[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:44903
[S3] → join 127.0.0.1:44902
[S4] → join 127.0.0.1:44902
[S5] → join 127.0.0.1:44902
[S6] → join 127.0.0.1:44902
[S7] → join 127.0.0.1:44902
[S8] → join 127.0.0.1:44902
[S9] → join 127.0.0.1:44902
[S10] → join 127.0.0.1:44902
[S11] → join 127.0.0.1:44902
[S13] → join 127.0.0.1:44902
[S14] → join 127.0.0.1:44902
[S15] → join 127.0.0.1:44902
[S16] → join 127.0.0.1:44902
[S17] → join 127.0.0.1:44902
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.122416 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.110327 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.210141 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.111336 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.132144 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.199460 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.133061 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.161987 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.140865 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.187280 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.136240 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.108673 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.176035 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.140622 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.126128 (no previous merge yet)
[S10]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S4] + discovered S2
[S3] + discovered S7
[S3] + discovered S11
[S3] + discovered S8
[S3] + discovered S13
[S3] + discovered S6
[S3] + discovered S10
[S3] + discovered S17
[S3] + discovered S4
[S3] + discovered S5
[S3] + discovered S14
[S3] + discovered S9
[S3] + discovered S16
[S3] + discovered S15
[S4] + discovered S3
[S4] + discovered S15
[S4] + discovered S10
[S4] + discovered S16
[S4] + discovered S14
[S4] + discovered S9
[S4] + discovered S5
[S4] + discovered S7
[S4] + discovered S6
[S4] + discovered S17
[S4] + discovered S13
[S4] + discovered S11
[S4] + discovered S8
[S5] + discovered S2
[S5] + discovered S3
[S5] + discovered S4
[S5] + discovered S6
[S5] + discovered S7
[S5] + discovered S14
[S5] + discovered S16
[S5] + discovered S11
[S5] + discovered S8
[S5] + discovered S13
[S5] + discovered S17
[S5] + discovered S9
[S5] + discovered S10
[S6] + discovered S2
[S6] + discovered S3
[S6] + discovered S5
[S5] + discovered S15
[S6] + discovered S4
[S6] + discovered S7
[S6] + discovered S14
[S6] + discovered S11
[S6] + discovered S13
[S6] + discovered S17
[S6] + discovered S9
[S6] + discovered S10
[S6] + discovered S16
[S6] + discovered S8
[S6] + discovered S15
[S7] + discovered S2
[S7] + discovered S6
[S7] + discovered S5
[S7] + discovered S4
[S7] + discovered S3
[S8] + discovered S7
[S8] + discovered S4
[S8] + discovered S3
[S8] + discovered S2
[S8] + discovered S6
[S8] + discovered S5
[S7] + discovered S10
[S7] + discovered S11
[S7] + discovered S17
[S7] + discovered S8
[S7] + discovered S14
[S7] + discovered S13
[S7] + discovered S9
[S7] + discovered S16
[S7] + discovered S15
[S8] + discovered S17
[S8] + discovered S10
[S9] + discovered S6
[S9] + discovered S5
[S9] + discovered S2
[S9] + discovered S4
[S9] + discovered S3
[S8] + discovered S15
[S8] + discovered S14
[S9] + discovered S7
[S8] + discovered S16
[S8] + discovered S9
[S8] + discovered S13
[S9] + discovered S8
[S8] + discovered S11
[S10] + discovered S2
[S9] + discovered S11
[S9] + discovered S10
[S9] + discovered S17
[S9] + discovered S13
[S9] + discovered S16
[S9] + discovered S14
[S9] + discovered S15
[S10] + discovered S4
[S10] + discovered S6
[S10] + discovered S5
[S10] + discovered S7
[S10] + discovered S8
[S10] + discovered S3
[S10] + discovered S9
[S11] + discovered S10
[S11] + discovered S5
[S11] + discovered S8
[S10] + discovered S11
[S10] + discovered S15
[S11] + discovered S3
[S11] + discovered S7
[S11] + discovered S4
[S11] + discovered S6
[S11] + discovered S9
[S11] + discovered S2
[S10] + discovered S17
[S10] + discovered S13
[S10] + discovered S16
[S10] + discovered S14
[S13] + discovered S6
[S13] + discovered S8
[S13] + discovered S9
[S13] + discovered S10
[S13] + discovered S3
[S13] + discovered S2
[S13] + discovered S5
[S11] + discovered S15
[S11] + discovered S13
[S11] + discovered S16
[S11] + discovered S17
[S11] + discovered S14
[S13] + discovered S11
[S13] + discovered S4
[S13] + discovered S7
[S14] + discovered S5
[S14] + discovered S11
[S14] + discovered S3
[S13] + discovered S17
[S14] + discovered S9
[S14] + discovered S8
[S14] + discovered S4
[S14] + discovered S7
[S14] + discovered S13
[S14] + discovered S2
[S14] + discovered S6
[S13] + discovered S14
[S14] + discovered S10
[S13] + discovered S15
[S13] + discovered S16
[S14] + discovered S17
[S15] + discovered S10
[S15] + discovered S8
[S15] + discovered S4
[S15] + discovered S2
[S14] + discovered S16
[S15] + discovered S13
[S14] + discovered S15
[S15] + discovered S3
[S15] + discovered S5
[S15] + discovered S9
[S15] + discovered S14
[S15] + discovered S6
[S15] + discovered S11
[S15] + discovered S7
[S15] + discovered S17
[S15] + discovered S16
[S16] + discovered S15
[S16] + discovered S4
[S16] + discovered S10
[S16] + discovered S13
[S16] + discovered S9
[S16] + discovered S6
[S16] + discovered S11
[S16] + discovered S7
[S16] + discovered S2
[S16] + discovered S5
[S16] + discovered S3
[S16] + discovered S14
[S16] + discovered S8
[S17] + discovered S6
[S16] + discovered S17
[S17] + discovered S5
[S17] + discovered S2
[S17] + discovered S7
[S17] + discovered S11
[S17] + discovered S15
[S17] + discovered S4
[S17] + discovered S13
[S17] + discovered S10
[S17] + discovered S9
[S17] + discovered S16
[S17] + discovered S8
[S17] + discovered S14
[S17] + discovered S3
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] ⇄ pheromone p=1.000 → S15@127.0.0.1:44915
[S15] ⇄ pheromone p=1.000 → S5@127.0.0.1:44905
[S3] ⇄ pheromone p=1.000 → S2@127.0.0.1:44902
[S7] ⇄ pheromone p=1.000 → S3@127.0.0.1:44903
[S9] ⇄ pheromone p=1.000 → S16@127.0.0.1:44916
[S14] ⇄ pheromone p=1.000 → S8@127.0.0.1:44909
[S10] ⇄ pheromone p=1.000 → S9@127.0.0.1:44910
[S13] ⇄ pheromone p=1.000 → S10@127.0.0.1:44911
[S6] ⇄ pheromone p=1.000 → S8@127.0.0.1:44909
[S5] ⇄ pheromone p=1.000 → S16@127.0.0.1:44916
[S2] ⇄ pheromone p=1.000 → S15@127.0.0.1:44915
[S8] ⇄ pheromone p=1.000 → S9@127.0.0.1:44910
[S4] ⇄ pheromone p=1.000 → S11@127.0.0.1:44912
[S16] ⇄ pheromone p=1.000 → S14@127.0.0.1:44914
[S17] ⇄ pheromone p=1.000 → S3@127.0.0.1:44903
[S2] START round=1 head_norm_before_train=1.131426 (no previous merge yet)
[S2] round=1 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6721362116885865, 'loss_val': 1.314609374915039, 'psi': 0.35392076470857464}-{'f1_val': 0.4044215101318086, 'auprc': 0.6342576043597282, 'loss_val': 1.3510220009178813, 'psi': 0.49635594782297643}
[S3] START round=1 head_norm_before_train=1.128539 (no previous merge yet)
[S3] round=1 local utility u=0.027982 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.998896941725322, 'loss_val': 1.264850680897238, 'psi': 0.483462816058593}-{'f1_val': 0.13984006561410703, 'auprc': 0.9987049062813904, 'loss_val': 1.3202395047658158, 'psi': 0.48338600188102043}
[S4] START round=1 head_norm_before_train=1.222903 (no previous merge yet)
[S4] round=1 local utility u=0.343189 metrics={'f1_val': 0.424076865109269, 'auprc': 0.7851496076107134, 'loss_val': 1.3182165916157105, 'psi': 0.5685059621098467}-{'f1_val': 0.3214953964953965, 'auprc': 0.7750043202647561, 'loss_val': 1.3586699168222685, 'psi': 0.5028989660031403}
[S5] START round=1 head_norm_before_train=1.120654 (no previous merge yet)
[S5] round=1 local utility u=0.030266 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.733930952407299, 'loss_val': 1.2778188610021106, 'psi': 0.37892952382006245}-{'f1_val': 0.14226190476190476, 'auprc': 0.7328790694108513, 'loss_val': 1.3351958082342021, 'psi': 0.3785087706214834}
[S6] START round=1 head_norm_before_train=1.135917 (no previous merge yet)
[S6] round=1 local utility u=0.361615 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.7090345998817077, 'loss_val': 1.3235705170646692, 'psi': 0.3684696091834523}-{'f1_val': 0.14142628205128205, 'auprc': 0.47942722216660355, 'loss_val': 1.3579777829811568, 'psi': 0.27662665809741066}
[S7] START round=1 head_norm_before_train=1.216186 (no previous merge yet)
[S7] round=1 local utility u=0.013842 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7694462805193898, 'loss_val': 1.2734090489468801, 'psi': 0.3930126058452109}-{'f1_val': 0.14205682272909165, 'auprc': 0.7790513767670382, 'loss_val': 1.3299093107848927, 'psi': 0.39685464434427026}
[S8] START round=1 head_norm_before_train=1.135660 (no previous merge yet)
[S8] round=1 local utility u=0.420201 metrics={'f1_val': 0.39142700823716925, 'auprc': 0.7784911759765252, 'loss_val': 1.350643366470513, 'psi': 0.5462526753329116}-{'f1_val': 0.29481513086063793, 'auprc': 0.7028933810080036, 'loss_val': 1.3845800712728709, 'psi': 0.4580464309195842}
[S9] START round=1 head_norm_before_train=1.177796 (no previous merge yet)
[S9] round=1 local utility u=0.275719 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8656471185546122, 'loss_val': 1.2118375451184673, 'psi': 0.4310976217058425}-{'f1_val': 0.141397957139996, 'auprc': 0.7146997261946293, 'loss_val': 1.3104325089690838, 'psi': 0.37071866476184934}
[S10] START round=1 head_norm_before_train=1.149198 (no previous merge yet)
[S10] round=1 local utility u=0.457126 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6848149064962774, 'loss_val': 1.329166112243975, 'psi': 0.35709894512354534}-{'f1_val': 0.10303146446995638, 'auprc': 0.4614931058758971, 'loss_val': 1.3599117480647784, 'psi': 0.24641612103233268}
[S11] START round=1 head_norm_before_train=1.189424 (no previous merge yet)
[S11] round=1 local utility u=0.469323 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.9018949883022114, 'loss_val': 1.335170302744968, 'psi': 0.44500620534475094}-{'f1_val': 0.14041368337311058, 'auprc': 0.5984163215900511, 'loss_val': 1.3633803443696377, 'psi': 0.32361473865988677}
[S13] START round=1 head_norm_before_train=1.139454 (no previous merge yet)
[S13] round=1 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5573425108275397, 'loss_val': 1.3219956191452966, 'psi': 0.3071684618772478}-{'f1_val': 0.41043461468271947, 'auprc': 0.5307085518435155, 'loss_val': 1.3526780665226572, 'psi': 0.4585441895470379}
[S14] START round=1 head_norm_before_train=1.112589 (no previous merge yet)
[S14] round=1 local utility u=0.152275 metrics={'f1_val': 0.09155565590426733, 'auprc': 0.8531358616370461, 'loss_val': 1.3653465535794644, 'psi': 0.39618773819737885}-{'f1_val': 0.09155565590426733, 'auprc': 0.7601154616569813, 'loss_val': 1.3908357532479947, 'psi': 0.3589795782053529}
[S15] START round=1 head_norm_before_train=1.184769 (no previous merge yet)
[S15] round=1 local utility u=0.039896 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7646068717457984, 'loss_val': 1.316644385915394, 'psi': 0.3896829395152544}-{'f1_val': 0.13973365136155833, 'auprc': 0.7460889158904945, 'loss_val': 1.3408828416819807, 'psi': 0.38227575717313284}
[S16] START round=1 head_norm_before_train=1.150010 (no previous merge yet)
[S16] round=1 local utility u=0.179156 metrics={'f1_val': 0.14583450902934536, 'auprc': 0.6868823176751252, 'loss_val': 1.3328946597962184, 'psi': 0.3622536324876573}-{'f1_val': 0.10386473429951691, 'auprc': 0.663047195985327, 'loss_val': 1.3678818145098472, 'psi': 0.327537718973841}
[S17] START round=1 head_norm_before_train=1.119091 (no previous merge yet)
[S17] round=1 local utility u=0.021136 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5805632781604377, 'loss_val': 1.3577659046979471, 'psi': 0.31679468925460574}-{'f1_val': 0.14094896331738438, 'auprc': 0.5739915338780612, 'loss_val': 1.3803224657530448, 'psi': 0.31416599154165514}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] → sending delta(kind=head bytes=1792) to S8@127.0.0.1:44909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:44907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] → sending delta(kind=head bytes=1792) to S6@127.0.0.1:44907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:44902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S6] → sending delta(kind=head bytes=1790) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S3] → sending delta(kind=head bytes=1791) to S10@127.0.0.1:44911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:44917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:44917
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:44912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:44903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S7] → sending delta(kind=head bytes=1789) to S6@127.0.0.1:44907
[S4] sending update (kind=head size=1792 to 1 peers)
[S11] sending update (kind=head size=1792 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1791 to 1 peers)
[S7] sending update (kind=head size=1789 to 1 peers)
[S6] sending update (kind=head size=1790 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1792 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1792 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1795) from S15
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.198953)
[S16] loaded HEAD from S15 (vec_in norm=1.198953)
[S16] cosine check vs S15: cos=0.0668
[S16] BUFFERED delta from S15 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1797) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.124766)
[S11] loaded HEAD from S14 (vec_in norm=1.124766)
[S11] cosine check vs S14: cos=0.0212
[S11] BUFFERED delta from S14 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1789) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.250375)
[S6] loaded HEAD from S7 (vec_in norm=1.250375)
[S6] cosine check vs S7: cos=0.0094
[S6] BUFFERED delta from S7 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1792) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.146754)
[S17] loaded HEAD from S8 (vec_in norm=1.146754)
[S17] cosine check vs S8: cos=-0.1090
[S17] DROPPED delta from S8 (cos=-0.1090 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1791) from S3
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.170567)
[S10] loaded HEAD from S3 (vec_in norm=1.170567)
[S10] cosine check vs S3: cos=0.0541
[S10] BUFFERED delta from S3 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1796) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.170239)
[S6] loaded HEAD from S16 (vec_in norm=1.170239)
[S6] cosine check vs S16: cos=0.0845
[S6] BUFFERED delta from S16 (total buffered=2)
[S8] RECEIVED delta(kind=head bytes=1792) from S10
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.160530)
[S8] loaded HEAD from S10 (vec_in norm=1.160530)
[S8] cosine check vs S10: cos=0.0116
[S8] BUFFERED delta from S10 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1792) from S11
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.202437)
[S6] loaded HEAD from S11 (vec_in norm=1.202437)
[S6] cosine check vs S11: cos=-0.1309
[S6] DROPPED delta from S11 (cos=-0.1309 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1792) from S4
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.244828)
[S17] loaded HEAD from S4 (vec_in norm=1.244828)
[S17] cosine check vs S4: cos=-0.0262
[S17] DROPPED delta from S4 (cos=-0.0262 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1790) from S6
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.151377)
[S15] loaded HEAD from S6 (vec_in norm=1.151377)
[S15] cosine check vs S6: cos=-0.0388
[S15] DROPPED delta from S6 (cos=-0.0388 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1796) from S5
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.151723)
[S2] loaded HEAD from S5 (vec_in norm=1.151723)
[S2] cosine check vs S5: cos=0.0411
[S2] BUFFERED delta from S5 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1799) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.219397)
[S3] loaded HEAD from S9 (vec_in norm=1.219397)
[S3] cosine check vs S9: cos=0.0671
[S3] BUFFERED delta from S9 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1783 reason=None
[S17] → sending delta(kind=head bytes=1783) to S16@127.0.0.1:44916
[S17] sending update (kind=head size=1783 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1783) from S17
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.123284)
[S16] loaded HEAD from S17 (vec_in norm=1.123284)
[S16] cosine check vs S17: cos=-0.0860
[S16] DROPPED delta from S17 (cos=-0.0860 < 0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=1 metric=0.1418 head_norm=1.148691
[S2] _apply_head_vector_avg (torch): Δ‖w‖=7.964392e-01
[S2] stored merged vector for next round verification (round=1)
[S2] DEBUG after merge:  round=1 metric=0.1418 head_norm=0.829857 delta_norm=0.796439
[S2] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=1 metric=0.1458 head_norm=1.170239
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.092325e-01
[S16] stored merged vector for next round verification (round=1)
[S16] DEBUG after merge:  round=1 metric=0.1243 head_norm=0.865226 delta_norm=0.809232
[S16] aggregate: ROLLBACK (f1_val pre=0.146 post=0.124 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=1 metric=0.3914 head_norm=1.146754
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.110239e-01
[S8] stored merged vector for next round verification (round=1)
[S8] DEBUG after merge:  round=1 metric=0.1045 head_norm=0.820474 delta_norm=0.811024
[S8] aggregate: ROLLBACK (f1_val pre=0.391 post=0.105 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=1 metric=0.1404 head_norm=1.202437
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.144979e-01
[S11] stored merged vector for next round verification (round=1)
[S11] DEBUG after merge:  round=1 metric=0.1404 head_norm=0.831907 delta_norm=0.814498
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=1 metric=0.1398 head_norm=1.170567
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.163305e-01
[S3] stored merged vector for next round verification (round=1)
[S3] DEBUG after merge:  round=1 metric=0.1398 head_norm=0.873031 delta_norm=0.816330
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=1 metric=0.1386 head_norm=1.160530
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.015606e-01
[S10] stored merged vector for next round verification (round=1)
[S10] DEBUG after merge:  round=1 metric=0.1386 head_norm=0.846185 delta_norm=0.801561
[S10] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=1 metric=0.1414 head_norm=1.151377
[S6] _apply_head_vector_avg (torch): Δ‖w‖=6.907420e-01
[S6] stored merged vector for next round verification (round=1)
[S6] DEBUG after merge:  round=1 metric=0.1414 head_norm=0.735388 delta_norm=0.690742
[S6] aggregate: ACCEPT kept=['S7', 'S16'] (k=2/2) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=0.829857 cos_to_last_merge=1.0000 (last merge round=1)
[S2] round=2 local utility u=0.103935 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7385532461108696, 'loss_val': 1.3059900140548766, 'psi': 0.3804875784774879}-{'f1_val': 0.1417771333885667, 'auprc': 0.6721362116885865, 'loss_val': 1.314609374915039, 'psi': 0.35392076470857464}
[S3] START round=2 head_norm_before_train=0.873031 cos_to_last_merge=1.0000 (last merge round=1)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9156514932508787, 'loss_val': 1.230157179072474, 'psi': 0.4501646366688157}-{'f1_val': 0.13984006561410703, 'auprc': 0.998896941725322, 'loss_val': 1.264850680897238, 'psi': 0.483462816058593}
[S4] START round=2 head_norm_before_train=1.244828 (no previous merge yet)
[S4] round=2 local utility u=0.000000 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7885865813997145, 'loss_val': 1.2686976817738151, 'psi': 0.3995706098969963}-{'f1_val': 0.424076865109269, 'auprc': 0.7851496076107134, 'loss_val': 1.3182165916157105, 'psi': 0.5685059621098467}
[S5] START round=2 head_norm_before_train=1.151723 (no previous merge yet)
[S5] round=2 local utility u=0.048226 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.736660495399025, 'loss_val': 1.1895552367746038, 'psi': 0.3800213410167529}-{'f1_val': 0.14226190476190476, 'auprc': 0.733930952407299, 'loss_val': 1.2778188610021106, 'psi': 0.37892952382006245}
[S6] START round=2 head_norm_before_train=0.735388 cos_to_last_merge=1.0000 (last merge round=1)
[S6] round=2 local utility u=0.168083 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8211123583874989, 'loss_val': 1.323637568585621, 'psi': 0.4133007125857688}-{'f1_val': 0.14142628205128205, 'auprc': 0.7090345998817077, 'loss_val': 1.3235705170646692, 'psi': 0.3684696091834523}
[S7] START round=2 head_norm_before_train=1.250375 (no previous merge yet)
[S7] round=2 local utility u=0.015439 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.771116392309358, 'loss_val': 1.247540928180605, 'psi': 0.3936806505611982}-{'f1_val': 0.14205682272909165, 'auprc': 0.7694462805193898, 'loss_val': 1.2734090489468801, 'psi': 0.3930126058452109}
[S8] START round=2 head_norm_before_train=0.820474 cos_to_last_merge=1.0000 (last merge round=1)
[S8] round=2 local utility u=0.088135 metrics={'f1_val': 0.42257860386146096, 'auprc': 0.7706723585899764, 'loss_val': 1.3378266747828278, 'psi': 0.5618161057528672}-{'f1_val': 0.39142700823716925, 'auprc': 0.7784911759765252, 'loss_val': 1.350643366470513, 'psi': 0.5462526753329116}
[S9] START round=2 head_norm_before_train=1.219397 (no previous merge yet)
[S9] round=2 local utility u=0.071268 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8589515572708042, 'loss_val': 1.049215735920882, 'psi': 0.4284193971923193}-{'f1_val': 0.141397957139996, 'auprc': 0.8656471185546122, 'loss_val': 1.2118375451184673, 'psi': 0.4310976217058425}
[S10] START round=2 head_norm_before_train=0.846185 cos_to_last_merge=1.0000 (last merge round=1)
[S10] round=2 local utility u=0.201985 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.8196088673762673, 'loss_val': 1.3295776674631692, 'psi': 0.4110165294755413}-{'f1_val': 0.13862163754172394, 'auprc': 0.6848149064962774, 'loss_val': 1.329166112243975, 'psi': 0.35709894512354534}
[S11] START round=2 head_norm_before_train=0.831907 cos_to_last_merge=1.0000 (last merge round=1)
[S11] round=2 local utility u=0.144486 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.998807866747412, 'loss_val': 1.3369379031303597, 'psi': 0.48377135672283117}-{'f1_val': 0.14041368337311058, 'auprc': 0.9018949883022114, 'loss_val': 1.335170302744968, 'psi': 0.44500620534475094}
[S13] START round=2 head_norm_before_train=1.151754 (no previous merge yet)
[S13] round=2 local utility u=0.106992 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6174729964293904, 'loss_val': 1.2884030613518471, 'psi': 0.331220656117988}-{'f1_val': 0.1403857625770531, 'auprc': 0.5573425108275397, 'loss_val': 1.3219956191452966, 'psi': 0.3071684618772478}
[S14] START round=2 head_norm_before_train=1.124766 (no previous merge yet)
[S14] round=2 local utility u=0.159557 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8521755104677984, 'loss_val': 1.3361652148048018, 'psi': 0.42508491591674163}-{'f1_val': 0.09155565590426733, 'auprc': 0.8531358616370461, 'loss_val': 1.3653465535794644, 'psi': 0.39618773819737885}
[S15] START round=2 head_norm_before_train=1.198953 (no previous merge yet)
[S15] round=2 local utility u=0.018499 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7683539802994822, 'loss_val': 1.2908868405578855, 'psi': 0.3911817829367279}-{'f1_val': 0.13973365136155833, 'auprc': 0.7646068717457984, 'loss_val': 1.316644385915394, 'psi': 0.3896829395152544}
[S16] START round=2 head_norm_before_train=0.865226 cos_to_last_merge=1.0000 (last merge round=1)
[S16] round=2 local utility u=0.015031 metrics={'f1_val': 0.14735963264454185, 'auprc': 0.6896152034034347, 'loss_val': 1.3201816136286852, 'psi': 0.364261860948099}-{'f1_val': 0.14583450902934536, 'auprc': 0.6868823176751252, 'loss_val': 1.3328946597962184, 'psi': 0.3622536324876573}
[S17] START round=2 head_norm_before_train=1.123284 (no previous merge yet)
[S17] round=2 local utility u=0.192538 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.7007874879632814, 'loss_val': 1.3333631245812503, 'psi': 0.3648843731757432}-{'f1_val': 0.14094896331738438, 'auprc': 0.5805632781604377, 'loss_val': 1.3577659046979471, 'psi': 0.31679468925460574}
[S10] not sending this round → trigger blocked (psi=0.411)
[S11] not sending this round → trigger blocked (psi=0.484)
[S15] not sending this round → trigger blocked (psi=0.391)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:44910
[S16] not sending this round → trigger blocked (psi=0.364)
[S14] not sending this round → trigger blocked (psi=0.425)
[S5] not sending this round → trigger blocked (psi=0.380)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:44908
[S6] not sending this round → trigger blocked (psi=0.413)
[S9] not sending this round → trigger blocked (psi=0.428)
[S8] not sending this round → trigger blocked (psi=0.562)
[S7] not sending this round → trigger blocked (psi=0.394)
[S2] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1799) from S13
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.169255)
[S9] loaded HEAD from S13 (vec_in norm=1.169255)
[S9] cosine check vs S13: cos=0.0106
[S9] BUFFERED delta from S13 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1799) from S2
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=0.852020)
[S7] loaded HEAD from S2 (vec_in norm=0.852020)
[S7] cosine check vs S2: cos=0.0233
[S7] BUFFERED delta from S2 (total buffered=1)
[S17] not sending this round → trigger blocked (psi=0.365)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=2 metric=0.1414 head_norm=1.267521
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.576798e-01
[S9] stored merged vector for next round verification (round=2)
[S9] DEBUG after merge:  round=2 metric=0.1414 head_norm=0.866758 delta_norm=0.857680
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=2 metric=0.1421 head_norm=1.274172
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.581174e-01
[S7] stored merged vector for next round verification (round=2)
[S7] DEBUG after merge:  round=2 metric=0.1421 head_norm=0.774587 delta_norm=0.758117
[S7] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=0.852020 cos_to_last_merge=0.9962 (last merge round=1)
[S2] round=3 local utility u=0.032357 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7443709881546828, 'loss_val': 1.2587300849675787, 'psi': 0.3828146752950132}-{'f1_val': 0.1417771333885667, 'auprc': 0.7385532461108696, 'loss_val': 1.3059900140548766, 'psi': 0.3804875784774879}
[S3] START round=3 head_norm_before_train=0.927647 cos_to_last_merge=0.9912 (last merge round=1)
[S3] round=3 local utility u=0.749958 metrics={'f1_val': 0.4224768768179887, 'auprc': 0.7942132187725967, 'loss_val': 1.0617464348980605, 'psi': 0.5711714135998318}-{'f1_val': 0.13984006561410703, 'auprc': 0.9156514932508787, 'loss_val': 1.230157179072474, 'psi': 0.4501646366688157}
[S4] START round=3 head_norm_before_train=1.275464 (no previous merge yet)
[S4] round=3 local utility u=0.062187 metrics={'f1_val': 0.1483098868023294, 'auprc': 0.7915321812574071, 'loss_val': 1.2016603445419751, 'psi': 0.40559880458436054}-{'f1_val': 0.14022662889518414, 'auprc': 0.7885865813997145, 'loss_val': 1.2686976817738151, 'psi': 0.3995706098969963}
[S5] START round=3 head_norm_before_train=1.199145 (no previous merge yet)
[S5] round=3 local utility u=0.948860 metrics={'f1_val': 0.41734838192522206, 'auprc': 0.7754718499258021, 'loss_val': 1.0587876427838019, 'psi': 0.5605977691254541}-{'f1_val': 0.14226190476190476, 'auprc': 0.736660495399025, 'loss_val': 1.1895552367746038, 'psi': 0.3800213410167529}
[S6] START round=3 head_norm_before_train=0.756109 cos_to_last_merge=0.9966 (last merge round=1)
[S6] round=3 local utility u=0.012809 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8159116851242355, 'loss_val': 1.2824184858733225, 'psi': 0.4112204432804634}-{'f1_val': 0.14142628205128205, 'auprc': 0.8211123583874989, 'loss_val': 1.323637568585621, 'psi': 0.4133007125857688}
[S7] START round=3 head_norm_before_train=0.774587 cos_to_last_merge=1.0000 (last merge round=2)
[S7] round=3 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7750056678729061, 'loss_val': 1.263513344001995, 'psi': 0.39523636078661745}-{'f1_val': 0.14205682272909165, 'auprc': 0.771116392309358, 'loss_val': 1.247540928180605, 'psi': 0.3936806505611982}
[S8] START round=3 head_norm_before_train=0.841921 cos_to_last_merge=0.9968 (last merge round=1)
[S8] round=3 local utility u=0.000000 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7707856124387746, 'loss_val': 1.2991868313132242, 'psi': 0.3922878344112842}-{'f1_val': 0.42257860386146096, 'auprc': 0.7706723585899764, 'loss_val': 1.3378266747828278, 'psi': 0.5618161057528672}
[S9] START round=3 head_norm_before_train=0.866758 cos_to_last_merge=1.0000 (last merge round=2)
[S9] round=3 local utility u=0.000000 metrics={'f1_val': 0.14242485374218278, 'auprc': 0.8157460728317991, 'loss_val': 0.9379873364695154, 'psi': 0.4117533413780293}-{'f1_val': 0.141397957139996, 'auprc': 0.8589515572708042, 'loss_val': 1.049215735920882, 'psi': 0.4284193971923193}
[S10] START round=3 head_norm_before_train=0.856886 cos_to_last_merge=0.9977 (last merge round=1)
[S10] round=3 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7757992278617856, 'loss_val': 1.3037454832476212, 'psi': 0.3934926736697486}-{'f1_val': 0.13862163754172394, 'auprc': 0.8196088673762673, 'loss_val': 1.3295776674631692, 'psi': 0.4110165294755413}
[S11] START round=3 head_norm_before_train=0.853766 cos_to_last_merge=0.9964 (last merge round=1)
[S11] round=3 local utility u=0.020230 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.9988423834940647, 'loss_val': 1.2965807930079754, 'psi': 0.48378516342149225}-{'f1_val': 0.14041368337311058, 'auprc': 0.998807866747412, 'loss_val': 1.3369379031303597, 'psi': 0.48377135672283117}
[S13] START round=3 head_norm_before_train=1.169255 (no previous merge yet)
[S13] round=3 local utility u=0.164902 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7127662290360401, 'loss_val': 1.2444792476537685, 'psi': 0.36933794916064794}-{'f1_val': 0.1403857625770531, 'auprc': 0.6174729964293904, 'loss_val': 1.2884030613518471, 'psi': 0.331220656117988}
[S14] START round=3 head_norm_before_train=1.146116 (no previous merge yet)
[S14] round=3 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8338352966521062, 'loss_val': 1.301737226555396, 'psi': 0.41774883039046473}-{'f1_val': 0.14035785288270378, 'auprc': 0.8521755104677984, 'loss_val': 1.3361652148048018, 'psi': 0.42508491591674163}
[S15] START round=3 head_norm_before_train=1.219515 (no previous merge yet)
[S15] round=3 local utility u=0.020393 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7718527799652373, 'loss_val': 1.260598087162755, 'psi': 0.39258130280302994}-{'f1_val': 0.13973365136155833, 'auprc': 0.7683539802994822, 'loss_val': 1.2908868405578855, 'psi': 0.3911817829367279}
[S16] START round=3 head_norm_before_train=0.890824 cos_to_last_merge=0.9970 (last merge round=1)
[S16] round=3 local utility u=0.005993 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.6948353218688268, 'loss_val': 1.2835226734273324, 'psi': 0.3623165988670526}-{'f1_val': 0.14735963264454185, 'auprc': 0.6896152034034347, 'loss_val': 1.3201816136286852, 'psi': 0.364261860948099}
[S17] START round=3 head_norm_before_train=1.137320 (no previous merge yet)
[S17] round=3 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.687692964371092, 'loss_val': 1.3060074814625353, 'psi': 0.35964656373886744}-{'f1_val': 0.14094896331738438, 'auprc': 0.7007874879632814, 'loss_val': 1.3333631245812503, 'psi': 0.3648843731757432}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] → sending delta(kind=head bytes=1792) to S8@127.0.0.1:44909
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.369)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.383)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] → sending delta(kind=head bytes=1792) to S5@127.0.0.1:44905
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:44902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:44914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:44916
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S4] → sending delta(kind=head bytes=1791) to S11@127.0.0.1:44912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:44915
[S11] sending update (kind=head size=1793 to 1 peers)
[S4] sending update (kind=head size=1791 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1792 to 1 peers)
[S6] sending update (kind=head size=1792 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1792) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.249029)
[S5] loaded HEAD from S15 (vec_in norm=1.249029)
[S5] cosine check vs S15: cos=0.0251
[S5] BUFFERED delta from S15 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1792) from S6
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.784758)
[S8] loaded HEAD from S6 (vec_in norm=0.784758)
[S8] cosine check vs S6: cos=0.0254
[S8] BUFFERED delta from S6 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1793) from S11
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.887056)
[S15] loaded HEAD from S11 (vec_in norm=0.887056)
[S15] cosine check vs S11: cos=-0.0187
[S15] DROPPED delta from S11 (cos=-0.0187 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1796) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.237838)
[S16] loaded HEAD from S5 (vec_in norm=1.237838)
[S16] cosine check vs S5: cos=-0.0475
[S16] DROPPED delta from S5 (cos=-0.0475 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1798) from S3
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=0.994993)
[S2] loaded HEAD from S3 (vec_in norm=0.994993)
[S2] cosine check vs S3: cos=-0.0688
[S2] DROPPED delta from S3 (cos=-0.0688 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1800) from S16
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.924352)
[S14] loaded HEAD from S16 (vec_in norm=0.924352)
[S14] cosine check vs S16: cos=-0.0190
[S14] DROPPED delta from S16 (cos=-0.0190 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1791) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.313956)
[S11] loaded HEAD from S4 (vec_in norm=1.313956)
[S11] cosine check vs S4: cos=0.0105
[S11] BUFFERED delta from S4 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=3 metric=0.1400 head_norm=0.873327
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.795981e-01
[S8] stored merged vector for next round verification (round=3)
[S8] DEBUG after merge:  round=3 metric=0.4227 head_norm=0.594423 delta_norm=0.579598
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=3 metric=0.1404 head_norm=0.887056
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.888231e-01
[S11] stored merged vector for next round verification (round=3)
[S11] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.796513 delta_norm=0.788823
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=3 metric=0.4173 head_norm=1.237838
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.681300e-01
[S5] stored merged vector for next round verification (round=3)
[S5] DEBUG after merge:  round=3 metric=0.4175 head_norm=0.890229 delta_norm=0.868130
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=0.883987 cos_to_last_merge=0.9857 (last merge round=1)
[S2] round=4 local utility u=0.016523 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7467189007147509, 'loss_val': 1.2327277559304095, 'psi': 0.3837538403190404}-{'f1_val': 0.1417771333885667, 'auprc': 0.7443709881546828, 'loss_val': 1.2587300849675787, 'psi': 0.3828146752950132}
[S3] START round=4 head_norm_before_train=0.994993 cos_to_last_merge=0.9744 (last merge round=1)
[S3] round=4 local utility u=0.287560 metrics={'f1_val': 0.4058701688477675, 'auprc': 0.9272254375651383, 'loss_val': 0.7860220604946386, 'psi': 0.6144122763347158}-{'f1_val': 0.4224768768179887, 'auprc': 0.7942132187725967, 'loss_val': 1.0617464348980605, 'psi': 0.5711714135998318}
[S4] START round=4 head_norm_before_train=1.313956 (no previous merge yet)
[S4] round=4 local utility u=0.846224 metrics={'f1_val': 0.41419477691946305, 'auprc': 0.7930316000171806, 'loss_val': 1.1090189891054154, 'psi': 0.5657295061585501}-{'f1_val': 0.1483098868023294, 'auprc': 0.7915321812574071, 'loss_val': 1.2016603445419751, 'psi': 0.40559880458436054}
[S5] START round=4 head_norm_before_train=0.890229 cos_to_last_merge=1.0000 (last merge round=3)
[S5] round=4 local utility u=0.064519 metrics={'f1_val': 0.41762898496828804, 'auprc': 0.7773955965919588, 'loss_val': 0.9372038953949903, 'psi': 0.5615356296177563}-{'f1_val': 0.41734838192522206, 'auprc': 0.7754718499258021, 'loss_val': 1.0587876427838019, 'psi': 0.5605977691254541}
[S6] START round=4 head_norm_before_train=0.784758 cos_to_last_merge=0.9879 (last merge round=1)
[S6] round=4 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6906734288937079, 'loss_val': 1.2308558018768212, 'psi': 0.36112514078825236}-{'f1_val': 0.14142628205128205, 'auprc': 0.8159116851242355, 'loss_val': 1.2824184858733225, 'psi': 0.4112204432804634}
[S7] START round=4 head_norm_before_train=0.803172 cos_to_last_merge=0.9965 (last merge round=2)
[S7] round=4 local utility u=0.039781 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.777596619848518, 'loss_val': 1.1917234564919783, 'psi': 0.3962727415768622}-{'f1_val': 0.14205682272909165, 'auprc': 0.7750056678729061, 'loss_val': 1.263513344001995, 'psi': 0.39523636078661745}
[S8] START round=4 head_norm_before_train=0.594423 cos_to_last_merge=1.0000 (last merge round=3)
[S8] round=4 local utility u=0.000000 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7661367035904227, 'loss_val': 1.286456816612467, 'psi': 0.39042827087194343}-{'f1_val': 0.13995598239295717, 'auprc': 0.7707856124387746, 'loss_val': 1.2991868313132242, 'psi': 0.3922878344112842}
[S9] START round=4 head_norm_before_train=0.929990 cos_to_last_merge=0.9912 (last merge round=2)
[S9] round=4 local utility u=1.000000 metrics={'f1_val': 0.40257148104194684, 'auprc': 0.9995844304021745, 'loss_val': 0.7174351943549429, 'psi': 0.6413766607860378}-{'f1_val': 0.14242485374218278, 'auprc': 0.8157460728317991, 'loss_val': 0.9379873364695154, 'psi': 0.4117533413780293}
[S10] START round=4 head_norm_before_train=0.877514 cos_to_last_merge=0.9911 (last merge round=1)
[S10] round=4 local utility u=0.018068 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7759883745799769, 'loss_val': 1.26817701071852, 'psi': 0.39356833235702515}-{'f1_val': 0.13862163754172394, 'auprc': 0.7757992278617856, 'loss_val': 1.3037454832476212, 'psi': 0.3934926736697486}
[S11] START round=4 head_norm_before_train=0.796513 cos_to_last_merge=1.0000 (last merge round=3)
[S11] round=4 local utility u=0.000689 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.9963809216219864, 'loss_val': 1.2878179498168283, 'psi': 0.48280057867266096}-{'f1_val': 0.14041368337311058, 'auprc': 0.9988423834940647, 'loss_val': 1.2965807930079754, 'psi': 0.48378516342149225}
[S13] START round=4 head_norm_before_train=1.195443 (no previous merge yet)
[S13] round=4 local utility u=0.039500 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7206654496984535, 'loss_val': 1.1891770159125747, 'psi': 0.37249763742561326}-{'f1_val': 0.1403857625770531, 'auprc': 0.7127662290360401, 'loss_val': 1.2444792476537685, 'psi': 0.36933794916064794}
[S14] START round=4 head_norm_before_train=1.175420 (no previous merge yet)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.6842903883153271, 'loss_val': 1.2710427245662381, 'psi': 0.3579308670557531}-{'f1_val': 0.14035785288270378, 'auprc': 0.8338352966521062, 'loss_val': 1.301737226555396, 'psi': 0.41774883039046473}
[S15] START round=4 head_norm_before_train=1.249029 (no previous merge yet)
[S15] round=4 local utility u=0.018510 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7754743967296851, 'loss_val': 1.2344426728121247, 'psi': 0.39402994950880904}-{'f1_val': 0.13973365136155833, 'auprc': 0.7718527799652373, 'loss_val': 1.260598087162755, 'psi': 0.39258130280302994}
[S16] START round=4 head_norm_before_train=0.924352 cos_to_last_merge=0.9896 (last merge round=1)
[S16] round=4 local utility u=0.028990 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.6949788940829575, 'loss_val': 1.225972821556958, 'psi': 0.3623740277527049}-{'f1_val': 0.14063745019920318, 'auprc': 0.6948353218688268, 'loss_val': 1.2835226734273324, 'psi': 0.3623165988670526}
[S17] START round=4 head_norm_before_train=1.159123 (no previous merge yet)
[S17] round=4 local utility u=0.047922 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.708752135762355, 'loss_val': 1.2733400598279359, 'psi': 0.3680702322953726}-{'f1_val': 0.14094896331738438, 'auprc': 0.687692964371092, 'loss_val': 1.3060074814625353, 'psi': 0.35964656373886744}
[S16] not sending this round → trigger blocked (psi=0.362)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:44910
[S4] not sending this round → trigger blocked (psi=0.566)
[S11] not sending this round → trigger blocked (psi=0.483)
[S3] not sending this round → trigger blocked (psi=0.614)
[S15] not sending this round → trigger blocked (psi=0.394)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:44911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:44916
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.562)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:44903
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1794 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1794) from S7
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.852383)
[S3] loaded HEAD from S7 (vec_in norm=0.852383)
[S3] cosine check vs S7: cos=-0.0121
[S3] DROPPED delta from S7 (cos=-0.0121 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1802) from S13
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.227292)
[S10] loaded HEAD from S13 (vec_in norm=1.227292)
[S10] cosine check vs S13: cos=-0.0359
[S10] DROPPED delta from S13 (cos=-0.0359 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1796) from S10
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=0.906351)
[S9] loaded HEAD from S10 (vec_in norm=0.906351)
[S9] cosine check vs S10: cos=0.0048
[S9] BUFFERED delta from S10 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1799) from S2
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=0.912763)
[S15] loaded HEAD from S2 (vec_in norm=0.912763)
[S15] cosine check vs S2: cos=0.0846
[S15] BUFFERED delta from S2 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1798) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.019916)
[S16] loaded HEAD from S9 (vec_in norm=1.019916)
[S16] cosine check vs S9: cos=-0.0224
[S16] DROPPED delta from S9 (cos=-0.0224 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:44903
[S17] sending update (kind=head size=1796 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1796) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.183940)
[S3] loaded HEAD from S17 (vec_in norm=1.183940)
[S3] cosine check vs S17: cos=0.1324
[S3] BUFFERED delta from S17 (total buffered=1)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=4 metric=0.4059 head_norm=1.070478
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.436476e-01
[S3] stored merged vector for next round verification (round=4)
[S3] DEBUG after merge:  round=4 metric=0.4493 head_norm=0.849003 delta_norm=0.743648
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=4 metric=0.1397 head_norm=1.283212
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.552652e-01
[S15] stored merged vector for next round verification (round=4)
[S15] DEBUG after merge:  round=4 metric=0.1397 head_norm=0.818205 delta_norm=0.755265
[S15] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=4 metric=0.4026 head_norm=1.019916
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.805921e-01
[S9] stored merged vector for next round verification (round=4)
[S9] DEBUG after merge:  round=4 metric=0.4033 head_norm=0.683845 delta_norm=0.680592
[S9] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=0.912763 cos_to_last_merge=0.9756 (last merge round=1)
[S2] round=5 local utility u=0.035892 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7561354935454474, 'loss_val': 1.189194532186177, 'psi': 0.387520477451319}-{'f1_val': 0.1417771333885667, 'auprc': 0.7467189007147509, 'loss_val': 1.2327277559304095, 'psi': 0.3837538403190404}
[S3] START round=5 head_norm_before_train=0.849003 cos_to_last_merge=1.0000 (last merge round=4)
[S3] round=5 local utility u=0.000000 metrics={'f1_val': 0.4024484509855121, 'auprc': 0.8956988294919181, 'loss_val': 0.7900573952651211, 'psi': 0.5997486023880745}-{'f1_val': 0.4058701688477675, 'auprc': 0.9272254375651383, 'loss_val': 0.7860220604946386, 'psi': 0.6144122763347158}
[S4] START round=5 head_norm_before_train=1.356104 (no previous merge yet)
[S4] round=5 local utility u=0.882465 metrics={'f1_val': 0.6830539175813959, 'auprc': 0.7930491068062068, 'loss_val': 0.9572955755292464, 'psi': 0.7270519932713202}-{'f1_val': 0.41419477691946305, 'auprc': 0.7930316000171806, 'loss_val': 1.1090189891054154, 'psi': 0.5657295061585501}
[S5] START round=5 head_norm_before_train=0.952260 cos_to_last_merge=0.9925 (last merge round=3)
[S5] round=5 local utility u=0.096148 metrics={'f1_val': 0.4176671856330787, 'auprc': 0.7947391253168765, 'loss_val': 0.797167009452586, 'psi': 0.5684959615065979}-{'f1_val': 0.41762898496828804, 'auprc': 0.7773955965919588, 'loss_val': 0.9372038953949903, 'psi': 0.5615356296177563}
[S6] START round=5 head_norm_before_train=0.825463 cos_to_last_merge=0.9748 (last merge round=1)
[S6] round=5 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6629129967853118, 'loss_val': 1.1921552558962858, 'psi': 0.35002096794489396}-{'f1_val': 0.14142628205128205, 'auprc': 0.6906734288937079, 'loss_val': 1.2308558018768212, 'psi': 0.36112514078825236}
[S7] START round=5 head_norm_before_train=0.852383 cos_to_last_merge=0.9862 (last merge round=2)
[S7] round=5 local utility u=0.805799 metrics={'f1_val': 0.4172807768329403, 'auprc': 0.712667238958237, 'loss_val': 1.0366816774788388, 'psi': 0.5354353616830589}-{'f1_val': 0.14205682272909165, 'auprc': 0.777596619848518, 'loss_val': 1.1917234564919783, 'psi': 0.3962727415768622}
[S8] START round=5 head_norm_before_train=0.632212 cos_to_last_merge=0.9945 (last merge round=3)
[S8] round=5 local utility u=0.044837 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7686006553047672, 'loss_val': 1.2041739606580715, 'psi': 0.3914138515576812}-{'f1_val': 0.13995598239295717, 'auprc': 0.7661367035904227, 'loss_val': 1.286456816612467, 'psi': 0.39042827087194343}
[S9] START round=5 head_norm_before_train=0.683845 cos_to_last_merge=1.0000 (last merge round=4)
[S9] round=5 local utility u=0.687442 metrics={'f1_val': 0.7014391336149548, 'auprc': 0.8653531963900644, 'loss_val': 0.7330641336165505, 'psi': 0.7670047587249986}-{'f1_val': 0.40257148104194684, 'auprc': 0.9995844304021745, 'loss_val': 0.7174351943549429, 'psi': 0.6413766607860378}
[S10] START round=5 head_norm_before_train=0.906351 cos_to_last_merge=0.9810 (last merge round=1)
[S10] round=5 local utility u=0.017254 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7764149694295213, 'loss_val': 1.2349485357021937, 'psi': 0.3937389702968429}-{'f1_val': 0.13862163754172394, 'auprc': 0.7759883745799769, 'loss_val': 1.26817701071852, 'psi': 0.39356833235702515}
[S11] START round=5 head_norm_before_train=0.826133 cos_to_last_merge=0.9958 (last merge round=3)
[S11] round=5 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6655200074201674, 'loss_val': 1.1997453168241234, 'psi': 0.3504562129919333}-{'f1_val': 0.14041368337311058, 'auprc': 0.9963809216219864, 'loss_val': 1.2878179498168283, 'psi': 0.48280057867266096}
[S13] START round=5 head_norm_before_train=1.227292 (no previous merge yet)
[S13] round=5 local utility u=0.541565 metrics={'f1_val': 0.30632034039150946, 'auprc': 0.7239565175622714, 'loss_val': 1.1115274487593811, 'psi': 0.47337481125981423}-{'f1_val': 0.1403857625770531, 'auprc': 0.7206654496984535, 'loss_val': 1.1891770159125747, 'psi': 0.37249763742561326}
[S14] START round=5 head_norm_before_train=1.210705 (no previous merge yet)
[S14] round=5 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.657421967976402, 'loss_val': 1.2453377909894057, 'psi': 0.347183498920183}-{'f1_val': 0.14035785288270378, 'auprc': 0.6842903883153271, 'loss_val': 1.2710427245662381, 'psi': 0.3579308670557531}
[S15] START round=5 head_norm_before_train=0.818205 cos_to_last_merge=1.0000 (last merge round=4)
[S15] round=5 local utility u=0.033302 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7922225471188235, 'loss_val': 1.2180834840752754, 'psi': 0.4007292096644644}-{'f1_val': 0.13973365136155833, 'auprc': 0.7754743967296851, 'loss_val': 1.2344426728121247, 'psi': 0.39402994950880904}
[S16] START round=5 head_norm_before_train=0.960806 cos_to_last_merge=0.9799 (last merge round=1)
[S16] round=5 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.6392999636362156, 'loss_val': 1.1628048827284332, 'psi': 0.3401024555740081}-{'f1_val': 0.14063745019920318, 'auprc': 0.6949788940829575, 'loss_val': 1.225972821556958, 'psi': 0.3623740277527049}
[S17] START round=5 head_norm_before_train=1.183940 (no previous merge yet)
[S17] round=5 local utility u=0.021509 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.7037615056913141, 'loss_val': 1.2153503684165374, 'psi': 0.3660739802669563}-{'f1_val': 0.14094896331738438, 'auprc': 0.708752135762355, 'loss_val': 1.2733400598279359, 'psi': 0.3680702322953726}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.767)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:44916
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.473)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:44905
[S10] not sending this round → trigger blocked (psi=0.394)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:44912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:44910
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.535)
[S2] not sending this round → trigger blocked (psi=0.388)
[S8] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1800) from S8
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.679159)
[S9] loaded HEAD from S8 (vec_in norm=0.679159)
[S9] cosine check vs S8: cos=0.1441
[S9] BUFFERED delta from S8 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1796) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.846993)
[S5] loaded HEAD from S15 (vec_in norm=0.846993)
[S5] cosine check vs S15: cos=0.8009
[S5] BUFFERED delta from S15 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1800) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.015544)
[S16] loaded HEAD from S5 (vec_in norm=1.015544)
[S16] cosine check vs S5: cos=0.3470
[S16] BUFFERED delta from S5 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1797) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.397980)
[S11] loaded HEAD from S4 (vec_in norm=1.397980)
[S11] cosine check vs S4: cos=0.7748
[S11] BUFFERED delta from S4 (total buffered=1)
[S17] not sending this round → trigger blocked (psi=0.366)
[S7] ⇄ pheromone p=0.498 → S3@127.0.0.1:44903
[S3] ⇄ pheromone p=0.472 → S2@127.0.0.1:44902
[S14] ⇄ pheromone p=0.356 → S8@127.0.0.1:44909
[S13] ⇄ pheromone p=0.474 → S10@127.0.0.1:44911
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=5 metric=0.1404 head_norm=0.866805
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.549814e-01
[S11] stored merged vector for next round verification (round=5)
[S11] DEBUG after merge:  round=5 metric=0.1404 head_norm=1.070440 delta_norm=0.454981
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.384 → S15@127.0.0.1:44915
[S6] ⇄ pheromone p=0.376 → S8@127.0.0.1:44909
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=5 metric=0.7014 head_norm=0.775085
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.770617e-01
[S9] stored merged vector for next round verification (round=5)
[S9] DEBUG after merge:  round=5 metric=0.3810 head_norm=0.550835 delta_norm=0.477062
[S9] aggregate: ROLLBACK (f1_val pre=0.701 post=0.381 tol_abs=0.005 tol_rel=0.0)
[S9] ⇄ pheromone p=0.655 → S16@127.0.0.1:44916
[S2] ⇄ pheromone p=0.352 → S15@127.0.0.1:44915
[S10] ⇄ pheromone p=0.392 → S9@127.0.0.1:44910
[S8] ⇄ pheromone p=0.380 → S9@127.0.0.1:44910
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=5 metric=0.4177 head_norm=1.015544
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.045505e-01
[S5] stored merged vector for next round verification (round=5)
[S5] DEBUG after merge:  round=5 metric=0.4177 head_norm=0.884088 delta_norm=0.304550
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.486 → S16@127.0.0.1:44916
[S15] ⇄ pheromone p=0.345 → S5@127.0.0.1:44905
[S4] ⇄ pheromone p=0.676 → S11@127.0.0.1:44912
[S17] ⇄ pheromone p=0.361 → S3@127.0.0.1:44903
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=5 metric=0.1406 head_norm=1.001537
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.763122e-01
[S16] stored merged vector for next round verification (round=5)
[S16] DEBUG after merge:  round=5 metric=0.1406 head_norm=0.827688 delta_norm=0.576312
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.349 → S14@127.0.0.1:44914
[S2] START round=6 head_norm_before_train=0.933989 cos_to_last_merge=0.9680 (last merge round=1)
[S2] round=6 local utility u=0.053465 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7683941563237746, 'loss_val': 1.1190407385416912, 'psi': 0.3924239425626499}-{'f1_val': 0.1417771333885667, 'auprc': 0.7561354935454474, 'loss_val': 1.189194532186177, 'psi': 0.387520477451319}
[S3] START round=6 head_norm_before_train=0.942266 cos_to_last_merge=0.9893 (last merge round=4)
[S3] round=6 local utility u=1.000000 metrics={'f1_val': 0.649579316308615, 'auprc': 0.9973034029991864, 'loss_val': 0.524066127008567, 'psi': 0.7886689509848436}-{'f1_val': 0.4024484509855121, 'auprc': 0.8956988294919181, 'loss_val': 0.7900573952651211, 'psi': 0.5997486023880745}
[S4] START round=6 head_norm_before_train=1.397980 (no previous merge yet)
[S4] round=6 local utility u=0.109163 metrics={'f1_val': 0.6887368219190715, 'auprc': 0.7826779697144344, 'loss_val': 0.7419541857714541, 'psi': 0.7263132810372166}-{'f1_val': 0.6830539175813959, 'auprc': 0.7930491068062068, 'loss_val': 0.9572955755292464, 'psi': 0.7270519932713202}
[S5] START round=6 head_norm_before_train=0.884088 cos_to_last_merge=1.0000 (last merge round=5)
[S5] round=6 local utility u=0.001194 metrics={'f1_val': 0.4181926743009027, 'auprc': 0.7918084576350475, 'loss_val': 0.7891396969887003, 'psi': 0.5676389876345607}-{'f1_val': 0.4176671856330787, 'auprc': 0.7947391253168765, 'loss_val': 0.797167009452586, 'psi': 0.5684959615065979}
[S6] START round=6 head_norm_before_train=0.862555 cos_to_last_merge=0.9622 (last merge round=1)
[S6] round=6 local utility u=0.817839 metrics={'f1_val': 0.40615967502538863, 'auprc': 0.6460951663281215, 'loss_val': 1.0944234861027893, 'psi': 0.5021338715464818}-{'f1_val': 0.14142628205128205, 'auprc': 0.6629129967853118, 'loss_val': 1.1921552558962858, 'psi': 0.35002096794489396}
[S7] START round=6 head_norm_before_train=0.905185 cos_to_last_merge=0.9688 (last merge round=2)
[S7] round=6 local utility u=0.256355 metrics={'f1_val': 0.49946605295037266, 'auprc': 0.6687654481576184, 'loss_val': 0.8853787051895582, 'psi': 0.567185811033271}-{'f1_val': 0.4172807768329403, 'auprc': 0.712667238958237, 'loss_val': 1.0366816774788388, 'psi': 0.5354353616830589}
[S8] START round=6 head_norm_before_train=0.679159 cos_to_last_merge=0.9803 (last merge round=3)
[S8] round=6 local utility u=0.892608 metrics={'f1_val': 0.4156929677121941, 'auprc': 0.7768967366723254, 'loss_val': 1.0982690161376993, 'psi': 0.5601744752962466}-{'f1_val': 0.13995598239295717, 'auprc': 0.7686006553047672, 'loss_val': 1.2041739606580715, 'psi': 0.3914138515576812}
[S9] START round=6 head_norm_before_train=0.550835 cos_to_last_merge=1.0000 (last merge round=5)
[S9] round=6 local utility u=0.000000 metrics={'f1_val': 0.3813405653993305, 'auprc': 0.9754397131536375, 'loss_val': 0.7399579385310768, 'psi': 0.6189802245010533}-{'f1_val': 0.7014391336149548, 'auprc': 0.8653531963900644, 'loss_val': 0.7330641336165505, 'psi': 0.7670047587249986}
[S10] START round=6 head_norm_before_train=0.939796 cos_to_last_merge=0.9691 (last merge round=1)
[S10] round=6 local utility u=0.030368 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7763950122954275, 'loss_val': 1.1741523354097598, 'psi': 0.3937309874432054}-{'f1_val': 0.13862163754172394, 'auprc': 0.7764149694295213, 'loss_val': 1.2349485357021937, 'psi': 0.3937389702968429}
[S11] START round=6 head_norm_before_train=1.070440 cos_to_last_merge=1.0000 (last merge round=5)
[S11] round=6 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6094197858743378, 'loss_val': 1.148653325433113, 'psi': 0.32801612437360145}-{'f1_val': 0.14041368337311058, 'auprc': 0.6655200074201674, 'loss_val': 1.1997453168241234, 'psi': 0.3504562129919333}
[S13] START round=6 head_norm_before_train=1.261099 (no previous merge yet)
[S13] round=6 local utility u=0.272004 metrics={'f1_val': 0.416200286011302, 'auprc': 0.660819609490771, 'loss_val': 1.0373889520272657, 'psi': 0.5140480154030895}-{'f1_val': 0.30632034039150946, 'auprc': 0.7239565175622714, 'loss_val': 1.1115274487593811, 'psi': 0.47337481125981423}
[S14] START round=6 head_norm_before_train=1.245440 (no previous merge yet)
[S14] round=6 local utility u=0.557494 metrics={'f1_val': 0.17741681692920083, 'auprc': 0.9320464112588114, 'loss_val': 1.1765770385477061, 'psi': 0.47926865466104507}-{'f1_val': 0.14035785288270378, 'auprc': 0.657421967976402, 'loss_val': 1.2453377909894057, 'psi': 0.347183498920183}
[S15] START round=6 head_norm_before_train=0.846993 cos_to_last_merge=0.9984 (last merge round=4)
[S15] round=6 local utility u=0.818679 metrics={'f1_val': 0.4164559415260807, 'auprc': 0.7602611233330425, 'loss_val': 1.1451753866971373, 'psi': 0.5539780142488654}-{'f1_val': 0.13973365136155833, 'auprc': 0.7922225471188235, 'loss_val': 1.2180834840752754, 'psi': 0.4007292096644644}
[S16] START round=6 head_norm_before_train=0.827688 cos_to_last_merge=1.0000 (last merge round=5)
[S16] round=6 local utility u=0.881148 metrics={'f1_val': 0.4173069283424069, 'auprc': 0.6560928527546449, 'loss_val': 1.1109037147665335, 'psi': 0.5128212981073021}-{'f1_val': 0.14063745019920318, 'auprc': 0.6392999636362156, 'loss_val': 1.1628048827284332, 'psi': 0.3401024555740081}
[S17] START round=6 head_norm_before_train=1.216550 (no previous merge yet)
[S17] round=6 local utility u=0.796962 metrics={'f1_val': 0.3832811102772674, 'auprc': 0.7142128792639446, 'loss_val': 1.1067729521196803, 'psi': 0.5156538178719383}-{'f1_val': 0.14094896331738438, 'auprc': 0.7037615056913141, 'loss_val': 1.2153503684165374, 'psi': 0.3660739802669563}
[S5] not sending this round → trigger blocked (psi=0.568)
[S8] not sending this round → trigger blocked (psi=0.560)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S6] → sending delta(kind=head bytes=1788) to S8@127.0.0.1:44909
[S4] not sending this round → trigger blocked (psi=0.726)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:44914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:44902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:44911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:44910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:44909
[S15] not sending this round → trigger blocked (psi=0.554)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:44903
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1794 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1788 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1794) from S7
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.969573)
[S3] loaded HEAD from S7 (vec_in norm=0.969573)
[S3] cosine check vs S7: cos=-0.0040
[S3] DROPPED delta from S7 (cos=-0.0040 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1797) from S13
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.288211)
[S10] loaded HEAD from S13 (vec_in norm=1.288211)
[S10] cosine check vs S13: cos=-0.0476
[S10] DROPPED delta from S13 (cos=-0.0476 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1794) from S10
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=0.968693)
[S9] loaded HEAD from S10 (vec_in norm=0.968693)
[S9] cosine check vs S10: cos=0.4970
[S9] BUFFERED delta from S10 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1788) from S6
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.894313)
[S8] loaded HEAD from S6 (vec_in norm=0.894313)
[S8] cosine check vs S6: cos=0.5779
[S8] BUFFERED delta from S6 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1800) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.268274)
[S8] loaded HEAD from S14 (vec_in norm=1.268274)
[S8] cosine check vs S14: cos=0.0192
[S8] BUFFERED delta from S14 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1799) from S2
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=0.956797)
[S15] loaded HEAD from S2 (vec_in norm=0.956797)
[S15] cosine check vs S2: cos=0.5824
[S15] BUFFERED delta from S2 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1795) from S16
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.853932)
[S14] loaded HEAD from S16 (vec_in norm=0.853932)
[S14] cosine check vs S16: cos=-0.0169
[S14] DROPPED delta from S16 (cos=-0.0169 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1801) from S3
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.044322)
[S2] loaded HEAD from S3 (vec_in norm=1.044322)
[S2] cosine check vs S3: cos=-0.0142
[S2] DROPPED delta from S3 (cos=-0.0142 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:44903
[S17] sending update (kind=head size=1794 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1794) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.252766)
[S3] loaded HEAD from S17 (vec_in norm=1.252766)
[S3] cosine check vs S17: cos=0.6882
[S3] BUFFERED delta from S17 (total buffered=1)
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=6 metric=0.4157 head_norm=0.727796
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.220656e-01
[S8] stored merged vector for next round verification (round=6)
[S8] DEBUG after merge:  round=6 metric=0.1575 head_norm=0.612415 delta_norm=0.422066
[S8] aggregate: ROLLBACK (f1_val pre=0.416 post=0.158 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=6 metric=0.3813 head_norm=0.652524
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.288939e-01
[S9] stored merged vector for next round verification (round=6)
[S9] DEBUG after merge:  round=6 metric=0.3810 head_norm=0.705781 delta_norm=0.428894
[S9] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=6 metric=0.6496 head_norm=1.044322
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.635127e-01
[S3] stored merged vector for next round verification (round=6)
[S3] DEBUG after merge:  round=6 metric=0.6553 head_norm=1.056017 delta_norm=0.463513
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=6 metric=0.4165 head_norm=0.884059
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.218123e-01
[S15] stored merged vector for next round verification (round=6)
[S15] DEBUG after merge:  round=6 metric=0.4165 head_norm=0.818893 delta_norm=0.421812
[S15] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=0.956797 cos_to_last_merge=0.9597 (last merge round=1)
[S2] round=7 local utility u=0.889526 metrics={'f1_val': 0.4160938496492347, 'auprc': 0.7767001122366274, 'loss_val': 1.010806752866103, 'psi': 0.5603363546841917}-{'f1_val': 0.1417771333885667, 'auprc': 0.7683941563237746, 'loss_val': 1.1190407385416912, 'psi': 0.3924239425626499}
[S3] START round=7 head_norm_before_train=1.056017 cos_to_last_merge=1.0000 (last merge round=6)
[S3] round=7 local utility u=0.204625 metrics={'f1_val': 0.7010108237857944, 'auprc': 0.9983160802686473, 'loss_val': 0.42644388638950703, 'psi': 0.8199329263789356}-{'f1_val': 0.649579316308615, 'auprc': 0.9973034029991864, 'loss_val': 0.524066127008567, 'psi': 0.7886689509848436}
[S4] START round=7 head_norm_before_train=1.442783 (no previous merge yet)
[S4] round=7 local utility u=0.000000 metrics={'f1_val': 0.6795420901615074, 'auprc': 0.6634495061625961, 'loss_val': 0.5777110466532281, 'psi': 0.6731050565619429}-{'f1_val': 0.6887368219190715, 'auprc': 0.7826779697144344, 'loss_val': 0.7419541857714541, 'psi': 0.7263132810372166}
[S5] START round=7 head_norm_before_train=0.947035 cos_to_last_merge=0.9918 (last merge round=5)
[S5] round=7 local utility u=0.091052 metrics={'f1_val': 0.41758505646266003, 'auprc': 0.8094382731738696, 'loss_val': 0.6562786324337129, 'psi': 0.5743263431471439}-{'f1_val': 0.4181926743009027, 'auprc': 0.7918084576350475, 'loss_val': 0.7891396969887003, 'psi': 0.5676389876345607}
[S6] START round=7 head_norm_before_train=0.894313 cos_to_last_merge=0.9509 (last merge round=1)
[S6] round=7 local utility u=0.119610 metrics={'f1_val': 0.4156481186360783, 'auprc': 0.661566713813493, 'loss_val': 0.9585494643016423, 'psi': 0.5140155567070441}-{'f1_val': 0.40615967502538863, 'auprc': 0.6460951663281215, 'loss_val': 1.0944234861027893, 'psi': 0.5021338715464818}
[S7] START round=7 head_norm_before_train=0.969573 cos_to_last_merge=0.9384 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.938
[S7] round=7 local utility u=0.000000 metrics={'f1_val': 0.3754075469366204, 'auprc': 0.785209143797288, 'loss_val': 0.8521983968769203, 'psi': 0.5393281856808874}-{'f1_val': 0.49946605295037266, 'auprc': 0.6687654481576184, 'loss_val': 0.8853787051895582, 'psi': 0.567185811033271}
[S8] START round=7 head_norm_before_train=0.612415 cos_to_last_merge=1.0000 (last merge round=6)
[S8] round=7 local utility u=0.897952 metrics={'f1_val': 0.7150331423137155, 'auprc': 0.7769407000936664, 'loss_val': 1.098538673602724, 'psi': 0.7397961654256959}-{'f1_val': 0.4156929677121941, 'auprc': 0.7768967366723254, 'loss_val': 1.0982690161376993, 'psi': 0.5601744752962466}
[S9] START round=7 head_norm_before_train=0.705781 cos_to_last_merge=1.0000 (last merge round=6)
[S9] round=7 local utility u=0.819625 metrics={'f1_val': 0.7011143398254496, 'auprc': 0.8620386500653071, 'loss_val': 0.6791464111661898, 'psi': 0.7654840639213926}-{'f1_val': 0.3813405653993305, 'auprc': 0.9754397131536375, 'loss_val': 0.7399579385310768, 'psi': 0.6189802245010533}
[S10] START round=7 head_norm_before_train=0.968693 cos_to_last_merge=0.9600 (last merge round=1)
[S10] round=7 local utility u=0.712741 metrics={'f1_val': 0.41652587907229816, 'auprc': 0.6605815286216923, 'loss_val': 1.0686555807780223, 'psi': 0.5141481388920558}-{'f1_val': 0.13862163754172394, 'auprc': 0.7763950122954275, 'loss_val': 1.1741523354097598, 'psi': 0.3937309874432054}
[S11] START round=7 head_norm_before_train=1.099604 cos_to_last_merge=0.9970 (last merge round=5)
[S11] round=7 local utility u=1.000000 metrics={'f1_val': 0.4229120744550575, 'auprc': 0.810637134261265, 'loss_val': 1.001141176849484, 'psi': 0.5780020983775405}-{'f1_val': 0.14041368337311058, 'auprc': 0.6094197858743378, 'loss_val': 1.148653325433113, 'psi': 0.32801612437360145}
[S13] START round=7 head_norm_before_train=1.288211 (no previous merge yet)
[S13] round=7 local utility u=0.000000 metrics={'f1_val': 0.37169029467602305, 'auprc': 0.6250450576207247, 'loss_val': 0.93041854796679, 'psi': 0.47303219985390377}-{'f1_val': 0.416200286011302, 'auprc': 0.660819609490771, 'loss_val': 1.0373889520272657, 'psi': 0.5140480154030895}
[S14] START round=7 head_norm_before_train=1.268274 (no previous merge yet)
[S14] round=7 local utility u=0.972731 metrics={'f1_val': 0.47067971767642025, 'auprc': 0.9620752692439393, 'loss_val': 1.080779105128198, 'psi': 0.6672379383034279}-{'f1_val': 0.17741681692920083, 'auprc': 0.9320464112588114, 'loss_val': 1.1765770385477061, 'psi': 0.47926865466104507}
[S15] START round=7 head_norm_before_train=0.818893 cos_to_last_merge=1.0000 (last merge round=6)
[S15] round=7 local utility u=0.064159 metrics={'f1_val': 0.4163758395072774, 'auprc': 0.7761775717857312, 'loss_val': 1.0641269535368683, 'psi': 0.560296532418659}-{'f1_val': 0.4164559415260807, 'auprc': 0.7602611233330425, 'loss_val': 1.1451753866971373, 'psi': 0.5539780142488654}
[S16] START round=7 head_norm_before_train=0.853932 cos_to_last_merge=0.9966 (last merge round=5)
[S16] round=7 local utility u=0.000000 metrics={'f1_val': 0.41715761842766974, 'auprc': 0.577104646767543, 'loss_val': 1.0205518858475888, 'psi': 0.4811364297636191}-{'f1_val': 0.4173069283424069, 'auprc': 0.6560928527546449, 'loss_val': 1.1109037147665335, 'psi': 0.5128212981073021}
[S17] START round=7 head_norm_before_train=1.252766 (no previous merge yet)
[S17] round=7 local utility u=0.360515 metrics={'f1_val': 0.39165840333776125, 'auprc': 0.8736627636266308, 'loss_val': 0.9143563043963229, 'psi': 0.5844601474533091}-{'f1_val': 0.3832811102772674, 'auprc': 0.7142128792639446, 'loss_val': 1.1067729521196803, 'psi': 0.5156538178719383}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:44916
[S2] not sending this round → trigger blocked (psi=0.560)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:44916
[S3] not sending this round → trigger blocked (psi=0.820)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:44905
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.514)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:44910
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.514)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.667)
[S15] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1801) from S8
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.645716)
[S9] loaded HEAD from S8 (vec_in norm=0.645716)
[S9] cosine check vs S8: cos=0.2423
[S9] BUFFERED delta from S8 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1800) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.852076)
[S5] loaded HEAD from S15 (vec_in norm=0.852076)
[S5] cosine check vs S15: cos=0.8150
[S5] BUFFERED delta from S15 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1794) from S11
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.134077)
[S15] loaded HEAD from S11 (vec_in norm=1.134077)
[S15] cosine check vs S11: cos=0.1107
[S15] BUFFERED delta from S11 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1802) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.023847)
[S16] loaded HEAD from S5 (vec_in norm=1.023847)
[S16] cosine check vs S5: cos=0.7485
[S16] BUFFERED delta from S5 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1797) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.793864)
[S16] loaded HEAD from S9 (vec_in norm=0.793864)
[S16] cosine check vs S9: cos=0.0269
[S16] BUFFERED delta from S9 (total buffered=2)
[S17] not sending this round → trigger blocked (psi=0.584)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=7 metric=0.4164 head_norm=0.852076
[S15] _apply_head_vector_avg (torch): Δ‖w‖=6.704870e-01
[S15] stored merged vector for next round verification (round=7)
[S15] DEBUG after merge:  round=7 metric=0.4166 head_norm=0.746009 delta_norm=0.670487
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=7 metric=0.7011 head_norm=0.793864
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.468803e-01
[S9] stored merged vector for next round verification (round=7)
[S9] DEBUG after merge:  round=7 metric=0.3810 head_norm=0.569107 delta_norm=0.446880
[S9] aggregate: ROLLBACK (f1_val pre=0.701 post=0.381 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=7 metric=0.4176 head_norm=1.023847
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.967640e-01
[S5] stored merged vector for next round verification (round=7)
[S5] DEBUG after merge:  round=7 metric=0.4175 head_norm=0.893912 delta_norm=0.296764
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=7 metric=0.4172 head_norm=0.892650
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.474818e-01
[S16] stored merged vector for next round verification (round=7)
[S16] DEBUG after merge:  round=7 metric=0.4172 head_norm=0.687262 delta_norm=0.347482
[S16] aggregate: ACCEPT kept=['S5', 'S9'] (k=2/2) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=0.987584 cos_to_last_merge=0.9488 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.949
[S2] round=8 local utility u=0.940552 metrics={'f1_val': 0.7065524162334019, 'auprc': 0.7745756204281511, 'loss_val': 0.8660797021351448, 'psi': 0.7337616979113016}-{'f1_val': 0.4160938496492347, 'auprc': 0.7767001122366274, 'loss_val': 1.010806752866103, 'psi': 0.5603363546841917}
[S3] START round=8 head_norm_before_train=1.133660 cos_to_last_merge=0.9944 (last merge round=6)
[S3] round=8 local utility u=0.033086 metrics={'f1_val': 0.7010108237857944, 'auprc': 0.9966900114099703, 'loss_val': 0.3553933423390666, 'psi': 0.8192824988354648}-{'f1_val': 0.7010108237857944, 'auprc': 0.9983160802686473, 'loss_val': 0.42644388638950703, 'psi': 0.8199329263789356}
[S4] START round=8 head_norm_before_train=1.494032 (no previous merge yet)
[S4] round=8 local utility u=0.038634 metrics={'f1_val': 0.6779265636492962, 'auprc': 0.6577539266950865, 'loss_val': 0.47366220831908107, 'psi': 0.6698575088676122}-{'f1_val': 0.6795420901615074, 'auprc': 0.6634495061625961, 'loss_val': 0.5777110466532281, 'psi': 0.6731050565619429}
[S5] START round=8 head_norm_before_train=0.893912 cos_to_last_merge=1.0000 (last merge round=7)
[S5] round=8 local utility u=0.727724 metrics={'f1_val': 0.7005685100046517, 'auprc': 0.7066272271447408, 'loss_val': 0.5902991654208725, 'psi': 0.7029919968606874}-{'f1_val': 0.41758505646266003, 'auprc': 0.8094382731738696, 'loss_val': 0.6562786324337129, 'psi': 0.5743263431471439}
[S6] START round=8 head_norm_before_train=0.924219 cos_to_last_merge=0.9398 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.940
[S6] round=8 local utility u=0.103566 metrics={'f1_val': 0.4156481186360783, 'auprc': 0.6916765543051915, 'loss_val': 0.8417467932031034, 'psi': 0.5260594929037237}-{'f1_val': 0.4156481186360783, 'auprc': 0.661566713813493, 'loss_val': 0.9585494643016423, 'psi': 0.5140155567070441}
[S7] START round=8 head_norm_before_train=1.043110 cos_to_last_merge=0.9067 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.907
[S7] round=8 local utility u=0.091340 metrics={'f1_val': 0.38056395833953094, 'auprc': 0.8396777284039858, 'loss_val': 0.8638623911413336, 'psi': 0.5642094663653129}-{'f1_val': 0.3754075469366204, 'auprc': 0.785209143797288, 'loss_val': 0.8521983968769203, 'psi': 0.5393281856808874}
[S8] START round=8 head_norm_before_train=0.645716 cos_to_last_merge=0.9938 (last merge round=6)
[S8] round=8 local utility u=0.071053 metrics={'f1_val': 0.714460606093301, 'auprc': 0.7750788019762239, 'loss_val': 0.9474111595847031, 'psi': 0.7387078844464701}-{'f1_val': 0.7150331423137155, 'auprc': 0.7769407000936664, 'loss_val': 1.098538673602724, 'psi': 0.7397961654256959}
[S9] START round=8 head_norm_before_train=0.569107 cos_to_last_merge=1.0000 (last merge round=7)
[S9] round=8 local utility u=0.201892 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.9958135455323804, 'loss_val': 0.6781896525995786, 'psi': 0.8191442188444578}-{'f1_val': 0.7011143398254496, 'auprc': 0.8620386500653071, 'loss_val': 0.6791464111661898, 'psi': 0.7654840639213926}
[S10] START round=8 head_norm_before_train=0.998724 cos_to_last_merge=0.9512 (last merge round=1)
[S10] round=8 local utility u=0.082751 metrics={'f1_val': 0.4169882880629132, 'auprc': 0.6590542950210587, 'loss_val': 0.9013455593933456, 'psi': 0.5138146908461714}-{'f1_val': 0.41652587907229816, 'auprc': 0.6605815286216923, 'loss_val': 1.0686555807780223, 'psi': 0.5141481388920558}
[S11] START round=8 head_norm_before_train=1.134077 cos_to_last_merge=0.9902 (last merge round=5)
[S11] round=8 local utility u=0.244651 metrics={'f1_val': 0.39651855440916606, 'auprc': 0.9632422012985177, 'loss_val': 0.8112931970412444, 'psi': 0.6232080131649067}-{'f1_val': 0.4229120744550575, 'auprc': 0.810637134261265, 'loss_val': 1.001141176849484, 'psi': 0.5780020983775405}
[S13] START round=8 head_norm_before_train=1.327540 (no previous merge yet)
[S13] round=8 local utility u=0.186087 metrics={'f1_val': 0.3732429036429986, 'auprc': 0.7159296730840372, 'loss_val': 0.8402141034320834, 'psi': 0.5103176114194141}-{'f1_val': 0.37169029467602305, 'auprc': 0.6250450576207247, 'loss_val': 0.93041854796679, 'psi': 0.47303219985390377}
[S14] START round=8 head_norm_before_train=1.299968 (no previous merge yet)
[S14] round=8 local utility u=0.000000 metrics={'f1_val': 0.399195519517617, 'auprc': 0.9701018652711553, 'loss_val': 0.8713843259836143, 'psi': 0.6275580578190323}-{'f1_val': 0.47067971767642025, 'auprc': 0.9620752692439393, 'loss_val': 1.080779105128198, 'psi': 0.6672379383034279}
[S15] START round=8 head_norm_before_train=0.746009 cos_to_last_merge=1.0000 (last merge round=7)
[S15] round=8 local utility u=0.000000 metrics={'f1_val': 0.416567672447929, 'auprc': 0.7391918501645234, 'loss_val': 1.0404910812984132, 'psi': 0.5456173435345668}-{'f1_val': 0.4163758395072774, 'auprc': 0.7761775717857312, 'loss_val': 1.0641269535368683, 'psi': 0.560296532418659}
[S16] START round=8 head_norm_before_train=0.687262 cos_to_last_merge=1.0000 (last merge round=7)
[S16] round=8 local utility u=0.000000 metrics={'f1_val': 0.37026538244513546, 'auprc': 0.4849044033053418, 'loss_val': 1.050130537895242, 'psi': 0.416120990789218}-{'f1_val': 0.41715761842766974, 'auprc': 0.577104646767543, 'loss_val': 1.0205518858475888, 'psi': 0.4811364297636191}
[S17] START round=8 head_norm_before_train=1.298642 (no previous merge yet)
[S17] round=8 local utility u=0.164068 metrics={'f1_val': 0.3898711714035321, 'auprc': 0.9466624176786947, 'loss_val': 0.7944949032916998, 'psi': 0.6125876699135971}-{'f1_val': 0.39165840333776125, 'auprc': 0.8736627636266308, 'loss_val': 0.9143563043963229, 'psi': 0.5844601474533091}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S2] → sending delta(kind=head bytes=1792) to S15@127.0.0.1:44915
[S5] not sending this round → trigger blocked (psi=0.703)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:44910
[S8] not sending this round → trigger blocked (psi=0.739)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:44902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S6] → sending delta(kind=head bytes=1788) to S8@127.0.0.1:44909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:44912
[S9] not sending this round → trigger blocked (psi=0.819)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:44903
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.623)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:44911
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1788 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1792 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1797) from S10
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.034165)
[S9] loaded HEAD from S10 (vec_in norm=1.034165)
[S9] cosine check vs S10: cos=0.5712
[S9] BUFFERED delta from S10 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1788) from S6
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.964080)
[S8] loaded HEAD from S6 (vec_in norm=0.964080)
[S8] cosine check vs S6: cos=0.6450
[S8] BUFFERED delta from S6 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1800) from S13
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.365269)
[S10] loaded HEAD from S13 (vec_in norm=1.365269)
[S10] cosine check vs S13: cos=-0.0651
[S10] DROPPED delta from S13 (cos=-0.0651 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1792) from S2
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.029128)
[S15] loaded HEAD from S2 (vec_in norm=1.029128)
[S15] cosine check vs S2: cos=0.5900
[S15] BUFFERED delta from S2 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1801) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.545020)
[S11] loaded HEAD from S4 (vec_in norm=1.545020)
[S11] cosine check vs S4: cos=0.9037
[S11] BUFFERED delta from S4 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1798) from S3
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.204713)
[S2] loaded HEAD from S3 (vec_in norm=1.204713)
[S2] cosine check vs S3: cos=0.0158
[S2] BUFFERED delta from S3 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1798) from S7
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.096141)
[S3] loaded HEAD from S7 (vec_in norm=1.096141)
[S3] cosine check vs S7: cos=-0.0159
[S3] DROPPED delta from S7 (cos=-0.0159 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:44903
[S17] sending update (kind=head size=1795 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1795) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.345574)
[S3] loaded HEAD from S17 (vec_in norm=1.345574)
[S3] cosine check vs S17: cos=0.8615
[S3] BUFFERED delta from S17 (total buffered=1)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=8 metric=0.3965 head_norm=1.181621
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.477441e-01
[S11] stored merged vector for next round verification (round=8)
[S11] DEBUG after merge:  round=8 metric=0.3965 head_norm=1.330688 delta_norm=0.347744
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=8 metric=0.7014 head_norm=0.669857
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.262559e-01
[S9] stored merged vector for next round verification (round=8)
[S9] DEBUG after merge:  round=8 metric=0.7014 head_norm=0.759874 delta_norm=0.426256
[S9] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=8 metric=0.4166 head_norm=0.777494
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.240847e-01
[S15] stored merged vector for next round verification (round=8)
[S15] DEBUG after merge:  round=8 metric=0.4164 head_norm=0.807436 delta_norm=0.424085
[S15] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=8 metric=0.7145 head_norm=0.695284
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.701800e-01
[S8] stored merged vector for next round verification (round=8)
[S8] DEBUG after merge:  round=8 metric=0.7145 head_norm=0.754588 delta_norm=0.370180
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=8 metric=0.7066 head_norm=1.029128
[S2] _apply_head_vector_avg (torch): Δ‖w‖=7.860223e-01
[S2] stored merged vector for next round verification (round=8)
[S2] DEBUG after merge:  round=8 metric=0.7146 head_norm=0.798365 delta_norm=0.786022
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=8 metric=0.7010 head_norm=1.204713
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.424227e-01
[S3] stored merged vector for next round verification (round=8)
[S3] DEBUG after merge:  round=8 metric=0.7010 head_norm=1.230324 delta_norm=0.342423
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=0.798365 cos_to_last_merge=1.0000 (last merge round=8)
[S2] round=9 local utility u=0.032943 metrics={'f1_val': 0.7147885550663329, 'auprc': 0.7781449919657136, 'loss_val': 0.8603184782022198, 'psi': 0.7401311298260852}-{'f1_val': 0.7065524162334019, 'auprc': 0.7745756204281511, 'loss_val': 0.8660797021351448, 'psi': 0.7337616979113016}
[S3] START round=9 head_norm_before_train=1.230324 cos_to_last_merge=1.0000 (last merge round=8)
[S3] round=9 local utility u=0.000000 metrics={'f1_val': 0.7003512381127298, 'auprc': 0.9983734036427939, 'loss_val': 0.3712450855165631, 'psi': 0.8195601043247555}-{'f1_val': 0.7010108237857944, 'auprc': 0.9966900114099703, 'loss_val': 0.3553933423390666, 'psi': 0.8192824988354648}
[S4] START round=9 head_norm_before_train=1.545020 (no previous merge yet)
[S4] round=9 local utility u=0.007386 metrics={'f1_val': 0.6762157886733121, 'auprc': 0.6502591317966442, 'loss_val': 0.42614073491354665, 'psi': 0.665833125922645}-{'f1_val': 0.6779265636492962, 'auprc': 0.6577539266950865, 'loss_val': 0.47366220831908107, 'psi': 0.6698575088676122}
[S5] START round=9 head_norm_before_train=0.967533 cos_to_last_merge=0.9938 (last merge round=7)
[S5] round=9 local utility u=0.231314 metrics={'f1_val': 0.7015262981553677, 'auprc': 0.8281349143560355, 'loss_val': 0.49794127157896717, 'psi': 0.7521697446356348}-{'f1_val': 0.7005685100046517, 'auprc': 0.7066272271447408, 'loss_val': 0.5902991654208725, 'psi': 0.7029919968606874}
[S6] START round=9 head_norm_before_train=0.964080 cos_to_last_merge=0.9251 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.925
[S6] round=9 local utility u=0.154072 metrics={'f1_val': 0.41705570454086727, 'auprc': 0.7614000366220349, 'loss_val': 0.7512186385831985, 'psi': 0.5547934373733343}-{'f1_val': 0.4156481186360783, 'auprc': 0.6916765543051915, 'loss_val': 0.8417467932031034, 'psi': 0.5260594929037237}
[S7] START round=9 head_norm_before_train=1.096141 cos_to_last_merge=0.8849 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.885
[S7] round=9 local utility u=0.005724 metrics={'f1_val': 0.41473518177997515, 'auprc': 0.7821679699624859, 'loss_val': 0.8849115022334347, 'psi': 0.5617082970529794}-{'f1_val': 0.38056395833953094, 'auprc': 0.8396777284039858, 'loss_val': 0.8638623911413336, 'psi': 0.5642094663653129}
[S8] START round=9 head_norm_before_train=0.754588 cos_to_last_merge=1.0000 (last merge round=8)
[S8] round=9 local utility u=0.000000 metrics={'f1_val': 0.3729316501988709, 'auprc': 0.6547835542347502, 'loss_val': 0.9030936496016422, 'psi': 0.4856724118132226}-{'f1_val': 0.714460606093301, 'auprc': 0.7750788019762239, 'loss_val': 0.9474111595847031, 'psi': 0.7387078844464701}
[S9] START round=9 head_norm_before_train=0.759874 cos_to_last_merge=1.0000 (last merge round=8)
[S9] round=9 local utility u=0.056094 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.9955234237678452, 'loss_val': 0.5651322361019687, 'psi': 0.8190281701386436}-{'f1_val': 0.7013646677191758, 'auprc': 0.9958135455323804, 'loss_val': 0.6781896525995786, 'psi': 0.8191442188444578}
[S10] START round=9 head_norm_before_train=1.034165 cos_to_last_merge=0.9409 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.941
[S10] round=9 local utility u=0.923299 metrics={'f1_val': 0.5946944317999948, 'auprc': 0.8643453327953659, 'loss_val': 0.7368575745703133, 'psi': 0.7025547921981432}-{'f1_val': 0.4169882880629132, 'auprc': 0.6590542950210587, 'loss_val': 0.9013455593933456, 'psi': 0.5138146908461714}
[S11] START round=9 head_norm_before_train=1.330688 cos_to_last_merge=1.0000 (last merge round=8)
[S11] round=9 local utility u=1.000000 metrics={'f1_val': 0.701890640953942, 'auprc': 0.9930966837086405, 'loss_val': 0.6721733026088385, 'psi': 0.8183730580558215}-{'f1_val': 0.39651855440916606, 'auprc': 0.9632422012985177, 'loss_val': 0.8112931970412444, 'psi': 0.6232080131649067}
[S13] START round=9 head_norm_before_train=1.365269 (no previous merge yet)
[S13] round=9 local utility u=1.000000 metrics={'f1_val': 0.7111117215716545, 'auprc': 0.7449521794909412, 'loss_val': 0.6687317877309814, 'psi': 0.7246479047393692}-{'f1_val': 0.3732429036429986, 'auprc': 0.7159296730840372, 'loss_val': 0.8402141034320834, 'psi': 0.5103176114194141}
[S14] START round=9 head_norm_before_train=1.344146 (no previous merge yet)
[S14] round=9 local utility u=1.000000 metrics={'f1_val': 0.7473882822561821, 'auprc': 0.9957611162451021, 'loss_val': 0.6459092342534878, 'psi': 0.8467374158517502}-{'f1_val': 0.399195519517617, 'auprc': 0.9701018652711553, 'loss_val': 0.8713843259836143, 'psi': 0.6275580578190323}
[S15] START round=9 head_norm_before_train=0.807436 cos_to_last_merge=1.0000 (last merge round=8)
[S15] round=9 local utility u=0.000000 metrics={'f1_val': 0.37276400931375114, 'auprc': 0.5733813530283953, 'loss_val': 0.9704227989026871, 'psi': 0.45301094679960885}-{'f1_val': 0.416567672447929, 'auprc': 0.7391918501645234, 'loss_val': 1.0404910812984132, 'psi': 0.5456173435345668}
[S16] START round=9 head_norm_before_train=0.726088 cos_to_last_merge=0.9931 (last merge round=7)
[S16] round=9 local utility u=0.233806 metrics={'f1_val': 0.34786954271723813, 'auprc': 0.6936919129181203, 'loss_val': 1.0745053058614913, 'psi': 0.48619849079759103}-{'f1_val': 0.37026538244513546, 'auprc': 0.4849044033053418, 'loss_val': 1.050130537895242, 'psi': 0.416120990789218}
[S17] START round=9 head_norm_before_train=1.345574 (no previous merge yet)
[S17] round=9 local utility u=0.000000 metrics={'f1_val': 0.43126300834231696, 'auprc': 0.8736566825136562, 'loss_val': 0.9139097270544446, 'psi': 0.6082204780108527}-{'f1_val': 0.3898711714035321, 'auprc': 0.9466624176786947, 'loss_val': 0.7944949032916998, 'psi': 0.6125876699135971}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:44909
[S4] not sending this round → trigger blocked (psi=0.666)
[S6] not sending this round → trigger blocked (psi=0.555)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:44916
[S10] not sending this round → trigger blocked (psi=0.703)
[S7] not sending this round → trigger blocked (psi=0.562)
[S2] not sending this round → trigger blocked (psi=0.740)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:44914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S5] → sending delta(kind=head bytes=1791) to S16@127.0.0.1:44916
[S13] not sending this round → trigger blocked (psi=0.725)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:44915
[S11] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1791 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.395851)
[S8] loaded HEAD from S14 (vec_in norm=1.395851)
[S8] cosine check vs S14: cos=0.1554
[S8] BUFFERED delta from S14 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1796) from S11
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.372083)
[S15] loaded HEAD from S11 (vec_in norm=1.372083)
[S15] cosine check vs S11: cos=0.4449
[S15] BUFFERED delta from S11 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1797) from S16
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.773646)
[S14] loaded HEAD from S16 (vec_in norm=0.773646)
[S14] cosine check vs S16: cos=-0.0597
[S14] DROPPED delta from S16 (cos=-0.0597 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1791) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.039949)
[S16] loaded HEAD from S5 (vec_in norm=1.039949)
[S16] cosine check vs S5: cos=0.7008
[S16] BUFFERED delta from S5 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1796) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.851040)
[S16] loaded HEAD from S9 (vec_in norm=0.851040)
[S16] cosine check vs S9: cos=0.2684
[S16] BUFFERED delta from S9 (total buffered=2)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=9 metric=0.3729 head_norm=0.799676
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.484892e-01
[S8] stored merged vector for next round verification (round=9)
[S8] DEBUG after merge:  round=9 metric=0.3914 head_norm=0.856566 delta_norm=0.748489
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=9 metric=0.3479 head_norm=0.773646
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.611171e-01
[S16] stored merged vector for next round verification (round=9)
[S16] DEBUG after merge:  round=9 metric=0.3479 head_norm=0.662164 delta_norm=0.261117
[S16] aggregate: ACCEPT kept=['S5', 'S9'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=9 metric=0.3728 head_norm=0.842532
[S15] _apply_head_vector_avg (torch): Δ‖w‖=6.252666e-01
[S15] stored merged vector for next round verification (round=9)
[S15] DEBUG after merge:  round=9 metric=0.4450 head_norm=0.951461 delta_norm=0.625267
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=0.834872 cos_to_last_merge=0.9950 (last merge round=8)
[S2] round=10 local utility u=0.000000 metrics={'f1_val': 0.7019912318095572, 'auprc': 0.6990589756803162, 'loss_val': 0.6778827892589137, 'psi': 0.7008183293578608}-{'f1_val': 0.7147885550663329, 'auprc': 0.7781449919657136, 'loss_val': 0.8603184782022198, 'psi': 0.7401311298260852}
[S3] START round=10 head_norm_before_train=1.275606 cos_to_last_merge=0.9982 (last merge round=8)
[S3] round=10 local utility u=0.016348 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.999226697626367, 'loss_val': 0.34308685395635274, 'psi': 0.8200992548497477}-{'f1_val': 0.7003512381127298, 'auprc': 0.9983734036427939, 'loss_val': 0.3712450855165631, 'psi': 0.8195601043247555}
[S4] START round=10 head_norm_before_train=1.591185 (no previous merge yet)
[S4] round=10 local utility u=0.057783 metrics={'f1_val': 0.6858999273453107, 'auprc': 0.6560752176072797, 'loss_val': 0.3861286950931186, 'psi': 0.6739700434500983}-{'f1_val': 0.6762157886733121, 'auprc': 0.6502591317966442, 'loss_val': 0.42614073491354665, 'psi': 0.665833125922645}
[S5] START round=10 head_norm_before_train=1.039949 cos_to_last_merge=0.9820 (last merge round=7)
[S5] round=10 local utility u=0.102364 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.856311764597918, 'loss_val': 0.3722410868007078, 'psi': 0.7628901622426356}-{'f1_val': 0.7015262981553677, 'auprc': 0.8281349143560355, 'loss_val': 0.49794127157896717, 'psi': 0.7521697446356348}
[S6] START round=10 head_norm_before_train=1.004970 cos_to_last_merge=0.9089 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.909
[S6] round=10 local utility u=0.135761 metrics={'f1_val': 0.4168551858772006, 'auprc': 0.8188965665955711, 'loss_val': 0.6509837413729519, 'psi': 0.5776717381645489}-{'f1_val': 0.41705570454086727, 'auprc': 0.7614000366220349, 'loss_val': 0.7512186385831985, 'psi': 0.5547934373733343}
[S7] START round=10 head_norm_before_train=1.134502 cos_to_last_merge=0.8720 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.872
[S7] round=10 local utility u=0.421457 metrics={'f1_val': 0.5287068798025881, 'auprc': 0.7920500099769912, 'loss_val': 0.7554737982002505, 'psi': 0.6340441318723493}-{'f1_val': 0.41473518177997515, 'auprc': 0.7821679699624859, 'loss_val': 0.8849115022334347, 'psi': 0.5617082970529794}
[S8] START round=10 head_norm_before_train=0.856566 cos_to_last_merge=1.0000 (last merge round=9)
[S8] round=10 local utility u=1.000000 metrics={'f1_val': 0.7144597852518105, 'auprc': 0.9919092115793089, 'loss_val': 0.8988366158671154, 'psi': 0.8254395557828098}-{'f1_val': 0.3729316501988709, 'auprc': 0.6547835542347502, 'loss_val': 0.9030936496016422, 'psi': 0.4856724118132226}
[S9] START round=10 head_norm_before_train=0.851040 cos_to_last_merge=0.9756 (last merge round=8)
[S9] round=10 local utility u=0.074531 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.9967879135145086, 'loss_val': 0.41986279390174663, 'psi': 0.8195339660373089}-{'f1_val': 0.7013646677191758, 'auprc': 0.9955234237678452, 'loss_val': 0.5651322361019687, 'psi': 0.8190281701386436}
[S10] START round=10 head_norm_before_train=1.083471 cos_to_last_merge=0.9269 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.927
[S10] round=10 local utility u=0.566914 metrics={'f1_val': 0.7001456920165336, 'auprc': 0.9789018965402461, 'loss_val': 0.5794066788533473, 'psi': 0.8116481738260186}-{'f1_val': 0.5946944317999948, 'auprc': 0.8643453327953659, 'loss_val': 0.7368575745703133, 'psi': 0.7025547921981432}
[S11] START round=10 head_norm_before_train=1.372083 cos_to_last_merge=0.9977 (last merge round=8)
[S11] round=10 local utility u=0.096931 metrics={'f1_val': 0.7017589383281313, 'auprc': 0.9974307591693314, 'loss_val': 0.4905232250185663, 'psi': 0.8200276666646114}-{'f1_val': 0.701890640953942, 'auprc': 0.9930966837086405, 'loss_val': 0.6721733026088385, 'psi': 0.8183730580558215}
[S13] START round=10 head_norm_before_train=1.398298 (no previous merge yet)
[S13] round=10 local utility u=0.000000 metrics={'f1_val': 0.4250330484108363, 'auprc': 0.619222735139587, 'loss_val': 0.8191747872596884, 'psi': 0.5027089231023366}-{'f1_val': 0.7111117215716545, 'auprc': 0.7449521794909412, 'loss_val': 0.6687317877309814, 'psi': 0.7246479047393692}
[S14] START round=10 head_norm_before_train=1.395851 (no previous merge yet)
[S14] round=10 local utility u=0.644140 metrics={'f1_val': 0.9284698698241556, 'auprc': 0.9957652507816697, 'loss_val': 0.4441307268992978, 'psi': 0.9553880222071612}-{'f1_val': 0.7473882822561821, 'auprc': 0.9957611162451021, 'loss_val': 0.6459092342534878, 'psi': 0.8467374158517502}
[S15] START round=10 head_norm_before_train=0.951461 cos_to_last_merge=1.0000 (last merge round=9)
[S15] round=10 local utility u=0.235364 metrics={'f1_val': 0.43748228581968224, 'auprc': 0.589971951317957, 'loss_val': 0.9377753009494109, 'psi': 0.49847815201899215}-{'f1_val': 0.37276400931375114, 'auprc': 0.5733813530283953, 'loss_val': 0.9704227989026871, 'psi': 0.45301094679960885}
[S16] START round=10 head_norm_before_train=0.662164 cos_to_last_merge=1.0000 (last merge round=9)
[S16] round=10 local utility u=0.034451 metrics={'f1_val': 0.3474004586769864, 'auprc': 0.7176088818003501, 'loss_val': 1.0745397933986065, 'psi': 0.49548382792633183}-{'f1_val': 0.34786954271723813, 'auprc': 0.6936919129181203, 'loss_val': 1.0745053058614913, 'psi': 0.48619849079759103}
[S17] START round=10 head_norm_before_train=1.384119 (no previous merge yet)
[S17] round=10 local utility u=0.000000 metrics={'f1_val': 0.356128824162089, 'auprc': 0.8375179634775834, 'loss_val': 1.0333882019527263, 'psi': 0.5486844798882868}-{'f1_val': 0.43126300834231696, 'auprc': 0.8736566825136562, 'loss_val': 0.9139097270544446, 'psi': 0.6082204780108527}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:44910
[S9] not sending this round → trigger blocked (psi=0.820)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:44902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:44912
[S5] not sending this round → trigger blocked (psi=0.763)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:44903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:44909
[S11] not sending this round → trigger blocked (psi=0.820)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S15] → sending delta(kind=head bytes=1791) to S5@127.0.0.1:44905
[S14] not sending this round → trigger blocked (psi=0.955)
[S16] not sending this round → trigger blocked (psi=0.495)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:44910
[S15] sending update (kind=head size=1791 to 1 peers)
[S8] sending update (kind=head size=1793 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1793) from S8
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.889166)
[S9] loaded HEAD from S8 (vec_in norm=0.889166)
[S9] cosine check vs S8: cos=0.0772
[S9] BUFFERED delta from S8 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1791) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.975743)
[S5] loaded HEAD from S15 (vec_in norm=0.975743)
[S5] cosine check vs S15: cos=0.4415
[S5] BUFFERED delta from S15 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1795) from S6
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.047614)
[S8] loaded HEAD from S6 (vec_in norm=1.047614)
[S8] cosine check vs S6: cos=0.4108
[S8] BUFFERED delta from S6 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1799) from S7
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.174776)
[S3] loaded HEAD from S7 (vec_in norm=1.174776)
[S3] cosine check vs S7: cos=-0.0187
[S3] DROPPED delta from S7 (cos=-0.0187 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1801) from S3
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.331350)
[S2] loaded HEAD from S3 (vec_in norm=1.331350)
[S2] cosine check vs S3: cos=0.6853
[S2] BUFFERED delta from S3 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1796) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.627519)
[S11] loaded HEAD from S4 (vec_in norm=1.627519)
[S11] cosine check vs S4: cos=0.9520
[S11] BUFFERED delta from S4 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1799) from S10
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.141781)
[S9] loaded HEAD from S10 (vec_in norm=1.141781)
[S9] cosine check vs S10: cos=0.7837
[S9] BUFFERED delta from S10 (total buffered=2)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=10 metric=0.7018 head_norm=1.423456
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.568667e-01
[S11] stored merged vector for next round verification (round=10)
[S11] DEBUG after merge:  round=10 metric=0.7020 head_norm=1.507164 delta_norm=0.256867
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.439 → S15@127.0.0.1:44915
[S13] ⇄ pheromone p=0.362 → S10@127.0.0.1:44911
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=10 metric=0.7014 head_norm=0.958686
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.589003e-01
[S9] stored merged vector for next round verification (round=10)
[S9] DEBUG after merge:  round=10 metric=0.7014 head_norm=0.768530 delta_norm=0.358900
[S9] aggregate: ACCEPT kept=['S8', 'S10'] (k=2/2) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.348 → S16@127.0.0.1:44916
[S14] ⇄ pheromone p=0.551 → S8@127.0.0.1:44909
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=10 metric=0.7020 head_norm=0.889219
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.848969e-01
[S2] stored merged vector for next round verification (round=10)
[S2] DEBUG after merge:  round=10 metric=0.7019 head_norm=1.022974 delta_norm=0.484897
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.337 → S15@127.0.0.1:44915
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=10 metric=0.7006 head_norm=1.101777
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.515230e-01
[S5] stored merged vector for next round verification (round=10)
[S5] DEBUG after merge:  round=10 metric=0.7006 head_norm=0.882505 delta_norm=0.551523
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.319 → S16@127.0.0.1:44916
[S4] ⇄ pheromone p=0.248 → S11@127.0.0.1:44912
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=10 metric=0.7145 head_norm=0.889166
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.298268e-01
[S8] stored merged vector for next round verification (round=10)
[S8] DEBUG after merge:  round=10 metric=0.3727 head_norm=0.814457 delta_norm=0.529827
[S8] aggregate: ROLLBACK (f1_val pre=0.714 post=0.373 tol_abs=0.005 tol_rel=0.0)
[S8] ⇄ pheromone p=0.499 → S9@127.0.0.1:44910
[S6] ⇄ pheromone p=0.268 → S8@127.0.0.1:44909
[S7] ⇄ pheromone p=0.281 → S3@127.0.0.1:44903
[S3] ⇄ pheromone p=0.265 → S2@127.0.0.1:44902
[S15] ⇄ pheromone p=0.234 → S5@127.0.0.1:44905
[S10] ⇄ pheromone p=0.476 → S9@127.0.0.1:44910
[S16] ⇄ pheromone p=0.231 → S14@127.0.0.1:44914
[S17] ⇄ pheromone p=0.242 → S3@127.0.0.1:44903
[S2] START round=11 head_norm_before_train=1.022974 cos_to_last_merge=1.0000 (last merge round=10)
[S2] round=11 local utility u=0.092686 metrics={'f1_val': 0.7016506089258296, 'auprc': 0.7497480474827527, 'loss_val': 0.6425335545019094, 'psi': 0.7208895843485988}-{'f1_val': 0.7019912318095572, 'auprc': 0.6990589756803162, 'loss_val': 0.6778827892589137, 'psi': 0.7008183293578608}
[S3] START round=11 head_norm_before_train=1.331350 cos_to_last_merge=0.9930 (last merge round=8)
[S3] round=11 local utility u=0.022852 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9995838018614577, 'loss_val': 0.2989056586109614, 'psi': 0.8202872429857628}-{'f1_val': 0.7006809596653347, 'auprc': 0.999226697626367, 'loss_val': 0.34308685395635274, 'psi': 0.8200992548497477}
[S4] START round=11 head_norm_before_train=1.627519 (no previous merge yet)
[S4] round=11 local utility u=0.000000 metrics={'f1_val': 0.6756351979443518, 'auprc': 0.6601212852082143, 'loss_val': 0.37269101170204316, 'psi': 0.6694296328498968}-{'f1_val': 0.6858999273453107, 'auprc': 0.6560752176072797, 'loss_val': 0.3861286950931186, 'psi': 0.6739700434500983}
[S5] START round=11 head_norm_before_train=0.882505 cos_to_last_merge=1.0000 (last merge round=10)
[S5] round=11 local utility u=0.172605 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9840444635496858, 'loss_val': 0.4102244294869377, 'psi': 0.8139828210174789}-{'f1_val': 0.7006090940057808, 'auprc': 0.856311764597918, 'loss_val': 0.3722410868007078, 'psi': 0.7628901622426356}
[S6] START round=11 head_norm_before_train=1.047614 cos_to_last_merge=0.8937 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.894
[S6] round=11 local utility u=0.010380 metrics={'f1_val': 0.4244357493914819, 'auprc': 0.7854411330721272, 'loss_val': 0.5753403747336452, 'psi': 0.56883790286374}-{'f1_val': 0.4168551858772006, 'auprc': 0.8188965665955711, 'loss_val': 0.6509837413729519, 'psi': 0.5776717381645489}
[S7] START round=11 head_norm_before_train=1.174776 cos_to_last_merge=0.8629 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.863
[S7] round=11 local utility u=0.000000 metrics={'f1_val': 0.5258659660581473, 'auprc': 0.785647480502377, 'loss_val': 0.7810966183253325, 'psi': 0.6297785718358392}-{'f1_val': 0.5287068798025881, 'auprc': 0.7920500099769912, 'loss_val': 0.7554737982002505, 'psi': 0.6340441318723493}
[S8] START round=11 head_norm_before_train=0.814457 cos_to_last_merge=1.0000 (last merge round=10)
[S8] round=11 local utility u=0.000000 metrics={'f1_val': 0.37266438550987346, 'auprc': 0.9908697949787797, 'loss_val': 0.7962462237906659, 'psi': 0.619946549297436}-{'f1_val': 0.7144597852518105, 'auprc': 0.9919092115793089, 'loss_val': 0.8988366158671154, 'psi': 0.8254395557828098}
[S9] START round=11 head_norm_before_train=0.768530 cos_to_last_merge=1.0000 (last merge round=10)
[S9] round=11 local utility u=0.000000 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.939777735730561, 'loss_val': 0.4582413849297821, 'psi': 0.7966853844167625}-{'f1_val': 0.7013646677191758, 'auprc': 0.9967879135145086, 'loss_val': 0.41986279390174663, 'psi': 0.8195339660373089}
[S10] START round=11 head_norm_before_train=1.141781 cos_to_last_merge=0.9115 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.911
[S10] round=11 local utility u=0.099360 metrics={'f1_val': 0.7002428651507397, 'auprc': 0.9972498993476229, 'loss_val': 0.43631347066614246, 'psi': 0.8190456788294931}-{'f1_val': 0.7001456920165336, 'auprc': 0.9789018965402461, 'loss_val': 0.5794066788533473, 'psi': 0.8116481738260186}
[S11] START round=11 head_norm_before_train=1.507164 cos_to_last_merge=1.0000 (last merge round=10)
[S11] round=11 local utility u=0.041729 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9970178165329604, 'loss_val': 0.405433047712388, 'psi': 0.819823214365339}-{'f1_val': 0.7017589383281313, 'auprc': 0.9974307591693314, 'loss_val': 0.4905232250185663, 'psi': 0.8200276666646114}
[S13] START round=11 head_norm_before_train=1.428972 (no previous merge yet)
[S13] round=11 local utility u=1.000000 metrics={'f1_val': 0.7121355239164153, 'auprc': 0.7636743388765715, 'loss_val': 0.574490318841664, 'psi': 0.7327510499004778}-{'f1_val': 0.4250330484108363, 'auprc': 0.619222735139587, 'loss_val': 0.8191747872596884, 'psi': 0.5027089231023366}
[S14] START round=11 head_norm_before_train=1.449846 (no previous merge yet)
[S14] round=11 local utility u=0.100022 metrics={'f1_val': 0.9297714992301829, 'auprc': 0.9971586800082581, 'loss_val': 0.25607762991295513, 'psi': 0.956726371541413}-{'f1_val': 0.9284698698241556, 'auprc': 0.9957652507816697, 'loss_val': 0.4441307268992978, 'psi': 0.9553880222071612}
[S15] START round=11 head_norm_before_train=0.975743 cos_to_last_merge=0.9948 (last merge round=9)
[S15] round=11 local utility u=0.000000 metrics={'f1_val': 0.389033609831846, 'auprc': 0.6040342661520448, 'loss_val': 0.8294789780296169, 'psi': 0.4750338723599255}-{'f1_val': 0.43748228581968224, 'auprc': 0.589971951317957, 'loss_val': 0.9377753009494109, 'psi': 0.49847815201899215}
[S16] START round=11 head_norm_before_train=0.705289 cos_to_last_merge=0.9939 (last merge round=9)
[S16] round=11 local utility u=0.183139 metrics={'f1_val': 0.3988455245477248, 'auprc': 0.7227479367397642, 'loss_val': 1.0323487739651311, 'psi': 0.5284064894245406}-{'f1_val': 0.3474004586769864, 'auprc': 0.7176088818003501, 'loss_val': 1.0745397933986065, 'psi': 0.49548382792633183}
[S17] START round=11 head_norm_before_train=1.407613 (no previous merge yet)
[S17] round=11 local utility u=0.000000 metrics={'f1_val': 0.34539292433449387, 'auprc': 0.8323224335057106, 'loss_val': 1.014899152779707, 'psi': 0.5401647280029805}-{'f1_val': 0.356128824162089, 'auprc': 0.8375179634775834, 'loss_val': 1.0333882019527263, 'psi': 0.5486844798882868}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:44911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S14] → sending delta(kind=head bytes=1808) to S8@127.0.0.1:44909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:44914
[S3] not sending this round → trigger blocked (psi=0.820)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:44915
[S10] not sending this round → trigger blocked (psi=0.819)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.569)
[S2] sending update (kind=head size=1793 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1808 to 1 peers)
[S5] sending update (kind=head size=1804 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1800) from S13
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.457910)
[S10] loaded HEAD from S13 (vec_in norm=1.457910)
[S10] cosine check vs S13: cos=-0.0839
[S10] DROPPED delta from S13 (cos=-0.0839 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1801) from S11
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.554941)
[S15] loaded HEAD from S11 (vec_in norm=1.554941)
[S15] cosine check vs S11: cos=0.8615
[S15] BUFFERED delta from S11 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1804) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.943569)
[S16] loaded HEAD from S5 (vec_in norm=0.943569)
[S16] cosine check vs S5: cos=0.6004
[S16] BUFFERED delta from S5 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1808) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.497423)
[S8] loaded HEAD from S14 (vec_in norm=1.497423)
[S8] cosine check vs S14: cos=0.4194
[S8] BUFFERED delta from S14 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1794) from S16
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.760598)
[S14] loaded HEAD from S16 (vec_in norm=0.760598)
[S14] cosine check vs S16: cos=-0.0584
[S14] DROPPED delta from S16 (cos=-0.0584 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1793) from S2
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.062852)
[S15] loaded HEAD from S2 (vec_in norm=1.062852)
[S15] cosine check vs S2: cos=0.1580
[S15] BUFFERED delta from S2 (total buffered=2)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=11 metric=0.3727 head_norm=0.866377
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.900629e-01
[S8] stored merged vector for next round verification (round=11)
[S8] DEBUG after merge:  round=11 metric=0.5884 head_norm=1.010077 delta_norm=0.690063
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=11 metric=0.3988 head_norm=0.760598
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.895618e-01
[S16] stored merged vector for next round verification (round=11)
[S16] DEBUG after merge:  round=11 metric=0.4279 head_norm=0.763320 delta_norm=0.389562
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=11 metric=0.3890 head_norm=1.011876
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.124343e-01
[S15] stored merged vector for next round verification (round=11)
[S15] DEBUG after merge:  round=11 metric=0.3844 head_norm=0.927533 delta_norm=0.312434
[S15] aggregate: ACCEPT kept=['S11', 'S2'] (k=2/2) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.062852 cos_to_last_merge=0.9950 (last merge round=10)
[S2] round=12 local utility u=0.000000 metrics={'f1_val': 0.7016506089258296, 'auprc': 0.6647511339787555, 'loss_val': 0.4957185581408211, 'psi': 0.686890818947}-{'f1_val': 0.7016506089258296, 'auprc': 0.7497480474827527, 'loss_val': 0.6425335545019094, 'psi': 0.7208895843485988}
[S3] START round=12 head_norm_before_train=1.379204 cos_to_last_merge=0.9873 (last merge round=8)
[S3] round=12 local utility u=0.022310 metrics={'f1_val': 0.7003512381127298, 'auprc': 0.9982649348682195, 'loss_val': 0.2478985333852682, 'psi': 0.8195167168149258}-{'f1_val': 0.7007562037352997, 'auprc': 0.9995838018614577, 'loss_val': 0.2989056586109614, 'psi': 0.8202872429857628}
[S4] START round=12 head_norm_before_train=1.657891 (no previous merge yet)
[S4] round=12 local utility u=0.372563 metrics={'f1_val': 0.6694626955152176, 'auprc': 0.9225668924283879, 'loss_val': 0.3778675310363354, 'psi': 0.7707043742804858}-{'f1_val': 0.6756351979443518, 'auprc': 0.6601212852082143, 'loss_val': 0.37269101170204316, 'psi': 0.6694296328498968}
[S5] START round=12 head_norm_before_train=0.943569 cos_to_last_merge=0.9956 (last merge round=10)
[S5] round=12 local utility u=0.017809 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9751985664424976, 'loss_val': 0.3480680079675935, 'psi': 0.8104444621746036}-{'f1_val': 0.7006083926626743, 'auprc': 0.9840444635496858, 'loss_val': 0.4102244294869377, 'psi': 0.8139828210174789}
[S6] START round=12 head_norm_before_train=1.090354 cos_to_last_merge=0.8807 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.881
[S6] round=12 local utility u=0.896203 metrics={'f1_val': 0.698903336545142, 'auprc': 0.7932482832679585, 'loss_val': 0.45316101992805624, 'psi': 0.7366413152342686}-{'f1_val': 0.4244357493914819, 'auprc': 0.7854411330721272, 'loss_val': 0.5753403747336452, 'psi': 0.56883790286374}
[S7] START round=12 head_norm_before_train=1.210312 cos_to_last_merge=0.8544 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.854
[S7] round=12 local utility u=0.003718 metrics={'f1_val': 0.531555603660578, 'auprc': 0.7849078506730027, 'loss_val': 0.8055802735239569, 'psi': 0.632896502465548}-{'f1_val': 0.5258659660581473, 'auprc': 0.785647480502377, 'loss_val': 0.7810966183253325, 'psi': 0.6297785718358392}
[S8] START round=12 head_norm_before_train=1.010077 cos_to_last_merge=1.0000 (last merge round=11)
[S8] round=12 local utility u=0.722339 metrics={'f1_val': 0.6083522704714224, 'auprc': 0.9934742283089338, 'loss_val': 0.7735096865218473, 'psi': 0.762401053606427}-{'f1_val': 0.37266438550987346, 'auprc': 0.9908697949787797, 'loss_val': 0.7962462237906659, 'psi': 0.619946549297436}
[S9] START round=12 head_norm_before_train=0.862700 cos_to_last_merge=0.9863 (last merge round=10)
[S9] round=12 local utility u=0.142104 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.99715084822303, 'loss_val': 0.34659749313030636, 'psi': 0.8196791399207175}-{'f1_val': 0.7012904835408967, 'auprc': 0.939777735730561, 'loss_val': 0.4582413849297821, 'psi': 0.7966853844167625}
[S10] START round=12 head_norm_before_train=1.201264 cos_to_last_merge=0.8963 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.896
[S10] round=12 local utility u=0.000000 metrics={'f1_val': 0.6888947466168216, 'auprc': 0.9919481659799629, 'loss_val': 0.3614116705742634, 'psi': 0.8101161143620781}-{'f1_val': 0.7002428651507397, 'auprc': 0.9972498993476229, 'loss_val': 0.43631347066614246, 'psi': 0.8190456788294931}
[S11] START round=12 head_norm_before_train=1.554941 cos_to_last_merge=0.9984 (last merge round=10)
[S11] round=12 local utility u=0.000000 metrics={'f1_val': 0.6629907141494882, 'auprc': 0.9949927188664212, 'loss_val': 0.3867283327477294, 'psi': 0.7957915160362614}-{'f1_val': 0.7016934795869249, 'auprc': 0.9970178165329604, 'loss_val': 0.405433047712388, 'psi': 0.819823214365339}
[S13] START round=12 head_norm_before_train=1.457910 (no previous merge yet)
[S13] round=12 local utility u=0.000000 metrics={'f1_val': 0.6905699732082244, 'auprc': 0.7592168006052601, 'loss_val': 0.5421198847090088, 'psi': 0.7180287041670388}-{'f1_val': 0.7121355239164153, 'auprc': 0.7636743388765715, 'loss_val': 0.574490318841664, 'psi': 0.7327510499004778}
[S14] START round=12 head_norm_before_train=1.497423 (no previous merge yet)
[S14] round=12 local utility u=0.233415 metrics={'f1_val': 0.9966690272900108, 'auprc': 0.9970687239146128, 'loss_val': 0.19036366338197383, 'psi': 0.9968289059398516}-{'f1_val': 0.9297714992301829, 'auprc': 0.9971586800082581, 'loss_val': 0.25607762991295513, 'psi': 0.956726371541413}
[S15] START round=12 head_norm_before_train=0.927533 cos_to_last_merge=1.0000 (last merge round=11)
[S15] round=12 local utility u=0.081357 metrics={'f1_val': 0.4352171803192782, 'auprc': 0.5772097590882088, 'loss_val': 0.863393450056843, 'psi': 0.49201421182685046}-{'f1_val': 0.389033609831846, 'auprc': 0.6040342661520448, 'loss_val': 0.8294789780296169, 'psi': 0.4750338723599255}
[S16] START round=12 head_norm_before_train=0.763320 cos_to_last_merge=1.0000 (last merge round=11)
[S16] round=12 local utility u=0.000000 metrics={'f1_val': 0.37478971511622955, 'auprc': 0.7188843871839972, 'loss_val': 1.0746721396099475, 'psi': 0.5124275839433365}-{'f1_val': 0.3988455245477248, 'auprc': 0.7227479367397642, 'loss_val': 1.0323487739651311, 'psi': 0.5284064894245406}
[S17] START round=12 head_norm_before_train=1.425244 (no previous merge yet)
[S17] round=12 local utility u=0.016918 metrics={'f1_val': 0.34679085914770313, 'auprc': 0.8333716350777615, 'loss_val': 0.9925977966908623, 'psi': 0.5414231695197265}-{'f1_val': 0.34539292433449387, 'auprc': 0.8323224335057106, 'loss_val': 1.014899152779707, 'psi': 0.5401647280029805}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:44916
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:44905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:44909
[S14] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:44910
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.810)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:44912
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:44902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:44903
[S3] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1799) from S8
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.045491)
[S9] loaded HEAD from S8 (vec_in norm=1.045491)
[S9] cosine check vs S8: cos=0.1845
[S9] BUFFERED delta from S8 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1801) from S7
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.242414)
[S3] loaded HEAD from S7 (vec_in norm=1.242414)
[S3] cosine check vs S7: cos=-0.0294
[S3] DROPPED delta from S7 (cos=-0.0294 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1796) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.962294)
[S5] loaded HEAD from S15 (vec_in norm=0.962294)
[S5] cosine check vs S15: cos=0.7328
[S5] BUFFERED delta from S15 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1798) from S6
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.132908)
[S8] loaded HEAD from S6 (vec_in norm=1.132908)
[S8] cosine check vs S6: cos=0.3696
[S8] BUFFERED delta from S6 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1796) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.967858)
[S16] loaded HEAD from S9 (vec_in norm=0.967858)
[S16] cosine check vs S9: cos=0.1636
[S16] BUFFERED delta from S9 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1798) from S3
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.422516)
[S2] loaded HEAD from S3 (vec_in norm=1.422516)
[S2] cosine check vs S3: cos=0.8857
[S2] BUFFERED delta from S3 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1802) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.681934)
[S11] loaded HEAD from S4 (vec_in norm=1.681934)
[S11] cosine check vs S4: cos=0.9711
[S11] BUFFERED delta from S4 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:44903
[S17] sending update (kind=head size=1794 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1794) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.438975)
[S3] loaded HEAD from S17 (vec_in norm=1.438975)
[S3] cosine check vs S17: cos=0.8966
[S3] BUFFERED delta from S17 (total buffered=1)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=12 metric=0.6630 head_norm=1.602908
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.012301e-01
[S11] stored merged vector for next round verification (round=12)
[S11] DEBUG after merge:  round=12 metric=0.6560 head_norm=1.630526 delta_norm=0.201230
[S11] aggregate: ROLLBACK (f1_val pre=0.663 post=0.656 tol_abs=0.005 tol_rel=0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=12 metric=0.7017 head_norm=1.116074
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.379674e-01
[S2] stored merged vector for next round verification (round=12)
[S2] DEBUG after merge:  round=12 metric=0.7017 head_norm=1.233031 delta_norm=0.337967
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=12 metric=0.7006 head_norm=1.020377
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.633363e-01
[S5] stored merged vector for next round verification (round=12)
[S5] DEBUG after merge:  round=12 metric=0.7006 head_norm=0.922808 delta_norm=0.363336
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=12 metric=0.6084 head_norm=1.045491
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.125810e-01
[S8] stored merged vector for next round verification (round=12)
[S8] DEBUG after merge:  round=12 metric=0.3728 head_norm=0.901671 delta_norm=0.612581
[S8] aggregate: ROLLBACK (f1_val pre=0.608 post=0.373 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=12 metric=0.7014 head_norm=0.967858
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.434979e-01
[S9] stored merged vector for next round verification (round=12)
[S9] DEBUG after merge:  round=12 metric=0.7014 head_norm=0.775120 delta_norm=0.643498
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=12 metric=0.7004 head_norm=1.422516
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.253686e-01
[S3] stored merged vector for next round verification (round=12)
[S3] DEBUG after merge:  round=12 metric=0.9325 head_norm=1.393282 delta_norm=0.325369
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=12 metric=0.3748 head_norm=0.807778
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.773585e-01
[S16] stored merged vector for next round verification (round=12)
[S16] DEBUG after merge:  round=12 metric=0.4129 head_norm=0.679179 delta_norm=0.577358
[S16] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.233031 cos_to_last_merge=1.0000 (last merge round=12)
[S2] round=13 local utility u=0.001174 metrics={'f1_val': 0.7019113741730649, 'auprc': 0.6634510960919168, 'loss_val': 0.49103502996613646, 'psi': 0.6865272629406056}-{'f1_val': 0.7016506089258296, 'auprc': 0.6647511339787555, 'loss_val': 0.4957185581408211, 'psi': 0.686890818947}
[S3] START round=13 head_norm_before_train=1.393282 cos_to_last_merge=1.0000 (last merge round=12)
[S3] round=13 local utility u=0.000000 metrics={'f1_val': 0.7000937670991018, 'auprc': 0.9998621919469897, 'loss_val': 0.3405185473143631, 'psi': 0.8200011370382569}-{'f1_val': 0.7003512381127298, 'auprc': 0.9982649348682195, 'loss_val': 0.2478985333852682, 'psi': 0.8195167168149258}
[S4] START round=13 head_norm_before_train=1.681934 (no previous merge yet)
[S4] round=13 local utility u=0.000000 metrics={'f1_val': 0.6675846878467709, 'auprc': 0.9367969399206939, 'loss_val': 0.4273147248966056, 'psi': 0.7752695886763401}-{'f1_val': 0.6694626955152176, 'auprc': 0.9225668924283879, 'loss_val': 0.3778675310363354, 'psi': 0.7707043742804858}
[S5] START round=13 head_norm_before_train=0.922808 cos_to_last_merge=1.0000 (last merge round=12)
[S5] round=13 local utility u=0.000000 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.7564953172234836, 'loss_val': 0.42474086772918074, 'psi': 0.7229631624869981}-{'f1_val': 0.7006083926626743, 'auprc': 0.9751985664424976, 'loss_val': 0.3480680079675935, 'psi': 0.8104444621746036}
[S6] START round=13 head_norm_before_train=1.132908 cos_to_last_merge=0.8688 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.869
[S6] round=13 local utility u=0.078721 metrics={'f1_val': 0.6974949427829299, 'auprc': 0.8346966061671777, 'loss_val': 0.4116144666280244, 'psi': 0.7523756081366291}-{'f1_val': 0.698903336545142, 'auprc': 0.7932482832679585, 'loss_val': 0.45316101992805624, 'psi': 0.7366413152342686}
[S7] START round=13 head_norm_before_train=1.242414 cos_to_last_merge=0.8498 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.850
[S7] round=13 local utility u=0.000000 metrics={'f1_val': 0.5317867150855147, 'auprc': 0.7845761333902795, 'loss_val': 0.8302828480370855, 'psi': 0.6329024824074205}-{'f1_val': 0.531555603660578, 'auprc': 0.7849078506730027, 'loss_val': 0.8055802735239569, 'psi': 0.632896502465548}
[S8] START round=13 head_norm_before_train=0.901671 cos_to_last_merge=1.0000 (last merge round=12)
[S8] round=13 local utility u=0.000000 metrics={'f1_val': 0.575526164199716, 'auprc': 0.8659691120121824, 'loss_val': 0.7085974658333128, 'psi': 0.6917033433247026}-{'f1_val': 0.6083522704714224, 'auprc': 0.9934742283089338, 'loss_val': 0.7735096865218473, 'psi': 0.762401053606427}
[S9] START round=13 head_norm_before_train=0.775120 cos_to_last_merge=1.0000 (last merge round=12)
[S9] round=13 local utility u=0.000000 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.995402672785201, 'loss_val': 0.4955120917955888, 'psi': 0.8189798697455859}-{'f1_val': 0.7013646677191758, 'auprc': 0.99715084822303, 'loss_val': 0.34659749313030636, 'psi': 0.8196791399207175}
[S10] START round=13 head_norm_before_train=1.259993 cos_to_last_merge=0.8831 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.883
[S10] round=13 local utility u=0.000000 metrics={'f1_val': 0.6585123118371455, 'auprc': 0.9646934499739299, 'loss_val': 0.3559522327001707, 'psi': 0.7809847670918593}-{'f1_val': 0.6888947466168216, 'auprc': 0.9919481659799629, 'loss_val': 0.3614116705742634, 'psi': 0.8101161143620781}
[S11] START round=13 head_norm_before_train=1.630526 cos_to_last_merge=1.0000 (last merge round=12)
[S11] round=13 local utility u=0.162961 metrics={'f1_val': 0.7017589383281313, 'auprc': 0.9960397994644699, 'loss_val': 0.29655631311607267, 'psi': 0.8194712827826667}-{'f1_val': 0.6629907141494882, 'auprc': 0.9949927188664212, 'loss_val': 0.3867283327477294, 'psi': 0.7957915160362614}
[S13] START round=13 head_norm_before_train=1.483329 (no previous merge yet)
[S13] round=13 local utility u=0.000000 metrics={'f1_val': 0.6187226353091642, 'auprc': 0.7684548372481497, 'loss_val': 0.5786950458468658, 'psi': 0.6786155160847585}-{'f1_val': 0.6905699732082244, 'auprc': 0.7592168006052601, 'loss_val': 0.5421198847090088, 'psi': 0.7180287041670388}
[S14] START round=13 head_norm_before_train=1.536966 (no previous merge yet)
[S14] round=13 local utility u=0.029263 metrics={'f1_val': 0.997673454559638, 'auprc': 0.9970692307334289, 'loss_val': 0.13786651103381636, 'psi': 0.9974317650291543}-{'f1_val': 0.9966690272900108, 'auprc': 0.9970687239146128, 'loss_val': 0.19036366338197383, 'psi': 0.9968289059398516}
[S15] START round=13 head_norm_before_train=0.962294 cos_to_last_merge=0.9948 (last merge round=11)
[S15] round=13 local utility u=0.381332 metrics={'f1_val': 0.5408797640367183, 'auprc': 0.595725845965313, 'loss_val': 0.7902538959268847, 'psi': 0.5628181968081561}-{'f1_val': 0.4352171803192782, 'auprc': 0.5772097590882088, 'loss_val': 0.863393450056843, 'psi': 0.49201421182685046}
[S16] START round=13 head_norm_before_train=0.679179 cos_to_last_merge=1.0000 (last merge round=12)
[S16] round=13 local utility u=0.219358 metrics={'f1_val': 0.42854991759299593, 'auprc': 0.7325172991311893, 'loss_val': 0.999416473197698, 'psi': 0.5501368702082734}-{'f1_val': 0.37478971511622955, 'auprc': 0.7188843871839972, 'loss_val': 1.0746721396099475, 'psi': 0.5124275839433365}
[S17] START round=13 head_norm_before_train=1.438975 (no previous merge yet)
[S17] round=13 local utility u=0.000000 metrics={'f1_val': 0.3386672329012731, 'auprc': 0.8246997656406424, 'loss_val': 1.0538787080039043, 'psi': 0.5330802459970208}-{'f1_val': 0.34679085914770313, 'auprc': 0.8333716350777615, 'loss_val': 0.9925977966908623, 'psi': 0.5414231695197265}
[S6] not sending this round → trigger blocked (psi=0.752)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] → sending delta(kind=head bytes=1792) to S14@127.0.0.1:44914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S2] → sending delta(kind=head bytes=1792) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:44915
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.563)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:44909
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1792 to 1 peers)
[S16] sending update (kind=head size=1792 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1792) from S16
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.723258)
[S14] loaded HEAD from S16 (vec_in norm=0.723258)
[S14] cosine check vs S16: cos=0.0586
[S14] BUFFERED delta from S16 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1801) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.575357)
[S8] loaded HEAD from S14 (vec_in norm=1.575357)
[S8] cosine check vs S14: cos=0.4867
[S8] BUFFERED delta from S14 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1798) from S11
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.666838)
[S15] loaded HEAD from S11 (vec_in norm=1.666838)
[S15] cosine check vs S11: cos=0.8324
[S15] BUFFERED delta from S11 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1792) from S2
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.275428)
[S15] loaded HEAD from S2 (vec_in norm=1.275428)
[S15] cosine check vs S2: cos=0.3124
[S15] BUFFERED delta from S2 (total buffered=2)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=13 metric=0.5755 head_norm=0.951341
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.942431e-01
[S8] stored merged vector for next round verification (round=13)
[S8] DEBUG after merge:  round=13 metric=0.6553 head_norm=1.100648 delta_norm=0.694243
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=13 metric=0.9977 head_norm=1.575357
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.472645e-01
[S14] stored merged vector for next round verification (round=13)
[S14] DEBUG after merge:  round=13 metric=0.9970 head_norm=0.885759 delta_norm=0.847264
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=13 metric=0.5409 head_norm=1.011340
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.750174e-01
[S15] stored merged vector for next round verification (round=13)
[S15] DEBUG after merge:  round=13 metric=0.5310 head_norm=0.989288 delta_norm=0.275017
[S15] aggregate: ROLLBACK (f1_val pre=0.541 post=0.531 tol_abs=0.005 tol_rel=0.0)
[S2] START round=14 head_norm_before_train=1.275428 cos_to_last_merge=0.9969 (last merge round=12)
[S2] round=14 local utility u=0.108002 metrics={'f1_val': 0.7015710590385817, 'auprc': 0.7001185114578559, 'loss_val': 0.3829907897190292, 'psi': 0.7009900400062914}-{'f1_val': 0.7019113741730649, 'auprc': 0.6634510960919168, 'loss_val': 0.49103502996613646, 'psi': 0.6865272629406056}
[S3] START round=14 head_norm_before_train=1.437995 cos_to_last_merge=0.9990 (last merge round=12)
[S3] round=14 local utility u=0.637018 metrics={'f1_val': 0.9061894164162239, 'auprc': 0.9993524459478211, 'loss_val': 0.3015267311314474, 'psi': 0.9434546282288627}-{'f1_val': 0.7000937670991018, 'auprc': 0.9998621919469897, 'loss_val': 0.3405185473143631, 'psi': 0.8200011370382569}
[S4] START round=14 head_norm_before_train=1.702888 (no previous merge yet)
[S4] round=14 local utility u=0.017465 metrics={'f1_val': 0.6669816921643597, 'auprc': 0.9404257220182628, 'loss_val': 0.39965352627224443, 'psi': 0.7763593041059209}-{'f1_val': 0.6675846878467709, 'auprc': 0.9367969399206939, 'loss_val': 0.4273147248966056, 'psi': 0.7752695886763401}
[S5] START round=14 head_norm_before_train=1.002300 cos_to_last_merge=0.9936 (last merge round=12)
[S5] round=14 local utility u=0.404960 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.9874322830666316, 'loss_val': 0.3076356984677831, 'psi': 0.8153383696301211}-{'f1_val': 0.7006083926626743, 'auprc': 0.7564953172234836, 'loss_val': 0.42474086772918074, 'psi': 0.7229631624869981}
[S6] START round=14 head_norm_before_train=1.171723 cos_to_last_merge=0.8590 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.859
[S6] round=14 local utility u=0.000000 metrics={'f1_val': 0.707401226099641, 'auprc': 0.7822733406530352, 'loss_val': 0.5076291277432977, 'psi': 0.7373500719209987}-{'f1_val': 0.6974949427829299, 'auprc': 0.8346966061671777, 'loss_val': 0.4116144666280244, 'psi': 0.7523756081366291}
[S7] START round=14 head_norm_before_train=1.277770 cos_to_last_merge=0.8442 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.844
[S7] round=14 local utility u=0.736179 metrics={'f1_val': 0.6732694043401081, 'auprc': 0.8510067294049228, 'loss_val': 0.40611237927487087, 'psi': 0.744364334366034}-{'f1_val': 0.5317867150855147, 'auprc': 0.7845761333902795, 'loss_val': 0.8302828480370855, 'psi': 0.6329024824074205}
[S8] START round=14 head_norm_before_train=1.100648 cos_to_last_merge=1.0000 (last merge round=13)
[S8] round=14 local utility u=0.419067 metrics={'f1_val': 0.6469760982484024, 'auprc': 0.9946820256339207, 'loss_val': 0.6853012811875011, 'psi': 0.7860584692026098}-{'f1_val': 0.575526164199716, 'auprc': 0.8659691120121824, 'loss_val': 0.7085974658333128, 'psi': 0.6917033433247026}
[S9] START round=14 head_norm_before_train=0.846540 cos_to_last_merge=0.9868 (last merge round=12)
[S9] round=14 local utility u=0.069187 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.9982194363946632, 'loss_val': 0.36558739708391086, 'psi': 0.8201065751893708}-{'f1_val': 0.7013646677191758, 'auprc': 0.995402672785201, 'loss_val': 0.4955120917955888, 'psi': 0.8189798697455859}
[S10] START round=14 head_norm_before_train=1.308191 cos_to_last_merge=0.8726 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.873
[S10] round=14 local utility u=0.441332 metrics={'f1_val': 0.7781699205864544, 'auprc': 0.9900381867264065, 'loss_val': 0.2672682408543393, 'psi': 0.8629172270424352}-{'f1_val': 0.6585123118371455, 'auprc': 0.9646934499739299, 'loss_val': 0.3559522327001707, 'psi': 0.7809847670918593}
[S11] START round=14 head_norm_before_train=1.666838 cos_to_last_merge=0.9993 (last merge round=12)
[S11] round=14 local utility u=0.755150 metrics={'f1_val': 0.9444793396979181, 'auprc': 0.9957468708325141, 'loss_val': 0.24169899103111686, 'psi': 0.9649863521517565}-{'f1_val': 0.7017589383281313, 'auprc': 0.9960397994644699, 'loss_val': 0.29655631311607267, 'psi': 0.8194712827826667}
[S13] START round=14 head_norm_before_train=1.506579 (no previous merge yet)
[S13] round=14 local utility u=0.276067 metrics={'f1_val': 0.7100014716809795, 'auprc': 0.7288631308439768, 'loss_val': 0.4554591952900162, 'psi': 0.7175461353461784}-{'f1_val': 0.6187226353091642, 'auprc': 0.7684548372481497, 'loss_val': 0.5786950458468658, 'psi': 0.6786155160847585}
[S14] START round=14 head_norm_before_train=0.885759 cos_to_last_merge=1.0000 (last merge round=13)
[S14] round=14 local utility u=0.000000 metrics={'f1_val': 0.9977165309073976, 'auprc': 0.9970660121328986, 'loss_val': 0.36106258261002466, 'psi': 0.997456323397598}-{'f1_val': 0.997673454559638, 'auprc': 0.9970692307334289, 'loss_val': 0.13786651103381636, 'psi': 0.9974317650291543}
[S15] START round=14 head_norm_before_train=0.989288 cos_to_last_merge=1.0000 (last merge round=13)
[S15] round=14 local utility u=0.840268 metrics={'f1_val': 0.6454326003060465, 'auprc': 0.9204605551977467, 'loss_val': 0.7112386543549001, 'psi': 0.7554437822627267}-{'f1_val': 0.5408797640367183, 'auprc': 0.595725845965313, 'loss_val': 0.7902538959268847, 'psi': 0.5628181968081561}
[S16] START round=14 head_norm_before_train=0.723258 cos_to_last_merge=0.9946 (last merge round=12)
[S16] round=14 local utility u=0.000000 metrics={'f1_val': 0.39995421266116715, 'auprc': 0.7390527199227672, 'loss_val': 1.0306434407863465, 'psi': 0.5355936155658072}-{'f1_val': 0.42854991759299593, 'auprc': 0.7325172991311893, 'loss_val': 0.999416473197698, 'psi': 0.5501368702082734}
[S17] START round=14 head_norm_before_train=1.452656 (no previous merge yet)
[S17] round=14 local utility u=0.067387 metrics={'f1_val': 0.34672117721038764, 'auprc': 0.8277794926523093, 'loss_val': 0.9766667828650725, 'psi': 0.5391445033871564}-{'f1_val': 0.3386672329012731, 'auprc': 0.8246997656406424, 'loss_val': 1.0538787080039043, 'psi': 0.5330802459970208}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:44910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:44902
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:44911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S9] → sending delta(kind=head bytes=1791) to S16@127.0.0.1:44916
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:44905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:44912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:44910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:44903
[S2] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1791 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1802) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.720380)
[S11] loaded HEAD from S4 (vec_in norm=1.720380)
[S11] cosine check vs S4: cos=0.9830
[S11] BUFFERED delta from S4 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1801) from S8
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.139130)
[S9] loaded HEAD from S8 (vec_in norm=1.139130)
[S9] cosine check vs S8: cos=0.5976
[S9] BUFFERED delta from S8 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1800) from S10
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.353016)
[S9] loaded HEAD from S10 (vec_in norm=1.353016)
[S9] cosine check vs S10: cos=0.4610
[S9] BUFFERED delta from S10 (total buffered=2)
[S5] RECEIVED delta(kind=head bytes=1803) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.029917)
[S5] loaded HEAD from S15 (vec_in norm=1.029917)
[S5] cosine check vs S15: cos=0.8181
[S5] BUFFERED delta from S15 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1802) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.074609)
[S16] loaded HEAD from S5 (vec_in norm=1.074609)
[S16] cosine check vs S5: cos=0.4408
[S16] BUFFERED delta from S5 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1794) from S2
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.324571)
[S15] loaded HEAD from S2 (vec_in norm=1.324571)
[S15] cosine check vs S2: cos=0.4762
[S15] BUFFERED delta from S2 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1803) from S11
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.700873)
[S15] loaded HEAD from S11 (vec_in norm=1.700873)
[S15] cosine check vs S11: cos=0.8263
[S15] BUFFERED delta from S11 (total buffered=2)
[S3] RECEIVED delta(kind=head bytes=1795) from S7
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.306359)
[S3] loaded HEAD from S7 (vec_in norm=1.306359)
[S3] cosine check vs S7: cos=-0.0247
[S3] DROPPED delta from S7 (cos=-0.0247 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1799) from S3
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.495908)
[S2] loaded HEAD from S3 (vec_in norm=1.495908)
[S2] cosine check vs S3: cos=0.9339
[S2] BUFFERED delta from S3 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1802) from S13
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.526300)
[S10] loaded HEAD from S13 (vec_in norm=1.526300)
[S10] cosine check vs S13: cos=-0.0936
[S10] DROPPED delta from S13 (cos=-0.0936 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1791) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.942840)
[S16] loaded HEAD from S9 (vec_in norm=0.942840)
[S16] cosine check vs S9: cos=0.6348
[S16] BUFFERED delta from S9 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:44903
[S17] sending update (kind=head size=1800 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1800) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.465750)
[S3] loaded HEAD from S17 (vec_in norm=1.465750)
[S3] cosine check vs S17: cos=0.9485
[S3] BUFFERED delta from S17 (total buffered=1)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=14 metric=0.7016 head_norm=1.324571
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.698931e-01
[S2] stored merged vector for next round verification (round=14)
[S2] DEBUG after merge:  round=14 metric=0.7016 head_norm=1.386821 delta_norm=0.269893
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=14 metric=0.6454 head_norm=1.029917
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.720182e-01
[S15] stored merged vector for next round verification (round=14)
[S15] DEBUG after merge:  round=14 metric=0.6754 head_norm=1.038334 delta_norm=0.172018
[S15] aggregate: ACCEPT kept=['S2', 'S11'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=14 metric=0.7014 head_norm=0.942840
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.146389e-01
[S9] stored merged vector for next round verification (round=14)
[S9] DEBUG after merge:  round=14 metric=0.7014 head_norm=0.844952 delta_norm=0.314639
[S9] aggregate: ACCEPT kept=['S8', 'S10'] (k=2/2) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=14 metric=0.9062 head_norm=1.495908
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.380453e-01
[S3] stored merged vector for next round verification (round=14)
[S3] DEBUG after merge:  round=14 metric=0.8796 head_norm=1.461648 delta_norm=0.238045
[S3] aggregate: ROLLBACK (f1_val pre=0.906 post=0.880 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=14 metric=0.7006 head_norm=1.074609
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.180158e-01
[S5] stored merged vector for next round verification (round=14)
[S5] DEBUG after merge:  round=14 metric=0.7006 head_norm=1.003306 delta_norm=0.318016
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=14 metric=0.9445 head_norm=1.700873
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.578094e-01
[S11] stored merged vector for next round verification (round=14)
[S11] DEBUG after merge:  round=14 metric=0.9494 head_norm=1.703360 delta_norm=0.157809
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=14 metric=0.4000 head_norm=0.776981
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.651089e-01
[S16] stored merged vector for next round verification (round=14)
[S16] DEBUG after merge:  round=14 metric=0.6567 head_norm=0.697727 delta_norm=0.265109
[S16] aggregate: ACCEPT kept=['S5', 'S9'] (k=2/2) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.386821 cos_to_last_merge=1.0000 (last merge round=14)
[S2] round=15 local utility u=0.000000 metrics={'f1_val': 0.7018318238212289, 'auprc': 0.6586079843886967, 'loss_val': 0.37972096877762435, 'psi': 0.684542288048216}-{'f1_val': 0.7015710590385817, 'auprc': 0.7001185114578559, 'loss_val': 0.3829907897190292, 'psi': 0.7009900400062914}
[S3] START round=15 head_norm_before_train=1.461648 cos_to_last_merge=1.0000 (last merge round=14)
[S3] round=15 local utility u=0.340541 metrics={'f1_val': 0.9994909045756504, 'auprc': 0.9996514742996592, 'loss_val': 0.18115127803672568, 'psi': 0.999555132465254}-{'f1_val': 0.9061894164162239, 'auprc': 0.9993524459478211, 'loss_val': 0.3015267311314474, 'psi': 0.9434546282288627}
[S4] START round=15 head_norm_before_train=1.720380 (no previous merge yet)
[S4] round=15 local utility u=0.878525 metrics={'f1_val': 0.956066150711309, 'auprc': 0.9519553179278838, 'loss_val': 0.4116981969450003, 'psi': 0.9544218175979389}-{'f1_val': 0.6669816921643597, 'auprc': 0.9404257220182628, 'loss_val': 0.39965352627224443, 'psi': 0.7763593041059209}
[S5] START round=15 head_norm_before_train=1.003306 cos_to_last_merge=1.0000 (last merge round=14)
[S5] round=15 local utility u=0.000000 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9862673830522231, 'loss_val': 0.35776328658361367, 'psi': 0.8148719888184939}-{'f1_val': 0.7006090940057808, 'auprc': 0.9874322830666316, 'loss_val': 0.3076356984677831, 'psi': 0.8153383696301211}
[S6] START round=15 head_norm_before_train=1.206607 cos_to_last_merge=0.8499 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.850
[S6] round=15 local utility u=0.313115 metrics={'f1_val': 0.6991863219873771, 'auprc': 0.9527559157037602, 'loss_val': 0.34355717439135147, 'psi': 0.8006141594739302}-{'f1_val': 0.707401226099641, 'auprc': 0.7822733406530352, 'loss_val': 0.5076291277432977, 'psi': 0.7373500719209987}
[S7] START round=15 head_norm_before_train=1.306359 cos_to_last_merge=0.8396 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.840
[S7] round=15 local utility u=0.098966 metrics={'f1_val': 0.6830193850080108, 'auprc': 0.8760354208392207, 'loss_val': 0.34176695285658576, 'psi': 0.7602257993404948}-{'f1_val': 0.6732694043401081, 'auprc': 0.8510067294049228, 'loss_val': 0.40611237927487087, 'psi': 0.744364334366034}
[S8] START round=15 head_norm_before_train=1.139130 cos_to_last_merge=0.9966 (last merge round=13)
[S8] round=15 local utility u=0.091941 metrics={'f1_val': 0.6553452627147397, 'auprc': 0.9936057033110066, 'loss_val': 0.5484056576520814, 'psi': 0.7906494389532465}-{'f1_val': 0.6469760982484024, 'auprc': 0.9946820256339207, 'loss_val': 0.6853012811875011, 'psi': 0.7860584692026098}
[S9] START round=15 head_norm_before_train=0.844952 cos_to_last_merge=1.0000 (last merge round=14)
[S9] round=15 local utility u=0.000000 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.998724238773105, 'loss_val': 0.39253594467796, 'psi': 0.8203084961407475}-{'f1_val': 0.7013646677191758, 'auprc': 0.9982194363946632, 'loss_val': 0.36558739708391086, 'psi': 0.8201065751893708}
[S10] START round=15 head_norm_before_train=1.353016 cos_to_last_merge=0.8638 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.864
[S10] round=15 local utility u=0.253514 metrics={'f1_val': 0.8509927926323709, 'auprc': 0.9946677996132521, 'loss_val': 0.21106598746321437, 'psi': 0.9084627954247234}-{'f1_val': 0.7781699205864544, 'auprc': 0.9900381867264065, 'loss_val': 0.2672682408543393, 'psi': 0.8629172270424352}
[S11] START round=15 head_norm_before_train=1.703360 cos_to_last_merge=1.0000 (last merge round=14)
[S11] round=15 local utility u=0.000000 metrics={'f1_val': 0.8652123135999648, 'auprc': 0.9739384028625448, 'loss_val': 0.48640129733057413, 'psi': 0.9087027493049968}-{'f1_val': 0.9444793396979181, 'auprc': 0.9957468708325141, 'loss_val': 0.24169899103111686, 'psi': 0.9649863521517565}
[S13] START round=15 head_norm_before_train=1.526300 (no previous merge yet)
[S13] round=15 local utility u=0.000000 metrics={'f1_val': 0.616055203679605, 'auprc': 0.7426629117625893, 'loss_val': 0.5766486924066525, 'psi': 0.6666982869127986}-{'f1_val': 0.7100014716809795, 'auprc': 0.7288631308439768, 'loss_val': 0.4554591952900162, 'psi': 0.7175461353461784}
[S14] START round=15 head_norm_before_train=0.933614 cos_to_last_merge=0.9982 (last merge round=13)
[S14] round=15 local utility u=0.038546 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9970652840344316, 'loss_val': 0.28357504098934816, 'psi': 0.9974167844436848}-{'f1_val': 0.9977165309073976, 'auprc': 0.9970660121328986, 'loss_val': 0.36106258261002466, 'psi': 0.997456323397598}
[S15] START round=15 head_norm_before_train=1.038334 cos_to_last_merge=1.0000 (last merge round=14)
[S15] round=15 local utility u=0.000000 metrics={'f1_val': 0.693260670612956, 'auprc': 0.6818248050096758, 'loss_val': 0.626494807878236, 'psi': 0.6886863243716439}-{'f1_val': 0.6454326003060465, 'auprc': 0.9204605551977467, 'loss_val': 0.7112386543549001, 'psi': 0.7554437822627267}
[S16] START round=15 head_norm_before_train=0.697727 cos_to_last_merge=1.0000 (last merge round=14)
[S16] round=15 local utility u=0.000000 metrics={'f1_val': 0.38389734677818327, 'auprc': 0.7375993313372275, 'loss_val': 1.0399903637561745, 'psi': 0.525378140601801}-{'f1_val': 0.39995421266116715, 'auprc': 0.7390527199227672, 'loss_val': 1.0306434407863465, 'psi': 0.5355936155658072}
[S17] START round=15 head_norm_before_train=1.465750 (no previous merge yet)
[S17] round=15 local utility u=0.121790 metrics={'f1_val': 0.3685037965929705, 'auprc': 0.8397168637015433, 'loss_val': 0.8995946423744483, 'psi': 0.5569890234363997}-{'f1_val': 0.34672117721038764, 'auprc': 0.8277794926523093, 'loss_val': 0.9766667828650725, 'psi': 0.5391445033871564}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:44910
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:44909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:44903
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:44912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:44909
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:44902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:44910
[S3] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1802) from S10
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.386390)
[S9] loaded HEAD from S10 (vec_in norm=1.386390)
[S9] cosine check vs S10: cos=0.6318
[S9] BUFFERED delta from S10 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1794) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.988690)
[S8] loaded HEAD from S14 (vec_in norm=0.988690)
[S8] cosine check vs S14: cos=0.8423
[S8] BUFFERED delta from S14 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1797) from S3
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.506468)
[S2] loaded HEAD from S3 (vec_in norm=1.506468)
[S2] cosine check vs S3: cos=0.9623
[S2] BUFFERED delta from S3 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1800) from S8
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.184884)
[S9] loaded HEAD from S8 (vec_in norm=1.184884)
[S9] cosine check vs S8: cos=0.5823
[S9] BUFFERED delta from S8 (total buffered=2)
[S8] RECEIVED delta(kind=head bytes=1797) from S6
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.233933)
[S8] loaded HEAD from S6 (vec_in norm=1.233933)
[S8] cosine check vs S6: cos=0.3882
[S8] BUFFERED delta from S6 (total buffered=2)
[S3] RECEIVED delta(kind=head bytes=1798) from S7
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.324608)
[S3] loaded HEAD from S7 (vec_in norm=1.324608)
[S3] cosine check vs S7: cos=-0.0184
[S3] DROPPED delta from S7 (cos=-0.0184 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1802) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.736807)
[S11] loaded HEAD from S4 (vec_in norm=1.736807)
[S11] cosine check vs S4: cos=0.9929
[S11] BUFFERED delta from S4 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:44903
[S17] sending update (kind=head size=1801 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1801) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.481527)
[S3] loaded HEAD from S17 (vec_in norm=1.481527)
[S3] cosine check vs S17: cos=0.9787
[S3] BUFFERED delta from S17 (total buffered=1)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=15 metric=0.7018 head_norm=1.425495
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.052450e-01
[S2] stored merged vector for next round verification (round=15)
[S2] DEBUG after merge:  round=15 metric=0.7018 head_norm=1.452107 delta_norm=0.205245
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.135 → S15@127.0.0.1:44915
[S13] ⇄ pheromone p=0.245 → S10@127.0.0.1:44911
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=15 metric=0.7014 head_norm=0.930214
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.218878e-01
[S9] stored merged vector for next round verification (round=15)
[S9] DEBUG after merge:  round=15 metric=0.7014 head_norm=0.881785 delta_norm=0.221888
[S9] aggregate: ACCEPT kept=['S10', 'S8'] (k=2/2) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.140 → S16@127.0.0.1:44916
[S15] ⇄ pheromone p=0.268 → S5@127.0.0.1:44905
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=15 metric=0.8652 head_norm=1.731731
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.037038e-01
[S11] stored merged vector for next round verification (round=15)
[S11] DEBUG after merge:  round=15 metric=0.8646 head_norm=1.731167 delta_norm=0.103704
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.289 → S15@127.0.0.1:44915
[S5] ⇄ pheromone p=0.185 → S16@127.0.0.1:44916
[S6] ⇄ pheromone p=0.253 → S8@127.0.0.1:44909
[S4] ⇄ pheromone p=0.298 → S11@127.0.0.1:44912
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=15 metric=0.6553 head_norm=1.184884
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.422052e-01
[S8] stored merged vector for next round verification (round=15)
[S8] DEBUG after merge:  round=15 metric=0.6553 head_norm=0.945668 delta_norm=0.342205
[S8] aggregate: ACCEPT kept=['S14', 'S6'] (k=2/2) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.323 → S9@127.0.0.1:44910
[S7] ⇄ pheromone p=0.230 → S3@127.0.0.1:44903
[S14] ⇄ pheromone p=0.224 → S8@127.0.0.1:44909
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=15 metric=0.9995 head_norm=1.506468
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.545942e-01
[S3] stored merged vector for next round verification (round=15)
[S3] DEBUG after merge:  round=15 metric=0.9991 head_norm=1.486030 delta_norm=0.154594
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.261 → S2@127.0.0.1:44902
[S10] ⇄ pheromone p=0.285 → S9@127.0.0.1:44910
[S16] ⇄ pheromone p=0.119 → S14@127.0.0.1:44914
[S17] ⇄ pheromone p=0.116 → S3@127.0.0.1:44903
[S2] START round=16 head_norm_before_train=1.452107 cos_to_last_merge=1.0000 (last merge round=15)
[S2] round=16 local utility u=0.002977 metrics={'f1_val': 0.7018318238212289, 'auprc': 0.6592034466530123, 'loss_val': 0.3755536481447539, 'psi': 0.6847804729539423}-{'f1_val': 0.7018318238212289, 'auprc': 0.6586079843886967, 'loss_val': 0.37972096877762435, 'psi': 0.684542288048216}
[S3] START round=16 head_norm_before_train=1.486030 cos_to_last_merge=1.0000 (last merge round=15)
[S3] round=16 local utility u=0.000000 metrics={'f1_val': 0.9834431434003827, 'auprc': 0.9995058083874151, 'loss_val': 0.2115773841675412, 'psi': 0.9898682093951956}-{'f1_val': 0.9994909045756504, 'auprc': 0.9996514742996592, 'loss_val': 0.18115127803672568, 'psi': 0.999555132465254}
[S4] START round=16 head_norm_before_train=1.736807 (no previous merge yet)
[S4] round=16 local utility u=0.000000 metrics={'f1_val': 0.9520069680133474, 'auprc': 0.9512092456907105, 'loss_val': 0.3963231592427898, 'psi': 0.9516878790842926}-{'f1_val': 0.956066150711309, 'auprc': 0.9519553179278838, 'loss_val': 0.4116981969450003, 'psi': 0.9544218175979389}
[S5] START round=16 head_norm_before_train=1.049813 cos_to_last_merge=0.9977 (last merge round=14)
[S5] round=16 local utility u=0.026096 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9862807591748178, 'loss_val': 0.3056115433978656, 'psi': 0.8148773392675317}-{'f1_val': 0.7006083926626743, 'auprc': 0.9862673830522231, 'loss_val': 0.35776328658361367, 'psi': 0.8148719888184939}
[S6] START round=16 head_norm_before_train=1.233933 cos_to_last_merge=0.8437 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.844
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.7082586975972295, 'auprc': 0.7934746447413369, 'loss_val': 0.48454871511976544, 'psi': 0.7423450764548725}-{'f1_val': 0.6991863219873771, 'auprc': 0.9527559157037602, 'loss_val': 0.34355717439135147, 'psi': 0.8006141594739302}
[S7] START round=16 head_norm_before_train=1.324608 cos_to_last_merge=0.8365 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.836
[S7] round=16 local utility u=0.000000 metrics={'f1_val': 0.6349643811243255, 'auprc': 0.8045525354048996, 'loss_val': 0.5647524714572668, 'psi': 0.7027996428365552}-{'f1_val': 0.6830193850080108, 'auprc': 0.8760354208392207, 'loss_val': 0.34176695285658576, 'psi': 0.7602257993404948}
[S8] START round=16 head_norm_before_train=0.945668 cos_to_last_merge=1.0000 (last merge round=15)
[S8] round=16 local utility u=0.005828 metrics={'f1_val': 0.6550634210237409, 'auprc': 0.995661081859019, 'loss_val': 0.5412256445458794, 'psi': 0.7913024853578522}-{'f1_val': 0.6553452627147397, 'auprc': 0.9936057033110066, 'loss_val': 0.5484056576520814, 'psi': 0.7906494389532465}
[S9] START round=16 head_norm_before_train=0.881785 cos_to_last_merge=1.0000 (last merge round=15)
[S9] round=16 local utility u=0.000000 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.9986111497352604, 'loss_val': 0.3949587968328093, 'psi': 0.8202632605256097}-{'f1_val': 0.7013646677191758, 'auprc': 0.998724238773105, 'loss_val': 0.39253594467796, 'psi': 0.8203084961407475}
[S10] START round=16 head_norm_before_train=1.386390 cos_to_last_merge=0.8576 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.858
[S10] round=16 local utility u=0.447246 metrics={'f1_val': 0.9919548558034597, 'auprc': 0.9970953744058411, 'loss_val': 0.16962809920727906, 'psi': 0.9940110632444122}-{'f1_val': 0.8509927926323709, 'auprc': 0.9946677996132521, 'loss_val': 0.21106598746321437, 'psi': 0.9084627954247234}
[S11] START round=16 head_norm_before_train=1.731167 cos_to_last_merge=1.0000 (last merge round=15)
[S11] round=16 local utility u=0.555603 metrics={'f1_val': 0.9958784765900407, 'auprc': 0.9961473922258094, 'loss_val': 0.22582014440772755, 'psi': 0.9959860428443481}-{'f1_val': 0.8652123135999648, 'auprc': 0.9739384028625448, 'loss_val': 0.48640129733057413, 'psi': 0.9087027493049968}
[S13] START round=16 head_norm_before_train=1.544733 (no previous merge yet)
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.6509542520668972, 'auprc': 0.6274490075315271, 'loss_val': 0.5695488947278452, 'psi': 0.6415521542527491}-{'f1_val': 0.616055203679605, 'auprc': 0.7426629117625893, 'loss_val': 0.5766486924066525, 'psi': 0.6666982869127986}
[S14] START round=16 head_norm_before_train=0.988690 cos_to_last_merge=0.9932 (last merge round=13)
[S14] round=16 local utility u=0.030271 metrics={'f1_val': 0.9976483782674455, 'auprc': 0.9955428318192028, 'loss_val': 0.21844854236807237, 'psi': 0.9968061596881483}-{'f1_val': 0.9976511180498535, 'auprc': 0.9970652840344316, 'loss_val': 0.28357504098934816, 'psi': 0.9974167844436848}
[S15] START round=16 head_norm_before_train=1.071441 cos_to_last_merge=0.9974 (last merge round=14)
[S15] round=16 local utility u=0.391228 metrics={'f1_val': 0.6850715402218939, 'auprc': 0.9262396239885805, 'loss_val': 0.528147784183276, 'psi': 0.7815387737285686}-{'f1_val': 0.693260670612956, 'auprc': 0.6818248050096758, 'loss_val': 0.626494807878236, 'psi': 0.6886863243716439}
[S16] START round=16 head_norm_before_train=0.746636 cos_to_last_merge=0.9948 (last merge round=14)
[S16] round=16 local utility u=0.315961 metrics={'f1_val': 0.463063072648078, 'auprc': 0.7518253599355643, 'loss_val': 0.9257410245341052, 'psi': 0.5785679875630725}-{'f1_val': 0.38389734677818327, 'auprc': 0.7375993313372275, 'loss_val': 1.0399903637561745, 'psi': 0.525378140601801}
[S17] START round=16 head_norm_before_train=1.481527 (no previous merge yet)
[S17] round=16 local utility u=0.007003 metrics={'f1_val': 0.3723420036186749, 'auprc': 0.8370390685504947, 'loss_val': 0.9005847880399013, 'psi': 0.5582208295914028}-{'f1_val': 0.3685037965929705, 'auprc': 0.8397168637015433, 'loss_val': 0.8995946423744483, 'psi': 0.5569890234363997}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:44909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:44914
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:44915
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:44910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S10] → sending delta(kind=head bytes=1807) to S9@127.0.0.1:44910
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:44905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:44916
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1807 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.119825)
[S16] loaded HEAD from S5 (vec_in norm=1.119825)
[S16] cosine check vs S5: cos=0.5629
[S16] BUFFERED delta from S5 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1797) from S2
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.488705)
[S15] loaded HEAD from S2 (vec_in norm=1.488705)
[S15] cosine check vs S2: cos=0.5178
[S15] BUFFERED delta from S2 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1807) from S10
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.410203)
[S9] loaded HEAD from S10 (vec_in norm=1.410203)
[S9] cosine check vs S10: cos=0.7004
[S9] BUFFERED delta from S10 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1803) from S8
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.995487)
[S9] loaded HEAD from S8 (vec_in norm=0.995487)
[S9] cosine check vs S8: cos=0.5933
[S9] BUFFERED delta from S8 (total buffered=2)
[S5] RECEIVED delta(kind=head bytes=1796) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.110321)
[S5] loaded HEAD from S15 (vec_in norm=1.110321)
[S5] cosine check vs S15: cos=0.8917
[S5] BUFFERED delta from S15 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1796) from S16
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.802643)
[S14] loaded HEAD from S16 (vec_in norm=0.802643)
[S14] cosine check vs S16: cos=0.4870
[S14] BUFFERED delta from S16 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1798) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.052451)
[S8] loaded HEAD from S14 (vec_in norm=1.052451)
[S8] cosine check vs S14: cos=0.7696
[S8] BUFFERED delta from S14 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1798) from S11
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.750810)
[S15] loaded HEAD from S11 (vec_in norm=1.750810)
[S15] cosine check vs S11: cos=0.7858
[S15] BUFFERED delta from S11 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:44903
[S17] sending update (kind=head size=1801 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1801) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.495582)
[S3] loaded HEAD from S17 (vec_in norm=1.495582)
[S3] cosine check vs S17: cos=0.9882
[S3] BUFFERED delta from S17 (total buffered=1)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=16 metric=0.9834 head_norm=1.530164
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.176588e-01
[S3] stored merged vector for next round verification (round=16)
[S3] DEBUG after merge:  round=16 metric=0.9925 head_norm=1.508390 delta_norm=0.117659
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=16 metric=0.7014 head_norm=0.961400
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.893875e-01
[S9] stored merged vector for next round verification (round=16)
[S9] DEBUG after merge:  round=16 metric=0.7014 head_norm=0.891390 delta_norm=0.189387
[S9] aggregate: ACCEPT kept=['S10', 'S8'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=16 metric=0.6551 head_norm=0.995487
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.485493e-01
[S8] stored merged vector for next round verification (round=16)
[S8] DEBUG after merge:  round=16 metric=0.9961 head_norm=0.963243 delta_norm=0.348549
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=16 metric=0.9976 head_norm=1.052451
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.819300e-01
[S14] stored merged vector for next round verification (round=16)
[S14] DEBUG after merge:  round=16 metric=0.9981 head_norm=0.802302 delta_norm=0.481930
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=16 metric=0.4631 head_norm=0.802643
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.707383e-01
[S16] stored merged vector for next round verification (round=16)
[S16] DEBUG after merge:  round=16 metric=0.8189 head_norm=0.852952 delta_norm=0.470738
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=16 metric=0.6851 head_norm=1.110321
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.985180e-01
[S15] stored merged vector for next round verification (round=16)
[S15] DEBUG after merge:  round=16 metric=0.6797 head_norm=1.109577 delta_norm=0.198518
[S15] aggregate: ROLLBACK (f1_val pre=0.685 post=0.680 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=16 metric=0.7006 head_norm=1.119825
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.594694e-01
[S5] stored merged vector for next round verification (round=16)
[S5] DEBUG after merge:  round=16 metric=0.7006 head_norm=1.084475 delta_norm=0.259469
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.488705 cos_to_last_merge=0.9986 (last merge round=15)
[S2] round=17 local utility u=0.020105 metrics={'f1_val': 0.7015710590385817, 'auprc': 0.6619538361272466, 'loss_val': 0.34203103947596764, 'psi': 0.6857241698740477}-{'f1_val': 0.7018318238212289, 'auprc': 0.6592034466530123, 'loss_val': 0.3755536481447539, 'psi': 0.6847804729539423}
[S3] START round=17 head_norm_before_train=1.508390 cos_to_last_merge=1.0000 (last merge round=16)
[S3] round=17 local utility u=0.000000 metrics={'f1_val': 0.9587146887554572, 'auprc': 0.9987150754745863, 'loss_val': 0.19717882300348766, 'psi': 0.9747148434431088}-{'f1_val': 0.9834431434003827, 'auprc': 0.9995058083874151, 'loss_val': 0.2115773841675412, 'psi': 0.9898682093951956}
[S4] START round=17 head_norm_before_train=1.755164 (no previous merge yet)
[S4] round=17 local utility u=0.000000 metrics={'f1_val': 0.9427250926949478, 'auprc': 0.9582311870650604, 'loss_val': 0.40516763983487347, 'psi': 0.9489275304429927}-{'f1_val': 0.9520069680133474, 'auprc': 0.9512092456907105, 'loss_val': 0.3963231592427898, 'psi': 0.9516878790842926}
[S5] START round=17 head_norm_before_train=1.084475 cos_to_last_merge=1.0000 (last merge round=16)
[S5] round=17 local utility u=0.008608 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9885134542350587, 'loss_val': 0.29336781303345005, 'psi': 0.8155977407888388}-{'f1_val': 0.7006083926626743, 'auprc': 0.9862807591748178, 'loss_val': 0.3056115433978656, 'psi': 0.8148773392675317}
[S6] START round=17 head_norm_before_train=1.261541 cos_to_last_merge=0.8383 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.838
[S6] round=17 local utility u=1.000000 metrics={'f1_val': 0.9617364792020078, 'auprc': 0.9553089984236015, 'loss_val': 0.3314028115294131, 'psi': 0.9591654868906453}-{'f1_val': 0.7082586975972295, 'auprc': 0.7934746447413369, 'loss_val': 0.48454871511976544, 'psi': 0.7423450764548725}
[S7] START round=17 head_norm_before_train=1.341444 cos_to_last_merge=0.8334 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.833
[S7] round=17 local utility u=0.000000 metrics={'f1_val': 0.6012624202929829, 'auprc': 0.7905900113660893, 'loss_val': 0.6898854178795545, 'psi': 0.6769934567222256}-{'f1_val': 0.6349643811243255, 'auprc': 0.8045525354048996, 'loss_val': 0.5647524714572668, 'psi': 0.7027996428365552}
[S8] START round=17 head_norm_before_train=0.963243 cos_to_last_merge=1.0000 (last merge round=16)
[S8] round=17 local utility u=0.000000 metrics={'f1_val': 0.3738520754615789, 'auprc': 0.9884930296786745, 'loss_val': 0.6574842282185163, 'psi': 0.6197084571484172}-{'f1_val': 0.6550634210237409, 'auprc': 0.995661081859019, 'loss_val': 0.5412256445458794, 'psi': 0.7913024853578522}
[S9] START round=17 head_norm_before_train=0.891390 cos_to_last_merge=1.0000 (last merge round=16)
[S9] round=17 local utility u=0.007307 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.9980792145804829, 'loss_val': 0.3787481127294129, 'psi': 0.8200504864636986}-{'f1_val': 0.7013646677191758, 'auprc': 0.9986111497352604, 'loss_val': 0.3949587968328093, 'psi': 0.8202632605256097}
[S10] START round=17 head_norm_before_train=1.410203 cos_to_last_merge=0.8535 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.854
[S10] round=17 local utility u=0.009379 metrics={'f1_val': 0.9943473480461396, 'auprc': 0.997006866553372, 'loss_val': 0.1649588016394715, 'psi': 0.9954111554490326}-{'f1_val': 0.9919548558034597, 'auprc': 0.9970953744058411, 'loss_val': 0.16962809920727906, 'psi': 0.9940110632444122}
[S11] START round=17 head_norm_before_train=1.750810 cos_to_last_merge=0.9997 (last merge round=15)
[S11] round=17 local utility u=0.000077 metrics={'f1_val': 0.9882496730395877, 'auprc': 0.9973814767578735, 'loss_val': 0.18359579091033298, 'psi': 0.9919023945269021}-{'f1_val': 0.9958784765900407, 'auprc': 0.9961473922258094, 'loss_val': 0.22582014440772755, 'psi': 0.9959860428443481}
[S13] START round=17 head_norm_before_train=1.560123 (no previous merge yet)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.5707287898102376, 'auprc': 0.7223617188941481, 'loss_val': 0.7798762470388237, 'psi': 0.6313819614438019}-{'f1_val': 0.6509542520668972, 'auprc': 0.6274490075315271, 'loss_val': 0.5695488947278452, 'psi': 0.6415521542527491}
[S14] START round=17 head_norm_before_train=0.802302 cos_to_last_merge=1.0000 (last merge round=16)
[S14] round=17 local utility u=0.000000 metrics={'f1_val': 0.986031725211497, 'auprc': 0.9955420513768668, 'loss_val': 0.4002942545949068, 'psi': 0.989835855677645}-{'f1_val': 0.9976483782674455, 'auprc': 0.9955428318192028, 'loss_val': 0.21844854236807237, 'psi': 0.9968061596881483}
[S15] START round=17 head_norm_before_train=1.109577 cos_to_last_merge=1.0000 (last merge round=16)
[S15] round=17 local utility u=0.000000 metrics={'f1_val': 0.6950284736305511, 'auprc': 0.8631213265764699, 'loss_val': 0.5124363388775854, 'psi': 0.7622656148089186}-{'f1_val': 0.6850715402218939, 'auprc': 0.9262396239885805, 'loss_val': 0.528147784183276, 'psi': 0.7815387737285686}
[S16] START round=17 head_norm_before_train=0.852952 cos_to_last_merge=1.0000 (last merge round=16)
[S16] round=17 local utility u=0.000000 metrics={'f1_val': 0.4393320708226957, 'auprc': 0.7541085588921216, 'loss_val': 0.9242070225285296, 'psi': 0.5652426660504661}-{'f1_val': 0.463063072648078, 'auprc': 0.7518253599355643, 'loss_val': 0.9257410245341052, 'psi': 0.5785679875630725}
[S17] START round=17 head_norm_before_train=1.495582 (no previous merge yet)
[S17] round=17 local utility u=0.343228 metrics={'f1_val': 0.48430177500774185, 'auprc': 0.8390013651079672, 'loss_val': 0.8917743317680726, 'psi': 0.626181611047832}-{'f1_val': 0.3723420036186749, 'auprc': 0.8370390685504947, 'loss_val': 0.9005847880399013, 'psi': 0.5582208295914028}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:44909
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:44916
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:44910
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:44915
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1801) from S10
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.434542)
[S9] loaded HEAD from S10 (vec_in norm=1.434542)
[S9] cosine check vs S10: cos=0.7573
[S9] BUFFERED delta from S10 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1799) from S6
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.284287)
[S8] loaded HEAD from S6 (vec_in norm=1.284287)
[S8] cosine check vs S6: cos=0.3095
[S8] BUFFERED delta from S6 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1804) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.148070)
[S16] loaded HEAD from S5 (vec_in norm=1.148070)
[S16] cosine check vs S5: cos=0.8617
[S16] BUFFERED delta from S5 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1796) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.971177)
[S16] loaded HEAD from S9 (vec_in norm=0.971177)
[S16] cosine check vs S9: cos=0.3148
[S16] BUFFERED delta from S9 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1801) from S2
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.525952)
[S15] loaded HEAD from S2 (vec_in norm=1.525952)
[S15] cosine check vs S2: cos=0.5894
[S15] BUFFERED delta from S2 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1799) from S11
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.772741)
[S15] loaded HEAD from S11 (vec_in norm=1.772741)
[S15] cosine check vs S11: cos=0.7787
[S15] BUFFERED delta from S11 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:44903
[S17] sending update (kind=head size=1800 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1800) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.513443)
[S3] loaded HEAD from S17 (vec_in norm=1.513443)
[S3] cosine check vs S17: cos=0.9900
[S3] BUFFERED delta from S17 (total buffered=1)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=17 metric=0.3739 head_norm=1.000335
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.809433e-01
[S8] stored merged vector for next round verification (round=17)
[S8] DEBUG after merge:  round=17 metric=0.4528 head_norm=0.928089 delta_norm=0.680943
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=17 metric=0.9587 head_norm=1.565645
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.121292e-01
[S3] stored merged vector for next round verification (round=17)
[S3] DEBUG after merge:  round=17 metric=0.9601 head_norm=1.535677 delta_norm=0.112129
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=17 metric=0.6950 head_norm=1.144444
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.257179e-01
[S15] stored merged vector for next round verification (round=17)
[S15] DEBUG after merge:  round=17 metric=0.6945 head_norm=1.149058 delta_norm=0.125718
[S15] aggregate: ACCEPT kept=['S2', 'S11'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=17 metric=0.7014 head_norm=0.971177
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.719854e-01
[S9] stored merged vector for next round verification (round=17)
[S9] DEBUG after merge:  round=17 metric=0.7014 head_norm=1.130388 delta_norm=0.471985
[S9] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=17 metric=0.4393 head_norm=0.892178
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.377041e-01
[S16] stored merged vector for next round verification (round=17)
[S16] DEBUG after merge:  round=17 metric=0.6929 head_norm=0.796389 delta_norm=0.237704
[S16] aggregate: ACCEPT kept=['S5', 'S9'] (k=2/2) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.525952 cos_to_last_merge=0.9952 (last merge round=15)
[S2] round=18 local utility u=0.015960 metrics={'f1_val': 0.7018318238212289, 'auprc': 0.6698511793598586, 'loss_val': 0.33536804985186824, 'psi': 0.6890395660366808}-{'f1_val': 0.7015710590385817, 'auprc': 0.6619538361272466, 'loss_val': 0.34203103947596764, 'psi': 0.6857241698740477}
[S3] START round=18 head_norm_before_train=1.535677 cos_to_last_merge=1.0000 (last merge round=17)
[S3] round=18 local utility u=0.000000 metrics={'f1_val': 0.7047927687254677, 'auprc': 0.9586936450055552, 'loss_val': 0.49585381157324865, 'psi': 0.8063531192375026}-{'f1_val': 0.9587146887554572, 'auprc': 0.9987150754745863, 'loss_val': 0.19717882300348766, 'psi': 0.9747148434431088}
[S4] START round=18 head_norm_before_train=1.772655 (no previous merge yet)
[S4] round=18 local utility u=0.046507 metrics={'f1_val': 0.9455559033868335, 'auprc': 0.9597333152242626, 'loss_val': 0.33364535667647444, 'psi': 0.9512268681218051}-{'f1_val': 0.9427250926949478, 'auprc': 0.9582311870650604, 'loss_val': 0.40516763983487347, 'psi': 0.9489275304429927}
[S5] START round=18 head_norm_before_train=1.148070 cos_to_last_merge=0.9969 (last merge round=16)
[S5] round=18 local utility u=0.000000 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9866128036424077, 'loss_val': 0.32608074842991225, 'psi': 0.8150101570545676}-{'f1_val': 0.700320598491359, 'auprc': 0.9885134542350587, 'loss_val': 0.29336781303345005, 'psi': 0.8155977407888388}
[S6] START round=18 head_norm_before_train=1.284287 cos_to_last_merge=0.8337 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.834
[S6] round=18 local utility u=0.010728 metrics={'f1_val': 0.9602793441540762, 'auprc': 0.9556385293415296, 'loss_val': 0.30219222642988336, 'psi': 0.9584230182290576}-{'f1_val': 0.9617364792020078, 'auprc': 0.9553089984236015, 'loss_val': 0.3314028115294131, 'psi': 0.9591654868906453}
[S7] START round=18 head_norm_before_train=1.365191 cos_to_last_merge=0.8309 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.831
[S7] round=18 local utility u=0.000000 metrics={'f1_val': 0.5689347334944617, 'auprc': 0.7871449499880114, 'loss_val': 0.7323534148066413, 'psi': 0.6562188200918816}-{'f1_val': 0.6012624202929829, 'auprc': 0.7905900113660893, 'loss_val': 0.6898854178795545, 'psi': 0.6769934567222256}
[S8] START round=18 head_norm_before_train=0.928089 cos_to_last_merge=1.0000 (last merge round=17)
[S8] round=18 local utility u=0.697068 metrics={'f1_val': 0.6550602073380677, 'auprc': 0.865385244174543, 'loss_val': 0.5812731784807131, 'psi': 0.7391902220726578}-{'f1_val': 0.3738520754615789, 'auprc': 0.9884930296786745, 'loss_val': 0.6574842282185163, 'psi': 0.6197084571484172}
[S9] START round=18 head_norm_before_train=1.130388 cos_to_last_merge=1.0000 (last merge round=17)
[S9] round=18 local utility u=0.038211 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.9980954862166146, 'loss_val': 0.30237557119531505, 'psi': 0.8200569951181513}-{'f1_val': 0.7013646677191758, 'auprc': 0.9980792145804829, 'loss_val': 0.3787481127294129, 'psi': 0.8200504864636986}
[S10] START round=18 head_norm_before_train=1.434542 cos_to_last_merge=0.8504 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.850
[S10] round=18 local utility u=0.007705 metrics={'f1_val': 0.9954430117283648, 'auprc': 0.9966635200544178, 'loss_val': 0.15509217096589475, 'psi': 0.995931215058786}-{'f1_val': 0.9943473480461396, 'auprc': 0.997006866553372, 'loss_val': 0.1649588016394715, 'psi': 0.9954111554490326}
[S11] START round=18 head_norm_before_train=1.772741 cos_to_last_merge=0.9990 (last merge round=15)
[S11] round=18 local utility u=0.041434 metrics={'f1_val': 0.996960829744628, 'auprc': 0.9975305291987326, 'loss_val': 0.15344275271899738, 'psi': 0.9971887095262698}-{'f1_val': 0.9882496730395877, 'auprc': 0.9973814767578735, 'loss_val': 0.18359579091033298, 'psi': 0.9919023945269021}
[S13] START round=18 head_norm_before_train=1.573928 (no previous merge yet)
[S13] round=18 local utility u=0.000000 metrics={'f1_val': 0.5998506832054089, 'auprc': 0.5481941700228332, 'loss_val': 0.7089253404669043, 'psi': 0.5791880779323786}-{'f1_val': 0.5707287898102376, 'auprc': 0.7223617188941481, 'loss_val': 0.7798762470388237, 'psi': 0.6313819614438019}
[S14] START round=18 head_norm_before_train=0.864496 cos_to_last_merge=0.9953 (last merge round=16)
[S14] round=18 local utility u=0.000000 metrics={'f1_val': 0.9465317490259154, 'auprc': 0.9955418802777318, 'loss_val': 0.2970308357343843, 'psi': 0.966135801526642}-{'f1_val': 0.986031725211497, 'auprc': 0.9955420513768668, 'loss_val': 0.4002942545949068, 'psi': 0.989835855677645}
[S15] START round=18 head_norm_before_train=1.149058 cos_to_last_merge=1.0000 (last merge round=17)
[S15] round=18 local utility u=0.226699 metrics={'f1_val': 0.6981806593793383, 'auprc': 0.9877418000428647, 'loss_val': 0.45181307111909663, 'psi': 0.8140051156447489}-{'f1_val': 0.6950284736305511, 'auprc': 0.8631213265764699, 'loss_val': 0.5124363388775854, 'psi': 0.7622656148089186}
[S16] START round=18 head_norm_before_train=0.796389 cos_to_last_merge=1.0000 (last merge round=17)
[S16] round=18 local utility u=0.959463 metrics={'f1_val': 0.7360730425903754, 'auprc': 0.7775346951197062, 'loss_val': 0.8560056953687979, 'psi': 0.7526577036021078}-{'f1_val': 0.4393320708226957, 'auprc': 0.7541085588921216, 'loss_val': 0.9242070225285296, 'psi': 0.5652426660504661}
[S17] START round=18 head_norm_before_train=1.513443 (no previous merge yet)
[S17] round=18 local utility u=0.000000 metrics={'f1_val': 0.35423343175441036, 'auprc': 0.825811994886041, 'loss_val': 0.9938996113479558, 'psi': 0.5428648570070626}-{'f1_val': 0.48430177500774185, 'auprc': 0.8390013651079672, 'loss_val': 0.8917743317680726, 'psi': 0.626181611047832}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:44914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:44905
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:44912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:44909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:44910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:44910
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1804 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1804) from S10
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.458295)
[S9] loaded HEAD from S10 (vec_in norm=1.458295)
[S9] cosine check vs S10: cos=0.9402
[S9] BUFFERED delta from S10 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1797) from S2
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.558720)
[S15] loaded HEAD from S2 (vec_in norm=1.558720)
[S15] cosine check vs S2: cos=0.6204
[S15] BUFFERED delta from S2 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1797) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.201249)
[S16] loaded HEAD from S9 (vec_in norm=1.201249)
[S16] cosine check vs S9: cos=0.4596
[S16] BUFFERED delta from S9 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1796) from S16
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.837672)
[S14] loaded HEAD from S16 (vec_in norm=0.837672)
[S14] cosine check vs S16: cos=0.6911
[S14] BUFFERED delta from S16 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1798) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.790540)
[S11] loaded HEAD from S4 (vec_in norm=1.790540)
[S11] cosine check vs S4: cos=0.9906
[S11] BUFFERED delta from S4 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1799) from S8
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.967240)
[S9] loaded HEAD from S8 (vec_in norm=0.967240)
[S9] cosine check vs S8: cos=0.1915
[S9] BUFFERED delta from S8 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1796) from S11
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.798919)
[S15] loaded HEAD from S11 (vec_in norm=1.798919)
[S15] cosine check vs S11: cos=0.7684
[S15] BUFFERED delta from S11 (total buffered=2)
[S5] RECEIVED delta(kind=head bytes=1802) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.185476)
[S5] loaded HEAD from S15 (vec_in norm=1.185476)
[S5] cosine check vs S15: cos=0.8898
[S5] BUFFERED delta from S15 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1798) from S6
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.308264)
[S8] loaded HEAD from S6 (vec_in norm=1.308264)
[S8] cosine check vs S6: cos=0.8505
[S8] BUFFERED delta from S6 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=18 metric=0.9465 head_norm=0.945620
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.539151e-01
[S14] stored merged vector for next round verification (round=18)
[S14] DEBUG after merge:  round=18 metric=0.9468 head_norm=0.820177 delta_norm=0.353915
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=18 metric=0.7006 head_norm=1.200106
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.800801e-01
[S5] stored merged vector for next round verification (round=18)
[S5] DEBUG after merge:  round=18 metric=0.7006 head_norm=1.159465 delta_norm=0.280080
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=18 metric=0.6982 head_norm=1.185476
[S15] _apply_head_vector_avg (torch): Δ‖w‖=9.825346e-02
[S15] stored merged vector for next round verification (round=18)
[S15] DEBUG after merge:  round=18 metric=0.6974 head_norm=1.184128 delta_norm=0.098253
[S15] aggregate: ACCEPT kept=['S2', 'S11'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=18 metric=0.9970 head_norm=1.798919
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.230467e-01
[S11] stored merged vector for next round verification (round=18)
[S11] DEBUG after merge:  round=18 metric=0.9970 head_norm=1.790511 delta_norm=0.123047
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=18 metric=0.7361 head_norm=0.837672
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.522056e-01
[S16] stored merged vector for next round verification (round=18)
[S16] DEBUG after merge:  round=18 metric=0.6732 head_norm=0.876023 delta_norm=0.552206
[S16] aggregate: ROLLBACK (f1_val pre=0.736 post=0.673 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=18 metric=0.6551 head_norm=0.967240
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.516575e-01
[S8] stored merged vector for next round verification (round=18)
[S8] DEBUG after merge:  round=18 metric=0.4065 head_norm=1.095395 delta_norm=0.351658
[S8] aggregate: ROLLBACK (f1_val pre=0.655 post=0.406 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=18 metric=0.7014 head_norm=1.201249
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.866291e-01
[S9] stored merged vector for next round verification (round=18)
[S9] DEBUG after merge:  round=18 metric=0.7014 head_norm=1.008429 delta_norm=0.286629
[S9] aggregate: ACCEPT kept=['S10', 'S8'] (k=2/2) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.558720 cos_to_last_merge=0.9914 (last merge round=15)
[S2] round=19 local utility u=0.006731 metrics={'f1_val': 0.7015719066528542, 'auprc': 0.6697508155513814, 'loss_val': 0.3200463420055119, 'psi': 0.688843470212265}-{'f1_val': 0.7018318238212289, 'auprc': 0.6698511793598586, 'loss_val': 0.33536804985186824, 'psi': 0.6890395660366808}
[S3] START round=19 head_norm_before_train=1.596354 cos_to_last_merge=0.9982 (last merge round=17)
[S3] round=19 local utility u=1.000000 metrics={'f1_val': 0.9820281436931092, 'auprc': 0.9983474409849458, 'loss_val': 0.13262392563508268, 'psi': 0.9885558626098438}-{'f1_val': 0.7047927687254677, 'auprc': 0.9586936450055552, 'loss_val': 0.49585381157324865, 'psi': 0.8063531192375026}
[S4] START round=19 head_norm_before_train=1.790540 (no previous merge yet)
[S4] round=19 local utility u=0.023202 metrics={'f1_val': 0.9439176816471346, 'auprc': 0.9612471473953328, 'loss_val': 0.28195293154819323, 'psi': 0.9508494679464139}-{'f1_val': 0.9455559033868335, 'auprc': 0.9597333152242626, 'loss_val': 0.33364535667647444, 'psi': 0.9512268681218051}
[S5] START round=19 head_norm_before_train=1.159465 cos_to_last_merge=1.0000 (last merge round=18)
[S5] round=19 local utility u=0.000000 metrics={'f1_val': 0.7004809549016324, 'auprc': 0.876176923225254, 'loss_val': 0.3769043354778339, 'psi': 0.770759342231081}-{'f1_val': 0.7006083926626743, 'auprc': 0.9866128036424077, 'loss_val': 0.32608074842991225, 'psi': 0.8150101570545676}
[S6] START round=19 head_norm_before_train=1.308264 cos_to_last_merge=0.8293 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.829
[S6] round=19 local utility u=0.000000 metrics={'f1_val': 0.8216351486810441, 'auprc': 0.949534504625319, 'loss_val': 0.3677749996142774, 'psi': 0.8727948910587541}-{'f1_val': 0.9602793441540762, 'auprc': 0.9556385293415296, 'loss_val': 0.30219222642988336, 'psi': 0.9584230182290576}
[S7] START round=19 head_norm_before_train=1.382358 cos_to_last_merge=0.8289 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.829
[S7] round=19 local utility u=0.161671 metrics={'f1_val': 0.6051868251936703, 'auprc': 0.7922313512424319, 'loss_val': 0.6417838138009538, 'psi': 0.680004635613175}-{'f1_val': 0.5689347334944617, 'auprc': 0.7871449499880114, 'loss_val': 0.7323534148066413, 'psi': 0.6562188200918816}
[S8] START round=19 head_norm_before_train=1.095395 cos_to_last_merge=1.0000 (last merge round=18)
[S8] round=19 local utility u=0.225714 metrics={'f1_val': 0.6550634210237409, 'auprc': 0.9957820561086649, 'loss_val': 0.521054640167883, 'psi': 0.7913508750577105}-{'f1_val': 0.6550602073380677, 'auprc': 0.865385244174543, 'loss_val': 0.5812731784807131, 'psi': 0.7391902220726578}
[S9] START round=19 head_norm_before_train=1.008429 cos_to_last_merge=1.0000 (last merge round=18)
[S9] round=19 local utility u=0.000000 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.9979889667073298, 'loss_val': 0.32258960669065995, 'psi': 0.8200143873144374}-{'f1_val': 0.7013646677191758, 'auprc': 0.9980954862166146, 'loss_val': 0.30237557119531505, 'psi': 0.8200569951181513}
[S10] START round=19 head_norm_before_train=1.458295 cos_to_last_merge=0.8477 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.848
[S10] round=19 local utility u=0.010359 metrics={'f1_val': 0.9951279124444816, 'auprc': 0.9957786617672776, 'loss_val': 0.12982822909473404, 'psi': 0.9953882121736}-{'f1_val': 0.9954430117283648, 'auprc': 0.9966635200544178, 'loss_val': 0.15509217096589475, 'psi': 0.995931215058786}
[S11] START round=19 head_norm_before_train=1.790511 cos_to_last_merge=1.0000 (last merge round=18)
[S11] round=19 local utility u=0.002198 metrics={'f1_val': 0.9967189926998994, 'auprc': 0.9976845975706374, 'loss_val': 0.14805815156820631, 'psi': 0.9971052346481946}-{'f1_val': 0.996960829744628, 'auprc': 0.9975305291987326, 'loss_val': 0.15344275271899738, 'psi': 0.9971887095262698}
[S13] START round=19 head_norm_before_train=1.586471 (no previous merge yet)
[S13] round=19 local utility u=0.156650 metrics={'f1_val': 0.6071354168662039, 'auprc': 0.6077905834910373, 'loss_val': 0.6181226856599548, 'psi': 0.6073974835161372}-{'f1_val': 0.5998506832054089, 'auprc': 0.5481941700228332, 'loss_val': 0.7089253404669043, 'psi': 0.5791880779323786}
[S14] START round=19 head_norm_before_train=0.820177 cos_to_last_merge=1.0000 (last merge round=18)
[S14] round=19 local utility u=0.096462 metrics={'f1_val': 0.9943183518468823, 'auprc': 0.9955420519883236, 'loss_val': 0.3908263996919534, 'psi': 0.9948078319034588}-{'f1_val': 0.9465317490259154, 'auprc': 0.9955418802777318, 'loss_val': 0.2970308357343843, 'psi': 0.966135801526642}
[S15] START round=19 head_norm_before_train=1.184128 cos_to_last_merge=1.0000 (last merge round=18)
[S15] round=19 local utility u=0.000000 metrics={'f1_val': 0.6947924414002149, 'auprc': 0.8956663773139457, 'loss_val': 0.4940820274788603, 'psi': 0.7751420157657072}-{'f1_val': 0.6981806593793383, 'auprc': 0.9877418000428647, 'loss_val': 0.45181307111909663, 'psi': 0.8140051156447489}
[S16] START round=19 head_norm_before_train=0.876023 cos_to_last_merge=1.0000 (last merge round=18)
[S16] round=19 local utility u=0.349903 metrics={'f1_val': 0.8280538708298396, 'auprc': 0.7954447626062624, 'loss_val': 0.7618149669872958, 'psi': 0.8150102275404087}-{'f1_val': 0.7360730425903754, 'auprc': 0.7775346951197062, 'loss_val': 0.8560056953687979, 'psi': 0.7526577036021078}
[S17] START round=19 head_norm_before_train=1.533695 (no previous merge yet)
[S17] round=19 local utility u=0.137491 metrics={'f1_val': 0.4092455530364195, 'auprc': 0.8219283022183776, 'loss_val': 1.0373391827284315, 'psi': 0.5743186527092028}-{'f1_val': 0.35423343175441036, 'auprc': 0.825811994886041, 'loss_val': 0.9938996113479558, 'psi': 0.5428648570070626}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:44903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S13] → sending delta(kind=head bytes=1808) to S10@127.0.0.1:44911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:44914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:44910
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:44909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] → sending delta(kind=head bytes=1793) to S2@127.0.0.1:44902
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:44910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:44915
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S11@127.0.0.1:44912
[S4] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1793 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1793 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1808 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1802) from S10
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.480342)
[S9] loaded HEAD from S10 (vec_in norm=1.480342)
[S9] cosine check vs S10: cos=0.9017
[S9] BUFFERED delta from S10 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1808) from S13
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.598201)
[S10] loaded HEAD from S13 (vec_in norm=1.598201)
[S10] cosine check vs S13: cos=-0.0831
[S10] DROPPED delta from S13 (cos=-0.0831 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1796) from S8
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.128753)
[S9] loaded HEAD from S8 (vec_in norm=1.128753)
[S9] cosine check vs S8: cos=0.2592
[S9] BUFFERED delta from S8 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1799) from S2
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.586568)
[S15] loaded HEAD from S2 (vec_in norm=1.586568)
[S15] cosine check vs S2: cos=0.6354
[S15] BUFFERED delta from S2 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1793) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.892032)
[S8] loaded HEAD from S14 (vec_in norm=0.892032)
[S8] cosine check vs S14: cos=0.1734
[S8] BUFFERED delta from S14 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1797) from S11
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.812729)
[S15] loaded HEAD from S11 (vec_in norm=1.812729)
[S15] cosine check vs S11: cos=0.7595
[S15] BUFFERED delta from S11 (total buffered=2)
[S2] RECEIVED delta(kind=head bytes=1793) from S3
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.644965)
[S2] loaded HEAD from S3 (vec_in norm=1.644965)
[S2] cosine check vs S3: cos=0.9553
[S2] BUFFERED delta from S3 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1796) from S16
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.919999)
[S14] loaded HEAD from S16 (vec_in norm=0.919999)
[S14] cosine check vs S16: cos=0.7569
[S14] BUFFERED delta from S16 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1802) from S7
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.395921)
[S3] loaded HEAD from S7 (vec_in norm=1.395921)
[S3] cosine check vs S7: cos=-0.0169
[S3] DROPPED delta from S7 (cos=-0.0169 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1803) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.809661)
[S11] loaded HEAD from S4 (vec_in norm=1.809661)
[S11] cosine check vs S4: cos=0.9955
[S11] BUFFERED delta from S4 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:44903
[S17] sending update (kind=head size=1799 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1799) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.554071)
[S3] loaded HEAD from S17 (vec_in norm=1.554071)
[S3] cosine check vs S17: cos=0.9843
[S3] BUFFERED delta from S17 (total buffered=1)
[S5] r=20 psi=0.771 u=0.0000 p_local=0.0797 f1=0.700 auprc=0.876 bytes=16194
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=19 metric=0.7014 head_norm=1.076449
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.379302e-01
[S9] stored merged vector for next round verification (round=19)
[S9] DEBUG after merge:  round=19 metric=0.7014 head_norm=0.965667 delta_norm=0.237930
[S9] aggregate: ACCEPT kept=['S10', 'S8'] (k=2/2) mode=median trim_p=0.1
[S9] r=20 psi=0.820 u=0.0000 p_local=0.0643 f1=0.701 auprc=0.998 bytes=14370
[S6] r=20 psi=0.873 u=0.0000 p_local=0.2333 f1=0.822 auprc=0.950 bytes=16145
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=19 metric=0.9943 head_norm=0.892032
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.161272e-01
[S14] stored merged vector for next round verification (round=19)
[S14] DEBUG after merge:  round=19 metric=0.9956 head_norm=0.849190 delta_norm=0.316127
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S14] r=20 psi=0.995 u=0.0965 p_local=0.1142 f1=0.994 auprc=0.996 bytes=14389
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=19 metric=0.9967 head_norm=1.812729
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.631644e-02
[S11] stored merged vector for next round verification (round=19)
[S11] DEBUG after merge:  round=19 metric=0.9967 head_norm=1.809137 delta_norm=0.086316
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] r=20 psi=0.997 u=0.0022 p_local=0.1823 f1=0.997 auprc=0.998 bytes=19767
[S16] r=20 psi=0.815 u=0.3499 p_local=0.3045 f1=0.828 auprc=0.795 bytes=16162
[S13] r=20 psi=0.607 u=0.1567 p_local=0.1315 f1=0.607 auprc=0.608 bytes=12608
[S4] r=20 psi=0.951 u=0.0232 p_local=0.1341 f1=0.944 auprc=0.961 bytes=17984
[S7] r=20 psi=0.680 u=0.1617 p_local=0.1266 f1=0.605 auprc=0.792 bytes=16170
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=19 metric=0.9820 head_norm=1.644965
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.488774e-01
[S3] stored merged vector for next round verification (round=19)
[S3] DEBUG after merge:  round=19 metric=0.9740 head_norm=1.593223 delta_norm=0.148877
[S3] aggregate: ROLLBACK (f1_val pre=0.982 post=0.974 tol_abs=0.005 tol_rel=0.0)
[S3] r=20 psi=0.989 u=1.0000 p_local=0.3069 f1=0.982 auprc=0.998 bytes=16176
[S10] r=20 psi=0.995 u=0.0104 p_local=0.1672 f1=0.995 auprc=0.996 bytes=19794
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=19 metric=0.6551 head_norm=1.128753
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.558780e-01
[S8] stored merged vector for next round verification (round=19)
[S8] DEBUG after merge:  round=19 metric=0.9884 head_norm=0.777641 delta_norm=0.655878
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S8] r=20 psi=0.791 u=0.2257 p_local=0.2895 f1=0.655 auprc=0.996 bytes=17984
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=19 metric=0.7016 head_norm=1.586568
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.433084e-01
[S2] stored merged vector for next round verification (round=19)
[S2] DEBUG after merge:  round=19 metric=0.7016 head_norm=1.597609 delta_norm=0.243308
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] r=20 psi=0.689 u=0.0067 p_local=0.0622 f1=0.702 auprc=0.670 bytes=19762
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=19 metric=0.6948 head_norm=1.217425
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.430861e-02
[S15] stored merged vector for next round verification (round=19)
[S15] DEBUG after merge:  round=19 metric=0.6947 head_norm=1.207830 delta_norm=0.084309
[S15] aggregate: ACCEPT kept=['S2', 'S11'] (k=2/2) mode=median trim_p=0.1
[S15] r=20 psi=0.775 u=0.0000 p_local=0.1862 f1=0.695 auprc=0.896 bytes=16171
[S17] r=20 psi=0.574 u=0.1375 p_local=0.1197 f1=0.409 auprc=0.822 bytes=17963
[S2] START round=20 head_norm_before_train=1.597609 cos_to_last_merge=1.0000 (last merge round=19)
[S2] round=20 local utility u=0.000000 metrics={'f1_val': 0.7010525544289868, 'auprc': 0.674819743672842, 'loss_val': 0.3479972432355051, 'psi': 0.690559430126529}-{'f1_val': 0.7015719066528542, 'auprc': 0.6697508155513814, 'loss_val': 0.3200463420055119, 'psi': 0.688843470212265}
[S3] START round=20 head_norm_before_train=1.593223 cos_to_last_merge=1.0000 (last merge round=19)
[S3] round=20 local utility u=0.000000 metrics={'f1_val': 0.850221655946152, 'auprc': 0.9845426291076392, 'loss_val': 0.3653956654979641, 'psi': 0.9039500452107468}-{'f1_val': 0.9820281436931092, 'auprc': 0.9983474409849458, 'loss_val': 0.13262392563508268, 'psi': 0.9885558626098438}
[S4] START round=20 head_norm_before_train=1.809661 (no previous merge yet)
[S4] round=20 local utility u=0.036000 metrics={'f1_val': 0.9510610616617015, 'auprc': 0.9662169526950776, 'loss_val': 0.267722086498923, 'psi': 0.9571234180750519}-{'f1_val': 0.9439176816471346, 'auprc': 0.9612471473953328, 'loss_val': 0.28195293154819323, 'psi': 0.9508494679464139}
[S5] START round=20 head_norm_before_train=1.204783 cos_to_last_merge=0.9981 (last merge round=18)
[S5] round=20 local utility u=0.000000 metrics={'f1_val': 0.43676623050537206, 'auprc': 0.8530064848984285, 'loss_val': 0.8901713596150624, 'psi': 0.6032623322625946}-{'f1_val': 0.7004809549016324, 'auprc': 0.876176923225254, 'loss_val': 0.3769043354778339, 'psi': 0.770759342231081}
[S6] START round=20 head_norm_before_train=1.331438 cos_to_last_merge=0.8245 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.825
[S6] round=20 local utility u=0.524900 metrics={'f1_val': 0.9602126425003467, 'auprc': 0.9682708438531358, 'loss_val': 0.20564848820323103, 'psi': 0.9634359230414622}-{'f1_val': 0.8216351486810441, 'auprc': 0.949534504625319, 'loss_val': 0.3677749996142774, 'psi': 0.8727948910587541}
[S7] START round=20 head_norm_before_train=1.395921 cos_to_last_merge=0.8272 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.827
[S7] round=20 local utility u=0.321494 metrics={'f1_val': 0.6592005825519247, 'auprc': 0.8267614449289915, 'loss_val': 0.42646918214236523, 'psi': 0.7262249275027515}-{'f1_val': 0.6051868251936703, 'auprc': 0.7922313512424319, 'loss_val': 0.6417838138009538, 'psi': 0.680004635613175}
[S8] START round=20 head_norm_before_train=0.777641 cos_to_last_merge=1.0000 (last merge round=19)
[S8] round=20 local utility u=0.996917 metrics={'f1_val': 0.9959789603727395, 'auprc': 0.9940463092547812, 'loss_val': 0.5675068994162866, 'psi': 0.9952058999255562}-{'f1_val': 0.6550634210237409, 'auprc': 0.9957820561086649, 'loss_val': 0.521054640167883, 'psi': 0.7913508750577105}
[S9] START round=20 head_norm_before_train=0.965667 cos_to_last_merge=1.0000 (last merge round=19)
[S9] round=20 local utility u=0.002879 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.9985041592170645, 'loss_val': 0.31837657315015816, 'psi': 0.8202204643183313}-{'f1_val': 0.7013646677191758, 'auprc': 0.9979889667073298, 'loss_val': 0.32258960669065995, 'psi': 0.8200143873144374}
[S10] START round=20 head_norm_before_train=1.480342 cos_to_last_merge=0.8455 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.846
[S10] round=20 local utility u=0.002627 metrics={'f1_val': 0.9945528553774142, 'auprc': 0.9928849207403416, 'loss_val': 0.11244283320107447, 'psi': 0.9938856815225852}-{'f1_val': 0.9951279124444816, 'auprc': 0.9957786617672776, 'loss_val': 0.12982822909473404, 'psi': 0.9953882121736}
[S11] START round=20 head_norm_before_train=1.809137 cos_to_last_merge=1.0000 (last merge round=19)
[S11] round=20 local utility u=0.002213 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9974592323219068, 'loss_val': 0.14047324238375059, 'psi': 0.9967667934100792}-{'f1_val': 0.9967189926998994, 'auprc': 0.9976845975706374, 'loss_val': 0.14805815156820631, 'psi': 0.9971052346481946}
[S13] START round=20 head_norm_before_train=1.598201 (no previous merge yet)
[S13] round=20 local utility u=0.000000 metrics={'f1_val': 0.5807281876100379, 'auprc': 0.6936604651389389, 'loss_val': 0.7694269432111794, 'psi': 0.6259010986215983}-{'f1_val': 0.6071354168662039, 'auprc': 0.6077905834910373, 'loss_val': 0.6181226856599548, 'psi': 0.6073974835161372}
[S14] START round=20 head_norm_before_train=0.849190 cos_to_last_merge=1.0000 (last merge round=19)
[S14] round=20 local utility u=0.000000 metrics={'f1_val': 0.9934807235898097, 'auprc': 0.9954661456322198, 'loss_val': 0.42878671555847314, 'psi': 0.9942748924067737}-{'f1_val': 0.9943183518468823, 'auprc': 0.9955420519883236, 'loss_val': 0.3908263996919534, 'psi': 0.9948078319034588}
[S15] START round=20 head_norm_before_train=1.207830 cos_to_last_merge=1.0000 (last merge round=19)
[S15] round=20 local utility u=0.226708 metrics={'f1_val': 0.7091893840168764, 'auprc': 0.987535514064539, 'loss_val': 0.4026559222481608, 'psi': 0.8205278360359414}-{'f1_val': 0.6947924414002149, 'auprc': 0.8956663773139457, 'loss_val': 0.4940820274788603, 'psi': 0.7751420157657072}
[S16] START round=20 head_norm_before_train=0.919999 cos_to_last_merge=0.9960 (last merge round=18)
[S16] round=20 local utility u=0.000000 metrics={'f1_val': 0.5673802564247831, 'auprc': 0.8296797993316241, 'loss_val': 0.705194629710666, 'psi': 0.6723000735875195}-{'f1_val': 0.8280538708298396, 'auprc': 0.7954447626062624, 'loss_val': 0.7618149669872958, 'psi': 0.8150102275404087}
[S17] START round=20 head_norm_before_train=1.554071 (no previous merge yet)
[S17] round=20 local utility u=0.000000 metrics={'f1_val': 0.3545343993004416, 'auprc': 0.8208899384839545, 'loss_val': 1.1311131939876906, 'psi': 0.5410766149738468}-{'f1_val': 0.4092455530364195, 'auprc': 0.8219283022183776, 'loss_val': 1.0373391827284315, 'psi': 0.5743186527092028}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:44910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:44903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:44910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:44909
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:44912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:44905
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1805 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1801) from S7
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.409298)
[S3] loaded HEAD from S7 (vec_in norm=1.409298)
[S3] cosine check vs S7: cos=-0.0167
[S3] DROPPED delta from S7 (cos=-0.0167 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1802) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.826173)
[S11] loaded HEAD from S4 (vec_in norm=1.826173)
[S11] cosine check vs S4: cos=0.9973
[S11] BUFFERED delta from S4 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1801) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.038475)
[S16] loaded HEAD from S9 (vec_in norm=1.038475)
[S16] cosine check vs S9: cos=0.8301
[S16] BUFFERED delta from S9 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1804) from S10
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.504438)
[S9] loaded HEAD from S10 (vec_in norm=1.504438)
[S9] cosine check vs S10: cos=0.8579
[S9] BUFFERED delta from S10 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1800) from S8
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.816684)
[S9] loaded HEAD from S8 (vec_in norm=0.816684)
[S9] cosine check vs S8: cos=0.5461
[S9] BUFFERED delta from S8 (total buffered=2)
[S5] RECEIVED delta(kind=head bytes=1805) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.235986)
[S5] loaded HEAD from S15 (vec_in norm=1.235986)
[S5] cosine check vs S15: cos=0.9310
[S5] BUFFERED delta from S15 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1802) from S6
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.351345)
[S8] loaded HEAD from S6 (vec_in norm=1.351345)
[S8] cosine check vs S6: cos=0.6833
[S8] BUFFERED delta from S6 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1802) from S11
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.833766)
[S15] loaded HEAD from S11 (vec_in norm=1.833766)
[S15] cosine check vs S11: cos=0.7539
[S15] BUFFERED delta from S11 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=20 metric=0.4368 head_norm=1.258328
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.319698e-01
[S5] stored merged vector for next round verification (round=20)
[S5] DEBUG after merge:  round=20 metric=0.4368 head_norm=1.225445 delta_norm=0.231970
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.064 → S16@127.0.0.1:44916
[S3] ⇄ pheromone p=0.246 → S2@127.0.0.1:44902
[S14] ⇄ pheromone p=0.091 → S8@127.0.0.1:44909
[S13] ⇄ pheromone p=0.105 → S10@127.0.0.1:44911
[S2] ⇄ pheromone p=0.050 → S15@127.0.0.1:44915
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=20 metric=0.9960 head_norm=0.816684
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.962274e-01
[S8] stored merged vector for next round verification (round=20)
[S8] DEBUG after merge:  round=20 metric=0.9965 head_norm=1.000156 delta_norm=0.496227
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.431 → S9@127.0.0.1:44910
[S4] ⇄ pheromone p=0.114 → S11@127.0.0.1:44912
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=20 metric=0.9963 head_norm=1.833766
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.711289e-02
[S11] stored merged vector for next round verification (round=20)
[S11] DEBUG after merge:  round=20 metric=0.9963 head_norm=1.828742 delta_norm=0.067113
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.146 → S15@127.0.0.1:44915
[S6] ⇄ pheromone p=0.292 → S8@127.0.0.1:44909
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=20 metric=0.7092 head_norm=1.235986
[S15] _apply_head_vector_avg (torch): Δ‖w‖=6.067817e-01
[S15] stored merged vector for next round verification (round=20)
[S15] DEBUG after merge:  round=20 metric=0.7583 head_norm=1.441178 delta_norm=0.606782
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.194 → S5@127.0.0.1:44905
[S10] ⇄ pheromone p=0.134 → S9@127.0.0.1:44910
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=20 metric=0.7014 head_norm=1.038475
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.489993e-01
[S9] stored merged vector for next round verification (round=20)
[S9] DEBUG after merge:  round=20 metric=0.7014 head_norm=0.961220 delta_norm=0.148999
[S9] aggregate: ACCEPT kept=['S10', 'S8'] (k=2/2) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.052 → S16@127.0.0.1:44916
[S7] ⇄ pheromone p=0.166 → S3@127.0.0.1:44903
[S17] ⇄ pheromone p=0.096 → S3@127.0.0.1:44903
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=20 metric=0.5674 head_norm=0.967514
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.943378e-01
[S16] stored merged vector for next round verification (round=20)
[S16] DEBUG after merge:  round=20 metric=0.7794 head_norm=0.959490 delta_norm=0.294338
[S16] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.244 → S14@127.0.0.1:44914
[S2] START round=21 head_norm_before_train=1.620208 cos_to_last_merge=0.9997 (last merge round=19)
[S2] round=21 local utility u=0.001144 metrics={'f1_val': 0.700690975227825, 'auprc': 0.6767571372780503, 'loss_val': 0.34935224291890554, 'psi': 0.6911174400479152}-{'f1_val': 0.7010525544289868, 'auprc': 0.674819743672842, 'loss_val': 0.3479972432355051, 'psi': 0.690559430126529}
[S3] START round=21 head_norm_before_train=1.623416 cos_to_last_merge=0.9995 (last merge round=19)
[S3] round=21 local utility u=0.309033 metrics={'f1_val': 0.9226405614370743, 'auprc': 0.9929189879798644, 'loss_val': 0.20697182459800018, 'psi': 0.9507519320541903}-{'f1_val': 0.850221655946152, 'auprc': 0.9845426291076392, 'loss_val': 0.3653956654979641, 'psi': 0.9039500452107468}
[S4] START round=21 head_norm_before_train=1.826173 (no previous merge yet)
[S4] round=21 local utility u=0.000000 metrics={'f1_val': 0.9476508382737512, 'auprc': 0.9648890230559939, 'loss_val': 0.2559435781858092, 'psi': 0.9545461121866483}-{'f1_val': 0.9510610616617015, 'auprc': 0.9662169526950776, 'loss_val': 0.267722086498923, 'psi': 0.9571234180750519}
[S5] START round=21 head_norm_before_train=1.225445 cos_to_last_merge=1.0000 (last merge round=20)
[S5] round=21 local utility u=1.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9863552992588254, 'loss_val': 0.31172176238514543, 'psi': 0.8147344787983455}-{'f1_val': 0.43676623050537206, 'auprc': 0.8530064848984285, 'loss_val': 0.8901713596150624, 'psi': 0.6032623322625946}
[S6] START round=21 head_norm_before_train=1.351345 cos_to_last_merge=0.8203 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.820
[S6] round=21 local utility u=0.000000 metrics={'f1_val': 0.6058706531074269, 'auprc': 0.7823678528779068, 'loss_val': 0.7501188072451848, 'psi': 0.676469533015619}-{'f1_val': 0.9602126425003467, 'auprc': 0.9682708438531358, 'loss_val': 0.20564848820323103, 'psi': 0.9634359230414622}
[S7] START round=21 head_norm_before_train=1.409298 cos_to_last_merge=0.8265 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.827
[S7] round=21 local utility u=0.000000 metrics={'f1_val': 0.5771866687125398, 'auprc': 0.7866958823575271, 'loss_val': 0.7638989086338842, 'psi': 0.6609903541705346}-{'f1_val': 0.6592005825519247, 'auprc': 0.8267614449289915, 'loss_val': 0.42646918214236523, 'psi': 0.7262249275027515}
[S8] START round=21 head_norm_before_train=1.000156 cos_to_last_merge=1.0000 (last merge round=20)
[S8] round=21 local utility u=0.063690 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9972002681006285, 'loss_val': 0.4518334291667166, 'psi': 0.9966919522016262}-{'f1_val': 0.9959789603727395, 'auprc': 0.9940463092547812, 'loss_val': 0.5675068994162866, 'psi': 0.9952058999255562}
[S9] START round=21 head_norm_before_train=0.961220 cos_to_last_merge=1.0000 (last merge round=20)
[S9] round=21 local utility u=0.012249 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.9985038202329055, 'loss_val': 0.2938766392562374, 'psi': 0.8202203287246677}-{'f1_val': 0.7013646677191758, 'auprc': 0.9985041592170645, 'loss_val': 0.31837657315015816, 'psi': 0.8202204643183313}
[S10] START round=21 head_norm_before_train=1.504438 cos_to_last_merge=0.8430 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.843
[S10] round=21 local utility u=0.009987 metrics={'f1_val': 0.9947060979488367, 'auprc': 0.9936798757284246, 'loss_val': 0.09577275021597408, 'psi': 0.9942956090606718}-{'f1_val': 0.9945528553774142, 'auprc': 0.9928849207403416, 'loss_val': 0.11244283320107447, 'psi': 0.9938856815225852}
[S11] START round=21 head_norm_before_train=1.828742 cos_to_last_merge=1.0000 (last merge round=20)
[S11] round=21 local utility u=0.005543 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9964914830603786, 'loss_val': 0.12793546947697487, 'psi': 0.9965247959323051}-{'f1_val': 0.996305167468861, 'auprc': 0.9974592323219068, 'loss_val': 0.14047324238375059, 'psi': 0.9967667934100792}
[S13] START round=21 head_norm_before_train=1.612272 (no previous merge yet)
[S13] round=21 local utility u=0.304763 metrics={'f1_val': 0.6506029925285749, 'auprc': 0.6624870778159024, 'loss_val': 0.48562886108511133, 'psi': 0.6553566266435059}-{'f1_val': 0.5807281876100379, 'auprc': 0.6936604651389389, 'loss_val': 0.7694269432111794, 'psi': 0.6259010986215983}
[S14] START round=21 head_norm_before_train=0.913756 cos_to_last_merge=0.9922 (last merge round=19)
[S14] round=21 local utility u=0.000000 metrics={'f1_val': 0.9425917093272638, 'auprc': 0.9951659910981343, 'loss_val': 0.31178575597681984, 'psi': 0.9636214220356121}-{'f1_val': 0.9934807235898097, 'auprc': 0.9954661456322198, 'loss_val': 0.42878671555847314, 'psi': 0.9942748924067737}
[S15] START round=21 head_norm_before_train=1.441178 cos_to_last_merge=1.0000 (last merge round=20)
[S15] round=21 local utility u=0.000000 metrics={'f1_val': 0.6990535378134184, 'auprc': 0.9874016685386368, 'loss_val': 0.4279637300308523, 'psi': 0.8143927901035057}-{'f1_val': 0.7091893840168764, 'auprc': 0.987535514064539, 'loss_val': 0.4026559222481608, 'psi': 0.8205278360359414}
[S16] START round=21 head_norm_before_train=0.959490 cos_to_last_merge=1.0000 (last merge round=20)
[S16] round=21 local utility u=0.891642 metrics={'f1_val': 0.8295296957894088, 'auprc': 0.9005794345662803, 'loss_val': 0.7075059989469527, 'psi': 0.8579495913001575}-{'f1_val': 0.5673802564247831, 'auprc': 0.8296797993316241, 'loss_val': 0.705194629710666, 'psi': 0.6723000735875195}
[S17] START round=21 head_norm_before_train=1.575214 (no previous merge yet)
[S17] round=21 local utility u=0.270507 metrics={'f1_val': 0.4112413017971446, 'auprc': 0.8406786344015501, 'loss_val': 0.9897072734171845, 'psi': 0.5830162348389067}-{'f1_val': 0.3545343993004416, 'auprc': 0.8208899384839545, 'loss_val': 1.1311131939876906, 'psi': 0.5410766149738468}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:44902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:44916
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:44914
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:44916
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] → sending delta(kind=head bytes=1806) to S10@127.0.0.1:44911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S8] → sending delta(kind=head bytes=1790) to S9@127.0.0.1:44910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:44910
[S11] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1790 to 1 peers)
[S13] sending update (kind=head size=1806 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1803) from S10
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.529015)
[S9] loaded HEAD from S10 (vec_in norm=1.529015)
[S9] cosine check vs S10: cos=0.8680
[S9] BUFFERED delta from S10 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1790) from S8
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.043013)
[S9] loaded HEAD from S8 (vec_in norm=1.043013)
[S9] cosine check vs S8: cos=0.4045
[S9] BUFFERED delta from S8 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1797) from S11
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.858079)
[S15] loaded HEAD from S11 (vec_in norm=1.858079)
[S15] cosine check vs S11: cos=0.9546
[S15] BUFFERED delta from S11 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1796) from S2
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.641076)
[S15] loaded HEAD from S2 (vec_in norm=1.641076)
[S15] cosine check vs S2: cos=0.2797
[S15] BUFFERED delta from S2 (total buffered=2)
[S16] RECEIVED delta(kind=head bytes=1800) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.037837)
[S16] loaded HEAD from S9 (vec_in norm=1.037837)
[S16] cosine check vs S9: cos=0.9639
[S16] BUFFERED delta from S9 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1801) from S3
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.648998)
[S2] loaded HEAD from S3 (vec_in norm=1.648998)
[S2] cosine check vs S3: cos=0.9802
[S2] BUFFERED delta from S3 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1806) from S13
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.622029)
[S10] loaded HEAD from S13 (vec_in norm=1.622029)
[S10] cosine check vs S13: cos=-0.0754
[S10] DROPPED delta from S13 (cos=-0.0754 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1802) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.256681)
[S16] loaded HEAD from S5 (vec_in norm=1.256681)
[S16] cosine check vs S5: cos=0.2112
[S16] BUFFERED delta from S5 (total buffered=2)
[S14] RECEIVED delta(kind=head bytes=1797) from S16
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.001713)
[S14] loaded HEAD from S16 (vec_in norm=1.001713)
[S14] cosine check vs S16: cos=0.7938
[S14] BUFFERED delta from S16 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] → sending delta(kind=head bytes=1805) to S3@127.0.0.1:44903
[S17] sending update (kind=head size=1805 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1805) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.597089)
[S3] loaded HEAD from S17 (vec_in norm=1.597089)
[S3] cosine check vs S17: cos=0.9880
[S3] BUFFERED delta from S17 (total buffered=1)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=21 metric=0.9426 head_norm=0.993056
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.202536e-01
[S14] stored merged vector for next round verification (round=21)
[S14] DEBUG after merge:  round=21 metric=0.9463 head_norm=0.944580 delta_norm=0.320254
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=21 metric=0.7007 head_norm=1.641076
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.636460e-01
[S2] stored merged vector for next round verification (round=21)
[S2] DEBUG after merge:  round=21 metric=0.7002 head_norm=1.636882 delta_norm=0.163646
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=21 metric=0.8295 head_norm=1.001713
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.354771e-01
[S16] stored merged vector for next round verification (round=21)
[S16] DEBUG after merge:  round=21 metric=0.8271 head_norm=0.864013 delta_norm=0.335477
[S16] aggregate: ACCEPT kept=['S9', 'S5'] (k=2/2) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=21 metric=0.9226 head_norm=1.648998
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.285366e-01
[S3] stored merged vector for next round verification (round=21)
[S3] DEBUG after merge:  round=21 metric=0.9228 head_norm=1.618154 delta_norm=0.128537
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=21 metric=0.7014 head_norm=1.037837
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.702763e-01
[S9] stored merged vector for next round verification (round=21)
[S9] DEBUG after merge:  round=21 metric=0.7014 head_norm=0.967785 delta_norm=0.170276
[S9] aggregate: ACCEPT kept=['S10', 'S8'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=21 metric=0.6991 head_norm=1.466006
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.202344e-01
[S15] stored merged vector for next round verification (round=21)
[S15] DEBUG after merge:  round=21 metric=0.6996 head_norm=1.318781 delta_norm=0.320234
[S15] aggregate: ACCEPT kept=['S11', 'S2'] (k=2/2) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.636882 cos_to_last_merge=1.0000 (last merge round=21)
[S2] round=22 local utility u=0.013001 metrics={'f1_val': 0.7007484297570562, 'auprc': 0.6821791739422218, 'loss_val': 0.3399612508370153, 'psi': 0.6933207274311224}-{'f1_val': 0.700690975227825, 'auprc': 0.6767571372780503, 'loss_val': 0.34935224291890554, 'psi': 0.6911174400479152}
[S3] START round=22 head_norm_before_train=1.618154 cos_to_last_merge=1.0000 (last merge round=21)
[S3] round=22 local utility u=0.153817 metrics={'f1_val': 0.9611152572344858, 'auprc': 0.9997113780761984, 'loss_val': 0.15056284394731748, 'psi': 0.9765537055711708}-{'f1_val': 0.9226405614370743, 'auprc': 0.9929189879798644, 'loss_val': 0.20697182459800018, 'psi': 0.9507519320541903}
[S4] START round=22 head_norm_before_train=1.840312 (no previous merge yet)
[S4] round=22 local utility u=0.000000 metrics={'f1_val': 0.9461706723180516, 'auprc': 0.9568872623000468, 'loss_val': 0.27669431466930616, 'psi': 0.9504573083108497}-{'f1_val': 0.9476508382737512, 'auprc': 0.9648890230559939, 'loss_val': 0.2559435781858092, 'psi': 0.9545461121866483}
[S5] START round=22 head_norm_before_train=1.256681 cos_to_last_merge=0.9993 (last merge round=20)
[S5] round=22 local utility u=0.000925 metrics={'f1_val': 0.7004069097142683, 'auprc': 0.9801069407264025, 'loss_val': 0.2916441351691877, 'psi': 0.812286922119122}-{'f1_val': 0.700320598491359, 'auprc': 0.9863552992588254, 'loss_val': 0.31172176238514543, 'psi': 0.8147344787983455}
[S6] START round=22 head_norm_before_train=1.371110 cos_to_last_merge=0.8160 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.816
[S6] round=22 local utility u=1.000000 metrics={'f1_val': 0.9863980261797888, 'auprc': 0.9810670097229465, 'loss_val': 0.15018731518938688, 'psi': 0.9842656195970518}-{'f1_val': 0.6058706531074269, 'auprc': 0.7823678528779068, 'loss_val': 0.7501188072451848, 'psi': 0.676469533015619}
[S7] START round=22 head_norm_before_train=1.428452 cos_to_last_merge=0.8253 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.825
[S7] round=22 local utility u=0.111444 metrics={'f1_val': 0.6063506914728745, 'auprc': 0.7895384858013138, 'loss_val': 0.7245222319839838, 'psi': 0.6796258092042502}-{'f1_val': 0.5771866687125398, 'auprc': 0.7866958823575271, 'loss_val': 0.7638989086338842, 'psi': 0.6609903541705346}
[S8] START round=22 head_norm_before_train=1.043013 cos_to_last_merge=0.9975 (last merge round=20)
[S8] round=22 local utility u=0.058679 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9971089435543272, 'loss_val': 0.3333018312932444, 'psi': 0.9965654394618226}-{'f1_val': 0.9963530749356245, 'auprc': 0.9972002681006285, 'loss_val': 0.4518334291667166, 'psi': 0.9966919522016262}
[S9] START round=22 head_norm_before_train=0.967785 cos_to_last_merge=1.0000 (last merge round=21)
[S9] round=22 local utility u=0.008293 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.998446992134808, 'loss_val': 0.2771207680266591, 'psi': 0.8201975974854288}-{'f1_val': 0.7013646677191758, 'auprc': 0.9985038202329055, 'loss_val': 0.2938766392562374, 'psi': 0.8202203287246677}
[S10] START round=22 head_norm_before_train=1.529015 cos_to_last_merge=0.8406 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.841
[S10] round=22 local utility u=0.009171 metrics={'f1_val': 0.9936100131187782, 'auprc': 0.9958125883969755, 'loss_val': 0.07725162584362506, 'psi': 0.9944910432300571}-{'f1_val': 0.9947060979488367, 'auprc': 0.9936798757284246, 'loss_val': 0.09577275021597408, 'psi': 0.9942956090606718}
[S11] START round=22 head_norm_before_train=1.858079 cos_to_last_merge=0.9996 (last merge round=20)
[S11] round=22 local utility u=0.018074 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9978148105021951, 'loss_val': 0.0957566718757485, 'psi': 0.9970541269090318}-{'f1_val': 0.9965470045135896, 'auprc': 0.9964914830603786, 'loss_val': 0.12793546947697487, 'psi': 0.9965247959323051}
[S13] START round=22 head_norm_before_train=1.622029 (no previous merge yet)
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.6090497610638299, 'auprc': 0.6797152736572923, 'loss_val': 0.6813327649728353, 'psi': 0.6373159661012149}-{'f1_val': 0.6506029925285749, 'auprc': 0.6624870778159024, 'loss_val': 0.48562886108511133, 'psi': 0.6553566266435059}
[S14] START round=22 head_norm_before_train=0.944580 cos_to_last_merge=1.0000 (last merge round=21)
[S14] round=22 local utility u=0.000000 metrics={'f1_val': 0.9455518821365693, 'auprc': 0.9963459940307124, 'loss_val': 0.3590682356812556, 'psi': 0.9658695268942266}-{'f1_val': 0.9425917093272638, 'auprc': 0.9951659910981343, 'loss_val': 0.31178575597681984, 'psi': 0.9636214220356121}
[S15] START round=22 head_norm_before_train=1.318781 cos_to_last_merge=1.0000 (last merge round=21)
[S15] round=22 local utility u=0.232548 metrics={'f1_val': 0.7675759527668808, 'auprc': 0.9886420446467439, 'loss_val': 0.3777237875597337, 'psi': 0.856002389518826}-{'f1_val': 0.6990535378134184, 'auprc': 0.9874016685386368, 'loss_val': 0.4279637300308523, 'psi': 0.8143927901035057}
[S16] START round=22 head_norm_before_train=0.864013 cos_to_last_merge=1.0000 (last merge round=21)
[S16] round=22 local utility u=0.224747 metrics={'f1_val': 0.8789032980597657, 'auprc': 0.9242035555582505, 'loss_val': 0.6251254485196144, 'psi': 0.8970234010591597}-{'f1_val': 0.8295296957894088, 'auprc': 0.9005794345662803, 'loss_val': 0.7075059989469527, 'psi': 0.8579495913001575}
[S17] START round=22 head_norm_before_train=1.597089 (no previous merge yet)
[S17] round=22 local utility u=0.322747 metrics={'f1_val': 0.4903499037366349, 'auprc': 0.8617095982136829, 'loss_val': 0.8819582336375719, 'psi': 0.6388937815274541}-{'f1_val': 0.4112413017971446, 'auprc': 0.8406786344015501, 'loss_val': 0.9897072734171845, 'psi': 0.5830162348389067}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:44910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:44903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:44914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:44909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:44916
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:44905
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:44902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:44910
[S3] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1793 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1799) from S10
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.552444)
[S9] loaded HEAD from S10 (vec_in norm=1.552444)
[S9] cosine check vs S10: cos=0.8493
[S9] BUFFERED delta from S10 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1800) from S8
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.091570)
[S9] loaded HEAD from S8 (vec_in norm=1.091570)
[S9] cosine check vs S8: cos=0.4625
[S9] BUFFERED delta from S8 (total buffered=2)
[S5] RECEIVED delta(kind=head bytes=1799) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.347463)
[S5] loaded HEAD from S15 (vec_in norm=1.347463)
[S5] cosine check vs S15: cos=0.9417
[S5] BUFFERED delta from S15 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1801) from S16
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.906967)
[S14] loaded HEAD from S16 (vec_in norm=0.906967)
[S14] cosine check vs S16: cos=0.9196
[S14] BUFFERED delta from S16 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1803) from S6
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.386602)
[S8] loaded HEAD from S6 (vec_in norm=1.386602)
[S8] cosine check vs S6: cos=0.9297
[S8] BUFFERED delta from S6 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1802) from S2
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.653784)
[S15] loaded HEAD from S2 (vec_in norm=1.653784)
[S15] cosine check vs S2: cos=0.4671
[S15] BUFFERED delta from S2 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1797) from S11
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.886783)
[S15] loaded HEAD from S11 (vec_in norm=1.886783)
[S15] cosine check vs S11: cos=0.8781
[S15] BUFFERED delta from S11 (total buffered=2)
[S16] RECEIVED delta(kind=head bytes=1798) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.295723)
[S16] loaded HEAD from S5 (vec_in norm=1.295723)
[S16] cosine check vs S5: cos=0.4969
[S16] BUFFERED delta from S5 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1798) from S3
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.652700)
[S2] loaded HEAD from S3 (vec_in norm=1.652700)
[S2] cosine check vs S3: cos=0.9899
[S2] BUFFERED delta from S3 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1793) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.044429)
[S16] loaded HEAD from S9 (vec_in norm=1.044429)
[S16] cosine check vs S9: cos=0.8620
[S16] BUFFERED delta from S9 (total buffered=2)
[S3] RECEIVED delta(kind=head bytes=1797) from S7
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.440642)
[S3] loaded HEAD from S7 (vec_in norm=1.440642)
[S3] cosine check vs S7: cos=-0.0165
[S3] DROPPED delta from S7 (cos=-0.0165 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:44903
[S17] sending update (kind=head size=1800 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1800) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.617446)
[S3] loaded HEAD from S17 (vec_in norm=1.617446)
[S3] cosine check vs S17: cos=0.9935
[S3] BUFFERED delta from S17 (total buffered=1)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=22 metric=0.9456 head_norm=1.009575
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.985538e-01
[S14] stored merged vector for next round verification (round=22)
[S14] DEBUG after merge:  round=22 metric=0.9536 head_norm=0.938878 delta_norm=0.198554
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=22 metric=0.9611 head_norm=1.652700
[S3] _apply_head_vector_avg (torch): Δ‖w‖=9.469904e-02
[S3] stored merged vector for next round verification (round=22)
[S3] DEBUG after merge:  round=22 metric=0.9611 head_norm=1.632423 delta_norm=0.094699
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=22 metric=0.7007 head_norm=1.653784
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.175977e-01
[S2] stored merged vector for next round verification (round=22)
[S2] DEBUG after merge:  round=22 metric=0.7006 head_norm=1.649054 delta_norm=0.117598
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=22 metric=0.7676 head_norm=1.347463
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.738304e-01
[S15] stored merged vector for next round verification (round=22)
[S15] DEBUG after merge:  round=22 metric=0.7703 head_norm=1.291091 delta_norm=0.173830
[S15] aggregate: ACCEPT kept=['S2', 'S11'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=22 metric=0.9962 head_norm=1.091570
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.738592e-01
[S8] stored merged vector for next round verification (round=22)
[S8] DEBUG after merge:  round=22 metric=0.9962 head_norm=1.217413 delta_norm=0.273859
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=22 metric=0.7004 head_norm=1.295723
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.270764e-01
[S5] stored merged vector for next round verification (round=22)
[S5] DEBUG after merge:  round=22 metric=0.7004 head_norm=1.302196 delta_norm=0.227076
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=22 metric=0.7014 head_norm=1.044429
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.443887e-01
[S9] stored merged vector for next round verification (round=22)
[S9] DEBUG after merge:  round=22 metric=0.9072 head_norm=0.986434 delta_norm=0.144389
[S9] aggregate: ACCEPT kept=['S10', 'S8'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=22 metric=0.8789 head_norm=0.906967
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.950489e-01
[S16] stored merged vector for next round verification (round=22)
[S16] DEBUG after merge:  round=22 metric=0.9210 head_norm=0.859211 delta_norm=0.195049
[S16] aggregate: ACCEPT kept=['S5', 'S9'] (k=2/2) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.649054 cos_to_last_merge=1.0000 (last merge round=22)
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.7000472919661002, 'auprc': 0.6816479890863288, 'loss_val': 0.3542490459980595, 'psi': 0.6926875708141916}-{'f1_val': 0.7007484297570562, 'auprc': 0.6821791739422218, 'loss_val': 0.3399612508370153, 'psi': 0.6933207274311224}
[S3] START round=23 head_norm_before_train=1.632423 cos_to_last_merge=1.0000 (last merge round=22)
[S3] round=23 local utility u=0.022672 metrics={'f1_val': 0.9719047351261174, 'auprc': 0.9979325754396517, 'loss_val': 0.16461998407153303, 'psi': 0.9823158712515311}-{'f1_val': 0.9611152572344858, 'auprc': 0.9997113780761984, 'loss_val': 0.15056284394731748, 'psi': 0.9765537055711708}
[S4] START round=23 head_norm_before_train=1.850364 (no previous merge yet)
[S4] round=23 local utility u=0.000000 metrics={'f1_val': 0.9387006033398457, 'auprc': 0.929442135346535, 'loss_val': 0.27346743951091024, 'psi': 0.9349972161425215}-{'f1_val': 0.9461706723180516, 'auprc': 0.9568872623000468, 'loss_val': 0.27669431466930616, 'psi': 0.9504573083108497}
[S5] START round=23 head_norm_before_train=1.302196 cos_to_last_merge=1.0000 (last merge round=22)
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.8816743963815925, 'loss_val': 0.37194785251268675, 'psi': 0.7728621176474524}-{'f1_val': 0.7004069097142683, 'auprc': 0.9801069407264025, 'loss_val': 0.2916441351691877, 'psi': 0.812286922119122}
[S6] START round=23 head_norm_before_train=1.386602 cos_to_last_merge=0.8127 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.813
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.7345959668005605, 'auprc': 0.8056354958884975, 'loss_val': 0.4704847899275354, 'psi': 0.7630117784357353}-{'f1_val': 0.9863980261797888, 'auprc': 0.9810670097229465, 'loss_val': 0.15018731518938688, 'psi': 0.9842656195970518}
[S7] START round=23 head_norm_before_train=1.440642 cos_to_last_merge=0.8244 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.824
[S7] round=23 local utility u=0.000000 metrics={'f1_val': 0.5349207181629654, 'auprc': 0.7832559912381457, 'loss_val': 0.7690202081821289, 'psi': 0.6342548273930375}-{'f1_val': 0.6063506914728745, 'auprc': 0.7895384858013138, 'loss_val': 0.7245222319839838, 'psi': 0.6796258092042502}
[S8] START round=23 head_norm_before_train=1.217413 cos_to_last_merge=1.0000 (last merge round=22)
[S8] round=23 local utility u=0.027044 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9973024440333363, 'loss_val': 0.2806949587851341, 'psi': 0.9967328225747093}-{'f1_val': 0.9962031034001528, 'auprc': 0.9971089435543272, 'loss_val': 0.3333018312932444, 'psi': 0.9965654394618226}
[S9] START round=23 head_norm_before_train=0.986434 cos_to_last_merge=1.0000 (last merge round=22)
[S9] round=23 local utility u=0.902935 metrics={'f1_val': 0.9963298967426935, 'auprc': 0.9989630155457215, 'loss_val': 0.2425904292026367, 'psi': 0.9973831442639047}-{'f1_val': 0.7013646677191758, 'auprc': 0.998446992134808, 'loss_val': 0.2771207680266591, 'psi': 0.8201975974854288}
[S10] START round=23 head_norm_before_train=1.552444 cos_to_last_merge=0.8382 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.838
[S10] round=23 local utility u=0.004542 metrics={'f1_val': 0.9935856916635499, 'auprc': 0.9956884617961717, 'loss_val': 0.06764931220367397, 'psi': 0.9944267997165986}-{'f1_val': 0.9936100131187782, 'auprc': 0.9958125883969755, 'loss_val': 0.07725162584362506, 'psi': 0.9944910432300571}
[S11] START round=23 head_norm_before_train=1.886783 cos_to_last_merge=0.9987 (last merge round=20)
[S11] round=23 local utility u=0.009041 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9977487342493956, 'loss_val': 0.07747713581480542, 'psi': 0.997027696407912}-{'f1_val': 0.9965470045135896, 'auprc': 0.9978148105021951, 'loss_val': 0.0957566718757485, 'psi': 0.9970541269090318}
[S13] START round=23 head_norm_before_train=1.630261 (no previous merge yet)
[S13] round=23 local utility u=0.114999 metrics={'f1_val': 0.6340738148060219, 'auprc': 0.6646103256729717, 'loss_val': 0.55616451106064, 'psi': 0.6462884191528018}-{'f1_val': 0.6090497610638299, 'auprc': 0.6797152736572923, 'loss_val': 0.6813327649728353, 'psi': 0.6373159661012149}
[S14] START round=23 head_norm_before_train=0.938878 cos_to_last_merge=1.0000 (last merge round=22)
[S14] round=23 local utility u=0.130535 metrics={'f1_val': 0.9890436640530711, 'auprc': 0.9965986153519586, 'loss_val': 0.35970586680169353, 'psi': 0.9920656445726261}-{'f1_val': 0.9455518821365693, 'auprc': 0.9963459940307124, 'loss_val': 0.3590682356812556, 'psi': 0.9658695268942266}
[S15] START round=23 head_norm_before_train=1.291091 cos_to_last_merge=1.0000 (last merge round=22)
[S15] round=23 local utility u=0.000000 metrics={'f1_val': 0.6955230186082217, 'auprc': 0.986828233681107, 'loss_val': 0.415530279712393, 'psi': 0.8120451046373758}-{'f1_val': 0.7675759527668808, 'auprc': 0.9886420446467439, 'loss_val': 0.3777237875597337, 'psi': 0.856002389518826}
[S16] START round=23 head_norm_before_train=0.859211 cos_to_last_merge=1.0000 (last merge round=22)
[S16] round=23 local utility u=0.150950 metrics={'f1_val': 0.9202521070024762, 'auprc': 0.9397252191098646, 'loss_val': 0.6178842403772504, 'psi': 0.9280413518454316}-{'f1_val': 0.8789032980597657, 'auprc': 0.9242035555582505, 'loss_val': 0.6251254485196144, 'psi': 0.8970234010591597}
[S17] START round=23 head_norm_before_train=1.617446 (no previous merge yet)
[S17] round=23 local utility u=0.000000 metrics={'f1_val': 0.34896086336598625, 'auprc': 0.6681375749809485, 'loss_val': 1.1754079187932738, 'psi': 0.47663154801197116}-{'f1_val': 0.4903499037366349, 'auprc': 0.8617095982136829, 'loss_val': 0.8819582336375719, 'psi': 0.6388937815274541}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:44915
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:44910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:44911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:44902
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:44916
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:44910
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:44914
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:44909
[S16] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S9] sending update (kind=head size=1804 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1804) from S10
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.578711)
[S9] loaded HEAD from S10 (vec_in norm=1.578711)
[S9] cosine check vs S10: cos=0.8340
[S9] BUFFERED delta from S10 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1803) from S13
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.637375)
[S10] loaded HEAD from S13 (vec_in norm=1.637375)
[S10] cosine check vs S13: cos=-0.0697
[S10] DROPPED delta from S13 (cos=-0.0697 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1800) from S8
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.256641)
[S9] loaded HEAD from S8 (vec_in norm=1.256641)
[S9] cosine check vs S8: cos=0.4404
[S9] BUFFERED delta from S8 (total buffered=2)
[S8] RECEIVED delta(kind=head bytes=1796) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.002597)
[S8] loaded HEAD from S14 (vec_in norm=1.002597)
[S8] cosine check vs S14: cos=0.2145
[S8] BUFFERED delta from S14 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1797) from S11
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.915421)
[S15] loaded HEAD from S11 (vec_in norm=1.915421)
[S15] cosine check vs S11: cos=0.8211
[S15] BUFFERED delta from S11 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1804) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.063678)
[S16] loaded HEAD from S9 (vec_in norm=1.063678)
[S16] cosine check vs S9: cos=0.7665
[S16] BUFFERED delta from S9 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1796) from S3
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.667471)
[S2] loaded HEAD from S3 (vec_in norm=1.667471)
[S2] cosine check vs S3: cos=0.9945
[S2] BUFFERED delta from S3 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1795) from S16
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.901212)
[S14] loaded HEAD from S16 (vec_in norm=0.901212)
[S14] cosine check vs S16: cos=0.9229
[S14] BUFFERED delta from S16 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=23 metric=0.7000 head_norm=1.667078
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.747863e-02
[S2] stored merged vector for next round verification (round=23)
[S2] DEBUG after merge:  round=23 metric=0.6995 head_norm=1.664978 delta_norm=0.087479
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=23 metric=0.9964 head_norm=1.256641
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.148042e-01
[S8] stored merged vector for next round verification (round=23)
[S8] DEBUG after merge:  round=23 metric=0.9964 head_norm=0.883872 delta_norm=0.714804
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=23 metric=0.9203 head_norm=0.901212
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.442850e-01
[S16] stored merged vector for next round verification (round=23)
[S16] DEBUG after merge:  round=23 metric=0.9302 head_norm=0.923723 delta_norm=0.344285
[S16] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=23 metric=0.9890 head_norm=1.002597
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.933783e-01
[S14] stored merged vector for next round verification (round=23)
[S14] DEBUG after merge:  round=23 metric=0.9937 head_norm=0.933433 delta_norm=0.193378
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=23 metric=0.9963 head_norm=1.063678
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.677307e-01
[S9] stored merged vector for next round verification (round=23)
[S9] DEBUG after merge:  round=23 metric=0.9972 head_norm=1.011277 delta_norm=0.167731
[S9] aggregate: ACCEPT kept=['S10', 'S8'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=23 metric=0.6955 head_norm=1.325856
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.604227e-01
[S15] stored merged vector for next round verification (round=23)
[S15] DEBUG after merge:  round=23 metric=0.6946 head_norm=1.548965 delta_norm=0.560423
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.664978 cos_to_last_merge=1.0000 (last merge round=23)
[S2] round=24 local utility u=0.014453 metrics={'f1_val': 0.7018318238212289, 'auprc': 0.6831249866689002, 'loss_val': 0.3404807008850863, 'psi': 0.6943490889602975}-{'f1_val': 0.7000472919661002, 'auprc': 0.6816479890863288, 'loss_val': 0.3542490459980595, 'psi': 0.6926875708141916}
[S3] START round=24 head_norm_before_train=1.667471 cos_to_last_merge=0.9994 (last merge round=22)
[S3] round=24 local utility u=0.000000 metrics={'f1_val': 0.869549579672957, 'auprc': 0.997487372507289, 'loss_val': 0.2671020318711096, 'psi': 0.9207246968066898}-{'f1_val': 0.9719047351261174, 'auprc': 0.9979325754396517, 'loss_val': 0.16461998407153303, 'psi': 0.9823158712515311}
[S4] START round=24 head_norm_before_train=1.857562 (no previous merge yet)
[S4] round=24 local utility u=0.080677 metrics={'f1_val': 0.9445510052471422, 'auprc': 0.9678210066774613, 'loss_val': 0.26235158139488796, 'psi': 0.9538590058192697}-{'f1_val': 0.9387006033398457, 'auprc': 0.929442135346535, 'loss_val': 0.27346743951091024, 'psi': 0.9349972161425215}
[S5] START round=24 head_norm_before_train=1.341432 cos_to_last_merge=0.9989 (last merge round=22)
[S5] round=24 local utility u=0.248066 metrics={'f1_val': 0.7004945718785263, 'auprc': 0.9924745073031399, 'loss_val': 0.20926018483603942, 'psi': 0.8172865460483717}-{'f1_val': 0.700320598491359, 'auprc': 0.8816743963815925, 'loss_val': 0.37194785251268675, 'psi': 0.7728621176474524}
[S6] START round=24 head_norm_before_train=1.402859 cos_to_last_merge=0.8094 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.809
[S6] round=24 local utility u=0.000000 metrics={'f1_val': 0.6519052966564318, 'auprc': 0.8062674808844112, 'loss_val': 0.45033813885332186, 'psi': 0.7136501703476236}-{'f1_val': 0.7345959668005605, 'auprc': 0.8056354958884975, 'loss_val': 0.4704847899275354, 'psi': 0.7630117784357353}
[S7] START round=24 head_norm_before_train=1.446510 cos_to_last_merge=0.8229 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.823
[S7] round=24 local utility u=0.000000 metrics={'f1_val': 0.46938100137294314, 'auprc': 0.7793261001258449, 'loss_val': 1.0002875787292478, 'psi': 0.5933590408741038}-{'f1_val': 0.5349207181629654, 'auprc': 0.7832559912381457, 'loss_val': 0.7690202081821289, 'psi': 0.6342548273930375}
[S8] START round=24 head_norm_before_train=0.883872 cos_to_last_merge=1.0000 (last merge round=23)
[S8] round=24 local utility u=0.000000 metrics={'f1_val': 0.9964894426023416, 'auprc': 0.9967556672095526, 'loss_val': 0.3541212276874414, 'psi': 0.996595932445226}-{'f1_val': 0.9963530749356245, 'auprc': 0.9973024440333363, 'loss_val': 0.2806949587851341, 'psi': 0.9967328225747093}
[S9] START round=24 head_norm_before_train=1.011277 cos_to_last_merge=1.0000 (last merge round=23)
[S9] round=24 local utility u=0.000000 metrics={'f1_val': 0.9930269256803308, 'auprc': 0.998869583938139, 'loss_val': 0.24106817915708803, 'psi': 0.995363988983454}-{'f1_val': 0.9963298967426935, 'auprc': 0.9989630155457215, 'loss_val': 0.2425904292026367, 'psi': 0.9973831442639047}
[S10] START round=24 head_norm_before_train=1.578711 cos_to_last_merge=0.8357 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.836
[S10] round=24 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9925202863162306, 'loss_val': 0.08130677888904249, 'psi': 0.993989026445538}-{'f1_val': 0.9935856916635499, 'auprc': 0.9956884617961717, 'loss_val': 0.06764931220367397, 'psi': 0.9944267997165986}
[S11] START round=24 head_norm_before_train=1.915421 cos_to_last_merge=0.9974 (last merge round=20)
[S11] round=24 local utility u=0.000000 metrics={'f1_val': 0.985122075700291, 'auprc': 0.997724176298996, 'loss_val': 0.09375891148395157, 'psi': 0.990162915939773}-{'f1_val': 0.9965470045135896, 'auprc': 0.9977487342493956, 'loss_val': 0.07747713581480542, 'psi': 0.997027696407912}
[S13] START round=24 head_norm_before_train=1.637375 (no previous merge yet)
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.6102208074901094, 'auprc': 0.6772028197972221, 'loss_val': 0.7042713459652528, 'psi': 0.6370136124129545}-{'f1_val': 0.6340738148060219, 'auprc': 0.6646103256729717, 'loss_val': 0.55616451106064, 'psi': 0.6462884191528018}
[S14] START round=24 head_norm_before_train=0.933433 cos_to_last_merge=1.0000 (last merge round=23)
[S14] round=24 local utility u=0.016741 metrics={'f1_val': 0.9940995221384037, 'auprc': 0.9982078182743802, 'loss_val': 0.3613875740767329, 'psi': 0.9957428405927943}-{'f1_val': 0.9890436640530711, 'auprc': 0.9965986153519586, 'loss_val': 0.35970586680169353, 'psi': 0.9920656445726261}
[S15] START round=24 head_norm_before_train=1.548965 cos_to_last_merge=1.0000 (last merge round=23)
[S15] round=24 local utility u=0.056528 metrics={'f1_val': 0.7022008590516499, 'auprc': 0.9882147805186341, 'loss_val': 0.3467003769206092, 'psi': 0.8166064276384436}-{'f1_val': 0.6955230186082217, 'auprc': 0.986828233681107, 'loss_val': 0.415530279712393, 'psi': 0.8120451046373758}
[S16] START round=24 head_norm_before_train=0.923723 cos_to_last_merge=1.0000 (last merge round=23)
[S16] round=24 local utility u=0.000000 metrics={'f1_val': 0.8457858110486991, 'auprc': 0.9201183707235916, 'loss_val': 0.703197173692464, 'psi': 0.8755188349186561}-{'f1_val': 0.9202521070024762, 'auprc': 0.9397252191098646, 'loss_val': 0.6178842403772504, 'psi': 0.9280413518454316}
[S17] START round=24 head_norm_before_train=1.636269 (no previous merge yet)
[S17] round=24 local utility u=0.213781 metrics={'f1_val': 0.38241564888970525, 'auprc': 0.6952905576432844, 'loss_val': 1.0300341555359498, 'psi': 0.507565612391137}-{'f1_val': 0.34896086336598625, 'auprc': 0.6681375749809485, 'loss_val': 1.1754079187932738, 'psi': 0.47663154801197116}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:44915
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:44912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:44916
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:44909
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:44905
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1798) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.575851)
[S5] loaded HEAD from S15 (vec_in norm=1.575851)
[S5] cosine check vs S15: cos=0.9203
[S5] BUFFERED delta from S15 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1801) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.864100)
[S11] loaded HEAD from S4 (vec_in norm=1.864100)
[S11] cosine check vs S4: cos=0.9914
[S11] BUFFERED delta from S4 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1795) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.997043)
[S8] loaded HEAD from S14 (vec_in norm=0.997043)
[S8] cosine check vs S14: cos=0.7002
[S8] BUFFERED delta from S14 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1802) from S2
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.685732)
[S15] loaded HEAD from S2 (vec_in norm=1.685732)
[S15] cosine check vs S2: cos=0.2513
[S15] BUFFERED delta from S2 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1800) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.379621)
[S16] loaded HEAD from S5 (vec_in norm=1.379621)
[S16] cosine check vs S5: cos=0.3310
[S16] BUFFERED delta from S5 (total buffered=1)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:44903
[S17] sending update (kind=head size=1803 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1803) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.652120)
[S3] loaded HEAD from S17 (vec_in norm=1.652120)
[S3] cosine check vs S17: cos=0.9924
[S3] BUFFERED delta from S17 (total buffered=1)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=24 metric=0.9851 head_norm=1.942364
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.305621e-01
[S11] stored merged vector for next round verification (round=24)
[S11] DEBUG after merge:  round=24 metric=0.9765 head_norm=1.899152 delta_norm=0.130562
[S11] aggregate: ROLLBACK (f1_val pre=0.985 post=0.976 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=24 metric=0.7005 head_norm=1.379621
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.102013e-01
[S5] stored merged vector for next round verification (round=24)
[S5] DEBUG after merge:  round=24 metric=0.7004 head_norm=1.448139 delta_norm=0.310201
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=24 metric=0.7022 head_norm=1.575851
[S15] _apply_head_vector_avg (torch): Δ‖w‖=9.987291e-01
[S15] stored merged vector for next round verification (round=24)
[S15] DEBUG after merge:  round=24 metric=0.7022 head_norm=1.290364 delta_norm=0.998729
[S15] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=24 metric=0.8458 head_norm=0.969778
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.996758e-01
[S16] stored merged vector for next round verification (round=24)
[S16] DEBUG after merge:  round=24 metric=0.8359 head_norm=0.965591 delta_norm=0.699676
[S16] aggregate: ROLLBACK (f1_val pre=0.846 post=0.836 tol_abs=0.005 tol_rel=0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=24 metric=0.8695 head_norm=1.700704
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.063088e-01
[S3] stored merged vector for next round verification (round=24)
[S3] DEBUG after merge:  round=24 metric=0.8700 head_norm=1.673214 delta_norm=0.106309
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=24 metric=0.9965 head_norm=0.934032
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.749359e-01
[S8] stored merged vector for next round verification (round=24)
[S8] DEBUG after merge:  round=24 metric=0.8082 head_norm=0.890325 delta_norm=0.374936
[S8] aggregate: ROLLBACK (f1_val pre=0.996 post=0.808 tol_abs=0.005 tol_rel=0.0)
[S2] START round=25 head_norm_before_train=1.685732 cos_to_last_merge=0.9997 (last merge round=23)
[S2] round=25 local utility u=0.000000 metrics={'f1_val': 0.6808214373622918, 'auprc': 0.6859304359272752, 'loss_val': 0.3487515166495285, 'psi': 0.6828650367882851}-{'f1_val': 0.7018318238212289, 'auprc': 0.6831249866689002, 'loss_val': 0.3404807008850863, 'psi': 0.6943490889602975}
[S3] START round=25 head_norm_before_train=1.673214 cos_to_last_merge=1.0000 (last merge round=24)
[S3] round=25 local utility u=0.277138 metrics={'f1_val': 0.948576416758251, 'auprc': 0.9960800892506789, 'loss_val': 0.18276422231659145, 'psi': 0.9675778857552222}-{'f1_val': 0.869549579672957, 'auprc': 0.997487372507289, 'loss_val': 0.2671020318711096, 'psi': 0.9207246968066898}
[S4] START round=25 head_norm_before_train=1.864100 (no previous merge yet)
[S4] round=25 local utility u=0.025259 metrics={'f1_val': 0.9524474059075616, 'auprc': 0.9653155252665429, 'loss_val': 0.2516959214375069, 'psi': 0.9575946536511541}-{'f1_val': 0.9445510052471422, 'auprc': 0.9678210066774613, 'loss_val': 0.26235158139488796, 'psi': 0.9538590058192697}
[S5] START round=25 head_norm_before_train=1.448139 cos_to_last_merge=1.0000 (last merge round=24)
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.41726206372792607, 'auprc': 0.6953766939560819, 'loss_val': 1.2208819224915586, 'psi': 0.5285079158191884}-{'f1_val': 0.7004945718785263, 'auprc': 0.9924745073031399, 'loss_val': 0.20926018483603942, 'psi': 0.8172865460483717}
[S6] START round=25 head_norm_before_train=1.418108 cos_to_last_merge=0.8063 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.806
[S6] round=25 local utility u=1.000000 metrics={'f1_val': 0.9691297707345827, 'auprc': 0.9845214959563461, 'loss_val': 0.14495041507520662, 'psi': 0.9752864608232881}-{'f1_val': 0.6519052966564318, 'auprc': 0.8062674808844112, 'loss_val': 0.45033813885332186, 'psi': 0.7136501703476236}
[S7] START round=25 head_norm_before_train=1.461318 cos_to_last_merge=0.8215 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.822
[S7] round=25 local utility u=0.022254 metrics={'f1_val': 0.47355303473099997, 'auprc': 0.7808596787966489, 'loss_val': 0.9854118189918144, 'psi': 0.5964756923572595}-{'f1_val': 0.46938100137294314, 'auprc': 0.7793261001258449, 'loss_val': 1.0002875787292478, 'psi': 0.5933590408741038}
[S8] START round=25 head_norm_before_train=0.890325 cos_to_last_merge=1.0000 (last merge round=24)
[S8] round=25 local utility u=0.000000 metrics={'f1_val': 0.9965458537967758, 'auprc': 0.9972317082532132, 'loss_val': 0.41850355486065377, 'psi': 0.9968201955793508}-{'f1_val': 0.9964894426023416, 'auprc': 0.9967556672095526, 'loss_val': 0.3541212276874414, 'psi': 0.996595932445226}
[S9] START round=25 head_norm_before_train=1.088300 cos_to_last_merge=0.9945 (last merge round=23)
[S9] round=25 local utility u=0.050483 metrics={'f1_val': 0.9971609471241525, 'auprc': 0.9987985887562312, 'loss_val': 0.16469333108506454, 'psi': 0.997816003776984}-{'f1_val': 0.9930269256803308, 'auprc': 0.998869583938139, 'loss_val': 0.24106817915708803, 'psi': 0.995363988983454}
[S10] START round=25 head_norm_before_train=1.605758 cos_to_last_merge=0.8335 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.833
[S10] round=25 local utility u=0.014515 metrics={'f1_val': 0.9942674420396322, 'auprc': 0.9951496245381013, 'loss_val': 0.0559607545336445, 'psi': 0.9946203150390199}-{'f1_val': 0.9949681865317428, 'auprc': 0.9925202863162306, 'loss_val': 0.08130677888904249, 'psi': 0.993989026445538}
[S11] START round=25 head_norm_before_train=1.899152 cos_to_last_merge=1.0000 (last merge round=24)
[S11] round=25 local utility u=0.047889 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9979393430281663, 'loss_val': 0.06717663829452658, 'psi': 0.9971039399194203}-{'f1_val': 0.985122075700291, 'auprc': 0.997724176298996, 'loss_val': 0.09375891148395157, 'psi': 0.990162915939773}
[S13] START round=25 head_norm_before_train=1.646027 (no previous merge yet)
[S13] round=25 local utility u=0.072038 metrics={'f1_val': 0.6279352411031187, 'auprc': 0.6663589414889732, 'loss_val': 0.6339499358043008, 'psi': 0.6433047212574605}-{'f1_val': 0.6102208074901094, 'auprc': 0.6772028197972221, 'loss_val': 0.7042713459652528, 'psi': 0.6370136124129545}
[S14] START round=25 head_norm_before_train=0.997043 cos_to_last_merge=0.9939 (last merge round=23)
[S14] round=25 local utility u=0.000000 metrics={'f1_val': 0.9643316323993956, 'auprc': 0.9985743493974931, 'loss_val': 0.25853434347241283, 'psi': 0.9780287191986345}-{'f1_val': 0.9940995221384037, 'auprc': 0.9982078182743802, 'loss_val': 0.3613875740767329, 'psi': 0.9957428405927943}
[S15] START round=25 head_norm_before_train=1.290364 cos_to_last_merge=1.0000 (last merge round=24)
[S15] round=25 local utility u=0.306669 metrics={'f1_val': 0.8024643562235952, 'auprc': 0.9877444753324537, 'loss_val': 0.3335333409823803, 'psi': 0.8765764038671386}-{'f1_val': 0.7022008590516499, 'auprc': 0.9882147805186341, 'loss_val': 0.3467003769206092, 'psi': 0.8166064276384436}
[S16] START round=25 head_norm_before_train=0.965591 cos_to_last_merge=1.0000 (last merge round=24)
[S16] round=25 local utility u=0.567553 metrics={'f1_val': 0.9805143104950205, 'auprc': 0.9778141368798368, 'loss_val': 0.5495489582624119, 'psi': 0.9794342410489469}-{'f1_val': 0.8457858110486991, 'auprc': 0.9201183707235916, 'loss_val': 0.703197173692464, 'psi': 0.8755188349186561}
[S17] START round=25 head_norm_before_train=1.652120 (no previous merge yet)
[S17] round=25 local utility u=0.824618 metrics={'f1_val': 0.5661353127927282, 'auprc': 0.8109439573518077, 'loss_val': 0.8300767924128932, 'psi': 0.6640587706163601}-{'f1_val': 0.38241564888970525, 'auprc': 0.6952905576432844, 'loss_val': 1.0300341555359498, 'psi': 0.507565612391137}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:44902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:44909
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:44912
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:44903
[S11] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1796) from S11
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.921825)
[S15] loaded HEAD from S11 (vec_in norm=1.921825)
[S15] cosine check vs S11: cos=0.5946
[S15] BUFFERED delta from S11 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1797) from S6
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.433503)
[S8] loaded HEAD from S6 (vec_in norm=1.433503)
[S8] cosine check vs S6: cos=0.4717
[S8] BUFFERED delta from S6 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1795) from S3
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.711532)
[S2] loaded HEAD from S3 (vec_in norm=1.711532)
[S2] cosine check vs S3: cos=0.9953
[S2] BUFFERED delta from S3 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1798) from S7
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.471796)
[S3] loaded HEAD from S7 (vec_in norm=1.471796)
[S3] cosine check vs S7: cos=-0.0177
[S3] DROPPED delta from S7 (cos=-0.0177 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1800) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.872068)
[S11] loaded HEAD from S4 (vec_in norm=1.872068)
[S11] cosine check vs S4: cos=0.9965
[S11] BUFFERED delta from S4 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S10@127.0.0.1:44911
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1804 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1804) from S13
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.659346)
[S10] loaded HEAD from S13 (vec_in norm=1.659346)
[S10] cosine check vs S13: cos=-0.0647
[S10] DROPPED delta from S13 (cos=-0.0647 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:44905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:44914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:44910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:44916
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1797) from S16
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.003974)
[S14] loaded HEAD from S16 (vec_in norm=1.003974)
[S14] cosine check vs S16: cos=0.8277
[S14] BUFFERED delta from S16 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1800) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.314186)
[S5] loaded HEAD from S15 (vec_in norm=1.314186)
[S5] cosine check vs S15: cos=0.8503
[S5] BUFFERED delta from S15 (total buffered=1)
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1802) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.161883)
[S16] loaded HEAD from S9 (vec_in norm=1.161883)
[S16] cosine check vs S9: cos=0.4995
[S16] BUFFERED delta from S9 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1800) from S10
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.630235)
[S9] loaded HEAD from S10 (vec_in norm=1.630235)
[S9] cosine check vs S10: cos=0.8013
[S9] BUFFERED delta from S10 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:44903
[S17] sending update (kind=head size=1802 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1802) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.666788)
[S3] loaded HEAD from S17 (vec_in norm=1.666788)
[S3] cosine check vs S17: cos=0.9954
[S3] BUFFERED delta from S17 (total buffered=1)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=25 metric=0.6808 head_norm=1.709069
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.270658e-02
[S2] stored merged vector for next round verification (round=25)
[S2] DEBUG after merge:  round=25 metric=0.6583 head_norm=1.708300 delta_norm=0.082707
[S2] aggregate: ROLLBACK (f1_val pre=0.681 post=0.658 tol_abs=0.005 tol_rel=0.0)
[S2] ⇄ pheromone p=0.020 → S15@127.0.0.1:44915
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=25 metric=0.9965 head_norm=0.939698
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.455978e-01
[S8] stored merged vector for next round verification (round=25)
[S8] DEBUG after merge:  round=25 metric=0.9965 head_norm=1.025761 delta_norm=0.645598
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.156 → S9@127.0.0.1:44910
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=25 metric=0.4173 head_norm=1.469576
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.880288e-01
[S5] stored merged vector for next round verification (round=25)
[S5] DEBUG after merge:  round=25 metric=0.4174 head_norm=1.338956 delta_norm=0.388029
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.143 → S16@127.0.0.1:44916
[S6] ⇄ pheromone p=0.398 → S8@127.0.0.1:44909
[S7] ⇄ pheromone p=0.070 → S3@127.0.0.1:44903
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=25 metric=0.9486 head_norm=1.711532
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.390088e-02
[S3] stored merged vector for next round verification (round=25)
[S3] DEBUG after merge:  round=25 metric=0.9480 head_norm=1.687223 delta_norm=0.083901
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.180 → S2@127.0.0.1:44902
[S4] ⇄ pheromone p=0.055 → S11@127.0.0.1:44912
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=25 metric=0.9965 head_norm=1.921825
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.266867e-02
[S11] stored merged vector for next round verification (round=25)
[S11] DEBUG after merge:  round=25 metric=0.9965 head_norm=1.895308 delta_norm=0.082669
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.061 → S15@127.0.0.1:44915
[S13] ⇄ pheromone p=0.089 → S10@127.0.0.1:44911
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=25 metric=0.9643 head_norm=1.069494
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.059320e-01
[S14] stored merged vector for next round verification (round=25)
[S14] DEBUG after merge:  round=25 metric=0.9762 head_norm=0.991109 delta_norm=0.305932
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.049 → S8@127.0.0.1:44909
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=25 metric=0.8025 head_norm=1.314186
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.772964e-01
[S15] stored merged vector for next round verification (round=25)
[S15] DEBUG after merge:  round=25 metric=0.8190 head_norm=1.451226 delta_norm=0.777296
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.158 → S5@127.0.0.1:44905
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=25 metric=0.9805 head_norm=1.003974
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.460328e-01
[S16] stored merged vector for next round verification (round=25)
[S16] DEBUG after merge:  round=25 metric=0.9419 head_norm=0.938518 delta_norm=0.546033
[S16] aggregate: ROLLBACK (f1_val pre=0.981 post=0.942 tol_abs=0.005 tol_rel=0.0)
[S16] ⇄ pheromone p=0.309 → S14@127.0.0.1:44914
[S10] ⇄ pheromone p=0.049 → S9@127.0.0.1:44910
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=25 metric=0.9972 head_norm=1.161883
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.929421e-01
[S9] stored merged vector for next round verification (round=25)
[S9] DEBUG after merge:  round=25 metric=0.9972 head_norm=1.326962 delta_norm=0.492942
[S9] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.145 → S16@127.0.0.1:44916
[S17] ⇄ pheromone p=0.286 → S3@127.0.0.1:44903
[S2] START round=26 head_norm_before_train=1.708300 cos_to_last_merge=1.0000 (last merge round=25)
[S2] round=26 local utility u=0.227818 metrics={'f1_val': 0.7028481313951817, 'auprc': 0.7858999263408468, 'loss_val': 0.32518338441409755, 'psi': 0.7360688493734477}-{'f1_val': 0.6808214373622918, 'auprc': 0.6859304359272752, 'loss_val': 0.3487515166495285, 'psi': 0.6828650367882851}
[S3] START round=26 head_norm_before_train=1.687223 cos_to_last_merge=1.0000 (last merge round=25)
[S3] round=26 local utility u=0.107585 metrics={'f1_val': 0.970860184791537, 'auprc': 0.9984592406902084, 'loss_val': 0.10843456215804984, 'psi': 0.9818998071510056}-{'f1_val': 0.948576416758251, 'auprc': 0.9960800892506789, 'loss_val': 0.18276422231659145, 'psi': 0.9675778857552222}
[S4] START round=26 head_norm_before_train=1.872068 (no previous merge yet)
[S4] round=26 local utility u=0.000000 metrics={'f1_val': 0.9399938585497721, 'auprc': 0.9343456800264647, 'loss_val': 0.2811581739557214, 'psi': 0.9377345871404492}-{'f1_val': 0.9524474059075616, 'auprc': 0.9653155252665429, 'loss_val': 0.2516959214375069, 'psi': 0.9575946536511541}
[S5] START round=26 head_norm_before_train=1.338956 cos_to_last_merge=1.0000 (last merge round=25)
[S5] round=26 local utility u=1.000000 metrics={'f1_val': 0.7004069097142683, 'auprc': 0.891321129429868, 'loss_val': 0.40590578155658874, 'psi': 0.7767725976005082}-{'f1_val': 0.41726206372792607, 'auprc': 0.6953766939560819, 'loss_val': 1.2208819224915586, 'psi': 0.5285079158191884}
[S6] START round=26 head_norm_before_train=1.433503 cos_to_last_merge=0.8032 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.803
[S6] round=26 local utility u=0.000000 metrics={'f1_val': 0.4540326488083876, 'auprc': 0.7800510403962704, 'loss_val': 0.9071021466987391, 'psi': 0.5844400054435408}-{'f1_val': 0.9691297707345827, 'auprc': 0.9845214959563461, 'loss_val': 0.14495041507520662, 'psi': 0.9752864608232881}
[S7] START round=26 head_norm_before_train=1.471796 cos_to_last_merge=0.8203 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.820
[S7] round=26 local utility u=0.790408 metrics={'f1_val': 0.6442281864262005, 'auprc': 0.8068895581290435, 'loss_val': 0.5067365599289876, 'psi': 0.7092927351073377}-{'f1_val': 0.47355303473099997, 'auprc': 0.7808596787966489, 'loss_val': 0.9854118189918144, 'psi': 0.5964756923572595}
[S8] START round=26 head_norm_before_train=1.025761 cos_to_last_merge=1.0000 (last merge round=25)
[S8] round=26 local utility u=0.092980 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9991376092087526, 'loss_val': 0.2362040908846218, 'psi': 0.9973769057235928}-{'f1_val': 0.9965458537967758, 'auprc': 0.9972317082532132, 'loss_val': 0.41850355486065377, 'psi': 0.9968201955793508}
[S9] START round=26 head_norm_before_train=1.326962 cos_to_last_merge=1.0000 (last merge round=25)
[S9] round=26 local utility u=0.010566 metrics={'f1_val': 0.9963298967426935, 'auprc': 0.9985664778731443, 'loss_val': 0.13787878260506445, 'psi': 0.9972245291948738}-{'f1_val': 0.9971609471241525, 'auprc': 0.9987985887562312, 'loss_val': 0.16469333108506454, 'psi': 0.997816003776984}
[S10] START round=26 head_norm_before_train=1.630235 cos_to_last_merge=0.8315 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.831
[S10] round=26 local utility u=0.004715 metrics={'f1_val': 0.994243089309356, 'auprc': 0.9961183124322742, 'loss_val': 0.04929169692778851, 'psi': 0.9949931785585233}-{'f1_val': 0.9942674420396322, 'auprc': 0.9951496245381013, 'loss_val': 0.0559607545336445, 'psi': 0.9946203150390199}
[S11] START round=26 head_norm_before_train=1.895308 cos_to_last_merge=1.0000 (last merge round=25)
[S11] round=26 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9972446225796876, 'loss_val': 0.06919800339565212, 'psi': 0.9965903338783223}-{'f1_val': 0.9965470045135896, 'auprc': 0.9979393430281663, 'loss_val': 0.06717663829452658, 'psi': 0.9971039399194203}
[S13] START round=26 head_norm_before_train=1.659346 (no previous merge yet)
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.6307900345342999, 'auprc': 0.6619132350034992, 'loss_val': 0.6438794618515468, 'psi': 0.6432393147219797}-{'f1_val': 0.6279352411031187, 'auprc': 0.6663589414889732, 'loss_val': 0.6339499358043008, 'psi': 0.6433047212574605}
[S14] START round=26 head_norm_before_train=0.991109 cos_to_last_merge=1.0000 (last merge round=25)
[S14] round=26 local utility u=0.062555 metrics={'f1_val': 0.9938807661707628, 'auprc': 0.9985587636942593, 'loss_val': 0.31067297648987185, 'psi': 0.9957519651801614}-{'f1_val': 0.9643316323993956, 'auprc': 0.9985743493974931, 'loss_val': 0.25853434347241283, 'psi': 0.9780287191986345}
[S15] START round=26 head_norm_before_train=1.451226 cos_to_last_merge=1.0000 (last merge round=25)
[S15] round=26 local utility u=0.000000 metrics={'f1_val': 0.6965426799700429, 'auprc': 0.9403209972128327, 'loss_val': 0.4525587255366256, 'psi': 0.7940540068671589}-{'f1_val': 0.8024643562235952, 'auprc': 0.9877444753324537, 'loss_val': 0.3335333409823803, 'psi': 0.8765764038671386}
[S16] START round=26 head_norm_before_train=0.938518 cos_to_last_merge=1.0000 (last merge round=25)
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.862969722237779, 'auprc': 0.9586568312196813, 'loss_val': 0.6036678620012392, 'psi': 0.9012445658305399}-{'f1_val': 0.9805143104950205, 'auprc': 0.9778141368798368, 'loss_val': 0.5495489582624119, 'psi': 0.9794342410489469}
[S17] START round=26 head_norm_before_train=1.666788 (no previous merge yet)
[S17] round=26 local utility u=0.000000 metrics={'f1_val': 0.4467797224100165, 'auprc': 0.8629631715381426, 'loss_val': 0.8704677500216079, 'psi': 0.6132531020612669}-{'f1_val': 0.5661353127927282, 'auprc': 0.8109439573518077, 'loss_val': 0.8300767924128932, 'psi': 0.6640587706163601}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:44903
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:44910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:44902
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:44916
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:44909
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S10] → sending delta(kind=head bytes=1809) to S9@127.0.0.1:44910
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:44915
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1804 to 1 peers)
[S10] sending update (kind=head size=1809 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.049569)
[S8] loaded HEAD from S14 (vec_in norm=1.049569)
[S8] cosine check vs S14: cos=0.4419
[S8] BUFFERED delta from S14 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1798) from S2
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.729251)
[S15] loaded HEAD from S2 (vec_in norm=1.729251)
[S15] cosine check vs S2: cos=0.3687
[S15] BUFFERED delta from S2 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1804) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.379990)
[S16] loaded HEAD from S9 (vec_in norm=1.379990)
[S16] cosine check vs S9: cos=0.8351
[S16] BUFFERED delta from S9 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1800) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.358120)
[S16] loaded HEAD from S5 (vec_in norm=1.358120)
[S16] cosine check vs S5: cos=0.4630
[S16] BUFFERED delta from S5 (total buffered=2)
[S9] RECEIVED delta(kind=head bytes=1795) from S8
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.087967)
[S9] loaded HEAD from S8 (vec_in norm=1.087967)
[S9] cosine check vs S8: cos=0.3942
[S9] BUFFERED delta from S8 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1809) from S10
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.653330)
[S9] loaded HEAD from S10 (vec_in norm=1.653330)
[S9] cosine check vs S10: cos=0.9560
[S9] BUFFERED delta from S10 (total buffered=2)
[S2] RECEIVED delta(kind=head bytes=1801) from S3
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.725204)
[S2] loaded HEAD from S3 (vec_in norm=1.725204)
[S2] cosine check vs S3: cos=0.9970
[S2] BUFFERED delta from S3 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1802) from S7
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.482647)
[S3] loaded HEAD from S7 (vec_in norm=1.482647)
[S3] cosine check vs S7: cos=-0.0180
[S3] DROPPED delta from S7 (cos=-0.0180 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=26 metric=0.6965 head_norm=1.475161
[S15] _apply_head_vector_avg (torch): Δ‖w‖=9.062524e-01
[S15] stored merged vector for next round verification (round=26)
[S15] DEBUG after merge:  round=26 metric=0.6979 head_norm=1.327370 delta_norm=0.906252
[S15] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=26 metric=0.9962 head_norm=1.087967
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.648322e-01
[S8] stored merged vector for next round verification (round=26)
[S8] DEBUG after merge:  round=26 metric=0.9964 head_norm=0.907523 delta_norm=0.564832
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=26 metric=0.7028 head_norm=1.729251
[S2] _apply_head_vector_avg (torch): Δ‖w‖=6.718550e-02
[S2] stored merged vector for next round verification (round=26)
[S2] DEBUG after merge:  round=26 metric=0.7040 head_norm=1.725922 delta_norm=0.067185
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=26 metric=0.9963 head_norm=1.379990
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.537204e-01
[S9] stored merged vector for next round verification (round=26)
[S9] DEBUG after merge:  round=26 metric=0.9967 head_norm=1.204506 delta_norm=0.253720
[S9] aggregate: ACCEPT kept=['S8', 'S10'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=26 metric=0.8630 head_norm=0.989282
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.167690e-01
[S16] stored merged vector for next round verification (round=26)
[S16] DEBUG after merge:  round=26 metric=0.8577 head_norm=0.963379 delta_norm=0.216769
[S16] aggregate: ROLLBACK (f1_val pre=0.863 post=0.858 tol_abs=0.005 tol_rel=0.0)
[S2] START round=27 head_norm_before_train=1.725922 cos_to_last_merge=1.0000 (last merge round=26)
[S2] round=27 local utility u=0.000000 metrics={'f1_val': 0.34506664069768056, 'auprc': 0.6665573995694881, 'loss_val': 1.4191069073175993, 'psi': 0.4736629442464036}-{'f1_val': 0.7028481313951817, 'auprc': 0.7858999263408468, 'loss_val': 0.32518338441409755, 'psi': 0.7360688493734477}
[S3] START round=27 head_norm_before_train=1.725204 cos_to_last_merge=0.9995 (last merge round=25)
[S3] round=27 local utility u=0.000000 metrics={'f1_val': 0.9326473579350169, 'auprc': 0.9978971095957654, 'loss_val': 0.17452605534800206, 'psi': 0.9587472585993162}-{'f1_val': 0.970860184791537, 'auprc': 0.9984592406902084, 'loss_val': 0.10843456215804984, 'psi': 0.9818998071510056}
[S4] START round=27 head_norm_before_train=1.879969 (no previous merge yet)
[S4] round=27 local utility u=0.000000 metrics={'f1_val': 0.9398799119513961, 'auprc': 0.9344930621793572, 'loss_val': 0.29744780298275214, 'psi': 0.9377251720425805}-{'f1_val': 0.9399938585497721, 'auprc': 0.9343456800264647, 'loss_val': 0.2811581739557214, 'psi': 0.9377345871404492}
[S5] START round=27 head_norm_before_train=1.358120 cos_to_last_merge=0.9997 (last merge round=25)
[S5] round=27 local utility u=0.154848 metrics={'f1_val': 0.7004809549016324, 'auprc': 0.978453265141191, 'loss_val': 0.3580496188235288, 'psi': 0.8116698789974559}-{'f1_val': 0.7004069097142683, 'auprc': 0.891321129429868, 'loss_val': 0.40590578155658874, 'psi': 0.7767725976005082}
[S6] START round=27 head_norm_before_train=1.447247 cos_to_last_merge=0.8004 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.800
[S6] round=27 local utility u=1.000000 metrics={'f1_val': 0.9852994837938016, 'auprc': 0.9816549246443126, 'loss_val': 0.11663687256007839, 'psi': 0.983841660134006}-{'f1_val': 0.4540326488083876, 'auprc': 0.7800510403962704, 'loss_val': 0.9071021466987391, 'psi': 0.5844400054435408}
[S7] START round=27 head_norm_before_train=1.482647 cos_to_last_merge=0.8191 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.819
[S7] round=27 local utility u=0.000000 metrics={'f1_val': 0.6274391560314773, 'auprc': 0.7924548551957894, 'loss_val': 0.6003826787392748, 'psi': 0.6934454356972022}-{'f1_val': 0.6442281864262005, 'auprc': 0.8068895581290435, 'loss_val': 0.5067365599289876, 'psi': 0.7092927351073377}
[S8] START round=27 head_norm_before_train=0.907523 cos_to_last_merge=1.0000 (last merge round=26)
[S8] round=27 local utility u=0.000000 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9989526936030799, 'loss_val': 0.3097595488085358, 'psi': 0.9973929224026068}-{'f1_val': 0.9962031034001528, 'auprc': 0.9991376092087526, 'loss_val': 0.2362040908846218, 'psi': 0.9973769057235928}
[S9] START round=27 head_norm_before_train=1.204506 cos_to_last_merge=1.0000 (last merge round=26)
[S9] round=27 local utility u=0.000000 metrics={'f1_val': 0.9971609471241525, 'auprc': 0.9989455122088844, 'loss_val': 0.14985386314512816, 'psi': 0.9978747731580453}-{'f1_val': 0.9963298967426935, 'auprc': 0.9985664778731443, 'loss_val': 0.13787878260506445, 'psi': 0.9972245291948738}
[S10] START round=27 head_norm_before_train=1.653330 cos_to_last_merge=0.8299 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.830
[S10] round=27 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9928894030691496, 'loss_val': 0.0661655315220506, 'psi': 0.9942684646392848}-{'f1_val': 0.994243089309356, 'auprc': 0.9961183124322742, 'loss_val': 0.04929169692778851, 'psi': 0.9949931785585233}
[S11] START round=27 head_norm_before_train=1.918911 cos_to_last_merge=0.9998 (last merge round=25)
[S11] round=27 local utility u=0.006663 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.997723330131843, 'loss_val': 0.05730762894462588, 'psi': 0.9967818168991844}-{'f1_val': 0.9961541414107454, 'auprc': 0.9972446225796876, 'loss_val': 0.06919800339565212, 'psi': 0.9965903338783223}
[S13] START round=27 head_norm_before_train=1.671970 (no previous merge yet)
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.5755371461146448, 'auprc': 0.6898163840907007, 'loss_val': 0.956535463833131, 'psi': 0.6212488413050672}-{'f1_val': 0.6307900345342999, 'auprc': 0.6619132350034992, 'loss_val': 0.6438794618515468, 'psi': 0.6432393147219797}
[S14] START round=27 head_norm_before_train=1.049569 cos_to_last_merge=0.9965 (last merge round=25)
[S14] round=27 local utility u=0.049653 metrics={'f1_val': 0.9959644614659175, 'auprc': 0.9985700036265444, 'loss_val': 0.22390274666446824, 'psi': 0.9970066783301682}-{'f1_val': 0.9938807661707628, 'auprc': 0.9985587636942593, 'loss_val': 0.31067297648987185, 'psi': 0.9957519651801614}
[S15] START round=27 head_norm_before_train=1.327370 cos_to_last_merge=1.0000 (last merge round=26)
[S15] round=27 local utility u=0.828548 metrics={'f1_val': 0.9207268449956095, 'auprc': 0.9920272211836142, 'loss_val': 0.2956869763221759, 'psi': 0.9492469954708114}-{'f1_val': 0.6965426799700429, 'auprc': 0.9403209972128327, 'loss_val': 0.4525587255366256, 'psi': 0.7940540068671589}
[S16] START round=27 head_norm_before_train=0.963379 cos_to_last_merge=1.0000 (last merge round=26)
[S16] round=27 local utility u=0.516484 metrics={'f1_val': 0.9869970251788577, 'auprc': 0.9792250207625518, 'loss_val': 0.3765678011925591, 'psi': 0.9838882234123354}-{'f1_val': 0.862969722237779, 'auprc': 0.9586568312196813, 'loss_val': 0.6036678620012392, 'psi': 0.9012445658305399}
[S17] START round=27 head_norm_before_train=1.676063 (no previous merge yet)
[S17] round=27 local utility u=0.072461 metrics={'f1_val': 0.5831784194963543, 'auprc': 0.6905540600162785, 'loss_val': 1.026710223666542, 'psi': 0.626128675704324}-{'f1_val': 0.4467797224100165, 'auprc': 0.8629631715381426, 'loss_val': 0.8704677500216079, 'psi': 0.6132531020612669}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:44915
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:44905
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:44916
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:44909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:44914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:44909
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1800) from S11
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.945090)
[S15] loaded HEAD from S11 (vec_in norm=1.945090)
[S15] cosine check vs S11: cos=0.5201
[S15] BUFFERED delta from S11 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1795) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.350258)
[S5] loaded HEAD from S15 (vec_in norm=1.350258)
[S5] cosine check vs S15: cos=0.9197
[S5] BUFFERED delta from S15 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1801) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.395113)
[S16] loaded HEAD from S5 (vec_in norm=1.395113)
[S16] cosine check vs S5: cos=0.5852
[S16] BUFFERED delta from S5 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1798) from S16
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.013127)
[S14] loaded HEAD from S16 (vec_in norm=1.013127)
[S14] cosine check vs S16: cos=0.9014
[S14] BUFFERED delta from S16 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] → sending delta(kind=head bytes=1805) to S3@127.0.0.1:44903
[S17] sending update (kind=head size=1805 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1805) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.689399)
[S3] loaded HEAD from S17 (vec_in norm=1.689399)
[S3] cosine check vs S17: cos=0.9939
[S3] BUFFERED delta from S17 (total buffered=1)
[S14] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1805 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1805) from S6
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.456649)
[S8] loaded HEAD from S6 (vec_in norm=1.456649)
[S8] cosine check vs S6: cos=0.6031
[S8] BUFFERED delta from S6 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1798) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.110859)
[S8] loaded HEAD from S14 (vec_in norm=1.110859)
[S8] cosine check vs S14: cos=0.8198
[S8] BUFFERED delta from S14 (total buffered=2)
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=27 metric=0.9964 head_norm=0.966226
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.596630e-01
[S8] stored merged vector for next round verification (round=27)
[S8] DEBUG after merge:  round=27 metric=0.9964 head_norm=0.943348 delta_norm=0.159663
[S8] aggregate: ACCEPT kept=['S6', 'S14'] (k=2/2) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=27 metric=0.9326 head_norm=1.761128
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.015127e-01
[S3] stored merged vector for next round verification (round=27)
[S3] DEBUG after merge:  round=27 metric=0.9321 head_norm=1.722648 delta_norm=0.101513
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=27 metric=0.7005 head_norm=1.395113
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.759074e-01
[S5] stored merged vector for next round verification (round=27)
[S5] DEBUG after merge:  round=27 metric=0.7006 head_norm=1.344858 delta_norm=0.275907
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=27 metric=0.9207 head_norm=1.350258
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.477734e-01
[S15] stored merged vector for next round verification (round=27)
[S15] DEBUG after merge:  round=27 metric=0.9533 head_norm=1.443803 delta_norm=0.847773
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=27 metric=0.9870 head_norm=1.013127
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.741239e-01
[S16] stored merged vector for next round verification (round=27)
[S16] DEBUG after merge:  round=27 metric=0.9634 head_norm=1.075530 delta_norm=0.574124
[S16] aggregate: ROLLBACK (f1_val pre=0.987 post=0.963 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=27 metric=0.9960 head_norm=1.110859
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.405305e-01
[S14] stored merged vector for next round verification (round=27)
[S14] DEBUG after merge:  round=27 metric=0.9968 head_norm=1.035550 delta_norm=0.240531
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=1.741956 cos_to_last_merge=0.9999 (last merge round=26)
[S2] round=28 local utility u=1.000000 metrics={'f1_val': 0.7122529591339266, 'auprc': 0.8031653856293866, 'loss_val': 0.4028336307625536, 'psi': 0.7486179297321106}-{'f1_val': 0.34506664069768056, 'auprc': 0.6665573995694881, 'loss_val': 1.4191069073175993, 'psi': 0.4736629442464036}
[S3] START round=28 head_norm_before_train=1.722648 cos_to_last_merge=1.0000 (last merge round=27)
[S3] round=28 local utility u=0.000000 metrics={'f1_val': 0.8718540817320131, 'auprc': 0.9966172358684642, 'loss_val': 0.2581875460893794, 'psi': 0.9217593433865936}-{'f1_val': 0.9326473579350169, 'auprc': 0.9978971095957654, 'loss_val': 0.17452605534800206, 'psi': 0.9587472585993162}
[S4] START round=28 head_norm_before_train=1.885098 (no previous merge yet)
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.9383366700159477, 'auprc': 0.9309659460902515, 'loss_val': 0.3055864583302121, 'psi': 0.9353883804456693}-{'f1_val': 0.9398799119513961, 'auprc': 0.9344930621793572, 'loss_val': 0.29744780298275214, 'psi': 0.9377251720425805}
[S5] START round=28 head_norm_before_train=1.344858 cos_to_last_merge=1.0000 (last merge round=27)
[S5] round=28 local utility u=0.027761 metrics={'f1_val': 0.7005672661245418, 'auprc': 0.9765830078400222, 'loss_val': 0.29743454488991083, 'psi': 0.810973562810734}-{'f1_val': 0.7004809549016324, 'auprc': 0.978453265141191, 'loss_val': 0.3580496188235288, 'psi': 0.8116698789974559}
[S6] START round=28 head_norm_before_train=1.456649 cos_to_last_merge=0.7984 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.798
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.7694458822880073, 'auprc': 0.9393820055554152, 'loss_val': 0.4752116094206528, 'psi': 0.8374203315949704}-{'f1_val': 0.9852994837938016, 'auprc': 0.9816549246443126, 'loss_val': 0.11663687256007839, 'psi': 0.983841660134006}
[S7] START round=28 head_norm_before_train=1.492585 cos_to_last_merge=0.8184 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.818
[S7] round=28 local utility u=0.000000 metrics={'f1_val': 0.48377345458348187, 'auprc': 0.7809351938563629, 'loss_val': 0.9389647335850676, 'psi': 0.6026381502926343}-{'f1_val': 0.6274391560314773, 'auprc': 0.7924548551957894, 'loss_val': 0.6003826787392748, 'psi': 0.6934454356972022}
[S8] START round=28 head_norm_before_train=0.943348 cos_to_last_merge=1.0000 (last merge round=27)
[S8] round=28 local utility u=0.027784 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9976787525706443, 'loss_val': 0.24946938166182406, 'psi': 0.9967933630683494}-{'f1_val': 0.9963530749356245, 'auprc': 0.9989526936030799, 'loss_val': 0.3097595488085358, 'psi': 0.9973929224026068}
[S9] START round=28 head_norm_before_train=1.258577 cos_to_last_merge=0.9980 (last merge round=26)
[S9] round=28 local utility u=0.018327 metrics={'f1_val': 0.9971609471241525, 'auprc': 0.9989423129716473, 'loss_val': 0.11319072786941581, 'psi': 0.9978734934631505}-{'f1_val': 0.9971609471241525, 'auprc': 0.9989455122088844, 'loss_val': 0.14985386314512816, 'psi': 0.9978747731580453}
[S10] START round=28 head_norm_before_train=1.675045 cos_to_last_merge=0.8284 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.828
[S10] round=28 local utility u=0.013641 metrics={'f1_val': 0.9947757294679969, 'auprc': 0.9964255006351631, 'loss_val': 0.04701833449153606, 'psi': 0.9954356379348634}-{'f1_val': 0.9951878390193748, 'auprc': 0.9928894030691496, 'loss_val': 0.0661655315220506, 'psi': 0.9942684646392848}
[S11] START round=28 head_norm_before_train=1.945090 cos_to_last_merge=0.9993 (last merge round=25)
[S11] round=28 local utility u=0.006855 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9980307936690949, 'loss_val': 0.046877532065352306, 'psi': 0.9971405201757917}-{'f1_val': 0.9961541414107454, 'auprc': 0.997723330131843, 'loss_val': 0.05730762894462588, 'psi': 0.9967818168991844}
[S13] START round=28 head_norm_before_train=1.684160 (no previous merge yet)
[S13] round=28 local utility u=0.195919 metrics={'f1_val': 0.6125295523961678, 'auprc': 0.6460308691622072, 'loss_val': 0.6552959727370137, 'psi': 0.6259300791025836}-{'f1_val': 0.5755371461146448, 'auprc': 0.6898163840907007, 'loss_val': 0.956535463833131, 'psi': 0.6212488413050672}
[S14] START round=28 head_norm_before_train=1.035550 cos_to_last_merge=1.0000 (last merge round=27)
[S14] round=28 local utility u=0.000000 metrics={'f1_val': 0.9928841366764432, 'auprc': 0.9983648020464291, 'loss_val': 0.26680566163105857, 'psi': 0.9950764028244375}-{'f1_val': 0.9959644614659175, 'auprc': 0.9985700036265444, 'loss_val': 0.22390274666446824, 'psi': 0.9970066783301682}
[S15] START round=28 head_norm_before_train=1.443803 cos_to_last_merge=1.0000 (last merge round=27)
[S15] round=28 local utility u=0.000000 metrics={'f1_val': 0.7765016984201794, 'auprc': 0.9912189872606495, 'loss_val': 0.3171049585436837, 'psi': 0.8623886139563675}-{'f1_val': 0.9207268449956095, 'auprc': 0.9920272211836142, 'loss_val': 0.2956869763221759, 'psi': 0.9492469954708114}
[S16] START round=28 head_norm_before_train=1.075530 cos_to_last_merge=1.0000 (last merge round=27)
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.9396869387966997, 'auprc': 0.9915088156118107, 'loss_val': 0.481382503693147, 'psi': 0.9604156895227441}-{'f1_val': 0.9869970251788577, 'auprc': 0.9792250207625518, 'loss_val': 0.3765678011925591, 'psi': 0.9838882234123354}
[S17] START round=28 head_norm_before_train=1.689399 (no previous merge yet)
[S17] round=28 local utility u=0.515259 metrics={'f1_val': 0.629108946064455, 'auprc': 0.8706429512886685, 'loss_val': 0.8120430508487918, 'psi': 0.7257225481541405}-{'f1_val': 0.5831784194963543, 'auprc': 0.6905540600162785, 'loss_val': 1.026710223666542, 'psi': 0.626128675704324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:44911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:44910
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:44910
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:44916
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1799) from S10
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.696203)
[S9] loaded HEAD from S10 (vec_in norm=1.696203)
[S9] cosine check vs S10: cos=0.9084
[S9] BUFFERED delta from S10 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1800) from S13
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.692512)
[S10] loaded HEAD from S13 (vec_in norm=1.692512)
[S10] cosine check vs S13: cos=-0.0593
[S10] DROPPED delta from S13 (cos=-0.0593 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1799) from S2
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.753676)
[S15] loaded HEAD from S2 (vec_in norm=1.753676)
[S15] cosine check vs S2: cos=0.4029
[S15] BUFFERED delta from S2 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1795) from S8
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.007536)
[S9] loaded HEAD from S8 (vec_in norm=1.007536)
[S9] cosine check vs S8: cos=0.6052
[S9] BUFFERED delta from S8 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1800) from S11
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.969845)
[S15] loaded HEAD from S11 (vec_in norm=1.969845)
[S15] cosine check vs S11: cos=0.9138
[S15] BUFFERED delta from S11 (total buffered=2)
[S16] RECEIVED delta(kind=head bytes=1804) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.374892)
[S16] loaded HEAD from S5 (vec_in norm=1.374892)
[S16] cosine check vs S5: cos=0.8915
[S16] BUFFERED delta from S5 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1797) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.316100)
[S16] loaded HEAD from S9 (vec_in norm=1.316100)
[S16] cosine check vs S9: cos=0.4406
[S16] BUFFERED delta from S9 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:44903
[S17] sending update (kind=head size=1798 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1798) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.704906)
[S3] loaded HEAD from S17 (vec_in norm=1.704906)
[S3] cosine check vs S17: cos=0.9965
[S3] BUFFERED delta from S17 (total buffered=1)
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=28 metric=0.7765 head_norm=1.472554
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.354925e-01
[S15] stored merged vector for next round verification (round=28)
[S15] DEBUG after merge:  round=28 metric=0.7774 head_norm=1.378747 delta_norm=0.235493
[S15] aggregate: ACCEPT kept=['S2', 'S11'] (k=2/2) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=28 metric=0.8719 head_norm=1.757623
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.738453e-02
[S3] stored merged vector for next round verification (round=28)
[S3] DEBUG after merge:  round=28 metric=0.8715 head_norm=1.729735 delta_norm=0.077385
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=28 metric=0.9397 head_norm=1.113098
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.151865e-01
[S16] stored merged vector for next round verification (round=28)
[S16] DEBUG after merge:  round=28 metric=0.9393 head_norm=1.025305 delta_norm=0.215186
[S16] aggregate: ACCEPT kept=['S5', 'S9'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=28 metric=0.9972 head_norm=1.316100
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.791428e-01
[S9] stored merged vector for next round verification (round=28)
[S9] DEBUG after merge:  round=28 metric=0.9972 head_norm=1.203044 delta_norm=0.179143
[S9] aggregate: ACCEPT kept=['S10', 'S8'] (k=2/2) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=1.753676 cos_to_last_merge=0.9996 (last merge round=26)
[S2] round=29 local utility u=0.000000 metrics={'f1_val': 0.7032763945655556, 'auprc': 0.7069077794784967, 'loss_val': 0.4510820490771121, 'psi': 0.704728948530732}-{'f1_val': 0.7122529591339266, 'auprc': 0.8031653856293866, 'loss_val': 0.4028336307625536, 'psi': 0.7486179297321106}
[S3] START round=29 head_norm_before_train=1.729735 cos_to_last_merge=1.0000 (last merge round=28)
[S3] round=29 local utility u=0.000000 metrics={'f1_val': 0.7842802720353892, 'auprc': 0.9966574050984827, 'loss_val': 0.4216397749580989, 'psi': 0.8692311252606266}-{'f1_val': 0.8718540817320131, 'auprc': 0.9966172358684642, 'loss_val': 0.2581875460893794, 'psi': 0.9217593433865936}
[S4] START round=29 head_norm_before_train=1.892293 (no previous merge yet)
[S4] round=29 local utility u=0.042609 metrics={'f1_val': 0.9404017118377793, 'auprc': 0.9462177768703106, 'loss_val': 0.2785137830459183, 'psi': 0.9427281378507918}-{'f1_val': 0.9383366700159477, 'auprc': 0.9309659460902515, 'loss_val': 0.3055864583302121, 'psi': 0.9353883804456693}
[S5] START round=29 head_norm_before_train=1.374892 cos_to_last_merge=0.9992 (last merge round=27)
[S5] round=29 local utility u=0.000000 metrics={'f1_val': 0.7006536512124258, 'auprc': 0.9808220094736974, 'loss_val': 0.31209940625461363, 'psi': 0.8127209945169345}-{'f1_val': 0.7005672661245418, 'auprc': 0.9765830078400222, 'loss_val': 0.29743454488991083, 'psi': 0.810973562810734}
[S6] START round=29 head_norm_before_train=1.465238 cos_to_last_merge=0.7963 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.796
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.6963576449457829, 'auprc': 0.8073307157833922, 'loss_val': 0.5118649053771809, 'psi': 0.7407468732808267}-{'f1_val': 0.7694458822880073, 'auprc': 0.9393820055554152, 'loss_val': 0.4752116094206528, 'psi': 0.8374203315949704}
[S7] START round=29 head_norm_before_train=1.494717 cos_to_last_merge=0.8179 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.818
[S7] round=29 local utility u=0.000000 metrics={'f1_val': 0.4521242085746061, 'auprc': 0.7799449208524416, 'loss_val': 1.1232639935788993, 'psi': 0.5832524934857404}-{'f1_val': 0.48377345458348187, 'auprc': 0.7809351938563629, 'loss_val': 0.9389647335850676, 'psi': 0.6026381502926343}
[S8] START round=29 head_norm_before_train=1.007536 cos_to_last_merge=0.9970 (last merge round=27)
[S8] round=29 local utility u=0.036996 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9991744231156052, 'loss_val': 0.18086503080949468, 'psi': 0.9974816142076168}-{'f1_val': 0.9962031034001528, 'auprc': 0.9976787525706443, 'loss_val': 0.24946938166182406, 'psi': 0.9967933630683494}
[S9] START round=29 head_norm_before_train=1.203044 cos_to_last_merge=1.0000 (last merge round=28)
[S9] round=29 local utility u=0.000000 metrics={'f1_val': 0.9975718516672275, 'auprc': 0.9988528956200927, 'loss_val': 0.12920516902916993, 'psi': 0.9980842692483736}-{'f1_val': 0.9971609471241525, 'auprc': 0.9989423129716473, 'loss_val': 0.11319072786941581, 'psi': 0.9978734934631505}
[S10] START round=29 head_norm_before_train=1.696203 cos_to_last_merge=0.8270 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.827
[S10] round=29 local utility u=0.002082 metrics={'f1_val': 0.9948838907637279, 'auprc': 0.995770639371283, 'loss_val': 0.0415379678987804, 'psi': 0.99523859020675}-{'f1_val': 0.9947757294679969, 'auprc': 0.9964255006351631, 'loss_val': 0.04701833449153606, 'psi': 0.9954356379348634}
[S11] START round=29 head_norm_before_train=1.969845 cos_to_last_merge=0.9986 (last merge round=25)
[S11] round=29 local utility u=0.003366 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9986029805386634, 'loss_val': 0.041861554508657826, 'psi': 0.9973693949236191}-{'f1_val': 0.9965470045135896, 'auprc': 0.9980307936690949, 'loss_val': 0.046877532065352306, 'psi': 0.9971405201757917}
[S13] START round=29 head_norm_before_train=1.692512 (no previous merge yet)
[S13] round=29 local utility u=0.000000 metrics={'f1_val': 0.6072011236323412, 'auprc': 0.6581170046773068, 'loss_val': 0.6843205479907982, 'psi': 0.6275674760503275}-{'f1_val': 0.6125295523961678, 'auprc': 0.6460308691622072, 'loss_val': 0.6552959727370137, 'psi': 0.6259300791025836}
[S14] START round=29 head_norm_before_train=1.095917 cos_to_last_merge=0.9969 (last merge round=27)
[S14] round=29 local utility u=0.053419 metrics={'f1_val': 0.9965992529308234, 'auprc': 0.9986625009407512, 'loss_val': 0.18315207471308062, 'psi': 0.9974245521347945}-{'f1_val': 0.9928841366764432, 'auprc': 0.9983648020464291, 'loss_val': 0.26680566163105857, 'psi': 0.9950764028244375}
[S15] START round=29 head_norm_before_train=1.378747 cos_to_last_merge=1.0000 (last merge round=28)
[S15] round=29 local utility u=0.000000 metrics={'f1_val': 0.7152165258204175, 'auprc': 0.9882133682346241, 'loss_val': 0.3387428665337509, 'psi': 0.8244152627861001}-{'f1_val': 0.7765016984201794, 'auprc': 0.9912189872606495, 'loss_val': 0.3171049585436837, 'psi': 0.8623886139563675}
[S16] START round=29 head_norm_before_train=1.025305 cos_to_last_merge=1.0000 (last merge round=28)
[S16] round=29 local utility u=0.203681 metrics={'f1_val': 0.9896113818338841, 'auprc': 0.9881767745368969, 'loss_val': 0.3635718612555803, 'psi': 0.9890375389150892}-{'f1_val': 0.9396869387966997, 'auprc': 0.9915088156118107, 'loss_val': 0.481382503693147, 'psi': 0.9604156895227441}
[S17] START round=29 head_norm_before_train=1.704906 (no previous merge yet)
[S17] round=29 local utility u=0.000000 metrics={'f1_val': 0.5692132052294815, 'auprc': 0.7114040027847526, 'loss_val': 0.8543631691425814, 'psi': 0.6260895242515899}-{'f1_val': 0.629108946064455, 'auprc': 0.8706429512886685, 'loss_val': 0.8120430508487918, 'psi': 0.7257225481541405}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] → sending delta(kind=head bytes=1792) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:44910
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:44910
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:44909
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1794 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1792 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1794) from S8
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.071171)
[S9] loaded HEAD from S8 (vec_in norm=1.071171)
[S9] cosine check vs S8: cos=0.6300
[S9] BUFFERED delta from S8 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1804) from S10
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.711712)
[S9] loaded HEAD from S10 (vec_in norm=1.711712)
[S9] cosine check vs S10: cos=0.9030
[S9] BUFFERED delta from S10 (total buffered=2)
[S8] RECEIVED delta(kind=head bytes=1802) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.165614)
[S8] loaded HEAD from S14 (vec_in norm=1.165614)
[S8] cosine check vs S14: cos=0.7258
[S8] BUFFERED delta from S14 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1792) from S11
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.991795)
[S15] loaded HEAD from S11 (vec_in norm=1.991795)
[S15] cosine check vs S11: cos=0.8430
[S15] BUFFERED delta from S11 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:44914
[S16] sending update (kind=head size=1799 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1799) from S16
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.070709)
[S14] loaded HEAD from S16 (vec_in norm=1.070709)
[S14] cosine check vs S16: cos=0.9048
[S14] BUFFERED delta from S16 (total buffered=1)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=29 metric=0.9976 head_norm=1.259595
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.282202e-01
[S9] stored merged vector for next round verification (round=29)
[S9] DEBUG after merge:  round=29 metric=0.9972 head_norm=1.189505 delta_norm=0.128220
[S9] aggregate: ACCEPT kept=['S8', 'S10'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=29 metric=0.9964 head_norm=1.071171
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.164376e-01
[S8] stored merged vector for next round verification (round=29)
[S8] DEBUG after merge:  round=29 metric=0.9964 head_norm=1.039044 delta_norm=0.416438
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=29 metric=0.7152 head_norm=1.411593
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.521004e-01
[S15] stored merged vector for next round verification (round=29)
[S15] DEBUG after merge:  round=29 metric=0.7393 head_norm=1.635576 delta_norm=0.552100
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=29 metric=0.9966 head_norm=1.165614
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.483681e-01
[S14] stored merged vector for next round verification (round=29)
[S14] DEBUG after merge:  round=29 metric=0.9970 head_norm=1.091261 delta_norm=0.248368
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=1.765548 cos_to_last_merge=0.9992 (last merge round=26)
[S2] round=30 local utility u=0.070272 metrics={'f1_val': 0.7053921553802778, 'auprc': 0.7295682293096231, 'loss_val': 0.3912129781245068, 'psi': 0.7150625849520159}-{'f1_val': 0.7032763945655556, 'auprc': 0.7069077794784967, 'loss_val': 0.4510820490771121, 'psi': 0.704728948530732}
[S3] START round=30 head_norm_before_train=1.766161 cos_to_last_merge=0.9996 (last merge round=28)
[S3] round=30 local utility u=0.430441 metrics={'f1_val': 0.8917958174604576, 'auprc': 0.9975070144797593, 'loss_val': 0.20839968154704078, 'psi': 0.9340802962681782}-{'f1_val': 0.7842802720353892, 'auprc': 0.9966574050984827, 'loss_val': 0.4216397749580989, 'psi': 0.8692311252606266}
[S4] START round=30 head_norm_before_train=1.904067 (no previous merge yet)
[S4] round=30 local utility u=0.000000 metrics={'f1_val': 0.9383913570973237, 'auprc': 0.9418013702635547, 'loss_val': 0.28532833045191575, 'psi': 0.9397553623638161}-{'f1_val': 0.9404017118377793, 'auprc': 0.9462177768703106, 'loss_val': 0.2785137830459183, 'psi': 0.9427281378507918}
[S5] START round=30 head_norm_before_train=1.409185 cos_to_last_merge=0.9968 (last merge round=27)
[S5] round=30 local utility u=0.000000 metrics={'f1_val': 0.7006536512124258, 'auprc': 0.8872098180296606, 'loss_val': 0.37011962827728107, 'psi': 0.7752761179393197}-{'f1_val': 0.7006536512124258, 'auprc': 0.9808220094736974, 'loss_val': 0.31209940625461363, 'psi': 0.8127209945169345}
[S6] START round=30 head_norm_before_train=1.473917 cos_to_last_merge=0.7944 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.794
[S6] round=30 local utility u=0.803990 metrics={'f1_val': 0.841691709020931, 'auprc': 0.9706472567049246, 'loss_val': 0.2658379194107315, 'psi': 0.8932739280945284}-{'f1_val': 0.6963576449457829, 'auprc': 0.8073307157833922, 'loss_val': 0.5118649053771809, 'psi': 0.7407468732808267}
[S7] START round=30 head_norm_before_train=1.501523 cos_to_last_merge=0.8169 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.817
[S7] round=30 local utility u=0.060891 metrics={'f1_val': 0.4605603840325863, 'auprc': 0.7808908307841222, 'loss_val': 1.0549363225007848, 'psi': 0.5886925627332007}-{'f1_val': 0.4521242085746061, 'auprc': 0.7799449208524416, 'loss_val': 1.1232639935788993, 'psi': 0.5832524934857404}
[S8] START round=30 head_norm_before_train=1.039044 cos_to_last_merge=1.0000 (last merge round=29)
[S8] round=30 local utility u=0.000000 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9994743948039075, 'loss_val': 0.23314184676030658, 'psi': 0.9976016028829378}-{'f1_val': 0.9963530749356245, 'auprc': 0.9991744231156052, 'loss_val': 0.18086503080949468, 'psi': 0.9974816142076168}
[S9] START round=30 head_norm_before_train=1.189505 cos_to_last_merge=1.0000 (last merge round=29)
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.9971609471241525, 'auprc': 0.9988600135365612, 'loss_val': 0.13021614099958762, 'psi': 0.997840573689116}-{'f1_val': 0.9975718516672275, 'auprc': 0.9988528956200927, 'loss_val': 0.12920516902916993, 'psi': 0.9980842692483736}
[S10] START round=30 head_norm_before_train=1.711712 cos_to_last_merge=0.8260 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.826
[S10] round=30 local utility u=0.000244 metrics={'f1_val': 0.9946220143540194, 'auprc': 0.9960762678823437, 'loss_val': 0.04039494222269406, 'psi': 0.9952037157653492}-{'f1_val': 0.9948838907637279, 'auprc': 0.995770639371283, 'loss_val': 0.0415379678987804, 'psi': 0.99523859020675}
[S11] START round=30 head_norm_before_train=1.991795 cos_to_last_merge=0.9979 (last merge round=25)
[S11] round=30 local utility u=0.002305 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.998598786691675, 'loss_val': 0.0372395292002688, 'psi': 0.9973677173848238}-{'f1_val': 0.9965470045135896, 'auprc': 0.9986029805386634, 'loss_val': 0.041861554508657826, 'psi': 0.9973693949236191}
[S13] START round=30 head_norm_before_train=1.697414 (no previous merge yet)
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.5789611992625276, 'auprc': 0.6907577336326831, 'loss_val': 0.8890331711395056, 'psi': 0.6236798130105898}-{'f1_val': 0.6072011236323412, 'auprc': 0.6581170046773068, 'loss_val': 0.6843205479907982, 'psi': 0.6275674760503275}
[S14] START round=30 head_norm_before_train=1.091261 cos_to_last_merge=1.0000 (last merge round=29)
[S14] round=30 local utility u=0.000000 metrics={'f1_val': 0.9679549312515116, 'auprc': 0.9982096225689447, 'loss_val': 0.23322050246049184, 'psi': 0.9800568077784848}-{'f1_val': 0.9965992529308234, 'auprc': 0.9986625009407512, 'loss_val': 0.18315207471308062, 'psi': 0.9974245521347945}
[S15] START round=30 head_norm_before_train=1.635576 cos_to_last_merge=1.0000 (last merge round=29)
[S15] round=30 local utility u=0.938543 metrics={'f1_val': 0.9911030436738927, 'auprc': 0.9969995652200436, 'loss_val': 0.14333373600196778, 'psi': 0.9934616522923531}-{'f1_val': 0.7152165258204175, 'auprc': 0.9882133682346241, 'loss_val': 0.3387428665337509, 'psi': 0.8244152627861001}
[S16] START round=30 head_norm_before_train=1.070709 cos_to_last_merge=0.9966 (last merge round=28)
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.8771102336003149, 'auprc': 0.9891363585314079, 'loss_val': 0.5044922901806516, 'psi': 0.921920683572752}-{'f1_val': 0.9896113818338841, 'auprc': 0.9881767745368969, 'loss_val': 0.3635718612555803, 'psi': 0.9890375389150892}
[S17] START round=30 head_norm_before_train=1.722175 (no previous merge yet)
[S17] round=30 local utility u=0.194996 metrics={'f1_val': 0.6026149751141727, 'auprc': 0.8097285718777021, 'loss_val': 0.9597558474105273, 'psi': 0.6854604138195844}-{'f1_val': 0.5692132052294815, 'auprc': 0.7114040027847526, 'loss_val': 0.8543631691425814, 'psi': 0.6260895242515899}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:44912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:44917
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:44903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:44904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:44913
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1799) from S10
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.727722)
[S13] loaded HEAD from S10 (vec_in norm=1.727722)
[S13] cosine check vs S10: cos=-0.0559
[S13] DROPPED delta from S10 (cos=-0.0559 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1799) from S15
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.663536)
[S11] loaded HEAD from S15 (vec_in norm=1.663536)
[S11] cosine check vs S15: cos=0.9687
[S11] BUFFERED delta from S15 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1801) from S2
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.780880)
[S3] loaded HEAD from S2 (vec_in norm=1.780880)
[S3] cosine check vs S2: cos=0.9948
[S3] BUFFERED delta from S2 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1800) from S3
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.800469)
[S17] loaded HEAD from S3 (vec_in norm=1.800469)
[S17] cosine check vs S3: cos=0.9953
[S17] BUFFERED delta from S3 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1795) from S11
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=2.010499)
[S4] loaded HEAD from S11 (vec_in norm=2.010499)
[S4] cosine check vs S11: cos=0.9933
[S4] BUFFERED delta from S11 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S14] ⇄ pheromone p=0.035 → S16@127.0.0.1:44916
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=30 metric=0.9384 head_norm=1.916824
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.227755e-01
[S4] stored merged vector for next round verification (round=30)
[S4] DEBUG after merge:  round=30 metric=0.9384 head_norm=1.960379 delta_norm=0.122775
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.148 → S15@127.0.0.1:44915
[S9] ⇄ pheromone p=0.051 → S8@127.0.0.1:44909
[S8] ⇄ pheromone p=0.068 → S6@127.0.0.1:44907
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=30 metric=0.8918 head_norm=1.800469
[S3] _apply_head_vector_avg (torch): Δ‖w‖=9.175526e-02
[S3] stored merged vector for next round verification (round=30)
[S3] DEBUG after merge:  round=30 metric=0.8892 head_norm=1.788349 delta_norm=0.091755
[S3] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.154 → S17@127.0.0.1:44917
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=30 metric=0.9965 head_norm=2.010499
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.871089e-01
[S11] stored merged vector for next round verification (round=30)
[S11] DEBUG after merge:  round=30 metric=0.9965 head_norm=1.822717 delta_norm=0.287109
[S11] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.023 → S4@127.0.0.1:44904
[S2] ⇄ pheromone p=0.167 → S3@127.0.0.1:44903
[S10] ⇄ pheromone p=0.019 → S13@127.0.0.1:44913
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=30 metric=0.6026 head_norm=1.732810
[S17] _apply_head_vector_avg (torch): Δ‖w‖=9.167930e-02
[S17] stored merged vector for next round verification (round=30)
[S17] DEBUG after merge:  round=30 metric=0.6008 head_norm=1.764583 delta_norm=0.091679
[S17] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.187 → S9@127.0.0.1:44910
[S15] ⇄ pheromone p=0.324 → S5@127.0.0.1:44905
[S2] START round=31 head_norm_before_train=1.780880 cos_to_last_merge=0.9986 (last merge round=26)
[S2] round=31 local utility u=0.117223 metrics={'f1_val': 0.7058004407129939, 'auprc': 0.8009152342257474, 'loss_val': 0.3732584660624261, 'psi': 0.7438463581180953}-{'f1_val': 0.7053921553802778, 'auprc': 0.7295682293096231, 'loss_val': 0.3912129781245068, 'psi': 0.7150625849520159}
[S3] START round=31 head_norm_before_train=1.788349 cos_to_last_merge=1.0000 (last merge round=30)
[S3] round=31 local utility u=0.030024 metrics={'f1_val': 0.9037737328175796, 'auprc': 0.9980886840044676, 'loss_val': 0.22196343565006707, 'psi': 0.9414997132923348}-{'f1_val': 0.8917958174604576, 'auprc': 0.9975070144797593, 'loss_val': 0.20839968154704078, 'psi': 0.9340802962681782}
[S4] START round=31 head_norm_before_train=1.960379 cos_to_last_merge=1.0000 (last merge round=30)
[S4] round=31 local utility u=0.042612 metrics={'f1_val': 0.9409438474627075, 'auprc': 0.96737210414762, 'loss_val': 0.29213056524830716, 'psi': 0.9515151501366725}-{'f1_val': 0.9383913570973237, 'auprc': 0.9418013702635547, 'loss_val': 0.28532833045191575, 'psi': 0.9397553623638161}
[S5] START round=31 head_norm_before_train=1.444392 cos_to_last_merge=0.9933 (last merge round=27)
[S5] round=31 local utility u=0.143443 metrics={'f1_val': 0.7006536512124258, 'auprc': 0.9667283083141339, 'loss_val': 0.3217894339756462, 'psi': 0.8070835140531091}-{'f1_val': 0.7006536512124258, 'auprc': 0.8872098180296606, 'loss_val': 0.37011962827728107, 'psi': 0.7752761179393197}
[S6] START round=31 head_norm_before_train=1.483297 cos_to_last_merge=0.7923 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.792
[S6] round=31 local utility u=0.223297 metrics={'f1_val': 0.9067592139636838, 'auprc': 0.9798589585647334, 'loss_val': 0.2372833755587456, 'psi': 0.9359991118041036}-{'f1_val': 0.841691709020931, 'auprc': 0.9706472567049246, 'loss_val': 0.2658379194107315, 'psi': 0.8932739280945284}
[S7] START round=31 head_norm_before_train=1.509740 cos_to_last_merge=0.8168 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.817
[S7] round=31 local utility u=0.125425 metrics={'f1_val': 0.48048617656793297, 'auprc': 0.7811986445080575, 'loss_val': 0.9245636319072209, 'psi': 0.6007711637439828}-{'f1_val': 0.4605603840325863, 'auprc': 0.7808908307841222, 'loss_val': 1.0549363225007848, 'psi': 0.5886925627332007}
[S8] START round=31 head_norm_before_train=1.090246 cos_to_last_merge=0.9979 (last merge round=29)
[S8] round=31 local utility u=0.028982 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9981115637264484, 'loss_val': 0.17018855014199333, 'psi': 0.9969664875306711}-{'f1_val': 0.9963530749356245, 'auprc': 0.9994743948039075, 'loss_val': 0.23314184676030658, 'psi': 0.9976016028829378}
[S9] START round=31 head_norm_before_train=1.248604 cos_to_last_merge=0.9979 (last merge round=29)
[S9] round=31 local utility u=0.016411 metrics={'f1_val': 0.9971609471241525, 'auprc': 0.9988658702371077, 'loss_val': 0.09741127160510551, 'psi': 0.9978429163693346}-{'f1_val': 0.9971609471241525, 'auprc': 0.9988600135365612, 'loss_val': 0.13021614099958762, 'psi': 0.997840573689116}
[S10] START round=31 head_norm_before_train=1.727722 cos_to_last_merge=0.8249 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.825
[S10] round=31 local utility u=0.000000 metrics={'f1_val': 0.9941183616473943, 'auprc': 0.9964930299500279, 'loss_val': 0.043519987268202005, 'psi': 0.9950682289684477}-{'f1_val': 0.9946220143540194, 'auprc': 0.9960762678823437, 'loss_val': 0.04039494222269406, 'psi': 0.9952037157653492}
[S11] START round=31 head_norm_before_train=1.822717 cos_to_last_merge=1.0000 (last merge round=30)
[S11] round=31 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9987055657784913, 'loss_val': 0.04415305984622139, 'psi': 0.9974104290195502}-{'f1_val': 0.9965470045135896, 'auprc': 0.998598786691675, 'loss_val': 0.0372395292002688, 'psi': 0.9973677173848238}
[S13] START round=31 head_norm_before_train=1.701673 (no previous merge yet)
[S13] round=31 local utility u=0.143429 metrics={'f1_val': 0.6168344919757797, 'auprc': 0.655281580590661, 'loss_val': 0.7229854738170077, 'psi': 0.6322133274217322}-{'f1_val': 0.5789611992625276, 'auprc': 0.6907577336326831, 'loss_val': 0.8890331711395056, 'psi': 0.6236798130105898}
[S14] START round=31 head_norm_before_train=1.152066 cos_to_last_merge=0.9973 (last merge round=29)
[S14] round=31 local utility u=0.123395 metrics={'f1_val': 0.9974537796719909, 'auprc': 0.9986163656636219, 'loss_val': 0.1646430166752648, 'psi': 0.9979188140686432}-{'f1_val': 0.9679549312515116, 'auprc': 0.9982096225689447, 'loss_val': 0.23322050246049184, 'psi': 0.9800568077784848}
[S15] START round=31 head_norm_before_train=1.663536 cos_to_last_merge=0.9993 (last merge round=29)
[S15] round=31 local utility u=0.000000 metrics={'f1_val': 0.7502552232676422, 'auprc': 0.9810880638020206, 'loss_val': 0.37578501193347835, 'psi': 0.8425883594813935}-{'f1_val': 0.9911030436738927, 'auprc': 0.9969995652200436, 'loss_val': 0.14333373600196778, 'psi': 0.9934616522923531}
[S16] START round=31 head_norm_before_train=1.122840 cos_to_last_merge=0.9885 (last merge round=28)
[S16] round=31 local utility u=0.000000 metrics={'f1_val': 0.8562240309258227, 'auprc': 0.9860498133198685, 'loss_val': 0.5504386269554726, 'psi': 0.9081543438834411}-{'f1_val': 0.8771102336003149, 'auprc': 0.9891363585314079, 'loss_val': 0.5044922901806516, 'psi': 0.921920683572752}
[S17] START round=31 head_norm_before_train=1.764583 cos_to_last_merge=1.0000 (last merge round=30)
[S17] round=31 local utility u=0.144945 metrics={'f1_val': 0.6026562160256445, 'auprc': 0.8552354225153054, 'loss_val': 0.8066329775266641, 'psi': 0.7036878986215088}-{'f1_val': 0.6026149751141727, 'auprc': 0.8097285718777021, 'loss_val': 0.9597558474105273, 'psi': 0.6854604138195844}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:44912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:44903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:44907
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:44917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:44909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:44911
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:44915
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1802) from S2
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.796776)
[S3] loaded HEAD from S2 (vec_in norm=1.796776)
[S3] cosine check vs S2: cos=0.9978
[S3] BUFFERED delta from S2 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1800) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.973229)
[S11] loaded HEAD from S4 (vec_in norm=1.973229)
[S11] cosine check vs S4: cos=0.9914
[S11] BUFFERED delta from S4 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1796) from S8
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.142668)
[S6] loaded HEAD from S8 (vec_in norm=1.142668)
[S6] cosine check vs S8: cos=0.4822
[S6] BUFFERED delta from S8 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1799) from S13
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.706484)
[S10] loaded HEAD from S13 (vec_in norm=1.706484)
[S10] cosine check vs S13: cos=-0.0548
[S10] DROPPED delta from S13 (cos=-0.0548 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1800) from S6
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.498392)
[S8] loaded HEAD from S6 (vec_in norm=1.498392)
[S8] cosine check vs S6: cos=0.4822
[S8] BUFFERED delta from S6 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1801) from S5
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.469283)
[S15] loaded HEAD from S5 (vec_in norm=1.469283)
[S15] cosine check vs S5: cos=0.8274
[S15] BUFFERED delta from S5 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1797) from S14
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.202530)
[S16] loaded HEAD from S14 (vec_in norm=1.202530)
[S16] cosine check vs S14: cos=0.9444
[S16] BUFFERED delta from S14 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1800) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.306838)
[S16] loaded HEAD from S9 (vec_in norm=1.306838)
[S16] cosine check vs S9: cos=0.6732
[S16] BUFFERED delta from S9 (total buffered=2)
[S17] RECEIVED delta(kind=head bytes=1797) from S3
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.818319)
[S17] loaded HEAD from S3 (vec_in norm=1.818319)
[S17] cosine check vs S3: cos=0.9956
[S17] BUFFERED delta from S3 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:44903
[S17] sending update (kind=head size=1803 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1803) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.777836)
[S3] loaded HEAD from S17 (vec_in norm=1.777836)
[S3] cosine check vs S17: cos=0.9956
[S3] BUFFERED delta from S17 (total buffered=2)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=31 metric=0.9965 head_norm=1.843701
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.408973e-01
[S11] stored merged vector for next round verification (round=31)
[S11] DEBUG after merge:  round=31 metric=0.9965 head_norm=1.904358 delta_norm=0.140897
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=31 metric=0.9038 head_norm=1.818319
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.231596e-02
[S3] stored merged vector for next round verification (round=31)
[S3] DEBUG after merge:  round=31 metric=0.9038 head_norm=1.800286 delta_norm=0.042316
[S3] aggregate: ACCEPT kept=['S2', 'S17'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=31 metric=0.9962 head_norm=1.142668
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.891661e-01
[S8] stored merged vector for next round verification (round=31)
[S8] DEBUG after merge:  round=31 metric=0.9962 head_norm=1.140388 delta_norm=0.689166
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=31 metric=0.9068 head_norm=1.498392
[S6] _apply_head_vector_avg (torch): Δ‖w‖=6.891661e-01
[S6] stored merged vector for next round verification (round=31)
[S6] DEBUG after merge:  round=31 metric=0.8659 head_norm=1.140388 delta_norm=0.689166
[S6] aggregate: ROLLBACK (f1_val pre=0.907 post=0.866 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=31 metric=0.7503 head_norm=1.691425
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.761784e-01
[S15] stored merged vector for next round verification (round=31)
[S15] DEBUG after merge:  round=31 metric=0.7455 head_norm=1.510996 delta_norm=0.476178
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=31 metric=0.6027 head_norm=1.777836
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.672927e-02
[S17] stored merged vector for next round verification (round=31)
[S17] DEBUG after merge:  round=31 metric=0.6047 head_norm=1.796099 delta_norm=0.086729
[S17] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=31 metric=0.8562 head_norm=1.177863
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.030441e-01
[S16] stored merged vector for next round verification (round=31)
[S16] DEBUG after merge:  round=31 metric=0.8577 head_norm=1.130820 delta_norm=0.303044
[S16] aggregate: ACCEPT kept=['S14', 'S9'] (k=2/2) mode=median trim_p=0.1
[S2] START round=32 head_norm_before_train=1.796776 cos_to_last_merge=0.9978 (last merge round=26)
[S2] round=32 local utility u=0.000000 metrics={'f1_val': 0.4344333818818527, 'auprc': 0.6540644264554933, 'loss_val': 1.0409384798941224, 'psi': 0.522285799711309}-{'f1_val': 0.7058004407129939, 'auprc': 0.8009152342257474, 'loss_val': 0.3732584660624261, 'psi': 0.7438463581180953}
[S3] START round=32 head_norm_before_train=1.800286 cos_to_last_merge=1.0000 (last merge round=31)
[S3] round=32 local utility u=0.000000 metrics={'f1_val': 0.870538888254893, 'auprc': 0.9981223533370134, 'loss_val': 0.27457502987551424, 'psi': 0.9215722742877411}-{'f1_val': 0.9037737328175796, 'auprc': 0.9980886840044676, 'loss_val': 0.22196343565006707, 'psi': 0.9414997132923348}
[S4] START round=32 head_norm_before_train=1.973229 cos_to_last_merge=1.0000 (last merge round=30)
[S4] round=32 local utility u=0.005366 metrics={'f1_val': 0.9409438474627075, 'auprc': 0.9709587982363038, 'loss_val': 0.292158087112819, 'psi': 0.952949827772146}-{'f1_val': 0.9409438474627075, 'auprc': 0.96737210414762, 'loss_val': 0.29213056524830716, 'psi': 0.9515151501366725}
[S5] START round=32 head_norm_before_train=1.469283 cos_to_last_merge=0.9904 (last merge round=27)
[S5] round=32 local utility u=0.000000 metrics={'f1_val': 0.4228938349315548, 'auprc': 0.6917144012938906, 'loss_val': 0.9577826299632597, 'psi': 0.5304220614764892}-{'f1_val': 0.7006536512124258, 'auprc': 0.9667283083141339, 'loss_val': 0.3217894339756462, 'psi': 0.8070835140531091}
[S6] START round=32 head_norm_before_train=1.140388 cos_to_last_merge=1.0000 (last merge round=31)
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.6746518868084622, 'auprc': 0.9529613402769064, 'loss_val': 0.5893362876829427, 'psi': 0.7859756681958399}-{'f1_val': 0.9067592139636838, 'auprc': 0.9798589585647334, 'loss_val': 0.2372833755587456, 'psi': 0.9359991118041036}
[S7] START round=32 head_norm_before_train=1.516426 cos_to_last_merge=0.8161 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.816
[S7] round=32 local utility u=0.651575 metrics={'f1_val': 0.6282241777011174, 'auprc': 0.7952766053721393, 'loss_val': 0.5500764609694802, 'psi': 0.6950451487695262}-{'f1_val': 0.48048617656793297, 'auprc': 0.7811986445080575, 'loss_val': 0.9245636319072209, 'psi': 0.6007711637439828}
[S8] START round=32 head_norm_before_train=1.140388 cos_to_last_merge=1.0000 (last merge round=31)
[S8] round=32 local utility u=0.012391 metrics={'f1_val': 0.9957619501091535, 'auprc': 0.9991597464494283, 'loss_val': 0.14590457717656682, 'psi': 0.9971210686452634}-{'f1_val': 0.9962031034001528, 'auprc': 0.9981115637264484, 'loss_val': 0.17018855014199333, 'psi': 0.9969664875306711}
[S9] START round=32 head_norm_before_train=1.306838 cos_to_last_merge=0.9934 (last merge round=29)
[S9] round=32 local utility u=0.009789 metrics={'f1_val': 0.9975426610709598, 'auprc': 0.9984889035970864, 'loss_val': 0.07899197729309744, 'psi': 0.9979211580814105}-{'f1_val': 0.9971609471241525, 'auprc': 0.9988658702371077, 'loss_val': 0.09741127160510551, 'psi': 0.9978429163693346}
[S10] START round=32 head_norm_before_train=1.744887 cos_to_last_merge=0.8236 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.824
[S10] round=32 local utility u=0.000000 metrics={'f1_val': 0.8975503188586423, 'auprc': 0.9893385976515843, 'loss_val': 0.20580371983303986, 'psi': 0.9342656303758192}-{'f1_val': 0.9941183616473943, 'auprc': 0.9964930299500279, 'loss_val': 0.043519987268202005, 'psi': 0.9950682289684477}
[S11] START round=32 head_norm_before_train=1.904358 cos_to_last_merge=1.0000 (last merge round=31)
[S11] round=32 local utility u=0.000000 metrics={'f1_val': 0.9185625473507983, 'auprc': 0.9982102182755966, 'loss_val': 0.23685413549977763, 'psi': 0.9504216157207177}-{'f1_val': 0.9965470045135896, 'auprc': 0.9987055657784913, 'loss_val': 0.04415305984622139, 'psi': 0.9974104290195502}
[S13] START round=32 head_norm_before_train=1.706484 (no previous merge yet)
[S13] round=32 local utility u=0.008623 metrics={'f1_val': 0.6135305401334914, 'auprc': 0.6792910828526013, 'loss_val': 0.7579447223354244, 'psi': 0.6398347572211354}-{'f1_val': 0.6168344919757797, 'auprc': 0.655281580590661, 'loss_val': 0.7229854738170077, 'psi': 0.6322133274217322}
[S14] START round=32 head_norm_before_train=1.202530 cos_to_last_merge=0.9924 (last merge round=29)
[S14] round=32 local utility u=0.000000 metrics={'f1_val': 0.9599558358426158, 'auprc': 0.9986874269256123, 'loss_val': 0.14978212249876877, 'psi': 0.9754484722758144}-{'f1_val': 0.9974537796719909, 'auprc': 0.9986163656636219, 'loss_val': 0.1646430166752648, 'psi': 0.9979188140686432}
[S15] START round=32 head_norm_before_train=1.510996 cos_to_last_merge=1.0000 (last merge round=31)
[S15] round=32 local utility u=0.283385 metrics={'f1_val': 0.8193049521247834, 'auprc': 0.993887784761871, 'loss_val': 0.2617129282581779, 'psi': 0.8891380851796185}-{'f1_val': 0.7502552232676422, 'auprc': 0.9810880638020206, 'loss_val': 0.37578501193347835, 'psi': 0.8425883594813935}
[S16] START round=32 head_norm_before_train=1.130820 cos_to_last_merge=1.0000 (last merge round=31)
[S16] round=32 local utility u=0.063168 metrics={'f1_val': 0.8658000902999909, 'auprc': 0.9888988776197593, 'loss_val': 0.4901062189826547, 'psi': 0.9150396052278983}-{'f1_val': 0.8562240309258227, 'auprc': 0.9860498133198685, 'loss_val': 0.5504386269554726, 'psi': 0.9081543438834411}
[S17] START round=32 head_norm_before_train=1.796099 cos_to_last_merge=1.0000 (last merge round=31)
[S17] round=32 local utility u=0.588541 metrics={'f1_val': 0.7152774942163687, 'auprc': 0.9339359074713633, 'loss_val': 0.5413794433769582, 'psi': 0.8027408595183665}-{'f1_val': 0.6026562160256445, 'auprc': 0.8552354225153054, 'loss_val': 0.8066329775266641, 'psi': 0.7036878986215088}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] → sending delta(kind=head bytes=1805) to S10@127.0.0.1:44911
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:44910
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S9] → sending delta(kind=head bytes=1806) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:44907
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:44912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:44905
[S16] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1806 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1805 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1806) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.358582)
[S16] loaded HEAD from S9 (vec_in norm=1.358582)
[S16] cosine check vs S9: cos=0.8249
[S16] BUFFERED delta from S9 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1795) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.979319)
[S11] loaded HEAD from S4 (vec_in norm=1.979319)
[S11] cosine check vs S4: cos=0.9977
[S11] BUFFERED delta from S4 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1801) from S16
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.181538)
[S9] loaded HEAD from S16 (vec_in norm=1.181538)
[S9] cosine check vs S16: cos=0.8249
[S9] BUFFERED delta from S16 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1805) from S13
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.713931)
[S10] loaded HEAD from S13 (vec_in norm=1.713931)
[S10] cosine check vs S13: cos=-0.0545
[S10] DROPPED delta from S13 (cos=-0.0545 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1799) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.539399)
[S5] loaded HEAD from S15 (vec_in norm=1.539399)
[S5] cosine check vs S15: cos=0.9490
[S5] BUFFERED delta from S15 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:44903
[S17] sending update (kind=head size=1799 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1799) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.809368)
[S3] loaded HEAD from S17 (vec_in norm=1.809368)
[S3] cosine check vs S17: cos=0.9988
[S3] BUFFERED delta from S17 (total buffered=1)
[S8] sending update (kind=head size=1800 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1800) from S8
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.191016)
[S6] loaded HEAD from S8 (vec_in norm=1.191016)
[S6] cosine check vs S8: cos=0.9986
[S6] BUFFERED delta from S8 (total buffered=1)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=32 metric=0.6747 head_norm=1.165186
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.413159e-02
[S6] stored merged vector for next round verification (round=32)
[S6] DEBUG after merge:  round=32 metric=0.6685 head_norm=1.177678 delta_norm=0.034132
[S6] aggregate: ROLLBACK (f1_val pre=0.675 post=0.668 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=32 metric=0.9186 head_norm=1.922722
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.220519e-02
[S11] stored merged vector for next round verification (round=32)
[S11] DEBUG after merge:  round=32 metric=0.9162 head_norm=1.949889 delta_norm=0.072205
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=32 metric=0.9975 head_norm=1.358582
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.852240e-01
[S9] stored merged vector for next round verification (round=32)
[S9] DEBUG after merge:  round=32 metric=0.9975 head_norm=1.213462 delta_norm=0.385224
[S9] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=32 metric=0.8658 head_norm=1.181538
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.852240e-01
[S16] stored merged vector for next round verification (round=32)
[S16] DEBUG after merge:  round=32 metric=0.8675 head_norm=1.213462 delta_norm=0.385224
[S16] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=32 metric=0.8705 head_norm=1.828745
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.497360e-02
[S3] stored merged vector for next round verification (round=32)
[S3] DEBUG after merge:  round=32 metric=0.8705 head_norm=1.818526 delta_norm=0.044974
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=32 metric=0.4229 head_norm=1.487117
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.429511e-01
[S5] stored merged vector for next round verification (round=32)
[S5] DEBUG after merge:  round=32 metric=0.4231 head_norm=1.493857 delta_norm=0.242951
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=33 head_norm_before_train=1.809574 cos_to_last_merge=0.9971 (last merge round=26)
[S2] round=33 local utility u=1.000000 metrics={'f1_val': 0.7140907822436273, 'auprc': 0.807015406868273, 'loss_val': 0.40452298389044766, 'psi': 0.7512606320934856}-{'f1_val': 0.4344333818818527, 'auprc': 0.6540644264554933, 'loss_val': 1.0409384798941224, 'psi': 0.522285799711309}
[S3] START round=33 head_norm_before_train=1.818526 cos_to_last_merge=1.0000 (last merge round=32)
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.8423042987525089, 'auprc': 0.985804206936739, 'loss_val': 0.35742539268403956, 'psi': 0.8997042620262009}-{'f1_val': 0.870538888254893, 'auprc': 0.9981223533370134, 'loss_val': 0.27457502987551424, 'psi': 0.9215722742877411}
[S4] START round=33 head_norm_before_train=1.979319 cos_to_last_merge=0.9999 (last merge round=30)
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.9407123957493898, 'auprc': 0.9679269797515206, 'loss_val': 0.29480971262826444, 'psi': 0.9515982293502421}-{'f1_val': 0.9409438474627075, 'auprc': 0.9709587982363038, 'loss_val': 0.292158087112819, 'psi': 0.952949827772146}
[S5] START round=33 head_norm_before_train=1.493857 cos_to_last_merge=1.0000 (last merge round=32)
[S5] round=33 local utility u=1.000000 metrics={'f1_val': 0.9845365605889473, 'auprc': 0.9876887128543801, 'loss_val': 0.15052416752899878, 'psi': 0.9857974214951204}-{'f1_val': 0.4228938349315548, 'auprc': 0.6917144012938906, 'loss_val': 0.9577826299632597, 'psi': 0.5304220614764892}
[S6] START round=33 head_norm_before_train=1.177678 cos_to_last_merge=1.0000 (last merge round=32)
[S6] round=33 local utility u=0.212048 metrics={'f1_val': 0.7396649634918482, 'auprc': 0.9456091186658716, 'loss_val': 0.533261579694517, 'psi': 0.8220426255614575}-{'f1_val': 0.6746518868084622, 'auprc': 0.9529613402769064, 'loss_val': 0.5893362876829427, 'psi': 0.7859756681958399}
[S7] START round=33 head_norm_before_train=1.523750 cos_to_last_merge=0.8152 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.815
[S7] round=33 local utility u=0.000000 metrics={'f1_val': 0.479767645689712, 'auprc': 0.7811617103696004, 'loss_val': 0.961535717365805, 'psi': 0.6003252715616674}-{'f1_val': 0.6282241777011174, 'auprc': 0.7952766053721393, 'loss_val': 0.5500764609694802, 'psi': 0.6950451487695262}
[S8] START round=33 head_norm_before_train=1.191016 cos_to_last_merge=0.9991 (last merge round=31)
[S8] round=33 local utility u=0.008119 metrics={'f1_val': 0.9950790219939822, 'auprc': 0.9990351007466056, 'loss_val': 0.1251948833858757, 'psi': 0.9966614534950315}-{'f1_val': 0.9957619501091535, 'auprc': 0.9991597464494283, 'loss_val': 0.14590457717656682, 'psi': 0.9971210686452634}
[S9] START round=33 head_norm_before_train=1.213462 cos_to_last_merge=1.0000 (last merge round=32)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.9971609471241525, 'auprc': 0.9988388743315737, 'loss_val': 0.09866582593154628, 'psi': 0.997832118007121}-{'f1_val': 0.9975426610709598, 'auprc': 0.9984889035970864, 'loss_val': 0.07899197729309744, 'psi': 0.9979211580814105}
[S10] START round=33 head_norm_before_train=1.761328 cos_to_last_merge=0.8225 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.822
[S10] round=33 local utility u=0.380880 metrics={'f1_val': 0.9941183616473943, 'auprc': 0.9962097145759743, 'loss_val': 0.04406472234074661, 'psi': 0.9949549028188263}-{'f1_val': 0.8975503188586423, 'auprc': 0.9893385976515843, 'loss_val': 0.20580371983303986, 'psi': 0.9342656303758192}
[S11] START round=33 head_norm_before_train=1.949889 cos_to_last_merge=1.0000 (last merge round=32)
[S11] round=33 local utility u=0.330391 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9983760273459863, 'loss_val': 0.04054475794567725, 'psi': 0.9968855136595429}-{'f1_val': 0.9185625473507983, 'auprc': 0.9982102182755966, 'loss_val': 0.23685413549977763, 'psi': 0.9504216157207177}
[S13] START round=33 head_norm_before_train=1.713931 (no previous merge yet)
[S13] round=33 local utility u=0.153311 metrics={'f1_val': 0.6359293134401263, 'auprc': 0.6720942852911519, 'loss_val': 0.5641241884907036, 'psi': 0.6503953021805365}-{'f1_val': 0.6135305401334914, 'auprc': 0.6792910828526013, 'loss_val': 0.7579447223354244, 'psi': 0.6398347572211354}
[S14] START round=33 head_norm_before_train=1.249441 cos_to_last_merge=0.9872 (last merge round=29)
[S14] round=33 local utility u=0.130471 metrics={'f1_val': 0.9965574496053289, 'auprc': 0.9975567194903602, 'loss_val': 0.10505772802206864, 'psi': 0.9969571575593414}-{'f1_val': 0.9599558358426158, 'auprc': 0.9986874269256123, 'loss_val': 0.14978212249876877, 'psi': 0.9754484722758144}
[S15] START round=33 head_norm_before_train=1.539399 cos_to_last_merge=0.9995 (last merge round=31)
[S15] round=33 local utility u=0.200475 metrics={'f1_val': 0.8744091213379718, 'auprc': 0.9923886011234753, 'loss_val': 0.18689085067049563, 'psi': 0.9216009132521732}-{'f1_val': 0.8193049521247834, 'auprc': 0.993887784761871, 'loss_val': 0.2617129282581779, 'psi': 0.8891380851796185}
[S16] START round=33 head_norm_before_train=1.213462 cos_to_last_merge=1.0000 (last merge round=32)
[S16] round=33 local utility u=0.218848 metrics={'f1_val': 0.9182267833768278, 'auprc': 0.9858819600053649, 'loss_val': 0.35791904358869975, 'psi': 0.9452888540282427}-{'f1_val': 0.8658000902999909, 'auprc': 0.9888988776197593, 'loss_val': 0.4901062189826547, 'psi': 0.9150396052278983}
[S17] START round=33 head_norm_before_train=1.809368 cos_to_last_merge=0.9999 (last merge round=31)
[S17] round=33 local utility u=0.000000 metrics={'f1_val': 0.6576706392498406, 'auprc': 0.8387454945544037, 'loss_val': 0.8250761138767869, 'psi': 0.7301005813716659}-{'f1_val': 0.7152774942163687, 'auprc': 0.9339359074713633, 'loss_val': 0.5413794433769582, 'psi': 0.8027408595183665}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S13] → sending delta(kind=head bytes=1807) to S10@127.0.0.1:44911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:44909
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1807 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1807) from S13
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.717155)
[S10] loaded HEAD from S13 (vec_in norm=1.717155)
[S10] cosine check vs S13: cos=-0.0524
[S10] DROPPED delta from S13 (cos=-0.0524 < 0.0)
[S6] sending update (kind=head size=1797 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1797) from S6
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.218777)
[S8] loaded HEAD from S6 (vec_in norm=1.218777)
[S8] cosine check vs S6: cos=0.9960
[S8] BUFFERED delta from S6 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:44905
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:44913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:44907
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:44904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:44916
[S15] sending update (kind=head size=1800 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1800) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.566907)
[S5] loaded HEAD from S15 (vec_in norm=1.566907)
[S5] cosine check vs S15: cos=0.9867
[S5] BUFFERED delta from S15 (total buffered=1)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1793 to 1 peers)
[S14] sending update (kind=head size=1805 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1799) from S10
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.773959)
[S13] loaded HEAD from S10 (vec_in norm=1.773959)
[S13] cosine check vs S10: cos=-0.0524
[S13] DROPPED delta from S10 (cos=-0.0524 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1801) from S11
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.962827)
[S4] loaded HEAD from S11 (vec_in norm=1.962827)
[S4] cosine check vs S11: cos=0.9993
[S4] BUFFERED delta from S11 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1793) from S8
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.231792)
[S6] loaded HEAD from S8 (vec_in norm=1.231792)
[S6] cosine check vs S8: cos=0.9960
[S6] BUFFERED delta from S8 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1805) from S14
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.296003)
[S16] loaded HEAD from S14 (vec_in norm=1.296003)
[S16] cosine check vs S14: cos=0.8579
[S16] BUFFERED delta from S14 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] → sending delta(kind=head bytes=1805) to S3@127.0.0.1:44903
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S16] → sending delta(kind=head bytes=1806) to S9@127.0.0.1:44910
[S2] sending update (kind=head size=1805 to 1 peers)
[S16] sending update (kind=head size=1806 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1805) from S2
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.818765)
[S3] loaded HEAD from S2 (vec_in norm=1.818765)
[S3] cosine check vs S2: cos=0.9950
[S3] BUFFERED delta from S2 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1806) from S16
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.258511)
[S9] loaded HEAD from S16 (vec_in norm=1.258511)
[S9] cosine check vs S16: cos=0.9982
[S9] BUFFERED delta from S16 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:44915
[S5] sending update (kind=head size=1804 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1804) from S5
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.503726)
[S15] loaded HEAD from S5 (vec_in norm=1.503726)
[S15] cosine check vs S5: cos=0.9867
[S15] BUFFERED delta from S5 (total buffered=1)
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S16
[S5]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S7
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S15
[S16]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=33 metric=0.9182 head_norm=1.258511
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.409777e-01
[S16] stored merged vector for next round verification (round=33)
[S16] DEBUG after merge:  round=33 metric=0.9111 head_norm=1.231045 delta_norm=0.340978
[S16] aggregate: ROLLBACK (f1_val pre=0.918 post=0.911 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=33 metric=0.9845 head_norm=1.503726
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.293153e-01
[S5] stored merged vector for next round verification (round=33)
[S5] DEBUG after merge:  round=33 metric=0.9615 head_norm=1.530187 delta_norm=0.129315
[S5] aggregate: ROLLBACK (f1_val pre=0.985 post=0.962 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=33 metric=0.9972 head_norm=1.262080
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.781812e-02
[S9] stored merged vector for next round verification (round=33)
[S9] DEBUG after merge:  round=33 metric=0.9972 head_norm=1.259729 delta_norm=0.037818
[S9] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=33 metric=0.7397 head_norm=1.218777
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.493623e-02
[S6] stored merged vector for next round verification (round=33)
[S6] DEBUG after merge:  round=33 metric=0.7249 head_norm=1.224070 delta_norm=0.054936
[S6] aggregate: ROLLBACK (f1_val pre=0.740 post=0.725 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=33 metric=0.8744 head_norm=1.566907
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.293153e-01
[S15] stored merged vector for next round verification (round=33)
[S15] DEBUG after merge:  round=33 metric=0.8712 head_norm=1.530187 delta_norm=0.129315
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=33 metric=0.9407 head_norm=1.983274
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.922535e-02
[S4] stored merged vector for next round verification (round=33)
[S4] DEBUG after merge:  round=33 metric=0.9407 head_norm=1.972687 delta_norm=0.039225
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=33 metric=0.9951 head_norm=1.231792
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.493623e-02
[S8] stored merged vector for next round verification (round=33)
[S8] DEBUG after merge:  round=33 metric=0.9951 head_norm=1.224070 delta_norm=0.054936
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=33 metric=0.8423 head_norm=1.851498
[S3] _apply_head_vector_avg (torch): Δ‖w‖=9.348432e-02
[S3] stored merged vector for next round verification (round=33)
[S3] DEBUG after merge:  round=33 metric=0.8404 head_norm=1.832822 delta_norm=0.093484
[S3] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=34 head_norm_before_train=1.818765 cos_to_last_merge=0.9966 (last merge round=26)
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.6653244262527522, 'auprc': 0.7241498508826922, 'loss_val': 0.542838774612994, 'psi': 0.6888545961047282}-{'f1_val': 0.7140907822436273, 'auprc': 0.807015406868273, 'loss_val': 0.40452298389044766, 'psi': 0.7512606320934856}
[S3] START round=34 head_norm_before_train=1.832822 cos_to_last_merge=1.0000 (last merge round=33)
[S3] round=34 local utility u=0.321514 metrics={'f1_val': 0.9158339723849407, 'auprc': 0.9982551774964519, 'loss_val': 0.19292854327503328, 'psi': 0.9488024544295453}-{'f1_val': 0.8423042987525089, 'auprc': 0.985804206936739, 'loss_val': 0.35742539268403956, 'psi': 0.8997042620262009}
[S4] START round=34 head_norm_before_train=1.972687 cos_to_last_merge=1.0000 (last merge round=33)
[S4] round=34 local utility u=0.000000 metrics={'f1_val': 0.9339006880458222, 'auprc': 0.9356634035695315, 'loss_val': 0.34804777151365063, 'psi': 0.9346057742553059}-{'f1_val': 0.9407123957493898, 'auprc': 0.9679269797515206, 'loss_val': 0.29480971262826444, 'psi': 0.9515982293502421}
[S5] START round=34 head_norm_before_train=1.530187 cos_to_last_merge=1.0000 (last merge round=33)
[S5] round=34 local utility u=0.000000 metrics={'f1_val': 0.9030183677236561, 'auprc': 0.990297851166657, 'loss_val': 0.18192095918495402, 'psi': 0.9379301611008565}-{'f1_val': 0.9845365605889473, 'auprc': 0.9876887128543801, 'loss_val': 0.15052416752899878, 'psi': 0.9857974214951204}
[S6] START round=34 head_norm_before_train=1.224070 cos_to_last_merge=1.0000 (last merge round=33)
[S6] round=34 local utility u=0.689479 metrics={'f1_val': 0.9065569031312674, 'auprc': 0.9729501584588165, 'loss_val': 0.23767919895905618, 'psi': 0.933114205262287}-{'f1_val': 0.7396649634918482, 'auprc': 0.9456091186658716, 'loss_val': 0.533261579694517, 'psi': 0.8220426255614575}
[S7] START round=34 head_norm_before_train=1.533136 cos_to_last_merge=0.8139 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.814
[S7] round=34 local utility u=1.000000 metrics={'f1_val': 0.690990885240189, 'auprc': 0.8903229408521272, 'loss_val': 0.24104276275829942, 'psi': 0.7707237074849643}-{'f1_val': 0.479767645689712, 'auprc': 0.7811617103696004, 'loss_val': 0.961535717365805, 'psi': 0.6003252715616674}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=34 head_norm_before_train=1.224070 cos_to_last_merge=1.0000 (last merge round=33)
[S8] round=34 local utility u=0.013927 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9991418972796828, 'loss_val': 0.10530571310108358, 'psi': 0.9974686038732479}-{'f1_val': 0.9950790219939822, 'auprc': 0.9990351007466056, 'loss_val': 0.1251948833858757, 'psi': 0.9966614534950315}
[S9] START round=34 head_norm_before_train=1.259729 cos_to_last_merge=1.0000 (last merge round=33)
[S9] round=34 local utility u=0.007112 metrics={'f1_val': 0.9971317563071089, 'auprc': 0.9984910913190675, 'loss_val': 0.0832225309453535, 'psi': 0.9976754903118924}-{'f1_val': 0.9971609471241525, 'auprc': 0.9988388743315737, 'loss_val': 0.09866582593154628, 'psi': 0.997832118007121}
[S10] START round=34 head_norm_before_train=1.773959 cos_to_last_merge=0.8216 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.822
[S10] round=34 local utility u=0.001583 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9941875111064451, 'loss_val': 0.038612813103598174, 'psi': 0.9945241699742016}-{'f1_val': 0.9941183616473943, 'auprc': 0.9962097145759743, 'loss_val': 0.04406472234074661, 'psi': 0.9949549028188263}
[S11] START round=34 head_norm_before_train=1.962827 cos_to_last_merge=1.0000 (last merge round=32)
[S11] round=34 local utility u=0.002151 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9983704414174486, 'loss_val': 0.037800214814345916, 'psi': 0.9970406614134266}-{'f1_val': 0.9958918378685807, 'auprc': 0.9983760273459863, 'loss_val': 0.04054475794567725, 'psi': 0.9968855136595429}
[S13] START round=34 head_norm_before_train=1.717155 (no previous merge yet)
[S13] round=34 local utility u=0.000000 metrics={'f1_val': 0.6075330226824288, 'auprc': 0.6923730237068988, 'loss_val': 0.7542030853264033, 'psi': 0.6414690230922169}-{'f1_val': 0.6359293134401263, 'auprc': 0.6720942852911519, 'loss_val': 0.5641241884907036, 'psi': 0.6503953021805365}
[S14] START round=34 head_norm_before_train=1.296003 cos_to_last_merge=0.9819 (last merge round=29)
[S14] round=34 local utility u=0.015447 metrics={'f1_val': 0.997871830388708, 'auprc': 0.998754281602289, 'loss_val': 0.08564327124777539, 'psi': 0.9982248108741404}-{'f1_val': 0.9965574496053289, 'auprc': 0.9975567194903602, 'loss_val': 0.10505772802206864, 'psi': 0.9969571575593414}
[S15] START round=34 head_norm_before_train=1.530187 cos_to_last_merge=1.0000 (last merge round=33)
[S15] round=34 local utility u=0.033138 metrics={'f1_val': 0.8830183108719266, 'auprc': 0.9929834725876143, 'loss_val': 0.17405416045867303, 'psi': 0.9270043755582017}-{'f1_val': 0.8744091213379718, 'auprc': 0.9923886011234753, 'loss_val': 0.18689085067049563, 'psi': 0.9216009132521732}
[S16] START round=34 head_norm_before_train=1.231045 cos_to_last_merge=1.0000 (last merge round=33)
[S16] round=34 local utility u=0.131279 metrics={'f1_val': 0.9413243669785587, 'auprc': 0.9885200749461355, 'loss_val': 0.24186179262147653, 'psi': 0.9602026501655894}-{'f1_val': 0.9182267833768278, 'auprc': 0.9858819600053649, 'loss_val': 0.35791904358869975, 'psi': 0.9452888540282427}
[S17] START round=34 head_norm_before_train=1.824839 cos_to_last_merge=0.9996 (last merge round=31)
[S17] round=34 local utility u=0.000000 metrics={'f1_val': 0.6300854285374231, 'auprc': 0.8361254630121938, 'loss_val': 0.8900565661134914, 'psi': 0.7125014423273315}-{'f1_val': 0.6576706392498406, 'auprc': 0.8387454945544037, 'loss_val': 0.8250761138767869, 'psi': 0.7301005813716659}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:44913
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:44916
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:44904
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1799) from S10
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.785089)
[S13] loaded HEAD from S10 (vec_in norm=1.785089)
[S13] cosine check vs S10: cos=-0.0509
[S13] DROPPED delta from S10 (cos=-0.0509 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1799) from S14
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.334895)
[S16] loaded HEAD from S14 (vec_in norm=1.334895)
[S16] cosine check vs S14: cos=0.9596
[S16] BUFFERED delta from S14 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1795) from S11
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.975754)
[S4] loaded HEAD from S11 (vec_in norm=1.975754)
[S4] cosine check vs S11: cos=0.9997
[S4] BUFFERED delta from S11 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:44917
[S3] sending update (kind=head size=1796 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1796) from S3
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.863369)
[S17] loaded HEAD from S3 (vec_in norm=1.863369)
[S17] cosine check vs S3: cos=0.9956
[S17] BUFFERED delta from S3 (total buffered=1)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:44909
[S6] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S6
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.266669)
[S8] loaded HEAD from S6 (vec_in norm=1.266669)
[S8] cosine check vs S6: cos=0.9982
[S8] BUFFERED delta from S6 (total buffered=1)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=34 metric=0.9339 head_norm=1.974507
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.506338e-02
[S4] stored merged vector for next round verification (round=34)
[S4] DEBUG after merge:  round=34 metric=0.9339 head_norm=1.974972 delta_norm=0.025063
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:44907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:44916
[S8] sending update (kind=head size=1796 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1796) from S8
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.258630)
[S6] loaded HEAD from S8 (vec_in norm=1.258630)
[S6] cosine check vs S8: cos=0.9982
[S6] BUFFERED delta from S8 (total buffered=1)
[S9] sending update (kind=head size=1803 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1803) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.310772)
[S16] loaded HEAD from S9 (vec_in norm=1.310772)
[S16] cosine check vs S9: cos=0.9545
[S16] BUFFERED delta from S9 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:44910
[S16] sending update (kind=head size=1797 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1797) from S16
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.274763)
[S9] loaded HEAD from S16 (vec_in norm=1.274763)
[S9] cosine check vs S16: cos=0.9545
[S9] BUFFERED delta from S16 (total buffered=1)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=34 metric=0.9971 head_norm=1.310772
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.958483e-01
[S9] stored merged vector for next round verification (round=34)
[S9] DEBUG after merge:  round=34 metric=0.9971 head_norm=1.277973 delta_norm=0.195848
[S9] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=34 metric=0.9413 head_norm=1.274763
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.842462e-02
[S16] stored merged vector for next round verification (round=34)
[S16] DEBUG after merge:  round=34 metric=0.9413 head_norm=1.270963 delta_norm=0.038425
[S16] aggregate: ACCEPT kept=['S14', 'S9'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=34 metric=0.9964 head_norm=1.258630
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.757015e-02
[S8] stored merged vector for next round verification (round=34)
[S8] DEBUG after merge:  round=34 metric=0.9964 head_norm=1.262097 delta_norm=0.037570
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S15] RoundReady barrier timeout: have=1 need=2 — continuing
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:44905
[S15] sending update (kind=head size=1801 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1801) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.556150)
[S5] loaded HEAD from S15 (vec_in norm=1.556150)
[S5] cosine check vs S15: cos=0.9997
[S5] BUFFERED delta from S15 (total buffered=1)
[S16]  timeout peer S5
[S16]  timeout peer S9
[S10]  timeout peer S13
[S2]  timeout peer S3
[S9]  timeout peer S8
[S9]  timeout peer S10
[S15]  timeout peer S2
[S15]  timeout peer S11
[S3]  timeout peer S7
[S3]  timeout peer S17
[S8]  timeout peer S6
[S8]  timeout peer S14
[S11]  timeout peer S4
[S14]  timeout peer S16
[S2] START round=35 head_norm_before_train=1.828324 cos_to_last_merge=0.9959 (last merge round=26)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.6504612164173204, 'auprc': 0.7172783659001519, 'loss_val': 0.5641285156228407, 'psi': 0.677188076210453}-{'f1_val': 0.6653244262527522, 'auprc': 0.7241498508826922, 'loss_val': 0.542838774612994, 'psi': 0.6888545961047282}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=35 head_norm_before_train=1.863369 cos_to_last_merge=0.9998 (last merge round=33)
[S3] round=35 local utility u=0.148264 metrics={'f1_val': 0.9513152656459996, 'auprc': 0.9984705627408479, 'loss_val': 0.10993443492204033, 'psi': 0.9701773844839389}-{'f1_val': 0.9158339723849407, 'auprc': 0.9982551774964519, 'loss_val': 0.19292854327503328, 'psi': 0.9488024544295453}
[S4] START round=35 head_norm_before_train=1.974972 cos_to_last_merge=1.0000 (last merge round=34)
[S4] round=35 local utility u=0.094545 metrics={'f1_val': 0.9397882719579784, 'auprc': 0.9691860869691018, 'loss_val': 0.29485167728172296, 'psi': 0.9515473979624278}-{'f1_val': 0.9339006880458222, 'auprc': 0.9356634035695315, 'loss_val': 0.34804777151365063, 'psi': 0.9346057742553059}
[S5] START round=35 head_norm_before_train=1.540802 cos_to_last_merge=0.9999 (last merge round=33)
[S5] round=35 local utility u=0.080017 metrics={'f1_val': 0.9257454070015556, 'auprc': 0.9915365165115873, 'loss_val': 0.16196600834222627, 'psi': 0.9520618508055683}-{'f1_val': 0.9030183677236561, 'auprc': 0.990297851166657, 'loss_val': 0.18192095918495402, 'psi': 0.9379301611008565}
[S6] START round=35 head_norm_before_train=1.266669 cos_to_last_merge=0.9988 (last merge round=33)
[S6] round=35 local utility u=0.000000 metrics={'f1_val': 0.6886331234837787, 'auprc': 0.8981547332846478, 'loss_val': 0.6207558894324384, 'psi': 0.7724417674041264}-{'f1_val': 0.9065569031312674, 'auprc': 0.9729501584588165, 'loss_val': 0.23767919895905618, 'psi': 0.933114205262287}
[S7] START round=35 head_norm_before_train=1.543882 cos_to_last_merge=0.8131 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.813
[S7] round=35 local utility u=0.000000 metrics={'f1_val': 0.4234409962222857, 'auprc': 0.7799909923751558, 'loss_val': 1.4001818188638755, 'psi': 0.5660609946834337}-{'f1_val': 0.690990885240189, 'auprc': 0.8903229408521272, 'loss_val': 0.24104276275829942, 'psi': 0.7707237074849643}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=35 head_norm_before_train=1.262097 cos_to_last_merge=1.0000 (last merge round=34)
[S8] round=35 local utility u=0.005674 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9991469860980356, 'loss_val': 0.09307245022359097, 'psi': 0.997380656479306}-{'f1_val': 0.9963530749356245, 'auprc': 0.9991418972796828, 'loss_val': 0.10530571310108358, 'psi': 0.9974686038732479}
[S9] START round=35 head_norm_before_train=1.277973 cos_to_last_merge=1.0000 (last merge round=34)
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.9971317563071089, 'auprc': 0.9991313660198884, 'loss_val': 0.08638325666874408, 'psi': 0.9979316001922207}-{'f1_val': 0.9971317563071089, 'auprc': 0.9984910913190675, 'loss_val': 0.0832225309453535, 'psi': 0.9976754903118924}
[S10] START round=35 head_norm_before_train=1.785089 cos_to_last_merge=0.8208 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.821
[S10] round=35 local utility u=0.001531 metrics={'f1_val': 0.9939400388726987, 'auprc': 0.9963742472376362, 'loss_val': 0.03725916042005344, 'psi': 0.9949137222186737}-{'f1_val': 0.9947486092193725, 'auprc': 0.9941875111064451, 'loss_val': 0.038612813103598174, 'psi': 0.9945241699742016}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=35 head_norm_before_train=1.975754 cos_to_last_merge=0.9999 (last merge round=32)
[S11] round=35 local utility u=0.001296 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9984937285918364, 'loss_val': 0.03557792431159291, 'psi': 0.9970899762831817}-{'f1_val': 0.9961541414107454, 'auprc': 0.9983704414174486, 'loss_val': 0.037800214814345916, 'psi': 0.9970406614134266}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=35 head_norm_before_train=1.720247 (no previous merge yet)
[S13] round=35 local utility u=0.084398 metrics={'f1_val': 0.6283472656328433, 'auprc': 0.6787649550103412, 'loss_val': 0.6694690696329411, 'psi': 0.6485143413838425}-{'f1_val': 0.6075330226824288, 'auprc': 0.6923730237068988, 'loss_val': 0.7542030853264033, 'psi': 0.6414690230922169}
[S14] START round=35 head_norm_before_train=1.334895 cos_to_last_merge=0.9774 (last merge round=29)
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.9965803821790421, 'auprc': 0.9984359643173202, 'loss_val': 0.0782514946409816, 'psi': 0.9973226150343533}-{'f1_val': 0.997871830388708, 'auprc': 0.998754281602289, 'loss_val': 0.08564327124777539, 'psi': 0.9982248108741404}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=35 head_norm_before_train=1.556150 cos_to_last_merge=0.9998 (last merge round=33)
[S15] round=35 local utility u=0.000000 metrics={'f1_val': 0.6998700924264248, 'auprc': 0.8146713342403018, 'loss_val': 0.4598954832028077, 'psi': 0.7457905891519756}-{'f1_val': 0.8830183108719266, 'auprc': 0.9929834725876143, 'loss_val': 0.17405416045867303, 'psi': 0.9270043755582017}
[S16] START round=35 head_norm_before_train=1.270963 cos_to_last_merge=1.0000 (last merge round=34)
[S16] round=35 local utility u=0.000000 metrics={'f1_val': 0.9156683837345334, 'auprc': 0.9905018144513054, 'loss_val': 0.35138062983769425, 'psi': 0.9456017560212422}-{'f1_val': 0.9413243669785587, 'auprc': 0.9885200749461355, 'loss_val': 0.24186179262147653, 'psi': 0.9602026501655894}
[S17] START round=35 head_norm_before_train=1.842071 cos_to_last_merge=0.9989 (last merge round=31)
[S17] round=35 local utility u=0.041908 metrics={'f1_val': 0.6332948696040216, 'auprc': 0.8443212157015906, 'loss_val': 0.8500850289541004, 'psi': 0.7177054080430492}-{'f1_val': 0.6300854285374231, 'auprc': 0.8361254630121938, 'loss_val': 0.8900565661134914, 'psi': 0.7125014423273315}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=35 metric=0.9257 head_norm=1.564785
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.823585e-02
[S5] stored merged vector for next round verification (round=35)
[S5] DEBUG after merge:  round=35 metric=0.9085 head_norm=1.560218 delta_norm=0.028236
[S5] aggregate: ROLLBACK (f1_val pre=0.926 post=0.908 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=35 metric=0.6333 head_norm=1.860731
[S17] _apply_head_vector_avg (torch): Δ‖w‖=9.759176e-02
[S17] stored merged vector for next round verification (round=35)
[S17] DEBUG after merge:  round=35 metric=0.6443 head_norm=1.859491 delta_norm=0.097592
[S17] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=35 metric=0.6886 head_norm=1.306238
[S6] _apply_head_vector_avg (torch): Δ‖w‖=6.085384e-02
[S6] stored merged vector for next round verification (round=35)
[S6] DEBUG after merge:  round=35 metric=0.6885 head_norm=1.281210 delta_norm=0.060854
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=36 head_norm_before_train=1.835678 cos_to_last_merge=0.9954 (last merge round=26)
[S2] round=36 local utility u=0.068007 metrics={'f1_val': 0.688754048364954, 'auprc': 0.7284153905494053, 'loss_val': 0.6912823829473432, 'psi': 0.7046185852387346}-{'f1_val': 0.6504612164173204, 'auprc': 0.7172783659001519, 'loss_val': 0.5641285156228407, 'psi': 0.677188076210453}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=36 head_norm_before_train=1.887828 cos_to_last_merge=0.9994 (last merge round=33)
[S3] round=36 local utility u=0.000000 metrics={'f1_val': 0.7186379192612953, 'auprc': 0.9775142635639351, 'loss_val': 0.6609953823090305, 'psi': 0.8221884569823512}-{'f1_val': 0.9513152656459996, 'auprc': 0.9984705627408479, 'loss_val': 0.10993443492204033, 'psi': 0.9701773844839389}
[S4] START round=36 head_norm_before_train=1.976899 cos_to_last_merge=1.0000 (last merge round=34)
[S4] round=36 local utility u=0.050180 metrics={'f1_val': 0.9514968129156651, 'auprc': 0.9730160319817006, 'loss_val': 0.27623225313783356, 'psi': 0.9601045005420794}-{'f1_val': 0.9397882719579784, 'auprc': 0.9691860869691018, 'loss_val': 0.29485167728172296, 'psi': 0.9515473979624278}
[S5] START round=36 head_norm_before_train=1.560218 cos_to_last_merge=1.0000 (last merge round=35)
[S5] round=36 local utility u=0.000000 metrics={'f1_val': 0.700781124122831, 'auprc': 0.985186993371419, 'loss_val': 0.40654137384102035, 'psi': 0.8145434718222662}-{'f1_val': 0.9257454070015556, 'auprc': 0.9915365165115873, 'loss_val': 0.16196600834222627, 'psi': 0.9520618508055683}
[S6] START round=36 head_norm_before_train=1.281210 cos_to_last_merge=1.0000 (last merge round=35)
[S6] round=36 local utility u=0.573126 metrics={'f1_val': 0.8201791712613414, 'auprc': 0.947699608423509, 'loss_val': 0.4124141068614859, 'psi': 0.8711873461262084}-{'f1_val': 0.6886331234837787, 'auprc': 0.8981547332846478, 'loss_val': 0.6207558894324384, 'psi': 0.7724417674041264}
[S7] START round=36 head_norm_before_train=1.546528 cos_to_last_merge=0.8119 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.812
[S7] round=36 local utility u=0.552431 metrics={'f1_val': 0.5256826918759863, 'auprc': 0.7817990720260336, 'loss_val': 0.9141948652284742, 'psi': 0.6281292439360052}-{'f1_val': 0.4234409962222857, 'auprc': 0.7799909923751558, 'loss_val': 1.4001818188638755, 'psi': 0.5660609946834337}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=36 head_norm_before_train=1.293200 cos_to_last_merge=0.9998 (last merge round=34)
[S8] round=36 local utility u=0.004576 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.998749968195485, 'loss_val': 0.08272959923812574, 'psi': 0.9972218493182857}-{'f1_val': 0.9962031034001528, 'auprc': 0.9991469860980356, 'loss_val': 0.09307245022359097, 'psi': 0.997380656479306}
[S9] START round=36 head_norm_before_train=1.327453 cos_to_last_merge=0.9991 (last merge round=34)
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.9904309721744243, 'auprc': 0.9985888125708776, 'loss_val': 0.07951395392543473, 'psi': 0.9936941083330055}-{'f1_val': 0.9971317563071089, 'auprc': 0.9991313660198884, 'loss_val': 0.08638325666874408, 'psi': 0.9979316001922207}
[S10] START round=36 head_norm_before_train=1.794412 cos_to_last_merge=0.8202 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.820
[S10] round=36 local utility u=0.000000 metrics={'f1_val': 0.9936100131187782, 'auprc': 0.996302714675143, 'loss_val': 0.03561659689518724, 'psi': 0.994687093741324}-{'f1_val': 0.9939400388726987, 'auprc': 0.9963742472376362, 'loss_val': 0.03725916042005344, 'psi': 0.9949137222186737}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=36 head_norm_before_train=1.991048 cos_to_last_merge=0.9997 (last merge round=32)
[S11] round=36 local utility u=0.001968 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9986949049056338, 'loss_val': 0.03224592104130254, 'psi': 0.9971704468087008}-{'f1_val': 0.9961541414107454, 'auprc': 0.9984937285918364, 'loss_val': 0.03557792431159291, 'psi': 0.9970899762831817}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=36 head_norm_before_train=1.724257 (no previous merge yet)
[S13] round=36 local utility u=0.000000 metrics={'f1_val': 0.618569665743083, 'auprc': 0.6828618107573737, 'loss_val': 0.7514850299671194, 'psi': 0.6442865237487994}-{'f1_val': 0.6283472656328433, 'auprc': 0.6787649550103412, 'loss_val': 0.6694690696329411, 'psi': 0.6485143413838425}
[S14] START round=36 head_norm_before_train=1.362324 cos_to_last_merge=0.9740 (last merge round=29)
[S14] round=36 local utility u=0.000796 metrics={'f1_val': 0.9963144732565343, 'auprc': 0.9975453782325169, 'loss_val': 0.07239241226556031, 'psi': 0.9968068352469274}-{'f1_val': 0.9965803821790421, 'auprc': 0.9984359643173202, 'loss_val': 0.0782514946409816, 'psi': 0.9973226150343533}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=36 head_norm_before_train=1.579257 cos_to_last_merge=0.9994 (last merge round=33)
[S15] round=36 local utility u=1.000000 metrics={'f1_val': 0.9834901656248838, 'auprc': 0.9974264905970854, 'loss_val': 0.11166272104909916, 'psi': 0.9890646956137645}-{'f1_val': 0.6998700924264248, 'auprc': 0.8146713342403018, 'loss_val': 0.4598954832028077, 'psi': 0.7457905891519756}
[S16] START round=36 head_norm_before_train=1.310597 cos_to_last_merge=0.9995 (last merge round=34)
[S16] round=36 local utility u=0.126538 metrics={'f1_val': 0.9390606380333147, 'auprc': 0.9902338553122911, 'loss_val': 0.2378550202245261, 'psi': 0.9595299249449054}-{'f1_val': 0.9156683837345334, 'auprc': 0.9905018144513054, 'loss_val': 0.35138062983769425, 'psi': 0.9456017560212422}
[S17] START round=36 head_norm_before_train=1.859491 cos_to_last_merge=1.0000 (last merge round=35)
[S17] round=36 local utility u=0.059007 metrics={'f1_val': 0.6622146466255419, 'auprc': 0.8256124682492821, 'loss_val': 0.8494636057184214, 'psi': 0.727573775275038}-{'f1_val': 0.6332948696040216, 'auprc': 0.8443212157015906, 'loss_val': 0.8500850289541004, 'psi': 0.7177054080430492}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.960)
[S8] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S17] not sending this round → trigger blocked (psi=0.728)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=37 head_norm_before_train=1.842744 cos_to_last_merge=0.9949 (last merge round=26)
[S2] round=37 local utility u=0.474743 metrics={'f1_val': 0.7087550880902902, 'auprc': 0.9016563692495799, 'loss_val': 0.38152511094140107, 'psi': 0.785915600554006}-{'f1_val': 0.688754048364954, 'auprc': 0.7284153905494053, 'loss_val': 0.6912823829473432, 'psi': 0.7046185852387346}
[S2] not sending this round → trigger blocked (psi=0.786)
[S3] START round=37 head_norm_before_train=1.909949 cos_to_last_merge=0.9989 (last merge round=33)
[S3] round=37 local utility u=0.911096 metrics={'f1_val': 0.9275509290366781, 'auprc': 0.9983223278377925, 'loss_val': 0.1547049004228775, 'psi': 0.9558594885571239}-{'f1_val': 0.7186379192612953, 'auprc': 0.9775142635639351, 'loss_val': 0.6609953823090305, 'psi': 0.8221884569823512}
[S4] START round=37 head_norm_before_train=1.972748 cos_to_last_merge=0.9999 (last merge round=34)
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.9413184256261347, 'auprc': 0.9620344049015819, 'loss_val': 0.281674042661456, 'psi': 0.9496048173363135}-{'f1_val': 0.9514968129156651, 'auprc': 0.9730160319817006, 'loss_val': 0.27623225313783356, 'psi': 0.9601045005420794}
[S5] START round=37 head_norm_before_train=1.592591 cos_to_last_merge=0.9995 (last merge round=35)
[S5] round=37 local utility u=1.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9962948543562846, 'loss_val': 0.08832739320928341, 'psi': 0.9963182289206479}-{'f1_val': 0.700781124122831, 'auprc': 0.985186993371419, 'loss_val': 0.40654137384102035, 'psi': 0.8145434718222662}
[S6] START round=37 head_norm_before_train=1.309387 cos_to_last_merge=0.9998 (last merge round=35)
[S6] round=37 local utility u=0.723851 metrics={'f1_val': 0.9869694916127223, 'auprc': 0.9931758823621817, 'loss_val': 0.1018834514130357, 'psi': 0.9894520479125061}-{'f1_val': 0.8201791712613414, 'auprc': 0.947699608423509, 'loss_val': 0.4124141068614859, 'psi': 0.8711873461262084}
[S7] START round=37 head_norm_before_train=1.546631 cos_to_last_merge=0.8112 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.811
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.4556083766576251, 'auprc': 0.7795305821046441, 'loss_val': 1.096742482590445, 'psi': 0.5851772588364328}-{'f1_val': 0.5256826918759863, 'auprc': 0.7817990720260336, 'loss_val': 0.9141948652284742, 'psi': 0.6281292439360052}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=37 head_norm_before_train=1.321706 cos_to_last_merge=0.9992 (last merge round=34)
[S8] round=37 local utility u=0.005475 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9990856016304899, 'loss_val': 0.07278576217659397, 'psi': 0.9973561026922877}-{'f1_val': 0.9962031034001528, 'auprc': 0.998749968195485, 'loss_val': 0.08272959923812574, 'psi': 0.9972218493182857}
[S9] START round=37 head_norm_before_train=1.374882 cos_to_last_merge=0.9972 (last merge round=34)
[S9] round=37 local utility u=0.027747 metrics={'f1_val': 0.9971317563071089, 'auprc': 0.9966316330282644, 'loss_val': 0.05835263127126274, 'psi': 0.9969317069955712}-{'f1_val': 0.9904309721744243, 'auprc': 0.9985888125708776, 'loss_val': 0.07951395392543473, 'psi': 0.9936941083330055}
[S10] START round=37 head_norm_before_train=1.805590 cos_to_last_merge=0.8195 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.819
[S10] round=37 local utility u=0.002663 metrics={'f1_val': 0.9944867328096639, 'auprc': 0.9956189520260266, 'loss_val': 0.03349909371325429, 'psi': 0.994939620496209}-{'f1_val': 0.9936100131187782, 'auprc': 0.996302714675143, 'loss_val': 0.03561659689518724, 'psi': 0.994687093741324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=37 head_norm_before_train=2.007680 cos_to_last_merge=0.9995 (last merge round=32)
[S11] round=37 local utility u=0.001502 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9988925850781433, 'loss_val': 0.029834345322525945, 'psi': 0.9972495188777045}-{'f1_val': 0.9961541414107454, 'auprc': 0.9986949049056338, 'loss_val': 0.03224592104130254, 'psi': 0.9971704468087008}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=37 head_norm_before_train=1.731025 (no previous merge yet)
[S13] round=37 local utility u=0.124157 metrics={'f1_val': 0.6348058518195135, 'auprc': 0.6835547686309871, 'loss_val': 0.6026667843485982, 'psi': 0.654305418544103}-{'f1_val': 0.618569665743083, 'auprc': 0.6828618107573737, 'loss_val': 0.7514850299671194, 'psi': 0.6442865237487994}
[S14] START round=37 head_norm_before_train=1.383615 cos_to_last_merge=0.9715 (last merge round=29)
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.9906880499145175, 'auprc': 0.9966754504257439, 'loss_val': 0.08177920310382844, 'psi': 0.993083010119008}-{'f1_val': 0.9963144732565343, 'auprc': 0.9975453782325169, 'loss_val': 0.07239241226556031, 'psi': 0.9968068352469274}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=37 head_norm_before_train=1.598638 cos_to_last_merge=0.9989 (last merge round=33)
[S15] round=37 local utility u=0.000000 metrics={'f1_val': 0.7767058520448733, 'auprc': 0.9916893946604854, 'loss_val': 0.30361589765382374, 'psi': 0.8626992690911182}-{'f1_val': 0.9834901656248838, 'auprc': 0.9974264905970854, 'loss_val': 0.11166272104909916, 'psi': 0.9890646956137645}
[S16] START round=37 head_norm_before_train=1.347070 cos_to_last_merge=0.9982 (last merge round=34)
[S16] round=37 local utility u=0.003728 metrics={'f1_val': 0.9398957315831811, 'auprc': 0.9855209932626837, 'loss_val': 0.22127088319183352, 'psi': 0.9581458362549822}-{'f1_val': 0.9390606380333147, 'auprc': 0.9902338553122911, 'loss_val': 0.2378550202245261, 'psi': 0.9595299249449054}
[S17] START round=37 head_norm_before_train=1.879400 cos_to_last_merge=0.9998 (last merge round=35)
[S17] round=37 local utility u=0.000000 metrics={'f1_val': 0.6633536501803179, 'auprc': 0.8369693476899474, 'loss_val': 0.9255795839726672, 'psi': 0.7327999291841697}-{'f1_val': 0.6622146466255419, 'auprc': 0.8256124682492821, 'loss_val': 0.8494636057184214, 'psi': 0.727573775275038}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S16] not sending this round → trigger blocked (psi=0.958)
[S6] not sending this round → trigger blocked (psi=0.989)
[S2] START round=38 head_norm_before_train=1.852480 cos_to_last_merge=0.9941 (last merge round=26)
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.669198125930089, 'auprc': 0.7378324207543047, 'loss_val': 0.566499159918476, 'psi': 0.6966518438597753}-{'f1_val': 0.7087550880902902, 'auprc': 0.9016563692495799, 'loss_val': 0.38152511094140107, 'psi': 0.785915600554006}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=38 head_norm_before_train=1.929835 cos_to_last_merge=0.9983 (last merge round=33)
[S3] round=38 local utility u=0.000000 metrics={'f1_val': 0.8604689066549742, 'auprc': 0.9985938787486649, 'loss_val': 0.3040084599762038, 'psi': 0.9157188954924504}-{'f1_val': 0.9275509290366781, 'auprc': 0.9983223278377925, 'loss_val': 0.1547049004228775, 'psi': 0.9558594885571239}
[S4] START round=38 head_norm_before_train=1.970120 cos_to_last_merge=0.9998 (last merge round=34)
[S4] round=38 local utility u=0.014921 metrics={'f1_val': 0.9407396336504595, 'auprc': 0.973748459725077, 'loss_val': 0.2835023246274084, 'psi': 0.9539431640803065}-{'f1_val': 0.9413184256261347, 'auprc': 0.9620344049015819, 'loss_val': 0.281674042661456, 'psi': 0.9496048173363135}
[S5] START round=38 head_norm_before_train=1.619984 cos_to_last_merge=0.9984 (last merge round=35)
[S5] round=38 local utility u=0.000000 metrics={'f1_val': 0.9429334865087966, 'auprc': 0.9932403492599563, 'loss_val': 0.12050300126193357, 'psi': 0.9630562316092606}-{'f1_val': 0.9963338119635569, 'auprc': 0.9962948543562846, 'loss_val': 0.08832739320928341, 'psi': 0.9963182289206479}
[S6] START round=38 head_norm_before_train=1.331726 cos_to_last_merge=0.9994 (last merge round=35)
[S6] round=38 local utility u=0.000000 metrics={'f1_val': 0.5966059686276022, 'auprc': 0.7865329120005793, 'loss_val': 0.8627054895122762, 'psi': 0.6725767459767931}-{'f1_val': 0.9869694916127223, 'auprc': 0.9931758823621817, 'loss_val': 0.1018834514130357, 'psi': 0.9894520479125061}
[S7] START round=38 head_norm_before_train=1.550012 cos_to_last_merge=0.8112 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.811
[S7] round=38 local utility u=0.156312 metrics={'f1_val': 0.4933709464007552, 'auprc': 0.7811408150366689, 'loss_val': 1.01552464997592, 'psi': 0.6084788938551207}-{'f1_val': 0.4556083766576251, 'auprc': 0.7795305821046441, 'loss_val': 1.096742482590445, 'psi': 0.5851772588364328}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=38 head_norm_before_train=1.348798 cos_to_last_merge=0.9984 (last merge round=34)
[S8] round=38 local utility u=0.002872 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9986653074853649, 'loss_val': 0.06578024872172561, 'psi': 0.9971879850342377}-{'f1_val': 0.9962031034001528, 'auprc': 0.9990856016304899, 'loss_val': 0.07278576217659397, 'psi': 0.9973561026922877}
[S9] START round=38 head_norm_before_train=1.414414 cos_to_last_merge=0.9950 (last merge round=34)
[S9] round=38 local utility u=0.005974 metrics={'f1_val': 0.9971290324227131, 'auprc': 0.9984887325954179, 'loss_val': 0.051958611789285285, 'psi': 0.9976729124917951}-{'f1_val': 0.9971317563071089, 'auprc': 0.9966316330282644, 'loss_val': 0.05835263127126274, 'psi': 0.9969317069955712}
[S10] START round=38 head_norm_before_train=1.815348 cos_to_last_merge=0.8189 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.819
[S10] round=38 local utility u=0.000000 metrics={'f1_val': 0.9935019932013915, 'auprc': 0.9964661878293739, 'loss_val': 0.03663910704736979, 'psi': 0.9946876710525845}-{'f1_val': 0.9944867328096639, 'auprc': 0.9956189520260266, 'loss_val': 0.03349909371325429, 'psi': 0.994939620496209}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=38 head_norm_before_train=2.024938 cos_to_last_merge=0.9992 (last merge round=32)
[S11] round=38 local utility u=0.002159 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9988962719800427, 'loss_val': 0.02800835783483382, 'psi': 0.9974989911757453}-{'f1_val': 0.9961541414107454, 'auprc': 0.9988925850781433, 'loss_val': 0.029834345322525945, 'psi': 0.9972495188777045}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=38 head_norm_before_train=1.734912 (no previous merge yet)
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.6279277637791061, 'auprc': 0.684728585527762, 'loss_val': 0.6882623531196714, 'psi': 0.6506480924785685}-{'f1_val': 0.6348058518195135, 'auprc': 0.6835547686309871, 'loss_val': 0.6026667843485982, 'psi': 0.654305418544103}
[S14] START round=38 head_norm_before_train=1.399906 cos_to_last_merge=0.9695 (last merge round=29)
[S14] round=38 local utility u=0.032079 metrics={'f1_val': 0.9969682102907778, 'auprc': 0.9991508925970463, 'loss_val': 0.06272752715415576, 'psi': 0.9978412832132851}-{'f1_val': 0.9906880499145175, 'auprc': 0.9966754504257439, 'loss_val': 0.08177920310382844, 'psi': 0.993083010119008}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] START round=38 head_norm_before_train=1.616091 cos_to_last_merge=0.9983 (last merge round=33)
[S15] round=38 local utility u=0.525871 metrics={'f1_val': 0.9209934948764662, 'auprc': 0.9966099572525517, 'loss_val': 0.1323611067885884, 'psi': 0.9512400798269005}-{'f1_val': 0.7767058520448733, 'auprc': 0.9916893946604854, 'loss_val': 0.30361589765382374, 'psi': 0.8626992690911182}
[S16] START round=38 head_norm_before_train=1.379800 cos_to_last_merge=0.9967 (last merge round=34)
[S16] round=38 local utility u=0.000000 metrics={'f1_val': 0.8458305163482227, 'auprc': 0.984233013153915, 'loss_val': 0.6734165112449572, 'psi': 0.9011915150704997}-{'f1_val': 0.9398957315831811, 'auprc': 0.9855209932626837, 'loss_val': 0.22127088319183352, 'psi': 0.9581458362549822}
[S17] START round=38 head_norm_before_train=1.900258 cos_to_last_merge=0.9994 (last merge round=35)
[S17] round=38 local utility u=0.000000 metrics={'f1_val': 0.6270366390104518, 'auprc': 0.8785492736293583, 'loss_val': 0.9681968317700658, 'psi': 0.7276416928580144}-{'f1_val': 0.6633536501803179, 'auprc': 0.8369693476899474, 'loss_val': 0.9255795839726672, 'psi': 0.7327999291841697}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S8] not sending this round → trigger blocked (psi=0.997)
[S9] not sending this round → trigger blocked (psi=0.998)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S2] START round=39 head_norm_before_train=1.862936 cos_to_last_merge=0.9933 (last merge round=26)
[S2] round=39 local utility u=0.228655 metrics={'f1_val': 0.721806403664889, 'auprc': 0.7970013178299974, 'loss_val': 0.6023456782454254, 'psi': 0.7518843693309324}-{'f1_val': 0.669198125930089, 'auprc': 0.7378324207543047, 'loss_val': 0.566499159918476, 'psi': 0.6966518438597753}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] sending update (kind=head size=1804 to 1 peers)
[S2] r=40 psi=0.752 u=0.2287 p_local=0.1923 f1=0.722 auprc=0.797 bytes=37770
[S3] START round=39 head_norm_before_train=1.949901 cos_to_last_merge=0.9976 (last merge round=33)
[S3] round=39 local utility u=0.500689 metrics={'f1_val': 0.9831816184386583, 'auprc': 0.9993625358312791, 'loss_val': 0.04121246516734191, 'psi': 0.9896539853957066}-{'f1_val': 0.8604689066549742, 'auprc': 0.9985938787486649, 'loss_val': 0.3040084599762038, 'psi': 0.9157188954924504}
[S4] START round=39 head_norm_before_train=1.969996 cos_to_last_merge=0.9997 (last merge round=34)
[S4] round=39 local utility u=0.035881 metrics={'f1_val': 0.9525643291962909, 'auprc': 0.9704736614923776, 'loss_val': 0.272864558606779, 'psi': 0.9597280621147255}-{'f1_val': 0.9407396336504595, 'auprc': 0.973748459725077, 'loss_val': 0.2835023246274084, 'psi': 0.9539431640803065}
[S5] START round=39 head_norm_before_train=1.645578 cos_to_last_merge=0.9973 (last merge round=35)
[S5] round=39 local utility u=0.194107 metrics={'f1_val': 0.9975086222760589, 'auprc': 0.9994384197944416, 'loss_val': 0.07833370399646657, 'psi': 0.9982805412834119}-{'f1_val': 0.9429334865087966, 'auprc': 0.9932403492599563, 'loss_val': 0.12050300126193357, 'psi': 0.9630562316092606}
[S6] START round=39 head_norm_before_train=1.351175 cos_to_last_merge=0.9989 (last merge round=35)
[S6] round=39 local utility u=0.774224 metrics={'f1_val': 0.7391818133823944, 'auprc': 0.927107812345686, 'loss_val': 0.5914374055838727, 'psi': 0.814352212967711}-{'f1_val': 0.5966059686276022, 'auprc': 0.7865329120005793, 'loss_val': 0.8627054895122762, 'psi': 0.6725767459767931}
[S7] START round=39 head_norm_before_train=1.555626 cos_to_last_merge=0.8111 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.811
[S7] round=39 local utility u=0.339177 metrics={'f1_val': 0.5662294021954266, 'auprc': 0.7825720287458656, 'loss_val': 0.7786155338208294, 'psi': 0.6527664528156023}-{'f1_val': 0.4933709464007552, 'auprc': 0.7811408150366689, 'loss_val': 1.01552464997592, 'psi': 0.6084788938551207}
[S7] not sending this round → trigger blocked (psi=0.653)
[S7] r=40 psi=0.653 u=0.3392 p_local=0.2599 f1=0.566 auprc=0.783 bytes=34178
[S8] START round=39 head_norm_before_train=1.373611 cos_to_last_merge=0.9974 (last merge round=34)
[S8] round=39 local utility u=0.003549 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.998969770564386, 'loss_val': 0.060494653538458946, 'psi': 0.9973997531871291}-{'f1_val': 0.9962031034001528, 'auprc': 0.9986653074853649, 'loss_val': 0.06578024872172561, 'psi': 0.9971879850342377}
[S9] START round=39 head_norm_before_train=1.449750 cos_to_last_merge=0.9927 (last merge round=34)
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.996721335281205, 'auprc': 0.9948092598697202, 'loss_val': 0.04551882021977498, 'psi': 0.995956505116611}-{'f1_val': 0.9971290324227131, 'auprc': 0.9984887325954179, 'loss_val': 0.051958611789285285, 'psi': 0.9976729124917951}
[S10] START round=39 head_norm_before_train=1.824912 cos_to_last_merge=0.8182 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.818
[S10] round=39 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9926898652684928, 'loss_val': 0.03448591072070251, 'psi': 0.9940568580264428}-{'f1_val': 0.9935019932013915, 'auprc': 0.9964661878293739, 'loss_val': 0.03663910704736979, 'psi': 0.9946876710525845}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=40 psi=0.994 u=0.0000 p_local=0.0230 f1=0.995 auprc=0.993 bytes=43217
[S11] START round=39 head_norm_before_train=2.040644 cos_to_last_merge=0.9989 (last merge round=32)
[S11] round=39 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9989591254428017, 'loss_val': 0.027091914422126388, 'psi': 0.9972761350235679}-{'f1_val': 0.996567470639547, 'auprc': 0.9988962719800427, 'loss_val': 0.02800835783483382, 'psi': 0.9974989911757453}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=40 psi=0.997 u=0.0000 p_local=0.0213 f1=0.996 auprc=0.999 bytes=43136
[S13] START round=39 head_norm_before_train=1.738431 (no previous merge yet)
[S13] round=39 local utility u=0.000000 metrics={'f1_val': 0.614322919494596, 'auprc': 0.6851961974732881, 'loss_val': 0.786944694762537, 'psi': 0.6426722306860728}-{'f1_val': 0.6279277637791061, 'auprc': 0.684728585527762, 'loss_val': 0.6882623531196714, 'psi': 0.6506480924785685}
[S14] START round=39 head_norm_before_train=1.414846 cos_to_last_merge=0.9678 (last merge round=29)
[S14] round=39 local utility u=0.003277 metrics={'f1_val': 0.9972408627570057, 'auprc': 0.9992255483587553, 'loss_val': 0.058033039117507436, 'psi': 0.9980347369977055}-{'f1_val': 0.9969682102907778, 'auprc': 0.9991508925970463, 'loss_val': 0.06272752715415576, 'psi': 0.9978412832132851}
[S14] not sending this round → trigger blocked (psi=0.998)
[S14] r=40 psi=0.998 u=0.0033 p_local=0.0225 f1=0.997 auprc=0.999 bytes=32381
[S15] START round=39 head_norm_before_train=1.633678 cos_to_last_merge=0.9977 (last merge round=33)
[S15] round=39 local utility u=0.000000 metrics={'f1_val': 0.7006575167213118, 'auprc': 0.8098582347213115, 'loss_val': 0.499940898053132, 'psi': 0.7443378039213118}-{'f1_val': 0.9209934948764662, 'auprc': 0.9966099572525517, 'loss_val': 0.1323611067885884, 'psi': 0.9512400798269005}
[S16] START round=39 head_norm_before_train=1.409230 cos_to_last_merge=0.9952 (last merge round=34)
[S16] round=39 local utility u=0.240757 metrics={'f1_val': 0.8840825801981818, 'auprc': 0.9868380159820158, 'loss_val': 0.42923065290709855, 'psi': 0.9251847545117153}-{'f1_val': 0.8458305163482227, 'auprc': 0.984233013153915, 'loss_val': 0.6734165112449572, 'psi': 0.9011915150704997}
[S17] START round=39 head_norm_before_train=1.918942 cos_to_last_merge=0.9988 (last merge round=35)
[S17] round=39 local utility u=0.000000 metrics={'f1_val': 0.5973398866164508, 'auprc': 0.8592079913954569, 'loss_val': 1.1361302214665454, 'psi': 0.7020871285280532}-{'f1_val': 0.6270366390104518, 'auprc': 0.8785492736293583, 'loss_val': 0.9681968317700658, 'psi': 0.7276416928580144}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S4] not sending this round → trigger blocked (psi=0.960)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] sending update (kind=head size=1806 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=40 psi=0.814 u=0.7742 p_local=0.4228 f1=0.739 auprc=0.927 bytes=34144
[S8] r=40 psi=0.997 u=0.0035 p_local=0.0148 f1=0.996 auprc=0.999 bytes=43145
[S5] r=40 psi=0.998 u=0.1941 p_local=0.2505 f1=0.998 auprc=0.999 bytes=35992
[S13] r=40 psi=0.643 u=0.0000 p_local=0.0433 f1=0.614 auprc=0.685 bytes=28839
[S4] r=40 psi=0.960 u=0.0359 p_local=0.0275 f1=0.953 auprc=0.970 bytes=32373
[S3] r=40 psi=0.990 u=0.5007 p_local=0.2716 f1=0.983 auprc=0.999 bytes=35960
[S15] r=40 psi=0.744 u=0.0000 p_local=0.2546 f1=0.701 auprc=0.810 bytes=35960
[S16] r=40 psi=0.925 u=0.2408 p_local=0.1094 f1=0.884 auprc=0.987 bytes=35950
[S9] r=40 psi=0.996 u=0.0000 p_local=0.0127 f1=0.997 auprc=0.995 bytes=34181
[S17] r=40 psi=0.702 u=0.0000 p_local=0.0667 f1=0.597 auprc=0.859 bytes=35977
[S2] START round=40 head_norm_before_train=1.871874 cos_to_last_merge=0.9926 (last merge round=26)
[S2] round=40 local utility u=0.264589 metrics={'f1_val': 0.7070969735526399, 'auprc': 0.9276307883060059, 'loss_val': 0.37679970007311037, 'psi': 0.7953104994539864}-{'f1_val': 0.721806403664889, 'auprc': 0.7970013178299974, 'loss_val': 0.6023456782454254, 'psi': 0.7518843693309324}
[S2] not sending this round → trigger blocked (psi=0.795)
[S3] START round=40 head_norm_before_train=1.968114 cos_to_last_merge=0.9970 (last merge round=33)
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.8136310125193349, 'auprc': 0.9983326278509725, 'loss_val': 0.46268312490545793, 'psi': 0.88751165865199}-{'f1_val': 0.9831816184386583, 'auprc': 0.9993625358312791, 'loss_val': 0.04121246516734191, 'psi': 0.9896539853957066}
[S4] START round=40 head_norm_before_train=1.966998 cos_to_last_merge=0.9994 (last merge round=34)
[S4] round=40 local utility u=0.000000 metrics={'f1_val': 0.9438479890711516, 'auprc': 0.9790070583691788, 'loss_val': 0.28026384940641974, 'psi': 0.9579116167903625}-{'f1_val': 0.9525643291962909, 'auprc': 0.9704736614923776, 'loss_val': 0.272864558606779, 'psi': 0.9597280621147255}
[S5] START round=40 head_norm_before_train=1.659308 cos_to_last_merge=0.9966 (last merge round=35)
[S5] round=40 local utility u=0.000000 metrics={'f1_val': 0.7561827134898376, 'auprc': 0.990482818148543, 'loss_val': 0.29973733228997984, 'psi': 0.8499027553533198}-{'f1_val': 0.9975086222760589, 'auprc': 0.9994384197944416, 'loss_val': 0.07833370399646657, 'psi': 0.9982805412834119}
[S6] START round=40 head_norm_before_train=1.366158 cos_to_last_merge=0.9983 (last merge round=35)
[S6] round=40 local utility u=1.000000 metrics={'f1_val': 0.9804389347532969, 'auprc': 0.9835338012088342, 'loss_val': 0.11978879750428034, 'psi': 0.9816768813355119}-{'f1_val': 0.7391818133823944, 'auprc': 0.927107812345686, 'loss_val': 0.5914374055838727, 'psi': 0.814352212967711}
[S7] START round=40 head_norm_before_train=1.560202 cos_to_last_merge=0.8105 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.810
[S7] round=40 local utility u=0.000000 metrics={'f1_val': 0.4440615952994318, 'auprc': 0.780053483538423, 'loss_val': 1.1256175368843133, 'psi': 0.5784583505950283}-{'f1_val': 0.5662294021954266, 'auprc': 0.7825720287458656, 'loss_val': 0.7786155338208294, 'psi': 0.6527664528156023}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=40 head_norm_before_train=1.392799 cos_to_last_merge=0.9966 (last merge round=34)
[S8] round=40 local utility u=0.000421 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9988149919288196, 'loss_val': 0.05828924408951327, 'psi': 0.9972478588116196}-{'f1_val': 0.9963530749356245, 'auprc': 0.998969770564386, 'loss_val': 0.060494653538458946, 'psi': 0.9973997531871291}
[S9] START round=40 head_norm_before_train=1.478333 cos_to_last_merge=0.9907 (last merge round=34)
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.9933838446360591, 'auprc': 0.9984388802077844, 'loss_val': 0.04748509347228713, 'psi': 0.9954058588647492}-{'f1_val': 0.996721335281205, 'auprc': 0.9948092598697202, 'loss_val': 0.04551882021977498, 'psi': 0.995956505116611}
[S10] START round=40 head_norm_before_train=1.835963 cos_to_last_merge=0.8175 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.817
[S10] round=40 local utility u=0.002903 metrics={'f1_val': 0.9939400388726987, 'auprc': 0.9964240885942348, 'loss_val': 0.03371424667767341, 'psi': 0.9949336587613131}-{'f1_val': 0.9949681865317428, 'auprc': 0.9926898652684928, 'loss_val': 0.03448591072070251, 'psi': 0.9940568580264428}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=40 head_norm_before_train=2.053011 cos_to_last_merge=0.9986 (last merge round=32)
[S11] round=40 local utility u=0.000232 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9988659873089888, 'loss_val': 0.026349119639504353, 'psi': 0.9972388797700428}-{'f1_val': 0.9961541414107454, 'auprc': 0.9989591254428017, 'loss_val': 0.027091914422126388, 'psi': 0.9972761350235679}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=40 head_norm_before_train=1.745887 (no previous merge yet)
[S13] round=40 local utility u=0.122502 metrics={'f1_val': 0.6309774682070574, 'auprc': 0.6786621896662315, 'loss_val': 0.6222666418871758, 'psi': 0.650051356790727}-{'f1_val': 0.614322919494596, 'auprc': 0.6851961974732881, 'loss_val': 0.786944694762537, 'psi': 0.6426722306860728}
[S14] START round=40 head_norm_before_train=1.430905 cos_to_last_merge=0.9659 (last merge round=29)
[S14] round=40 local utility u=0.000940 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9992237485093669, 'loss_val': 0.05468704143320748, 'psi': 0.9978880042983458}-{'f1_val': 0.9972408627570057, 'auprc': 0.9992255483587553, 'loss_val': 0.058033039117507436, 'psi': 0.9980347369977055}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] START round=40 head_norm_before_train=1.649478 cos_to_last_merge=0.9970 (last merge round=33)
[S15] round=40 local utility u=1.000000 metrics={'f1_val': 0.9881166981748497, 'auprc': 0.9988258665677118, 'loss_val': 0.07303533048910062, 'psi': 0.9924003655319945}-{'f1_val': 0.7006575167213118, 'auprc': 0.8098582347213115, 'loss_val': 0.499940898053132, 'psi': 0.7443378039213118}
[S16] START round=40 head_norm_before_train=1.433566 cos_to_last_merge=0.9938 (last merge round=34)
[S16] round=40 local utility u=0.465853 metrics={'f1_val': 0.9898902972123078, 'auprc': 0.9769305964156815, 'loss_val': 0.10264772552879751, 'psi': 0.9847064168936573}-{'f1_val': 0.8840825801981818, 'auprc': 0.9868380159820158, 'loss_val': 0.42923065290709855, 'psi': 0.9251847545117153}
[S17] START round=40 head_norm_before_train=1.933323 cos_to_last_merge=0.9982 (last merge round=35)
[S17] round=40 local utility u=0.463077 metrics={'f1_val': 0.6475924739578699, 'auprc': 0.9564958444252059, 'loss_val': 0.8033544663143732, 'psi': 0.7711538221448042}-{'f1_val': 0.5973398866164508, 'auprc': 0.8592079913954569, 'loss_val': 1.1361302214665454, 'psi': 0.7020871285280532}
[S16] not sending this round → trigger blocked (psi=0.985)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S6] not sending this round → trigger blocked (psi=0.982)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.997)
[S2] START round=41 head_norm_before_train=1.882965 cos_to_last_merge=0.9916 (last merge round=26)
[S2] round=41 local utility u=0.015614 metrics={'f1_val': 0.7181710416453577, 'auprc': 0.9077958910585275, 'loss_val': 0.3525122420420268, 'psi': 0.7940209814106256}-{'f1_val': 0.7070969735526399, 'auprc': 0.9276307883060059, 'loss_val': 0.37679970007311037, 'psi': 0.7953104994539864}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=41 head_norm_before_train=1.983045 cos_to_last_merge=0.9963 (last merge round=33)
[S3] round=41 local utility u=0.000000 metrics={'f1_val': 0.7595913464090271, 'auprc': 0.9968176038412626, 'loss_val': 0.6051473143372161, 'psi': 0.8544818493819213}-{'f1_val': 0.8136310125193349, 'auprc': 0.9983326278509725, 'loss_val': 0.46268312490545793, 'psi': 0.88751165865199}
[S4] START round=41 head_norm_before_train=1.968365 cos_to_last_merge=0.9994 (last merge round=34)
[S4] round=41 local utility u=0.000000 metrics={'f1_val': 0.9441154189961304, 'auprc': 0.979908615540387, 'loss_val': 0.28550576192286986, 'psi': 0.9584326976138331}-{'f1_val': 0.9438479890711516, 'auprc': 0.9790070583691788, 'loss_val': 0.28026384940641974, 'psi': 0.9579116167903625}
[S5] START round=41 head_norm_before_train=1.668139 cos_to_last_merge=0.9962 (last merge round=35)
[S5] round=41 local utility u=0.850233 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9980170619488435, 'loss_val': 0.06498960931743074, 'psi': 0.9972280058666121}-{'f1_val': 0.7561827134898376, 'auprc': 0.990482818148543, 'loss_val': 0.29973733228997984, 'psi': 0.8499027553533198}
[S6] START round=41 head_norm_before_train=1.387054 cos_to_last_merge=0.9975 (last merge round=35)
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.623554589388545, 'auprc': 0.7532665321030837, 'loss_val': 0.7845367351840774, 'psi': 0.6754393664743605}-{'f1_val': 0.9804389347532969, 'auprc': 0.9835338012088342, 'loss_val': 0.11978879750428034, 'psi': 0.9816768813355119}
[S7] START round=41 head_norm_before_train=1.568396 cos_to_last_merge=0.8094 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.809
[S7] round=41 local utility u=1.000000 metrics={'f1_val': 0.9696735862018273, 'auprc': 0.9653210540773924, 'loss_val': 0.19121938366443278, 'psi': 0.9679325733520534}-{'f1_val': 0.4440615952994318, 'auprc': 0.780053483538423, 'loss_val': 1.1256175368843133, 'psi': 0.5784583505950283}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=41 head_norm_before_train=1.408944 cos_to_last_merge=0.9960 (last merge round=34)
[S8] round=41 local utility u=0.000000 metrics={'f1_val': 0.9866701491073004, 'auprc': 0.997996153175696, 'loss_val': 0.0829858035714379, 'psi': 0.9912005507346586}-{'f1_val': 0.9962031034001528, 'auprc': 0.9988149919288196, 'loss_val': 0.05828924408951327, 'psi': 0.9972478588116196}
[S9] START round=41 head_norm_before_train=1.505232 cos_to_last_merge=0.9887 (last merge round=34)
[S9] round=41 local utility u=0.016307 metrics={'f1_val': 0.9971317563071089, 'auprc': 0.9987397841471776, 'loss_val': 0.03826191489229342, 'psi': 0.9977749674431364}-{'f1_val': 0.9933838446360591, 'auprc': 0.9984388802077844, 'loss_val': 0.04748509347228713, 'psi': 0.9954058588647492}
[S10] START round=41 head_norm_before_train=1.847305 cos_to_last_merge=0.8167 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.817
[S10] round=41 local utility u=0.000000 metrics={'f1_val': 0.9792470808379912, 'auprc': 0.9925200501208788, 'loss_val': 0.0768930700082901, 'psi': 0.9845562685511462}-{'f1_val': 0.9939400388726987, 'auprc': 0.9964240885942348, 'loss_val': 0.03371424667767341, 'psi': 0.9949336587613131}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=41 head_norm_before_train=2.066054 cos_to_last_merge=0.9983 (last merge round=32)
[S11] round=41 local utility u=0.000494 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9989001600887858, 'loss_val': 0.025462822635381518, 'psi': 0.9972525488819616}-{'f1_val': 0.9961541414107454, 'auprc': 0.9988659873089888, 'loss_val': 0.026349119639504353, 'psi': 0.9972388797700428}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=41 head_norm_before_train=1.754248 (no previous merge yet)
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.6102863765827092, 'auprc': 0.6872568813926198, 'loss_val': 0.8129208176619498, 'psi': 0.6410745785066735}-{'f1_val': 0.6309774682070574, 'auprc': 0.6786621896662315, 'loss_val': 0.6222666418871758, 'psi': 0.650051356790727}
[S14] START round=41 head_norm_before_train=1.449751 cos_to_last_merge=0.9639 (last merge round=29)
[S14] round=41 local utility u=0.000931 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9988465534505707, 'loss_val': 0.05169312317929445, 'psi': 0.9977371262748274}-{'f1_val': 0.9969975081576651, 'auprc': 0.9992237485093669, 'loss_val': 0.05468704143320748, 'psi': 0.9978880042983458}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=41 head_norm_before_train=1.662449 cos_to_last_merge=0.9965 (last merge round=33)
[S15] round=41 local utility u=0.000000 metrics={'f1_val': 0.7009191843683342, 'auprc': 0.9894525457332689, 'loss_val': 0.366521636846706, 'psi': 0.8163325289143082}-{'f1_val': 0.9881166981748497, 'auprc': 0.9988258665677118, 'loss_val': 0.07303533048910062, 'psi': 0.9924003655319945}
[S16] START round=41 head_norm_before_train=1.452931 cos_to_last_merge=0.9926 (last merge round=34)
[S16] round=41 local utility u=0.000000 metrics={'f1_val': 0.8297707451545828, 'auprc': 0.9263806642807828, 'loss_val': 0.846798029748559, 'psi': 0.8684147128050628}-{'f1_val': 0.9898902972123078, 'auprc': 0.9769305964156815, 'loss_val': 0.10264772552879751, 'psi': 0.9847064168936573}
[S17] START round=41 head_norm_before_train=1.947179 cos_to_last_merge=0.9977 (last merge round=35)
[S17] round=41 local utility u=0.000000 metrics={'f1_val': 0.6076654414308382, 'auprc': 0.8469471968659013, 'loss_val': 1.0981559252095405, 'psi': 0.7033781436048634}-{'f1_val': 0.6475924739578699, 'auprc': 0.9564958444252059, 'loss_val': 0.8033544663143732, 'psi': 0.7711538221448042}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] sending update (kind=head size=1804 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S2] START round=42 head_norm_before_train=1.893222 cos_to_last_merge=0.9907 (last merge round=26)
[S2] round=42 local utility u=0.180038 metrics={'f1_val': 0.8252271946382755, 'auprc': 0.822173112937418, 'loss_val': 0.37790548164758336, 'psi': 0.8240055619579325}-{'f1_val': 0.7181710416453577, 'auprc': 0.9077958910585275, 'loss_val': 0.3525122420420268, 'psi': 0.7940209814106256}
[S2] not sending this round → trigger blocked (psi=0.824)
[S3] START round=42 head_norm_before_train=1.998976 cos_to_last_merge=0.9956 (last merge round=33)
[S3] round=42 local utility u=0.524162 metrics={'f1_val': 0.8814410568410593, 'auprc': 0.998432027645345, 'loss_val': 0.2927657952925421, 'psi': 0.9282374451627736}-{'f1_val': 0.7595913464090271, 'auprc': 0.9968176038412626, 'loss_val': 0.6051473143372161, 'psi': 0.8544818493819213}
[S4] START round=42 head_norm_before_train=1.974990 cos_to_last_merge=0.9993 (last merge round=34)
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.9449888230117902, 'auprc': 0.9754828083841314, 'loss_val': 0.2895974992279779, 'psi': 0.9571864171607267}-{'f1_val': 0.9441154189961304, 'auprc': 0.979908615540387, 'loss_val': 0.28550576192286986, 'psi': 0.9584326976138331}
[S5] START round=42 head_norm_before_train=1.673257 cos_to_last_merge=0.9959 (last merge round=35)
[S5] round=42 local utility u=0.000000 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9984816671569736, 'loss_val': 0.09052232512854884, 'psi': 0.9976344020294281}-{'f1_val': 0.9967019684784577, 'auprc': 0.9980170619488435, 'loss_val': 0.06498960931743074, 'psi': 0.9972280058666121}
[S6] START round=42 head_norm_before_train=1.412427 cos_to_last_merge=0.9967 (last merge round=35)
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.5882833969450629, 'auprc': 0.7302496804485306, 'loss_val': 1.0186962563122997, 'psi': 0.64506991034645}-{'f1_val': 0.623554589388545, 'auprc': 0.7532665321030837, 'loss_val': 0.7845367351840774, 'psi': 0.6754393664743605}
[S7] START round=42 head_norm_before_train=1.572184 cos_to_last_merge=0.8090 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.809
[S7] round=42 local utility u=0.000000 metrics={'f1_val': 0.67213328295449, 'auprc': 0.8296277476453677, 'loss_val': 0.3756280554892135, 'psi': 0.7351310688308412}-{'f1_val': 0.9696735862018273, 'auprc': 0.9653210540773924, 'loss_val': 0.19121938366443278, 'psi': 0.9679325733520534}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=42 head_norm_before_train=1.424989 cos_to_last_merge=0.9953 (last merge round=34)
[S8] round=42 local utility u=0.045069 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9990791611162618, 'loss_val': 0.054194470596430094, 'psi': 0.9974435094078795}-{'f1_val': 0.9866701491073004, 'auprc': 0.997996153175696, 'loss_val': 0.0829858035714379, 'psi': 0.9912005507346586}
[S9] START round=42 head_norm_before_train=1.528023 cos_to_last_merge=0.9870 (last merge round=34)
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.9971317563071089, 'auprc': 0.9973929536628082, 'loss_val': 0.03551297222528619, 'psi': 0.9972362352493886}-{'f1_val': 0.9971317563071089, 'auprc': 0.9987397841471776, 'loss_val': 0.03826191489229342, 'psi': 0.9977749674431364}
[S10] START round=42 head_norm_before_train=1.858715 cos_to_last_merge=0.8160 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.816
[S10] round=42 local utility u=0.070289 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9954065390260853, 'loss_val': 0.041431323568891905, 'psi': 0.9953564879486723}-{'f1_val': 0.9792470808379912, 'auprc': 0.9925200501208788, 'loss_val': 0.0768930700082901, 'psi': 0.9845562685511462}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] sending update (kind=head size=1805 to 1 peers)
[S11] START round=42 head_norm_before_train=2.078165 cos_to_last_merge=0.9979 (last merge round=32)
[S11] round=42 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9987532446954502, 'loss_val': 0.025785257165513192, 'psi': 0.9971937827246273}-{'f1_val': 0.9961541414107454, 'auprc': 0.9989001600887858, 'loss_val': 0.025462822635381518, 'psi': 0.9972525488819616}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=42 head_norm_before_train=1.764050 (no previous merge yet)
[S13] round=42 local utility u=0.001139 metrics={'f1_val': 0.6019049282945349, 'auprc': 0.6879984057171254, 'loss_val': 0.7625792271454604, 'psi': 0.6363423192635711}-{'f1_val': 0.6102863765827092, 'auprc': 0.6872568813926198, 'loss_val': 0.8129208176619498, 'psi': 0.6410745785066735}
[S14] START round=42 head_norm_before_train=1.470230 cos_to_last_merge=0.9618 (last merge round=29)
[S14] round=42 local utility u=0.001701 metrics={'f1_val': 0.9967774409524363, 'auprc': 0.9992187010947076, 'loss_val': 0.04808728018572952, 'psi': 0.9977539450093448}-{'f1_val': 0.9969975081576651, 'auprc': 0.9988465534505707, 'loss_val': 0.05169312317929445, 'psi': 0.9977371262748274}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=42 head_norm_before_train=1.672378 cos_to_last_merge=0.9960 (last merge round=33)
[S15] round=42 local utility u=0.814924 metrics={'f1_val': 0.9265919278872766, 'auprc': 0.9964510211973486, 'loss_val': 0.1117054511795495, 'psi': 0.9545355652113054}-{'f1_val': 0.7009191843683342, 'auprc': 0.9894525457332689, 'loss_val': 0.366521636846706, 'psi': 0.8163325289143082}
[S16] START round=42 head_norm_before_train=1.470341 cos_to_last_merge=0.9915 (last merge round=34)
[S16] round=42 local utility u=0.521392 metrics={'f1_val': 0.8784296108203721, 'auprc': 0.9789132846750108, 'loss_val': 0.25356553128055537, 'psi': 0.9186230803622276}-{'f1_val': 0.8297707451545828, 'auprc': 0.9263806642807828, 'loss_val': 0.846798029748559, 'psi': 0.8684147128050628}
[S17] START round=42 head_norm_before_train=1.961567 cos_to_last_merge=0.9970 (last merge round=35)
[S17] round=42 local utility u=0.113399 metrics={'f1_val': 0.6328325440061537, 'auprc': 0.8215857098015193, 'loss_val': 0.9462770124032747, 'psi': 0.7083338103243}-{'f1_val': 0.6076654414308382, 'auprc': 0.8469471968659013, 'loss_val': 1.0981559252095405, 'psi': 0.7033781436048634}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S2] START round=43 head_norm_before_train=1.903781 cos_to_last_merge=0.9898 (last merge round=26)
[S2] round=43 local utility u=0.020949 metrics={'f1_val': 0.8241887904192252, 'auprc': 0.8367993708291211, 'loss_val': 0.37365605010291264, 'psi': 0.8292330225831837}-{'f1_val': 0.8252271946382755, 'auprc': 0.822173112937418, 'loss_val': 0.37790548164758336, 'psi': 0.8240055619579325}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=43 head_norm_before_train=2.014817 cos_to_last_merge=0.9949 (last merge round=33)
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.8351842225012607, 'auprc': 0.9983378747721854, 'loss_val': 0.3741451703275401, 'psi': 0.9004456834096306}-{'f1_val': 0.8814410568410593, 'auprc': 0.998432027645345, 'loss_val': 0.2927657952925421, 'psi': 0.9282374451627736}
[S4] START round=43 head_norm_before_train=1.986659 cos_to_last_merge=0.9993 (last merge round=34)
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.9405925729878124, 'auprc': 0.9539584190051091, 'loss_val': 0.3027726352975895, 'psi': 0.9459389113947311}-{'f1_val': 0.9449888230117902, 'auprc': 0.9754828083841314, 'loss_val': 0.2895974992279779, 'psi': 0.9571864171607267}
[S5] START round=43 head_norm_before_train=1.676913 cos_to_last_merge=0.9958 (last merge round=35)
[S5] round=43 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9934617722155084, 'loss_val': 0.08132978931816225, 'psi': 0.995405889973278}-{'f1_val': 0.9970695586110643, 'auprc': 0.9984816671569736, 'loss_val': 0.09052232512854884, 'psi': 0.9976344020294281}
[S6] START round=43 head_norm_before_train=1.433915 cos_to_last_merge=0.9959 (last merge round=35)
[S6] round=43 local utility u=1.000000 metrics={'f1_val': 0.7977157494498276, 'auprc': 0.9467191136387153, 'loss_val': 0.48599628101379244, 'psi': 0.8573170951253827}-{'f1_val': 0.5882833969450629, 'auprc': 0.7302496804485306, 'loss_val': 1.0186962563122997, 'psi': 0.64506991034645}
[S7] START round=43 head_norm_before_train=1.576980 cos_to_last_merge=0.8083 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.808
[S7] round=43 local utility u=0.071527 metrics={'f1_val': 0.6811835127031929, 'auprc': 0.8440801889511991, 'loss_val': 0.3302324757527188, 'psi': 0.7463421832023953}-{'f1_val': 0.67213328295449, 'auprc': 0.8296277476453677, 'loss_val': 0.3756280554892135, 'psi': 0.7351310688308412}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] START round=43 head_norm_before_train=1.438386 cos_to_last_merge=0.9947 (last merge round=34)
[S8] round=43 local utility u=0.000792 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9991282648130948, 'loss_val': 0.05275867548299002, 'psi': 0.9974631508866127}-{'f1_val': 0.9963530749356245, 'auprc': 0.9990791611162618, 'loss_val': 0.054194470596430094, 'psi': 0.9974435094078795}
[S9] START round=43 head_norm_before_train=1.548575 cos_to_last_merge=0.9853 (last merge round=34)
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.9958851710193355, 'auprc': 0.9986667825956181, 'loss_val': 0.037173232374441256, 'psi': 0.9969978156498485}-{'f1_val': 0.9971317563071089, 'auprc': 0.9973929536628082, 'loss_val': 0.03551297222528619, 'psi': 0.9972362352493886}
[S10] START round=43 head_norm_before_train=1.866979 cos_to_last_merge=0.8154 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.815
[S10] round=43 local utility u=0.007261 metrics={'f1_val': 0.9957380956904327, 'auprc': 0.9957596270880864, 'loss_val': 0.03045756105760229, 'psi': 0.9957467082494942}-{'f1_val': 0.9953231205637304, 'auprc': 0.9954065390260853, 'loss_val': 0.041431323568891905, 'psi': 0.9953564879486723}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=43 head_norm_before_train=2.089031 cos_to_last_merge=0.9976 (last merge round=32)
[S11] round=43 local utility u=0.000398 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9987214092652954, 'loss_val': 0.02489362753451025, 'psi': 0.9971810485525654}-{'f1_val': 0.9961541414107454, 'auprc': 0.9987532446954502, 'loss_val': 0.025785257165513192, 'psi': 0.9971937827246273}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=43 head_norm_before_train=1.774094 (no previous merge yet)
[S13] round=43 local utility u=0.054431 metrics={'f1_val': 0.6117614122170139, 'auprc': 0.6911390700531768, 'loss_val': 0.7222783673735962, 'psi': 0.643512475351479}-{'f1_val': 0.6019049282945349, 'auprc': 0.6879984057171254, 'loss_val': 0.7625792271454604, 'psi': 0.6363423192635711}
[S14] START round=43 head_norm_before_train=1.490117 cos_to_last_merge=0.9596 (last merge round=29)
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.9570801013968268, 'auprc': 0.9971538835700622, 'loss_val': 0.07737171140869711, 'psi': 0.9731096142661209}-{'f1_val': 0.9967774409524363, 'auprc': 0.9992187010947076, 'loss_val': 0.04808728018572952, 'psi': 0.9977539450093448}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=43 head_norm_before_train=1.680502 cos_to_last_merge=0.9956 (last merge round=33)
[S15] round=43 local utility u=0.000000 metrics={'f1_val': 0.8675924559262574, 'auprc': 0.9934970990248007, 'loss_val': 0.24472200233924973, 'psi': 0.9179543131656748}-{'f1_val': 0.9265919278872766, 'auprc': 0.9964510211973486, 'loss_val': 0.1117054511795495, 'psi': 0.9545355652113054}
[S16] START round=43 head_norm_before_train=1.484310 cos_to_last_merge=0.9906 (last merge round=34)
[S16] round=43 local utility u=0.445411 metrics={'f1_val': 0.9914277471829631, 'auprc': 0.986751498422888, 'loss_val': 0.06424652522208335, 'psi': 0.989557247678933}-{'f1_val': 0.8784296108203721, 'auprc': 0.9789132846750108, 'loss_val': 0.25356553128055537, 'psi': 0.9186230803622276}
[S17] START round=43 head_norm_before_train=1.974440 cos_to_last_merge=0.9964 (last merge round=35)
[S17] round=43 local utility u=0.520464 metrics={'f1_val': 0.6927078650859245, 'auprc': 0.945157730964583, 'loss_val': 0.6353165452256145, 'psi': 0.793687811437388}-{'f1_val': 0.6328325440061537, 'auprc': 0.8215857098015193, 'loss_val': 0.9462770124032747, 'psi': 0.7083338103243}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S13] not sending this round → trigger blocked (psi=0.644)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.990)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.997)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.794)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=44 head_norm_before_train=1.917270 cos_to_last_merge=0.9886 (last merge round=26)
[S2] round=44 local utility u=0.008610 metrics={'f1_val': 0.8258957730571894, 'auprc': 0.8363520951994262, 'loss_val': 0.3653358091085815, 'psi': 0.8300783019140842}-{'f1_val': 0.8241887904192252, 'auprc': 0.8367993708291211, 'loss_val': 0.37365605010291264, 'psi': 0.8292330225831837}
[S2] not sending this round → trigger blocked (psi=0.830)
[S3] START round=44 head_norm_before_train=2.026135 cos_to_last_merge=0.9945 (last merge round=33)
[S3] round=44 local utility u=0.000000 metrics={'f1_val': 0.8141600706261503, 'auprc': 0.9982410359877419, 'loss_val': 0.4511113454681098, 'psi': 0.8877924567707869}-{'f1_val': 0.8351842225012607, 'auprc': 0.9983378747721854, 'loss_val': 0.3741451703275401, 'psi': 0.9004456834096306}
[S4] START round=44 head_norm_before_train=1.993485 cos_to_last_merge=0.9992 (last merge round=34)
[S4] round=44 local utility u=0.059543 metrics={'f1_val': 0.9471206342850843, 'auprc': 0.9762568663876233, 'loss_val': 0.2897508947020116, 'psi': 0.9587751271260999}-{'f1_val': 0.9405925729878124, 'auprc': 0.9539584190051091, 'loss_val': 0.3027726352975895, 'psi': 0.9459389113947311}
[S5] START round=44 head_norm_before_train=1.683348 cos_to_last_merge=0.9955 (last merge round=35)
[S5] round=44 local utility u=0.011130 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9940854931113798, 'loss_val': 0.060940843745245055, 'psi': 0.9956553783316265}-{'f1_val': 0.9967019684784577, 'auprc': 0.9934617722155084, 'loss_val': 0.08132978931816225, 'psi': 0.995405889973278}
[S6] START round=44 head_norm_before_train=1.449092 cos_to_last_merge=0.9952 (last merge round=35)
[S6] round=44 local utility u=0.180143 metrics={'f1_val': 0.8265162439171593, 'auprc': 0.9639784969069185, 'loss_val': 0.3502906898469736, 'psi': 0.881501145113063}-{'f1_val': 0.7977157494498276, 'auprc': 0.9467191136387153, 'loss_val': 0.48599628101379244, 'psi': 0.8573170951253827}
[S7] START round=44 head_norm_before_train=1.580805 cos_to_last_merge=0.8074 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.807
[S7] round=44 local utility u=0.000000 metrics={'f1_val': 0.5864999874575878, 'auprc': 0.7900832977337247, 'loss_val': 0.6845141466692687, 'psi': 0.6679333115680426}-{'f1_val': 0.6811835127031929, 'auprc': 0.8440801889511991, 'loss_val': 0.3302324757527188, 'psi': 0.7463421832023953}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=44 head_norm_before_train=1.449777 cos_to_last_merge=0.9942 (last merge round=34)
[S8] round=44 local utility u=0.001087 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9990950032257857, 'loss_val': 0.04958493692920038, 'psi': 0.9973598633304059}-{'f1_val': 0.9963530749356245, 'auprc': 0.9991282648130948, 'loss_val': 0.05275867548299002, 'psi': 0.9974631508866127}
[S9] START round=44 head_norm_before_train=1.568793 cos_to_last_merge=0.9837 (last merge round=34)
[S9] round=44 local utility u=0.003874 metrics={'f1_val': 0.9971317563071089, 'auprc': 0.9968203811910956, 'loss_val': 0.031365235425490856, 'psi': 0.9970072062607036}-{'f1_val': 0.9958851710193355, 'auprc': 0.9986667825956181, 'loss_val': 0.037173232374441256, 'psi': 0.9969978156498485}
[S10] START round=44 head_norm_before_train=1.875244 cos_to_last_merge=0.8147 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.815
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.9617224979881414, 'auprc': 0.9927954343798051, 'loss_val': 0.09009037660340997, 'psi': 0.9741516725448068}-{'f1_val': 0.9957380956904327, 'auprc': 0.9957596270880864, 'loss_val': 0.03045756105760229, 'psi': 0.9957467082494942}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=44 head_norm_before_train=2.100711 cos_to_last_merge=0.9972 (last merge round=32)
[S11] round=44 local utility u=0.000717 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9988035974398337, 'loss_val': 0.023706655019853133, 'psi': 0.9972139238223807}-{'f1_val': 0.9961541414107454, 'auprc': 0.9987214092652954, 'loss_val': 0.02489362753451025, 'psi': 0.9971810485525654}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=44 head_norm_before_train=1.786276 (no previous merge yet)
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.57736622933764, 'auprc': 0.7052174911367254, 'loss_val': 1.0161323809453808, 'psi': 0.6285067340572741}-{'f1_val': 0.6117614122170139, 'auprc': 0.6911390700531768, 'loss_val': 0.7222783673735962, 'psi': 0.643512475351479}
[S14] START round=44 head_norm_before_train=1.508185 cos_to_last_merge=0.9575 (last merge round=29)
[S14] round=44 local utility u=0.138110 metrics={'f1_val': 0.9965574496053289, 'auprc': 0.9990900514820815, 'loss_val': 0.04382424241068669, 'psi': 0.99757049035603}-{'f1_val': 0.9570801013968268, 'auprc': 0.9971538835700622, 'loss_val': 0.07737171140869711, 'psi': 0.9731096142661209}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=44 head_norm_before_train=1.692227 cos_to_last_merge=0.9950 (last merge round=33)
[S15] round=44 local utility u=0.000000 metrics={'f1_val': 0.7009202876340006, 'auprc': 0.9909627208500001, 'loss_val': 0.43797789011921984, 'psi': 0.8169372609204004}-{'f1_val': 0.8675924559262574, 'auprc': 0.9934970990248007, 'loss_val': 0.24472200233924973, 'psi': 0.9179543131656748}
[S16] START round=44 head_norm_before_train=1.497796 cos_to_last_merge=0.9897 (last merge round=34)
[S16] round=44 local utility u=0.006424 metrics={'f1_val': 0.9914277471829631, 'auprc': 0.9902924742667121, 'loss_val': 0.06202199979407918, 'psi': 0.9909736380164627}-{'f1_val': 0.9914277471829631, 'auprc': 0.986751498422888, 'loss_val': 0.06424652522208335, 'psi': 0.989557247678933}
[S17] START round=44 head_norm_before_train=1.985434 cos_to_last_merge=0.9960 (last merge round=35)
[S17] round=44 local utility u=0.000000 metrics={'f1_val': 0.6335820279548972, 'auprc': 0.9001324282923575, 'loss_val': 1.12234909576781, 'psi': 0.7402021880898813}-{'f1_val': 0.6927078650859245, 'auprc': 0.945157730964583, 'loss_val': 0.6353165452256145, 'psi': 0.793687811437388}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] sending update (kind=head size=1804 to 1 peers)
[S6] not sending this round → trigger blocked (psi=0.882)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S2] START round=45 head_norm_before_train=1.931342 cos_to_last_merge=0.9874 (last merge round=26)
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.7110197655315256, 'auprc': 0.9766847286984062, 'loss_val': 0.39093601941634143, 'psi': 0.8172857507982778}-{'f1_val': 0.8258957730571894, 'auprc': 0.8363520951994262, 'loss_val': 0.3653358091085815, 'psi': 0.8300783019140842}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=45 head_norm_before_train=2.040043 cos_to_last_merge=0.9938 (last merge round=33)
[S3] round=45 local utility u=0.727525 metrics={'f1_val': 0.9880003466241639, 'auprc': 0.999148495137193, 'loss_val': 0.04182523998555559, 'psi': 0.9924596060293756}-{'f1_val': 0.8141600706261503, 'auprc': 0.9982410359877419, 'loss_val': 0.4511113454681098, 'psi': 0.8877924567707869}
[S4] START round=45 head_norm_before_train=1.997675 cos_to_last_merge=0.9991 (last merge round=34)
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.9415064810117215, 'auprc': 0.9599935771292807, 'loss_val': 0.3033447301711305, 'psi': 0.9489013194587452}-{'f1_val': 0.9471206342850843, 'auprc': 0.9762568663876233, 'loss_val': 0.2897508947020116, 'psi': 0.9587751271260999}
[S5] START round=45 head_norm_before_train=1.700234 cos_to_last_merge=0.9945 (last merge round=35)
[S5] round=45 local utility u=0.006152 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9952053594096759, 'loss_val': 0.05199557126915737, 'psi': 0.996103324850945}-{'f1_val': 0.9967019684784577, 'auprc': 0.9940854931113798, 'loss_val': 0.060940843745245055, 'psi': 0.9956553783316265}
[S6] START round=45 head_norm_before_train=1.466878 cos_to_last_merge=0.9944 (last merge round=35)
[S6] round=45 local utility u=0.000000 metrics={'f1_val': 0.689812882379319, 'auprc': 0.9399116040105012, 'loss_val': 0.7423117081339579, 'psi': 0.789852371031792}-{'f1_val': 0.8265162439171593, 'auprc': 0.9639784969069185, 'loss_val': 0.3502906898469736, 'psi': 0.881501145113063}
[S7] START round=45 head_norm_before_train=1.581684 cos_to_last_merge=0.8067 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.807
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.5326652810869699, 'auprc': 0.7833991097551452, 'loss_val': 0.7182549303226323, 'psi': 0.63295881255424}-{'f1_val': 0.5864999874575878, 'auprc': 0.7900832977337247, 'loss_val': 0.6845141466692687, 'psi': 0.6679333115680426}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=45 head_norm_before_train=1.463789 cos_to_last_merge=0.9935 (last merge round=34)
[S8] round=45 local utility u=0.001774 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9990199383414613, 'loss_val': 0.04671234052755399, 'psi': 0.9974198202979593}-{'f1_val': 0.9962031034001528, 'auprc': 0.9990950032257857, 'loss_val': 0.04958493692920038, 'psi': 0.9973598633304059}
[S9] START round=45 head_norm_before_train=1.585644 cos_to_last_merge=0.9824 (last merge round=34)
[S9] round=45 local utility u=0.002324 metrics={'f1_val': 0.9967181314020974, 'auprc': 0.9987502711247992, 'loss_val': 0.030025985477887904, 'psi': 0.9975309872911781}-{'f1_val': 0.9971317563071089, 'auprc': 0.9968203811910956, 'loss_val': 0.031365235425490856, 'psi': 0.9970072062607036}
[S10] START round=45 head_norm_before_train=1.884386 cos_to_last_merge=0.8141 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.814
[S10] round=45 local utility u=0.133101 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9951757011101889, 'loss_val': 0.032632871291433295, 'psi': 0.9952641527823138}-{'f1_val': 0.9617224979881414, 'auprc': 0.9927954343798051, 'loss_val': 0.09009037660340997, 'psi': 0.9741516725448068}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=45 head_norm_before_train=2.110955 cos_to_last_merge=0.9970 (last merge round=32)
[S11] round=45 local utility u=0.000000 metrics={'f1_val': 0.9959137982851655, 'auprc': 0.9988557994804628, 'loss_val': 0.025104157856365578, 'psi': 0.9970905987632844}-{'f1_val': 0.9961541414107454, 'auprc': 0.9988035974398337, 'loss_val': 0.023706655019853133, 'psi': 0.9972139238223807}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=45 head_norm_before_train=1.793331 (no previous merge yet)
[S13] round=45 local utility u=0.265528 metrics={'f1_val': 0.6059042737845806, 'auprc': 0.7051971097404754, 'loss_val': 0.6562437567618463, 'psi': 0.6456214081669385}-{'f1_val': 0.57736622933764, 'auprc': 0.7052174911367254, 'loss_val': 1.0161323809453808, 'psi': 0.6285067340572741}
[S14] START round=45 head_norm_before_train=1.523982 cos_to_last_merge=0.9559 (last merge round=29)
[S14] round=45 local utility u=0.001920 metrics={'f1_val': 0.9967552940827689, 'auprc': 0.9988487564841284, 'loss_val': 0.04044821592736785, 'psi': 0.9975926790433127}-{'f1_val': 0.9965574496053289, 'auprc': 0.9990900514820815, 'loss_val': 0.04382424241068669, 'psi': 0.99757049035603}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=45 head_norm_before_train=1.704796 cos_to_last_merge=0.9944 (last merge round=33)
[S15] round=45 local utility u=1.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.997191270952617, 'loss_val': 0.037984479516858, 'psi': 0.9969245094135591}-{'f1_val': 0.7009202876340006, 'auprc': 0.9909627208500001, 'loss_val': 0.43797789011921984, 'psi': 0.8169372609204004}
[S16] START round=45 head_norm_before_train=1.510085 cos_to_last_merge=0.9890 (last merge round=34)
[S16] round=45 local utility u=0.000000 metrics={'f1_val': 0.9899731562937589, 'auprc': 0.9782922736013335, 'loss_val': 0.08255273389174146, 'psi': 0.9853008032167888}-{'f1_val': 0.9914277471829631, 'auprc': 0.9902924742667121, 'loss_val': 0.06202199979407918, 'psi': 0.9909736380164627}
[S17] START round=45 head_norm_before_train=1.994856 cos_to_last_merge=0.9956 (last merge round=35)
[S17] round=45 local utility u=0.212755 metrics={'f1_val': 0.6490530420009496, 'auprc': 0.9533650369957756, 'loss_val': 0.949363664705426, 'psi': 0.77077783999888}-{'f1_val': 0.6335820279548972, 'auprc': 0.9001324282923575, 'loss_val': 1.12234909576781, 'psi': 0.7402021880898813}
[S8] not sending this round → trigger blocked (psi=0.997)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S9] not sending this round → trigger blocked (psi=0.998)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S13] sending update (kind=head size=1807 to 1 peers)
[S5] not sending this round → trigger blocked (psi=0.996)
[S2] START round=46 head_norm_before_train=1.944109 cos_to_last_merge=0.9862 (last merge round=26)
[S2] round=46 local utility u=0.059490 metrics={'f1_val': 0.8031836400736148, 'auprc': 0.8422040690041716, 'loss_val': 0.42149688325867873, 'psi': 0.8187918116458375}-{'f1_val': 0.7110197655315256, 'auprc': 0.9766847286984062, 'loss_val': 0.39093601941634143, 'psi': 0.8172857507982778}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=46 head_norm_before_train=2.055072 cos_to_last_merge=0.9931 (last merge round=33)
[S3] round=46 local utility u=0.000000 metrics={'f1_val': 0.8999862647684349, 'auprc': 0.9819275950296, 'loss_val': 0.2459525749265605, 'psi': 0.9327627968729009}-{'f1_val': 0.9880003466241639, 'auprc': 0.999148495137193, 'loss_val': 0.04182523998555559, 'psi': 0.9924596060293756}
[S4] START round=46 head_norm_before_train=2.004726 cos_to_last_merge=0.9990 (last merge round=34)
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.9393599798062586, 'auprc': 0.9494720594899828, 'loss_val': 0.3130850931216888, 'psi': 0.9434048116797482}-{'f1_val': 0.9415064810117215, 'auprc': 0.9599935771292807, 'loss_val': 0.3033447301711305, 'psi': 0.9489013194587452}
[S5] START round=46 head_norm_before_train=1.724440 cos_to_last_merge=0.9927 (last merge round=35)
[S5] round=46 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.995260918709248, 'loss_val': 0.06251943875348916, 'psi': 0.9961255485707738}-{'f1_val': 0.9967019684784577, 'auprc': 0.9952053594096759, 'loss_val': 0.05199557126915737, 'psi': 0.996103324850945}
[S6] START round=46 head_norm_before_train=1.488402 cos_to_last_merge=0.9934 (last merge round=35)
[S6] round=46 local utility u=1.000000 metrics={'f1_val': 0.9316851024586402, 'auprc': 0.988033121310666, 'loss_val': 0.17566669244549088, 'psi': 0.9542243099994505}-{'f1_val': 0.689812882379319, 'auprc': 0.9399116040105012, 'loss_val': 0.7423117081339579, 'psi': 0.789852371031792}
[S7] START round=46 head_norm_before_train=1.587674 cos_to_last_merge=0.8057 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.806
[S7] round=46 local utility u=0.047377 metrics={'f1_val': 0.5642187132557431, 'auprc': 0.7827741478825345, 'loss_val': 0.8109457180824637, 'psi': 0.6516408871064596}-{'f1_val': 0.5326652810869699, 'auprc': 0.7833991097551452, 'loss_val': 0.7182549303226323, 'psi': 0.63295881255424}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] sending update (kind=head size=1806 to 1 peers)
[S8] START round=46 head_norm_before_train=1.478403 cos_to_last_merge=0.9927 (last merge round=34)
[S8] round=46 local utility u=0.001050 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9990495158873692, 'loss_val': 0.043801877574226405, 'psi': 0.9973416683950393}-{'f1_val': 0.9963530749356245, 'auprc': 0.9990199383414613, 'loss_val': 0.04671234052755399, 'psi': 0.9974198202979593}
[S9] START round=46 head_norm_before_train=1.602047 cos_to_last_merge=0.9810 (last merge round=34)
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.996721335281205, 'auprc': 0.9952408212462365, 'loss_val': 0.02848554083571448, 'psi': 0.9961291296672176}-{'f1_val': 0.9967181314020974, 'auprc': 0.9987502711247992, 'loss_val': 0.030025985477887904, 'psi': 0.9975309872911781}
[S10] START round=46 head_norm_before_train=1.893752 cos_to_last_merge=0.8135 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.814
[S10] round=46 local utility u=0.003151 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9958545290979562, 'loss_val': 0.027049580765026986, 'psi': 0.9954038924848414}-{'f1_val': 0.9953231205637304, 'auprc': 0.9951757011101889, 'loss_val': 0.032632871291433295, 'psi': 0.9952641527823138}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=46 head_norm_before_train=2.121248 cos_to_last_merge=0.9967 (last merge round=32)
[S11] round=46 local utility u=0.001675 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.998838278671605, 'loss_val': 0.02314462031887149, 'psi': 0.9972277963150893}-{'f1_val': 0.9959137982851655, 'auprc': 0.9988557994804628, 'loss_val': 0.025104157856365578, 'psi': 0.9970905987632844}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=46 head_norm_before_train=1.800360 (no previous merge yet)
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.5729514478248572, 'auprc': 0.7167615539773436, 'loss_val': 0.8149377144485418, 'psi': 0.6304754902858518}-{'f1_val': 0.6059042737845806, 'auprc': 0.7051971097404754, 'loss_val': 0.6562437567618463, 'psi': 0.6456214081669385}
[S14] START round=46 head_norm_before_train=1.539092 cos_to_last_merge=0.9544 (last merge round=29)
[S14] round=46 local utility u=0.001584 metrics={'f1_val': 0.9973862616479148, 'auprc': 0.9988080418445244, 'loss_val': 0.04094287863960386, 'psi': 0.9979549737265586}-{'f1_val': 0.9967552940827689, 'auprc': 0.9988487564841284, 'loss_val': 0.04044821592736785, 'psi': 0.9975926790433127}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=46 head_norm_before_train=1.716568 cos_to_last_merge=0.9938 (last merge round=33)
[S15] round=46 local utility u=0.000000 metrics={'f1_val': 0.9954874377857804, 'auprc': 0.9967583990860854, 'loss_val': 0.04343400718021466, 'psi': 0.9959958223059024}-{'f1_val': 0.9967466683875206, 'auprc': 0.997191270952617, 'loss_val': 0.037984479516858, 'psi': 0.9969245094135591}
[S16] START round=46 head_norm_before_train=1.522153 cos_to_last_merge=0.9883 (last merge round=34)
[S16] round=46 local utility u=0.030060 metrics={'f1_val': 0.9908943619511692, 'auprc': 0.9899916451495899, 'loss_val': 0.06305765749689574, 'psi': 0.9905332752305375}-{'f1_val': 0.9899731562937589, 'auprc': 0.9782922736013335, 'loss_val': 0.08255273389174146, 'psi': 0.9853008032167888}
[S17] START round=46 head_norm_before_train=2.005089 cos_to_last_merge=0.9951 (last merge round=35)
[S17] round=46 local utility u=0.000000 metrics={'f1_val': 0.6435263367821558, 'auprc': 0.8921261915001298, 'loss_val': 1.0223069860372915, 'psi': 0.7429662786693454}-{'f1_val': 0.6490530420009496, 'auprc': 0.9533650369957756, 'loss_val': 0.949363664705426, 'psi': 0.77077783999888}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] sending update (kind=head size=1796 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=47 head_norm_before_train=1.955716 cos_to_last_merge=0.9850 (last merge round=26)
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.7471478119628866, 'auprc': 0.8519194537709333, 'loss_val': 0.429241796340982, 'psi': 0.7890564686861052}-{'f1_val': 0.8031836400736148, 'auprc': 0.8422040690041716, 'loss_val': 0.42149688325867873, 'psi': 0.8187918116458375}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=47 head_norm_before_train=2.069315 cos_to_last_merge=0.9925 (last merge round=33)
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.736872893511257, 'auprc': 0.9980337467053144, 'loss_val': 0.7581726255509726, 'psi': 0.8413372347888799}-{'f1_val': 0.8999862647684349, 'auprc': 0.9819275950296, 'loss_val': 0.2459525749265605, 'psi': 0.9327627968729009}
[S4] START round=47 head_norm_before_train=2.007400 cos_to_last_merge=0.9987 (last merge round=34)
[S4] round=47 local utility u=0.035435 metrics={'f1_val': 0.942198997823838, 'auprc': 0.9636895282468741, 'loss_val': 0.3019014957588828, 'psi': 0.9507952099930526}-{'f1_val': 0.9393599798062586, 'auprc': 0.9494720594899828, 'loss_val': 0.3130850931216888, 'psi': 0.9434048116797482}
[S5] START round=47 head_norm_before_train=1.744285 cos_to_last_merge=0.9913 (last merge round=35)
[S5] round=47 local utility u=0.002502 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9916333032519529, 'loss_val': 0.04663292162961714, 'psi': 0.9946745023878558}-{'f1_val': 0.9967019684784577, 'auprc': 0.995260918709248, 'loss_val': 0.06251943875348916, 'psi': 0.9961255485707738}
[S6] START round=47 head_norm_before_train=1.505238 cos_to_last_merge=0.9925 (last merge round=35)
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.8390771072644051, 'auprc': 0.9658134348193805, 'loss_val': 0.2675240136737283, 'psi': 0.8897716382863953}-{'f1_val': 0.9316851024586402, 'auprc': 0.988033121310666, 'loss_val': 0.17566669244549088, 'psi': 0.9542243099994505}
[S7] START round=47 head_norm_before_train=1.597719 cos_to_last_merge=0.8050 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.805
[S7] round=47 local utility u=0.511889 metrics={'f1_val': 0.6586720337511538, 'auprc': 0.8136154141461809, 'loss_val': 0.4464119784685762, 'psi': 0.7206493859091647}-{'f1_val': 0.5642187132557431, 'auprc': 0.7827741478825345, 'loss_val': 0.8109457180824637, 'psi': 0.6516408871064596}
[S7] not sending this round → trigger blocked (psi=0.721)
[S8] START round=47 head_norm_before_train=1.493111 cos_to_last_merge=0.9919 (last merge round=34)
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.998620310645953, 'loss_val': 0.046728035535618016, 'psi': 0.9971699862984729}-{'f1_val': 0.9962031034001528, 'auprc': 0.9990495158873692, 'loss_val': 0.043801877574226405, 'psi': 0.9973416683950393}
[S9] START round=47 head_norm_before_train=1.618482 cos_to_last_merge=0.9796 (last merge round=34)
[S9] round=47 local utility u=0.006769 metrics={'f1_val': 0.9971317563071089, 'auprc': 0.9985134435964513, 'loss_val': 0.02722863997598617, 'psi': 0.9976844312228459}-{'f1_val': 0.996721335281205, 'auprc': 0.9952408212462365, 'loss_val': 0.02848554083571448, 'psi': 0.9961291296672176}
[S10] START round=47 head_norm_before_train=1.903147 cos_to_last_merge=0.8129 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.813
[S10] round=47 local utility u=0.000000 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9957725444568784, 'loss_val': 0.027261192471815486, 'psi': 0.9953710986284103}-{'f1_val': 0.9951034680760983, 'auprc': 0.9958545290979562, 'loss_val': 0.027049580765026986, 'psi': 0.9954038924848414}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=47 head_norm_before_train=2.129293 cos_to_last_merge=0.9965 (last merge round=32)
[S11] round=47 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.998684758688679, 'loss_val': 0.0235789975451406, 'psi': 0.9971663883219188}-{'f1_val': 0.9961541414107454, 'auprc': 0.998838278671605, 'loss_val': 0.02314462031887149, 'psi': 0.9972277963150893}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=47 head_norm_before_train=1.807195 (no previous merge yet)
[S13] round=47 local utility u=0.144047 metrics={'f1_val': 0.6204334817492556, 'auprc': 0.7272327829972336, 'loss_val': 0.8431491194106233, 'psi': 0.6631532022484468}-{'f1_val': 0.5729514478248572, 'auprc': 0.7167615539773436, 'loss_val': 0.8149377144485418, 'psi': 0.6304754902858518}
[S14] START round=47 head_norm_before_train=1.554588 cos_to_last_merge=0.9529 (last merge round=29)
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.9963144732565343, 'auprc': 0.9969592132838339, 'loss_val': 0.04021797078024186, 'psi': 0.9965723692674542}-{'f1_val': 0.9973862616479148, 'auprc': 0.9988080418445244, 'loss_val': 0.04094287863960386, 'psi': 0.9979549737265586}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=47 head_norm_before_train=1.728066 cos_to_last_merge=0.9932 (last merge round=33)
[S15] round=47 local utility u=0.004640 metrics={'f1_val': 0.9958217461321837, 'auprc': 0.9981777526368202, 'loss_val': 0.040418548396753476, 'psi': 0.9967641487340383}-{'f1_val': 0.9954874377857804, 'auprc': 0.9967583990860854, 'loss_val': 0.04343400718021466, 'psi': 0.9959958223059024}
[S16] START round=47 head_norm_before_train=1.534110 cos_to_last_merge=0.9875 (last merge round=34)
[S16] round=47 local utility u=0.000000 metrics={'f1_val': 0.9429960150571276, 'auprc': 0.9869898880911012, 'loss_val': 0.2145426389255493, 'psi': 0.9605935642707171}-{'f1_val': 0.9908943619511692, 'auprc': 0.9899916451495899, 'loss_val': 0.06305765749689574, 'psi': 0.9905332752305375}
[S17] START round=47 head_norm_before_train=2.016736 cos_to_last_merge=0.9946 (last merge round=35)
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.6289381994067684, 'auprc': 0.835485197861424, 'loss_val': 1.1803533743108041, 'psi': 0.7115569987886307}-{'f1_val': 0.6435263367821558, 'auprc': 0.8921261915001298, 'loss_val': 1.0223069860372915, 'psi': 0.7429662786693454}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=48 head_norm_before_train=1.967906 cos_to_last_merge=0.9838 (last merge round=26)
[S2] round=48 local utility u=0.091970 metrics={'f1_val': 0.7362645279904598, 'auprc': 0.9222115134569734, 'loss_val': 0.3908792323894001, 'psi': 0.8106433221770653}-{'f1_val': 0.7471478119628866, 'auprc': 0.8519194537709333, 'loss_val': 0.429241796340982, 'psi': 0.7890564686861052}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=48 head_norm_before_train=2.082509 cos_to_last_merge=0.9918 (last merge round=33)
[S3] round=48 local utility u=0.130790 metrics={'f1_val': 0.7624914334765458, 'auprc': 0.99809109019167, 'loss_val': 0.6504755034797267, 'psi': 0.8567312961625955}-{'f1_val': 0.736872893511257, 'auprc': 0.9980337467053144, 'loss_val': 0.7581726255509726, 'psi': 0.8413372347888799}
[S4] START round=48 head_norm_before_train=2.003142 cos_to_last_merge=0.9983 (last merge round=34)
[S4] round=48 local utility u=0.000000 metrics={'f1_val': 0.942198997823838, 'auprc': 0.9621109837682849, 'loss_val': 0.3026061840934872, 'psi': 0.9501637922016168}-{'f1_val': 0.942198997823838, 'auprc': 0.9636895282468741, 'loss_val': 0.3019014957588828, 'psi': 0.9507952099930526}
[S5] START round=48 head_norm_before_train=1.762498 cos_to_last_merge=0.9898 (last merge round=35)
[S5] round=48 local utility u=0.013150 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9976131160582918, 'loss_val': 0.0382728505176467, 'psi': 0.9970664275103913}-{'f1_val': 0.9967019684784577, 'auprc': 0.9916333032519529, 'loss_val': 0.04663292162961714, 'psi': 0.9946745023878558}
[S6] START round=48 head_norm_before_train=1.522458 cos_to_last_merge=0.9916 (last merge round=35)
[S6] round=48 local utility u=0.000000 metrics={'f1_val': 0.846238885679774, 'auprc': 0.9734550490242133, 'loss_val': 0.43395923561581123, 'psi': 0.8971253510175498}-{'f1_val': 0.8390771072644051, 'auprc': 0.9658134348193805, 'loss_val': 0.2675240136737283, 'psi': 0.8897716382863953}
[S7] START round=48 head_norm_before_train=1.605660 cos_to_last_merge=0.8043 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.804
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.5993804999234615, 'auprc': 0.7860792437014854, 'loss_val': 0.7427845475462967, 'psi': 0.674059997434671}-{'f1_val': 0.6586720337511538, 'auprc': 0.8136154141461809, 'loss_val': 0.4464119784685762, 'psi': 0.7206493859091647}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=48 head_norm_before_train=1.503878 cos_to_last_merge=0.9914 (last merge round=34)
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9989887042920198, 'loss_val': 0.04784707937376913, 'psi': 0.9973173437568996}-{'f1_val': 0.9962031034001528, 'auprc': 0.998620310645953, 'loss_val': 0.046728035535618016, 'psi': 0.9971699862984729}
[S9] START round=48 head_norm_before_train=1.634177 cos_to_last_merge=0.9783 (last merge round=34)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.9967181314020974, 'auprc': 0.9987511331424002, 'loss_val': 0.026576491624591664, 'psi': 0.9975313320982184}-{'f1_val': 0.9971317563071089, 'auprc': 0.9985134435964513, 'loss_val': 0.02722863997598617, 'psi': 0.9976844312228459}
[S10] START round=48 head_norm_before_train=1.910713 cos_to_last_merge=0.8124 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.812
[S10] round=48 local utility u=0.000000 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9957497992951245, 'loss_val': 0.027502336474783503, 'psi': 0.9953620005637087}-{'f1_val': 0.9951034680760983, 'auprc': 0.9957725444568784, 'loss_val': 0.027261192471815486, 'psi': 0.9953710986284103}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=48 head_norm_before_train=2.136551 cos_to_last_merge=0.9962 (last merge round=32)
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.9930317006241273, 'auprc': 0.9986846185638137, 'loss_val': 0.027808226560203764, 'psi': 0.9952928678000018}-{'f1_val': 0.9961541414107454, 'auprc': 0.998684758688679, 'loss_val': 0.0235789975451406, 'psi': 0.9971663883219188}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=48 head_norm_before_train=1.814919 (no previous merge yet)
[S13] round=48 local utility u=0.024659 metrics={'f1_val': 0.6043652305675334, 'auprc': 0.724691405304676, 'loss_val': 0.6897979622297715, 'psi': 0.6524957004623905}-{'f1_val': 0.6204334817492556, 'auprc': 0.7272327829972336, 'loss_val': 0.8431491194106233, 'psi': 0.6631532022484468}
[S14] START round=48 head_norm_before_train=1.567390 cos_to_last_merge=0.9516 (last merge round=29)
[S14] round=48 local utility u=0.005123 metrics={'f1_val': 0.9971652929977585, 'auprc': 0.998846685737063, 'loss_val': 0.04073966976831333, 'psi': 0.9978378500934804}-{'f1_val': 0.9963144732565343, 'auprc': 0.9969592132838339, 'loss_val': 0.04021797078024186, 'psi': 0.9965723692674542}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] START round=48 head_norm_before_train=1.739592 cos_to_last_merge=0.9926 (last merge round=33)
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.7009191843683342, 'auprc': 0.9224393612833077, 'loss_val': 0.5277322451529296, 'psi': 0.7895272551343236}-{'f1_val': 0.9958217461321837, 'auprc': 0.9981777526368202, 'loss_val': 0.040418548396753476, 'psi': 0.9967641487340383}
[S16] START round=48 head_norm_before_train=1.546957 cos_to_last_merge=0.9867 (last merge round=34)
[S16] round=48 local utility u=0.020109 metrics={'f1_val': 0.9440060750418791, 'auprc': 0.9889110865087397, 'loss_val': 0.18614820296266224, 'psi': 0.9619680796286233}-{'f1_val': 0.9429960150571276, 'auprc': 0.9869898880911012, 'loss_val': 0.2145426389255493, 'psi': 0.9605935642707171}
[S17] START round=48 head_norm_before_train=2.030747 cos_to_last_merge=0.9940 (last merge round=35)
[S17] round=48 local utility u=0.106150 metrics={'f1_val': 0.6405098003689602, 'auprc': 0.8695717887105484, 'loss_val': 1.1397429704555226, 'psi': 0.7321345957055956}-{'f1_val': 0.6289381994067684, 'auprc': 0.835485197861424, 'loss_val': 1.1803533743108041, 'psi': 0.7115569987886307}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.652)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.997)
[S2] START round=49 head_norm_before_train=1.979228 cos_to_last_merge=0.9827 (last merge round=26)
[S2] round=49 local utility u=0.213415 metrics={'f1_val': 0.8012888699469887, 'auprc': 0.9244583740565747, 'loss_val': 0.3609351707043283, 'psi': 0.850556671590823}-{'f1_val': 0.7362645279904598, 'auprc': 0.9222115134569734, 'loss_val': 0.3908792323894001, 'psi': 0.8106433221770653}
[S2] not sending this round → trigger blocked (psi=0.851)
[S3] START round=49 head_norm_before_train=2.095246 cos_to_last_merge=0.9912 (last merge round=33)
[S3] round=49 local utility u=0.084013 metrics={'f1_val': 0.781585674930204, 'auprc': 0.9981734794147574, 'loss_val': 0.5972613011652017, 'psi': 0.8682207967240254}-{'f1_val': 0.7624914334765458, 'auprc': 0.99809109019167, 'loss_val': 0.6504755034797267, 'psi': 0.8567312961625955}
[S4] START round=49 head_norm_before_train=2.001148 cos_to_last_merge=0.9979 (last merge round=34)
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.9399973075325021, 'auprc': 0.954814649169287, 'loss_val': 0.310446882439448, 'psi': 0.9459242441872161}-{'f1_val': 0.942198997823838, 'auprc': 0.9621109837682849, 'loss_val': 0.3026061840934872, 'psi': 0.9501637922016168}
[S5] START round=49 head_norm_before_train=1.785605 cos_to_last_merge=0.9883 (last merge round=35)
[S5] round=49 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9935701917953204, 'loss_val': 0.03612596860052809, 'psi': 0.9954492578052028}-{'f1_val': 0.9967019684784577, 'auprc': 0.9976131160582918, 'loss_val': 0.0382728505176467, 'psi': 0.9970664275103913}
[S6] START round=49 head_norm_before_train=1.537568 cos_to_last_merge=0.9907 (last merge round=35)
[S6] round=49 local utility u=0.049985 metrics={'f1_val': 0.8387056759937954, 'auprc': 0.9690902871787468, 'loss_val': 0.2756952457175024, 'psi': 0.890859520467776}-{'f1_val': 0.846238885679774, 'auprc': 0.9734550490242133, 'loss_val': 0.43395923561581123, 'psi': 0.8971253510175498}
[S7] START round=49 head_norm_before_train=1.611590 cos_to_last_merge=0.8039 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.804
[S7] round=49 local utility u=0.000000 metrics={'f1_val': 0.44694548670691747, 'auprc': 0.7802525103989024, 'loss_val': 1.2032695965853462, 'psi': 0.5802682961837115}-{'f1_val': 0.5993804999234615, 'auprc': 0.7860792437014854, 'loss_val': 0.7427845475462967, 'psi': 0.674059997434671}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=49 head_norm_before_train=1.513302 cos_to_last_merge=0.9909 (last merge round=34)
[S8] round=49 local utility u=0.003337 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9989792151187545, 'loss_val': 0.04204369530285151, 'psi': 0.9974035310088766}-{'f1_val': 0.9962031034001528, 'auprc': 0.9989887042920198, 'loss_val': 0.04784707937376913, 'psi': 0.9973173437568996}
[S9] START round=49 head_norm_before_train=1.647148 cos_to_last_merge=0.9772 (last merge round=34)
[S9] round=49 local utility u=0.001797 metrics={'f1_val': 0.9971317563071089, 'auprc': 0.9987611585353015, 'loss_val': 0.02549481488594828, 'psi': 0.997783517198386}-{'f1_val': 0.9967181314020974, 'auprc': 0.9987511331424002, 'loss_val': 0.026576491624591664, 'psi': 0.9975313320982184}
[S10] START round=49 head_norm_before_train=1.916314 cos_to_last_merge=0.8120 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.812
[S10] round=49 local utility u=0.000368 metrics={'f1_val': 0.9948838907637279, 'auprc': 0.9962870411922518, 'loss_val': 0.027060344066330178, 'psi': 0.9954451509351374}-{'f1_val': 0.9951034680760983, 'auprc': 0.9957497992951245, 'loss_val': 0.027502336474783503, 'psi': 0.9953620005637087}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=49 head_norm_before_train=2.144439 cos_to_last_merge=0.9960 (last merge round=32)
[S11] round=49 local utility u=0.012503 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9988787552944192, 'loss_val': 0.02211887742201271, 'psi': 0.9972439869642149}-{'f1_val': 0.9930317006241273, 'auprc': 0.9986846185638137, 'loss_val': 0.027808226560203764, 'psi': 0.9952928678000018}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=49 head_norm_before_train=1.820434 (no previous merge yet)
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.5972952596443581, 'auprc': 0.7469234111493722, 'loss_val': 1.098533975643055, 'psi': 0.6571465202463638}-{'f1_val': 0.6043652305675334, 'auprc': 0.724691405304676, 'loss_val': 0.6897979622297715, 'psi': 0.6524957004623905}
[S14] START round=49 head_norm_before_train=1.577901 cos_to_last_merge=0.9505 (last merge round=29)
[S14] round=49 local utility u=0.003370 metrics={'f1_val': 0.9973862616479148, 'auprc': 0.9989006393715121, 'loss_val': 0.03548691591745611, 'psi': 0.9979920127373537}-{'f1_val': 0.9971652929977585, 'auprc': 0.998846685737063, 'loss_val': 0.04073966976831333, 'psi': 0.9978378500934804}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=49 head_norm_before_train=1.752335 cos_to_last_merge=0.9919 (last merge round=33)
[S15] round=49 local utility u=1.000000 metrics={'f1_val': 0.9961470032418738, 'auprc': 0.9979047206493399, 'loss_val': 0.033331229956481155, 'psi': 0.9968500902048603}-{'f1_val': 0.7009191843683342, 'auprc': 0.9224393612833077, 'loss_val': 0.5277322451529296, 'psi': 0.7895272551343236}
[S16] START round=49 head_norm_before_train=1.559787 cos_to_last_merge=0.9858 (last merge round=34)
[S16] round=49 local utility u=0.169368 metrics={'f1_val': 0.9828233139416278, 'auprc': 0.9907640472683781, 'loss_val': 0.08587422268890912, 'psi': 0.9859996072723279}-{'f1_val': 0.9440060750418791, 'auprc': 0.9889110865087397, 'loss_val': 0.18614820296266224, 'psi': 0.9619680796286233}
[S17] START round=49 head_norm_before_train=2.047000 cos_to_last_merge=0.9933 (last merge round=35)
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.6246829407713639, 'auprc': 0.8581556837131975, 'loss_val': 1.309106896319002, 'psi': 0.7180720379480974}-{'f1_val': 0.6405098003689602, 'auprc': 0.8695717887105484, 'loss_val': 1.1397429704555226, 'psi': 0.7321345957055956}
[S13]  timeout peer S10
[S15]  timeout peer S5
[S17]  timeout peer S3
[S6]  timeout peer S8
[S3]  timeout peer S2
[S16]  timeout peer S14
[S9]  timeout peer S16
[S4]  timeout peer S11
[S5]  timeout peer S15
[S8]  timeout peer S9
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] sending update (kind=head size=1794 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] sending update (kind=head size=1803 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.868)
[S16] not sending this round → trigger blocked (psi=0.986)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[runner] rounds complete.
[runner] all agents stopped.
