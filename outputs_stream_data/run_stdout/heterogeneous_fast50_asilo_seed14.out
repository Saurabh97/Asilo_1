[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:59803
[S3] → join 127.0.0.1:59802
[S4] → join 127.0.0.1:59802
[S5] → join 127.0.0.1:59802
[S6] → join 127.0.0.1:59802
[S7] → join 127.0.0.1:59802
[S8] → join 127.0.0.1:59802
[S9] → join 127.0.0.1:59802
[S10] → join 127.0.0.1:59802
[S11] → join 127.0.0.1:59802
[S13] → join 127.0.0.1:59802
[S14] → join 127.0.0.1:59802
[S15] → join 127.0.0.1:59802
[S16] → join 127.0.0.1:59802
[S17] → join 127.0.0.1:59802
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.203240 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.095066 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.160770 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.171126 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.169234 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.162753 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.204467 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.131364 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.181588 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.180336 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.193950 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.208670 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.130641 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.190049 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.245765 (no previous merge yet)
[S2]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S3] + discovered S14
[S3] + discovered S16
[S3] + discovered S15
[S3] + discovered S4
[S3] + discovered S9
[S3] + discovered S7
[S3] + discovered S11
[S3] + discovered S17
[S3] + discovered S13
[S4] + discovered S3
[S4] + discovered S2
[S3] + discovered S5
[S3] + discovered S6
[S3] + discovered S10
[S3] + discovered S8
[S4] + discovered S5
[S4] + discovered S15
[S4] + discovered S10
[S4] + discovered S8
[S4] + discovered S14
[S4] + discovered S16
[S4] + discovered S7
[S4] + discovered S6
[S4] + discovered S9
[S4] + discovered S11
[S4] + discovered S17
[S4] + discovered S13
[S5] + discovered S3
[S5] + discovered S2
[S5] + discovered S4
[S6] + discovered S4
[S6] + discovered S2
[S6] + discovered S3
[S6] + discovered S5
[S5] + discovered S13
[S5] + discovered S7
[S5] + discovered S11
[S5] + discovered S14
[S5] + discovered S15
[S5] + discovered S17
[S5] + discovered S6
[S5] + discovered S9
[S5] + discovered S16
[S5] + discovered S8
[S5] + discovered S10
[S6] + discovered S9
[S6] + discovered S16
[S6] + discovered S17
[S6] + discovered S11
[S6] + discovered S13
[S6] + discovered S10
[S6] + discovered S8
[S6] + discovered S15
[S6] + discovered S14
[S6] + discovered S7
[S7] + discovered S2
[S7] + discovered S5
[S7] + discovered S6
[S7] + discovered S3
[S7] + discovered S4
[S8] + discovered S4
[S8] + discovered S6
[S8] + discovered S7
[S8] + discovered S3
[S8] + discovered S5
[S8] + discovered S2
[S7] + discovered S13
[S7] + discovered S15
[S7] + discovered S10
[S7] + discovered S11
[S7] + discovered S17
[S7] + discovered S16
[S7] + discovered S14
[S7] + discovered S8
[S7] + discovered S9
[S9] + discovered S2
[S9] + discovered S8
[S9] + discovered S7
[S9] + discovered S5
[S9] + discovered S3
[S9] + discovered S6
[S9] + discovered S4
[S8] + discovered S9
[S8] + discovered S14
[S8] + discovered S17
[S8] + discovered S10
[S8] + discovered S13
[S8] + discovered S15
[S8] + discovered S16
[S8] + discovered S11
[S9] + discovered S10
[S9] + discovered S14
[S9] + discovered S15
[S9] + discovered S17
[S10] + discovered S6
[S10] + discovered S4
[S9] + discovered S13
[S10] + discovered S7
[S9] + discovered S16
[S10] + discovered S5
[S10] + discovered S8
[S9] + discovered S11
[S10] + discovered S9
[S10] + discovered S3
[S10] + discovered S2
[S10] + discovered S13
[S10] + discovered S14
[S11] + discovered S2
[S11] + discovered S9
[S11] + discovered S4
[S11] + discovered S10
[S11] + discovered S3
[S11] + discovered S5
[S11] + discovered S6
[S11] + discovered S8
[S11] + discovered S7
[S10] + discovered S11
[S10] + discovered S16
[S10] + discovered S15
[S10] + discovered S17
[S13] + discovered S10
[S13] + discovered S8
[S13] + discovered S6
[S13] + discovered S3
[S13] + discovered S9
[S13] + discovered S2
[S13] + discovered S5
[S13] + discovered S7
[S13] + discovered S11
[S11] + discovered S13
[S13] + discovered S4
[S11] + discovered S16
[S11] + discovered S17
[S11] + discovered S15
[S11] + discovered S14
[S14] + discovered S6
[S14] + discovered S7
[S14] + discovered S5
[S14] + discovered S9
[S14] + discovered S3
[S14] + discovered S13
[S14] + discovered S4
[S14] + discovered S11
[S14] + discovered S2
[S14] + discovered S8
[S14] + discovered S10
[S13] + discovered S17
[S13] + discovered S14
[S13] + discovered S15
[S13] + discovered S16
[S14] + discovered S16
[S14] + discovered S15
[S14] + discovered S17
[S15] + discovered S13
[S15] + discovered S14
[S15] + discovered S4
[S15] + discovered S3
[S15] + discovered S5
[S15] + discovered S6
[S15] + discovered S10
[S15] + discovered S8
[S15] + discovered S2
[S15] + discovered S11
[S15] + discovered S9
[S15] + discovered S7
[S16] + discovered S6
[S16] + discovered S4
[S16] + discovered S7
[S16] + discovered S2
[S16] + discovered S13
[S15] + discovered S17
[S16] + discovered S10
[S15] + discovered S16
[S16] + discovered S11
[S16] + discovered S3
[S16] + discovered S14
[S16] + discovered S9
[S16] + discovered S5
[S16] + discovered S15
[S16] + discovered S8
[S17] + discovered S11
[S17] + discovered S7
[S17] + discovered S13
[S17] + discovered S4
[S17] + discovered S6
[S17] + discovered S15
[S17] + discovered S9
[S17] + discovered S5
[S17] + discovered S14
[S17] + discovered S3
[S16] + discovered S17
[S17] + discovered S2
[S17] + discovered S8
[S17] + discovered S10
[S17] + discovered S16
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] ⇄ pheromone p=1.000 → S9@127.0.0.1:59810
[S7] ⇄ pheromone p=1.000 → S6@127.0.0.1:59807
[S5] ⇄ pheromone p=1.000 → S9@127.0.0.1:59810
[S3] ⇄ pheromone p=1.000 → S2@127.0.0.1:59802
[S10] ⇄ pheromone p=1.000 → S4@127.0.0.1:59804
[S6] ⇄ pheromone p=1.000 → S15@127.0.0.1:59815
[S8] ⇄ pheromone p=1.000 → S6@127.0.0.1:59807
[S16] ⇄ pheromone p=1.000 → S4@127.0.0.1:59804
[S4] ⇄ pheromone p=1.000 → S5@127.0.0.1:59805
[S15] ⇄ pheromone p=1.000 → S14@127.0.0.1:59814
[S2] ⇄ pheromone p=1.000 → S6@127.0.0.1:59807
[S14] ⇄ pheromone p=1.000 → S11@127.0.0.1:59812
[S9] ⇄ pheromone p=1.000 → S14@127.0.0.1:59814
[S11] ⇄ pheromone p=1.000 → S9@127.0.0.1:59810
[S17] ⇄ pheromone p=1.000 → S5@127.0.0.1:59805
[S2] START round=1 head_norm_before_train=1.209894 (no previous merge yet)
[S2] round=1 local utility u=0.055392 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6057410592532967, 'loss_val': 1.280875775060301, 'psi': 0.3273627037344587}-{'f1_val': 0.1417771333885667, 'auprc': 0.5886320498276856, 'loss_val': 1.3403335928276197, 'psi': 0.3205190999642143}
[S3] START round=1 head_norm_before_train=1.102653 (no previous merge yet)
[S3] round=1 local utility u=0.922025 metrics={'f1_val': 0.3993040781804574, 'auprc': 0.6017146469679379, 'loss_val': 1.3319389961559243, 'psi': 0.48026830569544954}-{'f1_val': 0.10474797479747974, 'auprc': 0.5852780767257191, 'loss_val': 1.359343437081034, 'psi': 0.2969600155687755}
[S4] START round=1 head_norm_before_train=1.178533 (no previous merge yet)
[S4] round=1 local utility u=0.044731 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7778802765078446, 'loss_val': 1.2651905772659842, 'psi': 0.39528808794024833}-{'f1_val': 0.14022662889518414, 'auprc': 0.7695651417786684, 'loss_val': 1.32970710876879, 'psi': 0.3919620340485779}
[S5] START round=1 head_norm_before_train=1.187407 (no previous merge yet)
[S5] round=1 local utility u=0.001577 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7318192065088801, 'loss_val': 1.3071903208915352, 'psi': 0.3780848254606949}-{'f1_val': 0.14226190476190476, 'auprc': 0.7413495012452674, 'loss_val': 1.3389350835863534, 'psi': 0.3818969433552498}
[S6] START round=1 head_norm_before_train=1.174980 (no previous merge yet)
[S6] round=1 local utility u=0.553643 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8306140037076453, 'loss_val': 1.3048448487383537, 'psi': 0.41710137071382736}-{'f1_val': 0.05550037248572138, 'auprc': 0.655801647280331, 'loss_val': 1.3721381639990529, 'psi': 0.2956208824035652}
[S7] START round=1 head_norm_before_train=1.168010 (no previous merge yet)
[S7] round=1 local utility u=0.458486 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7321034771801211, 'loss_val': 1.321697536581197, 'psi': 0.37807548450950346}-{'f1_val': 0.14205682272909165, 'auprc': 0.43904480144062286, 'loss_val': 1.359493101690557, 'psi': 0.26085201421370413}
[S8] START round=1 head_norm_before_train=1.203614 (no previous merge yet)
[S8] round=1 local utility u=0.000000 metrics={'f1_val': 0.20719297778724008, 'auprc': 0.7564386779539349, 'loss_val': 1.284568443278757, 'psi': 0.42689125785391807}-{'f1_val': 0.39142700823716925, 'auprc': 0.5428087143563975, 'loss_val': 1.3398603953379695, 'psi': 0.45197969068486055}
[S9] START round=1 head_norm_before_train=1.143420 (no previous merge yet)
[S9] round=1 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8664461800754382, 'loss_val': 1.2840997388172892, 'psi': 0.4314172463141729}-{'f1_val': 0.4158529361854233, 'auprc': 0.866020215978647, 'loss_val': 1.3262599573556626, 'psi': 0.5959198481027128}
[S10] START round=1 head_norm_before_train=1.193833 (no previous merge yet)
[S10] round=1 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6429181101379008, 'loss_val': 1.2790187968370526, 'psi': 0.3403402265801947}-{'f1_val': 0.13862163754172394, 'auprc': 0.8589733862213866, 'loss_val': 1.34757975466214, 'psi': 0.426762337013589}
[S11] START round=1 head_norm_before_train=1.179822 (no previous merge yet)
[S11] round=1 local utility u=0.576903 metrics={'f1_val': 0.23941148759421754, 'auprc': 0.6752884495536464, 'loss_val': 1.3483492385798186, 'psi': 0.41376227237798907}-{'f1_val': 0.09723875267793383, 'auprc': 0.5870807399301281, 'loss_val': 1.3844953528415114, 'psi': 0.29317554757881154}
[S13] START round=1 head_norm_before_train=1.198508 (no previous merge yet)
[S13] round=1 local utility u=0.060949 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5420180923969979, 'loss_val': 1.2966794883204014, 'psi': 0.30103869450503107}-{'f1_val': 0.1403857625770531, 'auprc': 0.5137217164918791, 'loss_val': 1.3336883303690201, 'psi': 0.2897201441429835}
[S14] START round=1 head_norm_before_train=1.205065 (no previous merge yet)
[S14] round=1 local utility u=1.000000 metrics={'f1_val': 0.389299219155268, 'auprc': 0.8486331840171867, 'loss_val': 1.3408115695727112, 'psi': 0.5730328051000355}-{'f1_val': 0.1038107752956636, 'auprc': 0.6545407081423344, 'loss_val': 1.360297885825201, 'psi': 0.32410274843433196}
[S15] START round=1 head_norm_before_train=1.151710 (no previous merge yet)
[S15] round=1 local utility u=0.035882 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7685790657719656, 'loss_val': 1.271254435612685, 'psi': 0.39127181712572123}-{'f1_val': 0.13973365136155833, 'auprc': 0.7658465352207484, 'loss_val': 1.3348217162344886, 'psi': 0.3901788049052344}
[S16] START round=1 head_norm_before_train=1.192775 (no previous merge yet)
[S16] round=1 local utility u=0.947691 metrics={'f1_val': 0.41609894103363587, 'auprc': 0.7856011019807126, 'loss_val': 1.3378970856017869, 'psi': 0.5638998054124666}-{'f1_val': 0.20563612164880563, 'auprc': 0.5830007730801373, 'loss_val': 1.3627020225941502, 'psi': 0.3565819822213383}
[S17] START round=1 head_norm_before_train=1.247525 (no previous merge yet)
[S17] round=1 local utility u=0.097069 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5582689951554013, 'loss_val': 1.3114089399449615, 'psi': 0.3078769760525911}-{'f1_val': 0.14094896331738438, 'auprc': 0.5112008539566381, 'loss_val': 1.364342003978637, 'psi': 0.2890497195730859}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S16] → sending delta(kind=head bytes=1788) to S10@127.0.0.1:59811
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1784 reason=None
[S7] → sending delta(kind=head bytes=1784) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S2] → sending delta(kind=head bytes=1790) to S11@127.0.0.1:59812
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:59804
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S5] → sending delta(kind=head bytes=1789) to S17@127.0.0.1:59817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:59817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S14] → sending delta(kind=head bytes=1788) to S2@127.0.0.1:59802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] → sending delta(kind=head bytes=1793) to S10@127.0.0.1:59811
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1785 reason=None
[S13] → sending delta(kind=head bytes=1785) to S14@127.0.0.1:59814
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S14@127.0.0.1:59814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S11] → sending delta(kind=head bytes=1791) to S7@127.0.0.1:59808
[S4] sending update (kind=head size=1793 to 1 peers)
[S3] sending update (kind=head size=1793 to 1 peers)
[S14] sending update (kind=head size=1788 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1789 to 1 peers)
[S13] sending update (kind=head size=1785 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1790 to 1 peers)
[S7] sending update (kind=head size=1784 to 1 peers)
[S16] sending update (kind=head size=1788 to 1 peers)
[S11] sending update (kind=head size=1791 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1784) from S7
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.182116)
[S9] loaded HEAD from S7 (vec_in norm=1.182116)
[S9] cosine check vs S7: cos=0.0233
[S9] BUFFERED delta from S7 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1793) from S3
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.117617)
[S10] loaded HEAD from S3 (vec_in norm=1.117617)
[S10] cosine check vs S3: cos=-0.0101
[S10] DROPPED delta from S3 (cos=-0.0101 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1788) from S14
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.210667)
[S2] loaded HEAD from S14 (vec_in norm=1.210667)
[S2] cosine check vs S14: cos=0.1318
[S2] BUFFERED delta from S14 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1788) from S16
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.205280)
[S10] loaded HEAD from S16 (vec_in norm=1.205280)
[S10] cosine check vs S16: cos=-0.0217
[S10] DROPPED delta from S16 (cos=-0.0217 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1793) from S4
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.216056)
[S14] loaded HEAD from S4 (vec_in norm=1.216056)
[S14] cosine check vs S4: cos=-0.0454
[S14] DROPPED delta from S4 (cos=-0.0454 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1785) from S13
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.220843)
[S14] loaded HEAD from S13 (vec_in norm=1.220843)
[S14] cosine check vs S13: cos=-0.0326
[S14] DROPPED delta from S13 (cos=-0.0326 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1791) from S11
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.189241)
[S7] loaded HEAD from S11 (vec_in norm=1.189241)
[S7] cosine check vs S11: cos=0.0088
[S7] BUFFERED delta from S11 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1795) from S15
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.195771)
[S17] loaded HEAD from S15 (vec_in norm=1.195771)
[S17] cosine check vs S15: cos=-0.0388
[S17] DROPPED delta from S15 (cos=-0.0388 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1796) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.205592)
[S4] loaded HEAD from S6 (vec_in norm=1.205592)
[S4] cosine check vs S6: cos=0.0606
[S4] BUFFERED delta from S6 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1790) from S2
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.238221)
[S11] loaded HEAD from S2 (vec_in norm=1.238221)
[S11] cosine check vs S2: cos=-0.0141
[S11] DROPPED delta from S2 (cos=-0.0141 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1789) from S5
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.210786)
[S17] loaded HEAD from S5 (vec_in norm=1.210786)
[S17] cosine check vs S5: cos=0.1282
[S17] BUFFERED delta from S5 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S17] → sending delta(kind=head bytes=1791) to S8@127.0.0.1:59809
[S17] sending update (kind=head size=1791 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1791) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.272198)
[S8] loaded HEAD from S17 (vec_in norm=1.272198)
[S8] cosine check vs S17: cos=-0.0662
[S8] DROPPED delta from S17 (cos=-0.0662 < 0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=1 metric=0.1414 head_norm=1.165124
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.201871e-01
[S9] stored merged vector for next round verification (round=1)
[S9] DEBUG after merge:  round=1 metric=0.1414 head_norm=0.839494 delta_norm=0.820187
[S9] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=1 metric=0.1418 head_norm=1.238221
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.068170e-01
[S2] stored merged vector for next round verification (round=1)
[S2] DEBUG after merge:  round=1 metric=0.1418 head_norm=0.921140 delta_norm=0.806817
[S2] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=1 metric=0.1402 head_norm=1.216056
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.298514e-01
[S4] stored merged vector for next round verification (round=1)
[S4] DEBUG after merge:  round=1 metric=0.1402 head_norm=0.881742 delta_norm=0.829851
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=1 metric=0.1421 head_norm=1.182116
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.347138e-01
[S7] stored merged vector for next round verification (round=1)
[S7] DEBUG after merge:  round=1 metric=0.1421 head_norm=0.842080 delta_norm=0.834714
[S7] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=1 metric=0.1409 head_norm=1.272198
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.200008e-01
[S17] stored merged vector for next round verification (round=1)
[S17] DEBUG after merge:  round=1 metric=0.1409 head_norm=0.932654 delta_norm=0.820001
[S17] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=0.921140 cos_to_last_merge=1.0000 (last merge round=1)
[S2] round=2 local utility u=0.022477 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6057459821949591, 'loss_val': 1.235936322680672, 'psi': 0.3273646729111237}-{'f1_val': 0.1417771333885667, 'auprc': 0.6057410592532967, 'loss_val': 1.280875775060301, 'psi': 0.3273627037344587}
[S3] START round=2 head_norm_before_train=1.117617 (no previous merge yet)
[S3] round=2 local utility u=0.139044 metrics={'f1_val': 0.4226551239713414, 'auprc': 0.6355828114094173, 'loss_val': 1.295562371503556, 'psi': 0.5078261989465718}-{'f1_val': 0.3993040781804574, 'auprc': 0.6017146469679379, 'loss_val': 1.3319389961559243, 'psi': 0.48026830569544954}
[S4] START round=2 head_norm_before_train=0.881742 cos_to_last_merge=1.0000 (last merge round=1)
[S4] round=2 local utility u=0.847869 metrics={'f1_val': 0.4148091473984988, 'auprc': 0.782955040794776, 'loss_val': 1.2321725769252778, 'psi': 0.5620675047570096}-{'f1_val': 0.14022662889518414, 'auprc': 0.7778802765078446, 'loss_val': 1.2651905772659842, 'psi': 0.39528808794024833}
[S5] START round=2 head_norm_before_train=1.210786 (no previous merge yet)
[S5] round=2 local utility u=0.026071 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7389494385777164, 'loss_val': 1.2764393262108285, 'psi': 0.38093691828822945}-{'f1_val': 0.14226190476190476, 'auprc': 0.7318192065088801, 'loss_val': 1.3071903208915352, 'psi': 0.3780848254606949}
[S6] START round=2 head_norm_before_train=1.205592 (no previous merge yet)
[S6] round=2 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6650215530824255, 'loss_val': 1.1980830811454162, 'psi': 0.3508643904637394}-{'f1_val': 0.14142628205128205, 'auprc': 0.8306140037076453, 'loss_val': 1.3048448487383537, 'psi': 0.41710137071382736}
[S7] START round=2 head_norm_before_train=0.842080 cos_to_last_merge=1.0000 (last merge round=1)
[S7] round=2 local utility u=0.081796 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7862270779018207, 'loss_val': 1.3204769621805554, 'psi': 0.3997249247981833}-{'f1_val': 0.14205682272909165, 'auprc': 0.7321034771801211, 'loss_val': 1.321697536581197, 'psi': 0.37807548450950346}
[S8] START round=2 head_norm_before_train=1.231604 (no previous merge yet)
[S8] round=2 local utility u=0.695094 metrics={'f1_val': 0.4158888197469405, 'auprc': 0.7709603866972989, 'loss_val': 1.1901214176619659, 'psi': 0.5579174465270839}-{'f1_val': 0.20719297778724008, 'auprc': 0.7564386779539349, 'loss_val': 1.284568443278757, 'psi': 0.42689125785391807}
[S9] START round=2 head_norm_before_train=0.839494 cos_to_last_merge=1.0000 (last merge round=1)
[S9] round=2 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8656138684446558, 'loss_val': 1.2947661983972099, 'psi': 0.43108432166185995}-{'f1_val': 0.141397957139996, 'auprc': 0.8664461800754382, 'loss_val': 1.2840997388172892, 'psi': 0.4314172463141729}
[S10] START round=2 head_norm_before_train=1.229289 (no previous merge yet)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.5883897793602344, 'loss_val': 1.1541051688928095, 'psi': 0.3185288942691281}-{'f1_val': 0.13862163754172394, 'auprc': 0.6429181101379008, 'loss_val': 1.2790187968370526, 'psi': 0.3403402265801947}
[S11] START round=2 head_norm_before_train=1.189241 (no previous merge yet)
[S11] round=2 local utility u=0.265130 metrics={'f1_val': 0.28699447113205834, 'auprc': 0.7417062763143671, 'loss_val': 1.3028411992689986, 'psi': 0.46887919320498184}-{'f1_val': 0.23941148759421754, 'auprc': 0.6752884495536464, 'loss_val': 1.3483492385798186, 'psi': 0.41376227237798907}
[S13] START round=2 head_norm_before_train=1.220843 (no previous merge yet)
[S13] round=2 local utility u=0.066734 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5658589434569643, 'loss_val': 1.2347339488067037, 'psi': 0.3105750349290176}-{'f1_val': 0.1403857625770531, 'auprc': 0.5420180923969979, 'loss_val': 1.2966794883204014, 'psi': 0.30103869450503107}
[S14] START round=2 head_norm_before_train=1.210667 (no previous merge yet)
[S14] round=2 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.9084299138758813, 'loss_val': 1.3203317415755622, 'psi': 0.4475866772799748}-{'f1_val': 0.389299219155268, 'auprc': 0.8486331840171867, 'loss_val': 1.3408115695727112, 'psi': 0.5730328051000355}
[S15] START round=2 head_norm_before_train=1.195771 (no previous merge yet)
[S15] round=2 local utility u=0.053141 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7765244551338638, 'loss_val': 1.1888095230225655, 'psi': 0.39444997287048056}-{'f1_val': 0.13973365136155833, 'auprc': 0.7685790657719656, 'loss_val': 1.271254435612685, 'psi': 0.39127181712572123}
[S16] START round=2 head_norm_before_train=1.205280 (no previous merge yet)
[S16] round=2 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7896820698449439, 'loss_val': 1.3071168045397452, 'psi': 0.4002552980574995}-{'f1_val': 0.41609894103363587, 'auprc': 0.7856011019807126, 'loss_val': 1.3378970856017869, 'psi': 0.5638998054124666}
[S17] START round=2 head_norm_before_train=0.932654 cos_to_last_merge=1.0000 (last merge round=1)
[S17] round=2 local utility u=0.013785 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5467536652938914, 'loss_val': 1.2492938431191756, 'psi': 0.3032708441079872}-{'f1_val': 0.14094896331738438, 'auprc': 0.5582689951554013, 'loss_val': 1.3114089399449615, 'psi': 0.3078769760525911}
[S3] not sending this round → trigger blocked (psi=0.508)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:59815
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.469)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.311)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.400)
[S5] not sending this round → trigger blocked (psi=0.381)
[S4] not sending this round → trigger blocked (psi=0.562)
[S2] not sending this round → trigger blocked (psi=0.327)
[S15] not sending this round → trigger blocked (psi=0.394)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1793 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1793) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.286761)
[S15] loaded HEAD from S8 (vec_in norm=1.286761)
[S15] cosine check vs S8: cos=-0.0303
[S15] DROPPED delta from S8 (cos=-0.0303 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.303)
[S2] START round=3 head_norm_before_train=0.963223 cos_to_last_merge=0.9943 (last merge round=1)
[S2] round=3 local utility u=0.289835 metrics={'f1_val': 0.1674003423820005, 'auprc': 0.7088600789371993, 'loss_val': 1.1193474758084263, 'psi': 0.38398423700408}-{'f1_val': 0.1417771333885667, 'auprc': 0.6057459821949591, 'loss_val': 1.235936322680672, 'psi': 0.3273646729111237}
[S3] START round=3 head_norm_before_train=1.141151 (no previous merge yet)
[S3] round=3 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8169530791049483, 'loss_val': 1.2447889084392145, 'psi': 0.4106852710104436}-{'f1_val': 0.4226551239713414, 'auprc': 0.6355828114094173, 'loss_val': 1.295562371503556, 'psi': 0.5078261989465718}
[S4] START round=3 head_norm_before_train=0.926365 cos_to_last_merge=0.9928 (last merge round=1)
[S4] round=3 local utility u=0.106862 metrics={'f1_val': 0.4120909458574801, 'auprc': 0.7839808501986901, 'loss_val': 1.0052162417083779, 'psi': 0.5608469075939642}-{'f1_val': 0.4148091473984988, 'auprc': 0.782955040794776, 'loss_val': 1.2321725769252778, 'psi': 0.5620675047570096}
[S5] START round=3 head_norm_before_train=1.231756 (no previous merge yet)
[S5] round=3 local utility u=0.049059 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7596906628760973, 'loss_val': 1.240545465070223, 'psi': 0.3892334080075818}-{'f1_val': 0.14226190476190476, 'auprc': 0.7389494385777164, 'loss_val': 1.2764393262108285, 'psi': 0.38093691828822945}
[S6] START round=3 head_norm_before_train=1.262789 (no previous merge yet)
[S6] round=3 local utility u=0.891360 metrics={'f1_val': 0.4166544795555117, 'auprc': 0.6533434415173743, 'loss_val': 1.0316986652951872, 'psi': 0.5113300643402567}-{'f1_val': 0.14142628205128205, 'auprc': 0.6650215530824255, 'loss_val': 1.1980830811454162, 'psi': 0.3508643904637394}
[S7] START round=3 head_norm_before_train=0.858807 cos_to_last_merge=0.9971 (last merge round=1)
[S7] round=3 local utility u=0.022852 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7866792560945268, 'loss_val': 1.2761292225214609, 'psi': 0.3999057960752657}-{'f1_val': 0.14205682272909165, 'auprc': 0.7862270779018207, 'loss_val': 1.3204769621805554, 'psi': 0.3997249247981833}
[S8] START round=3 head_norm_before_train=1.286761 (no previous merge yet)
[S8] round=3 local utility u=0.117218 metrics={'f1_val': 0.41632552871207484, 'auprc': 0.7710455247517534, 'loss_val': 0.9585617860260742, 'psi': 0.5582135271279463}-{'f1_val': 0.4158888197469405, 'auprc': 0.7709603866972989, 'loss_val': 1.1901214176619659, 'psi': 0.5579174465270839}
[S9] START round=3 head_norm_before_train=0.860154 cos_to_last_merge=0.9961 (last merge round=1)
[S9] round=3 local utility u=0.029502 metrics={'f1_val': 0.141397957139996, 'auprc': 0.865704299134841, 'loss_val': 1.2360343125647584, 'psi': 0.43112049393793406}-{'f1_val': 0.141397957139996, 'auprc': 0.8656138684446558, 'loss_val': 1.2947661983972099, 'psi': 0.43108432166185995}
[S10] START round=3 head_norm_before_train=1.286945 (no previous merge yet)
[S10] round=3 local utility u=1.000000 metrics={'f1_val': 0.4364405736041273, 'auprc': 0.6548238970853351, 'loss_val': 0.9338408669234659, 'psi': 0.5237939029966104}-{'f1_val': 0.13862163754172394, 'auprc': 0.5883897793602344, 'loss_val': 1.1541051688928095, 'psi': 0.3185288942691281}
[S11] START round=3 head_norm_before_train=1.209097 (no previous merge yet)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7435617459115175, 'loss_val': 1.2415292879433992, 'psi': 0.38167290838847334}-{'f1_val': 0.28699447113205834, 'auprc': 0.7417062763143671, 'loss_val': 1.3028411992689986, 'psi': 0.46887919320498184}
[S13] START round=3 head_norm_before_train=1.267368 (no previous merge yet)
[S13] round=3 local utility u=0.898263 metrics={'f1_val': 0.41643344272875704, 'auprc': 0.5561605488897222, 'loss_val': 1.0653988080684587, 'psi': 0.4723242851931431}-{'f1_val': 0.1403857625770531, 'auprc': 0.5658589434569643, 'loss_val': 1.2347339488067037, 'psi': 0.3105750349290176}
[S14] START round=3 head_norm_before_train=1.225243 (no previous merge yet)
[S14] round=3 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8916235079878103, 'loss_val': 1.294797156525887, 'psi': 0.4408641149247464}-{'f1_val': 0.14035785288270378, 'auprc': 0.9084299138758813, 'loss_val': 1.3203317415755622, 'psi': 0.4475866772799748}
[S15] START round=3 head_norm_before_train=1.256658 (no previous merge yet)
[S15] round=3 local utility u=0.959890 metrics={'f1_val': 0.416567672447929, 'auprc': 0.8000381700867885, 'loss_val': 1.0005752915551345, 'psi': 0.5699558715034728}-{'f1_val': 0.13973365136155833, 'auprc': 0.7765244551338638, 'loss_val': 1.1888095230225655, 'psi': 0.39444997287048056}
[S16] START round=3 head_norm_before_train=1.226726 (no previous merge yet)
[S16] round=3 local utility u=0.032929 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7980795480971739, 'loss_val': 1.2664512785062656, 'psi': 0.4036142893583915}-{'f1_val': 0.14063745019920318, 'auprc': 0.7896820698449439, 'loss_val': 1.3071168045397452, 'psi': 0.4002552980574995}
[S17] START round=3 head_norm_before_train=0.970230 cos_to_last_merge=0.9920 (last merge round=1)
[S17] round=3 local utility u=0.094919 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5514191073774943, 'loss_val': 1.0734531568993622, 'psi': 0.30513702094142836}-{'f1_val': 0.14094896331738438, 'auprc': 0.5467536652938914, 'loss_val': 1.2492938431191756, 'psi': 0.3032708441079872}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S15] → sending delta(kind=head bytes=1789) to S14@127.0.0.1:59814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:59814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S2] → sending delta(kind=head bytes=1791) to S6@127.0.0.1:59807
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:59810
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S16] → sending delta(kind=head bytes=1788) to S4@127.0.0.1:59804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:59805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:59815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:59804
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.558)
[S4] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S16] sending update (kind=head size=1788 to 1 peers)
[S13] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1791 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1789 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1800) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.892334)
[S14] loaded HEAD from S9 (vec_in norm=0.892334)
[S14] cosine check vs S9: cos=0.1967
[S14] BUFFERED delta from S9 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1788) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.257180)
[S4] loaded HEAD from S16 (vec_in norm=1.257180)
[S4] cosine check vs S16: cos=-0.0373
[S4] DROPPED delta from S16 (cos=-0.0373 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1791) from S2
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.010277)
[S6] loaded HEAD from S2 (vec_in norm=1.010277)
[S6] cosine check vs S2: cos=0.0328
[S6] BUFFERED delta from S2 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1797) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.884783)
[S6] loaded HEAD from S7 (vec_in norm=0.884783)
[S6] cosine check vs S7: cos=-0.0152
[S6] DROPPED delta from S7 (cos=-0.0152 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1803) from S6
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.324326)
[S15] loaded HEAD from S6 (vec_in norm=1.324326)
[S15] cosine check vs S6: cos=-0.0390
[S15] DROPPED delta from S6 (cos=-0.0390 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1803) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.350823)
[S4] loaded HEAD from S10 (vec_in norm=1.350823)
[S4] cosine check vs S10: cos=-0.0209
[S4] DROPPED delta from S10 (cos=-0.0209 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1801) from S4
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.997494)
[S5] loaded HEAD from S4 (vec_in norm=0.997494)
[S5] cosine check vs S4: cos=0.0043
[S5] BUFFERED delta from S4 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1794) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.257411)
[S9] loaded HEAD from S5 (vec_in norm=1.257411)
[S9] cosine check vs S5: cos=0.0646
[S9] BUFFERED delta from S5 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1789) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.309309)
[S14] loaded HEAD from S15 (vec_in norm=1.309309)
[S14] cosine check vs S15: cos=-0.0164
[S14] DROPPED delta from S15 (cos=-0.0164 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1795) from S13
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.332614)
[S9] loaded HEAD from S13 (vec_in norm=1.332614)
[S9] cosine check vs S13: cos=0.1043
[S9] BUFFERED delta from S13 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S17] → sending delta(kind=head bytes=1789) to S5@127.0.0.1:59805
[S17] sending update (kind=head size=1789 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1789) from S17
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.021926)
[S5] loaded HEAD from S17 (vec_in norm=1.021926)
[S5] cosine check vs S17: cos=0.6768
[S5] BUFFERED delta from S17 (total buffered=2)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=3 metric=0.1404 head_norm=1.248779
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.923269e-01
[S14] stored merged vector for next round verification (round=3)
[S14] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.835786 delta_norm=0.692327
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=3 metric=0.4167 head_norm=1.324326
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.195534e-01
[S6] stored merged vector for next round verification (round=3)
[S6] DEBUG after merge:  round=3 metric=0.2885 head_norm=0.845920 delta_norm=0.819553
[S6] aggregate: ROLLBACK (f1_val pre=0.417 post=0.288 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=3 metric=0.1423 head_norm=1.257411
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.429356e-01
[S5] stored merged vector for next round verification (round=3)
[S5] DEBUG after merge:  round=3 metric=0.1423 head_norm=0.855737 delta_norm=0.542936
[S5] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=3 metric=0.1414 head_norm=0.892334
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.019236e-01
[S9] stored merged vector for next round verification (round=3)
[S9] DEBUG after merge:  round=3 metric=0.1414 head_norm=0.678659 delta_norm=0.601924
[S9] aggregate: ACCEPT kept=['S5', 'S13'] (k=2/2) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=1.010277 cos_to_last_merge=0.9823 (last merge round=1)
[S2] round=4 local utility u=1.000000 metrics={'f1_val': 0.7126000571064917, 'auprc': 0.7772637601414826, 'loss_val': 0.857829750634881, 'psi': 0.7384655383204881}-{'f1_val': 0.1674003423820005, 'auprc': 0.7088600789371993, 'loss_val': 1.1193474758084263, 'psi': 0.38398423700408}
[S3] START round=4 head_norm_before_train=1.173449 (no previous merge yet)
[S3] round=4 local utility u=0.030628 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8170554589378751, 'loss_val': 1.1838409591009622, 'psi': 0.41072622294361427}-{'f1_val': 0.13984006561410703, 'auprc': 0.8169530791049483, 'loss_val': 1.2447889084392145, 'psi': 0.4106852710104436}
[S4] START round=4 head_norm_before_train=0.997494 cos_to_last_merge=0.9736 (last merge round=1)
[S4] round=4 local utility u=0.000000 metrics={'f1_val': 0.4045227176790248, 'auprc': 0.66148757500678, 'loss_val': 0.7544961907125497, 'psi': 0.5073086606101269}-{'f1_val': 0.4120909458574801, 'auprc': 0.7839808501986901, 'loss_val': 1.0052162417083779, 'psi': 0.5608469075939642}
[S5] START round=4 head_norm_before_train=0.855737 cos_to_last_merge=1.0000 (last merge round=3)
[S5] round=4 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7510841558542776, 'loss_val': 1.231616779471655, 'psi': 0.3857908051988539}-{'f1_val': 0.14226190476190476, 'auprc': 0.7596906628760973, 'loss_val': 1.240545465070223, 'psi': 0.3892334080075818}
[S6] START round=4 head_norm_before_train=0.845920 cos_to_last_merge=1.0000 (last merge round=3)
[S6] round=4 local utility u=0.208543 metrics={'f1_val': 0.4168551858772006, 'auprc': 0.770419457338344, 'loss_val': 0.9670442295873778, 'psi': 0.558280894461658}-{'f1_val': 0.4166544795555117, 'auprc': 0.6533434415173743, 'loss_val': 1.0316986652951872, 'psi': 0.5113300643402567}
[S7] START round=4 head_norm_before_train=0.884783 cos_to_last_merge=0.9888 (last merge round=1)
[S7] round=4 local utility u=0.019665 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7928071014097866, 'loss_val': 1.255182288026862, 'psi': 0.40235693420136964}-{'f1_val': 0.14205682272909165, 'auprc': 0.7866792560945268, 'loss_val': 1.2761292225214609, 'psi': 0.3999057960752657}
[S8] START round=4 head_norm_before_train=1.358867 (no previous merge yet)
[S8] round=4 local utility u=0.282004 metrics={'f1_val': 0.3728657005221765, 'auprc': 0.9877425034238106, 'loss_val': 0.7838867180901955, 'psi': 0.6188164216828302}-{'f1_val': 0.41632552871207484, 'auprc': 0.7710455247517534, 'loss_val': 0.9585617860260742, 'psi': 0.5582135271279463}
[S9] START round=4 head_norm_before_train=0.678659 cos_to_last_merge=1.0000 (last merge round=3)
[S9] round=4 local utility u=0.002821 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8656271867552034, 'loss_val': 1.2301613364198578, 'psi': 0.431089648986079}-{'f1_val': 0.141397957139996, 'auprc': 0.865704299134841, 'loss_val': 1.2360343125647584, 'psi': 0.43112049393793406}
[S10] START round=4 head_norm_before_train=1.350823 (no previous merge yet)
[S10] round=4 local utility u=1.000000 metrics={'f1_val': 0.6902197428046895, 'auprc': 0.8560543435011398, 'loss_val': 0.6845564586663447, 'psi': 0.7565535830832696}-{'f1_val': 0.4364405736041273, 'auprc': 0.6548238970853351, 'loss_val': 0.9338408669234659, 'psi': 0.5237939029966104}
[S11] START round=4 head_norm_before_train=1.237967 (no previous merge yet)
[S11] round=4 local utility u=0.046275 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7537543850125752, 'loss_val': 1.1795575291645966, 'psi': 0.38574996402889644}-{'f1_val': 0.14041368337311058, 'auprc': 0.7435617459115175, 'loss_val': 1.2415292879433992, 'psi': 0.38167290838847334}
[S13] START round=4 head_norm_before_train=1.332614 (no previous merge yet)
[S13] round=4 local utility u=0.401383 metrics={'f1_val': 0.4160038662657951, 'auprc': 0.7349291318159233, 'loss_val': 0.7963603397686762, 'psi': 0.5435739724858464}-{'f1_val': 0.41643344272875704, 'auprc': 0.5561605488897222, 'loss_val': 1.0653988080684587, 'psi': 0.4723242851931431}
[S14] START round=4 head_norm_before_train=0.835786 cos_to_last_merge=1.0000 (last merge round=3)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7911860004828417, 'loss_val': 1.306401558723792, 'psi': 0.40068911192275897}-{'f1_val': 0.14035785288270378, 'auprc': 0.8916235079878103, 'loss_val': 1.294797156525887, 'psi': 0.4408641149247464}
[S15] START round=4 head_norm_before_train=1.309309 (no previous merge yet)
[S15] round=4 local utility u=1.000000 metrics={'f1_val': 0.7075938727426347, 'auprc': 0.7998293550719044, 'loss_val': 0.7058571227533933, 'psi': 0.7444880656743427}-{'f1_val': 0.416567672447929, 'auprc': 0.8000381700867885, 'loss_val': 1.0005752915551345, 'psi': 0.5699558715034728}
[S16] START round=4 head_norm_before_train=1.257180 (no previous merge yet)
[S16] round=4 local utility u=0.020346 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7943575060308422, 'loss_val': 1.214594058738511, 'psi': 0.4021254725318588}-{'f1_val': 0.14063745019920318, 'auprc': 0.7980795480971739, 'loss_val': 1.2664512785062656, 'psi': 0.4036142893583915}
[S17] START round=4 head_norm_before_train=1.021926 cos_to_last_merge=0.9738 (last merge round=1)
[S17] round=4 local utility u=0.872991 metrics={'f1_val': 0.3909269062963138, 'auprc': 0.5998719983109999, 'loss_val': 0.9726970102191056, 'psi': 0.47450494310218827}-{'f1_val': 0.14094896331738438, 'auprc': 0.5514191073774943, 'loss_val': 1.0734531568993622, 'psi': 0.30513702094142836}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.402)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:59807
[S16] not sending this round → trigger blocked (psi=0.402)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:59802
[S6] not sending this round → trigger blocked (psi=0.558)
[S2] not sending this round → trigger blocked (psi=0.738)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:59810
[S13] not sending this round → trigger blocked (psi=0.544)
[S9] not sending this round → trigger blocked (psi=0.431)
[S15] not sending this round → trigger blocked (psi=0.744)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.757)
[S11] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1796) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.265524)
[S9] loaded HEAD from S11 (vec_in norm=1.265524)
[S9] cosine check vs S11: cos=0.0198
[S9] BUFFERED delta from S11 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1795) from S3
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.208875)
[S2] loaded HEAD from S3 (vec_in norm=1.208875)
[S2] cosine check vs S3: cos=-0.0047
[S2] DROPPED delta from S3 (cos=-0.0047 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1796) from S8
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.427527)
[S6] loaded HEAD from S8 (vec_in norm=1.427527)
[S6] cosine check vs S8: cos=-0.0826
[S6] DROPPED delta from S8 (cos=-0.0826 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.475)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=4 metric=0.1414 head_norm=0.711894
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.198461e-01
[S9] stored merged vector for next round verification (round=4)
[S9] DEBUG after merge:  round=4 metric=0.1414 head_norm=0.732116 delta_norm=0.719846
[S9] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=1.073002 cos_to_last_merge=0.9631 (last merge round=1)
[S2] round=5 local utility u=0.000000 metrics={'f1_val': 0.6998516911365366, 'auprc': 0.6986229103461017, 'loss_val': 0.6625428386410541, 'psi': 0.6993601788203626}-{'f1_val': 0.7126000571064917, 'auprc': 0.7772637601414826, 'loss_val': 0.857829750634881, 'psi': 0.7384655383204881}
[S3] START round=5 head_norm_before_train=1.208875 (no previous merge yet)
[S3] round=5 local utility u=0.186542 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9029060992361666, 'loss_val': 1.0683087622491536, 'psi': 0.44506647906293084}-{'f1_val': 0.13984006561410703, 'auprc': 0.8170554589378751, 'loss_val': 1.1838409591009622, 'psi': 0.41072622294361427}
[S4] START round=5 head_norm_before_train=1.068411 cos_to_last_merge=0.9529 (last merge round=1)
[S4] round=5 local utility u=0.422877 metrics={'f1_val': 0.43649768000596756, 'auprc': 0.8320454132816079, 'loss_val': 0.6122660191541939, 'psi': 0.5947167733162237}-{'f1_val': 0.4045227176790248, 'auprc': 0.66148757500678, 'loss_val': 0.7544961907125497, 'psi': 0.5073086606101269}
[S5] START round=5 head_norm_before_train=0.889811 cos_to_last_merge=0.9981 (last merge round=3)
[S5] round=5 local utility u=0.052651 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7707483464412624, 'loss_val': 1.1853072769452742, 'psi': 0.39365648143364784}-{'f1_val': 0.14226190476190476, 'auprc': 0.7510841558542776, 'loss_val': 1.231616779471655, 'psi': 0.3857908051988539}
[S6] START round=5 head_norm_before_train=0.913913 cos_to_last_merge=0.9927 (last merge round=3)
[S6] round=5 local utility u=0.750967 metrics={'f1_val': 0.5897575500449785, 'auprc': 0.8323579179256427, 'loss_val': 0.6883393731091422, 'psi': 0.6867976971972443}-{'f1_val': 0.4168551858772006, 'auprc': 0.770419457338344, 'loss_val': 0.9670442295873778, 'psi': 0.558280894461658}
[S7] START round=5 head_norm_before_train=0.900554 cos_to_last_merge=0.9823 (last merge round=1)
[S7] round=5 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.784656520909905, 'loss_val': 1.240392754562137, 'psi': 0.399096702001417}-{'f1_val': 0.14205682272909165, 'auprc': 0.7928071014097866, 'loss_val': 1.255182288026862, 'psi': 0.40235693420136964}
[S8] START round=5 head_norm_before_train=1.427527 (no previous merge yet)
[S8] round=5 local utility u=0.029174 metrics={'f1_val': 0.3729316501988709, 'auprc': 0.9583953899759631, 'loss_val': 0.6378934827671567, 'psi': 0.6071171461097078}-{'f1_val': 0.3728657005221765, 'auprc': 0.9877425034238106, 'loss_val': 0.7838867180901955, 'psi': 0.6188164216828302}
[S9] START round=5 head_norm_before_train=0.732116 cos_to_last_merge=1.0000 (last merge round=4)
[S9] round=5 local utility u=0.012808 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8652770366731368, 'loss_val': 1.203494750142798, 'psi': 0.43094958895325236}-{'f1_val': 0.141397957139996, 'auprc': 0.8656271867552034, 'loss_val': 1.2301613364198578, 'psi': 0.431089648986079}
[S10] START round=5 head_norm_before_train=1.437199 (no previous merge yet)
[S10] round=5 local utility u=0.169370 metrics={'f1_val': 0.7005376949864333, 'auprc': 0.8753045862571478, 'loss_val': 0.46547589834803943, 'psi': 0.7704444514947191}-{'f1_val': 0.6902197428046895, 'auprc': 0.8560543435011398, 'loss_val': 0.6845564586663447, 'psi': 0.7565535830832696}
[S11] START round=5 head_norm_before_train=1.265524 (no previous merge yet)
[S11] round=5 local utility u=0.066086 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7672266239749745, 'loss_val': 1.0878025918917744, 'psi': 0.3911388596138562}-{'f1_val': 0.14041368337311058, 'auprc': 0.7537543850125752, 'loss_val': 1.1795575291645966, 'psi': 0.38574996402889644}
[S13] START round=5 head_norm_before_train=1.403846 (no previous merge yet)
[S13] round=5 local utility u=0.978071 metrics={'f1_val': 0.7116411800817113, 'auprc': 0.7497048032780331, 'loss_val': 0.6583688970542837, 'psi': 0.72686662936024}-{'f1_val': 0.4160038662657951, 'auprc': 0.7349291318159233, 'loss_val': 0.7963603397686762, 'psi': 0.5435739724858464}
[S14] START round=5 head_norm_before_train=0.860355 cos_to_last_merge=0.9974 (last merge round=3)
[S14] round=5 local utility u=0.093471 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.84047391142372, 'loss_val': 1.267323922504491, 'psi': 0.42040427629911026}-{'f1_val': 0.14035785288270378, 'auprc': 0.7911860004828417, 'loss_val': 1.306401558723792, 'psi': 0.40068911192275897}
[S15] START round=5 head_norm_before_train=1.381592 (no previous merge yet)
[S15] round=5 local utility u=0.000000 metrics={'f1_val': 0.6945942531326492, 'auprc': 0.7608171806635331, 'loss_val': 0.6272442442046515, 'psi': 0.7210834241450028}-{'f1_val': 0.7075938727426347, 'auprc': 0.7998293550719044, 'loss_val': 0.7058571227533933, 'psi': 0.7444880656743427}
[S16] START round=5 head_norm_before_train=1.292523 (no previous merge yet)
[S16] round=5 local utility u=0.760282 metrics={'f1_val': 0.41467924219943564, 'auprc': 0.7288482413914129, 'loss_val': 1.1417536586762354, 'psi': 0.5403468418762265}-{'f1_val': 0.14063745019920318, 'auprc': 0.7943575060308422, 'loss_val': 1.214594058738511, 'psi': 0.4021254725318588}
[S17] START round=5 head_norm_before_train=1.086908 cos_to_last_merge=0.9496 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.950
[S17] round=5 local utility u=0.106921 metrics={'f1_val': 0.35273268957802617, 'auprc': 0.7228758102831989, 'loss_val': 0.8987002020145247, 'psi': 0.5007899378600953}-{'f1_val': 0.3909269062963138, 'auprc': 0.5998719983109999, 'loss_val': 0.9726970102191056, 'psi': 0.47450494310218827}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] → sending delta(kind=head bytes=1792) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:59804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:59814
[S3] not sending this round → trigger blocked (psi=0.445)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] → sending delta(kind=head bytes=1793) to S11@127.0.0.1:59812
[S11] not sending this round → trigger blocked (psi=0.391)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:59805
[S8] not sending this round → trigger blocked (psi=0.607)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:59804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:59815
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1793 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1792 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1799) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.518187)
[S4] loaded HEAD from S10 (vec_in norm=1.518187)
[S4] cosine check vs S10: cos=-0.0201
[S4] DROPPED delta from S10 (cos=-0.0201 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1793) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.895788)
[S11] loaded HEAD from S14 (vec_in norm=0.895788)
[S11] cosine check vs S14: cos=-0.0016
[S11] DROPPED delta from S14 (cos=-0.0016 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1797) from S6
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.998213)
[S15] loaded HEAD from S6 (vec_in norm=0.998213)
[S15] cosine check vs S6: cos=0.0039
[S15] BUFFERED delta from S6 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1800) from S13
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.464228)
[S9] loaded HEAD from S13 (vec_in norm=1.464228)
[S9] cosine check vs S13: cos=0.1898
[S9] BUFFERED delta from S13 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1795) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.758028)
[S14] loaded HEAD from S9 (vec_in norm=0.758028)
[S14] cosine check vs S9: cos=0.2402
[S14] BUFFERED delta from S9 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1795) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.331700)
[S4] loaded HEAD from S16 (vec_in norm=1.331700)
[S4] cosine check vs S16: cos=-0.0253
[S4] DROPPED delta from S16 (cos=-0.0253 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1792) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.917644)
[S9] loaded HEAD from S5 (vec_in norm=0.917644)
[S9] cosine check vs S5: cos=0.3087
[S9] BUFFERED delta from S5 (total buffered=2)
[S5] RECEIVED delta(kind=head bytes=1801) from S4
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.164537)
[S5] loaded HEAD from S4 (vec_in norm=1.164537)
[S5] cosine check vs S4: cos=0.2416
[S5] BUFFERED delta from S4 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S17] → sending delta(kind=head bytes=1792) to S5@127.0.0.1:59805
[S17] sending update (kind=head size=1792 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1792) from S17
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.160491)
[S5] loaded HEAD from S17 (vec_in norm=1.160491)
[S5] cosine check vs S17: cos=0.7175
[S5] BUFFERED delta from S17 (total buffered=2)
[S8] ⇄ pheromone p=0.465 → S6@127.0.0.1:59807
[S7] ⇄ pheromone p=0.380 → S6@127.0.0.1:59807
[S11] ⇄ pheromone p=0.423 → S9@127.0.0.1:59810
[S2] ⇄ pheromone p=0.532 → S6@127.0.0.1:59807
[S3] ⇄ pheromone p=0.460 → S2@127.0.0.1:59802
[S16] ⇄ pheromone p=0.565 → S4@127.0.0.1:59804
[S10] ⇄ pheromone p=0.650 → S4@127.0.0.1:59804
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=5 metric=0.1414 head_norm=0.758028
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.768168e-01
[S9] stored merged vector for next round verification (round=5)
[S9] DEBUG after merge:  round=5 metric=0.1414 head_norm=0.663373 delta_norm=0.476817
[S9] aggregate: ACCEPT kept=['S13', 'S5'] (k=2/2) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.334 → S14@127.0.0.1:59814
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=5 metric=0.1404 head_norm=0.895788
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.125487e-01
[S14] stored merged vector for next round verification (round=5)
[S14] DEBUG after merge:  round=5 metric=0.1404 head_norm=0.652545 delta_norm=0.512549
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.428 → S11@127.0.0.1:59812
[S13] ⇄ pheromone p=0.714 → S9@127.0.0.1:59810
[S4] ⇄ pheromone p=0.516 → S5@127.0.0.1:59805
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=5 metric=0.1423 head_norm=0.917644
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.341314e-01
[S5] stored merged vector for next round verification (round=5)
[S5] DEBUG after merge:  round=5 metric=0.1423 head_norm=0.789143 delta_norm=0.334131
[S5] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.347 → S9@127.0.0.1:59810
[S6] ⇄ pheromone p=0.671 → S15@127.0.0.1:59815
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=5 metric=0.6946 head_norm=1.445914
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.768849e-01
[S15] stored merged vector for next round verification (round=5)
[S15] DEBUG after merge:  round=5 metric=0.6012 head_norm=0.880125 delta_norm=0.876885
[S15] aggregate: ROLLBACK (f1_val pre=0.695 post=0.601 tol_abs=0.005 tol_rel=0.0)
[S15] ⇄ pheromone p=0.619 → S14@127.0.0.1:59814
[S17] ⇄ pheromone p=0.510 → S5@127.0.0.1:59805
[S2] START round=6 head_norm_before_train=1.149326 cos_to_last_merge=0.9376 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.938
[S2] round=6 local utility u=0.168918 metrics={'f1_val': 0.7064348163147742, 'auprc': 0.7757068883355347, 'loss_val': 0.5954583759024283, 'psi': 0.7341436451230785}-{'f1_val': 0.6998516911365366, 'auprc': 0.6986229103461017, 'loss_val': 0.6625428386410541, 'psi': 0.6993601788203626}
[S3] START round=6 head_norm_before_train=1.242078 (no previous merge yet)
[S3] round=6 local utility u=1.000000 metrics={'f1_val': 0.69982954919712, 'auprc': 0.9973577686060711, 'loss_val': 0.9151173399553642, 'psi': 0.8188408369607005}-{'f1_val': 0.13984006561410703, 'auprc': 0.9029060992361666, 'loss_val': 1.0683087622491536, 'psi': 0.44506647906293084}
[S4] START round=6 head_norm_before_train=1.164537 cos_to_last_merge=0.9249 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.925
[S4] round=6 local utility u=0.556336 metrics={'f1_val': 0.6823206856328985, 'auprc': 0.6645334002159287, 'loss_val': 0.4719957472724518, 'psi': 0.6752057714661106}-{'f1_val': 0.43649768000596756, 'auprc': 0.8320454132816079, 'loss_val': 0.6122660191541939, 'psi': 0.5947167733162237}
[S5] START round=6 head_norm_before_train=0.789143 cos_to_last_merge=1.0000 (last merge round=5)
[S5] round=6 local utility u=0.109591 metrics={'f1_val': 0.17094914646680787, 'auprc': 0.7745100858130671, 'loss_val': 1.1495332382686743, 'psi': 0.41237352220531154}-{'f1_val': 0.14226190476190476, 'auprc': 0.7707483464412624, 'loss_val': 1.1853072769452742, 'psi': 0.39365648143364784}
[S6] START round=6 head_norm_before_train=0.998213 cos_to_last_merge=0.9718 (last merge round=3)
[S6] round=6 local utility u=0.094025 metrics={'f1_val': 0.61939393928922, 'auprc': 0.7942361177259565, 'loss_val': 0.5637420538709478, 'psi': 0.6893308106639147}-{'f1_val': 0.5897575500449785, 'auprc': 0.8323579179256427, 'loss_val': 0.6883393731091422, 'psi': 0.6867976971972443}
[S7] START round=6 head_norm_before_train=0.909449 cos_to_last_merge=0.9778 (last merge round=1)
[S7] round=6 local utility u=0.003971 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7778136078764735, 'loss_val': 1.2119221835971954, 'psi': 0.3963595367880444}-{'f1_val': 0.14205682272909165, 'auprc': 0.784656520909905, 'loss_val': 1.240392754562137, 'psi': 0.399096702001417}
[S8] START round=6 head_norm_before_train=1.493175 (no previous merge yet)
[S8] round=6 local utility u=1.000000 metrics={'f1_val': 0.6889879416535731, 'auprc': 0.9959162774728145, 'loss_val': 0.47925341205376804, 'psi': 0.8117592759812697}-{'f1_val': 0.3729316501988709, 'auprc': 0.9583953899759631, 'loss_val': 0.6378934827671567, 'psi': 0.6071171461097078}
[S9] START round=6 head_norm_before_train=0.663373 cos_to_last_merge=1.0000 (last merge round=5)
[S9] round=6 local utility u=0.024720 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8644943154905013, 'loss_val': 1.1517075172986937, 'psi': 0.43063650048019814}-{'f1_val': 0.141397957139996, 'auprc': 0.8652770366731368, 'loss_val': 1.203494750142798, 'psi': 0.43094958895325236}
[S10] START round=6 head_norm_before_train=1.518187 (no previous merge yet)
[S10] round=6 local utility u=0.226893 metrics={'f1_val': 0.6889680379787774, 'auprc': 0.9974943816534335, 'loss_val': 0.30884229774038957, 'psi': 0.8123785754486399}-{'f1_val': 0.7005376949864333, 'auprc': 0.8753045862571478, 'loss_val': 0.46547589834803943, 'psi': 0.7704444514947191}
[S11] START round=6 head_norm_before_train=1.294886 (no previous merge yet)
[S11] round=6 local utility u=1.000000 metrics={'f1_val': 0.39651855440916606, 'auprc': 0.9981965005730659, 'loss_val': 0.9694472486020999, 'psi': 0.637189732874726}-{'f1_val': 0.14041368337311058, 'auprc': 0.7672266239749745, 'loss_val': 1.0878025918917744, 'psi': 0.3911388596138562}
[S13] START round=6 head_norm_before_train=1.464228 (no previous merge yet)
[S13] round=6 local utility u=0.065399 metrics={'f1_val': 0.7124345433715253, 'auprc': 0.7457475302647358, 'loss_val': 0.5204591532700343, 'psi': 0.7257597381288095}-{'f1_val': 0.7116411800817113, 'auprc': 0.7497048032780331, 'loss_val': 0.6583688970542837, 'psi': 0.72686662936024}
[S14] START round=6 head_norm_before_train=0.652545 cos_to_last_merge=1.0000 (last merge round=5)
[S14] round=6 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7905952588062445, 'loss_val': 1.261040648645454, 'psi': 0.40045281525212006}-{'f1_val': 0.14035785288270378, 'auprc': 0.84047391142372, 'loss_val': 1.267323922504491, 'psi': 0.42040427629911026}
[S15] START round=6 head_norm_before_train=0.880125 cos_to_last_merge=1.0000 (last merge round=5)
[S15] round=6 local utility u=0.150544 metrics={'f1_val': 0.6977395583968921, 'auprc': 0.8317859954323157, 'loss_val': 0.5579338381759432, 'psi': 0.7513581332110615}-{'f1_val': 0.6945942531326492, 'auprc': 0.7608171806635331, 'loss_val': 0.6272442442046515, 'psi': 0.7210834241450028}
[S16] START round=6 head_norm_before_train=1.331700 (no previous merge yet)
[S16] round=6 local utility u=0.092633 metrics={'f1_val': 0.4175015313869336, 'auprc': 0.7396120930324036, 'loss_val': 1.0057120107901778, 'psi': 0.5463457560451216}-{'f1_val': 0.41467924219943564, 'auprc': 0.7288482413914129, 'loss_val': 1.1417536586762354, 'psi': 0.5403468418762265}
[S17] START round=6 head_norm_before_train=1.160491 cos_to_last_merge=0.9224 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.922
[S17] round=6 local utility u=0.237006 metrics={'f1_val': 0.5081494792077106, 'auprc': 0.5804100972192834, 'loss_val': 0.9297913677074439, 'psi': 0.5370537264123397}-{'f1_val': 0.35273268957802617, 'auprc': 0.7228758102831989, 'loss_val': 0.8987002020145247, 'psi': 0.5007899378600953}
[S13] not sending this round → trigger blocked (psi=0.726)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:59802
[S10] not sending this round → trigger blocked (psi=0.812)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:59807
[S9] not sending this round → trigger blocked (psi=0.431)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:59807
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.546)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:59814
[S4] not sending this round → trigger blocked (psi=0.675)
[S6] not sending this round → trigger blocked (psi=0.689)
[S5] not sending this round → trigger blocked (psi=0.412)
[S2] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1793 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1794 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1797) from S8
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.554191)
[S6] loaded HEAD from S8 (vec_in norm=1.554191)
[S6] cosine check vs S8: cos=-0.1220
[S6] DROPPED delta from S8 (cos=-0.1220 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1797) from S3
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.276166)
[S2] loaded HEAD from S3 (vec_in norm=1.276166)
[S2] cosine check vs S3: cos=-0.0036
[S2] DROPPED delta from S3 (cos=-0.0036 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1793) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.323438)
[S9] loaded HEAD from S11 (vec_in norm=1.323438)
[S9] cosine check vs S11: cos=0.4626
[S9] BUFFERED delta from S11 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1794) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.954971)
[S14] loaded HEAD from S15 (vec_in norm=0.954971)
[S14] cosine check vs S15: cos=0.0797
[S14] BUFFERED delta from S15 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1801) from S2
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.220731)
[S6] loaded HEAD from S2 (vec_in norm=1.220731)
[S6] cosine check vs S2: cos=0.4406
[S6] BUFFERED delta from S2 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1795) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.922454)
[S6] loaded HEAD from S7 (vec_in norm=0.922454)
[S6] cosine check vs S7: cos=0.0195
[S6] BUFFERED delta from S7 (total buffered=2)
[S17] not sending this round → trigger blocked (psi=0.537)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=6 metric=0.1414 head_norm=0.693546
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.880514e-01
[S9] stored merged vector for next round verification (round=6)
[S9] DEBUG after merge:  round=6 metric=0.1414 head_norm=0.877749 delta_norm=0.588051
[S9] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=6 metric=0.6194 head_norm=1.088261
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.448551e-01
[S6] stored merged vector for next round verification (round=6)
[S6] DEBUG after merge:  round=6 metric=0.7075 head_norm=0.774152 delta_norm=0.544855
[S6] aggregate: ACCEPT kept=['S2', 'S7'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=6 metric=0.1404 head_norm=0.687095
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.655644e-01
[S14] stored merged vector for next round verification (round=6)
[S14] DEBUG after merge:  round=6 metric=0.1404 head_norm=0.610058 delta_norm=0.565564
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=1.220731 cos_to_last_merge=0.9154 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.915
[S2] round=7 local utility u=0.065666 metrics={'f1_val': 0.7024588655463511, 'auprc': 0.7896895652133439, 'loss_val': 0.4822194776614452, 'psi': 0.7373511454131483}-{'f1_val': 0.7064348163147742, 'auprc': 0.7757068883355347, 'loss_val': 0.5954583759024283, 'psi': 0.7341436451230785}
[S3] START round=7 head_norm_before_train=1.276166 (no previous merge yet)
[S3] round=7 local utility u=0.099883 metrics={'f1_val': 0.6995786553134029, 'auprc': 0.9961116417628818, 'loss_val': 0.7101081712594643, 'psi': 0.8181918498931944}-{'f1_val': 0.69982954919712, 'auprc': 0.9973577686060711, 'loss_val': 0.9151173399553642, 'psi': 0.8188408369607005}
[S4] START round=7 head_norm_before_train=1.257831 cos_to_last_merge=0.8982 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.898
[S4] round=7 local utility u=0.184078 metrics={'f1_val': 0.6663783076155665, 'auprc': 0.8214457513282832, 'loss_val': 0.4789230699683952, 'psi': 0.7284052851006533}-{'f1_val': 0.6823206856328985, 'auprc': 0.6645334002159287, 'loss_val': 0.4719957472724518, 'psi': 0.6752057714661106}
[S5] START round=7 head_norm_before_train=0.816975 cos_to_last_merge=0.9980 (last merge round=5)
[S5] round=7 local utility u=0.801681 metrics={'f1_val': 0.4175889530834738, 'auprc': 0.7777851279916571, 'loss_val': 1.0358359041547751, 'psi': 0.5616674230467471}-{'f1_val': 0.17094914646680787, 'auprc': 0.7745100858130671, 'loss_val': 1.1495332382686743, 'psi': 0.41237352220531154}
[S6] START round=7 head_norm_before_train=0.774152 cos_to_last_merge=1.0000 (last merge round=6)
[S6] round=7 local utility u=0.523609 metrics={'f1_val': 0.6976465564246477, 'auprc': 0.9680428997802414, 'loss_val': 0.5074596599841966, 'psi': 0.8058050937668852}-{'f1_val': 0.61939393928922, 'auprc': 0.7942361177259565, 'loss_val': 0.5637420538709478, 'psi': 0.6893308106639147}
[S7] START round=7 head_norm_before_train=0.922454 cos_to_last_merge=0.9726 (last merge round=1)
[S7] round=7 local utility u=0.025666 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7778565635016158, 'loss_val': 1.1607200470832144, 'psi': 0.39637671903810134}-{'f1_val': 0.14205682272909165, 'auprc': 0.7778136078764735, 'loss_val': 1.2119221835971954, 'psi': 0.3963595367880444}
[S8] START round=7 head_norm_before_train=1.554191 (no previous merge yet)
[S8] round=7 local utility u=0.158271 metrics={'f1_val': 0.7141092833849391, 'auprc': 0.9976787451185013, 'loss_val': 0.31872671271499475, 'psi': 0.827537068078364}-{'f1_val': 0.6889879416535731, 'auprc': 0.9959162774728145, 'loss_val': 0.47925341205376804, 'psi': 0.8117592759812697}
[S9] START round=7 head_norm_before_train=0.877749 cos_to_last_merge=1.0000 (last merge round=6)
[S9] round=7 local utility u=0.080006 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8658895024078017, 'loss_val': 0.995881053087726, 'psi': 0.4311945752471183}-{'f1_val': 0.141397957139996, 'auprc': 0.8644943154905013, 'loss_val': 1.1517075172986937, 'psi': 0.43063650048019814}
[S10] START round=7 head_norm_before_train=1.589633 (no previous merge yet)
[S10] round=7 local utility u=0.000000 metrics={'f1_val': 0.6398499096301068, 'auprc': 0.9538488309010134, 'loss_val': 0.3132117157786756, 'psi': 0.7654494781384695}-{'f1_val': 0.6889680379787774, 'auprc': 0.9974943816534335, 'loss_val': 0.30884229774038957, 'psi': 0.8123785754486399}
[S11] START round=7 head_norm_before_train=1.323438 (no previous merge yet)
[S11] round=7 local utility u=0.088422 metrics={'f1_val': 0.39651855440916606, 'auprc': 0.9986349592866602, 'loss_val': 0.793917732715454, 'psi': 0.6373651163601637}-{'f1_val': 0.39651855440916606, 'auprc': 0.9981965005730659, 'loss_val': 0.9694472486020999, 'psi': 0.637189732874726}
[S13] START round=7 head_norm_before_train=1.512900 (no previous merge yet)
[S13] round=7 local utility u=0.000000 metrics={'f1_val': 0.6871805481578802, 'auprc': 0.7617226501941641, 'loss_val': 0.5125499851465644, 'psi': 0.7169973889723937}-{'f1_val': 0.7124345433715253, 'auprc': 0.7457475302647358, 'loss_val': 0.5204591532700343, 'psi': 0.7257597381288095}
[S14] START round=7 head_norm_before_train=0.610058 cos_to_last_merge=1.0000 (last merge round=6)
[S14] round=7 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.5845650775524222, 'loss_val': 1.223251370360799, 'psi': 0.31804074275059113}-{'f1_val': 0.14035785288270378, 'auprc': 0.7905952588062445, 'loss_val': 1.261040648645454, 'psi': 0.40045281525212006}
[S15] START round=7 head_norm_before_train=0.954971 cos_to_last_merge=0.9909 (last merge round=5)
[S15] round=7 local utility u=0.033070 metrics={'f1_val': 0.6976740606446065, 'auprc': 0.8130984195952973, 'loss_val': 0.4353382784170182, 'psi': 0.7438438042248827}-{'f1_val': 0.6977395583968921, 'auprc': 0.8317859954323157, 'loss_val': 0.5579338381759432, 'psi': 0.7513581332110615}
[S16] START round=7 head_norm_before_train=1.366984 (no previous merge yet)
[S16] round=7 local utility u=0.064850 metrics={'f1_val': 0.4171583814486223, 'auprc': 0.741806555900992, 'loss_val': 0.8805369410127001, 'psi': 0.5470176512295701}-{'f1_val': 0.4175015313869336, 'auprc': 0.7396120930324036, 'loss_val': 1.0057120107901778, 'psi': 0.5463457560451216}
[S17] START round=7 head_norm_before_train=1.223818 cos_to_last_merge=0.8991 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.899
[S17] round=7 local utility u=0.000000 metrics={'f1_val': 0.35273268957802617, 'auprc': 0.6407079410542363, 'loss_val': 0.895613618559348, 'psi': 0.46792279016851024}-{'f1_val': 0.5081494792077106, 'auprc': 0.5804100972192834, 'loss_val': 0.9297913677074439, 'psi': 0.5370537264123397}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:59815
[S7] not sending this round → trigger blocked (psi=0.396)
[S11] not sending this round → trigger blocked (psi=0.637)
[S2] not sending this round → trigger blocked (psi=0.737)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] → sending delta(kind=head bytes=1792) to S4@127.0.0.1:59804
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.828)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:59805
[S15] not sending this round → trigger blocked (psi=0.744)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] → sending delta(kind=head bytes=1792) to S14@127.0.0.1:59814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:59810
[S3] not sending this round → trigger blocked (psi=0.818)
[S16] sending update (kind=head size=1792 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1792 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1792) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.910166)
[S14] loaded HEAD from S9 (vec_in norm=0.910166)
[S14] cosine check vs S9: cos=0.2857
[S14] BUFFERED delta from S9 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1798) from S4
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.326431)
[S5] loaded HEAD from S4 (vec_in norm=1.326431)
[S5] cosine check vs S4: cos=0.4379
[S5] BUFFERED delta from S4 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1796) from S6
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.857235)
[S15] loaded HEAD from S6 (vec_in norm=0.857235)
[S15] cosine check vs S6: cos=0.4475
[S15] BUFFERED delta from S6 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1801) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.852382)
[S9] loaded HEAD from S5 (vec_in norm=0.852382)
[S9] cosine check vs S5: cos=0.2358
[S9] BUFFERED delta from S5 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1792) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.398711)
[S4] loaded HEAD from S16 (vec_in norm=1.398711)
[S4] cosine check vs S16: cos=-0.0066
[S4] DROPPED delta from S16 (cos=-0.0066 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=7 metric=0.1404 head_norm=0.647987
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.772948e-01
[S14] stored merged vector for next round verification (round=7)
[S14] DEBUG after merge:  round=7 metric=0.1404 head_norm=0.629551 delta_norm=0.477295
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=7 metric=0.1414 head_norm=0.910166
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.452089e-01
[S9] stored merged vector for next round verification (round=7)
[S9] DEBUG after merge:  round=7 metric=0.1414 head_norm=0.692983 delta_norm=0.545209
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=7 metric=0.4176 head_norm=0.852382
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.115021e-01
[S5] stored merged vector for next round verification (round=7)
[S5] DEBUG after merge:  round=7 metric=0.4583 head_norm=0.932230 delta_norm=0.611502
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=7 metric=0.6977 head_norm=1.057849
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.104435e-01
[S15] stored merged vector for next round verification (round=7)
[S15] DEBUG after merge:  round=7 metric=0.6966 head_norm=0.816331 delta_norm=0.510444
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=1.282455 cos_to_last_merge=0.8973 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.897
[S2] round=8 local utility u=0.031005 metrics={'f1_val': 0.6993270296991614, 'auprc': 0.7895994517430238, 'loss_val': 0.4011472999433212, 'psi': 0.7354359985167063}-{'f1_val': 0.7024588655463511, 'auprc': 0.7896895652133439, 'loss_val': 0.4822194776614452, 'psi': 0.7373511454131483}
[S3] START round=8 head_norm_before_train=1.319510 (no previous merge yet)
[S3] round=8 local utility u=0.000000 metrics={'f1_val': 0.4059544683010684, 'auprc': 0.9922852061030082, 'loss_val': 0.676281859942106, 'psi': 0.6404867634218443}-{'f1_val': 0.6995786553134029, 'auprc': 0.9961116417628818, 'loss_val': 0.7101081712594643, 'psi': 0.8181918498931944}
[S4] START round=8 head_norm_before_train=1.326431 cos_to_last_merge=0.8779 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.878
[S4] round=8 local utility u=1.000000 metrics={'f1_val': 0.9461650699503418, 'auprc': 0.9351817481659339, 'loss_val': 0.48046488920980085, 'psi': 0.9417717412365787}-{'f1_val': 0.6663783076155665, 'auprc': 0.8214457513282832, 'loss_val': 0.4789230699683952, 'psi': 0.7284052851006533}
[S5] START round=8 head_norm_before_train=0.932230 cos_to_last_merge=1.0000 (last merge round=7)
[S5] round=8 local utility u=0.015751 metrics={'f1_val': 0.41762898496828804, 'auprc': 0.7773532403044892, 'loss_val': 1.0032776822726046, 'psi': 0.5615186871027684}-{'f1_val': 0.4175889530834738, 'auprc': 0.7777851279916571, 'loss_val': 1.0358359041547751, 'psi': 0.5616674230467471}
[S6] START round=8 head_norm_before_train=0.857235 cos_to_last_merge=0.9884 (last merge round=6)
[S6] round=8 local utility u=0.000000 metrics={'f1_val': 0.6844294498176483, 'auprc': 0.8286745555192561, 'loss_val': 0.5002866815785698, 'psi': 0.7421274920982914}-{'f1_val': 0.6976465564246477, 'auprc': 0.9680428997802414, 'loss_val': 0.5074596599841966, 'psi': 0.8058050937668852}
[S7] START round=8 head_norm_before_train=0.939664 cos_to_last_merge=0.9666 (last merge round=1)
[S7] round=8 local utility u=0.815044 metrics={'f1_val': 0.40105398755467947, 'auprc': 0.7778964252328475, 'loss_val': 1.0847354105750353, 'psi': 0.5517909626259467}-{'f1_val': 0.14205682272909165, 'auprc': 0.7778565635016158, 'loss_val': 1.1607200470832144, 'psi': 0.39637671903810134}
[S8] START round=8 head_norm_before_train=1.603908 (no previous merge yet)
[S8] round=8 local utility u=0.007099 metrics={'f1_val': 0.7141742661762565, 'auprc': 0.9961028080767217, 'loss_val': 0.30019001243589816, 'psi': 0.8269456829364425}-{'f1_val': 0.7141092833849391, 'auprc': 0.9976787451185013, 'loss_val': 0.31872671271499475, 'psi': 0.827537068078364}
[S9] START round=8 head_norm_before_train=0.692983 cos_to_last_merge=1.0000 (last merge round=7)
[S9] round=8 local utility u=0.903175 metrics={'f1_val': 0.36152823749882185, 'auprc': 0.999048525962946, 'loss_val': 0.9097892220506048, 'psi': 0.6165363528844716}-{'f1_val': 0.141397957139996, 'auprc': 0.8658895024078017, 'loss_val': 0.995881053087726, 'psi': 0.4311945752471183}
[S10] START round=8 head_norm_before_train=1.647966 (no previous merge yet)
[S10] round=8 local utility u=1.000000 metrics={'f1_val': 0.9584240890591054, 'auprc': 0.9975804744208343, 'loss_val': 0.17290288018998318, 'psi': 0.974086643203797}-{'f1_val': 0.6398499096301068, 'auprc': 0.9538488309010134, 'loss_val': 0.3132117157786756, 'psi': 0.7654494781384695}
[S11] START round=8 head_norm_before_train=1.364317 (no previous merge yet)
[S11] round=8 local utility u=0.278453 metrics={'f1_val': 0.47067828814516777, 'auprc': 0.9950031987106571, 'loss_val': 0.6710749442944033, 'psi': 0.6804082523713635}-{'f1_val': 0.39651855440916606, 'auprc': 0.9986349592866602, 'loss_val': 0.793917732715454, 'psi': 0.6373651163601637}
[S13] START round=8 head_norm_before_train=1.549092 (no previous merge yet)
[S13] round=8 local utility u=0.043061 metrics={'f1_val': 0.7100221653820893, 'auprc': 0.730795331466454, 'loss_val': 0.47069598414096003, 'psi': 0.7183314318158351}-{'f1_val': 0.6871805481578802, 'auprc': 0.7617226501941641, 'loss_val': 0.5125499851465644, 'psi': 0.7169973889723937}
[S14] START round=8 head_norm_before_train=0.629551 cos_to_last_merge=1.0000 (last merge round=7)
[S14] round=8 local utility u=0.275883 metrics={'f1_val': 0.15387968613775066, 'auprc': 0.7155530204558758, 'loss_val': 1.145579613587967, 'psi': 0.37854901986500067}-{'f1_val': 0.14035785288270378, 'auprc': 0.5845650775524222, 'loss_val': 1.223251370360799, 'psi': 0.31804074275059113}
[S15] START round=8 head_norm_before_train=0.816331 cos_to_last_merge=1.0000 (last merge round=7)
[S15] round=8 local utility u=0.000000 metrics={'f1_val': 0.6982189809106911, 'auprc': 0.7995007100422831, 'loss_val': 0.5205292457920501, 'psi': 0.738731672563328}-{'f1_val': 0.6976740606446065, 'auprc': 0.8130984195952973, 'loss_val': 0.4353382784170182, 'psi': 0.7438438042248827}
[S16] START round=8 head_norm_before_train=1.398711 (no previous merge yet)
[S16] round=8 local utility u=0.083654 metrics={'f1_val': 0.4361982574512411, 'auprc': 0.7433534007580432, 'loss_val': 0.8321079635706176, 'psi': 0.5590603147739619}-{'f1_val': 0.4171583814486223, 'auprc': 0.741806555900992, 'loss_val': 0.8805369410127001, 'psi': 0.5470176512295701}
[S17] START round=8 head_norm_before_train=1.261435 cos_to_last_merge=0.8821 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.882
[S17] round=8 local utility u=0.026889 metrics={'f1_val': 0.35243618488830136, 'auprc': 0.6658398933153233, 'loss_val': 0.915451714832528, 'psi': 0.4777976682591102}-{'f1_val': 0.35273268957802617, 'auprc': 0.6407079410542363, 'loss_val': 0.895613618559348, 'psi': 0.46792279016851024}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:59807
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:59804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] → sending delta(kind=head bytes=1793) to S11@127.0.0.1:59812
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.559)
[S9] not sending this round → trigger blocked (psi=0.617)
[S5] not sending this round → trigger blocked (psi=0.562)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:59810
[S4] not sending this round → trigger blocked (psi=0.942)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:59807
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1805 to 1 peers)
[S14] sending update (kind=head size=1793 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1793) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.665223)
[S11] loaded HEAD from S14 (vec_in norm=0.665223)
[S11] cosine check vs S14: cos=0.7147
[S11] BUFFERED delta from S14 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1797) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.410932)
[S9] loaded HEAD from S11 (vec_in norm=1.410932)
[S9] cosine check vs S11: cos=0.6224
[S9] BUFFERED delta from S11 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1804) from S8
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.650131)
[S6] loaded HEAD from S8 (vec_in norm=1.650131)
[S6] cosine check vs S8: cos=-0.1243
[S6] DROPPED delta from S8 (cos=-0.1243 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1796) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.959008)
[S6] loaded HEAD from S7 (vec_in norm=0.959008)
[S6] cosine check vs S7: cos=0.2635
[S6] BUFFERED delta from S7 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1803) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.694305)
[S4] loaded HEAD from S10 (vec_in norm=1.694305)
[S4] cosine check vs S10: cos=0.0086
[S4] BUFFERED delta from S10 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1805) from S2
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.347833)
[S6] loaded HEAD from S2 (vec_in norm=1.347833)
[S6] cosine check vs S2: cos=0.5703
[S6] BUFFERED delta from S2 (total buffered=2)
[S9] RECEIVED delta(kind=head bytes=1797) from S13
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.575699)
[S9] loaded HEAD from S13 (vec_in norm=1.575699)
[S9] cosine check vs S13: cos=0.1394
[S9] BUFFERED delta from S13 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:59805
[S17] sending update (kind=head size=1802 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1802) from S17
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.290209)
[S5] loaded HEAD from S17 (vec_in norm=1.290209)
[S5] cosine check vs S17: cos=0.3062
[S5] BUFFERED delta from S17 (total buffered=1)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=8 metric=0.4176 head_norm=0.958977
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.757469e-01
[S5] stored merged vector for next round verification (round=8)
[S5] DEBUG after merge:  round=8 metric=0.4182 head_norm=0.914059 delta_norm=0.675747
[S5] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=8 metric=0.6844 head_norm=0.939741
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.937186e-01
[S6] stored merged vector for next round verification (round=8)
[S6] DEBUG after merge:  round=8 metric=0.7082 head_norm=0.796813 delta_norm=0.393719
[S6] aggregate: ACCEPT kept=['S7', 'S2'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=8 metric=0.9462 head_norm=1.372139
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.085542e+00
[S4] stored merged vector for next round verification (round=8)
[S4] DEBUG after merge:  round=8 metric=0.6142 head_norm=1.094676 delta_norm=1.085542
[S4] aggregate: ROLLBACK (f1_val pre=0.946 post=0.614 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=8 metric=0.3615 head_norm=0.740719
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.415704e-01
[S9] stored merged vector for next round verification (round=8)
[S9] DEBUG after merge:  round=8 metric=0.4061 head_norm=0.775600 delta_norm=0.441570
[S9] aggregate: ACCEPT kept=['S11', 'S13'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=8 metric=0.4707 head_norm=1.410932
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.223879e-01
[S11] stored merged vector for next round verification (round=8)
[S11] DEBUG after merge:  round=8 metric=0.3907 head_norm=0.971461 delta_norm=0.522388
[S11] aggregate: ROLLBACK (f1_val pre=0.471 post=0.391 tol_abs=0.005 tol_rel=0.0)
[S2] START round=9 head_norm_before_train=1.347833 cos_to_last_merge=0.8818 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.882
[S2] round=9 local utility u=0.000000 metrics={'f1_val': 0.6995880223688264, 'auprc': 0.6690406005146758, 'loss_val': 0.3406710330357923, 'psi': 0.6873690536271662}-{'f1_val': 0.6993270296991614, 'auprc': 0.7895994517430238, 'loss_val': 0.4011472999433212, 'psi': 0.7354359985167063}
[S3] START round=9 head_norm_before_train=1.359081 (no previous merge yet)
[S3] round=9 local utility u=0.442344 metrics={'f1_val': 0.5398038925919595, 'auprc': 0.9951069362253382, 'loss_val': 0.6031555700237082, 'psi': 0.721925110045311}-{'f1_val': 0.4059544683010684, 'auprc': 0.9922852061030082, 'loss_val': 0.676281859942106, 'psi': 0.6404867634218443}
[S4] START round=9 head_norm_before_train=1.094676 cos_to_last_merge=1.0000 (last merge round=8)
[S4] round=9 local utility u=0.000000 metrics={'f1_val': 0.6189306816563457, 'auprc': 0.9410151176394278, 'loss_val': 0.5351775090903887, 'psi': 0.7477644560495785}-{'f1_val': 0.9461650699503418, 'auprc': 0.9351817481659339, 'loss_val': 0.48046488920980085, 'psi': 0.9417717412365787}
[S5] START round=9 head_norm_before_train=0.914059 cos_to_last_merge=1.0000 (last merge round=8)
[S5] round=9 local utility u=0.940375 metrics={'f1_val': 0.7148635441655908, 'auprc': 0.7776234152596662, 'loss_val': 0.9067460140794183, 'psi': 0.7399674926032209}-{'f1_val': 0.41762898496828804, 'auprc': 0.7773532403044892, 'loss_val': 1.0032776822726046, 'psi': 0.5615186871027684}
[S6] START round=9 head_norm_before_train=0.796813 cos_to_last_merge=1.0000 (last merge round=8)
[S6] round=9 local utility u=0.279100 metrics={'f1_val': 0.7073090728396058, 'auprc': 0.9607181151669392, 'loss_val': 0.47549560575923216, 'psi': 0.8086726897705392}-{'f1_val': 0.6844294498176483, 'auprc': 0.8286745555192561, 'loss_val': 0.5002866815785698, 'psi': 0.7421274920982914}
[S7] START round=9 head_norm_before_train=0.959008 cos_to_last_merge=0.9591 (last merge round=1)
[S7] round=9 local utility u=0.872264 metrics={'f1_val': 0.6736936472882229, 'auprc': 0.7798433507900023, 'loss_val': 0.9818860355761289, 'psi': 0.7161535286889347}-{'f1_val': 0.40105398755467947, 'auprc': 0.7778964252328475, 'loss_val': 1.0847354105750353, 'psi': 0.5517909626259467}
[S8] START round=9 head_norm_before_train=1.650131 (no previous merge yet)
[S8] round=9 local utility u=0.044953 metrics={'f1_val': 0.7141742661762565, 'auprc': 0.9960539274311712, 'loss_val': 0.21013743494243758, 'psi': 0.8269261306782223}-{'f1_val': 0.7141742661762565, 'auprc': 0.9961028080767217, 'loss_val': 0.30019001243589816, 'psi': 0.8269456829364425}
[S9] START round=9 head_norm_before_train=0.775600 cos_to_last_merge=1.0000 (last merge round=8)
[S9] round=9 local utility u=1.000000 metrics={'f1_val': 0.7007662265142289, 'auprc': 0.9994600857562838, 'loss_val': 0.7905951320071093, 'psi': 0.8202437702110509}-{'f1_val': 0.36152823749882185, 'auprc': 0.999048525962946, 'loss_val': 0.9097892220506048, 'psi': 0.6165363528844716}
[S10] START round=9 head_norm_before_train=1.694305 (no previous merge yet)
[S10] round=9 local utility u=0.102115 metrics={'f1_val': 0.9949140915418154, 'auprc': 0.9943342160096057, 'loss_val': 0.177873414553372, 'psi': 0.9946821413289315}-{'f1_val': 0.9584240890591054, 'auprc': 0.9975804744208343, 'loss_val': 0.17290288018998318, 'psi': 0.974086643203797}
[S11] START round=9 head_norm_before_train=0.971461 cos_to_last_merge=1.0000 (last merge round=8)
[S11] round=9 local utility u=0.338560 metrics={'f1_val': 0.5823571021274323, 'auprc': 0.9945354977713808, 'loss_val': 0.6626238350730933, 'psi': 0.7472284603850117}-{'f1_val': 0.47067828814516777, 'auprc': 0.9950031987106571, 'loss_val': 0.6710749442944033, 'psi': 0.6804082523713635}
[S13] START round=9 head_norm_before_train=1.575699 (no previous merge yet)
[S13] round=9 local utility u=0.000000 metrics={'f1_val': 0.6327490837052001, 'auprc': 0.6978005170528578, 'loss_val': 0.5394067507672959, 'psi': 0.6587696570442632}-{'f1_val': 0.7100221653820893, 'auprc': 0.730795331466454, 'loss_val': 0.47069598414096003, 'psi': 0.7183314318158351}
[S14] START round=9 head_norm_before_train=0.665223 cos_to_last_merge=0.9914 (last merge round=7)
[S14] round=9 local utility u=0.886194 metrics={'f1_val': 0.39152081203261796, 'auprc': 0.7708449065581431, 'loss_val': 0.9649137465747032, 'psi': 0.543250449842828}-{'f1_val': 0.15387968613775066, 'auprc': 0.7155530204558758, 'loss_val': 1.145579613587967, 'psi': 0.37854901986500067}
[S15] START round=9 head_norm_before_train=0.905238 cos_to_last_merge=0.9889 (last merge round=7)
[S15] round=9 local utility u=0.054700 metrics={'f1_val': 0.6980919167946789, 'auprc': 0.8007829004635527, 'loss_val': 0.41421418466650656, 'psi': 0.7391683102622284}-{'f1_val': 0.6982189809106911, 'auprc': 0.7995007100422831, 'loss_val': 0.5205292457920501, 'psi': 0.738731672563328}
[S16] START round=9 head_norm_before_train=1.437889 (no previous merge yet)
[S16] round=9 local utility u=0.016983 metrics={'f1_val': 0.4357211989682394, 'auprc': 0.7441588387904406, 'loss_val': 0.7976967611235591, 'psi': 0.5590962548971199}-{'f1_val': 0.4361982574512411, 'auprc': 0.7433534007580432, 'loss_val': 0.8321079635706176, 'psi': 0.5590603147739619}
[S17] START round=9 head_norm_before_train=1.290209 cos_to_last_merge=0.8690 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.869
[S17] round=9 local utility u=0.000000 metrics={'f1_val': 0.34263861241091664, 'auprc': 0.6774517760625575, 'loss_val': 0.9908033496079861, 'psi': 0.47656387787157295}-{'f1_val': 0.35243618488830136, 'auprc': 0.6658398933153233, 'loss_val': 0.915451714832528, 'psi': 0.4777976682591102}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:59810
[S10] not sending this round → trigger blocked (psi=0.995)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:59804
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.827)
[S14] not sending this round → trigger blocked (psi=0.543)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:59814
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:59802
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.747)
[S7] not sending this round → trigger blocked (psi=0.716)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S9] → sending delta(kind=head bytes=1791) to S14@127.0.0.1:59814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:59815
[S16] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1791 to 1 peers)
[S5] sending update (kind=head size=1793 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1801) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.030346)
[S14] loaded HEAD from S15 (vec_in norm=1.030346)
[S14] cosine check vs S15: cos=0.4644
[S14] BUFFERED delta from S15 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1791) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.826780)
[S14] loaded HEAD from S9 (vec_in norm=0.826780)
[S14] cosine check vs S9: cos=0.7376
[S14] BUFFERED delta from S9 (total buffered=2)
[S4] RECEIVED delta(kind=head bytes=1795) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.478909)
[S4] loaded HEAD from S16 (vec_in norm=1.478909)
[S4] cosine check vs S16: cos=0.0244
[S4] BUFFERED delta from S16 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1796) from S6
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.884264)
[S15] loaded HEAD from S6 (vec_in norm=0.884264)
[S15] cosine check vs S6: cos=0.6334
[S15] BUFFERED delta from S6 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1793) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.950629)
[S9] loaded HEAD from S5 (vec_in norm=0.950629)
[S9] cosine check vs S5: cos=0.3530
[S9] BUFFERED delta from S5 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1799) from S3
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.396017)
[S2] loaded HEAD from S3 (vec_in norm=1.396017)
[S2] cosine check vs S3: cos=0.0061
[S2] BUFFERED delta from S3 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=9 metric=0.3915 head_norm=0.723048
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.264368e-01
[S14] stored merged vector for next round verification (round=9)
[S14] DEBUG after merge:  round=9 metric=0.3915 head_norm=0.666891 delta_norm=0.226437
[S14] aggregate: ACCEPT kept=['S15', 'S9'] (k=2/2) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=9 metric=0.6996 head_norm=1.406416
[S2] _apply_head_vector_avg (torch): Δ‖w‖=9.877713e-01
[S2] stored merged vector for next round verification (round=9)
[S2] DEBUG after merge:  round=9 metric=0.6996 head_norm=0.993853 delta_norm=0.987771
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=9 metric=0.6189 head_norm=1.157518
[S4] _apply_head_vector_avg (torch): Δ‖w‖=9.278163e-01
[S4] stored merged vector for next round verification (round=9)
[S4] DEBUG after merge:  round=9 metric=0.6676 head_norm=0.950087 delta_norm=0.927816
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=9 metric=0.6981 head_norm=1.030346
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.151346e-01
[S15] stored merged vector for next round verification (round=9)
[S15] DEBUG after merge:  round=9 metric=0.6979 head_norm=0.865697 delta_norm=0.415135
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=9 metric=0.7008 head_norm=0.826780
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.080451e-01
[S9] stored merged vector for next round verification (round=9)
[S9] DEBUG after merge:  round=9 metric=0.7003 head_norm=0.731793 delta_norm=0.508045
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=0.993853 cos_to_last_merge=1.0000 (last merge round=9)
[S2] round=10 local utility u=0.151713 metrics={'f1_val': 0.7081352674707335, 'auprc': 0.7957307966658985, 'loss_val': 0.4685992361536691, 'psi': 0.7431734791487996}-{'f1_val': 0.6995880223688264, 'auprc': 0.6690406005146758, 'loss_val': 0.3406710330357923, 'psi': 0.6873690536271662}
[S3] START round=10 head_norm_before_train=1.396017 (no previous merge yet)
[S3] round=10 local utility u=0.559064 metrics={'f1_val': 0.7010108237857944, 'auprc': 0.997399865401599, 'loss_val': 0.4591485593874701, 'psi': 0.8195664404321162}-{'f1_val': 0.5398038925919595, 'auprc': 0.9951069362253382, 'loss_val': 0.6031555700237082, 'psi': 0.721925110045311}
[S4] START round=10 head_norm_before_train=0.950087 cos_to_last_merge=1.0000 (last merge round=9)
[S4] round=10 local utility u=0.116699 metrics={'f1_val': 0.6653554156066982, 'auprc': 0.9382603738177517, 'loss_val': 0.5720630425202134, 'psi': 0.7745173988911196}-{'f1_val': 0.6189306816563457, 'auprc': 0.9410151176394278, 'loss_val': 0.5351775090903887, 'psi': 0.7477644560495785}
[S5] START round=10 head_norm_before_train=0.950629 cos_to_last_merge=0.9974 (last merge round=8)
[S5] round=10 local utility u=0.000000 metrics={'f1_val': 0.5612444766382126, 'auprc': 0.7946605254413711, 'loss_val': 0.7753952719501015, 'psi': 0.6546108961594761}-{'f1_val': 0.7148635441655908, 'auprc': 0.7776234152596662, 'loss_val': 0.9067460140794183, 'psi': 0.7399674926032209}
[S6] START round=10 head_norm_before_train=0.884264 cos_to_last_merge=0.9869 (last merge round=8)
[S6] round=10 local utility u=0.839300 metrics={'f1_val': 0.9621044272595924, 'auprc': 0.9633356415809494, 'loss_val': 0.33352084216150785, 'psi': 0.9625969129881353}-{'f1_val': 0.7073090728396058, 'auprc': 0.9607181151669392, 'loss_val': 0.47549560575923216, 'psi': 0.8086726897705392}
[S7] START round=10 head_norm_before_train=0.983217 cos_to_last_merge=0.9497 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.950
[S7] round=10 local utility u=0.206408 metrics={'f1_val': 0.714792420046008, 'auprc': 0.7948621142218023, 'loss_val': 0.8607188981175085, 'psi': 0.7468202977163256}-{'f1_val': 0.6736936472882229, 'auprc': 0.7798433507900023, 'loss_val': 0.9818860355761289, 'psi': 0.7161535286889347}
[S8] START round=10 head_norm_before_train=1.689687 (no previous merge yet)
[S8] round=10 local utility u=0.881993 metrics={'f1_val': 0.9959789603727395, 'auprc': 0.9959870217719158, 'loss_val': 0.13677960217419405, 'psi': 0.99598218493241}-{'f1_val': 0.7141742661762565, 'auprc': 0.9960539274311712, 'loss_val': 0.21013743494243758, 'psi': 0.8269261306782223}
[S9] START round=10 head_norm_before_train=0.731793 cos_to_last_merge=1.0000 (last merge round=9)
[S9] round=10 local utility u=0.039219 metrics={'f1_val': 0.7012635524283195, 'auprc': 0.9993570939657064, 'loss_val': 0.7148311748548618, 'psi': 0.8205009690432743}-{'f1_val': 0.7007662265142289, 'auprc': 0.9994600857562838, 'loss_val': 0.7905951320071093, 'psi': 0.8202437702110509}
[S10] START round=10 head_norm_before_train=1.733524 (no previous merge yet)
[S10] round=10 local utility u=0.027263 metrics={'f1_val': 0.9939904298799414, 'auprc': 0.9956842499163439, 'loss_val': 0.12185607092860873, 'psi': 0.9946679578945024}-{'f1_val': 0.9949140915418154, 'auprc': 0.9943342160096057, 'loss_val': 0.177873414553372, 'psi': 0.9946821413289315}
[S11] START round=10 head_norm_before_train=1.023019 cos_to_last_merge=0.9973 (last merge round=8)
[S11] round=10 local utility u=0.416485 metrics={'f1_val': 0.701890640953942, 'auprc': 0.9953186014228836, 'loss_val': 0.5492039235197081, 'psi': 0.8192618251415187}-{'f1_val': 0.5823571021274323, 'auprc': 0.9945354977713808, 'loss_val': 0.6626238350730933, 'psi': 0.7472284603850117}
[S13] START round=10 head_norm_before_train=1.602153 (no previous merge yet)
[S13] round=10 local utility u=0.000000 metrics={'f1_val': 0.574437682327023, 'auprc': 0.5486288510171191, 'loss_val': 0.6614340041558256, 'psi': 0.5641141498030615}-{'f1_val': 0.6327490837052001, 'auprc': 0.6978005170528578, 'loss_val': 0.5394067507672959, 'psi': 0.6587696570442632}
[S14] START round=10 head_norm_before_train=0.666891 cos_to_last_merge=1.0000 (last merge round=9)
[S14] round=10 local utility u=0.230262 metrics={'f1_val': 0.390486867611325, 'auprc': 0.8944175818127201, 'loss_val': 0.8689047465840026, 'psi': 0.5920591532918831}-{'f1_val': 0.39152081203261796, 'auprc': 0.7708449065581431, 'loss_val': 0.9649137465747032, 'psi': 0.543250449842828}
[S15] START round=10 head_norm_before_train=0.865697 cos_to_last_merge=1.0000 (last merge round=9)
[S15] round=10 local utility u=0.146577 metrics={'f1_val': 0.7014422425349331, 'auprc': 0.894293530603764, 'loss_val': 0.42169376796491487, 'psi': 0.7785827577624655}-{'f1_val': 0.6980919167946789, 'auprc': 0.8007829004635527, 'loss_val': 0.41421418466650656, 'psi': 0.7391683102622284}
[S16] START round=10 head_norm_before_train=1.478909 (no previous merge yet)
[S16] round=10 local utility u=0.000000 metrics={'f1_val': 0.38657369965022276, 'auprc': 0.742395686644208, 'loss_val': 0.7984015477538272, 'psi': 0.5289024944478169}-{'f1_val': 0.4357211989682394, 'auprc': 0.7441588387904406, 'loss_val': 0.7976967611235591, 'psi': 0.5590962548971199}
[S17] START round=10 head_norm_before_train=1.313531 cos_to_last_merge=0.8586 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.859
[S17] round=10 local utility u=0.032886 metrics={'f1_val': 0.360735423829749, 'auprc': 0.6791720523653189, 'loss_val': 1.0387726482854651, 'psi': 0.4881100752439769}-{'f1_val': 0.34263861241091664, 'auprc': 0.6774517760625575, 'loss_val': 0.9908033496079861, 'psi': 0.47656387787157295}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:59812
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:59815
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S11] → sending delta(kind=head bytes=1789) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:59805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:59814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:59802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:59804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:59814
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:59807
[S4] sending update (kind=head size=1805 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1805 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1789 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1797) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.008131)
[S6] loaded HEAD from S7 (vec_in norm=1.008131)
[S6] cosine check vs S7: cos=0.3820
[S6] BUFFERED delta from S7 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1798) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.720076)
[S11] loaded HEAD from S14 (vec_in norm=0.720076)
[S11] cosine check vs S14: cos=0.6968
[S11] BUFFERED delta from S14 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1805) from S4
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.032346)
[S5] loaded HEAD from S4 (vec_in norm=1.032346)
[S5] cosine check vs S4: cos=0.2336
[S5] BUFFERED delta from S4 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1805) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.964795)
[S14] loaded HEAD from S15 (vec_in norm=0.964795)
[S14] cosine check vs S15: cos=0.7040
[S14] BUFFERED delta from S15 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1799) from S3
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.435903)
[S2] loaded HEAD from S3 (vec_in norm=1.435903)
[S2] cosine check vs S3: cos=0.6483
[S2] BUFFERED delta from S3 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1801) from S6
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.982367)
[S15] loaded HEAD from S6 (vec_in norm=0.982367)
[S15] cosine check vs S6: cos=0.8133
[S15] BUFFERED delta from S6 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1798) from S2
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.078582)
[S6] loaded HEAD from S2 (vec_in norm=1.078582)
[S6] cosine check vs S2: cos=0.4621
[S6] BUFFERED delta from S2 (total buffered=2)
[S14] RECEIVED delta(kind=head bytes=1802) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.789283)
[S14] loaded HEAD from S9 (vec_in norm=0.789283)
[S14] cosine check vs S9: cos=0.6018
[S14] BUFFERED delta from S9 (total buffered=2)
[S4] RECEIVED delta(kind=head bytes=1798) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.764284)
[S4] loaded HEAD from S10 (vec_in norm=1.764284)
[S4] cosine check vs S10: cos=0.4342
[S4] BUFFERED delta from S10 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1802) from S8
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.734019)
[S6] loaded HEAD from S8 (vec_in norm=1.734019)
[S6] cosine check vs S8: cos=-0.1078
[S6] DROPPED delta from S8 (cos=-0.1078 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1789) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.082128)
[S9] loaded HEAD from S11 (vec_in norm=1.082128)
[S9] cosine check vs S11: cos=0.5145
[S9] BUFFERED delta from S11 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:59805
[S17] sending update (kind=head size=1794 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1794) from S17
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.334294)
[S5] loaded HEAD from S17 (vec_in norm=1.334294)
[S5] cosine check vs S17: cos=0.8493
[S5] BUFFERED delta from S17 (total buffered=2)
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=10 metric=0.5612 head_norm=0.987167
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.887136e-01
[S5] stored merged vector for next round verification (round=10)
[S5] DEBUG after merge:  round=10 metric=0.6841 head_norm=0.872777 delta_norm=0.288714
[S5] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.357 → S9@127.0.0.1:59810
[S13] ⇄ pheromone p=0.245 → S9@127.0.0.1:59810
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=10 metric=0.7019 head_norm=1.082128
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.884569e-01
[S11] stored merged vector for next round verification (round=10)
[S11] DEBUG after merge:  round=10 metric=0.6634 head_norm=0.832981 delta_norm=0.388457
[S11] aggregate: ROLLBACK (f1_val pre=0.702 post=0.663 tol_abs=0.005 tol_rel=0.0)
[S11] ⇄ pheromone p=0.403 → S9@127.0.0.1:59810
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=10 metric=0.7081 head_norm=1.078582
[S2] _apply_head_vector_avg (torch): Δ‖w‖=5.516113e-01
[S2] stored merged vector for next round verification (round=10)
[S2] DEBUG after merge:  round=10 metric=0.7010 head_norm=1.143811 delta_norm=0.551611
[S2] aggregate: ROLLBACK (f1_val pre=0.708 post=0.701 tol_abs=0.005 tol_rel=0.0)
[S2] ⇄ pheromone p=0.229 → S6@127.0.0.1:59807
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=10 metric=0.9621 head_norm=0.982367
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.947494e-01
[S6] stored merged vector for next round verification (round=10)
[S6] DEBUG after merge:  round=10 metric=0.9621 head_norm=0.767963 delta_norm=0.394749
[S6] aggregate: ACCEPT kept=['S7', 'S2'] (k=2/2) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.494 → S15@127.0.0.1:59815
[S10] ⇄ pheromone p=0.381 → S4@127.0.0.1:59804
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=10 metric=0.3905 head_norm=0.720076
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.871682e-01
[S14] stored merged vector for next round verification (round=10)
[S14] DEBUG after merge:  round=10 metric=0.3913 head_norm=0.671264 delta_norm=0.187168
[S14] aggregate: ACCEPT kept=['S15', 'S9'] (k=2/2) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.363 → S11@127.0.0.1:59812
[S7] ⇄ pheromone p=0.413 → S6@127.0.0.1:59807
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=10 metric=0.6654 head_norm=1.032346
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.057413e-01
[S4] stored merged vector for next round verification (round=10)
[S4] DEBUG after merge:  round=10 metric=0.6187 head_norm=1.200000 delta_norm=0.805741
[S4] aggregate: ROLLBACK (f1_val pre=0.665 post=0.619 tol_abs=0.005 tol_rel=0.0)
[S4] ⇄ pheromone p=0.385 → S5@127.0.0.1:59805
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=10 metric=0.7014 head_norm=0.964795
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.975895e-01
[S15] stored merged vector for next round verification (round=10)
[S15] DEBUG after merge:  round=10 metric=0.7181 head_norm=0.927026 delta_norm=0.297589
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.257 → S14@127.0.0.1:59814
[S8] ⇄ pheromone p=0.435 → S6@127.0.0.1:59807
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=10 metric=0.7013 head_norm=0.789283
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.782898e-01
[S9] stored merged vector for next round verification (round=10)
[S9] DEBUG after merge:  round=10 metric=0.7012 head_norm=0.817449 delta_norm=0.478290
[S9] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.403 → S14@127.0.0.1:59814
[S3] ⇄ pheromone p=0.425 → S2@127.0.0.1:59802
[S16] ⇄ pheromone p=0.213 → S4@127.0.0.1:59804
[S17] ⇄ pheromone p=0.197 → S5@127.0.0.1:59805
[S2] START round=11 head_norm_before_train=1.143811 cos_to_last_merge=1.0000 (last merge round=10)
[S2] round=11 local utility u=0.070962 metrics={'f1_val': 0.7002298375331623, 'auprc': 0.848523591600299, 'loss_val': 0.43762163739108123, 'psi': 0.7595473391600169}-{'f1_val': 0.7081352674707335, 'auprc': 0.7957307966658985, 'loss_val': 0.4685992361536691, 'psi': 0.7431734791487996}
[S3] START round=11 head_norm_before_train=1.435903 (no previous merge yet)
[S3] round=11 local utility u=0.034320 metrics={'f1_val': 0.7010108237857944, 'auprc': 0.9982718120361689, 'loss_val': 0.3931242438410624, 'psi': 0.8199152190859442}-{'f1_val': 0.7010108237857944, 'auprc': 0.997399865401599, 'loss_val': 0.4591485593874701, 'psi': 0.8195664404321162}
[S4] START round=11 head_norm_before_train=1.200000 cos_to_last_merge=1.0000 (last merge round=10)
[S4] round=11 local utility u=0.490154 metrics={'f1_val': 0.8192487404676294, 'auprc': 0.9432637097015704, 'loss_val': 0.530125938931831, 'psi': 0.8688547281612058}-{'f1_val': 0.6653554156066982, 'auprc': 0.9382603738177517, 'loss_val': 0.5720630425202134, 'psi': 0.7745173988911196}
[S5] START round=11 head_norm_before_train=0.872777 cos_to_last_merge=1.0000 (last merge round=10)
[S5] round=11 local utility u=0.471303 metrics={'f1_val': 0.7133181566396725, 'auprc': 0.7948774045043062, 'loss_val': 0.7458825878878426, 'psi': 0.745941855785526}-{'f1_val': 0.5612444766382126, 'auprc': 0.7946605254413711, 'loss_val': 0.7753952719501015, 'psi': 0.6546108961594761}
[S6] START round=11 head_norm_before_train=0.767963 cos_to_last_merge=1.0000 (last merge round=10)
[S6] round=11 local utility u=0.000000 metrics={'f1_val': 0.9610310590589646, 'auprc': 0.9590192949058537, 'loss_val': 0.46945021370810136, 'psi': 0.9602263533977202}-{'f1_val': 0.9621044272595924, 'auprc': 0.9633356415809494, 'loss_val': 0.33352084216150785, 'psi': 0.9625969129881353}
[S7] START round=11 head_norm_before_train=1.008131 cos_to_last_merge=0.9385 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.939
[S7] round=11 local utility u=0.048190 metrics={'f1_val': 0.7144974922643522, 'auprc': 0.7946384601314554, 'loss_val': 0.7618990477795683, 'psi': 0.7465538794111934}-{'f1_val': 0.714792420046008, 'auprc': 0.7948621142218023, 'loss_val': 0.8607188981175085, 'psi': 0.7468202977163256}
[S8] START round=11 head_norm_before_train=1.734019 (no previous merge yet)
[S8] round=11 local utility u=0.026568 metrics={'f1_val': 0.9964900410640029, 'auprc': 0.9990634086687377, 'loss_val': 0.0959398453980825, 'psi': 0.9975193881058968}-{'f1_val': 0.9959789603727395, 'auprc': 0.9959870217719158, 'loss_val': 0.13677960217419405, 'psi': 0.99598218493241}
[S9] START round=11 head_norm_before_train=0.817449 cos_to_last_merge=1.0000 (last merge round=10)
[S9] round=11 local utility u=0.091707 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.9988089921982779, 'loss_val': 0.5303790952458325, 'psi': 0.8203423975108166}-{'f1_val': 0.7012635524283195, 'auprc': 0.9993570939657064, 'loss_val': 0.7148311748548618, 'psi': 0.8205009690432743}
[S10] START round=11 head_norm_before_train=1.764284 (no previous merge yet)
[S10] round=11 local utility u=0.009959 metrics={'f1_val': 0.9930885249073472, 'auprc': 0.9947637524205328, 'loss_val': 0.09376549568427923, 'psi': 0.9937586159126215}-{'f1_val': 0.9939904298799414, 'auprc': 0.9956842499163439, 'loss_val': 0.12185607092860873, 'psi': 0.9946679578945024}
[S11] START round=11 head_norm_before_train=0.832981 cos_to_last_merge=1.0000 (last merge round=10)
[S11] round=11 local utility u=0.000000 metrics={'f1_val': 0.7018246587012323, 'auprc': 0.9952154044044117, 'loss_val': 0.5904478366624821, 'psi': 0.8191809569825041}-{'f1_val': 0.701890640953942, 'auprc': 0.9953186014228836, 'loss_val': 0.5492039235197081, 'psi': 0.8192618251415187}
[S13] START round=11 head_norm_before_train=1.635536 (no previous merge yet)
[S13] round=11 local utility u=0.028155 metrics={'f1_val': 0.6016537448781083, 'auprc': 0.5347926168401965, 'loss_val': 0.7269117956022123, 'psi': 0.5749092936629436}-{'f1_val': 0.574437682327023, 'auprc': 0.5486288510171191, 'loss_val': 0.6614340041558256, 'psi': 0.5641141498030615}
[S14] START round=11 head_norm_before_train=0.671264 cos_to_last_merge=1.0000 (last merge round=10)
[S14] round=11 local utility u=0.764477 metrics={'f1_val': 0.6047710183395615, 'auprc': 0.9465563397152542, 'loss_val': 0.7820722182760582, 'psi': 0.7414851468898387}-{'f1_val': 0.390486867611325, 'auprc': 0.8944175818127201, 'loss_val': 0.8689047465840026, 'psi': 0.5920591532918831}
[S15] START round=11 head_norm_before_train=0.927026 cos_to_last_merge=1.0000 (last merge round=10)
[S15] round=11 local utility u=0.000000 metrics={'f1_val': 0.6976744926565395, 'auprc': 0.8365195943459136, 'loss_val': 0.4883680937321004, 'psi': 0.7532125333322891}-{'f1_val': 0.7014422425349331, 'auprc': 0.894293530603764, 'loss_val': 0.42169376796491487, 'psi': 0.7785827577624655}
[S16] START round=11 head_norm_before_train=1.520860 (no previous merge yet)
[S16] round=11 local utility u=0.456315 metrics={'f1_val': 0.5436487274998383, 'auprc': 0.752657814206743, 'loss_val': 0.859007826751499, 'psi': 0.6272523621826002}-{'f1_val': 0.38657369965022276, 'auprc': 0.742395686644208, 'loss_val': 0.7984015477538272, 'psi': 0.5289024944478169}
[S17] START round=11 head_norm_before_train=1.334294 cos_to_last_merge=0.8493 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.849
[S17] round=11 local utility u=0.061474 metrics={'f1_val': 0.35306299220966936, 'auprc': 0.6993356076858269, 'loss_val': 0.9302808408421183, 'psi': 0.49157203840013236}-{'f1_val': 0.360735423829749, 'auprc': 0.6791720523653189, 'loss_val': 1.0387726482854651, 'psi': 0.4881100752439769}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] → sending delta(kind=head bytes=1806) to S5@127.0.0.1:59805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:59804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:59804
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:59802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S7] → sending delta(kind=head bytes=1807) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:59814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S8] → sending delta(kind=head bytes=1808) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:59812
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1806 to 1 peers)
[S7] sending update (kind=head size=1807 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1808 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1798) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.726393)
[S11] loaded HEAD from S14 (vec_in norm=0.726393)
[S11] cosine check vs S14: cos=0.7832
[S11] BUFFERED delta from S14 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1797) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.561340)
[S4] loaded HEAD from S16 (vec_in norm=1.561340)
[S4] cosine check vs S16: cos=0.3248
[S4] BUFFERED delta from S16 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1796) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.884968)
[S14] loaded HEAD from S9 (vec_in norm=0.884968)
[S14] cosine check vs S9: cos=0.7126
[S14] BUFFERED delta from S9 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1799) from S13
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.662702)
[S9] loaded HEAD from S13 (vec_in norm=1.662702)
[S9] cosine check vs S13: cos=0.1559
[S9] BUFFERED delta from S13 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1800) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.794079)
[S4] loaded HEAD from S10 (vec_in norm=1.794079)
[S4] cosine check vs S10: cos=0.8768
[S4] BUFFERED delta from S10 (total buffered=2)
[S5] RECEIVED delta(kind=head bytes=1806) from S4
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.273832)
[S5] loaded HEAD from S4 (vec_in norm=1.273832)
[S5] cosine check vs S4: cos=0.3470
[S5] BUFFERED delta from S4 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1794) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.912090)
[S9] loaded HEAD from S5 (vec_in norm=0.912090)
[S9] cosine check vs S5: cos=0.4357
[S9] BUFFERED delta from S5 (total buffered=2)
[S6] RECEIVED delta(kind=head bytes=1800) from S2
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.217599)
[S6] loaded HEAD from S2 (vec_in norm=1.217599)
[S6] cosine check vs S2: cos=0.4447
[S6] BUFFERED delta from S2 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1801) from S3
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.469834)
[S2] loaded HEAD from S3 (vec_in norm=1.469834)
[S2] cosine check vs S3: cos=0.8769
[S2] BUFFERED delta from S3 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1808) from S8
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.776794)
[S6] loaded HEAD from S8 (vec_in norm=1.776794)
[S6] cosine check vs S8: cos=-0.0670
[S6] DROPPED delta from S8 (cos=-0.0670 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1807) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.038242)
[S6] loaded HEAD from S7 (vec_in norm=1.038242)
[S6] cosine check vs S7: cos=0.5154
[S6] BUFFERED delta from S7 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:59805
[S17] sending update (kind=head size=1800 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1800) from S17
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.355435)
[S5] loaded HEAD from S17 (vec_in norm=1.355435)
[S5] cosine check vs S17: cos=0.8566
[S5] BUFFERED delta from S17 (total buffered=2)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=11 metric=0.7018 head_norm=0.889996
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.770934e-01
[S11] stored merged vector for next round verification (round=11)
[S11] DEBUG after merge:  round=11 metric=0.7018 head_norm=0.763603 delta_norm=0.277093
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=11 metric=0.9610 head_norm=0.840794
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.175187e-01
[S6] stored merged vector for next round verification (round=11)
[S6] DEBUG after merge:  round=11 metric=0.9613 head_norm=0.743923 delta_norm=0.317519
[S6] aggregate: ACCEPT kept=['S2', 'S7'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=11 metric=0.7014 head_norm=0.884968
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.271205e-01
[S9] stored merged vector for next round verification (round=11)
[S9] DEBUG after merge:  round=11 metric=0.7014 head_norm=0.753892 delta_norm=0.527121
[S9] aggregate: ACCEPT kept=['S13', 'S5'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=11 metric=0.7133 head_norm=0.912090
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.617799e-01
[S5] stored merged vector for next round verification (round=11)
[S5] DEBUG after merge:  round=11 metric=0.7011 head_norm=0.894208 delta_norm=0.261780
[S5] aggregate: ROLLBACK (f1_val pre=0.713 post=0.701 tol_abs=0.005 tol_rel=0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=11 metric=0.7002 head_norm=1.217599
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.551089e-01
[S2] stored merged vector for next round verification (round=11)
[S2] DEBUG after merge:  round=11 metric=0.6982 head_norm=1.302066 delta_norm=0.355109
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=11 metric=0.8192 head_norm=1.273832
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.247119e-01
[S4] stored merged vector for next round verification (round=11)
[S4] DEBUG after merge:  round=11 metric=0.6683 head_norm=1.195939 delta_norm=0.324712
[S4] aggregate: ROLLBACK (f1_val pre=0.819 post=0.668 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=11 metric=0.6048 head_norm=0.726393
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.141228e-01
[S14] stored merged vector for next round verification (round=11)
[S14] DEBUG after merge:  round=11 metric=0.6016 head_norm=0.746147 delta_norm=0.314123
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.302066 cos_to_last_merge=1.0000 (last merge round=11)
[S2] round=12 local utility u=0.000000 metrics={'f1_val': 0.7007729058908991, 'auprc': 0.7533338139586467, 'loss_val': 0.40715608159475764, 'psi': 0.7217972691179981}-{'f1_val': 0.7002298375331623, 'auprc': 0.848523591600299, 'loss_val': 0.43762163739108123, 'psi': 0.7595473391600169}
[S3] START round=12 head_norm_before_train=1.469834 (no previous merge yet)
[S3] round=12 local utility u=0.017829 metrics={'f1_val': 0.7008362290767893, 'auprc': 0.9968214964378606, 'loss_val': 0.35206706573529567, 'psi': 0.8192303360212179}-{'f1_val': 0.7010108237857944, 'auprc': 0.9982718120361689, 'loss_val': 0.3931242438410624, 'psi': 0.8199152190859442}
[S4] START round=12 head_norm_before_train=1.195939 cos_to_last_merge=1.0000 (last merge round=11)
[S4] round=12 local utility u=0.397363 metrics={'f1_val': 0.9433212707826675, 'auprc': 0.945852192234865, 'loss_val': 0.48760038586949617, 'psi': 0.9443336393635465}-{'f1_val': 0.8192487404676294, 'auprc': 0.9432637097015704, 'loss_val': 0.530125938931831, 'psi': 0.8688547281612058}
[S5] START round=12 head_norm_before_train=0.894208 cos_to_last_merge=1.0000 (last merge round=11)
[S5] round=12 local utility u=0.034549 metrics={'f1_val': 0.7146275168069246, 'auprc': 0.7932208642417901, 'loss_val': 0.6796715628249271, 'psi': 0.7460648557808708}-{'f1_val': 0.7133181566396725, 'auprc': 0.7948774045043062, 'loss_val': 0.7458825878878426, 'psi': 0.745941855785526}
[S6] START round=12 head_norm_before_train=0.743923 cos_to_last_merge=1.0000 (last merge round=11)
[S6] round=12 local utility u=0.000000 metrics={'f1_val': 0.8767610325142869, 'auprc': 0.9624404861802138, 'loss_val': 0.5802488584523036, 'psi': 0.9110328139806577}-{'f1_val': 0.9610310590589646, 'auprc': 0.9590192949058537, 'loss_val': 0.46945021370810136, 'psi': 0.9602263533977202}
[S7] START round=12 head_norm_before_train=1.038242 cos_to_last_merge=0.9241 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.924
[S7] round=12 local utility u=0.000000 metrics={'f1_val': 0.7018815165288186, 'auprc': 0.7922856856304102, 'loss_val': 0.7184461156047588, 'psi': 0.7380431841694552}-{'f1_val': 0.7144974922643522, 'auprc': 0.7946384601314554, 'loss_val': 0.7618990477795683, 'psi': 0.7465538794111934}
[S8] START round=12 head_norm_before_train=1.776794 (no previous merge yet)
[S8] round=12 local utility u=0.011139 metrics={'f1_val': 0.9948349509112366, 'auprc': 0.9992653215359392, 'loss_val': 0.06433662451060955, 'psi': 0.9966070991611177}-{'f1_val': 0.9964900410640029, 'auprc': 0.9990634086687377, 'loss_val': 0.0959398453980825, 'psi': 0.9975193881058968}
[S9] START round=12 head_norm_before_train=0.753892 cos_to_last_merge=1.0000 (last merge round=11)
[S9] round=12 local utility u=0.003730 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9985816565593746, 'loss_val': 0.5217917746105826, 'psi': 0.8202069527482879}-{'f1_val': 0.7013646677191758, 'auprc': 0.9988089921982779, 'loss_val': 0.5303790952458325, 'psi': 0.8203423975108166}
[S10] START round=12 head_norm_before_train=1.794079 (no previous merge yet)
[S10] round=12 local utility u=0.007768 metrics={'f1_val': 0.9930734810403055, 'auprc': 0.9947451592110049, 'loss_val': 0.07808367535126053, 'psi': 0.9937421523085852}-{'f1_val': 0.9930885249073472, 'auprc': 0.9947637524205328, 'loss_val': 0.09376549568427923, 'psi': 0.9937586159126215}
[S11] START round=12 head_norm_before_train=0.763603 cos_to_last_merge=1.0000 (last merge round=11)
[S11] round=12 local utility u=0.000000 metrics={'f1_val': 0.698781530858875, 'auprc': 0.9928451601479863, 'loss_val': 0.5979507491428978, 'psi': 0.8164069825745195}-{'f1_val': 0.7018246587012323, 'auprc': 0.9952154044044117, 'loss_val': 0.5904478366624821, 'psi': 0.8191809569825041}
[S13] START round=12 head_norm_before_train=1.662702 (no previous merge yet)
[S13] round=12 local utility u=0.003542 metrics={'f1_val': 0.5480085842000623, 'auprc': 0.6215971092103018, 'loss_val': 0.658370188538216, 'psi': 0.577443994204158}-{'f1_val': 0.6016537448781083, 'auprc': 0.5347926168401965, 'loss_val': 0.7269117956022123, 'psi': 0.5749092936629436}
[S14] START round=12 head_norm_before_train=0.746147 cos_to_last_merge=1.0000 (last merge round=11)
[S14] round=12 local utility u=0.191108 metrics={'f1_val': 0.6392650472589011, 'auprc': 0.9875195329089577, 'loss_val': 0.7297107783343598, 'psi': 0.7785668415189237}-{'f1_val': 0.6047710183395615, 'auprc': 0.9465563397152542, 'loss_val': 0.7820722182760582, 'psi': 0.7414851468898387}
[S15] START round=12 head_norm_before_train=1.012712 cos_to_last_merge=0.9856 (last merge round=10)
[S15] round=12 local utility u=1.000000 metrics={'f1_val': 0.9953347042740918, 'auprc': 0.9904961350165016, 'loss_val': 0.2083464924219603, 'psi': 0.9933992765710558}-{'f1_val': 0.6976744926565395, 'auprc': 0.8365195943459136, 'loss_val': 0.4883680937321004, 'psi': 0.7532125333322891}
[S16] START round=12 head_norm_before_train=1.561340 (no previous merge yet)
[S16] round=12 local utility u=0.000000 metrics={'f1_val': 0.5153978826857035, 'auprc': 0.758681607617225, 'loss_val': 0.7965356673815871, 'psi': 0.6127113726583122}-{'f1_val': 0.5436487274998383, 'auprc': 0.752657814206743, 'loss_val': 0.859007826751499, 'psi': 0.6272523621826002}
[S17] START round=12 head_norm_before_train=1.355435 cos_to_last_merge=0.8407 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.841
[S17] round=12 local utility u=0.132891 metrics={'f1_val': 0.39057800136951437, 'auprc': 0.6857491657301229, 'loss_val': 0.8488300866705822, 'psi': 0.5086464671137578}-{'f1_val': 0.35306299220966936, 'auprc': 0.6993356076858269, 'loss_val': 0.9302808408421183, 'psi': 0.49157203840013236}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:59804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:59805
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:59814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:59814
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:59802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:59812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:59810
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:59810
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1804 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1805 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1805 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1804) from S8
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.818552)
[S6] loaded HEAD from S8 (vec_in norm=1.818552)
[S6] cosine check vs S8: cos=-0.0355
[S6] DROPPED delta from S8 (cos=-0.0355 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1797) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.797649)
[S11] loaded HEAD from S14 (vec_in norm=0.797649)
[S11] cosine check vs S14: cos=0.9659
[S11] BUFFERED delta from S14 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1805) from S4
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.276266)
[S5] loaded HEAD from S4 (vec_in norm=1.276266)
[S5] cosine check vs S4: cos=0.5261
[S5] BUFFERED delta from S4 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1796) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.820120)
[S14] loaded HEAD from S9 (vec_in norm=0.820120)
[S14] cosine check vs S9: cos=0.7920
[S14] BUFFERED delta from S9 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1805) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.129042)
[S14] loaded HEAD from S15 (vec_in norm=1.129042)
[S14] cosine check vs S15: cos=0.5230
[S14] BUFFERED delta from S15 (total buffered=2)
[S4] RECEIVED delta(kind=head bytes=1797) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.835544)
[S4] loaded HEAD from S10 (vec_in norm=1.835544)
[S4] cosine check vs S10: cos=0.8124
[S4] BUFFERED delta from S10 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1795) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.940488)
[S9] loaded HEAD from S5 (vec_in norm=0.940488)
[S9] cosine check vs S5: cos=0.5238
[S9] BUFFERED delta from S5 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1802) from S3
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.498450)
[S2] loaded HEAD from S3 (vec_in norm=1.498450)
[S2] cosine check vs S3: cos=0.9348
[S2] BUFFERED delta from S3 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1799) from S13
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.677878)
[S9] loaded HEAD from S13 (vec_in norm=1.677878)
[S9] cosine check vs S13: cos=0.6126
[S9] BUFFERED delta from S13 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:59805
[S17] sending update (kind=head size=1798 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1798) from S17
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.381940)
[S5] loaded HEAD from S17 (vec_in norm=1.381940)
[S5] cosine check vs S17: cos=0.8328
[S5] BUFFERED delta from S17 (total buffered=2)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=12 metric=0.6988 head_norm=0.828674
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.072230e-01
[S11] stored merged vector for next round verification (round=12)
[S11] DEBUG after merge:  round=12 metric=0.6252 head_norm=0.806211 delta_norm=0.107223
[S11] aggregate: ROLLBACK (f1_val pre=0.699 post=0.625 tol_abs=0.005 tol_rel=0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=12 metric=0.7008 head_norm=1.372230
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.664242e-01
[S2] stored merged vector for next round verification (round=12)
[S2] DEBUG after merge:  round=12 metric=0.7006 head_norm=1.411808 delta_norm=0.266424
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=12 metric=0.7013 head_norm=0.820120
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.029440e-01
[S9] stored merged vector for next round verification (round=12)
[S9] DEBUG after merge:  round=12 metric=0.7014 head_norm=0.845739 delta_norm=0.302944
[S9] aggregate: ACCEPT kept=['S5', 'S13'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=12 metric=0.7146 head_norm=0.940488
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.572670e-01
[S5] stored merged vector for next round verification (round=12)
[S5] DEBUG after merge:  round=12 metric=0.7146 head_norm=0.938973 delta_norm=0.157267
[S5] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=12 metric=0.6393 head_norm=0.797649
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.370744e-01
[S14] stored merged vector for next round verification (round=12)
[S14] DEBUG after merge:  round=12 metric=0.6393 head_norm=0.742117 delta_norm=0.237074
[S14] aggregate: ACCEPT kept=['S9', 'S15'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=12 metric=0.9433 head_norm=1.276266
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.458018e-01
[S4] stored merged vector for next round verification (round=12)
[S4] DEBUG after merge:  round=12 metric=0.6221 head_norm=1.483623 delta_norm=0.545802
[S4] aggregate: ROLLBACK (f1_val pre=0.943 post=0.622 tol_abs=0.005 tol_rel=0.0)
[S2] START round=13 head_norm_before_train=1.411808 cos_to_last_merge=1.0000 (last merge round=12)
[S2] round=13 local utility u=0.172422 metrics={'f1_val': 0.7065386290706148, 'auprc': 0.837338219774977, 'loss_val': 0.3489203139609581, 'psi': 0.7588584653523598}-{'f1_val': 0.7007729058908991, 'auprc': 0.7533338139586467, 'loss_val': 0.40715608159475764, 'psi': 0.7217972691179981}
[S3] START round=13 head_norm_before_train=1.498450 (no previous merge yet)
[S3] round=13 local utility u=0.016342 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.9967349425656662, 'loss_val': 0.3190960707503015, 'psi': 0.819193018041553}-{'f1_val': 0.7008362290767893, 'auprc': 0.9968214964378606, 'loss_val': 0.35206706573529567, 'psi': 0.8192303360212179}
[S4] START round=13 head_norm_before_train=1.483623 cos_to_last_merge=1.0000 (last merge round=12)
[S4] round=13 local utility u=0.000000 metrics={'f1_val': 0.9161873999313499, 'auprc': 0.9569630149587417, 'loss_val': 0.4587631967187861, 'psi': 0.9324976459423067}-{'f1_val': 0.9433212707826675, 'auprc': 0.945852192234865, 'loss_val': 0.48760038586949617, 'psi': 0.9443336393635465}
[S5] START round=13 head_norm_before_train=0.938973 cos_to_last_merge=1.0000 (last merge round=12)
[S5] round=13 local utility u=0.000000 metrics={'f1_val': 0.7008168588441903, 'auprc': 0.71918441705453, 'loss_val': 0.611142464331504, 'psi': 0.7081638821283263}-{'f1_val': 0.7146275168069246, 'auprc': 0.7932208642417901, 'loss_val': 0.6796715628249271, 'psi': 0.7460648557808708}
[S6] START round=13 head_norm_before_train=0.813831 cos_to_last_merge=0.9883 (last merge round=11)
[S6] round=13 local utility u=0.245038 metrics={'f1_val': 0.9368209913483392, 'auprc': 0.9601227222414325, 'loss_val': 0.4435793109874989, 'psi': 0.9461416837055765}-{'f1_val': 0.8767610325142869, 'auprc': 0.9624404861802138, 'loss_val': 0.5802488584523036, 'psi': 0.9110328139806577}
[S7] START round=13 head_norm_before_train=1.075625 cos_to_last_merge=0.9066 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.907
[S7] round=13 local utility u=0.114468 metrics={'f1_val': 0.7142026337939525, 'auprc': 0.7927917975089865, 'loss_val': 0.5649550539111159, 'psi': 0.7456382992799662}-{'f1_val': 0.7018815165288186, 'auprc': 0.7922856856304102, 'loss_val': 0.7184461156047588, 'psi': 0.7380431841694552}
[S8] START round=13 head_norm_before_train=1.818552 (no previous merge yet)
[S8] round=13 local utility u=0.000000 metrics={'f1_val': 0.9925263999649303, 'auprc': 0.9992604639509057, 'loss_val': 0.05839595835583444, 'psi': 0.9952200255593204}-{'f1_val': 0.9948349509112366, 'auprc': 0.9992653215359392, 'loss_val': 0.06433662451060955, 'psi': 0.9966070991611177}
[S9] START round=13 head_norm_before_train=0.845739 cos_to_last_merge=1.0000 (last merge round=12)
[S9] round=13 local utility u=0.010468 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9979412124360929, 'loss_val': 0.4989351502871723, 'psi': 0.8199507750989752}-{'f1_val': 0.7012904835408967, 'auprc': 0.9985816565593746, 'loss_val': 0.5217917746105826, 'psi': 0.8202069527482879}
[S10] START round=13 head_norm_before_train=1.835544 (no previous merge yet)
[S10] round=13 local utility u=0.001110 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.992958194752692, 'loss_val': 0.07923560481312908, 'psi': 0.9939007419801134}-{'f1_val': 0.9930734810403055, 'auprc': 0.9947451592110049, 'loss_val': 0.07808367535126053, 'psi': 0.9937421523085852}
[S11] START round=13 head_norm_before_train=0.806211 cos_to_last_merge=1.0000 (last merge round=12)
[S11] round=13 local utility u=0.051822 metrics={'f1_val': 0.7020007759458987, 'auprc': 0.9964130934225668, 'loss_val': 0.524325814237182, 'psi': 0.8197657029365659}-{'f1_val': 0.698781530858875, 'auprc': 0.9928451601479863, 'loss_val': 0.5979507491428978, 'psi': 0.8164069825745195}
[S13] START round=13 head_norm_before_train=1.677878 (no previous merge yet)
[S13] round=13 local utility u=0.233556 metrics={'f1_val': 0.5928643937097442, 'auprc': 0.6566305062735982, 'loss_val': 0.565493753546019, 'psi': 0.6183708387352858}-{'f1_val': 0.5480085842000623, 'auprc': 0.6215971092103018, 'loss_val': 0.658370188538216, 'psi': 0.577443994204158}
[S14] START round=13 head_norm_before_train=0.742117 cos_to_last_merge=1.0000 (last merge round=12)
[S14] round=13 local utility u=0.159511 metrics={'f1_val': 0.6742657328466439, 'auprc': 0.9933926250829367, 'loss_val': 0.6383121330379873, 'psi': 0.801916489741161}-{'f1_val': 0.6392650472589011, 'auprc': 0.9875195329089577, 'loss_val': 0.7297107783343598, 'psi': 0.7785668415189237}
[S15] START round=13 head_norm_before_train=1.129042 cos_to_last_merge=0.9560 (last merge round=10)
[S15] round=13 local utility u=0.000000 metrics={'f1_val': 0.9880603263660775, 'auprc': 0.9795771334906336, 'loss_val': 0.17188494703295257, 'psi': 0.9846670492159}-{'f1_val': 0.9953347042740918, 'auprc': 0.9904961350165016, 'loss_val': 0.2083464924219603, 'psi': 0.9933992765710558}
[S16] START round=13 head_norm_before_train=1.596582 (no previous merge yet)
[S16] round=13 local utility u=0.041792 metrics={'f1_val': 0.48808856205612305, 'auprc': 0.7969470523783526, 'loss_val': 0.6638914261851011, 'psi': 0.6116319581850149}-{'f1_val': 0.5153978826857035, 'auprc': 0.758681607617225, 'loss_val': 0.7965356673815871, 'psi': 0.6127113726583122}
[S17] START round=13 head_norm_before_train=1.381940 cos_to_last_merge=0.8341 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.834
[S17] round=13 local utility u=0.020803 metrics={'f1_val': 0.39150282933631075, 'auprc': 0.6845973343205513, 'loss_val': 0.8093165942846776, 'psi': 0.5087406313300069}-{'f1_val': 0.39057800136951437, 'auprc': 0.6857491657301229, 'loss_val': 0.8488300866705822, 'psi': 0.5086464671137578}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:59815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:59814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:59804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:59804
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:59802
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:59810
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S14] → sending delta(kind=head bytes=1806) to S11@127.0.0.1:59812
[S11] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1806 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1797) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.901995)
[S14] loaded HEAD from S9 (vec_in norm=0.901995)
[S14] cosine check vs S9: cos=0.6313
[S14] BUFFERED delta from S9 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1801) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.629138)
[S4] loaded HEAD from S16 (vec_in norm=1.629138)
[S4] cosine check vs S16: cos=0.2385
[S4] BUFFERED delta from S16 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1797) from S2
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.476571)
[S6] loaded HEAD from S2 (vec_in norm=1.476571)
[S6] cosine check vs S2: cos=0.4580
[S6] BUFFERED delta from S2 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1798) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.116842)
[S6] loaded HEAD from S7 (vec_in norm=1.116842)
[S6] cosine check vs S7: cos=0.5185
[S6] BUFFERED delta from S7 (total buffered=2)
[S9] RECEIVED delta(kind=head bytes=1796) from S13
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.697807)
[S9] loaded HEAD from S13 (vec_in norm=1.697807)
[S9] cosine check vs S13: cos=0.7671
[S9] BUFFERED delta from S13 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1806) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.796368)
[S11] loaded HEAD from S14 (vec_in norm=0.796368)
[S11] cosine check vs S14: cos=0.9343
[S11] BUFFERED delta from S14 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1797) from S6
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.909373)
[S15] loaded HEAD from S6 (vec_in norm=0.909373)
[S15] cosine check vs S6: cos=0.6496
[S15] BUFFERED delta from S6 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1798) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.879142)
[S9] loaded HEAD from S11 (vec_in norm=0.879142)
[S9] cosine check vs S11: cos=0.5606
[S9] BUFFERED delta from S11 (total buffered=2)
[S4] RECEIVED delta(kind=head bytes=1799) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.877512)
[S4] loaded HEAD from S10 (vec_in norm=1.877512)
[S4] cosine check vs S10: cos=0.9442
[S4] BUFFERED delta from S10 (total buffered=2)
[S2] RECEIVED delta(kind=head bytes=1800) from S3
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.525928)
[S2] loaded HEAD from S3 (vec_in norm=1.525928)
[S2] cosine check vs S3: cos=0.9576
[S2] BUFFERED delta from S3 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:59805
[S17] sending update (kind=head size=1800 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1800) from S17
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.407627)
[S5] loaded HEAD from S17 (vec_in norm=1.407627)
[S5] cosine check vs S17: cos=0.8062
[S5] BUFFERED delta from S17 (total buffered=1)
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=13 metric=0.9162 head_norm=1.551625
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.006323e-01
[S4] stored merged vector for next round verification (round=13)
[S4] DEBUG after merge:  round=13 metric=0.8218 head_norm=1.355418 delta_norm=0.400632
[S4] aggregate: ROLLBACK (f1_val pre=0.916 post=0.822 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=13 metric=0.7008 head_norm=0.984933
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.230973e-01
[S5] stored merged vector for next round verification (round=13)
[S5] DEBUG after merge:  round=13 metric=0.7006 head_norm=1.138746 delta_norm=0.423097
[S5] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=13 metric=0.7020 head_norm=0.879142
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.572054e-01
[S11] stored merged vector for next round verification (round=13)
[S11] DEBUG after merge:  round=13 metric=0.7020 head_norm=0.823913 delta_norm=0.157205
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=13 metric=0.6743 head_norm=0.796368
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.676898e-01
[S14] stored merged vector for next round verification (round=13)
[S14] DEBUG after merge:  round=13 metric=0.6611 head_norm=0.767270 delta_norm=0.367690
[S14] aggregate: ROLLBACK (f1_val pre=0.674 post=0.661 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=13 metric=0.7013 head_norm=0.901995
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.378118e-01
[S9] stored merged vector for next round verification (round=13)
[S9] DEBUG after merge:  round=13 metric=0.7013 head_norm=0.930676 delta_norm=0.237812
[S9] aggregate: ACCEPT kept=['S13', 'S11'] (k=2/2) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=13 metric=0.7065 head_norm=1.476571
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.199776e-01
[S2] stored merged vector for next round verification (round=13)
[S2] DEBUG after merge:  round=13 metric=0.7099 head_norm=1.485250 delta_norm=0.219978
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=13 metric=0.9368 head_norm=0.909373
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.437302e-01
[S6] stored merged vector for next round verification (round=13)
[S6] DEBUG after merge:  round=13 metric=0.9274 head_norm=0.830015 delta_norm=0.343730
[S6] aggregate: ROLLBACK (f1_val pre=0.937 post=0.927 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=13 metric=0.9881 head_norm=1.226605
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.696797e-01
[S15] stored merged vector for next round verification (round=13)
[S15] DEBUG after merge:  round=13 metric=0.9868 head_norm=0.972194 delta_norm=0.469680
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.485250 cos_to_last_merge=1.0000 (last merge round=13)
[S2] round=14 local utility u=0.564871 metrics={'f1_val': 0.8273980341681471, 'auprc': 0.9606818706201289, 'loss_val': 0.3143652773479101, 'psi': 0.8807115687489397}-{'f1_val': 0.7065386290706148, 'auprc': 0.837338219774977, 'loss_val': 0.3489203139609581, 'psi': 0.7588584653523598}
[S3] START round=14 head_norm_before_train=1.525928 (no previous merge yet)
[S3] round=14 local utility u=0.000000 metrics={'f1_val': 0.6490213229049897, 'auprc': 0.9921049501640787, 'loss_val': 0.39514664649789283, 'psi': 0.7862547738086254}-{'f1_val': 0.7008317350254774, 'auprc': 0.9967349425656662, 'loss_val': 0.3190960707503015, 'psi': 0.819193018041553}
[S4] START round=14 head_norm_before_train=1.355418 cos_to_last_merge=1.0000 (last merge round=13)
[S4] round=14 local utility u=0.148148 metrics={'f1_val': 0.9428697128652721, 'auprc': 0.9652484751873134, 'loss_val': 0.34741758945813433, 'psi': 0.9518212177940886}-{'f1_val': 0.9161873999313499, 'auprc': 0.9569630149587417, 'loss_val': 0.4587631967187861, 'psi': 0.9324976459423067}
[S5] START round=14 head_norm_before_train=1.138746 cos_to_last_merge=1.0000 (last merge round=13)
[S5] round=14 local utility u=0.098975 metrics={'f1_val': 0.7005691551769304, 'auprc': 0.7471337918985821, 'loss_val': 0.495553770994698, 'psi': 0.719195009865591}-{'f1_val': 0.7008168588441903, 'auprc': 0.71918441705453, 'loss_val': 0.611142464331504, 'psi': 0.7081638821283263}
[S6] START round=14 head_norm_before_train=0.830015 cos_to_last_merge=1.0000 (last merge round=13)
[S6] round=14 local utility u=0.095530 metrics={'f1_val': 0.9614471606370787, 'auprc': 0.9699592530406206, 'loss_val': 0.4297853956418134, 'psi': 0.9648519975984955}-{'f1_val': 0.9368209913483392, 'auprc': 0.9601227222414325, 'loss_val': 0.4435793109874989, 'psi': 0.9461416837055765}
[S7] START round=14 head_norm_before_train=1.116842 cos_to_last_merge=0.8902 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.890
[S7] round=14 local utility u=0.000000 metrics={'f1_val': 0.45640262545113197, 'auprc': 0.7897062230992016, 'loss_val': 0.7762319255561034, 'psi': 0.5897240645103599}-{'f1_val': 0.7142026337939525, 'auprc': 0.7927917975089865, 'loss_val': 0.5649550539111159, 'psi': 0.7456382992799662}
[S8] START round=14 head_norm_before_train=1.856511 (no previous merge yet)
[S8] round=14 local utility u=0.000000 metrics={'f1_val': 0.9885743956773263, 'auprc': 0.9992315684164649, 'loss_val': 0.060810381941697945, 'psi': 0.9928372647729817}-{'f1_val': 0.9925263999649303, 'auprc': 0.9992604639509057, 'loss_val': 0.05839595835583444, 'psi': 0.9952200255593204}
[S9] START round=14 head_norm_before_train=0.930676 cos_to_last_merge=1.0000 (last merge round=13)
[S9] round=14 local utility u=0.037761 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9977344090897031, 'loss_val': 0.422792597513262, 'psi': 0.8198680537604193}-{'f1_val': 0.7012904835408967, 'auprc': 0.9979412124360929, 'loss_val': 0.4989351502871723, 'psi': 0.8199507750989752}
[S10] START round=14 head_norm_before_train=1.877512 (no previous merge yet)
[S10] round=14 local utility u=0.011002 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9926850612455799, 'loss_val': 0.05722421584957069, 'psi': 0.9938726575038819}-{'f1_val': 0.9945291067983943, 'auprc': 0.992958194752692, 'loss_val': 0.07923560481312908, 'psi': 0.9939007419801134}
[S11] START round=14 head_norm_before_train=0.823913 cos_to_last_merge=1.0000 (last merge round=13)
[S11] round=14 local utility u=0.027746 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9965431255610411, 'loss_val': 0.46738017618908445, 'psi': 0.8196333379765713}-{'f1_val': 0.7020007759458987, 'auprc': 0.9964130934225668, 'loss_val': 0.524325814237182, 'psi': 0.8197657029365659}
[S13] START round=14 head_norm_before_train=1.697807 (no previous merge yet)
[S13] round=14 local utility u=0.000000 metrics={'f1_val': 0.6195952942761879, 'auprc': 0.6285506371668174, 'loss_val': 0.6570076521475375, 'psi': 0.6231774314324396}-{'f1_val': 0.5928643937097442, 'auprc': 0.6566305062735982, 'loss_val': 0.565493753546019, 'psi': 0.6183708387352858}
[S14] START round=14 head_norm_before_train=0.767270 cos_to_last_merge=1.0000 (last merge round=13)
[S14] round=14 local utility u=0.000000 metrics={'f1_val': 0.6400627295624943, 'auprc': 0.9886010738755798, 'loss_val': 0.6188346420944647, 'psi': 0.7794780672877286}-{'f1_val': 0.6742657328466439, 'auprc': 0.9933926250829367, 'loss_val': 0.6383121330379873, 'psi': 0.801916489741161}
[S15] START round=14 head_norm_before_train=0.972194 cos_to_last_merge=1.0000 (last merge round=13)
[S15] round=14 local utility u=0.000000 metrics={'f1_val': 0.7009169771696235, 'auprc': 0.7991458459820324, 'loss_val': 0.4668092163127838, 'psi': 0.7402085246945871}-{'f1_val': 0.9880603263660775, 'auprc': 0.9795771334906336, 'loss_val': 0.17188494703295257, 'psi': 0.9846670492159}
[S16] START round=14 head_norm_before_train=1.629138 (no previous merge yet)
[S16] round=14 local utility u=0.369726 metrics={'f1_val': 0.5823182593325185, 'auprc': 0.842165553614294, 'loss_val': 0.6254725650900431, 'psi': 0.6862571770452287}-{'f1_val': 0.48808856205612305, 'auprc': 0.7969470523783526, 'loss_val': 0.6638914261851011, 'psi': 0.6116319581850149}
[S17] START round=14 head_norm_before_train=1.407627 cos_to_last_merge=0.8308 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.831
[S17] round=14 local utility u=0.446561 metrics={'f1_val': 0.41830815999105225, 'auprc': 0.8504068738462505, 'loss_val': 0.5744543813723981, 'psi': 0.5911476455331316}-{'f1_val': 0.39150282933631075, 'auprc': 0.6845973343205513, 'loss_val': 0.8093165942846776, 'psi': 0.5087406313300069}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] → sending delta(kind=head bytes=1792) to S9@127.0.0.1:59810
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S16] → sending delta(kind=head bytes=1806) to S4@127.0.0.1:59804
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:59805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:59815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:59804
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:59814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:59807
[S9] sending update (kind=head size=1794 to 1 peers)
[S16] sending update (kind=head size=1806 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1792 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1795) from S6
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.912136)
[S15] loaded HEAD from S6 (vec_in norm=0.912136)
[S15] cosine check vs S6: cos=0.7363
[S15] BUFFERED delta from S6 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1792) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.176386)
[S9] loaded HEAD from S5 (vec_in norm=1.176386)
[S9] cosine check vs S5: cos=0.3526
[S9] BUFFERED delta from S5 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1795) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.888855)
[S9] loaded HEAD from S11 (vec_in norm=0.888855)
[S9] cosine check vs S11: cos=0.6414
[S9] BUFFERED delta from S11 (total buffered=2)
[S14] RECEIVED delta(kind=head bytes=1794) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.988330)
[S14] loaded HEAD from S9 (vec_in norm=0.988330)
[S14] cosine check vs S9: cos=0.9004
[S14] BUFFERED delta from S9 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1800) from S4
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.429384)
[S5] loaded HEAD from S4 (vec_in norm=1.429384)
[S5] cosine check vs S4: cos=0.2890
[S5] BUFFERED delta from S4 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1797) from S2
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.542914)
[S6] loaded HEAD from S2 (vec_in norm=1.542914)
[S6] cosine check vs S2: cos=0.6017
[S6] BUFFERED delta from S2 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1799) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.914132)
[S4] loaded HEAD from S10 (vec_in norm=1.914132)
[S4] cosine check vs S10: cos=0.8735
[S4] BUFFERED delta from S10 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1806) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.661597)
[S4] loaded HEAD from S16 (vec_in norm=1.661597)
[S4] cosine check vs S16: cos=0.4464
[S4] BUFFERED delta from S16 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:59805
[S17] sending update (kind=head size=1802 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1802) from S17
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.441285)
[S5] loaded HEAD from S17 (vec_in norm=1.441285)
[S5] cosine check vs S17: cos=0.9605
[S5] BUFFERED delta from S17 (total buffered=2)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=14 metric=0.6401 head_norm=0.817597
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.180509e-01
[S14] stored merged vector for next round verification (round=14)
[S14] DEBUG after merge:  round=14 metric=0.6401 head_norm=0.880389 delta_norm=0.218051
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=14 metric=0.7013 head_norm=0.988330
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.193892e-01
[S9] stored merged vector for next round verification (round=14)
[S9] DEBUG after merge:  round=14 metric=0.7013 head_norm=0.813994 delta_norm=0.419389
[S9] aggregate: ACCEPT kept=['S5', 'S11'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=14 metric=0.9614 head_norm=0.912136
[S6] _apply_head_vector_avg (torch): Δ‖w‖=6.162497e-01
[S6] stored merged vector for next round verification (round=14)
[S6] DEBUG after merge:  round=14 metric=0.9613 head_norm=1.107485 delta_norm=0.616250
[S6] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=14 metric=0.9429 head_norm=1.429384
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.501236e-01
[S4] stored merged vector for next round verification (round=14)
[S4] DEBUG after merge:  round=14 metric=0.9423 head_norm=1.337064 delta_norm=0.250124
[S4] aggregate: ACCEPT kept=['S10', 'S16'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=14 metric=0.7006 head_norm=1.176386
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.004713e-01
[S5] stored merged vector for next round verification (round=14)
[S5] DEBUG after merge:  round=14 metric=0.7006 head_norm=1.071234 delta_norm=0.300471
[S5] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=14 metric=0.7009 head_norm=1.047096
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.612148e-01
[S15] stored merged vector for next round verification (round=14)
[S15] DEBUG after merge:  round=14 metric=0.7009 head_norm=0.913085 delta_norm=0.361215
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.542914 cos_to_last_merge=0.9954 (last merge round=13)
[S2] round=15 local utility u=0.000000 metrics={'f1_val': 0.7053235228089023, 'auprc': 0.9504148941741132, 'loss_val': 0.3214259926241331, 'psi': 0.8033600713549867}-{'f1_val': 0.8273980341681471, 'auprc': 0.9606818706201289, 'loss_val': 0.3143652773479101, 'psi': 0.8807115687489397}
[S3] START round=15 head_norm_before_train=1.553692 (no previous merge yet)
[S3] round=15 local utility u=0.000000 metrics={'f1_val': 0.640835580446145, 'auprc': 0.990841160675229, 'loss_val': 0.4020479152646505, 'psi': 0.7808378125377786}-{'f1_val': 0.6490213229049897, 'auprc': 0.9921049501640787, 'loss_val': 0.39514664649789283, 'psi': 0.7862547738086254}
[S4] START round=15 head_norm_before_train=1.337064 cos_to_last_merge=1.0000 (last merge round=14)
[S4] round=15 local utility u=0.000000 metrics={'f1_val': 0.9409774363037859, 'auprc': 0.9489425207540474, 'loss_val': 0.347503230199257, 'psi': 0.9441634700838906}-{'f1_val': 0.9428697128652721, 'auprc': 0.9652484751873134, 'loss_val': 0.34741758945813433, 'psi': 0.9518212177940886}
[S5] START round=15 head_norm_before_train=1.071234 cos_to_last_merge=1.0000 (last merge round=14)
[S5] round=15 local utility u=0.089872 metrics={'f1_val': 0.7091547584171244, 'auprc': 0.7915516284219277, 'loss_val': 0.5005759232425758, 'psi': 0.7421135064190457}-{'f1_val': 0.7005691551769304, 'auprc': 0.7471337918985821, 'loss_val': 0.495553770994698, 'psi': 0.719195009865591}
[S6] START round=15 head_norm_before_train=1.107485 cos_to_last_merge=1.0000 (last merge round=14)
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.8990115532233967, 'auprc': 0.9665883328555922, 'loss_val': 0.5005783812721788, 'psi': 0.926042265076275}-{'f1_val': 0.9614471606370787, 'auprc': 0.9699592530406206, 'loss_val': 0.4297853956418134, 'psi': 0.9648519975984955}
[S7] START round=15 head_norm_before_train=1.148576 cos_to_last_merge=0.8771 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.877
[S7] round=15 local utility u=0.825125 metrics={'f1_val': 0.6810340872178713, 'auprc': 0.8013188914414735, 'loss_val': 0.5086093972750338, 'psi': 0.7291480089073121}-{'f1_val': 0.45640262545113197, 'auprc': 0.7897062230992016, 'loss_val': 0.7762319255561034, 'psi': 0.5897240645103599}
[S8] START round=15 head_norm_before_train=1.889328 (no previous merge yet)
[S8] round=15 local utility u=0.021394 metrics={'f1_val': 0.9926457841098181, 'auprc': 0.9992186692900545, 'loss_val': 0.04241262003188346, 'psi': 0.9952749381819126}-{'f1_val': 0.9885743956773263, 'auprc': 0.9992315684164649, 'loss_val': 0.060810381941697945, 'psi': 0.9928372647729817}
[S9] START round=15 head_norm_before_train=0.813994 cos_to_last_merge=1.0000 (last merge round=14)
[S9] round=15 local utility u=0.020274 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.997991396923483, 'loss_val': 0.3830157949522105, 'psi': 0.8199708488939312}-{'f1_val': 0.7012904835408967, 'auprc': 0.9977344090897031, 'loss_val': 0.422792597513262, 'psi': 0.8198680537604193}
[S10] START round=15 head_norm_before_train=1.914132 (no previous merge yet)
[S10] round=15 local utility u=0.004415 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9941004322614191, 'loss_val': 0.046061307408413896, 'psi': 0.9937809667237243}-{'f1_val': 0.9946643883427498, 'auprc': 0.9926850612455799, 'loss_val': 0.05722421584957069, 'psi': 0.9938726575038819}
[S11] START round=15 head_norm_before_train=0.888855 cos_to_last_merge=0.9959 (last merge round=13)
[S11] round=15 local utility u=0.050605 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9971021585266424, 'loss_val': 0.36784695902035913, 'psi': 0.8198569511628119}-{'f1_val': 0.7016934795869249, 'auprc': 0.9965431255610411, 'loss_val': 0.46738017618908445, 'psi': 0.8196333379765713}
[S13] START round=15 head_norm_before_train=1.718801 (no previous merge yet)
[S13] round=15 local utility u=0.000000 metrics={'f1_val': 0.5812724007746702, 'auprc': 0.6067264497343043, 'loss_val': 0.8211020933963606, 'psi': 0.5914540203585239}-{'f1_val': 0.6195952942761879, 'auprc': 0.6285506371668174, 'loss_val': 0.6570076521475375, 'psi': 0.6231774314324396}
[S14] START round=15 head_norm_before_train=0.880389 cos_to_last_merge=1.0000 (last merge round=14)
[S14] round=15 local utility u=0.167679 metrics={'f1_val': 0.6887946161912328, 'auprc': 0.990297959729565, 'loss_val': 0.5809589846127835, 'psi': 0.8093959536065658}-{'f1_val': 0.6400627295624943, 'auprc': 0.9886010738755798, 'loss_val': 0.6188346420944647, 'psi': 0.7794780672877286}
[S15] START round=15 head_norm_before_train=0.913085 cos_to_last_merge=1.0000 (last merge round=14)
[S15] round=15 local utility u=0.527449 metrics={'f1_val': 0.8258214134245451, 'auprc': 0.9120280986661558, 'loss_val': 0.49998443721327135, 'psi': 0.8603040875211894}-{'f1_val': 0.7009169771696235, 'auprc': 0.7991458459820324, 'loss_val': 0.4668092163127838, 'psi': 0.7402085246945871}
[S16] START round=15 head_norm_before_train=1.661597 (no previous merge yet)
[S16] round=15 local utility u=0.109027 metrics={'f1_val': 0.5915821074723346, 'auprc': 0.8790773629465604, 'loss_val': 0.5737365120391439, 'psi': 0.7065802096620248}-{'f1_val': 0.5823182593325185, 'auprc': 0.842165553614294, 'loss_val': 0.6254725650900431, 'psi': 0.6862571770452287}
[S17] START round=15 head_norm_before_train=1.441285 cos_to_last_merge=0.8257 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.826
[S17] round=15 local utility u=0.000000 metrics={'f1_val': 0.39784231488036315, 'auprc': 0.6913046229065849, 'loss_val': 0.7023705481897901, 'psi': 0.5152272380908518}-{'f1_val': 0.41830815999105225, 'auprc': 0.8504068738462505, 'loss_val': 0.5744543813723981, 'psi': 0.5911476455331316}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:59812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S4@127.0.0.1:59804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S11] → sending delta(kind=head bytes=1789) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:59807
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:59804
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:59810
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:59807
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:59814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:59814
[S8] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1804 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1789 to 1 peers)
[S10] sending update (kind=head size=1805 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1796) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.104383)
[S9] loaded HEAD from S5 (vec_in norm=1.104383)
[S9] cosine check vs S5: cos=0.6068
[S9] BUFFERED delta from S5 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1789) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.959183)
[S9] loaded HEAD from S11 (vec_in norm=0.959183)
[S9] cosine check vs S11: cos=0.7674
[S9] BUFFERED delta from S11 (total buffered=2)
[S14] RECEIVED delta(kind=head bytes=1797) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.970806)
[S14] loaded HEAD from S15 (vec_in norm=0.970806)
[S14] cosine check vs S15: cos=0.3562
[S14] BUFFERED delta from S15 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1804) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.690373)
[S4] loaded HEAD from S16 (vec_in norm=1.690373)
[S4] cosine check vs S16: cos=0.5549
[S4] BUFFERED delta from S16 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1801) from S8
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.915498)
[S6] loaded HEAD from S8 (vec_in norm=1.915498)
[S6] cosine check vs S8: cos=0.0475
[S6] BUFFERED delta from S8 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1803) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.180498)
[S6] loaded HEAD from S7 (vec_in norm=1.180498)
[S6] cosine check vs S7: cos=0.1657
[S6] BUFFERED delta from S7 (total buffered=2)
[S11] RECEIVED delta(kind=head bytes=1798) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.928846)
[S11] loaded HEAD from S14 (vec_in norm=0.928846)
[S11] cosine check vs S14: cos=0.7704
[S11] BUFFERED delta from S14 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1805) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.947916)
[S4] loaded HEAD from S10 (vec_in norm=1.947916)
[S4] cosine check vs S10: cos=0.8218
[S4] BUFFERED delta from S10 (total buffered=2)
[S14] RECEIVED delta(kind=head bytes=1795) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.880909)
[S14] loaded HEAD from S9 (vec_in norm=0.880909)
[S14] cosine check vs S9: cos=0.9444
[S14] BUFFERED delta from S9 (total buffered=2)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] ⇄ pheromone p=0.113 → S9@127.0.0.1:59810
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=15 metric=0.8990 head_norm=1.160095
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.484971e-01
[S6] stored merged vector for next round verification (round=15)
[S6] DEBUG after merge:  round=15 metric=0.9041 head_norm=0.852323 delta_norm=0.748497
[S6] aggregate: ACCEPT kept=['S8', 'S7'] (k=2/2) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.208 → S15@127.0.0.1:59815
[S3] ⇄ pheromone p=0.146 → S2@127.0.0.1:59802
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=15 metric=0.9410 head_norm=1.402712
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.794631e-01
[S4] stored merged vector for next round verification (round=15)
[S4] DEBUG after merge:  round=15 metric=0.9410 head_norm=1.346388 delta_norm=0.179463
[S4] aggregate: ACCEPT kept=['S16', 'S10'] (k=2/2) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.231 → S5@127.0.0.1:59805
[S2] ⇄ pheromone p=0.193 → S6@127.0.0.1:59807
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=15 metric=0.7017 head_norm=0.959183
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.201523e-01
[S11] stored merged vector for next round verification (round=15)
[S11] DEBUG after merge:  round=15 metric=0.7017 head_norm=0.888198 delta_norm=0.320152
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.153 → S9@127.0.0.1:59810
[S8] ⇄ pheromone p=0.150 → S6@127.0.0.1:59807
[S7] ⇄ pheromone p=0.319 → S6@127.0.0.1:59807
[S16] ⇄ pheromone p=0.193 → S4@127.0.0.1:59804
[S15] ⇄ pheromone p=0.292 → S14@127.0.0.1:59814
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=15 metric=0.6888 head_norm=0.928846
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.851482e-01
[S14] stored merged vector for next round verification (round=15)
[S14] DEBUG after merge:  round=15 metric=0.6866 head_norm=0.792658 delta_norm=0.285148
[S14] aggregate: ACCEPT kept=['S15', 'S9'] (k=2/2) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.255 → S11@127.0.0.1:59812
[S10] ⇄ pheromone p=0.129 → S4@127.0.0.1:59804
[S5] ⇄ pheromone p=0.193 → S9@127.0.0.1:59810
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=15 metric=0.7013 head_norm=0.880909
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.306057e-01
[S9] stored merged vector for next round verification (round=15)
[S9] DEBUG after merge:  round=15 metric=0.7013 head_norm=0.820108 delta_norm=0.230606
[S9] aggregate: ACCEPT kept=['S5', 'S11'] (k=2/2) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.151 → S14@127.0.0.1:59814
[S17] ⇄ pheromone p=0.157 → S5@127.0.0.1:59805
[S2] START round=16 head_norm_before_train=1.599566 cos_to_last_merge=0.9875 (last merge round=13)
[S2] round=16 local utility u=0.311983 metrics={'f1_val': 0.8219221166224047, 'auprc': 0.9237759333313527, 'loss_val': 0.31713376244245917, 'psi': 0.8626636433059839}-{'f1_val': 0.7053235228089023, 'auprc': 0.9504148941741132, 'loss_val': 0.3214259926241331, 'psi': 0.8033600713549867}
[S3] START round=16 head_norm_before_train=1.580642 (no previous merge yet)
[S3] round=16 local utility u=0.149697 metrics={'f1_val': 0.6779504562005798, 'auprc': 0.9933064144414001, 'loss_val': 0.3327385323695566, 'psi': 0.8040928394969079}-{'f1_val': 0.640835580446145, 'auprc': 0.990841160675229, 'loss_val': 0.4020479152646505, 'psi': 0.7808378125377786}
[S4] START round=16 head_norm_before_train=1.346388 cos_to_last_merge=1.0000 (last merge round=15)
[S4] round=16 local utility u=0.000000 metrics={'f1_val': 0.9360818410037937, 'auprc': 0.9387707353493242, 'loss_val': 0.35851358440126496, 'psi': 0.9371573987420059}-{'f1_val': 0.9409774363037859, 'auprc': 0.9489425207540474, 'loss_val': 0.347503230199257, 'psi': 0.9441634700838906}
[S5] START round=16 head_norm_before_train=1.104383 cos_to_last_merge=0.9987 (last merge round=14)
[S5] round=16 local utility u=0.000000 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.7658732804322145, 'loss_val': 0.4351612106295597, 'psi': 0.7267147685763542}-{'f1_val': 0.7091547584171244, 'auprc': 0.7915516284219277, 'loss_val': 0.5005759232425758, 'psi': 0.7421135064190457}
[S6] START round=16 head_norm_before_train=0.852323 cos_to_last_merge=1.0000 (last merge round=15)
[S6] round=16 local utility u=0.106324 metrics={'f1_val': 0.9485804422237563, 'auprc': 0.962903372073673, 'loss_val': 0.5742881743479747, 'psi': 0.9543096141637231}-{'f1_val': 0.8990115532233967, 'auprc': 0.9665883328555922, 'loss_val': 0.5005783812721788, 'psi': 0.926042265076275}
[S7] START round=16 head_norm_before_train=1.180498 cos_to_last_merge=0.8646 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.865
[S7] round=16 local utility u=0.000000 metrics={'f1_val': 0.6281397177705652, 'auprc': 0.8149566236449233, 'loss_val': 0.6382354661566852, 'psi': 0.7028664801203084}-{'f1_val': 0.6810340872178713, 'auprc': 0.8013188914414735, 'loss_val': 0.5086093972750338, 'psi': 0.7291480089073121}
[S8] START round=16 head_norm_before_train=1.915498 (no previous merge yet)
[S8] round=16 local utility u=0.008466 metrics={'f1_val': 0.9943513027344518, 'auprc': 0.9991994360458865, 'loss_val': 0.03565684839658965, 'psi': 0.9962905560590256}-{'f1_val': 0.9926457841098181, 'auprc': 0.9992186692900545, 'loss_val': 0.04241262003188346, 'psi': 0.9952749381819126}
[S9] START round=16 head_norm_before_train=0.820108 cos_to_last_merge=1.0000 (last merge round=15)
[S9] round=16 local utility u=0.007301 metrics={'f1_val': 0.7012888352718426, 'auprc': 0.9977629326491964, 'loss_val': 0.36771832456042375, 'psi': 0.8198784742227841}-{'f1_val': 0.7012904835408967, 'auprc': 0.997991396923483, 'loss_val': 0.3830157949522105, 'psi': 0.8199708488939312}
[S10] START round=16 head_norm_before_train=1.947916 (no previous merge yet)
[S10] round=16 local utility u=0.000000 metrics={'f1_val': 0.9936518403636662, 'auprc': 0.9929344591394622, 'loss_val': 0.0435557251273503, 'psi': 0.9933648878739846}-{'f1_val': 0.9935679896985945, 'auprc': 0.9941004322614191, 'loss_val': 0.046061307408413896, 'psi': 0.9937809667237243}
[S11] START round=16 head_norm_before_train=0.888198 cos_to_last_merge=1.0000 (last merge round=15)
[S11] round=16 local utility u=0.000624 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9978141123273975, 'loss_val': 0.3701865822291585, 'psi': 0.820286834909951}-{'f1_val': 0.7016934795869249, 'auprc': 0.9971021585266424, 'loss_val': 0.36784695902035913, 'psi': 0.8198569511628119}
[S13] START round=16 head_norm_before_train=1.733959 (no previous merge yet)
[S13] round=16 local utility u=0.227951 metrics={'f1_val': 0.6175605136754699, 'auprc': 0.6133550163599741, 'loss_val': 0.6028149185608039, 'psi': 0.6158783147492716}-{'f1_val': 0.5812724007746702, 'auprc': 0.6067264497343043, 'loss_val': 0.8211020933963606, 'psi': 0.5914540203585239}
[S14] START round=16 head_norm_before_train=0.792658 cos_to_last_merge=1.0000 (last merge round=15)
[S14] round=16 local utility u=0.090291 metrics={'f1_val': 0.6996417459439656, 'auprc': 0.9961090128668998, 'loss_val': 0.4828932193314309, 'psi': 0.8182286527131393}-{'f1_val': 0.6887946161912328, 'auprc': 0.990297959729565, 'loss_val': 0.5809589846127835, 'psi': 0.8093959536065658}
[S15] START round=16 head_norm_before_train=0.970806 cos_to_last_merge=0.9926 (last merge round=14)
[S15] round=16 local utility u=0.150310 metrics={'f1_val': 0.8352580861647588, 'auprc': 0.9433317189924301, 'loss_val': 0.3498962791879338, 'psi': 0.8784875392958273}-{'f1_val': 0.8258214134245451, 'auprc': 0.9120280986661558, 'loss_val': 0.49998443721327135, 'psi': 0.8603040875211894}
[S16] START round=16 head_norm_before_train=1.690373 (no previous merge yet)
[S16] round=16 local utility u=1.000000 metrics={'f1_val': 0.8765783994880858, 'auprc': 0.9756182363743453, 'loss_val': 0.30194136998459603, 'psi': 0.9161943342425897}-{'f1_val': 0.5915821074723346, 'auprc': 0.8790773629465604, 'loss_val': 0.5737365120391439, 'psi': 0.7065802096620248}
[S17] START round=16 head_norm_before_train=1.479161 cos_to_last_merge=0.8239 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.824
[S17] round=16 local utility u=0.535231 metrics={'f1_val': 0.5440912726236954, 'auprc': 0.7543385804044165, 'loss_val': 0.6985032840085728, 'psi': 0.6281901957359839}-{'f1_val': 0.39784231488036315, 'auprc': 0.6913046229065849, 'loss_val': 0.7023705481897901, 'psi': 0.5152272380908518}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] → sending delta(kind=head bytes=1792) to S11@127.0.0.1:59812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:59814
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:59814
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:59810
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] → sending delta(kind=head bytes=1805) to S2@127.0.0.1:59802
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:59804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:59815
[S2] sending update (kind=head size=1795 to 1 peers)
[S3] sending update (kind=head size=1805 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1805 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1792 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1805) from S3
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.606842)
[S2] loaded HEAD from S3 (vec_in norm=1.606842)
[S2] cosine check vs S3: cos=0.9471
[S2] BUFFERED delta from S3 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1799) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.052114)
[S14] loaded HEAD from S15 (vec_in norm=1.052114)
[S14] cosine check vs S15: cos=0.5931
[S14] BUFFERED delta from S15 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1800) from S13
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.742294)
[S9] loaded HEAD from S13 (vec_in norm=1.742294)
[S9] cosine check vs S13: cos=0.3674
[S9] BUFFERED delta from S13 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1795) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.881741)
[S14] loaded HEAD from S9 (vec_in norm=0.881741)
[S14] cosine check vs S9: cos=0.8680
[S14] BUFFERED delta from S9 (total buffered=2)
[S9] RECEIVED delta(kind=head bytes=1794) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.951627)
[S9] loaded HEAD from S11 (vec_in norm=0.951627)
[S9] cosine check vs S11: cos=0.8790
[S9] BUFFERED delta from S11 (total buffered=2)
[S4] RECEIVED delta(kind=head bytes=1800) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.717103)
[S4] loaded HEAD from S16 (vec_in norm=1.717103)
[S4] cosine check vs S16: cos=0.6081
[S4] BUFFERED delta from S16 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1795) from S2
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.633711)
[S6] loaded HEAD from S2 (vec_in norm=1.633711)
[S6] cosine check vs S2: cos=0.6419
[S6] BUFFERED delta from S2 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1805) from S8
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.938166)
[S6] loaded HEAD from S8 (vec_in norm=1.938166)
[S6] cosine check vs S8: cos=0.5153
[S6] BUFFERED delta from S8 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1802) from S6
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.906022)
[S15] loaded HEAD from S6 (vec_in norm=0.906022)
[S15] cosine check vs S6: cos=0.6289
[S15] BUFFERED delta from S6 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1792) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.847267)
[S11] loaded HEAD from S14 (vec_in norm=0.847267)
[S11] cosine check vs S14: cos=0.9443
[S11] BUFFERED delta from S14 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] → sending delta(kind=head bytes=1806) to S5@127.0.0.1:59805
[S17] sending update (kind=head size=1806 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1806) from S17
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.531631)
[S5] loaded HEAD from S17 (vec_in norm=1.531631)
[S5] cosine check vs S17: cos=0.8682
[S5] BUFFERED delta from S17 (total buffered=1)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=16 metric=0.9361 head_norm=1.407599
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.053747e-01
[S4] stored merged vector for next round verification (round=16)
[S4] DEBUG after merge:  round=16 metric=0.9367 head_norm=1.402617 delta_norm=0.705375
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=16 metric=0.7006 head_norm=1.136346
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.920715e-01
[S5] stored merged vector for next round verification (round=16)
[S5] DEBUG after merge:  round=16 metric=0.7006 head_norm=1.290298 delta_norm=0.392072
[S5] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=16 metric=0.7013 head_norm=0.881741
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.554385e-01
[S9] stored merged vector for next round verification (round=16)
[S9] DEBUG after merge:  round=16 metric=0.7013 head_norm=0.926501 delta_norm=0.455438
[S9] aggregate: ACCEPT kept=['S13', 'S11'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=16 metric=0.8353 head_norm=1.052114
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.268832e-01
[S15] stored merged vector for next round verification (round=16)
[S15] DEBUG after merge:  round=16 metric=0.8369 head_norm=0.884127 delta_norm=0.426883
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=16 metric=0.8219 head_norm=1.633711
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.637771e-01
[S2] stored merged vector for next round verification (round=16)
[S2] DEBUG after merge:  round=16 metric=0.8182 head_norm=1.598717 delta_norm=0.263777
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=16 metric=0.9486 head_norm=0.906022
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.375480e-01
[S6] stored merged vector for next round verification (round=16)
[S6] DEBUG after merge:  round=16 metric=0.9570 head_norm=1.057795 delta_norm=0.437548
[S6] aggregate: ACCEPT kept=['S2', 'S8'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=16 metric=0.7019 head_norm=0.951627
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.586771e-01
[S11] stored merged vector for next round verification (round=16)
[S11] DEBUG after merge:  round=16 metric=0.7019 head_norm=0.886876 delta_norm=0.158677
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=16 metric=0.6996 head_norm=0.847267
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.993707e-01
[S14] stored merged vector for next round verification (round=16)
[S14] DEBUG after merge:  round=16 metric=0.6996 head_norm=0.792661 delta_norm=0.199371
[S14] aggregate: ACCEPT kept=['S15', 'S9'] (k=2/2) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.598717 cos_to_last_merge=1.0000 (last merge round=16)
[S2] round=17 local utility u=0.070171 metrics={'f1_val': 0.8279855843529772, 'auprc': 0.9568886190977052, 'loss_val': 0.31251080822921173, 'psi': 0.8795467982508685}-{'f1_val': 0.8219221166224047, 'auprc': 0.9237759333313527, 'loss_val': 0.31713376244245917, 'psi': 0.8626636433059839}
[S3] START round=17 head_norm_before_train=1.606842 (no previous merge yet)
[S3] round=17 local utility u=0.060838 metrics={'f1_val': 0.6886507686525366, 'auprc': 0.9933068760578192, 'loss_val': 0.2752648871545192, 'psi': 0.8105132116146496}-{'f1_val': 0.6779504562005798, 'auprc': 0.9933064144414001, 'loss_val': 0.3327385323695566, 'psi': 0.8040928394969079}
[S4] START round=17 head_norm_before_train=1.402617 cos_to_last_merge=1.0000 (last merge round=16)
[S4] round=17 local utility u=0.064126 metrics={'f1_val': 0.9472516557478742, 'auprc': 0.9550745904147702, 'loss_val': 0.3461915202444329, 'psi': 0.9503808296146325}-{'f1_val': 0.9360818410037937, 'auprc': 0.9387707353493242, 'loss_val': 0.35851358440126496, 'psi': 0.9371573987420059}
[S5] START round=17 head_norm_before_train=1.290298 cos_to_last_merge=1.0000 (last merge round=16)
[S5] round=17 local utility u=0.060292 metrics={'f1_val': 0.7056830987950715, 'auprc': 0.7913891625307536, 'loss_val': 0.42156848498224864, 'psi': 0.7399655242893444}-{'f1_val': 0.7006090940057808, 'auprc': 0.7658732804322145, 'loss_val': 0.4351612106295597, 'psi': 0.7267147685763542}
[S6] START round=17 head_norm_before_train=1.057795 cos_to_last_merge=1.0000 (last merge round=16)
[S6] round=17 local utility u=0.000000 metrics={'f1_val': 0.8770443104061927, 'auprc': 0.9559789992745702, 'loss_val': 0.5860510755389873, 'psi': 0.9086181859535436}-{'f1_val': 0.9485804422237563, 'auprc': 0.962903372073673, 'loss_val': 0.5742881743479747, 'psi': 0.9543096141637231}
[S7] START round=17 head_norm_before_train=1.209229 cos_to_last_merge=0.8538 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.854
[S7] round=17 local utility u=0.439914 metrics={'f1_val': 0.6932235404647593, 'auprc': 0.9007231092081264, 'loss_val': 0.4062091342874931, 'psi': 0.7762233679621061}-{'f1_val': 0.6281397177705652, 'auprc': 0.8149566236449233, 'loss_val': 0.6382354661566852, 'psi': 0.7028664801203084}
[S8] START round=17 head_norm_before_train=1.938166 (no previous merge yet)
[S8] round=17 local utility u=0.000000 metrics={'f1_val': 0.9937407205431326, 'auprc': 0.9991437033136056, 'loss_val': 0.034158128709102384, 'psi': 0.9959019136513219}-{'f1_val': 0.9943513027344518, 'auprc': 0.9991994360458865, 'loss_val': 0.03565684839658965, 'psi': 0.9962905560590256}
[S9] START round=17 head_norm_before_train=0.926501 cos_to_last_merge=1.0000 (last merge round=16)
[S9] round=17 local utility u=0.020161 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9986196898296278, 'loss_val': 0.32997643020551554, 'psi': 0.8202221660563892}-{'f1_val': 0.7012888352718426, 'auprc': 0.9977629326491964, 'loss_val': 0.36771832456042375, 'psi': 0.8198784742227841}
[S10] START round=17 head_norm_before_train=1.980413 (no previous merge yet)
[S10] round=17 local utility u=0.000220 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9922595359570274, 'loss_val': 0.04058823844766959, 'psi': 0.9930446082019676}-{'f1_val': 0.9936518403636662, 'auprc': 0.9929344591394622, 'loss_val': 0.0435557251273503, 'psi': 0.9933648878739846}
[S11] START round=17 head_norm_before_train=0.886876 cos_to_last_merge=1.0000 (last merge round=16)
[S11] round=17 local utility u=0.767279 metrics={'f1_val': 0.9571108743110381, 'auprc': 0.9955408963375407, 'loss_val': 0.35986231847621386, 'psi': 0.9724828831216392}-{'f1_val': 0.7019353166316534, 'auprc': 0.9978141123273975, 'loss_val': 0.3701865822291585, 'psi': 0.820286834909951}
[S13] START round=17 head_norm_before_train=1.742294 (no previous merge yet)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.5498774543676456, 'auprc': 0.6418114750815487, 'loss_val': 0.8517946874203715, 'psi': 0.5866510626532069}-{'f1_val': 0.6175605136754699, 'auprc': 0.6133550163599741, 'loss_val': 0.6028149185608039, 'psi': 0.6158783147492716}
[S14] START round=17 head_norm_before_train=0.792661 cos_to_last_merge=1.0000 (last merge round=16)
[S14] round=17 local utility u=0.000000 metrics={'f1_val': 0.6381156072387909, 'auprc': 0.9747373238731836, 'loss_val': 0.5264143660130634, 'psi': 0.772764293892548}-{'f1_val': 0.6996417459439656, 'auprc': 0.9961090128668998, 'loss_val': 0.4828932193314309, 'psi': 0.8182286527131393}
[S15] START round=17 head_norm_before_train=0.884127 cos_to_last_merge=1.0000 (last merge round=16)
[S15] round=17 local utility u=0.000000 metrics={'f1_val': 0.811515500457829, 'auprc': 0.9266850824989283, 'loss_val': 0.4496874296535356, 'psi': 0.8575833332742688}-{'f1_val': 0.8352580861647588, 'auprc': 0.9433317189924301, 'loss_val': 0.3498962791879338, 'psi': 0.8784875392958273}
[S16] START round=17 head_norm_before_train=1.717103 (no previous merge yet)
[S16] round=17 local utility u=0.000000 metrics={'f1_val': 0.8351120575865874, 'auprc': 0.9413360643903717, 'loss_val': 0.35848420095823036, 'psi': 0.877601660308101}-{'f1_val': 0.8765783994880858, 'auprc': 0.9756182363743453, 'loss_val': 0.30194136998459603, 'psi': 0.9161943342425897}
[S17] START round=17 head_norm_before_train=1.531631 cos_to_last_merge=0.8195 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.819
[S17] round=17 local utility u=0.170073 metrics={'f1_val': 0.5806495264820384, 'auprc': 0.8006044832908129, 'loss_val': 0.7165044438732281, 'psi': 0.6686315092055481}-{'f1_val': 0.5440912726236954, 'auprc': 0.7543385804044165, 'loss_val': 0.6985032840085728, 'psi': 0.6281901957359839}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:59804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] → sending delta(kind=head bytes=1805) to S2@127.0.0.1:59802
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:59810
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:59814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:59805
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1794 to 1 peers)
[S3] sending update (kind=head size=1805 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S9] sending update (kind=head size=1794 to 1 peers)
[S11] sending update (kind=head size=1793 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1802) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=2.002523)
[S4] loaded HEAD from S10 (vec_in norm=2.002523)
[S4] cosine check vs S10: cos=0.4381
[S4] BUFFERED delta from S10 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1794) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.982310)
[S14] loaded HEAD from S9 (vec_in norm=0.982310)
[S14] cosine check vs S9: cos=0.8250
[S14] BUFFERED delta from S9 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1795) from S2
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.635969)
[S6] loaded HEAD from S2 (vec_in norm=1.635969)
[S6] cosine check vs S2: cos=0.6995
[S6] BUFFERED delta from S2 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1805) from S3
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.633165)
[S2] loaded HEAD from S3 (vec_in norm=1.633165)
[S2] cosine check vs S3: cos=0.9794
[S2] BUFFERED delta from S3 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1793) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.946858)
[S9] loaded HEAD from S11 (vec_in norm=0.946858)
[S9] cosine check vs S11: cos=0.9031
[S9] BUFFERED delta from S11 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1804) from S4
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.464322)
[S5] loaded HEAD from S4 (vec_in norm=1.464322)
[S5] cosine check vs S4: cos=0.1939
[S5] BUFFERED delta from S4 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1794) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.313513)
[S9] loaded HEAD from S5 (vec_in norm=1.313513)
[S9] cosine check vs S5: cos=0.4478
[S9] BUFFERED delta from S5 (total buffered=2)
[S6] RECEIVED delta(kind=head bytes=1800) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.237939)
[S6] loaded HEAD from S7 (vec_in norm=1.237939)
[S6] cosine check vs S7: cos=0.1422
[S6] BUFFERED delta from S7 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:59805
[S17] sending update (kind=head size=1804 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1804) from S17
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.595733)
[S5] loaded HEAD from S17 (vec_in norm=1.595733)
[S5] cosine check vs S17: cos=0.9674
[S5] BUFFERED delta from S17 (total buffered=2)
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=17 metric=0.8770 head_norm=1.105459
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.214144e-01
[S6] stored merged vector for next round verification (round=17)
[S6] DEBUG after merge:  round=17 metric=0.9054 head_norm=0.952560 delta_norm=0.421414
[S6] aggregate: ACCEPT kept=['S2', 'S7'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=17 metric=0.6381 head_norm=0.842014
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.779999e-01
[S14] stored merged vector for next round verification (round=17)
[S14] DEBUG after merge:  round=17 metric=0.8599 head_norm=0.871594 delta_norm=0.278000
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=17 metric=0.8280 head_norm=1.635969
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.658467e-01
[S2] stored merged vector for next round verification (round=17)
[S2] DEBUG after merge:  round=17 metric=0.8269 head_norm=1.626132 delta_norm=0.165847
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=17 metric=0.7057 head_norm=1.313513
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.651505e-01
[S5] stored merged vector for next round verification (round=17)
[S5] DEBUG after merge:  round=17 metric=0.7040 head_norm=1.154864 delta_norm=0.365151
[S5] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=17 metric=0.9473 head_norm=1.464322
[S4] _apply_head_vector_avg (torch): Δ‖w‖=9.466751e-01
[S4] stored merged vector for next round verification (round=17)
[S4] DEBUG after merge:  round=17 metric=0.9422 head_norm=1.476812 delta_norm=0.946675
[S4] aggregate: ROLLBACK (f1_val pre=0.947 post=0.942 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=17 metric=0.7013 head_norm=0.982310
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.262645e-01
[S9] stored merged vector for next round verification (round=17)
[S9] DEBUG after merge:  round=17 metric=0.7013 head_norm=0.902957 delta_norm=0.326265
[S9] aggregate: ACCEPT kept=['S11', 'S5'] (k=2/2) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.626132 cos_to_last_merge=1.0000 (last merge round=17)
[S2] round=18 local utility u=0.000000 metrics={'f1_val': 0.8270124049890252, 'auprc': 0.9374534056481265, 'loss_val': 0.31738534722502926, 'psi': 0.8711888052526657}-{'f1_val': 0.8279855843529772, 'auprc': 0.9568886190977052, 'loss_val': 0.31251080822921173, 'psi': 0.8795467982508685}
[S3] START round=18 head_norm_before_train=1.633165 (no previous merge yet)
[S3] round=18 local utility u=0.000000 metrics={'f1_val': 0.6339811462621265, 'auprc': 0.9589078734278018, 'loss_val': 0.3413266318561868, 'psi': 0.7639518371283966}-{'f1_val': 0.6886507686525366, 'auprc': 0.9933068760578192, 'loss_val': 0.2752648871545192, 'psi': 0.8105132116146496}
[S4] START round=18 head_norm_before_train=1.476812 cos_to_last_merge=1.0000 (last merge round=17)
[S4] round=18 local utility u=0.025280 metrics={'f1_val': 0.9395213178000266, 'auprc': 0.9735816426973294, 'loss_val': 0.3047705045950241, 'psi': 0.9531454477589476}-{'f1_val': 0.9472516557478742, 'auprc': 0.9550745904147702, 'loss_val': 0.3461915202444329, 'psi': 0.9503808296146325}
[S5] START round=18 head_norm_before_train=1.154864 cos_to_last_merge=1.0000 (last merge round=17)
[S5] round=18 local utility u=0.000000 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.6918476970702784, 'loss_val': 0.41243871594461184, 'psi': 0.6971045352315799}-{'f1_val': 0.7056830987950715, 'auprc': 0.7913891625307536, 'loss_val': 0.42156848498224864, 'psi': 0.7399655242893444}
[S6] START round=18 head_norm_before_train=0.952560 cos_to_last_merge=1.0000 (last merge round=17)
[S6] round=18 local utility u=0.000000 metrics={'f1_val': 0.8443173011171352, 'auprc': 0.9674089149645573, 'loss_val': 0.4920616599302901, 'psi': 0.893553946656104}-{'f1_val': 0.8770443104061927, 'auprc': 0.9559789992745702, 'loss_val': 0.5860510755389873, 'psi': 0.9086181859535436}
[S7] START round=18 head_norm_before_train=1.237939 cos_to_last_merge=0.8453 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.845
[S7] round=18 local utility u=0.000000 metrics={'f1_val': 0.5617550464584495, 'auprc': 0.7844853047404212, 'loss_val': 0.7553113965574868, 'psi': 0.6508471497712383}-{'f1_val': 0.6932235404647593, 'auprc': 0.9007231092081264, 'loss_val': 0.4062091342874931, 'psi': 0.7762233679621061}
[S8] START round=18 head_norm_before_train=1.958669 (no previous merge yet)
[S8] round=18 local utility u=0.000000 metrics={'f1_val': 0.9599851941090664, 'auprc': 0.9885946228621216, 'loss_val': 0.096357284572339, 'psi': 0.9714289656102885}-{'f1_val': 0.9937407205431326, 'auprc': 0.9991437033136056, 'loss_val': 0.034158128709102384, 'psi': 0.9959019136513219}
[S9] START round=18 head_norm_before_train=0.902957 cos_to_last_merge=1.0000 (last merge round=17)
[S9] round=18 local utility u=0.010701 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9981738661808528, 'loss_val': 0.3072378688489056, 'psi': 0.8200438365968792}-{'f1_val': 0.7012904835408967, 'auprc': 0.9986196898296278, 'loss_val': 0.32997643020551554, 'psi': 0.8202221660563892}
[S10] START round=18 head_norm_before_train=2.002523 (no previous merge yet)
[S10] round=18 local utility u=0.000000 metrics={'f1_val': 0.9938337578714179, 'auprc': 0.9917854825312408, 'loss_val': 0.04527643918884124, 'psi': 0.9930144477353471}-{'f1_val': 0.9935679896985945, 'auprc': 0.9922595359570274, 'loss_val': 0.04058823844766959, 'psi': 0.9930446082019676}
[S11] START round=18 head_norm_before_train=0.946858 cos_to_last_merge=0.9968 (last merge round=16)
[S11] round=18 local utility u=0.102673 metrics={'f1_val': 0.981169186686789, 'auprc': 0.9946762889746431, 'loss_val': 0.2962726449849561, 'psi': 0.9865720276019305}-{'f1_val': 0.9571108743110381, 'auprc': 0.9955408963375407, 'loss_val': 0.35986231847621386, 'psi': 0.9724828831216392}
[S13] START round=18 head_norm_before_train=1.751848 (no previous merge yet)
[S13] round=18 local utility u=0.262101 metrics={'f1_val': 0.5878310855662393, 'auprc': 0.6563536564872785, 'loss_val': 0.5989406189761638, 'psi': 0.615240113934655}-{'f1_val': 0.5498774543676456, 'auprc': 0.6418114750815487, 'loss_val': 0.8517946874203715, 'psi': 0.5866510626532069}
[S14] START round=18 head_norm_before_train=0.871594 cos_to_last_merge=1.0000 (last merge round=17)
[S14] round=18 local utility u=0.983675 metrics={'f1_val': 0.9433340656811267, 'auprc': 0.9969886423613237, 'loss_val': 0.4571287255712057, 'psi': 0.9647958963532055}-{'f1_val': 0.6381156072387909, 'auprc': 0.9747373238731836, 'loss_val': 0.5264143660130634, 'psi': 0.772764293892548}
[S15] START round=18 head_norm_before_train=0.965204 cos_to_last_merge=0.9871 (last merge round=16)
[S15] round=18 local utility u=0.769296 metrics={'f1_val': 0.9915973629788402, 'auprc': 0.9924784978892379, 'loss_val': 0.1889665734485084, 'psi': 0.9919498169429992}-{'f1_val': 0.811515500457829, 'auprc': 0.9266850824989283, 'loss_val': 0.4496874296535356, 'psi': 0.8575833332742688}
[S16] START round=18 head_norm_before_train=1.744040 (no previous merge yet)
[S16] round=18 local utility u=0.174665 metrics={'f1_val': 0.8733166358693061, 'auprc': 0.9933878347870705, 'loss_val': 0.3945374050980331, 'psi': 0.9213451154364118}-{'f1_val': 0.8351120575865874, 'auprc': 0.9413360643903717, 'loss_val': 0.35848420095823036, 'psi': 0.877601660308101}
[S17] START round=18 head_norm_before_train=1.595733 cos_to_last_merge=0.8146 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.815
[S17] round=18 local utility u=0.316219 metrics={'f1_val': 0.6219220781913466, 'auprc': 0.9009066158517228, 'loss_val': 0.6326076581439459, 'psi': 0.733515893255497}-{'f1_val': 0.5806495264820384, 'auprc': 0.8006044832908129, 'loss_val': 0.7165044438732281, 'psi': 0.6686315092055481}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:59804
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:59814
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:59814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:59805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:59812
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:59810
[S13] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.080130)
[S14] loaded HEAD from S15 (vec_in norm=1.080130)
[S14] cosine check vs S15: cos=0.4602
[S14] BUFFERED delta from S15 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1798) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.772260)
[S4] loaded HEAD from S16 (vec_in norm=1.772260)
[S4] cosine check vs S16: cos=0.4726
[S4] BUFFERED delta from S16 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1798) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.915444)
[S11] loaded HEAD from S14 (vec_in norm=0.915444)
[S11] cosine check vs S14: cos=0.9550
[S11] BUFFERED delta from S14 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1794) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.013057)
[S9] loaded HEAD from S11 (vec_in norm=1.013057)
[S9] cosine check vs S11: cos=0.8747
[S9] BUFFERED delta from S11 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1796) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.953974)
[S14] loaded HEAD from S9 (vec_in norm=0.953974)
[S14] cosine check vs S9: cos=0.9296
[S14] BUFFERED delta from S9 (total buffered=2)
[S9] RECEIVED delta(kind=head bytes=1797) from S13
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.756763)
[S9] loaded HEAD from S13 (vec_in norm=1.756763)
[S9] cosine check vs S13: cos=0.5343
[S9] BUFFERED delta from S13 (total buffered=2)
[S5] RECEIVED delta(kind=head bytes=1796) from S4
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.553676)
[S5] loaded HEAD from S4 (vec_in norm=1.553676)
[S5] cosine check vs S4: cos=0.4172
[S5] BUFFERED delta from S4 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:59805
[S17] sending update (kind=head size=1802 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1802) from S17
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.647218)
[S5] loaded HEAD from S17 (vec_in norm=1.647218)
[S5] cosine check vs S17: cos=0.8994
[S5] BUFFERED delta from S17 (total buffered=2)
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=18 metric=0.7006 head_norm=1.181944
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.434080e-01
[S5] stored merged vector for next round verification (round=18)
[S5] DEBUG after merge:  round=18 metric=0.7006 head_norm=1.147972 delta_norm=0.243408
[S5] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=18 metric=0.9395 head_norm=1.553676
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.590750e-01
[S4] stored merged vector for next round verification (round=18)
[S4] DEBUG after merge:  round=18 metric=0.9394 head_norm=1.428074 delta_norm=0.859075
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=18 metric=0.7013 head_norm=0.953974
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.863940e-01
[S9] stored merged vector for next round verification (round=18)
[S9] DEBUG after merge:  round=18 metric=0.7013 head_norm=1.009818 delta_norm=0.386394
[S9] aggregate: ACCEPT kept=['S11', 'S13'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=18 metric=0.9433 head_norm=0.915444
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.316978e-01
[S14] stored merged vector for next round verification (round=18)
[S14] DEBUG after merge:  round=18 metric=0.9328 head_norm=0.828930 delta_norm=0.231698
[S14] aggregate: ROLLBACK (f1_val pre=0.943 post=0.933 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=18 metric=0.9812 head_norm=1.013057
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.524293e-01
[S11] stored merged vector for next round verification (round=18)
[S11] DEBUG after merge:  round=18 metric=0.9580 head_norm=0.953377 delta_norm=0.152429
[S11] aggregate: ROLLBACK (f1_val pre=0.981 post=0.958 tol_abs=0.005 tol_rel=0.0)
[S2] START round=19 head_norm_before_train=1.678749 cos_to_last_merge=0.9984 (last merge round=17)
[S2] round=19 local utility u=0.110798 metrics={'f1_val': 0.8307992575977177, 'auprc': 0.9830728779904611, 'loss_val': 0.2553690520462816, 'psi': 0.891708705754815}-{'f1_val': 0.8270124049890252, 'auprc': 0.9374534056481265, 'loss_val': 0.31738534722502926, 'psi': 0.8711888052526657}
[S3] START round=19 head_norm_before_train=1.662074 (no previous merge yet)
[S3] round=19 local utility u=0.326207 metrics={'f1_val': 0.700330919019862, 'auprc': 0.9947260228221849, 'loss_val': 0.1944666269632355, 'psi': 0.8180889605407912}-{'f1_val': 0.6339811462621265, 'auprc': 0.9589078734278018, 'loss_val': 0.3413266318561868, 'psi': 0.7639518371283966}
[S4] START round=19 head_norm_before_train=1.428074 cos_to_last_merge=1.0000 (last merge round=18)
[S4] round=19 local utility u=0.000000 metrics={'f1_val': 0.9437203854692784, 'auprc': 0.9659757135059546, 'loss_val': 0.30889475505116254, 'psi': 0.9526225166839488}-{'f1_val': 0.9395213178000266, 'auprc': 0.9735816426973294, 'loss_val': 0.3047705045950241, 'psi': 0.9531454477589476}
[S5] START round=19 head_norm_before_train=1.147972 cos_to_last_merge=1.0000 (last merge round=18)
[S5] round=19 local utility u=0.455944 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9913662922124876, 'loss_val': 0.39910139230061, 'psi': 0.8169115524825996}-{'f1_val': 0.7006090940057808, 'auprc': 0.6918476970702784, 'loss_val': 0.41243871594461184, 'psi': 0.6971045352315799}
[S6] START round=19 head_norm_before_train=1.030152 cos_to_last_merge=0.9874 (last merge round=17)
[S6] round=19 local utility u=0.488656 metrics={'f1_val': 0.9619600947348879, 'auprc': 0.9837790257786241, 'loss_val': 0.26971721174709373, 'psi': 0.9706876671523823}-{'f1_val': 0.8443173011171352, 'auprc': 0.9674089149645573, 'loss_val': 0.4920616599302901, 'psi': 0.893553946656104}
[S7] START round=19 head_norm_before_train=1.257976 cos_to_last_merge=0.8398 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.840
[S7] round=19 local utility u=0.131663 metrics={'f1_val': 0.5950211785934076, 'auprc': 0.787000839357781, 'loss_val': 0.6991280315204184, 'psi': 0.6718130428991569}-{'f1_val': 0.5617550464584495, 'auprc': 0.7844853047404212, 'loss_val': 0.7553113965574868, 'psi': 0.6508471497712383}
[S8] START round=19 head_norm_before_train=1.979715 (no previous merge yet)
[S8] round=19 local utility u=0.037493 metrics={'f1_val': 0.966675604784054, 'auprc': 0.9990656083448199, 'loss_val': 0.09292578290793632, 'psi': 0.9796316062083603}-{'f1_val': 0.9599851941090664, 'auprc': 0.9885946228621216, 'loss_val': 0.096357284572339, 'psi': 0.9714289656102885}
[S9] START round=19 head_norm_before_train=1.009818 cos_to_last_merge=1.0000 (last merge round=18)
[S9] round=19 local utility u=0.025352 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9986429095477001, 'loss_val': 0.25794153006053055, 'psi': 0.8202314539436181}-{'f1_val': 0.7012904835408967, 'auprc': 0.9981738661808528, 'loss_val': 0.3072378688489056, 'psi': 0.8200438365968792}
[S10] START round=19 head_norm_before_train=2.024957 (no previous merge yet)
[S10] round=19 local utility u=0.004288 metrics={'f1_val': 0.9933489306849028, 'auprc': 0.9938442961128061, 'loss_val': 0.03996819938317575, 'psi': 0.9935470768560641}-{'f1_val': 0.9938337578714179, 'auprc': 0.9917854825312408, 'loss_val': 0.04527643918884124, 'psi': 0.9930144477353471}
[S11] START round=19 head_norm_before_train=0.953377 cos_to_last_merge=1.0000 (last merge round=18)
[S11] round=19 local utility u=0.008742 metrics={'f1_val': 0.9831068072057609, 'auprc': 0.9945673263232564, 'loss_val': 0.29008706288600195, 'psi': 0.9876910148527591}-{'f1_val': 0.981169186686789, 'auprc': 0.9946762889746431, 'loss_val': 0.2962726449849561, 'psi': 0.9865720276019305}
[S13] START round=19 head_norm_before_train=1.756763 (no previous merge yet)
[S13] round=19 local utility u=0.000000 metrics={'f1_val': 0.5788155686327703, 'auprc': 0.6813113507558072, 'loss_val': 0.697280194137415, 'psi': 0.619813881481985}-{'f1_val': 0.5878310855662393, 'auprc': 0.6563536564872785, 'loss_val': 0.5989406189761638, 'psi': 0.615240113934655}
[S14] START round=19 head_norm_before_train=0.828930 cos_to_last_merge=1.0000 (last merge round=18)
[S14] round=19 local utility u=0.000000 metrics={'f1_val': 0.9204415826602106, 'auprc': 0.8744789028483044, 'loss_val': 0.5758859428431348, 'psi': 0.9020565107354481}-{'f1_val': 0.9433340656811267, 'auprc': 0.9969886423613237, 'loss_val': 0.4571287255712057, 'psi': 0.9647958963532055}
[S15] START round=19 head_norm_before_train=1.080130 cos_to_last_merge=0.9577 (last merge round=16)
[S15] round=19 local utility u=0.000000 metrics={'f1_val': 0.7941670382235694, 'auprc': 0.9727259220363953, 'loss_val': 0.2977724692747391, 'psi': 0.8655905917486998}-{'f1_val': 0.9915973629788402, 'auprc': 0.9924784978892379, 'loss_val': 0.1889665734485084, 'psi': 0.9919498169429992}
[S16] START round=19 head_norm_before_train=1.772260 (no previous merge yet)
[S16] round=19 local utility u=0.469612 metrics={'f1_val': 0.9905203190107039, 'auprc': 0.9875836532077871, 'loss_val': 0.1411231985618089, 'psi': 0.9893456526895372}-{'f1_val': 0.8733166358693061, 'auprc': 0.9933878347870705, 'loss_val': 0.3945374050980331, 'psi': 0.9213451154364118}
[S17] START round=19 head_norm_before_train=1.647218 cos_to_last_merge=0.8112 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.811
[S17] round=19 local utility u=0.000000 metrics={'f1_val': 0.5765095370058724, 'auprc': 0.8647129479898011, 'loss_val': 0.7791108925795699, 'psi': 0.6917909013994439}-{'f1_val': 0.6219220781913466, 'auprc': 0.9009066158517228, 'loss_val': 0.6326076581439459, 'psi': 0.733515893255497}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:59815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:59807
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:59802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] → sending delta(kind=head bytes=1793) to S14@127.0.0.1:59814
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:59804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S11] → sending delta(kind=head bytes=1789) to S9@127.0.0.1:59810
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:59804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:59810
[S16] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1789 to 1 peers)
[S9] sending update (kind=head size=1793 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1798) from S6
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.131355)
[S15] loaded HEAD from S6 (vec_in norm=1.131355)
[S15] cosine check vs S6: cos=0.7195
[S15] BUFFERED delta from S6 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1797) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.183493)
[S9] loaded HEAD from S5 (vec_in norm=1.183493)
[S9] cosine check vs S5: cos=0.3844
[S9] BUFFERED delta from S5 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1793) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.056786)
[S14] loaded HEAD from S9 (vec_in norm=1.056786)
[S14] cosine check vs S9: cos=0.8626
[S14] BUFFERED delta from S9 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1803) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=2.046177)
[S4] loaded HEAD from S10 (vec_in norm=2.046177)
[S4] cosine check vs S10: cos=0.5157
[S4] BUFFERED delta from S10 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1798) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.799611)
[S4] loaded HEAD from S16 (vec_in norm=1.799611)
[S4] cosine check vs S16: cos=0.8611
[S4] BUFFERED delta from S16 (total buffered=2)
[S6] RECEIVED delta(kind=head bytes=1804) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.274427)
[S6] loaded HEAD from S7 (vec_in norm=1.274427)
[S6] cosine check vs S7: cos=0.3475
[S6] BUFFERED delta from S7 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1789) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.010497)
[S9] loaded HEAD from S11 (vec_in norm=1.010497)
[S9] cosine check vs S11: cos=0.8989
[S9] BUFFERED delta from S11 (total buffered=2)
[S6] RECEIVED delta(kind=head bytes=1803) from S8
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.994620)
[S6] loaded HEAD from S8 (vec_in norm=1.994620)
[S6] cosine check vs S8: cos=0.3438
[S6] BUFFERED delta from S8 (total buffered=2)
[S6] RECEIVED delta(kind=head bytes=1797) from S2
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.733084)
[S6] loaded HEAD from S2 (vec_in norm=1.733084)
[S6] cosine check vs S2: cos=0.7397
[S6] BUFFERED delta from S2 (total buffered=3)
[S2] RECEIVED delta(kind=head bytes=1801) from S3
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.692758)
[S2] loaded HEAD from S3 (vec_in norm=1.692758)
[S2] cosine check vs S3: cos=0.9782
[S2] BUFFERED delta from S3 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=19 metric=0.9204 head_norm=0.864779
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.683044e-01
[S14] stored merged vector for next round verification (round=19)
[S14] DEBUG after merge:  round=19 metric=0.9170 head_norm=0.927541 delta_norm=0.268304
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S14] r=20 psi=0.902 u=0.0000 p_local=0.2712 f1=0.920 auprc=0.874 bytes=17961
[S13] r=20 psi=0.620 u=0.0000 p_local=0.1115 f1=0.579 auprc=0.681 bytes=16168
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=19 metric=0.9437 head_norm=1.488519
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.662274e-01
[S4] stored merged vector for next round verification (round=19)
[S4] DEBUG after merge:  round=19 metric=0.9409 head_norm=1.417611 delta_norm=0.266227
[S4] aggregate: ACCEPT kept=['S10', 'S16'] (k=2/2) mode=median trim_p=0.1
[S4] r=20 psi=0.953 u=0.0000 p_local=0.1067 f1=0.944 auprc=0.966 bytes=18009
[S10] r=20 psi=0.994 u=0.0043 p_local=0.0539 f1=0.993 auprc=0.994 bytes=19808
[S5] r=20 psi=0.817 u=0.4559 p_local=0.1780 f1=0.701 auprc=0.991 bytes=19737
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=19 metric=0.7013 head_norm=1.056786
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.500057e-01
[S9] stored merged vector for next round verification (round=19)
[S9] DEBUG after merge:  round=19 metric=0.9912 head_norm=0.918089 delta_norm=0.350006
[S9] aggregate: ACCEPT kept=['S5', 'S11'] (k=2/2) mode=median trim_p=0.1
[S9] r=20 psi=0.820 u=0.0254 p_local=0.0722 f1=0.701 auprc=0.999 bytes=25136
[S16] r=20 psi=0.989 u=0.4696 p_local=0.3035 f1=0.991 auprc=0.988 bytes=21562
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=19 metric=0.8308 head_norm=1.733084
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.800679e-01
[S2] stored merged vector for next round verification (round=19)
[S2] DEBUG after merge:  round=19 metric=0.8313 head_norm=1.703549 delta_norm=0.180068
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] r=20 psi=0.892 u=0.1108 p_local=0.1423 f1=0.831 auprc=0.983 bytes=19766
[S6] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=19 metric=0.9620 head_norm=1.131355
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.170128e-01
[S6] stored merged vector for next round verification (round=19)
[S6] DEBUG after merge:  round=19 metric=0.9621 head_norm=1.002596 delta_norm=0.317013
[S6] aggregate: ACCEPT kept=['S7', 'S8', 'S2'] (k=3/3) mode=median trim_p=0.1
[S6] r=20 psi=0.971 u=0.4887 p_local=0.1940 f1=0.962 auprc=0.984 bytes=17981
[S3] r=20 psi=0.818 u=0.3262 p_local=0.1482 f1=0.700 auprc=0.995 bytes=19797
[S11] r=20 psi=0.988 u=0.0087 p_local=0.1792 f1=0.983 auprc=0.995 bytes=21518
[S7] r=20 psi=0.672 u=0.1317 p_local=0.2132 f1=0.595 auprc=0.787 bytes=17981
[S8] r=20 psi=0.980 u=0.0375 p_local=0.0699 f1=0.967 auprc=0.999 bytes=18013
[S17] r=20 psi=0.692 u=0.0000 p_local=0.1916 f1=0.577 auprc=0.865 bytes=21580
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=19 metric=0.7942 head_norm=1.183694
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.341410e-01
[S15] stored merged vector for next round verification (round=19)
[S15] DEBUG after merge:  round=19 metric=0.7907 head_norm=1.073345 delta_norm=0.434141
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S15] r=20 psi=0.866 u=0.0000 p_local=0.2581 f1=0.794 auprc=0.973 bytes=16183
[S2] START round=20 head_norm_before_train=1.703549 cos_to_last_merge=1.0000 (last merge round=19)
[S2] round=20 local utility u=0.000000 metrics={'f1_val': 0.829250698760343, 'auprc': 0.9852675214516182, 'loss_val': 0.26894229596599123, 'psi': 0.891657427836853}-{'f1_val': 0.8307992575977177, 'auprc': 0.9830728779904611, 'loss_val': 0.2553690520462816, 'psi': 0.891708705754815}
[S3] START round=20 head_norm_before_train=1.692758 (no previous merge yet)
[S3] round=20 local utility u=0.019414 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9968214838802607, 'loss_val': 0.16447600688247743, 'psi': 0.819182315793284}-{'f1_val': 0.700330919019862, 'auprc': 0.9947260228221849, 'loss_val': 0.1944666269632355, 'psi': 0.8180889605407912}
[S4] START round=20 head_norm_before_train=1.417611 cos_to_last_merge=1.0000 (last merge round=19)
[S4] round=20 local utility u=0.000000 metrics={'f1_val': 0.9467497487839088, 'auprc': 0.9525280001416242, 'loss_val': 0.29985480243216905, 'psi': 0.949061049326995}-{'f1_val': 0.9437203854692784, 'auprc': 0.9659757135059546, 'loss_val': 0.30889475505116254, 'psi': 0.9526225166839488}
[S5] START round=20 head_norm_before_train=1.183493 cos_to_last_merge=0.9988 (last merge round=18)
[S5] round=20 local utility u=0.000000 metrics={'f1_val': 0.7145330545296904, 'auprc': 0.7920478961529223, 'loss_val': 0.5678932770308014, 'psi': 0.7455389911789831}-{'f1_val': 0.7006083926626743, 'auprc': 0.9913662922124876, 'loss_val': 0.39910139230061, 'psi': 0.8169115524825996}
[S6] START round=20 head_norm_before_train=1.002596 cos_to_last_merge=1.0000 (last merge round=19)
[S6] round=20 local utility u=0.000000 metrics={'f1_val': 0.9513242735678756, 'auprc': 0.974664304795354, 'loss_val': 0.38856363235849706, 'psi': 0.960660286058867}-{'f1_val': 0.9619600947348879, 'auprc': 0.9837790257786241, 'loss_val': 0.26971721174709373, 'psi': 0.9706876671523823}
[S7] START round=20 head_norm_before_train=1.274427 cos_to_last_merge=0.8353 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.835
[S7] round=20 local utility u=0.541980 metrics={'f1_val': 0.6806857246610654, 'auprc': 0.8768060638232139, 'loss_val': 0.39857144145387885, 'psi': 0.7591338603259248}-{'f1_val': 0.5950211785934076, 'auprc': 0.787000839357781, 'loss_val': 0.6991280315204184, 'psi': 0.6718130428991569}
[S8] START round=20 head_norm_before_train=1.994620 (no previous merge yet)
[S8] round=20 local utility u=0.097120 metrics={'f1_val': 0.9897076210669344, 'auprc': 0.9992265188927419, 'loss_val': 0.037361511454487344, 'psi': 0.9935151801972575}-{'f1_val': 0.966675604784054, 'auprc': 0.9990656083448199, 'loss_val': 0.09292578290793632, 'psi': 0.9796316062083603}
[S9] START round=20 head_norm_before_train=0.918089 cos_to_last_merge=1.0000 (last merge round=19)
[S9] round=20 local utility u=0.891173 metrics={'f1_val': 0.9966857875385419, 'auprc': 0.998207891290538, 'loss_val': 0.24666290817893619, 'psi': 0.9972946290393403}-{'f1_val': 0.7012904835408967, 'auprc': 0.9986429095477001, 'loss_val': 0.25794153006053055, 'psi': 0.8202314539436181}
[S10] START round=20 head_norm_before_train=2.046177 (no previous merge yet)
[S10] round=20 local utility u=0.001195 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9937687119668746, 'loss_val': 0.038666201731489415, 'psi': 0.9936482786059064}-{'f1_val': 0.9933489306849028, 'auprc': 0.9938442961128061, 'loss_val': 0.03996819938317575, 'psi': 0.9935470768560641}
[S11] START round=20 head_norm_before_train=1.010497 cos_to_last_merge=0.9979 (last merge round=18)
[S11] round=20 local utility u=0.059667 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9933571248461099, 'loss_val': 0.24776298034364275, 'psi': 0.9952710526465978}-{'f1_val': 0.9831068072057609, 'auprc': 0.9945673263232564, 'loss_val': 0.29008706288600195, 'psi': 0.9876910148527591}
[S13] START round=20 head_norm_before_train=1.762005 (no previous merge yet)
[S13] round=20 local utility u=0.000000 metrics={'f1_val': 0.5563562806647024, 'auprc': 0.6850707396677234, 'loss_val': 0.6856981287286521, 'psi': 0.6078420642659108}-{'f1_val': 0.5788155686327703, 'auprc': 0.6813113507558072, 'loss_val': 0.697280194137415, 'psi': 0.619813881481985}
[S14] START round=20 head_norm_before_train=0.927541 cos_to_last_merge=1.0000 (last merge round=19)
[S14] round=20 local utility u=0.382739 metrics={'f1_val': 0.949478742705183, 'auprc': 0.9975204077484363, 'loss_val': 0.3537562829413798, 'psi': 0.9686954087224844}-{'f1_val': 0.9204415826602106, 'auprc': 0.8744789028483044, 'loss_val': 0.5758859428431348, 'psi': 0.9020565107354481}
[S15] START round=20 head_norm_before_train=1.073345 cos_to_last_merge=1.0000 (last merge round=19)
[S15] round=20 local utility u=0.656867 metrics={'f1_val': 0.9912110630593476, 'auprc': 0.9843702866970607, 'loss_val': 0.2012365309219055, 'psi': 0.9884747525144328}-{'f1_val': 0.7941670382235694, 'auprc': 0.9727259220363953, 'loss_val': 0.2977724692747391, 'psi': 0.8655905917486998}
[S16] START round=20 head_norm_before_train=1.799611 (no previous merge yet)
[S16] round=20 local utility u=0.000000 metrics={'f1_val': 0.8325167502100002, 'auprc': 0.9661112824559999, 'loss_val': 0.7153546229769057, 'psi': 0.8859545631084}-{'f1_val': 0.9905203190107039, 'auprc': 0.9875836532077871, 'loss_val': 0.1411231985618089, 'psi': 0.9893456526895372}
[S17] START round=20 head_norm_before_train=1.683387 cos_to_last_merge=0.8098 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.810
[S17] round=20 local utility u=0.000000 metrics={'f1_val': 0.5368785337333962, 'auprc': 0.7265658965594208, 'loss_val': 1.076458072180812, 'psi': 0.612753478863806}-{'f1_val': 0.5765095370058724, 'auprc': 0.8647129479898011, 'loss_val': 0.7791108925795699, 'psi': 0.6917909013994439}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:59807
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S9] → sending delta(kind=head bytes=1791) to S14@127.0.0.1:59814
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:59802
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:59804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:59807
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:59812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:59814
[S9] sending update (kind=head size=1791 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1791) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.962972)
[S14] loaded HEAD from S9 (vec_in norm=0.962972)
[S14] cosine check vs S9: cos=0.9443
[S14] BUFFERED delta from S9 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1803) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=2.065296)
[S4] loaded HEAD from S10 (vec_in norm=2.065296)
[S4] cosine check vs S10: cos=0.6479
[S4] BUFFERED delta from S10 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1800) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.292796)
[S6] loaded HEAD from S7 (vec_in norm=1.292796)
[S6] cosine check vs S7: cos=0.3778
[S6] BUFFERED delta from S7 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1800) from S8
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=2.006560)
[S6] loaded HEAD from S8 (vec_in norm=2.006560)
[S6] cosine check vs S8: cos=0.4924
[S6] BUFFERED delta from S8 (total buffered=2)
[S9] RECEIVED delta(kind=head bytes=1796) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.063288)
[S9] loaded HEAD from S11 (vec_in norm=1.063288)
[S9] cosine check vs S11: cos=0.8983
[S9] BUFFERED delta from S11 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1798) from S3
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.722675)
[S2] loaded HEAD from S3 (vec_in norm=1.722675)
[S2] cosine check vs S3: cos=0.9899
[S2] BUFFERED delta from S3 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1801) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.159648)
[S14] loaded HEAD from S15 (vec_in norm=1.159648)
[S14] cosine check vs S15: cos=0.3971
[S14] BUFFERED delta from S15 (total buffered=2)
[S11] RECEIVED delta(kind=head bytes=1794) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.970797)
[S11] loaded HEAD from S14 (vec_in norm=0.970797)
[S11] cosine check vs S14: cos=0.9508
[S11] BUFFERED delta from S14 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] ⇄ pheromone p=0.142 → S9@127.0.0.1:59810
[S13] ⇄ pheromone p=0.089 → S9@127.0.0.1:59810
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=20 metric=0.9467 head_norm=1.469268
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.892824e-01
[S4] stored merged vector for next round verification (round=20)
[S4] DEBUG after merge:  round=20 metric=0.9452 head_norm=1.609078 delta_norm=0.789282
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.085 → S5@127.0.0.1:59805
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=20 metric=0.9513 head_norm=1.060130
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.859649e-01
[S6] stored merged vector for next round verification (round=20)
[S6] DEBUG after merge:  round=20 metric=0.9548 head_norm=1.009344 delta_norm=0.485965
[S6] aggregate: ACCEPT kept=['S7', 'S8'] (k=2/2) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.155 → S15@127.0.0.1:59815
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=20 metric=0.8293 head_norm=1.742688
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.234260e-01
[S2] stored merged vector for next round verification (round=20)
[S2] DEBUG after merge:  round=20 metric=0.8300 head_norm=1.728309 delta_norm=0.123426
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.114 → S6@127.0.0.1:59807
[S16] ⇄ pheromone p=0.243 → S4@127.0.0.1:59804
[S8] ⇄ pheromone p=0.075 → S6@127.0.0.1:59807
[S7] ⇄ pheromone p=0.279 → S6@127.0.0.1:59807
[S15] ⇄ pheromone p=0.338 → S14@127.0.0.1:59814
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=20 metric=0.9965 head_norm=1.063288
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.659651e-01
[S11] stored merged vector for next round verification (round=20)
[S11] DEBUG after merge:  round=20 metric=0.9965 head_norm=1.004475 delta_norm=0.165965
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.155 → S9@127.0.0.1:59810
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=20 metric=0.9495 head_norm=0.970797
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.748596e-01
[S14] stored merged vector for next round verification (round=20)
[S14] DEBUG after merge:  round=20 metric=0.9372 head_norm=0.860503 delta_norm=0.274860
[S14] aggregate: ROLLBACK (f1_val pre=0.949 post=0.937 tol_abs=0.005 tol_rel=0.0)
[S14] ⇄ pheromone p=0.293 → S11@127.0.0.1:59812
[S3] ⇄ pheromone p=0.122 → S2@127.0.0.1:59802
[S10] ⇄ pheromone p=0.043 → S4@127.0.0.1:59804
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=20 metric=0.9967 head_norm=0.962972
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.336230e-01
[S9] stored merged vector for next round verification (round=20)
[S9] DEBUG after merge:  round=20 metric=0.9967 head_norm=0.987101 delta_norm=0.233623
[S9] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.236 → S14@127.0.0.1:59814
[S17] ⇄ pheromone p=0.153 → S5@127.0.0.1:59805
[S2] START round=21 head_norm_before_train=1.728309 cos_to_last_merge=1.0000 (last merge round=20)
[S2] round=21 local utility u=0.000000 metrics={'f1_val': 0.8191372799246006, 'auprc': 0.8857203091004224, 'loss_val': 0.3577288891764657, 'psi': 0.8457704915949293}-{'f1_val': 0.829250698760343, 'auprc': 0.9852675214516182, 'loss_val': 0.26894229596599123, 'psi': 0.891657427836853}
[S3] START round=21 head_norm_before_train=1.722675 (no previous merge yet)
[S3] round=21 local utility u=0.557238 metrics={'f1_val': 0.8836297850210368, 'auprc': 0.9984539436101953, 'loss_val': 0.15213948478839165, 'psi': 0.9295594484567002}-{'f1_val': 0.7007562037352997, 'auprc': 0.9968214838802607, 'loss_val': 0.16447600688247743, 'psi': 0.819182315793284}
[S4] START round=21 head_norm_before_train=1.609078 cos_to_last_merge=1.0000 (last merge round=20)
[S4] round=21 local utility u=0.000000 metrics={'f1_val': 0.9389347821115984, 'auprc': 0.9561860679767112, 'loss_val': 0.29468355221908327, 'psi': 0.9458352964576435}-{'f1_val': 0.9467497487839088, 'auprc': 0.9525280001416242, 'loss_val': 0.29985480243216905, 'psi': 0.949061049326995}
[S5] START round=21 head_norm_before_train=1.215199 cos_to_last_merge=0.9962 (last merge round=18)
[S5] round=21 local utility u=0.375065 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.9947277202538756, 'loss_val': 0.34225809404812246, 'psi': 0.8182565445050187}-{'f1_val': 0.7145330545296904, 'auprc': 0.7920478961529223, 'loss_val': 0.5678932770308014, 'psi': 0.7455389911789831}
[S6] START round=21 head_norm_before_train=1.009344 cos_to_last_merge=1.0000 (last merge round=20)
[S6] round=21 local utility u=0.000000 metrics={'f1_val': 0.8614102505184182, 'auprc': 0.9118757800076278, 'loss_val': 0.6560953584137859, 'psi': 0.8815964623141022}-{'f1_val': 0.9513242735678756, 'auprc': 0.974664304795354, 'loss_val': 0.38856363235849706, 'psi': 0.960660286058867}
[S7] START round=21 head_norm_before_train=1.292796 cos_to_last_merge=0.8306 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.831
[S7] round=21 local utility u=0.000000 metrics={'f1_val': 0.607703961640661, 'auprc': 0.7919918840875423, 'loss_val': 0.6500470675023772, 'psi': 0.6814191306194135}-{'f1_val': 0.6806857246610654, 'auprc': 0.8768060638232139, 'loss_val': 0.39857144145387885, 'psi': 0.7591338603259248}
[S8] START round=21 head_norm_before_train=2.006560 (no previous merge yet)
[S8] round=21 local utility u=0.012684 metrics={'f1_val': 0.9930102130034458, 'auprc': 0.9992210386236093, 'loss_val': 0.031793391928967386, 'psi': 0.9954945432515112}-{'f1_val': 0.9897076210669344, 'auprc': 0.9992265188927419, 'loss_val': 0.037361511454487344, 'psi': 0.9935151801972575}
[S9] START round=21 head_norm_before_train=0.987101 cos_to_last_merge=1.0000 (last merge round=20)
[S9] round=21 local utility u=0.029284 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9984722024840823, 'loss_val': 0.1913904072777438, 'psi': 0.9976506285009186}-{'f1_val': 0.9966857875385419, 'auprc': 0.998207891290538, 'loss_val': 0.24666290817893619, 'psi': 0.9972946290393403}
[S10] START round=21 head_norm_before_train=2.065296 (no previous merge yet)
[S10] round=21 local utility u=0.000000 metrics={'f1_val': 0.9938337578714179, 'auprc': 0.9918795663811865, 'loss_val': 0.04087992276535661, 'psi': 0.9930520812753254}-{'f1_val': 0.9935679896985945, 'auprc': 0.9937687119668746, 'loss_val': 0.038666201731489415, 'psi': 0.9936482786059064}
[S11] START round=21 head_norm_before_train=1.004475 cos_to_last_merge=1.0000 (last merge round=20)
[S11] round=21 local utility u=0.000000 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9932402127657958, 'loss_val': 0.2685370701988908, 'psi': 0.9950791855876349}-{'f1_val': 0.9965470045135896, 'auprc': 0.9933571248461099, 'loss_val': 0.24776298034364275, 'psi': 0.9952710526465978}
[S13] START round=21 head_norm_before_train=1.772102 (no previous merge yet)
[S13] round=21 local utility u=0.135880 metrics={'f1_val': 0.5924877832948723, 'auprc': 0.681013893581911, 'loss_val': 0.618557150140967, 'psi': 0.6278982274096878}-{'f1_val': 0.5563562806647024, 'auprc': 0.6850707396677234, 'loss_val': 0.6856981287286521, 'psi': 0.6078420642659108}
[S14] START round=21 head_norm_before_train=0.860503 cos_to_last_merge=1.0000 (last merge round=20)
[S14] round=21 local utility u=0.109296 metrics={'f1_val': 0.9872326049581561, 'auprc': 0.9974163054584362, 'loss_val': 0.3613748431834275, 'psi': 0.9913060851582681}-{'f1_val': 0.949478742705183, 'auprc': 0.9975204077484363, 'loss_val': 0.3537562829413798, 'psi': 0.9686954087224844}
[S15] START round=21 head_norm_before_train=1.159648 cos_to_last_merge=0.9941 (last merge round=19)
[S15] round=21 local utility u=0.000000 metrics={'f1_val': 0.788918091474657, 'auprc': 0.919069676754418, 'loss_val': 0.35249880195230043, 'psi': 0.8409787255865614}-{'f1_val': 0.9912110630593476, 'auprc': 0.9843702866970607, 'loss_val': 0.2012365309219055, 'psi': 0.9884747525144328}
[S16] START round=21 head_norm_before_train=1.822311 (no previous merge yet)
[S16] round=21 local utility u=0.432669 metrics={'f1_val': 0.898485792180618, 'auprc': 0.9938644844874276, 'loss_val': 0.3290898390268339, 'psi': 0.9366372691033418}-{'f1_val': 0.8325167502100002, 'auprc': 0.9661112824559999, 'loss_val': 0.7153546229769057, 'psi': 0.8859545631084}
[S17] START round=21 head_norm_before_train=1.712208 cos_to_last_merge=0.8089 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.809
[S17] round=21 local utility u=0.472455 metrics={'f1_val': 0.5790553923169705, 'auprc': 0.8757726971106593, 'loss_val': 0.8322289490186785, 'psi': 0.6977423142344461}-{'f1_val': 0.5368785337333962, 'auprc': 0.7265658965594208, 'loss_val': 1.076458072180812, 'psi': 0.612753478863806}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:59804
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:59814
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:59807
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:59802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1785 reason=None
[S14] → sending delta(kind=head bytes=1785) to S11@127.0.0.1:59812
[S9] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1785 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1803) from S3
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.751196)
[S2] loaded HEAD from S3 (vec_in norm=1.751196)
[S2] cosine check vs S3: cos=0.9943
[S2] BUFFERED delta from S3 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1802) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.238612)
[S9] loaded HEAD from S5 (vec_in norm=1.238612)
[S9] cosine check vs S5: cos=0.4959
[S9] BUFFERED delta from S5 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1800) from S13
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.787793)
[S9] loaded HEAD from S13 (vec_in norm=1.787793)
[S9] cosine check vs S13: cos=0.5393
[S9] BUFFERED delta from S13 (total buffered=2)
[S6] RECEIVED delta(kind=head bytes=1803) from S8
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=2.020625)
[S6] loaded HEAD from S8 (vec_in norm=2.020625)
[S6] cosine check vs S8: cos=0.7124
[S6] BUFFERED delta from S8 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1800) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.843649)
[S4] loaded HEAD from S16 (vec_in norm=1.843649)
[S4] cosine check vs S16: cos=0.3916
[S4] BUFFERED delta from S16 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1798) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.033701)
[S14] loaded HEAD from S9 (vec_in norm=1.033701)
[S14] cosine check vs S9: cos=0.9284
[S14] BUFFERED delta from S9 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1785) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.901269)
[S11] loaded HEAD from S14 (vec_in norm=0.901269)
[S11] cosine check vs S14: cos=0.9531
[S11] BUFFERED delta from S14 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:59805
[S17] sending update (kind=head size=1797 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1797) from S17
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.734157)
[S5] loaded HEAD from S17 (vec_in norm=1.734157)
[S5] cosine check vs S17: cos=0.8359
[S5] BUFFERED delta from S17 (total buffered=1)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=21 metric=0.8614 head_norm=1.053177
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.348351e-01
[S6] stored merged vector for next round verification (round=21)
[S6] DEBUG after merge:  round=21 metric=0.5213 head_norm=1.433900 delta_norm=0.734835
[S6] aggregate: ROLLBACK (f1_val pre=0.861 post=0.521 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=21 metric=0.9963 head_norm=1.048582
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.661546e-01
[S11] stored merged vector for next round verification (round=21)
[S11] DEBUG after merge:  round=21 metric=0.9963 head_norm=0.963482 delta_norm=0.166155
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=21 metric=0.9389 head_norm=1.659482
[S4] _apply_head_vector_avg (torch): Δ‖w‖=9.691408e-01
[S4] stored merged vector for next round verification (round=21)
[S4] DEBUG after merge:  round=21 metric=0.9401 head_norm=1.461926 delta_norm=0.969141
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=21 metric=0.8191 head_norm=1.765801
[S2] _apply_head_vector_avg (torch): Δ‖w‖=9.382203e-02
[S2] stored merged vector for next round verification (round=21)
[S2] DEBUG after merge:  round=21 metric=0.8184 head_norm=1.756009 delta_norm=0.093822
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=21 metric=0.7006 head_norm=1.238612
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.874443e-01
[S5] stored merged vector for next round verification (round=21)
[S5] DEBUG after merge:  round=21 metric=0.7006 head_norm=1.425878 delta_norm=0.487444
[S5] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=21 metric=0.9971 head_norm=1.033701
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.973827e-01
[S9] stored merged vector for next round verification (round=21)
[S9] DEBUG after merge:  round=21 metric=0.9971 head_norm=0.986785 delta_norm=0.397383
[S9] aggregate: ACCEPT kept=['S5', 'S13'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=21 metric=0.9872 head_norm=0.901269
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.942246e-01
[S14] stored merged vector for next round verification (round=21)
[S14] DEBUG after merge:  round=21 metric=0.9914 head_norm=0.950099 delta_norm=0.194225
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.756009 cos_to_last_merge=1.0000 (last merge round=21)
[S2] round=22 local utility u=0.253172 metrics={'f1_val': 0.8302178914217909, 'auprc': 0.9933587662185096, 'loss_val': 0.24078369640597824, 'psi': 0.8954742413404784}-{'f1_val': 0.8191372799246006, 'auprc': 0.8857203091004224, 'loss_val': 0.3577288891764657, 'psi': 0.8457704915949293}
[S3] START round=22 head_norm_before_train=1.751196 (no previous merge yet)
[S3] round=22 local utility u=0.249900 metrics={'f1_val': 0.9605709740356257, 'auprc': 0.9986622305190083, 'loss_val': 0.11461127694704111, 'psi': 0.9758074766289788}-{'f1_val': 0.8836297850210368, 'auprc': 0.9984539436101953, 'loss_val': 0.15213948478839165, 'psi': 0.9295594484567002}
[S4] START round=22 head_norm_before_train=1.461926 cos_to_last_merge=1.0000 (last merge round=21)
[S4] round=22 local utility u=0.046365 metrics={'f1_val': 0.9481508552468193, 'auprc': 0.9668720962535163, 'loss_val': 0.28930904553961867, 'psi': 0.9556393516494981}-{'f1_val': 0.9389347821115984, 'auprc': 0.9561860679767112, 'loss_val': 0.29468355221908327, 'psi': 0.9458352964576435}
[S5] START round=22 head_norm_before_train=1.425878 cos_to_last_merge=1.0000 (last merge round=21)
[S5] round=22 local utility u=0.000000 metrics={'f1_val': 0.714400588689728, 'auprc': 0.7907912063431514, 'loss_val': 0.4399662317249095, 'psi': 0.7449568357510974}-{'f1_val': 0.7006090940057808, 'auprc': 0.9947277202538756, 'loss_val': 0.34225809404812246, 'psi': 0.8182565445050187}
[S6] START round=22 head_norm_before_train=1.433900 cos_to_last_merge=1.0000 (last merge round=21)
[S6] round=22 local utility u=0.033362 metrics={'f1_val': 0.8688609131236319, 'auprc': 0.9084212319424542, 'loss_val': 0.6237111729465541, 'psi': 0.8846850406511608}-{'f1_val': 0.8614102505184182, 'auprc': 0.9118757800076278, 'loss_val': 0.6560953584137859, 'psi': 0.8815964623141022}
[S7] START round=22 head_norm_before_train=1.306322 cos_to_last_merge=0.8269 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.827
[S7] round=22 local utility u=0.105449 metrics={'f1_val': 0.6270652018932461, 'auprc': 0.8006870055798391, 'loss_val': 0.581401623202222, 'psi': 0.6965139233678833}-{'f1_val': 0.607703961640661, 'auprc': 0.7919918840875423, 'loss_val': 0.6500470675023772, 'psi': 0.6814191306194135}
[S8] START round=22 head_norm_before_train=2.020625 (no previous merge yet)
[S8] round=22 local utility u=0.000000 metrics={'f1_val': 0.9889889874193012, 'auprc': 0.9992523773421994, 'loss_val': 0.03757263069292716, 'psi': 0.9930943433884605}-{'f1_val': 0.9930102130034458, 'auprc': 0.9992210386236093, 'loss_val': 0.031793391928967386, 'psi': 0.9954945432515112}
[S9] START round=22 head_norm_before_train=0.986785 cos_to_last_merge=1.0000 (last merge round=21)
[S9] round=22 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9987132967940856, 'loss_val': 0.21561949629058882, 'psi': 0.9977470662249199}-{'f1_val': 0.9971029125121428, 'auprc': 0.9984722024840823, 'loss_val': 0.1913904072777438, 'psi': 0.9976506285009186}
[S10] START round=22 head_norm_before_train=2.076014 (no previous merge yet)
[S10] round=22 local utility u=0.001765 metrics={'f1_val': 0.9938108179980837, 'auprc': 0.9916778932716579, 'loss_val': 0.03660735917791639, 'psi': 0.9929576481075134}-{'f1_val': 0.9938337578714179, 'auprc': 0.9918795663811865, 'loss_val': 0.04087992276535661, 'psi': 0.9930520812753254}
[S11] START round=22 head_norm_before_train=0.963482 cos_to_last_merge=1.0000 (last merge round=21)
[S11] round=22 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.994638127015461, 'loss_val': 0.2793335223197949, 'psi': 0.9957834535143382}-{'f1_val': 0.996305167468861, 'auprc': 0.9932402127657958, 'loss_val': 0.2685370701988908, 'psi': 0.9950791855876349}
[S13] START round=22 head_norm_before_train=1.787793 (no previous merge yet)
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.5740021216819282, 'auprc': 0.6775483191610532, 'loss_val': 0.7220733784732052, 'psi': 0.6154206006735782}-{'f1_val': 0.5924877832948723, 'auprc': 0.681013893581911, 'loss_val': 0.618557150140967, 'psi': 0.6278982274096878}
[S14] START round=22 head_norm_before_train=0.950099 cos_to_last_merge=1.0000 (last merge round=21)
[S14] round=22 local utility u=0.058352 metrics={'f1_val': 0.9961262192904017, 'auprc': 0.9973086212273264, 'loss_val': 0.29770877655157485, 'psi': 0.9965991800651717}-{'f1_val': 0.9872326049581561, 'auprc': 0.9974163054584362, 'loss_val': 0.3613748431834275, 'psi': 0.9913060851582681}
[S15] START round=22 head_norm_before_train=1.247579 cos_to_last_merge=0.9818 (last merge round=19)
[S15] round=22 local utility u=0.000000 metrics={'f1_val': 0.7811023128682673, 'auprc': 0.913639174884334, 'loss_val': 0.36983810850521215, 'psi': 0.8341170576746939}-{'f1_val': 0.788918091474657, 'auprc': 0.919069676754418, 'loss_val': 0.35249880195230043, 'psi': 0.8409787255865614}
[S16] START round=22 head_norm_before_train=1.843649 (no previous merge yet)
[S16] round=22 local utility u=0.186440 metrics={'f1_val': 0.9392281262744867, 'auprc': 0.9953562044306559, 'loss_val': 0.205139344477524, 'psi': 0.9616793575369544}-{'f1_val': 0.898485792180618, 'auprc': 0.9938644844874276, 'loss_val': 0.3290898390268339, 'psi': 0.9366372691033418}
[S17] START round=22 head_norm_before_train=1.734157 cos_to_last_merge=0.8079 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.808
[S17] round=22 local utility u=0.000000 metrics={'f1_val': 0.5814834801510045, 'auprc': 0.7895374724055394, 'loss_val': 0.9180621796876479, 'psi': 0.6647050770528184}-{'f1_val': 0.5790553923169705, 'auprc': 0.8757726971106593, 'loss_val': 0.8322289490186785, 'psi': 0.6977423142344461}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S2] → sending delta(kind=head bytes=1808) to S6@127.0.0.1:59807
[S3] not sending this round → trigger blocked (psi=0.976)
[S16] not sending this round → trigger blocked (psi=0.962)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:59805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:59815
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:59804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:59807
[S10] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1808 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1799) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=2.082443)
[S4] loaded HEAD from S10 (vec_in norm=2.082443)
[S4] cosine check vs S10: cos=0.5627
[S4] BUFFERED delta from S10 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1801) from S4
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.515671)
[S5] loaded HEAD from S4 (vec_in norm=1.515671)
[S5] cosine check vs S4: cos=0.2508
[S5] BUFFERED delta from S4 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1800) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.321441)
[S6] loaded HEAD from S7 (vec_in norm=1.321441)
[S6] cosine check vs S7: cos=0.1693
[S6] BUFFERED delta from S7 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1803) from S6
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.463250)
[S15] loaded HEAD from S6 (vec_in norm=1.463250)
[S15] cosine check vs S6: cos=0.4712
[S15] BUFFERED delta from S6 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1808) from S2
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.792572)
[S6] loaded HEAD from S2 (vec_in norm=1.792572)
[S6] cosine check vs S2: cos=0.2511
[S6] BUFFERED delta from S2 (total buffered=2)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=22 metric=0.7144 head_norm=1.440744
[S5] _apply_head_vector_avg (torch): Δ‖w‖=9.051968e-01
[S5] stored merged vector for next round verification (round=22)
[S5] DEBUG after merge:  round=22 metric=0.7167 head_norm=1.169239 delta_norm=0.905197
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=22 metric=0.7811 head_norm=1.322113
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.186491e-01
[S15] stored merged vector for next round verification (round=22)
[S15] DEBUG after merge:  round=22 metric=0.7982 head_norm=1.195025 delta_norm=0.718649
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=22 metric=0.8689 head_norm=1.463250
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.514675e-01
[S6] stored merged vector for next round verification (round=22)
[S6] DEBUG after merge:  round=22 metric=0.8749 head_norm=1.028466 delta_norm=0.751468
[S6] aggregate: ACCEPT kept=['S7', 'S2'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=22 metric=0.9482 head_norm=1.515671
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.777202e-01
[S4] stored merged vector for next round verification (round=22)
[S4] DEBUG after merge:  round=22 metric=0.9468 head_norm=1.595782 delta_norm=0.877720
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.792572 cos_to_last_merge=0.9995 (last merge round=21)
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.8029969445127006, 'auprc': 0.8344443883764747, 'loss_val': 0.46719048204449926, 'psi': 0.8155759220582103}-{'f1_val': 0.8302178914217909, 'auprc': 0.9933587662185096, 'loss_val': 0.24078369640597824, 'psi': 0.8954742413404784}
[S3] START round=23 head_norm_before_train=1.774409 (no previous merge yet)
[S3] round=23 local utility u=0.011924 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9986809702056516, 'loss_val': 0.09360511617811607, 'psi': 0.9760935387455267}-{'f1_val': 0.9605709740356257, 'auprc': 0.9986622305190083, 'loss_val': 0.11461127694704111, 'psi': 0.9758074766289788}
[S4] START round=23 head_norm_before_train=1.595782 cos_to_last_merge=1.0000 (last merge round=22)
[S4] round=23 local utility u=0.000000 metrics={'f1_val': 0.937261133671649, 'auprc': 0.9467402198413936, 'loss_val': 0.2997912059493241, 'psi': 0.9410527681395469}-{'f1_val': 0.9481508552468193, 'auprc': 0.9668720962535163, 'loss_val': 0.28930904553961867, 'psi': 0.9556393516494981}
[S5] START round=23 head_norm_before_train=1.169239 cos_to_last_merge=1.0000 (last merge round=22)
[S5] round=23 local utility u=0.269912 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9927247018590526, 'loss_val': 0.4214626980020502, 'psi': 0.8172822398384365}-{'f1_val': 0.714400588689728, 'auprc': 0.7907912063431514, 'loss_val': 0.4399662317249095, 'psi': 0.7449568357510974}
[S6] START round=23 head_norm_before_train=1.028466 cos_to_last_merge=1.0000 (last merge round=22)
[S6] round=23 local utility u=0.415387 metrics={'f1_val': 0.9454353205789401, 'auprc': 0.9745225413198847, 'loss_val': 0.45068778509706836, 'psi': 0.957070208875318}-{'f1_val': 0.8688609131236319, 'auprc': 0.9084212319424542, 'loss_val': 0.6237111729465541, 'psi': 0.8846850406511608}
[S7] START round=23 head_norm_before_train=1.321441 cos_to_last_merge=0.8235 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.824
[S7] round=23 local utility u=0.000000 metrics={'f1_val': 0.5883453955655732, 'auprc': 0.7882889064899944, 'loss_val': 0.6643136362716456, 'psi': 0.6683227999353417}-{'f1_val': 0.6270652018932461, 'auprc': 0.8006870055798391, 'loss_val': 0.581401623202222, 'psi': 0.6965139233678833}
[S8] START round=23 head_norm_before_train=2.035897 (no previous merge yet)
[S8] round=23 local utility u=0.013987 metrics={'f1_val': 0.9926457841098181, 'auprc': 0.9991551779836284, 'loss_val': 0.031247015017899768, 'psi': 0.9952495416593421}-{'f1_val': 0.9889889874193012, 'auprc': 0.9992523773421994, 'loss_val': 0.03757263069292716, 'psi': 0.9930943433884605}
[S9] START round=23 head_norm_before_train=1.031608 cos_to_last_merge=0.9984 (last merge round=21)
[S9] round=23 local utility u=0.028357 metrics={'f1_val': 0.9979557977304231, 'auprc': 0.9988012183874908, 'loss_val': 0.16428557949579242, 'psi': 0.9982939659932502}-{'f1_val': 0.9971029125121428, 'auprc': 0.9987132967940856, 'loss_val': 0.21561949629058882, 'psi': 0.9977470662249199}
[S10] START round=23 head_norm_before_train=2.082443 (no previous merge yet)
[S10] round=23 local utility u=0.001272 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9927360400989639, 'loss_val': 0.03578142835266029, 'psi': 0.9932352098587423}-{'f1_val': 0.9938108179980837, 'auprc': 0.9916778932716579, 'loss_val': 0.03660735917791639, 'psi': 0.9929576481075134}
[S11] START round=23 head_norm_before_train=1.016677 cos_to_last_merge=0.9983 (last merge round=21)
[S11] round=23 local utility u=0.023277 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9924654069334669, 'loss_val': 0.2248098913292575, 'psi': 0.9947692632547034}-{'f1_val': 0.9965470045135896, 'auprc': 0.994638127015461, 'loss_val': 0.2793335223197949, 'psi': 0.9957834535143382}
[S13] START round=23 head_norm_before_train=1.802401 (no previous merge yet)
[S13] round=23 local utility u=0.211339 metrics={'f1_val': 0.6203360915333554, 'auprc': 0.6839522051632757, 'loss_val': 0.5966106595188728, 'psi': 0.6457825369853236}-{'f1_val': 0.5740021216819282, 'auprc': 0.6775483191610532, 'loss_val': 0.7220733784732052, 'psi': 0.6154206006735782}
[S14] START round=23 head_norm_before_train=0.991161 cos_to_last_merge=0.9988 (last merge round=21)
[S14] round=23 local utility u=0.010709 metrics={'f1_val': 0.9921662509577629, 'auprc': 0.9975282061681159, 'loss_val': 0.2531900508257349, 'psi': 0.994311033041904}-{'f1_val': 0.9961262192904017, 'auprc': 0.9973086212273264, 'loss_val': 0.29770877655157485, 'psi': 0.9965991800651717}
[S15] START round=23 head_norm_before_train=1.195025 cos_to_last_merge=1.0000 (last merge round=22)
[S15] round=23 local utility u=0.532801 metrics={'f1_val': 0.9026158541655958, 'auprc': 0.9910352994032441, 'loss_val': 0.26550531803482413, 'psi': 0.9379836322606552}-{'f1_val': 0.7811023128682673, 'auprc': 0.913639174884334, 'loss_val': 0.36983810850521215, 'psi': 0.8341170576746939}
[S16] START round=23 head_norm_before_train=1.866729 (no previous merge yet)
[S16] round=23 local utility u=0.000000 metrics={'f1_val': 0.8743352738884826, 'auprc': 0.9920201283380911, 'loss_val': 0.4751777627748256, 'psi': 0.921409215668326}-{'f1_val': 0.9392281262744867, 'auprc': 0.9953562044306559, 'loss_val': 0.205139344477524, 'psi': 0.9616793575369544}
[S17] START round=23 head_norm_before_train=1.759253 cos_to_last_merge=0.8064 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.806
[S17] round=23 local utility u=0.106385 metrics={'f1_val': 0.5786531095648086, 'auprc': 0.8727041048100739, 'loss_val': 0.93781058599264, 'psi': 0.6962735076629147}-{'f1_val': 0.5814834801510045, 'auprc': 0.7895374724055394, 'loss_val': 0.9180621796876479, 'psi': 0.6647050770528184}
[S10] not sending this round → trigger blocked (psi=0.993)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:59802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:59812
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:59810
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:59810
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:59814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:59814
[S6] not sending this round → trigger blocked (psi=0.957)
[S15] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1801) from S3
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.799990)
[S2] loaded HEAD from S3 (vec_in norm=1.799990)
[S2] cosine check vs S3: cos=0.9930
[S2] BUFFERED delta from S3 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1802) from S13
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.819118)
[S9] loaded HEAD from S13 (vec_in norm=1.819118)
[S9] cosine check vs S13: cos=0.7143
[S9] BUFFERED delta from S13 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1802) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.190170)
[S9] loaded HEAD from S5 (vec_in norm=1.190170)
[S9] cosine check vs S5: cos=0.4848
[S9] BUFFERED delta from S5 (total buffered=2)
[S14] RECEIVED delta(kind=head bytes=1799) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.250322)
[S14] loaded HEAD from S15 (vec_in norm=1.250322)
[S14] cosine check vs S15: cos=0.3391
[S14] BUFFERED delta from S15 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1800) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.036881)
[S11] loaded HEAD from S14 (vec_in norm=1.036881)
[S11] cosine check vs S14: cos=0.9873
[S11] BUFFERED delta from S14 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1799) from S8
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=2.040175)
[S6] loaded HEAD from S8 (vec_in norm=2.040175)
[S6] cosine check vs S8: cos=0.6839
[S6] BUFFERED delta from S8 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1796) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.066705)
[S9] loaded HEAD from S11 (vec_in norm=1.066705)
[S9] cosine check vs S11: cos=0.8662
[S9] BUFFERED delta from S11 (total buffered=3)
[S14] RECEIVED delta(kind=head bytes=1800) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.077252)
[S14] loaded HEAD from S9 (vec_in norm=1.077252)
[S14] cosine check vs S9: cos=0.8964
[S14] BUFFERED delta from S9 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:59805
[S17] sending update (kind=head size=1801 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1801) from S17
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.786854)
[S5] loaded HEAD from S17 (vec_in norm=1.786854)
[S5] cosine check vs S17: cos=0.6296
[S5] BUFFERED delta from S17 (total buffered=1)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=23 metric=0.9454 head_norm=1.083163
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.604179e-01
[S6] stored merged vector for next round verification (round=23)
[S6] DEBUG after merge:  round=23 metric=0.9334 head_norm=1.445525 delta_norm=0.760418
[S6] aggregate: ROLLBACK (f1_val pre=0.945 post=0.933 tol_abs=0.005 tol_rel=0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=23 metric=0.8030 head_norm=1.827424
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.078339e-01
[S2] stored merged vector for next round verification (round=23)
[S2] DEBUG after merge:  round=23 metric=0.7985 head_norm=1.810551 delta_norm=0.107834
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=23 metric=0.7003 head_norm=1.190170
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.949012e-01
[S5] stored merged vector for next round verification (round=23)
[S5] DEBUG after merge:  round=23 metric=0.7006 head_norm=1.349736 delta_norm=0.694901
[S5] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=23 metric=0.9980 head_norm=1.077252
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.541447e-01
[S9] stored merged vector for next round verification (round=23)
[S9] DEBUG after merge:  round=23 metric=0.9980 head_norm=1.006485 delta_norm=0.154145
[S9] aggregate: ACCEPT kept=['S13', 'S5', 'S11'] (k=3/3) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=23 metric=0.9922 head_norm=1.036881
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.100266e-01
[S14] stored merged vector for next round verification (round=23)
[S14] DEBUG after merge:  round=23 metric=0.9942 head_norm=0.903621 delta_norm=0.310027
[S14] aggregate: ACCEPT kept=['S15', 'S9'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=23 metric=0.9963 head_norm=1.066705
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.524100e-02
[S11] stored merged vector for next round verification (round=23)
[S11] DEBUG after merge:  round=23 metric=0.9963 head_norm=1.048440 delta_norm=0.085241
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.810551 cos_to_last_merge=1.0000 (last merge round=23)
[S2] round=24 local utility u=0.270398 metrics={'f1_val': 0.8229520528701171, 'auprc': 0.9334628791169008, 'loss_val': 0.34317976564576297, 'psi': 0.8671563833688305}-{'f1_val': 0.8029969445127006, 'auprc': 0.8344443883764747, 'loss_val': 0.46719048204449926, 'psi': 0.8155759220582103}
[S3] START round=24 head_norm_before_train=1.799990 (no previous merge yet)
[S3] round=24 local utility u=0.078381 metrics={'f1_val': 0.9838020307430322, 'auprc': 0.9986619642363108, 'loss_val': 0.07338690113946518, 'psi': 0.9897460041403436}-{'f1_val': 0.9610352511054436, 'auprc': 0.9986809702056516, 'loss_val': 0.09360511617811607, 'psi': 0.9760935387455267}
[S4] START round=24 head_norm_before_train=1.638813 cos_to_last_merge=0.9987 (last merge round=22)
[S4] round=24 local utility u=0.055979 metrics={'f1_val': 0.9434895053351121, 'auprc': 0.9632805490331936, 'loss_val': 0.2748248855701716, 'psi': 0.9514059228143447}-{'f1_val': 0.937261133671649, 'auprc': 0.9467402198413936, 'loss_val': 0.2997912059493241, 'psi': 0.9410527681395469}
[S5] START round=24 head_norm_before_train=1.349736 cos_to_last_merge=1.0000 (last merge round=23)
[S5] round=24 local utility u=0.000000 metrics={'f1_val': 0.7145330545296904, 'auprc': 0.7749800727303728, 'loss_val': 0.6335467712257814, 'psi': 0.7387118618099634}-{'f1_val': 0.700320598491359, 'auprc': 0.9927247018590526, 'loss_val': 0.4214626980020502, 'psi': 0.8172822398384365}
[S6] START round=24 head_norm_before_train=1.445525 cos_to_last_merge=1.0000 (last merge round=23)
[S6] round=24 local utility u=0.000000 metrics={'f1_val': 0.7878014673216226, 'auprc': 0.8468223333485756, 'loss_val': 0.7327309947994054, 'psi': 0.8114098137324037}-{'f1_val': 0.9454353205789401, 'auprc': 0.9745225413198847, 'loss_val': 0.45068778509706836, 'psi': 0.957070208875318}
[S7] START round=24 head_norm_before_train=1.335180 cos_to_last_merge=0.8211 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.821
[S7] round=24 local utility u=0.000000 metrics={'f1_val': 0.4827139459162854, 'auprc': 0.7783529274830132, 'loss_val': 0.8284358020527481, 'psi': 0.6009695385429765}-{'f1_val': 0.5883453955655732, 'auprc': 0.7882889064899944, 'loss_val': 0.6643136362716456, 'psi': 0.6683227999353417}
[S8] START round=24 head_norm_before_train=2.040175 (no previous merge yet)
[S8] round=24 local utility u=0.001213 metrics={'f1_val': 0.9930102130034458, 'auprc': 0.9991604769257161, 'loss_val': 0.031022949510559335, 'psi': 0.9954703185723539}-{'f1_val': 0.9926457841098181, 'auprc': 0.9991551779836284, 'loss_val': 0.031247015017899768, 'psi': 0.9952495416593421}
[S9] START round=24 head_norm_before_train=1.006485 cos_to_last_merge=1.0000 (last merge round=23)
[S9] round=24 local utility u=0.000000 metrics={'f1_val': 0.9958851710193355, 'auprc': 0.9988092559355363, 'loss_val': 0.15988926087327832, 'psi': 0.9970548049858158}-{'f1_val': 0.9979557977304231, 'auprc': 0.9988012183874908, 'loss_val': 0.16428557949579242, 'psi': 0.9982939659932502}
[S10] START round=24 head_norm_before_train=2.094722 (no previous merge yet)
[S10] round=24 local utility u=0.000915 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.993165057662207, 'loss_val': 0.03523758338499197, 'psi': 0.9934068168840394}-{'f1_val': 0.9935679896985945, 'auprc': 0.9927360400989639, 'loss_val': 0.03578142835266029, 'psi': 0.9932352098587423}
[S11] START round=24 head_norm_before_train=1.048440 cos_to_last_merge=1.0000 (last merge round=23)
[S11] round=24 local utility u=0.009631 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9946862479827816, 'loss_val': 0.2111816863698991, 'psi': 0.9955547041410983}-{'f1_val': 0.996305167468861, 'auprc': 0.9924654069334669, 'loss_val': 0.2248098913292575, 'psi': 0.9947692632547034}
[S13] START round=24 head_norm_before_train=1.819118 (no previous merge yet)
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.6065892548130114, 'auprc': 0.6972481868940914, 'loss_val': 0.6480831662804554, 'psi': 0.6428528276454435}-{'f1_val': 0.6203360915333554, 'auprc': 0.6839522051632757, 'loss_val': 0.5966106595188728, 'psi': 0.6457825369853236}
[S14] START round=24 head_norm_before_train=0.903621 cos_to_last_merge=1.0000 (last merge round=23)
[S14] round=24 local utility u=0.000000 metrics={'f1_val': 0.9946020679315772, 'auprc': 0.9989922292263261, 'loss_val': 0.32604441967346504, 'psi': 0.9963581324494768}-{'f1_val': 0.9921662509577629, 'auprc': 0.9975282061681159, 'loss_val': 0.2531900508257349, 'psi': 0.994311033041904}
[S15] START round=24 head_norm_before_train=1.250322 cos_to_last_merge=0.9973 (last merge round=22)
[S15] round=24 local utility u=0.000000 metrics={'f1_val': 0.8726346052022851, 'auprc': 0.9645776555721668, 'loss_val': 0.3025836335810214, 'psi': 0.9094118253502378}-{'f1_val': 0.9026158541655958, 'auprc': 0.9910352994032441, 'loss_val': 0.26550531803482413, 'psi': 0.9379836322606552}
[S16] START round=24 head_norm_before_train=1.889227 (no previous merge yet)
[S16] round=24 local utility u=0.396189 metrics={'f1_val': 0.9460880529848261, 'auprc': 0.9952797217868782, 'loss_val': 0.12309610387856872, 'psi': 0.965764720505647}-{'f1_val': 0.8743352738884826, 'auprc': 0.9920201283380911, 'loss_val': 0.4751777627748256, 'psi': 0.921409215668326}
[S17] START round=24 head_norm_before_train=1.786854 cos_to_last_merge=0.8048 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.805
[S17] round=24 local utility u=0.000000 metrics={'f1_val': 0.4444148755333317, 'auprc': 0.6924952248980412, 'loss_val': 1.5274404956942746, 'psi': 0.5436470152792154}-{'f1_val': 0.5786531095648086, 'auprc': 0.8727041048100739, 'loss_val': 0.93781058599264, 'psi': 0.6962735076629147}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:59807
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S2@127.0.0.1:59802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:59804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] → sending delta(kind=head bytes=1805) to S4@127.0.0.1:59804
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:59810
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:59805
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1794 to 1 peers)
[S2] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1805 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1794) from S4
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.683583)
[S5] loaded HEAD from S4 (vec_in norm=1.683583)
[S5] cosine check vs S4: cos=0.3532
[S5] BUFFERED delta from S4 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1804) from S3
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.827802)
[S2] loaded HEAD from S3 (vec_in norm=1.827802)
[S2] cosine check vs S3: cos=0.9962
[S2] BUFFERED delta from S3 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1805) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.910832)
[S4] loaded HEAD from S16 (vec_in norm=1.910832)
[S4] cosine check vs S16: cos=0.4354
[S4] BUFFERED delta from S16 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1798) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=2.106433)
[S4] loaded HEAD from S10 (vec_in norm=2.106433)
[S4] cosine check vs S10: cos=0.9052
[S4] BUFFERED delta from S10 (total buffered=2)
[S6] RECEIVED delta(kind=head bytes=1804) from S2
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.838583)
[S6] loaded HEAD from S2 (vec_in norm=1.838583)
[S6] cosine check vs S2: cos=0.3120
[S6] BUFFERED delta from S2 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1800) from S8
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=2.050037)
[S6] loaded HEAD from S8 (vec_in norm=2.050037)
[S6] cosine check vs S8: cos=0.9470
[S6] BUFFERED delta from S8 (total buffered=2)
[S9] RECEIVED delta(kind=head bytes=1796) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.099512)
[S9] loaded HEAD from S11 (vec_in norm=1.099512)
[S9] cosine check vs S11: cos=0.9230
[S9] BUFFERED delta from S11 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=24 metric=0.7145 head_norm=1.375283
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.789473e-01
[S5] stored merged vector for next round verification (round=24)
[S5] DEBUG after merge:  round=24 metric=0.7142 head_norm=1.261102 delta_norm=0.878947
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=24 metric=0.7878 head_norm=1.477995
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.855836e-01
[S6] stored merged vector for next round verification (round=24)
[S6] DEBUG after merge:  round=24 metric=0.7497 head_norm=1.416800 delta_norm=0.385584
[S6] aggregate: ROLLBACK (f1_val pre=0.788 post=0.750 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=24 metric=0.9959 head_norm=1.052566
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.123958e-01
[S9] stored merged vector for next round verification (round=24)
[S9] DEBUG after merge:  round=24 metric=0.9951 head_norm=1.055130 delta_norm=0.212396
[S9] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=24 metric=0.9435 head_norm=1.683583
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.930587e-01
[S4] stored merged vector for next round verification (round=24)
[S4] DEBUG after merge:  round=24 metric=0.9422 head_norm=1.546391 delta_norm=0.293059
[S4] aggregate: ACCEPT kept=['S16', 'S10'] (k=2/2) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=24 metric=0.8230 head_norm=1.838583
[S2] _apply_head_vector_avg (torch): Δ‖w‖=7.962234e-02
[S2] stored merged vector for next round verification (round=24)
[S2] DEBUG after merge:  round=24 metric=0.8229 head_norm=1.831470 delta_norm=0.079622
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.831470 cos_to_last_merge=1.0000 (last merge round=24)
[S2] round=25 local utility u=0.130964 metrics={'f1_val': 0.8263172691985475, 'auprc': 0.9921664038915448, 'loss_val': 0.2775528053813406, 'psi': 0.8926569230757464}-{'f1_val': 0.8229520528701171, 'auprc': 0.9334628791169008, 'loss_val': 0.34317976564576297, 'psi': 0.8671563833688305}
[S3] START round=25 head_norm_before_train=1.827802 (no previous merge yet)
[S3] round=25 local utility u=0.050994 metrics={'f1_val': 0.9976216349699458, 'auprc': 0.998854112603833, 'loss_val': 0.054892022842240686, 'psi': 0.9981146260235007}-{'f1_val': 0.9838020307430322, 'auprc': 0.9986619642363108, 'loss_val': 0.07338690113946518, 'psi': 0.9897460041403436}
[S4] START round=25 head_norm_before_train=1.546391 cos_to_last_merge=1.0000 (last merge round=24)
[S4] round=25 local utility u=0.000000 metrics={'f1_val': 0.9386708305469323, 'auprc': 0.9432235249622124, 'loss_val': 0.2914308708851318, 'psi': 0.9404919083130443}-{'f1_val': 0.9434895053351121, 'auprc': 0.9632805490331936, 'loss_val': 0.2748248855701716, 'psi': 0.9514059228143447}
[S5] START round=25 head_norm_before_train=1.261102 cos_to_last_merge=1.0000 (last merge round=24)
[S5] round=25 local utility u=0.397266 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9935918179507331, 'loss_val': 0.4095789330415777, 'psi': 0.8176295176406415}-{'f1_val': 0.7145330545296904, 'auprc': 0.7749800727303728, 'loss_val': 0.6335467712257814, 'psi': 0.7387118618099634}
[S6] START round=25 head_norm_before_train=1.416800 cos_to_last_merge=1.0000 (last merge round=24)
[S6] round=25 local utility u=0.511658 metrics={'f1_val': 0.8669425992799891, 'auprc': 0.9646463812458883, 'loss_val': 0.5377347628358257, 'psi': 0.9060241120663487}-{'f1_val': 0.7878014673216226, 'auprc': 0.8468223333485756, 'loss_val': 0.7327309947994054, 'psi': 0.8114098137324037}
[S7] START round=25 head_norm_before_train=1.351938 cos_to_last_merge=0.8165 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.816
[S7] round=25 local utility u=0.801254 metrics={'f1_val': 0.6584810463488623, 'auprc': 0.8299651709575957, 'loss_val': 0.4353679042720413, 'psi': 0.7270746961923557}-{'f1_val': 0.4827139459162854, 'auprc': 0.7783529274830132, 'loss_val': 0.8284358020527481, 'psi': 0.6009695385429765}
[S8] START round=25 head_norm_before_train=2.050037 (no previous merge yet)
[S8] round=25 local utility u=0.000000 metrics={'f1_val': 0.9904706258921226, 'auprc': 0.9992271715648248, 'loss_val': 0.03209685037425248, 'psi': 0.9939732441612035}-{'f1_val': 0.9930102130034458, 'auprc': 0.9991604769257161, 'loss_val': 0.031022949510559335, 'psi': 0.9954703185723539}
[S9] START round=25 head_norm_before_train=1.055130 cos_to_last_merge=1.0000 (last merge round=24)
[S9] round=25 local utility u=0.018449 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9969353504186631, 'loss_val': 0.12732689249233098, 'psi': 0.9973010741738515}-{'f1_val': 0.9958851710193355, 'auprc': 0.9988092559355363, 'loss_val': 0.15988926087327832, 'psi': 0.9970548049858158}
[S10] START round=25 head_norm_before_train=2.106433 (no previous merge yet)
[S10] round=25 local utility u=0.000000 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9921685020996859, 'loss_val': 0.034098654877077104, 'psi': 0.993008194659031}-{'f1_val': 0.9935679896985945, 'auprc': 0.993165057662207, 'loss_val': 0.03523758338499197, 'psi': 0.9934068168840394}
[S11] START round=25 head_norm_before_train=1.099512 cos_to_last_merge=0.9989 (last merge round=23)
[S11] round=25 local utility u=0.018897 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9945789192922925, 'loss_val': 0.17306561042172006, 'psi': 0.9955117726649025}-{'f1_val': 0.9961336749133093, 'auprc': 0.9946862479827816, 'loss_val': 0.2111816863698991, 'psi': 0.9955547041410983}
[S13] START round=25 head_norm_before_train=1.831205 (no previous merge yet)
[S13] round=25 local utility u=0.000000 metrics={'f1_val': 0.57127426483756, 'auprc': 0.7215467421525725, 'loss_val': 0.9469425575564668, 'psi': 0.631383255763565}-{'f1_val': 0.6065892548130114, 'auprc': 0.6972481868940914, 'loss_val': 0.6480831662804554, 'psi': 0.6428528276454435}
[S14] START round=25 head_norm_before_train=0.951343 cos_to_last_merge=0.9983 (last merge round=23)
[S14] round=25 local utility u=0.013449 metrics={'f1_val': 0.992179300802197, 'auprc': 0.9959785623191808, 'loss_val': 0.2755680490651688, 'psi': 0.9936990054089905}-{'f1_val': 0.9946020679315772, 'auprc': 0.9989922292263261, 'loss_val': 0.32604441967346504, 'psi': 0.9963581324494768}
[S15] START round=25 head_norm_before_train=1.318450 cos_to_last_merge=0.9896 (last merge round=22)
[S15] round=25 local utility u=0.000000 metrics={'f1_val': 0.7022860510790107, 'auprc': 0.9147939175367898, 'loss_val': 0.4206332916319162, 'psi': 0.7872891976621224}-{'f1_val': 0.8726346052022851, 'auprc': 0.9645776555721668, 'loss_val': 0.3025836335810214, 'psi': 0.9094118253502378}
[S16] START round=25 head_norm_before_train=1.910832 (no previous merge yet)
[S16] round=25 local utility u=0.091196 metrics={'f1_val': 0.9721982102353193, 'auprc': 0.9950056158498775, 'loss_val': 0.09654266926434711, 'psi': 0.9813211724811426}-{'f1_val': 0.9460880529848261, 'auprc': 0.9952797217868782, 'loss_val': 0.12309610387856872, 'psi': 0.965764720505647}
[S17] START round=25 head_norm_before_train=1.815393 cos_to_last_merge=0.8028 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.803
[S17] round=25 local utility u=0.919030 metrics={'f1_val': 0.5932773998612225, 'auprc': 0.8516939285497357, 'loss_val': 1.0601515569481603, 'psi': 0.6966440113366278}-{'f1_val': 0.4444148755333317, 'auprc': 0.6924952248980412, 'loss_val': 1.5274404956942746, 'psi': 0.5436470152792154}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:59812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:59814
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.981)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:59815
[S2] not sending this round → trigger blocked (psi=0.893)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:59810
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.998)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.996)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:59807
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1804 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1798) from S6
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.460284)
[S15] loaded HEAD from S6 (vec_in norm=1.460284)
[S15] cosine check vs S6: cos=0.7884
[S15] BUFFERED delta from S6 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1803) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.278299)
[S9] loaded HEAD from S5 (vec_in norm=1.278299)
[S9] cosine check vs S5: cos=0.3602
[S9] BUFFERED delta from S5 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1796) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.102776)
[S14] loaded HEAD from S9 (vec_in norm=1.102776)
[S14] cosine check vs S9: cos=0.9390
[S14] BUFFERED delta from S9 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1804) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.365602)
[S6] loaded HEAD from S7 (vec_in norm=1.365602)
[S6] cosine check vs S7: cos=0.0352
[S6] BUFFERED delta from S7 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1796) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.003219)
[S11] loaded HEAD from S14 (vec_in norm=1.003219)
[S11] cosine check vs S14: cos=0.9530
[S11] BUFFERED delta from S14 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S17] → sending delta(kind=head bytes=1808) to S5@127.0.0.1:59805
[S17] sending update (kind=head size=1808 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1808) from S17
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.833605)
[S5] loaded HEAD from S17 (vec_in norm=1.833605)
[S5] cosine check vs S17: cos=0.5606
[S5] BUFFERED delta from S17 (total buffered=1)
[S8] ⇄ pheromone p=0.028 → S6@127.0.0.1:59807
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=25 metric=0.9961 head_norm=1.151159
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.805493e-01
[S11] stored merged vector for next round verification (round=25)
[S11] DEBUG after merge:  round=25 metric=0.9961 head_norm=1.064523 delta_norm=0.180549
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.059 → S9@127.0.0.1:59810
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=25 metric=0.7023 head_norm=1.384921
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.640469e-01
[S15] stored merged vector for next round verification (round=25)
[S15] DEBUG after merge:  round=25 metric=0.7185 head_norm=1.345317 delta_norm=0.464047
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.179 → S14@127.0.0.1:59814
[S2] ⇄ pheromone p=0.133 → S6@127.0.0.1:59807
[S13] ⇄ pheromone p=0.067 → S9@127.0.0.1:59810
[S3] ⇄ pheromone p=0.136 → S2@127.0.0.1:59802
[S10] ⇄ pheromone p=0.015 → S4@127.0.0.1:59804
[S4] ⇄ pheromone p=0.042 → S5@127.0.0.1:59805
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=25 metric=0.7003 head_norm=1.278299
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.694232e-01
[S5] stored merged vector for next round verification (round=25)
[S5] DEBUG after merge:  round=25 metric=0.7003 head_norm=1.380603 delta_norm=0.769423
[S5] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.191 → S9@127.0.0.1:59810
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=25 metric=0.9922 head_norm=1.003219
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.903118e-01
[S14] stored merged vector for next round verification (round=25)
[S14] DEBUG after merge:  round=25 metric=0.9767 head_norm=1.036853 delta_norm=0.190312
[S14] aggregate: ROLLBACK (f1_val pre=0.992 post=0.977 tol_abs=0.005 tol_rel=0.0)
[S14] ⇄ pheromone p=0.115 → S11@127.0.0.1:59812
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=25 metric=0.8669 head_norm=1.460284
[S6] _apply_head_vector_avg (torch): Δ‖w‖=9.819607e-01
[S6] stored merged vector for next round verification (round=25)
[S6] DEBUG after merge:  round=25 metric=0.8241 head_norm=1.017056 delta_norm=0.981961
[S6] aggregate: ROLLBACK (f1_val pre=0.867 post=0.824 tol_abs=0.005 tol_rel=0.0)
[S6] ⇄ pheromone p=0.210 → S15@127.0.0.1:59815
[S7] ⇄ pheromone p=0.262 → S6@127.0.0.1:59807
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=25 metric=0.9975 head_norm=1.102776
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.772471e-01
[S9] stored merged vector for next round verification (round=25)
[S9] DEBUG after merge:  round=25 metric=0.9975 head_norm=0.983066 delta_norm=0.677247
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.087 → S14@127.0.0.1:59814
[S16] ⇄ pheromone p=0.216 → S4@127.0.0.1:59804
[S17] ⇄ pheromone p=0.286 → S5@127.0.0.1:59805
[S2] START round=26 head_norm_before_train=1.862636 cos_to_last_merge=0.9997 (last merge round=24)
[S2] round=26 local utility u=0.000000 metrics={'f1_val': 0.8290392925222463, 'auprc': 0.9478445898399585, 'loss_val': 0.33857398397188804, 'psi': 0.8765614114493312}-{'f1_val': 0.8263172691985475, 'auprc': 0.9921664038915448, 'loss_val': 0.2775528053813406, 'psi': 0.8926569230757464}
[S3] START round=26 head_norm_before_train=1.856003 (no previous merge yet)
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.960995754132836, 'auprc': 0.9983008158430405, 'loss_val': 0.09974217748619343, 'psi': 0.9759177788169179}-{'f1_val': 0.9976216349699458, 'auprc': 0.998854112603833, 'loss_val': 0.054892022842240686, 'psi': 0.9981146260235007}
[S4] START round=26 head_norm_before_train=1.582547 cos_to_last_merge=0.9992 (last merge round=24)
[S4] round=26 local utility u=0.000000 metrics={'f1_val': 0.9387082689244315, 'auprc': 0.9278290262246123, 'loss_val': 0.31891520440262444, 'psi': 0.9343565718445037}-{'f1_val': 0.9386708305469323, 'auprc': 0.9432235249622124, 'loss_val': 0.2914308708851318, 'psi': 0.9404919083130443}
[S5] START round=26 head_norm_before_train=1.380603 cos_to_last_merge=1.0000 (last merge round=25)
[S5] round=26 local utility u=0.267056 metrics={'f1_val': 0.7853524695263496, 'auprc': 0.9684135220670769, 'loss_val': 0.31011859832329103, 'psi': 0.8585768905426405}-{'f1_val': 0.7003213174339138, 'auprc': 0.9935918179507331, 'loss_val': 0.4095789330415777, 'psi': 0.8176295176406415}
[S6] START round=26 head_norm_before_train=1.017056 cos_to_last_merge=1.0000 (last merge round=25)
[S6] round=26 local utility u=0.000000 metrics={'f1_val': 0.6896193885172396, 'auprc': 0.7894919630214631, 'loss_val': 0.6997373062999724, 'psi': 0.729568418318929}-{'f1_val': 0.8669425992799891, 'auprc': 0.9646463812458883, 'loss_val': 0.5377347628358257, 'psi': 0.9060241120663487}
[S7] START round=26 head_norm_before_train=1.365602 cos_to_last_merge=0.8133 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.813
[S7] round=26 local utility u=0.000000 metrics={'f1_val': 0.6271195251328173, 'auprc': 0.8003022012409131, 'loss_val': 0.567264704215383, 'psi': 0.6963925955760557}-{'f1_val': 0.6584810463488623, 'auprc': 0.8299651709575957, 'loss_val': 0.4353679042720413, 'psi': 0.7270746961923557}
[S8] START round=26 head_norm_before_train=2.061609 (no previous merge yet)
[S8] round=26 local utility u=0.000000 metrics={'f1_val': 0.9901099825334893, 'auprc': 0.9991514752773352, 'loss_val': 0.035031405459903193, 'psi': 0.9937265796310275}-{'f1_val': 0.9904706258921226, 'auprc': 0.9992271715648248, 'loss_val': 0.03209685037425248, 'psi': 0.9939732441612035}
[S9] START round=26 head_norm_before_train=0.983066 cos_to_last_merge=1.0000 (last merge round=25)
[S9] round=26 local utility u=0.000000 metrics={'f1_val': 0.9912751909181616, 'auprc': 0.9967591734264154, 'loss_val': 0.2242377836748241, 'psi': 0.9934687839214631}-{'f1_val': 0.9975448900106438, 'auprc': 0.9969353504186631, 'loss_val': 0.12732689249233098, 'psi': 0.9973010741738515}
[S10] START round=26 head_norm_before_train=2.115982 (no previous merge yet)
[S10] round=26 local utility u=0.002083 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9937663418764936, 'loss_val': 0.0347268972299471, 'psi': 0.9936473305697541}-{'f1_val': 0.9935679896985945, 'auprc': 0.9921685020996859, 'loss_val': 0.034098654877077104, 'psi': 0.993008194659031}
[S11] START round=26 head_norm_before_train=1.064523 cos_to_last_merge=1.0000 (last merge round=25)
[S11] round=26 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9925952113112857, 'loss_val': 0.18728604452872877, 'psi': 0.994966287232668}-{'f1_val': 0.9961336749133093, 'auprc': 0.9945789192922925, 'loss_val': 0.17306561042172006, 'psi': 0.9955117726649025}
[S13] START round=26 head_norm_before_train=1.848031 (no previous merge yet)
[S13] round=26 local utility u=0.294316 metrics={'f1_val': 0.6235700661892548, 'auprc': 0.7072329022555924, 'loss_val': 0.6291444831324415, 'psi': 0.6570352006157898}-{'f1_val': 0.57127426483756, 'auprc': 0.7215467421525725, 'loss_val': 0.9469425575564668, 'psi': 0.631383255763565}
[S14] START round=26 head_norm_before_train=1.036853 cos_to_last_merge=1.0000 (last merge round=25)
[S14] round=26 local utility u=0.057019 metrics={'f1_val': 0.9972626935085508, 'auprc': 0.9991987182766018, 'loss_val': 0.20169006287018107, 'psi': 0.9980371034157712}-{'f1_val': 0.992179300802197, 'auprc': 0.9959785623191808, 'loss_val': 0.2755680490651688, 'psi': 0.9936990054089905}
[S15] START round=26 head_norm_before_train=1.345317 cos_to_last_merge=1.0000 (last merge round=25)
[S15] round=26 local utility u=0.000000 metrics={'f1_val': 0.7009169771696235, 'auprc': 0.8440540413365476, 'loss_val': 0.4835986696907018, 'psi': 0.7581718028363932}-{'f1_val': 0.7022860510790107, 'auprc': 0.9147939175367898, 'loss_val': 0.4206332916319162, 'psi': 0.7872891976621224}
[S16] START round=26 head_norm_before_train=1.930812 (no previous merge yet)
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.8298010220383505, 'auprc': 0.8881233024439336, 'loss_val': 1.0001662414869172, 'psi': 0.8531299342005837}-{'f1_val': 0.9721982102353193, 'auprc': 0.9950056158498775, 'loss_val': 0.09654266926434711, 'psi': 0.9813211724811426}
[S17] START round=26 head_norm_before_train=1.833605 cos_to_last_merge=0.8019 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.802
[S17] round=26 local utility u=0.326658 metrics={'f1_val': 0.6116642012872038, 'auprc': 0.9767227625008572, 'loss_val': 0.8922422700466499, 'psi': 0.7576876257726652}-{'f1_val': 0.5932773998612225, 'auprc': 0.8516939285497357, 'loss_val': 1.0601515569481603, 'psi': 0.6966440113366278}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.998)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:59804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:59810
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.859)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1796) from S13
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.856574)
[S9] loaded HEAD from S13 (vec_in norm=1.856574)
[S9] cosine check vs S13: cos=0.3375
[S9] BUFFERED delta from S13 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1797) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=2.129172)
[S4] loaded HEAD from S10 (vec_in norm=2.129172)
[S4] cosine check vs S10: cos=0.8388
[S4] BUFFERED delta from S10 (total buffered=1)
[S17] not sending this round → trigger blocked (psi=0.758)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=26 metric=0.9913 head_norm=1.028023
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.965966e-01
[S9] stored merged vector for next round verification (round=26)
[S9] DEBUG after merge:  round=26 metric=0.9917 head_norm=1.203314 delta_norm=0.896597
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=26 metric=0.9387 head_norm=1.615613
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.858091e-01
[S4] stored merged vector for next round verification (round=26)
[S4] DEBUG after merge:  round=26 metric=0.9304 head_norm=1.796836 delta_norm=0.585809
[S4] aggregate: ROLLBACK (f1_val pre=0.939 post=0.930 tol_abs=0.005 tol_rel=0.0)
[S2] START round=27 head_norm_before_train=1.894416 cos_to_last_merge=0.9988 (last merge round=24)
[S2] round=27 local utility u=0.000000 metrics={'f1_val': 0.8289465084346906, 'auprc': 0.9220376339931631, 'loss_val': 0.3288339353660374, 'psi': 0.8661829586580796}-{'f1_val': 0.8290392925222463, 'auprc': 0.9478445898399585, 'loss_val': 0.33857398397188804, 'psi': 0.8765614114493312}
[S3] START round=27 head_norm_before_train=1.884688 (no previous merge yet)
[S3] round=27 local utility u=0.142523 metrics={'f1_val': 0.9977814963782642, 'auprc': 0.9986905975572588, 'loss_val': 0.03657913448904939, 'psi': 0.9981451368498621}-{'f1_val': 0.960995754132836, 'auprc': 0.9983008158430405, 'loss_val': 0.09974217748619343, 'psi': 0.9759177788169179}
[S4] START round=27 head_norm_before_train=1.796836 cos_to_last_merge=1.0000 (last merge round=26)
[S4] round=27 local utility u=0.087788 metrics={'f1_val': 0.9408609389081577, 'auprc': 0.9684258759776095, 'loss_val': 0.2780462456640976, 'psi': 0.9518869137359385}-{'f1_val': 0.9387082689244315, 'auprc': 0.9278290262246123, 'loss_val': 0.31891520440262444, 'psi': 0.9343565718445037}
[S5] START round=27 head_norm_before_train=1.403438 cos_to_last_merge=0.9996 (last merge round=25)
[S5] round=27 local utility u=0.112685 metrics={'f1_val': 0.8838774629943166, 'auprc': 0.855833390193659, 'loss_val': 0.33815763630658063, 'psi': 0.8726598338740535}-{'f1_val': 0.7853524695263496, 'auprc': 0.9684135220670769, 'loss_val': 0.31011859832329103, 'psi': 0.8585768905426405}
[S6] START round=27 head_norm_before_train=1.082294 cos_to_last_merge=0.9919 (last merge round=25)
[S6] round=27 local utility u=0.680920 metrics={'f1_val': 0.8079925023190382, 'auprc': 0.9459162140246193, 'loss_val': 0.5174080233120345, 'psi': 0.8631619870012707}-{'f1_val': 0.6896193885172396, 'auprc': 0.7894919630214631, 'loss_val': 0.6997373062999724, 'psi': 0.729568418318929}
[S7] START round=27 head_norm_before_train=1.377047 cos_to_last_merge=0.8108 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.811
[S7] round=27 local utility u=0.000000 metrics={'f1_val': 0.4909838099371985, 'auprc': 0.7784623692618378, 'loss_val': 0.8653422030292475, 'psi': 0.6059752336670542}-{'f1_val': 0.6271195251328173, 'auprc': 0.8003022012409131, 'loss_val': 0.567264704215383, 'psi': 0.6963925955760557}
[S8] START round=27 head_norm_before_train=2.071103 (no previous merge yet)
[S8] round=27 local utility u=0.000000 metrics={'f1_val': 0.9730308848835374, 'auprc': 0.9992256690078074, 'loss_val': 0.06479909851793972, 'psi': 0.9835087985332454}-{'f1_val': 0.9901099825334893, 'auprc': 0.9991514752773352, 'loss_val': 0.035031405459903193, 'psi': 0.9937265796310275}
[S9] START round=27 head_norm_before_train=1.203314 cos_to_last_merge=1.0000 (last merge round=26)
[S9] round=27 local utility u=0.029819 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9949778099836061, 'loss_val': 0.19687305184539003, 'psi': 0.9965180579998287}-{'f1_val': 0.9912751909181616, 'auprc': 0.9967591734264154, 'loss_val': 0.2242377836748241, 'psi': 0.9934687839214631}
[S10] START round=27 head_norm_before_train=2.129172 (no previous merge yet)
[S10] round=27 local utility u=0.000000 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9936470298116246, 'loss_val': 0.03454001988379233, 'psi': 0.9935996057438065}-{'f1_val': 0.9935679896985945, 'auprc': 0.9937663418764936, 'loss_val': 0.0347268972299471, 'psi': 0.9936473305697541}
[S11] START round=27 head_norm_before_train=1.115068 cos_to_last_merge=0.9990 (last merge round=25)
[S11] round=27 local utility u=0.019322 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9935319975960162, 'loss_val': 0.15145326466697778, 'psi': 0.9953410017465603}-{'f1_val': 0.9965470045135896, 'auprc': 0.9925952113112857, 'loss_val': 0.18728604452872877, 'psi': 0.994966287232668}
[S13] START round=27 head_norm_before_train=1.856574 (no previous merge yet)
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.6272442847919366, 'auprc': 0.716970485346857, 'loss_val': 0.7702275824944393, 'psi': 0.6631347650139048}-{'f1_val': 0.6235700661892548, 'auprc': 0.7072329022555924, 'loss_val': 0.6291444831324415, 'psi': 0.6570352006157898}
[S14] START round=27 head_norm_before_train=1.073185 cos_to_last_merge=0.9994 (last merge round=25)
[S14] round=27 local utility u=0.007866 metrics={'f1_val': 0.9967768676353955, 'auprc': 0.9967636132970656, 'loss_val': 0.1757377059484672, 'psi': 0.9967715659000635}-{'f1_val': 0.9972626935085508, 'auprc': 0.9991987182766018, 'loss_val': 0.20169006287018107, 'psi': 0.9980371034157712}
[S15] START round=27 head_norm_before_train=1.389452 cos_to_last_merge=0.9981 (last merge round=25)
[S15] round=27 local utility u=1.000000 metrics={'f1_val': 0.9851140459615646, 'auprc': 0.9883812035100432, 'loss_val': 0.15659258476734286, 'psi': 0.9864209089809561}-{'f1_val': 0.7009169771696235, 'auprc': 0.8440540413365476, 'loss_val': 0.4835986696907018, 'psi': 0.7581718028363932}
[S16] START round=27 head_norm_before_train=1.946964 (no previous merge yet)
[S16] round=27 local utility u=0.876582 metrics={'f1_val': 0.9398281847328391, 'auprc': 0.9947579548771589, 'loss_val': 0.22706903512585438, 'psi': 0.9618000927905671}-{'f1_val': 0.8298010220383505, 'auprc': 0.8881233024439336, 'loss_val': 1.0001662414869172, 'psi': 0.8531299342005837}
[S17] START round=27 head_norm_before_train=1.845436 cos_to_last_merge=0.8014 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.801
[S17] round=27 local utility u=0.000000 metrics={'f1_val': 0.5903267361005431, 'auprc': 0.9474029512289053, 'loss_val': 0.9057766976857078, 'psi': 0.733157222151888}-{'f1_val': 0.6116642012872038, 'auprc': 0.9767227625008572, 'loss_val': 0.8922422700466499, 'psi': 0.7576876257726652}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:59812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:59804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:59805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:59802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:59814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:59814
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S6] → sending delta(kind=head bytes=1807) to S15@127.0.0.1:59815
[S5] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1807 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1793 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1796) from S3
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.910617)
[S2] loaded HEAD from S3 (vec_in norm=1.910617)
[S2] cosine check vs S3: cos=0.9917
[S2] BUFFERED delta from S3 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1807) from S6
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.143948)
[S15] loaded HEAD from S6 (vec_in norm=1.143948)
[S15] cosine check vs S6: cos=0.7789
[S15] BUFFERED delta from S6 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1800) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.112998)
[S11] loaded HEAD from S14 (vec_in norm=1.112998)
[S11] cosine check vs S14: cos=0.9846
[S11] BUFFERED delta from S14 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1797) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.245578)
[S14] loaded HEAD from S9 (vec_in norm=1.245578)
[S14] cosine check vs S9: cos=0.7732
[S14] BUFFERED delta from S9 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1798) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.421094)
[S9] loaded HEAD from S5 (vec_in norm=1.421094)
[S9] cosine check vs S5: cos=0.3541
[S9] BUFFERED delta from S5 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1800) from S4
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.830361)
[S5] loaded HEAD from S4 (vec_in norm=1.830361)
[S5] cosine check vs S4: cos=0.4224
[S5] BUFFERED delta from S4 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1799) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.955152)
[S4] loaded HEAD from S16 (vec_in norm=1.955152)
[S4] cosine check vs S16: cos=0.2862
[S4] BUFFERED delta from S16 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1793) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.170175)
[S9] loaded HEAD from S11 (vec_in norm=1.170175)
[S9] cosine check vs S11: cos=0.7073
[S9] BUFFERED delta from S11 (total buffered=2)
[S14] RECEIVED delta(kind=head bytes=1803) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.435770)
[S14] loaded HEAD from S15 (vec_in norm=1.435770)
[S14] cosine check vs S15: cos=0.3242
[S14] BUFFERED delta from S15 (total buffered=2)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=27 metric=0.8289 head_norm=1.924040
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.235418e-01
[S2] stored merged vector for next round verification (round=27)
[S2] DEBUG after merge:  round=27 metric=0.8295 head_norm=1.913356 delta_norm=0.123542
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=27 metric=0.9851 head_norm=1.435770
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.503695e-01
[S15] stored merged vector for next round verification (round=27)
[S15] DEBUG after merge:  round=27 metric=0.9850 head_norm=1.217454 delta_norm=0.450370
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=27 metric=0.8839 head_norm=1.421094
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.905495e-01
[S5] stored merged vector for next round verification (round=27)
[S5] DEBUG after merge:  round=27 metric=0.9968 head_norm=1.375422 delta_norm=0.890549
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=27 metric=0.9965 head_norm=1.170175
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.041457e-01
[S11] stored merged vector for next round verification (round=27)
[S11] DEBUG after merge:  round=27 metric=0.9965 head_norm=1.137186 delta_norm=0.104146
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=27 metric=0.9975 head_norm=1.245578
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.123914e-01
[S9] stored merged vector for next round verification (round=27)
[S9] DEBUG after merge:  round=27 metric=0.9975 head_norm=1.044676 delta_norm=0.512391
[S9] aggregate: ACCEPT kept=['S5', 'S11'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=27 metric=0.9968 head_norm=1.112998
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.820525e-01
[S14] stored merged vector for next round verification (round=27)
[S14] DEBUG after merge:  round=27 metric=0.9968 head_norm=0.969998 delta_norm=0.382053
[S14] aggregate: ACCEPT kept=['S9', 'S15'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=27 metric=0.9409 head_norm=1.830361
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.131879e+00
[S4] stored merged vector for next round verification (round=27)
[S4] DEBUG after merge:  round=27 metric=0.9409 head_norm=1.518312 delta_norm=1.131879
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=1.913356 cos_to_last_merge=1.0000 (last merge round=27)
[S2] round=28 local utility u=0.101193 metrics={'f1_val': 0.8306074174116411, 'auprc': 0.9738414004934135, 'loss_val': 0.29182503538846793, 'psi': 0.8879010106443501}-{'f1_val': 0.8289465084346906, 'auprc': 0.9220376339931631, 'loss_val': 0.3288339353660374, 'psi': 0.8661829586580796}
[S3] START round=28 head_norm_before_train=1.910617 (no previous merge yet)
[S3] round=28 local utility u=0.000000 metrics={'f1_val': 0.9795260847245232, 'auprc': 0.9987077047605928, 'loss_val': 0.05051873337196902, 'psi': 0.9871987327389511}-{'f1_val': 0.9977814963782642, 'auprc': 0.9986905975572588, 'loss_val': 0.03657913448904939, 'psi': 0.9981451368498621}
[S4] START round=28 head_norm_before_train=1.518312 cos_to_last_merge=1.0000 (last merge round=27)
[S4] round=28 local utility u=0.016436 metrics={'f1_val': 0.9508683724691309, 'auprc': 0.9589405051178195, 'loss_val': 0.2767632057474777, 'psi': 0.9540972255286063}-{'f1_val': 0.9408609389081577, 'auprc': 0.9684258759776095, 'loss_val': 0.2780462456640976, 'psi': 0.9518869137359385}
[S5] START round=28 head_norm_before_train=1.375422 cos_to_last_merge=1.0000 (last merge round=27)
[S5] round=28 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9942088668997464, 'loss_val': 0.37687968358395324, 'psi': 0.817875905854714}-{'f1_val': 0.8838774629943166, 'auprc': 0.855833390193659, 'loss_val': 0.33815763630658063, 'psi': 0.8726598338740535}
[S6] START round=28 head_norm_before_train=1.143948 cos_to_last_merge=0.9777 (last merge round=25)
[S6] round=28 local utility u=0.160343 metrics={'f1_val': 0.8684730820549973, 'auprc': 0.9135431145656276, 'loss_val': 0.4624871853772583, 'psi': 0.8865010950592493}-{'f1_val': 0.8079925023190382, 'auprc': 0.9459162140246193, 'loss_val': 0.5174080233120345, 'psi': 0.8631619870012707}
[S7] START round=28 head_norm_before_train=1.390693 cos_to_last_merge=0.8082 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.808
[S7] round=28 local utility u=0.610368 metrics={'f1_val': 0.6306033014240479, 'auprc': 0.8033564368889389, 'loss_val': 0.557006131148796, 'psi': 0.6997045556100043}-{'f1_val': 0.4909838099371985, 'auprc': 0.7784623692618378, 'loss_val': 0.8653422030292475, 'psi': 0.6059752336670542}
[S8] START round=28 head_norm_before_train=2.082222 (no previous merge yet)
[S8] round=28 local utility u=0.069063 metrics={'f1_val': 0.9906522705779591, 'auprc': 0.9993122259122609, 'loss_val': 0.03266065750263585, 'psi': 0.9941162527116798}-{'f1_val': 0.9730308848835374, 'auprc': 0.9992256690078074, 'loss_val': 0.06479909851793972, 'psi': 0.9835087985332454}
[S9] START round=28 head_norm_before_train=1.044676 cos_to_last_merge=1.0000 (last merge round=27)
[S9] round=28 local utility u=0.022340 metrics={'f1_val': 0.9946069829493691, 'auprc': 0.9986440520795091, 'loss_val': 0.1455634494185187, 'psi': 0.9962218106014251}-{'f1_val': 0.9975448900106438, 'auprc': 0.9949778099836061, 'loss_val': 0.19687305184539003, 'psi': 0.9965180579998287}
[S10] START round=28 head_norm_before_train=2.137760 (no previous merge yet)
[S10] round=28 local utility u=0.000000 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9928446665402659, 'loss_val': 0.034328318513060826, 'psi': 0.993278660435263}-{'f1_val': 0.9935679896985945, 'auprc': 0.9936470298116246, 'loss_val': 0.03454001988379233, 'psi': 0.9935996057438065}
[S11] START round=28 head_norm_before_train=1.137186 cos_to_last_merge=1.0000 (last merge round=27)
[S11] round=28 local utility u=0.000000 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9932238012103104, 'loss_val': 0.1744539436870388, 'psi': 0.9948246232052727}-{'f1_val': 0.9965470045135896, 'auprc': 0.9935319975960162, 'loss_val': 0.15145326466697778, 'psi': 0.9953410017465603}
[S13] START round=28 head_norm_before_train=1.861399 (no previous merge yet)
[S13] round=28 local utility u=0.081760 metrics={'f1_val': 0.6316691826577845, 'auprc': 0.7293738634755927, 'loss_val': 0.6704665125587213, 'psi': 0.6707510549849078}-{'f1_val': 0.6272442847919366, 'auprc': 0.716970485346857, 'loss_val': 0.7702275824944393, 'psi': 0.6631347650139048}
[S14] START round=28 head_norm_before_train=0.969998 cos_to_last_merge=1.0000 (last merge round=27)
[S14] round=28 local utility u=0.000000 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9981258013240214, 'loss_val': 0.2508145951098153, 'psi': 0.9972026594960588}-{'f1_val': 0.9967768676353955, 'auprc': 0.9967636132970656, 'loss_val': 0.1757377059484672, 'psi': 0.9967715659000635}
[S15] START round=28 head_norm_before_train=1.217454 cos_to_last_merge=1.0000 (last merge round=27)
[S15] round=28 local utility u=0.000000 metrics={'f1_val': 0.8787096522294732, 'auprc': 0.9902061028763866, 'loss_val': 0.3310207102592432, 'psi': 0.9233082324882385}-{'f1_val': 0.9851140459615646, 'auprc': 0.9883812035100432, 'loss_val': 0.15659258476734286, 'psi': 0.9864209089809561}
[S16] START round=28 head_norm_before_train=1.955152 (no previous merge yet)
[S16] round=28 local utility u=0.247570 metrics={'f1_val': 0.9924935213968427, 'auprc': 0.9937737622716674, 'loss_val': 0.0449690980206498, 'psi': 0.9930056177467725}-{'f1_val': 0.9398281847328391, 'auprc': 0.9947579548771589, 'loss_val': 0.22706903512585438, 'psi': 0.9618000927905671}
[S17] START round=28 head_norm_before_train=1.852788 cos_to_last_merge=0.8011 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.801
[S17] round=28 local utility u=0.000000 metrics={'f1_val': 0.5945796832220525, 'auprc': 0.935795023878282, 'loss_val': 0.9395380209073907, 'psi': 0.7310658194845443}-{'f1_val': 0.5903267361005431, 'auprc': 0.9474029512289053, 'loss_val': 0.9057766976857078, 'psi': 0.733157222151888}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:59805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] → sending delta(kind=head bytes=1805) to S15@127.0.0.1:59815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:59814
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:59804
[S16] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1805 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1805 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.095702)
[S14] loaded HEAD from S9 (vec_in norm=1.095702)
[S14] cosine check vs S9: cos=0.8343
[S14] BUFFERED delta from S9 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1805) from S4
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.553442)
[S5] loaded HEAD from S4 (vec_in norm=1.553442)
[S5] cosine check vs S4: cos=0.7281
[S5] BUFFERED delta from S4 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1801) from S13
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.872451)
[S9] loaded HEAD from S13 (vec_in norm=1.872451)
[S9] cosine check vs S13: cos=0.6639
[S9] BUFFERED delta from S13 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1797) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.964162)
[S4] loaded HEAD from S16 (vec_in norm=1.964162)
[S4] cosine check vs S16: cos=0.8094
[S4] BUFFERED delta from S16 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1798) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.402557)
[S6] loaded HEAD from S7 (vec_in norm=1.402557)
[S6] cosine check vs S7: cos=0.6280
[S6] BUFFERED delta from S7 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1797) from S8
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=2.095992)
[S6] loaded HEAD from S8 (vec_in norm=2.095992)
[S6] cosine check vs S8: cos=0.5794
[S6] BUFFERED delta from S8 (total buffered=2)
[S6] RECEIVED delta(kind=head bytes=1797) from S2
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.942577)
[S6] loaded HEAD from S2 (vec_in norm=1.942577)
[S6] cosine check vs S2: cos=0.3142
[S6] BUFFERED delta from S2 (total buffered=3)
[S15] RECEIVED delta(kind=head bytes=1805) from S6
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.210983)
[S15] loaded HEAD from S6 (vec_in norm=1.210983)
[S15] cosine check vs S6: cos=0.9049
[S15] BUFFERED delta from S6 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=28 metric=0.7003 head_norm=1.392105
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.481504e-01
[S5] stored merged vector for next round verification (round=28)
[S5] DEBUG after merge:  round=28 metric=0.7003 head_norm=1.369343 delta_norm=0.548150
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=28 metric=0.9966 head_norm=1.009346
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.058065e-01
[S14] stored merged vector for next round verification (round=28)
[S14] DEBUG after merge:  round=28 metric=0.9966 head_norm=1.008044 delta_norm=0.305806
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=28 metric=0.8685 head_norm=1.210983
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.154830e-01
[S6] stored merged vector for next round verification (round=28)
[S6] DEBUG after merge:  round=28 metric=0.8426 head_norm=1.090301 delta_norm=0.315483
[S6] aggregate: ROLLBACK (f1_val pre=0.868 post=0.843 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=28 metric=0.9509 head_norm=1.553442
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.770198e-01
[S4] stored merged vector for next round verification (round=28)
[S4] DEBUG after merge:  round=28 metric=0.9509 head_norm=1.674099 delta_norm=0.577020
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=28 metric=0.9946 head_norm=1.095702
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.040254e-01
[S9] stored merged vector for next round verification (round=28)
[S9] DEBUG after merge:  round=28 metric=0.9954 head_norm=1.362962 delta_norm=0.704025
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=28 metric=0.8787 head_norm=1.275162
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.729227e-01
[S15] stored merged vector for next round verification (round=28)
[S15] DEBUG after merge:  round=28 metric=0.8806 head_norm=1.213167 delta_norm=0.272923
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=1.942577 cos_to_last_merge=0.9998 (last merge round=27)
[S2] round=29 local utility u=0.000000 metrics={'f1_val': 0.8286758175217979, 'auprc': 0.9824193733657273, 'loss_val': 0.3399732348116441, 'psi': 0.8901732398593696}-{'f1_val': 0.8306074174116411, 'auprc': 0.9738414004934135, 'loss_val': 0.29182503538846793, 'psi': 0.8879010106443501}
[S3] START round=29 head_norm_before_train=1.932779 (no previous merge yet)
[S3] round=29 local utility u=0.000000 metrics={'f1_val': 0.9608655541319502, 'auprc': 0.9987181406176686, 'loss_val': 0.10309021891751943, 'psi': 0.9760065887262376}-{'f1_val': 0.9795260847245232, 'auprc': 0.9987077047605928, 'loss_val': 0.05051873337196902, 'psi': 0.9871987327389511}
[S4] START round=29 head_norm_before_train=1.674099 cos_to_last_merge=1.0000 (last merge round=28)
[S4] round=29 local utility u=0.000000 metrics={'f1_val': 0.9379447951300348, 'auprc': 0.9443175488469837, 'loss_val': 0.34536914494399407, 'psi': 0.9404938966168144}-{'f1_val': 0.9508683724691309, 'auprc': 0.9589405051178195, 'loss_val': 0.2767632057474777, 'psi': 0.9540972255286063}
[S5] START round=29 head_norm_before_train=1.369343 cos_to_last_merge=1.0000 (last merge round=28)
[S5] round=29 local utility u=0.000000 metrics={'f1_val': 0.7302423076362222, 'auprc': 0.7935104249159641, 'loss_val': 0.4895920695604902, 'psi': 0.755549554548119}-{'f1_val': 0.700320598491359, 'auprc': 0.9942088668997464, 'loss_val': 0.37687968358395324, 'psi': 0.817875905854714}
[S6] START round=29 head_norm_before_train=1.090301 cos_to_last_merge=1.0000 (last merge round=28)
[S6] round=29 local utility u=0.117451 metrics={'f1_val': 0.87733004222485, 'auprc': 0.9573280455341276, 'loss_val': 0.4120818577517795, 'psi': 0.909329243548561}-{'f1_val': 0.8684730820549973, 'auprc': 0.9135431145656276, 'loss_val': 0.4624871853772583, 'psi': 0.8865010950592493}
[S7] START round=29 head_norm_before_train=1.402557 cos_to_last_merge=0.8066 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.807
[S7] round=29 local utility u=0.000000 metrics={'f1_val': 0.6180427366631134, 'auprc': 0.7956002668753306, 'loss_val': 0.6163891942996311, 'psi': 0.6890657487480003}-{'f1_val': 0.6306033014240479, 'auprc': 0.8033564368889389, 'loss_val': 0.557006131148796, 'psi': 0.6997045556100043}
[S8] START round=29 head_norm_before_train=2.095992 (no previous merge yet)
[S8] round=29 local utility u=0.000000 metrics={'f1_val': 0.9904706258921226, 'auprc': 0.9994213107178831, 'loss_val': 0.03251070427053645, 'psi': 0.9940508998224268}-{'f1_val': 0.9906522705779591, 'auprc': 0.9993122259122609, 'loss_val': 0.03266065750263585, 'psi': 0.9941162527116798}
[S9] START round=29 head_norm_before_train=1.362962 cos_to_last_merge=1.0000 (last merge round=28)
[S9] round=29 local utility u=0.000000 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9947440142746486, 'loss_val': 0.15279499228987894, 'psi': 0.9964245397162457}-{'f1_val': 0.9946069829493691, 'auprc': 0.9986440520795091, 'loss_val': 0.1455634494185187, 'psi': 0.9962218106014251}
[S10] START round=29 head_norm_before_train=2.146589 (no previous merge yet)
[S10] round=29 local utility u=0.000425 metrics={'f1_val': 0.9933489306849028, 'auprc': 0.9936631997459198, 'loss_val': 0.03462022874331127, 'psi': 0.9934746383093096}-{'f1_val': 0.9935679896985945, 'auprc': 0.9928446665402659, 'loss_val': 0.034328318513060826, 'psi': 0.993278660435263}
[S11] START round=29 head_norm_before_train=1.189826 cos_to_last_merge=0.9992 (last merge round=27)
[S11] round=29 local utility u=0.019485 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9948301949474134, 'loss_val': 0.14175508788567018, 'psi': 0.9956122829269509}-{'f1_val': 0.9958918378685807, 'auprc': 0.9932238012103104, 'loss_val': 0.1744539436870388, 'psi': 0.9948246232052727}
[S13] START round=29 head_norm_before_train=1.872451 (no previous merge yet)
[S13] round=29 local utility u=0.031968 metrics={'f1_val': 0.6303096054478468, 'auprc': 0.7442140483321074, 'loss_val': 0.6428945222486369, 'psi': 0.675871382601551}-{'f1_val': 0.6316691826577845, 'auprc': 0.7293738634755927, 'loss_val': 0.6704665125587213, 'psi': 0.6707510549849078}
[S14] START round=29 head_norm_before_train=1.008044 cos_to_last_merge=1.0000 (last merge round=28)
[S14] round=29 local utility u=0.002930 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.994915930900772, 'loss_val': 0.2353241515708125, 'psi': 0.995918711326759}-{'f1_val': 0.9965872316107504, 'auprc': 0.9981258013240214, 'loss_val': 0.2508145951098153, 'psi': 0.9972026594960588}
[S15] START round=29 head_norm_before_train=1.213167 cos_to_last_merge=1.0000 (last merge round=28)
[S15] round=29 local utility u=0.000000 metrics={'f1_val': 0.786099936279043, 'auprc': 0.895801986905751, 'loss_val': 0.42784341710457846, 'psi': 0.8299807565297261}-{'f1_val': 0.8787096522294732, 'auprc': 0.9902061028763866, 'loss_val': 0.3310207102592432, 'psi': 0.9233082324882385}
[S16] START round=29 head_norm_before_train=1.964162 (no previous merge yet)
[S16] round=29 local utility u=0.000000 metrics={'f1_val': 0.9368248046934413, 'auprc': 0.9820281834879877, 'loss_val': 0.3218582789277005, 'psi': 0.95490615621126}-{'f1_val': 0.9924935213968427, 'auprc': 0.9937737622716674, 'loss_val': 0.0449690980206498, 'psi': 0.9930056177467725}
[S17] START round=29 head_norm_before_train=1.859898 cos_to_last_merge=0.8008 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.801
[S17] round=29 local utility u=0.074710 metrics={'f1_val': 0.5961830835708728, 'auprc': 0.9480329600368775, 'loss_val': 0.8364528193909571, 'psi': 0.7369230341572747}-{'f1_val': 0.5945796832220525, 'auprc': 0.935795023878282, 'loss_val': 0.9395380209073907, 'psi': 0.7310658194845443}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:59815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S6] → sending delta(kind=head bytes=1807) to S7@127.0.0.1:59808
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S11] → sending delta(kind=head bytes=1789) to S14@127.0.0.1:59814
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1789 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1807 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1789) from S11
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.240221)
[S14] loaded HEAD from S11 (vec_in norm=1.240221)
[S14] cosine check vs S11: cos=0.9376
[S14] BUFFERED delta from S11 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1799) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.052796)
[S15] loaded HEAD from S14 (vec_in norm=1.052796)
[S15] cosine check vs S14: cos=0.4010
[S15] BUFFERED delta from S14 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1807) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.158928)
[S7] loaded HEAD from S6 (vec_in norm=1.158928)
[S7] cosine check vs S6: cos=0.5247
[S7] BUFFERED delta from S6 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=29 metric=0.6180 head_norm=1.412617
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.364852e-01
[S7] stored merged vector for next round verification (round=29)
[S7] DEBUG after merge:  round=29 metric=0.6262 head_norm=1.124361 delta_norm=0.636485
[S7] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=29 metric=0.7861 head_norm=1.288730
[S15] _apply_head_vector_avg (torch): Δ‖w‖=6.482555e-01
[S15] stored merged vector for next round verification (round=29)
[S15] DEBUG after merge:  round=29 metric=0.8026 head_norm=0.982022 delta_norm=0.648255
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=29 metric=0.9966 head_norm=1.052796
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.225389e-01
[S14] stored merged vector for next round verification (round=29)
[S14] DEBUG after merge:  round=29 metric=0.9964 head_norm=1.128601 delta_norm=0.222539
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=1.970575 cos_to_last_merge=0.9992 (last merge round=27)
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.8285781895650447, 'auprc': 0.958165288109474, 'loss_val': 0.3643227953447715, 'psi': 0.8804130289828165}-{'f1_val': 0.8286758175217979, 'auprc': 0.9824193733657273, 'loss_val': 0.3399732348116441, 'psi': 0.8901732398593696}
[S3] START round=30 head_norm_before_train=1.950273 (no previous merge yet)
[S3] round=30 local utility u=0.146633 metrics={'f1_val': 0.9978389274664787, 'auprc': 0.9988498759079841, 'loss_val': 0.03205982031948375, 'psi': 0.9982433068430809}-{'f1_val': 0.9608655541319502, 'auprc': 0.9987181406176686, 'loss_val': 0.10309021891751943, 'psi': 0.9760065887262376}
[S4] START round=30 head_norm_before_train=1.708109 cos_to_last_merge=0.9989 (last merge round=28)
[S4] round=30 local utility u=0.051343 metrics={'f1_val': 0.9386347866774317, 'auprc': 0.9635913752917751, 'loss_val': 0.30464415707071657, 'psi': 0.9486174221231691}-{'f1_val': 0.9379447951300348, 'auprc': 0.9443175488469837, 'loss_val': 0.34536914494399407, 'psi': 0.9404938966168144}
[S5] START round=30 head_norm_before_train=1.389299 cos_to_last_merge=0.9992 (last merge round=28)
[S5] round=30 local utility u=0.294004 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9957093354271453, 'loss_val': 0.32864968255200144, 'psi': 0.8184760932656736}-{'f1_val': 0.7302423076362222, 'auprc': 0.7935104249159641, 'loss_val': 0.4895920695604902, 'psi': 0.755549554548119}
[S6] START round=30 head_norm_before_train=1.158928 cos_to_last_merge=0.9967 (last merge round=28)
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.7872886033503861, 'auprc': 0.9555906190304468, 'loss_val': 0.5768429650640294, 'psi': 0.8546094096224104}-{'f1_val': 0.87733004222485, 'auprc': 0.9573280455341276, 'loss_val': 0.4120818577517795, 'psi': 0.909329243548561}
[S7] START round=30 head_norm_before_train=1.124361 cos_to_last_merge=1.0000 (last merge round=29)
[S7] round=30 local utility u=0.000000 metrics={'f1_val': 0.4901581509822561, 'auprc': 0.7764848004750364, 'loss_val': 0.8322843882626952, 'psi': 0.6046888107793682}-{'f1_val': 0.6180427366631134, 'auprc': 0.7956002668753306, 'loss_val': 0.6163891942996311, 'psi': 0.6890657487480003}
[S8] START round=30 head_norm_before_train=2.100660 (no previous merge yet)
[S8] round=30 local utility u=0.002259 metrics={'f1_val': 0.9912584815032434, 'auprc': 0.9995991365059879, 'loss_val': 0.03325420599644614, 'psi': 0.9945947435043412}-{'f1_val': 0.9904706258921226, 'auprc': 0.9994213107178831, 'loss_val': 0.03251070427053645, 'psi': 0.9940508998224268}
[S9] START round=30 head_norm_before_train=1.399602 cos_to_last_merge=0.9985 (last merge round=28)
[S9] round=30 local utility u=0.025743 metrics={'f1_val': 0.9963002897586258, 'auprc': 0.9989405168407692, 'loss_val': 0.1064310341063727, 'psi': 0.9973563805914831}-{'f1_val': 0.9975448900106438, 'auprc': 0.9947440142746486, 'loss_val': 0.15279499228987894, 'psi': 0.9964245397162457}
[S10] START round=30 head_norm_before_train=2.158518 (no previous merge yet)
[S10] round=30 local utility u=0.000622 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9930439288101527, 'loss_val': 0.032833244434456316, 'psi': 0.9933583653432178}-{'f1_val': 0.9933489306849028, 'auprc': 0.9936631997459198, 'loss_val': 0.03462022874331127, 'psi': 0.9934746383093096}
[S11] START round=30 head_norm_before_train=1.240221 cos_to_last_merge=0.9972 (last merge round=27)
[S11] round=30 local utility u=0.016950 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9926662951485303, 'loss_val': 0.0999126814641982, 'psi': 0.9946016207805606}-{'f1_val': 0.9961336749133093, 'auprc': 0.9948301949474134, 'loss_val': 0.14175508788567018, 'psi': 0.9956122829269509}
[S13] START round=30 head_norm_before_train=1.883489 (no previous merge yet)
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.6016788985213326, 'auprc': 0.7685835298386341, 'loss_val': 0.8908915014935586, 'psi': 0.6684407510482532}-{'f1_val': 0.6303096054478468, 'auprc': 0.7442140483321074, 'loss_val': 0.6428945222486369, 'psi': 0.675871382601551}
[S14] START round=30 head_norm_before_train=1.128601 cos_to_last_merge=1.0000 (last merge round=29)
[S14] round=30 local utility u=0.053914 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9966817536652399, 'loss_val': 0.1352546380577478, 'psi': 0.996871206360695}-{'f1_val': 0.9965872316107504, 'auprc': 0.994915930900772, 'loss_val': 0.2353241515708125, 'psi': 0.995918711326759}
[S15] START round=30 head_norm_before_train=0.982022 cos_to_last_merge=1.0000 (last merge round=29)
[S15] round=30 local utility u=0.896070 metrics={'f1_val': 0.9954340008316187, 'auprc': 0.9906721099693883, 'loss_val': 0.17631858533646794, 'psi': 0.9935292444867265}-{'f1_val': 0.786099936279043, 'auprc': 0.895801986905751, 'loss_val': 0.42784341710457846, 'psi': 0.8299807565297261}
[S16] START round=30 head_norm_before_train=1.973946 (no previous merge yet)
[S16] round=30 local utility u=0.184409 metrics={'f1_val': 0.9596718636538519, 'auprc': 0.9916761116204609, 'loss_val': 0.11906615032244809, 'psi': 0.9724735628404955}-{'f1_val': 0.9368248046934413, 'auprc': 0.9820281834879877, 'loss_val': 0.3218582789277005, 'psi': 0.95490615621126}
[S17] START round=30 head_norm_before_train=1.859995 cos_to_last_merge=0.8009 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.801
[S17] round=30 local utility u=0.000000 metrics={'f1_val': 0.5344817992291, 'auprc': 0.7275264343673259, 'loss_val': 1.339616268524587, 'psi': 0.6116996532843904}-{'f1_val': 0.5961830835708728, 'auprc': 0.9480329600368775, 'loss_val': 0.8364528193909571, 'psi': 0.7369230341572747}
[S14] not sending this round → trigger blocked (psi=0.997)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.995)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:59816
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:59805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:59807
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] → sending delta(kind=head bytes=1806) to S17@127.0.0.1:59817
[S10] not sending this round → trigger blocked (psi=0.993)
[S5] sending update (kind=head size=1806 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1796) from S9
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.437541)
[S5] loaded HEAD from S9 (vec_in norm=1.437541)
[S5] cosine check vs S9: cos=0.1665
[S5] BUFFERED delta from S9 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1803) from S4
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.746440)
[S16] loaded HEAD from S4 (vec_in norm=1.746440)
[S16] cosine check vs S4: cos=0.9462
[S16] BUFFERED delta from S4 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1799) from S15
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.086278)
[S6] loaded HEAD from S15 (vec_in norm=1.086278)
[S6] cosine check vs S15: cos=0.7893
[S6] BUFFERED delta from S15 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1806) from S5
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.417855)
[S17] loaded HEAD from S5 (vec_in norm=1.417855)
[S17] cosine check vs S5: cos=0.3385
[S17] BUFFERED delta from S5 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=30 metric=0.7873 head_norm=1.230178
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.820369e-01
[S6] stored merged vector for next round verification (round=30)
[S6] DEBUG after merge:  round=30 metric=0.7726 head_norm=1.095772 delta_norm=0.382037
[S6] aggregate: ROLLBACK (f1_val pre=0.787 post=0.773 tol_abs=0.005 tol_rel=0.0)
[S6] ⇄ pheromone p=0.178 → S7@127.0.0.1:59808
[S11] ⇄ pheromone p=0.028 → S14@127.0.0.1:59814
[S14] ⇄ pheromone p=0.054 → S15@127.0.0.1:59815
[S2] ⇄ pheromone p=0.056 → S3@127.0.0.1:59803
[S4] ⇄ pheromone p=0.035 → S16@127.0.0.1:59816
[S15] ⇄ pheromone p=0.340 → S6@127.0.0.1:59807
[S9] ⇄ pheromone p=0.040 → S5@127.0.0.1:59805
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=30 metric=0.7003 head_norm=1.417855
[S5] _apply_head_vector_avg (torch): Δ‖w‖=9.217163e-01
[S5] stored merged vector for next round verification (round=30)
[S5] DEBUG after merge:  round=30 metric=0.7003 head_norm=1.090348 delta_norm=0.921716
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.155 → S17@127.0.0.1:59817
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=30 metric=0.5345 head_norm=1.859516
[S17] _apply_head_vector_avg (torch): Δ‖w‖=9.596046e-01
[S17] stored merged vector for next round verification (round=30)
[S17] DEBUG after merge:  round=30 metric=0.5326 head_norm=1.346557 delta_norm=0.959605
[S17] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.133 → S5@127.0.0.1:59805
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=30 metric=0.9597 head_norm=1.984909
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.277358e-01
[S16] stored merged vector for next round verification (round=30)
[S16] DEBUG after merge:  round=30 metric=0.9555 head_norm=1.840529 delta_norm=0.327736
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.229 → S4@127.0.0.1:59804
[S2] START round=31 head_norm_before_train=1.996709 cos_to_last_merge=0.9984 (last merge round=27)
[S2] round=31 local utility u=0.000000 metrics={'f1_val': 0.8274791401453985, 'auprc': 0.9035864231302401, 'loss_val': 0.3543174397196692, 'psi': 0.8579220533393351}-{'f1_val': 0.8285781895650447, 'auprc': 0.958165288109474, 'loss_val': 0.3643227953447715, 'psi': 0.8804130289828165}
[S3] START round=31 head_norm_before_train=1.966234 (no previous merge yet)
[S3] round=31 local utility u=0.000000 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9988145318303998, 'loss_val': 0.08967536476466444, 'psi': 0.9761708639718322}-{'f1_val': 0.9978389274664787, 'auprc': 0.9988498759079841, 'loss_val': 0.03205982031948375, 'psi': 0.9982433068430809}
[S4] START round=31 head_norm_before_train=1.746440 cos_to_last_merge=0.9959 (last merge round=28)
[S4] round=31 local utility u=0.007401 metrics={'f1_val': 0.9393641652669368, 'auprc': 0.9705365682846092, 'loss_val': 0.3150547274212631, 'psi': 0.9518331264740058}-{'f1_val': 0.9386347866774317, 'auprc': 0.9635913752917751, 'loss_val': 0.30464415707071657, 'psi': 0.9486174221231691}
[S5] START round=31 head_norm_before_train=1.090348 cos_to_last_merge=1.0000 (last merge round=30)
[S5] round=31 local utility u=0.000000 metrics={'f1_val': 0.7109093822655016, 'auprc': 0.8770721619131024, 'loss_val': 0.44212101640037155, 'psi': 0.777374494124542}-{'f1_val': 0.700320598491359, 'auprc': 0.9957093354271453, 'loss_val': 0.32864968255200144, 'psi': 0.8184760932656736}
[S6] START round=31 head_norm_before_train=1.095772 cos_to_last_merge=1.0000 (last merge round=30)
[S6] round=31 local utility u=0.271194 metrics={'f1_val': 0.8553809191319462, 'auprc': 0.9669945856546647, 'loss_val': 0.4772203584810669, 'psi': 0.9000263857410336}-{'f1_val': 0.7872886033503861, 'auprc': 0.9555906190304468, 'loss_val': 0.5768429650640294, 'psi': 0.8546094096224104}
[S7] START round=31 head_norm_before_train=1.138347 cos_to_last_merge=0.9999 (last merge round=29)
[S7] round=31 local utility u=0.807411 metrics={'f1_val': 0.665319697877756, 'auprc': 0.8323087370733767, 'loss_val': 0.4359044726284175, 'psi': 0.7321153135560043}-{'f1_val': 0.4901581509822561, 'auprc': 0.7764848004750364, 'loss_val': 0.8322843882626952, 'psi': 0.6046888107793682}
[S8] START round=31 head_norm_before_train=2.103162 (no previous merge yet)
[S8] round=31 local utility u=0.007300 metrics={'f1_val': 0.9931961080096116, 'auprc': 0.9997129526886288, 'loss_val': 0.03062095869080996, 'psi': 0.9958028458812185}-{'f1_val': 0.9912584815032434, 'auprc': 0.9995991365059879, 'loss_val': 0.03325420599644614, 'psi': 0.9945947435043412}
[S9] START round=31 head_norm_before_train=1.437541 cos_to_last_merge=0.9943 (last merge round=28)
[S9] round=31 local utility u=0.011756 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9955515530760018, 'loss_val': 0.0802203786153056, 'psi': 0.996747555236787}-{'f1_val': 0.9963002897586258, 'auprc': 0.9989405168407692, 'loss_val': 0.1064310341063727, 'psi': 0.9973563805914831}
[S10] START round=31 head_norm_before_train=2.163984 (no previous merge yet)
[S10] round=31 local utility u=0.000248 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9931331602291883, 'loss_val': 0.032603941312874106, 'psi': 0.993394057910832}-{'f1_val': 0.9935679896985945, 'auprc': 0.9930439288101527, 'loss_val': 0.032833244434456316, 'psi': 0.9933583653432178}
[S11] START round=31 head_norm_before_train=1.287778 cos_to_last_merge=0.9947 (last merge round=27)
[S11] round=31 local utility u=0.009856 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.994492363796226, 'loss_val': 0.08712906747688173, 'psi': 0.995477150466476}-{'f1_val': 0.9958918378685807, 'auprc': 0.9926662951485303, 'loss_val': 0.0999126814641982, 'psi': 0.9946016207805606}
[S13] START round=31 head_norm_before_train=1.893046 (no previous merge yet)
[S13] round=31 local utility u=0.299035 metrics={'f1_val': 0.6543647255386309, 'auprc': 0.7614515316190328, 'loss_val': 0.5875406835346472, 'psi': 0.6971994479707917}-{'f1_val': 0.6016788985213326, 'auprc': 0.7685835298386341, 'loss_val': 0.8908915014935586, 'psi': 0.6684407510482532}
[S14] START round=31 head_norm_before_train=1.181215 cos_to_last_merge=0.9990 (last merge round=29)
[S14] round=31 local utility u=0.015785 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9968988701435311, 'loss_val': 0.1057925159685768, 'psi': 0.9971037620808882}-{'f1_val': 0.9969975081576651, 'auprc': 0.9966817536652399, 'loss_val': 0.1352546380577478, 'psi': 0.996871206360695}
[S15] START round=31 head_norm_before_train=1.086278 cos_to_last_merge=0.9893 (last merge round=29)
[S15] round=31 local utility u=0.000000 metrics={'f1_val': 0.9838765464574964, 'auprc': 0.9908545608495642, 'loss_val': 0.1196329922062328, 'psi': 0.9866677522143237}-{'f1_val': 0.9954340008316187, 'auprc': 0.9906721099693883, 'loss_val': 0.17631858533646794, 'psi': 0.9935292444867265}
[S16] START round=31 head_norm_before_train=1.840529 cos_to_last_merge=1.0000 (last merge round=30)
[S16] round=31 local utility u=0.000000 metrics={'f1_val': 0.9239693799035529, 'auprc': 0.9925646393006413, 'loss_val': 0.36730840249278235, 'psi': 0.9514074836623883}-{'f1_val': 0.9596718636538519, 'auprc': 0.9916761116204609, 'loss_val': 0.11906615032244809, 'psi': 0.9724735628404955}
[S17] START round=31 head_norm_before_train=1.346557 cos_to_last_merge=1.0000 (last merge round=30)
[S17] round=31 local utility u=0.819706 metrics={'f1_val': 0.5892740800193634, 'auprc': 0.9816445794939744, 'loss_val': 0.7913118733705738, 'psi': 0.7462222798092079}-{'f1_val': 0.5344817992291, 'auprc': 0.7275264343673259, 'loss_val': 1.339616268524587, 'psi': 0.6116996532843904}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:59815
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S13] sending update (kind=head size=1792 to 1 peers)
[S4] not sending this round → trigger blocked (psi=0.952)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:59807
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.996)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:59815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:59814
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1801) from S6
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.153699)
[S15] loaded HEAD from S6 (vec_in norm=1.153699)
[S15] cosine check vs S6: cos=0.9172
[S15] BUFFERED delta from S6 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1798) from S11
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.326825)
[S14] loaded HEAD from S11 (vec_in norm=1.326825)
[S14] cosine check vs S11: cos=0.9813
[S14] BUFFERED delta from S11 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1797) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.149297)
[S6] loaded HEAD from S7 (vec_in norm=1.149297)
[S6] cosine check vs S7: cos=0.7972
[S6] BUFFERED delta from S7 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1795) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.226453)
[S15] loaded HEAD from S14 (vec_in norm=1.226453)
[S15] cosine check vs S14: cos=0.7534
[S15] BUFFERED delta from S14 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:59805
[S17] sending update (kind=head size=1803 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1803) from S17
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.390941)
[S5] loaded HEAD from S17 (vec_in norm=1.390941)
[S5] cosine check vs S17: cos=0.6930
[S5] BUFFERED delta from S17 (total buffered=1)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=31 metric=0.7109 head_norm=1.132447
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.084239e-01
[S5] stored merged vector for next round verification (round=31)
[S5] DEBUG after merge:  round=31 metric=0.7103 head_norm=1.161930 delta_norm=0.508424
[S5] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=31 metric=0.9839 head_norm=1.196810
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.163305e-01
[S15] stored merged vector for next round verification (round=31)
[S15] DEBUG after merge:  round=31 metric=0.9890 head_norm=1.110359 delta_norm=0.216330
[S15] aggregate: ACCEPT kept=['S6', 'S14'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=31 metric=0.8554 head_norm=1.153699
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.666765e-01
[S6] stored merged vector for next round verification (round=31)
[S6] DEBUG after merge:  round=31 metric=0.8272 head_norm=1.091559 delta_norm=0.366677
[S6] aggregate: ROLLBACK (f1_val pre=0.855 post=0.827 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=31 metric=0.9972 head_norm=1.226453
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.332162e-01
[S14] stored merged vector for next round verification (round=31)
[S14] DEBUG after merge:  round=31 metric=0.9972 head_norm=1.270661 delta_norm=0.133216
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=32 head_norm_before_train=2.015717 cos_to_last_merge=0.9978 (last merge round=27)
[S2] round=32 local utility u=0.118608 metrics={'f1_val': 0.8229516564117376, 'auprc': 0.9706821790365171, 'loss_val': 0.29122421614853233, 'psi': 0.8820438654616494}-{'f1_val': 0.8274791401453985, 'auprc': 0.9035864231302401, 'loss_val': 0.3543174397196692, 'psi': 0.8579220533393351}
[S3] START round=32 head_norm_before_train=1.983035 (no previous merge yet)
[S3] round=32 local utility u=0.135792 metrics={'f1_val': 0.997542018298261, 'auprc': 0.9986785371319625, 'loss_val': 0.03648483069043434, 'psi': 0.9979966258317415}-{'f1_val': 0.9610750853994537, 'auprc': 0.9988145318303998, 'loss_val': 0.08967536476466444, 'psi': 0.9761708639718322}
[S4] START round=32 head_norm_before_train=1.775474 cos_to_last_merge=0.9933 (last merge round=28)
[S4] round=32 local utility u=0.004344 metrics={'f1_val': 0.9393903513842503, 'auprc': 0.9665446576118888, 'loss_val': 0.2945475547336342, 'psi': 0.9502520738753057}-{'f1_val': 0.9393641652669368, 'auprc': 0.9705365682846092, 'loss_val': 0.3150547274212631, 'psi': 0.9518331264740058}
[S5] START round=32 head_norm_before_train=1.161930 cos_to_last_merge=1.0000 (last merge round=31)
[S5] round=32 local utility u=0.000000 metrics={'f1_val': 0.7142403540694661, 'auprc': 0.7924156800618156, 'loss_val': 0.5160006942699239, 'psi': 0.7455104844664059}-{'f1_val': 0.7109093822655016, 'auprc': 0.8770721619131024, 'loss_val': 0.44212101640037155, 'psi': 0.777374494124542}
[S6] START round=32 head_norm_before_train=1.091559 cos_to_last_merge=1.0000 (last merge round=31)
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.8003070263154817, 'auprc': 0.9513472017763609, 'loss_val': 0.526538234167512, 'psi': 0.8607230964998334}-{'f1_val': 0.8553809191319462, 'auprc': 0.9669945856546647, 'loss_val': 0.4772203584810669, 'psi': 0.9000263857410336}
[S7] START round=32 head_norm_before_train=1.149297 cos_to_last_merge=0.9996 (last merge round=29)
[S7] round=32 local utility u=0.000000 metrics={'f1_val': 0.6321696493607096, 'auprc': 0.7969195418541634, 'loss_val': 0.5640934727678276, 'psi': 0.6980696063580911}-{'f1_val': 0.665319697877756, 'auprc': 0.8323087370733767, 'loss_val': 0.4359044726284175, 'psi': 0.7321153135560043}
[S8] START round=32 head_norm_before_train=2.110369 (no previous merge yet)
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.9879572329959369, 'auprc': 0.9995170975897205, 'loss_val': 0.039809645602633885, 'psi': 0.9925811788334503}-{'f1_val': 0.9931961080096116, 'auprc': 0.9997129526886288, 'loss_val': 0.03062095869080996, 'psi': 0.9958028458812185}
[S9] START round=32 head_norm_before_train=1.470724 cos_to_last_merge=0.9896 (last merge round=28)
[S9] round=32 local utility u=0.008318 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9965219607954081, 'loss_val': 0.06649563149634333, 'psi': 0.9971357183245495}-{'f1_val': 0.9975448900106438, 'auprc': 0.9955515530760018, 'loss_val': 0.0802203786153056, 'psi': 0.996747555236787}
[S10] START round=32 head_norm_before_train=2.172905 (no previous merge yet)
[S10] round=32 local utility u=0.000000 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9928259197825668, 'loss_val': 0.03234095882896686, 'psi': 0.9932711617321834}-{'f1_val': 0.9935679896985945, 'auprc': 0.9931331602291883, 'loss_val': 0.032603941312874106, 'psi': 0.993394057910832}
[S11] START round=32 head_norm_before_train=1.326825 cos_to_last_merge=0.9924 (last merge round=27)
[S11] round=32 local utility u=0.005270 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.994211533894565, 'loss_val': 0.0757475279537831, 'psi': 0.9953648185058116}-{'f1_val': 0.9961336749133093, 'auprc': 0.994492363796226, 'loss_val': 0.08712906747688173, 'psi': 0.995477150466476}
[S13] START round=32 head_norm_before_train=1.900860 (no previous merge yet)
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.6171940020365535, 'auprc': 0.7797694799612732, 'loss_val': 0.973748380755652, 'psi': 0.6822241932064415}-{'f1_val': 0.6543647255386309, 'auprc': 0.7614515316190328, 'loss_val': 0.5875406835346472, 'psi': 0.6971994479707917}
[S14] START round=32 head_norm_before_train=1.270661 cos_to_last_merge=1.0000 (last merge round=31)
[S14] round=32 local utility u=0.011839 metrics={'f1_val': 0.9970233560109115, 'auprc': 0.998829555579413, 'loss_val': 0.08660520931672068, 'psi': 0.9977458358383121}-{'f1_val': 0.997240356705793, 'auprc': 0.9968988701435311, 'loss_val': 0.1057925159685768, 'psi': 0.9971037620808882}
[S15] START round=32 head_norm_before_train=1.110359 cos_to_last_merge=1.0000 (last merge round=31)
[S15] round=32 local utility u=0.000000 metrics={'f1_val': 0.9016191743390298, 'auprc': 0.9917650971930699, 'loss_val': 0.24100004319020168, 'psi': 0.9376775434806459}-{'f1_val': 0.9838765464574964, 'auprc': 0.9908545608495642, 'loss_val': 0.1196329922062328, 'psi': 0.9866677522143237}
[S16] START round=32 head_norm_before_train=1.851528 cos_to_last_merge=1.0000 (last merge round=30)
[S16] round=32 local utility u=0.012563 metrics={'f1_val': 0.9242115008148171, 'auprc': 0.9959557035896947, 'loss_val': 0.35380864900279113, 'psi': 0.9529091819247681}-{'f1_val': 0.9239693799035529, 'auprc': 0.9925646393006413, 'loss_val': 0.36730840249278235, 'psi': 0.9514074836623883}
[S17] START round=32 head_norm_before_train=1.390941 cos_to_last_merge=0.9991 (last merge round=30)
[S17] round=32 local utility u=0.000000 metrics={'f1_val': 0.5722253107778521, 'auprc': 0.8512088011307615, 'loss_val': 1.0357040299755529, 'psi': 0.6838187069190158}-{'f1_val': 0.5892740800193634, 'auprc': 0.9816445794939744, 'loss_val': 0.7913118733705738, 'psi': 0.7462222798092079}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:59803
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.995)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:59802
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:59816
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.998)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1798) from S3
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.997953)
[S2] loaded HEAD from S3 (vec_in norm=1.997953)
[S2] cosine check vs S3: cos=0.9887
[S2] BUFFERED delta from S3 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1803) from S4
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.801245)
[S16] loaded HEAD from S4 (vec_in norm=1.801245)
[S16] cosine check vs S4: cos=0.9775
[S16] BUFFERED delta from S4 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1798) from S2
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=2.032356)
[S3] loaded HEAD from S2 (vec_in norm=2.032356)
[S3] cosine check vs S2: cos=0.9887
[S3] BUFFERED delta from S2 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:59804
[S16] sending update (kind=head size=1802 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1802) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.865930)
[S4] loaded HEAD from S16 (vec_in norm=1.865930)
[S4] cosine check vs S16: cos=0.9775
[S4] BUFFERED delta from S16 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:59805
[S9] sending update (kind=head size=1800 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1800) from S9
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.498445)
[S5] loaded HEAD from S9 (vec_in norm=1.498445)
[S5] cosine check vs S9: cos=0.5389
[S5] BUFFERED delta from S9 (total buffered=1)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=32 metric=0.9394 head_norm=1.801245
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.971903e-01
[S4] stored merged vector for next round verification (round=32)
[S4] DEBUG after merge:  round=32 metric=0.9394 head_norm=1.823240 delta_norm=0.197190
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=32 metric=0.8230 head_norm=2.032356
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.527483e-01
[S2] stored merged vector for next round verification (round=32)
[S2] DEBUG after merge:  round=32 metric=0.8348 head_norm=2.009431 delta_norm=0.152748
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=32 metric=0.9975 head_norm=1.997953
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.527483e-01
[S3] stored merged vector for next round verification (round=32)
[S3] DEBUG after merge:  round=32 metric=0.9978 head_norm=2.009431 delta_norm=0.152748
[S3] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=32 metric=0.7142 head_norm=1.207699
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.620859e-01
[S5] stored merged vector for next round verification (round=32)
[S5] DEBUG after merge:  round=32 metric=0.7142 head_norm=1.188941 delta_norm=0.662086
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=32 metric=0.9242 head_norm=1.865930
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.971903e-01
[S16] stored merged vector for next round verification (round=32)
[S16] DEBUG after merge:  round=32 metric=0.9223 head_norm=1.823240 delta_norm=0.197190
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=33 head_norm_before_train=2.009431 cos_to_last_merge=1.0000 (last merge round=32)
[S2] round=33 local utility u=0.000000 metrics={'f1_val': 0.8283620506113877, 'auprc': 0.911452852123108, 'loss_val': 0.37731136441254237, 'psi': 0.8615983712160757}-{'f1_val': 0.8229516564117376, 'auprc': 0.9706821790365171, 'loss_val': 0.29122421614853233, 'psi': 0.8820438654616494}
[S3] START round=33 head_norm_before_train=2.009431 cos_to_last_merge=1.0000 (last merge round=32)
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.9637704531144897, 'auprc': 0.9985490968976132, 'loss_val': 0.08522583499283133, 'psi': 0.9776819106277391}-{'f1_val': 0.997542018298261, 'auprc': 0.9986785371319625, 'loss_val': 0.03648483069043434, 'psi': 0.9979966258317415}
[S4] START round=33 head_norm_before_train=1.823240 cos_to_last_merge=1.0000 (last merge round=32)
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.9398290922183721, 'auprc': 0.9555257665606962, 'loss_val': 0.2906582845470029, 'psi': 0.9461077619553018}-{'f1_val': 0.9393903513842503, 'auprc': 0.9665446576118888, 'loss_val': 0.2945475547336342, 'psi': 0.9502520738753057}
[S5] START round=33 head_norm_before_train=1.188941 cos_to_last_merge=1.0000 (last merge round=32)
[S5] round=33 local utility u=0.350636 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9967091567153477, 'loss_val': 0.3440897468699321, 'psi': 0.8188760217809545}-{'f1_val': 0.7142403540694661, 'auprc': 0.7924156800618156, 'loss_val': 0.5160006942699239, 'psi': 0.7455104844664059}
[S6] START round=33 head_norm_before_train=1.132391 cos_to_last_merge=0.9988 (last merge round=31)
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.7085552535910298, 'auprc': 0.944119549900373, 'loss_val': 0.6593689322952035, 'psi': 0.802780972114767}-{'f1_val': 0.8003070263154817, 'auprc': 0.9513472017763609, 'loss_val': 0.526538234167512, 'psi': 0.8607230964998334}
[S7] START round=33 head_norm_before_train=1.158992 cos_to_last_merge=0.9993 (last merge round=29)
[S7] round=33 local utility u=0.057936 metrics={'f1_val': 0.6424339322055324, 'auprc': 0.8015348540079441, 'loss_val': 0.5236527648286737, 'psi': 0.7060743009264971}-{'f1_val': 0.6321696493607096, 'auprc': 0.7969195418541634, 'loss_val': 0.5640934727678276, 'psi': 0.6980696063580911}
[S8] START round=33 head_norm_before_train=2.117122 (no previous merge yet)
[S8] round=33 local utility u=0.011729 metrics={'f1_val': 0.9906522705779591, 'auprc': 0.9996775615939074, 'loss_val': 0.03300381390171478, 'psi': 0.9942623869843384}-{'f1_val': 0.9879572329959369, 'auprc': 0.9995170975897205, 'loss_val': 0.039809645602633885, 'psi': 0.9925811788334503}
[S9] START round=33 head_norm_before_train=1.498445 cos_to_last_merge=0.9855 (last merge round=28)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.9889102855642282, 'auprc': 0.9974138583755854, 'loss_val': 0.07775046939689154, 'psi': 0.9923117146887711}-{'f1_val': 0.9975448900106438, 'auprc': 0.9965219607954081, 'loss_val': 0.06649563149634333, 'psi': 0.9971357183245495}
[S10] START round=33 head_norm_before_train=2.181760 (no previous merge yet)
[S10] round=33 local utility u=0.000000 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9933554827644974, 'loss_val': 0.033231449676418896, 'psi': 0.9934018179983425}-{'f1_val': 0.9935679896985945, 'auprc': 0.9928259197825668, 'loss_val': 0.03234095882896686, 'psi': 0.9932711617321834}
[S11] START round=33 head_norm_before_train=1.362620 cos_to_last_merge=0.9901 (last merge round=27)
[S11] round=33 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9935083598580395, 'loss_val': 0.07780799553115772, 'psi': 0.9950835488912014}-{'f1_val': 0.9961336749133093, 'auprc': 0.994211533894565, 'loss_val': 0.0757475279537831, 'psi': 0.9953648185058116}
[S13] START round=33 head_norm_before_train=1.912101 (no previous merge yet)
[S13] round=33 local utility u=0.253940 metrics={'f1_val': 0.6640289952956487, 'auprc': 0.7705999541114138, 'loss_val': 0.7193695672509242, 'psi': 0.7066573788219548}-{'f1_val': 0.6171940020365535, 'auprc': 0.7797694799612732, 'loss_val': 0.973748380755652, 'psi': 0.6822241932064415}
[S14] START round=33 head_norm_before_train=1.310036 cos_to_last_merge=0.9996 (last merge round=31)
[S14] round=33 local utility u=0.003384 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9966586493897072, 'loss_val': 0.07070803313926961, 'psi': 0.9966157987223331}-{'f1_val': 0.9970233560109115, 'auprc': 0.998829555579413, 'loss_val': 0.08660520931672068, 'psi': 0.9977458358383121}
[S15] START round=33 head_norm_before_train=1.194040 cos_to_last_merge=0.9969 (last merge round=31)
[S15] round=33 local utility u=0.375211 metrics={'f1_val': 0.9965259456095847, 'auprc': 0.9978867316670298, 'loss_val': 0.07838379389015993, 'psi': 0.9970702600325627}-{'f1_val': 0.9016191743390298, 'auprc': 0.9917650971930699, 'loss_val': 0.24100004319020168, 'psi': 0.9376775434806459}
[S16] START round=33 head_norm_before_train=1.823240 cos_to_last_merge=1.0000 (last merge round=32)
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.8692479196467544, 'auprc': 0.9957283206234836, 'loss_val': 0.5639628666557542, 'psi': 0.919840080037446}-{'f1_val': 0.9242115008148171, 'auprc': 0.9959557035896947, 'loss_val': 0.35380864900279113, 'psi': 0.9529091819247681}
[S17] START round=33 head_norm_before_train=1.462371 cos_to_last_merge=0.9962 (last merge round=30)
[S17] round=33 local utility u=0.174454 metrics={'f1_val': 0.5972143681109382, 'auprc': 0.8899393547793151, 'loss_val': 0.9529219428574899, 'psi': 0.714304362778289}-{'f1_val': 0.5722253107778521, 'auprc': 0.8512088011307615, 'loss_val': 1.0357040299755529, 'psi': 0.6838187069190158}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:59817
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:59807
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:59815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S8] sending update (kind=head size=1807 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1795) from S5
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.218001)
[S17] loaded HEAD from S5 (vec_in norm=1.218001)
[S17] cosine check vs S5: cos=0.6665
[S17] BUFFERED delta from S5 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1799) from S15
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.268544)
[S6] loaded HEAD from S15 (vec_in norm=1.268544)
[S6] cosine check vs S15: cos=0.8178
[S6] BUFFERED delta from S15 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1798) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.171559)
[S6] loaded HEAD from S7 (vec_in norm=1.171559)
[S6] cosine check vs S7: cos=0.9284
[S6] BUFFERED delta from S7 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1797) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.343810)
[S15] loaded HEAD from S14 (vec_in norm=1.343810)
[S15] cosine check vs S14: cos=0.7940
[S15] BUFFERED delta from S14 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:59805
[S17] sending update (kind=head size=1801 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1801) from S17
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.518376)
[S5] loaded HEAD from S17 (vec_in norm=1.518376)
[S5] cosine check vs S17: cos=0.6665
[S5] BUFFERED delta from S17 (total buffered=1)
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=33 metric=0.7086 head_norm=1.168455
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.615665e-01
[S6] stored merged vector for next round verification (round=33)
[S6] DEBUG after merge:  round=33 metric=0.7136 head_norm=1.125904 delta_norm=0.161566
[S6] aggregate: ACCEPT kept=['S15', 'S7'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=33 metric=0.7003 head_norm=1.218001
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.752996e-01
[S5] stored merged vector for next round verification (round=33)
[S5] DEBUG after merge:  round=33 metric=0.7015 head_norm=1.250411 delta_norm=0.575300
[S5] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=33 metric=0.5972 head_norm=1.518376
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.752995e-01
[S17] stored merged vector for next round verification (round=33)
[S17] DEBUG after merge:  round=33 metric=0.6029 head_norm=1.250411 delta_norm=0.575300
[S17] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=33 metric=0.9965 head_norm=1.268544
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.207447e-01
[S15] stored merged vector for next round verification (round=33)
[S15] DEBUG after merge:  round=33 metric=0.9965 head_norm=1.237129 delta_norm=0.420745
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=34 head_norm_before_train=2.027248 cos_to_last_merge=0.9999 (last merge round=32)
[S2] round=34 local utility u=0.056141 metrics={'f1_val': 0.8254578577754816, 'auprc': 0.9677429789793993, 'loss_val': 0.416474965368644, 'psi': 0.8823719062570488}-{'f1_val': 0.8283620506113877, 'auprc': 0.911452852123108, 'loss_val': 0.37731136441254237, 'psi': 0.8615983712160757}
[S3] START round=34 head_norm_before_train=2.023171 cos_to_last_merge=1.0000 (last merge round=32)
[S3] round=34 local utility u=0.094833 metrics={'f1_val': 0.9911102450811275, 'auprc': 0.9986812818702422, 'loss_val': 0.05999476412476655, 'psi': 0.9941386597967734}-{'f1_val': 0.9637704531144897, 'auprc': 0.9985490968976132, 'loss_val': 0.08522583499283133, 'psi': 0.9776819106277391}
[S4] START round=34 head_norm_before_train=1.847261 cos_to_last_merge=0.9998 (last merge round=32)
[S4] round=34 local utility u=0.017808 metrics={'f1_val': 0.9450489284550119, 'auprc': 0.9538161365702503, 'loss_val': 0.2812325794563179, 'psi': 0.9485558117011073}-{'f1_val': 0.9398290922183721, 'auprc': 0.9555257665606962, 'loss_val': 0.2906582845470029, 'psi': 0.9461077619553018}
[S5] START round=34 head_norm_before_train=1.250411 cos_to_last_merge=1.0000 (last merge round=33)
[S5] round=34 local utility u=0.000000 metrics={'f1_val': 0.714306097623075, 'auprc': 0.792229601997917, 'loss_val': 0.5503699866600976, 'psi': 0.7454754993730117}-{'f1_val': 0.700320598491359, 'auprc': 0.9967091567153477, 'loss_val': 0.3440897468699321, 'psi': 0.8188760217809545}
[S6] START round=34 head_norm_before_train=1.125904 cos_to_last_merge=1.0000 (last merge round=33)
[S6] round=34 local utility u=0.761046 metrics={'f1_val': 0.8986315383023571, 'auprc': 0.9694161602917164, 'loss_val': 0.3536253568457925, 'psi': 0.9269453870981008}-{'f1_val': 0.7085552535910298, 'auprc': 0.944119549900373, 'loss_val': 0.6593689322952035, 'psi': 0.802780972114767}
[S7] START round=34 head_norm_before_train=1.171559 cos_to_last_merge=0.9988 (last merge round=29)
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.4807184313607825, 'auprc': 0.7799004237258, 'loss_val': 0.8473664141639894, 'psi': 0.6003912283067896}-{'f1_val': 0.6424339322055324, 'auprc': 0.8015348540079441, 'loss_val': 0.5236527648286737, 'psi': 0.7060743009264971}
[S8] START round=34 head_norm_before_train=2.122581 (no previous merge yet)
[S8] round=34 local utility u=0.000000 metrics={'f1_val': 0.989930320298491, 'auprc': 0.9996482016461153, 'loss_val': 0.0354868428317341, 'psi': 0.9938174728375408}-{'f1_val': 0.9906522705779591, 'auprc': 0.9996775615939074, 'loss_val': 0.03300381390171478, 'psi': 0.9942623869843384}
[S9] START round=34 head_norm_before_train=1.521725 cos_to_last_merge=0.9823 (last merge round=28)
[S9] round=34 local utility u=0.032433 metrics={'f1_val': 0.9971344652643916, 'auprc': 0.9941958028701222, 'loss_val': 0.05257496091593558, 'psi': 0.9959590003066838}-{'f1_val': 0.9889102855642282, 'auprc': 0.9974138583755854, 'loss_val': 0.07775046939689154, 'psi': 0.9923117146887711}
[S10] START round=34 head_norm_before_train=2.186889 (no previous merge yet)
[S10] round=34 local utility u=0.000508 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9930227218069825, 'loss_val': 0.03202831760609399, 'psi': 0.9933498825419497}-{'f1_val': 0.9934327081542391, 'auprc': 0.9933554827644974, 'loss_val': 0.033231449676418896, 'psi': 0.9934018179983425}
[S11] START round=34 head_norm_before_train=1.394605 cos_to_last_merge=0.9880 (last merge round=27)
[S11] round=34 local utility u=0.000000 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9934964951923981, 'loss_val': 0.07784384312555785, 'psi': 0.9949337007981076}-{'f1_val': 0.9961336749133093, 'auprc': 0.9935083598580395, 'loss_val': 0.07780799553115772, 'psi': 0.9950835488912014}
[S13] START round=34 head_norm_before_train=1.916710 (no previous merge yet)
[S13] round=34 local utility u=0.000000 metrics={'f1_val': 0.6540973912131056, 'auprc': 0.7668930832297055, 'loss_val': 0.7339142989443317, 'psi': 0.6992156680197456}-{'f1_val': 0.6640289952956487, 'auprc': 0.7705999541114138, 'loss_val': 0.7193695672509242, 'psi': 0.7066573788219548}
[S14] START round=34 head_norm_before_train=1.343810 cos_to_last_merge=0.9988 (last merge round=31)
[S14] round=34 local utility u=0.004452 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9966254052475056, 'loss_val': 0.061704025034676986, 'psi': 0.9966025010654525}-{'f1_val': 0.9965872316107504, 'auprc': 0.9966586493897072, 'loss_val': 0.07070803313926961, 'psi': 0.9966157987223331}
[S15] START round=34 head_norm_before_train=1.237129 cos_to_last_merge=1.0000 (last merge round=33)
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.9023462775246476, 'auprc': 0.9949742439097449, 'loss_val': 0.23324978595474416, 'psi': 0.9393974640786864}-{'f1_val': 0.9965259456095847, 'auprc': 0.9978867316670298, 'loss_val': 0.07838379389015993, 'psi': 0.9970702600325627}
[S16] START round=34 head_norm_before_train=1.838053 cos_to_last_merge=1.0000 (last merge round=32)
[S16] round=34 local utility u=0.000000 metrics={'f1_val': 0.8571183068741983, 'auprc': 0.9939967022500851, 'loss_val': 0.6955984206960656, 'psi': 0.911869665024553}-{'f1_val': 0.8692479196467544, 'auprc': 0.9957283206234836, 'loss_val': 0.5639628666557542, 'psi': 0.919840080037446}
[S17] START round=34 head_norm_before_train=1.250411 cos_to_last_merge=1.0000 (last merge round=33)
[S17] round=34 local utility u=0.000000 metrics={'f1_val': 0.5690897999423794, 'auprc': 0.7933060810423176, 'loss_val': 1.0737847313112405, 'psi': 0.6587763123823547}-{'f1_val': 0.5972143681109382, 'auprc': 0.8899393547793151, 'loss_val': 0.9529219428574899, 'psi': 0.714304362778289}
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S16
[S6]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S16
[S15]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S10
[S14]  timeout peer S13
[S14]  timeout peer S16
[S14]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:59815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:59802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:59805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:59815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:59816
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:59803
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1795 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1801) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.373249)
[S15] loaded HEAD from S14 (vec_in norm=1.373249)
[S15] cosine check vs S14: cos=0.9343
[S15] BUFFERED delta from S14 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1801) from S6
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.171450)
[S15] loaded HEAD from S6 (vec_in norm=1.171450)
[S15] cosine check vs S6: cos=0.7834
[S15] BUFFERED delta from S6 (total buffered=2)
[S2] RECEIVED delta(kind=head bytes=1797) from S3
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=2.035312)
[S2] loaded HEAD from S3 (vec_in norm=2.035312)
[S2] cosine check vs S3: cos=0.9996
[S2] BUFFERED delta from S3 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1799) from S9
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.541002)
[S5] loaded HEAD from S9 (vec_in norm=1.541002)
[S5] cosine check vs S9: cos=0.6108
[S5] BUFFERED delta from S9 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1797) from S4
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.867586)
[S16] loaded HEAD from S4 (vec_in norm=1.867586)
[S16] cosine check vs S4: cos=0.9989
[S16] BUFFERED delta from S4 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1795) from S2
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=2.047616)
[S3] loaded HEAD from S2 (vec_in norm=2.047616)
[S3] cosine check vs S2: cos=0.9996
[S3] BUFFERED delta from S2 (total buffered=1)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=34 metric=0.9911 head_norm=2.035312
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.071116e-02
[S3] stored merged vector for next round verification (round=34)
[S3] DEBUG after merge:  round=34 metric=0.9911 head_norm=2.041242 delta_norm=0.030711
[S3] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=34 metric=0.8255 head_norm=2.047616
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.071116e-02
[S2] stored merged vector for next round verification (round=34)
[S2] DEBUG after merge:  round=34 metric=0.8255 head_norm=2.041242 delta_norm=0.030711
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=34 metric=0.7143 head_norm=1.282781
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.335480e-01
[S5] stored merged vector for next round verification (round=34)
[S5] DEBUG after merge:  round=34 metric=0.7143 head_norm=1.268354 delta_norm=0.633548
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=34 metric=0.9023 head_norm=1.297250
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.829707e-01
[S15] stored merged vector for next round verification (round=34)
[S15] DEBUG after merge:  round=34 metric=0.9029 head_norm=1.208694 delta_norm=0.182971
[S15] aggregate: ACCEPT kept=['S14', 'S6'] (k=2/2) mode=median trim_p=0.1
[S6] CommDone barrier timeout: have=2 need=3 — continuing
[S2] START round=35 head_norm_before_train=2.041242 cos_to_last_merge=1.0000 (last merge round=34)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.7295417818668641, 'auprc': 0.8054356593540839, 'loss_val': 0.46119213090962385, 'psi': 0.759899332861752}-{'f1_val': 0.8254578577754816, 'auprc': 0.9677429789793993, 'loss_val': 0.416474965368644, 'psi': 0.8823719062570488}
[S3] START round=35 head_norm_before_train=2.041242 cos_to_last_merge=1.0000 (last merge round=34)
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.987368141410594, 'auprc': 0.9986027215104475, 'loss_val': 0.06420689513317113, 'psi': 0.9918619734505354}-{'f1_val': 0.9911102450811275, 'auprc': 0.9986812818702422, 'loss_val': 0.05999476412476655, 'psi': 0.9941386597967734}
[S4] START round=35 head_norm_before_train=1.867586 cos_to_last_merge=0.9992 (last merge round=32)
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.9415123058428478, 'auprc': 0.9569030082256019, 'loss_val': 0.2867884699167301, 'psi': 0.9476685867959495}-{'f1_val': 0.9450489284550119, 'auprc': 0.9538161365702503, 'loss_val': 0.2812325794563179, 'psi': 0.9485558117011073}
[S5] START round=35 head_norm_before_train=1.268354 cos_to_last_merge=1.0000 (last merge round=34)
[S5] round=35 local utility u=0.379776 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9966557029938277, 'loss_val': 0.32018317022630677, 'psi': 0.8188546402923464}-{'f1_val': 0.714306097623075, 'auprc': 0.792229601997917, 'loss_val': 0.5503699866600976, 'psi': 0.7454754993730117}
[S6] START round=35 head_norm_before_train=1.171450 cos_to_last_merge=0.9989 (last merge round=33)
[S6] round=35 local utility u=0.000000 metrics={'f1_val': 0.7059346471047803, 'auprc': 0.9299784585773754, 'loss_val': 0.6809615529997529, 'psi': 0.7955521716938183}-{'f1_val': 0.8986315383023571, 'auprc': 0.9694161602917164, 'loss_val': 0.3536253568457925, 'psi': 0.9269453870981008}
[S7] START round=35 head_norm_before_train=1.189256 cos_to_last_merge=0.9980 (last merge round=29)
[S7] round=35 local utility u=0.834720 metrics={'f1_val': 0.6679249738424997, 'auprc': 0.8252646344549607, 'loss_val': 0.4372577301659848, 'psi': 0.7308608380874841}-{'f1_val': 0.4807184313607825, 'auprc': 0.7799004237258, 'loss_val': 0.8473664141639894, 'psi': 0.6003912283067896}
[S8] START round=35 head_norm_before_train=2.135096 (no previous merge yet)
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.9908851572808252, 'auprc': 0.9803743961375904, 'loss_val': 0.03870013797193773, 'psi': 0.9866808528235312}-{'f1_val': 0.989930320298491, 'auprc': 0.9996482016461153, 'loss_val': 0.0354868428317341, 'psi': 0.9938174728375408}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=35 head_norm_before_train=1.541002 cos_to_last_merge=0.9797 (last merge round=28)
[S9] round=35 local utility u=0.005660 metrics={'f1_val': 0.9963002897586258, 'auprc': 0.9983748682278049, 'loss_val': 0.04878677263796182, 'psi': 0.9971301211462974}-{'f1_val': 0.9971344652643916, 'auprc': 0.9941958028701222, 'loss_val': 0.05257496091593558, 'psi': 0.9959590003066838}
[S10] START round=35 head_norm_before_train=2.196388 (no previous merge yet)
[S10] round=35 local utility u=0.000000 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9926572837866, 'loss_val': 0.03187360414372667, 'psi': 0.9931225384071836}-{'f1_val': 0.9935679896985945, 'auprc': 0.9930227218069825, 'loss_val': 0.03202831760609399, 'psi': 0.9933498825419497}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=35 head_norm_before_train=1.422040 cos_to_last_merge=0.9861 (last merge round=27)
[S11] round=35 local utility u=0.010073 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9937139037174542, 'loss_val': 0.05980156457933307, 'psi': 0.9951657664349672}-{'f1_val': 0.9958918378685807, 'auprc': 0.9934964951923981, 'loss_val': 0.07784384312555785, 'psi': 0.9949337007981076}
[S13] START round=35 head_norm_before_train=1.927929 (no previous merge yet)
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.618165544219226, 'auprc': 0.7879145576042947, 'loss_val': 0.9054089434439128, 'psi': 0.6860651495732535}-{'f1_val': 0.6540973912131056, 'auprc': 0.7668930832297055, 'loss_val': 0.7339142989443317, 'psi': 0.6992156680197456}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=35 head_norm_before_train=1.373249 cos_to_last_merge=0.9977 (last merge round=31)
[S14] round=35 local utility u=0.004990 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9973444654270627, 'loss_val': 0.053881397914551786, 'psi': 0.9968901251372753}-{'f1_val': 0.9965872316107504, 'auprc': 0.9966254052475056, 'loss_val': 0.061704025034676986, 'psi': 0.9966025010654525}
[S15] START round=35 head_norm_before_train=1.208694 cos_to_last_merge=1.0000 (last merge round=34)
[S15] round=35 local utility u=0.332339 metrics={'f1_val': 0.9945108292729825, 'auprc': 0.9922338664038188, 'loss_val': 0.11333786093003193, 'psi': 0.993600044125317}-{'f1_val': 0.9023462775246476, 'auprc': 0.9949742439097449, 'loss_val': 0.23324978595474416, 'psi': 0.9393974640786864}
[S16] START round=35 head_norm_before_train=1.854056 cos_to_last_merge=0.9999 (last merge round=32)
[S16] round=35 local utility u=0.000438 metrics={'f1_val': 0.8581796826332654, 'auprc': 0.9915047981066374, 'loss_val': 0.6936141496861055, 'psi': 0.9115097288226142}-{'f1_val': 0.8571183068741983, 'auprc': 0.9939967022500851, 'loss_val': 0.6955984206960656, 'psi': 0.911869665024553}
[S17] START round=35 head_norm_before_train=1.324911 cos_to_last_merge=0.9983 (last merge round=33)
[S17] round=35 local utility u=0.775716 metrics={'f1_val': 0.6526108435963597, 'auprc': 0.9994670478347647, 'loss_val': 0.6419622983097897, 'psi': 0.7913533252917218}-{'f1_val': 0.5690897999423794, 'auprc': 0.7933060810423176, 'loss_val': 1.0737847313112405, 'psi': 0.6587763123823547}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:59814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:59805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:59804
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] ⇄ pheromone p=0.040 → S3@127.0.0.1:59803
[S3] ⇄ pheromone p=0.058 → S2@127.0.0.1:59802
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] sending update (kind=head size=1794 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] RECEIVED delta(kind=head bytes=1798) from S11
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.446121)
[S14] loaded HEAD from S11 (vec_in norm=1.446121)
[S14] cosine check vs S11: cos=0.9850
[S14] BUFFERED delta from S11 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1801) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.868940)
[S4] loaded HEAD from S16 (vec_in norm=1.868940)
[S4] cosine check vs S16: cos=0.9980
[S4] BUFFERED delta from S16 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1794) from S17
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.393441)
[S5] loaded HEAD from S17 (vec_in norm=1.393441)
[S5] cosine check vs S17: cos=0.8608
[S5] BUFFERED delta from S17 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1798) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.203709)
[S6] loaded HEAD from S7 (vec_in norm=1.203709)
[S6] cosine check vs S7: cos=0.9021
[S6] BUFFERED delta from S7 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:59817
[S7] ⇄ pheromone p=0.294 → S6@127.0.0.1:59807
[S11] ⇄ pheromone p=0.012 → S14@127.0.0.1:59814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:59805
[S17] ⇄ pheromone p=0.288 → S5@127.0.0.1:59805
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=35 metric=0.8582 head_norm=1.868940
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.636545e-02
[S16] stored merged vector for next round verification (round=35)
[S16] DEBUG after merge:  round=35 metric=0.8582 head_norm=1.867688 delta_norm=0.046365
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.076 → S4@127.0.0.1:59804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:59815
[S9] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=35 metric=0.9415 head_norm=1.887190
[S4] _apply_head_vector_avg (torch): Δ‖w‖=6.025982e-02
[S4] stored merged vector for next round verification (round=35)
[S4] DEBUG after merge:  round=35 metric=0.9415 head_norm=1.877120 delta_norm=0.060260
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.015 → S16@127.0.0.1:59816
[S15] RECEIVED delta(kind=head bytes=1794) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.398641)
[S15] loaded HEAD from S14 (vec_in norm=1.398641)
[S15] cosine check vs S14: cos=0.9165
[S15] BUFFERED delta from S14 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1799) from S9
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.557179)
[S5] loaded HEAD from S9 (vec_in norm=1.557179)
[S5] cosine check vs S9: cos=0.9118
[S5] BUFFERED delta from S9 (total buffered=2)
[S17] RECEIVED delta(kind=head bytes=1794) from S5
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.286274)
[S17] loaded HEAD from S5 (vec_in norm=1.286274)
[S17] cosine check vs S5: cos=0.8608
[S17] BUFFERED delta from S5 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:59807
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=35 metric=0.7003 head_norm=1.286274
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.503477e-02
[S5] stored merged vector for next round verification (round=35)
[S5] DEBUG after merge:  round=35 metric=0.7003 head_norm=1.298687 delta_norm=0.045035
[S5] aggregate: ACCEPT kept=['S17', 'S9'] (k=2/2) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.172 → S17@127.0.0.1:59817
[S9] ⇄ pheromone p=0.021 → S5@127.0.0.1:59805
[S15] sending update (kind=head size=1801 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1801) from S15
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.280601)
[S6] loaded HEAD from S15 (vec_in norm=1.280601)
[S6] cosine check vs S15: cos=0.8349
[S6] BUFFERED delta from S15 (total buffered=2)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=35 metric=0.9945 head_norm=1.280601
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.798080e-01
[S15] stored merged vector for next round verification (round=35)
[S15] DEBUG after merge:  round=35 metric=0.9951 head_norm=1.311402 delta_norm=0.279808
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.226 → S6@127.0.0.1:59807
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=35 metric=0.9966 head_norm=1.398641
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.252347e-01
[S14] stored merged vector for next round verification (round=35)
[S14] DEBUG after merge:  round=35 metric=0.9966 head_norm=1.417056 delta_norm=0.125235
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.022 → S15@127.0.0.1:59815
[S11]  timeout peer S14
[S6]  timeout peer S2
[S6]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S15
[S5]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S11
[S9]  timeout peer S13
[S4]  timeout peer S10
[S15]  timeout peer S6
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=35 metric=0.7059 head_norm=1.216654
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.726168e-01
[S6] stored merged vector for next round verification (round=35)
[S6] DEBUG after merge:  round=35 metric=0.7111 head_norm=1.157914 delta_norm=0.172617
[S6] aggregate: ACCEPT kept=['S7', 'S15'] (k=2/2) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.202 → S7@127.0.0.1:59808
[S2] START round=36 head_norm_before_train=2.058829 cos_to_last_merge=0.9999 (last merge round=34)
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.6894423130318318, 'auprc': 0.7427620248470721, 'loss_val': 0.5715855774582824, 'psi': 0.7107701977579279}-{'f1_val': 0.7295417818668641, 'auprc': 0.8054356593540839, 'loss_val': 0.46119213090962385, 'psi': 0.759899332861752}
[S3] START round=36 head_norm_before_train=2.051423 cos_to_last_merge=1.0000 (last merge round=34)
[S3] round=36 local utility u=0.000000 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9988433308943588, 'loss_val': 0.10645892081018213, 'psi': 0.9761823835974158}-{'f1_val': 0.987368141410594, 'auprc': 0.9986027215104475, 'loss_val': 0.06420689513317113, 'psi': 0.9918619734505354}
[S4] START round=36 head_norm_before_train=1.877120 cos_to_last_merge=1.0000 (last merge round=35)
[S4] round=36 local utility u=0.000000 metrics={'f1_val': 0.9390732908208931, 'auprc': 0.9572737682556647, 'loss_val': 0.30060693878406314, 'psi': 0.9463534817948017}-{'f1_val': 0.9415123058428478, 'auprc': 0.9569030082256019, 'loss_val': 0.2867884699167301, 'psi': 0.9476685867959495}
[S5] START round=36 head_norm_before_train=1.298687 cos_to_last_merge=1.0000 (last merge round=35)
[S5] round=36 local utility u=0.000000 metrics={'f1_val': 0.7143712450552575, 'auprc': 0.7938136051693331, 'loss_val': 0.5041408926380536, 'psi': 0.7461481891008878}-{'f1_val': 0.700320598491359, 'auprc': 0.9966557029938277, 'loss_val': 0.32018317022630677, 'psi': 0.8188546402923464}
[S6] START round=36 head_norm_before_train=1.157914 cos_to_last_merge=1.0000 (last merge round=35)
[S6] round=36 local utility u=0.471139 metrics={'f1_val': 0.8501518503868629, 'auprc': 0.9138921113871963, 'loss_val': 0.5557275213027187, 'psi': 0.8756479547869962}-{'f1_val': 0.7059346471047803, 'auprc': 0.9299784585773754, 'loss_val': 0.6809615529997529, 'psi': 0.7955521716938183}
[S7] START round=36 head_norm_before_train=1.203709 cos_to_last_merge=0.9973 (last merge round=29)
[S7] round=36 local utility u=0.000000 metrics={'f1_val': 0.6487235703860017, 'auprc': 0.8064858289985951, 'loss_val': 0.49873596938161163, 'psi': 0.7118284738310391}-{'f1_val': 0.6679249738424997, 'auprc': 0.8252646344549607, 'loss_val': 0.4372577301659848, 'psi': 0.7308608380874841}
[S8] START round=36 head_norm_before_train=2.152049 (no previous merge yet)
[S8] round=36 local utility u=0.016200 metrics={'f1_val': 0.987260455059864, 'auprc': 0.9992671668462522, 'loss_val': 0.04122994940963068, 'psi': 0.9920631397744193}-{'f1_val': 0.9908851572808252, 'auprc': 0.9803743961375904, 'loss_val': 0.03870013797193773, 'psi': 0.9866808528235312}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=36 head_norm_before_train=1.557179 cos_to_last_merge=0.9777 (last merge round=28)
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.9933838446360591, 'auprc': 0.9983830472063132, 'loss_val': 0.05052519730477866, 'psi': 0.9953835256641608}-{'f1_val': 0.9963002897586258, 'auprc': 0.9983748682278049, 'loss_val': 0.04878677263796182, 'psi': 0.9971301211462974}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=36 head_norm_before_train=2.207023 (no previous merge yet)
[S10] round=36 local utility u=0.000908 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9933381114792055, 'loss_val': 0.03291189721625911, 'psi': 0.9934760384108389}-{'f1_val': 0.9934327081542391, 'auprc': 0.9926572837866, 'loss_val': 0.03187360414372667, 'psi': 0.9931225384071836}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=36 head_norm_before_train=1.446121 cos_to_last_merge=0.9844 (last merge round=27)
[S11] round=36 local utility u=0.007429 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9956359755853257, 'loss_val': 0.05071030004505391, 'psi': 0.9959345951821159}-{'f1_val': 0.9961336749133093, 'auprc': 0.9937139037174542, 'loss_val': 0.05980156457933307, 'psi': 0.9951657664349672}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=36 head_norm_before_train=1.938477 (no previous merge yet)
[S13] round=36 local utility u=0.178499 metrics={'f1_val': 0.6535875222205147, 'auprc': 0.7759273157186635, 'loss_val': 0.7249817544737314, 'psi': 0.7025234396197743}-{'f1_val': 0.618165544219226, 'auprc': 0.7879145576042947, 'loss_val': 0.9054089434439128, 'psi': 0.6860651495732535}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] sending update (kind=head size=1794 to 1 peers)
[S14] START round=36 head_norm_before_train=1.417056 cos_to_last_merge=1.0000 (last merge round=35)
[S14] round=36 local utility u=0.003255 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9988558653537659, 'loss_val': 0.05190617642775003, 'psi': 0.9974946851079566}-{'f1_val': 0.9965872316107504, 'auprc': 0.9973444654270627, 'loss_val': 0.053881397914551786, 'psi': 0.9968901251372753}
[S15] START round=36 head_norm_before_train=1.311402 cos_to_last_merge=1.0000 (last merge round=35)
[S15] round=36 local utility u=0.000000 metrics={'f1_val': 0.8251868556861368, 'auprc': 0.9921172712190596, 'loss_val': 0.31420240975600183, 'psi': 0.8919590218993059}-{'f1_val': 0.9945108292729825, 'auprc': 0.9922338664038188, 'loss_val': 0.11333786093003193, 'psi': 0.993600044125317}
[S16] START round=36 head_norm_before_train=1.867688 cos_to_last_merge=1.0000 (last merge round=35)
[S16] round=36 local utility u=0.082676 metrics={'f1_val': 0.8716829243074683, 'auprc': 0.9896799556434397, 'loss_val': 0.6038071624713565, 'psi': 0.9188817368418569}-{'f1_val': 0.8581796826332654, 'auprc': 0.9915047981066374, 'loss_val': 0.6936141496861055, 'psi': 0.9115097288226142}
[S17] START round=36 head_norm_before_train=1.393441 cos_to_last_merge=0.9945 (last merge round=33)
[S17] round=36 local utility u=0.000000 metrics={'f1_val': 0.5394736985035498, 'auprc': 0.7388253595906761, 'loss_val': 1.3104635277071208, 'psi': 0.6192143629384004}-{'f1_val': 0.6526108435963597, 'auprc': 0.9994670478347647, 'loss_val': 0.6419622983097897, 'psi': 0.7913533252917218}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:59804
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:59812
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1794 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=36 metric=0.5395 head_norm=1.451074
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.815783e-01
[S17] stored merged vector for next round verification (round=36)
[S17] DEBUG after merge:  round=36 metric=0.5426 head_norm=1.316988 delta_norm=0.381578
[S17] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:59808
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] RECEIVED delta(kind=head bytes=1800) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.880745)
[S4] loaded HEAD from S16 (vec_in norm=1.880745)
[S4] cosine check vs S16: cos=0.9997
[S4] BUFFERED delta from S16 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1794) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.439199)
[S11] loaded HEAD from S14 (vec_in norm=1.439199)
[S11] cosine check vs S14: cos=0.9949
[S11] BUFFERED delta from S14 (total buffered=1)
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1803) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.194167)
[S7] loaded HEAD from S6 (vec_in norm=1.194167)
[S7] cosine check vs S6: cos=0.9021
[S7] BUFFERED delta from S6 (total buffered=1)
[S2] START round=37 head_norm_before_train=2.073577 cos_to_last_merge=0.9998 (last merge round=34)
[S2] round=37 local utility u=0.890866 metrics={'f1_val': 0.8269106311295942, 'auprc': 0.9896817026655395, 'loss_val': 0.3554222501209956, 'psi': 0.8920190597439723}-{'f1_val': 0.6894423130318318, 'auprc': 0.7427620248470721, 'loss_val': 0.5715855774582824, 'psi': 0.7107701977579279}
[S3] START round=37 head_norm_before_train=2.063814 cos_to_last_merge=0.9999 (last merge round=34)
[S3] round=37 local utility u=0.153815 metrics={'f1_val': 0.9978100342676263, 'auprc': 0.9993996097413177, 'loss_val': 0.0209072964791434, 'psi': 0.9984458644571028}-{'f1_val': 0.9610750853994537, 'auprc': 0.9988433308943588, 'loss_val': 0.10645892081018213, 'psi': 0.9761823835974158}
[S4] START round=37 head_norm_before_train=1.894459 cos_to_last_merge=0.9999 (last merge round=35)
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.7130274622214839, 'auprc': 0.9168525509180843, 'loss_val': 0.5528526386082584, 'psi': 0.7945574977001241}-{'f1_val': 0.9390732908208931, 'auprc': 0.9572737682556647, 'loss_val': 0.30060693878406314, 'psi': 0.9463534817948017}
[S5] START round=37 head_norm_before_train=1.317890 cos_to_last_merge=0.9998 (last merge round=35)
[S5] round=37 local utility u=0.382727 metrics={'f1_val': 0.7000725525005456, 'auprc': 0.9964938584508317, 'loss_val': 0.26093596948776293, 'psi': 0.8186410748806601}-{'f1_val': 0.7143712450552575, 'auprc': 0.7938136051693331, 'loss_val': 0.5041408926380536, 'psi': 0.7461481891008878}
[S6] START round=37 head_norm_before_train=1.194167 cos_to_last_merge=0.9992 (last merge round=35)
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.7882206482812582, 'auprc': 0.9468402623206389, 'loss_val': 0.5225016081790707, 'psi': 0.8516684938970105}-{'f1_val': 0.8501518503868629, 'auprc': 0.9138921113871963, 'loss_val': 0.5557275213027187, 'psi': 0.8756479547869962}
[S7] START round=37 head_norm_before_train=1.217745 cos_to_last_merge=0.9966 (last merge round=29)
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.6174286880500709, 'auprc': 0.7963466675964732, 'loss_val': 0.6042476922035318, 'psi': 0.6889958798686318}-{'f1_val': 0.6487235703860017, 'auprc': 0.8064858289985951, 'loss_val': 0.49873596938161163, 'psi': 0.7118284738310391}
[S8] START round=37 head_norm_before_train=2.164274 (no previous merge yet)
[S8] round=37 local utility u=0.000000 metrics={'f1_val': 0.889643709508185, 'auprc': 0.9991824158659037, 'loss_val': 0.2355894474222846, 'psi': 0.9334591920512725}-{'f1_val': 0.987260455059864, 'auprc': 0.9992671668462522, 'loss_val': 0.04122994940963068, 'psi': 0.9920631397744193}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=37 head_norm_before_train=1.572440 cos_to_last_merge=0.9757 (last merge round=28)
[S9] round=37 local utility u=0.007313 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9940234795971737, 'loss_val': 0.0426725305535959, 'psi': 0.9956248865977269}-{'f1_val': 0.9933838446360591, 'auprc': 0.9983830472063132, 'loss_val': 0.05052519730477866, 'psi': 0.9953835256641608}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=37 head_norm_before_train=2.217858 (no previous merge yet)
[S10] round=37 local utility u=0.000000 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.993106382430281, 'loss_val': 0.032076802377130155, 'psi': 0.9933021778646559}-{'f1_val': 0.9935679896985945, 'auprc': 0.9933381114792055, 'loss_val': 0.03291189721625911, 'psi': 0.9934760384108389}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=37 head_norm_before_train=1.468801 cos_to_last_merge=0.9827 (last merge round=27)
[S11] round=37 local utility u=0.004244 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9968535477211995, 'loss_val': 0.04835543345346033, 'psi': 0.9966696217966335}-{'f1_val': 0.9961336749133093, 'auprc': 0.9956359755853257, 'loss_val': 0.05071030004505391, 'psi': 0.9959345951821159}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=37 metric=0.9965 head_norm=1.491439
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.248071e-02
[S11] stored merged vector for next round verification (round=37)
[S11] DEBUG after merge:  round=37 metric=0.9965 head_norm=1.463229 delta_norm=0.082481
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S13] START round=37 head_norm_before_train=1.950373 (no previous merge yet)
[S13] round=37 local utility u=0.003176 metrics={'f1_val': 0.656259725083415, 'auprc': 0.7819679476818402, 'loss_val': 0.7527855257839973, 'psi': 0.7065430141227851}-{'f1_val': 0.6535875222205147, 'auprc': 0.7759273157186635, 'loss_val': 0.7249817544737314, 'psi': 0.7025234396197743}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] sending update (kind=head size=1793 to 1 peers)
[S14] START round=37 head_norm_before_train=1.439199 cos_to_last_merge=0.9999 (last merge round=35)
[S14] round=37 local utility u=0.002401 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9989010892933295, 'loss_val': 0.04723926363102463, 'psi': 0.997512774683782}-{'f1_val': 0.9965872316107504, 'auprc': 0.9988558653537659, 'loss_val': 0.05190617642775003, 'psi': 0.9974946851079566}
[S15] START round=37 head_norm_before_train=1.370272 cos_to_last_merge=0.9979 (last merge round=35)
[S15] round=37 local utility u=0.175852 metrics={'f1_val': 0.8776511180994477, 'auprc': 0.9920261361154761, 'loss_val': 0.27701147668400833, 'psi': 0.923401125305859}-{'f1_val': 0.8251868556861368, 'auprc': 0.9921172712190596, 'loss_val': 0.31420240975600183, 'psi': 0.8919590218993059}
[S16] START round=37 head_norm_before_train=1.880745 cos_to_last_merge=1.0000 (last merge round=35)
[S16] round=37 local utility u=0.476895 metrics={'f1_val': 0.9481531443319953, 'auprc': 0.9959086389630777, 'loss_val': 0.12752461423436398, 'psi': 0.9672553421844282}-{'f1_val': 0.8716829243074683, 'auprc': 0.9896799556434397, 'loss_val': 0.6038071624713565, 'psi': 0.9188817368418569}
[S17] START round=37 head_norm_before_train=1.316988 cos_to_last_merge=1.0000 (last merge round=36)
[S17] round=37 local utility u=0.916174 metrics={'f1_val': 0.6313713734923041, 'auprc': 0.9750041202797508, 'loss_val': 0.7380378457598878, 'psi': 0.7688244722072828}-{'f1_val': 0.5394736985035498, 'auprc': 0.7388253595906761, 'loss_val': 1.3104635277071208, 'psi': 0.6192143629384004}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:59812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:59814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:59805
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:59802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:59804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:59803
[S16] sending update (kind=head size=1795 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:59817
[S17] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=37 metric=0.7130 head_norm=1.910743
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.006372e-02
[S4] stored merged vector for next round verification (round=37)
[S4] DEBUG after merge:  round=37 metric=0.7130 head_norm=1.895380 delta_norm=0.040064
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S15] sending update (kind=head size=1798 to 1 peers)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=37 metric=0.6174 head_norm=1.236712
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.722537e-01
[S7] stored merged vector for next round verification (round=37)
[S7] DEBUG after merge:  round=37 metric=0.6186 head_norm=1.184746 delta_norm=0.272254
[S7] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S14] sending update (kind=head size=1797 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1795) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.896275)
[S4] loaded HEAD from S16 (vec_in norm=1.896275)
[S4] cosine check vs S16: cos=0.9997
[S4] BUFFERED delta from S16 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1797) from S3
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=2.077010)
[S2] loaded HEAD from S3 (vec_in norm=2.077010)
[S2] cosine check vs S3: cos=0.9994
[S2] BUFFERED delta from S3 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1795) from S17
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.377119)
[S5] loaded HEAD from S17 (vec_in norm=1.377119)
[S5] cosine check vs S17: cos=0.9577
[S5] BUFFERED delta from S17 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1797) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.459381)
[S11] loaded HEAD from S14 (vec_in norm=1.459381)
[S11] cosine check vs S14: cos=0.9980
[S11] BUFFERED delta from S14 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1798) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.431248)
[S14] loaded HEAD from S15 (vec_in norm=1.431248)
[S14] cosine check vs S15: cos=0.9552
[S14] BUFFERED delta from S15 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1801) from S2
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=2.083326)
[S3] loaded HEAD from S2 (vec_in norm=2.083326)
[S3] cosine check vs S2: cos=0.9994
[S3] BUFFERED delta from S2 (total buffered=1)
[S5] sending update (kind=head size=1798 to 1 peers)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=37 metric=0.8269 head_norm=2.083326
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.736064e-02
[S2] stored merged vector for next round verification (round=37)
[S2] DEBUG after merge:  round=37 metric=0.8269 head_norm=2.079835 delta_norm=0.037361
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=37 metric=0.9966 head_norm=1.459381
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.166505e-01
[S14] stored merged vector for next round verification (round=37)
[S14] DEBUG after merge:  round=37 metric=0.9966 head_norm=1.429054 delta_norm=0.216650
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=37 metric=0.9978 head_norm=2.077010
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.736063e-02
[S3] stored merged vector for next round verification (round=37)
[S3] DEBUG after merge:  round=37 metric=0.9978 head_norm=2.079835 delta_norm=0.037361
[S3] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S17] RECEIVED delta(kind=head bytes=1798) from S5
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.333324)
[S17] loaded HEAD from S5 (vec_in norm=1.333324)
[S17] cosine check vs S5: cos=0.9577
[S17] BUFFERED delta from S5 (total buffered=1)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=37 metric=0.7001 head_norm=1.333324
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.982832e-01
[S5] stored merged vector for next round verification (round=37)
[S5] DEBUG after merge:  round=37 metric=0.7001 head_norm=1.340816 delta_norm=0.198283
[S5] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=38 head_norm_before_train=2.079835 cos_to_last_merge=1.0000 (last merge round=37)
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.8247958671081974, 'auprc': 0.8785167196850033, 'loss_val': 0.43952589856595176, 'psi': 0.8462842081389198}-{'f1_val': 0.8269106311295942, 'auprc': 0.9896817026655395, 'loss_val': 0.3554222501209956, 'psi': 0.8920190597439723}
[S3] START round=38 head_norm_before_train=2.079835 cos_to_last_merge=1.0000 (last merge round=37)
[S3] round=38 local utility u=0.000000 metrics={'f1_val': 0.961498813606586, 'auprc': 0.9990430581413167, 'loss_val': 0.07334509552649075, 'psi': 0.9765165114204782}-{'f1_val': 0.9978100342676263, 'auprc': 0.9993996097413177, 'loss_val': 0.0209072964791434, 'psi': 0.9984458644571028}
[S4] START round=38 head_norm_before_train=1.895380 cos_to_last_merge=1.0000 (last merge round=37)
[S4] round=38 local utility u=0.857366 metrics={'f1_val': 0.9384343831725761, 'auprc': 0.9546360974372764, 'loss_val': 0.3039128899118331, 'psi': 0.9449150688784562}-{'f1_val': 0.7130274622214839, 'auprc': 0.9168525509180843, 'loss_val': 0.5528526386082584, 'psi': 0.7945574977001241}
[S5] START round=38 head_norm_before_train=1.340816 cos_to_last_merge=1.0000 (last merge round=37)
[S5] round=38 local utility u=0.000000 metrics={'f1_val': 0.7143712450552575, 'auprc': 0.9248971848655368, 'loss_val': 0.36804122501654324, 'psi': 0.7985816209793692}-{'f1_val': 0.7000725525005456, 'auprc': 0.9964938584508317, 'loss_val': 0.26093596948776293, 'psi': 0.8186410748806601}
[S6] START round=38 head_norm_before_train=1.226757 cos_to_last_merge=0.9978 (last merge round=35)
[S6] round=38 local utility u=0.201333 metrics={'f1_val': 0.8580566439850272, 'auprc': 0.9403230250199903, 'loss_val': 0.519299860779328, 'psi': 0.8909631963990124}-{'f1_val': 0.7882206482812582, 'auprc': 0.9468402623206389, 'loss_val': 0.5225016081790707, 'psi': 0.8516684938970105}
[S7] START round=38 head_norm_before_train=1.184746 cos_to_last_merge=1.0000 (last merge round=37)
[S7] round=38 local utility u=0.000000 metrics={'f1_val': 0.5400203303574059, 'auprc': 0.7844465175563491, 'loss_val': 0.7781308639727458, 'psi': 0.6377908052369832}-{'f1_val': 0.6174286880500709, 'auprc': 0.7963466675964732, 'loss_val': 0.6042476922035318, 'psi': 0.6889958798686318}
[S8] START round=38 head_norm_before_train=2.174609 (no previous merge yet)
[S8] round=38 local utility u=0.396377 metrics={'f1_val': 0.9927806433552421, 'auprc': 0.9906477385814343, 'loss_val': 0.036053055900657084, 'psi': 0.991927481445719}-{'f1_val': 0.889643709508185, 'auprc': 0.9991824158659037, 'loss_val': 0.2355894474222846, 'psi': 0.9334591920512725}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[S9] START round=38 head_norm_before_train=1.585868 cos_to_last_merge=0.9741 (last merge round=28)
[S9] round=38 local utility u=0.005985 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9984119349100307, 'loss_val': 0.04133840750737778, 'psi': 0.9971273914022559}-{'f1_val': 0.9966924912647621, 'auprc': 0.9940234795971737, 'loss_val': 0.0426725305535959, 'psi': 0.9956248865977269}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=38 head_norm_before_train=2.224520 (no previous merge yet)
[S10] round=38 local utility u=0.000000 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9933013802682197, 'loss_val': 0.03266601241111875, 'psi': 0.9933801769998314}-{'f1_val': 0.9934327081542391, 'auprc': 0.993106382430281, 'loss_val': 0.032076802377130155, 'psi': 0.9933021778646559}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=38 head_norm_before_train=1.463229 cos_to_last_merge=1.0000 (last merge round=37)
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9959468877688843, 'loss_val': 0.04908069300314914, 'psi': 0.9963069578157074}-{'f1_val': 0.9965470045135896, 'auprc': 0.9968535477211995, 'loss_val': 0.04835543345346033, 'psi': 0.9966696217966335}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=38 metric=0.9965 head_norm=1.485758
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.283749e-02
[S11] stored merged vector for next round verification (round=38)
[S11] DEBUG after merge:  round=38 metric=0.9965 head_norm=1.471681 delta_norm=0.052837
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S13] START round=38 head_norm_before_train=1.962614 (no previous merge yet)
[S13] round=38 local utility u=0.117424 metrics={'f1_val': 0.6775697466812731, 'auprc': 0.7832777750640891, 'loss_val': 0.6497278173406993, 'psi': 0.7198529580343995}-{'f1_val': 0.656259725083415, 'auprc': 0.7819679476818402, 'loss_val': 0.7527855257839973, 'psi': 0.7065430141227851}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=38 head_norm_before_train=1.429054 cos_to_last_merge=1.0000 (last merge round=37)
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9983552878661667, 'loss_val': 0.047388476290075164, 'psi': 0.9972944541129168}-{'f1_val': 0.9965872316107504, 'auprc': 0.9989010892933295, 'loss_val': 0.04723926363102463, 'psi': 0.997512774683782}
[S15] START round=38 head_norm_before_train=1.431248 cos_to_last_merge=0.9928 (last merge round=35)
[S15] round=38 local utility u=0.475197 metrics={'f1_val': 0.9963164379542544, 'auprc': 0.997079669009055, 'loss_val': 0.05376932634088733, 'psi': 0.9966217303761746}-{'f1_val': 0.8776511180994477, 'auprc': 0.9920261361154761, 'loss_val': 0.27701147668400833, 'psi': 0.923401125305859}
[S16] START round=38 head_norm_before_train=1.896275 cos_to_last_merge=0.9999 (last merge round=35)
[S16] round=38 local utility u=0.128994 metrics={'f1_val': 0.9814007857518192, 'auprc': 0.996446192341727, 'loss_val': 0.07063497079757414, 'psi': 0.9874189483877824}-{'f1_val': 0.9481531443319953, 'auprc': 0.9959086389630777, 'loss_val': 0.12752461423436398, 'psi': 0.9672553421844282}
[S17] START round=38 head_norm_before_train=1.377119 cos_to_last_merge=0.9989 (last merge round=36)
[S17] round=38 local utility u=0.000000 metrics={'f1_val': 0.6102683797115622, 'auprc': 0.9331344745489241, 'loss_val': 0.8593843874436489, 'psi': 0.739414817646507}-{'f1_val': 0.6313713734923041, 'auprc': 0.9750041202797508, 'loss_val': 0.7380378457598878, 'psi': 0.7688244722072828}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:59814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:59804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:59816
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:59808
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=38 metric=0.6103 head_norm=1.451325
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.363782e-01
[S17] stored merged vector for next round verification (round=38)
[S17] DEBUG after merge:  round=38 metric=0.6125 head_norm=1.373380 delta_norm=0.236378
[S17] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] RECEIVED delta(kind=head bytes=1801) from S4
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.912044)
[S16] loaded HEAD from S4 (vec_in norm=1.912044)
[S16] cosine check vs S4: cos=0.9992
[S16] BUFFERED delta from S4 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1803) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.482245)
[S14] loaded HEAD from S15 (vec_in norm=1.482245)
[S14] cosine check vs S15: cos=0.9826
[S14] BUFFERED delta from S15 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1804) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.911543)
[S4] loaded HEAD from S16 (vec_in norm=1.911543)
[S4] cosine check vs S16: cos=0.9992
[S4] BUFFERED delta from S16 (total buffered=2)
[S6] sending update (kind=head size=1797 to 1 peers)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=38 metric=0.9814 head_norm=1.911543
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.717323e-02
[S16] stored merged vector for next round verification (round=38)
[S16] DEBUG after merge:  round=38 metric=0.9814 head_norm=1.911432 delta_norm=0.037173
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=38 metric=0.9384 head_norm=1.912044
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.553881e-02
[S4] stored merged vector for next round verification (round=38)
[S4] DEBUG after merge:  round=38 metric=0.9384 head_norm=1.907644 delta_norm=0.035539
[S4] aggregate: ACCEPT kept=['S16', 'S16'] (k=2/2) mode=median trim_p=0.1
[S7] RECEIVED delta(kind=head bytes=1797) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.258801)
[S7] loaded HEAD from S6 (vec_in norm=1.258801)
[S7] cosine check vs S6: cos=0.9649
[S7] BUFFERED delta from S6 (total buffered=1)
[S2] START round=39 head_norm_before_train=2.090204 cos_to_last_merge=1.0000 (last merge round=37)
[S2] round=39 local utility u=0.177811 metrics={'f1_val': 0.8331051198693153, 'auprc': 0.9365838879111887, 'loss_val': 0.3079617284268554, 'psi': 0.8744966270860647}-{'f1_val': 0.8247958671081974, 'auprc': 0.8785167196850033, 'loss_val': 0.43952589856595176, 'psi': 0.8462842081389198}
[S3] START round=39 head_norm_before_train=2.091756 cos_to_last_merge=1.0000 (last merge round=37)
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9990152631304565, 'loss_val': 0.11139932330794179, 'psi': 0.9762272559154488}-{'f1_val': 0.961498813606586, 'auprc': 0.9990430581413167, 'loss_val': 0.07334509552649075, 'psi': 0.9765165114204782}
[S4] START round=39 head_norm_before_train=1.907644 cos_to_last_merge=1.0000 (last merge round=38)
[S4] round=39 local utility u=0.012673 metrics={'f1_val': 0.94084109443967, 'auprc': 0.9551106980592159, 'loss_val': 0.2944304017038398, 'psi': 0.9465489358874883}-{'f1_val': 0.9384343831725761, 'auprc': 0.9546360974372764, 'loss_val': 0.3039128899118331, 'psi': 0.9449150688784562}
[S5] START round=39 head_norm_before_train=1.356659 cos_to_last_merge=0.9999 (last merge round=37)
[S5] round=39 local utility u=1.000000 metrics={'f1_val': 0.9960398919057053, 'auprc': 0.9965378623421383, 'loss_val': 0.17281417935114993, 'psi': 0.9962390800802785}-{'f1_val': 0.7143712450552575, 'auprc': 0.9248971848655368, 'loss_val': 0.36804122501654324, 'psi': 0.7985816209793692}
[S6] START round=39 head_norm_before_train=1.258801 cos_to_last_merge=0.9960 (last merge round=35)
[S6] round=39 local utility u=0.000000 metrics={'f1_val': 0.7564502636413476, 'auprc': 0.9527916777464387, 'loss_val': 0.6114479039871159, 'psi': 0.834986829283384}-{'f1_val': 0.8580566439850272, 'auprc': 0.9403230250199903, 'loss_val': 0.519299860779328, 'psi': 0.8909631963990124}
[S7] START round=39 head_norm_before_train=1.206698 cos_to_last_merge=0.9997 (last merge round=37)
[S7] round=39 local utility u=0.120648 metrics={'f1_val': 0.5756001451487289, 'auprc': 0.7873489473087529, 'loss_val': 0.7590215287401734, 'psi': 0.6602996660127385}-{'f1_val': 0.5400203303574059, 'auprc': 0.7844465175563491, 'loss_val': 0.7781308639727458, 'psi': 0.6377908052369832}
[S8] START round=39 head_norm_before_train=2.180341 (no previous merge yet)
[S8] round=39 local utility u=0.000000 metrics={'f1_val': 0.9747315309751892, 'auprc': 0.9960668429226032, 'loss_val': 0.06598348481698645, 'psi': 0.9832656557541548}-{'f1_val': 0.9927806433552421, 'auprc': 0.9906477385814343, 'loss_val': 0.036053055900657084, 'psi': 0.991927481445719}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=40 psi=0.983 u=0.0000 p_local=0.0684 f1=0.975 auprc=0.996 bytes=34225
[S9] START round=39 head_norm_before_train=1.598479 cos_to_last_merge=0.9726 (last merge round=28)
[S9] round=39 local utility u=0.002243 metrics={'f1_val': 0.9964678035083712, 'auprc': 0.9986761096472412, 'loss_val': 0.03882582121450714, 'psi': 0.9973511259639192}-{'f1_val': 0.9962710290637395, 'auprc': 0.9984119349100307, 'loss_val': 0.04133840750737778, 'psi': 0.9971273914022559}
[S9] not sending this round → trigger blocked (psi=0.997)
[S9] r=40 psi=0.997 u=0.0022 p_local=0.0110 f1=0.996 auprc=0.999 bytes=46709
[S10] START round=39 head_norm_before_train=2.228079 (no previous merge yet)
[S10] round=39 local utility u=0.000000 metrics={'f1_val': 0.993871046050545, 'auprc': 0.9917954756716597, 'loss_val': 0.031088363452571342, 'psi': 0.9930408178989909}-{'f1_val': 0.9934327081542391, 'auprc': 0.9933013802682197, 'loss_val': 0.03266601241111875, 'psi': 0.9933801769998314}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=40 psi=0.993 u=0.0000 p_local=0.0008 f1=0.994 auprc=0.992 bytes=34196
[S11] START round=39 head_norm_before_train=1.471681 cos_to_last_merge=1.0000 (last merge round=38)
[S11] round=39 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9938267071023446, 'loss_val': 0.048979263701700866, 'psi': 0.9952108877889234}-{'f1_val': 0.9965470045135896, 'auprc': 0.9959468877688843, 'loss_val': 0.04908069300314914, 'psi': 0.9963069578157074}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=40 psi=0.995 u=0.0000 p_local=0.0064 f1=0.996 auprc=0.994 bytes=37689
[S13] START round=39 head_norm_before_train=1.970078 (no previous merge yet)
[S13] round=39 local utility u=0.000000 metrics={'f1_val': 0.6836260487755859, 'auprc': 0.7453330474790564, 'loss_val': 1.0147360869679807, 'psi': 0.708308848256974}-{'f1_val': 0.6775697466812731, 'auprc': 0.7832777750640891, 'loss_val': 0.6497278173406993, 'psi': 0.7198529580343995}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=40 psi=0.708 u=0.0000 p_local=0.0691 f1=0.684 auprc=0.745 bytes=34138
[S14] START round=39 head_norm_before_train=1.446813 cos_to_last_merge=0.9999 (last merge round=37)
[S14] round=39 local utility u=0.001427 metrics={'f1_val': 0.9965603779504312, 'auprc': 0.9990425255772506, 'loss_val': 0.046434519030660384, 'psi': 0.9975532370011589}-{'f1_val': 0.9965872316107504, 'auprc': 0.9983552878661667, 'loss_val': 0.047388476290075164, 'psi': 0.9972944541129168}
[S15] START round=39 head_norm_before_train=1.482245 cos_to_last_merge=0.9876 (last merge round=35)
[S15] round=39 local utility u=0.000000 metrics={'f1_val': 0.992570146973819, 'auprc': 0.9888194157037258, 'loss_val': 0.058992941786724505, 'psi': 0.9910698544657817}-{'f1_val': 0.9963164379542544, 'auprc': 0.997079669009055, 'loss_val': 0.05376932634088733, 'psi': 0.9966217303761746}
[S16] START round=39 head_norm_before_train=1.911432 cos_to_last_merge=1.0000 (last merge round=38)
[S16] round=39 local utility u=0.000000 metrics={'f1_val': 0.9383186233101835, 'auprc': 0.9918766633829623, 'loss_val': 0.2981622276910085, 'psi': 0.959741839339295}-{'f1_val': 0.9814007857518192, 'auprc': 0.996446192341727, 'loss_val': 0.07063497079757414, 'psi': 0.9874189483877824}
[S17] START round=39 head_norm_before_train=1.373380 cos_to_last_merge=1.0000 (last merge round=38)
[S17] round=39 local utility u=0.000000 metrics={'f1_val': 0.6077543138515555, 'auprc': 0.8323791601313877, 'loss_val': 1.0193213743926812, 'psi': 0.6976042523634884}-{'f1_val': 0.6102683797115622, 'auprc': 0.9331344745489241, 'loss_val': 0.8593843874436489, 'psi': 0.739414817646507}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] → sending delta(kind=head bytes=1793) to S11@127.0.0.1:59812
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.947)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:59803
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:59807
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S16] r=40 psi=0.960 u=0.0000 p_local=0.1214 f1=0.938 auprc=0.992 bytes=39561
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:59817
[S3] r=40 psi=0.976 u=0.0000 p_local=0.0435 f1=0.961 auprc=0.999 bytes=35992
[S14] sending update (kind=head size=1793 to 1 peers)
[S4] r=40 psi=0.947 u=0.0127 p_local=0.1460 f1=0.941 auprc=0.955 bytes=32413
[S17] r=40 psi=0.698 u=0.0000 p_local=0.2353 f1=0.608 auprc=0.832 bytes=35983
[S15] r=40 psi=0.991 u=0.0000 p_local=0.1911 f1=0.993 auprc=0.989 bytes=30586
[S11] RECEIVED delta(kind=head bytes=1793) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.464466)
[S11] loaded HEAD from S14 (vec_in norm=1.464466)
[S11] cosine check vs S14: cos=0.9864
[S11] BUFFERED delta from S14 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1795) from S2
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=2.102683)
[S3] loaded HEAD from S2 (vec_in norm=2.102683)
[S3] cosine check vs S2: cos=0.9999
[S3] BUFFERED delta from S2 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1800) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.232728)
[S6] loaded HEAD from S7 (vec_in norm=1.232728)
[S6] cosine check vs S7: cos=0.9585
[S6] BUFFERED delta from S7 (total buffered=1)
[S5] sending update (kind=head size=1792 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=39 metric=0.9966 head_norm=1.464466
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.392360e-01
[S14] stored merged vector for next round verification (round=39)
[S14] DEBUG after merge:  round=39 metric=0.9966 head_norm=1.466789 delta_norm=0.139236
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S14] r=40 psi=0.998 u=0.0014 p_local=0.0101 f1=0.997 auprc=0.999 bytes=41306
[S2] r=40 psi=0.874 u=0.1778 p_local=0.1658 f1=0.833 auprc=0.937 bytes=32364
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=39 metric=0.5756 head_norm=1.232728
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.735362e-01
[S7] stored merged vector for next round verification (round=39)
[S7] DEBUG after merge:  round=39 metric=0.5725 head_norm=1.233688 delta_norm=0.173536
[S7] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S7] r=40 psi=0.660 u=0.1206 p_local=0.1447 f1=0.576 auprc=0.787 bytes=32376
[S17] RECEIVED delta(kind=head bytes=1792) from S5
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.370293)
[S17] loaded HEAD from S5 (vec_in norm=1.370293)
[S17] cosine check vs S5: cos=0.9970
[S17] BUFFERED delta from S5 (total buffered=1)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=39 metric=0.7565 head_norm=1.284544
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.832110e-01
[S6] stored merged vector for next round verification (round=39)
[S6] DEBUG after merge:  round=39 metric=0.7605 head_norm=1.245500 delta_norm=0.183211
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S6] r=40 psi=0.835 u=0.0000 p_local=0.1633 f1=0.756 auprc=0.953 bytes=34203
[S5] r=40 psi=0.996 u=1.0000 p_local=0.3193 f1=0.996 auprc=0.997 bytes=35927
[S2] START round=40 head_norm_before_train=2.102683 cos_to_last_merge=0.9999 (last merge round=37)
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.7227345618661349, 'auprc': 0.8887193014834456, 'loss_val': 0.599790920738213, 'psi': 0.7891284577130592}-{'f1_val': 0.8331051198693153, 'auprc': 0.9365838879111887, 'loss_val': 0.3079617284268554, 'psi': 0.8744966270860647}
[S3] START round=40 head_norm_before_train=2.102936 cos_to_last_merge=0.9999 (last merge round=37)
[S3] round=40 local utility u=0.120787 metrics={'f1_val': 0.9877274083160191, 'auprc': 0.9989156098546572, 'loss_val': 0.029679922411014623, 'psi': 0.9922026889314743}-{'f1_val': 0.9610352511054436, 'auprc': 0.9990152631304565, 'loss_val': 0.11139932330794179, 'psi': 0.9762272559154488}
[S4] START round=40 head_norm_before_train=1.927617 cos_to_last_merge=0.9999 (last merge round=38)
[S4] round=40 local utility u=0.000000 metrics={'f1_val': 0.937777598338748, 'auprc': 0.9510515068339491, 'loss_val': 0.3105807105776453, 'psi': 0.9430871617368285}-{'f1_val': 0.94084109443967, 'auprc': 0.9551106980592159, 'loss_val': 0.2944304017038398, 'psi': 0.9465489358874883}
[S5] START round=40 head_norm_before_train=1.370293 cos_to_last_merge=0.9996 (last merge round=37)
[S5] round=40 local utility u=0.000000 metrics={'f1_val': 0.7301466990358718, 'auprc': 0.9906717740837415, 'loss_val': 0.2348562934558051, 'psi': 0.8343567290550198}-{'f1_val': 0.9960398919057053, 'auprc': 0.9965378623421383, 'loss_val': 0.17281417935114993, 'psi': 0.9962390800802785}
[S6] START round=40 head_norm_before_train=1.245500 cos_to_last_merge=1.0000 (last merge round=39)
[S6] round=40 local utility u=0.154595 metrics={'f1_val': 0.790656443051033, 'auprc': 0.9530366557621374, 'loss_val': 0.5082295323111907, 'psi': 0.8556085281354747}-{'f1_val': 0.7564502636413476, 'auprc': 0.9527916777464387, 'loss_val': 0.6114479039871159, 'psi': 0.834986829283384}
[S7] START round=40 head_norm_before_train=1.233688 cos_to_last_merge=1.0000 (last merge round=39)
[S7] round=40 local utility u=0.045894 metrics={'f1_val': 0.5878999075153781, 'auprc': 0.7905835066563509, 'loss_val': 0.7507349218893866, 'psi': 0.6689733471717673}-{'f1_val': 0.5756001451487289, 'auprc': 0.7873489473087529, 'loss_val': 0.7590215287401734, 'psi': 0.6602996660127385}
[S8] START round=40 head_norm_before_train=2.185220 (no previous merge yet)
[S8] round=40 local utility u=0.068193 metrics={'f1_val': 0.9901099825334893, 'auprc': 0.9992611328962655, 'loss_val': 0.03145190014603525, 'psi': 0.9937704426785997}-{'f1_val': 0.9747315309751892, 'auprc': 0.9960668429226032, 'loss_val': 0.06598348481698645, 'psi': 0.9832656557541548}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=40 head_norm_before_train=1.609308 cos_to_last_merge=0.9716 (last merge round=28)
[S9] round=40 local utility u=0.000706 metrics={'f1_val': 0.9968814284133827, 'auprc': 0.997604403581744, 'loss_val': 0.036681170445463686, 'psi': 0.9971706184807272}-{'f1_val': 0.9964678035083712, 'auprc': 0.9986761096472412, 'loss_val': 0.03882582121450714, 'psi': 0.9973511259639192}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] sending update (kind=head size=1804 to 1 peers)
[S10] START round=40 head_norm_before_train=2.233683 (no previous merge yet)
[S10] round=40 local utility u=0.000917 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9937145443821417, 'loss_val': 0.032381480379922986, 'psi': 0.9935454426454002}-{'f1_val': 0.993871046050545, 'auprc': 0.9917954756716597, 'loss_val': 0.031088363452571342, 'psi': 0.9930408178989909}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=40 head_norm_before_train=1.491965 cos_to_last_merge=1.0000 (last merge round=38)
[S11] round=40 local utility u=0.000000 metrics={'f1_val': 0.8397185561337105, 'auprc': 0.9948158848054534, 'loss_val': 0.20438608872137987, 'psi': 0.9017574876024076}-{'f1_val': 0.9961336749133093, 'auprc': 0.9938267071023446, 'loss_val': 0.048979263701700866, 'psi': 0.9952108877889234}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=40 metric=0.8397 head_norm=1.512388
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.276719e-01
[S11] stored merged vector for next round verification (round=40)
[S11] DEBUG after merge:  round=40 metric=0.8380 head_norm=1.483135 delta_norm=0.127672
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S13] START round=40 head_norm_before_train=1.977066 (no previous merge yet)
[S13] round=40 local utility u=0.000000 metrics={'f1_val': 0.6250733487214265, 'auprc': 0.7819869852314564, 'loss_val': 0.9029368547177651, 'psi': 0.6878388033254386}-{'f1_val': 0.6836260487755859, 'auprc': 0.7453330474790564, 'loss_val': 1.0147360869679807, 'psi': 0.708308848256974}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=40 head_norm_before_train=1.466789 cos_to_last_merge=1.0000 (last merge round=39)
[S14] round=40 local utility u=0.002093 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9984487644431977, 'loss_val': 0.045553855463900984, 'psi': 0.9978244674783144}-{'f1_val': 0.9965603779504312, 'auprc': 0.9990425255772506, 'loss_val': 0.046434519030660384, 'psi': 0.9975532370011589}
[S15] START round=40 head_norm_before_train=1.520606 cos_to_last_merge=0.9834 (last merge round=35)
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.774573221818794, 'auprc': 0.9388848303918287, 'loss_val': 0.4276162428369643, 'psi': 0.8402978652480079}-{'f1_val': 0.992570146973819, 'auprc': 0.9888194157037258, 'loss_val': 0.058992941786724505, 'psi': 0.9910698544657817}
[S16] START round=40 head_norm_before_train=1.925736 cos_to_last_merge=1.0000 (last merge round=38)
[S16] round=40 local utility u=0.000000 metrics={'f1_val': 0.9368579165516175, 'auprc': 0.9917593508220147, 'loss_val': 0.31796714557588635, 'psi': 0.9588184902597765}-{'f1_val': 0.9383186233101835, 'auprc': 0.9918766633829623, 'loss_val': 0.2981622276910085, 'psi': 0.959741839339295}
[S17] START round=40 head_norm_before_train=1.439905 cos_to_last_merge=0.9987 (last merge round=38)
[S17] round=40 local utility u=0.567696 metrics={'f1_val': 0.6614923524707153, 'auprc': 0.981068549536619, 'loss_val': 0.6524266208649068, 'psi': 0.7893228312970768}-{'f1_val': 0.6077543138515555, 'auprc': 0.8323791601313877, 'loss_val': 1.0193213743926812, 'psi': 0.6976042523634884}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:59802
[S14] not sending this round → trigger blocked (psi=0.998)
[S7] not sending this round → trigger blocked (psi=0.669)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:59805
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] ⇄ pheromone p=0.133 → S3@127.0.0.1:59803
[S16] ⇄ pheromone p=0.097 → S4@127.0.0.1:59804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:59808
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] ⇄ pheromone p=0.117 → S16@127.0.0.1:59816
[S7] ⇄ pheromone p=0.125 → S6@127.0.0.1:59807
[S3] sending update (kind=head size=1795 to 1 peers)
[S14] ⇄ pheromone p=0.009 → S11@127.0.0.1:59812
[S15] ⇄ pheromone p=0.153 → S14@127.0.0.1:59814
[S2] RECEIVED delta(kind=head bytes=1795) from S3
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=2.114359)
[S2] loaded HEAD from S3 (vec_in norm=2.114359)
[S2] cosine check vs S3: cos=0.9997
[S2] BUFFERED delta from S3 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1801) from S17
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.513264)
[S5] loaded HEAD from S17 (vec_in norm=1.513264)
[S5] cosine check vs S17: cos=0.9922
[S5] BUFFERED delta from S17 (total buffered=1)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=40 metric=0.9877 head_norm=2.114359
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.249064e-02
[S3] stored merged vector for next round verification (round=40)
[S3] DEBUG after merge:  round=40 metric=0.9877 head_norm=2.108409 delta_norm=0.022491
[S3] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.059 → S2@127.0.0.1:59802
[S6] sending update (kind=head size=1801 to 1 peers)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=40 metric=0.6615 head_norm=1.513264
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.146088e-01
[S17] stored merged vector for next round verification (round=40)
[S17] DEBUG after merge:  round=40 metric=0.6644 head_norm=1.438993 delta_norm=0.114609
[S17] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.302 → S5@127.0.0.1:59805
[S7] RECEIVED delta(kind=head bytes=1801) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.280576)
[S7] loaded HEAD from S6 (vec_in norm=1.280576)
[S7] cosine check vs S6: cos=0.9984
[S7] BUFFERED delta from S6 (total buffered=1)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=40 metric=0.7301 head_norm=1.385784
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.107155e-01
[S5] stored merged vector for next round verification (round=40)
[S5] DEBUG after merge:  round=40 metric=0.7301 head_norm=1.446694 delta_norm=0.110716
[S5] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.255 → S17@127.0.0.1:59817
[S6] ⇄ pheromone p=0.162 → S15@127.0.0.1:59815
[S2] START round=41 head_norm_before_train=2.116714 cos_to_last_merge=0.9998 (last merge round=37)
[S2] round=41 local utility u=0.627037 metrics={'f1_val': 0.8302453265638923, 'auprc': 0.993412265690344, 'loss_val': 0.3048602171774669, 'psi': 0.895512102214473}-{'f1_val': 0.7227345618661349, 'auprc': 0.8887193014834456, 'loss_val': 0.599790920738213, 'psi': 0.7891284577130592}
[S3] START round=41 head_norm_before_train=2.108409 cos_to_last_merge=1.0000 (last merge round=40)
[S3] round=41 local utility u=0.000000 metrics={'f1_val': 0.9715229121240536, 'auprc': 0.9989969416465865, 'loss_val': 0.058634287849126596, 'psi': 0.9825125239330668}-{'f1_val': 0.9877274083160191, 'auprc': 0.9989156098546572, 'loss_val': 0.029679922411014623, 'psi': 0.9922026889314743}
[S4] START round=41 head_norm_before_train=1.941849 cos_to_last_merge=0.9996 (last merge round=38)
[S4] round=41 local utility u=0.027581 metrics={'f1_val': 0.9416016286399517, 'auprc': 0.9573407182020951, 'loss_val': 0.2972308228004634, 'psi': 0.947897264464809}-{'f1_val': 0.937777598338748, 'auprc': 0.9510515068339491, 'loss_val': 0.3105807105776453, 'psi': 0.9430871617368285}
[S5] START round=41 head_norm_before_train=1.446694 cos_to_last_merge=1.0000 (last merge round=40)
[S5] round=41 local utility u=0.840921 metrics={'f1_val': 0.9945615134312132, 'auprc': 0.9932761891515485, 'loss_val': 0.14731660902527183, 'psi': 0.9940473837193473}-{'f1_val': 0.7301466990358718, 'auprc': 0.9906717740837415, 'loss_val': 0.2348562934558051, 'psi': 0.8343567290550198}
[S6] START round=41 head_norm_before_train=1.280576 cos_to_last_merge=0.9995 (last merge round=39)
[S6] round=41 local utility u=0.287412 metrics={'f1_val': 0.8671996314902679, 'auprc': 0.9634246177934217, 'loss_val': 0.42382896053796887, 'psi': 0.9056896260115295}-{'f1_val': 0.790656443051033, 'auprc': 0.9530366557621374, 'loss_val': 0.5082295323111907, 'psi': 0.8556085281354747}
[S7] START round=41 head_norm_before_train=1.261269 cos_to_last_merge=0.9996 (last merge round=39)
[S7] round=41 local utility u=0.159385 metrics={'f1_val': 0.6233695393761078, 'auprc': 0.7957427917374413, 'loss_val': 0.660260946795686, 'psi': 0.6923188403206413}-{'f1_val': 0.5878999075153781, 'auprc': 0.7905835066563509, 'loss_val': 0.7507349218893866, 'psi': 0.6689733471717673}
[S8] START round=41 head_norm_before_train=2.185972 (no previous merge yet)
[S8] round=41 local utility u=0.000000 metrics={'f1_val': 0.8581932327299797, 'auprc': 0.995654430660133, 'loss_val': 0.2494160720493339, 'psi': 0.913177711902041}-{'f1_val': 0.9901099825334893, 'auprc': 0.9992611328962655, 'loss_val': 0.03145190014603525, 'psi': 0.9937704426785997}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=41 head_norm_before_train=1.620475 cos_to_last_merge=0.9705 (last merge round=28)
[S9] round=41 local utility u=0.000525 metrics={'f1_val': 0.9968814284133827, 'auprc': 0.9973846793779505, 'loss_val': 0.034971525655500865, 'psi': 0.9970827287992098}-{'f1_val': 0.9968814284133827, 'auprc': 0.997604403581744, 'loss_val': 0.036681170445463686, 'psi': 0.9971706184807272}
[S9] not sending this round → trigger blocked (psi=0.997)
[S10] START round=41 head_norm_before_train=2.236622 (no previous merge yet)
[S10] round=41 local utility u=0.000052 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9936836470042342, 'loss_val': 0.032184808736630634, 'psi': 0.9935330836942372}-{'f1_val': 0.9934327081542391, 'auprc': 0.9937145443821417, 'loss_val': 0.032381480379922986, 'psi': 0.9935454426454002}
[S10] not sending this round → trigger blocked (psi=0.994)
[S11] START round=41 head_norm_before_train=1.483135 cos_to_last_merge=1.0000 (last merge round=40)
[S11] round=41 local utility u=0.547938 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9948893296429948, 'loss_val': 0.0472214947700834, 'psi': 0.9956359368051835}-{'f1_val': 0.8397185561337105, 'auprc': 0.9948158848054534, 'loss_val': 0.20438608872137987, 'psi': 0.9017574876024076}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=41 head_norm_before_train=1.987002 (no previous merge yet)
[S13] round=41 local utility u=0.340040 metrics={'f1_val': 0.72616035693716, 'auprc': 0.7904657824553407, 'loss_val': 0.8548153441709606, 'psi': 0.7518825271444323}-{'f1_val': 0.6250733487214265, 'auprc': 0.7819869852314564, 'loss_val': 0.9029368547177651, 'psi': 0.6878388033254386}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S13] sending update (kind=head size=1792 to 1 peers)
[S14] START round=41 head_norm_before_train=1.482603 cos_to_last_merge=0.9999 (last merge round=39)
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.9580191556648172, 'auprc': 0.9982206221371124, 'loss_val': 0.07699158637034108, 'psi': 0.9740997422537352}-{'f1_val': 0.9974082695017256, 'auprc': 0.9984487644431977, 'loss_val': 0.045553855463900984, 'psi': 0.9978244674783144}
[S15] START round=41 head_norm_before_train=1.553822 cos_to_last_merge=0.9798 (last merge round=35)
[S15] round=41 local utility u=0.856634 metrics={'f1_val': 0.9736209334564336, 'auprc': 0.9910594870948722, 'loss_val': 0.06515805410380261, 'psi': 0.9805963549118091}-{'f1_val': 0.774573221818794, 'auprc': 0.9388848303918287, 'loss_val': 0.4276162428369643, 'psi': 0.8402978652480079}
[S16] START round=41 head_norm_before_train=1.932928 cos_to_last_merge=0.9999 (last merge round=38)
[S16] round=41 local utility u=0.019947 metrics={'f1_val': 0.939749205085862, 'auprc': 0.9918466979728715, 'loss_val': 0.29568330812625976, 'psi': 0.9605882022406658}-{'f1_val': 0.9368579165516175, 'auprc': 0.9917593508220147, 'loss_val': 0.31796714557588635, 'psi': 0.9588184902597765}
[S17] START round=41 head_norm_before_train=1.438993 cos_to_last_merge=1.0000 (last merge round=40)
[S17] round=41 local utility u=0.000000 metrics={'f1_val': 0.6549812030823886, 'auprc': 0.9110784591059621, 'loss_val': 0.8493111163677858, 'psi': 0.757420105491818}-{'f1_val': 0.6614923524707153, 'auprc': 0.981068549536619, 'loss_val': 0.6524266208649068, 'psi': 0.7893228312970768}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:59803
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:59814
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:59804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:59816
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:59807
[S7] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1805 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S6] not sending this round → trigger blocked (psi=0.906)
[S15] sending update (kind=head size=1805 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:59817
[S16] RECEIVED delta(kind=head bytes=1805) from S4
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.952023)
[S16] loaded HEAD from S4 (vec_in norm=1.952023)
[S16] cosine check vs S4: cos=0.9991
[S16] BUFFERED delta from S4 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1805) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.582527)
[S14] loaded HEAD from S15 (vec_in norm=1.582527)
[S14] cosine check vs S15: cos=0.9881
[S14] BUFFERED delta from S15 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1800) from S2
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=2.131281)
[S3] loaded HEAD from S2 (vec_in norm=2.131281)
[S3] cosine check vs S2: cos=0.9997
[S3] BUFFERED delta from S2 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1801) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.941348)
[S4] loaded HEAD from S16 (vec_in norm=1.941348)
[S4] cosine check vs S16: cos=0.9991
[S4] BUFFERED delta from S16 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1798) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.280019)
[S6] loaded HEAD from S7 (vec_in norm=1.280019)
[S6] cosine check vs S7: cos=0.9955
[S6] BUFFERED delta from S7 (total buffered=1)
[S5] sending update (kind=head size=1799 to 1 peers)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=41 metric=0.8302 head_norm=2.131281
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.560301e-02
[S2] stored merged vector for next round verification (round=41)
[S2] DEBUG after merge:  round=41 metric=0.8302 head_norm=2.122538 delta_norm=0.035603
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=41 metric=0.9416 head_norm=1.952023
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.144965e-02
[S4] stored merged vector for next round verification (round=41)
[S4] DEBUG after merge:  round=41 metric=0.9416 head_norm=1.946251 delta_norm=0.041450
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=41 metric=0.6234 head_norm=1.280019
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.343146e-02
[S7] stored merged vector for next round verification (round=41)
[S7] DEBUG after merge:  round=41 metric=0.6260 head_norm=1.279561 delta_norm=0.043431
[S7] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=41 metric=0.9397 head_norm=1.941348
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.144964e-02
[S16] stored merged vector for next round verification (round=41)
[S16] DEBUG after merge:  round=41 metric=0.9397 head_norm=1.946251 delta_norm=0.041450
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S17] RECEIVED delta(kind=head bytes=1799) from S5
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.460153)
[S17] loaded HEAD from S5 (vec_in norm=1.460153)
[S17] cosine check vs S5: cos=0.9992
[S17] BUFFERED delta from S5 (total buffered=1)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=41 metric=0.8672 head_norm=1.316535
[S6] _apply_head_vector_avg (torch): Δ‖w‖=6.396458e-02
[S6] stored merged vector for next round verification (round=41)
[S6] DEBUG after merge:  round=41 metric=0.8614 head_norm=1.296829 delta_norm=0.063965
[S6] aggregate: ROLLBACK (f1_val pre=0.867 post=0.861 tol_abs=0.005 tol_rel=0.0)
[S2] START round=42 head_norm_before_train=2.122538 cos_to_last_merge=1.0000 (last merge round=41)
[S2] round=42 local utility u=0.000000 metrics={'f1_val': 0.8289748449307263, 'auprc': 0.8891315882838906, 'loss_val': 0.40741223188821624, 'psi': 0.853037542271992}-{'f1_val': 0.8302453265638923, 'auprc': 0.993412265690344, 'loss_val': 0.3048602171774669, 'psi': 0.895512102214473}
[S3] START round=42 head_norm_before_train=2.119422 cos_to_last_merge=1.0000 (last merge round=40)
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.963845097981865, 'auprc': 0.9988494194198427, 'loss_val': 0.06306475025422136, 'psi': 0.9778468265570561}-{'f1_val': 0.9715229121240536, 'auprc': 0.9989969416465865, 'loss_val': 0.058634287849126596, 'psi': 0.9825125239330668}
[S4] START round=42 head_norm_before_train=1.946251 cos_to_last_merge=1.0000 (last merge round=41)
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.940518506318891, 'auprc': 0.9563168388837971, 'loss_val': 0.3008602393913731, 'psi': 0.9468378393448534}-{'f1_val': 0.9416016286399517, 'auprc': 0.9573407182020951, 'loss_val': 0.2972308228004634, 'psi': 0.947897264464809}
[S5] START round=42 head_norm_before_train=1.460153 cos_to_last_merge=0.9999 (last merge round=40)
[S5] round=42 local utility u=0.000000 metrics={'f1_val': 0.9742999946819697, 'auprc': 0.9915810658609745, 'loss_val': 0.15189570418541865, 'psi': 0.9812124231535717}-{'f1_val': 0.9945615134312132, 'auprc': 0.9932761891515485, 'loss_val': 0.14731660902527183, 'psi': 0.9940473837193473}
[S6] START round=42 head_norm_before_train=1.296829 cos_to_last_merge=1.0000 (last merge round=41)
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.8229112991404556, 'auprc': 0.9510599089026336, 'loss_val': 0.4826294590848956, 'psi': 0.8741707430453267}-{'f1_val': 0.8671996314902679, 'auprc': 0.9634246177934217, 'loss_val': 0.42382896053796887, 'psi': 0.9056896260115295}
[S7] START round=42 head_norm_before_train=1.279561 cos_to_last_merge=1.0000 (last merge round=41)
[S7] round=42 local utility u=0.000000 metrics={'f1_val': 0.5802027495460089, 'auprc': 0.784334683694913, 'loss_val': 0.7474881142823027, 'psi': 0.6618555232055705}-{'f1_val': 0.6233695393761078, 'auprc': 0.7957427917374413, 'loss_val': 0.660260946795686, 'psi': 0.6923188403206413}
[S8] START round=42 head_norm_before_train=2.193496 (no previous merge yet)
[S8] round=42 local utility u=0.451194 metrics={'f1_val': 0.980754111015934, 'auprc': 0.9899476969009378, 'loss_val': 0.06527242520244503, 'psi': 0.9844315453699355}-{'f1_val': 0.8581932327299797, 'auprc': 0.995654430660133, 'loss_val': 0.2494160720493339, 'psi': 0.913177711902041}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=42 head_norm_before_train=1.631236 cos_to_last_merge=0.9694 (last merge round=28)
[S9] round=42 local utility u=0.003226 metrics={'f1_val': 0.9968814284133827, 'auprc': 0.9991167187658656, 'loss_val': 0.03371659327672171, 'psi': 0.9977755445543758}-{'f1_val': 0.9968814284133827, 'auprc': 0.9973846793779505, 'loss_val': 0.034971525655500865, 'psi': 0.9970827287992098}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=42 head_norm_before_train=2.244649 (no previous merge yet)
[S10] round=42 local utility u=0.000000 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9930229079506631, 'loss_val': 0.03124060547732673, 'psi': 0.9932687880728087}-{'f1_val': 0.9934327081542391, 'auprc': 0.9936836470042342, 'loss_val': 0.032184808736630634, 'psi': 0.9935330836942372}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=42 head_norm_before_train=1.504879 cos_to_last_merge=0.9999 (last merge round=40)
[S11] round=42 local utility u=0.000000 metrics={'f1_val': 0.9940327724445256, 'auprc': 0.9963356287113834, 'loss_val': 0.05047871044398935, 'psi': 0.9949539149512687}-{'f1_val': 0.9961336749133093, 'auprc': 0.9948893296429948, 'loss_val': 0.0472214947700834, 'psi': 0.9956359368051835}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=42 head_norm_before_train=1.998978 (no previous merge yet)
[S13] round=42 local utility u=0.000000 metrics={'f1_val': 0.5914813658983256, 'auprc': 0.6661459861638799, 'loss_val': 1.3000093671346826, 'psi': 0.6213472140045473}-{'f1_val': 0.72616035693716, 'auprc': 0.7904657824553407, 'loss_val': 0.8548153441709606, 'psi': 0.7518825271444323}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=42 head_norm_before_train=1.497328 cos_to_last_merge=0.9998 (last merge round=39)
[S14] round=42 local utility u=0.135617 metrics={'f1_val': 0.9971882020035234, 'auprc': 0.998798462555381, 'loss_val': 0.04250439841668541, 'psi': 0.9978323062242664}-{'f1_val': 0.9580191556648172, 'auprc': 0.9982206221371124, 'loss_val': 0.07699158637034108, 'psi': 0.9740997422537352}
[S15] START round=42 head_norm_before_train=1.582527 cos_to_last_merge=0.9768 (last merge round=35)
[S15] round=42 local utility u=0.000000 metrics={'f1_val': 0.8770230389698865, 'auprc': 0.9922757308217282, 'loss_val': 0.28840994019716926, 'psi': 0.9231241157106231}-{'f1_val': 0.9736209334564336, 'auprc': 0.9910594870948722, 'loss_val': 0.06515805410380261, 'psi': 0.9805963549118091}
[S16] START round=42 head_norm_before_train=1.946251 cos_to_last_merge=1.0000 (last merge round=41)
[S16] round=42 local utility u=0.105597 metrics={'f1_val': 0.9470882710803584, 'auprc': 0.9932091578005467, 'loss_val': 0.1326103384298122, 'psi': 0.9655366257684337}-{'f1_val': 0.939749205085862, 'auprc': 0.9918466979728715, 'loss_val': 0.29568330812625976, 'psi': 0.9605882022406658}
[S17] START round=42 head_norm_before_train=1.496105 cos_to_last_merge=0.9993 (last merge round=40)
[S17] round=42 local utility u=0.728263 metrics={'f1_val': 0.8277306474703244, 'auprc': 0.9266910468355075, 'loss_val': 0.4761203572896524, 'psi': 0.8673148072163976}-{'f1_val': 0.6549812030823886, 'auprc': 0.9110784591059621, 'loss_val': 0.8493111163677858, 'psi': 0.757420105491818}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:59805
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:59812
[S16] not sending this round → trigger blocked (psi=0.966)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1796 to 1 peers)
[S17] sending update (kind=head size=1804 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=42 metric=0.9638 head_norm=2.130072
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.116195e-02
[S3] stored merged vector for next round verification (round=42)
[S3] DEBUG after merge:  round=42 metric=0.9638 head_norm=2.130449 delta_norm=0.031162
[S3] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] RECEIVED delta(kind=head bytes=1796) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.511749)
[S11] loaded HEAD from S14 (vec_in norm=1.511749)
[S11] cosine check vs S14: cos=0.9832
[S11] BUFFERED delta from S14 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1804) from S17
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.537495)
[S5] loaded HEAD from S17 (vec_in norm=1.537495)
[S5] cosine check vs S17: cos=0.9979
[S5] BUFFERED delta from S17 (total buffered=1)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=42 metric=0.8277 head_norm=1.537495
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.980932e-02
[S17] stored merged vector for next round verification (round=42)
[S17] DEBUG after merge:  round=42 metric=0.8277 head_norm=1.498129 delta_norm=0.059809
[S17] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=42 metric=0.9972 head_norm=1.511749
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.275237e-01
[S14] stored merged vector for next round verification (round=42)
[S14] DEBUG after merge:  round=42 metric=0.9972 head_norm=1.542279 delta_norm=0.127524
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=42 metric=0.9743 head_norm=1.474946
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.819518e-02
[S5] stored merged vector for next round verification (round=42)
[S5] DEBUG after merge:  round=42 metric=0.9702 head_norm=1.505421 delta_norm=0.058195
[S5] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=43 head_norm_before_train=2.132316 cos_to_last_merge=1.0000 (last merge round=41)
[S2] round=43 local utility u=0.124028 metrics={'f1_val': 0.8293427701917001, 'auprc': 0.9613745132067428, 'loss_val': 0.37829164754361233, 'psi': 0.8821554673977172}-{'f1_val': 0.8289748449307263, 'auprc': 0.8891315882838906, 'loss_val': 0.40741223188821624, 'psi': 0.853037542271992}
[S3] START round=43 head_norm_before_train=2.130449 cos_to_last_merge=1.0000 (last merge round=42)
[S3] round=43 local utility u=0.121151 metrics={'f1_val': 0.9974247332315468, 'auprc': 0.9987413910909383, 'loss_val': 0.021917049370081963, 'psi': 0.9979513963753033}-{'f1_val': 0.963845097981865, 'auprc': 0.9988494194198427, 'loss_val': 0.06306475025422136, 'psi': 0.9778468265570561}
[S4] START round=43 head_norm_before_train=1.955151 cos_to_last_merge=0.9999 (last merge round=41)
[S4] round=43 local utility u=0.025729 metrics={'f1_val': 0.9464382814214669, 'auprc': 0.9583871889959267, 'loss_val': 0.2911325843250244, 'psi': 0.9512178444512508}-{'f1_val': 0.940518506318891, 'auprc': 0.9563168388837971, 'loss_val': 0.3008602393913731, 'psi': 0.9468378393448534}
[S5] START round=43 head_norm_before_train=1.505421 cos_to_last_merge=1.0000 (last merge round=42)
[S5] round=43 local utility u=0.099009 metrics={'f1_val': 0.9960398919057053, 'auprc': 0.996639464948436, 'loss_val': 0.09949312546137971, 'psi': 0.9962797211227976}-{'f1_val': 0.9742999946819697, 'auprc': 0.9915810658609745, 'loss_val': 0.15189570418541865, 'psi': 0.9812124231535717}
[S6] START round=43 head_norm_before_train=1.336823 cos_to_last_merge=0.9995 (last merge round=41)
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.7843764353545375, 'auprc': 0.937285721083737, 'loss_val': 0.603633270462216, 'psi': 0.8455401496462174}-{'f1_val': 0.8229112991404556, 'auprc': 0.9510599089026336, 'loss_val': 0.4826294590848956, 'psi': 0.8741707430453267}
[S7] START round=43 head_norm_before_train=1.292051 cos_to_last_merge=0.9999 (last merge round=41)
[S7] round=43 local utility u=0.303735 metrics={'f1_val': 0.6364098840405084, 'auprc': 0.8018926084589623, 'loss_val': 0.529934265302476, 'psi': 0.7026029738078898}-{'f1_val': 0.5802027495460089, 'auprc': 0.784334683694913, 'loss_val': 0.7474881142823027, 'psi': 0.6618555232055705}
[S8] START round=43 head_norm_before_train=2.199455 (no previous merge yet)
[S8] round=43 local utility u=0.035282 metrics={'f1_val': 0.9854461996159931, 'auprc': 0.9960558533859619, 'loss_val': 0.04118471272653977, 'psi': 0.9896900611239806}-{'f1_val': 0.980754111015934, 'auprc': 0.9899476969009378, 'loss_val': 0.06527242520244503, 'psi': 0.9844315453699355}
[S8] not sending this round → trigger blocked (psi=0.990)
[S9] START round=43 head_norm_before_train=1.642612 cos_to_last_merge=0.9683 (last merge round=28)
[S9] round=43 local utility u=0.001046 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9986476348389405, 'loss_val': 0.031546334082584886, 'psi': 0.9977208014428619}-{'f1_val': 0.9968814284133827, 'auprc': 0.9991167187658656, 'loss_val': 0.03371659327672171, 'psi': 0.9977755445543758}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=43 head_norm_before_train=2.252827 (no previous merge yet)
[S10] round=43 local utility u=0.000566 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.993435081472824, 'loss_val': 0.031345616832976195, 'psi': 0.9934336574816731}-{'f1_val': 0.9934327081542391, 'auprc': 0.9930229079506631, 'loss_val': 0.03124060547732673, 'psi': 0.9932687880728087}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=43 head_norm_before_train=1.527009 cos_to_last_merge=0.9998 (last merge round=40)
[S11] round=43 local utility u=0.008022 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9946020462355154, 'loss_val': 0.0418399195336926, 'psi': 0.9955210234421917}-{'f1_val': 0.9940327724445256, 'auprc': 0.9963356287113834, 'loss_val': 0.05047871044398935, 'psi': 0.9949539149512687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=43 metric=0.9961 head_norm=1.545278
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.444995e-01
[S11] stored merged vector for next round verification (round=43)
[S11] DEBUG after merge:  round=43 metric=0.9961 head_norm=1.521761 delta_norm=0.144499
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S13] START round=43 head_norm_before_train=2.018129 (no previous merge yet)
[S13] round=43 local utility u=0.894598 metrics={'f1_val': 0.7414608570771549, 'auprc': 0.7687828059044266, 'loss_val': 0.718601642351579, 'psi': 0.7523896366080636}-{'f1_val': 0.5914813658983256, 'auprc': 0.6661459861638799, 'loss_val': 1.3000093671346826, 'psi': 0.6213472140045473}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S13] sending update (kind=head size=1792 to 1 peers)
[S14] START round=43 head_norm_before_train=1.542279 cos_to_last_merge=1.0000 (last merge round=42)
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.996754531653698, 'auprc': 0.9981922640348477, 'loss_val': 0.0391100461011024, 'psi': 0.9973296246061579}-{'f1_val': 0.9971882020035234, 'auprc': 0.998798462555381, 'loss_val': 0.04250439841668541, 'psi': 0.9978323062242664}
[S15] START round=43 head_norm_before_train=1.606848 cos_to_last_merge=0.9743 (last merge round=35)
[S15] round=43 local utility u=0.488849 metrics={'f1_val': 0.9951611201824148, 'auprc': 0.9977630994703945, 'loss_val': 0.03600227517736685, 'psi': 0.9962019118976067}-{'f1_val': 0.8770230389698865, 'auprc': 0.9922757308217282, 'loss_val': 0.28840994019716926, 'psi': 0.9231241157106231}
[S16] START round=43 head_norm_before_train=1.956295 cos_to_last_merge=1.0000 (last merge round=41)
[S16] round=43 local utility u=0.132838 metrics={'f1_val': 0.979894531925576, 'auprc': 0.9963505576104813, 'loss_val': 0.0731965588508228, 'psi': 0.9864769421995381}-{'f1_val': 0.9470882710803584, 'auprc': 0.9932091578005467, 'loss_val': 0.1326103384298122, 'psi': 0.9655366257684337}
[S17] START round=43 head_norm_before_train=1.498129 cos_to_last_merge=1.0000 (last merge round=42)
[S17] round=43 local utility u=0.000000 metrics={'f1_val': 0.5787065890093371, 'auprc': 0.8121829652497665, 'loss_val': 1.1940276491307975, 'psi': 0.6720971395055089}-{'f1_val': 0.8277306474703244, 'auprc': 0.9266910468355075, 'loss_val': 0.4761203572896524, 'psi': 0.8673148072163976}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:59814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:59816
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:59804
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:59802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:59803
[S16] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1805 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:59817
[S4] RECEIVED delta(kind=head bytes=1802) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.967853)
[S4] loaded HEAD from S16 (vec_in norm=1.967853)
[S4] cosine check vs S16: cos=0.9998
[S4] BUFFERED delta from S16 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1805) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.306198)
[S6] loaded HEAD from S7 (vec_in norm=1.306198)
[S6] cosine check vs S7: cos=0.9965
[S6] BUFFERED delta from S7 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1799) from S3
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=2.138072)
[S2] loaded HEAD from S3 (vec_in norm=2.138072)
[S2] cosine check vs S3: cos=0.9998
[S2] BUFFERED delta from S3 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1802) from S4
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.961881)
[S16] loaded HEAD from S4 (vec_in norm=1.961881)
[S16] cosine check vs S4: cos=0.9998
[S16] BUFFERED delta from S4 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1797) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.627785)
[S14] loaded HEAD from S15 (vec_in norm=1.627785)
[S14] cosine check vs S15: cos=0.9949
[S14] BUFFERED delta from S15 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1797) from S2
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=2.144876)
[S3] loaded HEAD from S2 (vec_in norm=2.144876)
[S3] cosine check vs S2: cos=0.9998
[S3] BUFFERED delta from S2 (total buffered=1)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=43 metric=0.8293 head_norm=2.144876
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.927918e-02
[S2] stored merged vector for next round verification (round=43)
[S2] DEBUG after merge:  round=43 metric=0.8293 head_norm=2.141390 delta_norm=0.019279
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=43 metric=0.9464 head_norm=1.961881
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.006484e-02
[S4] stored merged vector for next round verification (round=43)
[S4] DEBUG after merge:  round=43 metric=0.9464 head_norm=1.964767 delta_norm=0.020065
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S5] sending update (kind=head size=1794 to 1 peers)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=43 metric=0.9799 head_norm=1.967853
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.006483e-02
[S16] stored merged vector for next round verification (round=43)
[S16] DEBUG after merge:  round=43 metric=0.9799 head_norm=1.964767 delta_norm=0.020065
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=43 metric=0.9974 head_norm=2.138072
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.927919e-02
[S3] stored merged vector for next round verification (round=43)
[S3] DEBUG after merge:  round=43 metric=0.9974 head_norm=2.141390 delta_norm=0.019279
[S3] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S17] RECEIVED delta(kind=head bytes=1794) from S5
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.518702)
[S17] loaded HEAD from S5 (vec_in norm=1.518702)
[S17] cosine check vs S5: cos=0.9996
[S17] BUFFERED delta from S5 (total buffered=1)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=43 metric=0.7844 head_norm=1.370866
[S6] _apply_head_vector_avg (torch): Δ‖w‖=6.461047e-02
[S6] stored merged vector for next round verification (round=43)
[S6] DEBUG after merge:  round=43 metric=0.7883 head_norm=1.337363 delta_norm=0.064610
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=44 head_norm_before_train=2.141390 cos_to_last_merge=1.0000 (last merge round=43)
[S2] round=44 local utility u=0.040701 metrics={'f1_val': 0.8292592888103074, 'auprc': 0.9893337475160098, 'loss_val': 0.38026635457035945, 'psi': 0.8932890722925884}-{'f1_val': 0.8293427701917001, 'auprc': 0.9613745132067428, 'loss_val': 0.37829164754361233, 'psi': 0.8821554673977172}
[S3] START round=44 head_norm_before_train=2.141390 cos_to_last_merge=1.0000 (last merge round=43)
[S3] round=44 local utility u=0.003022 metrics={'f1_val': 0.9978389274664787, 'auprc': 0.998992748687152, 'loss_val': 0.019113202530544673, 'psi': 0.9983004559547481}-{'f1_val': 0.9974247332315468, 'auprc': 0.9987413910909383, 'loss_val': 0.021917049370081963, 'psi': 0.9979513963753033}
[S4] START round=44 head_norm_before_train=1.964767 cos_to_last_merge=1.0000 (last merge round=43)
[S4] round=44 local utility u=0.000000 metrics={'f1_val': 0.943251806796635, 'auprc': 0.9529579804390268, 'loss_val': 0.2992722850253079, 'psi': 0.9471342762535917}-{'f1_val': 0.9464382814214669, 'auprc': 0.9583871889959267, 'loss_val': 0.2911325843250244, 'psi': 0.9512178444512508}
[S5] START round=44 head_norm_before_train=1.518702 cos_to_last_merge=0.9999 (last merge round=42)
[S5] round=44 local utility u=0.000000 metrics={'f1_val': 0.7293263279759107, 'auprc': 0.9907237944567865, 'loss_val': 0.23233769135490726, 'psi': 0.833885314568261}-{'f1_val': 0.9960398919057053, 'auprc': 0.996639464948436, 'loss_val': 0.09949312546137971, 'psi': 0.9962797211227976}
[S6] START round=44 head_norm_before_train=1.337363 cos_to_last_merge=1.0000 (last merge round=43)
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.6152129475903394, 'auprc': 0.9157598217349766, 'loss_val': 0.8359692626090033, 'psi': 0.7354316972481942}-{'f1_val': 0.7843764353545375, 'auprc': 0.937285721083737, 'loss_val': 0.603633270462216, 'psi': 0.8455401496462174}
[S7] START round=44 head_norm_before_train=1.306198 cos_to_last_merge=0.9997 (last merge round=41)
[S7] round=44 local utility u=0.000000 metrics={'f1_val': 0.461679833515203, 'auprc': 0.7806060804584574, 'loss_val': 0.9307163796948149, 'psi': 0.5892503322925048}-{'f1_val': 0.6364098840405084, 'auprc': 0.8018926084589623, 'loss_val': 0.529934265302476, 'psi': 0.7026029738078898}
[S8] START round=44 head_norm_before_train=2.201787 (no previous merge yet)
[S8] round=44 local utility u=0.039493 metrics={'f1_val': 0.9944672019690619, 'auprc': 0.9992177087495785, 'loss_val': 0.025809305985979008, 'psi': 0.9963674046812685}-{'f1_val': 0.9854461996159931, 'auprc': 0.9960558533859619, 'loss_val': 0.04118471272653977, 'psi': 0.9896900611239806}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=44 head_norm_before_train=1.653303 cos_to_last_merge=0.9672 (last merge round=28)
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9963245722468625, 'loss_val': 0.031733850827148635, 'psi': 0.9965453236576023}-{'f1_val': 0.9971029125121428, 'auprc': 0.9986476348389405, 'loss_val': 0.031546334082584886, 'psi': 0.9977208014428619}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=44 head_norm_before_train=2.255397 (no previous merge yet)
[S10] round=44 local utility u=0.000242 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9937537797357313, 'loss_val': 0.031818477789147356, 'psi': 0.993561136786836}-{'f1_val': 0.9934327081542391, 'auprc': 0.993435081472824, 'loss_val': 0.031345616832976195, 'psi': 0.9934336574816731}
[S10] not sending this round → trigger blocked (psi=0.994)
[S11] START round=44 head_norm_before_train=1.521761 cos_to_last_merge=1.0000 (last merge round=43)
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9954413341508226, 'loss_val': 0.06085674906728406, 'psi': 0.9958567386083146}-{'f1_val': 0.9961336749133093, 'auprc': 0.9946020462355154, 'loss_val': 0.0418399195336926, 'psi': 0.9955210234421917}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=44 head_norm_before_train=2.023042 (no previous merge yet)
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.7306299512105259, 'auprc': 0.7468413568014598, 'loss_val': 1.0815585915457664, 'psi': 0.7371145134468995}-{'f1_val': 0.7414608570771549, 'auprc': 0.7687828059044266, 'loss_val': 0.718601642351579, 'psi': 0.7523896366080636}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=44 head_norm_before_train=1.556846 cos_to_last_merge=1.0000 (last merge round=42)
[S14] round=44 local utility u=0.000660 metrics={'f1_val': 0.9971652929977585, 'auprc': 0.9976408142903432, 'loss_val': 0.03860088326664128, 'psi': 0.9973555015147924}-{'f1_val': 0.996754531653698, 'auprc': 0.9981922640348477, 'loss_val': 0.0391100461011024, 'psi': 0.9973296246061579}
[S15] START round=44 head_norm_before_train=1.627785 cos_to_last_merge=0.9722 (last merge round=35)
[S15] round=44 local utility u=0.000000 metrics={'f1_val': 0.7007681293011265, 'auprc': 0.8617949853605856, 'loss_val': 0.6027557000563709, 'psi': 0.7651788717249102}-{'f1_val': 0.9951611201824148, 'auprc': 0.9977630994703945, 'loss_val': 0.03600227517736685, 'psi': 0.9962019118976067}
[S16] START round=44 head_norm_before_train=1.964767 cos_to_last_merge=1.0000 (last merge round=43)
[S16] round=44 local utility u=0.000000 metrics={'f1_val': 0.9796795852072916, 'auprc': 0.9963820815603402, 'loss_val': 0.07595555021380379, 'psi': 0.986360583748511}-{'f1_val': 0.979894531925576, 'auprc': 0.9963505576104813, 'loss_val': 0.0731965588508228, 'psi': 0.9864769421995381}
[S17] START round=44 head_norm_before_train=1.540638 cos_to_last_merge=0.9997 (last merge round=42)
[S17] round=44 local utility u=1.000000 metrics={'f1_val': 0.7638226436311109, 'auprc': 0.9955765992995181, 'loss_val': 0.48731860682507266, 'psi': 0.8565242258984738}-{'f1_val': 0.5787065890093371, 'auprc': 0.8121829652497665, 'loss_val': 1.1940276491307975, 'psi': 0.6720971395055089}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:59805
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.998)
[S2] not sending this round → trigger blocked (psi=0.893)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S11@127.0.0.1:59812
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1804 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1798 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] RECEIVED delta(kind=head bytes=1804) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.569970)
[S11] loaded HEAD from S14 (vec_in norm=1.569970)
[S11] cosine check vs S14: cos=0.9857
[S11] BUFFERED delta from S14 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1798) from S17
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.577963)
[S5] loaded HEAD from S17 (vec_in norm=1.577963)
[S5] cosine check vs S17: cos=0.9988
[S5] BUFFERED delta from S17 (total buffered=1)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=44 metric=0.7638 head_norm=1.577963
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.621328e-02
[S17] stored merged vector for next round verification (round=44)
[S17] DEBUG after merge:  round=44 metric=0.7637 head_norm=1.547926 delta_norm=0.046213
[S17] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=44 metric=0.9972 head_norm=1.569970
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.914444e-02
[S14] stored merged vector for next round verification (round=44)
[S14] DEBUG after merge:  round=44 metric=0.9972 head_norm=1.596652 delta_norm=0.089144
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=44 metric=0.7293 head_norm=1.529000
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.560814e-02
[S5] stored merged vector for next round verification (round=44)
[S5] DEBUG after merge:  round=44 metric=0.7282 head_norm=1.553005 delta_norm=0.045608
[S5] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=45 head_norm_before_train=2.156349 cos_to_last_merge=1.0000 (last merge round=43)
[S2] round=45 local utility u=0.025736 metrics={'f1_val': 0.829250698760343, 'auprc': 0.9939907753140996, 'loss_val': 0.3427141060749153, 'psi': 0.8951467293818456}-{'f1_val': 0.8292592888103074, 'auprc': 0.9893337475160098, 'loss_val': 0.38026635457035945, 'psi': 0.8932890722925884}
[S3] START round=45 head_norm_before_train=2.150682 cos_to_last_merge=1.0000 (last merge round=43)
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.8796092047217287, 'auprc': 0.9983267378886806, 'loss_val': 0.22033316739977926, 'psi': 0.9270962179885094}-{'f1_val': 0.9978389274664787, 'auprc': 0.998992748687152, 'loss_val': 0.019113202530544673, 'psi': 0.9983004559547481}
[S4] START round=45 head_norm_before_train=1.976998 cos_to_last_merge=1.0000 (last merge round=43)
[S4] round=45 local utility u=0.008984 metrics={'f1_val': 0.9432630273670566, 'auprc': 0.9599785171035993, 'loss_val': 0.3024335469710157, 'psi': 0.9499492232616736}-{'f1_val': 0.943251806796635, 'auprc': 0.9529579804390268, 'loss_val': 0.2992722850253079, 'psi': 0.9471342762535917}
[S5] START round=45 head_norm_before_train=1.553005 cos_to_last_merge=1.0000 (last merge round=44)
[S5] round=45 local utility u=0.873084 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9934385237951235, 'loss_val': 0.09371620925625837, 'psi': 0.994911403789253}-{'f1_val': 0.7293263279759107, 'auprc': 0.9907237944567865, 'loss_val': 0.23233769135490726, 'psi': 0.833885314568261}
[S6] START round=45 head_norm_before_train=1.365906 cos_to_last_merge=0.9998 (last merge round=43)
[S6] round=45 local utility u=1.000000 metrics={'f1_val': 0.9025102883987836, 'auprc': 0.9658511502562066, 'loss_val': 0.29390991002818206, 'psi': 0.9278466331417528}-{'f1_val': 0.6152129475903394, 'auprc': 0.9157598217349766, 'loss_val': 0.8359692626090033, 'psi': 0.7354316972481942}
[S7] START round=45 head_norm_before_train=1.317485 cos_to_last_merge=0.9995 (last merge round=41)
[S7] round=45 local utility u=0.369900 metrics={'f1_val': 0.5579410092184324, 'auprc': 0.7826431644102129, 'loss_val': 0.7745939937154497, 'psi': 0.6478218712951446}-{'f1_val': 0.461679833515203, 'auprc': 0.7806060804584574, 'loss_val': 0.9307163796948149, 'psi': 0.5892503322925048}
[S8] START round=45 head_norm_before_train=2.208466 (no previous merge yet)
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.9826792046579734, 'auprc': 0.9992172990949538, 'loss_val': 0.04541121790208085, 'psi': 0.9892944424327655}-{'f1_val': 0.9944672019690619, 'auprc': 0.9992177087495785, 'loss_val': 0.025809305985979008, 'psi': 0.9963674046812685}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=45 head_norm_before_train=1.663095 cos_to_last_merge=0.9662 (last merge round=28)
[S9] round=45 local utility u=0.005617 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9986008040956162, 'loss_val': 0.02979088576847084, 'psi': 0.9977020691455322}-{'f1_val': 0.9966924912647621, 'auprc': 0.9963245722468625, 'loss_val': 0.031733850827148635, 'psi': 0.9965453236576023}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=45 head_norm_before_train=2.262993 (no previous merge yet)
[S10] round=45 local utility u=0.000151 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9937030247891077, 'loss_val': 0.031364216203388806, 'psi': 0.9935408348081866}-{'f1_val': 0.9934327081542391, 'auprc': 0.9937537797357313, 'loss_val': 0.031818477789147356, 'psi': 0.993561136786836}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=45 head_norm_before_train=1.539540 cos_to_last_merge=0.9999 (last merge round=43)
[S11] round=45 local utility u=0.006259 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9953272782956328, 'loss_val': 0.04799604574435645, 'psi': 0.9958111162662387}-{'f1_val': 0.9961336749133093, 'auprc': 0.9954413341508226, 'loss_val': 0.06085674906728406, 'psi': 0.9958567386083146}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=45 metric=0.9961 head_norm=1.559349
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.364570e-01
[S11] stored merged vector for next round verification (round=45)
[S11] DEBUG after merge:  round=45 metric=0.9961 head_norm=1.558707 delta_norm=0.136457
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S13] START round=45 head_norm_before_train=2.030966 (no previous merge yet)
[S13] round=45 local utility u=0.268471 metrics={'f1_val': 0.7407244538787221, 'auprc': 0.785193098846237, 'loss_val': 0.720238791816159, 'psi': 0.7585119118657281}-{'f1_val': 0.7306299512105259, 'auprc': 0.7468413568014598, 'loss_val': 1.0815585915457664, 'psi': 0.7371145134468995}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S13] sending update (kind=head size=1791 to 1 peers)
[S14] START round=45 head_norm_before_train=1.596652 cos_to_last_merge=1.0000 (last merge round=44)
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.9967325241656609, 'auprc': 0.9977669494933181, 'loss_val': 0.037911992686622674, 'psi': 0.9971462942967237}-{'f1_val': 0.9971652929977585, 'auprc': 0.9976408142903432, 'loss_val': 0.03860088326664128, 'psi': 0.9973555015147924}
[S15] START round=45 head_norm_before_train=1.644397 cos_to_last_merge=0.9705 (last merge round=35)
[S15] round=45 local utility u=1.000000 metrics={'f1_val': 0.9966870188820673, 'auprc': 0.9921112556327885, 'loss_val': 0.028500248777175975, 'psi': 0.9948567135823558}-{'f1_val': 0.7007681293011265, 'auprc': 0.8617949853605856, 'loss_val': 0.6027557000563709, 'psi': 0.7651788717249102}
[S16] START round=45 head_norm_before_train=1.975116 cos_to_last_merge=1.0000 (last merge round=43)
[S16] round=45 local utility u=0.000000 metrics={'f1_val': 0.9400091629446087, 'auprc': 0.9960030460285832, 'loss_val': 0.26382618481191633, 'psi': 0.9624067161781986}-{'f1_val': 0.9796795852072916, 'auprc': 0.9963820815603402, 'loss_val': 0.07595555021380379, 'psi': 0.986360583748511}
[S17] START round=45 head_norm_before_train=1.547926 cos_to_last_merge=1.0000 (last merge round=44)
[S17] round=45 local utility u=0.000000 metrics={'f1_val': 0.6961328013490677, 'auprc': 0.9835246086772852, 'loss_val': 0.7623154190725157, 'psi': 0.8110895242803547}-{'f1_val': 0.7638226436311109, 'auprc': 0.9955765992995181, 'loss_val': 0.48731860682507266, 'psi': 0.8565242258984738}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:59807
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:59816
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:59814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:59803
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S14] ⇄ pheromone p=0.017 → S11@127.0.0.1:59812
[S3] ⇄ pheromone p=0.035 → S2@127.0.0.1:59802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:59817
[S16] ⇄ pheromone p=0.061 → S4@127.0.0.1:59804
[S7] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:59815
[S17] ⇄ pheromone p=0.333 → S5@127.0.0.1:59805
[S14] RECEIVED delta(kind=head bytes=1796) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.658491)
[S14] loaded HEAD from S15 (vec_in norm=1.658491)
[S14] cosine check vs S15: cos=0.9977
[S14] BUFFERED delta from S15 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1798) from S2
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=2.166290)
[S3] loaded HEAD from S2 (vec_in norm=2.166290)
[S3] cosine check vs S2: cos=0.9998
[S3] BUFFERED delta from S2 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1798) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.331192)
[S6] loaded HEAD from S7 (vec_in norm=1.331192)
[S6] cosine check vs S7: cos=0.9962
[S6] BUFFERED delta from S7 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1796) from S4
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.992857)
[S16] loaded HEAD from S4 (vec_in norm=1.992857)
[S16] cosine check vs S4: cos=0.9997
[S16] BUFFERED delta from S4 (total buffered=1)
[S5] sending update (kind=head size=1796 to 1 peers)
[S7] ⇄ pheromone p=0.167 → S6@127.0.0.1:59807
[S6] sending update (kind=head size=1800 to 1 peers)
[S4] ⇄ pheromone p=0.046 → S16@127.0.0.1:59816
[S2] ⇄ pheromone p=0.122 → S3@127.0.0.1:59803
[S15] ⇄ pheromone p=0.383 → S14@127.0.0.1:59814
[S17] RECEIVED delta(kind=head bytes=1796) from S5
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.562307)
[S17] loaded HEAD from S5 (vec_in norm=1.562307)
[S17] cosine check vs S5: cos=0.9997
[S17] BUFFERED delta from S5 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1800) from S6
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.391364)
[S15] loaded HEAD from S6 (vec_in norm=1.391364)
[S15] cosine check vs S6: cos=0.7393
[S15] BUFFERED delta from S6 (total buffered=1)
[S5] ⇄ pheromone p=0.340 → S17@127.0.0.1:59817
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=45 metric=0.9025 head_norm=1.391364
[S6] _apply_head_vector_avg (torch): Δ‖w‖=6.683155e-02
[S6] stored merged vector for next round verification (round=45)
[S6] DEBUG after merge:  round=45 metric=0.9108 head_norm=1.359969 delta_norm=0.066832
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.276 → S15@127.0.0.1:59815
[S2] START round=46 head_norm_before_train=2.166290 cos_to_last_merge=0.9999 (last merge round=43)
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.8300320546217095, 'auprc': 0.9790593921384482, 'loss_val': 0.34109597229006566, 'psi': 0.889642989628405}-{'f1_val': 0.829250698760343, 'auprc': 0.9939907753140996, 'loss_val': 0.3427141060749153, 'psi': 0.8951467293818456}
[S3] START round=46 head_norm_before_train=2.157526 cos_to_last_merge=0.9999 (last merge round=43)
[S3] round=46 local utility u=0.303253 metrics={'f1_val': 0.9605438728991138, 'auprc': 0.9988317469935846, 'loss_val': 0.10095039606070878, 'psi': 0.9758590225369022}-{'f1_val': 0.8796092047217287, 'auprc': 0.9983267378886806, 'loss_val': 0.22033316739977926, 'psi': 0.9270962179885094}
[S4] START round=46 head_norm_before_train=1.992857 cos_to_last_merge=0.9998 (last merge round=43)
[S4] round=46 local utility u=0.004178 metrics={'f1_val': 0.9471277878777237, 'auprc': 0.9525158321860422, 'loss_val': 0.2948778366802441, 'psi': 0.949283005601051}-{'f1_val': 0.9432630273670566, 'auprc': 0.9599785171035993, 'loss_val': 0.3024335469710157, 'psi': 0.9499492232616736}
[S5] START round=46 head_norm_before_train=1.562307 cos_to_last_merge=1.0000 (last merge round=44)
[S5] round=46 local utility u=0.007838 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9948292198962467, 'loss_val': 0.08221276218018024, 'psi': 0.9954676822297024}-{'f1_val': 0.9958933237853395, 'auprc': 0.9934385237951235, 'loss_val': 0.09371620925625837, 'psi': 0.994911403789253}
[S6] START round=46 head_norm_before_train=1.359969 cos_to_last_merge=1.0000 (last merge round=45)
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.7774159716442773, 'auprc': 0.947778181518103, 'loss_val': 0.5422753770107055, 'psi': 0.8455608555938076}-{'f1_val': 0.9025102883987836, 'auprc': 0.9658511502562066, 'loss_val': 0.29390991002818206, 'psi': 0.9278466331417528}
[S7] START round=46 head_norm_before_train=1.331192 cos_to_last_merge=0.9991 (last merge round=41)
[S7] round=46 local utility u=0.161171 metrics={'f1_val': 0.5905127408422196, 'auprc': 0.7889039410601978, 'loss_val': 0.6664640444540045, 'psi': 0.6698692209294108}-{'f1_val': 0.5579410092184324, 'auprc': 0.7826431644102129, 'loss_val': 0.7745939937154497, 'psi': 0.6478218712951446}
[S8] START round=46 head_norm_before_train=2.215249 (no previous merge yet)
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.8532193546656379, 'auprc': 0.9958962820911548, 'loss_val': 0.26202356067173016, 'psi': 0.9102901256358447}-{'f1_val': 0.9826792046579734, 'auprc': 0.9992172990949538, 'loss_val': 0.04541121790208085, 'psi': 0.9892944424327655}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=46 head_norm_before_train=1.672354 cos_to_last_merge=0.9654 (last merge round=28)
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.9967181314020974, 'auprc': 0.9986718628807629, 'loss_val': 0.02855127549165582, 'psi': 0.9974996239935636}-{'f1_val': 0.9971029125121428, 'auprc': 0.9986008040956162, 'loss_val': 0.02979088576847084, 'psi': 0.9977020691455322}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=46 head_norm_before_train=2.268122 (no previous merge yet)
[S10] round=46 local utility u=0.001082 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9945405503651124, 'loss_val': 0.03171366050213811, 'psi': 0.9938758450385885}-{'f1_val': 0.9934327081542391, 'auprc': 0.9937030247891077, 'loss_val': 0.031364216203388806, 'psi': 0.9935408348081866}
[S10] not sending this round → trigger blocked (psi=0.994)
[S11] START round=46 head_norm_before_train=1.558707 cos_to_last_merge=1.0000 (last merge round=45)
[S11] round=46 local utility u=0.000335 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.994532381842198, 'loss_val': 0.04494195725777947, 'psi': 0.9954931576848648}-{'f1_val': 0.9961336749133093, 'auprc': 0.9953272782956328, 'loss_val': 0.04799604574435645, 'psi': 0.9958111162662387}
[S11] not sending this round → trigger blocked (psi=0.995)
[S13] START round=46 head_norm_before_train=2.038152 (no previous merge yet)
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.7419696795951145, 'auprc': 0.8057412086337179, 'loss_val': 0.8643053755722309, 'psi': 0.7674782912105558}-{'f1_val': 0.7407244538787221, 'auprc': 0.785193098846237, 'loss_val': 0.720238791816159, 'psi': 0.7585119118657281}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=46 head_norm_before_train=1.607619 cos_to_last_merge=1.0000 (last merge round=44)
[S14] round=46 local utility u=0.003043 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9982579707562065, 'loss_val': 0.03488868443329476, 'psi': 0.9975016931970817}-{'f1_val': 0.9967325241656609, 'auprc': 0.9977669494933181, 'loss_val': 0.037911992686622674, 'psi': 0.9971462942967237}
[S15] START round=46 head_norm_before_train=1.658491 cos_to_last_merge=0.9690 (last merge round=35)
[S15] round=46 local utility u=0.000000 metrics={'f1_val': 0.8969963998270292, 'auprc': 0.9937899178754279, 'loss_val': 0.2468364717593063, 'psi': 0.9357138070463886}-{'f1_val': 0.9966870188820673, 'auprc': 0.9921112556327885, 'loss_val': 0.028500248777175975, 'psi': 0.9948567135823558}
[S16] START round=46 head_norm_before_train=1.984055 cos_to_last_merge=0.9999 (last merge round=43)
[S16] round=46 local utility u=0.000000 metrics={'f1_val': 0.9212608332312984, 'auprc': 0.9945887642397424, 'loss_val': 0.4202878958676507, 'psi': 0.9505920056346759}-{'f1_val': 0.9400091629446087, 'auprc': 0.9960030460285832, 'loss_val': 0.26382618481191633, 'psi': 0.9624067161781986}
[S17] START round=46 head_norm_before_train=1.581891 cos_to_last_merge=0.9998 (last merge round=44)
[S17] round=46 local utility u=0.041668 metrics={'f1_val': 0.7006247054585594, 'auprc': 0.976978856747799, 'loss_val': 0.6862939233094144, 'psi': 0.8111663659742552}-{'f1_val': 0.6961328013490677, 'auprc': 0.9835246086772852, 'loss_val': 0.7623154190725157, 'psi': 0.8110895242803547}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:59805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:59802
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.949)
[S7] not sending this round → trigger blocked (psi=0.670)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:59812
[S5] not sending this round → trigger blocked (psi=0.995)
[S14] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S17] sending update (kind=head size=1793 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=46 metric=0.8970 head_norm=1.672227
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.685965e-01
[S15] stored merged vector for next round verification (round=46)
[S15] DEBUG after merge:  round=46 metric=0.9005 head_norm=1.429271 delta_norm=0.568597
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=46 metric=0.9213 head_norm=1.992636
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.727665e-02
[S16] stored merged vector for next round verification (round=46)
[S16] DEBUG after merge:  round=46 metric=0.9215 head_norm=1.992560 delta_norm=0.027277
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] RECEIVED delta(kind=head bytes=1802) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.618385)
[S11] loaded HEAD from S14 (vec_in norm=1.618385)
[S11] cosine check vs S14: cos=0.9906
[S11] BUFFERED delta from S14 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1793) from S17
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.620280)
[S5] loaded HEAD from S17 (vec_in norm=1.620280)
[S5] cosine check vs S17: cos=0.9990
[S5] BUFFERED delta from S17 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1800) from S3
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=2.163604)
[S2] loaded HEAD from S3 (vec_in norm=2.163604)
[S2] cosine check vs S3: cos=0.9997
[S2] BUFFERED delta from S3 (total buffered=1)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=46 metric=0.9605 head_norm=2.163604
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.460535e-02
[S3] stored merged vector for next round verification (round=46)
[S3] DEBUG after merge:  round=46 metric=0.9608 head_norm=2.164807 delta_norm=0.024605
[S3] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=46 metric=0.7006 head_norm=1.620280
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.415514e-02
[S17] stored merged vector for next round verification (round=46)
[S17] DEBUG after merge:  round=46 metric=0.7020 head_norm=1.590945 delta_norm=0.044155
[S17] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=46 metric=0.9970 head_norm=1.618385
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.238446e-02
[S14] stored merged vector for next round verification (round=46)
[S14] DEBUG after merge:  round=46 metric=0.9970 head_norm=1.637373 delta_norm=0.062384
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=46 metric=0.9959 head_norm=1.572461
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.264184e-02
[S5] stored merged vector for next round verification (round=46)
[S5] DEBUG after merge:  round=46 metric=0.9959 head_norm=1.595980 delta_norm=0.042642
[S5] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=47 head_norm_before_train=2.175646 cos_to_last_merge=0.9998 (last merge round=43)
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.8261578939556098, 'auprc': 0.8917782312913154, 'loss_val': 0.43763505525088076, 'psi': 0.852406028889892}-{'f1_val': 0.8300320546217095, 'auprc': 0.9790593921384482, 'loss_val': 0.34109597229006566, 'psi': 0.889642989628405}
[S3] START round=47 head_norm_before_train=2.164807 cos_to_last_merge=1.0000 (last merge round=46)
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.9359093020477891, 'auprc': 0.9993517623142208, 'loss_val': 0.15372919212745198, 'psi': 0.9612862861543618}-{'f1_val': 0.9605438728991138, 'auprc': 0.9988317469935846, 'loss_val': 0.10095039606070878, 'psi': 0.9758590225369022}
[S4] START round=47 head_norm_before_train=2.001767 cos_to_last_merge=0.9997 (last merge round=43)
[S4] round=47 local utility u=0.004753 metrics={'f1_val': 0.946010109572665, 'auprc': 0.9593898207466626, 'loss_val': 0.2992878622848017, 'psi': 0.951361994042264}-{'f1_val': 0.9471277878777237, 'auprc': 0.9525158321860422, 'loss_val': 0.2948778366802441, 'psi': 0.949283005601051}
[S5] START round=47 head_norm_before_train=1.595980 cos_to_last_merge=1.0000 (last merge round=46)
[S5] round=47 local utility u=0.007857 metrics={'f1_val': 0.9960398919057053, 'auprc': 0.9974139973849326, 'loss_val': 0.0751327649448984, 'psi': 0.9965895340973963}-{'f1_val': 0.9958933237853395, 'auprc': 0.9948292198962467, 'loss_val': 0.08221276218018024, 'psi': 0.9954676822297024}
[S6] START round=47 head_norm_before_train=1.384997 cos_to_last_merge=0.9999 (last merge round=45)
[S6] round=47 local utility u=0.015843 metrics={'f1_val': 0.7840519327492868, 'auprc': 0.9528098507804994, 'loss_val': 0.5655008454411684, 'psi': 0.8515550999617718}-{'f1_val': 0.7774159716442773, 'auprc': 0.947778181518103, 'loss_val': 0.5422753770107055, 'psi': 0.8455608555938076}
[S7] START round=47 head_norm_before_train=1.347037 cos_to_last_merge=0.9986 (last merge round=41)
[S7] round=47 local utility u=0.373095 metrics={'f1_val': 0.6567539157731831, 'auprc': 0.8222656003310026, 'loss_val': 0.4178052195690227, 'psi': 0.7229585895963109}-{'f1_val': 0.5905127408422196, 'auprc': 0.7889039410601978, 'loss_val': 0.6664640444540045, 'psi': 0.6698692209294108}
[S8] START round=47 head_norm_before_train=2.214423 (no previous merge yet)
[S8] round=47 local utility u=0.547691 metrics={'f1_val': 0.9946562518404718, 'auprc': 0.9996013154853626, 'loss_val': 0.026378787090233613, 'psi': 0.996634277298428}-{'f1_val': 0.8532193546656379, 'auprc': 0.9958962820911548, 'loss_val': 0.26202356067173016, 'psi': 0.9102901256358447}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[S9] START round=47 head_norm_before_train=1.681627 cos_to_last_merge=0.9644 (last merge round=28)
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.9901917913342209, 'auprc': 0.999056011844065, 'loss_val': 0.04486483607104189, 'psi': 0.9937374795381585}-{'f1_val': 0.9967181314020974, 'auprc': 0.9986718628807629, 'loss_val': 0.02855127549165582, 'psi': 0.9974996239935636}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=47 head_norm_before_train=2.266064 (no previous merge yet)
[S10] round=47 local utility u=0.000181 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9945789889470024, 'loss_val': 0.031466665074831694, 'psi': 0.9938912204713445}-{'f1_val': 0.9934327081542391, 'auprc': 0.9945405503651124, 'loss_val': 0.03171366050213811, 'psi': 0.9938758450385885}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] sending update (kind=head size=1793 to 1 peers)
[S11] START round=47 head_norm_before_train=1.578991 cos_to_last_merge=0.9999 (last merge round=45)
[S11] round=47 local utility u=0.001643 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9953650683470989, 'loss_val': 0.044154089047793846, 'psi': 0.9958262322868252}-{'f1_val': 0.9961336749133093, 'auprc': 0.994532381842198, 'loss_val': 0.04494195725777947, 'psi': 0.9954931576848648}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=47 metric=0.9961 head_norm=1.597614
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.157304e-01
[S11] stored merged vector for next round verification (round=47)
[S11] DEBUG after merge:  round=47 metric=0.9961 head_norm=1.603863 delta_norm=0.115730
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S13] START round=47 head_norm_before_train=2.046159 (no previous merge yet)
[S13] round=47 local utility u=0.000000 metrics={'f1_val': 0.7343467904422489, 'auprc': 0.8024239065618325, 'loss_val': 0.8507589194463687, 'psi': 0.7615776368900824}-{'f1_val': 0.7419696795951145, 'auprc': 0.8057412086337179, 'loss_val': 0.8643053755722309, 'psi': 0.7674782912105558}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=47 head_norm_before_train=1.637373 cos_to_last_merge=1.0000 (last merge round=46)
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.996754531653698, 'auprc': 0.997892875188132, 'loss_val': 0.03633116361421532, 'psi': 0.9972098690674716}-{'f1_val': 0.9969975081576651, 'auprc': 0.9982579707562065, 'loss_val': 0.03488868443329476, 'psi': 0.9975016931970817}
[S15] START round=47 head_norm_before_train=1.429271 cos_to_last_merge=1.0000 (last merge round=46)
[S15] round=47 local utility u=0.285923 metrics={'f1_val': 0.9664397565641032, 'auprc': 0.9940714674604456, 'loss_val': 0.09249524015793663, 'psi': 0.9774924409226401}-{'f1_val': 0.8969963998270292, 'auprc': 0.9937899178754279, 'loss_val': 0.2468364717593063, 'psi': 0.9357138070463886}
[S16] START round=47 head_norm_before_train=1.992560 cos_to_last_merge=1.0000 (last merge round=46)
[S16] round=47 local utility u=0.000000 metrics={'f1_val': 0.8856556294446356, 'auprc': 0.9889784035496295, 'loss_val': 0.573625791189464, 'psi': 0.9269847390866331}-{'f1_val': 0.9212608332312984, 'auprc': 0.9945887642397424, 'loss_val': 0.4202878958676507, 'psi': 0.9505920056346759}
[S17] START round=47 head_norm_before_train=1.590945 cos_to_last_merge=1.0000 (last merge round=46)
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.6545480674104092, 'auprc': 0.9398719563526359, 'loss_val': 0.9053064127237148, 'psi': 0.7686776229872998}-{'f1_val': 0.7006247054585594, 'auprc': 0.976978856747799, 'loss_val': 0.6862939233094144, 'psi': 0.8111663659742552}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:59814
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:59816
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:59807
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S17@127.0.0.1:59817
[S7] sending update (kind=head size=1796 to 1 peers)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=47 metric=0.8262 head_norm=2.184246
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.530909e-02
[S2] stored merged vector for next round verification (round=47)
[S2] DEBUG after merge:  round=47 metric=0.8262 head_norm=2.173662 delta_norm=0.035309
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S4] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:59815
[S15] sending update (kind=head size=1803 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1796) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.361359)
[S6] loaded HEAD from S7 (vec_in norm=1.361359)
[S6] cosine check vs S7: cos=0.9961
[S6] BUFFERED delta from S7 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1803) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.455968)
[S14] loaded HEAD from S15 (vec_in norm=1.455968)
[S14] cosine check vs S15: cos=0.9454
[S14] BUFFERED delta from S15 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1799) from S4
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=2.008004)
[S16] loaded HEAD from S4 (vec_in norm=2.008004)
[S16] cosine check vs S4: cos=0.9996
[S16] BUFFERED delta from S4 (total buffered=1)
[S6] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1793 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1793) from S5
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.605269)
[S17] loaded HEAD from S5 (vec_in norm=1.605269)
[S17] cosine check vs S5: cos=0.9998
[S17] BUFFERED delta from S5 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1798) from S6
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.407891)
[S15] loaded HEAD from S6 (vec_in norm=1.407891)
[S15] cosine check vs S6: cos=0.9141
[S15] BUFFERED delta from S6 (total buffered=1)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=47 metric=0.7841 head_norm=1.407891
[S6] _apply_head_vector_avg (torch): Δ‖w‖=6.539499e-02
[S6] stored merged vector for next round verification (round=47)
[S6] DEBUG after merge:  round=47 metric=0.7865 head_norm=1.383275 delta_norm=0.065395
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=48 head_norm_before_train=2.173662 cos_to_last_merge=1.0000 (last merge round=47)
[S2] round=48 local utility u=0.000000 metrics={'f1_val': 0.8011435441999467, 'auprc': 0.8514165299884002, 'loss_val': 0.5813717936379185, 'psi': 0.8212527385153281}-{'f1_val': 0.8261578939556098, 'auprc': 0.8917782312913154, 'loss_val': 0.43763505525088076, 'psi': 0.852406028889892}
[S3] START round=48 head_norm_before_train=2.167188 cos_to_last_merge=1.0000 (last merge round=46)
[S3] round=48 local utility u=0.253207 metrics={'f1_val': 0.9978100342676263, 'auprc': 0.9995141485413919, 'loss_val': 0.0192059517069405, 'psi': 0.9984916799771325}-{'f1_val': 0.9359093020477891, 'auprc': 0.9993517623142208, 'loss_val': 0.15372919212745198, 'psi': 0.9612862861543618}
[S4] START round=48 head_norm_before_train=2.008004 cos_to_last_merge=0.9995 (last merge round=43)
[S4] round=48 local utility u=0.000000 metrics={'f1_val': 0.941355335792657, 'auprc': 0.9551781455710199, 'loss_val': 0.3089495361057361, 'psi': 0.946884459704002}-{'f1_val': 0.946010109572665, 'auprc': 0.9593898207466626, 'loss_val': 0.2992878622848017, 'psi': 0.951361994042264}
[S5] START round=48 head_norm_before_train=1.605269 cos_to_last_merge=1.0000 (last merge round=46)
[S5] round=48 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.991978883773754, 'loss_val': 0.07666291933461124, 'psi': 0.9945031674950882}-{'f1_val': 0.9960398919057053, 'auprc': 0.9974139973849326, 'loss_val': 0.0751327649448984, 'psi': 0.9965895340973963}
[S6] START round=48 head_norm_before_train=1.383275 cos_to_last_merge=1.0000 (last merge round=47)
[S6] round=48 local utility u=0.141550 metrics={'f1_val': 0.8229279132741215, 'auprc': 0.9374518263171263, 'loss_val': 0.46958274754630924, 'psi': 0.8687374784913234}-{'f1_val': 0.7840519327492868, 'auprc': 0.9528098507804994, 'loss_val': 0.5655008454411684, 'psi': 0.8515550999617718}
[S7] START round=48 head_norm_before_train=1.361359 cos_to_last_merge=0.9980 (last merge round=41)
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.4956069279170434, 'auprc': 0.7825462803941616, 'loss_val': 0.8651697278527033, 'psi': 0.6103826689078907}-{'f1_val': 0.6567539157731831, 'auprc': 0.8222656003310026, 'loss_val': 0.4178052195690227, 'psi': 0.7229585895963109}
[S8] START round=48 head_norm_before_train=2.217370 (no previous merge yet)
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.9939009886418481, 'auprc': 0.9926205244737405, 'loss_val': 0.03395245183950484, 'psi': 0.993388802974605}-{'f1_val': 0.9946562518404718, 'auprc': 0.9996013154853626, 'loss_val': 0.026378787090233613, 'psi': 0.996634277298428}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=48 head_norm_before_train=1.690456 cos_to_last_merge=0.9635 (last merge round=28)
[S9] round=48 local utility u=0.024944 metrics={'f1_val': 0.9972945621169176, 'auprc': 0.9954775945108442, 'loss_val': 0.026857537921705005, 'psi': 0.9965677750744881}-{'f1_val': 0.9901917913342209, 'auprc': 0.999056011844065, 'loss_val': 0.04486483607104189, 'psi': 0.9937374795381585}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=48 head_norm_before_train=2.272220 (no previous merge yet)
[S10] round=48 local utility u=0.000000 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9943221508410462, 'loss_val': 0.030986049154775396, 'psi': 0.993788485228962}-{'f1_val': 0.9934327081542391, 'auprc': 0.9945789889470024, 'loss_val': 0.031466665074831694, 'psi': 0.9938912204713445}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=48 head_norm_before_train=1.603863 cos_to_last_merge=1.0000 (last merge round=47)
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9951901137369586, 'loss_val': 0.05456240760517056, 'psi': 0.995756250442769}-{'f1_val': 0.9961336749133093, 'auprc': 0.9953650683470989, 'loss_val': 0.044154089047793846, 'psi': 0.9958262322868252}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=48 head_norm_before_train=2.053106 (no previous merge yet)
[S13] round=48 local utility u=0.000000 metrics={'f1_val': 0.6708671345836812, 'auprc': 0.8095994764018893, 'loss_val': 0.8022541171021135, 'psi': 0.7263600713109644}-{'f1_val': 0.7343467904422489, 'auprc': 0.8024239065618325, 'loss_val': 0.8507589194463687, 'psi': 0.7615776368900824}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=48 head_norm_before_train=1.648175 cos_to_last_merge=1.0000 (last merge round=46)
[S14] round=48 local utility u=0.002373 metrics={'f1_val': 0.9967774409524363, 'auprc': 0.998231630237788, 'loss_val': 0.03273925236849483, 'psi': 0.997359116666577}-{'f1_val': 0.996754531653698, 'auprc': 0.997892875188132, 'loss_val': 0.03633116361421532, 'psi': 0.9972098690674716}
[S15] START round=48 head_norm_before_train=1.455968 cos_to_last_merge=0.9998 (last merge round=46)
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.9286813888882448, 'auprc': 0.9943965132178335, 'loss_val': 0.13373436493694615, 'psi': 0.9549674386200804}-{'f1_val': 0.9664397565641032, 'auprc': 0.9940714674604456, 'loss_val': 0.09249524015793663, 'psi': 0.9774924409226401}
[S16] START round=48 head_norm_before_train=1.999270 cos_to_last_merge=1.0000 (last merge round=46)
[S16] round=48 local utility u=0.597104 metrics={'f1_val': 0.9927118271958891, 'auprc': 0.9938587334837372, 'loss_val': 0.03639633207619634, 'psi': 0.9931705897110283}-{'f1_val': 0.8856556294446356, 'auprc': 0.9889784035496295, 'loss_val': 0.573625791189464, 'psi': 0.9269847390866331}
[S17] START round=48 head_norm_before_train=1.621492 cos_to_last_merge=0.9999 (last merge round=46)
[S17] round=48 local utility u=0.304982 metrics={'f1_val': 0.7028818554595757, 'auprc': 0.9860685700810747, 'loss_val': 0.7239348923426803, 'psi': 0.8161565413081753}-{'f1_val': 0.6545480674104092, 'auprc': 0.9398719563526359, 'loss_val': 0.9053064127237148, 'psi': 0.7686776229872998}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:59804
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:59812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:59805
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:59802
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1797 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1800 to 1 peers)
[S6] not sending this round → trigger blocked (psi=0.869)
[S14] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=48 metric=0.9287 head_norm=1.491979
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.128010e-01
[S15] stored merged vector for next round verification (round=48)
[S15] DEBUG after merge:  round=48 metric=0.9302 head_norm=1.416416 delta_norm=0.312801
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] RECEIVED delta(kind=head bytes=1802) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=2.007949)
[S4] loaded HEAD from S16 (vec_in norm=2.007949)
[S4] cosine check vs S16: cos=0.9994
[S4] BUFFERED delta from S16 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1797) from S3
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=2.170993)
[S2] loaded HEAD from S3 (vec_in norm=2.170993)
[S2] cosine check vs S3: cos=0.9998
[S2] BUFFERED delta from S3 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1800) from S17
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.651567)
[S5] loaded HEAD from S17 (vec_in norm=1.651567)
[S5] cosine check vs S17: cos=0.9993
[S5] BUFFERED delta from S17 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1802) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.660169)
[S11] loaded HEAD from S14 (vec_in norm=1.660169)
[S11] cosine check vs S14: cos=0.9944
[S11] BUFFERED delta from S14 (total buffered=1)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=48 metric=0.9927 head_norm=2.007949
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.056214e-02
[S16] stored merged vector for next round verification (round=48)
[S16] DEBUG after merge:  round=48 metric=0.9927 head_norm=2.007744 delta_norm=0.030562
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=48 metric=0.9968 head_norm=1.660169
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.773060e-01
[S14] stored merged vector for next round verification (round=48)
[S14] DEBUG after merge:  round=48 metric=0.9968 head_norm=1.536588 delta_norm=0.277306
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=48 metric=0.7029 head_norm=1.651567
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.592093e-02
[S17] stored merged vector for next round verification (round=48)
[S17] DEBUG after merge:  round=48 metric=0.7026 head_norm=1.628186 delta_norm=0.035921
[S17] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=48 metric=0.9962 head_norm=1.614657
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.580451e-02
[S5] stored merged vector for next round verification (round=48)
[S5] DEBUG after merge:  round=48 metric=0.9962 head_norm=1.632824 delta_norm=0.035805
[S5] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=49 head_norm_before_train=2.182488 cos_to_last_merge=1.0000 (last merge round=47)
[S2] round=49 local utility u=0.336986 metrics={'f1_val': 0.8272370911925324, 'auprc': 0.9609383605106699, 'loss_val': 0.3925265846563461, 'psi': 0.8807175989197874}-{'f1_val': 0.8011435441999467, 'auprc': 0.8514165299884002, 'loss_val': 0.5813717936379185, 'psi': 0.8212527385153281}
[S3] START round=49 head_norm_before_train=2.170993 cos_to_last_merge=0.9999 (last merge round=46)
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.9977968513829619, 'auprc': 0.9991409918455596, 'loss_val': 0.03229555460315581, 'psi': 0.998334507568001}-{'f1_val': 0.9978100342676263, 'auprc': 0.9995141485413919, 'loss_val': 0.0192059517069405, 'psi': 0.9984916799771325}
[S4] START round=49 head_norm_before_train=2.015361 cos_to_last_merge=0.9993 (last merge round=43)
[S4] round=49 local utility u=0.027120 metrics={'f1_val': 0.947743118693198, 'auprc': 0.9579625902302163, 'loss_val': 0.3013890477180908, 'psi': 0.9518309073080053}-{'f1_val': 0.941355335792657, 'auprc': 0.9551781455710199, 'loss_val': 0.3089495361057361, 'psi': 0.946884459704002}
[S5] START round=49 head_norm_before_train=1.632824 cos_to_last_merge=1.0000 (last merge round=48)
[S5] round=49 local utility u=0.007570 metrics={'f1_val': 0.996186023309311, 'auprc': 0.993893283499248, 'loss_val': 0.06726661666776616, 'psi': 0.9952689273852858}-{'f1_val': 0.996186023309311, 'auprc': 0.991978883773754, 'loss_val': 0.07666291933461124, 'psi': 0.9945031674950882}
[S6] START round=49 head_norm_before_train=1.405789 cos_to_last_merge=0.9999 (last merge round=47)
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.6126394415069029, 'auprc': 0.9078354945201198, 'loss_val': 0.7390322965116165, 'psi': 0.7307178627121896}-{'f1_val': 0.8229279132741215, 'auprc': 0.9374518263171263, 'loss_val': 0.46958274754630924, 'psi': 0.8687374784913234}
[S7] START round=49 head_norm_before_train=1.374687 cos_to_last_merge=0.9974 (last merge round=41)
[S7] round=49 local utility u=0.322986 metrics={'f1_val': 0.5720777101236703, 'auprc': 0.7893552048960527, 'loss_val': 0.698449728807549, 'psi': 0.6589887080326233}-{'f1_val': 0.4956069279170434, 'auprc': 0.7825462803941616, 'loss_val': 0.8651697278527033, 'psi': 0.6103826689078907}
[S8] START round=49 head_norm_before_train=2.227851 (no previous merge yet)
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.9870853986449891, 'auprc': 0.9960556499074762, 'loss_val': 0.03993469470741672, 'psi': 0.9906734991499839}-{'f1_val': 0.9939009886418481, 'auprc': 0.9926205244737405, 'loss_val': 0.03395245183950484, 'psi': 0.993388802974605}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=49 head_norm_before_train=1.698344 cos_to_last_merge=0.9628 (last merge round=28)
[S9] round=49 local utility u=0.000000 metrics={'f1_val': 0.9971344652643916, 'auprc': 0.9951026058431875, 'loss_val': 0.026985717692341028, 'psi': 0.9963217214959099}-{'f1_val': 0.9972945621169176, 'auprc': 0.9954775945108442, 'loss_val': 0.026857537921705005, 'psi': 0.9965677750744881}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=49 head_norm_before_train=2.281599 (no previous merge yet)
[S10] round=49 local utility u=0.000352 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9946036260534102, 'loss_val': 0.031125792660544816, 'psi': 0.9939010753139076}-{'f1_val': 0.9934327081542391, 'auprc': 0.9943221508410462, 'loss_val': 0.030986049154775396, 'psi': 0.993788485228962}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=49 head_norm_before_train=1.620263 cos_to_last_merge=0.9999 (last merge round=47)
[S11] round=49 local utility u=0.003751 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9950790433622748, 'loss_val': 0.04672676125764063, 'psi': 0.9957118222928956}-{'f1_val': 0.9961336749133093, 'auprc': 0.9951901137369586, 'loss_val': 0.05456240760517056, 'psi': 0.995756250442769}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=49 metric=0.9961 head_norm=1.635751
[S11] _apply_head_vector_avg (torch): Δ‖w‖=9.260263e-02
[S11] stored merged vector for next round verification (round=49)
[S11] DEBUG after merge:  round=49 metric=0.9961 head_norm=1.645401 delta_norm=0.092603
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S13] START round=49 head_norm_before_train=2.056400 (no previous merge yet)
[S13] round=49 local utility u=0.019543 metrics={'f1_val': 0.7334229315078822, 'auprc': 0.7754756023177982, 'loss_val': 1.0361313982280589, 'psi': 0.7502439998318486}-{'f1_val': 0.6708671345836812, 'auprc': 0.8095994764018893, 'loss_val': 0.8022541171021135, 'psi': 0.7263600713109644}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S13] sending update (kind=head size=1791 to 1 peers)
[S14] START round=49 head_norm_before_train=1.536588 cos_to_last_merge=1.0000 (last merge round=48)
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.9967774409524363, 'auprc': 0.998636930554224, 'loss_val': 0.04258807461071847, 'psi': 0.9975212367931514}-{'f1_val': 0.9967774409524363, 'auprc': 0.998231630237788, 'loss_val': 0.03273925236849483, 'psi': 0.997359116666577}
[S15] START round=49 head_norm_before_train=1.416416 cos_to_last_merge=1.0000 (last merge round=48)
[S15] round=49 local utility u=0.000000 metrics={'f1_val': 0.9027624067881995, 'auprc': 0.9923544473716603, 'loss_val': 0.22525871572199943, 'psi': 0.9385992230215838}-{'f1_val': 0.9286813888882448, 'auprc': 0.9943965132178335, 'loss_val': 0.13373436493694615, 'psi': 0.9549674386200804}
[S16] START round=49 head_norm_before_train=2.007744 cos_to_last_merge=1.0000 (last merge round=48)
[S16] round=49 local utility u=0.000000 metrics={'f1_val': 0.9831516354167893, 'auprc': 0.9957036494587328, 'loss_val': 0.0832549037243546, 'psi': 0.9881724410335667}-{'f1_val': 0.9927118271958891, 'auprc': 0.9938587334837372, 'loss_val': 0.03639633207619634, 'psi': 0.9931705897110283}
[S17] START round=49 head_norm_before_train=1.628186 cos_to_last_merge=1.0000 (last merge round=48)
[S17] round=49 local utility u=0.453114 metrics={'f1_val': 0.821408033156708, 'auprc': 0.964117049529625, 'loss_val': 0.46300876849941475, 'psi': 0.8784916397058747}-{'f1_val': 0.7028818554595757, 'auprc': 0.9860685700810747, 'loss_val': 0.7239348923426803, 'psi': 0.8161565413081753}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:59816
[S17] not sending this round → trigger blocked (psi=0.878)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:59807
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:59803
[S7] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:59817
[S2] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] RECEIVED delta(kind=head bytes=1798) from S4
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=2.026345)
[S16] loaded HEAD from S4 (vec_in norm=2.026345)
[S16] cosine check vs S4: cos=0.9996
[S16] BUFFERED delta from S4 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1795) from S2
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=2.194217)
[S3] loaded HEAD from S2 (vec_in norm=2.194217)
[S3] cosine check vs S2: cos=0.9997
[S3] BUFFERED delta from S2 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1798) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.391123)
[S6] loaded HEAD from S7 (vec_in norm=1.391123)
[S6] cosine check vs S7: cos=0.9960
[S6] BUFFERED delta from S7 (total buffered=1)
[S5] sending update (kind=head size=1799 to 1 peers)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=49 metric=0.9477 head_norm=2.026345
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.197913e-02
[S4] stored merged vector for next round verification (round=49)
[S4] DEBUG after merge:  round=49 metric=0.9477 head_norm=2.016731 delta_norm=0.041979
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=49 metric=0.8272 head_norm=2.194217
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.685926e-02
[S2] stored merged vector for next round verification (round=49)
[S2] DEBUG after merge:  round=49 metric=0.8270 head_norm=2.182471 delta_norm=0.026859
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S17] RECEIVED delta(kind=head bytes=1799) from S5
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.643032)
[S17] loaded HEAD from S5 (vec_in norm=1.643032)
[S17] cosine check vs S5: cos=0.9998
[S17] BUFFERED delta from S5 (total buffered=1)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=49 metric=0.6126 head_norm=1.427905
[S6] _apply_head_vector_avg (torch): Δ‖w‖=6.561148e-02
[S6] stored merged vector for next round verification (round=49)
[S6] DEBUG after merge:  round=49 metric=0.6240 head_norm=1.408106 delta_norm=0.065611
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[runner] rounds complete.
[runner] all agents stopped.
