[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:44603
[S3] → join 127.0.0.1:44602
[S4] → join 127.0.0.1:44602
[S5] → join 127.0.0.1:44602
[S6] → join 127.0.0.1:44602
[S7] → join 127.0.0.1:44602
[S8] → join 127.0.0.1:44602
[S9] → join 127.0.0.1:44602
[S10] → join 127.0.0.1:44602
[S11] → join 127.0.0.1:44602
[S13] → join 127.0.0.1:44602
[S14] → join 127.0.0.1:44602
[S15] → join 127.0.0.1:44602
[S16] → join 127.0.0.1:44602
[S17] → join 127.0.0.1:44602
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.190591 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.075512 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.192574 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.243410 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.151102 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.182898 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.194302 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.152033 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.140255 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.140580 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.147628 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.209405 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.133674 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.136559 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.207496 (no previous merge yet)
[S7]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S4] + discovered S2
[S3] + discovered S7
[S3] + discovered S16
[S3] + discovered S5
[S3] + discovered S11
[S3] + discovered S4
[S3] + discovered S6
[S3] + discovered S14
[S3] + discovered S10
[S3] + discovered S15
[S3] + discovered S9
[S3] + discovered S13
[S3] + discovered S8
[S3] + discovered S17
[S4] + discovered S3
[S4] + discovered S5
[S4] + discovered S7
[S4] + discovered S16
[S4] + discovered S11
[S4] + discovered S6
[S4] + discovered S14
[S4] + discovered S10
[S4] + discovered S15
[S4] + discovered S8
[S4] + discovered S9
[S4] + discovered S13
[S4] + discovered S17
[S5] + discovered S4
[S5] + discovered S3
[S5] + discovered S2
[S5] + discovered S17
[S5] + discovered S13
[S5] + discovered S8
[S5] + discovered S9
[S5] + discovered S10
[S5] + discovered S14
[S5] + discovered S16
[S5] + discovered S11
[S5] + discovered S15
[S5] + discovered S6
[S5] + discovered S7
[S6] + discovered S2
[S6] + discovered S3
[S6] + discovered S4
[S6] + discovered S5
[S7] + discovered S4
[S7] + discovered S6
[S6] + discovered S15
[S6] + discovered S11
[S6] + discovered S16
[S6] + discovered S8
[S6] + discovered S13
[S6] + discovered S9
[S6] + discovered S17
[S6] + discovered S7
[S7] + discovered S2
[S6] + discovered S10
[S6] + discovered S14
[S7] + discovered S3
[S7] + discovered S5
[S7] + discovered S9
[S8] + discovered S4
[S7] + discovered S11
[S8] + discovered S7
[S7] + discovered S17
[S7] + discovered S10
[S7] + discovered S16
[S7] + discovered S15
[S8] + discovered S6
[S7] + discovered S8
[S8] + discovered S5
[S8] + discovered S2
[S7] + discovered S14
[S8] + discovered S3
[S7] + discovered S13
[S9] + discovered S8
[S9] + discovered S5
[S9] + discovered S7
[S9] + discovered S4
[S9] + discovered S3
[S8] + discovered S17
[S8] + discovered S11
[S9] + discovered S2
[S9] + discovered S6
[S8] + discovered S10
[S8] + discovered S13
[S8] + discovered S9
[S8] + discovered S16
[S8] + discovered S14
[S8] + discovered S15
[S10] + discovered S6
[S10] + discovered S2
[S10] + discovered S8
[S10] + discovered S5
[S10] + discovered S9
[S10] + discovered S7
[S10] + discovered S4
[S10] + discovered S3
[S9] + discovered S10
[S9] + discovered S11
[S9] + discovered S13
[S9] + discovered S17
[S9] + discovered S16
[S9] + discovered S15
[S9] + discovered S14
[S11] + discovered S3
[S11] + discovered S7
[S11] + discovered S9
[S11] + discovered S5
[S11] + discovered S8
[S11] + discovered S10
[S11] + discovered S6
[S10] + discovered S15
[S10] + discovered S11
[S10] + discovered S14
[S10] + discovered S16
[S10] + discovered S17
[S11] + discovered S2
[S10] + discovered S13
[S11] + discovered S4
[S11] + discovered S16
[S11] + discovered S13
[S11] + discovered S14
[S11] + discovered S17
[S11] + discovered S15
[S13] + discovered S11
[S13] + discovered S6
[S13] + discovered S2
[S13] + discovered S3
[S13] + discovered S4
[S13] + discovered S9
[S13] + discovered S7
[S13] + discovered S8
[S13] + discovered S5
[S13] + discovered S10
[S14] + discovered S2
[S14] + discovered S13
[S14] + discovered S6
[S14] + discovered S11
[S14] + discovered S3
[S14] + discovered S9
[S14] + discovered S4
[S14] + discovered S10
[S13] + discovered S15
[S14] + discovered S7
[S14] + discovered S8
[S14] + discovered S5
[S13] + discovered S17
[S13] + discovered S16
[S13] + discovered S14
[S14] + discovered S17
[S15] + discovered S2
[S15] + discovered S14
[S15] + discovered S3
[S15] + discovered S10
[S15] + discovered S8
[S15] + discovered S5
[S15] + discovered S7
[S15] + discovered S9
[S15] + discovered S4
[S14] + discovered S16
[S15] + discovered S13
[S15] + discovered S6
[S15] + discovered S11
[S14] + discovered S15
[S15] + discovered S16
[S16] + discovered S11
[S16] + discovered S2
[S16] + discovered S4
[S16] + discovered S9
[S16] + discovered S5
[S16] + discovered S8
[S16] + discovered S6
[S16] + discovered S10
[S16] + discovered S13
[S16] + discovered S7
[S16] + discovered S3
[S16] + discovered S14
[S16] + discovered S15
[S15] + discovered S17
[S17] + discovered S8
[S17] + discovered S16
[S17] + discovered S7
[S17] + discovered S14
[S17] + discovered S13
[S17] + discovered S10
[S17] + discovered S9
[S17] + discovered S5
[S17] + discovered S6
[S17] + discovered S4
[S17] + discovered S11
[S17] + discovered S2
[S17] + discovered S15
[S16] + discovered S17
[S17] + discovered S3
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] ⇄ pheromone p=1.000 → S14@127.0.0.1:44614
[S11] ⇄ pheromone p=1.000 → S16@127.0.0.1:44616
[S6] ⇄ pheromone p=1.000 → S4@127.0.0.1:44604
[S4] ⇄ pheromone p=1.000 → S5@127.0.0.1:44605
[S7] ⇄ pheromone p=1.000 → S16@127.0.0.1:44616
[S8] ⇄ pheromone p=1.000 → S4@127.0.0.1:44604
[S15] ⇄ pheromone p=1.000 → S8@127.0.0.1:44609
[S2] ⇄ pheromone p=1.000 → S16@127.0.0.1:44616
[S10] ⇄ pheromone p=1.000 → S9@127.0.0.1:44610
[S5] ⇄ pheromone p=1.000 → S9@127.0.0.1:44610
[S14] ⇄ pheromone p=1.000 → S15@127.0.0.1:44615
[S16] ⇄ pheromone p=1.000 → S15@127.0.0.1:44615
[S3] ⇄ pheromone p=1.000 → S14@127.0.0.1:44614
[S13] ⇄ pheromone p=1.000 → S14@127.0.0.1:44614
[S17] ⇄ pheromone p=1.000 → S16@127.0.0.1:44616
[S2] START round=1 head_norm_before_train=1.187849 (no previous merge yet)
[S2] round=1 local utility u=0.137362 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7956077097855646, 'loss_val': 1.3126656498803855, 'psi': 0.4033093639473659}-{'f1_val': 0.1417771333885667, 'auprc': 0.7148679630676752, 'loss_val': 1.3451712888438594, 'psi': 0.3710134652602101}
[S3] START round=1 head_norm_before_train=1.086670 (no previous merge yet)
[S3] round=1 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8918849381776892, 'loss_val': 1.321634186551481, 'psi': 0.4406580146395399}-{'f1_val': 0.3963275517403211, 'auprc': 0.8237754197059082, 'loss_val': 1.3528089733962656, 'psi': 0.5673066989265559}
[S4] START round=1 head_norm_before_train=1.197769 (no previous merge yet)
[S4] round=1 local utility u=0.083922 metrics={'f1_val': 0.11108647450110865, 'auprc': 0.7669973858115245, 'loss_val': 1.3405474663314332, 'psi': 0.37345083902527504}-{'f1_val': 0.10637591321673677, 'auprc': 0.7337796159979351, 'loss_val': 1.3804739004068176, 'psi': 0.3573373943292161}
[S5] START round=1 head_norm_before_train=1.243289 (no previous merge yet)
[S5] round=1 local utility u=0.424845 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7313162460557506, 'loss_val': 1.3025932364313078, 'psi': 0.3778836412794431}-{'f1_val': 0.14226190476190476, 'auprc': 0.45914742589050284, 'loss_val': 1.3357769576657765, 'psi': 0.269016113213344}
[S6] START round=1 head_norm_before_train=1.153016 (no previous merge yet)
[S6] round=1 local utility u=0.379025 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8694880270692202, 'loss_val': 1.3408655679908172, 'psi': 0.4326509800584573}-{'f1_val': 0.08954368264159597, 'auprc': 0.7355987505726502, 'loss_val': 1.3859530342111297, 'psi': 0.34796570981401764}
[S7] START round=1 head_norm_before_train=1.181825 (no previous merge yet)
[S7] round=1 local utility u=0.678983 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.773472073710288, 'loss_val': 1.3231181113853339, 'psi': 0.3946229231215702}-{'f1_val': 0.10429108604291086, 'auprc': 0.405633797295609, 'loss_val': 1.3509757951729318, 'psi': 0.22482817054399012}
[S8] START round=1 head_norm_before_train=1.190661 (no previous merge yet)
[S8] round=1 local utility u=1.000000 metrics={'f1_val': 0.3730767263257798, 'auprc': 0.7353820448862242, 'loss_val': 1.336883862310574, 'psi': 0.5179988537499576}-{'f1_val': 0.09148694665153236, 'auprc': 0.6153290441669426, 'loss_val': 1.3728995363616316, 'psi': 0.30102378565769644}
[S9] START round=1 head_norm_before_train=1.157860 (no previous merge yet)
[S9] round=1 local utility u=0.053323 metrics={'f1_val': 0.141397957139996, 'auprc': 0.6199965782543085, 'loss_val': 1.2939721461291733, 'psi': 0.332837405585721}-{'f1_val': 0.141397957139996, 'auprc': 0.5986869185778068, 'loss_val': 1.336689029414991, 'psi': 0.32431354171512033}
[S10] START round=1 head_norm_before_train=1.150185 (no previous merge yet)
[S10] round=1 local utility u=0.000000 metrics={'f1_val': 0.18666759246719722, 'auprc': 0.7706693193845703, 'loss_val': 1.3064433522940753, 'psi': 0.4202682832341465}-{'f1_val': 0.39659460544102737, 'auprc': 0.7656578293008849, 'loss_val': 1.335794919653367, 'psi': 0.5442198949849704}
[S11] START round=1 head_norm_before_train=1.145907 (no previous merge yet)
[S11] round=1 local utility u=0.159949 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.521755353557339, 'loss_val': 1.313834607164528, 'psi': 0.292950351446802}-{'f1_val': 0.14041368337311058, 'auprc': 0.42492865124551854, 'loss_val': 1.343253428317492, 'psi': 0.2542196705220738}
[S13] START round=1 head_norm_before_train=1.150391 (no previous merge yet)
[S13] round=1 local utility u=0.969430 metrics={'f1_val': 0.41628028861516686, 'auprc': 0.6054391753094039, 'loss_val': 1.3312254536920245, 'psi': 0.49194384329286167}-{'f1_val': 0.09261838440111421, 'auprc': 0.6178192364223654, 'loss_val': 1.3652542840641295, 'psi': 0.30269872520961466}
[S14] START round=1 head_norm_before_train=1.219755 (no previous merge yet)
[S14] round=1 local utility u=0.468329 metrics={'f1_val': 0.38626484403791306, 'auprc': 0.5026511910605431, 'loss_val': 1.3386285938534785, 'psi': 0.4328193828469651}-{'f1_val': 0.3351282657025822, 'auprc': 0.3010778998751885, 'loss_val': 1.3637465165404303, 'psi': 0.3215081193716247}
[S15] START round=1 head_norm_before_train=1.138818 (no previous merge yet)
[S15] round=1 local utility u=0.024254 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7908792909541575, 'loss_val': 1.3089826828733528, 'psi': 0.40019190719859804}-{'f1_val': 0.13973365136155833, 'auprc': 0.7835326653439381, 'loss_val': 1.3354505719557739, 'psi': 0.39725325695451025}
[S16] START round=1 head_norm_before_train=1.142296 (no previous merge yet)
[S16] round=1 local utility u=0.082947 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7040089986433472, 'loss_val': 1.333490339897164, 'psi': 0.36598606957686075}-{'f1_val': 0.14063745019920318, 'auprc': 0.6603014743579537, 'loss_val': 1.3682624576050237, 'psi': 0.34850305986270336}
[S17] START round=1 head_norm_before_train=1.217265 (no previous merge yet)
[S17] round=1 local utility u=0.226917 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.54238152078169, 'loss_val': 1.3101363294789812, 'psi': 0.30152198630310667}-{'f1_val': 0.14094896331738438, 'auprc': 0.39933107501289233, 'loss_val': 1.334818848350956, 'psi': 0.24430180799558757}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:44604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1779 reason=None
[S2] → sending delta(kind=head bytes=1779) to S5@127.0.0.1:44605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S7] → sending delta(kind=head bytes=1790) to S5@127.0.0.1:44605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S8] → sending delta(kind=head bytes=1788) to S11@127.0.0.1:44612
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:44617
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S5] → sending delta(kind=head bytes=1791) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S9] → sending delta(kind=head bytes=1788) to S8@127.0.0.1:44609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S6] → sending delta(kind=head bytes=1791) to S8@127.0.0.1:44609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:44608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:44610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S14] → sending delta(kind=head bytes=1786) to S7@127.0.0.1:44608
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S16] → sending delta(kind=head bytes=1788) to S17@127.0.0.1:44617
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1788 to 1 peers)
[S14] sending update (kind=head size=1786 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1791 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1788 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1791 to 1 peers)
[S8] sending update (kind=head size=1788 to 1 peers)
[S7] sending update (kind=head size=1790 to 1 peers)
[S2] sending update (kind=head size=1779 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1788) from S8
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.197346)
[S11] loaded HEAD from S8 (vec_in norm=1.197346)
[S11] cosine check vs S8: cos=-0.1009
[S11] DROPPED delta from S8 (cos=-0.1009 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1794) from S11
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.162300)
[S4] loaded HEAD from S11 (vec_in norm=1.162300)
[S4] cosine check vs S11: cos=-0.0422
[S4] DROPPED delta from S11 (cos=-0.0422 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1788) from S16
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.158031)
[S17] loaded HEAD from S16 (vec_in norm=1.158031)
[S17] cosine check vs S16: cos=0.0899
[S17] BUFFERED delta from S16 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1795) from S4
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.213315)
[S9] loaded HEAD from S4 (vec_in norm=1.213315)
[S9] cosine check vs S4: cos=0.0889
[S9] BUFFERED delta from S4 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1801) from S15
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.154214)
[S17] loaded HEAD from S15 (vec_in norm=1.154214)
[S17] cosine check vs S15: cos=0.1128
[S17] BUFFERED delta from S15 (total buffered=2)
[S8] RECEIVED delta(kind=head bytes=1791) from S6
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.168028)
[S8] loaded HEAD from S6 (vec_in norm=1.168028)
[S8] cosine check vs S6: cos=-0.0642
[S8] DROPPED delta from S6 (cos=-0.0642 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1791) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.253767)
[S16] loaded HEAD from S5 (vec_in norm=1.253767)
[S16] cosine check vs S5: cos=-0.0068
[S16] DROPPED delta from S5 (cos=-0.0068 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1790) from S7
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.190583)
[S5] loaded HEAD from S7 (vec_in norm=1.190583)
[S5] cosine check vs S7: cos=0.1135
[S5] BUFFERED delta from S7 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1786) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.234770)
[S7] loaded HEAD from S14 (vec_in norm=1.234770)
[S7] cosine check vs S14: cos=0.0090
[S7] BUFFERED delta from S14 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1779) from S2
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.196247)
[S5] loaded HEAD from S2 (vec_in norm=1.196247)
[S5] cosine check vs S2: cos=0.0560
[S5] BUFFERED delta from S2 (total buffered=2)
[S7] RECEIVED delta(kind=head bytes=1799) from S13
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.162301)
[S7] loaded HEAD from S13 (vec_in norm=1.162301)
[S7] cosine check vs S13: cos=-0.0540
[S7] DROPPED delta from S13 (cos=-0.0540 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1788) from S9
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.174242)
[S8] loaded HEAD from S9 (vec_in norm=1.174242)
[S8] cosine check vs S9: cos=0.0995
[S8] BUFFERED delta from S9 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S17] → sending delta(kind=head bytes=1787) to S15@127.0.0.1:44615
[S17] sending update (kind=head size=1787 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1787) from S17
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.234605)
[S15] loaded HEAD from S17 (vec_in norm=1.234605)
[S15] cosine check vs S17: cos=0.1128
[S15] BUFFERED delta from S17 (total buffered=1)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=1 metric=0.1397 head_norm=1.154214
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.960916e-01
[S15] stored merged vector for next round verification (round=1)
[S15] DEBUG after merge:  round=1 metric=0.1397 head_norm=0.891329 delta_norm=0.796092
[S15] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=1 metric=0.1421 head_norm=1.190583
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.537835e-01
[S7] stored merged vector for next round verification (round=1)
[S7] DEBUG after merge:  round=1 metric=0.1421 head_norm=0.861467 delta_norm=0.853783
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=1 metric=0.1414 head_norm=1.174242
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.058804e-01
[S9] stored merged vector for next round verification (round=1)
[S9] DEBUG after merge:  round=1 metric=0.4013 head_norm=0.880935 delta_norm=0.805880
[S9] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=1 metric=0.3731 head_norm=1.197346
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.957218e-01
[S8] stored merged vector for next round verification (round=1)
[S8] DEBUG after merge:  round=1 metric=0.1400 head_norm=0.879243 delta_norm=0.795722
[S8] aggregate: ROLLBACK (f1_val pre=0.373 post=0.140 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=1 metric=0.1423 head_norm=1.253767
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.003655e-01
[S5] stored merged vector for next round verification (round=1)
[S5] DEBUG after merge:  round=1 metric=0.1423 head_norm=0.785665 delta_norm=0.700365
[S5] aggregate: ACCEPT kept=['S7', 'S2'] (k=2/2) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=1 metric=0.1409 head_norm=1.234605
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.802343e-01
[S17] stored merged vector for next round verification (round=1)
[S17] DEBUG after merge:  round=1 metric=0.1409 head_norm=0.779316 delta_norm=0.680234
[S17] aggregate: ACCEPT kept=['S16', 'S15'] (k=2/2) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=1.196247 (no previous merge yet)
[S2] round=2 local utility u=0.012709 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7918223976763797, 'loss_val': 1.275892418213357, 'psi': 0.40179523910369197}-{'f1_val': 0.1417771333885667, 'auprc': 0.7956077097855646, 'loss_val': 1.3126656498803855, 'psi': 0.4033093639473659}
[S3] START round=2 head_norm_before_train=1.105678 (no previous merge yet)
[S3] round=2 local utility u=0.030813 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.89924491978386, 'loss_val': 1.282088689407174, 'psi': 0.44360200728200827}-{'f1_val': 0.13984006561410703, 'auprc': 0.8918849381776892, 'loss_val': 1.321634186551481, 'psi': 0.4406580146395399}
[S4] START round=2 head_norm_before_train=1.213315 (no previous merge yet)
[S4] round=2 local utility u=0.902744 metrics={'f1_val': 0.40112302651176646, 'auprc': 0.7722614514006034, 'loss_val': 1.2910708657453123, 'psi': 0.5495783964673012}-{'f1_val': 0.11108647450110865, 'auprc': 0.7669973858115245, 'loss_val': 1.3405474663314332, 'psi': 0.37345083902527504}
[S5] START round=2 head_norm_before_train=0.785665 cos_to_last_merge=1.0000 (last merge round=1)
[S5] round=2 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.6247166033327106, 'loss_val': 1.3025331186943092, 'psi': 0.3352437841902271}-{'f1_val': 0.14226190476190476, 'auprc': 0.7313162460557506, 'loss_val': 1.3025932364313078, 'psi': 0.3778836412794431}
[S6] START round=2 head_norm_before_train=1.168028 (no previous merge yet)
[S6] round=2 local utility u=0.024222 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8707195557595392, 'loss_val': 1.2961156196077732, 'psi': 0.4331435915345849}-{'f1_val': 0.14142628205128205, 'auprc': 0.8694880270692202, 'loss_val': 1.3408655679908172, 'psi': 0.4326509800584573}
[S7] START round=2 head_norm_before_train=0.861467 cos_to_last_merge=1.0000 (last merge round=1)
[S7] round=2 local utility u=0.021097 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7885105020997186, 'loss_val': 1.3260400540116455, 'psi': 0.40063829447734245}-{'f1_val': 0.14205682272909165, 'auprc': 0.773472073710288, 'loss_val': 1.3231181113853339, 'psi': 0.3946229231215702}
[S8] START round=2 head_norm_before_train=0.879243 cos_to_last_merge=1.0000 (last merge round=1)
[S8] round=2 local utility u=0.000000 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7679397993368993, 'loss_val': 1.319689230495643, 'psi': 0.39114950917053404}-{'f1_val': 0.3730767263257798, 'auprc': 0.7353820448862242, 'loss_val': 1.336883862310574, 'psi': 0.5179988537499576}
[S9] START round=2 head_norm_before_train=0.880935 cos_to_last_merge=1.0000 (last merge round=1)
[S9] round=2 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.6129067980184243, 'loss_val': 1.3098467537508462, 'psi': 0.3300014934913673}-{'f1_val': 0.141397957139996, 'auprc': 0.6199965782543085, 'loss_val': 1.2939721461291733, 'psi': 0.332837405585721}
[S10] START round=2 head_norm_before_train=1.169581 (no previous merge yet)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7760953156469839, 'loss_val': 1.272437603647127, 'psi': 0.39361110878382793}-{'f1_val': 0.18666759246719722, 'auprc': 0.7706693193845703, 'loss_val': 1.3064433522940753, 'psi': 0.4202682832341465}
[S11] START round=2 head_norm_before_train=1.162300 (no previous merge yet)
[S11] round=2 local utility u=0.535158 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8678862900621118, 'loss_val': 1.2819118812804426, 'psi': 0.4314027260487111}-{'f1_val': 0.14041368337311058, 'auprc': 0.521755353557339, 'loss_val': 1.313834607164528, 'psi': 0.292950351446802}
[S13] START round=2 head_norm_before_train=1.162301 (no previous merge yet)
[S13] round=2 local utility u=0.012705 metrics={'f1_val': 0.41596071143800184, 'auprc': 0.6014596300370673, 'loss_val': 1.2919590119954674, 'psi': 0.49016027887762803}-{'f1_val': 0.41628028861516686, 'auprc': 0.6054391753094039, 'loss_val': 1.3312254536920245, 'psi': 0.49194384329286167}
[S14] START round=2 head_norm_before_train=1.234770 (no previous merge yet)
[S14] round=2 local utility u=0.208836 metrics={'f1_val': 0.3961941673907543, 'auprc': 0.61339137137592, 'loss_val': 1.3127527580029301, 'psi': 0.4830730489848206}-{'f1_val': 0.38626484403791306, 'auprc': 0.5026511910605431, 'loss_val': 1.3386285938534785, 'psi': 0.4328193828469651}
[S15] START round=2 head_norm_before_train=0.891329 cos_to_last_merge=1.0000 (last merge round=1)
[S15] round=2 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7831299581798901, 'loss_val': 1.3075141725255808, 'psi': 0.397092174088891}-{'f1_val': 0.13973365136155833, 'auprc': 0.7908792909541575, 'loss_val': 1.3089826828733528, 'psi': 0.40019190719859804}
[S16] START round=2 head_norm_before_train=1.158031 (no previous merge yet)
[S16] round=2 local utility u=0.192928 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8185797820705807, 'loss_val': 1.2913475663080347, 'psi': 0.4118143829477542}-{'f1_val': 0.14063745019920318, 'auprc': 0.7040089986433472, 'loss_val': 1.333490339897164, 'psi': 0.36598606957686075}
[S17] START round=2 head_norm_before_train=0.779316 cos_to_last_merge=1.0000 (last merge round=1)
[S17] round=2 local utility u=0.095186 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6058550010787733, 'loss_val': 1.3101848043608844, 'psi': 0.32691137842193996}-{'f1_val': 0.14094896331738438, 'auprc': 0.54238152078169, 'loss_val': 1.3101363294789812, 'psi': 0.30152198630310667}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.433)
[S7] not sending this round → trigger blocked (psi=0.401)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.402)
[S11] not sending this round → trigger blocked (psi=0.431)
[S13] not sending this round → trigger blocked (psi=0.490)
[S4] not sending this round → trigger blocked (psi=0.550)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.483)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.412)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] → sending delta(kind=head bytes=1793) to S7@127.0.0.1:44608
[S3] sending update (kind=head size=1793 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1793) from S3
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.132912)
[S7] loaded HEAD from S3 (vec_in norm=1.132912)
[S7] cosine check vs S3: cos=0.0415
[S7] BUFFERED delta from S3 (total buffered=1)
[S17] not sending this round → trigger blocked (psi=0.327)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=2 metric=0.1421 head_norm=0.872985
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.006232e-01
[S7] stored merged vector for next round verification (round=2)
[S7] DEBUG after merge:  round=2 metric=0.1421 head_norm=0.729330 delta_norm=0.700623
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=1.217551 (no previous merge yet)
[S2] round=3 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7551843644960952, 'loss_val': 1.2309953464542924, 'psi': 0.38714002583157814}-{'f1_val': 0.1417771333885667, 'auprc': 0.7918223976763797, 'loss_val': 1.275892418213357, 'psi': 0.40179523910369197}
[S3] START round=3 head_norm_before_train=1.132912 (no previous merge yet)
[S3] round=3 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.6671458328502338, 'loss_val': 1.2420288082284083, 'psi': 0.3507623725085577}-{'f1_val': 0.13984006561410703, 'auprc': 0.89924491978386, 'loss_val': 1.282088689407174, 'psi': 0.44360200728200827}
[S4] START round=3 head_norm_before_train=1.238680 (no previous merge yet)
[S4] round=3 local utility u=0.000000 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7809165459419785, 'loss_val': 1.220251941927037, 'psi': 0.3965025957139019}-{'f1_val': 0.40112302651176646, 'auprc': 0.7722614514006034, 'loss_val': 1.2910708657453123, 'psi': 0.5495783964673012}
[S5] START round=3 head_norm_before_train=0.804766 cos_to_last_merge=0.9971 (last merge round=1)
[S5] round=3 local utility u=0.157088 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7164966784593417, 'loss_val': 1.2636977276318617, 'psi': 0.37195581424087953}-{'f1_val': 0.14226190476190476, 'auprc': 0.6247166033327106, 'loss_val': 1.3025331186943092, 'psi': 0.3352437841902271}
[S6] START round=3 head_norm_before_train=1.195641 (no previous merge yet)
[S6] round=3 local utility u=0.020564 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8682641778416609, 'loss_val': 1.2476219401075546, 'psi': 0.4321614403674336}-{'f1_val': 0.14142628205128205, 'auprc': 0.8707195557595392, 'loss_val': 1.2961156196077732, 'psi': 0.4331435915345849}
[S7] START round=3 head_norm_before_train=0.729330 cos_to_last_merge=1.0000 (last merge round=2)
[S7] round=3 local utility u=0.011671 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7946407773562167, 'loss_val': 1.3210888342641953, 'psi': 0.4030904045799417}-{'f1_val': 0.14205682272909165, 'auprc': 0.7885105020997186, 'loss_val': 1.3260400540116455, 'psi': 0.40063829447734245}
[S8] START round=3 head_norm_before_train=0.896298 cos_to_last_merge=0.9970 (last merge round=1)
[S8] round=3 local utility u=0.015393 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7661134765113357, 'loss_val': 1.2834246044181359, 'psi': 0.3904189800403086}-{'f1_val': 0.13995598239295717, 'auprc': 0.7679397993368993, 'loss_val': 1.319689230495643, 'psi': 0.39114950917053404}
[S9] START round=3 head_norm_before_train=0.897490 cos_to_last_merge=0.9966 (last merge round=1)
[S9] round=3 local utility u=0.332113 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8147571386826822, 'loss_val': 1.2511724366508805, 'psi': 0.4107416297570705}-{'f1_val': 0.141397957139996, 'auprc': 0.6129067980184243, 'loss_val': 1.3098467537508462, 'psi': 0.3300014934913673}
[S10] START round=3 head_norm_before_train=1.196634 (no previous merge yet)
[S10] round=3 local utility u=0.027015 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7763862236660501, 'loss_val': 1.2192809727780725, 'psi': 0.3937274719914544}-{'f1_val': 0.13862163754172394, 'auprc': 0.7760953156469839, 'loss_val': 1.272437603647127, 'psi': 0.39361110878382793}
[S11] START round=3 head_norm_before_train=1.186091 (no previous merge yet)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7858789336886645, 'loss_val': 1.2427445399471848, 'psi': 0.39859978349933217}-{'f1_val': 0.14041368337311058, 'auprc': 0.8678862900621118, 'loss_val': 1.2819118812804426, 'psi': 0.4314027260487111}
[S13] START round=3 head_norm_before_train=1.182419 (no previous merge yet)
[S13] round=3 local utility u=0.000000 metrics={'f1_val': 0.346580996916654, 'auprc': 0.6183064413085775, 'loss_val': 1.2386845377865423, 'psi': 0.4552711746734234}-{'f1_val': 0.41596071143800184, 'auprc': 0.6014596300370673, 'loss_val': 1.2919590119954674, 'psi': 0.49016027887762803}
[S14] START round=3 head_norm_before_train=1.258585 (no previous merge yet)
[S14] round=3 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.742207416790218, 'loss_val': 1.2805696669227682, 'psi': 0.38109767844570946}-{'f1_val': 0.3961941673907543, 'auprc': 0.61339137137592, 'loss_val': 1.3127527580029301, 'psi': 0.4830730489848206}
[S15] START round=3 head_norm_before_train=0.913342 cos_to_last_merge=0.9972 (last merge round=1)
[S15] round=3 local utility u=0.007141 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7774322880677964, 'loss_val': 1.2761382689753613, 'psi': 0.39481310604405356}-{'f1_val': 0.13973365136155833, 'auprc': 0.7831299581798901, 'loss_val': 1.3075141725255808, 'psi': 0.397092174088891}
[S16] START round=3 head_norm_before_train=1.183057 (no previous merge yet)
[S16] round=3 local utility u=0.011499 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8127600792570167, 'loss_val': 1.2508895139597696, 'psi': 0.4094865018223286}-{'f1_val': 0.14063745019920318, 'auprc': 0.8185797820705807, 'loss_val': 1.2913475663080347, 'psi': 0.4118143829477542}
[S17] START round=3 head_norm_before_train=0.805507 cos_to_last_merge=0.9965 (last merge round=1)
[S17] round=3 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5816848110156513, 'loss_val': 1.2696931016740485, 'psi': 0.3172433023966912}-{'f1_val': 0.14094896331738438, 'auprc': 0.6058550010787733, 'loss_val': 1.3101848043608844, 'psi': 0.32691137842193996}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:44616
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:44614
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:44604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:44610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:44604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S16] → sending delta(kind=head bytes=1791) to S15@127.0.0.1:44615
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:44609
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] → sending delta(kind=head bytes=1792) to S9@127.0.0.1:44610
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1792 to 1 peers)
[S15] sending update (kind=head size=1793 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1791 to 1 peers)
[S10] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1793 to 1 peers)
[S7] sending update (kind=head size=1805 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1792) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.836341)
[S9] loaded HEAD from S5 (vec_in norm=0.836341)
[S9] cosine check vs S5: cos=0.0562
[S9] BUFFERED delta from S5 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1794) from S10
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.229021)
[S9] loaded HEAD from S10 (vec_in norm=1.229021)
[S9] cosine check vs S10: cos=0.0734
[S9] BUFFERED delta from S10 (total buffered=2)
[S8] RECEIVED delta(kind=head bytes=1793) from S15
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.940831)
[S8] loaded HEAD from S15 (vec_in norm=0.940831)
[S8] cosine check vs S15: cos=0.0410
[S8] BUFFERED delta from S15 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1791) from S16
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.211980)
[S15] loaded HEAD from S16 (vec_in norm=1.211980)
[S15] cosine check vs S16: cos=0.0140
[S15] BUFFERED delta from S16 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1798) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.231356)
[S4] loaded HEAD from S6 (vec_in norm=1.231356)
[S4] cosine check vs S6: cos=0.0490
[S4] BUFFERED delta from S6 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1793) from S8
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.922838)
[S4] loaded HEAD from S8 (vec_in norm=0.922838)
[S4] cosine check vs S8: cos=0.0159
[S4] BUFFERED delta from S8 (total buffered=2)
[S14] RECEIVED delta(kind=head bytes=1799) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.926184)
[S14] loaded HEAD from S9 (vec_in norm=0.926184)
[S14] cosine check vs S9: cos=-0.0084
[S14] DROPPED delta from S9 (cos=-0.0084 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1805) from S7
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.745042)
[S16] loaded HEAD from S7 (vec_in norm=0.745042)
[S16] cosine check vs S7: cos=0.0706
[S16] BUFFERED delta from S7 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=3 metric=0.1402 head_norm=1.271546
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.314906e-01
[S4] stored merged vector for next round verification (round=3)
[S4] DEBUG after merge:  round=3 metric=0.1402 head_norm=0.763416 delta_norm=0.731491
[S4] aggregate: ACCEPT kept=['S6', 'S8'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=3 metric=0.1414 head_norm=0.926184
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.704919e-01
[S9] stored merged vector for next round verification (round=3)
[S9] DEBUG after merge:  round=3 metric=0.1414 head_norm=0.623709 delta_norm=0.570492
[S9] aggregate: ACCEPT kept=['S5', 'S10'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=3 metric=0.1397 head_norm=0.940831
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.619315e-01
[S15] stored merged vector for next round verification (round=3)
[S15] DEBUG after merge:  round=3 metric=0.1397 head_norm=0.772327 delta_norm=0.761932
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=3 metric=0.1406 head_norm=1.211980
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.885619e-01
[S16] stored merged vector for next round verification (round=3)
[S16] DEBUG after merge:  round=3 metric=0.1406 head_norm=0.733399 delta_norm=0.688562
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=3 metric=0.1400 head_norm=0.922838
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.453004e-01
[S8] stored merged vector for next round verification (round=3)
[S8] DEBUG after merge:  round=3 metric=0.1400 head_norm=0.672298 delta_norm=0.645300
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=1.248835 (no previous merge yet)
[S2] round=4 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6177666597651271, 'loss_val': 1.1845001005988105, 'psi': 0.3321729439391909}-{'f1_val': 0.1417771333885667, 'auprc': 0.7551843644960952, 'loss_val': 1.2309953464542924, 'psi': 0.38714002583157814}
[S3] START round=4 head_norm_before_train=1.168082 (no previous merge yet)
[S3] round=4 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.6196072075258698, 'loss_val': 1.2177045141092768, 'psi': 0.3317469223788122}-{'f1_val': 0.13984006561410703, 'auprc': 0.6671458328502338, 'loss_val': 1.2420288082284083, 'psi': 0.3507623725085577}
[S4] START round=4 head_norm_before_train=0.763416 cos_to_last_merge=1.0000 (last merge round=3)
[S4] round=4 local utility u=0.007178 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7853683581263757, 'loss_val': 1.2192523614020496, 'psi': 0.3982833205876608}-{'f1_val': 0.14022662889518414, 'auprc': 0.7809165459419785, 'loss_val': 1.220251941927037, 'psi': 0.3965025957139019}
[S5] START round=4 head_norm_before_train=0.836341 cos_to_last_merge=0.9893 (last merge round=1)
[S5] round=4 local utility u=0.111735 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7699281173740573, 'loss_val': 1.2005224584618508, 'psi': 0.3933283898067658}-{'f1_val': 0.14226190476190476, 'auprc': 0.7164966784593417, 'loss_val': 1.2636977276318617, 'psi': 0.37195581424087953}
[S6] START round=4 head_norm_before_train=1.231356 (no previous merge yet)
[S6] round=4 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8452239766331302, 'loss_val': 1.205161946700631, 'psi': 0.4229453598840213}-{'f1_val': 0.14142628205128205, 'auprc': 0.8682641778416609, 'loss_val': 1.2476219401075546, 'psi': 0.4321614403674336}
[S7] START round=4 head_norm_before_train=0.745042 cos_to_last_merge=0.9964 (last merge round=2)
[S7] round=4 local utility u=0.012490 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7913232665924314, 'loss_val': 1.286157167156522, 'psi': 0.40176340027442753}-{'f1_val': 0.14205682272909165, 'auprc': 0.7946407773562167, 'loss_val': 1.3210888342641953, 'psi': 0.4030904045799417}
[S8] START round=4 head_norm_before_train=0.672298 cos_to_last_merge=1.0000 (last merge round=3)
[S8] round=4 local utility u=0.000733 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7659861154584577, 'loss_val': 1.281576221839766, 'psi': 0.39036803561915745}-{'f1_val': 0.13995598239295717, 'auprc': 0.7661134765113357, 'loss_val': 1.2834246044181359, 'psi': 0.3904189800403086}
[S9] START round=4 head_norm_before_train=0.623709 cos_to_last_merge=1.0000 (last merge round=3)
[S9] round=4 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8139614546321233, 'loss_val': 1.2531459874943347, 'psi': 0.41042335613684694}-{'f1_val': 0.141397957139996, 'auprc': 0.8147571386826822, 'loss_val': 1.2511724366508805, 'psi': 0.4107416297570705}
[S10] START round=4 head_norm_before_train=1.229021 (no previous merge yet)
[S10] round=4 local utility u=0.040597 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7764116853650249, 'loss_val': 1.1381642039514788, 'psi': 0.3937376566710443}-{'f1_val': 0.13862163754172394, 'auprc': 0.7763862236660501, 'loss_val': 1.2192809727780725, 'psi': 0.3937274719914544}
[S11] START round=4 head_norm_before_train=1.215188 (no previous merge yet)
[S11] round=4 local utility u=0.019611 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7823161776837003, 'loss_val': 1.192834555110614, 'psi': 0.3971746810973465}-{'f1_val': 0.14041368337311058, 'auprc': 0.7858789336886645, 'loss_val': 1.2427445399471848, 'psi': 0.39859978349933217}
[S13] START round=4 head_norm_before_train=1.211429 (no previous merge yet)
[S13] round=4 local utility u=0.000000 metrics={'f1_val': 0.1876661714061942, 'auprc': 0.6340047007264622, 'loss_val': 1.1754506356334637, 'psi': 0.3662015831343014}-{'f1_val': 0.346580996916654, 'auprc': 0.6183064413085775, 'loss_val': 1.2386845377865423, 'psi': 0.4552711746734234}
[S14] START round=4 head_norm_before_train=1.288513 (no previous merge yet)
[S14] round=4 local utility u=0.091921 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7907977866924956, 'loss_val': 1.242499281590121, 'psi': 0.4005338264066205}-{'f1_val': 0.14035785288270378, 'auprc': 0.742207416790218, 'loss_val': 1.2805696669227682, 'psi': 0.38109767844570946}
[S15] START round=4 head_norm_before_train=0.772327 cos_to_last_merge=1.0000 (last merge round=3)
[S15] round=4 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7758976602069336, 'loss_val': 1.2873542949322094, 'psi': 0.3941992548997085}-{'f1_val': 0.13973365136155833, 'auprc': 0.7774322880677964, 'loss_val': 1.2761382689753613, 'psi': 0.39481310604405356}
[S16] START round=4 head_norm_before_train=0.733399 cos_to_last_merge=1.0000 (last merge round=3)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8121032288316452, 'loss_val': 1.2584982560901976, 'psi': 0.40922376165218}-{'f1_val': 0.14063745019920318, 'auprc': 0.8127600792570167, 'loss_val': 1.2508895139597696, 'psi': 0.4094865018223286}
[S17] START round=4 head_norm_before_train=0.838881 cos_to_last_merge=0.9875 (last merge round=1)
[S17] round=4 local utility u=0.010714 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.568230827834423, 'loss_val': 1.2079039696757534, 'psi': 0.31186170912419986}-{'f1_val': 0.14094896331738438, 'auprc': 0.5816848110156513, 'loss_val': 1.2696931016740485, 'psi': 0.3172433023966912}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:44605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:44616
[S8] not sending this round → trigger blocked (psi=0.390)
[S5] not sending this round → trigger blocked (psi=0.393)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.394)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S14] → sending delta(kind=head bytes=1790) to S15@127.0.0.1:44615
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.402)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1790 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1803) from S4
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.797922)
[S5] loaded HEAD from S4 (vec_in norm=0.797922)
[S5] cosine check vs S4: cos=0.0600
[S5] BUFFERED delta from S4 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1790) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.321874)
[S15] loaded HEAD from S14 (vec_in norm=1.321874)
[S15] cosine check vs S14: cos=0.0203
[S15] BUFFERED delta from S14 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1799) from S11
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.245205)
[S16] loaded HEAD from S11 (vec_in norm=1.245205)
[S16] cosine check vs S11: cos=-0.0282
[S16] DROPPED delta from S11 (cos=-0.0282 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:44616
[S17] sending update (kind=head size=1797 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1797) from S17
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.875985)
[S16] loaded HEAD from S17 (vec_in norm=0.875985)
[S16] cosine check vs S17: cos=0.3532
[S16] BUFFERED delta from S17 (total buffered=1)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=4 metric=0.1397 head_norm=0.797701
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.649924e-01
[S15] stored merged vector for next round verification (round=4)
[S15] DEBUG after merge:  round=4 metric=0.1677 head_norm=0.778862 delta_norm=0.764992
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=4 metric=0.1423 head_norm=0.876756
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.747770e-01
[S5] stored merged vector for next round verification (round=4)
[S5] DEBUG after merge:  round=4 metric=0.1667 head_norm=0.610182 delta_norm=0.574777
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=4 metric=0.1406 head_norm=0.762263
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.681714e-01
[S16] stored merged vector for next round verification (round=4)
[S16] DEBUG after merge:  round=4 metric=0.1406 head_norm=0.674547 delta_norm=0.468171
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=1.277497 (no previous merge yet)
[S2] round=5 local utility u=0.026065 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6137372330119425, 'loss_val': 1.1202823446516543, 'psi': 0.33056117323791706}-{'f1_val': 0.1417771333885667, 'auprc': 0.6177666597651271, 'loss_val': 1.1845001005988105, 'psi': 0.3321729439391909}
[S3] START round=5 head_norm_before_train=1.200081 (no previous merge yet)
[S3] round=5 local utility u=0.306503 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7958717420189599, 'loss_val': 1.1334924926575878, 'psi': 0.4022527361760482}-{'f1_val': 0.13984006561410703, 'auprc': 0.6196072075258698, 'loss_val': 1.2177045141092768, 'psi': 0.3317469223788122}
[S4] START round=5 head_norm_before_train=0.797922 cos_to_last_merge=0.9963 (last merge round=3)
[S4] round=5 local utility u=0.010199 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7682862114506822, 'loss_val': 1.147608010207439, 'psi': 0.39145046191738336}-{'f1_val': 0.14022662889518414, 'auprc': 0.7853683581263757, 'loss_val': 1.2192523614020496, 'psi': 0.3982833205876608}
[S5] START round=5 head_norm_before_train=0.610182 cos_to_last_merge=1.0000 (last merge round=4)
[S5] round=5 local utility u=0.647548 metrics={'f1_val': 0.35548640295854445, 'auprc': 0.7697048799223956, 'loss_val': 1.1841033367768536, 'psi': 0.5211737937440849}-{'f1_val': 0.14226190476190476, 'auprc': 0.7699281173740573, 'loss_val': 1.2005224584618508, 'psi': 0.3933283898067658}
[S6] START round=5 head_norm_before_train=1.262776 (no previous merge yet)
[S6] round=5 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8179060177928258, 'loss_val': 1.1426706640858169, 'psi': 0.41201817634789956}-{'f1_val': 0.14142628205128205, 'auprc': 0.8452239766331302, 'loss_val': 1.205161946700631, 'psi': 0.4229453598840213}
[S7] START round=5 head_norm_before_train=0.770118 cos_to_last_merge=0.9861 (last merge round=2)
[S7] round=5 local utility u=0.014889 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7917535323674956, 'loss_val': 1.2576708806448023, 'psi': 0.40193550658445326}-{'f1_val': 0.14205682272909165, 'auprc': 0.7913232665924314, 'loss_val': 1.286157167156522, 'psi': 0.40176340027442753}
[S8] START round=5 head_norm_before_train=0.695723 cos_to_last_merge=0.9965 (last merge round=3)
[S8] round=5 local utility u=0.026033 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.766324621306204, 'loss_val': 1.2305265220848285, 'psi': 0.390503437958256}-{'f1_val': 0.13995598239295717, 'auprc': 0.7659861154584577, 'loss_val': 1.281576221839766, 'psi': 0.39036803561915745}
[S9] START round=5 head_norm_before_train=0.652251 cos_to_last_merge=0.9937 (last merge round=3)
[S9] round=5 local utility u=0.017675 metrics={'f1_val': 0.141397957139996, 'auprc': 0.813857099133349, 'loss_val': 1.217483344421951, 'psi': 0.41038161393733724}-{'f1_val': 0.141397957139996, 'auprc': 0.8139614546321233, 'loss_val': 1.2531459874943347, 'psi': 0.41042335613684694}
[S10] START round=5 head_norm_before_train=1.266191 (no previous merge yet)
[S10] round=5 local utility u=0.922037 metrics={'f1_val': 0.41615846728099787, 'auprc': 0.7908679826208362, 'loss_val': 1.0026799922058642, 'psi': 0.5660422734169333}-{'f1_val': 0.13862163754172394, 'auprc': 0.7764116853650249, 'loss_val': 1.1381642039514788, 'psi': 0.3937376566710443}
[S11] START round=5 head_norm_before_train=1.245205 (no previous merge yet)
[S11] round=5 local utility u=0.044794 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.786248710142758, 'loss_val': 1.1150445345284896, 'psi': 0.39874769408096955}-{'f1_val': 0.14041368337311058, 'auprc': 0.7823161776837003, 'loss_val': 1.192834555110614, 'psi': 0.3971746810973465}
[S13] START round=5 head_norm_before_train=1.240780 (no previous merge yet)
[S13] round=5 local utility u=0.846014 metrics={'f1_val': 0.4156839344320697, 'auprc': 0.7075410316207934, 'loss_val': 1.072138268231888, 'psi': 0.5324267733075592}-{'f1_val': 0.1876661714061942, 'auprc': 0.6340047007264622, 'loss_val': 1.1754506356334637, 'psi': 0.3662015831343014}
[S14] START round=5 head_norm_before_train=1.321874 (no previous merge yet)
[S14] round=5 local utility u=0.011511 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7787439110934257, 'loss_val': 1.1833165312438634, 'psi': 0.39571227616699256}-{'f1_val': 0.14035785288270378, 'auprc': 0.7907977866924956, 'loss_val': 1.242499281590121, 'psi': 0.4005338264066205}
[S15] START round=5 head_norm_before_train=0.778862 cos_to_last_merge=1.0000 (last merge round=4)
[S15] round=5 local utility u=0.020355 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7819757654694831, 'loss_val': 1.2648779980061582, 'psi': 0.39663049700472824}-{'f1_val': 0.13973365136155833, 'auprc': 0.7758976602069336, 'loss_val': 1.2873542949322094, 'psi': 0.3941992548997085}
[S16] START round=5 head_norm_before_train=0.674547 cos_to_last_merge=1.0000 (last merge round=4)
[S16] round=5 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.6665535696607231, 'loss_val': 1.2404923649507864, 'psi': 0.35100389798381115}-{'f1_val': 0.14063745019920318, 'auprc': 0.8121032288316452, 'loss_val': 1.2584982560901976, 'psi': 0.40922376165218}
[S17] START round=5 head_norm_before_train=0.875985 cos_to_last_merge=0.9748 (last merge round=1)
[S17] round=5 local utility u=0.065648 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5755337154899948, 'loss_val': 1.0985162398823907, 'psi': 0.31478286418642853}-{'f1_val': 0.14094896331738438, 'auprc': 0.568230827834423, 'loss_val': 1.2079039696757534, 'psi': 0.31186170912419986}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:44610
[S11] not sending this round → trigger blocked (psi=0.399)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] → sending delta(kind=head bytes=1792) to S8@127.0.0.1:44609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:44604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:44616
[S14] not sending this round → trigger blocked (psi=0.396)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:44610
[S4] not sending this round → trigger blocked (psi=0.391)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:44614
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1794 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1792 to 1 peers)
[S7] sending update (kind=head size=1793 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1794) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.649544)
[S9] loaded HEAD from S5 (vec_in norm=0.649544)
[S9] cosine check vs S5: cos=0.6329
[S9] BUFFERED delta from S5 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1800) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.681994)
[S14] loaded HEAD from S9 (vec_in norm=0.681994)
[S14] cosine check vs S9: cos=0.0418
[S14] BUFFERED delta from S9 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1794) from S2
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.308741)
[S16] loaded HEAD from S2 (vec_in norm=1.308741)
[S16] cosine check vs S2: cos=-0.0531
[S16] DROPPED delta from S2 (cos=-0.0531 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1792) from S15
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.799686)
[S8] loaded HEAD from S15 (vec_in norm=0.799686)
[S8] cosine check vs S15: cos=0.1413
[S8] BUFFERED delta from S15 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1801) from S8
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.729036)
[S4] loaded HEAD from S8 (vec_in norm=0.729036)
[S4] cosine check vs S8: cos=0.2172
[S4] BUFFERED delta from S8 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1796) from S10
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.305432)
[S9] loaded HEAD from S10 (vec_in norm=1.305432)
[S9] cosine check vs S10: cos=0.5032
[S9] BUFFERED delta from S10 (total buffered=2)
[S14] RECEIVED delta(kind=head bytes=1800) from S13
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.277029)
[S14] loaded HEAD from S13 (vec_in norm=1.277029)
[S14] cosine check vs S13: cos=-0.0395
[S14] DROPPED delta from S13 (cos=-0.0395 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1799) from S3
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.226885)
[S14] loaded HEAD from S3 (vec_in norm=1.226885)
[S14] cosine check vs S3: cos=0.0327
[S14] BUFFERED delta from S3 (total buffered=2)
[S16] RECEIVED delta(kind=head bytes=1793) from S7
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.800560)
[S16] loaded HEAD from S7 (vec_in norm=0.800560)
[S16] cosine check vs S7: cos=0.3047
[S16] BUFFERED delta from S7 (total buffered=1)
[S17] not sending this round → trigger blocked (psi=0.315)
[S6] ⇄ pheromone p=0.364 → S4@127.0.0.1:44604
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=5 metric=0.1404 head_norm=1.356160
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.508431e-01
[S14] stored merged vector for next round verification (round=5)
[S14] DEBUG after merge:  round=5 metric=0.1428 head_norm=0.781242 delta_norm=0.750843
[S14] aggregate: ACCEPT kept=['S9', 'S3'] (k=2/2) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.404 → S15@127.0.0.1:44615
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=5 metric=0.1402 head_norm=0.828171
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.886464e-01
[S4] stored merged vector for next round verification (round=5)
[S4] DEBUG after merge:  round=5 metric=0.1402 head_norm=0.608198 delta_norm=0.488646
[S4] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.430 → S5@127.0.0.1:44605
[S11] ⇄ pheromone p=0.408 → S16@127.0.0.1:44616
[S7] ⇄ pheromone p=0.392 → S16@127.0.0.1:44616
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=5 metric=0.1400 head_norm=0.729036
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.015479e-01
[S8] stored merged vector for next round verification (round=5)
[S8] DEBUG after merge:  round=5 metric=0.1400 head_norm=0.577880 delta_norm=0.501548
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.417 → S4@127.0.0.1:44604
[S13] ⇄ pheromone p=0.578 → S14@127.0.0.1:44614
[S10] ⇄ pheromone p=0.522 → S9@127.0.0.1:44610
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=5 metric=0.1414 head_norm=0.681994
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.740312e-01
[S9] stored merged vector for next round verification (round=5)
[S9] DEBUG after merge:  round=5 metric=0.1414 head_norm=0.662775 delta_norm=0.274031
[S9] aggregate: ACCEPT kept=['S5', 'S10'] (k=2/2) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.378 → S14@127.0.0.1:44614
[S2] ⇄ pheromone p=0.345 → S16@127.0.0.1:44616
[S3] ⇄ pheromone p=0.392 → S14@127.0.0.1:44614
[S5] ⇄ pheromone p=0.530 → S9@127.0.0.1:44610
[S15] ⇄ pheromone p=0.335 → S8@127.0.0.1:44609
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=5 metric=0.1406 head_norm=0.700781
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.444415e-01
[S16] stored merged vector for next round verification (round=5)
[S16] DEBUG after merge:  round=5 metric=0.1406 head_norm=0.607014 delta_norm=0.444441
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.356 → S15@127.0.0.1:44615
[S17] ⇄ pheromone p=0.371 → S16@127.0.0.1:44616
[S2] START round=6 head_norm_before_train=1.308741 (no previous merge yet)
[S2] round=6 local utility u=1.000000 metrics={'f1_val': 0.41668780995073934, 'auprc': 0.774674010615519, 'loss_val': 1.001650105438242, 'psi': 0.5598822902166511}-{'f1_val': 0.1417771333885667, 'auprc': 0.6137372330119425, 'loss_val': 1.1202823446516543, 'psi': 0.33056117323791706}
[S3] START round=6 head_norm_before_train=1.226885 (no previous merge yet)
[S3] round=6 local utility u=0.907842 metrics={'f1_val': 0.4225626028819525, 'auprc': 0.796272581725436, 'loss_val': 1.0153453183339787, 'psi': 0.572046594419346}-{'f1_val': 0.13984006561410703, 'auprc': 0.7958717420189599, 'loss_val': 1.1334924926575878, 'psi': 0.4022527361760482}
[S4] START round=6 head_norm_before_train=0.608198 cos_to_last_merge=1.0000 (last merge round=5)
[S4] round=6 local utility u=0.000000 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7665931909832261, 'loss_val': 1.1475622875485647, 'psi': 0.39077325373040095}-{'f1_val': 0.14022662889518414, 'auprc': 0.7682862114506822, 'loss_val': 1.147608010207439, 'psi': 0.39145046191738336}
[S5] START round=6 head_norm_before_train=0.649544 cos_to_last_merge=0.9936 (last merge round=4)
[S5] round=6 local utility u=0.256904 metrics={'f1_val': 0.41734838192522206, 'auprc': 0.777762939234543, 'loss_val': 1.0656411441917906, 'psi': 0.5615142048489505}-{'f1_val': 0.35548640295854445, 'auprc': 0.7697048799223956, 'loss_val': 1.1841033367768536, 'psi': 0.5211737937440849}
[S6] START round=6 head_norm_before_train=1.290781 (no previous merge yet)
[S6] round=6 local utility u=0.665144 metrics={'f1_val': 0.41524424617876, 'auprc': 0.675438069548462, 'loss_val': 1.0278860143277755, 'psi': 0.5193217755266408}-{'f1_val': 0.14142628205128205, 'auprc': 0.8179060177928258, 'loss_val': 1.1426706640858169, 'psi': 0.41201817634789956}
[S7] START round=6 head_norm_before_train=0.800560 cos_to_last_merge=0.9721 (last merge round=2)
[S7] round=6 local utility u=0.016886 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7947029747040868, 'loss_val': 1.2327466556045117, 'psi': 0.4031152835190897}-{'f1_val': 0.14205682272909165, 'auprc': 0.7917535323674956, 'loss_val': 1.2576708806448023, 'psi': 0.40193550658445326}
[S8] START round=6 head_norm_before_train=0.577880 cos_to_last_merge=1.0000 (last merge round=5)
[S8] round=6 local utility u=0.011430 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.770951178976615, 'loss_val': 1.2215458332765858, 'psi': 0.39235406102642034}-{'f1_val': 0.13995598239295717, 'auprc': 0.766324621306204, 'loss_val': 1.2305265220848285, 'psi': 0.390503437958256}
[S9] START round=6 head_norm_before_train=0.662775 cos_to_last_merge=1.0000 (last merge round=5)
[S9] round=6 local utility u=0.014076 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8102251508226841, 'loss_val': 1.1784347294758115, 'psi': 0.4089288346130713}-{'f1_val': 0.141397957139996, 'auprc': 0.813857099133349, 'loss_val': 1.217483344421951, 'psi': 0.41038161393733724}
[S10] START round=6 head_norm_before_train=1.305432 (no previous merge yet)
[S10] round=6 local utility u=0.200202 metrics={'f1_val': 0.43821571827691713, 'auprc': 0.8210991036348259, 'loss_val': 0.8253119704135092, 'psi': 0.5913690724200806}-{'f1_val': 0.41615846728099787, 'auprc': 0.7908679826208362, 'loss_val': 1.0026799922058642, 'psi': 0.5660422734169333}
[S11] START round=6 head_norm_before_train=1.275906 (no previous merge yet)
[S11] round=6 local utility u=0.182291 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8630003163190845, 'loss_val': 0.9807170335375828, 'psi': 0.42944833655150016}-{'f1_val': 0.14041368337311058, 'auprc': 0.786248710142758, 'loss_val': 1.1150445345284896, 'psi': 0.39874769408096955}
[S13] START round=6 head_norm_before_train=1.277029 (no previous merge yet)
[S13] round=6 local utility u=0.000000 metrics={'f1_val': 0.4163965282706411, 'auprc': 0.5909610454698482, 'loss_val': 0.9715834337187027, 'psi': 0.486222335150324}-{'f1_val': 0.4156839344320697, 'auprc': 0.7075410316207934, 'loss_val': 1.072138268231888, 'psi': 0.5324267733075592}
[S14] START round=6 head_norm_before_train=0.781242 cos_to_last_merge=1.0000 (last merge round=5)
[S14] round=6 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7560192288470379, 'loss_val': 1.1600450795356996, 'psi': 0.38662240326843744}-{'f1_val': 0.14035785288270378, 'auprc': 0.7787439110934257, 'loss_val': 1.1833165312438634, 'psi': 0.39571227616699256}
[S15] START round=6 head_norm_before_train=0.799686 cos_to_last_merge=0.9955 (last merge round=4)
[S15] round=6 local utility u=0.019561 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7780267363523002, 'loss_val': 1.2139093620622678, 'psi': 0.3950508853578551}-{'f1_val': 0.13973365136155833, 'auprc': 0.7819757654694831, 'loss_val': 1.2648779980061582, 'psi': 0.39663049700472824}
[S16] START round=6 head_norm_before_train=0.607014 cos_to_last_merge=1.0000 (last merge round=5)
[S16] round=6 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.6123579984251137, 'loss_val': 1.2174138878447776, 'psi': 0.32932566948956743}-{'f1_val': 0.14063745019920318, 'auprc': 0.6665535696607231, 'loss_val': 1.2404923649507864, 'psi': 0.35100389798381115}
[S17] START round=6 head_norm_before_train=0.914795 cos_to_last_merge=0.9610 (last merge round=1)
[S17] round=6 local utility u=0.874754 metrics={'f1_val': 0.39178269178899605, 'auprc': 0.622720123525388, 'loss_val': 0.9955707720359847, 'psi': 0.4841576644835528}-{'f1_val': 0.14094896331738438, 'auprc': 0.5755337154899948, 'loss_val': 1.0985162398823907, 'psi': 0.31478286418642853}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.395)
[S10] not sending this round → trigger blocked (psi=0.591)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.572)
[S5] not sending this round → trigger blocked (psi=0.562)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:44604
[S7] not sending this round → trigger blocked (psi=0.403)
[S8] not sending this round → trigger blocked (psi=0.392)
[S2] not sending this round → trigger blocked (psi=0.560)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.409)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:44616
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1797) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.329097)
[S4] loaded HEAD from S6 (vec_in norm=1.329097)
[S4] cosine check vs S6: cos=0.2894
[S4] BUFFERED delta from S6 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1801) from S11
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.313112)
[S16] loaded HEAD from S11 (vec_in norm=1.313112)
[S16] cosine check vs S11: cos=-0.0155
[S16] DROPPED delta from S11 (cos=-0.0155 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:44616
[S17] sending update (kind=head size=1794 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1794) from S17
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.961273)
[S16] loaded HEAD from S17 (vec_in norm=0.961273)
[S16] cosine check vs S17: cos=0.5052
[S16] BUFFERED delta from S17 (total buffered=1)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=6 metric=0.1402 head_norm=0.639639
[S4] _apply_head_vector_avg (torch): Δ‖w‖=6.487791e-01
[S4] stored merged vector for next round verification (round=6)
[S4] DEBUG after merge:  round=6 metric=0.1402 head_norm=0.816642 delta_norm=0.648779
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=6 metric=0.1406 head_norm=0.631565
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.211559e-01
[S16] stored merged vector for next round verification (round=6)
[S16] DEBUG after merge:  round=6 metric=0.1406 head_norm=0.695764 delta_norm=0.421156
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=1.336879 (no previous merge yet)
[S2] round=7 local utility u=0.072979 metrics={'f1_val': 0.41639397765096375, 'auprc': 0.7781514957112703, 'loss_val': 0.864360580708599, 'psi': 0.5610969848750864}-{'f1_val': 0.41668780995073934, 'auprc': 0.774674010615519, 'loss_val': 1.001650105438242, 'psi': 0.5598822902166511}
[S3] START round=7 head_norm_before_train=1.259844 (no previous merge yet)
[S3] round=7 local utility u=0.260006 metrics={'f1_val': 0.3963275517403211, 'auprc': 0.9646398823938833, 'loss_val': 0.8430247458326273, 'psi': 0.623652484001746}-{'f1_val': 0.4225626028819525, 'auprc': 0.796272581725436, 'loss_val': 1.0153453183339787, 'psi': 0.572046594419346}
[S4] START round=7 head_norm_before_train=0.816642 cos_to_last_merge=1.0000 (last merge round=6)
[S4] round=7 local utility u=0.031120 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7658752148574028, 'loss_val': 1.0831676789342775, 'psi': 0.3904860632800716}-{'f1_val': 0.14022662889518414, 'auprc': 0.7665931909832261, 'loss_val': 1.1475622875485647, 'psi': 0.39077325373040095}
[S5] START round=7 head_norm_before_train=0.695110 cos_to_last_merge=0.9772 (last merge round=4)
[S5] round=7 local utility u=0.055206 metrics={'f1_val': 0.4175873768787894, 'auprc': 0.7772946265719834, 'loss_val': 0.9552576355939262, 'psi': 0.5614702767560671}-{'f1_val': 0.41734838192522206, 'auprc': 0.777762939234543, 'loss_val': 1.0656411441917906, 'psi': 0.5615142048489505}
[S6] START round=7 head_norm_before_train=1.329097 (no previous merge yet)
[S6] round=7 local utility u=0.101146 metrics={'f1_val': 0.41649329522006995, 'auprc': 0.6715536596616154, 'loss_val': 0.8214354674199574, 'psi': 0.5185174409966882}-{'f1_val': 0.41524424617876, 'auprc': 0.675438069548462, 'loss_val': 1.0278860143277755, 'psi': 0.5193217755266408}
[S7] START round=7 head_norm_before_train=0.828090 cos_to_last_merge=0.9596 (last merge round=2)
[S7] round=7 local utility u=0.029479 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7948962477548455, 'loss_val': 1.1743679901028636, 'psi': 0.4031925927393932}-{'f1_val': 0.14205682272909165, 'auprc': 0.7947029747040868, 'loss_val': 1.2327466556045117, 'psi': 0.4031152835190897}
[S8] START round=7 head_norm_before_train=0.603614 cos_to_last_merge=0.9939 (last merge round=5)
[S8] round=7 local utility u=0.442909 metrics={'f1_val': 0.27492551823627187, 'auprc': 0.7769752491075842, 'loss_val': 1.1636175095152375, 'psi': 0.4757454105847968}-{'f1_val': 0.13995598239295717, 'auprc': 0.770951178976615, 'loss_val': 1.2215458332765858, 'psi': 0.39235406102642034}
[S9] START round=7 head_norm_before_train=0.682767 cos_to_last_merge=0.9966 (last merge round=5)
[S9] round=7 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.7307035102569672, 'loss_val': 1.0545432413822962, 'psi': 0.3771201783867845}-{'f1_val': 0.141397957139996, 'auprc': 0.8102251508226841, 'loss_val': 1.1784347294758115, 'psi': 0.4089288346130713}
[S10] START round=7 head_norm_before_train=1.342266 (no previous merge yet)
[S10] round=7 local utility u=1.000000 metrics={'f1_val': 0.7025065561072298, 'auprc': 0.9270904170025955, 'loss_val': 0.6474005940680629, 'psi': 0.7923401004653761}-{'f1_val': 0.43821571827691713, 'auprc': 0.8210991036348259, 'loss_val': 0.8253119704135092, 'psi': 0.5913690724200806}
[S11] START round=7 head_norm_before_train=1.313112 (no previous merge yet)
[S11] round=7 local utility u=1.000000 metrics={'f1_val': 0.39655223592620625, 'auprc': 0.9979676620475686, 'loss_val': 0.8016541061763235, 'psi': 0.6371184063747511}-{'f1_val': 0.14041368337311058, 'auprc': 0.8630003163190845, 'loss_val': 0.9807170335375828, 'psi': 0.42944833655150016}
[S13] START round=7 head_norm_before_train=1.308598 (no previous merge yet)
[S13] round=7 local utility u=0.025211 metrics={'f1_val': 0.416200286011302, 'auprc': 0.572988865300916, 'loss_val': 0.8660674234946298, 'psi': 0.4789157177271476}-{'f1_val': 0.4163965282706411, 'auprc': 0.5909610454698482, 'loss_val': 0.9715834337187027, 'psi': 0.486222335150324}
[S14] START round=7 head_norm_before_train=0.825655 cos_to_last_merge=0.9970 (last merge round=5)
[S14] round=7 local utility u=1.000000 metrics={'f1_val': 0.39652757107859105, 'auprc': 0.8892971198134115, 'loss_val': 0.9998209191982291, 'psi': 0.5936353905725192}-{'f1_val': 0.14035785288270378, 'auprc': 0.7560192288470379, 'loss_val': 1.1600450795356996, 'psi': 0.38662240326843744}
[S15] START round=7 head_norm_before_train=0.822372 cos_to_last_merge=0.9853 (last merge round=4)
[S15] round=7 local utility u=0.442195 metrics={'f1_val': 0.27429640608988437, 'auprc': 0.7774681991817616, 'loss_val': 1.1352206868834709, 'psi': 0.47556512332663525}-{'f1_val': 0.13973365136155833, 'auprc': 0.7780267363523002, 'loss_val': 1.2139093620622678, 'psi': 0.3950508853578551}
[S16] START round=7 head_norm_before_train=0.695764 cos_to_last_merge=1.0000 (last merge round=6)
[S16] round=7 local utility u=0.778610 metrics={'f1_val': 0.4136115372358953, 'auprc': 0.5555148452413674, 'loss_val': 1.1275083915716018, 'psi': 0.47037286043808413}-{'f1_val': 0.14063745019920318, 'auprc': 0.6123579984251137, 'loss_val': 1.2174138878447776, 'psi': 0.32932566948956743}
[S17] START round=7 head_norm_before_train=0.961273 cos_to_last_merge=0.9440 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.944
[S17] round=7 local utility u=0.059375 metrics={'f1_val': 0.3641185314912927, 'auprc': 0.6916540446239344, 'loss_val': 0.9176379082619982, 'psi': 0.4951327367443494}-{'f1_val': 0.39178269178899605, 'auprc': 0.622720123525388, 'loss_val': 0.9955707720359847, 'psi': 0.4841576644835528}
[S11] not sending this round → trigger blocked (psi=0.637)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] → sending delta(kind=head bytes=1792) to S15@127.0.0.1:44615
[S6] not sending this round → trigger blocked (psi=0.519)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S2] → sending delta(kind=head bytes=1792) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S9@127.0.0.1:44610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:44615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:44604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:44609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] → sending delta(kind=head bytes=1792) to S5@127.0.0.1:44605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:44610
[S4] sending update (kind=head size=1792 to 1 peers)
[S15] sending update (kind=head size=1793 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1805 to 1 peers)
[S2] sending update (kind=head size=1792 to 1 peers)
[S14] sending update (kind=head size=1792 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1792) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.880929)
[S15] loaded HEAD from S14 (vec_in norm=0.880929)
[S15] cosine check vs S14: cos=0.7340
[S15] BUFFERED delta from S14 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1803) from S8
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.625947)
[S4] loaded HEAD from S8 (vec_in norm=0.625947)
[S4] cosine check vs S8: cos=0.2517
[S4] BUFFERED delta from S8 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1801) from S13
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.337354)
[S14] loaded HEAD from S13 (vec_in norm=1.337354)
[S14] cosine check vs S13: cos=-0.0774
[S14] DROPPED delta from S13 (cos=-0.0774 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1793) from S15
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.849011)
[S8] loaded HEAD from S15 (vec_in norm=0.849011)
[S8] cosine check vs S15: cos=0.7393
[S8] BUFFERED delta from S15 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1797) from S7
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.841782)
[S16] loaded HEAD from S7 (vec_in norm=0.841782)
[S16] cosine check vs S7: cos=0.3737
[S16] BUFFERED delta from S7 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1792) from S4
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.842839)
[S5] loaded HEAD from S4 (vec_in norm=0.842839)
[S5] cosine check vs S4: cos=0.3582
[S5] BUFFERED delta from S4 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1798) from S3
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.301323)
[S14] loaded HEAD from S3 (vec_in norm=1.301323)
[S14] cosine check vs S3: cos=0.3921
[S14] BUFFERED delta from S3 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1792) from S2
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.373790)
[S16] loaded HEAD from S2 (vec_in norm=1.373790)
[S16] cosine check vs S2: cos=-0.0599
[S16] DROPPED delta from S2 (cos=-0.0599 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1800) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.741284)
[S9] loaded HEAD from S5 (vec_in norm=0.741284)
[S9] cosine check vs S5: cos=0.5488
[S9] BUFFERED delta from S5 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1805) from S10
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.386741)
[S9] loaded HEAD from S10 (vec_in norm=1.386741)
[S9] cosine check vs S10: cos=0.7063
[S9] BUFFERED delta from S10 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1798) from S16
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.729103)
[S15] loaded HEAD from S16 (vec_in norm=0.729103)
[S15] cosine check vs S16: cos=0.5951
[S15] BUFFERED delta from S16 (total buffered=2)
[S17] not sending this round → trigger blocked (psi=0.495)
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=7 metric=0.1414 head_norm=0.721240
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.006671e-01
[S9] stored merged vector for next round verification (round=7)
[S9] DEBUG after merge:  round=7 metric=0.1604 head_norm=0.734981 delta_norm=0.200667
[S9] aggregate: ACCEPT kept=['S5', 'S10'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=7 metric=0.2749 head_norm=0.625947
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.858709e-01
[S8] stored merged vector for next round verification (round=7)
[S8] DEBUG after merge:  round=7 metric=0.1975 head_norm=0.688907 delta_norm=0.285871
[S8] aggregate: ROLLBACK (f1_val pre=0.275 post=0.197 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=7 metric=0.4136 head_norm=0.729103
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.420099e-01
[S16] stored merged vector for next round verification (round=7)
[S16] DEBUG after merge:  round=7 metric=0.4159 head_norm=0.651706 delta_norm=0.442010
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=7 metric=0.2743 head_norm=0.849011
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.257595e-01
[S15] stored merged vector for next round verification (round=7)
[S15] DEBUG after merge:  round=7 metric=0.3205 head_norm=0.713878 delta_norm=0.225760
[S15] aggregate: ACCEPT kept=['S14', 'S16'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=7 metric=0.4176 head_norm=0.741284
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.506467e-01
[S5] stored merged vector for next round verification (round=7)
[S5] DEBUG after merge:  round=7 metric=0.4176 head_norm=0.653343 delta_norm=0.450647
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=7 metric=0.3965 head_norm=0.880929
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.266081e-01
[S14] stored merged vector for next round verification (round=7)
[S14] DEBUG after merge:  round=7 metric=0.3965 head_norm=0.917661 delta_norm=0.626608
[S14] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=7 metric=0.1402 head_norm=0.842839
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.573332e-01
[S4] stored merged vector for next round verification (round=7)
[S4] DEBUG after merge:  round=7 metric=0.1402 head_norm=0.584757 delta_norm=0.457333
[S4] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=1.373790 (no previous merge yet)
[S2] round=8 local utility u=0.726534 metrics={'f1_val': 0.6420531654281249, 'auprc': 0.7764673755692677, 'loss_val': 0.7601952073822937, 'psi': 0.6958188494845821}-{'f1_val': 0.41639397765096375, 'auprc': 0.7781514957112703, 'loss_val': 0.864360580708599, 'psi': 0.5610969848750864}
[S3] START round=8 head_norm_before_train=1.301323 (no previous merge yet)
[S3] round=8 local utility u=0.457466 metrics={'f1_val': 0.5176485091717771, 'auprc': 0.9977070389963266, 'loss_val': 0.7552198614893487, 'psi': 0.7096719211015969}-{'f1_val': 0.3963275517403211, 'auprc': 0.9646398823938833, 'loss_val': 0.8430247458326273, 'psi': 0.623652484001746}
[S4] START round=8 head_norm_before_train=0.584757 cos_to_last_merge=1.0000 (last merge round=7)
[S4] round=8 local utility u=1.000000 metrics={'f1_val': 0.6870148072794671, 'auprc': 0.6518284173234901, 'loss_val': 1.0139903522200975, 'psi': 0.6729402512970762}-{'f1_val': 0.14022662889518414, 'auprc': 0.7658752148574028, 'loss_val': 1.0831676789342775, 'psi': 0.3904860632800716}
[S5] START round=8 head_norm_before_train=0.653343 cos_to_last_merge=1.0000 (last merge round=7)
[S5] round=8 local utility u=0.000000 metrics={'f1_val': 0.4174665005497404, 'auprc': 0.777104412746215, 'loss_val': 0.987361592632711, 'psi': 0.5613216654283303}-{'f1_val': 0.4175873768787894, 'auprc': 0.7772946265719834, 'loss_val': 0.9552576355939262, 'psi': 0.5614702767560671}
[S6] START round=8 head_norm_before_train=1.368295 (no previous merge yet)
[S6] round=8 local utility u=0.894661 metrics={'f1_val': 0.6226967831810499, 'auprc': 0.7945967341234424, 'loss_val': 0.6384630110849554, 'psi': 0.6914567635580069}-{'f1_val': 0.41649329522006995, 'auprc': 0.6715536596616154, 'loss_val': 0.8214354674199574, 'psi': 0.5185174409966882}
[S7] START round=8 head_norm_before_train=0.841782 cos_to_last_merge=0.9531 (last merge round=2)
[S7] round=8 local utility u=0.867717 metrics={'f1_val': 0.4168747328879592, 'auprc': 0.7914391536015152, 'loss_val': 1.0774706720974982, 'psi': 0.5667005011733817}-{'f1_val': 0.14205682272909165, 'auprc': 0.7948962477548455, 'loss_val': 1.1743679901028636, 'psi': 0.4031925927393932}
[S8] START round=8 head_norm_before_train=0.688907 cos_to_last_merge=1.0000 (last merge round=7)
[S8] round=8 local utility u=0.441635 metrics={'f1_val': 0.41636011246908367, 'auprc': 0.7769148400998068, 'loss_val': 1.1287733154728834, 'psi': 0.5605820035213729}-{'f1_val': 0.27492551823627187, 'auprc': 0.7769752491075842, 'loss_val': 1.1636175095152375, 'psi': 0.4757454105847968}
[S9] START round=8 head_norm_before_train=0.734981 cos_to_last_merge=1.0000 (last merge round=7)
[S9] round=8 local utility u=0.159368 metrics={'f1_val': 0.18818956349545893, 'auprc': 0.7118116481560425, 'loss_val': 0.9598821986600888, 'psi': 0.39763839735969236}-{'f1_val': 0.141397957139996, 'auprc': 0.7307035102569672, 'loss_val': 1.0545432413822962, 'psi': 0.3771201783867845}
[S10] START round=8 head_norm_before_train=1.386741 (no previous merge yet)
[S10] round=8 local utility u=0.168913 metrics={'f1_val': 0.6998705291795504, 'auprc': 0.9915066898875449, 'loss_val': 0.4870074764094443, 'psi': 0.8165249934627482}-{'f1_val': 0.7025065561072298, 'auprc': 0.9270904170025955, 'loss_val': 0.6474005940680629, 'psi': 0.7923401004653761}
[S11] START round=8 head_norm_before_train=1.357464 (no previous merge yet)
[S11] round=8 local utility u=0.080161 metrics={'f1_val': 0.39992541946910537, 'auprc': 0.9986126358643304, 'loss_val': 0.6635065385611918, 'psi': 0.6394003060271953}-{'f1_val': 0.39655223592620625, 'auprc': 0.9979676620475686, 'loss_val': 0.8016541061763235, 'psi': 0.6371184063747511}
[S13] START round=8 head_norm_before_train=1.337354 (no previous merge yet)
[S13] round=8 local utility u=0.959612 metrics={'f1_val': 0.6686762017862689, 'auprc': 0.686566411246921, 'loss_val': 0.8024321070071885, 'psi': 0.6758322855705297}-{'f1_val': 0.416200286011302, 'auprc': 0.572988865300916, 'loss_val': 0.8660674234946298, 'psi': 0.4789157177271476}
[S14] START round=8 head_norm_before_train=0.917661 cos_to_last_merge=1.0000 (last merge round=7)
[S14] round=8 local utility u=0.134929 metrics={'f1_val': 0.39656053564365834, 'auprc': 0.9564553737975761, 'loss_val': 0.9316351025472265, 'psi': 0.6205184709052255}-{'f1_val': 0.39652757107859105, 'auprc': 0.8892971198134115, 'loss_val': 0.9998209191982291, 'psi': 0.5936353905725192}
[S15] START round=8 head_norm_before_train=0.713878 cos_to_last_merge=1.0000 (last merge round=7)
[S15] round=8 local utility u=0.466768 metrics={'f1_val': 0.4163758395072774, 'auprc': 0.7769703932724644, 'loss_val': 1.0526671165637567, 'psi': 0.5606136610133522}-{'f1_val': 0.27429640608988437, 'auprc': 0.7774681991817616, 'loss_val': 1.1352206868834709, 'psi': 0.47556512332663525}
[S16] START round=8 head_norm_before_train=0.651706 cos_to_last_merge=1.0000 (last merge round=7)
[S16] round=8 local utility u=0.091814 metrics={'f1_val': 0.43601209605537106, 'auprc': 0.5598816087945201, 'loss_val': 1.0913832704074493, 'psi': 0.48555990115103065}-{'f1_val': 0.4136115372358953, 'auprc': 0.5555148452413674, 'loss_val': 1.1275083915716018, 'psi': 0.47037286043808413}
[S17] START round=8 head_norm_before_train=1.011664 cos_to_last_merge=0.9254 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.925
[S17] round=8 local utility u=0.165017 metrics={'f1_val': 0.35317697866335995, 'auprc': 0.8112715736587177, 'loss_val': 0.8808080365484374, 'psi': 0.536414816661503}-{'f1_val': 0.3641185314912927, 'auprc': 0.6916540446239344, 'loss_val': 0.9176379082619982, 'psi': 0.4951327367443494}
[S3] not sending this round → trigger blocked (psi=0.710)
[S10] not sending this round → trigger blocked (psi=0.817)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:44616
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S6] → sending delta(kind=head bytes=1788) to S4@127.0.0.1:44604
[S4] not sending this round → trigger blocked (psi=0.673)
[S8] not sending this round → trigger blocked (psi=0.561)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:44614
[S2] not sending this round → trigger blocked (psi=0.696)
[S7] not sending this round → trigger blocked (psi=0.567)
[S14] not sending this round → trigger blocked (psi=0.621)
[S15] not sending this round → trigger blocked (psi=0.561)
[S9] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1788 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1800) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.772257)
[S14] loaded HEAD from S9 (vec_in norm=0.772257)
[S14] cosine check vs S9: cos=0.1515
[S14] BUFFERED delta from S9 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1801) from S11
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.410572)
[S16] loaded HEAD from S11 (vec_in norm=1.410572)
[S16] cosine check vs S11: cos=-0.0104
[S16] DROPPED delta from S11 (cos=-0.0104 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1788) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.409865)
[S4] loaded HEAD from S6 (vec_in norm=1.409865)
[S4] cosine check vs S6: cos=0.6226
[S4] BUFFERED delta from S6 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:44615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S17] → sending delta(kind=head bytes=1791) to S16@127.0.0.1:44616
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] sending update (kind=head size=1791 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1799) from S16
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.684628)
[S15] loaded HEAD from S16 (vec_in norm=0.684628)
[S15] cosine check vs S16: cos=0.7167
[S15] BUFFERED delta from S16 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1791) from S17
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.059461)
[S16] loaded HEAD from S17 (vec_in norm=1.059461)
[S16] cosine check vs S17: cos=0.5341
[S16] BUFFERED delta from S17 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:44614
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1802) from S13
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.364397)
[S14] loaded HEAD from S13 (vec_in norm=1.364397)
[S14] cosine check vs S13: cos=-0.1073
[S14] DROPPED delta from S13 (cos=-0.1073 < 0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=8 metric=0.4164 head_norm=0.749798
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.716378e-01
[S15] stored merged vector for next round verification (round=8)
[S15] DEBUG after merge:  round=8 metric=0.4166 head_norm=0.664582 delta_norm=0.271638
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=8 metric=0.4360 head_norm=0.684628
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.517576e-01
[S16] stored merged vector for next round verification (round=8)
[S16] DEBUG after merge:  round=8 metric=0.4173 head_norm=0.769091 delta_norm=0.451758
[S16] aggregate: ROLLBACK (f1_val pre=0.436 post=0.417 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=8 metric=0.3966 head_norm=0.955960
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.671166e-01
[S14] stored merged vector for next round verification (round=8)
[S14] DEBUG after merge:  round=8 metric=0.3966 head_norm=0.658406 delta_norm=0.567117
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=8 metric=0.6870 head_norm=0.624690
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.659720e-01
[S4] stored merged vector for next round verification (round=8)
[S4] DEBUG after merge:  round=8 metric=0.3694 head_norm=0.932016 delta_norm=0.565972
[S4] aggregate: ROLLBACK (f1_val pre=0.687 post=0.369 tol_abs=0.005 tol_rel=0.0)
[S2] START round=9 head_norm_before_train=1.419126 (no previous merge yet)
[S2] round=9 local utility u=0.059073 metrics={'f1_val': 0.6560950844976662, 'auprc': 0.776151211147877, 'loss_val': 0.7253528014625362, 'psi': 0.7041175351577504}-{'f1_val': 0.6420531654281249, 'auprc': 0.7764673755692677, 'loss_val': 0.7601952073822937, 'psi': 0.6958188494845821}
[S3] START round=9 head_norm_before_train=1.350766 (no previous merge yet)
[S3] round=9 local utility u=0.350094 metrics={'f1_val': 0.6110235738512705, 'auprc': 0.9987067093356072, 'loss_val': 0.6182813671654035, 'psi': 0.7660968280450051}-{'f1_val': 0.5176485091717771, 'auprc': 0.9977070389963266, 'loss_val': 0.7552198614893487, 'psi': 0.7096719211015969}
[S4] START round=9 head_norm_before_train=0.932016 cos_to_last_merge=1.0000 (last merge round=8)
[S4] round=9 local utility u=0.000000 metrics={'f1_val': 0.6689876652477488, 'auprc': 0.6401433235288905, 'loss_val': 0.9158137900767166, 'psi': 0.6574499285602055}-{'f1_val': 0.6870148072794671, 'auprc': 0.6518284173234901, 'loss_val': 1.0139903522200975, 'psi': 0.6729402512970762}
[S5] START round=9 head_norm_before_train=0.688964 cos_to_last_merge=0.9911 (last merge round=7)
[S5] round=9 local utility u=0.432715 metrics={'f1_val': 0.42585596950784227, 'auprc': 0.9972377460463766, 'loss_val': 0.8326688095528416, 'psi': 0.654408680123256}-{'f1_val': 0.4174665005497404, 'auprc': 0.777104412746215, 'loss_val': 0.987361592632711, 'psi': 0.5613216654283303}
[S6] START round=9 head_norm_before_train=1.409865 (no previous merge yet)
[S6] round=9 local utility u=0.253967 metrics={'f1_val': 0.6887663677355819, 'auprc': 0.7936772313963748, 'loss_val': 0.5241889086248597, 'psi': 0.730730713199899}-{'f1_val': 0.6226967831810499, 'auprc': 0.7945967341234424, 'loss_val': 0.6384630110849554, 'psi': 0.6914567635580069}
[S7] START round=9 head_norm_before_train=0.863515 cos_to_last_merge=0.9426 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.943
[S7] round=9 local utility u=0.848888 metrics={'f1_val': 0.687932686355395, 'auprc': 0.7706937114912177, 'loss_val': 0.9438050863100825, 'psi': 0.721037096409724}-{'f1_val': 0.4168747328879592, 'auprc': 0.7914391536015152, 'loss_val': 1.0774706720974982, 'psi': 0.5667005011733817}
[S8] START round=9 head_norm_before_train=0.710538 cos_to_last_merge=0.9948 (last merge round=7)
[S8] round=9 local utility u=0.000000 metrics={'f1_val': 0.3728657005221765, 'auprc': 0.7766310388298833, 'loss_val': 0.9997796447583626, 'psi': 0.5343718358452592}-{'f1_val': 0.41636011246908367, 'auprc': 0.7769148400998068, 'loss_val': 1.1287733154728834, 'psi': 0.5605820035213729}
[S9] START round=9 head_norm_before_train=0.772257 cos_to_last_merge=0.9935 (last merge round=7)
[S9] round=9 local utility u=1.000000 metrics={'f1_val': 0.4018387807624859, 'auprc': 0.9799562125727441, 'loss_val': 0.8280797879589387, 'psi': 0.6330857534865892}-{'f1_val': 0.18818956349545893, 'auprc': 0.7118116481560425, 'loss_val': 0.9598821986600888, 'psi': 0.39763839735969236}
[S10] START round=9 head_norm_before_train=1.436231 (no previous merge yet)
[S10] round=9 local utility u=0.006989 metrics={'f1_val': 0.6885225916155341, 'auprc': 0.9835257483438883, 'loss_val': 0.38099879440092294, 'psi': 0.8065238543068758}-{'f1_val': 0.6998705291795504, 'auprc': 0.9915066898875449, 'loss_val': 0.4870074764094443, 'psi': 0.8165249934627482}
[S11] START round=9 head_norm_before_train=1.410572 (no previous merge yet)
[S11] round=9 local utility u=0.995334 metrics={'f1_val': 0.701890640953942, 'auprc': 0.9979059967198901, 'loss_val': 0.48251016336574776, 'psi': 0.8202967832603213}-{'f1_val': 0.39992541946910537, 'auprc': 0.9986126358643304, 'loss_val': 0.6635065385611918, 'psi': 0.6394003060271953}
[S13] START round=9 head_norm_before_train=1.364397 (no previous merge yet)
[S13] round=9 local utility u=0.021897 metrics={'f1_val': 0.6387827651634789, 'auprc': 0.7374350527292772, 'loss_val': 0.7318834624330961, 'psi': 0.6782436801897982}-{'f1_val': 0.6686762017862689, 'auprc': 0.686566411246921, 'loss_val': 0.8024321070071885, 'psi': 0.6758322855705297}
[S14] START round=9 head_norm_before_train=0.658406 cos_to_last_merge=1.0000 (last merge round=8)
[S14] round=9 local utility u=0.021901 metrics={'f1_val': 0.39656053564365834, 'auprc': 0.9579262867610021, 'loss_val': 0.8922449358194351, 'psi': 0.6211068360905959}-{'f1_val': 0.39656053564365834, 'auprc': 0.9564553737975761, 'loss_val': 0.9316351025472265, 'psi': 0.6205184709052255}
[S15] START round=9 head_norm_before_train=0.664582 cos_to_last_merge=1.0000 (last merge round=8)
[S15] round=9 local utility u=0.088590 metrics={'f1_val': 0.41714217784117924, 'auprc': 0.7906873677222755, 'loss_val': 0.921236979504079, 'psi': 0.5665602537936179}-{'f1_val': 0.4163758395072774, 'auprc': 0.7769703932724644, 'loss_val': 1.0526671165637567, 'psi': 0.5606136610133522}
[S16] START round=9 head_norm_before_train=0.769091 cos_to_last_merge=1.0000 (last merge round=8)
[S16] round=9 local utility u=0.000000 metrics={'f1_val': 0.40924151870619435, 'auprc': 0.5585928401871088, 'loss_val': 1.0109110270987007, 'psi': 0.4689820472985601}-{'f1_val': 0.43601209605537106, 'auprc': 0.5598816087945201, 'loss_val': 1.0913832704074493, 'psi': 0.48555990115103065}
[S17] START round=9 head_norm_before_train=1.059461 cos_to_last_merge=0.9068 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.907
[S17] round=9 local utility u=0.000000 metrics={'f1_val': 0.34348281876587505, 'auprc': 0.8850812522435088, 'loss_val': 1.0936264745597586, 'psi': 0.5601221921569286}-{'f1_val': 0.35317697866335995, 'auprc': 0.8112715736587177, 'loss_val': 0.8808080365484374, 'psi': 0.536414816661503}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:44616
[S2] sending update (kind=head size=1800 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1800) from S2
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.468225)
[S16] loaded HEAD from S2 (vec_in norm=1.468225)
[S16] cosine check vs S2: cos=-0.0632
[S16] DROPPED delta from S2 (cos=-0.0632 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:44610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:44614
[S11] sending update (kind=head size=1800 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1800) from S11
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.462590)
[S16] loaded HEAD from S11 (vec_in norm=1.462590)
[S16] cosine check vs S11: cos=-0.0394
[S16] DROPPED delta from S11 (cos=-0.0394 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:44609
[S13] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:44604
[S9] RECEIVED delta(kind=head bytes=1798) from S10
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.486350)
[S9] loaded HEAD from S10 (vec_in norm=1.486350)
[S9] cosine check vs S10: cos=0.7521
[S9] BUFFERED delta from S10 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1801) from S13
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.396228)
[S14] loaded HEAD from S13 (vec_in norm=1.396228)
[S14] cosine check vs S13: cos=-0.1347
[S14] DROPPED delta from S13 (cos=-0.1347 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1796) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.820705)
[S14] loaded HEAD from S9 (vec_in norm=0.820705)
[S14] cosine check vs S9: cos=0.6666
[S14] BUFFERED delta from S9 (total buffered=1)
[S15] sending update (kind=head size=1798 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S15
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.713122)
[S8] loaded HEAD from S15 (vec_in norm=0.713122)
[S8] cosine check vs S15: cos=0.8088
[S8] BUFFERED delta from S15 (total buffered=1)
[S6] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1797) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.450479)
[S4] loaded HEAD from S6 (vec_in norm=1.450479)
[S4] cosine check vs S6: cos=0.9410
[S4] BUFFERED delta from S6 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1796) from S3
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.405683)
[S14] loaded HEAD from S3 (vec_in norm=1.405683)
[S14] cosine check vs S3: cos=0.6119
[S14] BUFFERED delta from S3 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:44615
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1796) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.706460)
[S15] loaded HEAD from S14 (vec_in norm=0.706460)
[S15] cosine check vs S14: cos=0.4951
[S15] BUFFERED delta from S14 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:44616
[S7] sending update (kind=head size=1801 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1801) from S7
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.896478)
[S16] loaded HEAD from S7 (vec_in norm=0.896478)
[S16] cosine check vs S7: cos=0.3908
[S16] BUFFERED delta from S7 (total buffered=1)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:44610
[S5] sending update (kind=head size=1796 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1796) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.732835)
[S9] loaded HEAD from S5 (vec_in norm=0.732835)
[S9] cosine check vs S5: cos=0.4681
[S9] BUFFERED delta from S5 (total buffered=2)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=9 metric=0.6690 head_norm=0.966096
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.162055e-01
[S4] stored merged vector for next round verification (round=9)
[S4] DEBUG after merge:  round=9 metric=0.4292 head_norm=1.191062 delta_norm=0.316205
[S4] aggregate: ROLLBACK (f1_val pre=0.669 post=0.429 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=9 metric=0.4018 head_norm=0.820705
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.032355e-01
[S9] stored merged vector for next round verification (round=9)
[S9] DEBUG after merge:  round=9 metric=0.4018 head_norm=0.800515 delta_norm=0.203236
[S9] aggregate: ACCEPT kept=['S10', 'S5'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=9 metric=0.3729 head_norm=0.748938
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.266680e-01
[S8] stored merged vector for next round verification (round=9)
[S8] DEBUG after merge:  round=9 metric=0.3727 head_norm=0.695232 delta_norm=0.226668
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=9 metric=0.4171 head_norm=0.713122
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.566476e-01
[S15] stored merged vector for next round verification (round=9)
[S15] DEBUG after merge:  round=9 metric=0.4170 head_norm=0.613692 delta_norm=0.356648
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=9 metric=0.4092 head_norm=0.814161
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.732876e-01
[S16] stored merged vector for next round verification (round=9)
[S16] DEBUG after merge:  round=9 metric=0.4064 head_norm=0.713628 delta_norm=0.473288
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=9 metric=0.3966 head_norm=0.706460
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.199241e-01
[S14] stored merged vector for next round verification (round=9)
[S14] DEBUG after merge:  round=9 metric=0.6913 head_norm=0.738545 delta_norm=0.219924
[S14] aggregate: ACCEPT kept=['S9', 'S3'] (k=2/2) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.468225 (no previous merge yet)
[S2] round=10 local utility u=0.295749 metrics={'f1_val': 0.7121169467422572, 'auprc': 0.7937656752928024, 'loss_val': 0.5228285154684865, 'psi': 0.7447764381624753}-{'f1_val': 0.6560950844976662, 'auprc': 0.776151211147877, 'loss_val': 0.7253528014625362, 'psi': 0.7041175351577504}
[S3] START round=10 head_norm_before_train=1.405683 (no previous merge yet)
[S3] round=10 local utility u=0.085148 metrics={'f1_val': 0.623187803505786, 'auprc': 0.9988756034711207, 'loss_val': 0.5214773678477271, 'psi': 0.7734629234919199}-{'f1_val': 0.6110235738512705, 'auprc': 0.9987067093356072, 'loss_val': 0.6182813671654035, 'psi': 0.7660968280450051}
[S4] START round=10 head_norm_before_train=1.191062 cos_to_last_merge=1.0000 (last merge round=9)
[S4] round=10 local utility u=0.076700 metrics={'f1_val': 0.6657961197534716, 'auprc': 0.6678412931568112, 'loss_val': 0.8263585978112293, 'psi': 0.6666141891148074}-{'f1_val': 0.6689876652477488, 'auprc': 0.6401433235288905, 'loss_val': 0.9158137900767166, 'psi': 0.6574499285602055}
[S5] START round=10 head_norm_before_train=0.732835 cos_to_last_merge=0.9692 (last merge round=7)
[S5] round=10 local utility u=0.000000 metrics={'f1_val': 0.41770670426636225, 'auprc': 0.7305448600175599, 'loss_val': 0.7890564574346793, 'psi': 0.5428419665668414}-{'f1_val': 0.42585596950784227, 'auprc': 0.9972377460463766, 'loss_val': 0.8326688095528416, 'psi': 0.654408680123256}
[S6] START round=10 head_norm_before_train=1.450479 (no previous merge yet)
[S6] round=10 local utility u=0.075601 metrics={'f1_val': 0.7072428994429236, 'auprc': 0.7854408486379706, 'loss_val': 0.4591364517199854, 'psi': 0.7385220791209424}-{'f1_val': 0.6887663677355819, 'auprc': 0.7936772313963748, 'loss_val': 0.5241889086248597, 'psi': 0.730730713199899}
[S7] START round=10 head_norm_before_train=0.896478 cos_to_last_merge=0.9263 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.926
[S7] round=10 local utility u=0.053735 metrics={'f1_val': 0.6817961501774796, 'auprc': 0.7905594584613861, 'loss_val': 0.8591135397953306, 'psi': 0.7253014734910422}-{'f1_val': 0.687932686355395, 'auprc': 0.7706937114912177, 'loss_val': 0.9438050863100825, 'psi': 0.721037096409724}
[S8] START round=10 head_norm_before_train=0.695232 cos_to_last_merge=1.0000 (last merge round=9)
[S8] round=10 local utility u=0.000000 metrics={'f1_val': 0.37319932875242556, 'auprc': 0.6438923126908935, 'loss_val': 0.941808154651125, 'psi': 0.48147652232781274}-{'f1_val': 0.3728657005221765, 'auprc': 0.7766310388298833, 'loss_val': 0.9997796447583626, 'psi': 0.5343718358452592}
[S9] START round=10 head_norm_before_train=0.800515 cos_to_last_merge=1.0000 (last merge round=9)
[S9] round=10 local utility u=0.027321 metrics={'f1_val': 0.4018387807624859, 'auprc': 0.9892491516423867, 'loss_val': 0.8013171205431318, 'psi': 0.6368029291144462}-{'f1_val': 0.4018387807624859, 'auprc': 0.9799562125727441, 'loss_val': 0.8280797879589387, 'psi': 0.6330857534865892}
[S10] START round=10 head_norm_before_train=1.486350 (no previous merge yet)
[S10] round=10 local utility u=0.004353 metrics={'f1_val': 0.6798045954023724, 'auprc': 0.9869004778920973, 'loss_val': 0.33010925457951057, 'psi': 0.8026429483982624}-{'f1_val': 0.6885225916155341, 'auprc': 0.9835257483438883, 'loss_val': 0.38099879440092294, 'psi': 0.8065238543068758}
[S11] START round=10 head_norm_before_train=1.462590 (no previous merge yet)
[S11] round=10 local utility u=0.048918 metrics={'f1_val': 0.7020007759458987, 'auprc': 0.9981892163714443, 'loss_val': 0.3861855105815427, 'psi': 0.820476152116117}-{'f1_val': 0.701890640953942, 'auprc': 0.9979059967198901, 'loss_val': 0.48251016336574776, 'psi': 0.8202967832603213}
[S13] START round=10 head_norm_before_train=1.396228 (no previous merge yet)
[S13] round=10 local utility u=0.257682 metrics={'f1_val': 0.7109359514561793, 'auprc': 0.747267442047698, 'loss_val': 0.6789360009059829, 'psi': 0.7254685476927868}-{'f1_val': 0.6387827651634789, 'auprc': 0.7374350527292772, 'loss_val': 0.7318834624330961, 'psi': 0.6782436801897982}
[S14] START round=10 head_norm_before_train=0.738545 cos_to_last_merge=1.0000 (last merge round=9)
[S14] round=10 local utility u=0.731309 metrics={'f1_val': 0.6411983815048126, 'auprc': 0.9433950689506078, 'loss_val': 0.8538609945721473, 'psi': 0.7620770564831306}-{'f1_val': 0.39656053564365834, 'auprc': 0.9579262867610021, 'loss_val': 0.8922449358194351, 'psi': 0.6211068360905959}
[S15] START round=10 head_norm_before_train=0.613692 cos_to_last_merge=1.0000 (last merge round=9)
[S15] round=10 local utility u=0.027074 metrics={'f1_val': 0.41680775938714587, 'auprc': 0.7996658688047446, 'loss_val': 0.8920179052716299, 'psi': 0.5699510031541853}-{'f1_val': 0.41714217784117924, 'auprc': 0.7906873677222755, 'loss_val': 0.921236979504079, 'psi': 0.5665602537936179}
[S16] START round=10 head_norm_before_train=0.713628 cos_to_last_merge=1.0000 (last merge round=9)
[S16] round=10 local utility u=0.287792 metrics={'f1_val': 0.43690425558262214, 'auprc': 0.6884687709950976, 'loss_val': 0.9909321616027911, 'psi': 0.5375300617476123}-{'f1_val': 0.40924151870619435, 'auprc': 0.5585928401871088, 'loss_val': 1.0109110270987007, 'psi': 0.4689820472985601}
[S17] START round=10 head_norm_before_train=1.096682 cos_to_last_merge=0.8909 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.891
[S17] round=10 local utility u=0.000000 metrics={'f1_val': 0.34227591727186035, 'auprc': 0.7476164579900683, 'loss_val': 1.043890233564795, 'psi': 0.5044121335591436}-{'f1_val': 0.34348281876587505, 'auprc': 0.8850812522435088, 'loss_val': 1.0936264745597586, 'psi': 0.5601221921569286}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:44616
[S11] sending update (kind=head size=1803 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1803) from S11
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.509320)
[S16] loaded HEAD from S11 (vec_in norm=1.509320)
[S16] cosine check vs S11: cos=-0.0255
[S16] DROPPED delta from S11 (cos=-0.0255 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:44605
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1800) from S4
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.223973)
[S5] loaded HEAD from S4 (vec_in norm=1.223973)
[S5] cosine check vs S4: cos=0.6209
[S5] BUFFERED delta from S4 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:44604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:44616
[S6] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:44615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:44610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:44614
[S4] RECEIVED delta(kind=head bytes=1798) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.492684)
[S4] loaded HEAD from S6 (vec_in norm=1.492684)
[S4] cosine check vs S6: cos=0.9763
[S4] BUFFERED delta from S6 (total buffered=1)
[S10] sending update (kind=head size=1794 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1802) from S13
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.429546)
[S14] loaded HEAD from S13 (vec_in norm=1.429546)
[S14] cosine check vs S13: cos=-0.1433
[S14] DROPPED delta from S13 (cos=-0.1433 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1794) from S10
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.528690)
[S9] loaded HEAD from S10 (vec_in norm=1.528690)
[S9] cosine check vs S10: cos=0.8115
[S9] BUFFERED delta from S10 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1799) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.846438)
[S14] loaded HEAD from S9 (vec_in norm=0.846438)
[S14] cosine check vs S9: cos=0.5859
[S14] BUFFERED delta from S9 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1800) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.782931)
[S15] loaded HEAD from S14 (vec_in norm=0.782931)
[S15] cosine check vs S14: cos=0.7842
[S15] BUFFERED delta from S14 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1801) from S7
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.943375)
[S16] loaded HEAD from S7 (vec_in norm=0.943375)
[S16] cosine check vs S7: cos=0.8195
[S16] BUFFERED delta from S7 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:44615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:44609
[S3] sending update (kind=head size=1800 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1800) from S3
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.462670)
[S14] loaded HEAD from S3 (vec_in norm=1.462670)
[S14] cosine check vs S3: cos=0.7511
[S14] BUFFERED delta from S3 (total buffered=2)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1801 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1801) from S2
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.523678)
[S16] loaded HEAD from S2 (vec_in norm=1.523678)
[S16] cosine check vs S2: cos=-0.0555
[S16] DROPPED delta from S2 (cos=-0.0555 < 0.0)
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S15
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.664966)
[S8] loaded HEAD from S15 (vec_in norm=0.664966)
[S8] cosine check vs S15: cos=0.8053
[S8] BUFFERED delta from S15 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1799) from S16
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.759042)
[S15] loaded HEAD from S16 (vec_in norm=0.759042)
[S15] cosine check vs S16: cos=0.7899
[S15] BUFFERED delta from S16 (total buffered=2)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=10 metric=0.4018 head_norm=0.846438
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.882027e-01
[S9] stored merged vector for next round verification (round=10)
[S9] DEBUG after merge:  round=10 metric=0.4018 head_norm=1.135048 delta_norm=0.488203
[S9] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.311 → S14@127.0.0.1:44614
[S13] ⇄ pheromone p=0.370 → S14@127.0.0.1:44614
[S10] ⇄ pheromone p=0.313 → S9@127.0.0.1:44610
[S7] ⇄ pheromone p=0.390 → S16@127.0.0.1:44616
[S11] ⇄ pheromone p=0.430 → S16@127.0.0.1:44616
[S3] ⇄ pheromone p=0.361 → S14@127.0.0.1:44614
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=10 metric=0.6412 head_norm=0.782931
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.586481e-01
[S14] stored merged vector for next round verification (round=10)
[S14] DEBUG after merge:  round=10 metric=0.6931 head_norm=0.805865 delta_norm=0.158648
[S14] aggregate: ACCEPT kept=['S9', 'S3'] (k=2/2) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.402 → S15@127.0.0.1:44615
[S2] ⇄ pheromone p=0.364 → S16@127.0.0.1:44616
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=10 metric=0.4168 head_norm=0.664966
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.353967e-01
[S15] stored merged vector for next round verification (round=10)
[S15] DEBUG after merge:  round=10 metric=0.4167 head_norm=0.649461 delta_norm=0.135397
[S15] aggregate: ACCEPT kept=['S14', 'S16'] (k=2/2) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.236 → S8@127.0.0.1:44609
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=10 metric=0.6658 head_norm=1.223973
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.991604e-01
[S4] stored merged vector for next round verification (round=10)
[S4] DEBUG after merge:  round=10 metric=0.6616 head_norm=1.350349 delta_norm=0.199160
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.287 → S5@127.0.0.1:44605
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=10 metric=0.4177 head_norm=0.775416
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.797800e-01
[S5] stored merged vector for next round verification (round=10)
[S5] DEBUG after merge:  round=10 metric=0.4177 head_norm=0.905263 delta_norm=0.479780
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.270 → S9@127.0.0.1:44610
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=10 metric=0.4369 head_norm=0.759042
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.704126e-01
[S16] stored merged vector for next round verification (round=10)
[S16] DEBUG after merge:  round=10 metric=0.4374 head_norm=0.812359 delta_norm=0.270413
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.266 → S15@127.0.0.1:44615
[S6] ⇄ pheromone p=0.354 → S4@127.0.0.1:44604
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=10 metric=0.3732 head_norm=0.736628
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.213045e-01
[S8] stored merged vector for next round verification (round=10)
[S8] DEBUG after merge:  round=10 metric=0.3731 head_norm=0.665902 delta_norm=0.221305
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.239 → S4@127.0.0.1:44604
[S17] ⇄ pheromone p=0.220 → S16@127.0.0.1:44616
[S2] START round=11 head_norm_before_train=1.523678 (no previous merge yet)
[S2] round=11 local utility u=0.027719 metrics={'f1_val': 0.7126690448526247, 'auprc': 0.7933134662029646, 'loss_val': 0.4693469682493287, 'psi': 0.7449268133927607}-{'f1_val': 0.7121169467422572, 'auprc': 0.7937656752928024, 'loss_val': 0.5228285154684865, 'psi': 0.7447764381624753}
[S3] START round=11 head_norm_before_train=1.462670 (no previous merge yet)
[S3] round=11 local utility u=0.248512 metrics={'f1_val': 0.6896793741727709, 'auprc': 0.9968172271314903, 'loss_val': 0.41722674768156515, 'psi': 0.8125345153562586}-{'f1_val': 0.623187803505786, 'auprc': 0.9988756034711207, 'loss_val': 0.5214773678477271, 'psi': 0.7734629234919199}
[S4] START round=11 head_norm_before_train=1.350349 cos_to_last_merge=1.0000 (last merge round=10)
[S4] round=11 local utility u=0.048246 metrics={'f1_val': 0.667613411445481, 'auprc': 0.6539075583832845, 'loss_val': 0.6989695276197091, 'psi': 0.6621310702206025}-{'f1_val': 0.6657961197534716, 'auprc': 0.6678412931568112, 'loss_val': 0.8263585978112293, 'psi': 0.6666141891148074}
[S5] START round=11 head_norm_before_train=0.905263 cos_to_last_merge=1.0000 (last merge round=10)
[S5] round=11 local utility u=0.000000 metrics={'f1_val': 0.41794172867608725, 'auprc': 0.6742506881479294, 'loss_val': 0.8242674030855857, 'psi': 0.5204653124648242}-{'f1_val': 0.41770670426636225, 'auprc': 0.7305448600175599, 'loss_val': 0.7890564574346793, 'psi': 0.5428419665668414}
[S6] START round=11 head_norm_before_train=1.492684 (no previous merge yet)
[S6] round=11 local utility u=0.028214 metrics={'f1_val': 0.7072428994429236, 'auprc': 0.7954113413282262, 'loss_val': 0.43261967799681117, 'psi': 0.7425102761970447}-{'f1_val': 0.7072428994429236, 'auprc': 0.7854408486379706, 'loss_val': 0.4591364517199854, 'psi': 0.7385220791209424}
[S7] START round=11 head_norm_before_train=0.943375 cos_to_last_merge=0.9049 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.905
[S7] round=11 local utility u=0.000000 metrics={'f1_val': 0.4169130971024577, 'auprc': 0.7845005750710001, 'loss_val': 0.7579351213275555, 'psi': 0.5639480882898746}-{'f1_val': 0.6817961501774796, 'auprc': 0.7905594584613861, 'loss_val': 0.8591135397953306, 'psi': 0.7253014734910422}
[S8] START round=11 head_norm_before_train=0.665902 cos_to_last_merge=1.0000 (last merge round=10)
[S8] round=11 local utility u=0.198428 metrics={'f1_val': 0.3727318090052443, 'auprc': 0.7734897033552619, 'loss_val': 0.9309392173514849, 'psi': 0.5330349667452513}-{'f1_val': 0.37319932875242556, 'auprc': 0.6438923126908935, 'loss_val': 0.941808154651125, 'psi': 0.48147652232781274}
[S9] START round=11 head_norm_before_train=1.135048 cos_to_last_merge=1.0000 (last merge round=10)
[S9] round=11 local utility u=0.000000 metrics={'f1_val': 0.4371836703972053, 'auprc': 0.783193284113688, 'loss_val': 0.8879064912672052, 'psi': 0.5755875158837984}-{'f1_val': 0.4018387807624859, 'auprc': 0.9892491516423867, 'loss_val': 0.8013171205431318, 'psi': 0.6368029291144462}
[S10] START round=11 head_norm_before_train=1.528690 (no previous merge yet)
[S10] round=11 local utility u=0.102577 metrics={'f1_val': 0.7002428651507397, 'auprc': 0.9951596309280253, 'loss_val': 0.27236320582898743, 'psi': 0.818209571461654}-{'f1_val': 0.6798045954023724, 'auprc': 0.9869004778920973, 'loss_val': 0.33010925457951057, 'psi': 0.8026429483982624}
[S11] START round=11 head_norm_before_train=1.509320 (no previous merge yet)
[S11] round=11 local utility u=0.033420 metrics={'f1_val': 0.702242488399264, 'auprc': 0.9983606145640508, 'loss_val': 0.32131058654497097, 'psi': 0.8206897388651787}-{'f1_val': 0.7020007759458987, 'auprc': 0.9981892163714443, 'loss_val': 0.3861855105815427, 'psi': 0.820476152116117}
[S13] START round=11 head_norm_before_train=1.429546 (no previous merge yet)
[S13] round=11 local utility u=0.000000 metrics={'f1_val': 0.6959144415547596, 'auprc': 0.738819720042551, 'loss_val': 0.6208530350933021, 'psi': 0.7130765529498762}-{'f1_val': 0.7109359514561793, 'auprc': 0.747267442047698, 'loss_val': 0.6789360009059829, 'psi': 0.7254685476927868}
[S14] START round=11 head_norm_before_train=0.805865 cos_to_last_merge=1.0000 (last merge round=10)
[S14] round=11 local utility u=0.195715 metrics={'f1_val': 0.6923204752948531, 'auprc': 0.9608471422693565, 'loss_val': 0.8215188311956566, 'psi': 0.7997311420846545}-{'f1_val': 0.6411983815048126, 'auprc': 0.9433950689506078, 'loss_val': 0.8538609945721473, 'psi': 0.7620770564831306}
[S15] START round=11 head_norm_before_train=0.649461 cos_to_last_merge=1.0000 (last merge round=10)
[S15] round=11 local utility u=0.385394 metrics={'f1_val': 0.43743303554081, 'auprc': 0.9849150313128493, 'loss_val': 0.8007292119226539, 'psi': 0.6564258338496257}-{'f1_val': 0.41680775938714587, 'auprc': 0.7996658688047446, 'loss_val': 0.8920179052716299, 'psi': 0.5699510031541853}
[S16] START round=11 head_norm_before_train=0.812359 cos_to_last_merge=1.0000 (last merge round=10)
[S16] round=11 local utility u=0.525090 metrics={'f1_val': 0.5508390163087036, 'auprc': 0.7904549949250528, 'loss_val': 0.9303197190345571, 'psi': 0.6466854077552433}-{'f1_val': 0.43690425558262214, 'auprc': 0.6884687709950976, 'loss_val': 0.9909321616027911, 'psi': 0.5375300617476123}
[S17] START round=11 head_norm_before_train=1.133060 cos_to_last_merge=0.8768 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.877
[S17] round=11 local utility u=0.144967 metrics={'f1_val': 0.35277981772304445, 'auprc': 0.7787712895860712, 'loss_val': 0.9104438870131205, 'psi': 0.5231764064682551}-{'f1_val': 0.34227591727186035, 'auprc': 0.7476164579900683, 'loss_val': 1.043890233564795, 'psi': 0.5044121335591436}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:44604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:44609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:44604
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:44615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:44610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:44605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:44615
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1800) from S11
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.561205)
[S16] loaded HEAD from S11 (vec_in norm=1.561205)
[S16] cosine check vs S11: cos=-0.0186
[S16] DROPPED delta from S11 (cos=-0.0186 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1803) from S3
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.509992)
[S14] loaded HEAD from S3 (vec_in norm=1.509992)
[S14] cosine check vs S3: cos=0.8078
[S14] BUFFERED delta from S3 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1799) from S16
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.852493)
[S15] loaded HEAD from S16 (vec_in norm=0.852493)
[S15] cosine check vs S16: cos=0.8387
[S15] BUFFERED delta from S16 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1799) from S10
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.560289)
[S9] loaded HEAD from S10 (vec_in norm=1.560289)
[S9] cosine check vs S10: cos=0.9562
[S9] BUFFERED delta from S10 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1798) from S15
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.705762)
[S8] loaded HEAD from S15 (vec_in norm=0.705762)
[S8] cosine check vs S15: cos=0.8859
[S8] BUFFERED delta from S15 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1799) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.526520)
[S4] loaded HEAD from S6 (vec_in norm=1.526520)
[S4] cosine check vs S6: cos=0.9850
[S4] BUFFERED delta from S6 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1798) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.845613)
[S15] loaded HEAD from S14 (vec_in norm=0.845613)
[S15] cosine check vs S14: cos=0.7790
[S15] BUFFERED delta from S14 (total buffered=2)
[S4] RECEIVED delta(kind=head bytes=1798) from S8
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.704576)
[S4] loaded HEAD from S8 (vec_in norm=0.704576)
[S4] cosine check vs S8: cos=0.0621
[S4] BUFFERED delta from S8 (total buffered=2)
[S16] RECEIVED delta(kind=head bytes=1803) from S2
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.580284)
[S16] loaded HEAD from S2 (vec_in norm=1.580284)
[S16] cosine check vs S2: cos=-0.0456
[S16] DROPPED delta from S2 (cos=-0.0456 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:44616
[S17] sending update (kind=head size=1797 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1797) from S17
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.164562)
[S16] loaded HEAD from S17 (vec_in norm=1.164562)
[S16] cosine check vs S17: cos=0.3224
[S16] BUFFERED delta from S17 (total buffered=1)
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1799) from S4
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.386701)
[S5] loaded HEAD from S4 (vec_in norm=1.386701)
[S5] cosine check vs S4: cos=0.9068
[S5] BUFFERED delta from S4 (total buffered=1)
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=11 metric=0.4374 head_norm=0.705762
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.458241e-01
[S15] stored merged vector for next round verification (round=11)
[S15] DEBUG after merge:  round=11 metric=0.4369 head_norm=0.711367 delta_norm=0.145824
[S15] aggregate: ACCEPT kept=['S16', 'S14'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=11 metric=0.6923 head_norm=0.845613
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.827543e-01
[S14] stored merged vector for next round verification (round=11)
[S14] DEBUG after merge:  round=11 metric=0.6916 head_norm=1.124508 delta_norm=0.482754
[S14] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=11 metric=0.4179 head_norm=0.936306
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.334492e-01
[S5] stored merged vector for next round verification (round=11)
[S5] DEBUG after merge:  round=11 metric=0.4174 head_norm=1.135172 delta_norm=0.333449
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=11 metric=0.6676 head_norm=1.386701
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.490873e-01
[S4] stored merged vector for next round verification (round=11)
[S4] DEBUG after merge:  round=11 metric=0.6676 head_norm=1.093024 delta_norm=0.349087
[S4] aggregate: ACCEPT kept=['S6', 'S8'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=11 metric=0.4372 head_norm=1.167749
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.799805e-01
[S9] stored merged vector for next round verification (round=11)
[S9] DEBUG after merge:  round=11 metric=0.5524 head_norm=1.349326 delta_norm=0.279980
[S9] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=11 metric=0.5508 head_norm=0.852493
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.006007e-01
[S16] stored merged vector for next round verification (round=11)
[S16] DEBUG after merge:  round=11 metric=0.5591 head_norm=0.825078 delta_norm=0.600601
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=11 metric=0.3727 head_norm=0.704576
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.684618e-01
[S8] stored merged vector for next round verification (round=11)
[S8] DEBUG after merge:  round=11 metric=0.3727 head_norm=0.684751 delta_norm=0.168462
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.580284 (no previous merge yet)
[S2] round=12 local utility u=0.024844 metrics={'f1_val': 0.7129719282621669, 'auprc': 0.7904453765628983, 'loss_val': 0.41287180731991097, 'psi': 0.7439613075824594}-{'f1_val': 0.7126690448526247, 'auprc': 0.7933134662029646, 'loss_val': 0.4693469682493287, 'psi': 0.7449268133927607}
[S3] START round=12 head_norm_before_train=1.509992 (no previous merge yet)
[S3] round=12 local utility u=0.076587 metrics={'f1_val': 0.7005813959920884, 'auprc': 0.9952795256575222, 'loss_val': 0.3248515907385301, 'psi': 0.8184606478582619}-{'f1_val': 0.6896793741727709, 'auprc': 0.9968172271314903, 'loss_val': 0.41722674768156515, 'psi': 0.8125345153562586}
[S4] START round=12 head_norm_before_train=1.093024 cos_to_last_merge=1.0000 (last merge round=11)
[S4] round=12 local utility u=0.311157 metrics={'f1_val': 0.6631679790906391, 'auprc': 0.8521063568866556, 'loss_val': 0.6445788823186396, 'psi': 0.7387433302090457}-{'f1_val': 0.667613411445481, 'auprc': 0.6539075583832845, 'loss_val': 0.6989695276197091, 'psi': 0.6621310702206025}
[S5] START round=12 head_norm_before_train=1.135172 cos_to_last_merge=1.0000 (last merge round=11)
[S5] round=12 local utility u=0.060731 metrics={'f1_val': 0.4350366818158704, 'auprc': 0.6672703998384246, 'loss_val': 0.7844350858875595, 'psi': 0.5279301690248921}-{'f1_val': 0.41794172867608725, 'auprc': 0.6742506881479294, 'loss_val': 0.8242674030855857, 'psi': 0.5204653124648242}
[S6] START round=12 head_norm_before_train=1.526520 (no previous merge yet)
[S6] round=12 local utility u=0.151908 metrics={'f1_val': 0.6720211560569112, 'auprc': 0.9471609565317718, 'loss_val': 0.37272265247393954, 'psi': 0.7820770762468554}-{'f1_val': 0.7072428994429236, 'auprc': 0.7954113413282262, 'loss_val': 0.43261967799681117, 'psi': 0.7425102761970447}
[S7] START round=12 head_norm_before_train=0.994997 cos_to_last_merge=0.8846 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.885
[S7] round=12 local utility u=0.129766 metrics={'f1_val': 0.4660517704044801, 'auprc': 0.7892973789514854, 'loss_val': 0.8076260349347385, 'psi': 0.5953500138232822}-{'f1_val': 0.4169130971024577, 'auprc': 0.7845005750710001, 'loss_val': 0.7579351213275555, 'psi': 0.5639480882898746}
[S8] START round=12 head_norm_before_train=0.684751 cos_to_last_merge=1.0000 (last merge round=11)
[S8] round=12 local utility u=0.180010 metrics={'f1_val': 0.3729316501988709, 'auprc': 0.8690329764038232, 'loss_val': 0.8587485985061667, 'psi': 0.5713721806808518}-{'f1_val': 0.3727318090052443, 'auprc': 0.7734897033552619, 'loss_val': 0.9309392173514849, 'psi': 0.5330349667452513}
[S9] START round=12 head_norm_before_train=1.349326 cos_to_last_merge=1.0000 (last merge round=11)
[S9] round=12 local utility u=0.831049 metrics={'f1_val': 0.6155135393246816, 'auprc': 0.9205183036902131, 'loss_val': 0.7077619007452313, 'psi': 0.7375154450708942}-{'f1_val': 0.4371836703972053, 'auprc': 0.783193284113688, 'loss_val': 0.8879064912672052, 'psi': 0.5755875158837984}
[S10] START round=12 head_norm_before_train=1.560289 (no previous merge yet)
[S10] round=12 local utility u=0.006618 metrics={'f1_val': 0.6942074726961521, 'auprc': 0.9976703523600711, 'loss_val': 0.2304475907990705, 'psi': 0.8155926245617198}-{'f1_val': 0.7002428651507397, 'auprc': 0.9951596309280253, 'loss_val': 0.27236320582898743, 'psi': 0.818209571461654}
[S11] START round=12 head_norm_before_train=1.561205 (no previous merge yet)
[S11] round=12 local utility u=0.043411 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9980514415429732, 'loss_val': 0.2317177857579171, 'psi': 0.8203817665961813}-{'f1_val': 0.702242488399264, 'auprc': 0.9983606145640508, 'loss_val': 0.32131058654497097, 'psi': 0.8206897388651787}
[S13] START round=12 head_norm_before_train=1.460206 (no previous merge yet)
[S13] round=12 local utility u=0.000000 metrics={'f1_val': 0.6332617297295755, 'auprc': 0.7163533028104153, 'loss_val': 0.5780350227346114, 'psi': 0.6664983589619115}-{'f1_val': 0.6959144415547596, 'auprc': 0.738819720042551, 'loss_val': 0.6208530350933021, 'psi': 0.7130765529498762}
[S14] START round=12 head_norm_before_train=1.124508 cos_to_last_merge=1.0000 (last merge round=11)
[S14] round=12 local utility u=0.059649 metrics={'f1_val': 0.6897309908321345, 'auprc': 0.9598087550409382, 'loss_val': 0.6835696870917117, 'psi': 0.797762096515656}-{'f1_val': 0.6923204752948531, 'auprc': 0.9608471422693565, 'loss_val': 0.8215188311956566, 'psi': 0.7997311420846545}
[S15] START round=12 head_norm_before_train=0.711367 cos_to_last_merge=1.0000 (last merge round=11)
[S15] round=12 local utility u=0.159765 metrics={'f1_val': 0.5607855328476277, 'auprc': 0.8150161770100871, 'loss_val': 0.7116181807354023, 'psi': 0.6624777905126115}-{'f1_val': 0.43743303554081, 'auprc': 0.9849150313128493, 'loss_val': 0.8007292119226539, 'psi': 0.6564258338496257}
[S16] START round=12 head_norm_before_train=0.825078 cos_to_last_merge=1.0000 (last merge round=11)
[S16] round=12 local utility u=0.000000 metrics={'f1_val': 0.48532723928360405, 'auprc': 0.792565372009042, 'loss_val': 0.8185269200886138, 'psi': 0.6082224923737792}-{'f1_val': 0.5508390163087036, 'auprc': 0.7904549949250528, 'loss_val': 0.9303197190345571, 'psi': 0.6466854077552433}
[S17] START round=12 head_norm_before_train=1.164562 cos_to_last_merge=0.8656 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.866
[S17] round=12 local utility u=0.000000 metrics={'f1_val': 0.3532474827953347, 'auprc': 0.7741408577104947, 'loss_val': 0.931494368769203, 'psi': 0.5216048327613987}-{'f1_val': 0.35277981772304445, 'auprc': 0.7787712895860712, 'loss_val': 0.9104438870131205, 'psi': 0.5231764064682551}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S2] → sending delta(kind=head bytes=1806) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:44605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:44609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S14] → sending delta(kind=head bytes=1791) to S15@127.0.0.1:44615
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:44610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:44604
[S10] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1791 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1804 to 1 peers)
[S2] sending update (kind=head size=1806 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1800) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.378319)
[S14] loaded HEAD from S9 (vec_in norm=1.378319)
[S14] cosine check vs S9: cos=0.1595
[S14] BUFFERED delta from S9 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1796) from S8
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.724368)
[S4] loaded HEAD from S8 (vec_in norm=0.724368)
[S4] cosine check vs S8: cos=0.2168
[S4] BUFFERED delta from S8 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1791) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.159402)
[S15] loaded HEAD from S14 (vec_in norm=1.159402)
[S15] cosine check vs S14: cos=0.7890
[S15] BUFFERED delta from S14 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1799) from S15
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.773164)
[S8] loaded HEAD from S15 (vec_in norm=0.773164)
[S8] cosine check vs S15: cos=0.9096
[S8] BUFFERED delta from S15 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1802) from S11
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.610152)
[S16] loaded HEAD from S11 (vec_in norm=1.610152)
[S16] cosine check vs S11: cos=-0.0528
[S16] DROPPED delta from S11 (cos=-0.0528 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1804) from S7
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.034992)
[S16] loaded HEAD from S7 (vec_in norm=1.034992)
[S16] cosine check vs S7: cos=0.5151
[S16] BUFFERED delta from S7 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1806) from S2
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.624225)
[S16] loaded HEAD from S2 (vec_in norm=1.624225)
[S16] cosine check vs S2: cos=-0.0484
[S16] DROPPED delta from S2 (cos=-0.0484 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1798) from S4
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.136437)
[S5] loaded HEAD from S4 (vec_in norm=1.136437)
[S5] cosine check vs S4: cos=0.9676
[S5] BUFFERED delta from S4 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1801) from S10
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.582205)
[S9] loaded HEAD from S10 (vec_in norm=1.582205)
[S9] cosine check vs S10: cos=0.9805
[S9] BUFFERED delta from S10 (total buffered=1)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:44610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:44614
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:44604
[S5] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1799) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.159905)
[S9] loaded HEAD from S5 (vec_in norm=1.159905)
[S9] cosine check vs S5: cos=0.0769
[S9] BUFFERED delta from S5 (total buffered=2)
[S14] RECEIVED delta(kind=head bytes=1800) from S3
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.546162)
[S14] loaded HEAD from S3 (vec_in norm=1.546162)
[S14] cosine check vs S3: cos=0.9630
[S14] BUFFERED delta from S3 (total buffered=2)
[S6] sending update (kind=head size=1801 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1801) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.555040)
[S4] loaded HEAD from S6 (vec_in norm=1.555040)
[S4] cosine check vs S6: cos=0.9614
[S4] BUFFERED delta from S6 (total buffered=2)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=12 metric=0.4350 head_norm=1.159905
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.465555e-01
[S5] stored merged vector for next round verification (round=12)
[S5] DEBUG after merge:  round=12 metric=0.5629 head_norm=1.138840 delta_norm=0.146555
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=12 metric=0.6897 head_norm=1.159402
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.228678e-01
[S14] stored merged vector for next round verification (round=12)
[S14] DEBUG after merge:  round=12 metric=0.6916 head_norm=1.046345 delta_norm=0.322868
[S14] aggregate: ACCEPT kept=['S9', 'S3'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=12 metric=0.3729 head_norm=0.724368
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.610021e-01
[S8] stored merged vector for next round verification (round=12)
[S8] DEBUG after merge:  round=12 metric=0.3729 head_norm=0.731658 delta_norm=0.161002
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=12 metric=0.6632 head_norm=1.136437
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.996778e-01
[S4] stored merged vector for next round verification (round=12)
[S4] DEBUG after merge:  round=12 metric=0.6629 head_norm=0.989254 delta_norm=0.199678
[S4] aggregate: ACCEPT kept=['S8', 'S6'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=12 metric=0.6155 head_norm=1.378319
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.902386e-01
[S9] stored merged vector for next round verification (round=12)
[S9] DEBUG after merge:  round=12 metric=0.6271 head_norm=1.132649 delta_norm=0.390239
[S9] aggregate: ACCEPT kept=['S10', 'S5'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=12 metric=0.5608 head_norm=0.773164
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.631239e-01
[S15] stored merged vector for next round verification (round=12)
[S15] DEBUG after merge:  round=12 metric=0.4300 head_norm=0.916045 delta_norm=0.363124
[S15] aggregate: ROLLBACK (f1_val pre=0.561 post=0.430 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=12 metric=0.4853 head_norm=0.880119
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.763073e-01
[S16] stored merged vector for next round verification (round=12)
[S16] DEBUG after merge:  round=12 metric=0.5037 head_norm=0.834290 delta_norm=0.476307
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.624225 (no previous merge yet)
[S2] round=13 local utility u=0.000482 metrics={'f1_val': 0.7003779861200577, 'auprc': 0.7847824861275895, 'loss_val': 0.3193560311085235, 'psi': 0.7341397861230705}-{'f1_val': 0.7129719282621669, 'auprc': 0.7904453765628983, 'loss_val': 0.41287180731991097, 'psi': 0.7439613075824594}
[S3] START round=13 head_norm_before_train=1.546162 (no previous merge yet)
[S3] round=13 local utility u=0.016350 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.9954860087749351, 'loss_val': 0.29427372859280415, 'psi': 0.8186934445252605}-{'f1_val': 0.7005813959920884, 'auprc': 0.9952795256575222, 'loss_val': 0.3248515907385301, 'psi': 0.8184606478582619}
[S4] START round=13 head_norm_before_train=0.989254 cos_to_last_merge=1.0000 (last merge round=12)
[S4] round=13 local utility u=0.102150 metrics={'f1_val': 0.664752153210778, 'auprc': 0.8977518897172101, 'loss_val': 0.5867208748086866, 'psi': 0.7579520478133508}-{'f1_val': 0.6631679790906391, 'auprc': 0.8521063568866556, 'loss_val': 0.6445788823186396, 'psi': 0.7387433302090457}
[S5] START round=13 head_norm_before_train=1.138840 cos_to_last_merge=1.0000 (last merge round=12)
[S5] round=13 local utility u=1.000000 metrics={'f1_val': 0.7007424833918189, 'auprc': 0.8585145880141601, 'loss_val': 0.6598394942996926, 'psi': 0.7638513252407554}-{'f1_val': 0.4350366818158704, 'auprc': 0.6672703998384246, 'loss_val': 0.7844350858875595, 'psi': 0.5279301690248921}
[S6] START round=13 head_norm_before_train=1.555040 (no previous merge yet)
[S6] round=13 local utility u=0.124919 metrics={'f1_val': 0.7136345872659806, 'auprc': 0.9446606408012237, 'loss_val': 0.3650636971107522, 'psi': 0.8060450086800779}-{'f1_val': 0.6720211560569112, 'auprc': 0.9471609565317718, 'loss_val': 0.37272265247393954, 'psi': 0.7820770762468554}
[S7] START round=13 head_norm_before_train=1.034992 cos_to_last_merge=0.8688 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.869
[S7] round=13 local utility u=0.724886 metrics={'f1_val': 0.6811413744225863, 'auprc': 0.7860180893554455, 'loss_val': 0.6385542922851444, 'psi': 0.72309206039573}-{'f1_val': 0.4660517704044801, 'auprc': 0.7892973789514854, 'loss_val': 0.8076260349347385, 'psi': 0.5953500138232822}
[S8] START round=13 head_norm_before_train=0.731658 cos_to_last_merge=1.0000 (last merge round=12)
[S8] round=13 local utility u=0.000000 metrics={'f1_val': 0.3725978128855645, 'auprc': 0.7721299754419972, 'loss_val': 0.8589739215185918, 'psi': 0.5324106779081377}-{'f1_val': 0.3729316501988709, 'auprc': 0.8690329764038232, 'loss_val': 0.8587485985061667, 'psi': 0.5713721806808518}
[S9] START round=13 head_norm_before_train=1.132649 cos_to_last_merge=1.0000 (last merge round=12)
[S9] round=13 local utility u=0.144695 metrics={'f1_val': 0.7011906753306418, 'auprc': 0.8028036149517644, 'loss_val': 0.5792900314201064, 'psi': 0.7418358511790909}-{'f1_val': 0.6155135393246816, 'auprc': 0.9205183036902131, 'loss_val': 0.7077619007452313, 'psi': 0.7375154450708942}
[S10] START round=13 head_norm_before_train=1.582205 (no previous merge yet)
[S10] round=13 local utility u=0.315692 metrics={'f1_val': 0.7939404661737501, 'auprc': 0.9968968473594338, 'loss_val': 0.1951407743554695, 'psi': 0.8751230186480237}-{'f1_val': 0.6942074726961521, 'auprc': 0.9976703523600711, 'loss_val': 0.2304475907990705, 'psi': 0.8155926245617198}
[S11] START round=13 head_norm_before_train=1.610152 (no previous merge yet)
[S11] round=13 local utility u=0.789527 metrics={'f1_val': 0.9564005726812054, 'auprc': 0.9979297187957932, 'loss_val': 0.17909079227351124, 'psi': 0.9730122311270404}-{'f1_val': 0.7019353166316534, 'auprc': 0.9980514415429732, 'loss_val': 0.2317177857579171, 'psi': 0.8203817665961813}
[S13] START round=13 head_norm_before_train=1.491117 (no previous merge yet)
[S13] round=13 local utility u=0.000000 metrics={'f1_val': 0.6150754465221128, 'auprc': 0.671387383194606, 'loss_val': 0.5880464085361864, 'psi': 0.63760022119111}-{'f1_val': 0.6332617297295755, 'auprc': 0.7163533028104153, 'loss_val': 0.5780350227346114, 'psi': 0.6664983589619115}
[S14] START round=13 head_norm_before_train=1.046345 cos_to_last_merge=1.0000 (last merge round=12)
[S14] round=13 local utility u=0.000000 metrics={'f1_val': 0.6555080481873942, 'auprc': 0.9960679259295624, 'loss_val': 0.6291320236871156, 'psi': 0.7917319992842615}-{'f1_val': 0.6897309908321345, 'auprc': 0.9598087550409382, 'loss_val': 0.6835696870917117, 'psi': 0.797762096515656}
[S15] START round=13 head_norm_before_train=0.916045 cos_to_last_merge=1.0000 (last merge round=12)
[S15] round=13 local utility u=0.645042 metrics={'f1_val': 0.6997961442334821, 'auprc': 0.9306167224238658, 'loss_val': 0.6023997174782167, 'psi': 0.7921243755096357}-{'f1_val': 0.5607855328476277, 'auprc': 0.8150161770100871, 'loss_val': 0.7116181807354023, 'psi': 0.6624777905126115}
[S16] START round=13 head_norm_before_train=0.834290 cos_to_last_merge=1.0000 (last merge round=12)
[S16] round=13 local utility u=0.282934 metrics={'f1_val': 0.5445732020953824, 'auprc': 0.8417861528488236, 'loss_val': 0.755796125795463, 'psi': 0.6634583823967589}-{'f1_val': 0.48532723928360405, 'auprc': 0.792565372009042, 'loss_val': 0.8185269200886138, 'psi': 0.6082224923737792}
[S17] START round=13 head_norm_before_train=1.185958 cos_to_last_merge=0.8574 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.857
[S17] round=13 local utility u=0.000000 metrics={'f1_val': 0.3554972035324452, 'auprc': 0.7329893449067435, 'loss_val': 0.9216805130070688, 'psi': 0.5064940600821646}-{'f1_val': 0.3532474827953347, 'auprc': 0.7741408577104947, 'loss_val': 0.931494368769203, 'psi': 0.5216048327613987}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S9] → sending delta(kind=head bytes=1806) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:44609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:44610
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:44605
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:44604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:44614
[S3] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1806 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1802) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.162325)
[S9] loaded HEAD from S5 (vec_in norm=1.162325)
[S9] cosine check vs S5: cos=0.3122
[S9] BUFFERED delta from S5 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1797) from S15
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.971475)
[S8] loaded HEAD from S15 (vec_in norm=0.971475)
[S8] cosine check vs S15: cos=0.8596
[S8] BUFFERED delta from S15 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1801) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.580243)
[S4] loaded HEAD from S6 (vec_in norm=1.580243)
[S4] cosine check vs S6: cos=0.9338
[S4] BUFFERED delta from S6 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1800) from S3
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.582122)
[S14] loaded HEAD from S3 (vec_in norm=1.582122)
[S14] cosine check vs S3: cos=0.8876
[S14] BUFFERED delta from S3 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1806) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.169600)
[S14] loaded HEAD from S9 (vec_in norm=1.169600)
[S14] cosine check vs S9: cos=0.4028
[S14] BUFFERED delta from S9 (total buffered=2)
[S16] RECEIVED delta(kind=head bytes=1798) from S11
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.655543)
[S16] loaded HEAD from S11 (vec_in norm=1.655543)
[S16] cosine check vs S11: cos=-0.0354
[S16] DROPPED delta from S11 (cos=-0.0354 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1800) from S2
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.661730)
[S16] loaded HEAD from S2 (vec_in norm=1.661730)
[S16] cosine check vs S2: cos=-0.0442
[S16] DROPPED delta from S2 (cos=-0.0442 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1798) from S7
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.069969)
[S16] loaded HEAD from S7 (vec_in norm=1.069969)
[S16] cosine check vs S7: cos=0.8672
[S16] BUFFERED delta from S7 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:44615
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1797 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1797) from S16
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.885977)
[S15] loaded HEAD from S16 (vec_in norm=0.885977)
[S15] cosine check vs S16: cos=0.7250
[S15] BUFFERED delta from S16 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:44610
[S4] sending update (kind=head size=1793 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1793) from S4
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.041835)
[S5] loaded HEAD from S4 (vec_in norm=1.041835)
[S5] cosine check vs S4: cos=0.9716
[S5] BUFFERED delta from S4 (total buffered=1)
[S10] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1800) from S10
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.603391)
[S9] loaded HEAD from S10 (vec_in norm=1.603391)
[S9] cosine check vs S10: cos=0.9351
[S9] BUFFERED delta from S10 (total buffered=2)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=13 metric=0.3726 head_norm=0.772411
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.501656e-01
[S8] stored merged vector for next round verification (round=13)
[S8] DEBUG after merge:  round=13 metric=0.3726 head_norm=0.841195 delta_norm=0.250166
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=13 metric=0.7007 head_norm=1.162325
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.443763e-01
[S5] stored merged vector for next round verification (round=13)
[S5] DEBUG after merge:  round=13 metric=0.7007 head_norm=1.094242 delta_norm=0.144376
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=13 metric=0.7012 head_norm=1.169600
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.145613e-01
[S9] stored merged vector for next round verification (round=13)
[S9] DEBUG after merge:  round=13 metric=0.7010 head_norm=1.065375 delta_norm=0.214561
[S9] aggregate: ACCEPT kept=['S5', 'S10'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=13 metric=0.6648 head_norm=1.041835
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.562925e-01
[S4] stored merged vector for next round verification (round=13)
[S4] DEBUG after merge:  round=13 metric=0.6639 head_norm=1.290096 delta_norm=0.356293
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=13 metric=0.6998 head_norm=0.971475
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.466421e-01
[S15] stored merged vector for next round verification (round=13)
[S15] DEBUG after merge:  round=13 metric=0.6185 head_norm=0.862670 delta_norm=0.346642
[S15] aggregate: ROLLBACK (f1_val pre=0.700 post=0.618 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=13 metric=0.6555 head_norm=1.084462
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.549508e-01
[S14] stored merged vector for next round verification (round=13)
[S14] DEBUG after merge:  round=13 metric=0.8713 head_norm=1.020248 delta_norm=0.154951
[S14] aggregate: ACCEPT kept=['S3', 'S9'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=13 metric=0.5446 head_norm=0.885977
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.671795e-01
[S16] stored merged vector for next round verification (round=13)
[S16] DEBUG after merge:  round=13 metric=0.5269 head_norm=0.945256 delta_norm=0.267180
[S16] aggregate: ROLLBACK (f1_val pre=0.545 post=0.527 tol_abs=0.005 tol_rel=0.0)
[S2] START round=14 head_norm_before_train=1.661730 (no previous merge yet)
[S2] round=14 local utility u=0.152758 metrics={'f1_val': 0.681639379149755, 'auprc': 0.9293099156224254, 'loss_val': 0.33498984294509393, 'psi': 0.7807075937388233}-{'f1_val': 0.7003779861200577, 'auprc': 0.7847824861275895, 'loss_val': 0.3193560311085235, 'psi': 0.7341397861230705}
[S3] START round=14 head_norm_before_train=1.582122 (no previous merge yet)
[S3] round=14 local utility u=0.014103 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9967621116497858, 'loss_val': 0.2694422064674252, 'psi': 0.8191585669010941}-{'f1_val': 0.7008317350254774, 'auprc': 0.9954860087749351, 'loss_val': 0.29427372859280415, 'psi': 0.8186934445252605}
[S4] START round=14 head_norm_before_train=1.290096 cos_to_last_merge=1.0000 (last merge round=13)
[S4] round=14 local utility u=0.967682 metrics={'f1_val': 0.9527111746805698, 'auprc': 0.936905749606181, 'loss_val': 0.4965724723727674, 'psi': 0.9463890046508143}-{'f1_val': 0.664752153210778, 'auprc': 0.8977518897172101, 'loss_val': 0.5867208748086866, 'psi': 0.7579520478133508}
[S5] START round=14 head_norm_before_train=1.094242 cos_to_last_merge=1.0000 (last merge round=13)
[S5] round=14 local utility u=0.000000 metrics={'f1_val': 0.6800068049285951, 'auprc': 0.7792787654876319, 'loss_val': 0.6862771762096063, 'psi': 0.7197155891522098}-{'f1_val': 0.7007424833918189, 'auprc': 0.8585145880141601, 'loss_val': 0.6598394942996926, 'psi': 0.7638513252407554}
[S6] START round=14 head_norm_before_train=1.580243 (no previous merge yet)
[S6] round=14 local utility u=0.000000 metrics={'f1_val': 0.6272289595965719, 'auprc': 0.7967849693286739, 'loss_val': 0.441240526139448, 'psi': 0.6950513634894127}-{'f1_val': 0.7136345872659806, 'auprc': 0.9446606408012237, 'loss_val': 0.3650636971107522, 'psi': 0.8060450086800779}
[S7] START round=14 head_norm_before_train=1.069969 cos_to_last_merge=0.8564 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.856
[S7] round=14 local utility u=0.000000 metrics={'f1_val': 0.6584773156999558, 'auprc': 0.7883624963906695, 'loss_val': 0.6808730351919731, 'psi': 0.7104313879762413}-{'f1_val': 0.6811413744225863, 'auprc': 0.7860180893554455, 'loss_val': 0.6385542922851444, 'psi': 0.72309206039573}
[S8] START round=14 head_norm_before_train=0.841195 cos_to_last_merge=1.0000 (last merge round=13)
[S8] round=14 local utility u=0.279528 metrics={'f1_val': 0.4061231791250891, 'auprc': 0.8643725833457864, 'loss_val': 0.7777984795126843, 'psi': 0.589422940813368}-{'f1_val': 0.3725978128855645, 'auprc': 0.7721299754419972, 'loss_val': 0.8589739215185918, 'psi': 0.5324106779081377}
[S9] START round=14 head_norm_before_train=1.065375 cos_to_last_merge=1.0000 (last merge round=13)
[S9] round=14 local utility u=0.316422 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9830335669984933, 'loss_val': 0.4872919357007821, 'psi': 0.8139433752634084}-{'f1_val': 0.7011906753306418, 'auprc': 0.8028036149517644, 'loss_val': 0.5792900314201064, 'psi': 0.7418358511790909}
[S10] START round=14 head_norm_before_train=1.603391 (no previous merge yet)
[S10] round=14 local utility u=0.379480 metrics={'f1_val': 0.9344494507689262, 'auprc': 0.9891180236618249, 'loss_val': 0.25589802969506364, 'psi': 0.9563168799260856}-{'f1_val': 0.7939404661737501, 'auprc': 0.9968968473594338, 'loss_val': 0.1951407743554695, 'psi': 0.8751230186480237}
[S11] START round=14 head_norm_before_train=1.655543 (no previous merge yet)
[S11] round=14 local utility u=0.045423 metrics={'f1_val': 0.966246699603758, 'auprc': 0.9980884319515372, 'loss_val': 0.14779703546367143, 'psi': 0.9789833925428697}-{'f1_val': 0.9564005726812054, 'auprc': 0.9979297187957932, 'loss_val': 0.17909079227351124, 'psi': 0.9730122311270404}
[S13] START round=14 head_norm_before_train=1.522614 (no previous merge yet)
[S13] round=14 local utility u=0.000000 metrics={'f1_val': 0.6048736882447032, 'auprc': 0.6636687525258262, 'loss_val': 0.5773553346502506, 'psi': 0.6283917139571524}-{'f1_val': 0.6150754465221128, 'auprc': 0.671387383194606, 'loss_val': 0.5880464085361864, 'psi': 0.63760022119111}
[S14] START round=14 head_norm_before_train=1.020248 cos_to_last_merge=1.0000 (last merge round=13)
[S14] round=14 local utility u=0.137561 metrics={'f1_val': 0.6921047009941472, 'auprc': 0.9964231318979663, 'loss_val': 0.5746553685730837, 'psi': 0.8138320733556749}-{'f1_val': 0.6555080481873942, 'auprc': 0.9960679259295624, 'loss_val': 0.6291320236871156, 'psi': 0.7917319992842615}
[S15] START round=14 head_norm_before_train=0.862670 cos_to_last_merge=1.0000 (last merge round=13)
[S15] round=14 local utility u=0.019452 metrics={'f1_val': 0.6929714694063176, 'auprc': 0.9201994512125108, 'loss_val': 0.4912951561196317, 'psi': 0.783862662128795}-{'f1_val': 0.6997961442334821, 'auprc': 0.9306167224238658, 'loss_val': 0.6023997174782167, 'psi': 0.7921243755096357}
[S16] START round=14 head_norm_before_train=0.945256 cos_to_last_merge=1.0000 (last merge round=13)
[S16] round=14 local utility u=0.536515 metrics={'f1_val': 0.6336513910615743, 'auprc': 0.9836550891813343, 'loss_val': 0.6428427438534896, 'psi': 0.7736528703094783}-{'f1_val': 0.5445732020953824, 'auprc': 0.8417861528488236, 'loss_val': 0.755796125795463, 'psi': 0.6634583823967589}
[S17] START round=14 head_norm_before_train=1.201548 cos_to_last_merge=0.8516 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.852
[S17] round=14 local utility u=0.140571 metrics={'f1_val': 0.3626141913858736, 'auprc': 0.807613864255507, 'loss_val': 0.9071145070306802, 'psi': 0.540614060533727}-{'f1_val': 0.3554972035324452, 'auprc': 0.7329893449067435, 'loss_val': 0.9216805130070688, 'psi': 0.5064940600821646}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:44604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:44616
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:44605
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:44614
[S9] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1800) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.107394)
[S14] loaded HEAD from S9 (vec_in norm=1.107394)
[S14] cosine check vs S9: cos=0.4776
[S14] BUFFERED delta from S9 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1802) from S2
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.691754)
[S16] loaded HEAD from S2 (vec_in norm=1.691754)
[S16] cosine check vs S2: cos=-0.0386
[S16] DROPPED delta from S2 (cos=-0.0386 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1797) from S11
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.695121)
[S16] loaded HEAD from S11 (vec_in norm=1.695121)
[S16] cosine check vs S11: cos=-0.0261
[S16] DROPPED delta from S11 (cos=-0.0261 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1801) from S3
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.614733)
[S14] loaded HEAD from S3 (vec_in norm=1.614733)
[S14] cosine check vs S3: cos=0.8484
[S14] BUFFERED delta from S3 (total buffered=2)
[S5] RECEIVED delta(kind=head bytes=1799) from S4
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.337671)
[S5] loaded HEAD from S4 (vec_in norm=1.337671)
[S5] cosine check vs S4: cos=0.9762
[S5] BUFFERED delta from S4 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1798) from S8
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.875622)
[S4] loaded HEAD from S8 (vec_in norm=0.875622)
[S4] cosine check vs S8: cos=0.1403
[S4] BUFFERED delta from S8 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:44615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:44615
[S14] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S9@127.0.0.1:44610
[S15] RECEIVED delta(kind=head bytes=1800) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.062973)
[S15] loaded HEAD from S14 (vec_in norm=1.062973)
[S15] cosine check vs S14: cos=0.7036
[S15] BUFFERED delta from S14 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S17] → sending delta(kind=head bytes=1792) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S15] → sending delta(kind=head bytes=1789) to S8@127.0.0.1:44609
[S10] sending update (kind=head size=1805 to 1 peers)
[S15] sending update (kind=head size=1789 to 1 peers)
[S17] sending update (kind=head size=1792 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1789) from S15
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.927988)
[S8] loaded HEAD from S15 (vec_in norm=0.927988)
[S8] cosine check vs S15: cos=0.9447
[S8] BUFFERED delta from S15 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1792) from S17
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.217680)
[S16] loaded HEAD from S17 (vec_in norm=1.217680)
[S16] cosine check vs S17: cos=0.2989
[S16] BUFFERED delta from S17 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1802) from S16
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.992630)
[S15] loaded HEAD from S16 (vec_in norm=0.992630)
[S15] cosine check vs S16: cos=0.9102
[S15] BUFFERED delta from S16 (total buffered=2)
[S9] RECEIVED delta(kind=head bytes=1805) from S10
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.620883)
[S9] loaded HEAD from S10 (vec_in norm=1.620883)
[S9] cosine check vs S10: cos=0.8851
[S9] BUFFERED delta from S10 (total buffered=1)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=14 metric=0.6800 head_norm=1.115199
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.735346e-01
[S5] stored merged vector for next round verification (round=14)
[S5] DEBUG after merge:  round=14 metric=0.7004 head_norm=1.219181 delta_norm=0.173535
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=14 metric=0.4061 head_norm=0.875622
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.521024e-01
[S8] stored merged vector for next round verification (round=14)
[S8] DEBUG after merge:  round=14 metric=0.4064 head_norm=0.889271 delta_norm=0.152102
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=14 metric=0.9527 head_norm=1.337671
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.462310e-01
[S4] stored merged vector for next round verification (round=14)
[S4] DEBUG after merge:  round=14 metric=0.6653 head_norm=0.849222 delta_norm=0.746231
[S4] aggregate: ROLLBACK (f1_val pre=0.953 post=0.665 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=14 metric=0.7012 head_norm=1.107394
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.111118e-01
[S9] stored merged vector for next round verification (round=14)
[S9] DEBUG after merge:  round=14 metric=0.7012 head_norm=1.325813 delta_norm=0.411112
[S9] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=14 metric=0.6921 head_norm=1.062973
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.210491e-01
[S14] stored merged vector for next round verification (round=14)
[S14] DEBUG after merge:  round=14 metric=0.9581 head_norm=1.011868 delta_norm=0.121049
[S14] aggregate: ACCEPT kept=['S9', 'S3'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=14 metric=0.6337 head_norm=0.992630
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.605878e-01
[S16] stored merged vector for next round verification (round=14)
[S16] DEBUG after merge:  round=14 metric=0.6411 head_norm=0.893115 delta_norm=0.660588
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=14 metric=0.6930 head_norm=0.927988
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.682673e-01
[S15] stored merged vector for next round verification (round=14)
[S15] DEBUG after merge:  round=14 metric=0.6926 head_norm=0.891360 delta_norm=0.168267
[S15] aggregate: ACCEPT kept=['S14', 'S16'] (k=2/2) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.691754 (no previous merge yet)
[S2] round=15 local utility u=0.070566 metrics={'f1_val': 0.6812786789442438, 'auprc': 0.9763569291358545, 'loss_val': 0.33283542009058553, 'psi': 0.7993099790208881}-{'f1_val': 0.681639379149755, 'auprc': 0.9293099156224254, 'loss_val': 0.33498984294509393, 'psi': 0.7807075937388233}
[S3] START round=15 head_norm_before_train=1.614733 (no previous merge yet)
[S3] round=15 local utility u=0.016655 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9969394297742714, 'loss_val': 0.2362127583710917, 'psi': 0.8191843477089094}-{'f1_val': 0.7007562037352997, 'auprc': 0.9967621116497858, 'loss_val': 0.2694422064674252, 'psi': 0.8191585669010941}
[S4] START round=15 head_norm_before_train=0.849222 cos_to_last_merge=1.0000 (last merge round=14)
[S4] round=15 local utility u=0.000000 metrics={'f1_val': 0.6650255054272336, 'auprc': 0.9388860747595207, 'loss_val': 0.5536024461702315, 'psi': 0.7745697331601484}-{'f1_val': 0.9527111746805698, 'auprc': 0.936905749606181, 'loss_val': 0.4965724723727674, 'psi': 0.9463890046508143}
[S5] START round=15 head_norm_before_train=1.219181 cos_to_last_merge=1.0000 (last merge round=14)
[S5] round=15 local utility u=0.238547 metrics={'f1_val': 0.700407554886547, 'auprc': 0.853855444757071, 'loss_val': 0.5553167380630813, 'psi': 0.7617867108347567}-{'f1_val': 0.6800068049285951, 'auprc': 0.7792787654876319, 'loss_val': 0.6862771762096063, 'psi': 0.7197155891522098}
[S6] START round=15 head_norm_before_train=1.597628 (no previous merge yet)
[S6] round=15 local utility u=1.000000 metrics={'f1_val': 0.9408661198253367, 'auprc': 0.9483246372848441, 'loss_val': 0.30746659053520925, 'psi': 0.9438495268091397}-{'f1_val': 0.6272289595965719, 'auprc': 0.7967849693286739, 'loss_val': 0.441240526139448, 'psi': 0.6950513634894127}
[S7] START round=15 head_norm_before_train=1.098449 cos_to_last_merge=0.8470 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.847
[S7] round=15 local utility u=0.000000 metrics={'f1_val': 0.4012086738962046, 'auprc': 0.6614524572424314, 'loss_val': 0.8846465945273738, 'psi': 0.5053061872346953}-{'f1_val': 0.6584773156999558, 'auprc': 0.7883624963906695, 'loss_val': 0.6808730351919731, 'psi': 0.7104313879762413}
[S8] START round=15 head_norm_before_train=0.889271 cos_to_last_merge=1.0000 (last merge round=14)
[S8] round=15 local utility u=0.088076 metrics={'f1_val': 0.37266438550987346, 'auprc': 0.9847816567300773, 'loss_val': 0.7621202287928387, 'psi': 0.617511293997955}-{'f1_val': 0.4061231791250891, 'auprc': 0.8643725833457864, 'loss_val': 0.7777984795126843, 'psi': 0.589422940813368}
[S9] START round=15 head_norm_before_train=1.325813 cos_to_last_merge=1.0000 (last merge round=14)
[S9] round=15 local utility u=0.089751 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.998611195658884, 'loss_val': 0.3545231982621579, 'psi': 0.8201744267275648}-{'f1_val': 0.7012165807733519, 'auprc': 0.9830335669984933, 'loss_val': 0.4872919357007821, 'psi': 0.8139433752634084}
[S10] START round=15 head_norm_before_train=1.620883 (no previous merge yet)
[S10] round=15 local utility u=0.243611 metrics={'f1_val': 0.9948679860449806, 'auprc': 0.9965608384317095, 'loss_val': 0.15351548123340072, 'psi': 0.9955451269996721}-{'f1_val': 0.9344494507689262, 'auprc': 0.9891180236618249, 'loss_val': 0.25589802969506364, 'psi': 0.9563168799260856}
[S11] START round=15 head_norm_before_train=1.695121 (no previous merge yet)
[S11] round=15 local utility u=0.101312 metrics={'f1_val': 0.996960829744628, 'auprc': 0.9978736635492558, 'loss_val': 0.12881296278962595, 'psi': 0.997325963266479}-{'f1_val': 0.966246699603758, 'auprc': 0.9980884319515372, 'loss_val': 0.14779703546367143, 'psi': 0.9789833925428697}
[S13] START round=15 head_norm_before_train=1.550106 (no previous merge yet)
[S13] round=15 local utility u=0.001586 metrics={'f1_val': 0.6050755887699746, 'auprc': 0.6664138158666318, 'loss_val': 0.5836301944369386, 'psi': 0.6296108796086375}-{'f1_val': 0.6048736882447032, 'auprc': 0.6636687525258262, 'loss_val': 0.5773553346502506, 'psi': 0.6283917139571524}
[S14] START round=15 head_norm_before_train=1.011868 cos_to_last_merge=1.0000 (last merge round=14)
[S14] round=15 local utility u=0.954320 metrics={'f1_val': 0.9962028195153276, 'auprc': 0.996831346758632, 'loss_val': 0.4918294556058099, 'psi': 0.9964542304126494}-{'f1_val': 0.6921047009941472, 'auprc': 0.9964231318979663, 'loss_val': 0.5746553685730837, 'psi': 0.8138320733556749}
[S15] START round=15 head_norm_before_train=0.891360 cos_to_last_merge=1.0000 (last merge round=14)
[S15] round=15 local utility u=0.019166 metrics={'f1_val': 0.6973884265333976, 'auprc': 0.9149186632249454, 'loss_val': 0.46362263019888705, 'psi': 0.7844005212100167}-{'f1_val': 0.6929714694063176, 'auprc': 0.9201994512125108, 'loss_val': 0.4912951561196317, 'psi': 0.783862662128795}
[S16] START round=15 head_norm_before_train=0.893115 cos_to_last_merge=1.0000 (last merge round=14)
[S16] round=15 local utility u=0.182514 metrics={'f1_val': 0.6667345055633092, 'auprc': 0.9942726790715322, 'loss_val': 0.508165763524275, 'psi': 0.7977497749665984}-{'f1_val': 0.6336513910615743, 'auprc': 0.9836550891813343, 'loss_val': 0.6428427438534896, 'psi': 0.7736528703094783}
[S17] START round=15 head_norm_before_train=1.217680 cos_to_last_merge=0.8457 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.846
[S17] round=15 local utility u=0.236368 metrics={'f1_val': 0.3734283363266097, 'auprc': 0.9307665306865055, 'loss_val': 0.8687214085125964, 'psi': 0.596363614070568}-{'f1_val': 0.3626141913858736, 'auprc': 0.807613864255507, 'loss_val': 0.9071145070306802, 'psi': 0.540614060533727}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S8] → sending delta(kind=head bytes=1790) to S4@127.0.0.1:44604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:44615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:44609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:44604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S10] → sending delta(kind=head bytes=1806) to S9@127.0.0.1:44610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:44615
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:44610
[S5] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1806 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1790 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1801) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.238860)
[S9] loaded HEAD from S5 (vec_in norm=1.238860)
[S9] cosine check vs S5: cos=0.2082
[S9] BUFFERED delta from S5 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1800) from S2
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.719488)
[S16] loaded HEAD from S2 (vec_in norm=1.719488)
[S16] cosine check vs S2: cos=-0.0364
[S16] DROPPED delta from S2 (cos=-0.0364 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1806) from S10
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.635402)
[S9] loaded HEAD from S10 (vec_in norm=1.635402)
[S9] cosine check vs S10: cos=0.9740
[S9] BUFFERED delta from S10 (total buffered=2)
[S8] RECEIVED delta(kind=head bytes=1795) from S15
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.951453)
[S8] loaded HEAD from S15 (vec_in norm=0.951453)
[S8] cosine check vs S15: cos=0.9652
[S8] BUFFERED delta from S15 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1790) from S8
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.931618)
[S4] loaded HEAD from S8 (vec_in norm=0.931618)
[S4] cosine check vs S8: cos=0.5959
[S4] BUFFERED delta from S8 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1799) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.059647)
[S15] loaded HEAD from S14 (vec_in norm=1.059647)
[S15] cosine check vs S14: cos=0.7714
[S15] BUFFERED delta from S14 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1797) from S16
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.958178)
[S15] loaded HEAD from S16 (vec_in norm=0.958178)
[S15] cosine check vs S16: cos=0.7180
[S15] BUFFERED delta from S16 (total buffered=2)
[S14] RECEIVED delta(kind=head bytes=1795) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.365684)
[S14] loaded HEAD from S9 (vec_in norm=1.365684)
[S14] cosine check vs S9: cos=0.4831
[S14] BUFFERED delta from S9 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1803) from S3
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.643063)
[S14] loaded HEAD from S3 (vec_in norm=1.643063)
[S14] cosine check vs S3: cos=0.8363
[S14] BUFFERED delta from S3 (total buffered=2)
[S14] RECEIVED delta(kind=head bytes=1799) from S13
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.572219)
[S14] loaded HEAD from S13 (vec_in norm=1.572219)
[S14] cosine check vs S13: cos=-0.1675
[S14] DROPPED delta from S13 (cos=-0.1675 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1801) from S11
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.730009)
[S16] loaded HEAD from S11 (vec_in norm=1.730009)
[S16] cosine check vs S11: cos=-0.0567
[S16] DROPPED delta from S11 (cos=-0.0567 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1798) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.611227)
[S4] loaded HEAD from S6 (vec_in norm=1.611227)
[S4] cosine check vs S6: cos=0.7909
[S4] BUFFERED delta from S6 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:44616
[S17] sending update (kind=head size=1796 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1796) from S17
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.232999)
[S16] loaded HEAD from S17 (vec_in norm=1.232999)
[S16] cosine check vs S17: cos=0.8356
[S16] BUFFERED delta from S17 (total buffered=1)
[S7] ⇄ pheromone p=0.234 → S16@127.0.0.1:44616
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=15 metric=0.6650 head_norm=0.903065
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.186213e-01
[S4] stored merged vector for next round verification (round=15)
[S4] DEBUG after merge:  round=15 metric=0.6649 head_norm=0.916602 delta_norm=0.118621
[S4] aggregate: ACCEPT kept=['S8', 'S6'] (k=2/2) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.298 → S5@127.0.0.1:44605
[S11] ⇄ pheromone p=0.277 → S16@127.0.0.1:44616
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=15 metric=0.7012 head_norm=1.365684
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.211522e-01
[S9] stored merged vector for next round verification (round=15)
[S9] DEBUG after merge:  round=15 metric=0.7012 head_norm=1.169148 delta_norm=0.321152
[S9] aggregate: ACCEPT kept=['S5', 'S10'] (k=2/2) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.274 → S14@127.0.0.1:44614
[S2] ⇄ pheromone p=0.163 → S16@127.0.0.1:44616
[S3] ⇄ pheromone p=0.154 → S14@127.0.0.1:44614
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=15 metric=0.9962 head_norm=1.059647
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.326291e-01
[S14] stored merged vector for next round verification (round=15)
[S14] DEBUG after merge:  round=15 metric=0.9964 head_norm=1.046479 delta_norm=0.132629
[S14] aggregate: ACCEPT kept=['S9', 'S3'] (k=2/2) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.367 → S15@127.0.0.1:44615
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=15 metric=0.6974 head_norm=0.951453
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.757291e-01
[S15] stored merged vector for next round verification (round=15)
[S15] DEBUG after merge:  round=15 metric=0.6981 head_norm=0.864313 delta_norm=0.175729
[S15] aggregate: ACCEPT kept=['S14', 'S16'] (k=2/2) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.215 → S8@127.0.0.1:44609
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=15 metric=0.3727 head_norm=0.931618
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.246222e-01
[S8] stored merged vector for next round verification (round=15)
[S8] DEBUG after merge:  round=15 metric=0.3727 head_norm=0.933304 delta_norm=0.124622
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.175 → S4@127.0.0.1:44604
[S6] ⇄ pheromone p=0.350 → S4@127.0.0.1:44604
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=15 metric=0.6667 head_norm=0.958178
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.405742e-01
[S16] stored merged vector for next round verification (round=15)
[S16] DEBUG after merge:  round=15 metric=0.6728 head_norm=1.050336 delta_norm=0.340574
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.289 → S15@127.0.0.1:44615
[S5] ⇄ pheromone p=0.270 → S9@127.0.0.1:44610
[S10] ⇄ pheromone p=0.262 → S9@127.0.0.1:44610
[S13] ⇄ pheromone p=0.121 → S14@127.0.0.1:44614
[S17] ⇄ pheromone p=0.154 → S16@127.0.0.1:44616
[S2] START round=16 head_norm_before_train=1.719488 (no previous merge yet)
[S2] round=16 local utility u=0.007630 metrics={'f1_val': 0.6993045166530358, 'auprc': 0.9296498082463979, 'loss_val': 0.2856095856014604, 'psi': 0.7914426332903807}-{'f1_val': 0.6812786789442438, 'auprc': 0.9763569291358545, 'loss_val': 0.33283542009058553, 'psi': 0.7993099790208881}
[S3] START round=16 head_norm_before_train=1.643063 (no previous merge yet)
[S3] round=16 local utility u=0.015466 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.9984520028087017, 'loss_val': 0.20936851546144508, 'psi': 0.819744402623604}-{'f1_val': 0.7006809596653347, 'auprc': 0.9969394297742714, 'loss_val': 0.2362127583710917, 'psi': 0.8191843477089094}
[S4] START round=16 head_norm_before_train=0.916602 cos_to_last_merge=1.0000 (last merge round=15)
[S4] round=16 local utility u=0.049633 metrics={'f1_val': 0.668075454042389, 'auprc': 0.9485637135164671, 'loss_val': 0.5016694354547784, 'psi': 0.7802707578320203}-{'f1_val': 0.6650255054272336, 'auprc': 0.9388860747595207, 'loss_val': 0.5536024461702315, 'psi': 0.7745697331601484}
[S5] START round=16 head_norm_before_train=1.238860 cos_to_last_merge=0.9984 (last merge round=14)
[S5] round=16 local utility u=0.052648 metrics={'f1_val': 0.700407554886547, 'auprc': 0.8564515820616927, 'loss_val': 0.45780957433682035, 'psi': 0.7628251657566053}-{'f1_val': 0.700407554886547, 'auprc': 0.853855444757071, 'loss_val': 0.5553167380630813, 'psi': 0.7617867108347567}
[S6] START round=16 head_norm_before_train=1.611227 (no previous merge yet)
[S6] round=16 local utility u=0.109220 metrics={'f1_val': 0.9612225423113441, 'auprc': 0.9624000005165017, 'loss_val': 0.25339074213448265, 'psi': 0.9616935255934072}-{'f1_val': 0.9408661198253367, 'auprc': 0.9483246372848441, 'loss_val': 0.30746659053520925, 'psi': 0.9438495268091397}
[S7] START round=16 head_norm_before_train=1.125018 cos_to_last_merge=0.8379 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.838
[S7] round=16 local utility u=0.046767 metrics={'f1_val': 0.4248143946939231, 'auprc': 0.6466873800688031, 'loss_val': 0.8884507819480137, 'psi': 0.5135635888438752}-{'f1_val': 0.4012086738962046, 'auprc': 0.6614524572424314, 'loss_val': 0.8846465945273738, 'psi': 0.5053061872346953}
[S8] START round=16 head_norm_before_train=0.933304 cos_to_last_merge=1.0000 (last merge round=15)
[S8] round=16 local utility u=0.008405 metrics={'f1_val': 0.37273099922839503, 'auprc': 0.9824812615749059, 'loss_val': 0.7388089836788312, 'psi': 0.6166311041669994}-{'f1_val': 0.37266438550987346, 'auprc': 0.9847816567300773, 'loss_val': 0.7621202287928387, 'psi': 0.617511293997955}
[S9] START round=16 head_norm_before_train=1.169148 cos_to_last_merge=1.0000 (last merge round=15)
[S9] round=16 local utility u=0.000000 metrics={'f1_val': 0.7009679028957354, 'auprc': 0.9926576917414082, 'loss_val': 0.37675120504569026, 'psi': 0.8176438184340045}-{'f1_val': 0.7012165807733519, 'auprc': 0.998611195658884, 'loss_val': 0.3545231982621579, 'psi': 0.8201744267275648}
[S10] START round=16 head_norm_before_train=1.635402 (no previous merge yet)
[S10] round=16 local utility u=0.000000 metrics={'f1_val': 0.9939447192382613, 'auprc': 0.9914289202212141, 'loss_val': 0.15855143365353824, 'psi': 0.9929383996314425}-{'f1_val': 0.9948679860449806, 'auprc': 0.9965608384317095, 'loss_val': 0.15351548123340072, 'psi': 0.9955451269996721}
[S11] START round=16 head_norm_before_train=1.730009 (no previous merge yet)
[S11] round=16 local utility u=0.009388 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9979224509263246, 'loss_val': 0.10770021411148852, 'psi': 0.9970971830786836}-{'f1_val': 0.996960829744628, 'auprc': 0.9978736635492558, 'loss_val': 0.12881296278962595, 'psi': 0.997325963266479}
[S13] START round=16 head_norm_before_train=1.572219 (no previous merge yet)
[S13] round=16 local utility u=0.027500 metrics={'f1_val': 0.616991470292733, 'auprc': 0.666824969530768, 'loss_val': 0.6013588159273874, 'psi': 0.6369248699879471}-{'f1_val': 0.6050755887699746, 'auprc': 0.6664138158666318, 'loss_val': 0.5836301944369386, 'psi': 0.6296108796086375}
[S14] START round=16 head_norm_before_train=1.046479 cos_to_last_merge=1.0000 (last merge round=15)
[S14] round=16 local utility u=0.038774 metrics={'f1_val': 0.9964876071496979, 'auprc': 0.9984571891587317, 'loss_val': 0.42086869320282344, 'psi': 0.9972754399533115}-{'f1_val': 0.9962028195153276, 'auprc': 0.996831346758632, 'loss_val': 0.4918294556058099, 'psi': 0.9964542304126494}
[S15] START round=16 head_norm_before_train=0.864313 cos_to_last_merge=1.0000 (last merge round=15)
[S15] round=16 local utility u=0.067516 metrics={'f1_val': 0.691445471055588, 'auprc': 0.9631961632887576, 'loss_val': 0.4377657953750434, 'psi': 0.8001457479488558}-{'f1_val': 0.6973884265333976, 'auprc': 0.9149186632249454, 'loss_val': 0.46362263019888705, 'psi': 0.7844005212100167}
[S16] START round=16 head_norm_before_train=1.050336 cos_to_last_merge=1.0000 (last merge round=15)
[S16] round=16 local utility u=0.124477 metrics={'f1_val': 0.6935583092865008, 'auprc': 0.9963564615507243, 'loss_val': 0.42640656974204916, 'psi': 0.8146775701921902}-{'f1_val': 0.6667345055633092, 'auprc': 0.9942726790715322, 'loss_val': 0.508165763524275, 'psi': 0.7977497749665984}
[S17] START round=16 head_norm_before_train=1.232999 cos_to_last_merge=0.8406 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.841
[S17] round=16 local utility u=0.000000 metrics={'f1_val': 0.3606830583554471, 'auprc': 0.852923207021926, 'loss_val': 0.934444655182704, 'psi': 0.5575791178220387}-{'f1_val': 0.3734283363266097, 'auprc': 0.9307665306865055, 'loss_val': 0.8687214085125964, 'psi': 0.596363614070568}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:44604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:44609
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:44605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] → sending delta(kind=head bytes=1805) to S15@127.0.0.1:44615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S3] → sending delta(kind=head bytes=1806) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:44615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:44604
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:44610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S11] → sending delta(kind=head bytes=1791) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:44616
[S5] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1794 to 1 peers)
[S3] sending update (kind=head size=1806 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1805 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1791 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S15
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.918277)
[S8] loaded HEAD from S15 (vec_in norm=0.918277)
[S8] cosine check vs S15: cos=0.9689
[S8] BUFFERED delta from S15 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1796) from S16
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.107877)
[S15] loaded HEAD from S16 (vec_in norm=1.107877)
[S15] cosine check vs S16: cos=0.6143
[S15] BUFFERED delta from S16 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1795) from S4
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.970696)
[S5] loaded HEAD from S4 (vec_in norm=0.970696)
[S5] cosine check vs S4: cos=0.9135
[S5] BUFFERED delta from S4 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1805) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.089471)
[S15] loaded HEAD from S14 (vec_in norm=1.089471)
[S15] cosine check vs S14: cos=0.7648
[S15] BUFFERED delta from S14 (total buffered=2)
[S4] RECEIVED delta(kind=head bytes=1803) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.624737)
[S4] loaded HEAD from S6 (vec_in norm=1.624737)
[S4] cosine check vs S6: cos=0.8372
[S4] BUFFERED delta from S6 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1798) from S13
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.589289)
[S14] loaded HEAD from S13 (vec_in norm=1.589289)
[S14] cosine check vs S13: cos=-0.1747
[S14] DROPPED delta from S13 (cos=-0.1747 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1806) from S3
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.670710)
[S14] loaded HEAD from S3 (vec_in norm=1.670710)
[S14] cosine check vs S3: cos=0.8020
[S14] BUFFERED delta from S3 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1803) from S7
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.154455)
[S16] loaded HEAD from S7 (vec_in norm=1.154455)
[S16] cosine check vs S7: cos=0.3070
[S16] BUFFERED delta from S7 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1791) from S11
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.761347)
[S16] loaded HEAD from S11 (vec_in norm=1.761347)
[S16] cosine check vs S11: cos=-0.0646
[S16] DROPPED delta from S11 (cos=-0.0646 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1801) from S2
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.743251)
[S16] loaded HEAD from S2 (vec_in norm=1.743251)
[S16] cosine check vs S2: cos=-0.0295
[S16] DROPPED delta from S2 (cos=-0.0295 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1801) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.268821)
[S9] loaded HEAD from S5 (vec_in norm=1.268821)
[S9] cosine check vs S5: cos=0.3972
[S9] BUFFERED delta from S5 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1794) from S8
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.974465)
[S4] loaded HEAD from S8 (vec_in norm=0.974465)
[S4] cosine check vs S8: cos=0.5441
[S4] BUFFERED delta from S8 (total buffered=2)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=16 metric=0.7010 head_norm=1.211217
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.811826e-01
[S9] stored merged vector for next round verification (round=16)
[S9] DEBUG after merge:  round=16 metric=0.6975 head_norm=1.036565 delta_norm=0.681183
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=16 metric=0.3727 head_norm=0.974465
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.211672e-01
[S8] stored merged vector for next round verification (round=16)
[S8] DEBUG after merge:  round=16 metric=0.3727 head_norm=0.939003 delta_norm=0.121167
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=16 metric=0.9965 head_norm=1.089471
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.144855e-01
[S14] stored merged vector for next round verification (round=16)
[S14] DEBUG after merge:  round=16 metric=0.9958 head_norm=1.313169 delta_norm=0.514485
[S14] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=16 metric=0.6936 head_norm=1.107877
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.661227e-01
[S16] stored merged vector for next round verification (round=16)
[S16] DEBUG after merge:  round=16 metric=0.6773 head_norm=0.914527 delta_norm=0.666123
[S16] aggregate: ROLLBACK (f1_val pre=0.694 post=0.677 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=16 metric=0.7004 head_norm=1.268821
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.747684e-01
[S5] stored merged vector for next round verification (round=16)
[S5] DEBUG after merge:  round=16 metric=0.7004 head_norm=1.095710 delta_norm=0.274768
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=16 metric=0.6681 head_norm=0.970696
[S4] _apply_head_vector_avg (torch): Δ‖w‖=9.999890e-02
[S4] stored merged vector for next round verification (round=16)
[S4] DEBUG after merge:  round=16 metric=0.9490 head_norm=0.963060 delta_norm=0.099999
[S4] aggregate: ACCEPT kept=['S6', 'S8'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=16 metric=0.6914 head_norm=0.918277
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.822746e-01
[S15] stored merged vector for next round verification (round=16)
[S15] DEBUG after merge:  round=16 metric=0.6920 head_norm=0.853391 delta_norm=0.182275
[S15] aggregate: ACCEPT kept=['S16', 'S14'] (k=2/2) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.743251 (no previous merge yet)
[S2] round=17 local utility u=0.090187 metrics={'f1_val': 0.7001269353238722, 'auprc': 0.9823284640264636, 'loss_val': 0.2682053533458927, 'psi': 0.8130075468049087}-{'f1_val': 0.6993045166530358, 'auprc': 0.9296498082463979, 'loss_val': 0.2856095856014604, 'psi': 0.7914426332903807}
[S3] START round=17 head_norm_before_train=1.670710 (no previous merge yet)
[S3] round=17 local utility u=0.000000 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.9980815997042761, 'loss_val': 0.24150547366227335, 'psi': 0.8195962413818338}-{'f1_val': 0.7006060025002057, 'auprc': 0.9984520028087017, 'loss_val': 0.20936851546144508, 'psi': 0.819744402623604}
[S4] START round=17 head_norm_before_train=0.963060 cos_to_last_merge=1.0000 (last merge round=16)
[S4] round=17 local utility u=0.884735 metrics={'f1_val': 0.9538072239021959, 'auprc': 0.9508889001255341, 'loss_val': 0.4535655950729758, 'psi': 0.9526398943915312}-{'f1_val': 0.668075454042389, 'auprc': 0.9485637135164671, 'loss_val': 0.5016694354547784, 'psi': 0.7802707578320203}
[S5] START round=17 head_norm_before_train=1.095710 cos_to_last_merge=1.0000 (last merge round=16)
[S5] round=17 local utility u=0.000000 metrics={'f1_val': 0.5519276308189484, 'auprc': 0.8234768950681643, 'loss_val': 0.6507991949658599, 'psi': 0.6605473365186347}-{'f1_val': 0.700407554886547, 'auprc': 0.8564515820616927, 'loss_val': 0.45780957433682035, 'psi': 0.7628251657566053}
[S6] START round=17 head_norm_before_train=1.624737 (no previous merge yet)
[S6] round=17 local utility u=0.000000 metrics={'f1_val': 0.6630630875961405, 'auprc': 0.9042144834746274, 'loss_val': 0.3901723736658411, 'psi': 0.7595236459475352}-{'f1_val': 0.9612225423113441, 'auprc': 0.9624000005165017, 'loss_val': 0.25339074213448265, 'psi': 0.9616935255934072}
[S7] START round=17 head_norm_before_train=1.154455 cos_to_last_merge=0.8287 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.829
[S7] round=17 local utility u=0.000000 metrics={'f1_val': 0.39226298476109045, 'auprc': 0.6112468667479158, 'loss_val': 1.0522298470194371, 'psi': 0.4798565375558206}-{'f1_val': 0.4248143946939231, 'auprc': 0.6466873800688031, 'loss_val': 0.8884507819480137, 'psi': 0.5135635888438752}
[S8] START round=17 head_norm_before_train=0.939003 cos_to_last_merge=1.0000 (last merge round=16)
[S8] round=17 local utility u=0.676652 metrics={'f1_val': 0.6536464871578231, 'auprc': 0.8643504482752616, 'loss_val': 0.7166046763358678, 'psi': 0.7379280716047986}-{'f1_val': 0.37273099922839503, 'auprc': 0.9824812615749059, 'loss_val': 0.7388089836788312, 'psi': 0.6166311041669994}
[S9] START round=17 head_norm_before_train=1.036565 cos_to_last_merge=1.0000 (last merge round=16)
[S9] round=17 local utility u=0.891618 metrics={'f1_val': 0.9968062435266511, 'auprc': 0.9993113536423642, 'loss_val': 0.3885071880423302, 'psi': 0.9978082875729364}-{'f1_val': 0.7009679028957354, 'auprc': 0.9926576917414082, 'loss_val': 0.37675120504569026, 'psi': 0.8176438184340045}
[S10] START round=17 head_norm_before_train=1.648135 (no previous merge yet)
[S10] round=17 local utility u=0.030672 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9958370810852186, 'loss_val': 0.12042065982059152, 'psi': 0.9957006245430993}-{'f1_val': 0.9939447192382613, 'auprc': 0.9914289202212141, 'loss_val': 0.15855143365353824, 'psi': 0.9929383996314425}
[S11] START round=17 head_norm_before_train=1.761347 (no previous merge yet)
[S11] round=17 local utility u=0.000501 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9979493200775886, 'loss_val': 0.10677894480658769, 'psi': 0.9971079307391892}-{'f1_val': 0.9965470045135896, 'auprc': 0.9979224509263246, 'loss_val': 0.10770021411148852, 'psi': 0.9970971830786836}
[S13] START round=17 head_norm_before_train=1.589289 (no previous merge yet)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.6174007097094388, 'auprc': 0.6506401218976899, 'loss_val': 0.578905837623207, 'psi': 0.6306964745847392}-{'f1_val': 0.616991470292733, 'auprc': 0.666824969530768, 'loss_val': 0.6013588159273874, 'psi': 0.6369248699879471}
[S14] START round=17 head_norm_before_train=1.313169 cos_to_last_merge=1.0000 (last merge round=16)
[S14] round=17 local utility u=0.074464 metrics={'f1_val': 0.9962023016308376, 'auprc': 0.9989676641605274, 'loss_val': 0.2717602183255427, 'psi': 0.9973084466427135}-{'f1_val': 0.9964876071496979, 'auprc': 0.9984571891587317, 'loss_val': 0.42086869320282344, 'psi': 0.9972754399533115}
[S15] START round=17 head_norm_before_train=0.853391 cos_to_last_merge=1.0000 (last merge round=16)
[S15] round=17 local utility u=0.182670 metrics={'f1_val': 0.7289659596238702, 'auprc': 0.9901711429347125, 'loss_val': 0.3784739178262655, 'psi': 0.8334480329482072}-{'f1_val': 0.691445471055588, 'auprc': 0.9631961632887576, 'loss_val': 0.4377657953750434, 'psi': 0.8001457479488558}
[S16] START round=17 head_norm_before_train=0.914527 cos_to_last_merge=1.0000 (last merge round=16)
[S16] round=17 local utility u=0.034832 metrics={'f1_val': 0.6968763020926446, 'auprc': 0.997004644029453, 'loss_val': 0.37859514159719315, 'psi': 0.816927638867368}-{'f1_val': 0.6935583092865008, 'auprc': 0.9963564615507243, 'loss_val': 0.42640656974204916, 'psi': 0.8146775701921902}
[S17] START round=17 head_norm_before_train=1.244412 cos_to_last_merge=0.8371 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.837
[S17] round=17 local utility u=0.000000 metrics={'f1_val': 0.35816180302831935, 'auprc': 0.8558832767245421, 'loss_val': 0.9726599232040909, 'psi': 0.5572503925068085}-{'f1_val': 0.3606830583554471, 'auprc': 0.852923207021926, 'loss_val': 0.934444655182704, 'psi': 0.5575791178220387}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:44609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:44604
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:44615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:44610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:44605
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:44615
[S4] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1794 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1802) from S10
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.660147)
[S9] loaded HEAD from S10 (vec_in norm=1.660147)
[S9] cosine check vs S10: cos=0.5588
[S9] BUFFERED delta from S10 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1794) from S15
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.903905)
[S8] loaded HEAD from S15 (vec_in norm=0.903905)
[S8] cosine check vs S15: cos=0.9555
[S8] BUFFERED delta from S15 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1796) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.352410)
[S15] loaded HEAD from S14 (vec_in norm=1.352410)
[S15] cosine check vs S14: cos=0.7781
[S15] BUFFERED delta from S14 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1798) from S16
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.974309)
[S15] loaded HEAD from S16 (vec_in norm=0.974309)
[S15] cosine check vs S16: cos=0.8331
[S15] BUFFERED delta from S16 (total buffered=2)
[S4] RECEIVED delta(kind=head bytes=1794) from S8
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.981224)
[S4] loaded HEAD from S8 (vec_in norm=0.981224)
[S4] cosine check vs S8: cos=0.5431
[S4] BUFFERED delta from S8 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1798) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.075366)
[S14] loaded HEAD from S9 (vec_in norm=1.075366)
[S14] cosine check vs S9: cos=0.2136
[S14] BUFFERED delta from S9 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1797) from S11
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.791275)
[S16] loaded HEAD from S11 (vec_in norm=1.791275)
[S16] cosine check vs S11: cos=-0.0543
[S16] DROPPED delta from S11 (cos=-0.0543 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1795) from S2
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.764993)
[S16] loaded HEAD from S2 (vec_in norm=1.764993)
[S16] cosine check vs S2: cos=-0.0384
[S16] DROPPED delta from S2 (cos=-0.0384 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1794) from S4
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.017938)
[S5] loaded HEAD from S4 (vec_in norm=1.017938)
[S5] cosine check vs S4: cos=0.9671
[S5] BUFFERED delta from S4 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=17 metric=0.5519 head_norm=1.128605
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.481071e-01
[S5] stored merged vector for next round verification (round=17)
[S5] DEBUG after merge:  round=17 metric=0.5804 head_norm=1.064443 delta_norm=0.148107
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=17 metric=0.7290 head_norm=0.903905
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.702837e-01
[S15] stored merged vector for next round verification (round=17)
[S15] DEBUG after merge:  round=17 metric=0.8062 head_norm=0.933517 delta_norm=0.170284
[S15] aggregate: ACCEPT kept=['S14', 'S16'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=17 metric=0.9968 head_norm=1.075366
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.923249e-01
[S9] stored merged vector for next round verification (round=17)
[S9] DEBUG after merge:  round=17 metric=0.9880 head_norm=1.215293 delta_norm=0.692325
[S9] aggregate: ROLLBACK (f1_val pre=0.997 post=0.988 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=17 metric=0.6536 head_norm=0.981224
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.456936e-01
[S8] stored merged vector for next round verification (round=17)
[S8] DEBUG after merge:  round=17 metric=0.5407 head_norm=0.932039 delta_norm=0.145694
[S8] aggregate: ROLLBACK (f1_val pre=0.654 post=0.541 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=17 metric=0.9962 head_norm=1.352410
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.687792e-01
[S14] stored merged vector for next round verification (round=17)
[S14] DEBUG after merge:  round=17 metric=0.9966 head_norm=0.949574 delta_norm=0.768779
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=17 metric=0.9538 head_norm=1.017938
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.780232e-01
[S4] stored merged vector for next round verification (round=17)
[S4] DEBUG after merge:  round=17 metric=0.6641 head_norm=0.878062 delta_norm=0.478023
[S4] aggregate: ROLLBACK (f1_val pre=0.954 post=0.664 tol_abs=0.005 tol_rel=0.0)
[S2] START round=18 head_norm_before_train=1.764993 (no previous merge yet)
[S2] round=18 local utility u=0.008072 metrics={'f1_val': 0.7001269353238722, 'auprc': 0.9857506626776855, 'loss_val': 0.2623282104712898, 'psi': 0.8143764262653975}-{'f1_val': 0.7001269353238722, 'auprc': 0.9823284640264636, 'loss_val': 0.2682053533458927, 'psi': 0.8130075468049087}
[S3] START round=18 head_norm_before_train=1.694565 (no previous merge yet)
[S3] round=18 local utility u=0.834531 metrics={'f1_val': 0.9605709740356257, 'auprc': 0.9986615310742603, 'loss_val': 0.13397394516665187, 'psi': 0.9758071968510795}-{'f1_val': 0.7006060025002057, 'auprc': 0.9980815997042761, 'loss_val': 0.24150547366227335, 'psi': 0.8195962413818338}
[S4] START round=18 head_norm_before_train=0.878062 cos_to_last_merge=1.0000 (last merge round=17)
[S4] round=18 local utility u=0.000376 metrics={'f1_val': 0.9568739592712899, 'auprc': 0.9610704480786366, 'loss_val': 0.5017595575737277, 'psi': 0.9585525547942286}-{'f1_val': 0.9538072239021959, 'auprc': 0.9508889001255341, 'loss_val': 0.4535655950729758, 'psi': 0.9526398943915312}
[S5] START round=18 head_norm_before_train=1.064443 cos_to_last_merge=1.0000 (last merge round=17)
[S5] round=18 local utility u=0.627079 metrics={'f1_val': 0.700320598491359, 'auprc': 0.8860595120150546, 'loss_val': 0.4747466459288828, 'psi': 0.7746161639008373}-{'f1_val': 0.5519276308189484, 'auprc': 0.8234768950681643, 'loss_val': 0.6507991949658599, 'psi': 0.6605473365186347}
[S6] START round=18 head_norm_before_train=1.635262 (no previous merge yet)
[S6] round=18 local utility u=0.579006 metrics={'f1_val': 0.8226832613270291, 'auprc': 0.9541764868094171, 'loss_val': 0.33976751879102535, 'psi': 0.8752805515199843}-{'f1_val': 0.6630630875961405, 'auprc': 0.9042144834746274, 'loss_val': 0.3901723736658411, 'psi': 0.7595236459475352}
[S7] START round=18 head_norm_before_train=1.179530 cos_to_last_merge=0.8213 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.821
[S7] round=18 local utility u=0.324734 metrics={'f1_val': 0.4672071154722198, 'auprc': 0.630037251337301, 'loss_val': 0.9087982075215515, 'psi': 0.5323391698182522}-{'f1_val': 0.39226298476109045, 'auprc': 0.6112468667479158, 'loss_val': 1.0522298470194371, 'psi': 0.4798565375558206}
[S8] START round=18 head_norm_before_train=0.932039 cos_to_last_merge=1.0000 (last merge round=17)
[S8] round=18 local utility u=0.039705 metrics={'f1_val': 0.6528099342579192, 'auprc': 0.8762745185422647, 'loss_val': 0.6679477206647219, 'psi': 0.7421957679716574}-{'f1_val': 0.6536464871578231, 'auprc': 0.8643504482752616, 'loss_val': 0.7166046763358678, 'psi': 0.7379280716047986}
[S9] START round=18 head_norm_before_train=1.215293 cos_to_last_merge=1.0000 (last merge round=17)
[S9] round=18 local utility u=0.071533 metrics={'f1_val': 0.9955331911028912, 'auprc': 0.9994606044101888, 'loss_val': 0.23825072343336845, 'psi': 0.9971041564258103}-{'f1_val': 0.9968062435266511, 'auprc': 0.9993113536423642, 'loss_val': 0.3885071880423302, 'psi': 0.9978082875729364}
[S10] START round=18 head_norm_before_train=1.660147 (no previous merge yet)
[S10] round=18 local utility u=0.007461 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9957619445679698, 'loss_val': 0.10527369081056061, 'psi': 0.9956705699361998}-{'f1_val': 0.9956096535150197, 'auprc': 0.9958370810852186, 'loss_val': 0.12042065982059152, 'psi': 0.9957006245430993}
[S11] START round=18 head_norm_before_train=1.791275 (no previous merge yet)
[S11] round=18 local utility u=0.014681 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9979511223900491, 'loss_val': 0.07742171451788542, 'psi': 0.9971086516641734}-{'f1_val': 0.9965470045135896, 'auprc': 0.9979493200775886, 'loss_val': 0.10677894480658769, 'psi': 0.9971079307391892}
[S13] START round=18 head_norm_before_train=1.604794 (no previous merge yet)
[S13] round=18 local utility u=0.008309 metrics={'f1_val': 0.6223783649187812, 'auprc': 0.6674968955608508, 'loss_val': 0.6427235807400117, 'psi': 0.640425777175609}-{'f1_val': 0.6174007097094388, 'auprc': 0.6506401218976899, 'loss_val': 0.578905837623207, 'psi': 0.6306964745847392}
[S14] START round=18 head_norm_before_train=0.949574 cos_to_last_merge=1.0000 (last merge round=17)
[S14] round=18 local utility u=0.000000 metrics={'f1_val': 0.9395155688009535, 'auprc': 0.9986562682145737, 'loss_val': 0.40943422175248034, 'psi': 0.9631718485664016}-{'f1_val': 0.9962023016308376, 'auprc': 0.9989676641605274, 'loss_val': 0.2717602183255427, 'psi': 0.9973084466427135}
[S15] START round=18 head_norm_before_train=0.933517 cos_to_last_merge=1.0000 (last merge round=17)
[S15] round=18 local utility u=0.000000 metrics={'f1_val': 0.6976709744567837, 'auprc': 0.9854728915424418, 'loss_val': 0.36190066800561094, 'psi': 0.812791741291047}-{'f1_val': 0.7289659596238702, 'auprc': 0.9901711429347125, 'loss_val': 0.3784739178262655, 'psi': 0.8334480329482072}
[S16] START round=18 head_norm_before_train=0.974309 cos_to_last_merge=0.9976 (last merge round=16)
[S16] round=18 local utility u=0.703296 metrics={'f1_val': 0.9308669347835593, 'auprc': 0.9970393317522651, 'loss_val': 0.3760509588272266, 'psi': 0.9573358935710417}-{'f1_val': 0.6968763020926446, 'auprc': 0.997004644029453, 'loss_val': 0.37859514159719315, 'psi': 0.816927638867368}
[S17] START round=18 head_norm_before_train=1.251967 cos_to_last_merge=0.8344 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.834
[S17] round=18 local utility u=0.047299 metrics={'f1_val': 0.3601774703064794, 'auprc': 0.8749731236171494, 'loss_val': 0.9474252267019063, 'psi': 0.5660957316307474}-{'f1_val': 0.35816180302831935, 'auprc': 0.8558832767245421, 'loss_val': 0.9726599232040909, 'psi': 0.5572503925068085}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:44615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:44616
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:44610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] → sending delta(kind=head bytes=1792) to S16@127.0.0.1:44616
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:44610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:44604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:44604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:44605
[S9] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1792 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1801) from S8
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.980651)
[S4] loaded HEAD from S8 (vec_in norm=0.980651)
[S4] cosine check vs S8: cos=0.8497
[S4] BUFFERED delta from S8 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1804) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.645720)
[S4] loaded HEAD from S6 (vec_in norm=1.645720)
[S4] cosine check vs S6: cos=0.5562
[S4] BUFFERED delta from S6 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1801) from S16
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.035120)
[S15] loaded HEAD from S16 (vec_in norm=1.035120)
[S15] cosine check vs S16: cos=0.8265
[S15] BUFFERED delta from S16 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1797) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.263122)
[S14] loaded HEAD from S9 (vec_in norm=1.263122)
[S14] cosine check vs S9: cos=0.6129
[S14] BUFFERED delta from S9 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1803) from S3
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.720241)
[S14] loaded HEAD from S3 (vec_in norm=1.720241)
[S14] cosine check vs S3: cos=0.7038
[S14] BUFFERED delta from S3 (total buffered=2)
[S14] RECEIVED delta(kind=head bytes=1803) from S13
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.616827)
[S14] loaded HEAD from S13 (vec_in norm=1.616827)
[S14] cosine check vs S13: cos=-0.1725
[S14] DROPPED delta from S13 (cos=-0.1725 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1795) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.095273)
[S9] loaded HEAD from S5 (vec_in norm=1.095273)
[S9] cosine check vs S5: cos=0.3928
[S9] BUFFERED delta from S5 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1792) from S11
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.823265)
[S16] loaded HEAD from S11 (vec_in norm=1.823265)
[S16] cosine check vs S11: cos=-0.0515
[S16] DROPPED delta from S11 (cos=-0.0515 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1802) from S7
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.199953)
[S16] loaded HEAD from S7 (vec_in norm=1.199953)
[S16] cosine check vs S7: cos=0.7833
[S16] BUFFERED delta from S7 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1796) from S2
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.782685)
[S16] loaded HEAD from S2 (vec_in norm=1.782685)
[S16] cosine check vs S2: cos=-0.0308
[S16] DROPPED delta from S2 (cos=-0.0308 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1800) from S10
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.677282)
[S9] loaded HEAD from S10 (vec_in norm=1.677282)
[S9] cosine check vs S10: cos=0.9238
[S9] BUFFERED delta from S10 (total buffered=2)
[S5] RECEIVED delta(kind=head bytes=1802) from S4
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.926831)
[S5] loaded HEAD from S4 (vec_in norm=0.926831)
[S5] cosine check vs S4: cos=0.8504
[S5] BUFFERED delta from S4 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:44616
[S17] sending update (kind=head size=1802 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1802) from S17
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.261608)
[S16] loaded HEAD from S17 (vec_in norm=1.261608)
[S16] cosine check vs S17: cos=0.6162
[S16] BUFFERED delta from S17 (total buffered=2)
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=18 metric=0.9395 head_norm=0.993705
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.784100e-01
[S14] stored merged vector for next round verification (round=18)
[S14] DEBUG after merge:  round=18 metric=0.9410 head_norm=1.008950 delta_norm=0.178410
[S14] aggregate: ACCEPT kept=['S9', 'S3'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=18 metric=0.6977 head_norm=0.982333
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.982062e-01
[S15] stored merged vector for next round verification (round=18)
[S15] DEBUG after merge:  round=18 metric=0.6977 head_norm=0.964001 delta_norm=0.298206
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=18 metric=0.9955 head_norm=1.263122
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.854231e-01
[S9] stored merged vector for next round verification (round=18)
[S9] DEBUG after merge:  round=18 metric=0.9943 head_norm=1.133436 delta_norm=0.185423
[S9] aggregate: ACCEPT kept=['S5', 'S10'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=18 metric=0.7003 head_norm=1.095273
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.881197e-01
[S5] stored merged vector for next round verification (round=18)
[S5] DEBUG after merge:  round=18 metric=0.7006 head_norm=0.972782 delta_norm=0.288120
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=18 metric=0.9569 head_norm=0.926831
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.371115e-01
[S4] stored merged vector for next round verification (round=18)
[S4] DEBUG after merge:  round=18 metric=0.9554 head_norm=0.930882 delta_norm=0.237111
[S4] aggregate: ACCEPT kept=['S8', 'S6'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=18 metric=0.9309 head_norm=1.035120
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.485083e-01
[S16] stored merged vector for next round verification (round=18)
[S16] DEBUG after merge:  round=18 metric=0.9272 head_norm=0.954396 delta_norm=0.148508
[S16] aggregate: ACCEPT kept=['S7', 'S17'] (k=2/2) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.782685 (no previous merge yet)
[S2] round=19 local utility u=0.000000 metrics={'f1_val': 0.7037331790164348, 'auprc': 0.7879520093793321, 'loss_val': 0.307865366931671, 'psi': 0.7374207111615938}-{'f1_val': 0.7001269353238722, 'auprc': 0.9857506626776855, 'loss_val': 0.2623282104712898, 'psi': 0.8143764262653975}
[S3] START round=19 head_norm_before_train=1.720241 (no previous merge yet)
[S3] round=19 local utility u=0.000000 metrics={'f1_val': 0.7355740269038697, 'auprc': 0.9984525793595151, 'loss_val': 0.17489225911878398, 'psi': 0.8407254478861279}-{'f1_val': 0.9605709740356257, 'auprc': 0.9986615310742603, 'loss_val': 0.13397394516665187, 'psi': 0.9758071968510795}
[S4] START round=19 head_norm_before_train=0.930882 cos_to_last_merge=1.0000 (last merge round=18)
[S4] round=19 local utility u=0.000000 metrics={'f1_val': 0.946481610978507, 'auprc': 0.9481572607475399, 'loss_val': 0.4203320806174464, 'psi': 0.9471518708861202}-{'f1_val': 0.9568739592712899, 'auprc': 0.9610704480786366, 'loss_val': 0.5017595575737277, 'psi': 0.9585525547942286}
[S5] START round=19 head_norm_before_train=0.972782 cos_to_last_merge=1.0000 (last merge round=18)
[S5] round=19 local utility u=0.000000 metrics={'f1_val': 0.6688375904765398, 'auprc': 0.8537394493439427, 'loss_val': 0.550505985356565, 'psi': 0.7427983340235009}-{'f1_val': 0.700320598491359, 'auprc': 0.8860595120150546, 'loss_val': 0.4747466459288828, 'psi': 0.7746161639008373}
[S6] START round=19 head_norm_before_train=1.645720 (no previous merge yet)
[S6] round=19 local utility u=0.000000 metrics={'f1_val': 0.8113876347487241, 'auprc': 0.9443810501182106, 'loss_val': 0.3932241969409103, 'psi': 0.8645850008965187}-{'f1_val': 0.8226832613270291, 'auprc': 0.9541764868094171, 'loss_val': 0.33976751879102535, 'psi': 0.8752805515199843}
[S7] START round=19 head_norm_before_train=1.199953 cos_to_last_merge=0.8152 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.815
[S7] round=19 local utility u=0.835238 metrics={'f1_val': 0.6251254017482242, 'auprc': 0.7635746387039939, 'loss_val': 0.5864435699523766, 'psi': 0.680505096530532}-{'f1_val': 0.4672071154722198, 'auprc': 0.630037251337301, 'loss_val': 0.9087982075215515, 'psi': 0.5323391698182522}
[S8] START round=19 head_norm_before_train=0.980651 cos_to_last_merge=0.9958 (last merge round=17)
[S8] round=19 local utility u=0.217921 metrics={'f1_val': 0.6550634210237409, 'auprc': 0.981923408830059, 'loss_val': 0.5625728250871088, 'psi': 0.7858074161462683}-{'f1_val': 0.6528099342579192, 'auprc': 0.8762745185422647, 'loss_val': 0.6679477206647219, 'psi': 0.7421957679716574}
[S9] START round=19 head_norm_before_train=1.133436 cos_to_last_merge=1.0000 (last merge round=18)
[S9] round=19 local utility u=0.000000 metrics={'f1_val': 0.9892304409695105, 'auprc': 0.9994814800536074, 'loss_val': 0.22759062634054508, 'psi': 0.9933308566031493}-{'f1_val': 0.9955331911028912, 'auprc': 0.9994606044101888, 'loss_val': 0.23825072343336845, 'psi': 0.9971041564258103}
[S10] START round=19 head_norm_before_train=1.677282 (no previous merge yet)
[S10] round=19 local utility u=0.010820 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9955731018394223, 'loss_val': 0.08306768809052406, 'psi': 0.9955950328447808}-{'f1_val': 0.9956096535150197, 'auprc': 0.9957619445679698, 'loss_val': 0.10527369081056061, 'psi': 0.9956705699361998}
[S11] START round=19 head_norm_before_train=1.823265 (no previous merge yet)
[S11] round=19 local utility u=0.007305 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9982594682239359, 'loss_val': 0.06373598842953648, 'psi': 0.9972319899977281}-{'f1_val': 0.9965470045135896, 'auprc': 0.9979511223900491, 'loss_val': 0.07742171451788542, 'psi': 0.9971086516641734}
[S13] START round=19 head_norm_before_train=1.616827 (no previous merge yet)
[S13] round=19 local utility u=0.014438 metrics={'f1_val': 0.6256832774441292, 'auprc': 0.666985732973975, 'loss_val': 0.6321439925247467, 'psi': 0.6422042596560675}-{'f1_val': 0.6223783649187812, 'auprc': 0.6674968955608508, 'loss_val': 0.6427235807400117, 'psi': 0.640425777175609}
[S14] START round=19 head_norm_before_train=1.008950 cos_to_last_merge=1.0000 (last merge round=18)
[S14] round=19 local utility u=0.042073 metrics={'f1_val': 0.9415091111653373, 'auprc': 0.9985938861888114, 'loss_val': 0.337061818602225, 'psi': 0.964343021174727}-{'f1_val': 0.9395155688009535, 'auprc': 0.9986562682145737, 'loss_val': 0.40943422175248034, 'psi': 0.9631718485664016}
[S15] START round=19 head_norm_before_train=0.964001 cos_to_last_merge=1.0000 (last merge round=18)
[S15] round=19 local utility u=0.687840 metrics={'f1_val': 0.9095407386278715, 'auprc': 0.9898511905931172, 'loss_val': 0.27057413045693496, 'psi': 0.9416649194139698}-{'f1_val': 0.6976709744567837, 'auprc': 0.9854728915424418, 'loss_val': 0.36190066800561094, 'psi': 0.812791741291047}
[S16] START round=19 head_norm_before_train=0.954396 cos_to_last_merge=1.0000 (last merge round=18)
[S16] round=19 local utility u=0.229521 metrics={'f1_val': 0.9895925194293376, 'auprc': 0.9976425102602811, 'loss_val': 0.27117237789043647, 'psi': 0.9928125157617149}-{'f1_val': 0.9308669347835593, 'auprc': 0.9970393317522651, 'loss_val': 0.3760509588272266, 'psi': 0.9573358935710417}
[S17] START round=19 head_norm_before_train=1.261608 cos_to_last_merge=0.8317 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.832
[S17] round=19 local utility u=0.056784 metrics={'f1_val': 0.3673386928881805, 'auprc': 0.8606711022123832, 'loss_val': 0.83391784459029, 'psi': 0.5646716566178616}-{'f1_val': 0.3601774703064794, 'auprc': 0.8749731236171494, 'loss_val': 0.9474252267019063, 'psi': 0.5660957316307474}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:44609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:44604
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:44615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:44616
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S10] → sending delta(kind=head bytes=1806) to S9@127.0.0.1:44610
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:44615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:44616
[S7] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1804 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1806 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1804) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.061457)
[S15] loaded HEAD from S14 (vec_in norm=1.061457)
[S15] cosine check vs S14: cos=0.5844
[S15] BUFFERED delta from S14 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1795) from S15
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.014999)
[S8] loaded HEAD from S15 (vec_in norm=1.014999)
[S8] cosine check vs S15: cos=0.9389
[S8] BUFFERED delta from S15 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1798) from S16
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.012905)
[S15] loaded HEAD from S16 (vec_in norm=1.012905)
[S15] cosine check vs S16: cos=0.9445
[S15] BUFFERED delta from S16 (total buffered=2)
[S4] RECEIVED delta(kind=head bytes=1800) from S8
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.033958)
[S4] loaded HEAD from S8 (vec_in norm=1.033958)
[S4] cosine check vs S8: cos=0.6997
[S4] BUFFERED delta from S8 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1806) from S10
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.704918)
[S9] loaded HEAD from S10 (vec_in norm=1.704918)
[S9] cosine check vs S10: cos=0.8875
[S9] BUFFERED delta from S10 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1802) from S13
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.627486)
[S14] loaded HEAD from S13 (vec_in norm=1.627486)
[S14] cosine check vs S13: cos=-0.1783
[S14] DROPPED delta from S13 (cos=-0.1783 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1801) from S7
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.219091)
[S16] loaded HEAD from S7 (vec_in norm=1.219091)
[S16] cosine check vs S7: cos=0.7403
[S16] BUFFERED delta from S7 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1803) from S11
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.852291)
[S16] loaded HEAD from S11 (vec_in norm=1.852291)
[S16] cosine check vs S11: cos=-0.0584
[S16] DROPPED delta from S11 (cos=-0.0584 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:44616
[S17] sending update (kind=head size=1797 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1797) from S17
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.273187)
[S16] loaded HEAD from S17 (vec_in norm=1.273187)
[S16] cosine check vs S17: cos=0.6792
[S16] BUFFERED delta from S17 (total buffered=2)
[S5] r=20 psi=0.743 u=0.0000 p_local=0.2164 f1=0.669 auprc=0.854 bytes=17971
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=19 metric=0.9465 head_norm=0.987534
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.922648e-01
[S4] stored merged vector for next round verification (round=19)
[S4] DEBUG after merge:  round=19 metric=0.9475 head_norm=0.931813 delta_norm=0.392265
[S4] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S4] r=20 psi=0.947 u=0.0000 p_local=0.2404 f1=0.946 auprc=0.948 bytes=19770
[S2] r=20 psi=0.737 u=0.0000 p_local=0.0803 f1=0.704 auprc=0.788 bytes=23369
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=19 metric=0.9892 head_norm=1.185584
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.256181e-01
[S9] stored merged vector for next round verification (round=19)
[S9] DEBUG after merge:  round=19 metric=0.9875 head_norm=1.405356 delta_norm=0.425618
[S9] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S9] r=20 psi=0.993 u=0.0000 p_local=0.2378 f1=0.989 auprc=0.999 bytes=21578
[S3] r=20 psi=0.841 u=0.0000 p_local=0.1983 f1=0.736 auprc=0.998 bytes=21602
[S6] r=20 psi=0.865 u=0.0000 p_local=0.2472 f1=0.811 auprc=0.944 bytes=21575
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=19 metric=0.9896 head_norm=1.012905
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.102977e-01
[S16] stored merged vector for next round verification (round=19)
[S16] DEBUG after merge:  round=19 metric=0.9870 head_norm=0.952454 delta_norm=0.110298
[S16] aggregate: ACCEPT kept=['S7', 'S17'] (k=2/2) mode=median trim_p=0.1
[S16] r=20 psi=0.993 u=0.2295 p_local=0.2938 f1=0.990 auprc=0.998 bytes=23363
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=19 metric=0.6551 head_norm=1.033958
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.793152e-01
[S8] stored merged vector for next round verification (round=19)
[S8] DEBUG after merge:  round=19 metric=0.6553 head_norm=1.008708 delta_norm=0.179315
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S8] r=20 psi=0.786 u=0.2179 p_local=0.2093 f1=0.655 auprc=0.982 bytes=21556
[S7] r=20 psi=0.681 u=0.8352 p_local=0.3196 f1=0.625 auprc=0.764 bytes=19795
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=19 metric=0.9095 head_norm=1.014999
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.947298e-01
[S15] stored merged vector for next round verification (round=19)
[S15] DEBUG after merge:  round=19 metric=0.9755 head_norm=0.915563 delta_norm=0.194730
[S15] aggregate: ACCEPT kept=['S14', 'S16'] (k=2/2) mode=median trim_p=0.1
[S15] r=20 psi=0.942 u=0.6878 p_local=0.2558 f1=0.910 auprc=0.990 bytes=25143
[S14] r=20 psi=0.964 u=0.0421 p_local=0.1721 f1=0.942 auprc=0.999 bytes=21557
[S13] r=20 psi=0.642 u=0.0144 p_local=0.0568 f1=0.626 auprc=0.667 bytes=18007
[S10] r=20 psi=0.996 u=0.0108 p_local=0.1145 f1=0.996 auprc=0.996 bytes=23406
[S11] r=20 psi=0.997 u=0.0073 p_local=0.1182 f1=0.997 auprc=0.998 bytes=26979
[S17] r=20 psi=0.565 u=0.0568 p_local=0.0819 f1=0.367 auprc=0.861 bytes=16153
[S2] START round=20 head_norm_before_train=1.790853 (no previous merge yet)
[S2] round=20 local utility u=0.000000 metrics={'f1_val': 0.7140765741935879, 'auprc': 0.788110823096488, 'loss_val': 0.44056194509337776, 'psi': 0.7436902737547479}-{'f1_val': 0.7037331790164348, 'auprc': 0.7879520093793321, 'loss_val': 0.307865366931671, 'psi': 0.7374207111615938}
[S3] START round=20 head_norm_before_train=1.742591 (no previous merge yet)
[S3] round=20 local utility u=0.800260 metrics={'f1_val': 0.987695488604234, 'auprc': 0.9985103315853392, 'loss_val': 0.08727374669222457, 'psi': 0.992021425796676}-{'f1_val': 0.7355740269038697, 'auprc': 0.9984525793595151, 'loss_val': 0.17489225911878398, 'psi': 0.8407254478861279}
[S4] START round=20 head_norm_before_train=0.931813 cos_to_last_merge=1.0000 (last merge round=19)
[S4] round=20 local utility u=0.032287 metrics={'f1_val': 0.9513827811680355, 'auprc': 0.971845072028152, 'loss_val': 0.45622949466524415, 'psi': 0.9595676975120822}-{'f1_val': 0.946481610978507, 'auprc': 0.9481572607475399, 'loss_val': 0.4203320806174464, 'psi': 0.9471518708861202}
[S5] START round=20 head_norm_before_train=1.004750 cos_to_last_merge=0.9983 (last merge round=18)
[S5] round=20 local utility u=0.125681 metrics={'f1_val': 0.6949444578714125, 'auprc': 0.8562570560927112, 'loss_val': 0.463338683583664, 'psi': 0.7594694971599321}-{'f1_val': 0.6688375904765398, 'auprc': 0.8537394493439427, 'loss_val': 0.550505985356565, 'psi': 0.7427983340235009}
[S6] START round=20 head_norm_before_train=1.659323 (no previous merge yet)
[S6] round=20 local utility u=0.025541 metrics={'f1_val': 0.8214351962231459, 'auprc': 0.9534506055803127, 'loss_val': 0.4296354837946204, 'psi': 0.8742413599660126}-{'f1_val': 0.8113876347487241, 'auprc': 0.9443810501182106, 'loss_val': 0.3932241969409103, 'psi': 0.8645850008965187}
[S7] START round=20 head_norm_before_train=1.219091 cos_to_last_merge=0.8110 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.811
[S7] round=20 local utility u=0.000000 metrics={'f1_val': 0.4031363493446991, 'auprc': 0.6314578086710548, 'loss_val': 1.0880466696101148, 'psi': 0.4944649330752414}-{'f1_val': 0.6251254017482242, 'auprc': 0.7635746387039939, 'loss_val': 0.5864435699523766, 'psi': 0.680505096530532}
[S8] START round=20 head_norm_before_train=1.008708 cos_to_last_merge=1.0000 (last merge round=19)
[S8] round=20 local utility u=0.009182 metrics={'f1_val': 0.6531869895801803, 'auprc': 0.9889222488371887, 'loss_val': 0.5539475371117, 'psi': 0.7874810932829837}-{'f1_val': 0.6550634210237409, 'auprc': 0.981923408830059, 'loss_val': 0.5625728250871088, 'psi': 0.7858074161462683}
[S9] START round=20 head_norm_before_train=1.405356 cos_to_last_merge=1.0000 (last merge round=19)
[S9] round=20 local utility u=0.046486 metrics={'f1_val': 0.9938671257720713, 'auprc': 0.9994838084600881, 'loss_val': 0.16244489312461205, 'psi': 0.996113798847278}-{'f1_val': 0.9892304409695105, 'auprc': 0.9994814800536074, 'loss_val': 0.22759062634054508, 'psi': 0.9933308566031493}
[S10] START round=20 head_norm_before_train=1.704918 (no previous merge yet)
[S10] round=20 local utility u=0.007360 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9957401965093959, 'loss_val': 0.06631823169080873, 'psi': 0.9954087820153832}-{'f1_val': 0.9956096535150197, 'auprc': 0.9955731018394223, 'loss_val': 0.08306768809052406, 'psi': 0.9955950328447808}
[S11] START round=20 head_norm_before_train=1.852291 (no previous merge yet)
[S11] round=20 local utility u=0.004839 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9982807767927369, 'loss_val': 0.05412280519943857, 'psi': 0.9972405134252484}-{'f1_val': 0.9965470045135896, 'auprc': 0.9982594682239359, 'loss_val': 0.06373598842953648, 'psi': 0.9972319899977281}
[S13] START round=20 head_norm_before_train=1.627486 (no previous merge yet)
[S13] round=20 local utility u=0.000000 metrics={'f1_val': 0.6238318318579237, 'auprc': 0.6688629380736413, 'loss_val': 0.6411753375824281, 'psi': 0.6418442743442108}-{'f1_val': 0.6256832774441292, 'auprc': 0.666985732973975, 'loss_val': 0.6321439925247467, 'psi': 0.6422042596560675}
[S14] START round=20 head_norm_before_train=1.061457 cos_to_last_merge=0.9973 (last merge round=18)
[S14] round=20 local utility u=0.210171 metrics={'f1_val': 0.9976226870742808, 'auprc': 0.9986622615953455, 'loss_val': 0.2536072297895718, 'psi': 0.9980385168827067}-{'f1_val': 0.9415091111653373, 'auprc': 0.9985938861888114, 'loss_val': 0.337061818602225, 'psi': 0.964343021174727}
[S15] START round=20 head_norm_before_train=0.915563 cos_to_last_merge=1.0000 (last merge round=19)
[S15] round=20 local utility u=0.000000 metrics={'f1_val': 0.6980884699663077, 'auprc': 0.9723086137694329, 'loss_val': 0.3831636267344143, 'psi': 0.8077765274875578}-{'f1_val': 0.9095407386278715, 'auprc': 0.9898511905931172, 'loss_val': 0.27057413045693496, 'psi': 0.9416649194139698}
[S16] START round=20 head_norm_before_train=0.952454 cos_to_last_merge=1.0000 (last merge round=19)
[S16] round=20 local utility u=0.015192 metrics={'f1_val': 0.9924110498129963, 'auprc': 0.9967767189532312, 'loss_val': 0.25510266821902194, 'psi': 0.9941573174690902}-{'f1_val': 0.9895925194293376, 'auprc': 0.9976425102602811, 'loss_val': 0.27117237789043647, 'psi': 0.9928125157617149}
[S17] START round=20 head_norm_before_train=1.273187 cos_to_last_merge=0.8288 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.829
[S17] round=20 local utility u=0.105288 metrics={'f1_val': 0.39211049092363703, 'auprc': 0.8208348472990411, 'loss_val': 0.6524631616881633, 'psi': 0.5636002334737987}-{'f1_val': 0.3673386928881805, 'auprc': 0.8606711022123832, 'loss_val': 0.83391784459029, 'psi': 0.5646716566178616}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:44604
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:44615
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:44615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:44610
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:44610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:44605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:44604
[S6] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1802) from S10
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.737056)
[S9] loaded HEAD from S10 (vec_in norm=1.737056)
[S9] cosine check vs S10: cos=0.9749
[S9] BUFFERED delta from S10 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1798) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.044602)
[S9] loaded HEAD from S5 (vec_in norm=1.044602)
[S9] cosine check vs S5: cos=0.2439
[S9] BUFFERED delta from S5 (total buffered=2)
[S4] RECEIVED delta(kind=head bytes=1801) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.672374)
[S4] loaded HEAD from S6 (vec_in norm=1.672374)
[S4] cosine check vs S6: cos=0.4723
[S4] BUFFERED delta from S6 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1800) from S16
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.011274)
[S15] loaded HEAD from S16 (vec_in norm=1.011274)
[S15] cosine check vs S16: cos=0.8879
[S15] BUFFERED delta from S16 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1800) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.117044)
[S15] loaded HEAD from S14 (vec_in norm=1.117044)
[S15] cosine check vs S14: cos=0.6979
[S15] BUFFERED delta from S14 (total buffered=2)
[S4] RECEIVED delta(kind=head bytes=1799) from S8
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.053452)
[S4] loaded HEAD from S8 (vec_in norm=1.053452)
[S4] cosine check vs S8: cos=0.8918
[S4] BUFFERED delta from S8 (total buffered=2)
[S14] RECEIVED delta(kind=head bytes=1803) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.448071)
[S14] loaded HEAD from S9 (vec_in norm=1.448071)
[S14] cosine check vs S9: cos=0.5501
[S14] BUFFERED delta from S9 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1801) from S3
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.759429)
[S14] loaded HEAD from S3 (vec_in norm=1.759429)
[S14] cosine check vs S3: cos=0.7625
[S14] BUFFERED delta from S3 (total buffered=2)
[S16] RECEIVED delta(kind=head bytes=1802) from S11
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.881189)
[S16] loaded HEAD from S11 (vec_in norm=1.881189)
[S16] cosine check vs S11: cos=-0.0595
[S16] DROPPED delta from S11 (cos=-0.0595 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1797) from S4
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.977236)
[S5] loaded HEAD from S4 (vec_in norm=0.977236)
[S5] cosine check vs S4: cos=0.8941
[S5] BUFFERED delta from S4 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:44616
[S17] sending update (kind=head size=1800 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1800) from S17
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.288493)
[S16] loaded HEAD from S17 (vec_in norm=1.288493)
[S16] cosine check vs S17: cos=0.7089
[S16] BUFFERED delta from S17 (total buffered=1)
[S13] ⇄ pheromone p=0.045 → S14@127.0.0.1:44614
[S2] ⇄ pheromone p=0.064 → S16@127.0.0.1:44616
[S7] ⇄ pheromone p=0.256 → S16@127.0.0.1:44616
[S6] ⇄ pheromone p=0.203 → S4@127.0.0.1:44604
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=20 metric=0.9939 head_norm=1.448071
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.981636e-01
[S9] stored merged vector for next round verification (round=20)
[S9] DEBUG after merge:  round=20 metric=0.9934 head_norm=1.224528 delta_norm=0.298164
[S9] aggregate: ACCEPT kept=['S10', 'S5'] (k=2/2) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.200 → S14@127.0.0.1:44614
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=20 metric=0.6949 head_norm=1.044602
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.349434e-01
[S5] stored merged vector for next round verification (round=20)
[S5] DEBUG after merge:  round=20 metric=0.7003 head_norm=0.983816 delta_norm=0.234943
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.198 → S9@127.0.0.1:44610
[S8] ⇄ pheromone p=0.169 → S4@127.0.0.1:44604
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=20 metric=0.9976 head_norm=1.117044
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.804225e-01
[S14] stored merged vector for next round verification (round=20)
[S14] DEBUG after merge:  round=20 metric=0.9967 head_norm=1.107572 delta_norm=0.180422
[S14] aggregate: ACCEPT kept=['S9', 'S3'] (k=2/2) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.180 → S15@127.0.0.1:44615
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=20 metric=0.9514 head_norm=0.977236
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.794850e-01
[S4] stored merged vector for next round verification (round=20)
[S4] DEBUG after merge:  round=20 metric=0.9498 head_norm=0.960779 delta_norm=0.279485
[S4] aggregate: ACCEPT kept=['S6', 'S8'] (k=2/2) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.199 → S5@127.0.0.1:44605
[S11] ⇄ pheromone p=0.096 → S16@127.0.0.1:44616
[S10] ⇄ pheromone p=0.093 → S9@127.0.0.1:44610
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=20 metric=0.9924 head_norm=1.011274
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.570112e-01
[S16] stored merged vector for next round verification (round=20)
[S16] DEBUG after merge:  round=20 metric=0.9900 head_norm=1.064230 delta_norm=0.457011
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.238 → S15@127.0.0.1:44615
[S3] ⇄ pheromone p=0.319 → S14@127.0.0.1:44614
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=20 metric=0.6981 head_norm=0.964714
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.265084e-01
[S15] stored merged vector for next round verification (round=20)
[S15] DEBUG after merge:  round=20 metric=0.6982 head_norm=0.908379 delta_norm=0.126508
[S15] aggregate: ACCEPT kept=['S16', 'S14'] (k=2/2) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.205 → S8@127.0.0.1:44609
[S17] ⇄ pheromone p=0.087 → S16@127.0.0.1:44616
[S2] START round=21 head_norm_before_train=1.801606 (no previous merge yet)
[S2] round=21 local utility u=0.019267 metrics={'f1_val': 0.7024136952886046, 'auprc': 0.7849049018940105, 'loss_val': 0.32243228714989786, 'psi': 0.735410177930767}-{'f1_val': 0.7140765741935879, 'auprc': 0.788110823096488, 'loss_val': 0.44056194509337776, 'psi': 0.7436902737547479}
[S3] START round=21 head_norm_before_train=1.759429 (no previous merge yet)
[S3] round=21 local utility u=0.000000 metrics={'f1_val': 0.9737565819597069, 'auprc': 0.9986899710444128, 'loss_val': 0.08406134097831039, 'psi': 0.9837299375935893}-{'f1_val': 0.987695488604234, 'auprc': 0.9985103315853392, 'loss_val': 0.08727374669222457, 'psi': 0.992021425796676}
[S4] START round=21 head_norm_before_train=0.960779 cos_to_last_merge=1.0000 (last merge round=20)
[S4] round=21 local utility u=0.029927 metrics={'f1_val': 0.9533028287856862, 'auprc': 0.9608714225314239, 'loss_val': 0.37497474629432237, 'psi': 0.9563302662839812}-{'f1_val': 0.9513827811680355, 'auprc': 0.971845072028152, 'loss_val': 0.45622949466524415, 'psi': 0.9595676975120822}
[S5] START round=21 head_norm_before_train=0.983816 cos_to_last_merge=1.0000 (last merge round=20)
[S5] round=21 local utility u=0.000000 metrics={'f1_val': 0.667046282195277, 'auprc': 0.8470786804301944, 'loss_val': 0.5079795491418808, 'psi': 0.7390592414892438}-{'f1_val': 0.6949444578714125, 'auprc': 0.8562570560927112, 'loss_val': 0.463338683583664, 'psi': 0.7594694971599321}
[S6] START round=21 head_norm_before_train=1.672374 (no previous merge yet)
[S6] round=21 local utility u=0.402768 metrics={'f1_val': 0.9219544220025071, 'auprc': 0.955501422100252, 'loss_val': 0.2333676657645416, 'psi': 0.9353732220416051}-{'f1_val': 0.8214351962231459, 'auprc': 0.9534506055803127, 'loss_val': 0.4296354837946204, 'psi': 0.8742413599660126}
[S7] START round=21 head_norm_before_train=1.235018 cos_to_last_merge=0.8077 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.808
[S7] round=21 local utility u=1.000000 metrics={'f1_val': 0.6431612341144024, 'auprc': 0.8300663439056393, 'loss_val': 0.5530604896362221, 'psi': 0.7179232780308972}-{'f1_val': 0.4031363493446991, 'auprc': 0.6314578086710548, 'loss_val': 1.0880466696101148, 'psi': 0.4944649330752414}
[S8] START round=21 head_norm_before_train=1.053452 cos_to_last_merge=0.9979 (last merge round=19)
[S8] round=21 local utility u=1.000000 metrics={'f1_val': 0.9959161110103343, 'auprc': 0.991916475009926, 'loss_val': 0.3458083109934447, 'psi': 0.994316256610171}-{'f1_val': 0.6531869895801803, 'auprc': 0.9889222488371887, 'loss_val': 0.5539475371117, 'psi': 0.7874810932829837}
[S9] START round=21 head_norm_before_train=1.224528 cos_to_last_merge=1.0000 (last merge round=20)
[S9] round=21 local utility u=0.001693 metrics={'f1_val': 0.9963665676526772, 'auprc': 0.9987668624112586, 'loss_val': 0.1719051743354291, 'psi': 0.9973266855561097}-{'f1_val': 0.9938671257720713, 'auprc': 0.9994838084600881, 'loss_val': 0.16244489312461205, 'psi': 0.996113798847278}
[S10] START round=21 head_norm_before_train=1.737056 (no previous merge yet)
[S10] round=21 local utility u=0.004281 metrics={'f1_val': 0.9949436619942489, 'auprc': 0.9957022732537761, 'loss_val': 0.056177927906714, 'psi': 0.9952471064980598}-{'f1_val': 0.9951878390193748, 'auprc': 0.9957401965093959, 'loss_val': 0.06631823169080873, 'psi': 0.9954087820153832}
[S11] START round=21 head_norm_before_train=1.881189 (no previous merge yet)
[S11] round=21 local utility u=0.003288 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9981864062644161, 'loss_val': 0.047264564888056346, 'psi': 0.9972027652139202}-{'f1_val': 0.9965470045135896, 'auprc': 0.9982807767927369, 'loss_val': 0.05412280519943857, 'psi': 0.9972405134252484}
[S13] START round=21 head_norm_before_train=1.639990 (no previous merge yet)
[S13] round=21 local utility u=0.040974 metrics={'f1_val': 0.633757838044382, 'auprc': 0.6520183555874681, 'loss_val': 0.568249410223977, 'psi': 0.6410620450616165}-{'f1_val': 0.6238318318579237, 'auprc': 0.6688629380736413, 'loss_val': 0.6411753375824281, 'psi': 0.6418442743442108}
[S14] START round=21 head_norm_before_train=1.107572 cos_to_last_merge=1.0000 (last merge round=20)
[S14] round=21 local utility u=0.001970 metrics={'f1_val': 0.9958979278588579, 'auprc': 0.9937405173930722, 'loss_val': 0.22455355149396322, 'psi': 0.9950349636725437}-{'f1_val': 0.9976226870742808, 'auprc': 0.9986622615953455, 'loss_val': 0.2536072297895718, 'psi': 0.9980385168827067}
[S15] START round=21 head_norm_before_train=0.908379 cos_to_last_merge=1.0000 (last merge round=20)
[S15] round=21 local utility u=0.648237 metrics={'f1_val': 0.8869689550315338, 'auprc': 0.9922207778133635, 'loss_val': 0.2797097084823979, 'psi': 0.9290696841442657}-{'f1_val': 0.6980884699663077, 'auprc': 0.9723086137694329, 'loss_val': 0.3831636267344143, 'psi': 0.8077765274875578}
[S16] START round=21 head_norm_before_train=1.064230 cos_to_last_merge=1.0000 (last merge round=20)
[S16] round=21 local utility u=0.000000 metrics={'f1_val': 0.8367259295172933, 'auprc': 0.9819696245471249, 'loss_val': 0.6981109027164495, 'psi': 0.894823407529226}-{'f1_val': 0.9924110498129963, 'auprc': 0.9967767189532312, 'loss_val': 0.25510266821902194, 'psi': 0.9941573174690902}
[S17] START round=21 head_norm_before_train=1.288493 cos_to_last_merge=0.8261 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.826
[S17] round=21 local utility u=0.568339 metrics={'f1_val': 0.5245472262736945, 'auprc': 0.9120434518208747, 'loss_val': 0.5840318597717209, 'psi': 0.6795457164925667}-{'f1_val': 0.39211049092363703, 'auprc': 0.8208348472990411, 'loss_val': 0.6524631616881633, 'psi': 0.5636002334737987}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:44610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:44604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:44615
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S15] → sending delta(kind=head bytes=1791) to S8@127.0.0.1:44609
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:44604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:44605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] → sending delta(kind=head bytes=1806) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:44616
[S2] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1804 to 1 peers)
[S13] sending update (kind=head size=1806 to 1 peers)
[S15] sending update (kind=head size=1791 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1804) from S11
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.908042)
[S16] loaded HEAD from S11 (vec_in norm=1.908042)
[S16] cosine check vs S11: cos=-0.0677
[S16] DROPPED delta from S11 (cos=-0.0677 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1803) from S7
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.246972)
[S16] loaded HEAD from S7 (vec_in norm=1.246972)
[S16] cosine check vs S7: cos=0.3778
[S16] BUFFERED delta from S7 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1791) from S15
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.954350)
[S8] loaded HEAD from S15 (vec_in norm=0.954350)
[S8] cosine check vs S15: cos=0.9551
[S8] BUFFERED delta from S15 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1799) from S2
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.813218)
[S16] loaded HEAD from S2 (vec_in norm=1.813218)
[S16] cosine check vs S2: cos=-0.0281
[S16] DROPPED delta from S2 (cos=-0.0281 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1798) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.151469)
[S15] loaded HEAD from S14 (vec_in norm=1.151469)
[S15] cosine check vs S14: cos=0.7449
[S15] BUFFERED delta from S14 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1797) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.683319)
[S4] loaded HEAD from S6 (vec_in norm=1.683319)
[S4] cosine check vs S6: cos=0.7063
[S4] BUFFERED delta from S6 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1804) from S8
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.096131)
[S4] loaded HEAD from S8 (vec_in norm=1.096131)
[S4] cosine check vs S8: cos=0.7426
[S4] BUFFERED delta from S8 (total buffered=2)
[S14] RECEIVED delta(kind=head bytes=1806) from S13
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.653996)
[S14] loaded HEAD from S13 (vec_in norm=1.653996)
[S14] cosine check vs S13: cos=-0.1822
[S14] DROPPED delta from S13 (cos=-0.1822 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1797) from S4
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.011723)
[S5] loaded HEAD from S4 (vec_in norm=1.011723)
[S5] cosine check vs S4: cos=0.9773
[S5] BUFFERED delta from S4 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1800) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.265946)
[S14] loaded HEAD from S9 (vec_in norm=1.265946)
[S14] cosine check vs S9: cos=0.6522
[S14] BUFFERED delta from S9 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1803) from S10
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.768827)
[S9] loaded HEAD from S10 (vec_in norm=1.768827)
[S9] cosine check vs S10: cos=0.9364
[S9] BUFFERED delta from S10 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:44616
[S17] sending update (kind=head size=1793 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1793) from S17
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.308068)
[S16] loaded HEAD from S17 (vec_in norm=1.308068)
[S16] cosine check vs S17: cos=0.9312
[S16] BUFFERED delta from S17 (total buffered=2)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=21 metric=0.6670 head_norm=1.027560
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.089542e-01
[S5] stored merged vector for next round verification (round=21)
[S5] DEBUG after merge:  round=21 metric=0.6735 head_norm=1.013834 delta_norm=0.108954
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=21 metric=0.9533 head_norm=1.011723
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.416892e-01
[S4] stored merged vector for next round verification (round=21)
[S4] DEBUG after merge:  round=21 metric=0.9519 head_norm=1.016495 delta_norm=0.141689
[S4] aggregate: ACCEPT kept=['S6', 'S8'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=21 metric=0.9959 head_norm=1.096131
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.688006e-01
[S8] stored merged vector for next round verification (round=21)
[S8] DEBUG after merge:  round=21 metric=0.9959 head_norm=1.013731 delta_norm=0.168801
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=21 metric=0.9959 head_norm=1.151469
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.067180e-01
[S14] stored merged vector for next round verification (round=21)
[S14] DEBUG after merge:  round=21 metric=0.9959 head_norm=1.098857 delta_norm=0.506718
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=21 metric=0.9964 head_norm=1.265946
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.666247e-01
[S9] stored merged vector for next round verification (round=21)
[S9] DEBUG after merge:  round=21 metric=0.9964 head_norm=1.493744 delta_norm=0.366625
[S9] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=21 metric=0.8870 head_norm=0.954350
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.871773e-01
[S15] stored merged vector for next round verification (round=21)
[S15] DEBUG after merge:  round=21 metric=0.9820 head_norm=0.984086 delta_norm=0.387177
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=21 metric=0.8367 head_norm=1.114571
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.307003e-01
[S16] stored merged vector for next round verification (round=21)
[S16] DEBUG after merge:  round=21 metric=0.8355 head_norm=0.997305 delta_norm=0.230700
[S16] aggregate: ACCEPT kept=['S7', 'S17'] (k=2/2) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.813218 (no previous merge yet)
[S2] round=22 local utility u=0.015155 metrics={'f1_val': 0.7011259080402672, 'auprc': 0.785317605651358, 'loss_val': 0.2856331594254371, 'psi': 0.7348025870847035}-{'f1_val': 0.7024136952886046, 'auprc': 0.7849049018940105, 'loss_val': 0.32243228714989786, 'psi': 0.735410177930767}
[S3] START round=22 head_norm_before_train=1.778858 (no previous merge yet)
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.9614594427737211, 'auprc': 0.9985069871274532, 'loss_val': 0.08993851643946289, 'psi': 0.9762784605152139}-{'f1_val': 0.9737565819597069, 'auprc': 0.9986899710444128, 'loss_val': 0.08406134097831039, 'psi': 0.9837299375935893}
[S4] START round=22 head_norm_before_train=1.016495 cos_to_last_merge=1.0000 (last merge round=21)
[S4] round=22 local utility u=0.004510 metrics={'f1_val': 0.9511437434682775, 'auprc': 0.9594996238320042, 'loss_val': 0.3488839678598197, 'psi': 0.9544860956137681}-{'f1_val': 0.9533028287856862, 'auprc': 0.9608714225314239, 'loss_val': 0.37497474629432237, 'psi': 0.9563302662839812}
[S5] START round=22 head_norm_before_train=1.013834 cos_to_last_merge=1.0000 (last merge round=21)
[S5] round=22 local utility u=0.312046 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9596730896590734, 'loss_val': 0.4213172204475902, 'psi': 0.8040615949584448}-{'f1_val': 0.667046282195277, 'auprc': 0.8470786804301944, 'loss_val': 0.5079795491418808, 'psi': 0.7390592414892438}
[S6] START round=22 head_norm_before_train=1.683319 (no previous merge yet)
[S6] round=22 local utility u=0.000000 metrics={'f1_val': 0.5152460674028336, 'auprc': 0.7497714028722293, 'loss_val': 0.8291454757584313, 'psi': 0.6090562015905919}-{'f1_val': 0.9219544220025071, 'auprc': 0.955501422100252, 'loss_val': 0.2333676657645416, 'psi': 0.9353732220416051}
[S7] START round=22 head_norm_before_train=1.246972 cos_to_last_merge=0.8052 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.805
[S7] round=22 local utility u=0.000000 metrics={'f1_val': 0.38858533214521507, 'auprc': 0.6729248726939315, 'loss_val': 1.1602043955911299, 'psi': 0.5023211483647017}-{'f1_val': 0.6431612341144024, 'auprc': 0.8300663439056393, 'loss_val': 0.5530604896362221, 'psi': 0.7179232780308972}
[S8] START round=22 head_norm_before_train=1.013731 cos_to_last_merge=1.0000 (last merge round=21)
[S8] round=22 local utility u=0.023620 metrics={'f1_val': 0.9960662206126181, 'auprc': 0.9920338585471268, 'loss_val': 0.2998218245813637, 'psi': 0.9944532757864215}-{'f1_val': 0.9959161110103343, 'auprc': 0.991916475009926, 'loss_val': 0.3458083109934447, 'psi': 0.994316256610171}
[S9] START round=22 head_norm_before_train=1.493744 cos_to_last_merge=1.0000 (last merge round=21)
[S9] round=22 local utility u=0.002846 metrics={'f1_val': 0.9905305596763693, 'auprc': 0.9994880784071547, 'loss_val': 0.13336171869440644, 'psi': 0.9941135671686834}-{'f1_val': 0.9963665676526772, 'auprc': 0.9987668624112586, 'loss_val': 0.1719051743354291, 'psi': 0.9973266855561097}
[S10] START round=22 head_norm_before_train=1.768827 (no previous merge yet)
[S10] round=22 local utility u=0.002640 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9953250238110098, 'loss_val': 0.048596185377582805, 'psi': 0.9949791750560275}-{'f1_val': 0.9949436619942489, 'auprc': 0.9957022732537761, 'loss_val': 0.056177927906714, 'psi': 0.9952471064980598}
[S11] START round=22 head_norm_before_train=1.908042 (no previous merge yet)
[S11] round=22 local utility u=0.000000 metrics={'f1_val': 0.9958246664506369, 'auprc': 0.9982068619598944, 'loss_val': 0.04676591978034152, 'psi': 0.9967775446543399}-{'f1_val': 0.9965470045135896, 'auprc': 0.9981864062644161, 'loss_val': 0.047264564888056346, 'psi': 0.9972027652139202}
[S13] START round=22 head_norm_before_train=1.653996 (no previous merge yet)
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.621209242327019, 'auprc': 0.6730715391230473, 'loss_val': 0.6766898601074472, 'psi': 0.6419541610454302}-{'f1_val': 0.633757838044382, 'auprc': 0.6520183555874681, 'loss_val': 0.568249410223977, 'psi': 0.6410620450616165}
[S14] START round=22 head_norm_before_train=1.098857 cos_to_last_merge=1.0000 (last merge round=21)
[S14] round=22 local utility u=0.000000 metrics={'f1_val': 0.9785031882703672, 'auprc': 0.9985961886684397, 'loss_val': 0.30912258096077216, 'psi': 0.9865403884295961}-{'f1_val': 0.9958979278588579, 'auprc': 0.9937405173930722, 'loss_val': 0.22455355149396322, 'psi': 0.9950349636725437}
[S15] START round=22 head_norm_before_train=0.984086 cos_to_last_merge=1.0000 (last merge round=21)
[S15] round=22 local utility u=0.000000 metrics={'f1_val': 0.7632327957945004, 'auprc': 0.9876010352496557, 'loss_val': 0.37221912117070133, 'psi': 0.8529800915765625}-{'f1_val': 0.8869689550315338, 'auprc': 0.9922207778133635, 'loss_val': 0.2797097084823979, 'psi': 0.9290696841442657}
[S16] START round=22 head_norm_before_train=0.997305 cos_to_last_merge=1.0000 (last merge round=21)
[S16] round=22 local utility u=0.691282 metrics={'f1_val': 0.9854329600470325, 'auprc': 0.9979435210899155, 'loss_val': 0.25570977678107537, 'psi': 0.9904371844641857}-{'f1_val': 0.8367259295172933, 'auprc': 0.9819696245471249, 'loss_val': 0.6981109027164495, 'psi': 0.894823407529226}
[S17] START round=22 head_norm_before_train=1.308068 cos_to_last_merge=0.8238 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.824
[S17] round=22 local utility u=0.000000 metrics={'f1_val': 0.5474268850225475, 'auprc': 0.8319547013627949, 'loss_val': 0.5543108346726355, 'psi': 0.6612380115586465}-{'f1_val': 0.5245472262736945, 'auprc': 0.9120434518208747, 'loss_val': 0.5840318597717209, 'psi': 0.6795457164925667}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:44616
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:44605
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:44604
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S9] → sending delta(kind=head bytes=1809) to S14@127.0.0.1:44614
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:44610
[S5] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1809 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1809) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.528623)
[S14] loaded HEAD from S9 (vec_in norm=1.528623)
[S14] cosine check vs S9: cos=0.8592
[S14] BUFFERED delta from S9 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1798) from S8
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.051591)
[S4] loaded HEAD from S8 (vec_in norm=1.051591)
[S4] cosine check vs S8: cos=0.6929
[S4] BUFFERED delta from S8 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1801) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.057850)
[S9] loaded HEAD from S5 (vec_in norm=1.057850)
[S9] cosine check vs S5: cos=0.2160
[S9] BUFFERED delta from S5 (total buffered=1)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:44610
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1795 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1795) from S10
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.796325)
[S9] loaded HEAD from S10 (vec_in norm=1.796325)
[S9] cosine check vs S10: cos=0.9849
[S9] BUFFERED delta from S10 (total buffered=2)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:44615
[S16] sending update (kind=head size=1796 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1796) from S16
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.041943)
[S15] loaded HEAD from S16 (vec_in norm=1.041943)
[S15] cosine check vs S16: cos=0.5308
[S15] BUFFERED delta from S16 (total buffered=1)
[S2] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1795) from S2
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.824574)
[S16] loaded HEAD from S2 (vec_in norm=1.824574)
[S16] cosine check vs S2: cos=-0.0338
[S16] DROPPED delta from S2 (cos=-0.0338 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1796) from S4
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.060101)
[S5] loaded HEAD from S4 (vec_in norm=1.060101)
[S5] cosine check vs S4: cos=0.9733
[S5] BUFFERED delta from S4 (total buffered=1)
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=22 metric=0.9905 head_norm=1.528623
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.305212e-01
[S9] stored merged vector for next round verification (round=22)
[S9] DEBUG after merge:  round=22 metric=0.9901 head_norm=1.279105 delta_norm=0.330521
[S9] aggregate: ACCEPT kept=['S5', 'S10'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=22 metric=0.9785 head_norm=1.133774
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.012741e-01
[S14] stored merged vector for next round verification (round=22)
[S14] DEBUG after merge:  round=22 metric=0.9935 head_norm=1.284540 delta_norm=0.401274
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=22 metric=0.7632 head_norm=1.030412
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.018849e-01
[S15] stored merged vector for next round verification (round=22)
[S15] DEBUG after merge:  round=22 metric=0.7375 head_norm=0.906536 delta_norm=0.501885
[S15] aggregate: ROLLBACK (f1_val pre=0.763 post=0.737 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=22 metric=0.7003 head_norm=1.057850
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.222813e-01
[S5] stored merged vector for next round verification (round=22)
[S5] DEBUG after merge:  round=22 metric=0.7003 head_norm=1.051893 delta_norm=0.122281
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=22 metric=0.9511 head_norm=1.060101
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.137825e-01
[S4] stored merged vector for next round verification (round=22)
[S4] DEBUG after merge:  round=22 metric=0.9510 head_norm=0.971398 delta_norm=0.413783
[S4] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.824574 (no previous merge yet)
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.7009533202285976, 'auprc': 0.7021547147830847, 'loss_val': 0.2799908959684539, 'psi': 0.7014338780503924}-{'f1_val': 0.7011259080402672, 'auprc': 0.785317605651358, 'loss_val': 0.2856331594254371, 'psi': 0.7348025870847035}
[S3] START round=23 head_norm_before_train=1.799213 (no previous merge yet)
[S3] round=23 local utility u=0.054542 metrics={'f1_val': 0.9757868210428489, 'auprc': 0.9986885606049761, 'loss_val': 0.06736263714130145, 'psi': 0.9849475168676998}-{'f1_val': 0.9614594427737211, 'auprc': 0.9985069871274532, 'loss_val': 0.08993851643946289, 'psi': 0.9762784605152139}
[S4] START round=23 head_norm_before_train=0.971398 cos_to_last_merge=1.0000 (last merge round=22)
[S4] round=23 local utility u=0.000000 metrics={'f1_val': 0.9455515802161673, 'auprc': 0.9311916578755322, 'loss_val': 0.4242451259670557, 'psi': 0.9398076112799132}-{'f1_val': 0.9511437434682775, 'auprc': 0.9594996238320042, 'loss_val': 0.3488839678598197, 'psi': 0.9544860956137681}
[S5] START round=23 head_norm_before_train=1.051893 cos_to_last_merge=1.0000 (last merge round=22)
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.5807459969370969, 'auprc': 0.8510603674865912, 'loss_val': 0.6038885661190161, 'psi': 0.6888717451568946}-{'f1_val': 0.700320598491359, 'auprc': 0.9596730896590734, 'loss_val': 0.4213172204475902, 'psi': 0.8040615949584448}
[S6] START round=23 head_norm_before_train=1.690978 (no previous merge yet)
[S6] round=23 local utility u=1.000000 metrics={'f1_val': 0.8026215882317607, 'auprc': 0.9464857348095516, 'loss_val': 0.34240511339461627, 'psi': 0.860167246862877}-{'f1_val': 0.5152460674028336, 'auprc': 0.7497714028722293, 'loss_val': 0.8291454757584313, 'psi': 0.6090562015905919}
[S7] START round=23 head_norm_before_train=1.254649 cos_to_last_merge=0.8037 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.804
[S7] round=23 local utility u=1.000000 metrics={'f1_val': 0.6002514969049637, 'auprc': 0.806909070911684, 'loss_val': 0.6520505571747242, 'psi': 0.6829145265076518}-{'f1_val': 0.38858533214521507, 'auprc': 0.6729248726939315, 'loss_val': 1.1602043955911299, 'psi': 0.5023211483647017}
[S8] START round=23 head_norm_before_train=1.051591 cos_to_last_merge=0.9989 (last merge round=21)
[S8] round=23 local utility u=0.036446 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9926931672433355, 'loss_val': 0.23062814253227995, 'psi': 0.9948891118587089}-{'f1_val': 0.9960662206126181, 'auprc': 0.9920338585471268, 'loss_val': 0.2998218245813637, 'psi': 0.9944532757864215}
[S9] START round=23 head_norm_before_train=1.279105 cos_to_last_merge=1.0000 (last merge round=22)
[S9] round=23 local utility u=0.006685 metrics={'f1_val': 0.9963665676526772, 'auprc': 0.9973296296610663, 'loss_val': 0.14853215699348946, 'psi': 0.9967517924560327}-{'f1_val': 0.9905305596763693, 'auprc': 0.9994880784071547, 'loss_val': 0.13336171869440644, 'psi': 0.9941135671686834}
[S10] START round=23 head_norm_before_train=1.796325 (no previous merge yet)
[S10] round=23 local utility u=0.000000 metrics={'f1_val': 0.9943563983784213, 'auprc': 0.9926984028851609, 'loss_val': 0.04469825420093799, 'psi': 0.9936932001811172}-{'f1_val': 0.9947486092193725, 'auprc': 0.9953250238110098, 'loss_val': 0.048596185377582805, 'psi': 0.9949791750560275}
[S11] START round=23 head_norm_before_train=1.929586 (no previous merge yet)
[S11] round=23 local utility u=0.003754 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9980925537663523, 'loss_val': 0.04076879928935423, 'psi': 0.9969172264545265}-{'f1_val': 0.9958246664506369, 'auprc': 0.9982068619598944, 'loss_val': 0.04676591978034152, 'psi': 0.9967775446543399}
[S13] START round=23 head_norm_before_train=1.667683 (no previous merge yet)
[S13] round=23 local utility u=0.000000 metrics={'f1_val': 0.6206171285581911, 'auprc': 0.6667913940082519, 'loss_val': 0.7178663380341521, 'psi': 0.6390868347382154}-{'f1_val': 0.621209242327019, 'auprc': 0.6730715391230473, 'loss_val': 0.6766898601074472, 'psi': 0.6419541610454302}
[S14] START round=23 head_norm_before_train=1.284540 cos_to_last_merge=1.0000 (last merge round=22)
[S14] round=23 local utility u=0.038240 metrics={'f1_val': 0.9965284530806588, 'auprc': 0.9985054832355085, 'loss_val': 0.3405229698660299, 'psi': 0.9973192651425986}-{'f1_val': 0.9785031882703672, 'auprc': 0.9985961886684397, 'loss_val': 0.30912258096077216, 'psi': 0.9865403884295961}
[S15] START round=23 head_norm_before_train=0.906536 cos_to_last_merge=1.0000 (last merge round=22)
[S15] round=23 local utility u=0.104483 metrics={'f1_val': 0.7870752047238934, 'auprc': 0.9914923656068747, 'loss_val': 0.3179819776673744, 'psi': 0.8688420690770859}-{'f1_val': 0.7632327957945004, 'auprc': 0.9876010352496557, 'loss_val': 0.37221912117070133, 'psi': 0.8529800915765625}
[S16] START round=23 head_norm_before_train=1.041943 cos_to_last_merge=0.9987 (last merge round=21)
[S16] round=23 local utility u=0.058186 metrics={'f1_val': 0.9924158773336315, 'auprc': 0.9972958228868072, 'loss_val': 0.17929170939507652, 'psi': 0.9943678555549018}-{'f1_val': 0.9854329600470325, 'auprc': 0.9979435210899155, 'loss_val': 0.25570977678107537, 'psi': 0.9904371844641857}
[S17] START round=23 head_norm_before_train=1.335450 cos_to_last_merge=0.8203 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.820
[S17] round=23 local utility u=0.000000 metrics={'f1_val': 0.4764063246212227, 'auprc': 0.9249068656275234, 'loss_val': 0.5348893178937146, 'psi': 0.655806541023743}-{'f1_val': 0.5474268850225475, 'auprc': 0.8319547013627949, 'loss_val': 0.5543108346726355, 'psi': 0.6612380115586465}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:44616
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:44604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:44614
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:44604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:44616
[S11] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1804 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1798) from S11
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.950804)
[S16] loaded HEAD from S11 (vec_in norm=1.950804)
[S16] cosine check vs S11: cos=-0.0604
[S16] DROPPED delta from S11 (cos=-0.0604 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1803) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.700408)
[S4] loaded HEAD from S6 (vec_in norm=1.700408)
[S4] cosine check vs S6: cos=0.5174
[S4] BUFFERED delta from S6 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1798) from S8
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.094453)
[S4] loaded HEAD from S8 (vec_in norm=1.094453)
[S4] cosine check vs S8: cos=0.9036
[S4] BUFFERED delta from S8 (total buffered=2)
[S14] RECEIVED delta(kind=head bytes=1804) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.313302)
[S14] loaded HEAD from S9 (vec_in norm=1.313302)
[S14] cosine check vs S9: cos=0.9839
[S14] BUFFERED delta from S9 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1800) from S3
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.820050)
[S14] loaded HEAD from S3 (vec_in norm=1.820050)
[S14] cosine check vs S3: cos=0.2047
[S14] BUFFERED delta from S3 (total buffered=2)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:44615
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1803) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.306403)
[S15] loaded HEAD from S14 (vec_in norm=1.306403)
[S15] cosine check vs S14: cos=0.3669
[S15] BUFFERED delta from S14 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S15] → sending delta(kind=head bytes=1790) to S8@127.0.0.1:44609
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] → sending delta(kind=head bytes=1792) to S15@127.0.0.1:44615
[S15] sending update (kind=head size=1790 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1790) from S15
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.959902)
[S8] loaded HEAD from S15 (vec_in norm=0.959902)
[S8] cosine check vs S15: cos=0.9617
[S8] BUFFERED delta from S15 (total buffered=1)
[S16] sending update (kind=head size=1792 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1792) from S16
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.089521)
[S15] loaded HEAD from S16 (vec_in norm=1.089521)
[S15] cosine check vs S16: cos=0.8762
[S15] BUFFERED delta from S16 (total buffered=2)
[S16] RECEIVED delta(kind=head bytes=1802) from S7
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.260242)
[S16] loaded HEAD from S7 (vec_in norm=1.260242)
[S16] cosine check vs S7: cos=0.5411
[S16] BUFFERED delta from S7 (total buffered=1)
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=23 metric=0.9456 head_norm=1.009241
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.608290e-01
[S4] stored merged vector for next round verification (round=23)
[S4] DEBUG after merge:  round=23 metric=0.9446 head_norm=1.005499 delta_norm=0.260829
[S4] aggregate: ACCEPT kept=['S6', 'S8'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=23 metric=0.9964 head_norm=1.094453
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.569358e-01
[S8] stored merged vector for next round verification (round=23)
[S8] DEBUG after merge:  round=23 metric=0.9964 head_norm=1.017345 delta_norm=0.156936
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=23 metric=0.9924 head_norm=1.089521
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.677649e-01
[S16] stored merged vector for next round verification (round=23)
[S16] DEBUG after merge:  round=23 metric=0.9923 head_norm=1.032122 delta_norm=0.567765
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=23 metric=0.7871 head_norm=0.959902
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.724804e-01
[S15] stored merged vector for next round verification (round=23)
[S15] DEBUG after merge:  round=23 metric=0.8026 head_norm=0.873190 delta_norm=0.272480
[S15] aggregate: ACCEPT kept=['S14', 'S16'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=23 metric=0.9965 head_norm=1.306403
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.661849e-01
[S14] stored merged vector for next round verification (round=23)
[S14] DEBUG after merge:  round=23 metric=0.9965 head_norm=1.142213 delta_norm=0.466185
[S14] aggregate: ACCEPT kept=['S9', 'S3'] (k=2/2) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.830915 (no previous merge yet)
[S2] round=24 local utility u=0.000000 metrics={'f1_val': 0.7012120585667497, 'auprc': 0.6855338028600549, 'loss_val': 0.2850473797201145, 'psi': 0.6949407562840718}-{'f1_val': 0.7009533202285976, 'auprc': 0.7021547147830847, 'loss_val': 0.2799908959684539, 'psi': 0.7014338780503924}
[S3] START round=24 head_norm_before_train=1.820050 (no previous merge yet)
[S3] round=24 local utility u=0.000000 metrics={'f1_val': 0.960995754132836, 'auprc': 0.9985027792613097, 'loss_val': 0.09622413466068082, 'psi': 0.9759985641842255}-{'f1_val': 0.9757868210428489, 'auprc': 0.9986885606049761, 'loss_val': 0.06736263714130145, 'psi': 0.9849475168676998}
[S4] START round=24 head_norm_before_train=1.005499 cos_to_last_merge=1.0000 (last merge round=23)
[S4] round=24 local utility u=0.091863 metrics={'f1_val': 0.947481498071457, 'auprc': 0.9616121531852028, 'loss_val': 0.3433595398738088, 'psi': 0.9531337601169553}-{'f1_val': 0.9455515802161673, 'auprc': 0.9311916578755322, 'loss_val': 0.4242451259670557, 'psi': 0.9398076112799132}
[S5] START round=24 head_norm_before_train=1.097845 cos_to_last_merge=0.9977 (last merge round=22)
[S5] round=24 local utility u=0.684234 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9854575404670516, 'loss_val': 0.35605992661561114, 'psi': 0.8143753752816361}-{'f1_val': 0.5807459969370969, 'auprc': 0.8510603674865912, 'loss_val': 0.6038885661190161, 'psi': 0.6888717451568946}
[S6] START round=24 head_norm_before_train=1.700408 (no previous merge yet)
[S6] round=24 local utility u=0.000000 metrics={'f1_val': 0.8034083042554726, 'auprc': 0.9412592068854462, 'loss_val': 0.47623848582576617, 'psi': 0.8585486653074621}-{'f1_val': 0.8026215882317607, 'auprc': 0.9464857348095516, 'loss_val': 0.34240511339461627, 'psi': 0.860167246862877}
[S7] START round=24 head_norm_before_train=1.260242 cos_to_last_merge=0.8025 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.803
[S7] round=24 local utility u=0.000000 metrics={'f1_val': 0.5017921639511327, 'auprc': 0.7856264336975596, 'loss_val': 0.8613927345843623, 'psi': 0.6153258718497034}-{'f1_val': 0.6002514969049637, 'auprc': 0.806909070911684, 'loss_val': 0.6520505571747242, 'psi': 0.6829145265076518}
[S8] START round=24 head_norm_before_train=1.017345 cos_to_last_merge=1.0000 (last merge round=23)
[S8] round=24 local utility u=0.009769 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9950205097125521, 'loss_val': 0.21807306207833302, 'psi': 0.9958200488463955}-{'f1_val': 0.9963530749356245, 'auprc': 0.9926931672433355, 'loss_val': 0.23062814253227995, 'psi': 0.9948891118587089}
[S9] START round=24 head_norm_before_train=1.313302 cos_to_last_merge=0.9993 (last merge round=22)
[S9] round=24 local utility u=0.019381 metrics={'f1_val': 0.996808967411047, 'auprc': 0.9994775048020651, 'loss_val': 0.11886852632323665, 'psi': 0.9978763823674542}-{'f1_val': 0.9963665676526772, 'auprc': 0.9973296296610663, 'loss_val': 0.14853215699348946, 'psi': 0.9967517924560327}
[S10] START round=24 head_norm_before_train=1.817852 (no previous merge yet)
[S10] round=24 local utility u=0.007676 metrics={'f1_val': 0.9949085473053089, 'auprc': 0.9957103942026457, 'loss_val': 0.04169446853883841, 'psi': 0.9952292860642435}-{'f1_val': 0.9943563983784213, 'auprc': 0.9926984028851609, 'loss_val': 0.04469825420093799, 'psi': 0.9936932001811172}
[S11] START round=24 head_norm_before_train=1.950804 (no previous merge yet)
[S11] round=24 local utility u=0.003251 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9982728802402552, 'loss_val': 0.037288693812635304, 'psi': 0.9972373548042558}-{'f1_val': 0.9961336749133093, 'auprc': 0.9980925537663523, 'loss_val': 0.04076879928935423, 'psi': 0.9969172264545265}
[S13] START round=24 head_norm_before_train=1.680679 (no previous merge yet)
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.6091079528589292, 'auprc': 0.6573851572700486, 'loss_val': 0.6946583429823594, 'psi': 0.628418834623377}-{'f1_val': 0.6206171285581911, 'auprc': 0.6667913940082519, 'loss_val': 0.7178663380341521, 'psi': 0.6390868347382154}
[S14] START round=24 head_norm_before_train=1.142213 cos_to_last_merge=1.0000 (last merge round=23)
[S14] round=24 local utility u=0.042280 metrics={'f1_val': 0.9965515368176185, 'auprc': 0.9986555581087462, 'loss_val': 0.2565515370002219, 'psi': 0.9973931453340696}-{'f1_val': 0.9965284530806588, 'auprc': 0.9985054832355085, 'loss_val': 0.3405229698660299, 'psi': 0.9973192651425986}
[S15] START round=24 head_norm_before_train=0.873190 cos_to_last_merge=1.0000 (last merge round=23)
[S15] round=24 local utility u=0.117857 metrics={'f1_val': 0.828438343820117, 'auprc': 0.9887930642275675, 'loss_val': 0.3223485330448269, 'psi': 0.8925802319830973}-{'f1_val': 0.7870752047238934, 'auprc': 0.9914923656068747, 'loss_val': 0.3179819776673744, 'psi': 0.8688420690770859}
[S16] START round=24 head_norm_before_train=1.032122 cos_to_last_merge=1.0000 (last merge round=23)
[S16] round=24 local utility u=0.000000 metrics={'f1_val': 0.9922648414858459, 'auprc': 0.9936932211694077, 'loss_val': 0.23370529565906356, 'psi': 0.9928361933592706}-{'f1_val': 0.9924158773336315, 'auprc': 0.9972958228868072, 'loss_val': 0.17929170939507652, 'psi': 0.9943678555549018}
[S17] START round=24 head_norm_before_train=1.366573 cos_to_last_merge=0.8157 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.816
[S17] round=24 local utility u=0.042857 metrics={'f1_val': 0.4832798380048544, 'auprc': 0.9421218094998536, 'loss_val': 0.5420608981815822, 'psi': 0.6668166266028541}-{'f1_val': 0.4764063246212227, 'auprc': 0.9249068656275234, 'loss_val': 0.5348893178937146, 'psi': 0.655806541023743}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:44604
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:44610
[S5] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1801) from S8
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.064055)
[S4] loaded HEAD from S8 (vec_in norm=1.064055)
[S4] cosine check vs S8: cos=0.7662
[S4] BUFFERED delta from S8 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1797) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.140429)
[S9] loaded HEAD from S5 (vec_in norm=1.140429)
[S9] cosine check vs S5: cos=0.3576
[S9] BUFFERED delta from S5 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:44614
[S9] sending update (kind=head size=1801 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1801) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.352309)
[S14] loaded HEAD from S9 (vec_in norm=1.352309)
[S14] cosine check vs S9: cos=0.8669
[S14] BUFFERED delta from S9 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:44616
[S11] sending update (kind=head size=1798 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1798) from S11
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.972249)
[S16] loaded HEAD from S11 (vec_in norm=1.972249)
[S16] cosine check vs S11: cos=-0.0419
[S16] DROPPED delta from S11 (cos=-0.0419 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:44610
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:44609
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:44615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:44605
[S10] sending update (kind=head size=1798 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1798) from S10
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.838733)
[S9] loaded HEAD from S10 (vec_in norm=1.838733)
[S9] cosine check vs S10: cos=0.9449
[S9] BUFFERED delta from S10 (total buffered=2)
[S15] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1796) from S15
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.923728)
[S8] loaded HEAD from S15 (vec_in norm=0.923728)
[S8] cosine check vs S15: cos=0.9409
[S8] BUFFERED delta from S15 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1801) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.174283)
[S15] loaded HEAD from S14 (vec_in norm=1.174283)
[S15] cosine check vs S14: cos=0.6932
[S15] BUFFERED delta from S14 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:44616
[S17] sending update (kind=head size=1797 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1797) from S17
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.399050)
[S16] loaded HEAD from S17 (vec_in norm=1.399050)
[S16] cosine check vs S17: cos=0.4874
[S16] BUFFERED delta from S17 (total buffered=1)
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1801) from S4
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.057009)
[S5] loaded HEAD from S4 (vec_in norm=1.057009)
[S5] cosine check vs S4: cos=0.9757
[S5] BUFFERED delta from S4 (total buffered=1)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=24 metric=0.7003 head_norm=1.140429
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.280321e-01
[S5] stored merged vector for next round verification (round=24)
[S5] DEBUG after merge:  round=24 metric=0.7003 head_norm=1.092031 delta_norm=0.128032
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=24 metric=0.9964 head_norm=1.064055
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.843134e-01
[S8] stored merged vector for next round verification (round=24)
[S8] DEBUG after merge:  round=24 metric=0.9964 head_norm=0.979169 delta_norm=0.184313
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=24 metric=0.9968 head_norm=1.352309
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.983642e-01
[S9] stored merged vector for next round verification (round=24)
[S9] DEBUG after merge:  round=24 metric=0.9964 head_norm=1.220631 delta_norm=0.198364
[S9] aggregate: ACCEPT kept=['S5', 'S10'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=24 metric=0.9923 head_norm=1.076959
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.419467e-01
[S16] stored merged vector for next round verification (round=24)
[S16] DEBUG after merge:  round=24 metric=0.9924 head_norm=1.070745 delta_norm=0.641947
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=24 metric=0.9475 head_norm=1.057009
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.625894e-01
[S4] stored merged vector for next round verification (round=24)
[S4] DEBUG after merge:  round=24 metric=0.9475 head_norm=0.996629 delta_norm=0.362589
[S4] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=24 metric=0.9966 head_norm=1.174283
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.370479e-01
[S14] stored merged vector for next round verification (round=24)
[S14] DEBUG after merge:  round=24 metric=0.9974 head_norm=1.220754 delta_norm=0.337048
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=24 metric=0.8284 head_norm=0.923728
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.267316e-01
[S15] stored merged vector for next round verification (round=24)
[S15] DEBUG after merge:  round=24 metric=0.8761 head_norm=0.966441 delta_norm=0.426732
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.839672 (no previous merge yet)
[S2] round=25 local utility u=0.000000 metrics={'f1_val': 0.700410363496069, 'auprc': 0.6653066649155471, 'loss_val': 0.2758796211899605, 'psi': 0.6863688840638602}-{'f1_val': 0.7012120585667497, 'auprc': 0.6855338028600549, 'loss_val': 0.2850473797201145, 'psi': 0.6949407562840718}
[S3] START round=25 head_norm_before_train=1.838054 (no previous merge yet)
[S3] round=25 local utility u=0.139372 metrics={'f1_val': 0.9977814963782642, 'auprc': 0.9985431524560151, 'loss_val': 0.03831620125466255, 'psi': 0.9980861588093646}-{'f1_val': 0.960995754132836, 'auprc': 0.9985027792613097, 'loss_val': 0.09622413466068082, 'psi': 0.9759985641842255}
[S4] START round=25 head_norm_before_train=0.996629 cos_to_last_merge=1.0000 (last merge round=24)
[S4] round=25 local utility u=0.004855 metrics={'f1_val': 0.9465339429577126, 'auprc': 0.9812338931353786, 'loss_val': 0.3868303413117648, 'psi': 0.960413923028779}-{'f1_val': 0.947481498071457, 'auprc': 0.9616121531852028, 'loss_val': 0.3433595398738088, 'psi': 0.9531337601169553}
[S5] START round=25 head_norm_before_train=1.092031 cos_to_last_merge=1.0000 (last merge round=24)
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.7000725525005456, 'auprc': 0.8728353080457945, 'loss_val': 0.38128999178287526, 'psi': 0.7691776547186451}-{'f1_val': 0.700320598491359, 'auprc': 0.9854575404670516, 'loss_val': 0.35605992661561114, 'psi': 0.8143753752816361}
[S6] START round=25 head_norm_before_train=1.715648 (no previous merge yet)
[S6] round=25 local utility u=0.619078 metrics={'f1_val': 0.940835003745054, 'auprc': 0.9817997377967808, 'loss_val': 0.18426451297335764, 'psi': 0.9572208973657447}-{'f1_val': 0.8034083042554726, 'auprc': 0.9412592068854462, 'loss_val': 0.47623848582576617, 'psi': 0.8585486653074621}
[S7] START round=25 head_norm_before_train=1.269750 cos_to_last_merge=0.8009 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.801
[S7] round=25 local utility u=0.523361 metrics={'f1_val': 0.6169115847238085, 'auprc': 0.8145382851593701, 'loss_val': 0.5921219349800904, 'psi': 0.6959622648980331}-{'f1_val': 0.5017921639511327, 'auprc': 0.7856264336975596, 'loss_val': 0.8613927345843623, 'psi': 0.6153258718497034}
[S8] START round=25 head_norm_before_train=0.979169 cos_to_last_merge=1.0000 (last merge round=24)
[S8] round=25 local utility u=0.000000 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9975623688287323, 'loss_val': 0.2359957485306455, 'psi': 0.9967468095715846}-{'f1_val': 0.9963530749356245, 'auprc': 0.9950205097125521, 'loss_val': 0.21807306207833302, 'psi': 0.9958200488463955}
[S9] START round=25 head_norm_before_train=1.220631 cos_to_last_merge=1.0000 (last merge round=24)
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.9909524020220997, 'auprc': 0.9983989081141302, 'loss_val': 0.14581088322035182, 'psi': 0.9939310044589119}-{'f1_val': 0.996808967411047, 'auprc': 0.9994775048020651, 'loss_val': 0.11886852632323665, 'psi': 0.9978763823674542}
[S10] START round=25 head_norm_before_train=1.838733 (no previous merge yet)
[S10] round=25 local utility u=0.001844 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9953975715339045, 'loss_val': 0.03874438097361871, 'psi': 0.9952717320251867}-{'f1_val': 0.9949085473053089, 'auprc': 0.9957103942026457, 'loss_val': 0.04169446853883841, 'psi': 0.9952292860642435}
[S11] START round=25 head_norm_before_train=1.972249 (no previous merge yet)
[S11] round=25 local utility u=0.002120 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9981651994057065, 'loss_val': 0.03272584398000408, 'psi': 0.9971942824704363}-{'f1_val': 0.9965470045135896, 'auprc': 0.9982728802402552, 'loss_val': 0.037288693812635304, 'psi': 0.9972373548042558}
[S13] START round=25 head_norm_before_train=1.689380 (no previous merge yet)
[S13] round=25 local utility u=0.000000 metrics={'f1_val': 0.6027654226028758, 'auprc': 0.6649143934754249, 'loss_val': 0.726707927466975, 'psi': 0.6276250109518955}-{'f1_val': 0.6091079528589292, 'auprc': 0.6573851572700486, 'loss_val': 0.6946583429823594, 'psi': 0.628418834623377}
[S14] START round=25 head_norm_before_train=1.220754 cos_to_last_merge=1.0000 (last merge round=24)
[S14] round=25 local utility u=0.000000 metrics={'f1_val': 0.9771133018214408, 'auprc': 0.9986711870887908, 'loss_val': 0.2714306117744181, 'psi': 0.9857364559283808}-{'f1_val': 0.9965515368176185, 'auprc': 0.9986555581087462, 'loss_val': 0.2565515370002219, 'psi': 0.9973931453340696}
[S15] START round=25 head_norm_before_train=0.966441 cos_to_last_merge=1.0000 (last merge round=24)
[S15] round=25 local utility u=0.519168 metrics={'f1_val': 0.9931751715001954, 'auprc': 0.9911865135790283, 'loss_val': 0.2796143543870293, 'psi': 0.9923797083317285}-{'f1_val': 0.828438343820117, 'auprc': 0.9887930642275675, 'loss_val': 0.3223485330448269, 'psi': 0.8925802319830973}
[S16] START round=25 head_norm_before_train=1.070745 cos_to_last_merge=1.0000 (last merge round=24)
[S16] round=25 local utility u=0.041248 metrics={'f1_val': 0.9924110498129963, 'auprc': 0.997933594805387, 'loss_val': 0.164807950886836, 'psi': 0.9946200678099526}-{'f1_val': 0.9922648414858459, 'auprc': 0.9936932211694077, 'loss_val': 0.23370529565906356, 'psi': 0.9928361933592706}
[S17] START round=25 head_norm_before_train=1.399050 cos_to_last_merge=0.8103 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.810
[S17] round=25 local utility u=0.708577 metrics={'f1_val': 0.6953721241319546, 'auprc': 0.9618416067624519, 'loss_val': 0.4566194408836198, 'psi': 0.8019599171841535}-{'f1_val': 0.4832798380048544, 'auprc': 0.9421218094998536, 'loss_val': 0.5420608981815822, 'psi': 0.6668166266028541}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:44604
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:44614
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:44605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:44610
[S4] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1794 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1803) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.730499)
[S4] loaded HEAD from S6 (vec_in norm=1.730499)
[S4] cosine check vs S6: cos=0.4758
[S4] BUFFERED delta from S6 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1803) from S3
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.860339)
[S14] loaded HEAD from S3 (vec_in norm=1.860339)
[S14] cosine check vs S3: cos=0.3128
[S14] BUFFERED delta from S3 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1802) from S4
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.036323)
[S5] loaded HEAD from S4 (vec_in norm=1.036323)
[S5] cosine check vs S4: cos=0.9259
[S5] BUFFERED delta from S4 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1794) from S10
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.857799)
[S9] loaded HEAD from S10 (vec_in norm=1.857799)
[S9] cosine check vs S10: cos=0.9098
[S9] BUFFERED delta from S10 (total buffered=1)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:44616
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1797 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1797) from S11
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.992714)
[S16] loaded HEAD from S11 (vec_in norm=1.992714)
[S16] cosine check vs S11: cos=-0.0672
[S16] DROPPED delta from S11 (cos=-0.0672 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:44615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:44609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:44616
[S7] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S7
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.282102)
[S16] loaded HEAD from S7 (vec_in norm=1.282102)
[S16] cosine check vs S7: cos=0.4765
[S16] BUFFERED delta from S7 (total buffered=1)
[S16] sending update (kind=head size=1793 to 1 peers)
[S15] sending update (kind=head size=1805 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1793) from S16
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.121210)
[S15] loaded HEAD from S16 (vec_in norm=1.121210)
[S15] cosine check vs S16: cos=0.4875
[S15] BUFFERED delta from S16 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1805) from S15
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.016656)
[S8] loaded HEAD from S15 (vec_in norm=1.016656)
[S8] cosine check vs S15: cos=0.8631
[S8] BUFFERED delta from S15 (total buffered=1)
[S17] sending update (kind=head size=1798 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1798) from S17
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.433814)
[S16] loaded HEAD from S17 (vec_in norm=1.433814)
[S16] cosine check vs S17: cos=0.8894
[S16] BUFFERED delta from S17 (total buffered=2)
[S2] ⇄ pheromone p=0.024 → S16@127.0.0.1:44616
[S6] ⇄ pheromone p=0.351 → S4@127.0.0.1:44604
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=25 metric=0.9465 head_norm=1.036323
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.684698e-01
[S4] stored merged vector for next round verification (round=25)
[S4] DEBUG after merge:  round=25 metric=0.9450 head_norm=1.201561 delta_norm=0.768470
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.084 → S5@127.0.0.1:44605
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=25 metric=0.9910 head_norm=1.261826
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.410820e-01
[S9] stored merged vector for next round verification (round=25)
[S9] DEBUG after merge:  round=25 metric=0.9905 head_norm=1.525535 delta_norm=0.441082
[S9] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.070 → S14@127.0.0.1:44614
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=25 metric=0.7001 head_norm=1.134590
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.144410e-01
[S5] stored merged vector for next round verification (round=25)
[S5] DEBUG after merge:  round=25 metric=0.7001 head_norm=1.065197 delta_norm=0.214441
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.206 → S9@127.0.0.1:44610
[S7] ⇄ pheromone p=0.398 → S16@127.0.0.1:44616
[S13] ⇄ pheromone p=0.018 → S14@127.0.0.1:44614
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=25 metric=0.9962 head_norm=1.029366
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.677590e-01
[S8] stored merged vector for next round verification (round=25)
[S8] DEBUG after merge:  round=25 metric=0.9962 head_norm=0.987369 delta_norm=0.267759
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.146 → S4@127.0.0.1:44604
[S3] ⇄ pheromone p=0.139 → S14@127.0.0.1:44614
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=25 metric=0.9771 head_norm=1.257517
[S14] _apply_head_vector_avg (torch): Δ‖w‖=9.458582e-01
[S14] stored merged vector for next round verification (round=25)
[S14] DEBUG after merge:  round=25 metric=0.9571 head_norm=1.275326 delta_norm=0.945858
[S14] aggregate: ROLLBACK (f1_val pre=0.977 post=0.957 tol_abs=0.005 tol_rel=0.0)
[S14] ⇄ pheromone p=0.071 → S15@127.0.0.1:44615
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=25 metric=0.9924 head_norm=1.121210
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.695257e-01
[S16] stored merged vector for next round verification (round=25)
[S16] DEBUG after merge:  round=25 metric=0.9920 head_norm=1.042187 delta_norm=0.169526
[S16] aggregate: ACCEPT kept=['S7', 'S17'] (k=2/2) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.165 → S15@127.0.0.1:44615
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=25 metric=0.9932 head_norm=1.016656
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.430040e-01
[S15] stored merged vector for next round verification (round=25)
[S15] DEBUG after merge:  round=25 metric=0.9911 head_norm=0.922224 delta_norm=0.543004
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.256 → S8@127.0.0.1:44609
[S11] ⇄ pheromone p=0.033 → S16@127.0.0.1:44616
[S10] ⇄ pheromone p=0.033 → S9@127.0.0.1:44610
[S17] ⇄ pheromone p=0.224 → S16@127.0.0.1:44616
[S2] START round=26 head_norm_before_train=1.846965 (no previous merge yet)
[S2] round=26 local utility u=0.272329 metrics={'f1_val': 0.6952546490857723, 'auprc': 0.8600040071289767, 'loss_val': 0.2843800426520103, 'psi': 0.761154392303054}-{'f1_val': 0.700410363496069, 'auprc': 0.6653066649155471, 'loss_val': 0.2758796211899605, 'psi': 0.6863688840638602}
[S3] START round=26 head_norm_before_train=1.860339 (no previous merge yet)
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.9624238080555565, 'auprc': 0.9988625083104088, 'loss_val': 0.06902637986150703, 'psi': 0.9769992881574974}-{'f1_val': 0.9977814963782642, 'auprc': 0.9985431524560151, 'loss_val': 0.03831620125466255, 'psi': 0.9980861588093646}
[S4] START round=26 head_norm_before_train=1.201561 cos_to_last_merge=1.0000 (last merge round=25)
[S4] round=26 local utility u=0.026214 metrics={'f1_val': 0.9455885688149259, 'auprc': 0.9692659982353089, 'loss_val': 0.2928266140397674, 'psi': 0.9550595405830791}-{'f1_val': 0.9465339429577126, 'auprc': 0.9812338931353786, 'loss_val': 0.3868303413117648, 'psi': 0.960413923028779}
[S5] START round=26 head_norm_before_train=1.065197 cos_to_last_merge=1.0000 (last merge round=25)
[S5] round=26 local utility u=0.000000 metrics={'f1_val': 0.42189974600328706, 'auprc': 0.7986817631762095, 'loss_val': 0.9091762904074732, 'psi': 0.572612552872456}-{'f1_val': 0.7000725525005456, 'auprc': 0.8728353080457945, 'loss_val': 0.38128999178287526, 'psi': 0.7691776547186451}
[S6] START round=26 head_norm_before_train=1.730499 (no previous merge yet)
[S6] round=26 local utility u=0.000000 metrics={'f1_val': 0.7709579696335482, 'auprc': 0.9141535418707609, 'loss_val': 0.5151315453342797, 'psi': 0.8282361985284332}-{'f1_val': 0.940835003745054, 'auprc': 0.9817997377967808, 'loss_val': 0.18426451297335764, 'psi': 0.9572208973657447}
[S7] START round=26 head_norm_before_train=1.282102 cos_to_last_merge=0.7993 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.799
[S7] round=26 local utility u=0.000000 metrics={'f1_val': 0.39585138347521187, 'auprc': 0.7766196994145629, 'loss_val': 1.132965884297897, 'psi': 0.5481587098509523}-{'f1_val': 0.6169115847238085, 'auprc': 0.8145382851593701, 'loss_val': 0.5921219349800904, 'psi': 0.6959622648980331}
[S8] START round=26 head_norm_before_train=0.987369 cos_to_last_merge=1.0000 (last merge round=25)
[S8] round=26 local utility u=0.000000 metrics={'f1_val': 0.98783447454784, 'auprc': 0.9929810055407049, 'loss_val': 0.28032985632269447, 'psi': 0.989893086944986}-{'f1_val': 0.9962031034001528, 'auprc': 0.9975623688287323, 'loss_val': 0.2359957485306455, 'psi': 0.9967468095715846}
[S9] START round=26 head_norm_before_train=1.525535 cos_to_last_merge=1.0000 (last merge round=25)
[S9] round=26 local utility u=0.040475 metrics={'f1_val': 0.9963665676526772, 'auprc': 0.9957223126119104, 'loss_val': 0.08931660394921308, 'psi': 0.9961088656363704}-{'f1_val': 0.9909524020220997, 'auprc': 0.9983989081141302, 'loss_val': 0.14581088322035182, 'psi': 0.9939310044589119}
[S10] START round=26 head_norm_before_train=1.857799 (no previous merge yet)
[S10] round=26 local utility u=0.000615 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9956111970903843, 'loss_val': 0.03683666377671045, 'psi': 0.9952253907551993}-{'f1_val': 0.9951878390193748, 'auprc': 0.9953975715339045, 'loss_val': 0.03874438097361871, 'psi': 0.9952717320251867}
[S11] START round=26 head_norm_before_train=1.992714 (no previous merge yet)
[S11] round=26 local utility u=0.000584 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9982867069264577, 'loss_val': 0.03192218071791027, 'psi': 0.9972428854787369}-{'f1_val': 0.9965470045135896, 'auprc': 0.9981651994057065, 'loss_val': 0.03272584398000408, 'psi': 0.9971942824704363}
[S13] START round=26 head_norm_before_train=1.695965 (no previous merge yet)
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.6067442382812096, 'auprc': 0.6469204334175633, 'loss_val': 0.7165101574883478, 'psi': 0.6228147163357511}-{'f1_val': 0.6027654226028758, 'auprc': 0.6649143934754249, 'loss_val': 0.726707927466975, 'psi': 0.6276250109518955}
[S14] START round=26 head_norm_before_train=1.275326 cos_to_last_merge=1.0000 (last merge round=25)
[S14] round=26 local utility u=0.112623 metrics={'f1_val': 0.9963800105521481, 'auprc': 0.9987467484420648, 'loss_val': 0.16201186265581966, 'psi': 0.9973267057081148}-{'f1_val': 0.9771133018214408, 'auprc': 0.9986711870887908, 'loss_val': 0.2714306117744181, 'psi': 0.9857364559283808}
[S15] START round=26 head_norm_before_train=0.922224 cos_to_last_merge=1.0000 (last merge round=25)
[S15] round=26 local utility u=0.000000 metrics={'f1_val': 0.8765415603061529, 'auprc': 0.9930533492636675, 'loss_val': 0.26114284122482284, 'psi': 0.9231462758891588}-{'f1_val': 0.9931751715001954, 'auprc': 0.9911865135790283, 'loss_val': 0.2796143543870293, 'psi': 0.9923797083317285}
[S16] START round=26 head_norm_before_train=1.042187 cos_to_last_merge=1.0000 (last merge round=25)
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.8871717946771432, 'auprc': 0.9930315898185833, 'loss_val': 0.45693181361236307, 'psi': 0.9295157127337192}-{'f1_val': 0.9924110498129963, 'auprc': 0.997933594805387, 'loss_val': 0.164807950886836, 'psi': 0.9946200678099526}
[S17] START round=26 head_norm_before_train=1.433814 cos_to_last_merge=0.8055 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.806
[S17] round=26 local utility u=0.000000 metrics={'f1_val': 0.5770498232710345, 'auprc': 0.9513113881568629, 'loss_val': 0.5662918634372065, 'psi': 0.7267544492253659}-{'f1_val': 0.6953721241319546, 'auprc': 0.9618416067624519, 'loss_val': 0.4566194408836198, 'psi': 0.8019599171841535}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:44605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:44607
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S14] → sending delta(kind=head bytes=1806) to S3@127.0.0.1:44603
[S4] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1802) from S9
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.561009)
[S5] loaded HEAD from S9 (vec_in norm=1.561009)
[S5] cosine check vs S9: cos=0.2365
[S5] BUFFERED delta from S9 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1797) from S4
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.237955)
[S6] loaded HEAD from S4 (vec_in norm=1.237955)
[S6] cosine check vs S4: cos=0.9217
[S6] BUFFERED delta from S4 (total buffered=1)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1806 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1806) from S14
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.315758)
[S3] loaded HEAD from S14 (vec_in norm=1.315758)
[S3] cosine check vs S14: cos=0.8783
[S3] BUFFERED delta from S14 (total buffered=1)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=26 metric=0.9624 head_norm=1.883675
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.810697e-01
[S3] stored merged vector for next round verification (round=26)
[S3] DEBUG after merge:  round=26 metric=0.9629 head_norm=1.551869 delta_norm=0.481070
[S3] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=26 metric=0.7710 head_norm=1.742201
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.847754e-01
[S6] stored merged vector for next round verification (round=26)
[S6] DEBUG after merge:  round=26 metric=0.7682 head_norm=1.461453 delta_norm=0.384775
[S6] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=26 metric=0.4219 head_norm=1.102062
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.422623e-01
[S5] stored merged vector for next round verification (round=26)
[S5] DEBUG after merge:  round=26 metric=0.4247 head_norm=1.056522 delta_norm=0.842262
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.856077 (no previous merge yet)
[S2] round=27 local utility u=0.076185 metrics={'f1_val': 0.6807575191343646, 'auprc': 0.9536210710285122, 'loss_val': 0.32587782910661134, 'psi': 0.7899029398920236}-{'f1_val': 0.6952546490857723, 'auprc': 0.8600040071289767, 'loss_val': 0.2843800426520103, 'psi': 0.761154392303054}
[S3] START round=27 head_norm_before_train=1.551869 cos_to_last_merge=1.0000 (last merge round=26)
[S3] round=27 local utility u=0.060208 metrics={'f1_val': 0.9829707816095319, 'auprc': 0.9985297010142912, 'loss_val': 0.07089285962257287, 'psi': 0.9891943493714356}-{'f1_val': 0.9624238080555565, 'auprc': 0.9988625083104088, 'loss_val': 0.06902637986150703, 'psi': 0.9769992881574974}
[S4] START round=27 head_norm_before_train=1.237955 cos_to_last_merge=0.9991 (last merge round=25)
[S4] round=27 local utility u=0.000000 metrics={'f1_val': 0.9425559573830025, 'auprc': 0.9412030147486955, 'loss_val': 0.28748455007704954, 'psi': 0.9420147803292797}-{'f1_val': 0.9455885688149259, 'auprc': 0.9692659982353089, 'loss_val': 0.2928266140397674, 'psi': 0.9550595405830791}
[S5] START round=27 head_norm_before_train=1.056522 cos_to_last_merge=1.0000 (last merge round=26)
[S5] round=27 local utility u=1.000000 metrics={'f1_val': 0.6469705105680277, 'auprc': 0.9251009103253763, 'loss_val': 0.6088985535810694, 'psi': 0.7582226704709671}-{'f1_val': 0.42189974600328706, 'auprc': 0.7986817631762095, 'loss_val': 0.9091762904074732, 'psi': 0.572612552872456}
[S6] START round=27 head_norm_before_train=1.461453 cos_to_last_merge=1.0000 (last merge round=26)
[S6] round=27 local utility u=0.000000 metrics={'f1_val': 0.7399068982236725, 'auprc': 0.9501889522996243, 'loss_val': 0.47690393974717243, 'psi': 0.8240197198540532}-{'f1_val': 0.7709579696335482, 'auprc': 0.9141535418707609, 'loss_val': 0.5151315453342797, 'psi': 0.8282361985284332}
[S7] START round=27 head_norm_before_train=1.291121 cos_to_last_merge=0.7980 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.798
[S7] round=27 local utility u=1.000000 metrics={'f1_val': 0.6547139566018151, 'auprc': 0.8292345427705604, 'loss_val': 0.4917187641499482, 'psi': 0.7245221910693133}-{'f1_val': 0.39585138347521187, 'auprc': 0.7766196994145629, 'loss_val': 1.132965884297897, 'psi': 0.5481587098509523}
[S8] START round=27 head_norm_before_train=1.040000 cos_to_last_merge=0.9976 (last merge round=25)
[S8] round=27 local utility u=0.077215 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9975737551026065, 'loss_val': 0.1907895533204439, 'psi': 0.9968413470024173}-{'f1_val': 0.98783447454784, 'auprc': 0.9929810055407049, 'loss_val': 0.28032985632269447, 'psi': 0.989893086944986}
[S9] START round=27 head_norm_before_train=1.561009 cos_to_last_merge=0.9995 (last merge round=25)
[S9] round=27 local utility u=0.000000 metrics={'f1_val': 0.9888378245618925, 'auprc': 0.9952165523476094, 'loss_val': 0.09206199123012901, 'psi': 0.9913893156761793}-{'f1_val': 0.9963665676526772, 'auprc': 0.9957223126119104, 'loss_val': 0.08931660394921308, 'psi': 0.9961088656363704}
[S10] START round=27 head_norm_before_train=1.876207 (no previous merge yet)
[S10] round=27 local utility u=0.000982 metrics={'f1_val': 0.9949085473053089, 'auprc': 0.9957873617763828, 'loss_val': 0.0350439516808259, 'psi': 0.9952600730937384}-{'f1_val': 0.9949681865317428, 'auprc': 0.9956111970903843, 'loss_val': 0.03683666377671045, 'psi': 0.9952253907551993}
[S11] START round=27 head_norm_before_train=2.008221 (no previous merge yet)
[S11] round=27 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9983029901746092, 'loss_val': 0.031404644497734745, 'psi': 0.9970014010178293}-{'f1_val': 0.9965470045135896, 'auprc': 0.9982867069264577, 'loss_val': 0.03192218071791027, 'psi': 0.9972428854787369}
[S13] START round=27 head_norm_before_train=1.702145 (no previous merge yet)
[S13] round=27 local utility u=0.026294 metrics={'f1_val': 0.6071607812657983, 'auprc': 0.681588363128614, 'loss_val': 0.7704246112719041, 'psi': 0.6369318140109246}-{'f1_val': 0.6067442382812096, 'auprc': 0.6469204334175633, 'loss_val': 0.7165101574883478, 'psi': 0.6228147163357511}
[S14] START round=27 head_norm_before_train=1.315758 cos_to_last_merge=0.9990 (last merge round=25)
[S14] round=27 local utility u=0.017946 metrics={'f1_val': 0.9967805075071389, 'auprc': 0.9988079153926506, 'loss_val': 0.12870714860369623, 'psi': 0.9975914706613436}-{'f1_val': 0.9963800105521481, 'auprc': 0.9987467484420648, 'loss_val': 0.16201186265581966, 'psi': 0.9973267057081148}
[S15] START round=27 head_norm_before_train=0.983464 cos_to_last_merge=0.9973 (last merge round=25)
[S15] round=27 local utility u=0.380875 metrics={'f1_val': 0.986911452115074, 'auprc': 0.9911968399267084, 'loss_val': 0.1560432903811034, 'psi': 0.9886256072397278}-{'f1_val': 0.8765415603061529, 'auprc': 0.9930533492636675, 'loss_val': 0.26114284122482284, 'psi': 0.9231462758891588}
[S16] START round=27 head_norm_before_train=1.091975 cos_to_last_merge=0.9983 (last merge round=25)
[S16] round=27 local utility u=0.450138 metrics={'f1_val': 0.986027578701344, 'auprc': 0.9981080835415838, 'loss_val': 0.16501972924862357, 'psi': 0.99085978063744}-{'f1_val': 0.8871717946771432, 'auprc': 0.9930315898185833, 'loss_val': 0.45693181361236307, 'psi': 0.9295157127337192}
[S17] START round=27 head_norm_before_train=1.466675 cos_to_last_merge=0.8014 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.801
[S17] round=27 local utility u=0.000000 metrics={'f1_val': 0.6031775998376347, 'auprc': 0.7374719648294229, 'loss_val': 0.7436853403934645, 'psi': 0.65689534583435}-{'f1_val': 0.5770498232710345, 'auprc': 0.9513113881568629, 'loss_val': 0.5662918634372065, 'psi': 0.7267544492253659}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:44604
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:44615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:44603
[S14] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1801) from S5
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.082410)
[S4] loaded HEAD from S5 (vec_in norm=1.082410)
[S4] cosine check vs S5: cos=0.6242
[S4] BUFFERED delta from S5 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1797) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.090743)
[S15] loaded HEAD from S8 (vec_in norm=1.090743)
[S15] cosine check vs S8: cos=0.9389
[S15] BUFFERED delta from S8 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1798) from S14
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.353907)
[S3] loaded HEAD from S14 (vec_in norm=1.353907)
[S3] cosine check vs S14: cos=0.9517
[S3] BUFFERED delta from S14 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S15] → sending delta(kind=head bytes=1789) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:44608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1789 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1789) from S15
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.039973)
[S16] loaded HEAD from S15 (vec_in norm=1.039973)
[S16] cosine check vs S15: cos=0.8790
[S16] BUFFERED delta from S15 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1799) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.141693)
[S7] loaded HEAD from S16 (vec_in norm=1.141693)
[S7] cosine check vs S16: cos=0.5742
[S7] BUFFERED delta from S16 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=27 metric=0.6547 head_norm=1.300793
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.678951e-01
[S7] stored merged vector for next round verification (round=27)
[S7] DEBUG after merge:  round=27 metric=0.6561 head_norm=1.084093 delta_norm=0.567895
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=27 metric=0.9426 head_norm=1.268587
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.163770e-01
[S4] stored merged vector for next round verification (round=27)
[S4] DEBUG after merge:  round=27 metric=0.9453 head_norm=1.060102 delta_norm=0.516377
[S4] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=27 metric=0.9830 head_norm=1.575561
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.525622e-01
[S3] stored merged vector for next round verification (round=27)
[S3] DEBUG after merge:  round=27 metric=0.9830 head_norm=1.447045 delta_norm=0.252562
[S3] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=27 metric=0.9869 head_norm=1.039973
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.878964e-01
[S15] stored merged vector for next round verification (round=27)
[S15] DEBUG after merge:  round=27 metric=0.9899 head_norm=1.048965 delta_norm=0.187896
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=27 metric=0.9860 head_norm=1.141693
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.728237e-01
[S16] stored merged vector for next round verification (round=27)
[S16] DEBUG after merge:  round=27 metric=0.9898 head_norm=1.057389 delta_norm=0.272824
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=1.862242 (no previous merge yet)
[S2] round=28 local utility u=0.136247 metrics={'f1_val': 0.699425802216473, 'auprc': 0.9808902774975874, 'loss_val': 0.24720093431864862, 'psi': 0.8120115923289188}-{'f1_val': 0.6807575191343646, 'auprc': 0.9536210710285122, 'loss_val': 0.32587782910661134, 'psi': 0.7899029398920236}
[S3] START round=28 head_norm_before_train=1.447045 cos_to_last_merge=1.0000 (last merge round=27)
[S3] round=28 local utility u=0.045709 metrics={'f1_val': 0.9977814963782642, 'auprc': 0.9984876160073946, 'loss_val': 0.06821331400371791, 'psi': 0.9980639442299164}-{'f1_val': 0.9829707816095319, 'auprc': 0.9985297010142912, 'loss_val': 0.07089285962257287, 'psi': 0.9891943493714356}
[S4] START round=28 head_norm_before_train=1.060102 cos_to_last_merge=1.0000 (last merge round=27)
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.9406163789512147, 'auprc': 0.9223026881306641, 'loss_val': 0.3182453403691371, 'psi': 0.9332909026229945}-{'f1_val': 0.9425559573830025, 'auprc': 0.9412030147486955, 'loss_val': 0.28748455007704954, 'psi': 0.9420147803292797}
[S5] START round=28 head_norm_before_train=1.082410 cos_to_last_merge=0.9986 (last merge round=26)
[S5] round=28 local utility u=0.338421 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9888217962815691, 'loss_val': 0.44331982788890184, 'psi': 0.8157210776074431}-{'f1_val': 0.6469705105680277, 'auprc': 0.9251009103253763, 'loss_val': 0.6088985535810694, 'psi': 0.7582226704709671}
[S6] START round=28 head_norm_before_train=1.474211 cos_to_last_merge=0.9999 (last merge round=26)
[S6] round=28 local utility u=0.775923 metrics={'f1_val': 0.9424335864907023, 'auprc': 0.9717208588390301, 'loss_val': 0.20481300742673678, 'psi': 0.9541484954300334}-{'f1_val': 0.7399068982236725, 'auprc': 0.9501889522996243, 'loss_val': 0.47690393974717243, 'psi': 0.8240197198540532}
[S7] START round=28 head_norm_before_train=1.084093 cos_to_last_merge=1.0000 (last merge round=27)
[S7] round=28 local utility u=0.000000 metrics={'f1_val': 0.48679536287558944, 'auprc': 0.7830303773275067, 'loss_val': 0.8633369342701872, 'psi': 0.6052893686563563}-{'f1_val': 0.6547139566018151, 'auprc': 0.8292345427705604, 'loss_val': 0.4917187641499482, 'psi': 0.7245221910693133}
[S8] START round=28 head_norm_before_train=1.090743 cos_to_last_merge=0.9923 (last merge round=25)
[S8] round=28 local utility u=0.022335 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9980221678389222, 'loss_val': 0.14656570244085498, 'psi': 0.9969307291756606}-{'f1_val': 0.9963530749356245, 'auprc': 0.9975737551026065, 'loss_val': 0.1907895533204439, 'psi': 0.9968413470024173}
[S9] START round=28 head_norm_before_train=1.591038 cos_to_last_merge=0.9984 (last merge round=25)
[S9] round=28 local utility u=0.034088 metrics={'f1_val': 0.99595615083954, 'auprc': 0.9938136387403227, 'loss_val': 0.062387759739334095, 'psi': 0.995099145999853}-{'f1_val': 0.9888378245618925, 'auprc': 0.9952165523476094, 'loss_val': 0.09206199123012901, 'psi': 0.9913893156761793}
[S10] START round=28 head_norm_before_train=1.896135 (no previous merge yet)
[S10] round=28 local utility u=0.000000 metrics={'f1_val': 0.9947723700160056, 'auprc': 0.9913342781372699, 'loss_val': 0.034217426160060536, 'psi': 0.9933971332645113}-{'f1_val': 0.9949085473053089, 'auprc': 0.9957873617763828, 'loss_val': 0.0350439516808259, 'psi': 0.9952600730937384}
[S11] START round=28 head_norm_before_train=2.022088 (no previous merge yet)
[S11] round=28 local utility u=0.001141 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9983502916009724, 'loss_val': 0.029263893828645395, 'psi': 0.9970203215883746}-{'f1_val': 0.9961336749133093, 'auprc': 0.9983029901746092, 'loss_val': 0.031404644497734745, 'psi': 0.9970014010178293}
[S13] START round=28 head_norm_before_train=1.702316 (no previous merge yet)
[S13] round=28 local utility u=0.036643 metrics={'f1_val': 0.626865874942601, 'auprc': 0.6411926298535591, 'loss_val': 0.6941826494490478, 'psi': 0.6325965769069842}-{'f1_val': 0.6071607812657983, 'auprc': 0.681588363128614, 'loss_val': 0.7704246112719041, 'psi': 0.6369318140109246}
[S14] START round=28 head_norm_before_train=1.353907 cos_to_last_merge=0.9967 (last merge round=25)
[S14] round=28 local utility u=0.012120 metrics={'f1_val': 0.9967805075071389, 'auprc': 0.9988103838519975, 'loss_val': 0.1044740011393305, 'psi': 0.9975924580450823}-{'f1_val': 0.9967805075071389, 'auprc': 0.9988079153926506, 'loss_val': 0.12870714860369623, 'psi': 0.9975914706613436}
[S15] START round=28 head_norm_before_train=1.048965 cos_to_last_merge=1.0000 (last merge round=27)
[S15] round=28 local utility u=0.000000 metrics={'f1_val': 0.813650829084754, 'auprc': 0.9924216115301425, 'loss_val': 0.2877835063721125, 'psi': 0.8851591420629095}-{'f1_val': 0.986911452115074, 'auprc': 0.9911968399267084, 'loss_val': 0.1560432903811034, 'psi': 0.9886256072397278}
[S16] START round=28 head_norm_before_train=1.057389 cos_to_last_merge=1.0000 (last merge round=27)
[S16] round=28 local utility u=0.022017 metrics={'f1_val': 0.9914490695053817, 'auprc': 0.9948710163613983, 'loss_val': 0.14380318738193712, 'psi': 0.9928178482477883}-{'f1_val': 0.986027578701344, 'auprc': 0.9981080835415838, 'loss_val': 0.16501972924862357, 'psi': 0.99085978063744}
[S17] START round=28 head_norm_before_train=1.495513 cos_to_last_merge=0.7980 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.798
[S17] round=28 local utility u=1.000000 metrics={'f1_val': 0.8003280663660312, 'auprc': 0.9357216644118171, 'loss_val': 0.33916501362863755, 'psi': 0.8544855055843456}-{'f1_val': 0.6031775998376347, 'auprc': 0.7374719648294229, 'loss_val': 0.7436853403934645, 'psi': 0.65689534583435}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:44603
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S7@127.0.0.1:44608
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:44604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:44615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:44605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1802) from S5
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.110882)
[S4] loaded HEAD from S5 (vec_in norm=1.110882)
[S4] cosine check vs S5: cos=0.8859
[S4] BUFFERED delta from S5 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1796) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.139619)
[S15] loaded HEAD from S8 (vec_in norm=1.139619)
[S15] cosine check vs S8: cos=0.9801
[S15] BUFFERED delta from S8 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1798) from S14
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.391552)
[S3] loaded HEAD from S14 (vec_in norm=1.391552)
[S3] cosine check vs S14: cos=0.9812
[S3] BUFFERED delta from S14 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1798) from S9
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.616814)
[S5] loaded HEAD from S9 (vec_in norm=1.616814)
[S5] cosine check vs S9: cos=0.8357
[S5] BUFFERED delta from S9 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1794 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1794) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.103604)
[S7] loaded HEAD from S16 (vec_in norm=1.103604)
[S7] cosine check vs S16: cos=0.8579
[S7] BUFFERED delta from S16 (total buffered=1)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=28 metric=0.9978 head_norm=1.480283
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.460828e-01
[S3] stored merged vector for next round verification (round=28)
[S3] DEBUG after merge:  round=28 metric=0.9978 head_norm=1.429156 delta_norm=0.146083
[S3] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=28 metric=0.9406 head_norm=1.093703
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.633750e-01
[S4] stored merged vector for next round verification (round=28)
[S4] DEBUG after merge:  round=28 metric=0.9406 head_norm=1.070400 delta_norm=0.263375
[S4] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=28 metric=0.4868 head_norm=1.102072
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.939918e-01
[S7] stored merged vector for next round verification (round=28)
[S7] DEBUG after merge:  round=28 metric=0.4865 head_norm=1.062930 delta_norm=0.293992
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=28 metric=0.8137 head_norm=1.100489
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.132910e-01
[S15] stored merged vector for next round verification (round=28)
[S15] DEBUG after merge:  round=28 metric=0.8152 head_norm=1.114482 delta_norm=0.113291
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=28 metric=0.7003 head_norm=1.110882
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.599401e-01
[S5] stored merged vector for next round verification (round=28)
[S5] DEBUG after merge:  round=28 metric=0.7003 head_norm=1.308636 delta_norm=0.459940
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=1.869514 (no previous merge yet)
[S2] round=29 local utility u=0.000000 metrics={'f1_val': 0.7015650149407651, 'auprc': 0.7883368093431262, 'loss_val': 0.2806194084215024, 'psi': 0.7362737327017095}-{'f1_val': 0.699425802216473, 'auprc': 0.9808902774975874, 'loss_val': 0.24720093431864862, 'psi': 0.8120115923289188}
[S3] START round=29 head_norm_before_train=1.429156 cos_to_last_merge=1.0000 (last merge round=28)
[S3] round=29 local utility u=0.000000 metrics={'f1_val': 0.972709533161602, 'auprc': 0.998843046802041, 'loss_val': 0.10057650866954526, 'psi': 0.9831629386177776}-{'f1_val': 0.9977814963782642, 'auprc': 0.9984876160073946, 'loss_val': 0.06821331400371791, 'psi': 0.9980639442299164}
[S4] START round=29 head_norm_before_train=1.070400 cos_to_last_merge=1.0000 (last merge round=28)
[S4] round=29 local utility u=0.052576 metrics={'f1_val': 0.9460542457454326, 'auprc': 0.9452983723273104, 'loss_val': 0.31470788203561273, 'psi': 0.9457518963781837}-{'f1_val': 0.9406163789512147, 'auprc': 0.9223026881306641, 'loss_val': 0.3182453403691371, 'psi': 0.9332909026229945}
[S5] START round=29 head_norm_before_train=1.308636 cos_to_last_merge=1.0000 (last merge round=28)
[S5] round=29 local utility u=0.000000 metrics={'f1_val': 0.4213751165950829, 'auprc': 0.6505361535283167, 'loss_val': 1.0265545172822073, 'psi': 0.5130395313683764}-{'f1_val': 0.700320598491359, 'auprc': 0.9888217962815691, 'loss_val': 0.44331982788890184, 'psi': 0.8157210776074431}
[S6] START round=29 head_norm_before_train=1.489628 cos_to_last_merge=0.9998 (last merge round=26)
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.6210583285979204, 'auprc': 0.9258769355826695, 'loss_val': 0.7360296627171381, 'psi': 0.7429857713918201}-{'f1_val': 0.9424335864907023, 'auprc': 0.9717208588390301, 'loss_val': 0.20481300742673678, 'psi': 0.9541484954300334}
[S7] START round=29 head_norm_before_train=1.062930 cos_to_last_merge=1.0000 (last merge round=28)
[S7] round=29 local utility u=0.226769 metrics={'f1_val': 0.5536983987506108, 'auprc': 0.7853779293392822, 'loss_val': 0.8182593704209704, 'psi': 0.6463702109860794}-{'f1_val': 0.48679536287558944, 'auprc': 0.7830303773275067, 'loss_val': 0.8633369342701872, 'psi': 0.6052893686563563}
[S8] START round=29 head_norm_before_train=1.139619 cos_to_last_merge=0.9863 (last merge round=25)
[S8] round=29 local utility u=0.013820 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9983664943507045, 'loss_val': 0.11995962751550046, 'psi': 0.9970684597803735}-{'f1_val': 0.9962031034001528, 'auprc': 0.9980221678389222, 'loss_val': 0.14656570244085498, 'psi': 0.9969307291756606}
[S9] START round=29 head_norm_before_train=1.616814 cos_to_last_merge=0.9971 (last merge round=25)
[S9] round=29 local utility u=0.000000 metrics={'f1_val': 0.8979806591610825, 'auprc': 0.9902071717927612, 'loss_val': 0.22781262130636976, 'psi': 0.934871264213754}-{'f1_val': 0.99595615083954, 'auprc': 0.9938136387403227, 'loss_val': 0.062387759739334095, 'psi': 0.995099145999853}
[S10] START round=29 head_norm_before_train=1.914497 (no previous merge yet)
[S10] round=29 local utility u=0.008477 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9955938971793505, 'loss_val': 0.03253467667825338, 'psi': 0.995350262283365}-{'f1_val': 0.9947723700160056, 'auprc': 0.9913342781372699, 'loss_val': 0.034217426160060536, 'psi': 0.9933971332645113}
[S11] START round=29 head_norm_before_train=2.035939 (no previous merge yet)
[S11] round=29 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9982541928605304, 'loss_val': 0.07854850778692801, 'psi': 0.9969941619906594}-{'f1_val': 0.9961336749133093, 'auprc': 0.9983502916009724, 'loss_val': 0.029263893828645395, 'psi': 0.9970203215883746}
[S13] START round=29 head_norm_before_train=1.708751 (no previous merge yet)
[S13] round=29 local utility u=0.000000 metrics={'f1_val': 0.5966574846944025, 'auprc': 0.6870662598462329, 'loss_val': 0.8134855147668885, 'psi': 0.6328209947551346}-{'f1_val': 0.626865874942601, 'auprc': 0.6411926298535591, 'loss_val': 0.6941826494490478, 'psi': 0.6325965769069842}
[S14] START round=29 head_norm_before_train=1.391552 cos_to_last_merge=0.9939 (last merge round=25)
[S14] round=29 local utility u=0.008434 metrics={'f1_val': 0.9967774409524363, 'auprc': 0.9989709894417058, 'loss_val': 0.08806896905084947, 'psi': 0.9976548603481441}-{'f1_val': 0.9967805075071389, 'auprc': 0.9988103838519975, 'loss_val': 0.1044740011393305, 'psi': 0.9975924580450823}
[S15] START round=29 head_norm_before_train=1.114482 cos_to_last_merge=1.0000 (last merge round=28)
[S15] round=29 local utility u=0.271808 metrics={'f1_val': 0.8889292382814595, 'auprc': 0.992763440497861, 'loss_val': 0.19686267440976649, 'psi': 0.9304629191680202}-{'f1_val': 0.813650829084754, 'auprc': 0.9924216115301425, 'loss_val': 0.2877835063721125, 'psi': 0.8851591420629095}
[S16] START round=29 head_norm_before_train=1.103604 cos_to_last_merge=0.9991 (last merge round=27)
[S16] round=29 local utility u=0.000000 metrics={'f1_val': 0.9205054303229603, 'auprc': 0.9944777704661558, 'loss_val': 0.22047500517162846, 'psi': 0.9500943663802385}-{'f1_val': 0.9914490695053817, 'auprc': 0.9948710163613983, 'loss_val': 0.14380318738193712, 'psi': 0.9928178482477883}
[S17] START round=29 head_norm_before_train=1.521901 cos_to_last_merge=0.7951 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.795
[S17] round=29 local utility u=0.413512 metrics={'f1_val': 0.910461747518677, 'auprc': 0.9717054501617033, 'loss_val': 0.2808940175745787, 'psi': 0.9349592285758875}-{'f1_val': 0.8003280663660312, 'auprc': 0.9357216644118171, 'loss_val': 0.33916501362863755, 'psi': 0.8544855055843456}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:44607
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:44615
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:44603
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1793 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1793) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.186172)
[S15] loaded HEAD from S8 (vec_in norm=1.186172)
[S15] cosine check vs S8: cos=0.9911
[S15] BUFFERED delta from S8 (total buffered=1)
[S15] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1802) from S14
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.426973)
[S3] loaded HEAD from S14 (vec_in norm=1.426973)
[S3] cosine check vs S14: cos=0.9916
[S3] BUFFERED delta from S14 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1798) from S15
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.161207)
[S16] loaded HEAD from S15 (vec_in norm=1.161207)
[S16] cosine check vs S15: cos=0.8791
[S16] BUFFERED delta from S15 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1799) from S4
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.101172)
[S6] loaded HEAD from S4 (vec_in norm=1.101172)
[S6] cosine check vs S4: cos=0.7172
[S6] BUFFERED delta from S4 (total buffered=1)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=29 metric=0.6211 head_norm=1.508099
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.255856e-01
[S6] stored merged vector for next round verification (round=29)
[S6] DEBUG after merge:  round=29 metric=0.6204 head_norm=1.211293 delta_norm=0.525586
[S6] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=29 metric=0.9727 head_norm=1.462887
[S3] _apply_head_vector_avg (torch): Δ‖w‖=9.543428e-02
[S3] stored merged vector for next round verification (round=29)
[S3] DEBUG after merge:  round=29 metric=0.9727 head_norm=1.441887 delta_norm=0.095434
[S3] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=29 metric=0.9205 head_norm=1.146364
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.837912e-01
[S16] stored merged vector for next round verification (round=29)
[S16] DEBUG after merge:  round=29 metric=0.9067 head_norm=1.118365 delta_norm=0.283791
[S16] aggregate: ROLLBACK (f1_val pre=0.921 post=0.907 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=29 metric=0.8889 head_norm=1.161207
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.910239e-02
[S15] stored merged vector for next round verification (round=29)
[S15] DEBUG after merge:  round=29 metric=0.8889 head_norm=1.171087 delta_norm=0.079102
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S7
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S14]  timeout peer S2
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S16
[S8]  timeout peer S17
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S17
[S2] START round=30 head_norm_before_train=1.878003 (no previous merge yet)
[S2] round=30 local utility u=0.026650 metrics={'f1_val': 0.7044895533924764, 'auprc': 0.8135973030327797, 'loss_val': 0.320648357373353, 'psi': 0.7481326532485977}-{'f1_val': 0.7015650149407651, 'auprc': 0.7883368093431262, 'loss_val': 0.2806194084215024, 'psi': 0.7362737327017095}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] sending update (kind=head size=1794 to 1 peers)
[S3] START round=30 head_norm_before_train=1.441887 cos_to_last_merge=1.0000 (last merge round=29)
[S3] round=30 local utility u=0.090752 metrics={'f1_val': 0.9973696976584205, 'auprc': 0.9984662494599098, 'loss_val': 0.06590389146717929, 'psi': 0.9978083183790163}-{'f1_val': 0.972709533161602, 'auprc': 0.998843046802041, 'loss_val': 0.10057650866954526, 'psi': 0.9831629386177776}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=30 head_norm_before_train=1.101172 cos_to_last_merge=0.9994 (last merge round=28)
[S4] round=30 local utility u=0.000000 metrics={'f1_val': 0.9410534991587809, 'auprc': 0.9271734746907702, 'loss_val': 0.3158485501726293, 'psi': 0.9355014893715765}-{'f1_val': 0.9460542457454326, 'auprc': 0.9452983723273104, 'loss_val': 0.31470788203561273, 'psi': 0.9457518963781837}
[S5] START round=30 head_norm_before_train=1.326441 cos_to_last_merge=0.9991 (last merge round=28)
[S5] round=30 local utility u=1.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.982682034204482, 'loss_val': 0.4826191925520068, 'psi': 0.8132656041421411}-{'f1_val': 0.4213751165950829, 'auprc': 0.6505361535283167, 'loss_val': 1.0265545172822073, 'psi': 0.5130395313683764}
[S6] START round=30 head_norm_before_train=1.211293 cos_to_last_merge=1.0000 (last merge round=29)
[S6] round=30 local utility u=0.785619 metrics={'f1_val': 0.8102182976593337, 'auprc': 0.950648104635688, 'loss_val': 0.37406415964213247, 'psi': 0.8663902204498755}-{'f1_val': 0.6210583285979204, 'auprc': 0.9258769355826695, 'loss_val': 0.7360296627171381, 'psi': 0.7429857713918201}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=30 head_norm_before_train=1.086232 cos_to_last_merge=0.9994 (last merge round=28)
[S7] round=30 local utility u=0.655865 metrics={'f1_val': 0.6791833329513612, 'auprc': 0.8607549104812535, 'loss_val': 0.48556989903766856, 'psi': 0.7518119639633182}-{'f1_val': 0.5536983987506108, 'auprc': 0.7853779293392822, 'loss_val': 0.8182593704209704, 'psi': 0.6463702109860794}
[S7] not sending this round → trigger blocked (psi=0.752)
[S8] START round=30 head_norm_before_train=1.186172 cos_to_last_merge=0.9802 (last merge round=25)
[S8] round=30 local utility u=0.008311 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9988783526742109, 'loss_val': 0.10487410177374971, 'psi': 0.9972732031097761}-{'f1_val': 0.9962031034001528, 'auprc': 0.9983664943507045, 'loss_val': 0.11995962751550046, 'psi': 0.9970684597803735}
[S9] START round=30 head_norm_before_train=1.638935 cos_to_last_merge=0.9957 (last merge round=25)
[S9] round=30 local utility u=0.397219 metrics={'f1_val': 0.9959812240560731, 'auprc': 0.999595029992289, 'loss_val': 0.04954100507377548, 'psi': 0.9974267464305595}-{'f1_val': 0.8979806591610825, 'auprc': 0.9902071717927612, 'loss_val': 0.22781262130636976, 'psi': 0.934871264213754}
[S10] START round=30 head_norm_before_train=1.926381 (no previous merge yet)
[S10] round=30 local utility u=0.000587 metrics={'f1_val': 0.9948841898349063, 'auprc': 0.9964323929908765, 'loss_val': 0.03205471624543692, 'psi': 0.9955034710972943}-{'f1_val': 0.9951878390193748, 'auprc': 0.9955938971793505, 'loss_val': 0.03253467667825338, 'psi': 0.995350262283365}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=30 head_norm_before_train=2.047283 (no previous merge yet)
[S11] round=30 local utility u=0.024526 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9984649443523119, 'loss_val': 0.03000510004450689, 'psi': 0.9970661826889103}-{'f1_val': 0.9961541414107454, 'auprc': 0.9982541928605304, 'loss_val': 0.07854850778692801, 'psi': 0.9969941619906594}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=30 head_norm_before_train=1.716427 (no previous merge yet)
[S13] round=30 local utility u=0.207328 metrics={'f1_val': 0.6447170632108832, 'auprc': 0.6489374244598838, 'loss_val': 0.57279987593758, 'psi': 0.6464052077104834}-{'f1_val': 0.5966574846944025, 'auprc': 0.6870662598462329, 'loss_val': 0.8134855147668885, 'psi': 0.6328209947551346}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=30 head_norm_before_train=1.426973 cos_to_last_merge=0.9912 (last merge round=25)
[S14] round=30 local utility u=0.007400 metrics={'f1_val': 0.9980850197418996, 'auprc': 0.9990577409073677, 'loss_val': 0.0813753791869638, 'psi': 0.9984741082080868}-{'f1_val': 0.9967774409524363, 'auprc': 0.9989709894417058, 'loss_val': 0.08806896905084947, 'psi': 0.9976548603481441}
[S15] START round=30 head_norm_before_train=1.171087 cos_to_last_merge=1.0000 (last merge round=29)
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.8123528294170168, 'auprc': 0.9910446931393835, 'loss_val': 0.2762790288399795, 'psi': 0.8838295749059635}-{'f1_val': 0.8889292382814595, 'auprc': 0.992763440497861, 'loss_val': 0.19686267440976649, 'psi': 0.9304629191680202}
[S16] START round=30 head_norm_before_train=1.118365 cos_to_last_merge=1.0000 (last merge round=29)
[S16] round=30 local utility u=0.197988 metrics={'f1_val': 0.9773998181919785, 'auprc': 0.9944172174861585, 'loss_val': 0.16568431236372957, 'psi': 0.9842067779096506}-{'f1_val': 0.9205054303229603, 'auprc': 0.9944777704661558, 'loss_val': 0.22047500517162846, 'psi': 0.9500943663802385}
[S17] START round=30 head_norm_before_train=1.537931 cos_to_last_merge=0.7929 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.793
[S17] round=30 local utility u=0.000000 metrics={'f1_val': 0.6009520463767489, 'auprc': 0.8922189772111013, 'loss_val': 0.7751110934507223, 'psi': 0.7174588187104899}-{'f1_val': 0.910461747518677, 'auprc': 0.9717054501617033, 'loss_val': 0.2808940175745787, 'psi': 0.9349592285758875}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:44615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:44604
[S5] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] RECEIVED delta(kind=head bytes=1799) from S5
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.345297)
[S4] loaded HEAD from S5 (vec_in norm=1.345297)
[S4] cosine check vs S5: cos=0.8586
[S4] BUFFERED delta from S5 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1802) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.226289)
[S15] loaded HEAD from S8 (vec_in norm=1.226289)
[S15] cosine check vs S8: cos=0.9950
[S15] BUFFERED delta from S8 (total buffered=1)
[S8] ⇄ pheromone p=0.062 → S15@127.0.0.1:44615
[S5] ⇄ pheromone p=0.413 → S4@127.0.0.1:44604
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=30 metric=0.8124 head_norm=1.212840
[S15] _apply_head_vector_avg (torch): Δ‖w‖=6.129887e-02
[S15] stored merged vector for next round verification (round=30)
[S15] DEBUG after merge:  round=30 metric=0.8124 head_norm=1.218042 delta_norm=0.061299
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.166 → S16@127.0.0.1:44616
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=30 metric=0.9411 head_norm=1.132450
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.450522e-01
[S4] stored merged vector for next round verification (round=30)
[S4] DEBUG after merge:  round=30 metric=0.9417 head_norm=1.194601 delta_norm=0.345052
[S4] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.038 → S6@127.0.0.1:44607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:44605
[S9] sending update (kind=head size=1800 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1800) from S9
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.657115)
[S5] loaded HEAD from S9 (vec_in norm=1.657115)
[S5] cosine check vs S9: cos=0.9568
[S5] BUFFERED delta from S9 (total buffered=1)
[S14] RoundReady barrier timeout: have=1 need=2 — continuing
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:44603
[S16] RoundReady barrier timeout: have=1 need=3 — continuing
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:44608
[S14] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1800) from S14
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.457092)
[S3] loaded HEAD from S14 (vec_in norm=1.457092)
[S3] cosine check vs S14: cos=0.9954
[S3] BUFFERED delta from S14 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1801) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.157873)
[S7] loaded HEAD from S16 (vec_in norm=1.157873)
[S7] cosine check vs S16: cos=0.9233
[S7] BUFFERED delta from S16 (total buffered=1)
[S9] ⇄ pheromone p=0.110 → S5@127.0.0.1:44605
[S8]  timeout peer S15
[S5]  timeout peer S4
[S4]  timeout peer S6
[S4]  timeout peer S8
[S15]  timeout peer S14
[S15]  timeout peer S16
[S14]  timeout peer S3
[S14]  timeout peer S9
[S14]  timeout peer S13
[S16]  timeout peer S2
[S16]  timeout peer S7
[S16]  timeout peer S11
[S16]  timeout peer S17
[S9]  timeout peer S5
[S9]  timeout peer S10
[S2] START round=31 head_norm_before_train=1.889177 (no previous merge yet)
[S2] round=31 local utility u=0.000000 metrics={'f1_val': 0.7191489851723621, 'auprc': 0.7915069190853106, 'loss_val': 0.6173752332435722, 'psi': 0.7480921587375415}-{'f1_val': 0.7044895533924764, 'auprc': 0.8135973030327797, 'loss_val': 0.320648357373353, 'psi': 0.7481326532485977}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=31 head_norm_before_train=1.478001 cos_to_last_merge=0.9996 (last merge round=29)
[S3] round=31 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9981041960698556, 'loss_val': 0.12375182665123731, 'psi': 0.9758628290912084}-{'f1_val': 0.9973696976584205, 'auprc': 0.9984662494599098, 'loss_val': 0.06590389146717929, 'psi': 0.9978083183790163}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=31 metric=0.9610 head_norm=1.519401
[S3] _apply_head_vector_avg (torch): Δ‖w‖=9.346635e-02
[S3] stored merged vector for next round verification (round=31)
[S3] DEBUG after merge:  round=31 metric=0.9610 head_norm=1.485636 delta_norm=0.093466
[S3] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S4] START round=31 head_norm_before_train=1.194601 cos_to_last_merge=1.0000 (last merge round=30)
[S4] round=31 local utility u=0.050707 metrics={'f1_val': 0.9470485337735309, 'auprc': 0.9501213861141462, 'loss_val': 0.31924806488524465, 'psi': 0.948277674709777}-{'f1_val': 0.9410534991587809, 'auprc': 0.9271734746907702, 'loss_val': 0.3158485501726293, 'psi': 0.9355014893715765}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S4] sending update (kind=head size=1807 to 1 peers)
[S5] START round=31 head_norm_before_train=1.345297 cos_to_last_merge=0.9967 (last merge round=28)
[S5] round=31 local utility u=0.000000 metrics={'f1_val': 0.6932611872936022, 'auprc': 0.6879529448302921, 'loss_val': 0.5389131873288349, 'psi': 0.6911378903082782}-{'f1_val': 0.7003213174339138, 'auprc': 0.982682034204482, 'loss_val': 0.4826191925520068, 'psi': 0.8132656041421411}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=31 metric=0.6933 head_norm=1.372989
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.871484e-01
[S5] stored merged vector for next round verification (round=31)
[S5] DEBUG after merge:  round=31 metric=0.7004 head_norm=1.494359 delta_norm=0.287148
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S6] START round=31 head_norm_before_train=1.236677 cos_to_last_merge=0.9998 (last merge round=29)
[S6] round=31 local utility u=0.000000 metrics={'f1_val': 0.7511236483519335, 'auprc': 0.9204358222095952, 'loss_val': 0.5574934335322662, 'psi': 0.8188485178949982}-{'f1_val': 0.8102182976593337, 'auprc': 0.950648104635688, 'loss_val': 0.37406415964213247, 'psi': 0.8663902204498755}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=31 head_norm_before_train=1.123389 cos_to_last_merge=0.9962 (last merge round=28)
[S7] round=31 local utility u=0.000000 metrics={'f1_val': 0.6189748926820308, 'auprc': 0.8030943587579028, 'loss_val': 0.6429887607711727, 'psi': 0.6926226791123795}-{'f1_val': 0.6791833329513612, 'auprc': 0.8607549104812535, 'loss_val': 0.48556989903766856, 'psi': 0.7518119639633182}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=31 metric=0.6190 head_norm=1.155169
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.377695e-01
[S7] stored merged vector for next round verification (round=31)
[S7] DEBUG after merge:  round=31 metric=0.6077 head_norm=1.131816 delta_norm=0.237770
[S7] aggregate: ROLLBACK (f1_val pre=0.619 post=0.608 tol_abs=0.005 tol_rel=0.0)
[S8] START round=31 head_norm_before_train=1.226289 cos_to_last_merge=0.9749 (last merge round=25)
[S8] round=31 local utility u=0.000000 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.999090029933299, 'loss_val': 0.11107469160892508, 'psi': 0.9974478569346943}-{'f1_val': 0.9962031034001528, 'auprc': 0.9988783526742109, 'loss_val': 0.10487410177374971, 'psi': 0.9972732031097761}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=31 head_norm_before_train=1.657115 cos_to_last_merge=0.9947 (last merge round=25)
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.996398546385143, 'auprc': 0.9938223507290449, 'loss_val': 0.04653236017932015, 'psi': 0.9953680681227038}-{'f1_val': 0.9959812240560731, 'auprc': 0.999595029992289, 'loss_val': 0.04954100507377548, 'psi': 0.9974267464305595}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=31 head_norm_before_train=1.936964 (no previous merge yet)
[S10] round=31 local utility u=0.000000 metrics={'f1_val': 0.9947723700160056, 'auprc': 0.990883850108465, 'loss_val': 0.03251514554035524, 'psi': 0.9932169620529894}-{'f1_val': 0.9948841898349063, 'auprc': 0.9964323929908765, 'loss_val': 0.03205471624543692, 'psi': 0.9955034710972943}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=31 head_norm_before_train=2.059613 (no previous merge yet)
[S11] round=31 local utility u=0.003386 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9984410292499779, 'loss_val': 0.025642007657704604, 'psi': 0.9973046144081449}-{'f1_val': 0.9961336749133093, 'auprc': 0.9984649443523119, 'loss_val': 0.03000510004450689, 'psi': 0.9970661826889103}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S13] START round=31 head_norm_before_train=1.719687 (no previous merge yet)
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.5899331987710126, 'auprc': 0.6881478340541529, 'loss_val': 0.7835236163614222, 'psi': 0.6292190528842687}-{'f1_val': 0.6447170632108832, 'auprc': 0.6489374244598838, 'loss_val': 0.57279987593758, 'psi': 0.6464052077104834}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=31 head_norm_before_train=1.457092 cos_to_last_merge=0.9889 (last merge round=25)
[S14] round=31 local utility u=0.002811 metrics={'f1_val': 0.9974537796719909, 'auprc': 0.9990093896930152, 'loss_val': 0.07181998869188112, 'psi': 0.9980760236804006}-{'f1_val': 0.9980850197418996, 'auprc': 0.9990577409073677, 'loss_val': 0.0813753791869638, 'psi': 0.9984741082080868}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=31 head_norm_before_train=1.218042 cos_to_last_merge=1.0000 (last merge round=30)
[S15] round=31 local utility u=0.652720 metrics={'f1_val': 0.9963755136436562, 'auprc': 0.9914224601863306, 'loss_val': 0.07610777356219457, 'psi': 0.9943942922607261}-{'f1_val': 0.8123528294170168, 'auprc': 0.9910446931393835, 'loss_val': 0.2762790288399795, 'psi': 0.8838295749059635}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=31 head_norm_before_train=1.157873 cos_to_last_merge=0.9994 (last merge round=29)
[S16] round=31 local utility u=0.000000 metrics={'f1_val': 0.9412359656742246, 'auprc': 0.9975848963644526, 'loss_val': 0.21588774768513222, 'psi': 0.9637755379503158}-{'f1_val': 0.9773998181919785, 'auprc': 0.9944172174861585, 'loss_val': 0.16568431236372957, 'psi': 0.9842067779096506}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=31 head_norm_before_train=1.547863 cos_to_last_merge=0.7914 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.791
[S17] round=31 local utility u=0.423521 metrics={'f1_val': 0.6573854001291396, 'auprc': 0.9574847157723277, 'loss_val': 0.46246640171504994, 'psi': 0.7774251263864149}-{'f1_val': 0.6009520463767489, 'auprc': 0.8922189772111013, 'loss_val': 0.7751110934507223, 'psi': 0.7174588187104899}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=32 head_norm_before_train=1.899686 (no previous merge yet)
[S2] round=32 local utility u=1.000000 metrics={'f1_val': 0.9909747073650674, 'auprc': 0.985875927779914, 'loss_val': 0.1667960938737022, 'psi': 0.9889351955310061}-{'f1_val': 0.7191489851723621, 'auprc': 0.7915069190853106, 'loss_val': 0.6173752332435722, 'psi': 0.7480921587375415}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=32 head_norm_before_train=1.485636 cos_to_last_merge=1.0000 (last merge round=31)
[S3] round=32 local utility u=0.143648 metrics={'f1_val': 0.9973982357793907, 'auprc': 0.9987852319648498, 'loss_val': 0.0566758551015567, 'psi': 0.9979530342535744}-{'f1_val': 0.9610352511054436, 'auprc': 0.9981041960698556, 'loss_val': 0.12375182665123731, 'psi': 0.9758628290912084}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=32 head_norm_before_train=1.218826 cos_to_last_merge=0.9995 (last merge round=30)
[S4] round=32 local utility u=0.000000 metrics={'f1_val': 0.9433847346540136, 'auprc': 0.9456533148580372, 'loss_val': 0.3043220824992655, 'psi': 0.944292166735623}-{'f1_val': 0.9470485337735309, 'auprc': 0.9501213861141462, 'loss_val': 0.31924806488524465, 'psi': 0.948277674709777}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=32 head_norm_before_train=1.494359 cos_to_last_merge=1.0000 (last merge round=31)
[S5] round=32 local utility u=0.489417 metrics={'f1_val': 0.7003611031385764, 'auprc': 0.9812516512446868, 'loss_val': 0.4825743904793586, 'psi': 0.8127173223810206}-{'f1_val': 0.6932611872936022, 'auprc': 0.6879529448302921, 'loss_val': 0.5389131873288349, 'psi': 0.6911378903082782}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=32 head_norm_before_train=1.280848 cos_to_last_merge=0.9990 (last merge round=29)
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.693705445290213, 'auprc': 0.8635592882534346, 'loss_val': 0.6792362081575101, 'psi': 0.7616469824755017}-{'f1_val': 0.7511236483519335, 'auprc': 0.9204358222095952, 'loss_val': 0.5574934335322662, 'psi': 0.8188485178949982}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=32 head_norm_before_train=1.131816 cos_to_last_merge=1.0000 (last merge round=31)
[S7] round=32 local utility u=0.000000 metrics={'f1_val': 0.5262630518812216, 'auprc': 0.7781128692502108, 'loss_val': 0.8539570021659111, 'psi': 0.6270029788288174}-{'f1_val': 0.6189748926820308, 'auprc': 0.8030943587579028, 'loss_val': 0.6429887607711727, 'psi': 0.6926226791123795}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=32 head_norm_before_train=1.258721 cos_to_last_merge=0.9704 (last merge round=25)
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.7142391053978291, 'auprc': 0.9776021807987372, 'loss_val': 0.44230513832544677, 'psi': 0.8195843355581924}-{'f1_val': 0.9963530749356245, 'auprc': 0.999090029933299, 'loss_val': 0.11107469160892508, 'psi': 0.9974478569346943}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=32 head_norm_before_train=1.673535 cos_to_last_merge=0.9937 (last merge round=25)
[S9] round=32 local utility u=0.009298 metrics={'f1_val': 0.9959775008625639, 'auprc': 0.999602667996202, 'loss_val': 0.04275097618039301, 'psi': 0.9974275677160191}-{'f1_val': 0.996398546385143, 'auprc': 0.9938223507290449, 'loss_val': 0.04653236017932015, 'psi': 0.9953680681227038}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=32 head_norm_before_train=1.948264 (no previous merge yet)
[S10] round=32 local utility u=0.010122 metrics={'f1_val': 0.9953654828731612, 'auprc': 0.9957312868736692, 'loss_val': 0.030372121524381724, 'psi': 0.9955118044733644}-{'f1_val': 0.9947723700160056, 'auprc': 0.990883850108465, 'loss_val': 0.03251514554035524, 'psi': 0.9932169620529894}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=32 head_norm_before_train=2.071960 (no previous merge yet)
[S11] round=32 local utility u=0.000424 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9984424848731239, 'loss_val': 0.02479790516320177, 'psi': 0.9973051966574034}-{'f1_val': 0.9965470045135896, 'auprc': 0.9984410292499779, 'loss_val': 0.025642007657704604, 'psi': 0.9973046144081449}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] sending update (kind=head size=1792 to 1 peers)
[S13] START round=32 head_norm_before_train=1.722139 (no previous merge yet)
[S13] round=32 local utility u=0.016594 metrics={'f1_val': 0.5942761106553748, 'auprc': 0.6875903912608615, 'loss_val': 0.7747206361897653, 'psi': 0.6316018228975695}-{'f1_val': 0.5899331987710126, 'auprc': 0.6881478340541529, 'loss_val': 0.7835236163614222, 'psi': 0.6292190528842687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] sending update (kind=head size=1796 to 1 peers)
[S14] START round=32 head_norm_before_train=1.480522 cos_to_last_merge=0.9871 (last merge round=25)
[S14] round=32 local utility u=0.002485 metrics={'f1_val': 0.997211058727947, 'auprc': 0.9990745662848225, 'loss_val': 0.0655893701566198, 'psi': 0.9979564617506973}-{'f1_val': 0.9974537796719909, 'auprc': 0.9990093896930152, 'loss_val': 0.07181998869188112, 'psi': 0.9980760236804006}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] START round=32 head_norm_before_train=1.252170 cos_to_last_merge=0.9997 (last merge round=30)
[S15] round=32 local utility u=0.000000 metrics={'f1_val': 0.7180941799882314, 'auprc': 0.9895331635017177, 'loss_val': 0.3837924700683354, 'psi': 0.8266697733936259}-{'f1_val': 0.9963755136436562, 'auprc': 0.9914224601863306, 'loss_val': 0.07610777356219457, 'psi': 0.9943942922607261}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=32 head_norm_before_train=1.198717 cos_to_last_merge=0.9979 (last merge round=29)
[S16] round=32 local utility u=0.000000 metrics={'f1_val': 0.9400110735019539, 'auprc': 0.9974592541056244, 'loss_val': 0.2332851169017318, 'psi': 0.9629903457434221}-{'f1_val': 0.9412359656742246, 'auprc': 0.9975848963644526, 'loss_val': 0.21588774768513222, 'psi': 0.9637755379503158}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=32 head_norm_before_train=1.560206 cos_to_last_merge=0.7898 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.790
[S17] round=32 local utility u=0.000000 metrics={'f1_val': 0.589968820141954, 'auprc': 0.8110475950247917, 'loss_val': 0.872035319088304, 'psi': 0.6784003300950892}-{'f1_val': 0.6573854001291396, 'auprc': 0.9574847157723277, 'loss_val': 0.46246640171504994, 'psi': 0.7774251263864149}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=33 head_norm_before_train=1.911989 (no previous merge yet)
[S2] round=33 local utility u=0.000000 metrics={'f1_val': 0.8570535025596419, 'auprc': 0.9608793969146926, 'loss_val': 0.21507463636038493, 'psi': 0.8985838603016623}-{'f1_val': 0.9909747073650674, 'auprc': 0.985875927779914, 'loss_val': 0.1667960938737022, 'psi': 0.9889351955310061}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=33 head_norm_before_train=1.526172 cos_to_last_merge=0.9996 (last merge round=31)
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.9615385219550141, 'auprc': 0.9984196745997871, 'loss_val': 0.08587841835522358, 'psi': 0.9762909830129234}-{'f1_val': 0.9973982357793907, 'auprc': 0.9987852319648498, 'loss_val': 0.0566758551015567, 'psi': 0.9979530342535744}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=33 head_norm_before_train=1.244885 cos_to_last_merge=0.9979 (last merge round=30)
[S4] round=33 local utility u=0.034523 metrics={'f1_val': 0.9432810910641973, 'auprc': 0.9639373199164265, 'loss_val': 0.2895058497358946, 'psi': 0.9515435826050891}-{'f1_val': 0.9433847346540136, 'auprc': 0.9456533148580372, 'loss_val': 0.3043220824992655, 'psi': 0.944292166735623}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=33 head_norm_before_train=1.516357 cos_to_last_merge=0.9990 (last merge round=31)
[S5] round=33 local utility u=0.000000 metrics={'f1_val': 0.4176672648348806, 'auprc': 0.6118924786977424, 'loss_val': 1.1423762580640782, 'psi': 0.4953573503800254}-{'f1_val': 0.7003611031385764, 'auprc': 0.9812516512446868, 'loss_val': 0.4825743904793586, 'psi': 0.8127173223810206}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=33 head_norm_before_train=1.321173 cos_to_last_merge=0.9978 (last merge round=29)
[S6] round=33 local utility u=0.837939 metrics={'f1_val': 0.872028537218851, 'auprc': 0.9518811229636854, 'loss_val': 0.33826248673662174, 'psi': 0.9039695715167848}-{'f1_val': 0.693705445290213, 'auprc': 0.8635592882534346, 'loss_val': 0.6792362081575101, 'psi': 0.7616469824755017}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=33 head_norm_before_train=1.155702 cos_to_last_merge=0.9995 (last merge round=31)
[S7] round=33 local utility u=0.231730 metrics={'f1_val': 0.5726580423883987, 'auprc': 0.7941722915621576, 'loss_val': 0.7170452698309804, 'psi': 0.6612637420579023}-{'f1_val': 0.5262630518812216, 'auprc': 0.7781128692502108, 'loss_val': 0.8539570021659111, 'psi': 0.6270029788288174}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=33 head_norm_before_train=1.286655 cos_to_last_merge=0.9666 (last merge round=25)
[S8] round=33 local utility u=1.000000 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9986653849241951, 'loss_val': 0.10342389834053214, 'psi': 0.9971880160097697}-{'f1_val': 0.7142391053978291, 'auprc': 0.9776021807987372, 'loss_val': 0.44230513832544677, 'psi': 0.8195843355581924}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=33 head_norm_before_train=1.690859 cos_to_last_merge=0.9927 (last merge round=25)
[S9] round=33 local utility u=0.003012 metrics={'f1_val': 0.9963953425060355, 'auprc': 0.999602826416137, 'loss_val': 0.0392347129186663, 'psi': 0.997678336070076}-{'f1_val': 0.9959775008625639, 'auprc': 0.999602667996202, 'loss_val': 0.04275097618039301, 'psi': 0.9974275677160191}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=33 head_norm_before_train=1.959867 (no previous merge yet)
[S10] round=33 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9909210754958, 'loss_val': 0.030836133380637145, 'psi': 0.9934811336099448}-{'f1_val': 0.9953654828731612, 'auprc': 0.9957312868736692, 'loss_val': 0.030372121524381724, 'psi': 0.9955118044733644}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=33 head_norm_before_train=2.082796 (no previous merge yet)
[S11] round=33 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9984727574933371, 'loss_val': 0.02458486651566619, 'psi': 0.9970693079453204}-{'f1_val': 0.9965470045135896, 'auprc': 0.9984424848731239, 'loss_val': 0.02479790516320177, 'psi': 0.9973051966574034}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=33 head_norm_before_train=1.726386 (no previous merge yet)
[S13] round=33 local utility u=0.142883 metrics={'f1_val': 0.6356351761566985, 'auprc': 0.6355629476653775, 'loss_val': 0.5810268324418401, 'psi': 0.6356062847601701}-{'f1_val': 0.5942761106553748, 'auprc': 0.6875903912608615, 'loss_val': 0.7747206361897653, 'psi': 0.6316018228975695}
[S13] not sending this round → trigger blocked (psi=0.636)
[S14] START round=33 head_norm_before_train=1.498519 cos_to_last_merge=0.9857 (last merge round=25)
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.9394500935766451, 'auprc': 0.9990682995432092, 'loss_val': 0.13624672846727595, 'psi': 0.9632973759632708}-{'f1_val': 0.997211058727947, 'auprc': 0.9990745662848225, 'loss_val': 0.0655893701566198, 'psi': 0.9979564617506973}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=33 head_norm_before_train=1.284229 cos_to_last_merge=0.9990 (last merge round=30)
[S15] round=33 local utility u=0.999529 metrics={'f1_val': 0.9963755136436562, 'auprc': 0.9911526886594264, 'loss_val': 0.059280644036564356, 'psi': 0.9942863836499642}-{'f1_val': 0.7180941799882314, 'auprc': 0.9895331635017177, 'loss_val': 0.3837924700683354, 'psi': 0.8266697733936259}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=33 head_norm_before_train=1.236350 cos_to_last_merge=0.9959 (last merge round=29)
[S16] round=33 local utility u=0.007792 metrics={'f1_val': 0.9408493397651205, 'auprc': 0.9949491359369991, 'loss_val': 0.21520106991997542, 'psi': 0.962489258233872}-{'f1_val': 0.9400110735019539, 'auprc': 0.9974592541056244, 'loss_val': 0.2332851169017318, 'psi': 0.9629903457434221}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=33 head_norm_before_train=1.571727 cos_to_last_merge=0.7885 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.789
[S17] round=33 local utility u=1.000000 metrics={'f1_val': 0.9646518958761303, 'auprc': 0.9579242341302057, 'loss_val': 0.2485215652646112, 'psi': 0.9619608311777604}-{'f1_val': 0.589968820141954, 'auprc': 0.8110475950247917, 'loss_val': 0.872035319088304, 'psi': 0.6784003300950892}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=34 head_norm_before_train=1.922508 (no previous merge yet)
[S2] round=34 local utility u=0.421976 metrics={'f1_val': 0.9690412212572719, 'auprc': 0.9895821019794387, 'loss_val': 0.12915788337709228, 'psi': 0.9772575735461386}-{'f1_val': 0.8570535025596419, 'auprc': 0.9608793969146926, 'loss_val': 0.21507463636038493, 'psi': 0.8985838603016623}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=34 head_norm_before_train=1.562859 cos_to_last_merge=0.9987 (last merge round=31)
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.9330148379356801, 'auprc': 0.9982495256154924, 'loss_val': 0.19022012336571753, 'psi': 0.959108713007605}-{'f1_val': 0.9615385219550141, 'auprc': 0.9984196745997871, 'loss_val': 0.08587841835522358, 'psi': 0.9762909830129234}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=34 head_norm_before_train=1.270284 cos_to_last_merge=0.9957 (last merge round=30)
[S4] round=34 local utility u=0.049593 metrics={'f1_val': 0.9577226574211956, 'auprc': 0.9642636242579223, 'loss_val': 0.27794752585001153, 'psi': 0.9603390441558863}-{'f1_val': 0.9432810910641973, 'auprc': 0.9639373199164265, 'loss_val': 0.2895058497358946, 'psi': 0.9515435826050891}
[S4] not sending this round → trigger blocked (psi=0.960)
[S5] START round=34 head_norm_before_train=1.539273 cos_to_last_merge=0.9964 (last merge round=31)
[S5] round=34 local utility u=1.000000 metrics={'f1_val': 0.7003611031385764, 'auprc': 0.9830726043132395, 'loss_val': 0.37214463997894603, 'psi': 0.8134457036084417}-{'f1_val': 0.4176672648348806, 'auprc': 0.6118924786977424, 'loss_val': 1.1423762580640782, 'psi': 0.4953573503800254}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=34 head_norm_before_train=1.355242 cos_to_last_merge=0.9966 (last merge round=29)
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.7845676833763484, 'auprc': 0.9532153015133237, 'loss_val': 0.4929393160750298, 'psi': 0.8520267306311385}-{'f1_val': 0.872028537218851, 'auprc': 0.9518811229636854, 'loss_val': 0.33826248673662174, 'psi': 0.9039695715167848}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=34 head_norm_before_train=1.182134 cos_to_last_merge=0.9980 (last merge round=31)
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.5393154039165743, 'auprc': 0.7595563342862632, 'loss_val': 0.8408077827618251, 'psi': 0.6274117760644499}-{'f1_val': 0.5726580423883987, 'auprc': 0.7941722915621576, 'loss_val': 0.7170452698309804, 'psi': 0.6612637420579023}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=34 head_norm_before_train=1.306669 cos_to_last_merge=0.9639 (last merge round=25)
[S8] round=34 local utility u=0.000000 metrics={'f1_val': 0.7889083488874179, 'auprc': 0.9953051435399111, 'loss_val': 0.19578306698011072, 'psi': 0.8714670667484152}-{'f1_val': 0.9962031034001528, 'auprc': 0.9986653849241951, 'loss_val': 0.10342389834053214, 'psi': 0.9971880160097697}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=34 head_norm_before_train=1.707175 cos_to_last_merge=0.9917 (last merge round=25)
[S9] round=34 local utility u=0.002432 metrics={'f1_val': 0.996808967411047, 'auprc': 0.9996037740659562, 'loss_val': 0.03685480724044235, 'psi': 0.9979268900730107}-{'f1_val': 0.9963953425060355, 'auprc': 0.999602826416137, 'loss_val': 0.0392347129186663, 'psi': 0.997678336070076}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=34 head_norm_before_train=1.972151 (no previous merge yet)
[S10] round=34 local utility u=0.009748 metrics={'f1_val': 0.9955851229258669, 'auprc': 0.9960887010042139, 'loss_val': 0.029227708067990604, 'psi': 0.9957865541572057}-{'f1_val': 0.9951878390193748, 'auprc': 0.9909210754958, 'loss_val': 0.030836133380637145, 'psi': 0.9934811336099448}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] sending update (kind=head size=1804 to 1 peers)
[S11] START round=34 head_norm_before_train=2.093583 (no previous merge yet)
[S11] round=34 local utility u=0.000000 metrics={'f1_val': 0.9650400379867655, 'auprc': 0.9985238608021415, 'loss_val': 0.10728751111368066, 'psi': 0.978433567112916}-{'f1_val': 0.9961336749133093, 'auprc': 0.9984727574933371, 'loss_val': 0.02458486651566619, 'psi': 0.9970693079453204}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=34 head_norm_before_train=1.731816 (no previous merge yet)
[S13] round=34 local utility u=0.000000 metrics={'f1_val': 0.5749568814502992, 'auprc': 0.69617038773086, 'loss_val': 0.8898289874607207, 'psi': 0.6234422839625235}-{'f1_val': 0.6356351761566985, 'auprc': 0.6355629476653775, 'loss_val': 0.5810268324418401, 'psi': 0.6356062847601701}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=34 head_norm_before_train=1.513647 cos_to_last_merge=0.9847 (last merge round=25)
[S14] round=34 local utility u=0.052968 metrics={'f1_val': 0.9526409667831343, 'auprc': 0.9990193010258637, 'loss_val': 0.10930863294168164, 'psi': 0.9711923004802261}-{'f1_val': 0.9394500935766451, 'auprc': 0.9990682995432092, 'loss_val': 0.13624672846727595, 'psi': 0.9632973759632708}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=34 head_norm_before_train=1.310405 cos_to_last_merge=0.9981 (last merge round=30)
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.7678615012839803, 'auprc': 0.9454247184524365, 'loss_val': 0.38792063394792087, 'psi': 0.8388867881513629}-{'f1_val': 0.9963755136436562, 'auprc': 0.9911526886594264, 'loss_val': 0.059280644036564356, 'psi': 0.9942863836499642}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=34 head_norm_before_train=1.269941 cos_to_last_merge=0.9939 (last merge round=29)
[S16] round=34 local utility u=0.232024 metrics={'f1_val': 0.9923067388147779, 'auprc': 0.9979771726446303, 'loss_val': 0.06898252372399782, 'psi': 0.9945749123467189}-{'f1_val': 0.9408493397651205, 'auprc': 0.9949491359369991, 'loss_val': 0.21520106991997542, 'psi': 0.962489258233872}
[S16] not sending this round → trigger blocked (psi=0.995)
[S17] START round=34 head_norm_before_train=1.588626 cos_to_last_merge=0.7874 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.787
[S17] round=34 local utility u=0.000000 metrics={'f1_val': 0.6702788084296514, 'auprc': 0.9912630560343874, 'loss_val': 0.6512822949859592, 'psi': 0.7986725074715457}-{'f1_val': 0.9646518958761303, 'auprc': 0.9579242341302057, 'loss_val': 0.2485215652646112, 'psi': 0.9619608311777604}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=35 head_norm_before_train=1.932511 (no previous merge yet)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.6418766975567985, 'auprc': 0.7406882319826342, 'loss_val': 0.3567302147744817, 'psi': 0.6814013113271329}-{'f1_val': 0.9690412212572719, 'auprc': 0.9895821019794387, 'loss_val': 0.12915788337709228, 'psi': 0.9772575735461386}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=35 head_norm_before_train=1.595819 cos_to_last_merge=0.9976 (last merge round=31)
[S3] round=35 local utility u=0.024008 metrics={'f1_val': 0.9308513644528659, 'auprc': 0.9986479292594492, 'loss_val': 0.13041829717182638, 'psi': 0.9579699903754992}-{'f1_val': 0.9330148379356801, 'auprc': 0.9982495256154924, 'loss_val': 0.19022012336571753, 'psi': 0.959108713007605}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=35 head_norm_before_train=1.297703 cos_to_last_merge=0.9930 (last merge round=30)
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.9398625458992805, 'auprc': 0.9152111935108805, 'loss_val': 0.29563828624674426, 'psi': 0.9300020049439205}-{'f1_val': 0.9577226574211956, 'auprc': 0.9642636242579223, 'loss_val': 0.27794752585001153, 'psi': 0.9603390441558863}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=35 head_norm_before_train=1.556180 cos_to_last_merge=0.9940 (last merge round=31)
[S5] round=35 local utility u=0.000000 metrics={'f1_val': 0.5811835199005465, 'auprc': 0.698858312395259, 'loss_val': 0.6684328639594312, 'psi': 0.6282534368984315}-{'f1_val': 0.7003611031385764, 'auprc': 0.9830726043132395, 'loss_val': 0.37214463997894603, 'psi': 0.8134457036084417}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=35 head_norm_before_train=1.388843 cos_to_last_merge=0.9952 (last merge round=29)
[S6] round=35 local utility u=0.210212 metrics={'f1_val': 0.837191822084906, 'auprc': 0.9554709550029554, 'loss_val': 0.3950270035535903, 'psi': 0.8845034752521258}-{'f1_val': 0.7845676833763484, 'auprc': 0.9532153015133237, 'loss_val': 0.4929393160750298, 'psi': 0.8520267306311385}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=35 head_norm_before_train=1.208483 cos_to_last_merge=0.9958 (last merge round=31)
[S7] round=35 local utility u=0.106072 metrics={'f1_val': 0.5509630314827001, 'auprc': 0.7869955483345918, 'loss_val': 0.7808677666779438, 'psi': 0.6453760382234568}-{'f1_val': 0.5393154039165743, 'auprc': 0.7595563342862632, 'loss_val': 0.8408077827618251, 'psi': 0.6274117760644499}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=35 head_norm_before_train=1.328867 cos_to_last_merge=0.9612 (last merge round=25)
[S8] round=35 local utility u=0.691263 metrics={'f1_val': 0.9950949602617258, 'auprc': 0.999047670203362, 'loss_val': 0.06160444381480998, 'psi': 0.9966760442383803}-{'f1_val': 0.7889083488874179, 'auprc': 0.9953051435399111, 'loss_val': 0.19578306698011072, 'psi': 0.8714670667484152}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=35 head_norm_before_train=1.721730 cos_to_last_merge=0.9909 (last merge round=25)
[S9] round=35 local utility u=0.000896 metrics={'f1_val': 0.996808967411047, 'auprc': 0.9996031714470598, 'loss_val': 0.035061832656784926, 'psi': 0.9979266490254521}-{'f1_val': 0.996808967411047, 'auprc': 0.9996037740659562, 'loss_val': 0.03685480724044235, 'psi': 0.9979268900730107}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=35 head_norm_before_train=1.983297 (no previous merge yet)
[S10] round=35 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9934461305826698, 'loss_val': 0.02942244567526898, 'psi': 0.9944911556446927}-{'f1_val': 0.9955851229258669, 'auprc': 0.9960887010042139, 'loss_val': 0.029227708067990604, 'psi': 0.9957865541572057}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=35 head_norm_before_train=2.103798 (no previous merge yet)
[S11] round=35 local utility u=0.133322 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9982549707125172, 'loss_val': 0.024946888230415402, 'psi': 0.9968370910061553}-{'f1_val': 0.9650400379867655, 'auprc': 0.9985238608021415, 'loss_val': 0.10728751111368066, 'psi': 0.978433567112916}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=35 head_norm_before_train=1.735950 (no previous merge yet)
[S13] round=35 local utility u=0.191829 metrics={'f1_val': 0.6099542627527943, 'auprc': 0.6898683350904623, 'loss_val': 0.6972500368706972, 'psi': 0.6419198916878615}-{'f1_val': 0.5749568814502992, 'auprc': 0.69617038773086, 'loss_val': 0.8898289874607207, 'psi': 0.6234422839625235}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=35 head_norm_before_train=1.527394 cos_to_last_merge=0.9836 (last merge round=25)
[S14] round=35 local utility u=0.036128 metrics={'f1_val': 0.9613186889426174, 'auprc': 0.999035632110626, 'loss_val': 0.08916877572929548, 'psi': 0.9764054662098207}-{'f1_val': 0.9526409667831343, 'auprc': 0.9990193010258637, 'loss_val': 0.10930863294168164, 'psi': 0.9711923004802261}
[S14] not sending this round → trigger blocked (psi=0.976)
[S15] START round=35 head_norm_before_train=1.328901 cos_to_last_merge=0.9973 (last merge round=30)
[S15] round=35 local utility u=0.072407 metrics={'f1_val': 0.7736904966225093, 'auprc': 0.9773769472994667, 'loss_val': 0.37393668522711765, 'psi': 0.8551650768932922}-{'f1_val': 0.7678615012839803, 'auprc': 0.9454247184524365, 'loss_val': 0.38792063394792087, 'psi': 0.8388867881513629}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=35 head_norm_before_train=1.300481 cos_to_last_merge=0.9920 (last merge round=29)
[S16] round=35 local utility u=0.000000 metrics={'f1_val': 0.9339116795513906, 'auprc': 0.9876866368910291, 'loss_val': 0.30083039916132204, 'psi': 0.955421662487246}-{'f1_val': 0.9923067388147779, 'auprc': 0.9979771726446303, 'loss_val': 0.06898252372399782, 'psi': 0.9945749123467189}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=35 head_norm_before_train=1.602981 cos_to_last_merge=0.7864 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.786
[S17] round=35 local utility u=0.000000 metrics={'f1_val': 0.6483368752563973, 'auprc': 0.9835531403342233, 'loss_val': 0.6164432053780285, 'psi': 0.7824233812875276}-{'f1_val': 0.6702788084296514, 'auprc': 0.9912630560343874, 'loss_val': 0.6512822949859592, 'psi': 0.7986725074715457}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=36 head_norm_before_train=1.939720 (no previous merge yet)
[S2] round=36 local utility u=0.947205 metrics={'f1_val': 0.8055027562033312, 'auprc': 0.9841233103424656, 'loss_val': 0.17438119863400037, 'psi': 0.876950977858985}-{'f1_val': 0.6418766975567985, 'auprc': 0.7406882319826342, 'loss_val': 0.3567302147744817, 'psi': 0.6814013113271329}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=36 head_norm_before_train=1.620279 cos_to_last_merge=0.9965 (last merge round=31)
[S3] round=36 local utility u=0.098973 metrics={'f1_val': 0.9615785680382265, 'auprc': 0.9983765420796722, 'loss_val': 0.11602078747292585, 'psi': 0.9762977576548048}-{'f1_val': 0.9308513644528659, 'auprc': 0.9986479292594492, 'loss_val': 0.13041829717182638, 'psi': 0.9579699903754992}
[S3] not sending this round → trigger blocked (psi=0.976)
[S4] START round=36 head_norm_before_train=1.326269 cos_to_last_merge=0.9897 (last merge round=30)
[S4] round=36 local utility u=0.077450 metrics={'f1_val': 0.9468483755353373, 'auprc': 0.9441207608354673, 'loss_val': 0.26938159684219154, 'psi': 0.9457573296553893}-{'f1_val': 0.9398625458992805, 'auprc': 0.9152111935108805, 'loss_val': 0.29563828624674426, 'psi': 0.9300020049439205}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] sending update (kind=head size=1806 to 1 peers)
[S5] START round=36 head_norm_before_train=1.574064 cos_to_last_merge=0.9911 (last merge round=31)
[S5] round=36 local utility u=0.961528 metrics={'f1_val': 0.7004465831882414, 'auprc': 0.984369947174996, 'loss_val': 0.317489274562964, 'psi': 0.8140159287829433}-{'f1_val': 0.5811835199005465, 'auprc': 0.698858312395259, 'loss_val': 0.6684328639594312, 'psi': 0.6282534368984315}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=36 head_norm_before_train=1.414998 cos_to_last_merge=0.9939 (last merge round=29)
[S6] round=36 local utility u=0.550757 metrics={'f1_val': 0.9600408239911787, 'auprc': 0.9893383477650428, 'loss_val': 0.1322089679659344, 'psi': 0.9717598335007245}-{'f1_val': 0.837191822084906, 'auprc': 0.9554709550029554, 'loss_val': 0.3950270035535903, 'psi': 0.8845034752521258}
[S6] not sending this round → trigger blocked (psi=0.972)
[S7] START round=36 head_norm_before_train=1.229306 cos_to_last_merge=0.9941 (last merge round=31)
[S7] round=36 local utility u=0.554150 metrics={'f1_val': 0.6624854916567727, 'auprc': 0.8262162352618441, 'loss_val': 0.45936543123716234, 'psi': 0.7279777890988013}-{'f1_val': 0.5509630314827001, 'auprc': 0.7869955483345918, 'loss_val': 0.7808677666779438, 'psi': 0.6453760382234568}
[S7] not sending this round → trigger blocked (psi=0.728)
[S8] START round=36 head_norm_before_train=1.348159 cos_to_last_merge=0.9588 (last merge round=25)
[S8] round=36 local utility u=0.000000 metrics={'f1_val': 0.9950949602617258, 'auprc': 0.9987073247616334, 'loss_val': 0.06322780472540362, 'psi': 0.9965399060616889}-{'f1_val': 0.9950949602617258, 'auprc': 0.999047670203362, 'loss_val': 0.06160444381480998, 'psi': 0.9966760442383803}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=36 head_norm_before_train=1.735688 cos_to_last_merge=0.9900 (last merge round=25)
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.9901193303318852, 'auprc': 0.9995838563047923, 'loss_val': 0.04568325067956344, 'psi': 0.993905140721048}-{'f1_val': 0.996808967411047, 'auprc': 0.9996031714470598, 'loss_val': 0.035061832656784926, 'psi': 0.9979266490254521}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=36 head_norm_before_train=1.990039 (no previous merge yet)
[S10] round=36 local utility u=0.004580 metrics={'f1_val': 0.9949509212940392, 'auprc': 0.9969299801268188, 'loss_val': 0.029292070543341996, 'psi': 0.9957425448271511}-{'f1_val': 0.9951878390193748, 'auprc': 0.9934461305826698, 'loss_val': 0.02942244567526898, 'psi': 0.9944911556446927}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=36 head_norm_before_train=2.110950 (no previous merge yet)
[S11] round=36 local utility u=0.000000 metrics={'f1_val': 0.9826047033085225, 'auprc': 0.9985485297612411, 'loss_val': 0.06413324445407348, 'psi': 0.9889822338896099}-{'f1_val': 0.9958918378685807, 'auprc': 0.9982549707125172, 'loss_val': 0.024946888230415402, 'psi': 0.9968370910061553}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=36 head_norm_before_train=1.736972 (no previous merge yet)
[S13] round=36 local utility u=0.032434 metrics={'f1_val': 0.6254486414078289, 'auprc': 0.6685340141352055, 'loss_val': 0.6613452774765054, 'psi': 0.6426827904987795}-{'f1_val': 0.6099542627527943, 'auprc': 0.6898683350904623, 'loss_val': 0.6972500368706972, 'psi': 0.6419198916878615}
[S13] not sending this round → trigger blocked (psi=0.643)
[S14] START round=36 head_norm_before_train=1.543698 cos_to_last_merge=0.9824 (last merge round=25)
[S14] round=36 local utility u=0.042596 metrics={'f1_val': 0.973819941848, 'auprc': 0.9989990179202765, 'loss_val': 0.07887349342463824, 'psi': 0.9838915722769106}-{'f1_val': 0.9613186889426174, 'auprc': 0.999035632110626, 'loss_val': 0.08916877572929548, 'psi': 0.9764054662098207}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=36 head_norm_before_train=1.346193 cos_to_last_merge=0.9966 (last merge round=30)
[S15] round=36 local utility u=0.806866 metrics={'f1_val': 0.9841326292824172, 'auprc': 0.9929656208744185, 'loss_val': 0.06962314787695932, 'psi': 0.9876658259192177}-{'f1_val': 0.7736904966225093, 'auprc': 0.9773769472994667, 'loss_val': 0.37393668522711765, 'psi': 0.8551650768932922}
[S15] not sending this round → trigger blocked (psi=0.988)
[S16] START round=36 head_norm_before_train=1.326366 cos_to_last_merge=0.9903 (last merge round=29)
[S16] round=36 local utility u=0.303237 metrics={'f1_val': 0.9914105368870502, 'auprc': 0.9960604575744604, 'loss_val': 0.0644706556267164, 'psi': 0.9932705051620143}-{'f1_val': 0.9339116795513906, 'auprc': 0.9876866368910291, 'loss_val': 0.30083039916132204, 'psi': 0.955421662487246}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=36 head_norm_before_train=1.617908 cos_to_last_merge=0.7848 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.785
[S17] round=36 local utility u=0.000000 metrics={'f1_val': 0.6277906055050109, 'auprc': 0.8727842793099972, 'loss_val': 0.698597771815239, 'psi': 0.7257880750270054}-{'f1_val': 0.6483368752563973, 'auprc': 0.9835531403342233, 'loss_val': 0.6164432053780285, 'psi': 0.7824233812875276}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=37 head_norm_before_train=1.948126 (no previous merge yet)
[S2] round=37 local utility u=0.000000 metrics={'f1_val': 0.7665140945156168, 'auprc': 0.7542619057393896, 'loss_val': 0.3491647600145881, 'psi': 0.7616132190051259}-{'f1_val': 0.8055027562033312, 'auprc': 0.9841233103424656, 'loss_val': 0.17438119863400037, 'psi': 0.876950977858985}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=37 head_norm_before_train=1.645139 cos_to_last_merge=0.9954 (last merge round=31)
[S3] round=37 local utility u=0.150312 metrics={'f1_val': 0.9978100342676263, 'auprc': 0.9986826588776074, 'loss_val': 0.03370413109982644, 'psi': 0.9981590841116188}-{'f1_val': 0.9615785680382265, 'auprc': 0.9983765420796722, 'loss_val': 0.11602078747292585, 'psi': 0.9762977576548048}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] START round=37 head_norm_before_train=1.352647 cos_to_last_merge=0.9863 (last merge round=30)
[S4] round=37 local utility u=0.097195 metrics={'f1_val': 0.9596509664784723, 'auprc': 0.9797275486663821, 'loss_val': 0.25862841778642337, 'psi': 0.9676815993536363}-{'f1_val': 0.9468483755353373, 'auprc': 0.9441207608354673, 'loss_val': 0.26938159684219154, 'psi': 0.9457573296553893}
[S4] not sending this round → trigger blocked (psi=0.968)
[S5] START round=37 head_norm_before_train=1.589433 cos_to_last_merge=0.9886 (last merge round=31)
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.7003191454271995, 'auprc': 0.9632812789753998, 'loss_val': 0.3303692318242371, 'psi': 0.8055039988464796}-{'f1_val': 0.7004465831882414, 'auprc': 0.984369947174996, 'loss_val': 0.317489274562964, 'psi': 0.8140159287829433}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=37 head_norm_before_train=1.445133 cos_to_last_merge=0.9923 (last merge round=29)
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.7650772256417417, 'auprc': 0.9400153980199087, 'loss_val': 0.5667460455518, 'psi': 0.8350524945930086}-{'f1_val': 0.9600408239911787, 'auprc': 0.9893383477650428, 'loss_val': 0.1322089679659344, 'psi': 0.9717598335007245}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=37 head_norm_before_train=1.253346 cos_to_last_merge=0.9918 (last merge round=31)
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.5970303847964918, 'auprc': 0.7920807313324864, 'loss_val': 0.6561997431449925, 'psi': 0.6750505234108897}-{'f1_val': 0.6624854916567727, 'auprc': 0.8262162352618441, 'loss_val': 0.45936543123716234, 'psi': 0.7279777890988013}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=37 head_norm_before_train=1.366206 cos_to_last_merge=0.9566 (last merge round=25)
[S8] round=37 local utility u=0.007903 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9990018227417375, 'loss_val': 0.05495398017771148, 'psi': 0.9973225911367867}-{'f1_val': 0.9950949602617258, 'auprc': 0.9987073247616334, 'loss_val': 0.06322780472540362, 'psi': 0.9965399060616889}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=37 head_norm_before_train=1.748875 cos_to_last_merge=0.9892 (last merge round=25)
[S9] round=37 local utility u=0.016587 metrics={'f1_val': 0.996398546385143, 'auprc': 0.9939160042491864, 'loss_val': 0.033180151188743894, 'psi': 0.9954055295307604}-{'f1_val': 0.9901193303318852, 'auprc': 0.9995838563047923, 'loss_val': 0.04568325067956344, 'psi': 0.993905140721048}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=37 head_norm_before_train=1.997986 (no previous merge yet)
[S10] round=37 local utility u=0.000447 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.995675974551931, 'loss_val': 0.028587981732093443, 'psi': 0.9956361819297843}-{'f1_val': 0.9949509212940392, 'auprc': 0.9969299801268188, 'loss_val': 0.029292070543341996, 'psi': 0.9957425448271511}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=37 head_norm_before_train=2.117621 (no previous merge yet)
[S11] round=37 local utility u=0.060710 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9983131004070944, 'loss_val': 0.023181060218466665, 'psi': 0.9970054451108233}-{'f1_val': 0.9826047033085225, 'auprc': 0.9985485297612411, 'loss_val': 0.06413324445407348, 'psi': 0.9889822338896099}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] sending update (kind=head size=1792 to 1 peers)
[S13] START round=37 head_norm_before_train=1.739711 (no previous merge yet)
[S13] round=37 local utility u=0.000000 metrics={'f1_val': 0.6067282459668796, 'auprc': 0.7004485932147998, 'loss_val': 0.7129172002608819, 'psi': 0.6442163848660476}-{'f1_val': 0.6254486414078289, 'auprc': 0.6685340141352055, 'loss_val': 0.6613452774765054, 'psi': 0.6426827904987795}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=37 head_norm_before_train=1.559839 cos_to_last_merge=0.9813 (last merge round=25)
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.9404486415173138, 'auprc': 0.9990630466824634, 'loss_val': 0.14579098054639245, 'psi': 0.9638944035833736}-{'f1_val': 0.973819941848, 'auprc': 0.9989990179202765, 'loss_val': 0.07887349342463824, 'psi': 0.9838915722769106}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=37 head_norm_before_train=1.365355 cos_to_last_merge=0.9958 (last merge round=30)
[S15] round=37 local utility u=0.000000 metrics={'f1_val': 0.918835317241337, 'auprc': 0.9944303221400718, 'loss_val': 0.14174364981526832, 'psi': 0.9490733192008309}-{'f1_val': 0.9841326292824172, 'auprc': 0.9929656208744185, 'loss_val': 0.06962314787695932, 'psi': 0.9876658259192177}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=37 head_norm_before_train=1.349089 cos_to_last_merge=0.9890 (last merge round=29)
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.8385875670003109, 'auprc': 0.8911784672085276, 'loss_val': 0.7918217961960944, 'psi': 0.8596239270835976}-{'f1_val': 0.9914105368870502, 'auprc': 0.9960604575744604, 'loss_val': 0.0644706556267164, 'psi': 0.9932705051620143}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=37 head_norm_before_train=1.634020 cos_to_last_merge=0.7832 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.783
[S17] round=37 local utility u=0.065792 metrics={'f1_val': 0.6276317211103413, 'auprc': 0.9245311710459199, 'loss_val': 0.7213018609780392, 'psi': 0.7463915010845728}-{'f1_val': 0.6277906055050109, 'auprc': 0.8727842793099972, 'loss_val': 0.698597771815239, 'psi': 0.7257880750270054}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=38 head_norm_before_train=1.956364 (no previous merge yet)
[S2] round=38 local utility u=0.832206 metrics={'f1_val': 0.8919408650919245, 'auprc': 0.9876057014962427, 'loss_val': 0.13734421801642854, 'psi': 0.9302067996536518}-{'f1_val': 0.7665140945156168, 'auprc': 0.7542619057393896, 'loss_val': 0.3491647600145881, 'psi': 0.7616132190051259}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=38 head_norm_before_train=1.668635 cos_to_last_merge=0.9944 (last merge round=31)
[S3] round=38 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.998549434095268, 'loss_val': 0.12624454050940703, 'psi': 0.9760409243013733}-{'f1_val': 0.9978100342676263, 'auprc': 0.9986826588776074, 'loss_val': 0.03370413109982644, 'psi': 0.9981590841116188}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=38 head_norm_before_train=1.373629 cos_to_last_merge=0.9835 (last merge round=30)
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.9353191040373271, 'auprc': 0.9039208472486715, 'loss_val': 0.3363387033829934, 'psi': 0.9227598013218649}-{'f1_val': 0.9596509664784723, 'auprc': 0.9797275486663821, 'loss_val': 0.25862841778642337, 'psi': 0.9676815993536363}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=38 head_norm_before_train=1.607999 cos_to_last_merge=0.9856 (last merge round=31)
[S5] round=38 local utility u=0.000000 metrics={'f1_val': 0.6715969710157215, 'auprc': 0.8151124564696677, 'loss_val': 0.426552834216017, 'psi': 0.7290031651972999}-{'f1_val': 0.7003191454271995, 'auprc': 0.9632812789753998, 'loss_val': 0.3303692318242371, 'psi': 0.8055039988464796}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=38 head_norm_before_train=1.468647 cos_to_last_merge=0.9909 (last merge round=29)
[S6] round=38 local utility u=0.278631 metrics={'f1_val': 0.8101787266891681, 'auprc': 0.9553247566717382, 'loss_val': 0.3260216363683155, 'psi': 0.8682371386821961}-{'f1_val': 0.7650772256417417, 'auprc': 0.9400153980199087, 'loss_val': 0.5667460455518, 'psi': 0.8350524945930086}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=38 head_norm_before_train=1.275080 cos_to_last_merge=0.9895 (last merge round=31)
[S7] round=38 local utility u=0.000000 metrics={'f1_val': 0.5715074843631505, 'auprc': 0.7845345911428514, 'loss_val': 0.7478207256090457, 'psi': 0.6567183270750307}-{'f1_val': 0.5970303847964918, 'auprc': 0.7920807313324864, 'loss_val': 0.6561997431449925, 'psi': 0.6750505234108897}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=38 head_norm_before_train=1.385222 cos_to_last_merge=0.9544 (last merge round=25)
[S8] round=38 local utility u=0.000000 metrics={'f1_val': 0.9950949602617258, 'auprc': 0.9986882264477881, 'loss_val': 0.06211679785646259, 'psi': 0.9965322667361507}-{'f1_val': 0.9962031034001528, 'auprc': 0.9990018227417375, 'loss_val': 0.05495398017771148, 'psi': 0.9973225911367867}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=38 head_norm_before_train=1.760794 cos_to_last_merge=0.9885 (last merge round=25)
[S9] round=38 local utility u=0.005947 metrics={'f1_val': 0.996808967411047, 'auprc': 0.9964330499605987, 'loss_val': 0.03129964633372725, 'psi': 0.9966586004308677}-{'f1_val': 0.996398546385143, 'auprc': 0.9939160042491864, 'loss_val': 0.033180151188743894, 'psi': 0.9954055295307604}
[S9] not sending this round → trigger blocked (psi=0.997)
[S10] START round=38 head_norm_before_train=2.008347 (no previous merge yet)
[S10] round=38 local utility u=0.000000 metrics={'f1_val': 0.9953900010273877, 'auprc': 0.9959300247131757, 'loss_val': 0.028266909121593756, 'psi': 0.9956060105017029}-{'f1_val': 0.9956096535150197, 'auprc': 0.995675974551931, 'loss_val': 0.028587981732093443, 'psi': 0.9956361819297843}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=38 head_norm_before_train=2.121313 (no previous merge yet)
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9985658673891791, 'loss_val': 0.024200540813232193, 'psi': 0.99696144967682}-{'f1_val': 0.9961336749133093, 'auprc': 0.9983131004070944, 'loss_val': 0.023181060218466665, 'psi': 0.9970054451108233}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=38 head_norm_before_train=1.744626 (no previous merge yet)
[S13] round=38 local utility u=0.011831 metrics={'f1_val': 0.6085681216998113, 'auprc': 0.7034143560306827, 'loss_val': 0.7091911818717388, 'psi': 0.6465066154321599}-{'f1_val': 0.6067282459668796, 'auprc': 0.7004485932147998, 'loss_val': 0.7129172002608819, 'psi': 0.6442163848660476}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=38 head_norm_before_train=1.575600 cos_to_last_merge=0.9800 (last merge round=25)
[S14] round=38 local utility u=0.203420 metrics={'f1_val': 0.9930198893020945, 'auprc': 0.9986943399551947, 'loss_val': 0.05327224804763296, 'psi': 0.9952896695633346}-{'f1_val': 0.9404486415173138, 'auprc': 0.9990630466824634, 'loss_val': 0.14579098054639245, 'psi': 0.9638944035833736}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] START round=38 head_norm_before_train=1.384780 cos_to_last_merge=0.9949 (last merge round=30)
[S15] round=38 local utility u=0.000000 metrics={'f1_val': 0.8849961635803737, 'auprc': 0.9895976264982441, 'loss_val': 0.19113004817993443, 'psi': 0.9268367487475219}-{'f1_val': 0.918835317241337, 'auprc': 0.9944303221400718, 'loss_val': 0.14174364981526832, 'psi': 0.9490733192008309}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=38 head_norm_before_train=1.368693 cos_to_last_merge=0.9877 (last merge round=29)
[S16] round=38 local utility u=0.981939 metrics={'f1_val': 0.9913232195848869, 'auprc': 0.9977465533886685, 'loss_val': 0.06406181050210707, 'psi': 0.9938925531063996}-{'f1_val': 0.8385875670003109, 'auprc': 0.8911784672085276, 'loss_val': 0.7918217961960944, 'psi': 0.8596239270835976}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=38 head_norm_before_train=1.653369 cos_to_last_merge=0.7812 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.781
[S17] round=38 local utility u=0.000000 metrics={'f1_val': 0.6181066453549029, 'auprc': 0.8662179590719523, 'loss_val': 0.8262449199542866, 'psi': 0.7173511708417226}-{'f1_val': 0.6276317211103413, 'auprc': 0.9245311710459199, 'loss_val': 0.7213018609780392, 'psi': 0.7463915010845728}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=39 head_norm_before_train=1.966296 (no previous merge yet)
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.895607740760405, 'auprc': 0.976854836807376, 'loss_val': 0.16789103960517, 'psi': 0.9281065791791934}-{'f1_val': 0.8919408650919245, 'auprc': 0.9876057014962427, 'loss_val': 0.13734421801642854, 'psi': 0.9302067996536518}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=40 psi=0.928 u=0.0000 p_local=0.3079 f1=0.896 auprc=0.977 bytes=41345
[S3] START round=39 head_norm_before_train=1.690659 cos_to_last_merge=0.9933 (last merge round=31)
[S3] round=39 local utility u=0.157982 metrics={'f1_val': 0.9973696976584205, 'auprc': 0.9984788357102266, 'loss_val': 0.02807496320682323, 'psi': 0.9978133528791429}-{'f1_val': 0.9610352511054436, 'auprc': 0.998549434095268, 'loss_val': 0.12624454050940703, 'psi': 0.9760409243013733}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S3] r=40 psi=0.998 u=0.1580 p_local=0.0791 f1=0.997 auprc=0.998 bytes=39597
[S4] START round=39 head_norm_before_train=1.388122 cos_to_last_merge=0.9815 (last merge round=30)
[S4] round=39 local utility u=0.052280 metrics={'f1_val': 0.9377227865703374, 'auprc': 0.9175917352556868, 'loss_val': 0.2872126119175332, 'psi': 0.9296703660444772}-{'f1_val': 0.9353191040373271, 'auprc': 0.9039208472486715, 'loss_val': 0.3363387033829934, 'psi': 0.9227598013218649}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S4] r=40 psi=0.930 u=0.0523 p_local=0.0427 f1=0.938 auprc=0.918 bytes=39576
[S5] START round=39 head_norm_before_train=1.624646 cos_to_last_merge=0.9831 (last merge round=31)
[S5] round=39 local utility u=0.379418 metrics={'f1_val': 0.7002451011760882, 'auprc': 0.9661850409095253, 'loss_val': 0.29282330494098974, 'psi': 0.8066210770694631}-{'f1_val': 0.6715969710157215, 'auprc': 0.8151124564696677, 'loss_val': 0.426552834216017, 'psi': 0.7290031651972999}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S5] r=40 psi=0.807 u=0.3794 p_local=0.3159 f1=0.700 auprc=0.966 bytes=35971
[S6] START round=39 head_norm_before_train=1.487667 cos_to_last_merge=0.9896 (last merge round=29)
[S6] round=39 local utility u=0.000000 metrics={'f1_val': 0.7565185850486433, 'auprc': 0.9325666859435698, 'loss_val': 0.5629921573347063, 'psi': 0.826937825406614}-{'f1_val': 0.8101787266891681, 'auprc': 0.9553247566717382, 'loss_val': 0.3260216363683155, 'psi': 0.8682371386821961}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=40 psi=0.827 u=0.0000 p_local=0.2120 f1=0.757 auprc=0.933 bytes=37776
[S7] START round=39 head_norm_before_train=1.302616 cos_to_last_merge=0.9866 (last merge round=31)
[S7] round=39 local utility u=0.276848 metrics={'f1_val': 0.6322507239282503, 'auprc': 0.7997713105270372, 'loss_val': 0.6042935643947728, 'psi': 0.6992589585677651}-{'f1_val': 0.5715074843631505, 'auprc': 0.7845345911428514, 'loss_val': 0.7478207256090457, 'psi': 0.6567183270750307}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] sending update (kind=head size=1806 to 1 peers)
[S7] r=40 psi=0.699 u=0.2768 p_local=0.1867 f1=0.632 auprc=0.800 bytes=34203
[S8] START round=39 head_norm_before_train=1.402275 cos_to_last_merge=0.9524 (last merge round=25)
[S8] round=39 local utility u=0.000000 metrics={'f1_val': 0.9847167698009649, 'auprc': 0.9966980652994724, 'loss_val': 0.09159943435004311, 'psi': 0.989509288000368}-{'f1_val': 0.9950949602617258, 'auprc': 0.9986882264477881, 'loss_val': 0.06211679785646259, 'psi': 0.9965322667361507}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=40 psi=0.990 u=0.0000 p_local=0.1185 f1=0.985 auprc=0.997 bytes=43148
[S9] START round=39 head_norm_before_train=1.772250 cos_to_last_merge=0.9878 (last merge round=25)
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.9901193303318852, 'auprc': 0.9988797802590539, 'loss_val': 0.04499302108663007, 'psi': 0.9936235103027526}-{'f1_val': 0.996808967411047, 'auprc': 0.9964330499605987, 'loss_val': 0.03129964633372725, 'psi': 0.9966586004308677}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=40 psi=0.994 u=0.0000 p_local=0.0186 f1=0.990 auprc=0.999 bytes=41399
[S10] START round=39 head_norm_before_train=2.019589 (no previous merge yet)
[S10] round=39 local utility u=0.000330 metrics={'f1_val': 0.9949509212940392, 'auprc': 0.9969474051522598, 'loss_val': 0.0280246478783546, 'psi': 0.9957495148373274}-{'f1_val': 0.9953900010273877, 'auprc': 0.9959300247131757, 'loss_val': 0.028266909121593756, 'psi': 0.9956060105017029}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S10] r=40 psi=0.996 u=0.0003 p_local=0.0033 f1=0.995 auprc=0.997 bytes=46796
[S11] START round=39 head_norm_before_train=2.124968 (no previous merge yet)
[S11] round=39 local utility u=0.000000 metrics={'f1_val': 0.995672955508997, 'auprc': 0.9979074614545096, 'loss_val': 0.05484309630284004, 'psi': 0.9965667578872021}-{'f1_val': 0.9958918378685807, 'auprc': 0.9985658673891791, 'loss_val': 0.024200540813232193, 'psi': 0.99696144967682}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=40 psi=0.997 u=0.0000 p_local=0.0210 f1=0.996 auprc=0.998 bytes=48547
[S13] START round=39 head_norm_before_train=1.750689 (no previous merge yet)
[S13] round=39 local utility u=0.000000 metrics={'f1_val': 0.6079014244990313, 'auprc': 0.7051230261721415, 'loss_val': 0.7116626622065303, 'psi': 0.6467900651682754}-{'f1_val': 0.6085681216998113, 'auprc': 0.7034143560306827, 'loss_val': 0.7091911818717388, 'psi': 0.6465066154321599}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=40 psi=0.647 u=0.0000 p_local=0.0365 f1=0.608 auprc=0.705 bytes=30615
[S14] START round=39 head_norm_before_train=1.591993 cos_to_last_merge=0.9787 (last merge round=25)
[S14] round=39 local utility u=0.017468 metrics={'f1_val': 0.9969706583433163, 'auprc': 0.9990564547133751, 'loss_val': 0.04312760685448287, 'psi': 0.9978049768913398}-{'f1_val': 0.9930198893020945, 'auprc': 0.9986943399551947, 'loss_val': 0.05327224804763296, 'psi': 0.9952896695633346}
[S14] not sending this round → trigger blocked (psi=0.998)
[S14] r=40 psi=0.998 u=0.0175 p_local=0.0522 f1=0.997 auprc=0.999 bytes=46761
[S15] START round=39 head_norm_before_train=1.403324 cos_to_last_merge=0.9940 (last merge round=30)
[S15] round=39 local utility u=0.404001 metrics={'f1_val': 0.9955304014918784, 'auprc': 0.9914954189228332, 'loss_val': 0.05202674827083235, 'psi': 0.9939164084642604}-{'f1_val': 0.8849961635803737, 'auprc': 0.9895976264982441, 'loss_val': 0.19113004817993443, 'psi': 0.9268367487475219}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S15] r=40 psi=0.994 u=0.4040 p_local=0.2660 f1=0.996 auprc=0.991 bytes=43107
[S16] START round=39 head_norm_before_train=1.384251 cos_to_last_merge=0.9867 (last merge round=29)
[S16] round=39 local utility u=0.008273 metrics={'f1_val': 0.9922388235092688, 'auprc': 0.997882554349402, 'loss_val': 0.05341839877163201, 'psi': 0.9944963158453222}-{'f1_val': 0.9913232195848869, 'auprc': 0.9977465533886685, 'loss_val': 0.06406181050210707, 'psi': 0.9938925531063996}
[S16] not sending this round → trigger blocked (psi=0.994)
[S16] r=40 psi=0.994 u=0.0083 p_local=0.2245 f1=0.992 auprc=0.998 bytes=41337
[S17] START round=39 head_norm_before_train=1.674093 cos_to_last_merge=0.7789 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.779
[S17] round=39 local utility u=0.000000 metrics={'f1_val': 0.5838090753780455, 'auprc': 0.7945563646904881, 'loss_val': 1.0965781763319797, 'psi': 0.6681079911030225}-{'f1_val': 0.6181066453549029, 'auprc': 0.8662179590719523, 'loss_val': 0.8262449199542866, 'psi': 0.7173511708417226}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=40 psi=0.668 u=0.0000 p_local=0.1110 f1=0.584 auprc=0.795 bytes=32341
[S2] START round=40 head_norm_before_train=1.975158 (no previous merge yet)
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.8791498981966486, 'auprc': 0.9348214308515019, 'loss_val': 0.19881585399677687, 'psi': 0.90141851125859}-{'f1_val': 0.895607740760405, 'auprc': 0.976854836807376, 'loss_val': 0.16789103960517, 'psi': 0.9281065791791934}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=40 head_norm_before_train=1.710370 cos_to_last_merge=0.9923 (last merge round=31)
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.9973982357793907, 'auprc': 0.9987748605491593, 'loss_val': 0.029191489598504664, 'psi': 0.9979488856872982}-{'f1_val': 0.9973696976584205, 'auprc': 0.9984788357102266, 'loss_val': 0.02807496320682323, 'psi': 0.9978133528791429}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=40 head_norm_before_train=1.402449 cos_to_last_merge=0.9789 (last merge round=30)
[S4] round=40 local utility u=0.125691 metrics={'f1_val': 0.9549683228823256, 'auprc': 0.9590434061323942, 'loss_val': 0.2636595351659386, 'psi': 0.9565983561823531}-{'f1_val': 0.9377227865703374, 'auprc': 0.9175917352556868, 'loss_val': 0.2872126119175332, 'psi': 0.9296703660444772}
[S4] not sending this round → trigger blocked (psi=0.957)
[S5] START round=40 head_norm_before_train=1.640746 cos_to_last_merge=0.9809 (last merge round=31)
[S5] round=40 local utility u=0.000000 metrics={'f1_val': 0.43660442196719185, 'auprc': 0.8499830208905361, 'loss_val': 1.0089645985617801, 'psi': 0.6019558615365296}-{'f1_val': 0.7002451011760882, 'auprc': 0.9661850409095253, 'loss_val': 0.29282330494098974, 'psi': 0.8066210770694631}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=40 head_norm_before_train=1.506096 cos_to_last_merge=0.9881 (last merge round=29)
[S6] round=40 local utility u=0.292801 metrics={'f1_val': 0.8077321447252068, 'auprc': 0.9524289159598398, 'loss_val': 0.34425829601104174, 'psi': 0.8656108532190601}-{'f1_val': 0.7565185850486433, 'auprc': 0.9325666859435698, 'loss_val': 0.5629921573347063, 'psi': 0.826937825406614}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=40 head_norm_before_train=1.328235 cos_to_last_merge=0.9840 (last merge round=31)
[S7] round=40 local utility u=0.000000 metrics={'f1_val': 0.5839123872380316, 'auprc': 0.7922122350915437, 'loss_val': 0.7393225939326746, 'psi': 0.6672323263794364}-{'f1_val': 0.6322507239282503, 'auprc': 0.7997713105270372, 'loss_val': 0.6042935643947728, 'psi': 0.6992589585677651}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=40 head_norm_before_train=1.418597 cos_to_last_merge=0.9505 (last merge round=25)
[S8] round=40 local utility u=0.036052 metrics={'f1_val': 0.9926811669910671, 'auprc': 0.9988098142701554, 'loss_val': 0.07361706256384844, 'psi': 0.9951326259027025}-{'f1_val': 0.9847167698009649, 'auprc': 0.9966980652994724, 'loss_val': 0.09159943435004311, 'psi': 0.989509288000368}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=40 head_norm_before_train=1.782610 cos_to_last_merge=0.9872 (last merge round=25)
[S9] round=40 local utility u=0.028105 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9996018422120898, 'loss_val': 0.030196418429411797, 'psi': 0.9978370439731707}-{'f1_val': 0.9901193303318852, 'auprc': 0.9988797802590539, 'loss_val': 0.04499302108663007, 'psi': 0.9936235103027526}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=40 head_norm_before_train=2.029966 (no previous merge yet)
[S10] round=40 local utility u=0.000438 metrics={'f1_val': 0.9953900010273877, 'auprc': 0.9962215860531488, 'loss_val': 0.027606362709359004, 'psi': 0.9957226350376922}-{'f1_val': 0.9949509212940392, 'auprc': 0.9969474051522598, 'loss_val': 0.0280246478783546, 'psi': 0.9957495148373274}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=40 head_norm_before_train=2.130455 (no previous merge yet)
[S11] round=40 local utility u=0.016904 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9987212259532652, 'loss_val': 0.026363241330954884, 'psi': 0.9971809752277533}-{'f1_val': 0.995672955508997, 'auprc': 0.9979074614545096, 'loss_val': 0.05484309630284004, 'psi': 0.9965667578872021}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] sending update (kind=head size=1792 to 1 peers)
[S13] START round=40 head_norm_before_train=1.755438 (no previous merge yet)
[S13] round=40 local utility u=0.000000 metrics={'f1_val': 0.6162639528046395, 'auprc': 0.7055602743424491, 'loss_val': 0.7804471680948014, 'psi': 0.6519824814197633}-{'f1_val': 0.6079014244990313, 'auprc': 0.7051230261721415, 'loss_val': 0.7116626622065303, 'psi': 0.6467900651682754}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=40 head_norm_before_train=1.606835 cos_to_last_merge=0.9776 (last merge round=25)
[S14] round=40 local utility u=0.001276 metrics={'f1_val': 0.9974515471354712, 'auprc': 0.9986493142370295, 'loss_val': 0.04223982786566559, 'psi': 0.9979306539760945}-{'f1_val': 0.9969706583433163, 'auprc': 0.9990564547133751, 'loss_val': 0.04312760685448287, 'psi': 0.9978049768913398}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=40 head_norm_before_train=1.417982 cos_to_last_merge=0.9932 (last merge round=30)
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.7671076847074947, 'auprc': 0.9165121201206423, 'loss_val': 0.42667765138716557, 'psi': 0.8268694588727536}-{'f1_val': 0.9955304014918784, 'auprc': 0.9914954189228332, 'loss_val': 0.05202674827083235, 'psi': 0.9939164084642604}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=40 head_norm_before_train=1.398615 cos_to_last_merge=0.9857 (last merge round=29)
[S16] round=40 local utility u=0.000000 metrics={'f1_val': 0.9423140419960915, 'auprc': 0.9883293484865574, 'loss_val': 0.17392676560281015, 'psi': 0.9607201645922778}-{'f1_val': 0.9922388235092688, 'auprc': 0.997882554349402, 'loss_val': 0.05341839877163201, 'psi': 0.9944963158453222}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=40 head_norm_before_train=1.691220 cos_to_last_merge=0.7772 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.777
[S17] round=40 local utility u=1.000000 metrics={'f1_val': 0.7837756726084056, 'auprc': 0.9310862661382485, 'loss_val': 0.38533248174986323, 'psi': 0.8426999100203427}-{'f1_val': 0.5838090753780455, 'auprc': 0.7945563646904881, 'loss_val': 1.0965781763319797, 'psi': 0.6681079911030225}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=41 head_norm_before_train=1.984357 (no previous merge yet)
[S2] round=41 local utility u=0.451140 metrics={'f1_val': 0.9851666706106394, 'auprc': 0.9883210805588722, 'loss_val': 0.09313448251123622, 'psi': 0.9864284345899326}-{'f1_val': 0.8791498981966486, 'auprc': 0.9348214308515019, 'loss_val': 0.19881585399677687, 'psi': 0.90141851125859}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=41 head_norm_before_train=1.727996 cos_to_last_merge=0.9914 (last merge round=31)
[S3] round=41 local utility u=0.000330 metrics={'f1_val': 0.9973956967430226, 'auprc': 0.9989283673038389, 'loss_val': 0.028975823826998745, 'psi': 0.9980087649673491}-{'f1_val': 0.9973982357793907, 'auprc': 0.9987748605491593, 'loss_val': 0.029191489598504664, 'psi': 0.9979488856872982}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] START round=41 head_norm_before_train=1.418754 cos_to_last_merge=0.9761 (last merge round=30)
[S4] round=41 local utility u=0.000000 metrics={'f1_val': 0.940910580962427, 'auprc': 0.9436029502418941, 'loss_val': 0.278226473347434, 'psi': 0.9419875286742138}-{'f1_val': 0.9549683228823256, 'auprc': 0.9590434061323942, 'loss_val': 0.2636595351659386, 'psi': 0.9565983561823531}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=41 head_norm_before_train=1.656522 cos_to_last_merge=0.9789 (last merge round=31)
[S5] round=41 local utility u=0.905962 metrics={'f1_val': 0.666353138128311, 'auprc': 0.8083153585379389, 'loss_val': 0.45052913738871514, 'psi': 0.7231380262921622}-{'f1_val': 0.43660442196719185, 'auprc': 0.8499830208905361, 'loss_val': 1.0089645985617801, 'psi': 0.6019558615365296}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=41 head_norm_before_train=1.532343 cos_to_last_merge=0.9864 (last merge round=29)
[S6] round=41 local utility u=0.497101 metrics={'f1_val': 0.943881485783701, 'auprc': 0.9644623568292516, 'loss_val': 0.20305170084149218, 'psi': 0.9521138342019213}-{'f1_val': 0.8077321447252068, 'auprc': 0.9524289159598398, 'loss_val': 0.34425829601104174, 'psi': 0.8656108532190601}
[S6] not sending this round → trigger blocked (psi=0.952)
[S7] START round=41 head_norm_before_train=1.350733 cos_to_last_merge=0.9816 (last merge round=31)
[S7] round=41 local utility u=0.000000 metrics={'f1_val': 0.5053588985608669, 'auprc': 0.7822121680475906, 'loss_val': 0.8888092270820073, 'psi': 0.6161002063555565}-{'f1_val': 0.5839123872380316, 'auprc': 0.7922122350915437, 'loss_val': 0.7393225939326746, 'psi': 0.6672323263794364}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=41 head_norm_before_train=1.432232 cos_to_last_merge=0.9488 (last merge round=25)
[S8] ⚠️ Model drifted since last merge! cos=0.949
[S8] round=41 local utility u=0.020330 metrics={'f1_val': 0.9950790219939822, 'auprc': 0.9993588683814532, 'loss_val': 0.04899170488292818, 'psi': 0.9967909605489707}-{'f1_val': 0.9926811669910671, 'auprc': 0.9988098142701554, 'loss_val': 0.07361706256384844, 'psi': 0.9951326259027025}
[S8] not sending this round → trigger blocked (psi=0.997)
[S9] START round=41 head_norm_before_train=1.792033 cos_to_last_merge=0.9867 (last merge round=25)
[S9] round=41 local utility u=0.000535 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.999601372048692, 'loss_val': 0.029124056660807567, 'psi': 0.9978368559078117}-{'f1_val': 0.9966605118138915, 'auprc': 0.9996018422120898, 'loss_val': 0.030196418429411797, 'psi': 0.9978370439731707}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=41 head_norm_before_train=2.036664 (no previous merge yet)
[S10] round=41 local utility u=0.000000 metrics={'f1_val': 0.9953900010273877, 'auprc': 0.9960337291091372, 'loss_val': 0.027416126960524468, 'psi': 0.9956474922600875}-{'f1_val': 0.9953900010273877, 'auprc': 0.9962215860531488, 'loss_val': 0.027606362709359004, 'psi': 0.9957226350376922}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=41 head_norm_before_train=2.138445 (no previous merge yet)
[S11] round=41 local utility u=0.000000 metrics={'f1_val': 0.9951279150333554, 'auprc': 0.9980102994613999, 'loss_val': 0.056194448834573404, 'psi': 0.9962808688045731}-{'f1_val': 0.9961541414107454, 'auprc': 0.9987212259532652, 'loss_val': 0.026363241330954884, 'psi': 0.9971809752277533}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=41 head_norm_before_train=1.761984 (no previous merge yet)
[S13] round=41 local utility u=0.079593 metrics={'f1_val': 0.6214736720350036, 'auprc': 0.72079193309965, 'loss_val': 0.6982154257994052, 'psi': 0.6612009764608622}-{'f1_val': 0.6162639528046395, 'auprc': 0.7055602743424491, 'loss_val': 0.7804471680948014, 'psi': 0.6519824814197633}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] sending update (kind=head size=1806 to 1 peers)
[S14] START round=41 head_norm_before_train=1.621372 cos_to_last_merge=0.9765 (last merge round=25)
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.9971364818960446, 'auprc': 0.9989775680832594, 'loss_val': 0.04485942808253199, 'psi': 0.9978729163709306}-{'f1_val': 0.9974515471354712, 'auprc': 0.9986493142370295, 'loss_val': 0.04223982786566559, 'psi': 0.9979306539760945}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=41 head_norm_before_train=1.431345 cos_to_last_merge=0.9926 (last merge round=30)
[S15] round=41 local utility u=0.157340 metrics={'f1_val': 0.775604909473748, 'auprc': 0.9931970081582754, 'loss_val': 0.3930350055681798, 'psi': 0.862641748947559}-{'f1_val': 0.7671076847074947, 'auprc': 0.9165121201206423, 'loss_val': 0.42667765138716557, 'psi': 0.8268694588727536}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] sending update (kind=head size=1804 to 1 peers)
[S16] START round=41 head_norm_before_train=1.413620 cos_to_last_merge=0.9847 (last merge round=29)
[S16] round=41 local utility u=0.218230 metrics={'f1_val': 0.9927351217867696, 'auprc': 0.9921321570585623, 'loss_val': 0.05140107263930372, 'psi': 0.9924939358954866}-{'f1_val': 0.9423140419960915, 'auprc': 0.9883293484865574, 'loss_val': 0.17392676560281015, 'psi': 0.9607201645922778}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=41 head_norm_before_train=1.707240 cos_to_last_merge=0.7760 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.776
[S17] round=41 local utility u=0.000000 metrics={'f1_val': 0.6190890572855777, 'auprc': 0.9376267744529176, 'loss_val': 1.0196978834660406, 'psi': 0.7465041441525138}-{'f1_val': 0.7837756726084056, 'auprc': 0.9310862661382485, 'loss_val': 0.38533248174986323, 'psi': 0.8426999100203427}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=42 head_norm_before_train=1.996824 (no previous merge yet)
[S2] round=42 local utility u=0.018110 metrics={'f1_val': 0.9903056431298127, 'auprc': 0.9859799686324944, 'loss_val': 0.08072563104479595, 'psi': 0.9885753733308854}-{'f1_val': 0.9851666706106394, 'auprc': 0.9883210805588722, 'loss_val': 0.09313448251123622, 'psi': 0.9864284345899326}
[S2] not sending this round → trigger blocked (psi=0.989)
[S3] START round=42 head_norm_before_train=1.747602 cos_to_last_merge=0.9903 (last merge round=31)
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.9618331883652084, 'auprc': 0.997310589188311, 'loss_val': 0.11187951289349572, 'psi': 0.9760241486944494}-{'f1_val': 0.9973956967430226, 'auprc': 0.9989283673038389, 'loss_val': 0.028975823826998745, 'psi': 0.9980087649673491}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=42 head_norm_before_train=1.431281 cos_to_last_merge=0.9736 (last merge round=30)
[S4] round=42 local utility u=0.037011 metrics={'f1_val': 0.9441994739146099, 'auprc': 0.9580668988095082, 'loss_val': 0.267330538257174, 'psi': 0.9497464438725691}-{'f1_val': 0.940910580962427, 'auprc': 0.9436029502418941, 'loss_val': 0.278226473347434, 'psi': 0.9419875286742138}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=42 head_norm_before_train=1.670516 cos_to_last_merge=0.9773 (last merge round=31)
[S5] round=42 local utility u=0.396282 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9622343846328558, 'loss_val': 0.3235271230673982, 'psi': 0.8050861129479577}-{'f1_val': 0.666353138128311, 'auprc': 0.8083153585379389, 'loss_val': 0.45052913738871514, 'psi': 0.7231380262921622}
[S5] not sending this round → trigger blocked (psi=0.805)
[S6] START round=42 head_norm_before_train=1.558546 cos_to_last_merge=0.9848 (last merge round=29)
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.6108944869215874, 'auprc': 0.8995228232220058, 'loss_val': 0.8865829649925269, 'psi': 0.7263458214417549}-{'f1_val': 0.943881485783701, 'auprc': 0.9644623568292516, 'loss_val': 0.20305170084149218, 'psi': 0.9521138342019213}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=42 head_norm_before_train=1.371271 cos_to_last_merge=0.9795 (last merge round=31)
[S7] round=42 local utility u=0.693057 metrics={'f1_val': 0.6511137045385007, 'auprc': 0.816448998021758, 'loss_val': 0.4799341706276453, 'psi': 0.7172478219318037}-{'f1_val': 0.5053588985608669, 'auprc': 0.7822121680475906, 'loss_val': 0.8888092270820073, 'psi': 0.6161002063555565}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=42 head_norm_before_train=1.447998 cos_to_last_merge=0.9470 (last merge round=25)
[S8] ⚠️ Model drifted since last merge! cos=0.947
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.992174240363445, 'auprc': 0.9985809903835784, 'loss_val': 0.06110976056731291, 'psi': 0.9947369403714984}-{'f1_val': 0.9950790219939822, 'auprc': 0.9993588683814532, 'loss_val': 0.04899170488292818, 'psi': 0.9967909605489707}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=42 head_norm_before_train=1.801550 cos_to_last_merge=0.9862 (last merge round=25)
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9995961384154741, 'loss_val': 0.030401798955871105, 'psi': 0.9973344863847009}-{'f1_val': 0.9966605118138915, 'auprc': 0.999601372048692, 'loss_val': 0.029124056660807567, 'psi': 0.9978368559078117}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=42 head_norm_before_train=2.045284 (no previous merge yet)
[S10] round=42 local utility u=0.000000 metrics={'f1_val': 0.9949509212940392, 'auprc': 0.9964681505684763, 'loss_val': 0.02773755482275756, 'psi': 0.9955578130038141}-{'f1_val': 0.9953900010273877, 'auprc': 0.9960337291091372, 'loss_val': 0.027416126960524468, 'psi': 0.9956474922600875}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=42 head_norm_before_train=2.146325 (no previous merge yet)
[S11] round=42 local utility u=0.021516 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9987212701716525, 'loss_val': 0.023955185286177422, 'psi': 0.9974312569359357}-{'f1_val': 0.9951279150333554, 'auprc': 0.9980102994613999, 'loss_val': 0.056194448834573404, 'psi': 0.9962808688045731}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] sending update (kind=head size=1804 to 1 peers)
[S13] START round=42 head_norm_before_train=1.768937 (no previous merge yet)
[S13] round=42 local utility u=0.000000 metrics={'f1_val': 0.6397976296083752, 'auprc': 0.5945604561313421, 'loss_val': 0.7604701323316575, 'psi': 0.621702760217562}-{'f1_val': 0.6214736720350036, 'auprc': 0.72079193309965, 'loss_val': 0.6982154257994052, 'psi': 0.6612009764608622}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=42 head_norm_before_train=1.635052 cos_to_last_merge=0.9754 (last merge round=25)
[S14] round=42 local utility u=0.000000 metrics={'f1_val': 0.9484816499468509, 'auprc': 0.9985657273113882, 'loss_val': 0.09753186643451538, 'psi': 0.9685152808926658}-{'f1_val': 0.9971364818960446, 'auprc': 0.9989775680832594, 'loss_val': 0.04485942808253199, 'psi': 0.9978729163709306}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=42 head_norm_before_train=1.444154 cos_to_last_merge=0.9919 (last merge round=30)
[S15] round=42 local utility u=0.173114 metrics={'f1_val': 0.818097064726722, 'auprc': 0.9900508042021139, 'loss_val': 0.29232102980463825, 'psi': 0.8868785605168787}-{'f1_val': 0.775604909473748, 'auprc': 0.9931970081582754, 'loss_val': 0.3930350055681798, 'psi': 0.862641748947559}
[S15] not sending this round → trigger blocked (psi=0.887)
[S16] START round=42 head_norm_before_train=1.429049 cos_to_last_merge=0.9836 (last merge round=29)
[S16] round=42 local utility u=0.004542 metrics={'f1_val': 0.9920933441588928, 'auprc': 0.9947051338184174, 'loss_val': 0.04618593845746263, 'psi': 0.9931380600227027}-{'f1_val': 0.9927351217867696, 'auprc': 0.9921321570585623, 'loss_val': 0.05140107263930372, 'psi': 0.9924939358954866}
[S16] not sending this round → trigger blocked (psi=0.993)
[S17] START round=42 head_norm_before_train=1.718593 cos_to_last_merge=0.7752 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.775
[S17] round=42 local utility u=0.177354 metrics={'f1_val': 0.6437131185112273, 'auprc': 0.9666618084029722, 'loss_val': 0.8998389235623873, 'psi': 0.7728925944679252}-{'f1_val': 0.6190890572855777, 'auprc': 0.9376267744529176, 'loss_val': 1.0196978834660406, 'psi': 0.7465041441525138}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S2] START round=43 head_norm_before_train=2.008884 (no previous merge yet)
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.7865150793960147, 'auprc': 0.7940498089282314, 'loss_val': 0.3925934822234743, 'psi': 0.7895289712089014}-{'f1_val': 0.9903056431298127, 'auprc': 0.9859799686324944, 'loss_val': 0.08072563104479595, 'psi': 0.9885753733308854}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=43 head_norm_before_train=1.766189 cos_to_last_merge=0.9893 (last merge round=31)
[S3] round=43 local utility u=0.154309 metrics={'f1_val': 0.9977814963782642, 'auprc': 0.9987613813192173, 'loss_val': 0.023304093602423415, 'psi': 0.9981734503546456}-{'f1_val': 0.9618331883652084, 'auprc': 0.997310589188311, 'loss_val': 0.11187951289349572, 'psi': 0.9760241486944494}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] sending update (kind=head size=1805 to 1 peers)
[S4] START round=43 head_norm_before_train=1.441635 cos_to_last_merge=0.9714 (last merge round=30)
[S4] round=43 local utility u=0.009599 metrics={'f1_val': 0.9427442160210601, 'auprc': 0.9685282206217529, 'loss_val': 0.27078439429361006, 'psi': 0.9530578178613373}-{'f1_val': 0.9441994739146099, 'auprc': 0.9580668988095082, 'loss_val': 0.267330538257174, 'psi': 0.9497464438725691}
[S4] not sending this round → trigger blocked (psi=0.953)
[S5] START round=43 head_norm_before_train=1.681990 cos_to_last_merge=0.9758 (last merge round=31)
[S5] round=43 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9039983168908275, 'loss_val': 0.37977490567501065, 'psi': 0.7817916858511464}-{'f1_val': 0.700320598491359, 'auprc': 0.9622343846328558, 'loss_val': 0.3235271230673982, 'psi': 0.8050861129479577}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=43 head_norm_before_train=1.577469 cos_to_last_merge=0.9835 (last merge round=29)
[S6] round=43 local utility u=0.983590 metrics={'f1_val': 0.8241387711916774, 'auprc': 0.952174441033295, 'loss_val': 0.3568232579902349, 'psi': 0.8753530391283244}-{'f1_val': 0.6108944869215874, 'auprc': 0.8995228232220058, 'loss_val': 0.8865829649925269, 'psi': 0.7263458214417549}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=43 head_norm_before_train=1.392523 cos_to_last_merge=0.9772 (last merge round=31)
[S7] round=43 local utility u=0.000000 metrics={'f1_val': 0.6291088842730473, 'auprc': 0.8041005565697998, 'loss_val': 0.6415368741011978, 'psi': 0.6991055531917484}-{'f1_val': 0.6511137045385007, 'auprc': 0.816448998021758, 'loss_val': 0.4799341706276453, 'psi': 0.7172478219318037}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=43 head_norm_before_train=1.462432 cos_to_last_merge=0.9453 (last merge round=25)
[S8] ⚠️ Model drifted since last merge! cos=0.945
[S8] round=43 local utility u=0.017012 metrics={'f1_val': 0.9943590272655265, 'auprc': 0.999191389085019, 'loss_val': 0.042025702923015336, 'psi': 0.9962919719933235}-{'f1_val': 0.992174240363445, 'auprc': 0.9985809903835784, 'loss_val': 0.06110976056731291, 'psi': 0.9947369403714984}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[S9] START round=43 head_norm_before_train=1.810675 cos_to_last_merge=0.9856 (last merge round=25)
[S9] round=43 local utility u=0.004154 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9996014114097104, 'loss_val': 0.027113367845858327, 'psi': 0.997836871652219}-{'f1_val': 0.9958267183641853, 'auprc': 0.9995961384154741, 'loss_val': 0.030401798955871105, 'psi': 0.9973344863847009}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=43 head_norm_before_train=2.050351 (no previous merge yet)
[S10] round=43 local utility u=0.000239 metrics={'f1_val': 0.9951704237150173, 'auprc': 0.9960277562865635, 'loss_val': 0.027256046147525404, 'psi': 0.9955133567436357}-{'f1_val': 0.9949509212940392, 'auprc': 0.9964681505684763, 'loss_val': 0.02773755482275756, 'psi': 0.9955578130038141}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[S11] START round=43 head_norm_before_train=2.153210 (no previous merge yet)
[S11] round=43 local utility u=0.000587 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9989619554403874, 'loss_val': 0.021001560418022223, 'psi': 0.9972772670226022}-{'f1_val': 0.9965712481121245, 'auprc': 0.9987212701716525, 'loss_val': 0.023955185286177422, 'psi': 0.9974312569359357}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=43 head_norm_before_train=1.774771 (no previous merge yet)
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.5862437311726555, 'auprc': 0.7234944326092648, 'loss_val': 1.0491778311653888, 'psi': 0.6411440117472993}-{'f1_val': 0.6397976296083752, 'auprc': 0.5945604561313421, 'loss_val': 0.7604701323316575, 'psi': 0.621702760217562}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=43 head_norm_before_train=1.646487 cos_to_last_merge=0.9748 (last merge round=25)
[S14] round=43 local utility u=0.176486 metrics={'f1_val': 0.9969706583433163, 'auprc': 0.9989759291954735, 'loss_val': 0.036724932577336715, 'psi': 0.9977727666841792}-{'f1_val': 0.9484816499468509, 'auprc': 0.9985657273113882, 'loss_val': 0.09753186643451538, 'psi': 0.9685152808926658}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=43 head_norm_before_train=1.455149 cos_to_last_merge=0.9913 (last merge round=30)
[S15] round=43 local utility u=0.672799 metrics={'f1_val': 0.9963164379542544, 'auprc': 0.9963297038978329, 'loss_val': 0.03487604515078392, 'psi': 0.9963217443316859}-{'f1_val': 0.818097064726722, 'auprc': 0.9900508042021139, 'loss_val': 0.29232102980463825, 'psi': 0.8868785605168787}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] START round=43 head_norm_before_train=1.443143 cos_to_last_merge=0.9828 (last merge round=29)
[S16] round=43 local utility u=0.008723 metrics={'f1_val': 0.9931629591930706, 'auprc': 0.9980556515425538, 'loss_val': 0.045208477405875754, 'psi': 0.9951200361328638}-{'f1_val': 0.9920933441588928, 'auprc': 0.9947051338184174, 'loss_val': 0.04618593845746263, 'psi': 0.9931380600227027}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] sending update (kind=head size=1792 to 1 peers)
[S17] START round=43 head_norm_before_train=1.727008 cos_to_last_merge=0.7742 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.774
[S17] round=43 local utility u=0.287871 metrics={'f1_val': 0.6880932384842401, 'auprc': 0.9717338617989155, 'loss_val': 0.6055933070837016, 'psi': 0.8015494878101103}-{'f1_val': 0.6437131185112273, 'auprc': 0.9666618084029722, 'loss_val': 0.8998389235623873, 'psi': 0.7728925944679252}
[S17] not sending this round → trigger blocked (psi=0.802)
[S2] START round=44 head_norm_before_train=2.019243 (no previous merge yet)
[S2] round=44 local utility u=1.000000 metrics={'f1_val': 0.9815613119733404, 'auprc': 0.9885493897109705, 'loss_val': 0.08728478205016522, 'psi': 0.9843565430683925}-{'f1_val': 0.7865150793960147, 'auprc': 0.7940498089282314, 'loss_val': 0.3925934822234743, 'psi': 0.7895289712089014}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=44 head_norm_before_train=1.782160 cos_to_last_merge=0.9884 (last merge round=31)
[S3] round=44 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9988771225666495, 'loss_val': 0.14123732713893447, 'psi': 0.976171999689926}-{'f1_val': 0.9977814963782642, 'auprc': 0.9987613813192173, 'loss_val': 0.023304093602423415, 'psi': 0.9981734503546456}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=44 head_norm_before_train=1.452478 cos_to_last_merge=0.9700 (last merge round=30)
[S4] round=44 local utility u=0.050768 metrics={'f1_val': 0.9521810115196419, 'auprc': 0.9789139165513028, 'loss_val': 0.2570271543537688, 'psi': 0.9628741735323062}-{'f1_val': 0.9427442160210601, 'auprc': 0.9685282206217529, 'loss_val': 0.27078439429361006, 'psi': 0.9530578178613373}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=44 head_norm_before_train=1.692047 cos_to_last_merge=0.9744 (last merge round=31)
[S5] round=44 local utility u=0.308405 metrics={'f1_val': 0.7508379277415307, 'auprc': 0.9702030185807534, 'loss_val': 0.26468366367101115, 'psi': 0.8385839640772198}-{'f1_val': 0.700320598491359, 'auprc': 0.9039983168908275, 'loss_val': 0.37977490567501065, 'psi': 0.7817916858511464}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S5] sending update (kind=head size=1809 to 1 peers)
[S6] START round=44 head_norm_before_train=1.592502 cos_to_last_merge=0.9825 (last merge round=29)
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.7590823748838219, 'auprc': 0.9436218341503332, 'loss_val': 0.5896548127372305, 'psi': 0.8328981585904265}-{'f1_val': 0.8241387711916774, 'auprc': 0.952174441033295, 'loss_val': 0.3568232579902349, 'psi': 0.8753530391283244}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=44 head_norm_before_train=1.408212 cos_to_last_merge=0.9754 (last merge round=31)
[S7] round=44 local utility u=0.573410 metrics={'f1_val': 0.6950711351349059, 'auprc': 0.9245326903125055, 'loss_val': 0.2517874403454771, 'psi': 0.7868557572059458}-{'f1_val': 0.6291088842730473, 'auprc': 0.8041005565697998, 'loss_val': 0.6415368741011978, 'psi': 0.6991055531917484}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=44 head_norm_before_train=1.477574 cos_to_last_merge=0.9437 (last merge round=25)
[S8] ⚠️ Model drifted since last merge! cos=0.944
[S8] round=44 local utility u=0.000351 metrics={'f1_val': 0.994352627176911, 'auprc': 0.9993769066291717, 'loss_val': 0.04184208610113838, 'psi': 0.9963623389578153}-{'f1_val': 0.9943590272655265, 'auprc': 0.999191389085019, 'loss_val': 0.042025702923015336, 'psi': 0.9962919719933235}
[S8] not sending this round → trigger blocked (psi=0.996)
[S9] START round=44 head_norm_before_train=1.820372 cos_to_last_merge=0.9850 (last merge round=25)
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.9959775008625639, 'auprc': 0.9995951363390406, 'loss_val': 0.02833899018562302, 'psi': 0.9974245550531545}-{'f1_val': 0.9966605118138915, 'auprc': 0.9996014114097104, 'loss_val': 0.027113367845858327, 'psi': 0.997836871652219}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=44 head_norm_before_train=2.057234 (no previous merge yet)
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9955858454310109, 'loss_val': 0.026836241733941942, 'psi': 0.9953470415840292}-{'f1_val': 0.9951704237150173, 'auprc': 0.9960277562865635, 'loss_val': 0.027256046147525404, 'psi': 0.9955133567436357}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=44 head_norm_before_train=2.159014 (no previous merge yet)
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.995672955508997, 'auprc': 0.9989604430435693, 'loss_val': 0.021153764102708906, 'psi': 0.996987950522826}-{'f1_val': 0.9961541414107454, 'auprc': 0.9989619554403874, 'loss_val': 0.021001560418022223, 'psi': 0.9972772670226022}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=44 head_norm_before_train=1.775782 (no previous merge yet)
[S13] round=44 local utility u=0.176181 metrics={'f1_val': 0.5803126374059747, 'auprc': 0.7655896442068819, 'loss_val': 0.7875149024433263, 'psi': 0.6544234401263376}-{'f1_val': 0.5862437311726555, 'auprc': 0.7234944326092648, 'loss_val': 1.0491778311653888, 'psi': 0.6411440117472993}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=44 head_norm_before_train=1.658241 cos_to_last_merge=0.9739 (last merge round=25)
[S14] round=44 local utility u=0.000830 metrics={'f1_val': 0.9969459252103519, 'auprc': 0.9989799517158485, 'loss_val': 0.03492816400751055, 'psi': 0.9977595358125506}-{'f1_val': 0.9969706583433163, 'auprc': 0.9989759291954735, 'loss_val': 0.036724932577336715, 'psi': 0.9977727666841792}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=44 head_norm_before_train=1.468141 cos_to_last_merge=0.9906 (last merge round=30)
[S15] round=44 local utility u=0.002078 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9962560089611276, 'loss_val': 0.0330810301565404, 'psi': 0.9965504046169634}-{'f1_val': 0.9963164379542544, 'auprc': 0.9963297038978329, 'loss_val': 0.03487604515078392, 'psi': 0.9963217443316859}
[S15] not sending this round → trigger blocked (psi=0.997)
[S16] START round=44 head_norm_before_train=1.456040 cos_to_last_merge=0.9819 (last merge round=29)
[S16] round=44 local utility u=0.000000 metrics={'f1_val': 0.9922873425508638, 'auprc': 0.9980055310769462, 'loss_val': 0.04612128301885613, 'psi': 0.9945746179612969}-{'f1_val': 0.9931629591930706, 'auprc': 0.9980556515425538, 'loss_val': 0.045208477405875754, 'psi': 0.9951200361328638}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=44 head_norm_before_train=1.737990 cos_to_last_merge=0.7730 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.773
[S17] round=44 local utility u=0.000000 metrics={'f1_val': 0.4636793704824601, 'auprc': 0.7322724496403152, 'loss_val': 1.469774645172645, 'psi': 0.5711166021456022}-{'f1_val': 0.6880932384842401, 'auprc': 0.9717338617989155, 'loss_val': 0.6055933070837016, 'psi': 0.8015494878101103}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=45 head_norm_before_train=2.028629 (no previous merge yet)
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.8261232711652122, 'auprc': 0.9630010317380092, 'loss_val': 0.3094384323833654, 'psi': 0.8808743753943311}-{'f1_val': 0.9815613119733404, 'auprc': 0.9885493897109705, 'loss_val': 0.08728478205016522, 'psi': 0.9843565430683925}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=45 head_norm_before_train=1.795636 cos_to_last_merge=0.9877 (last merge round=31)
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.843667581284049, 'auprc': 0.9956547848767763, 'loss_val': 0.2512621098566346, 'psi': 0.9044624627211398}-{'f1_val': 0.9610352511054436, 'auprc': 0.9988771225666495, 'loss_val': 0.14123732713893447, 'psi': 0.976171999689926}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=45 head_norm_before_train=1.464735 cos_to_last_merge=0.9687 (last merge round=30)
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.9425353651959157, 'auprc': 0.9611518820422582, 'loss_val': 0.2709902011241969, 'psi': 0.9499819719344527}-{'f1_val': 0.9521810115196419, 'auprc': 0.9789139165513028, 'loss_val': 0.2570271543537688, 'psi': 0.9628741735323062}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=45 head_norm_before_train=1.700251 cos_to_last_merge=0.9731 (last merge round=31)
[S5] round=45 local utility u=0.000000 metrics={'f1_val': 0.43676623050537206, 'auprc': 0.8551393307577564, 'loss_val': 1.1508209349500191, 'psi': 0.6041154706063259}-{'f1_val': 0.7508379277415307, 'auprc': 0.9702030185807534, 'loss_val': 0.26468366367101115, 'psi': 0.8385839640772198}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=45 head_norm_before_train=1.605819 cos_to_last_merge=0.9815 (last merge round=29)
[S6] round=45 local utility u=0.398461 metrics={'f1_val': 0.8301711530198569, 'auprc': 0.9684889595445628, 'loss_val': 0.29386586196622816, 'psi': 0.8854982756297393}-{'f1_val': 0.7590823748838219, 'auprc': 0.9436218341503332, 'loss_val': 0.5896548127372305, 'psi': 0.8328981585904265}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] START round=45 head_norm_before_train=1.416619 cos_to_last_merge=0.9746 (last merge round=31)
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.3994175252810537, 'auprc': 0.6419812750809022, 'loss_val': 1.497363318349245, 'psi': 0.49644302520099304}-{'f1_val': 0.6950711351349059, 'auprc': 0.9245326903125055, 'loss_val': 0.2517874403454771, 'psi': 0.7868557572059458}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=45 head_norm_before_train=1.487981 cos_to_last_merge=0.9426 (last merge round=25)
[S8] ⚠️ Model drifted since last merge! cos=0.943
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.9857167178610293, 'auprc': 0.9984187553780173, 'loss_val': 0.0878894135997488, 'psi': 0.9907975328678245}-{'f1_val': 0.994352627176911, 'auprc': 0.9993769066291717, 'loss_val': 0.04184208610113838, 'psi': 0.9963623389578153}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=45 head_norm_before_train=1.829438 cos_to_last_merge=0.9845 (last merge round=25)
[S9] round=45 local utility u=0.002371 metrics={'f1_val': 0.9963953425060355, 'auprc': 0.999591949122344, 'loss_val': 0.02609358758143949, 'psi': 0.9976739851525589}-{'f1_val': 0.9959775008625639, 'auprc': 0.9995951363390406, 'loss_val': 0.02833899018562302, 'psi': 0.9974245550531545}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=45 head_norm_before_train=2.065568 (no previous merge yet)
[S10] round=45 local utility u=0.000852 metrics={'f1_val': 0.9951704237150173, 'auprc': 0.9961480785113488, 'loss_val': 0.02671463222849411, 'psi': 0.9955614856335498}-{'f1_val': 0.9951878390193748, 'auprc': 0.9955858454310109, 'loss_val': 0.026836241733941942, 'psi': 0.9953470415840292}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=45 head_norm_before_train=2.164667 (no previous merge yet)
[S11] round=45 local utility u=0.001782 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9989638594035597, 'loss_val': 0.020487349805679556, 'psi': 0.9972780286078711}-{'f1_val': 0.995672955508997, 'auprc': 0.9989604430435693, 'loss_val': 0.021153764102708906, 'psi': 0.996987950522826}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=45 head_norm_before_train=1.776164 (no previous merge yet)
[S13] round=45 local utility u=0.000000 metrics={'f1_val': 0.6043528142428547, 'auprc': 0.7307667984735372, 'loss_val': 0.8811887853176965, 'psi': 0.6549184079351277}-{'f1_val': 0.5803126374059747, 'auprc': 0.7655896442068819, 'loss_val': 0.7875149024433263, 'psi': 0.6544234401263376}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=45 head_norm_before_train=1.669937 cos_to_last_merge=0.9727 (last merge round=25)
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.934834564400547, 'auprc': 0.998485191301393, 'loss_val': 0.17646990314256175, 'psi': 0.9602948151608854}-{'f1_val': 0.9969459252103519, 'auprc': 0.9989799517158485, 'loss_val': 0.03492816400751055, 'psi': 0.9977595358125506}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=45 head_norm_before_train=1.478925 cos_to_last_merge=0.9901 (last merge round=30)
[S15] round=45 local utility u=0.000000 metrics={'f1_val': 0.700957864484732, 'auprc': 0.8095776422907466, 'loss_val': 0.5789075884539961, 'psi': 0.7444057756071378}-{'f1_val': 0.9967466683875206, 'auprc': 0.9962560089611276, 'loss_val': 0.0330810301565404, 'psi': 0.9965504046169634}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=45 head_norm_before_train=1.469188 cos_to_last_merge=0.9811 (last merge round=29)
[S16] round=45 local utility u=0.000000 metrics={'f1_val': 0.9898460133232493, 'auprc': 0.995356060691938, 'loss_val': 0.059838410815114, 'psi': 0.9920500322707249}-{'f1_val': 0.9922873425508638, 'auprc': 0.9980055310769462, 'loss_val': 0.04612128301885613, 'psi': 0.9945746179612969}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=45 head_norm_before_train=1.745493 cos_to_last_merge=0.7722 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.772
[S17] round=45 local utility u=0.903502 metrics={'f1_val': 0.5952137917737891, 'auprc': 0.972310538213349, 'loss_val': 1.1720910227269703, 'psi': 0.7460524903496131}-{'f1_val': 0.4636793704824601, 'auprc': 0.7322724496403152, 'loss_val': 1.469774645172645, 'psi': 0.5711166021456022}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=46 head_norm_before_train=2.039027 (no previous merge yet)
[S2] round=46 local utility u=0.656084 metrics={'f1_val': 0.9893521203376685, 'auprc': 0.9875912514474811, 'loss_val': 0.050413479804343346, 'psi': 0.9886477727815935}-{'f1_val': 0.8261232711652122, 'auprc': 0.9630010317380092, 'loss_val': 0.3094384323833654, 'psi': 0.8808743753943311}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] sending update (kind=head size=1794 to 1 peers)
[S3] START round=46 head_norm_before_train=1.805843 cos_to_last_merge=0.9871 (last merge round=31)
[S3] round=46 local utility u=0.566720 metrics={'f1_val': 0.9965780488688143, 'auprc': 0.9992732860327184, 'loss_val': 0.04614058042740824, 'psi': 0.9976561437343758}-{'f1_val': 0.843667581284049, 'auprc': 0.9956547848767763, 'loss_val': 0.2512621098566346, 'psi': 0.9044624627211398}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=46 head_norm_before_train=1.477983 cos_to_last_merge=0.9673 (last merge round=30)
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.9379953620351634, 'auprc': 0.9225509631863636, 'loss_val': 0.2997962523355371, 'psi': 0.9318176024956435}-{'f1_val': 0.9425353651959157, 'auprc': 0.9611518820422582, 'loss_val': 0.2709902011241969, 'psi': 0.9499819719344527}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=46 head_norm_before_train=1.709113 cos_to_last_merge=0.9720 (last merge round=31)
[S5] round=46 local utility u=0.818165 metrics={'f1_val': 0.6052428536936504, 'auprc': 0.8658650235150647, 'loss_val': 0.5575284999151022, 'psi': 0.7094917216222161}-{'f1_val': 0.43676623050537206, 'auprc': 0.8551393307577564, 'loss_val': 1.1508209349500191, 'psi': 0.6041154706063259}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=46 head_norm_before_train=1.618582 cos_to_last_merge=0.9806 (last merge round=29)
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.7444059092715799, 'auprc': 0.8885492026796038, 'loss_val': 0.7274378251319966, 'psi': 0.8020632266347895}-{'f1_val': 0.8301711530198569, 'auprc': 0.9684889595445628, 'loss_val': 0.29386586196622816, 'psi': 0.8854982756297393}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=46 head_norm_before_train=1.413970 cos_to_last_merge=0.9753 (last merge round=31)
[S7] round=46 local utility u=1.000000 metrics={'f1_val': 0.6813721919484759, 'auprc': 0.8441370508279633, 'loss_val': 0.40827917684532483, 'psi': 0.7464781355002708}-{'f1_val': 0.3994175252810537, 'auprc': 0.6419812750809022, 'loss_val': 1.497363318349245, 'psi': 0.49644302520099304}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=46 head_norm_before_train=1.497237 cos_to_last_merge=0.9417 (last merge round=25)
[S8] ⚠️ Model drifted since last merge! cos=0.942
[S8] round=46 local utility u=0.007984 metrics={'f1_val': 0.98543771888248, 'auprc': 0.9981992654961594, 'loss_val': 0.06958839326106614, 'psi': 0.9905423375279518}-{'f1_val': 0.9857167178610293, 'auprc': 0.9984187553780173, 'loss_val': 0.0878894135997488, 'psi': 0.9907975328678245}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=46 head_norm_before_train=1.838549 cos_to_last_merge=0.9839 (last merge round=25)
[S9] round=46 local utility u=0.001545 metrics={'f1_val': 0.996808967411047, 'auprc': 0.999586751719507, 'loss_val': 0.025469998051089085, 'psi': 0.997920081134431}-{'f1_val': 0.9963953425060355, 'auprc': 0.999591949122344, 'loss_val': 0.02609358758143949, 'psi': 0.9976739851525589}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=46 head_norm_before_train=2.074424 (no previous merge yet)
[S10] round=46 local utility u=0.000172 metrics={'f1_val': 0.9953900010273877, 'auprc': 0.9957559625206531, 'loss_val': 0.026511503602912115, 'psi': 0.9955363856246939}-{'f1_val': 0.9951704237150173, 'auprc': 0.9961480785113488, 'loss_val': 0.02671463222849411, 'psi': 0.9955614856335498}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=46 head_norm_before_train=2.171643 (no previous merge yet)
[S11] round=46 local utility u=0.000000 metrics={'f1_val': 0.9855898256676696, 'auprc': 0.9969740033143376, 'loss_val': 0.09721855125952267, 'psi': 0.9901434967263368}-{'f1_val': 0.9961541414107454, 'auprc': 0.9989638594035597, 'loss_val': 0.020487349805679556, 'psi': 0.9972780286078711}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=46 head_norm_before_train=1.779036 (no previous merge yet)
[S13] round=46 local utility u=0.145390 metrics={'f1_val': 0.6401863357958429, 'auprc': 0.730533929803595, 'loss_val': 0.8047104346662853, 'psi': 0.6763253733989437}-{'f1_val': 0.6043528142428547, 'auprc': 0.7307667984735372, 'loss_val': 0.8811887853176965, 'psi': 0.6549184079351277}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=46 head_norm_before_train=1.682179 cos_to_last_merge=0.9716 (last merge round=25)
[S14] round=46 local utility u=0.105820 metrics={'f1_val': 0.9566630124501271, 'auprc': 0.998939457442743, 'loss_val': 0.09716362800620708, 'psi': 0.9735735904471734}-{'f1_val': 0.934834564400547, 'auprc': 0.998485191301393, 'loss_val': 0.17646990314256175, 'psi': 0.9602948151608854}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=46 head_norm_before_train=1.487913 cos_to_last_merge=0.9897 (last merge round=30)
[S15] round=46 local utility u=1.000000 metrics={'f1_val': 0.9963164379542544, 'auprc': 0.9901166732247132, 'loss_val': 0.03411305650211876, 'psi': 0.9938365320624379}-{'f1_val': 0.700957864484732, 'auprc': 0.8095776422907466, 'loss_val': 0.5789075884539961, 'psi': 0.7444057756071378}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] sending update (kind=head size=1803 to 1 peers)
[S16] START round=46 head_norm_before_train=1.482129 cos_to_last_merge=0.9802 (last merge round=29)
[S16] round=46 local utility u=0.002570 metrics={'f1_val': 0.991135601342498, 'auprc': 0.9930054664636334, 'loss_val': 0.05538473881172205, 'psi': 0.9918835473909522}-{'f1_val': 0.9898460133232493, 'auprc': 0.995356060691938, 'loss_val': 0.059838410815114, 'psi': 0.9920500322707249}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=46 head_norm_before_train=1.750911 cos_to_last_merge=0.7719 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.772
[S17] round=46 local utility u=0.940474 metrics={'f1_val': 0.7826106361911607, 'auprc': 0.9726160657855273, 'loss_val': 0.4164409951251137, 'psi': 0.8586128080289073}-{'f1_val': 0.5952137917737891, 'auprc': 0.972310538213349, 'loss_val': 1.1720910227269703, 'psi': 0.7460524903496131}
[S17] not sending this round → trigger blocked (psi=0.859)
[S2] START round=47 head_norm_before_train=2.051731 (no previous merge yet)
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.8569028207443662, 'auprc': 0.9754900533048774, 'loss_val': 0.28605023303811056, 'psi': 0.9043377137685706}-{'f1_val': 0.9893521203376685, 'auprc': 0.9875912514474811, 'loss_val': 0.050413479804343346, 'psi': 0.9886477727815935}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=47 head_norm_before_train=1.813949 cos_to_last_merge=0.9866 (last merge round=31)
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.9351482796084434, 'auprc': 0.9990090013592344, 'loss_val': 0.17231242819370277, 'psi': 0.9606925683087598}-{'f1_val': 0.9965780488688143, 'auprc': 0.9992732860327184, 'loss_val': 0.04614058042740824, 'psi': 0.9976561437343758}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=47 head_norm_before_train=1.490697 cos_to_last_merge=0.9659 (last merge round=30)
[S4] round=47 local utility u=0.020059 metrics={'f1_val': 0.9396328875766342, 'auprc': 0.9296983414746445, 'loss_val': 0.29094647272878066, 'psi': 0.9356590691358383}-{'f1_val': 0.9379953620351634, 'auprc': 0.9225509631863636, 'loss_val': 0.2997962523355371, 'psi': 0.9318176024956435}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S4] sending update (kind=head size=1807 to 1 peers)
[S5] START round=47 head_norm_before_train=1.716732 cos_to_last_merge=0.9712 (last merge round=31)
[S5] round=47 local utility u=0.000000 metrics={'f1_val': 0.43213421050549483, 'auprc': 0.8357030717804371, 'loss_val': 1.0793480351771703, 'psi': 0.5935617550154717}-{'f1_val': 0.6052428536936504, 'auprc': 0.8658650235150647, 'loss_val': 0.5575284999151022, 'psi': 0.7094917216222161}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=47 head_norm_before_train=1.628890 cos_to_last_merge=0.9798 (last merge round=29)
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.5643657664450447, 'auprc': 0.8131539645144792, 'loss_val': 0.7614213141718368, 'psi': 0.6638810456728185}-{'f1_val': 0.7444059092715799, 'auprc': 0.8885492026796038, 'loss_val': 0.7274378251319966, 'psi': 0.8020632266347895}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=47 head_norm_before_train=1.412671 cos_to_last_merge=0.9757 (last merge round=31)
[S7] round=47 local utility u=0.000000 metrics={'f1_val': 0.679350454589905, 'auprc': 0.8416141237779571, 'loss_val': 0.3983814273791053, 'psi': 0.7442559222651258}-{'f1_val': 0.6813721919484759, 'auprc': 0.8441370508279633, 'loss_val': 0.40827917684532483, 'psi': 0.7464781355002708}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=47 head_norm_before_train=1.506099 cos_to_last_merge=0.9409 (last merge round=25)
[S8] ⚠️ Model drifted since last merge! cos=0.941
[S8] round=47 local utility u=0.031969 metrics={'f1_val': 0.9925289693239863, 'auprc': 0.9985690767599666, 'loss_val': 0.04930721846249223, 'psi': 0.9949450122983784}-{'f1_val': 0.98543771888248, 'auprc': 0.9981992654961594, 'loss_val': 0.06958839326106614, 'psi': 0.9905423375279518}
[S8] not sending this round → trigger blocked (psi=0.995)
[S9] START round=47 head_norm_before_train=1.847096 cos_to_last_merge=0.9833 (last merge round=25)
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.9901193303318852, 'auprc': 0.9990246769013246, 'loss_val': 0.0394647629574684, 'psi': 0.9936814689596609}-{'f1_val': 0.996808967411047, 'auprc': 0.999586751719507, 'loss_val': 0.025469998051089085, 'psi': 0.997920081134431}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=47 head_norm_before_train=2.083559 (no previous merge yet)
[S10] round=47 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9955709832670709, 'loss_val': 0.02635704225517206, 'psi': 0.9953410967184533}-{'f1_val': 0.9953900010273877, 'auprc': 0.9957559625206531, 'loss_val': 0.026511503602912115, 'psi': 0.9955363856246939}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=47 head_norm_before_train=2.178269 (no previous merge yet)
[S11] round=47 local utility u=0.073642 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9990474893795862, 'loss_val': 0.019540395913277768, 'psi': 0.9973114805982817}-{'f1_val': 0.9855898256676696, 'auprc': 0.9969740033143376, 'loss_val': 0.09721855125952267, 'psi': 0.9901434967263368}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=47 head_norm_before_train=1.781929 (no previous merge yet)
[S13] round=47 local utility u=0.405073 metrics={'f1_val': 0.7203241992597054, 'auprc': 0.7830161521187143, 'loss_val': 0.6328389282917407, 'psi': 0.745400980403309}-{'f1_val': 0.6401863357958429, 'auprc': 0.730533929803595, 'loss_val': 0.8047104346662853, 'psi': 0.6763253733989437}
[S13] not sending this round → trigger blocked (psi=0.745)
[S14] START round=47 head_norm_before_train=1.692192 cos_to_last_merge=0.9705 (last merge round=25)
[S14] round=47 local utility u=0.153247 metrics={'f1_val': 0.9969706583433163, 'auprc': 0.9989792823936313, 'loss_val': 0.03263409025482108, 'psi': 0.9977741079634423}-{'f1_val': 0.9566630124501271, 'auprc': 0.998939457442743, 'loss_val': 0.09716362800620708, 'psi': 0.9735735904471734}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=47 head_norm_before_train=1.494972 cos_to_last_merge=0.9893 (last merge round=30)
[S15] round=47 local utility u=0.000000 metrics={'f1_val': 0.9077613091362882, 'auprc': 0.9900107316353002, 'loss_val': 0.1334895520237744, 'psi': 0.940661078135893}-{'f1_val': 0.9963164379542544, 'auprc': 0.9901166732247132, 'loss_val': 0.03411305650211876, 'psi': 0.9938365320624379}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=47 head_norm_before_train=1.493669 cos_to_last_merge=0.9794 (last merge round=29)
[S16] round=47 local utility u=0.000000 metrics={'f1_val': 0.8777943645430472, 'auprc': 0.9890309647095527, 'loss_val': 0.3329737327510395, 'psi': 0.9222890046096494}-{'f1_val': 0.991135601342498, 'auprc': 0.9930054664636334, 'loss_val': 0.05538473881172205, 'psi': 0.9918835473909522}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=47 head_norm_before_train=1.755728 cos_to_last_merge=0.7716 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.772
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.5776543143021924, 'auprc': 0.8025041447757517, 'loss_val': 1.0115031507581267, 'psi': 0.6675942464916161}-{'f1_val': 0.7826106361911607, 'auprc': 0.9726160657855273, 'loss_val': 0.4164409951251137, 'psi': 0.8586128080289073}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=48 head_norm_before_train=2.055463 (no previous merge yet)
[S2] round=48 local utility u=0.202150 metrics={'f1_val': 0.9021741806397428, 'auprc': 0.9804988841517359, 'loss_val': 0.16840500759777907, 'psi': 0.93350406204454}-{'f1_val': 0.8569028207443662, 'auprc': 0.9754900533048774, 'loss_val': 0.28605023303811056, 'psi': 0.9043377137685706}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=48 head_norm_before_train=1.822839 cos_to_last_merge=0.9861 (last merge round=31)
[S3] round=48 local utility u=0.000000 metrics={'f1_val': 0.8779375823492565, 'auprc': 0.9934733360145354, 'loss_val': 0.2485233070064139, 'psi': 0.924151883815368}-{'f1_val': 0.9351482796084434, 'auprc': 0.9990090013592344, 'loss_val': 0.17231242819370277, 'psi': 0.9606925683087598}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=48 head_norm_before_train=1.499584 cos_to_last_merge=0.9647 (last merge round=30)
[S4] round=48 local utility u=0.017342 metrics={'f1_val': 0.9411381050203981, 'auprc': 0.9335426190409171, 'loss_val': 0.27682571213970913, 'psi': 0.9380999106286056}-{'f1_val': 0.9396328875766342, 'auprc': 0.9296983414746445, 'loss_val': 0.29094647272878066, 'psi': 0.9356590691358383}
[S4] not sending this round → trigger blocked (psi=0.938)
[S5] START round=48 head_norm_before_train=1.723509 cos_to_last_merge=0.9704 (last merge round=31)
[S5] round=48 local utility u=1.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9909295718003356, 'loss_val': 0.23929073983787377, 'psi': 0.8165646191804825}-{'f1_val': 0.43213421050549483, 'auprc': 0.8357030717804371, 'loss_val': 1.0793480351771703, 'psi': 0.5935617550154717}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=48 head_norm_before_train=1.640268 cos_to_last_merge=0.9790 (last merge round=29)
[S6] round=48 local utility u=0.746413 metrics={'f1_val': 0.7427502637055495, 'auprc': 0.9016853816156031, 'loss_val': 0.6044956351213782, 'psi': 0.806324310869571}-{'f1_val': 0.5643657664450447, 'auprc': 0.8131539645144792, 'loss_val': 0.7614213141718368, 'psi': 0.6638810456728185}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=48 head_norm_before_train=1.408146 cos_to_last_merge=0.9763 (last merge round=31)
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.44123607008845356, 'auprc': 0.7760205663832015, 'loss_val': 1.2318874910567794, 'psi': 0.5751498686063528}-{'f1_val': 0.679350454589905, 'auprc': 0.8416141237779571, 'loss_val': 0.3983814273791053, 'psi': 0.7442559222651258}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=48 head_norm_before_train=1.514765 cos_to_last_merge=0.9401 (last merge round=25)
[S8] ⚠️ Model drifted since last merge! cos=0.940
[S8] round=48 local utility u=0.010874 metrics={'f1_val': 0.9943590272655265, 'auprc': 0.9988365232630172, 'loss_val': 0.03934256696778781, 'psi': 0.9961500256645228}-{'f1_val': 0.9925289693239863, 'auprc': 0.9985690767599666, 'loss_val': 0.04930721846249223, 'psi': 0.9949450122983784}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=48 head_norm_before_train=1.855268 cos_to_last_merge=0.9827 (last merge round=25)
[S9] round=48 local utility u=0.024898 metrics={'f1_val': 0.996808967411047, 'auprc': 0.9972495884222277, 'loss_val': 0.02448208179182656, 'psi': 0.9969852158155192}-{'f1_val': 0.9901193303318852, 'auprc': 0.9990246769013246, 'loss_val': 0.0394647629574684, 'psi': 0.9936814689596609}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] sending update (kind=head size=1804 to 1 peers)
[S10] START round=48 head_norm_before_train=2.092602 (no previous merge yet)
[S10] round=48 local utility u=0.001417 metrics={'f1_val': 0.9953900010273877, 'auprc': 0.9960618955277754, 'loss_val': 0.026208180267537788, 'psi': 0.9956587588275427}-{'f1_val': 0.9951878390193748, 'auprc': 0.9955709832670709, 'loss_val': 0.02635704225517206, 'psi': 0.9953410967184533}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=48 head_norm_before_train=2.186264 (no previous merge yet)
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.998808216870044, 'loss_val': 0.019364359954400927, 'psi': 0.9972157715944648}-{'f1_val': 0.9961541414107454, 'auprc': 0.9990474893795862, 'loss_val': 0.019540395913277768, 'psi': 0.9973114805982817}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=48 head_norm_before_train=1.784409 (no previous merge yet)
[S13] round=48 local utility u=0.000000 metrics={'f1_val': 0.5938668605960349, 'auprc': 0.7740772089741655, 'loss_val': 1.0812856789799106, 'psi': 0.6659509999472871}-{'f1_val': 0.7203241992597054, 'auprc': 0.7830161521187143, 'loss_val': 0.6328389282917407, 'psi': 0.745400980403309}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=48 head_norm_before_train=1.701967 cos_to_last_merge=0.9696 (last merge round=25)
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.9965382307139673, 'auprc': 0.9965622193889454, 'loss_val': 0.03357007681011068, 'psi': 0.9965478261839587}-{'f1_val': 0.9969706583433163, 'auprc': 0.9989792823936313, 'loss_val': 0.03263409025482108, 'psi': 0.9977741079634423}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=48 head_norm_before_train=1.500863 cos_to_last_merge=0.9891 (last merge round=30)
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.8127061734034283, 'auprc': 0.9960695325607009, 'loss_val': 0.3079276435279048, 'psi': 0.8860515170663373}-{'f1_val': 0.9077613091362882, 'auprc': 0.9900107316353002, 'loss_val': 0.1334895520237744, 'psi': 0.940661078135893}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=48 head_norm_before_train=1.503315 cos_to_last_merge=0.9787 (last merge round=29)
[S16] round=48 local utility u=0.500921 metrics={'f1_val': 0.9930952402670012, 'auprc': 0.995351097641174, 'loss_val': 0.04189745056755335, 'psi': 0.9939975832166703}-{'f1_val': 0.8777943645430472, 'auprc': 0.9890309647095527, 'loss_val': 0.3329737327510395, 'psi': 0.9222890046096494}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=48 head_norm_before_train=1.761799 cos_to_last_merge=0.7711 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.771
[S17] round=48 local utility u=0.405314 metrics={'f1_val': 0.633984857786135, 'auprc': 0.89652455310267, 'loss_val': 0.8209189547720277, 'psi': 0.7390007359127491}-{'f1_val': 0.5776543143021924, 'auprc': 0.8025041447757517, 'loss_val': 1.0115031507581267, 'psi': 0.6675942464916161}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] sending update (kind=head size=1794 to 1 peers)
[S2] START round=49 head_norm_before_train=2.059710 (no previous merge yet)
[S2] round=49 local utility u=0.325799 metrics={'f1_val': 0.9884528471273388, 'auprc': 0.9850488193277636, 'loss_val': 0.04812835447113933, 'psi': 0.9870912360075088}-{'f1_val': 0.9021741806397428, 'auprc': 0.9804988841517359, 'loss_val': 0.16840500759777907, 'psi': 0.93350406204454}
[S2] not sending this round → trigger blocked (psi=0.987)
[S3] START round=49 head_norm_before_train=1.829426 cos_to_last_merge=0.9857 (last merge round=31)
[S3] round=49 local utility u=0.422130 metrics={'f1_val': 0.9859785266816256, 'auprc': 0.9986115154882718, 'loss_val': 0.06792349350310013, 'psi': 0.991031722204284}-{'f1_val': 0.8779375823492565, 'auprc': 0.9934733360145354, 'loss_val': 0.2485233070064139, 'psi': 0.924151883815368}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=49 head_norm_before_train=1.509616 cos_to_last_merge=0.9635 (last merge round=30)
[S4] round=49 local utility u=0.014648 metrics={'f1_val': 0.942584473864368, 'auprc': 0.939453224952092, 'loss_val': 0.27394056058472993, 'psi': 0.9413319742994576}-{'f1_val': 0.9411381050203981, 'auprc': 0.9335426190409171, 'loss_val': 0.27682571213970913, 'psi': 0.9380999106286056}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] sending update (kind=head size=1806 to 1 peers)
[S5] START round=49 head_norm_before_train=1.727038 cos_to_last_merge=0.9699 (last merge round=31)
[S5] round=49 local utility u=0.000000 metrics={'f1_val': 0.4191820962689531, 'auprc': 0.7406220319796983, 'loss_val': 1.3686483505771083, 'psi': 0.5477580705532512}-{'f1_val': 0.7003213174339138, 'auprc': 0.9909295718003356, 'loss_val': 0.23929073983787377, 'psi': 0.8165646191804825}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=49 head_norm_before_train=1.650003 cos_to_last_merge=0.9780 (last merge round=29)
[S6] round=49 local utility u=0.175207 metrics={'f1_val': 0.7773331958309848, 'auprc': 0.9247042689085677, 'loss_val': 0.5306362910601891, 'psi': 0.836281625062018}-{'f1_val': 0.7427502637055495, 'auprc': 0.9016853816156031, 'loss_val': 0.6044956351213782, 'psi': 0.806324310869571}
[S6] not sending this round → trigger blocked (psi=0.836)
[S7] START round=49 head_norm_before_train=1.404112 cos_to_last_merge=0.9766 (last merge round=31)
[S7] round=49 local utility u=1.000000 metrics={'f1_val': 0.6855701143260011, 'auprc': 0.8645601819065002, 'loss_val': 0.31753497349631205, 'psi': 0.7571661413582007}-{'f1_val': 0.44123607008845356, 'auprc': 0.7760205663832015, 'loss_val': 1.2318874910567794, 'psi': 0.5751498686063528}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] START round=49 head_norm_before_train=1.525074 cos_to_last_merge=0.9391 (last merge round=25)
[S8] ⚠️ Model drifted since last merge! cos=0.939
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.9925289693239863, 'auprc': 0.998889329481862, 'loss_val': 0.040187613572469826, 'psi': 0.9950731133871366}-{'f1_val': 0.9943590272655265, 'auprc': 0.9988365232630172, 'loss_val': 0.03934256696778781, 'psi': 0.9961500256645228}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=49 head_norm_before_train=1.863662 cos_to_last_merge=0.9822 (last merge round=25)
[S9] round=49 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9946319783520405, 'loss_val': 0.024826120602383737, 'psi': 0.9958682860996735}-{'f1_val': 0.996808967411047, 'auprc': 0.9972495884222277, 'loss_val': 0.02448208179182656, 'psi': 0.9969852158155192}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=49 head_norm_before_train=2.096328 (no previous merge yet)
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.9951704237150173, 'auprc': 0.9960935115652927, 'loss_val': 0.026058714928079194, 'psi': 0.9955396588551274}-{'f1_val': 0.9953900010273877, 'auprc': 0.9960618955277754, 'loss_val': 0.026208180267537788, 'psi': 0.9956587588275427}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=49 head_norm_before_train=2.194634 (no previous merge yet)
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.9953644915774865, 'auprc': 0.9987900152584619, 'loss_val': 0.02263526294439725, 'psi': 0.9967347010498767}-{'f1_val': 0.9961541414107454, 'auprc': 0.998808216870044, 'loss_val': 0.019364359954400927, 'psi': 0.9972157715944648}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=49 head_norm_before_train=1.790612 (no previous merge yet)
[S13] round=49 local utility u=0.079638 metrics={'f1_val': 0.6251437044107871, 'auprc': 0.6950331390425757, 'loss_val': 0.8725393327773844, 'psi': 0.6530994782635026}-{'f1_val': 0.5938668605960349, 'auprc': 0.7740772089741655, 'loss_val': 1.0812856789799106, 'psi': 0.6659509999472871}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=49 head_norm_before_train=1.711135 cos_to_last_merge=0.9690 (last merge round=25)
[S14] round=49 local utility u=0.000556 metrics={'f1_val': 0.9965382307139673, 'auprc': 0.9966543385618881, 'loss_val': 0.03273447632822464, 'psi': 0.9965846738531356}-{'f1_val': 0.9965382307139673, 'auprc': 0.9965622193889454, 'loss_val': 0.03357007681011068, 'psi': 0.9965478261839587}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=49 head_norm_before_train=1.506871 cos_to_last_merge=0.9889 (last merge round=30)
[S15] round=49 local utility u=0.000000 metrics={'f1_val': 0.7032213083283363, 'auprc': 0.9947446507306975, 'loss_val': 0.40825040530031265, 'psi': 0.8198306452892807}-{'f1_val': 0.8127061734034283, 'auprc': 0.9960695325607009, 'loss_val': 0.3079276435279048, 'psi': 0.8860515170663373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=49 head_norm_before_train=1.512078 cos_to_last_merge=0.9780 (last merge round=29)
[S16] round=49 local utility u=0.000000 metrics={'f1_val': 0.9918332172871517, 'auprc': 0.9873376326835258, 'loss_val': 0.04679547451443671, 'psi': 0.9900349834457014}-{'f1_val': 0.9930952402670012, 'auprc': 0.995351097641174, 'loss_val': 0.04189745056755335, 'psi': 0.9939975832166703}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=49 head_norm_before_train=1.772111 cos_to_last_merge=0.7702 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.770
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.611574631972101, 'auprc': 0.9413007073109815, 'loss_val': 1.0634115379424884, 'psi': 0.7434650621076533}-{'f1_val': 0.633984857786135, 'auprc': 0.89652455310267, 'loss_val': 0.8209189547720277, 'psi': 0.7390007359127491}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[runner] rounds complete.
[runner] all agents stopped.
