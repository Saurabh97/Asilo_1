[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:49303
[S3] → join 127.0.0.1:49302
[S4] → join 127.0.0.1:49302
[S5] → join 127.0.0.1:49302
[S6] → join 127.0.0.1:49302
[S7] → join 127.0.0.1:49302
[S8] → join 127.0.0.1:49302
[S9] → join 127.0.0.1:49302
[S10] → join 127.0.0.1:49302
[S11] → join 127.0.0.1:49302
[S13] → join 127.0.0.1:49302
[S14] → join 127.0.0.1:49302
[S15] → join 127.0.0.1:49302
[S16] → join 127.0.0.1:49302
[S17] → join 127.0.0.1:49302
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.175369 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.126018 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.176478 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.170906 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.142294 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.209659 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.192396 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.152838 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.120011 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.160009 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.178451 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.148770 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.177744 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.155571 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.153942 (no previous merge yet)
[S13]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S4] + discovered S2
[S3] + discovered S14
[S3] + discovered S13
[S3] + discovered S15
[S3] + discovered S8
[S3] + discovered S9
[S3] + discovered S7
[S3] + discovered S10
[S3] + discovered S16
[S3] + discovered S6
[S3] + discovered S17
[S3] + discovered S4
[S3] + discovered S5
[S3] + discovered S11
[S4] + discovered S3
[S4] + discovered S8
[S4] + discovered S9
[S4] + discovered S7
[S4] + discovered S10
[S4] + discovered S17
[S4] + discovered S16
[S4] + discovered S15
[S4] + discovered S6
[S4] + discovered S5
[S4] + discovered S11
[S5] + discovered S3
[S4] + discovered S13
[S5] + discovered S4
[S4] + discovered S14
[S5] + discovered S2
[S5] + discovered S8
[S5] + discovered S13
[S5] + discovered S6
[S6] + discovered S3
[S6] + discovered S4
[S6] + discovered S2
[S6] + discovered S5
[S5] + discovered S9
[S5] + discovered S10
[S5] + discovered S16
[S5] + discovered S11
[S5] + discovered S7
[S5] + discovered S15
[S5] + discovered S17
[S5] + discovered S14
[S7] + discovered S2
[S7] + discovered S4
[S7] + discovered S5
[S7] + discovered S6
[S7] + discovered S3
[S6] + discovered S16
[S6] + discovered S7
[S6] + discovered S17
[S6] + discovered S9
[S6] + discovered S10
[S6] + discovered S13
[S6] + discovered S8
[S6] + discovered S11
[S6] + discovered S15
[S6] + discovered S14
[S8] + discovered S3
[S8] + discovered S4
[S8] + discovered S6
[S8] + discovered S5
[S8] + discovered S7
[S7] + discovered S11
[S8] + discovered S2
[S7] + discovered S13
[S7] + discovered S10
[S7] + discovered S17
[S7] + discovered S14
[S7] + discovered S9
[S7] + discovered S16
[S7] + discovered S8
[S7] + discovered S15
[S9] + discovered S2
[S9] + discovered S5
[S9] + discovered S7
[S9] + discovered S8
[S9] + discovered S6
[S9] + discovered S3
[S9] + discovered S4
[S8] + discovered S17
[S8] + discovered S9
[S8] + discovered S15
[S8] + discovered S16
[S8] + discovered S14
[S8] + discovered S13
[S8] + discovered S10
[S8] + discovered S11
[S9] + discovered S17
[S9] + discovered S14
[S9] + discovered S11
[S9] + discovered S16
[S10] + discovered S2
[S9] + discovered S13
[S10] + discovered S3
[S10] + discovered S4
[S9] + discovered S15
[S10] + discovered S6
[S9] + discovered S10
[S10] + discovered S7
[S10] + discovered S5
[S10] + discovered S9
[S10] + discovered S8
[S11] + discovered S5
[S11] + discovered S8
[S11] + discovered S3
[S11] + discovered S4
[S11] + discovered S7
[S11] + discovered S9
[S11] + discovered S10
[S11] + discovered S2
[S10] + discovered S13
[S10] + discovered S17
[S10] + discovered S11
[S10] + discovered S15
[S10] + discovered S14
[S10] + discovered S16
[S11] + discovered S6
[S13] + discovered S9
[S11] + discovered S13
[S13] + discovered S8
[S13] + discovered S7
[S11] + discovered S16
[S13] + discovered S2
[S13] + discovered S11
[S11] + discovered S14
[S13] + discovered S4
[S13] + discovered S10
[S11] + discovered S15
[S13] + discovered S3
[S13] + discovered S5
[S11] + discovered S17
[S13] + discovered S6
[S14] + discovered S8
[S14] + discovered S9
[S13] + discovered S16
[S13] + discovered S15
[S13] + discovered S14
[S13] + discovered S17
[S14] + discovered S10
[S14] + discovered S11
[S14] + discovered S2
[S14] + discovered S13
[S14] + discovered S7
[S14] + discovered S4
[S14] + discovered S6
[S14] + discovered S5
[S14] + discovered S3
[S15] + discovered S4
[S15] + discovered S3
[S15] + discovered S6
[S15] + discovered S11
[S15] + discovered S2
[S15] + discovered S14
[S14] + discovered S17
[S15] + discovered S8
[S14] + discovered S15
[S14] + discovered S16
[S15] + discovered S7
[S15] + discovered S9
[S15] + discovered S5
[S15] + discovered S13
[S15] + discovered S10
[S16] + discovered S7
[S16] + discovered S13
[S16] + discovered S8
[S16] + discovered S15
[S16] + discovered S4
[S15] + discovered S16
[S16] + discovered S6
[S16] + discovered S10
[S16] + discovered S11
[S16] + discovered S14
[S16] + discovered S2
[S16] + discovered S9
[S15] + discovered S17
[S16] + discovered S5
[S16] + discovered S3
[S17] + discovered S6
[S17] + discovered S14
[S17] + discovered S7
[S17] + discovered S2
[S17] + discovered S13
[S17] + discovered S3
[S17] + discovered S15
[S17] + discovered S10
[S17] + discovered S5
[S17] + discovered S4
[S17] + discovered S9
[S17] + discovered S8
[S16] + discovered S17
[S17] + discovered S11
[S17] + discovered S16
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] ⇄ pheromone p=1.000 → S9@127.0.0.1:49310
[S7] ⇄ pheromone p=1.000 → S3@127.0.0.1:49303
[S16] ⇄ pheromone p=1.000 → S14@127.0.0.1:49314
[S8] ⇄ pheromone p=1.000 → S9@127.0.0.1:49310
[S13] ⇄ pheromone p=1.000 → S10@127.0.0.1:49311
[S11] ⇄ pheromone p=1.000 → S15@127.0.0.1:49315
[S9] ⇄ pheromone p=1.000 → S16@127.0.0.1:49316
[S4] ⇄ pheromone p=1.000 → S11@127.0.0.1:49312
[S15] ⇄ pheromone p=1.000 → S5@127.0.0.1:49305
[S2] ⇄ pheromone p=1.000 → S15@127.0.0.1:49315
[S5] ⇄ pheromone p=1.000 → S16@127.0.0.1:49316
[S6] ⇄ pheromone p=1.000 → S8@127.0.0.1:49309
[S14] ⇄ pheromone p=1.000 → S8@127.0.0.1:49309
[S3] ⇄ pheromone p=1.000 → S2@127.0.0.1:49302
[S17] ⇄ pheromone p=1.000 → S3@127.0.0.1:49303
[S2] START round=1 head_norm_before_train=1.180495 (no previous merge yet)
[S2] round=1 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.9510297643102099, 'loss_val': 1.270636172508558, 'psi': 0.46547818575722405}-{'f1_val': 0.1417771333885667, 'auprc': 0.9875901715363686, 'loss_val': 1.3462045733733072, 'psi': 0.4801023486476875}
[S3] START round=1 head_norm_before_train=1.130875 (no previous merge yet)
[S3] round=1 local utility u=0.211783 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.537494655112296, 'loss_val': 1.3146630849156014, 'psi': 0.29890190141338263}-{'f1_val': 0.13984006561410703, 'auprc': 0.4063217728721563, 'loss_val': 1.3447107212235887, 'psi': 0.24643274851732674}
[S4] START round=1 head_norm_before_train=1.193340 (no previous merge yet)
[S4] round=1 local utility u=0.109962 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7814082030460805, 'loss_val': 1.2713132986096312, 'psi': 0.3966992585555427}-{'f1_val': 0.14022662889518414, 'auprc': 0.7277464467670742, 'loss_val': 1.330252072443465, 'psi': 0.3752345560439402}
[S5] START round=1 head_norm_before_train=1.174889 (no previous merge yet)
[S5] round=1 local utility u=0.000000 metrics={'f1_val': 0.40767020518572783, 'auprc': 0.7758867552516135, 'loss_val': 1.3014222492364493, 'psi': 0.5549568252120821}-{'f1_val': 0.7149637112830016, 'auprc': 0.780193849219691, 'loss_val': 1.3460508776974858, 'psi': 0.7410557664576773}
[S6] START round=1 head_norm_before_train=1.160791 (no previous merge yet)
[S6] round=1 local utility u=0.000000 metrics={'f1_val': 0.23671437217261063, 'auprc': 0.8626244728021658, 'loss_val': 1.2604925843210166, 'psi': 0.4870784124244327}-{'f1_val': 0.6997472426304338, 'auprc': 0.6495119051063207, 'loss_val': 1.3320983976327943, 'psi': 0.6796531076207886}
[S7] START round=1 head_norm_before_train=1.219935 (no previous merge yet)
[S7] round=1 local utility u=0.024068 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7616823020422123, 'loss_val': 1.2995401575297283, 'psi': 0.38990701445433995}-{'f1_val': 0.14205682272909165, 'auprc': 0.7561574566990792, 'loss_val': 1.3311021056780568, 'psi': 0.38769707631708666}
[S8] START round=1 head_norm_before_train=1.201239 (no previous merge yet)
[S8] round=1 local utility u=1.000000 metrics={'f1_val': 0.7149686191926397, 'auprc': 0.6576536596516844, 'loss_val': 1.2891044948188284, 'psi': 0.6920426353762577}-{'f1_val': 0.09148694665153236, 'auprc': 0.6557757895888437, 'loss_val': 1.353431021075814, 'psi': 0.3172024838264569}
[S9] START round=1 head_norm_before_train=1.151337 (no previous merge yet)
[S9] round=1 local utility u=0.566047 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9693749255159934, 'loss_val': 1.3154032178128132, 'psi': 0.47258874449039495}-{'f1_val': 0.141397957139996, 'auprc': 0.6036478460294662, 'loss_val': 1.350316605492862, 'psi': 0.32629791269578406}
[S10] START round=1 head_norm_before_train=1.132845 (no previous merge yet)
[S10] round=1 local utility u=0.111955 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6521919114406007, 'loss_val': 1.2665171664928445, 'psi': 0.34404974710127467}-{'f1_val': 0.13862163754172394, 'auprc': 0.5962321834463666, 'loss_val': 1.3225476759656667, 'psi': 0.321665855903581}
[S11] START round=1 head_norm_before_train=1.156491 (no previous merge yet)
[S11] round=1 local utility u=1.000000 metrics={'f1_val': 0.4225625868721864, 'auprc': 0.7569665644587745, 'loss_val': 1.3410344663680551, 'psi': 0.5563241779068216}-{'f1_val': 0.1189378738737774, 'auprc': 0.6150390642566608, 'loss_val': 1.3720476776784742, 'psi': 0.31737835002693077}
[S13] START round=1 head_norm_before_train=1.187556 (no previous merge yet)
[S13] round=1 local utility u=0.025429 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7159832845954958, 'loss_val': 1.276372961348038, 'psi': 0.3706247713844302}-{'f1_val': 0.1403857625770531, 'auprc': 0.7165487966837354, 'loss_val': 1.328926576140358, 'psi': 0.370850976219726}
[S14] START round=1 head_norm_before_train=1.155723 (no previous merge yet)
[S14] round=1 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.9773371825488821, 'loss_val': 1.347687804356195, 'psi': 0.4751495847491751}-{'f1_val': 0.33219379320558956, 'auprc': 0.6026987546113814, 'loss_val': 1.3740365158331793, 'psi': 0.44039577776790634}
[S15] START round=1 head_norm_before_train=1.193060 (no previous merge yet)
[S15] round=1 local utility u=0.348007 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7764940601204731, 'loss_val': 1.2811254601850368, 'psi': 0.39443781486512425}-{'f1_val': 0.13973365136155833, 'auprc': 0.562446190060209, 'loss_val': 1.3349963080765053, 'psi': 0.3088186668410186}
[S16] START round=1 head_norm_before_train=1.155799 (no previous merge yet)
[S16] round=1 local utility u=0.789414 metrics={'f1_val': 0.33571673685852443, 'auprc': 0.6534085198605311, 'loss_val': 1.3394571347709987, 'psi': 0.46279345005932704}-{'f1_val': 0.09148550724637682, 'auprc': 0.6258418051822907, 'loss_val': 1.3701968053384066, 'psi': 0.30522802642074237}
[S17] START round=1 head_norm_before_train=1.151445 (no previous merge yet)
[S17] round=1 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.8375163106845677, 'loss_val': 1.3020314292539192, 'psi': 0.4195759022642577}-{'f1_val': 0.39035948097845735, 'auprc': 0.6975594973189732, 'loss_val': 1.3627716905616352, 'psi': 0.5132394875146636}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:49310
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] → sending delta(kind=head bytes=1792) to S16@127.0.0.1:49316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] → sending delta(kind=head bytes=1792) to S6@127.0.0.1:49307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:49307
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1784 reason=None
[S11] → sending delta(kind=head bytes=1784) to S2@127.0.0.1:49302
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:49315
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:49310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S10] → sending delta(kind=head bytes=1787) to S17@127.0.0.1:49317
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:49317
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] → sending delta(kind=head bytes=1792) to S11@127.0.0.1:49312
[S3] sending update (kind=head size=1792 to 1 peers)
[S13] sending update (kind=head size=1793 to 1 peers)
[S10] sending update (kind=head size=1787 to 1 peers)
[S4] sending update (kind=head size=1793 to 1 peers)
[S11] sending update (kind=head size=1784 to 1 peers)
[S16] sending update (kind=head size=1792 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1793 to 1 peers)
[S15] sending update (kind=head size=1792 to 1 peers)
[S7] sending update (kind=head size=1793 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1792) from S16
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.166148)
[S11] loaded HEAD from S16 (vec_in norm=1.166148)
[S11] cosine check vs S16: cos=0.1015
[S11] BUFFERED delta from S16 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1792) from S15
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.228722)
[S6] loaded HEAD from S15 (vec_in norm=1.228722)
[S6] cosine check vs S15: cos=-0.0187
[S6] DROPPED delta from S15 (cos=-0.0187 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1796) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.239386)
[S17] loaded HEAD from S8 (vec_in norm=1.239386)
[S17] cosine check vs S8: cos=-0.0559
[S17] DROPPED delta from S8 (cos=-0.0559 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1787) from S10
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.170188)
[S17] loaded HEAD from S10 (vec_in norm=1.170188)
[S17] cosine check vs S10: cos=-0.0149
[S17] DROPPED delta from S10 (cos=-0.0149 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1792) from S3
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.146447)
[S16] loaded HEAD from S3 (vec_in norm=1.146447)
[S16] cosine check vs S3: cos=-0.0290
[S16] DROPPED delta from S3 (cos=-0.0290 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1793) from S13
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.218989)
[S9] loaded HEAD from S13 (vec_in norm=1.218989)
[S9] cosine check vs S13: cos=-0.0549
[S9] DROPPED delta from S13 (cos=-0.0549 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1784) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.165125)
[S2] loaded HEAD from S11 (vec_in norm=1.165125)
[S2] cosine check vs S11: cos=-0.0064
[S2] DROPPED delta from S11 (cos=-0.0064 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1793) from S4
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.234087)
[S15] loaded HEAD from S4 (vec_in norm=1.234087)
[S15] cosine check vs S4: cos=0.0978
[S15] BUFFERED delta from S4 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1793) from S7
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.236044)
[S9] loaded HEAD from S7 (vec_in norm=1.236044)
[S9] cosine check vs S7: cos=-0.0265
[S9] DROPPED delta from S7 (cos=-0.0265 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1793) from S9
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.158471)
[S6] loaded HEAD from S9 (vec_in norm=1.158471)
[S6] cosine check vs S9: cos=-0.0110
[S6] DROPPED delta from S9 (cos=-0.0110 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=1 metric=0.4226 head_norm=1.165125
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.812653e-01
[S11] stored merged vector for next round verification (round=1)
[S11] DEBUG after merge:  round=1 metric=0.1036 head_norm=0.865062 delta_norm=0.781265
[S11] aggregate: ROLLBACK (f1_val pre=0.423 post=0.104 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=1 metric=0.1397 head_norm=1.228722
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.270556e-01
[S15] stored merged vector for next round verification (round=1)
[S15] DEBUG after merge:  round=1 metric=0.1397 head_norm=0.912328 delta_norm=0.827056
[S15] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=1.216179 (no previous merge yet)
[S2] round=2 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6174362719282701, 'loss_val': 1.1586117975002646, 'psi': 0.3320407888044481}-{'f1_val': 0.1417771333885667, 'auprc': 0.9510297643102099, 'loss_val': 1.270636172508558, 'psi': 0.46547818575722405}
[S3] START round=2 head_norm_before_train=1.146447 (no previous merge yet)
[S3] round=2 local utility u=0.129629 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.6121445148876811, 'loss_val': 1.2793552947713132, 'psi': 0.3287618453235367}-{'f1_val': 0.13984006561410703, 'auprc': 0.537494655112296, 'loss_val': 1.3146630849156014, 'psi': 0.29890190141338263}
[S4] START round=2 head_norm_before_train=1.234087 (no previous merge yet)
[S4] round=2 local utility u=0.055077 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7833599759263786, 'loss_val': 1.1670145925306064, 'psi': 0.397479967707662}-{'f1_val': 0.14022662889518414, 'auprc': 0.7814082030460805, 'loss_val': 1.2713132986096312, 'psi': 0.3966992585555427}
[S5] START round=2 head_norm_before_train=1.188375 (no previous merge yet)
[S5] round=2 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7773418603061623, 'loss_val': 1.2545039849377906, 'psi': 0.39629388697960777}-{'f1_val': 0.40767020518572783, 'auprc': 0.7758867552516135, 'loss_val': 1.3014222492364493, 'psi': 0.5549568252120821}
[S6] START round=2 head_norm_before_train=1.205607 (no previous merge yet)
[S6] round=2 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8616044982009945, 'loss_val': 1.1646978050207277, 'psi': 0.42949756851116705}-{'f1_val': 0.23671437217261063, 'auprc': 0.8626244728021658, 'loss_val': 1.2604925843210166, 'psi': 0.4870784124244327}
[S7] START round=2 head_norm_before_train=1.236044 (no previous merge yet)
[S7] round=2 local utility u=0.026069 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7682579545414527, 'loss_val': 1.2671293605710943, 'psi': 0.3925372754540361}-{'f1_val': 0.14205682272909165, 'auprc': 0.7616823020422123, 'loss_val': 1.2995401575297283, 'psi': 0.38990701445433995}
[S8] START round=2 head_norm_before_train=1.239386 (no previous merge yet)
[S8] round=2 local utility u=0.000000 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.6574258142631022, 'loss_val': 1.1944383042348978, 'psi': 0.3469439151410152}-{'f1_val': 0.7149686191926397, 'auprc': 0.6576536596516844, 'loss_val': 1.2891044948188284, 'psi': 0.6920426353762577}
[S9] START round=2 head_norm_before_train=1.158471 (no previous merge yet)
[S9] round=2 local utility u=0.063457 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9989481014837458, 'loss_val': 1.277208832012025, 'psi': 0.484418014877496}-{'f1_val': 0.141397957139996, 'auprc': 0.9693749255159934, 'loss_val': 1.3154032178128132, 'psi': 0.47258874449039495}
[S10] START round=2 head_norm_before_train=1.170188 (no previous merge yet)
[S10] round=2 local utility u=0.059457 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6611452864107029, 'loss_val': 1.1744628639752626, 'psi': 0.34763109708931555}-{'f1_val': 0.13862163754172394, 'auprc': 0.6521919114406007, 'loss_val': 1.2665171664928445, 'psi': 0.34404974710127467}
[S11] START round=2 head_norm_before_train=0.865062 cos_to_last_merge=1.0000 (last merge round=1)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.39652857013035536, 'auprc': 0.7896475055342034, 'loss_val': 1.3336886751253438, 'psi': 0.5537761442918946}-{'f1_val': 0.4225625868721864, 'auprc': 0.7569665644587745, 'loss_val': 1.3410344663680551, 'psi': 0.5563241779068216}
[S13] START round=2 head_norm_before_train=1.218989 (no previous merge yet)
[S13] round=2 local utility u=0.036378 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7206976589401779, 'loss_val': 1.217759536537741, 'psi': 0.37251052112230304}-{'f1_val': 0.1403857625770531, 'auprc': 0.7159832845954958, 'loss_val': 1.276372961348038, 'psi': 0.3706247713844302}
[S14] START round=2 head_norm_before_train=1.173414 (no previous merge yet)
[S14] round=2 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.9563151039627796, 'loss_val': 1.3129862681323163, 'psi': 0.46674075331473414}-{'f1_val': 0.14035785288270378, 'auprc': 0.9773371825488821, 'loss_val': 1.347687804356195, 'psi': 0.4751495847491751}
[S15] START round=2 head_norm_before_train=0.912328 cos_to_last_merge=1.0000 (last merge round=1)
[S15] round=2 local utility u=0.005980 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7767392513135281, 'loss_val': 1.269900261064758, 'psi': 0.39453589134234623}-{'f1_val': 0.13973365136155833, 'auprc': 0.7764940601204731, 'loss_val': 1.2811254601850368, 'psi': 0.39443781486512425}
[S16] START round=2 head_norm_before_train=1.166148 (no previous merge yet)
[S16] round=2 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.6694943123226015, 'loss_val': 1.3014977057263006, 'psi': 0.35218019504856246}-{'f1_val': 0.33571673685852443, 'auprc': 0.6534085198605311, 'loss_val': 1.3394571347709987, 'psi': 0.46279345005932704}
[S17] START round=2 head_norm_before_train=1.182585 (no previous merge yet)
[S17] round=2 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6917578509469638, 'loss_val': 1.1705212318318172, 'psi': 0.3612725183692162}-{'f1_val': 0.14094896331738438, 'auprc': 0.8375163106845677, 'loss_val': 1.3020314292539192, 'psi': 0.4195759022642577}
[S15] not sending this round → trigger blocked (psi=0.395)
[S3] not sending this round → trigger blocked (psi=0.329)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.397)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.373)
[S10] not sending this round → trigger blocked (psi=0.348)
[S7] not sending this round → trigger blocked (psi=0.393)
[S9] not sending this round → trigger blocked (psi=0.484)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=3 head_norm_before_train=1.271942 (no previous merge yet)
[S2] round=3 local utility u=1.000000 metrics={'f1_val': 0.417102078559347, 'auprc': 0.7755066407896984, 'loss_val': 0.9450395110639217, 'psi': 0.5604639034514876}-{'f1_val': 0.1417771333885667, 'auprc': 0.6174362719282701, 'loss_val': 1.1586117975002646, 'psi': 0.3320407888044481}
[S3] START round=3 head_norm_before_train=1.169866 (no previous merge yet)
[S3] round=3 local utility u=0.011553 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.6022704477595985, 'loss_val': 1.2266280747708476, 'psi': 0.3248122184723036}-{'f1_val': 0.13984006561410703, 'auprc': 0.6121445148876811, 'loss_val': 1.2793552947713132, 'psi': 0.3287618453235367}
[S4] START round=3 head_norm_before_train=1.285335 (no previous merge yet)
[S4] round=3 local utility u=0.935706 metrics={'f1_val': 0.4141138273491215, 'auprc': 0.7826127974349826, 'loss_val': 0.9366849619852841, 'psi': 0.561513415383466}-{'f1_val': 0.14022662889518414, 'auprc': 0.7833599759263786, 'loss_val': 1.1670145925306064, 'psi': 0.397479967707662}
[S5] START round=3 head_norm_before_train=1.208551 (no previous merge yet)
[S5] round=3 local utility u=0.022455 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7767566260824458, 'loss_val': 1.2078384077246063, 'psi': 0.3960597932901212}-{'f1_val': 0.14226190476190476, 'auprc': 0.7773418603061623, 'loss_val': 1.2545039849377906, 'psi': 0.39629388697960777}
[S6] START round=3 head_norm_before_train=1.265846 (no previous merge yet)
[S6] round=3 local utility u=0.902335 metrics={'f1_val': 0.4156481186360783, 'auprc': 0.8401050376887744, 'loss_val': 0.9408603294472072, 'psi': 0.5854308862571568}-{'f1_val': 0.14142628205128205, 'auprc': 0.8616044982009945, 'loss_val': 1.1646978050207277, 'psi': 0.42949756851116705}
[S7] START round=3 head_norm_before_train=1.260334 (no previous merge yet)
[S7] round=3 local utility u=0.015792 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7716883435694157, 'loss_val': 1.2458355373083638, 'psi': 0.3939094310652213}-{'f1_val': 0.14205682272909165, 'auprc': 0.7682579545414527, 'loss_val': 1.2671293605710943, 'psi': 0.3925372754540361}
[S8] START round=3 head_norm_before_train=1.297423 (no previous merge yet)
[S8] round=3 local utility u=1.000000 metrics={'f1_val': 0.7145884013058279, 'auprc': 0.7660946796715271, 'loss_val': 1.0713011886681192, 'psi': 0.7351909126521077}-{'f1_val': 0.13995598239295717, 'auprc': 0.6574258142631022, 'loss_val': 1.1944383042348978, 'psi': 0.3469439151410152}
[S9] START round=3 head_norm_before_train=1.175334 (no previous merge yet)
[S9] round=3 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9726686974248979, 'loss_val': 1.22628627365586, 'psi': 0.4739062532539568}-{'f1_val': 0.141397957139996, 'auprc': 0.9989481014837458, 'loss_val': 1.277208832012025, 'psi': 0.484418014877496}
[S10] START round=3 head_norm_before_train=1.226058 (no previous merge yet)
[S10] round=3 local utility u=0.949933 metrics={'f1_val': 0.41697224613064, 'auprc': 0.6670814542565052, 'loss_val': 0.9625094544322033, 'psi': 0.5170159293809861}-{'f1_val': 0.13862163754172394, 'auprc': 0.6611452864107029, 'loss_val': 1.1744628639752626, 'psi': 0.34763109708931555}
[S11] START round=3 head_norm_before_train=0.885716 cos_to_last_merge=0.9969 (last merge round=1)
[S11] round=3 local utility u=0.112319 metrics={'f1_val': 0.4223876636418746, 'auprc': 0.799828613332406, 'loss_val': 1.294748894081276, 'psi': 0.5733640435180871}-{'f1_val': 0.39652857013035536, 'auprc': 0.7896475055342034, 'loss_val': 1.3336886751253438, 'psi': 0.5537761442918946}
[S13] START round=3 head_norm_before_train=1.259190 (no previous merge yet)
[S13] round=3 local utility u=0.896169 metrics={'f1_val': 0.4156839344320697, 'auprc': 0.7304181387585538, 'loss_val': 1.1063728023306172, 'psi': 0.5415776161626633}-{'f1_val': 0.1403857625770531, 'auprc': 0.7206976589401779, 'loss_val': 1.217759536537741, 'psi': 0.37251052112230304}
[S14] START round=3 head_norm_before_train=1.203648 (no previous merge yet)
[S14] round=3 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8834716951135558, 'loss_val': 1.276217294545556, 'psi': 0.4376033897750446}-{'f1_val': 0.14035785288270378, 'auprc': 0.9563151039627796, 'loss_val': 1.3129862681323163, 'psi': 0.46674075331473414}
[S15] START round=3 head_norm_before_train=0.943534 cos_to_last_merge=0.9947 (last merge round=1)
[S15] round=3 local utility u=0.033480 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7770534926879272, 'loss_val': 1.2038837308082218, 'psi': 0.3946615878921059}-{'f1_val': 0.13973365136155833, 'auprc': 0.7767392513135281, 'loss_val': 1.269900261064758, 'psi': 0.39453589134234623}
[S16] START round=3 head_norm_before_train=1.183568 (no previous merge yet)
[S16] round=3 local utility u=0.139109 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7471835438244747, 'loss_val': 1.2563465538247356, 'psi': 0.38325588764931184}-{'f1_val': 0.14063745019920318, 'auprc': 0.6694943123226015, 'loss_val': 1.3014977057263006, 'psi': 0.35218019504856246}
[S17] START round=3 head_norm_before_train=1.241922 (no previous merge yet)
[S17] round=3 local utility u=0.950447 metrics={'f1_val': 0.3907912793961699, 'auprc': 0.767393179843193, 'loss_val': 0.9955869739440689, 'psi': 0.5414320395749792}-{'f1_val': 0.14094896331738438, 'auprc': 0.6917578509469638, 'loss_val': 1.1705212318318172, 'psi': 0.3612725183692162}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:49316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S7] → sending delta(kind=head bytes=1789) to S3@127.0.0.1:49303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:49310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S2@127.0.0.1:49302
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:49310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S16] → sending delta(kind=head bytes=1787) to S14@127.0.0.1:49314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:49311
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:49305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:49312
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:49315
[S4] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1787 to 1 peers)
[S3] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1789 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1802) from S2
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.333530)
[S15] loaded HEAD from S2 (vec_in norm=1.333530)
[S15] cosine check vs S2: cos=0.0038
[S15] BUFFERED delta from S2 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1787) from S16
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.207769)
[S14] loaded HEAD from S16 (vec_in norm=1.207769)
[S14] cosine check vs S16: cos=-0.0414
[S14] DROPPED delta from S16 (cos=-0.0414 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1798) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.346263)
[S11] loaded HEAD from S4 (vec_in norm=1.346263)
[S11] cosine check vs S4: cos=-0.1122
[S11] DROPPED delta from S4 (cos=-0.1122 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1800) from S13
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.312549)
[S10] loaded HEAD from S13 (vec_in norm=1.312549)
[S10] cosine check vs S13: cos=-0.0936
[S10] DROPPED delta from S13 (cos=-0.0936 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1799) from S10
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.285506)
[S9] loaded HEAD from S10 (vec_in norm=1.285506)
[S9] cosine check vs S10: cos=-0.0022
[S9] DROPPED delta from S10 (cos=-0.0022 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1794) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.233324)
[S16] loaded HEAD from S5 (vec_in norm=1.233324)
[S16] cosine check vs S5: cos=-0.0052
[S16] DROPPED delta from S5 (cos=-0.0052 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1800) from S8
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.344499)
[S9] loaded HEAD from S8 (vec_in norm=1.344499)
[S9] cosine check vs S8: cos=-0.0426
[S9] DROPPED delta from S8 (cos=-0.0426 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1801) from S6
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.332794)
[S8] loaded HEAD from S6 (vec_in norm=1.332794)
[S8] cosine check vs S6: cos=-0.0871
[S8] DROPPED delta from S6 (cos=-0.0871 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1794) from S3
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.204509)
[S2] loaded HEAD from S3 (vec_in norm=1.204509)
[S2] cosine check vs S3: cos=-0.1026
[S2] DROPPED delta from S3 (cos=-0.1026 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1789) from S7
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.284646)
[S3] loaded HEAD from S7 (vec_in norm=1.284646)
[S3] cosine check vs S7: cos=0.0503
[S3] BUFFERED delta from S7 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1800) from S11
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.911694)
[S15] loaded HEAD from S11 (vec_in norm=0.911694)
[S15] cosine check vs S11: cos=-0.0412
[S15] DROPPED delta from S11 (cos=-0.0412 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1798) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.985714)
[S5] loaded HEAD from S15 (vec_in norm=0.985714)
[S5] cosine check vs S15: cos=0.0749
[S5] BUFFERED delta from S15 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:49303
[S17] sending update (kind=head size=1795 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1795) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.312495)
[S3] loaded HEAD from S17 (vec_in norm=1.312495)
[S3] cosine check vs S17: cos=-0.1198
[S3] DROPPED delta from S17 (cos=-0.1198 < 0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=3 metric=0.1423 head_norm=1.233324
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.600442e-01
[S5] stored merged vector for next round verification (round=3)
[S5] DEBUG after merge:  round=3 metric=0.1423 head_norm=0.817737 delta_norm=0.760044
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=3 metric=0.1397 head_norm=0.985714
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.276235e-01
[S15] stored merged vector for next round verification (round=3)
[S15] DEBUG after merge:  round=3 metric=0.4457 head_norm=0.830666 delta_norm=0.827624
[S15] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=3 metric=0.1398 head_norm=1.204509
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.581261e-01
[S3] stored merged vector for next round verification (round=3)
[S3] DEBUG after merge:  round=3 metric=0.1398 head_norm=0.902329 delta_norm=0.858126
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=1.333530 (no previous merge yet)
[S2] round=4 local utility u=1.000000 metrics={'f1_val': 0.7139121598907653, 'auprc': 0.7792687354147638, 'loss_val': 0.65170462938223, 'psi': 0.7400547901003647}-{'f1_val': 0.417102078559347, 'auprc': 0.7755066407896984, 'loss_val': 0.9450395110639217, 'psi': 0.5604639034514876}
[S3] START round=4 head_norm_before_train=0.902329 cos_to_last_merge=1.0000 (last merge round=3)
[S3] round=4 local utility u=0.287190 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7900750283239133, 'loss_val': 1.215661823766923, 'psi': 0.39993405069802956}-{'f1_val': 0.13984006561410703, 'auprc': 0.6022704477595985, 'loss_val': 1.2266280747708476, 'psi': 0.3248122184723036}
[S4] START round=4 head_norm_before_train=1.346263 (no previous merge yet)
[S4] round=4 local utility u=0.695789 metrics={'f1_val': 0.6641854579277879, 'auprc': 0.6614941273738653, 'loss_val': 0.6821799048781401, 'psi': 0.6631089257062188}-{'f1_val': 0.4141138273491215, 'auprc': 0.7826127974349826, 'loss_val': 0.9366849619852841, 'psi': 0.561513415383466}
[S5] START round=4 head_norm_before_train=0.817737 cos_to_last_merge=1.0000 (last merge round=3)
[S5] round=4 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.6146955925290565, 'loss_val': 1.2208998188767022, 'psi': 0.33123537986876544}-{'f1_val': 0.14226190476190476, 'auprc': 0.7767566260824458, 'loss_val': 1.2078384077246063, 'psi': 0.3960597932901212}
[S6] START round=4 head_norm_before_train=1.332794 (no previous merge yet)
[S6] round=4 local utility u=0.150906 metrics={'f1_val': 0.42478867168863166, 'auprc': 0.8216804616572042, 'loss_val': 0.6386179439682905, 'psi': 0.5835453876760608}-{'f1_val': 0.4156481186360783, 'auprc': 0.8401050376887744, 'loss_val': 0.9408603294472072, 'psi': 0.5854308862571568}
[S7] START round=4 head_norm_before_train=1.284646 (no previous merge yet)
[S7] round=4 local utility u=0.014418 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7734993792575061, 'loss_val': 1.2224321284265647, 'psi': 0.3946338453404575}-{'f1_val': 0.14205682272909165, 'auprc': 0.7716883435694157, 'loss_val': 1.2458355373083638, 'psi': 0.3939094310652213}
[S8] START round=4 head_norm_before_train=1.344499 (no previous merge yet)
[S8] round=4 local utility u=0.120931 metrics={'f1_val': 0.7149691070173029, 'auprc': 0.7740106177877375, 'loss_val': 0.8554707747853975, 'psi': 0.7385857113254768}-{'f1_val': 0.7145884013058279, 'auprc': 0.7660946796715271, 'loss_val': 1.0713011886681192, 'psi': 0.7351909126521077}
[S9] START round=4 head_norm_before_train=1.201530 (no previous merge yet)
[S9] round=4 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8658998608135415, 'loss_val': 1.1674357866552039, 'psi': 0.4311987186094142}-{'f1_val': 0.141397957139996, 'auprc': 0.9726686974248979, 'loss_val': 1.22628627365586, 'psi': 0.4739062532539568}
[S10] START round=4 head_norm_before_train=1.285506 (no previous merge yet)
[S10] round=4 local utility u=0.390991 metrics={'f1_val': 0.4036120185680494, 'auprc': 0.8654092874069039, 'loss_val': 0.6953499217347697, 'psi': 0.5883309261035912}-{'f1_val': 0.41697224613064, 'auprc': 0.6670814542565052, 'loss_val': 0.9625094544322033, 'psi': 0.5170159293809861}
[S11] START round=4 head_norm_before_train=0.911694 cos_to_last_merge=0.9885 (last merge round=1)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8137658836330268, 'loss_val': 1.2321029381397004, 'psi': 0.4097545634770771}-{'f1_val': 0.4223876636418746, 'auprc': 0.799828613332406, 'loss_val': 1.294748894081276, 'psi': 0.5733640435180871}
[S13] START round=4 head_norm_before_train=1.312549 (no previous merge yet)
[S13] round=4 local utility u=0.913517 metrics={'f1_val': 0.687509390672429, 'auprc': 0.7254797503449618, 'loss_val': 0.8954762865288486, 'psi': 0.7026975345414421}-{'f1_val': 0.4156839344320697, 'auprc': 0.7304181387585538, 'loss_val': 1.1063728023306172, 'psi': 0.5415776161626633}
[S14] START round=4 head_norm_before_train=1.237675 (no previous merge yet)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.853341448247946, 'loss_val': 1.2300840624340432, 'psi': 0.4255512910288007}-{'f1_val': 0.14035785288270378, 'auprc': 0.8834716951135558, 'loss_val': 1.276217294545556, 'psi': 0.4376033897750446}
[S15] START round=4 head_norm_before_train=0.830666 cos_to_last_merge=1.0000 (last merge round=3)
[S15] round=4 local utility u=0.879914 metrics={'f1_val': 0.4163758395072774, 'auprc': 0.7779339675071024, 'loss_val': 1.1065496240946204, 'psi': 0.5609990907072074}-{'f1_val': 0.13973365136155833, 'auprc': 0.7770534926879272, 'loss_val': 1.2038837308082218, 'psi': 0.3946615878921059}
[S16] START round=4 head_norm_before_train=1.207769 (no previous merge yet)
[S16] round=4 local utility u=0.086951 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7886414872858548, 'loss_val': 1.2068184854360713, 'psi': 0.3998390650338639}-{'f1_val': 0.14063745019920318, 'auprc': 0.7471835438244747, 'loss_val': 1.2563465538247356, 'psi': 0.38325588764931184}
[S17] START round=4 head_norm_before_train=1.312495 (no previous merge yet)
[S17] round=4 local utility u=0.072929 metrics={'f1_val': 0.35657260771113186, 'auprc': 0.8287442953311219, 'loss_val': 0.8284693555494378, 'psi': 0.5454412827591278}-{'f1_val': 0.3907912793961699, 'auprc': 0.767393179843193, 'loss_val': 0.9955869739440689, 'psi': 0.5414320395749792}
[S7] not sending this round → trigger blocked (psi=0.395)
[S10] not sending this round → trigger blocked (psi=0.588)
[S8] not sending this round → trigger blocked (psi=0.739)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.584)
[S3] not sending this round → trigger blocked (psi=0.400)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.703)
[S4] not sending this round → trigger blocked (psi=0.663)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.740)
[S15] not sending this round → trigger blocked (psi=0.561)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.400)
[S17] not sending this round → trigger blocked (psi=0.545)
[S2] START round=5 head_norm_before_train=1.418511 (no previous merge yet)
[S2] round=5 local utility u=0.022305 metrics={'f1_val': 0.6998459069236436, 'auprc': 0.7678285524925206, 'loss_val': 0.4883764811248555, 'psi': 0.7270389651511944}-{'f1_val': 0.7139121598907653, 'auprc': 0.7792687354147638, 'loss_val': 0.65170462938223, 'psi': 0.7400547901003647}
[S3] START round=5 head_norm_before_train=0.935843 cos_to_last_merge=0.9976 (last merge round=3)
[S3] round=5 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.6138978658316783, 'loss_val': 1.1430443451232954, 'psi': 0.32946318570113553}-{'f1_val': 0.13984006561410703, 'auprc': 0.7900750283239133, 'loss_val': 1.215661823766923, 'psi': 0.39993405069802956}
[S4] START round=5 head_norm_before_train=1.425863 (no previous merge yet)
[S4] round=5 local utility u=0.170774 metrics={'f1_val': 0.6893194008216724, 'auprc': 0.6655485708826896, 'loss_val': 0.5035989844166038, 'psi': 0.6798110688460792}-{'f1_val': 0.6641854579277879, 'auprc': 0.6614941273738653, 'loss_val': 0.6821799048781401, 'psi': 0.6631089257062188}
[S5] START round=5 head_norm_before_train=0.842472 cos_to_last_merge=0.9977 (last merge round=3)
[S5] round=5 local utility u=0.071336 metrics={'f1_val': 0.1534621698572443, 'auprc': 0.6192998057663063, 'loss_val': 1.1592427287843285, 'psi': 0.3397972242208691}-{'f1_val': 0.14226190476190476, 'auprc': 0.6146955925290565, 'loss_val': 1.2208998188767022, 'psi': 0.33123537986876544}
[S6] START round=5 head_norm_before_train=1.404935 (no previous merge yet)
[S6] round=5 local utility u=1.000000 metrics={'f1_val': 0.7085954023507969, 'auprc': 0.9733716588480084, 'loss_val': 0.45249474429620223, 'psi': 0.8145059049496814}-{'f1_val': 0.42478867168863166, 'auprc': 0.8216804616572042, 'loss_val': 0.6386179439682905, 'psi': 0.5835453876760608}
[S7] START round=5 head_norm_before_train=1.303532 (no previous merge yet)
[S7] round=5 local utility u=0.020727 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7740234171843228, 'loss_val': 1.1825502077872867, 'psi': 0.39484346051118413}-{'f1_val': 0.14205682272909165, 'auprc': 0.7734993792575061, 'loss_val': 1.2224321284265647, 'psi': 0.3946338453404575}
[S8] START round=5 head_norm_before_train=1.395666 (no previous merge yet)
[S8] round=5 local utility u=0.473640 metrics={'f1_val': 0.7139808238386206, 'auprc': 0.9986038947474758, 'loss_val': 0.5760406595163426, 'psi': 0.8278300522021627}-{'f1_val': 0.7149691070173029, 'auprc': 0.7740106177877375, 'loss_val': 0.8554707747853975, 'psi': 0.7385857113254768}
[S9] START round=5 head_norm_before_train=1.229358 (no previous merge yet)
[S9] round=5 local utility u=0.045007 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8655001185607943, 'loss_val': 1.07622279118993, 'psi': 0.43103882170831537}-{'f1_val': 0.141397957139996, 'auprc': 0.8658998608135415, 'loss_val': 1.1674357866552039, 'psi': 0.4311987186094142}
[S10] START round=5 head_norm_before_train=1.368058 (no previous merge yet)
[S10] round=5 local utility u=1.000000 metrics={'f1_val': 0.700942136646399, 'auprc': 0.9762673724051527, 'loss_val': 0.48222195668630446, 'psi': 0.8110722309499006}-{'f1_val': 0.4036120185680494, 'auprc': 0.8654092874069039, 'loss_val': 0.6953499217347697, 'psi': 0.5883309261035912}
[S11] START round=5 head_norm_before_train=0.946645 cos_to_last_merge=0.9759 (last merge round=1)
[S11] round=5 local utility u=0.042011 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8148509442710784, 'loss_val': 1.151336243001573, 'psi': 0.4101885877322977}-{'f1_val': 0.14041368337311058, 'auprc': 0.8137658836330268, 'loss_val': 1.2321029381397004, 'psi': 0.4097545634770771}
[S13] START round=5 head_norm_before_train=1.363301 (no previous merge yet)
[S13] round=5 local utility u=0.000000 metrics={'f1_val': 0.37145502080491366, 'auprc': 0.6542797356886352, 'loss_val': 0.8012771673931787, 'psi': 0.48458490675840227}-{'f1_val': 0.687509390672429, 'auprc': 0.7254797503449618, 'loss_val': 0.8954762865288486, 'psi': 0.7026975345414421}
[S14] START round=5 head_norm_before_train=1.269949 (no previous merge yet)
[S14] round=5 local utility u=0.035333 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8531092715245339, 'loss_val': 1.1587209172787394, 'psi': 0.4254584203394358}-{'f1_val': 0.14035785288270378, 'auprc': 0.853341448247946, 'loss_val': 1.2300840624340432, 'psi': 0.4255512910288007}
[S15] START round=5 head_norm_before_train=0.879649 cos_to_last_merge=0.9928 (last merge round=3)
[S15] round=5 local utility u=0.029376 metrics={'f1_val': 0.38187268638998445, 'auprc': 0.797426020774662, 'loss_val': 0.8992543745814305, 'psi': 0.5480940201438554}-{'f1_val': 0.4163758395072774, 'auprc': 0.7779339675071024, 'loss_val': 1.1065496240946204, 'psi': 0.5609990907072074}
[S16] START round=5 head_norm_before_train=1.240128 (no previous merge yet)
[S16] round=5 local utility u=0.200112 metrics={'f1_val': 0.3189957371263722, 'auprc': 0.5349939013628956, 'loss_val': 1.115801325656807, 'psi': 0.40539500282098156}-{'f1_val': 0.14063745019920318, 'auprc': 0.7886414872858548, 'loss_val': 1.2068184854360713, 'psi': 0.3998390650338639}
[S17] START round=5 head_norm_before_train=1.391189 (no previous merge yet)
[S17] round=5 local utility u=0.000000 metrics={'f1_val': 0.3684546048961289, 'auprc': 0.7721389027176762, 'loss_val': 0.830742529080986, 'psi': 0.5299283240247478}-{'f1_val': 0.35657260771113186, 'auprc': 0.8287442953311219, 'loss_val': 0.8284693555494378, 'psi': 0.5454412827591278}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:49310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:49312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:49310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:49305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] → sending delta(kind=head bytes=1805) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:49316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S7] → sending delta(kind=head bytes=1789) to S3@127.0.0.1:49303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:49316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:49314
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:49315
[S11] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1789 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1805 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1798) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.871097)
[S16] loaded HEAD from S5 (vec_in norm=0.871097)
[S16] cosine check vs S5: cos=0.0180
[S16] BUFFERED delta from S5 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1797) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.261482)
[S16] loaded HEAD from S9 (vec_in norm=1.261482)
[S16] cosine check vs S9: cos=0.0089
[S16] BUFFERED delta from S9 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1805) from S2
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.499045)
[S15] loaded HEAD from S2 (vec_in norm=1.499045)
[S15] cosine check vs S2: cos=0.7317
[S15] BUFFERED delta from S2 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1797) from S16
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.273590)
[S14] loaded HEAD from S16 (vec_in norm=1.273590)
[S14] cosine check vs S16: cos=-0.0453
[S14] DROPPED delta from S16 (cos=-0.0453 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1799) from S11
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.987136)
[S15] loaded HEAD from S11 (vec_in norm=0.987136)
[S15] cosine check vs S11: cos=-0.0061
[S15] DROPPED delta from S11 (cos=-0.0061 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1800) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.521998)
[S11] loaded HEAD from S4 (vec_in norm=1.521998)
[S11] cosine check vs S4: cos=-0.1163
[S11] DROPPED delta from S4 (cos=-0.1163 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1801) from S8
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.471382)
[S9] loaded HEAD from S8 (vec_in norm=1.471382)
[S9] cosine check vs S8: cos=-0.0226
[S9] DROPPED delta from S8 (cos=-0.0226 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1799) from S10
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.456703)
[S9] loaded HEAD from S10 (vec_in norm=1.456703)
[S9] cosine check vs S10: cos=-0.0053
[S9] DROPPED delta from S10 (cos=-0.0053 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1797) from S6
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.473536)
[S8] loaded HEAD from S6 (vec_in norm=1.473536)
[S8] cosine check vs S6: cos=-0.0892
[S8] DROPPED delta from S6 (cos=-0.0892 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1796) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.303855)
[S8] loaded HEAD from S14 (vec_in norm=1.303855)
[S8] cosine check vs S14: cos=0.0316
[S8] BUFFERED delta from S14 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1799) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.952130)
[S5] loaded HEAD from S15 (vec_in norm=0.952130)
[S5] cosine check vs S15: cos=0.4083
[S5] BUFFERED delta from S15 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1789) from S7
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.316423)
[S3] loaded HEAD from S7 (vec_in norm=1.316423)
[S3] cosine check vs S7: cos=0.7038
[S3] BUFFERED delta from S7 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] ⇄ pheromone p=0.594 → S10@127.0.0.1:49311
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=5 metric=0.1398 head_norm=0.971695
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.681424e-01
[S3] stored merged vector for next round verification (round=5)
[S3] DEBUG after merge:  round=5 metric=0.1398 head_norm=1.058028 delta_norm=0.468142
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.406 → S2@127.0.0.1:49302
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=5 metric=0.1535 head_norm=0.871097
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.969948e-01
[S5] stored merged vector for next round verification (round=5)
[S5] DEBUG after merge:  round=5 metric=0.3969 head_norm=0.765295 delta_norm=0.496995
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.345 → S16@127.0.0.1:49316
[S10] ⇄ pheromone p=0.727 → S9@127.0.0.1:49310
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=5 metric=0.3819 head_norm=0.952130
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.160239e-01
[S15] stored merged vector for next round verification (round=5)
[S15] DEBUG after merge:  round=5 metric=0.6717 head_norm=1.144798 delta_norm=0.516024
[S15] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.508 → S5@127.0.0.1:49305
[S4] ⇄ pheromone p=0.608 → S11@127.0.0.1:49312
[S11] ⇄ pheromone p=0.432 → S15@127.0.0.1:49315
[S14] ⇄ pheromone p=0.335 → S8@127.0.0.1:49309
[S9] ⇄ pheromone p=0.390 → S16@127.0.0.1:49316
[S7] ⇄ pheromone p=0.341 → S3@127.0.0.1:49303
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=5 metric=0.3190 head_norm=1.273590
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.433591e-01
[S16] stored merged vector for next round verification (round=5)
[S16] DEBUG after merge:  round=5 metric=0.1406 head_norm=0.754818 delta_norm=0.743359
[S16] aggregate: ROLLBACK (f1_val pre=0.319 post=0.141 tol_abs=0.005 tol_rel=0.0)
[S16] ⇄ pheromone p=0.464 → S14@127.0.0.1:49314
[S6] ⇄ pheromone p=0.667 → S8@127.0.0.1:49309
[S2] ⇄ pheromone p=0.620 → S15@127.0.0.1:49315
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=5 metric=0.7140 head_norm=1.471382
[S8] _apply_head_vector_avg (torch): Δ‖w‖=9.674287e-01
[S8] stored merged vector for next round verification (round=5)
[S8] DEBUG after merge:  round=5 metric=0.7014 head_norm=0.998290 delta_norm=0.967429
[S8] aggregate: ROLLBACK (f1_val pre=0.714 post=0.701 tol_abs=0.005 tol_rel=0.0)
[S8] ⇄ pheromone p=0.652 → S9@127.0.0.1:49310
[S17] ⇄ pheromone p=0.461 → S3@127.0.0.1:49303
[S2] START round=6 head_norm_before_train=1.499045 (no previous merge yet)
[S2] round=6 local utility u=0.107086 metrics={'f1_val': 0.7142224911097961, 'auprc': 0.7946230591355389, 'loss_val': 0.4408482101890356, 'psi': 0.7463827183200933}-{'f1_val': 0.6998459069236436, 'auprc': 0.7678285524925206, 'loss_val': 0.4883764811248555, 'psi': 0.7270389651511944}
[S3] START round=6 head_norm_before_train=1.058028 cos_to_last_merge=1.0000 (last merge round=5)
[S3] round=6 local utility u=0.308983 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7957912348009776, 'loss_val': 1.0707579168890535, 'psi': 0.4022205332888553}-{'f1_val': 0.13984006561410703, 'auprc': 0.6138978658316783, 'loss_val': 1.1430443451232954, 'psi': 0.32946318570113553}
[S4] START round=6 head_norm_before_train=1.521998 (no previous merge yet)
[S4] round=6 local utility u=0.354535 metrics={'f1_val': 0.688281705406144, 'auprc': 0.8761715453884836, 'loss_val': 0.4201716561884228, 'psi': 0.7634376413990799}-{'f1_val': 0.6893194008216724, 'auprc': 0.6655485708826896, 'loss_val': 0.5035989844166038, 'psi': 0.6798110688460792}
[S5] START round=6 head_norm_before_train=0.765295 cos_to_last_merge=1.0000 (last merge round=5)
[S5] round=6 local utility u=1.000000 metrics={'f1_val': 0.41694544507090897, 'auprc': 0.7778229959834737, 'loss_val': 1.1448206566922916, 'psi': 0.5612964654359349}-{'f1_val': 0.1534621698572443, 'auprc': 0.6192998057663063, 'loss_val': 1.1592427287843285, 'psi': 0.3397972242208691}
[S6] START round=6 head_norm_before_train=1.473536 (no previous merge yet)
[S6] round=6 local utility u=0.000000 metrics={'f1_val': 0.6177966124664775, 'auprc': 0.7796984944251278, 'loss_val': 0.5643231333677962, 'psi': 0.6825573652499377}-{'f1_val': 0.7085954023507969, 'auprc': 0.9733716588480084, 'loss_val': 0.45249474429620223, 'psi': 0.8145059049496814}
[S7] START round=6 head_norm_before_train=1.316423 (no previous merge yet)
[S7] round=6 local utility u=0.024490 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7720960076839971, 'loss_val': 1.1277872051172977, 'psi': 0.3940724967110539}-{'f1_val': 0.14205682272909165, 'auprc': 0.7740234171843228, 'loss_val': 1.1825502077872867, 'psi': 0.39484346051118413}
[S8] START round=6 head_norm_before_train=0.998290 cos_to_last_merge=1.0000 (last merge round=5)
[S8] round=6 local utility u=0.000000 metrics={'f1_val': 0.7011901646574596, 'auprc': 0.9898551879438476, 'loss_val': 0.48777024161988985, 'psi': 0.8166561739720148}-{'f1_val': 0.7139808238386206, 'auprc': 0.9986038947474758, 'loss_val': 0.5760406595163426, 'psi': 0.8278300522021627}
[S9] START round=6 head_norm_before_train=1.261482 (no previous merge yet)
[S9] round=6 local utility u=0.900623 metrics={'f1_val': 0.41576403377768284, 'auprc': 0.86287189544928, 'loss_val': 0.9132876539475261, 'psi': 0.5946071784463217}-{'f1_val': 0.141397957139996, 'auprc': 0.8655001185607943, 'loss_val': 1.07622279118993, 'psi': 0.43103882170831537}
[S10] START round=6 head_norm_before_train=1.456703 (no previous merge yet)
[S10] round=6 local utility u=0.089207 metrics={'f1_val': 0.6926817686947103, 'auprc': 0.9982487800980341, 'loss_val': 0.32019044239215305, 'psi': 0.8149085732560398}-{'f1_val': 0.700942136646399, 'auprc': 0.9762673724051527, 'loss_val': 0.48222195668630446, 'psi': 0.8110722309499006}
[S11] START round=6 head_norm_before_train=0.987136 cos_to_last_merge=0.9623 (last merge round=1)
[S11] round=6 local utility u=1.000000 metrics={'f1_val': 0.42273739039721175, 'auprc': 0.8776434391687371, 'loss_val': 1.0235202628271467, 'psi': 0.6046998099058218}-{'f1_val': 0.14041368337311058, 'auprc': 0.8148509442710784, 'loss_val': 1.151336243001573, 'psi': 0.4101885877322977}
[S13] START round=6 head_norm_before_train=1.423813 (no previous merge yet)
[S13] round=6 local utility u=1.000000 metrics={'f1_val': 0.6763194536575505, 'auprc': 0.7817511367458194, 'loss_val': 0.5979592581270966, 'psi': 0.7184921268928581}-{'f1_val': 0.37145502080491366, 'auprc': 0.6542797356886352, 'loss_val': 0.8012771673931787, 'psi': 0.48458490675840227}
[S14] START round=6 head_norm_before_train=1.303855 (no previous merge yet)
[S14] round=6 local utility u=1.000000 metrics={'f1_val': 0.39617175030618124, 'auprc': 0.97976466767708, 'loss_val': 1.0363696520725492, 'psi': 0.6296089172545407}-{'f1_val': 0.14035785288270378, 'auprc': 0.8531092715245339, 'loss_val': 1.1587209172787394, 'psi': 0.4254584203394358}
[S15] START round=6 head_norm_before_train=1.144798 cos_to_last_merge=1.0000 (last merge round=5)
[S15] round=6 local utility u=0.000000 metrics={'f1_val': 0.41714194880853206, 'auprc': 0.6661236094522962, 'loss_val': 0.9367069802198118, 'psi': 0.5167346130660377}-{'f1_val': 0.38187268638998445, 'auprc': 0.797426020774662, 'loss_val': 0.8992543745814305, 'psi': 0.5480940201438554}
[S16] START round=6 head_norm_before_train=0.754818 cos_to_last_merge=1.0000 (last merge round=5)
[S16] round=6 local utility u=0.583910 metrics={'f1_val': 0.4173069283424069, 'auprc': 0.714071996510319, 'loss_val': 1.0750836331274363, 'psi': 0.5360129556095719}-{'f1_val': 0.3189957371263722, 'auprc': 0.5349939013628956, 'loss_val': 1.115801325656807, 'psi': 0.40539500282098156}
[S17] START round=6 head_norm_before_train=1.457714 (no previous merge yet)
[S17] round=6 local utility u=0.019541 metrics={'f1_val': 0.3709398748933813, 'auprc': 0.7795605055208217, 'loss_val': 0.8288364292691458, 'psi': 0.5343881271443575}-{'f1_val': 0.3684546048961289, 'auprc': 0.7721389027176762, 'loss_val': 0.830742529080986, 'psi': 0.5299283240247478}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.536)
[S4] not sending this round → trigger blocked (psi=0.763)
[S7] not sending this round → trigger blocked (psi=0.394)
[S2] not sending this round → trigger blocked (psi=0.746)
[S11] not sending this round → trigger blocked (psi=0.605)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S2@127.0.0.1:49302
[S5] not sending this round → trigger blocked (psi=0.561)
[S9] not sending this round → trigger blocked (psi=0.595)
[S10] not sending this round → trigger blocked (psi=0.815)
[S14] not sending this round → trigger blocked (psi=0.630)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:49311
[S3] sending update (kind=head size=1794 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1799) from S13
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.479217)
[S10] loaded HEAD from S13 (vec_in norm=1.479217)
[S10] cosine check vs S13: cos=-0.1073
[S10] DROPPED delta from S13 (cos=-0.1073 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1794) from S3
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.082541)
[S2] loaded HEAD from S3 (vec_in norm=1.082541)
[S2] cosine check vs S3: cos=0.0090
[S2] BUFFERED delta from S3 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:49303
[S17] sending update (kind=head size=1794 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1794) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.499399)
[S3] loaded HEAD from S17 (vec_in norm=1.499399)
[S3] cosine check vs S17: cos=-0.1442
[S3] DROPPED delta from S17 (cos=-0.1442 < 0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=6 metric=0.7142 head_norm=1.552204
[S2] _apply_head_vector_avg (torch): Δ‖w‖=9.422252e-01
[S2] stored merged vector for next round verification (round=6)
[S2] DEBUG after merge:  round=6 metric=0.7139 head_norm=0.950173 delta_norm=0.942225
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=0.950173 cos_to_last_merge=1.0000 (last merge round=6)
[S2] round=7 local utility u=0.255300 metrics={'f1_val': 0.7012105951167499, 'auprc': 0.9844918047072613, 'loss_val': 0.42178237225670023, 'psi': 0.8145230789529545}-{'f1_val': 0.7142224911097961, 'auprc': 0.7946230591355389, 'loss_val': 0.4408482101890356, 'psi': 0.7463827183200933}
[S3] START round=7 head_norm_before_train=1.082541 cos_to_last_merge=0.9977 (last merge round=5)
[S3] round=7 local utility u=0.850698 metrics={'f1_val': 0.40270514715362826, 'auprc': 0.7961665913260798, 'loss_val': 0.9476775779266619, 'psi': 0.5600897248226089}-{'f1_val': 0.13984006561410703, 'auprc': 0.7957912348009776, 'loss_val': 1.0707579168890535, 'psi': 0.4022205332888553}
[S4] START round=7 head_norm_before_train=1.607797 (no previous merge yet)
[S4] round=7 local utility u=0.289749 metrics={'f1_val': 0.7428583945846662, 'auprc': 0.947645447215949, 'loss_val': 0.3825557179988034, 'psi': 0.8247732156371793}-{'f1_val': 0.688281705406144, 'auprc': 0.8761715453884836, 'loss_val': 0.4201716561884228, 'psi': 0.7634376413990799}
[S5] START round=7 head_norm_before_train=0.789927 cos_to_last_merge=0.9957 (last merge round=5)
[S5] round=7 local utility u=0.055424 metrics={'f1_val': 0.41795135763108626, 'auprc': 0.7775682279917675, 'loss_val': 1.0392430770531575, 'psi': 0.5617981057753587}-{'f1_val': 0.41694544507090897, 'auprc': 0.7778229959834737, 'loss_val': 1.1448206566922916, 'psi': 0.5612964654359349}
[S6] START round=7 head_norm_before_train=1.531811 (no previous merge yet)
[S6] round=7 local utility u=0.311865 metrics={'f1_val': 0.6868424661757253, 'auprc': 0.8063842952881252, 'loss_val': 0.4349248479972892, 'psi': 0.7346591978206852}-{'f1_val': 0.6177966124664775, 'auprc': 0.7796984944251278, 'loss_val': 0.5643231333677962, 'psi': 0.6825573652499377}
[S7] START round=7 head_norm_before_train=1.335471 (no previous merge yet)
[S7] round=7 local utility u=0.822554 metrics={'f1_val': 0.4168747328879592, 'auprc': 0.741002350534797, 'loss_val': 1.0383066721226692, 'psi': 0.5465257799466943}-{'f1_val': 0.14205682272909165, 'auprc': 0.7720960076839971, 'loss_val': 1.1277872051172977, 'psi': 0.3940724967110539}
[S8] START round=7 head_norm_before_train=1.089679 cos_to_last_merge=0.9911 (last merge round=5)
[S8] round=7 local utility u=0.096815 metrics={'f1_val': 0.7145254456069222, 'auprc': 0.9962111864277259, 'loss_val': 0.3932198386928414, 'psi': 0.8271997419352437}-{'f1_val': 0.7011901646574596, 'auprc': 0.9898551879438476, 'loss_val': 0.48777024161988985, 'psi': 0.8166561739720148}
[S9] START round=7 head_norm_before_train=1.298010 (no previous merge yet)
[S9] round=7 local utility u=0.152193 metrics={'f1_val': 0.437450907031524, 'auprc': 0.8637389108695723, 'loss_val': 0.7416237549711332, 'psi': 0.6079661085667434}-{'f1_val': 0.41576403377768284, 'auprc': 0.86287189544928, 'loss_val': 0.9132876539475261, 'psi': 0.5946071784463217}
[S10] START round=7 head_norm_before_train=1.547584 (no previous merge yet)
[S10] round=7 local utility u=0.056052 metrics={'f1_val': 0.6994488052839094, 'auprc': 0.9968239007985285, 'loss_val': 0.24441400290784637, 'psi': 0.8183988434897571}-{'f1_val': 0.6926817686947103, 'auprc': 0.9982487800980341, 'loss_val': 0.32019044239215305, 'psi': 0.8149085732560398}
[S11] START round=7 head_norm_before_train=1.030139 cos_to_last_merge=0.9483 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.948
[S11] round=7 local utility u=0.140659 metrics={'f1_val': 0.3964515026091945, 'auprc': 0.9716237272856325, 'loss_val': 0.8664271888175713, 'psi': 0.6265203924797698}-{'f1_val': 0.42273739039721175, 'auprc': 0.8776434391687371, 'loss_val': 1.0235202628271467, 'psi': 0.6046998099058218}
[S13] START round=7 head_norm_before_train=1.479217 (no previous merge yet)
[S13] round=7 local utility u=0.000000 metrics={'f1_val': 0.6699546942156208, 'auprc': 0.6578040241420697, 'loss_val': 0.5725898403018687, 'psi': 0.6650944261862004}-{'f1_val': 0.6763194536575505, 'auprc': 0.7817511367458194, 'loss_val': 0.5979592581270966, 'psi': 0.7184921268928581}
[S14] START round=7 head_norm_before_train=1.341150 (no previous merge yet)
[S14] round=7 local utility u=0.496856 metrics={'f1_val': 0.5183208021264534, 'auprc': 0.9963867974573756, 'loss_val': 0.8254191201297666, 'psi': 0.7095472002588223}-{'f1_val': 0.39617175030618124, 'auprc': 0.97976466767708, 'loss_val': 1.0363696520725492, 'psi': 0.6296089172545407}
[S15] START round=7 head_norm_before_train=1.195490 cos_to_last_merge=0.9940 (last merge round=5)
[S15] round=7 local utility u=1.000000 metrics={'f1_val': 0.6970403574209588, 'auprc': 0.9880771272205858, 'loss_val': 0.6126214652598421, 'psi': 0.8134550653408097}-{'f1_val': 0.41714194880853206, 'auprc': 0.6661236094522962, 'loss_val': 0.9367069802198118, 'psi': 0.5167346130660377}
[S16] START round=7 head_norm_before_train=0.796426 cos_to_last_merge=0.9959 (last merge round=5)
[S16] round=7 local utility u=0.000000 metrics={'f1_val': 0.4170779150236796, 'auprc': 0.5556662833925374, 'loss_val': 0.9530811563214987, 'psi': 0.4725132623712227}-{'f1_val': 0.4173069283424069, 'auprc': 0.714071996510319, 'loss_val': 1.0750836331274363, 'psi': 0.5360129556095719}
[S17] START round=7 head_norm_before_train=1.499399 (no previous merge yet)
[S17] round=7 local utility u=0.102881 metrics={'f1_val': 0.3820250132764187, 'auprc': 0.7973469783601446, 'loss_val': 0.7429449623161022, 'psi': 0.548153799309909}-{'f1_val': 0.3709398748933813, 'auprc': 0.7795605055208217, 'loss_val': 0.8288364292691458, 'psi': 0.5343881271443575}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:49316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:49305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:49316
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] → sending delta(kind=head bytes=1806) to S9@127.0.0.1:49310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:49312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:49303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:49310
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S14] → sending delta(kind=head bytes=1806) to S8@127.0.0.1:49309
[S3] not sending this round → trigger blocked (psi=0.560)
[S14] sending update (kind=head size=1806 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1806 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1802) from S11
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.083362)
[S15] loaded HEAD from S11 (vec_in norm=1.083362)
[S15] cosine check vs S11: cos=0.0076
[S15] BUFFERED delta from S11 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1802) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.672332)
[S11] loaded HEAD from S4 (vec_in norm=1.672332)
[S11] cosine check vs S4: cos=-0.1148
[S11] DROPPED delta from S4 (cos=-0.1148 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1802) from S6
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.573951)
[S8] loaded HEAD from S6 (vec_in norm=1.573951)
[S8] cosine check vs S6: cos=0.0001
[S8] BUFFERED delta from S6 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1801) from S10
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.620350)
[S9] loaded HEAD from S10 (vec_in norm=1.620350)
[S9] cosine check vs S10: cos=-0.0097
[S9] DROPPED delta from S10 (cos=-0.0097 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1798) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.240983)
[S5] loaded HEAD from S15 (vec_in norm=1.240983)
[S5] cosine check vs S15: cos=0.6563
[S5] BUFFERED delta from S15 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1806) from S8
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.179036)
[S9] loaded HEAD from S8 (vec_in norm=1.179036)
[S9] cosine check vs S8: cos=-0.0373
[S9] DROPPED delta from S8 (cos=-0.0373 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1806) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.389895)
[S8] loaded HEAD from S14 (vec_in norm=1.389895)
[S8] cosine check vs S14: cos=0.5823
[S8] BUFFERED delta from S14 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1798) from S2
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.037875)
[S15] loaded HEAD from S2 (vec_in norm=1.037875)
[S15] cosine check vs S2: cos=0.7395
[S15] BUFFERED delta from S2 (total buffered=2)
[S3] RECEIVED delta(kind=head bytes=1795) from S7
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.366141)
[S3] loaded HEAD from S7 (vec_in norm=1.366141)
[S3] cosine check vs S7: cos=0.9052
[S3] BUFFERED delta from S7 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1801) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.346910)
[S16] loaded HEAD from S9 (vec_in norm=1.346910)
[S16] cosine check vs S9: cos=0.4180
[S16] BUFFERED delta from S9 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1797) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.823258)
[S16] loaded HEAD from S5 (vec_in norm=0.823258)
[S16] cosine check vs S5: cos=0.2097
[S16] BUFFERED delta from S5 (total buffered=2)
[S17] not sending this round → trigger blocked (psi=0.548)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=7 metric=0.4027 head_norm=1.116967
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.964101e-01
[S3] stored merged vector for next round verification (round=7)
[S3] DEBUG after merge:  round=7 metric=0.4227 head_norm=1.212073 delta_norm=0.296410
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=7 metric=0.6970 head_norm=1.240983
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.473679e-01
[S15] stored merged vector for next round verification (round=7)
[S15] DEBUG after merge:  round=7 metric=0.6963 head_norm=0.883696 delta_norm=0.547368
[S15] aggregate: ACCEPT kept=['S11', 'S2'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=7 metric=0.7145 head_norm=1.179036
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.467034e-01
[S8] stored merged vector for next round verification (round=7)
[S8] DEBUG after merge:  round=7 metric=0.7145 head_norm=0.946295 delta_norm=0.646703
[S8] aggregate: ACCEPT kept=['S6', 'S14'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=7 metric=0.4180 head_norm=0.823258
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.681831e-01
[S5] stored merged vector for next round verification (round=7)
[S5] DEBUG after merge:  round=7 metric=0.4178 head_norm=0.943239 delta_norm=0.468183
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=7 metric=0.4171 head_norm=0.845071
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.264897e-01
[S16] stored merged vector for next round verification (round=7)
[S16] DEBUG after merge:  round=7 metric=0.4171 head_norm=0.701946 delta_norm=0.426490
[S16] aggregate: ACCEPT kept=['S9', 'S5'] (k=2/2) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=1.037875 cos_to_last_merge=0.9911 (last merge round=6)
[S2] round=8 local utility u=0.000000 metrics={'f1_val': 0.7013111425127618, 'auprc': 0.8136236086145403, 'loss_val': 0.3417114299167663, 'psi': 0.7462361289534732}-{'f1_val': 0.7012105951167499, 'auprc': 0.9844918047072613, 'loss_val': 0.42178237225670023, 'psi': 0.8145230789529545}
[S3] START round=8 head_norm_before_train=1.212073 cos_to_last_merge=1.0000 (last merge round=7)
[S3] round=8 local utility u=0.925778 metrics={'f1_val': 0.7000757262075916, 'auprc': 0.7962068621591453, 'loss_val': 0.8804667721386094, 'psi': 0.7385281805882131}-{'f1_val': 0.40270514715362826, 'auprc': 0.7961665913260798, 'loss_val': 0.9476775779266619, 'psi': 0.5600897248226089}
[S4] START round=8 head_norm_before_train=1.672332 (no previous merge yet)
[S4] round=8 local utility u=0.741025 metrics={'f1_val': 0.9772981119323454, 'auprc': 0.9465755836012213, 'loss_val': 0.3039335571064476, 'psi': 0.9650091005998958}-{'f1_val': 0.7428583945846662, 'auprc': 0.947645447215949, 'loss_val': 0.3825557179988034, 'psi': 0.8247732156371793}
[S5] START round=8 head_norm_before_train=0.943239 cos_to_last_merge=1.0000 (last merge round=7)
[S5] round=8 local utility u=0.024458 metrics={'f1_val': 0.41770847824441854, 'auprc': 0.7772933753939335, 'loss_val': 0.9880447197564111, 'psi': 0.5615424371042246}-{'f1_val': 0.41795135763108626, 'auprc': 0.7775682279917675, 'loss_val': 1.0392430770531575, 'psi': 0.5617981057753587}
[S6] START round=8 head_norm_before_train=1.573951 (no previous merge yet)
[S6] round=8 local utility u=1.000000 metrics={'f1_val': 0.9608401381346896, 'auprc': 0.9603224808396569, 'loss_val': 0.2639870949523354, 'psi': 0.9606330752166765}-{'f1_val': 0.6868424661757253, 'auprc': 0.8063842952881252, 'loss_val': 0.4349248479972892, 'psi': 0.7346591978206852}
[S7] START round=8 head_norm_before_train=1.366141 (no previous merge yet)
[S7] round=8 local utility u=0.328273 metrics={'f1_val': 0.49722882680045777, 'auprc': 0.7623050144295136, 'loss_val': 0.9277936455082832, 'psi': 0.6032593018520801}-{'f1_val': 0.4168747328879592, 'auprc': 0.741002350534797, 'loss_val': 1.0383066721226692, 'psi': 0.5465257799466943}
[S8] START round=8 head_norm_before_train=0.946295 cos_to_last_merge=1.0000 (last merge round=7)
[S8] round=8 local utility u=0.000000 metrics={'f1_val': 0.7143033874680186, 'auprc': 0.9969963254390434, 'loss_val': 0.4195690421318575, 'psi': 0.8273805626564286}-{'f1_val': 0.7145254456069222, 'auprc': 0.9962111864277259, 'loss_val': 0.3932198386928414, 'psi': 0.8271997419352437}
[S9] START round=8 head_norm_before_train=1.346910 (no previous merge yet)
[S9] round=8 local utility u=1.000000 metrics={'f1_val': 0.7015406642019387, 'auprc': 0.9995852640597079, 'loss_val': 0.599254461210784, 'psi': 0.8207585041450465}-{'f1_val': 0.437450907031524, 'auprc': 0.8637389108695723, 'loss_val': 0.7416237549711332, 'psi': 0.6079661085667434}
[S10] START round=8 head_norm_before_train=1.620350 (no previous merge yet)
[S10] round=8 local utility u=0.292094 metrics={'f1_val': 0.8297966476164592, 'auprc': 0.9554354187939961, 'loss_val': 0.31814782375864, 'psi': 0.880052156087474}-{'f1_val': 0.6994488052839094, 'auprc': 0.9968239007985285, 'loss_val': 0.24441400290784637, 'psi': 0.8183988434897571}
[S11] START round=8 head_norm_before_train=1.083362 cos_to_last_merge=0.9317 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.932
[S11] round=8 local utility u=0.119739 metrics={'f1_val': 0.39976376621388054, 'auprc': 0.9954292281267945, 'loss_val': 0.7182383692371646, 'psi': 0.6380299509790461}-{'f1_val': 0.3964515026091945, 'auprc': 0.9716237272856325, 'loss_val': 0.8664271888175713, 'psi': 0.6265203924797698}
[S13] START round=8 head_norm_before_train=1.532873 (no previous merge yet)
[S13] round=8 local utility u=0.000000 metrics={'f1_val': 0.6275123238693486, 'auprc': 0.6162930101169843, 'loss_val': 0.5788693718859536, 'psi': 0.623024598368403}-{'f1_val': 0.6699546942156208, 'auprc': 0.6578040241420697, 'loss_val': 0.5725898403018687, 'psi': 0.6650944261862004}
[S14] START round=8 head_norm_before_train=1.389895 (no previous merge yet)
[S14] round=8 local utility u=0.000000 metrics={'f1_val': 0.4120192555029442, 'auprc': 0.9824784919257036, 'loss_val': 0.6527557253604998, 'psi': 0.640202950072048}-{'f1_val': 0.5183208021264534, 'auprc': 0.9963867974573756, 'loss_val': 0.8254191201297666, 'psi': 0.7095472002588223}
[S15] START round=8 head_norm_before_train=0.883696 cos_to_last_merge=1.0000 (last merge round=7)
[S15] round=8 local utility u=0.000000 metrics={'f1_val': 0.6937862743929353, 'auprc': 0.924977677663146, 'loss_val': 0.6335195927444348, 'psi': 0.7862628357010195}-{'f1_val': 0.6970403574209588, 'auprc': 0.9880771272205858, 'loss_val': 0.6126214652598421, 'psi': 0.8134550653408097}
[S16] START round=8 head_norm_before_train=0.701946 cos_to_last_merge=1.0000 (last merge round=7)
[S16] round=8 local utility u=0.268075 metrics={'f1_val': 0.41696372269722326, 'auprc': 0.7365469523063197, 'loss_val': 0.9588881592242083, 'psi': 0.5447970145408618}-{'f1_val': 0.4170779150236796, 'auprc': 0.5556662833925374, 'loss_val': 0.9530811563214987, 'psi': 0.4725132623712227}
[S17] START round=8 head_norm_before_train=1.523059 (no previous merge yet)
[S17] round=8 local utility u=0.300951 metrics={'f1_val': 0.3931523719693707, 'auprc': 0.9375796469907283, 'loss_val': 0.6285050257032263, 'psi': 0.6109232819779137}-{'f1_val': 0.3820250132764187, 'auprc': 0.7973469783601446, 'loss_val': 0.7429449623161022, 'psi': 0.548153799309909}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:49316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S3] → sending delta(kind=head bytes=1791) to S2@127.0.0.1:49302
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] → sending delta(kind=head bytes=1793) to S3@127.0.0.1:49303
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:49316
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:49314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:49312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:49310
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:49315
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1793 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1791 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1799) from S16
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.740262)
[S14] loaded HEAD from S16 (vec_in norm=0.740262)
[S14] cosine check vs S16: cos=-0.1544
[S14] DROPPED delta from S16 (cos=-0.1544 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1801) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.711236)
[S11] loaded HEAD from S4 (vec_in norm=1.711236)
[S11] cosine check vs S4: cos=-0.1116
[S11] DROPPED delta from S4 (cos=-0.1116 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1801) from S10
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.674183)
[S9] loaded HEAD from S10 (vec_in norm=1.674183)
[S9] cosine check vs S10: cos=-0.0109
[S9] DROPPED delta from S10 (cos=-0.0109 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1800) from S6
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.599205)
[S8] loaded HEAD from S6 (vec_in norm=1.599205)
[S8] cosine check vs S6: cos=0.4183
[S8] BUFFERED delta from S6 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1791) from S3
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.243258)
[S2] loaded HEAD from S3 (vec_in norm=1.243258)
[S2] cosine check vs S3: cos=0.4921
[S2] BUFFERED delta from S3 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1793) from S7
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.400555)
[S3] loaded HEAD from S7 (vec_in norm=1.400555)
[S3] cosine check vs S7: cos=0.9637
[S3] BUFFERED delta from S7 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1797) from S11
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.142021)
[S15] loaded HEAD from S11 (vec_in norm=1.142021)
[S15] cosine check vs S11: cos=0.3040
[S15] BUFFERED delta from S11 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1797) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.402698)
[S16] loaded HEAD from S9 (vec_in norm=1.402698)
[S16] cosine check vs S9: cos=0.7126
[S16] BUFFERED delta from S9 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1798) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.970428)
[S16] loaded HEAD from S5 (vec_in norm=0.970428)
[S16] cosine check vs S5: cos=0.2925
[S16] BUFFERED delta from S5 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] → sending delta(kind=head bytes=1793) to S3@127.0.0.1:49303
[S17] sending update (kind=head size=1793 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1793) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.544950)
[S3] loaded HEAD from S17 (vec_in norm=1.544950)
[S3] cosine check vs S17: cos=-0.1210
[S3] DROPPED delta from S17 (cos=-0.1210 < 0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=8 metric=0.7143 head_norm=1.020785
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.472678e-01
[S8] stored merged vector for next round verification (round=8)
[S8] DEBUG after merge:  round=8 metric=0.3358 head_norm=1.114145 delta_norm=0.747268
[S8] aggregate: ROLLBACK (f1_val pre=0.714 post=0.336 tol_abs=0.005 tol_rel=0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=8 metric=0.7013 head_norm=1.145605
[S2] _apply_head_vector_avg (torch): Δ‖w‖=6.033826e-01
[S2] stored merged vector for next round verification (round=8)
[S2] DEBUG after merge:  round=8 metric=0.7015 head_norm=1.031978 delta_norm=0.603383
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=8 metric=0.6938 head_norm=0.956110
[S15] _apply_head_vector_avg (torch): Δ‖w‖=6.233968e-01
[S15] stored merged vector for next round verification (round=8)
[S15] DEBUG after merge:  round=8 metric=0.6973 head_norm=0.848855 delta_norm=0.623397
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=8 metric=0.4170 head_norm=0.740262
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.808505e-01
[S16] stored merged vector for next round verification (round=8)
[S16] DEBUG after merge:  round=8 metric=0.4170 head_norm=0.744260 delta_norm=0.280850
[S16] aggregate: ACCEPT kept=['S9', 'S5'] (k=2/2) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=8 metric=0.7001 head_norm=1.243258
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.943095e-01
[S3] stored merged vector for next round verification (round=8)
[S3] DEBUG after merge:  round=8 metric=0.7003 head_norm=1.309910 delta_norm=0.194310
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.031978 cos_to_last_merge=1.0000 (last merge round=8)
[S2] round=9 local utility u=0.000000 metrics={'f1_val': 0.701132579636681, 'auprc': 0.7965472185688331, 'loss_val': 0.39958455388302694, 'psi': 0.7392984352095419}-{'f1_val': 0.7013111425127618, 'auprc': 0.8136236086145403, 'loss_val': 0.3417114299167663, 'psi': 0.7462361289534732}
[S3] START round=9 head_norm_before_train=1.309910 cos_to_last_merge=1.0000 (last merge round=8)
[S3] round=9 local utility u=0.071039 metrics={'f1_val': 0.700330919019862, 'auprc': 0.826168443628639, 'loss_val': 0.8298052688701345, 'psi': 0.7506659288633728}-{'f1_val': 0.7000757262075916, 'auprc': 0.7962068621591453, 'loss_val': 0.8804667721386094, 'psi': 0.7385281805882131}
[S4] START round=9 head_norm_before_train=1.711236 (no previous merge yet)
[S4] round=9 local utility u=0.000000 metrics={'f1_val': 0.9533984784976571, 'auprc': 0.9664815326799683, 'loss_val': 0.23303129548300575, 'psi': 0.9586317001705816}-{'f1_val': 0.9772981119323454, 'auprc': 0.9465755836012213, 'loss_val': 0.3039335571064476, 'psi': 0.9650091005998958}
[S5] START round=9 head_norm_before_train=0.970428 cos_to_last_merge=0.9965 (last merge round=7)
[S5] round=9 local utility u=0.023081 metrics={'f1_val': 0.4175465518408786, 'auprc': 0.7551654193378364, 'loss_val': 0.8745278926424728, 'psi': 0.5525940988396618}-{'f1_val': 0.41770847824441854, 'auprc': 0.7772933753939335, 'loss_val': 0.9880447197564111, 'psi': 0.5615424371042246}
[S6] START round=9 head_norm_before_train=1.599205 (no previous merge yet)
[S6] round=9 local utility u=0.000000 metrics={'f1_val': 0.7321311405519594, 'auprc': 0.8105016850710289, 'loss_val': 0.3841050185725554, 'psi': 0.7634793583595871}-{'f1_val': 0.9608401381346896, 'auprc': 0.9603224808396569, 'loss_val': 0.2639870949523354, 'psi': 0.9606330752166765}
[S7] START round=9 head_norm_before_train=1.400555 (no previous merge yet)
[S7] round=9 local utility u=0.054903 metrics={'f1_val': 0.5319076543136517, 'auprc': 0.7159269826978377, 'loss_val': 0.8869266375651315, 'psi': 0.6055153856673261}-{'f1_val': 0.49722882680045777, 'auprc': 0.7623050144295136, 'loss_val': 0.9277936455082832, 'psi': 0.6032593018520801}
[S8] START round=9 head_norm_before_train=1.114145 cos_to_last_merge=1.0000 (last merge round=8)
[S8] round=9 local utility u=0.000000 metrics={'f1_val': 0.7143033874680186, 'auprc': 0.9926766012511743, 'loss_val': 0.554037295274224, 'psi': 0.8256526729812809}-{'f1_val': 0.7143033874680186, 'auprc': 0.9969963254390434, 'loss_val': 0.4195690421318575, 'psi': 0.8273805626564286}
[S9] START round=9 head_norm_before_train=1.402698 (no previous merge yet)
[S9] round=9 local utility u=0.000000 metrics={'f1_val': 0.6606182039941267, 'auprc': 0.9942453829755491, 'loss_val': 0.4693187063781006, 'psi': 0.7940690755866957}-{'f1_val': 0.7015406642019387, 'auprc': 0.9995852640597079, 'loss_val': 0.599254461210784, 'psi': 0.8207585041450465}
[S10] START round=9 head_norm_before_train=1.674183 (no previous merge yet)
[S10] round=9 local utility u=0.609024 metrics={'f1_val': 0.9930849305540487, 'auprc': 0.9945125511784569, 'loss_val': 0.19706081681227605, 'psi': 0.993655978803812}-{'f1_val': 0.8297966476164592, 'auprc': 0.9554354187939961, 'loss_val': 0.31814782375864, 'psi': 0.880052156087474}
[S11] START round=9 head_norm_before_train=1.142021 cos_to_last_merge=0.9145 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.914
[S11] round=9 local utility u=0.906178 metrics={'f1_val': 0.6705355845093317, 'auprc': 0.9968923588202564, 'loss_val': 0.5349018536102249, 'psi': 0.8010782942337016}-{'f1_val': 0.39976376621388054, 'auprc': 0.9954292281267945, 'loss_val': 0.7182383692371646, 'psi': 0.6380299509790461}
[S13] START round=9 head_norm_before_train=1.565289 (no previous merge yet)
[S13] round=9 local utility u=0.105477 metrics={'f1_val': 0.6234960900516912, 'auprc': 0.6899007566123035, 'loss_val': 0.564641619808689, 'psi': 0.6500579566759361}-{'f1_val': 0.6275123238693486, 'auprc': 0.6162930101169843, 'loss_val': 0.5788693718859536, 'psi': 0.623024598368403}
[S14] START round=9 head_norm_before_train=1.440191 (no previous merge yet)
[S14] round=9 local utility u=0.936548 metrics={'f1_val': 0.6941639625631658, 'auprc': 0.9925395510704348, 'loss_val': 0.5027108159365953, 'psi': 0.8135141979660734}-{'f1_val': 0.4120192555029442, 'auprc': 0.9824784919257036, 'loss_val': 0.6527557253604998, 'psi': 0.640202950072048}
[S15] START round=9 head_norm_before_train=0.848855 cos_to_last_merge=1.0000 (last merge round=8)
[S15] round=9 local utility u=0.088736 metrics={'f1_val': 0.696695757245951, 'auprc': 0.9736736289808696, 'loss_val': 0.6195928462986307, 'psi': 0.8074869059399185}-{'f1_val': 0.6937862743929353, 'auprc': 0.924977677663146, 'loss_val': 0.6335195927444348, 'psi': 0.7862628357010195}
[S16] START round=9 head_norm_before_train=0.744260 cos_to_last_merge=1.0000 (last merge round=8)
[S16] round=9 local utility u=0.048105 metrics={'f1_val': 0.4290089217786053, 'auprc': 0.7407446103987498, 'loss_val': 0.9475416566006529, 'psi': 0.5537031972266631}-{'f1_val': 0.41696372269722326, 'auprc': 0.7365469523063197, 'loss_val': 0.9588881592242083, 'psi': 0.5447970145408618}
[S17] START round=9 head_norm_before_train=1.544950 (no previous merge yet)
[S17] round=9 local utility u=0.140575 metrics={'f1_val': 0.40718573928419444, 'auprc': 0.9731560675936202, 'loss_val': 0.5382850533524643, 'psi': 0.6335738706079648}-{'f1_val': 0.3931523719693707, 'auprc': 0.9375796469907283, 'loss_val': 0.6285050257032263, 'psi': 0.6109232819779137}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S7] → sending delta(kind=head bytes=1791) to S3@127.0.0.1:49303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:49310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:49311
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:49314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:49305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:49316
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S2@127.0.0.1:49302
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:49315
[S5] sending update (kind=head size=1793 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1794 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1791 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1791) from S7
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.429989)
[S3] loaded HEAD from S7 (vec_in norm=1.429989)
[S3] cosine check vs S7: cos=0.9784
[S3] BUFFERED delta from S7 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1795) from S16
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.780024)
[S14] loaded HEAD from S16 (vec_in norm=0.780024)
[S14] cosine check vs S16: cos=-0.1570
[S14] DROPPED delta from S16 (cos=-0.1570 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1799) from S13
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.591573)
[S10] loaded HEAD from S13 (vec_in norm=1.591573)
[S10] cosine check vs S13: cos=-0.0943
[S10] DROPPED delta from S13 (cos=-0.0943 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1800) from S10
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.722969)
[S9] loaded HEAD from S10 (vec_in norm=1.722969)
[S9] cosine check vs S10: cos=-0.0114
[S9] DROPPED delta from S10 (cos=-0.0114 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1797) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.486620)
[S8] loaded HEAD from S14 (vec_in norm=1.486620)
[S8] cosine check vs S14: cos=0.4166
[S8] BUFFERED delta from S14 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1795) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.918308)
[S5] loaded HEAD from S15 (vec_in norm=0.918308)
[S5] cosine check vs S15: cos=0.5563
[S5] BUFFERED delta from S15 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1794) from S3
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.340803)
[S2] loaded HEAD from S3 (vec_in norm=1.340803)
[S2] cosine check vs S3: cos=0.8178
[S2] BUFFERED delta from S3 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1793) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.007882)
[S16] loaded HEAD from S5 (vec_in norm=1.007882)
[S16] cosine check vs S5: cos=0.4281
[S16] BUFFERED delta from S5 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1802) from S11
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.198564)
[S15] loaded HEAD from S11 (vec_in norm=1.198564)
[S15] cosine check vs S11: cos=0.7713
[S15] BUFFERED delta from S11 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:49303
[S17] sending update (kind=head size=1800 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1800) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.570067)
[S3] loaded HEAD from S17 (vec_in norm=1.570067)
[S3] cosine check vs S17: cos=-0.1059
[S3] DROPPED delta from S17 (cos=-0.1059 < 0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=9 metric=0.7011 head_norm=1.117548
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.859235e-01
[S2] stored merged vector for next round verification (round=9)
[S2] DEBUG after merge:  round=9 metric=0.7013 head_norm=1.172346 delta_norm=0.385924
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=9 metric=0.7143 head_norm=1.159100
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.276607e-01
[S8] stored merged vector for next round verification (round=9)
[S8] DEBUG after merge:  round=9 metric=0.7202 head_norm=1.116820 delta_norm=0.727661
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=9 metric=0.6967 head_norm=0.918308
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.814315e-01
[S15] stored merged vector for next round verification (round=9)
[S15] DEBUG after merge:  round=9 metric=0.6975 head_norm=0.997213 delta_norm=0.381431
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=9 metric=0.4290 head_norm=0.780024
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.876463e-01
[S16] stored merged vector for next round verification (round=9)
[S16] DEBUG after merge:  round=9 metric=0.4170 head_norm=0.757847 delta_norm=0.487646
[S16] aggregate: ROLLBACK (f1_val pre=0.429 post=0.417 tol_abs=0.005 tol_rel=0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=9 metric=0.7003 head_norm=1.340803
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.506101e-01
[S3] stored merged vector for next round verification (round=9)
[S3] DEBUG after merge:  round=9 metric=0.7006 head_norm=1.377906 delta_norm=0.150610
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=9 metric=0.4175 head_norm=1.007882
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.553455e-01
[S5] stored merged vector for next round verification (round=9)
[S5] DEBUG after merge:  round=9 metric=0.4177 head_norm=0.849834 delta_norm=0.455345
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.172346 cos_to_last_merge=1.0000 (last merge round=9)
[S2] round=10 local utility u=0.000000 metrics={'f1_val': 0.7013051431189498, 'auprc': 0.7841426978952581, 'loss_val': 0.4099808978119253, 'psi': 0.7344401650294732}-{'f1_val': 0.701132579636681, 'auprc': 0.7965472185688331, 'loss_val': 0.39958455388302694, 'psi': 0.7392984352095419}
[S3] START round=10 head_norm_before_train=1.377906 cos_to_last_merge=1.0000 (last merge round=9)
[S3] round=10 local utility u=0.114562 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.8420331677569612, 'loss_val': 0.650827501415891, 'psi': 0.7572669893439643}-{'f1_val': 0.700330919019862, 'auprc': 0.826168443628639, 'loss_val': 0.8298052688701345, 'psi': 0.7506659288633728}
[S4] START round=10 head_norm_before_train=1.754248 (no previous merge yet)
[S4] round=10 local utility u=0.034579 metrics={'f1_val': 0.9539169453521255, 'auprc': 0.9730602989282093, 'loss_val': 0.18672072788716104, 'psi': 0.9615742867825591}-{'f1_val': 0.9533984784976571, 'auprc': 0.9664815326799683, 'loss_val': 0.23303129548300575, 'psi': 0.9586317001705816}
[S5] START round=10 head_norm_before_train=0.849834 cos_to_last_merge=1.0000 (last merge round=9)
[S5] round=10 local utility u=0.000000 metrics={'f1_val': 0.4175465518408786, 'auprc': 0.6695123090989661, 'loss_val': 0.8801558152334489, 'psi': 0.5183328547441136}-{'f1_val': 0.4175465518408786, 'auprc': 0.7551654193378364, 'loss_val': 0.8745278926424728, 'psi': 0.5525940988396618}
[S6] START round=10 head_norm_before_train=1.621142 (no previous merge yet)
[S6] round=10 local utility u=0.000000 metrics={'f1_val': 0.670397048034191, 'auprc': 0.8333795524366702, 'loss_val': 0.35052083471843887, 'psi': 0.7355900497951826}-{'f1_val': 0.7321311405519594, 'auprc': 0.8105016850710289, 'loss_val': 0.3841050185725554, 'psi': 0.7634793583595871}
[S7] START round=10 head_norm_before_train=1.429989 (no previous merge yet)
[S7] round=10 local utility u=0.311835 metrics={'f1_val': 0.5942579433253959, 'auprc': 0.7654857373953146, 'loss_val': 0.7860352418289558, 'psi': 0.6627490609533634}-{'f1_val': 0.5319076543136517, 'auprc': 0.7159269826978377, 'loss_val': 0.8869266375651315, 'psi': 0.6055153856673261}
[S8] START round=10 head_norm_before_train=1.116820 cos_to_last_merge=1.0000 (last merge round=9)
[S8] round=10 local utility u=0.931880 metrics={'f1_val': 0.9945675919922159, 'auprc': 0.9955690529765303, 'loss_val': 0.380539505636004, 'psi': 0.9949681763859417}-{'f1_val': 0.7143033874680186, 'auprc': 0.9926766012511743, 'loss_val': 0.554037295274224, 'psi': 0.8256526729812809}
[S9] START round=10 head_norm_before_train=1.461711 (no previous merge yet)
[S9] round=10 local utility u=0.190682 metrics={'f1_val': 0.7011143398254496, 'auprc': 0.9993455543324609, 'loss_val': 0.34623259610158924, 'psi': 0.8204068256282541}-{'f1_val': 0.6606182039941267, 'auprc': 0.9942453829755491, 'loss_val': 0.4693187063781006, 'psi': 0.7940690755866957}
[S10] START round=10 head_norm_before_train=1.722969 (no previous merge yet)
[S10] round=10 local utility u=0.059622 metrics={'f1_val': 0.993705525296829, 'auprc': 0.9972807362006384, 'loss_val': 0.08984554712798326, 'psi': 0.9951356096583528}-{'f1_val': 0.9930849305540487, 'auprc': 0.9945125511784569, 'loss_val': 0.19706081681227605, 'psi': 0.993655978803812}
[S11] START round=10 head_norm_before_train=1.198564 cos_to_last_merge=0.8987 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.899
[S11] round=10 local utility u=0.183593 metrics={'f1_val': 0.7020007759458987, 'auprc': 0.9986727131795834, 'loss_val': 0.3618486289791378, 'psi': 0.8206695508393727}-{'f1_val': 0.6705355845093317, 'auprc': 0.9968923588202564, 'loss_val': 0.5349018536102249, 'psi': 0.8010782942337016}
[S13] START round=10 head_norm_before_train=1.591573 (no previous merge yet)
[S13] round=10 local utility u=0.000000 metrics={'f1_val': 0.625433266641575, 'auprc': 0.6766139509677939, 'loss_val': 0.5782080322266564, 'psi': 0.6459055403720625}-{'f1_val': 0.6234960900516912, 'auprc': 0.6899007566123035, 'loss_val': 0.564641619808689, 'psi': 0.6500579566759361}
[S14] START round=10 head_norm_before_train=1.486620 (no previous merge yet)
[S14] round=10 local utility u=0.798723 metrics={'f1_val': 0.9283873481990949, 'auprc': 0.9988716465757818, 'loss_val': 0.32960082254020523, 'psi': 0.9565810675497697}-{'f1_val': 0.6941639625631658, 'auprc': 0.9925395510704348, 'loss_val': 0.5027108159365953, 'psi': 0.8135141979660734}
[S15] START round=10 head_norm_before_train=0.997213 cos_to_last_merge=1.0000 (last merge round=9)
[S15] round=10 local utility u=0.000000 metrics={'f1_val': 0.6925447113180185, 'auprc': 0.801521862773424, 'loss_val': 0.584165768475423, 'psi': 0.7361355719001808}-{'f1_val': 0.696695757245951, 'auprc': 0.9736736289808696, 'loss_val': 0.6195928462986307, 'psi': 0.8074869059399185}
[S16] START round=10 head_norm_before_train=0.757847 cos_to_last_merge=1.0000 (last merge round=9)
[S16] round=10 local utility u=0.024952 metrics={'f1_val': 0.4358416687275543, 'auprc': 0.7612470369675497, 'loss_val': 1.0001409989460894, 'psi': 0.5660038160235525}-{'f1_val': 0.4290089217786053, 'auprc': 0.7407446103987498, 'loss_val': 0.9475416566006529, 'psi': 0.5537031972266631}
[S17] START round=10 head_norm_before_train=1.570067 (no previous merge yet)
[S17] round=10 local utility u=0.000000 metrics={'f1_val': 0.5199175537491176, 'auprc': 0.7935200073474961, 'loss_val': 1.324777425808653, 'psi': 0.629358535188469}-{'f1_val': 0.40718573928419444, 'auprc': 0.9731560675936202, 'loss_val': 0.5382850533524643, 'psi': 0.6335738706079648}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:49316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S11@127.0.0.1:49312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:49314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:49309
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:49310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:49302
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:49315
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:49310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:49303
[S3] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1794 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1803) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.799428)
[S11] loaded HEAD from S4 (vec_in norm=1.799428)
[S11] cosine check vs S4: cos=-0.1006
[S11] DROPPED delta from S4 (cos=-0.1006 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1804) from S10
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.759071)
[S9] loaded HEAD from S10 (vec_in norm=1.759071)
[S9] cosine check vs S10: cos=-0.0131
[S9] DROPPED delta from S10 (cos=-0.0131 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1801) from S8
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.175496)
[S9] loaded HEAD from S8 (vec_in norm=1.175496)
[S9] cosine check vs S8: cos=-0.0598
[S9] DROPPED delta from S8 (cos=-0.0598 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1794) from S16
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.782304)
[S14] loaded HEAD from S16 (vec_in norm=0.782304)
[S14] cosine check vs S16: cos=-0.1511
[S14] DROPPED delta from S16 (cos=-0.1511 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1799) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.532630)
[S8] loaded HEAD from S14 (vec_in norm=1.532630)
[S8] cosine check vs S14: cos=0.8523
[S8] BUFFERED delta from S14 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1796) from S3
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.411626)
[S2] loaded HEAD from S3 (vec_in norm=1.411626)
[S2] cosine check vs S3: cos=0.9168
[S2] BUFFERED delta from S3 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1797) from S7
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.463764)
[S3] loaded HEAD from S7 (vec_in norm=1.463764)
[S3] cosine check vs S7: cos=0.9827
[S3] BUFFERED delta from S7 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1798) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.516898)
[S16] loaded HEAD from S9 (vec_in norm=1.516898)
[S16] cosine check vs S9: cos=0.4191
[S16] BUFFERED delta from S9 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1802) from S11
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.257433)
[S15] loaded HEAD from S11 (vec_in norm=1.257433)
[S15] cosine check vs S11: cos=0.9028
[S15] BUFFERED delta from S11 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] ⇄ pheromone p=0.207 → S16@127.0.0.1:49316
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=10 metric=0.7013 head_norm=1.251936
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.827139e-01
[S2] stored merged vector for next round verification (round=10)
[S2] DEBUG after merge:  round=10 metric=0.7013 head_norm=1.303874 delta_norm=0.282714
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.238 → S15@127.0.0.1:49315
[S6] ⇄ pheromone p=0.379 → S8@127.0.0.1:49309
[S13] ⇄ pheromone p=0.294 → S10@127.0.0.1:49311
[S10] ⇄ pheromone p=0.398 → S9@127.0.0.1:49310
[S11] ⇄ pheromone p=0.435 → S15@127.0.0.1:49315
[S4] ⇄ pheromone p=0.360 → S11@127.0.0.1:49312
[S7] ⇄ pheromone p=0.311 → S3@127.0.0.1:49303
[S14] ⇄ pheromone p=0.552 → S8@127.0.0.1:49309
[S9] ⇄ pheromone p=0.383 → S16@127.0.0.1:49316
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=10 metric=0.7008 head_norm=1.411626
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.360405e-01
[S3] stored merged vector for next round verification (round=10)
[S3] DEBUG after merge:  round=10 metric=0.7008 head_norm=1.431481 delta_norm=0.136040
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.398 → S2@127.0.0.1:49302
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=10 metric=0.4358 head_norm=0.782304
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.924952e-01
[S16] stored merged vector for next round verification (round=10)
[S16] DEBUG after merge:  round=10 metric=0.4370 head_norm=0.988403 delta_norm=0.692495
[S16] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.247 → S14@127.0.0.1:49314
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=10 metric=0.9946 head_norm=1.175496
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.060785e-01
[S8] stored merged vector for next round verification (round=10)
[S8] DEBUG after merge:  round=10 metric=0.9944 head_norm=1.304022 delta_norm=0.406079
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.410 → S9@127.0.0.1:49310
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=10 metric=0.6925 head_norm=1.056329
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.732154e-01
[S15] stored merged vector for next round verification (round=10)
[S15] DEBUG after merge:  round=10 metric=0.6927 head_norm=1.128644 delta_norm=0.273215
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.283 → S5@127.0.0.1:49305
[S17] ⇄ pheromone p=0.224 → S3@127.0.0.1:49303
[S2] START round=11 head_norm_before_train=1.303874 cos_to_last_merge=1.0000 (last merge round=10)
[S2] round=11 local utility u=0.000000 metrics={'f1_val': 0.7013083232172098, 'auprc': 0.6959011630162746, 'loss_val': 0.37941000158226834, 'psi': 0.6991454591368358}-{'f1_val': 0.7013051431189498, 'auprc': 0.7841426978952581, 'loss_val': 0.4099808978119253, 'psi': 0.7344401650294732}
[S3] START round=11 head_norm_before_train=1.431481 cos_to_last_merge=1.0000 (last merge round=10)
[S3] round=11 local utility u=0.060486 metrics={'f1_val': 0.7005813959920884, 'auprc': 0.8631194238436531, 'loss_val': 0.5920654594987631, 'psi': 0.7655966071327143}-{'f1_val': 0.7007562037352997, 'auprc': 0.8420331677569612, 'loss_val': 0.650827501415891, 'psi': 0.7572669893439643}
[S4] START round=11 head_norm_before_train=1.799428 (no previous merge yet)
[S4] round=11 local utility u=0.000000 metrics={'f1_val': 0.9508877690395983, 'auprc': 0.9727467835628536, 'loss_val': 0.18148578954526534, 'psi': 0.9596313748489004}-{'f1_val': 0.9539169453521255, 'auprc': 0.9730602989282093, 'loss_val': 0.18672072788716104, 'psi': 0.9615742867825591}
[S5] START round=11 head_norm_before_train=0.879356 cos_to_last_merge=0.9969 (last merge round=9)
[S5] round=11 local utility u=0.449797 metrics={'f1_val': 0.4362925695971138, 'auprc': 0.8910641858531596, 'loss_val': 0.7576940761249082, 'psi': 0.6182012160995322}-{'f1_val': 0.4175465518408786, 'auprc': 0.6695123090989661, 'loss_val': 0.8801558152334489, 'psi': 0.5183328547441136}
[S6] START round=11 head_norm_before_train=1.650770 (no previous merge yet)
[S6] round=11 local utility u=0.653767 metrics={'f1_val': 0.8228297850896743, 'auprc': 0.9564761727963199, 'loss_val': 0.3268722174499282, 'psi': 0.8762883401723326}-{'f1_val': 0.670397048034191, 'auprc': 0.8333795524366702, 'loss_val': 0.35052083471843887, 'psi': 0.7355900497951826}
[S7] START round=11 head_norm_before_train=1.463764 (no previous merge yet)
[S7] round=11 local utility u=0.000000 metrics={'f1_val': 0.41808043974165904, 'auprc': 0.7647572976234812, 'loss_val': 0.8099720270560061, 'psi': 0.5567511828943879}-{'f1_val': 0.5942579433253959, 'auprc': 0.7654857373953146, 'loss_val': 0.7860352418289558, 'psi': 0.6627490609533634}
[S8] START round=11 head_norm_before_train=1.304022 cos_to_last_merge=1.0000 (last merge round=10)
[S8] round=11 local utility u=0.044073 metrics={'f1_val': 0.9944244324421787, 'auprc': 0.9968767049330834, 'loss_val': 0.29545729062595183, 'psi': 0.9954053414385405}-{'f1_val': 0.9945675919922159, 'auprc': 0.9955690529765303, 'loss_val': 0.380539505636004, 'psi': 0.9949681763859417}
[S9] START round=11 head_norm_before_train=1.516898 (no previous merge yet)
[S9] round=11 local utility u=0.042194 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.99866660137679, 'loss_val': 0.2608649656753486, 'psi': 0.820240930675254}-{'f1_val': 0.7011143398254496, 'auprc': 0.9993455543324609, 'loss_val': 0.34623259610158924, 'psi': 0.8204068256282541}
[S10] START round=11 head_norm_before_train=1.759071 (no previous merge yet)
[S10] round=11 local utility u=0.004024 metrics={'f1_val': 0.9937713708662497, 'auprc': 0.9955098294154745, 'loss_val': 0.07688066726522957, 'psi': 0.9944667542859397}-{'f1_val': 0.993705525296829, 'auprc': 0.9972807362006384, 'loss_val': 0.08984554712798326, 'psi': 0.9951356096583528}
[S11] START round=11 head_norm_before_train=1.257433 cos_to_last_merge=0.8834 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.883
[S11] round=11 local utility u=0.790920 metrics={'f1_val': 0.9547615849080358, 'auprc': 0.998699524940083, 'loss_val': 0.29665480951855366, 'psi': 0.9723367609208546}-{'f1_val': 0.7020007759458987, 'auprc': 0.9986727131795834, 'loss_val': 0.3618486289791378, 'psi': 0.8206695508393727}
[S13] START round=11 head_norm_before_train=1.615735 (no previous merge yet)
[S13] round=11 local utility u=0.000000 metrics={'f1_val': 0.6018694853719786, 'auprc': 0.6823323020635392, 'loss_val': 0.6928986895243463, 'psi': 0.6340546120486028}-{'f1_val': 0.625433266641575, 'auprc': 0.6766139509677939, 'loss_val': 0.5782080322266564, 'psi': 0.6459055403720625}
[S14] START round=11 head_norm_before_train=1.532630 (no previous merge yet)
[S14] round=11 local utility u=0.228169 metrics={'f1_val': 0.998107494697275, 'auprc': 0.9961045465496323, 'loss_val': 0.283281629476458, 'psi': 0.9973063154382179}-{'f1_val': 0.9283873481990949, 'auprc': 0.9988716465757818, 'loss_val': 0.32960082254020523, 'psi': 0.9565810675497697}
[S15] START round=11 head_norm_before_train=1.128644 cos_to_last_merge=1.0000 (last merge round=10)
[S15] round=11 local utility u=0.063641 metrics={'f1_val': 0.697742482201144, 'auprc': 0.8060595210291288, 'loss_val': 0.5016829162107731, 'psi': 0.7410692977323379}-{'f1_val': 0.6925447113180185, 'auprc': 0.801521862773424, 'loss_val': 0.584165768475423, 'psi': 0.7361355719001808}
[S16] START round=11 head_norm_before_train=0.988403 cos_to_last_merge=1.0000 (last merge round=10)
[S16] round=11 local utility u=0.000000 metrics={'f1_val': 0.3978482401320432, 'auprc': 0.7608973721801304, 'loss_val': 0.8642488261489253, 'psi': 0.543067892951278}-{'f1_val': 0.4358416687275543, 'auprc': 0.7612470369675497, 'loss_val': 1.0001409989460894, 'psi': 0.5660038160235525}
[S17] START round=11 head_norm_before_train=1.606245 (no previous merge yet)
[S17] round=11 local utility u=0.823672 metrics={'f1_val': 0.6632709665620296, 'auprc': 0.8683324004798454, 'loss_val': 0.7619917117915034, 'psi': 0.7452955401291559}-{'f1_val': 0.5199175537491176, 'auprc': 0.7935200073474961, 'loss_val': 1.324777425808653, 'psi': 0.629358535188469}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:49316
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:49302
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:49310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:49315
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:49305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:49310
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:49316
[S5] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1802) from S3
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.464229)
[S2] loaded HEAD from S3 (vec_in norm=1.464229)
[S2] cosine check vs S3: cos=0.9496
[S2] BUFFERED delta from S3 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1802) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.186067)
[S5] loaded HEAD from S15 (vec_in norm=1.186067)
[S5] cosine check vs S15: cos=0.6175
[S5] BUFFERED delta from S15 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1802) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.567725)
[S16] loaded HEAD from S9 (vec_in norm=1.567725)
[S16] cosine check vs S9: cos=0.9218
[S16] BUFFERED delta from S9 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1798) from S6
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.672959)
[S8] loaded HEAD from S6 (vec_in norm=1.672959)
[S8] cosine check vs S6: cos=0.2862
[S8] BUFFERED delta from S6 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1801) from S8
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.358820)
[S9] loaded HEAD from S8 (vec_in norm=1.358820)
[S9] cosine check vs S8: cos=-0.0673
[S9] DROPPED delta from S8 (cos=-0.0673 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1798) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.574859)
[S8] loaded HEAD from S14 (vec_in norm=1.574859)
[S8] cosine check vs S14: cos=0.9497
[S8] BUFFERED delta from S14 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1799) from S11
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.313057)
[S15] loaded HEAD from S11 (vec_in norm=1.313057)
[S15] cosine check vs S11: cos=0.9443
[S15] BUFFERED delta from S11 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1804) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.913778)
[S16] loaded HEAD from S5 (vec_in norm=0.913778)
[S16] cosine check vs S5: cos=0.2970
[S16] BUFFERED delta from S5 (total buffered=2)
[S9] RECEIVED delta(kind=head bytes=1804) from S10
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.794526)
[S9] loaded HEAD from S10 (vec_in norm=1.794526)
[S9] cosine check vs S10: cos=-0.0158
[S9] DROPPED delta from S10 (cos=-0.0158 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:49303
[S17] sending update (kind=head size=1799 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1799) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.639632)
[S3] loaded HEAD from S17 (vec_in norm=1.639632)
[S3] cosine check vs S17: cos=-0.0870
[S3] DROPPED delta from S17 (cos=-0.0870 < 0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=11 metric=0.7013 head_norm=1.378268
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.296420e-01
[S2] stored merged vector for next round verification (round=11)
[S2] DEBUG after merge:  round=11 metric=0.7013 head_norm=1.403231 delta_norm=0.229642
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=11 metric=0.6977 head_norm=1.186067
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.176527e-01
[S15] stored merged vector for next round verification (round=11)
[S15] DEBUG after merge:  round=11 metric=0.6975 head_norm=1.232098 delta_norm=0.217653
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=11 metric=0.4363 head_norm=0.913778
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.751941e-01
[S5] stored merged vector for next round verification (round=11)
[S5] DEBUG after merge:  round=11 metric=0.6155 head_norm=0.946078 delta_norm=0.475194
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=11 metric=0.9944 head_norm=1.358820
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.007177e-01
[S8] stored merged vector for next round verification (round=11)
[S8] DEBUG after merge:  round=11 metric=0.9937 head_norm=1.225554 delta_norm=0.400718
[S8] aggregate: ACCEPT kept=['S6', 'S14'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=11 metric=0.3978 head_norm=1.026313
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.626387e-01
[S16] stored merged vector for next round verification (round=11)
[S16] DEBUG after merge:  round=11 metric=0.3802 head_norm=0.952527 delta_norm=0.162639
[S16] aggregate: ROLLBACK (f1_val pre=0.398 post=0.380 tol_abs=0.005 tol_rel=0.0)
[S2] START round=12 head_norm_before_train=1.403231 cos_to_last_merge=1.0000 (last merge round=11)
[S2] round=12 local utility u=0.000000 metrics={'f1_val': 0.7012261381470865, 'auprc': 0.668754716399926, 'loss_val': 0.36407727651121674, 'psi': 0.6882375694482223}-{'f1_val': 0.7013083232172098, 'auprc': 0.6959011630162746, 'loss_val': 0.37941000158226834, 'psi': 0.6991454591368358}
[S3] START round=12 head_norm_before_train=1.464229 cos_to_last_merge=0.9975 (last merge round=10)
[S3] round=12 local utility u=0.000000 metrics={'f1_val': 0.6303320192007309, 'auprc': 0.880528315692146, 'loss_val': 0.6128372879294148, 'psi': 0.7304105377972969}-{'f1_val': 0.7005813959920884, 'auprc': 0.8631194238436531, 'loss_val': 0.5920654594987631, 'psi': 0.7655966071327143}
[S4] START round=12 head_norm_before_train=1.840495 (no previous merge yet)
[S4] round=12 local utility u=0.000000 metrics={'f1_val': 0.9641339998223786, 'auprc': 0.9397914366946539, 'loss_val': 0.17328650553000272, 'psi': 0.9543969745712888}-{'f1_val': 0.9508877690395983, 'auprc': 0.9727467835628536, 'loss_val': 0.18148578954526534, 'psi': 0.9596313748489004}
[S5] START round=12 head_norm_before_train=0.946078 cos_to_last_merge=1.0000 (last merge round=11)
[S5] round=12 local utility u=0.000000 metrics={'f1_val': 0.4332392017985569, 'auprc': 0.8645438437751853, 'loss_val': 0.7857280128384952, 'psi': 0.6057610585892084}-{'f1_val': 0.4362925695971138, 'auprc': 0.8910641858531596, 'loss_val': 0.7576940761249082, 'psi': 0.6182012160995322}
[S6] START round=12 head_norm_before_train=1.672959 (no previous merge yet)
[S6] round=12 local utility u=0.000000 metrics={'f1_val': 0.4591304496956662, 'auprc': 0.7510056622858374, 'loss_val': 0.9090099291253296, 'psi': 0.5758805347317346}-{'f1_val': 0.8228297850896743, 'auprc': 0.9564761727963199, 'loss_val': 0.3268722174499282, 'psi': 0.8762883401723326}
[S7] START round=12 head_norm_before_train=1.495150 (no previous merge yet)
[S7] round=12 local utility u=1.000000 metrics={'f1_val': 0.6741269100931494, 'auprc': 0.8585121205332298, 'loss_val': 0.6127140137692704, 'psi': 0.7478809942691815}-{'f1_val': 0.41808043974165904, 'auprc': 0.7647572976234812, 'loss_val': 0.8099720270560061, 'psi': 0.5567511828943879}
[S8] START round=12 head_norm_before_train=1.225554 cos_to_last_merge=1.0000 (last merge round=11)
[S8] round=12 local utility u=0.000000 metrics={'f1_val': 0.9928243971176908, 'auprc': 0.9962581646109272, 'loss_val': 0.3100377986559935, 'psi': 0.9941979041149853}-{'f1_val': 0.9944244324421787, 'auprc': 0.9968767049330834, 'loss_val': 0.29545729062595183, 'psi': 0.9954053414385405}
[S9] START round=12 head_norm_before_train=1.567725 (no previous merge yet)
[S9] round=12 local utility u=0.000000 metrics={'f1_val': 0.6945099036107152, 'auprc': 0.9947000683633542, 'loss_val': 0.25238883254606514, 'psi': 0.8145859695117708}-{'f1_val': 0.7012904835408967, 'auprc': 0.99866660137679, 'loss_val': 0.2608649656753486, 'psi': 0.820240930675254}
[S10] START round=12 head_norm_before_train=1.794526 (no previous merge yet)
[S10] round=12 local utility u=0.010677 metrics={'f1_val': 0.993705525296829, 'auprc': 0.9974984172850796, 'loss_val': 0.0610978477100501, 'psi': 0.9952226820921293}-{'f1_val': 0.9937713708662497, 'auprc': 0.9955098294154745, 'loss_val': 0.07688066726522957, 'psi': 0.9944667542859397}
[S11] START round=12 head_norm_before_train=1.313057 cos_to_last_merge=0.8706 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.871
[S11] round=12 local utility u=0.047588 metrics={'f1_val': 0.9575857740575427, 'auprc': 0.9985041896909339, 'loss_val': 0.2178373884578932, 'psi': 0.9739531403108992}-{'f1_val': 0.9547615849080358, 'auprc': 0.998699524940083, 'loss_val': 0.29665480951855366, 'psi': 0.9723367609208546}
[S13] START round=12 head_norm_before_train=1.639594 (no previous merge yet)
[S13] round=12 local utility u=0.084042 metrics={'f1_val': 0.633889212120538, 'auprc': 0.6302349341027713, 'loss_val': 0.5606400231961514, 'psi': 0.6324275009134313}-{'f1_val': 0.6018694853719786, 'auprc': 0.6823323020635392, 'loss_val': 0.6928986895243463, 'psi': 0.6340546120486028}
[S14] START round=12 head_norm_before_train=1.574859 (no previous merge yet)
[S14] round=12 local utility u=0.038243 metrics={'f1_val': 0.9987407782270163, 'auprc': 0.9959925113695511, 'loss_val': 0.2102593657333957, 'psi': 0.9976414714840303}-{'f1_val': 0.998107494697275, 'auprc': 0.9961045465496323, 'loss_val': 0.283281629476458, 'psi': 0.9973063154382179}
[S15] START round=12 head_norm_before_train=1.232098 cos_to_last_merge=1.0000 (last merge round=11)
[S15] round=12 local utility u=0.230888 metrics={'f1_val': 0.6911259202902057, 'auprc': 0.9550340359494597, 'loss_val': 0.4471305244886868, 'psi': 0.7966891665539073}-{'f1_val': 0.697742482201144, 'auprc': 0.8060595210291288, 'loss_val': 0.5016829162107731, 'psi': 0.7410692977323379}
[S16] START round=12 head_norm_before_train=0.952527 cos_to_last_merge=1.0000 (last merge round=11)
[S16] round=12 local utility u=0.100209 metrics={'f1_val': 0.4373050348615034, 'auprc': 0.741557517527321, 'loss_val': 0.842552245951863, 'psi': 0.5590060279278304}-{'f1_val': 0.3978482401320432, 'auprc': 0.7608973721801304, 'loss_val': 0.8642488261489253, 'psi': 0.543067892951278}
[S17] START round=12 head_norm_before_train=1.639632 (no previous merge yet)
[S17] round=12 local utility u=0.244029 metrics={'f1_val': 0.7002052355973372, 'auprc': 0.8737898750975502, 'loss_val': 0.5119116506188006, 'psi': 0.7696390913974225}-{'f1_val': 0.6632709665620296, 'auprc': 0.8683324004798454, 'loss_val': 0.7619917117915034, 'psi': 0.7452955401291559}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:49314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:49315
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] → sending delta(kind=head bytes=1793) to S10@127.0.0.1:49311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:49309
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S15] → sending delta(kind=head bytes=1790) to S5@127.0.0.1:49305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:49303
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:49310
[S10] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1790 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1793 to 1 peers)
[S11] sending update (kind=head size=1804 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1798) from S7
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.522474)
[S3] loaded HEAD from S7 (vec_in norm=1.522474)
[S3] cosine check vs S7: cos=0.9735
[S3] BUFFERED delta from S7 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1801) from S16
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.992793)
[S14] loaded HEAD from S16 (vec_in norm=0.992793)
[S14] cosine check vs S16: cos=-0.1267
[S14] DROPPED delta from S16 (cos=-0.1267 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1793) from S13
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.653122)
[S10] loaded HEAD from S13 (vec_in norm=1.653122)
[S10] cosine check vs S13: cos=-0.0910
[S10] DROPPED delta from S13 (cos=-0.0910 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1804) from S11
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.366616)
[S15] loaded HEAD from S11 (vec_in norm=1.366616)
[S15] cosine check vs S11: cos=0.9629
[S15] BUFFERED delta from S11 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1797) from S10
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.838826)
[S9] loaded HEAD from S10 (vec_in norm=1.838826)
[S9] cosine check vs S10: cos=-0.0177
[S9] DROPPED delta from S10 (cos=-0.0177 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1802) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.614804)
[S8] loaded HEAD from S14 (vec_in norm=1.614804)
[S8] cosine check vs S14: cos=0.8736
[S8] BUFFERED delta from S14 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1790) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.289392)
[S5] loaded HEAD from S15 (vec_in norm=1.289392)
[S5] cosine check vs S15: cos=0.8829
[S5] BUFFERED delta from S15 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:49303
[S17] sending update (kind=head size=1800 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1800) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.675802)
[S3] loaded HEAD from S17 (vec_in norm=1.675802)
[S3] cosine check vs S17: cos=-0.0920
[S3] DROPPED delta from S17 (cos=-0.0920 < 0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=12 metric=0.4332 head_norm=0.974254
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.136966e-01
[S5] stored merged vector for next round verification (round=12)
[S5] DEBUG after merge:  round=12 metric=0.6536 head_norm=1.098838 delta_norm=0.313697
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=12 metric=0.9928 head_norm=1.278699
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.984078e-01
[S8] stored merged vector for next round verification (round=12)
[S8] DEBUG after merge:  round=12 metric=0.9925 head_norm=1.400929 delta_norm=0.398408
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=12 metric=0.6303 head_norm=1.501561
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.742843e-01
[S3] stored merged vector for next round verification (round=12)
[S3] DEBUG after merge:  round=12 metric=0.6340 head_norm=1.501976 delta_norm=0.174284
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=12 metric=0.6911 head_norm=1.289392
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.848936e-01
[S15] stored merged vector for next round verification (round=12)
[S15] DEBUG after merge:  round=12 metric=0.6911 head_norm=1.315637 delta_norm=0.184894
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.472066 cos_to_last_merge=0.9941 (last merge round=11)
[S2] round=13 local utility u=0.000000 metrics={'f1_val': 0.7013066604552667, 'auprc': 0.6570601191854273, 'loss_val': 0.3358782516696333, 'psi': 0.6836080439473309}-{'f1_val': 0.7012261381470865, 'auprc': 0.668754716399926, 'loss_val': 0.36407727651121674, 'psi': 0.6882375694482223}
[S3] START round=13 head_norm_before_train=1.501976 cos_to_last_merge=1.0000 (last merge round=12)
[S3] round=13 local utility u=0.258620 metrics={'f1_val': 0.6924880784557341, 'auprc': 0.882869081256529, 'loss_val': 0.47555670626530644, 'psi': 0.7686404795760521}-{'f1_val': 0.6303320192007309, 'auprc': 0.880528315692146, 'loss_val': 0.6128372879294148, 'psi': 0.7304105377972969}
[S4] START round=13 head_norm_before_train=1.862736 (no previous merge yet)
[S4] round=13 local utility u=0.004246 metrics={'f1_val': 0.9530034695362366, 'auprc': 0.9575768630796968, 'loss_val': 0.15136825273121524, 'psi': 0.9548328269536207}-{'f1_val': 0.9641339998223786, 'auprc': 0.9397914366946539, 'loss_val': 0.17328650553000272, 'psi': 0.9543969745712888}
[S5] START round=13 head_norm_before_train=1.098838 cos_to_last_merge=1.0000 (last merge round=12)
[S5] round=13 local utility u=0.000000 metrics={'f1_val': 0.4173841268229622, 'auprc': 0.8360758492639941, 'loss_val': 0.8143815450872451, 'psi': 0.584860815799375}-{'f1_val': 0.4332392017985569, 'auprc': 0.8645438437751853, 'loss_val': 0.7857280128384952, 'psi': 0.6057610585892084}
[S6] START round=13 head_norm_before_train=1.695321 (no previous merge yet)
[S6] round=13 local utility u=1.000000 metrics={'f1_val': 0.8300612262306157, 'auprc': 0.9607789703870173, 'loss_val': 0.2409766512688837, 'psi': 0.8823483238931764}-{'f1_val': 0.4591304496956662, 'auprc': 0.7510056622858374, 'loss_val': 0.9090099291253296, 'psi': 0.5758805347317346}
[S7] START round=13 head_norm_before_train=1.522474 (no previous merge yet)
[S7] round=13 local utility u=0.087372 metrics={'f1_val': 0.7141664499618597, 'auprc': 0.7889200538934052, 'loss_val': 0.46943059010661087, 'psi': 0.7440678915344779}-{'f1_val': 0.6741269100931494, 'auprc': 0.8585121205332298, 'loss_val': 0.6127140137692704, 'psi': 0.7478809942691815}
[S8] START round=13 head_norm_before_train=1.400929 cos_to_last_merge=1.0000 (last merge round=12)
[S8] round=13 local utility u=0.000000 metrics={'f1_val': 0.7140170479737811, 'auprc': 0.992069215445907, 'loss_val': 0.3222681519730696, 'psi': 0.8252379149626314}-{'f1_val': 0.9928243971176908, 'auprc': 0.9962581646109272, 'loss_val': 0.3100377986559935, 'psi': 0.9941979041149853}
[S9] START round=13 head_norm_before_train=1.612019 (no previous merge yet)
[S9] round=13 local utility u=0.069067 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.998927923323326, 'loss_val': 0.16717821601948615, 'psi': 0.8203011177933416}-{'f1_val': 0.6945099036107152, 'auprc': 0.9947000683633542, 'loss_val': 0.25238883254606514, 'psi': 0.8145859695117708}
[S10] START round=13 head_norm_before_train=1.838826 (no previous merge yet)
[S10] round=13 local utility u=0.000130 metrics={'f1_val': 0.992994663041229, 'auprc': 0.9958685520425498, 'loss_val': 0.05168284901427902, 'psi': 0.9941442186417573}-{'f1_val': 0.993705525296829, 'auprc': 0.9974984172850796, 'loss_val': 0.0610978477100501, 'psi': 0.9952226820921293}
[S11] START round=13 head_norm_before_train=1.366616 cos_to_last_merge=0.8597 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.860
[S11] round=13 local utility u=0.019745 metrics={'f1_val': 0.9597194965484097, 'auprc': 0.9984929988689797, 'loss_val': 0.19111712586764118, 'psi': 0.9752288974766377}-{'f1_val': 0.9575857740575427, 'auprc': 0.9985041896909339, 'loss_val': 0.2178373884578932, 'psi': 0.9739531403108992}
[S13] START round=13 head_norm_before_train=1.653122 (no previous merge yet)
[S13] round=13 local utility u=0.000000 metrics={'f1_val': 0.5994370929405429, 'auprc': 0.6851531511752732, 'loss_val': 0.7136338808868204, 'psi': 0.633723516234435}-{'f1_val': 0.633889212120538, 'auprc': 0.6302349341027713, 'loss_val': 0.5606400231961514, 'psi': 0.6324275009134313}
[S14] START round=13 head_norm_before_train=1.614804 (no previous merge yet)
[S14] round=13 local utility u=0.031336 metrics={'f1_val': 0.9983274240503504, 'auprc': 0.9957361946223344, 'loss_val': 0.14433820928578575, 'psi': 0.997290932279144}-{'f1_val': 0.9987407782270163, 'auprc': 0.9959925113695511, 'loss_val': 0.2102593657333957, 'psi': 0.9976414714840303}
[S15] START round=13 head_norm_before_train=1.315637 cos_to_last_merge=1.0000 (last merge round=12)
[S15] round=13 local utility u=0.099232 metrics={'f1_val': 0.69794086105842, 'auprc': 0.9876169764613112, 'loss_val': 0.38730466808288316, 'psi': 0.8138113072195765}-{'f1_val': 0.6911259202902057, 'auprc': 0.9550340359494597, 'loss_val': 0.4471305244886868, 'psi': 0.7966891665539073}
[S16] START round=13 head_norm_before_train=0.992793 cos_to_last_merge=0.9957 (last merge round=11)
[S16] round=13 local utility u=0.000000 metrics={'f1_val': 0.3889769219380825, 'auprc': 0.7553358867975858, 'loss_val': 0.7839731726935207, 'psi': 0.5355205078818838}-{'f1_val': 0.4373050348615034, 'auprc': 0.741557517527321, 'loss_val': 0.842552245951863, 'psi': 0.5590060279278304}
[S17] START round=13 head_norm_before_train=1.675802 (no previous merge yet)
[S17] round=13 local utility u=0.695720 metrics={'f1_val': 0.8600775871978423, 'auprc': 0.9662898358759139, 'loss_val': 0.3572060680074527, 'psi': 0.9025624866690709}-{'f1_val': 0.7002052355973372, 'auprc': 0.8737898750975502, 'loss_val': 0.5119116506188006, 'psi': 0.7696390913974225}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:49310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:49302
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:49312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:49305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:49316
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:49303
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:49315
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1803) from S11
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.406361)
[S15] loaded HEAD from S11 (vec_in norm=1.406361)
[S15] cosine check vs S11: cos=0.9753
[S15] BUFFERED delta from S11 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1799) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.874085)
[S11] loaded HEAD from S4 (vec_in norm=1.874085)
[S11] cosine check vs S4: cos=-0.0937
[S11] DROPPED delta from S4 (cos=-0.0937 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1798) from S10
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.879532)
[S9] loaded HEAD from S10 (vec_in norm=1.879532)
[S9] cosine check vs S10: cos=-0.0182
[S9] DROPPED delta from S10 (cos=-0.0182 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1802) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.659411)
[S8] loaded HEAD from S14 (vec_in norm=1.659411)
[S8] cosine check vs S14: cos=0.9618
[S8] BUFFERED delta from S14 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1801) from S6
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.714731)
[S8] loaded HEAD from S6 (vec_in norm=1.714731)
[S8] cosine check vs S6: cos=0.3057
[S8] BUFFERED delta from S6 (total buffered=2)
[S5] RECEIVED delta(kind=head bytes=1797) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.370199)
[S5] loaded HEAD from S15 (vec_in norm=1.370199)
[S5] cosine check vs S15: cos=0.9532
[S5] BUFFERED delta from S15 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1801) from S3
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.531304)
[S2] loaded HEAD from S3 (vec_in norm=1.531304)
[S2] cosine check vs S3: cos=0.9472
[S2] BUFFERED delta from S3 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1801) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.650066)
[S16] loaded HEAD from S9 (vec_in norm=1.650066)
[S16] cosine check vs S9: cos=0.8794
[S16] BUFFERED delta from S9 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1796) from S7
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.545997)
[S3] loaded HEAD from S7 (vec_in norm=1.545997)
[S3] cosine check vs S7: cos=0.9867
[S3] BUFFERED delta from S7 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:49303
[S17] sending update (kind=head size=1802 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1802) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.717266)
[S3] loaded HEAD from S17 (vec_in norm=1.717266)
[S3] cosine check vs S17: cos=-0.0812
[S3] DROPPED delta from S17 (cos=-0.0812 < 0.0)
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=13 metric=0.7140 head_norm=1.456719
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.949409e-01
[S8] stored merged vector for next round verification (round=13)
[S8] DEBUG after merge:  round=13 metric=0.7879 head_norm=1.303941 delta_norm=0.394941
[S8] aggregate: ACCEPT kept=['S14', 'S6'] (k=2/2) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=13 metric=0.7013 head_norm=1.534119
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.491340e-01
[S2] stored merged vector for next round verification (round=13)
[S2] DEBUG after merge:  round=13 metric=0.7013 head_norm=1.512329 delta_norm=0.249134
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=13 metric=0.4174 head_norm=1.124574
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.261313e-01
[S5] stored merged vector for next round verification (round=13)
[S5] DEBUG after merge:  round=13 metric=0.4215 head_norm=1.232850 delta_norm=0.226131
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=13 metric=0.3890 head_norm=1.044828
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.422260e-01
[S16] stored merged vector for next round verification (round=13)
[S16] DEBUG after merge:  round=13 metric=0.4087 head_norm=1.308292 delta_norm=0.442226
[S16] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=13 metric=0.6925 head_norm=1.531304
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.255192e-01
[S3] stored merged vector for next round verification (round=13)
[S3] DEBUG after merge:  round=13 metric=0.6927 head_norm=1.533540 delta_norm=0.125519
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=13 metric=0.6979 head_norm=1.370199
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.554474e-01
[S15] stored merged vector for next round verification (round=13)
[S15] DEBUG after merge:  round=13 metric=0.6979 head_norm=1.379668 delta_norm=0.155447
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.512329 cos_to_last_merge=1.0000 (last merge round=13)
[S2] round=14 local utility u=0.001010 metrics={'f1_val': 0.7010529594768992, 'auprc': 0.6564271353314084, 'loss_val': 0.33043621378226423, 'psi': 0.6832026298187028}-{'f1_val': 0.7013066604552667, 'auprc': 0.6570601191854273, 'loss_val': 0.3358782516696333, 'psi': 0.6836080439473309}
[S3] START round=14 head_norm_before_train=1.533540 cos_to_last_merge=1.0000 (last merge round=13)
[S3] round=14 local utility u=0.000000 metrics={'f1_val': 0.5759017666615476, 'auprc': 0.9777063580889949, 'loss_val': 0.6395779543917417, 'psi': 0.7366236032325265}-{'f1_val': 0.6924880784557341, 'auprc': 0.882869081256529, 'loss_val': 0.47555670626530644, 'psi': 0.7686404795760521}
[S4] START round=14 head_norm_before_train=1.874085 (no previous merge yet)
[S4] round=14 local utility u=0.066164 metrics={'f1_val': 0.9583702885792642, 'auprc': 0.9865024353673307, 'loss_val': 0.13801791842190567, 'psi': 0.9696231472944908}-{'f1_val': 0.9530034695362366, 'auprc': 0.9575768630796968, 'loss_val': 0.15136825273121524, 'psi': 0.9548328269536207}
[S5] START round=14 head_norm_before_train=1.232850 cos_to_last_merge=1.0000 (last merge round=13)
[S5] round=14 local utility u=0.988425 metrics={'f1_val': 0.7005699347162762, 'auprc': 0.8651465463669361, 'loss_val': 0.623858082622024, 'psi': 0.76640057937654}-{'f1_val': 0.4173841268229622, 'auprc': 0.8360758492639941, 'loss_val': 0.8143815450872451, 'psi': 0.584860815799375}
[S6] START round=14 head_norm_before_train=1.714731 (no previous merge yet)
[S6] round=14 local utility u=0.000000 metrics={'f1_val': 0.7923367504009774, 'auprc': 0.9586807394070599, 'loss_val': 0.4374073365957397, 'psi': 0.8588743460034104}-{'f1_val': 0.8300612262306157, 'auprc': 0.9607789703870173, 'loss_val': 0.2409766512688837, 'psi': 0.8823483238931764}
[S7] START round=14 head_norm_before_train=1.545997 (no previous merge yet)
[S7] round=14 local utility u=0.000000 metrics={'f1_val': 0.37738641200092254, 'auprc': 0.7755894687726417, 'loss_val': 1.0252270705530173, 'psi': 0.5366676347096102}-{'f1_val': 0.7141664499618597, 'auprc': 0.7889200538934052, 'loss_val': 0.46943059010661087, 'psi': 0.7440678915344779}
[S8] START round=14 head_norm_before_train=1.303941 cos_to_last_merge=1.0000 (last merge round=13)
[S8] round=14 local utility u=0.884801 metrics={'f1_val': 0.9932225217693944, 'auprc': 0.9952012228078033, 'loss_val': 0.23729434935770727, 'psi': 0.994014002184758}-{'f1_val': 0.7140170479737811, 'auprc': 0.992069215445907, 'loss_val': 0.3222681519730696, 'psi': 0.8252379149626314}
[S9] START round=14 head_norm_before_train=1.650066 (no previous merge yet)
[S9] round=14 local utility u=0.872064 metrics={'f1_val': 0.9890975148541, 'auprc': 0.999154511463196, 'loss_val': 0.15101530021449583, 'psi': 0.9931203134977384}-{'f1_val': 0.7012165807733519, 'auprc': 0.998927923323326, 'loss_val': 0.16717821601948615, 'psi': 0.8203011177933416}
[S10] START round=14 head_norm_before_train=1.879532 (no previous merge yet)
[S10] round=14 local utility u=0.005662 metrics={'f1_val': 0.9933489306849028, 'auprc': 0.9965956183099731, 'loss_val': 0.044665667525836825, 'psi': 0.9946476057349309}-{'f1_val': 0.992994663041229, 'auprc': 0.9958685520425498, 'loss_val': 0.05168284901427902, 'psi': 0.9941442186417573}
[S11] START round=14 head_norm_before_train=1.406361 cos_to_last_merge=0.8523 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.852
[S11] round=14 local utility u=0.126567 metrics={'f1_val': 0.9967189926998994, 'auprc': 0.9983957812050541, 'loss_val': 0.15968755033714946, 'psi': 0.9973897081019613}-{'f1_val': 0.9597194965484097, 'auprc': 0.9984929988689797, 'loss_val': 0.19111712586764118, 'psi': 0.9752288974766377}
[S13] START round=14 head_norm_before_train=1.663056 (no previous merge yet)
[S13] round=14 local utility u=0.033302 metrics={'f1_val': 0.610933919044371, 'auprc': 0.6488924465942267, 'loss_val': 0.6072281989008643, 'psi': 0.6261173300643132}-{'f1_val': 0.5994370929405429, 'auprc': 0.6851531511752732, 'loss_val': 0.7136338808868204, 'psi': 0.633723516234435}
[S14] START round=14 head_norm_before_train=1.659411 (no previous merge yet)
[S14] round=14 local utility u=0.000000 metrics={'f1_val': 0.9458006568960822, 'auprc': 0.9971380849183753, 'loss_val': 0.13376417944100863, 'psi': 0.9663356281049994}-{'f1_val': 0.9983274240503504, 'auprc': 0.9957361946223344, 'loss_val': 0.14433820928578575, 'psi': 0.997290932279144}
[S15] START round=14 head_norm_before_train=1.379668 cos_to_last_merge=1.0000 (last merge round=13)
[S15] round=14 local utility u=0.000000 metrics={'f1_val': 0.6921751044579605, 'auprc': 0.9657823107553011, 'loss_val': 0.36367196669855034, 'psi': 0.8016179869768967}-{'f1_val': 0.69794086105842, 'auprc': 0.9876169764613112, 'loss_val': 0.38730466808288316, 'psi': 0.8138113072195765}
[S16] START round=14 head_norm_before_train=1.308292 cos_to_last_merge=1.0000 (last merge round=13)
[S16] round=14 local utility u=0.139955 metrics={'f1_val': 0.42801989043642313, 'auprc': 0.758481201148172, 'loss_val': 0.7477566708980197, 'psi': 0.5602044147211227}-{'f1_val': 0.3889769219380825, 'auprc': 0.7553358867975858, 'loss_val': 0.7839731726935207, 'psi': 0.5355205078818838}
[S17] START round=14 head_norm_before_train=1.717266 (no previous merge yet)
[S17] round=14 local utility u=0.000000 metrics={'f1_val': 0.711200381760357, 'auprc': 0.8968206247299203, 'loss_val': 0.5461865087612815, 'psi': 0.7854484789481824}-{'f1_val': 0.8600775871978423, 'auprc': 0.9662898358759139, 'loss_val': 0.3572060680074527, 'psi': 0.9025624866690709}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:49311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:49316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:49314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:49316
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:49312
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:49310
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:49315
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:49310
[S4] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1800) from S11
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.445005)
[S15] loaded HEAD from S11 (vec_in norm=1.445005)
[S15] cosine check vs S11: cos=0.9824
[S15] BUFFERED delta from S11 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1801) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.685765)
[S16] loaded HEAD from S9 (vec_in norm=1.685765)
[S16] cosine check vs S9: cos=0.9730
[S16] BUFFERED delta from S9 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1798) from S2
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.556333)
[S15] loaded HEAD from S2 (vec_in norm=1.556333)
[S15] cosine check vs S2: cos=0.0741
[S15] BUFFERED delta from S2 (total buffered=2)
[S14] RECEIVED delta(kind=head bytes=1800) from S16
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.351718)
[S14] loaded HEAD from S16 (vec_in norm=1.351718)
[S14] cosine check vs S16: cos=-0.1076
[S14] DROPPED delta from S16 (cos=-0.1076 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1797) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.885920)
[S11] loaded HEAD from S4 (vec_in norm=1.885920)
[S11] cosine check vs S4: cos=-0.0922
[S11] DROPPED delta from S4 (cos=-0.0922 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1801) from S13
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.679335)
[S10] loaded HEAD from S13 (vec_in norm=1.679335)
[S10] cosine check vs S13: cos=-0.0906
[S10] DROPPED delta from S13 (cos=-0.0906 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1799) from S10
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.917200)
[S9] loaded HEAD from S10 (vec_in norm=1.917200)
[S9] cosine check vs S10: cos=-0.0184
[S9] DROPPED delta from S10 (cos=-0.0184 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1803) from S8
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.364895)
[S9] loaded HEAD from S8 (vec_in norm=1.364895)
[S9] cosine check vs S8: cos=-0.0841
[S9] DROPPED delta from S8 (cos=-0.0841 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1799) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.255203)
[S16] loaded HEAD from S5 (vec_in norm=1.255203)
[S16] cosine check vs S5: cos=0.1105
[S16] BUFFERED delta from S5 (total buffered=2)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=14 metric=0.4280 head_norm=1.351718
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.620666e-01
[S16] stored merged vector for next round verification (round=14)
[S16] DEBUG after merge:  round=14 metric=0.4391 head_norm=1.154747 delta_norm=0.362067
[S16] aggregate: ACCEPT kept=['S9', 'S5'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=14 metric=0.6922 head_norm=1.431023
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.099834e-01
[S15] stored merged vector for next round verification (round=14)
[S15] DEBUG after merge:  round=14 metric=0.6919 head_norm=1.165434 delta_norm=0.509983
[S15] aggregate: ACCEPT kept=['S11', 'S2'] (k=2/2) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.556333 cos_to_last_merge=0.9979 (last merge round=13)
[S2] round=15 local utility u=0.078680 metrics={'f1_val': 0.7014235525024627, 'auprc': 0.7170937151259849, 'loss_val': 0.35729877443802377, 'psi': 0.7076916175518715}-{'f1_val': 0.7010529594768992, 'auprc': 0.6564271353314084, 'loss_val': 0.33043621378226423, 'psi': 0.6832026298187028}
[S3] START round=15 head_norm_before_train=1.561806 cos_to_last_merge=0.9990 (last merge round=13)
[S3] round=15 local utility u=0.398132 metrics={'f1_val': 0.6661154621139382, 'auprc': 0.9960679322443717, 'loss_val': 0.43968007490636646, 'psi': 0.7980964501661116}-{'f1_val': 0.5759017666615476, 'auprc': 0.9777063580889949, 'loss_val': 0.6395779543917417, 'psi': 0.7366236032325265}
[S4] START round=15 head_norm_before_train=1.885920 (no previous merge yet)
[S4] round=15 local utility u=0.000000 metrics={'f1_val': 0.9653437224943499, 'auprc': 0.9514213962720597, 'loss_val': 0.14760530261491284, 'psi': 0.9597747920054338}-{'f1_val': 0.9583702885792642, 'auprc': 0.9865024353673307, 'loss_val': 0.13801791842190567, 'psi': 0.9696231472944908}
[S5] START round=15 head_norm_before_train=1.255203 cos_to_last_merge=0.9980 (last merge round=13)
[S5] round=15 local utility u=0.000000 metrics={'f1_val': 0.4229026149754049, 'auprc': 0.7739848169768825, 'loss_val': 0.7615758435455279, 'psi': 0.563335495775996}-{'f1_val': 0.7005699347162762, 'auprc': 0.8651465463669361, 'loss_val': 0.623858082622024, 'psi': 0.76640057937654}
[S6] START round=15 head_norm_before_train=1.732311 (no previous merge yet)
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.7638624040414159, 'auprc': 0.9422858106086169, 'loss_val': 0.5641986744234473, 'psi': 0.8352317666682962}-{'f1_val': 0.7923367504009774, 'auprc': 0.9586807394070599, 'loss_val': 0.4374073365957397, 'psi': 0.8588743460034104}
[S7] START round=15 head_norm_before_train=1.560903 (no previous merge yet)
[S7] round=15 local utility u=1.000000 metrics={'f1_val': 0.6794336000441663, 'auprc': 0.8710633301140263, 'loss_val': 0.4868124370639688, 'psi': 0.7560854920721103}-{'f1_val': 0.37738641200092254, 'auprc': 0.7755894687726417, 'loss_val': 1.0252270705530173, 'psi': 0.5366676347096102}
[S8] START round=15 head_norm_before_train=1.364895 cos_to_last_merge=0.9960 (last merge round=13)
[S8] round=15 local utility u=0.048604 metrics={'f1_val': 0.9942226369520374, 'auprc': 0.9955126649728159, 'loss_val': 0.14702077789096224, 'psi': 0.9947386481603488}-{'f1_val': 0.9932225217693944, 'auprc': 0.9952012228078033, 'loss_val': 0.23729434935770727, 'psi': 0.994014002184758}
[S9] START round=15 head_norm_before_train=1.685765 (no previous merge yet)
[S9] round=15 local utility u=0.057105 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9995965337320254, 'loss_val': 0.07850688837609905, 'psi': 0.9973346445113214}-{'f1_val': 0.9890975148541, 'auprc': 0.999154511463196, 'loss_val': 0.15101530021449583, 'psi': 0.9931203134977384}
[S10] START round=15 head_norm_before_train=1.917200 (no previous merge yet)
[S10] round=15 local utility u=0.001925 metrics={'f1_val': 0.9933244994136741, 'auprc': 0.9969861897746075, 'loss_val': 0.041840005715409606, 'psi': 0.9947891755580474}-{'f1_val': 0.9933489306849028, 'auprc': 0.9965956183099731, 'loss_val': 0.044665667525836825, 'psi': 0.9946476057349309}
[S11] START round=15 head_norm_before_train=1.445005 cos_to_last_merge=0.8455 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.845
[S11] round=15 local utility u=0.010711 metrics={'f1_val': 0.9967189926998994, 'auprc': 0.9984698413944078, 'loss_val': 0.13848693428665554, 'psi': 0.9974193321777027}-{'f1_val': 0.9967189926998994, 'auprc': 0.9983957812050541, 'loss_val': 0.15968755033714946, 'psi': 0.9973897081019613}
[S13] START round=15 head_norm_before_train=1.679335 (no previous merge yet)
[S13] round=15 local utility u=0.000000 metrics={'f1_val': 0.5890910441196877, 'auprc': 0.6824734901236398, 'loss_val': 0.771165752534832, 'psi': 0.6264440225212686}-{'f1_val': 0.610933919044371, 'auprc': 0.6488924465942267, 'loss_val': 0.6072281989008643, 'psi': 0.6261173300643132}
[S14] START round=15 head_norm_before_train=1.695490 (no previous merge yet)
[S14] round=15 local utility u=0.175305 metrics={'f1_val': 0.9976760408229349, 'auprc': 0.9966597448416084, 'loss_val': 0.09297156563557077, 'psi': 0.9972695224304043}-{'f1_val': 0.9458006568960822, 'auprc': 0.9971380849183753, 'loss_val': 0.13376417944100863, 'psi': 0.9663356281049994}
[S15] START round=15 head_norm_before_train=1.165434 cos_to_last_merge=1.0000 (last merge round=14)
[S15] round=15 local utility u=0.032527 metrics={'f1_val': 0.6972440552735569, 'auprc': 0.9868796440562703, 'loss_val': 0.3923232974843374, 'psi': 0.8130982907866423}-{'f1_val': 0.6921751044579605, 'auprc': 0.9657823107553011, 'loss_val': 0.36367196669855034, 'psi': 0.8016179869768967}
[S16] START round=15 head_norm_before_train=1.154747 cos_to_last_merge=1.0000 (last merge round=14)
[S16] round=15 local utility u=1.000000 metrics={'f1_val': 0.8308941006117678, 'auprc': 0.8042312222510635, 'loss_val': 0.710346150202816, 'psi': 0.8202289492674861}-{'f1_val': 0.42801989043642313, 'auprc': 0.758481201148172, 'loss_val': 0.7477566708980197, 'psi': 0.5602044147211227}
[S17] START round=15 head_norm_before_train=1.743726 (no previous merge yet)
[S17] round=15 local utility u=0.000000 metrics={'f1_val': 0.686529317441166, 'auprc': 0.8337967011449559, 'loss_val': 0.8827679313440684, 'psi': 0.7454362709226819}-{'f1_val': 0.711200381760357, 'auprc': 0.8968206247299203, 'loss_val': 0.5461865087612815, 'psi': 0.7854484789481824}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] → sending delta(kind=head bytes=1805) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:49305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:49303
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:49316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:49314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:49310
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:49310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:49302
[S10] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1805 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1799) from S2
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.602209)
[S15] loaded HEAD from S2 (vec_in norm=1.602209)
[S15] cosine check vs S2: cos=0.3885
[S15] BUFFERED delta from S2 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1801) from S7
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.573239)
[S3] loaded HEAD from S7 (vec_in norm=1.573239)
[S3] cosine check vs S7: cos=0.9875
[S3] BUFFERED delta from S7 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1794) from S16
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.198466)
[S14] loaded HEAD from S16 (vec_in norm=1.198466)
[S14] cosine check vs S16: cos=-0.0859
[S14] DROPPED delta from S16 (cos=-0.0859 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1800) from S10
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.942940)
[S9] loaded HEAD from S10 (vec_in norm=1.942940)
[S9] cosine check vs S10: cos=-0.0186
[S9] DROPPED delta from S10 (cos=-0.0186 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1800) from S8
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.444347)
[S9] loaded HEAD from S8 (vec_in norm=1.444347)
[S9] cosine check vs S8: cos=-0.0742
[S9] DROPPED delta from S8 (cos=-0.0742 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1802) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.723349)
[S8] loaded HEAD from S14 (vec_in norm=1.723349)
[S8] cosine check vs S14: cos=0.8711
[S8] BUFFERED delta from S14 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1802) from S3
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.589153)
[S2] loaded HEAD from S3 (vec_in norm=1.589153)
[S2] cosine check vs S3: cos=0.9636
[S2] BUFFERED delta from S3 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1801) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.224461)
[S5] loaded HEAD from S15 (vec_in norm=1.224461)
[S5] cosine check vs S15: cos=0.9231
[S5] BUFFERED delta from S15 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1805) from S11
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.478907)
[S15] loaded HEAD from S11 (vec_in norm=1.478907)
[S15] cosine check vs S11: cos=0.9190
[S15] BUFFERED delta from S11 (total buffered=2)
[S16] RECEIVED delta(kind=head bytes=1801) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.721646)
[S16] loaded HEAD from S9 (vec_in norm=1.721646)
[S16] cosine check vs S9: cos=0.9252
[S16] BUFFERED delta from S9 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] ⇄ pheromone p=0.129 → S11@127.0.0.1:49312
[S13] ⇄ pheromone p=0.110 → S10@127.0.0.1:49311
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=15 metric=0.4229 head_norm=1.281752
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.472833e-01
[S5] stored merged vector for next round verification (round=15)
[S5] DEBUG after merge:  round=15 metric=0.4985 head_norm=1.228799 delta_norm=0.247283
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.263 → S16@127.0.0.1:49316
[S14] ⇄ pheromone p=0.243 → S8@127.0.0.1:49309
[S9] ⇄ pheromone p=0.289 → S16@127.0.0.1:49316
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=15 metric=0.6661 head_norm=1.589153
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.251937e-01
[S3] stored merged vector for next round verification (round=15)
[S3] DEBUG after merge:  round=15 metric=0.6678 head_norm=1.576252 delta_norm=0.125194
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.248 → S2@127.0.0.1:49302
[S7] ⇄ pheromone p=0.416 → S3@127.0.0.1:49303
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=15 metric=0.9942 head_norm=1.444347
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.241472e-01
[S8] stored merged vector for next round verification (round=15)
[S8] DEBUG after merge:  round=15 metric=0.9937 head_norm=1.532362 delta_norm=0.424147
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.289 → S9@127.0.0.1:49310
[S11] ⇄ pheromone p=0.237 → S15@127.0.0.1:49315
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=15 metric=0.7014 head_norm=1.602209
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.154442e-01
[S2] stored merged vector for next round verification (round=15)
[S2] DEBUG after merge:  round=15 metric=0.7012 head_norm=1.581083 delta_norm=0.215444
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.094 → S15@127.0.0.1:49315
[S10] ⇄ pheromone p=0.133 → S9@127.0.0.1:49310
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=15 metric=0.6972 head_norm=1.224461
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.842692e-01
[S15] stored merged vector for next round verification (round=15)
[S15] DEBUG after merge:  round=15 metric=0.6972 head_norm=1.137531 delta_norm=0.284269
[S15] aggregate: ACCEPT kept=['S2', 'S11'] (k=2/2) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.141 → S5@127.0.0.1:49305
[S17] ⇄ pheromone p=0.255 → S3@127.0.0.1:49303
[S6] ⇄ pheromone p=0.306 → S8@127.0.0.1:49309
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=15 metric=0.8309 head_norm=1.198466
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.815266e-01
[S16] stored merged vector for next round verification (round=15)
[S16] DEBUG after merge:  round=15 metric=0.8263 head_norm=1.433398 delta_norm=0.381527
[S16] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.314 → S14@127.0.0.1:49314
[S2] START round=16 head_norm_before_train=1.581083 cos_to_last_merge=1.0000 (last merge round=15)
[S2] round=16 local utility u=0.000000 metrics={'f1_val': 0.701049040284694, 'auprc': 0.6565795741965179, 'loss_val': 0.33343053916388893, 'psi': 0.6832612538494235}-{'f1_val': 0.7014235525024627, 'auprc': 0.7170937151259849, 'loss_val': 0.35729877443802377, 'psi': 0.7076916175518715}
[S3] START round=16 head_norm_before_train=1.576252 cos_to_last_merge=1.0000 (last merge round=15)
[S3] round=16 local utility u=0.000000 metrics={'f1_val': 0.5828653280687559, 'auprc': 0.9986323535316359, 'loss_val': 0.5810921557025908, 'psi': 0.7491721382539079}-{'f1_val': 0.6661154621139382, 'auprc': 0.9960679322443717, 'loss_val': 0.43968007490636646, 'psi': 0.7980964501661116}
[S4] START round=16 head_norm_before_train=1.907658 (no previous merge yet)
[S4] round=16 local utility u=0.000000 metrics={'f1_val': 0.9492177654348801, 'auprc': 0.9643859180139935, 'loss_val': 0.15067661466519894, 'psi': 0.9552850264665255}-{'f1_val': 0.9653437224943499, 'auprc': 0.9514213962720597, 'loss_val': 0.14760530261491284, 'psi': 0.9597747920054338}
[S5] START round=16 head_norm_before_train=1.228799 cos_to_last_merge=1.0000 (last merge round=15)
[S5] round=16 local utility u=1.000000 metrics={'f1_val': 0.7005708485915159, 'auprc': 0.9349625491530313, 'loss_val': 0.5750248293897918, 'psi': 0.794327528816122}-{'f1_val': 0.4229026149754049, 'auprc': 0.7739848169768825, 'loss_val': 0.7615758435455279, 'psi': 0.563335495775996}
[S6] START round=16 head_norm_before_train=1.751821 (no previous merge yet)
[S6] round=16 local utility u=0.686098 metrics={'f1_val': 0.9352120420231103, 'auprc': 0.9438735826784123, 'loss_val': 0.2248648044561831, 'psi': 0.9386766582852311}-{'f1_val': 0.7638624040414159, 'auprc': 0.9422858106086169, 'loss_val': 0.5641986744234473, 'psi': 0.8352317666682962}
[S7] START round=16 head_norm_before_train=1.573239 (no previous merge yet)
[S7] round=16 local utility u=0.000000 metrics={'f1_val': 0.392286467650413, 'auprc': 0.7694689618198152, 'loss_val': 1.06471559267853, 'psi': 0.5431594653181739}-{'f1_val': 0.6794336000441663, 'auprc': 0.8710633301140263, 'loss_val': 0.4868124370639688, 'psi': 0.7560854920721103}
[S8] START round=16 head_norm_before_train=1.532362 cos_to_last_merge=1.0000 (last merge round=15)
[S8] round=16 local utility u=0.008062 metrics={'f1_val': 0.9918532151771823, 'auprc': 0.9968947170728435, 'loss_val': 0.12082616721441398, 'psi': 0.9938698159354469}-{'f1_val': 0.9942226369520374, 'auprc': 0.9955126649728159, 'loss_val': 0.14702077789096224, 'psi': 0.9947386481603488}
[S9] START round=16 head_norm_before_train=1.721646 (no previous merge yet)
[S9] round=16 local utility u=0.000000 metrics={'f1_val': 0.9882473538397808, 'auprc': 0.9954991382479299, 'loss_val': 0.0748355856678968, 'psi': 0.9911480676030404}-{'f1_val': 0.9958267183641853, 'auprc': 0.9995965337320254, 'loss_val': 0.07850688837609905, 'psi': 0.9973346445113214}
[S10] START round=16 head_norm_before_train=1.942940 (no previous merge yet)
[S10] round=16 local utility u=0.000000 metrics={'f1_val': 0.9929110311196298, 'auprc': 0.9966176297147769, 'loss_val': 0.04082533400405611, 'psi': 0.9943936705576886}-{'f1_val': 0.9933244994136741, 'auprc': 0.9969861897746075, 'loss_val': 0.041840005715409606, 'psi': 0.9947891755580474}
[S11] START round=16 head_norm_before_train=1.478907 cos_to_last_merge=0.8398 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.840
[S11] round=16 local utility u=0.000000 metrics={'f1_val': 0.996567470639547, 'auprc': 0.998484959197526, 'loss_val': 0.13903366229431885, 'psi': 0.9973344660627386}-{'f1_val': 0.9967189926998994, 'auprc': 0.9984698413944078, 'loss_val': 0.13848693428665554, 'psi': 0.9974193321777027}
[S13] START round=16 head_norm_before_train=1.690015 (no previous merge yet)
[S13] round=16 local utility u=0.126900 metrics={'f1_val': 0.6177155570697538, 'auprc': 0.6722568170915788, 'loss_val': 0.6584625919526091, 'psi': 0.6395320610784838}-{'f1_val': 0.5890910441196877, 'auprc': 0.6824734901236398, 'loss_val': 0.771165752534832, 'psi': 0.6264440225212686}
[S14] START round=16 head_norm_before_train=1.723349 (no previous merge yet)
[S14] round=16 local utility u=0.002887 metrics={'f1_val': 0.9981277793728904, 'auprc': 0.9974815595643256, 'loss_val': 0.09237256701279357, 'psi': 0.9978692914494645}-{'f1_val': 0.9976760408229349, 'auprc': 0.9966597448416084, 'loss_val': 0.09297156563557077, 'psi': 0.9972695224304043}
[S15] START round=16 head_norm_before_train=1.137531 cos_to_last_merge=1.0000 (last merge round=15)
[S15] round=16 local utility u=0.000000 metrics={'f1_val': 0.6979397577927536, 'auprc': 0.9817778847012821, 'loss_val': 0.39991013986922563, 'psi': 0.8114750085561651}-{'f1_val': 0.6972440552735569, 'auprc': 0.9868796440562703, 'loss_val': 0.3923232974843374, 'psi': 0.8130982907866423}
[S16] START round=16 head_norm_before_train=1.433398 cos_to_last_merge=1.0000 (last merge round=15)
[S16] round=16 local utility u=0.076980 metrics={'f1_val': 0.8282237553483007, 'auprc': 0.8466568511350758, 'loss_val': 0.6676413534449671, 'psi': 0.8355969936630108}-{'f1_val': 0.8308941006117678, 'auprc': 0.8042312222510635, 'loss_val': 0.710346150202816, 'psi': 0.8202289492674861}
[S17] START round=16 head_norm_before_train=1.763113 (no previous merge yet)
[S17] round=16 local utility u=0.180340 metrics={'f1_val': 0.6903391499379427, 'auprc': 0.8818360005642816, 'loss_val': 0.689064047730022, 'psi': 0.7669378901884782}-{'f1_val': 0.686529317441166, 'auprc': 0.8337967011449559, 'loss_val': 0.8827679313440684, 'psi': 0.7454362709226819}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:49314
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:49316
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:49311
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:49310
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1794) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.249451)
[S16] loaded HEAD from S5 (vec_in norm=1.249451)
[S16] cosine check vs S5: cos=0.1489
[S16] BUFFERED delta from S5 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1802) from S13
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.698047)
[S10] loaded HEAD from S13 (vec_in norm=1.698047)
[S10] cosine check vs S13: cos=-0.0904
[S10] DROPPED delta from S13 (cos=-0.0904 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1796) from S16
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.473102)
[S14] loaded HEAD from S16 (vec_in norm=1.473102)
[S14] cosine check vs S16: cos=-0.0898
[S14] DROPPED delta from S16 (cos=-0.0898 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1802) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.749480)
[S8] loaded HEAD from S14 (vec_in norm=1.749480)
[S8] cosine check vs S14: cos=0.9613
[S8] BUFFERED delta from S14 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1802) from S8
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.606569)
[S9] loaded HEAD from S8 (vec_in norm=1.606569)
[S9] cosine check vs S8: cos=-0.0761
[S9] DROPPED delta from S8 (cos=-0.0761 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1795) from S6
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.765917)
[S8] loaded HEAD from S6 (vec_in norm=1.765917)
[S8] cosine check vs S6: cos=0.3004
[S8] BUFFERED delta from S6 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:49303
[S17] sending update (kind=head size=1800 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1800) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.789285)
[S3] loaded HEAD from S17 (vec_in norm=1.789285)
[S3] cosine check vs S17: cos=-0.0725
[S3] DROPPED delta from S17 (cos=-0.0725 < 0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=16 metric=0.8282 head_norm=1.473102
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.920678e-01
[S16] stored merged vector for next round verification (round=16)
[S16] DEBUG after merge:  round=16 metric=0.5604 head_norm=1.034308 delta_norm=0.892068
[S16] aggregate: ROLLBACK (f1_val pre=0.828 post=0.560 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=16 metric=0.9919 head_norm=1.606569
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.309114e-01
[S8] stored merged vector for next round verification (round=16)
[S8] DEBUG after merge:  round=16 metric=0.9915 head_norm=1.400942 delta_norm=0.430911
[S8] aggregate: ACCEPT kept=['S14', 'S6'] (k=2/2) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.619253 cos_to_last_merge=0.9988 (last merge round=15)
[S2] round=17 local utility u=0.006464 metrics={'f1_val': 0.7010457022499126, 'auprc': 0.65898112521806, 'loss_val': 0.3276880074316881, 'psi': 0.6842198714371714}-{'f1_val': 0.701049040284694, 'auprc': 0.6565795741965179, 'loss_val': 0.33343053916388893, 'psi': 0.6832612538494235}
[S3] START round=17 head_norm_before_train=1.602707 cos_to_last_merge=0.9992 (last merge round=15)
[S3] round=17 local utility u=0.071704 metrics={'f1_val': 0.5986577866844742, 'auprc': 0.9999876705387495, 'loss_val': 0.536504547220272, 'psi': 0.7591897402261842}-{'f1_val': 0.5828653280687559, 'auprc': 0.9986323535316359, 'loss_val': 0.5810921557025908, 'psi': 0.7491721382539079}
[S4] START round=17 head_norm_before_train=1.921594 (no previous merge yet)
[S4] round=17 local utility u=0.106449 metrics={'f1_val': 0.9699115634604849, 'auprc': 0.9856149788389665, 'loss_val': 0.12562924915659138, 'psi': 0.9761929296118776}-{'f1_val': 0.9492177654348801, 'auprc': 0.9643859180139935, 'loss_val': 0.15067661466519894, 'psi': 0.9552850264665255}
[S5] START round=17 head_norm_before_train=1.249451 cos_to_last_merge=0.9989 (last merge round=15)
[S5] round=17 local utility u=0.000000 metrics={'f1_val': 0.6980497097591752, 'auprc': 0.7912042433923948, 'loss_val': 0.5787924977108895, 'psi': 0.7353115232124632}-{'f1_val': 0.7005708485915159, 'auprc': 0.9349625491530313, 'loss_val': 0.5750248293897918, 'psi': 0.794327528816122}
[S6] START round=17 head_norm_before_train=1.765917 (no previous merge yet)
[S6] round=17 local utility u=0.000000 metrics={'f1_val': 0.7859146892579967, 'auprc': 0.9418044064974029, 'loss_val': 0.5419544045972501, 'psi': 0.8482705761537592}-{'f1_val': 0.9352120420231103, 'auprc': 0.9438735826784123, 'loss_val': 0.2248648044561831, 'psi': 0.9386766582852311}
[S7] START round=17 head_norm_before_train=1.587251 (no previous merge yet)
[S7] round=17 local utility u=1.000000 metrics={'f1_val': 0.6752481881745394, 'auprc': 0.8217632119470913, 'loss_val': 0.48320311273487715, 'psi': 0.7338541976835602}-{'f1_val': 0.392286467650413, 'auprc': 0.7694689618198152, 'loss_val': 1.06471559267853, 'psi': 0.5431594653181739}
[S8] START round=17 head_norm_before_train=1.400942 cos_to_last_merge=1.0000 (last merge round=16)
[S8] round=17 local utility u=0.000000 metrics={'f1_val': 0.9934888194563342, 'auprc': 0.9874635112729936, 'loss_val': 0.15454422887032743, 'psi': 0.9910786961829978}-{'f1_val': 0.9918532151771823, 'auprc': 0.9968947170728435, 'loss_val': 0.12082616721441398, 'psi': 0.9938698159354469}
[S9] START round=17 head_norm_before_train=1.757508 (no previous merge yet)
[S9] round=17 local utility u=0.040780 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.996083345996696, 'loss_val': 0.04550639253337241, 'psi': 0.9964296454870133}-{'f1_val': 0.9882473538397808, 'auprc': 0.9954991382479299, 'loss_val': 0.0748355856678968, 'psi': 0.9911480676030404}
[S10] START round=17 head_norm_before_train=1.969043 (no previous merge yet)
[S10] round=17 local utility u=0.000000 metrics={'f1_val': 0.9933489306849028, 'auprc': 0.994311077315083, 'loss_val': 0.038247063637261214, 'psi': 0.9937337893369749}-{'f1_val': 0.9929110311196298, 'auprc': 0.9966176297147769, 'loss_val': 0.04082533400405611, 'psi': 0.9943936705576886}
[S11] START round=17 head_norm_before_train=1.510768 cos_to_last_merge=0.8345 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.834
[S11] round=17 local utility u=0.000000 metrics={'f1_val': 0.9432023673789057, 'auprc': 0.8986455354441283, 'loss_val': 0.3291519963529379, 'psi': 0.9253796346049947}-{'f1_val': 0.996567470639547, 'auprc': 0.998484959197526, 'loss_val': 0.13903366229431885, 'psi': 0.9973344660627386}
[S13] START round=17 head_norm_before_train=1.698047 (no previous merge yet)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.5577189249934518, 'auprc': 0.6941206341107509, 'loss_val': 0.8564799059153244, 'psi': 0.6122796086403715}-{'f1_val': 0.6177155570697538, 'auprc': 0.6722568170915788, 'loss_val': 0.6584625919526091, 'psi': 0.6395320610784838}
[S14] START round=17 head_norm_before_train=1.749480 (no previous merge yet)
[S14] round=17 local utility u=0.008359 metrics={'f1_val': 0.9974562277245294, 'auprc': 0.9957237986468168, 'loss_val': 0.06635154323755531, 'psi': 0.9967632560934443}-{'f1_val': 0.9981277793728904, 'auprc': 0.9974815595643256, 'loss_val': 0.09237256701279357, 'psi': 0.9978692914494645}
[S15] START round=17 head_norm_before_train=1.204614 cos_to_last_merge=0.9953 (last merge round=15)
[S15] round=17 local utility u=0.845974 metrics={'f1_val': 0.9719652280835913, 'auprc': 0.9662523225153092, 'loss_val': 0.30553915885825755, 'psi': 0.9696800658562785}-{'f1_val': 0.6979397577927536, 'auprc': 0.9817778847012821, 'loss_val': 0.39991013986922563, 'psi': 0.8114750085561651}
[S16] START round=17 head_norm_before_train=1.034308 cos_to_last_merge=1.0000 (last merge round=16)
[S16] round=17 local utility u=0.000000 metrics={'f1_val': 0.7958801615542382, 'auprc': 0.888503002495902, 'loss_val': 0.6230151220742932, 'psi': 0.8329292979309038}-{'f1_val': 0.8282237553483007, 'auprc': 0.8466568511350758, 'loss_val': 0.6676413534449671, 'psi': 0.8355969936630108}
[S17] START round=17 head_norm_before_train=1.789285 (no previous merge yet)
[S17] round=17 local utility u=0.000000 metrics={'f1_val': 0.6766388776254306, 'auprc': 0.8779451980610676, 'loss_val': 0.846559005038937, 'psi': 0.7571614057996854}-{'f1_val': 0.6903391499379427, 'auprc': 0.8818360005642816, 'loss_val': 0.689064047730022, 'psi': 0.7669378901884782}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:49309
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:49303
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S2] → sending delta(kind=head bytes=1790) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:49305
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:49316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:49312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:49302
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S2] sending update (kind=head size=1790 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1802) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.787167)
[S16] loaded HEAD from S9 (vec_in norm=1.787167)
[S16] cosine check vs S9: cos=0.7042
[S16] BUFFERED delta from S9 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1790) from S2
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.657227)
[S15] loaded HEAD from S2 (vec_in norm=1.657227)
[S15] cosine check vs S2: cos=0.5338
[S15] BUFFERED delta from S2 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1796) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.941091)
[S11] loaded HEAD from S4 (vec_in norm=1.941091)
[S11] cosine check vs S4: cos=-0.0894
[S11] DROPPED delta from S4 (cos=-0.0894 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1799) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.773572)
[S8] loaded HEAD from S14 (vec_in norm=1.773572)
[S8] cosine check vs S14: cos=0.8918
[S8] BUFFERED delta from S14 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1804) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.271153)
[S5] loaded HEAD from S15 (vec_in norm=1.271153)
[S5] cosine check vs S15: cos=0.9256
[S5] BUFFERED delta from S15 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1801) from S3
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.626746)
[S2] loaded HEAD from S3 (vec_in norm=1.626746)
[S2] cosine check vs S3: cos=0.9755
[S2] BUFFERED delta from S3 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1796) from S7
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.597681)
[S3] loaded HEAD from S7 (vec_in norm=1.597681)
[S3] cosine check vs S7: cos=0.9891
[S3] BUFFERED delta from S7 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=17 metric=0.6980 head_norm=1.272847
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.453289e-01
[S5] stored merged vector for next round verification (round=17)
[S5] DEBUG after merge:  round=17 metric=0.7117 head_norm=1.248118 delta_norm=0.245329
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=17 metric=0.9935 head_norm=1.464797
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.054581e-01
[S8] stored merged vector for next round verification (round=17)
[S8] DEBUG after merge:  round=17 metric=0.9935 head_norm=1.575182 delta_norm=0.405458
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=17 metric=0.9720 head_norm=1.271153
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.268596e-01
[S15] stored merged vector for next round verification (round=17)
[S15] DEBUG after merge:  round=17 metric=0.9601 head_norm=1.285609 delta_norm=0.726860
[S15] aggregate: ROLLBACK (f1_val pre=0.972 post=0.960 tol_abs=0.005 tol_rel=0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=17 metric=0.7010 head_norm=1.657227
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.822572e-01
[S2] stored merged vector for next round verification (round=17)
[S2] DEBUG after merge:  round=17 metric=0.7010 head_norm=1.631911 delta_norm=0.182257
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=17 metric=0.5987 head_norm=1.626746
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.198446e-01
[S3] stored merged vector for next round verification (round=17)
[S3] DEBUG after merge:  round=17 metric=0.6004 head_norm=1.607818 delta_norm=0.119845
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=17 metric=0.7959 head_norm=1.077802
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.408268e-01
[S16] stored merged vector for next round verification (round=17)
[S16] DEBUG after merge:  round=17 metric=0.8221 head_norm=1.329343 delta_norm=0.640827
[S16] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.631911 cos_to_last_merge=1.0000 (last merge round=17)
[S2] round=18 local utility u=0.046524 metrics={'f1_val': 0.7010491719684291, 'auprc': 0.6997268582801528, 'loss_val': 0.35689726016434303, 'psi': 0.7005202464931186}-{'f1_val': 0.7010457022499126, 'auprc': 0.65898112521806, 'loss_val': 0.3276880074316881, 'psi': 0.6842198714371714}
[S3] START round=18 head_norm_before_train=1.607818 cos_to_last_merge=1.0000 (last merge round=17)
[S3] round=18 local utility u=0.000000 metrics={'f1_val': 0.5747564592119965, 'auprc': 0.9991276895475244, 'loss_val': 0.5813489524437802, 'psi': 0.7445049513462076}-{'f1_val': 0.5986577866844742, 'auprc': 0.9999876705387495, 'loss_val': 0.536504547220272, 'psi': 0.7591897402261842}
[S4] START round=18 head_norm_before_train=1.941091 (no previous merge yet)
[S4] round=18 local utility u=0.000000 metrics={'f1_val': 0.9672128599296241, 'auprc': 0.9855881920775942, 'loss_val': 0.12432598598812335, 'psi': 0.9745629927888122}-{'f1_val': 0.9699115634604849, 'auprc': 0.9856149788389665, 'loss_val': 0.12562924915659138, 'psi': 0.9761929296118776}
[S5] START round=18 head_norm_before_train=1.248118 cos_to_last_merge=1.0000 (last merge round=17)
[S5] round=18 local utility u=0.363346 metrics={'f1_val': 0.7003221706489986, 'auprc': 0.9903429483199936, 'loss_val': 0.4631521772205083, 'psi': 0.8163304817173966}-{'f1_val': 0.6980497097591752, 'auprc': 0.7912042433923948, 'loss_val': 0.5787924977108895, 'psi': 0.7353115232124632}
[S6] START round=18 head_norm_before_train=1.778306 (no previous merge yet)
[S6] round=18 local utility u=0.130108 metrics={'f1_val': 0.8046586716663255, 'auprc': 0.9452570117892183, 'loss_val': 0.40455939376056066, 'psi': 0.8608980077154826}-{'f1_val': 0.7859146892579967, 'auprc': 0.9418044064974029, 'loss_val': 0.5419544045972501, 'psi': 0.8482705761537592}
[S7] START round=18 head_norm_before_train=1.597681 (no previous merge yet)
[S7] round=18 local utility u=0.000000 metrics={'f1_val': 0.5280693583124726, 'auprc': 0.779856524033071, 'loss_val': 0.8145897070886168, 'psi': 0.628784224600712}-{'f1_val': 0.6752481881745394, 'auprc': 0.8217632119470913, 'loss_val': 0.48320311273487715, 'psi': 0.7338541976835602}
[S8] START round=18 head_norm_before_train=1.575182 cos_to_last_merge=1.0000 (last merge round=17)
[S8] round=18 local utility u=0.025231 metrics={'f1_val': 0.9934888194563342, 'auprc': 0.9927638929675929, 'loss_val': 0.11998310174375093, 'psi': 0.9931988488608376}-{'f1_val': 0.9934888194563342, 'auprc': 0.9874635112729936, 'loss_val': 0.15454422887032743, 'psi': 0.9910786961829978}
[S9] START round=18 head_norm_before_train=1.787167 (no previous merge yet)
[S9] round=18 local utility u=0.000000 metrics={'f1_val': 0.9899455008418782, 'auprc': 0.99916806872133, 'loss_val': 0.049940967755662626, 'psi': 0.9936345279936589}-{'f1_val': 0.9966605118138915, 'auprc': 0.996083345996696, 'loss_val': 0.04550639253337241, 'psi': 0.9964296454870133}
[S10] START round=18 head_norm_before_train=1.992831 (no previous merge yet)
[S10] round=18 local utility u=0.002056 metrics={'f1_val': 0.9931299445855843, 'auprc': 0.9961788188926557, 'loss_val': 0.0384248407545413, 'psi': 0.9943494943084129}-{'f1_val': 0.9933489306849028, 'auprc': 0.994311077315083, 'loss_val': 0.038247063637261214, 'psi': 0.9937337893369749}
[S11] START round=18 head_norm_before_train=1.538400 cos_to_last_merge=0.8301 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.830
[S11] round=18 local utility u=0.428073 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9983507880341022, 'loss_val': 0.0907383302585262, 'psi': 0.9971234156949574}-{'f1_val': 0.9432023673789057, 'auprc': 0.8986455354441283, 'loss_val': 0.3291519963529379, 'psi': 0.9253796346049947}
[S13] START round=18 head_norm_before_train=1.709458 (no previous merge yet)
[S13] round=18 local utility u=0.158642 metrics={'f1_val': 0.5789381559516819, 'auprc': 0.6820381362496838, 'loss_val': 0.63026351766844, 'psi': 0.6201781480708826}-{'f1_val': 0.5577189249934518, 'auprc': 0.6941206341107509, 'loss_val': 0.8564799059153244, 'psi': 0.6122796086403715}
[S14] START round=18 head_norm_before_train=1.773572 (no previous merge yet)
[S14] round=18 local utility u=0.005768 metrics={'f1_val': 0.9978938390605482, 'auprc': 0.9970592894679778, 'loss_val': 0.06144723615403846, 'psi': 0.9975600192235201}-{'f1_val': 0.9974562277245294, 'auprc': 0.9957237986468168, 'loss_val': 0.06635154323755531, 'psi': 0.9967632560934443}
[S15] START round=18 head_norm_before_train=1.285609 cos_to_last_merge=1.0000 (last merge round=17)
[S15] round=18 local utility u=0.000000 metrics={'f1_val': 0.6889416510905831, 'auprc': 0.9632498843752192, 'loss_val': 0.4291750333089864, 'psi': 0.7986649444044376}-{'f1_val': 0.9719652280835913, 'auprc': 0.9662523225153092, 'loss_val': 0.30553915885825755, 'psi': 0.9696800658562785}
[S16] START round=18 head_norm_before_train=1.329343 cos_to_last_merge=1.0000 (last merge round=17)
[S16] round=18 local utility u=0.588242 metrics={'f1_val': 0.9218392456931137, 'auprc': 0.9538586828950208, 'loss_val': 0.3983517489018279, 'psi': 0.9346470205738766}-{'f1_val': 0.7958801615542382, 'auprc': 0.888503002495902, 'loss_val': 0.6230151220742932, 'psi': 0.8329292979309038}
[S17] START round=18 head_norm_before_train=1.809389 (no previous merge yet)
[S17] round=18 local utility u=0.017571 metrics={'f1_val': 0.6946244244260636, 'auprc': 0.8785750036506175, 'loss_val': 0.9212192584334128, 'psi': 0.7682046561158852}-{'f1_val': 0.6766388776254306, 'auprc': 0.8779451980610676, 'loss_val': 0.846559005038937, 'psi': 0.7571614057996854}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] → sending delta(kind=head bytes=1793) to S14@127.0.0.1:49314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:49311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] → sending delta(kind=head bytes=1792) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:49316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:49309
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:49315
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:49310
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:49310
[S10] sending update (kind=head size=1793 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1792 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1793 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1800) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.269023)
[S16] loaded HEAD from S5 (vec_in norm=1.269023)
[S16] cosine check vs S5: cos=0.2799
[S16] BUFFERED delta from S5 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1793) from S16
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.375234)
[S14] loaded HEAD from S16 (vec_in norm=1.375234)
[S14] cosine check vs S16: cos=-0.0746
[S14] DROPPED delta from S16 (cos=-0.0746 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1797) from S13
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.714514)
[S10] loaded HEAD from S13 (vec_in norm=1.714514)
[S10] cosine check vs S13: cos=-0.0896
[S10] DROPPED delta from S13 (cos=-0.0896 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1793) from S10
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=2.008881)
[S9] loaded HEAD from S10 (vec_in norm=2.008881)
[S9] cosine check vs S10: cos=-0.0190
[S9] DROPPED delta from S10 (cos=-0.0190 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1801) from S8
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.629565)
[S9] loaded HEAD from S8 (vec_in norm=1.629565)
[S9] cosine check vs S8: cos=-0.0847
[S9] DROPPED delta from S8 (cos=-0.0847 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1800) from S6
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.787307)
[S8] loaded HEAD from S6 (vec_in norm=1.787307)
[S8] cosine check vs S6: cos=0.2967
[S8] BUFFERED delta from S6 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1797) from S2
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.666849)
[S15] loaded HEAD from S2 (vec_in norm=1.666849)
[S15] cosine check vs S2: cos=0.8853
[S15] BUFFERED delta from S2 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1797) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.795422)
[S8] loaded HEAD from S14 (vec_in norm=1.795422)
[S8] cosine check vs S14: cos=0.9717
[S8] BUFFERED delta from S14 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1792) from S11
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.561900)
[S15] loaded HEAD from S11 (vec_in norm=1.561900)
[S15] cosine check vs S11: cos=0.4510
[S15] BUFFERED delta from S11 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:49303
[S17] sending update (kind=head size=1804 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1804) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.826878)
[S3] loaded HEAD from S17 (vec_in norm=1.826878)
[S3] cosine check vs S17: cos=-0.0707
[S3] DROPPED delta from S17 (cos=-0.0707 < 0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=18 metric=0.9218 head_norm=1.375234
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.944767e-01
[S16] stored merged vector for next round verification (round=18)
[S16] DEBUG after merge:  round=18 metric=0.9265 head_norm=1.058135 delta_norm=0.794477
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=18 metric=0.9935 head_norm=1.629565
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.250072e-01
[S8] stored merged vector for next round verification (round=18)
[S8] DEBUG after merge:  round=18 metric=0.9931 head_norm=1.426243 delta_norm=0.425007
[S8] aggregate: ACCEPT kept=['S6', 'S14'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=18 metric=0.6889 head_norm=1.321087
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.372573e-01
[S15] stored merged vector for next round verification (round=18)
[S15] DEBUG after merge:  round=18 metric=0.6889 head_norm=1.223240 delta_norm=0.237257
[S15] aggregate: ACCEPT kept=['S2', 'S11'] (k=2/2) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.666849 cos_to_last_merge=0.9991 (last merge round=17)
[S2] round=19 local utility u=0.086092 metrics={'f1_val': 0.701135811876329, 'auprc': 0.7616526467961389, 'loss_val': 0.37101060538259445, 'psi': 0.725342545844253}-{'f1_val': 0.7010491719684291, 'auprc': 0.6997268582801528, 'loss_val': 0.35689726016434303, 'psi': 0.7005202464931186}
[S3] START round=19 head_norm_before_train=1.632741 cos_to_last_merge=0.9993 (last merge round=17)
[S3] round=19 local utility u=0.330842 metrics={'f1_val': 0.653294757739245, 'auprc': 0.9999995766959255, 'loss_val': 0.3935106965984068, 'psi': 0.7919766853219172}-{'f1_val': 0.5747564592119965, 'auprc': 0.9991276895475244, 'loss_val': 0.5813489524437802, 'psi': 0.7445049513462076}
[S4] START round=19 head_norm_before_train=1.958631 (no previous merge yet)
[S4] round=19 local utility u=0.000000 metrics={'f1_val': 0.9687182566568275, 'auprc': 0.976988345564125, 'loss_val': 0.12711787374045094, 'psi': 0.9720262922197465}-{'f1_val': 0.9672128599296241, 'auprc': 0.9855881920775942, 'loss_val': 0.12432598598812335, 'psi': 0.9745629927888122}
[S5] START round=19 head_norm_before_train=1.269023 cos_to_last_merge=0.9993 (last merge round=17)
[S5] round=19 local utility u=0.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9426082268529978, 'loss_val': 0.41446381072560207, 'psi': 0.7972360812015473}-{'f1_val': 0.7003221706489986, 'auprc': 0.9903429483199936, 'loss_val': 0.4631521772205083, 'psi': 0.8163304817173966}
[S6] START round=19 head_norm_before_train=1.787307 (no previous merge yet)
[S6] round=19 local utility u=0.000000 metrics={'f1_val': 0.7616673222312197, 'auprc': 0.9464676697103591, 'loss_val': 0.6424310448524542, 'psi': 0.8355874612228754}-{'f1_val': 0.8046586716663255, 'auprc': 0.9452570117892183, 'loss_val': 0.40455939376056066, 'psi': 0.8608980077154826}
[S7] START round=19 head_norm_before_train=1.606181 (no previous merge yet)
[S7] round=19 local utility u=0.530603 metrics={'f1_val': 0.6616442801887035, 'auprc': 0.7892387448055788, 'loss_val': 0.5829800878693184, 'psi': 0.7126820660354536}-{'f1_val': 0.5280693583124726, 'auprc': 0.779856524033071, 'loss_val': 0.8145897070886168, 'psi': 0.628784224600712}
[S8] START round=19 head_norm_before_train=1.426243 cos_to_last_merge=1.0000 (last merge round=18)
[S8] round=19 local utility u=0.000000 metrics={'f1_val': 0.9932883265732785, 'auprc': 0.98337721990516, 'loss_val': 0.14794392957564256, 'psi': 0.989323883906031}-{'f1_val': 0.9934888194563342, 'auprc': 0.9927638929675929, 'loss_val': 0.11998310174375093, 'psi': 0.9931988488608376}
[S9] START round=19 head_norm_before_train=1.813049 (no previous merge yet)
[S9] round=19 local utility u=0.022039 metrics={'f1_val': 0.994994420763055, 'auprc': 0.9990351820618064, 'loss_val': 0.03575864433748947, 'psi': 0.9966107252825556}-{'f1_val': 0.9899455008418782, 'auprc': 0.99916806872133, 'loss_val': 0.049940967755662626, 'psi': 0.9936345279936589}
[S10] START round=19 head_norm_before_train=2.008881 (no previous merge yet)
[S10] round=19 local utility u=0.000000 metrics={'f1_val': 0.9931299445855843, 'auprc': 0.9956385831437089, 'loss_val': 0.037590522414052106, 'psi': 0.9941334000088342}-{'f1_val': 0.9931299445855843, 'auprc': 0.9961788188926557, 'loss_val': 0.0384248407545413, 'psi': 0.9943494943084129}
[S11] START round=19 head_norm_before_train=1.561900 cos_to_last_merge=0.8266 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.827
[S11] round=19 local utility u=0.005660 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9983447295486523, 'loss_val': 0.07940079791255389, 'psi': 0.9971209923007776}-{'f1_val': 0.996305167468861, 'auprc': 0.9983507880341022, 'loss_val': 0.0907383302585262, 'psi': 0.9971234156949574}
[S13] START round=19 head_norm_before_train=1.714514 (no previous merge yet)
[S13] round=19 local utility u=0.093253 metrics={'f1_val': 0.6092350204875905, 'auprc': 0.6766298989125565, 'loss_val': 0.6093130929490888, 'psi': 0.636192971857577}-{'f1_val': 0.5789381559516819, 'auprc': 0.6820381362496838, 'loss_val': 0.63026351766844, 'psi': 0.6201781480708826}
[S14] START round=19 head_norm_before_train=1.795422 (no previous merge yet)
[S14] round=19 local utility u=0.000942 metrics={'f1_val': 0.9970198446089119, 'auprc': 0.9973639460323585, 'loss_val': 0.05523258160016453, 'psi': 0.9971574851782905}-{'f1_val': 0.9978938390605482, 'auprc': 0.9970592894679778, 'loss_val': 0.06144723615403846, 'psi': 0.9975600192235201}
[S15] START round=19 head_norm_before_train=1.223240 cos_to_last_merge=1.0000 (last merge round=18)
[S15] round=19 local utility u=0.067825 metrics={'f1_val': 0.7009191843683342, 'auprc': 0.9836121416413312, 'loss_val': 0.4264769982951211, 'psi': 0.813996367277533}-{'f1_val': 0.6889416510905831, 'auprc': 0.9632498843752192, 'loss_val': 0.4291750333089864, 'psi': 0.7986649444044376}
[S16] START round=19 head_norm_before_train=1.058135 cos_to_last_merge=1.0000 (last merge round=18)
[S16] round=19 local utility u=0.000000 metrics={'f1_val': 0.8248884496253794, 'auprc': 0.9896760117444042, 'loss_val': 0.673737273467248, 'psi': 0.8908034744729894}-{'f1_val': 0.9218392456931137, 'auprc': 0.9538586828950208, 'loss_val': 0.3983517489018279, 'psi': 0.9346470205738766}
[S17] START round=19 head_norm_before_train=1.826878 (no previous merge yet)
[S17] round=19 local utility u=0.000000 metrics={'f1_val': 0.6757518554759552, 'auprc': 0.7977033058635271, 'loss_val': 1.206390061251105, 'psi': 0.7245324356309839}-{'f1_val': 0.6946244244260636, 'auprc': 0.8785750036506175, 'loss_val': 0.9212192584334128, 'psi': 0.7682046561158852}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:49302
[S3] sending update (kind=head size=1797 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1797) from S3
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.656379)
[S2] loaded HEAD from S3 (vec_in norm=1.656379)
[S2] cosine check vs S3: cos=0.9825
[S2] BUFFERED delta from S3 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S10@127.0.0.1:49311
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1794 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1794) from S13
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.726454)
[S10] loaded HEAD from S13 (vec_in norm=1.726454)
[S10] cosine check vs S13: cos=-0.0902
[S10] DROPPED delta from S13 (cos=-0.0902 < 0.0)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:49305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:49303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:49316
[S14] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1802) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.274056)
[S5] loaded HEAD from S15 (vec_in norm=1.274056)
[S5] cosine check vs S15: cos=0.8283
[S5] BUFFERED delta from S15 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1800) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.820381)
[S8] loaded HEAD from S14 (vec_in norm=1.820381)
[S8] cosine check vs S14: cos=0.8992
[S8] BUFFERED delta from S14 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1801) from S11
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.585536)
[S15] loaded HEAD from S11 (vec_in norm=1.585536)
[S15] cosine check vs S11: cos=0.5911
[S15] BUFFERED delta from S11 (total buffered=1)
[S7] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1798) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.836251)
[S16] loaded HEAD from S9 (vec_in norm=1.836251)
[S16] cosine check vs S9: cos=0.6300
[S16] BUFFERED delta from S9 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1797) from S7
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.619580)
[S3] loaded HEAD from S7 (vec_in norm=1.619580)
[S3] cosine check vs S7: cos=0.9900
[S3] BUFFERED delta from S7 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:49315
[S2] sending update (kind=head size=1804 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1804) from S2
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.701044)
[S15] loaded HEAD from S2 (vec_in norm=1.701044)
[S15] cosine check vs S2: cos=0.8125
[S15] BUFFERED delta from S2 (total buffered=2)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=19 metric=0.6533 head_norm=1.656379
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.174442e-01
[S3] stored merged vector for next round verification (round=19)
[S3] DEBUG after merge:  round=19 metric=0.6541 head_norm=1.633867 delta_norm=0.117444
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S3] r=20 psi=0.792 u=0.3308 p_local=0.1770 f1=0.653 auprc=1.000 bytes=19764
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=19 metric=0.9933 head_norm=1.492606
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.047420e-01
[S8] stored merged vector for next round verification (round=19)
[S8] DEBUG after merge:  round=19 metric=0.9933 head_norm=1.614625 delta_norm=0.404742
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S8] r=20 psi=0.989 u=0.0000 p_local=0.1233 f1=0.993 auprc=0.983 bytes=18011
[S11] r=20 psi=0.997 u=0.0057 p_local=0.1668 f1=0.996 auprc=0.998 bytes=25190
[S7] r=20 psi=0.713 u=0.5306 p_local=0.4043 f1=0.662 auprc=0.789 bytes=21535
[S9] r=20 psi=0.997 u=0.0220 p_local=0.1279 f1=0.995 auprc=0.999 bytes=19791
[S4] r=20 psi=0.972 u=0.0000 p_local=0.0664 f1=0.969 auprc=0.977 bytes=16189
[S6] r=20 psi=0.836 u=0.0000 p_local=0.2163 f1=0.762 auprc=0.946 bytes=14394
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=19 metric=0.7011 head_norm=1.701044
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.586416e-01
[S2] stored merged vector for next round verification (round=19)
[S2] DEBUG after merge:  round=19 metric=0.7011 head_norm=1.671348 delta_norm=0.158642
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] r=20 psi=0.725 u=0.0861 p_local=0.0640 f1=0.701 auprc=0.762 bytes=14393
[S13] r=20 psi=0.636 u=0.0933 p_local=0.1021 f1=0.609 auprc=0.677 bytes=16178
[S10] r=20 psi=0.994 u=0.0000 p_local=0.0549 f1=0.993 auprc=0.996 bytes=23382
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=19 metric=0.8249 head_norm=1.102693
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.135395e-01
[S16] stored merged vector for next round verification (round=19)
[S16] DEBUG after merge:  round=19 metric=0.8386 head_norm=1.335940 delta_norm=0.713540
[S16] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S16] r=20 psi=0.891 u=0.0000 p_local=0.2304 f1=0.825 auprc=0.990 bytes=19748
[S17] r=20 psi=0.725 u=0.0000 p_local=0.1257 f1=0.676 auprc=0.798 bytes=16187
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=19 metric=0.7009 head_norm=1.274056
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.391658e-01
[S15] stored merged vector for next round verification (round=19)
[S15] DEBUG after merge:  round=19 metric=0.7007 head_norm=1.223429 delta_norm=0.139166
[S15] aggregate: ACCEPT kept=['S11', 'S2'] (k=2/2) mode=median trim_p=0.1
[S15] r=20 psi=0.814 u=0.0678 p_local=0.1795 f1=0.701 auprc=0.984 bytes=19778
[S14] r=20 psi=0.997 u=0.0009 p_local=0.1018 f1=0.997 auprc=0.997 bytes=21600
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=19 metric=0.7003 head_norm=1.294199
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.763664e-01
[S5] stored merged vector for next round verification (round=19)
[S5] DEBUG after merge:  round=19 metric=0.7004 head_norm=1.227776 delta_norm=0.376366
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] r=20 psi=0.797 u=0.0000 p_local=0.2682 f1=0.700 auprc=0.943 bytes=16177
[S2] START round=20 head_norm_before_train=1.671348 cos_to_last_merge=1.0000 (last merge round=19)
[S2] round=20 local utility u=0.375772 metrics={'f1_val': 0.7053959136731758, 'auprc': 0.9818808449526376, 'loss_val': 0.30571130383120837, 'psi': 0.8159898861849606}-{'f1_val': 0.701135811876329, 'auprc': 0.7616526467961389, 'loss_val': 0.37101060538259445, 'psi': 0.725342545844253}
[S3] START round=20 head_norm_before_train=1.633867 cos_to_last_merge=1.0000 (last merge round=19)
[S3] round=20 local utility u=0.193669 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.9996200932524086, 'loss_val': 0.2902551504804632, 'psi': 0.8203470783162499}-{'f1_val': 0.653294757739245, 'auprc': 0.9999995766959255, 'loss_val': 0.3935106965984068, 'psi': 0.7919766853219172}
[S4] START round=20 head_norm_before_train=1.970641 (no previous merge yet)
[S4] round=20 local utility u=0.000000 metrics={'f1_val': 0.9578898525970113, 'auprc': 0.9869003894903592, 'loss_val': 0.1235295002866532, 'psi': 0.9694940673543504}-{'f1_val': 0.9687182566568275, 'auprc': 0.976988345564125, 'loss_val': 0.12711787374045094, 'psi': 0.9720262922197465}
[S5] START round=20 head_norm_before_train=1.227776 cos_to_last_merge=1.0000 (last merge round=19)
[S5] round=20 local utility u=0.000000 metrics={'f1_val': 0.7007938714502642, 'auprc': 0.8346890162437953, 'loss_val': 0.5034818961474639, 'psi': 0.7543519293676766}-{'f1_val': 0.7003213174339138, 'auprc': 0.9426082268529978, 'loss_val': 0.41446381072560207, 'psi': 0.7972360812015473}
[S6] START round=20 head_norm_before_train=1.811042 (no previous merge yet)
[S6] round=20 local utility u=0.965717 metrics={'f1_val': 0.9858867943106657, 'auprc': 0.9634112214928621, 'loss_val': 0.10714501113234863, 'psi': 0.9768965651835442}-{'f1_val': 0.7616673222312197, 'auprc': 0.9464676697103591, 'loss_val': 0.6424310448524542, 'psi': 0.8355874612228754}
[S7] START round=20 head_norm_before_train=1.619580 (no previous merge yet)
[S7] round=20 local utility u=0.279625 metrics={'f1_val': 0.6823273388773228, 'auprc': 0.8783872209443726, 'loss_val': 0.415273901621546, 'psi': 0.7607512917041428}-{'f1_val': 0.6616442801887035, 'auprc': 0.7892387448055788, 'loss_val': 0.5829800878693184, 'psi': 0.7126820660354536}
[S8] START round=20 head_norm_before_train=1.614625 cos_to_last_merge=1.0000 (last merge round=19)
[S8] round=20 local utility u=0.040681 metrics={'f1_val': 0.9914482382097267, 'auprc': 0.9979533773354436, 'loss_val': 0.09926934926592246, 'psi': 0.9940502938600135}-{'f1_val': 0.9932883265732785, 'auprc': 0.98337721990516, 'loss_val': 0.14794392957564256, 'psi': 0.989323883906031}
[S9] START round=20 head_norm_before_train=1.836251 (no previous merge yet)
[S9] round=20 local utility u=0.000000 metrics={'f1_val': 0.9882473538397808, 'auprc': 0.9951831150722232, 'loss_val': 0.052208166499702745, 'psi': 0.9910216583327578}-{'f1_val': 0.994994420763055, 'auprc': 0.9990351820618064, 'loss_val': 0.03575864433748947, 'psi': 0.9966107252825556}
[S10] START round=20 head_norm_before_train=2.027903 (no previous merge yet)
[S10] round=20 local utility u=0.000048 metrics={'f1_val': 0.9931299445855843, 'auprc': 0.9955975903447887, 'loss_val': 0.037372525352896514, 'psi': 0.9941170028892661}-{'f1_val': 0.9931299445855843, 'auprc': 0.9956385831437089, 'loss_val': 0.037590522414052106, 'psi': 0.9941334000088342}
[S11] START round=20 head_norm_before_train=1.585536 cos_to_last_merge=0.8231 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.823
[S11] round=20 local utility u=0.000000 metrics={'f1_val': 0.9463159772035115, 'auprc': 0.9362961284737387, 'loss_val': 0.26229151038039916, 'psi': 0.9423080377116023}-{'f1_val': 0.996305167468861, 'auprc': 0.9983447295486523, 'loss_val': 0.07940079791255389, 'psi': 0.9971209923007776}
[S13] START round=20 head_norm_before_train=1.726454 (no previous merge yet)
[S13] round=20 local utility u=0.000000 metrics={'f1_val': 0.5956642547998531, 'auprc': 0.6859031345559828, 'loss_val': 0.6850261797014542, 'psi': 0.6317598067023049}-{'f1_val': 0.6092350204875905, 'auprc': 0.6766298989125565, 'loss_val': 0.6093130929490888, 'psi': 0.636192971857577}
[S14] START round=20 head_norm_before_train=1.820381 (no previous merge yet)
[S14] round=20 local utility u=0.000000 metrics={'f1_val': 0.9928431501860732, 'auprc': 0.9971344411930849, 'loss_val': 0.06017874773599068, 'psi': 0.9945596665888778}-{'f1_val': 0.9970198446089119, 'auprc': 0.9973639460323585, 'loss_val': 0.05523258160016453, 'psi': 0.9971574851782905}
[S15] START round=20 head_norm_before_train=1.223429 cos_to_last_merge=1.0000 (last merge round=19)
[S15] round=20 local utility u=0.000000 metrics={'f1_val': 0.6917091735383313, 'auprc': 0.9818811383560314, 'loss_val': 0.4110036654623532, 'psi': 0.8077779594654113}-{'f1_val': 0.7009191843683342, 'auprc': 0.9836121416413312, 'loss_val': 0.4264769982951211, 'psi': 0.813996367277533}
[S16] START round=20 head_norm_before_train=1.335940 cos_to_last_merge=1.0000 (last merge round=19)
[S16] round=20 local utility u=0.536522 metrics={'f1_val': 0.9405781207685455, 'auprc': 0.9911051802215639, 'loss_val': 0.299117808068943, 'psi': 0.9607889445497528}-{'f1_val': 0.8248884496253794, 'auprc': 0.9896760117444042, 'loss_val': 0.673737273467248, 'psi': 0.8908034744729894}
[S17] START round=20 head_norm_before_train=1.849259 (no previous merge yet)
[S17] round=20 local utility u=0.000000 metrics={'f1_val': 0.6723817279863508, 'auprc': 0.7745610795074145, 'loss_val': 1.289755683670281, 'psi': 0.7132534685947762}-{'f1_val': 0.6757518554759552, 'auprc': 0.7977033058635271, 'loss_val': 1.206390061251105, 'psi': 0.7245324356309839}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:49315
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:49302
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:49303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:49310
[S8] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1802) from S8
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.675081)
[S9] loaded HEAD from S8 (vec_in norm=1.675081)
[S9] cosine check vs S8: cos=-0.0868
[S9] DROPPED delta from S8 (cos=-0.0868 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1798) from S2
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.701798)
[S15] loaded HEAD from S2 (vec_in norm=1.701798)
[S15] cosine check vs S2: cos=0.7635
[S15] BUFFERED delta from S2 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1795) from S3
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.656842)
[S2] loaded HEAD from S3 (vec_in norm=1.656842)
[S2] cosine check vs S3: cos=0.9904
[S2] BUFFERED delta from S3 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1799) from S6
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.828891)
[S8] loaded HEAD from S6 (vec_in norm=1.828891)
[S8] cosine check vs S6: cos=0.2905
[S8] BUFFERED delta from S6 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:49310
[S10] sending update (kind=head size=1797 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1797) from S10
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=2.041154)
[S9] loaded HEAD from S10 (vec_in norm=2.041154)
[S9] cosine check vs S10: cos=-0.0211
[S9] DROPPED delta from S10 (cos=-0.0211 < 0.0)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:49314
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1799 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1799) from S16
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.382460)
[S14] loaded HEAD from S16 (vec_in norm=1.382460)
[S14] cosine check vs S16: cos=-0.0695
[S14] DROPPED delta from S16 (cos=-0.0695 < 0.0)
[S7] sending update (kind=head size=1797 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1797) from S7
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.631414)
[S3] loaded HEAD from S7 (vec_in norm=1.631414)
[S3] cosine check vs S7: cos=0.9945
[S3] BUFFERED delta from S7 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] ⇄ pheromone p=0.215 → S16@127.0.0.1:49316
[S10] ⇄ pheromone p=0.044 → S9@127.0.0.1:49310
[S13] ⇄ pheromone p=0.082 → S10@127.0.0.1:49311
[S9] ⇄ pheromone p=0.102 → S16@127.0.0.1:49316
[S4] ⇄ pheromone p=0.053 → S11@127.0.0.1:49312
[S11] ⇄ pheromone p=0.133 → S15@127.0.0.1:49315
[S14] ⇄ pheromone p=0.081 → S8@127.0.0.1:49309
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=20 metric=0.9914 head_norm=1.675081
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.045312e+00
[S8] stored merged vector for next round verification (round=20)
[S8] DEBUG after merge:  round=20 metric=0.9900 head_norm=1.408081 delta_norm=1.045312
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.107 → S9@127.0.0.1:49310
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=20 metric=0.7008 head_norm=1.656842
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.736856e-02
[S3] stored merged vector for next round verification (round=20)
[S3] DEBUG after merge:  round=20 metric=0.7008 head_norm=1.641855 delta_norm=0.087369
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.180 → S2@127.0.0.1:49302
[S16] ⇄ pheromone p=0.292 → S14@127.0.0.1:49314
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=20 metric=0.7054 head_norm=1.701798
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.184074e-01
[S2] stored merged vector for next round verification (round=20)
[S2] DEBUG after merge:  round=20 metric=0.7048 head_norm=1.675291 delta_norm=0.118407
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.126 → S15@127.0.0.1:49315
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=20 metric=0.6917 head_norm=1.272051
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.496992e-01
[S15] stored merged vector for next round verification (round=20)
[S15] DEBUG after merge:  round=20 metric=0.6908 head_norm=1.398193 delta_norm=0.549699
[S15] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.144 → S5@127.0.0.1:49305
[S7] ⇄ pheromone p=0.379 → S3@127.0.0.1:49303
[S6] ⇄ pheromone p=0.366 → S8@127.0.0.1:49309
[S17] ⇄ pheromone p=0.101 → S3@127.0.0.1:49303
[S2] START round=21 head_norm_before_train=1.675291 cos_to_last_merge=1.0000 (last merge round=20)
[S2] round=21 local utility u=0.000000 metrics={'f1_val': 0.7012248454989554, 'auprc': 0.9851454970681939, 'loss_val': 0.29646516729313793, 'psi': 0.8147931061266507}-{'f1_val': 0.7053959136731758, 'auprc': 0.9818808449526376, 'loss_val': 0.30571130383120837, 'psi': 0.8159898861849606}
[S3] START round=21 head_norm_before_train=1.641855 cos_to_last_merge=1.0000 (last merge round=20)
[S3] round=21 local utility u=0.007681 metrics={'f1_val': 0.7010108237857944, 'auprc': 0.9992471960963838, 'loss_val': 0.2748485999059296, 'psi': 0.8203053727100302}-{'f1_val': 0.7008317350254774, 'auprc': 0.9996200932524086, 'loss_val': 0.2902551504804632, 'psi': 0.8203470783162499}
[S4] START round=21 head_norm_before_train=1.973605 (no previous merge yet)
[S4] round=21 local utility u=0.000000 metrics={'f1_val': 0.9191733642119203, 'auprc': 0.9342612202397759, 'loss_val': 0.25458413073786257, 'psi': 0.9252085066230625}-{'f1_val': 0.9578898525970113, 'auprc': 0.9869003894903592, 'loss_val': 0.1235295002866532, 'psi': 0.9694940673543504}
[S5] START round=21 head_norm_before_train=1.246708 cos_to_last_merge=0.9993 (last merge round=19)
[S5] round=21 local utility u=0.271995 metrics={'f1_val': 0.7003221706489986, 'auprc': 0.9899761374589648, 'loss_val': 0.4225237030783792, 'psi': 0.8161837573729851}-{'f1_val': 0.7007938714502642, 'auprc': 0.8346890162437953, 'loss_val': 0.5034818961474639, 'psi': 0.7543519293676766}
[S6] START round=21 head_norm_before_train=1.828891 (no previous merge yet)
[S6] round=21 local utility u=0.000000 metrics={'f1_val': 0.8324364610794533, 'auprc': 0.9679590162923123, 'loss_val': 0.3848979824953879, 'psi': 0.8866454831645969}-{'f1_val': 0.9858867943106657, 'auprc': 0.9634112214928621, 'loss_val': 0.10714501113234863, 'psi': 0.9768965651835442}
[S7] START round=21 head_norm_before_train=1.631414 (no previous merge yet)
[S7] round=21 local utility u=0.000000 metrics={'f1_val': 0.4223260889592114, 'auprc': 0.7754082004189187, 'loss_val': 1.0791511106869578, 'psi': 0.5635589335430944}-{'f1_val': 0.6823273388773228, 'auprc': 0.8783872209443726, 'loss_val': 0.415273901621546, 'psi': 0.7607512917041428}
[S8] START round=21 head_norm_before_train=1.408081 cos_to_last_merge=1.0000 (last merge round=20)
[S8] round=21 local utility u=0.000000 metrics={'f1_val': 0.9801438729447547, 'auprc': 0.9810252064962898, 'loss_val': 0.21821083164285301, 'psi': 0.9804964063653687}-{'f1_val': 0.9914482382097267, 'auprc': 0.9979533773354436, 'loss_val': 0.09926934926592246, 'psi': 0.9940502938600135}
[S9] START round=21 head_norm_before_train=1.853220 (no previous merge yet)
[S9] round=21 local utility u=0.037786 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9959393736730293, 'loss_val': 0.02938433673133804, 'psi': 0.9963720565575466}-{'f1_val': 0.9882473538397808, 'auprc': 0.9951831150722232, 'loss_val': 0.052208166499702745, 'psi': 0.9910216583327578}
[S10] START round=21 head_norm_before_train=2.041154 (no previous merge yet)
[S10] round=21 local utility u=0.000245 metrics={'f1_val': 0.9931299445855843, 'auprc': 0.9957703261132668, 'loss_val': 0.03740119779675691, 'psi': 0.9941860971966574}-{'f1_val': 0.9931299445855843, 'auprc': 0.9955975903447887, 'loss_val': 0.037372525352896514, 'psi': 0.9941170028892661}
[S11] START round=21 head_norm_before_train=1.603834 cos_to_last_merge=0.8205 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.821
[S11] round=21 local utility u=0.341654 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9983530827509097, 'loss_val': 0.06509017645820969, 'psi': 0.9971243335816804}-{'f1_val': 0.9463159772035115, 'auprc': 0.9362961284737387, 'loss_val': 0.26229151038039916, 'psi': 0.9423080377116023}
[S13] START round=21 head_norm_before_train=1.736988 (no previous merge yet)
[S13] round=21 local utility u=0.000000 metrics={'f1_val': 0.5756346617414652, 'auprc': 0.6926782642858433, 'loss_val': 0.8174081155302847, 'psi': 0.6224521027592165}-{'f1_val': 0.5956642547998531, 'auprc': 0.6859031345559828, 'loss_val': 0.6850261797014542, 'psi': 0.6317598067023049}
[S14] START round=21 head_norm_before_train=1.842238 (no previous merge yet)
[S14] round=21 local utility u=0.024081 metrics={'f1_val': 0.9980623665153463, 'auprc': 0.9970590070144546, 'loss_val': 0.04310505035929598, 'psi': 0.9976610227149897}-{'f1_val': 0.9928431501860732, 'auprc': 0.9971344411930849, 'loss_val': 0.06017874773599068, 'psi': 0.9945596665888778}
[S15] START round=21 head_norm_before_train=1.398193 cos_to_last_merge=1.0000 (last merge round=20)
[S15] round=21 local utility u=0.080425 metrics={'f1_val': 0.7034947857195883, 'auprc': 0.9910451112080649, 'loss_val': 0.3483600526902782, 'psi': 0.8185149159149789}-{'f1_val': 0.6917091735383313, 'auprc': 0.9818811383560314, 'loss_val': 0.4110036654623532, 'psi': 0.8077779594654113}
[S16] START round=21 head_norm_before_train=1.382460 cos_to_last_merge=0.9990 (last merge round=19)
[S16] round=21 local utility u=0.000000 metrics={'f1_val': 0.8640789741068354, 'auprc': 0.9962298790803427, 'loss_val': 0.47840269509993205, 'psi': 0.9169393360962383}-{'f1_val': 0.9405781207685455, 'auprc': 0.9911051802215639, 'loss_val': 0.299117808068943, 'psi': 0.9607889445497528}
[S17] START round=21 head_norm_before_train=1.868151 (no previous merge yet)
[S17] round=21 local utility u=0.319244 metrics={'f1_val': 0.6882166661725936, 'auprc': 0.878741961402754, 'loss_val': 1.0588198804154478, 'psi': 0.7644267842646577}-{'f1_val': 0.6723817279863508, 'auprc': 0.7745610795074145, 'loss_val': 1.289755683670281, 'psi': 0.7132534685947762}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:49310
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1795 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1795) from S10
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=2.055125)
[S9] loaded HEAD from S10 (vec_in norm=2.055125)
[S9] cosine check vs S10: cos=-0.0222
[S9] DROPPED delta from S10 (cos=-0.0222 < 0.0)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:49309
[S14] sending update (kind=head size=1802 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1802) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.861558)
[S8] loaded HEAD from S14 (vec_in norm=1.861558)
[S8] cosine check vs S14: cos=0.6584
[S8] BUFFERED delta from S14 (total buffered=1)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:49315
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:49302
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:49316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:49316
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:49305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:49303
[S5] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1802) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.267880)
[S16] loaded HEAD from S5 (vec_in norm=1.267880)
[S16] cosine check vs S5: cos=0.3120
[S16] BUFFERED delta from S5 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1796) from S11
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.621958)
[S15] loaded HEAD from S11 (vec_in norm=1.621958)
[S15] cosine check vs S11: cos=0.3545
[S15] BUFFERED delta from S11 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1797) from S3
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.664624)
[S2] loaded HEAD from S3 (vec_in norm=1.664624)
[S2] cosine check vs S3: cos=0.9943
[S2] BUFFERED delta from S3 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1801) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.868188)
[S16] loaded HEAD from S9 (vec_in norm=1.868188)
[S16] cosine check vs S9: cos=0.9387
[S16] BUFFERED delta from S9 (total buffered=2)
[S15] sending update (kind=head size=1802 to 1 peers)
[S17] sending update (kind=head size=1796 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1802) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.458405)
[S5] loaded HEAD from S15 (vec_in norm=1.458405)
[S5] cosine check vs S15: cos=0.8249
[S5] BUFFERED delta from S15 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1796) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.879989)
[S3] loaded HEAD from S17 (vec_in norm=1.879989)
[S3] cosine check vs S17: cos=-0.0657
[S3] DROPPED delta from S17 (cos=-0.0657 < 0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=21 metric=0.9801 head_norm=1.467074
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.108833e-01
[S8] stored merged vector for next round verification (round=21)
[S8] DEBUG after merge:  round=21 metric=0.9700 head_norm=1.517728 delta_norm=0.710883
[S8] aggregate: ROLLBACK (f1_val pre=0.980 post=0.970 tol_abs=0.005 tol_rel=0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=21 metric=0.7012 head_norm=1.698426
[S2] _apply_head_vector_avg (torch): Δ‖w‖=9.095516e-02
[S2] stored merged vector for next round verification (round=21)
[S2] DEBUG after merge:  round=21 metric=0.7012 head_norm=1.679148 delta_norm=0.090955
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=21 metric=0.7003 head_norm=1.267880
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.134224e-01
[S5] stored merged vector for next round verification (round=21)
[S5] DEBUG after merge:  round=21 metric=0.7005 head_norm=1.302426 delta_norm=0.413422
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=21 metric=0.7035 head_norm=1.458405
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.775832e-01
[S15] stored merged vector for next round verification (round=21)
[S15] DEBUG after merge:  round=21 metric=0.7642 head_norm=1.268343 delta_norm=0.877583
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=21 metric=0.8641 head_norm=1.428419
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.558534e-01
[S16] stored merged vector for next round verification (round=21)
[S16] DEBUG after merge:  round=21 metric=0.8562 head_norm=1.265101 delta_norm=0.255853
[S16] aggregate: ROLLBACK (f1_val pre=0.864 post=0.856 tol_abs=0.005 tol_rel=0.0)
[S2] START round=22 head_norm_before_train=1.679148 cos_to_last_merge=1.0000 (last merge round=21)
[S2] round=22 local utility u=0.015068 metrics={'f1_val': 0.7051825967970512, 'auprc': 0.9891030870158057, 'loss_val': 0.30194916270196726, 'psi': 0.818750792884553}-{'f1_val': 0.7012248454989554, 'auprc': 0.9851454970681939, 'loss_val': 0.29646516729313793, 'psi': 0.8147931061266507}
[S3] START round=22 head_norm_before_train=1.664624 cos_to_last_merge=0.9995 (last merge round=20)
[S3] round=22 local utility u=0.025660 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.9987813604325018, 'loss_val': 0.21970171970863564, 'psi': 0.8198761456731241}-{'f1_val': 0.7010108237857944, 'auprc': 0.9992471960963838, 'loss_val': 0.2748485999059296, 'psi': 0.8203053727100302}
[S4] START round=22 head_norm_before_train=1.983392 (no previous merge yet)
[S4] round=22 local utility u=0.239735 metrics={'f1_val': 0.9561790263141198, 'auprc': 0.9785438497745045, 'loss_val': 0.12999551974562587, 'psi': 0.9651249556982737}-{'f1_val': 0.9191733642119203, 'auprc': 0.9342612202397759, 'loss_val': 0.25458413073786257, 'psi': 0.9252085066230625}
[S5] START round=22 head_norm_before_train=1.302426 cos_to_last_merge=1.0000 (last merge round=21)
[S5] round=22 local utility u=0.000000 metrics={'f1_val': 0.6963264940565046, 'auprc': 0.7908425645465933, 'loss_val': 0.5934562903925227, 'psi': 0.7341329222525401}-{'f1_val': 0.7003221706489986, 'auprc': 0.9899761374589648, 'loss_val': 0.4225237030783792, 'psi': 0.8161837573729851}
[S6] START round=22 head_norm_before_train=1.837785 (no previous merge yet)
[S6] round=22 local utility u=0.465075 metrics={'f1_val': 0.9509100971162383, 'auprc': 0.9762384326367018, 'loss_val': 0.19042759812959742, 'psi': 0.9610414313244237}-{'f1_val': 0.8324364610794533, 'auprc': 0.9679590162923123, 'loss_val': 0.3848979824953879, 'psi': 0.8866454831645969}
[S7] START round=22 head_norm_before_train=1.637450 (no previous merge yet)
[S7] round=22 local utility u=1.000000 metrics={'f1_val': 0.6998175569551941, 'auprc': 0.9727295959489481, 'loss_val': 0.30759050061207177, 'psi': 0.8089823725526957}-{'f1_val': 0.4223260889592114, 'auprc': 0.7754082004189187, 'loss_val': 1.0791511106869578, 'psi': 0.5635589335430944}
[S8] START round=22 head_norm_before_train=1.517728 cos_to_last_merge=1.0000 (last merge round=21)
[S8] round=22 local utility u=0.107879 metrics={'f1_val': 0.9897914618847321, 'auprc': 0.9978318545222912, 'loss_val': 0.11075839044989098, 'psi': 0.9930076189397556}-{'f1_val': 0.9801438729447547, 'auprc': 0.9810252064962898, 'loss_val': 0.21821083164285301, 'psi': 0.9804964063653687}
[S9] START round=22 head_norm_before_train=1.868188 (no previous merge yet)
[S9] round=22 local utility u=0.000000 metrics={'f1_val': 0.9941601000394567, 'auprc': 0.9995896837896839, 'loss_val': 0.029976267175545777, 'psi': 0.9963319335395475}-{'f1_val': 0.9966605118138915, 'auprc': 0.9959393736730293, 'loss_val': 0.02938433673133804, 'psi': 0.9963720565575466}
[S10] START round=22 head_norm_before_train=2.055125 (no previous merge yet)
[S10] round=22 local utility u=0.000034 metrics={'f1_val': 0.9929110311196298, 'auprc': 0.9962663501173086, 'loss_val': 0.037507207284199075, 'psi': 0.9942531587187012}-{'f1_val': 0.9931299445855843, 'auprc': 0.9957703261132668, 'loss_val': 0.03740119779675691, 'psi': 0.9941860971966574}
[S11] START round=22 head_norm_before_train=1.621958 cos_to_last_merge=0.8177 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.818
[S11] round=22 local utility u=0.004935 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9987743714401629, 'loss_val': 0.05805862054426712, 'psi': 0.9974502309597935}-{'f1_val': 0.996305167468861, 'auprc': 0.9983530827509097, 'loss_val': 0.06509017645820969, 'psi': 0.9971243335816804}
[S13] START round=22 head_norm_before_train=1.752170 (no previous merge yet)
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.5712347012801091, 'auprc': 0.7071800969637494, 'loss_val': 0.934524429402315, 'psi': 0.6256128595535653}-{'f1_val': 0.5756346617414652, 'auprc': 0.6926782642858433, 'loss_val': 0.8174081155302847, 'psi': 0.6224521027592165}
[S14] START round=22 head_norm_before_train=1.861558 (no previous merge yet)
[S14] round=22 local utility u=0.000000 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9970552255029869, 'loss_val': 0.0428127525679157, 'psi': 0.9975138009815258}-{'f1_val': 0.9980623665153463, 'auprc': 0.9970590070144546, 'loss_val': 0.04310505035929598, 'psi': 0.9976610227149897}
[S15] START round=22 head_norm_before_train=1.268343 cos_to_last_merge=1.0000 (last merge round=21)
[S15] round=22 local utility u=0.000000 metrics={'f1_val': 0.6938031226236199, 'auprc': 0.987232634991059, 'loss_val': 0.380005308861057, 'psi': 0.8111749275705955}-{'f1_val': 0.7034947857195883, 'auprc': 0.9910451112080649, 'loss_val': 0.3483600526902782, 'psi': 0.8185149159149789}
[S16] START round=22 head_norm_before_train=1.265101 cos_to_last_merge=1.0000 (last merge round=21)
[S16] round=22 local utility u=0.478259 metrics={'f1_val': 0.986050495575405, 'auprc': 0.9911078807825408, 'loss_val': 0.23834832985854715, 'psi': 0.9880734496582593}-{'f1_val': 0.8640789741068354, 'auprc': 0.9962298790803427, 'loss_val': 0.47840269509993205, 'psi': 0.9169393360962383}
[S17] START round=22 head_norm_before_train=1.879989 (no previous merge yet)
[S17] round=22 local utility u=0.000000 metrics={'f1_val': 0.6853941334414381, 'auprc': 0.750227700844062, 'loss_val': 1.1654555587284636, 'psi': 0.7113275604024877}-{'f1_val': 0.6882166661725936, 'auprc': 0.878741961402754, 'loss_val': 1.0588198804154478, 'psi': 0.7644267842646577}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:49312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:49310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:49303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:49309
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:49310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:49315
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S2@127.0.0.1:49302
[S10] sending update (kind=head size=1793 to 1 peers)
[S3] sending update (kind=head size=1794 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1793) from S10
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=2.063783)
[S9] loaded HEAD from S10 (vec_in norm=2.063783)
[S9] cosine check vs S10: cos=-0.0236
[S9] DROPPED delta from S10 (cos=-0.0236 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1804) from S8
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.568824)
[S9] loaded HEAD from S8 (vec_in norm=1.568824)
[S9] cosine check vs S8: cos=-0.0968
[S9] DROPPED delta from S8 (cos=-0.0968 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1801) from S6
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.848723)
[S8] loaded HEAD from S6 (vec_in norm=1.848723)
[S8] cosine check vs S6: cos=0.4402
[S8] BUFFERED delta from S6 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1794) from S3
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.688875)
[S2] loaded HEAD from S3 (vec_in norm=1.688875)
[S2] cosine check vs S3: cos=0.9970
[S2] BUFFERED delta from S3 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1795) from S2
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.698006)
[S15] loaded HEAD from S2 (vec_in norm=1.698006)
[S15] cosine check vs S2: cos=0.5494
[S15] BUFFERED delta from S2 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1803) from S11
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.640832)
[S15] loaded HEAD from S11 (vec_in norm=1.640832)
[S15] cosine check vs S11: cos=0.8375
[S15] BUFFERED delta from S11 (total buffered=2)
[S11] RECEIVED delta(kind=head bytes=1797) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.996131)
[S11] loaded HEAD from S4 (vec_in norm=1.996131)
[S11] cosine check vs S4: cos=-0.0881
[S11] DROPPED delta from S4 (cos=-0.0881 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1802) from S7
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.646012)
[S3] loaded HEAD from S7 (vec_in norm=1.646012)
[S3] cosine check vs S7: cos=0.9934
[S3] BUFFERED delta from S7 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:49314
[S16] sending update (kind=head size=1799 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1799) from S16
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.311776)
[S14] loaded HEAD from S16 (vec_in norm=1.311776)
[S14] cosine check vs S16: cos=-0.0587
[S14] DROPPED delta from S16 (cos=-0.0587 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=22 metric=0.7052 head_norm=1.698006
[S2] _apply_head_vector_avg (torch): Δ‖w‖=6.564953e-02
[S2] stored merged vector for next round verification (round=22)
[S2] DEBUG after merge:  round=22 metric=0.7014 head_norm=1.692174 delta_norm=0.065650
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=22 metric=0.7006 head_norm=1.688875
[S3] _apply_head_vector_avg (torch): Δ‖w‖=9.803772e-02
[S3] stored merged vector for next round verification (round=22)
[S3] DEBUG after merge:  round=22 metric=0.7006 head_norm=1.664697 delta_norm=0.098038
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=22 metric=0.9898 head_norm=1.568824
[S8] _apply_head_vector_avg (torch): Δ‖w‖=9.117937e-01
[S8] stored merged vector for next round verification (round=22)
[S8] DEBUG after merge:  round=22 metric=0.9866 head_norm=1.451939 delta_norm=0.911794
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=22 metric=0.6938 head_norm=1.349141
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.979722e-01
[S15] stored merged vector for next round verification (round=22)
[S15] DEBUG after merge:  round=22 metric=0.6933 head_norm=1.263118 delta_norm=0.197972
[S15] aggregate: ACCEPT kept=['S2', 'S11'] (k=2/2) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.692174 cos_to_last_merge=1.0000 (last merge round=22)
[S2] round=23 local utility u=0.005512 metrics={'f1_val': 0.707384227725436, 'auprc': 0.9878288515643003, 'loss_val': 0.3003122229378495, 'psi': 0.8195620772609817}-{'f1_val': 0.7051825967970512, 'auprc': 0.9891030870158057, 'loss_val': 0.30194916270196726, 'psi': 0.818750792884553}
[S3] START round=23 head_norm_before_train=1.664697 cos_to_last_merge=1.0000 (last merge round=22)
[S3] round=23 local utility u=0.001755 metrics={'f1_val': 0.7009355793019081, 'auprc': 0.9991557262580938, 'loss_val': 0.2192919466185512, 'psi': 0.8202236380843824}-{'f1_val': 0.7006060025002057, 'auprc': 0.9987813604325018, 'loss_val': 0.21970171970863564, 'psi': 0.8198761456731241}
[S4] START round=23 head_norm_before_train=1.996131 (no previous merge yet)
[S4] round=23 local utility u=0.046053 metrics={'f1_val': 0.9703258019442934, 'auprc': 0.9783349992827971, 'loss_val': 0.12214348865557668, 'psi': 0.9735294808796949}-{'f1_val': 0.9561790263141198, 'auprc': 0.9785438497745045, 'loss_val': 0.12999551974562587, 'psi': 0.9651249556982737}
[S5] START round=23 head_norm_before_train=1.319146 cos_to_last_merge=0.9991 (last merge round=21)
[S5] round=23 local utility u=0.248745 metrics={'f1_val': 0.7003221706489986, 'auprc': 0.8961574910004262, 'loss_val': 0.43588537646427694, 'psi': 0.7786562987895697}-{'f1_val': 0.6963264940565046, 'auprc': 0.7908425645465933, 'loss_val': 0.5934562903925227, 'psi': 0.7341329222525401}
[S6] START round=23 head_norm_before_train=1.848723 (no previous merge yet)
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.8203181457515074, 'auprc': 0.9534263232141914, 'loss_val': 0.4831782290359646, 'psi': 0.873561416736581}-{'f1_val': 0.9509100971162383, 'auprc': 0.9762384326367018, 'loss_val': 0.19042759812959742, 'psi': 0.9610414313244237}
[S7] START round=23 head_norm_before_train=1.646012 (no previous merge yet)
[S7] round=23 local utility u=0.000000 metrics={'f1_val': 0.40679982100685863, 'auprc': 0.7755197313631986, 'loss_val': 1.1677248584696407, 'psi': 0.5542877851493946}-{'f1_val': 0.6998175569551941, 'auprc': 0.9727295959489481, 'loss_val': 0.30759050061207177, 'psi': 0.8089823725526957}
[S8] START round=23 head_norm_before_train=1.451939 cos_to_last_merge=1.0000 (last merge round=22)
[S8] round=23 local utility u=0.000000 metrics={'f1_val': 0.9931022471969293, 'auprc': 0.9820832157723143, 'loss_val': 0.17534462769751127, 'psi': 0.9886946346270833}-{'f1_val': 0.9897914618847321, 'auprc': 0.9978318545222912, 'loss_val': 0.11075839044989098, 'psi': 0.9930076189397556}
[S9] START round=23 head_norm_before_train=1.884429 (no previous merge yet)
[S9] round=23 local utility u=0.008371 metrics={'f1_val': 0.9962461149658858, 'auprc': 0.9995924149185873, 'loss_val': 0.025759543944690586, 'psi': 0.9975846349469664}-{'f1_val': 0.9941601000394567, 'auprc': 0.9995896837896839, 'loss_val': 0.029976267175545777, 'psi': 0.9963319335395475}
[S10] START round=23 head_norm_before_train=2.063783 (no previous merge yet)
[S10] round=23 local utility u=0.000000 metrics={'f1_val': 0.9929110311196298, 'auprc': 0.9961823021886798, 'loss_val': 0.03744559409506606, 'psi': 0.9942195395472497}-{'f1_val': 0.9929110311196298, 'auprc': 0.9962663501173086, 'loss_val': 0.037507207284199075, 'psi': 0.9942531587187012}
[S11] START round=23 head_norm_before_train=1.640832 cos_to_last_merge=0.8150 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.815
[S11] round=23 local utility u=0.001629 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9984839684101641, 'loss_val': 0.05235550489098717, 'psi': 0.9971766878453823}-{'f1_val': 0.996567470639547, 'auprc': 0.9987743714401629, 'loss_val': 0.05805862054426712, 'psi': 0.9974502309597935}
[S13] START round=23 head_norm_before_train=1.766807 (no previous merge yet)
[S13] round=23 local utility u=0.159491 metrics={'f1_val': 0.5889142173683019, 'auprc': 0.6941469092525532, 'loss_val': 0.68252026286293, 'psi': 0.6310072941220024}-{'f1_val': 0.5712347012801091, 'auprc': 0.7071800969637494, 'loss_val': 0.934524429402315, 'psi': 0.6256128595535653}
[S14] START round=23 head_norm_before_train=1.881177 (no previous merge yet)
[S14] round=23 local utility u=0.000835 metrics={'f1_val': 0.9976538428159559, 'auprc': 0.9970447197494796, 'loss_val': 0.04011788383835403, 'psi': 0.9974101935893654}-{'f1_val': 0.9978195179672185, 'auprc': 0.9970552255029869, 'loss_val': 0.0428127525679157, 'psi': 0.9975138009815258}
[S15] START round=23 head_norm_before_train=1.263118 cos_to_last_merge=1.0000 (last merge round=22)
[S15] round=23 local utility u=0.288141 metrics={'f1_val': 0.7732902106260173, 'auprc': 0.9880601538465618, 'loss_val': 0.2831291779902807, 'psi': 0.8591981879142351}-{'f1_val': 0.6938031226236199, 'auprc': 0.987232634991059, 'loss_val': 0.380005308861057, 'psi': 0.8111749275705955}
[S16] START round=23 head_norm_before_train=1.311776 cos_to_last_merge=0.9992 (last merge round=21)
[S16] round=23 local utility u=0.057972 metrics={'f1_val': 0.9902833583826779, 'auprc': 0.9958868273616142, 'loss_val': 0.1621393435394982, 'psi': 0.9925247459742524}-{'f1_val': 0.986050495575405, 'auprc': 0.9911078807825408, 'loss_val': 0.23834832985854715, 'psi': 0.9880734496582593}
[S17] START round=23 head_norm_before_train=1.893950 (no previous merge yet)
[S17] round=23 local utility u=0.012512 metrics={'f1_val': 0.6758169646552874, 'auprc': 0.8017550467030192, 'loss_val': 1.2375515821569398, 'psi': 0.7261921974743801}-{'f1_val': 0.6853941334414381, 'auprc': 0.750227700844062, 'loss_val': 1.1654555587284636, 'psi': 0.7113275604024877}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:49316
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:49305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:49311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:49315
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:49316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:49312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:49302
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:49314
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1804 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1803) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.340100)
[S16] loaded HEAD from S5 (vec_in norm=1.340100)
[S16] cosine check vs S5: cos=0.3936
[S16] BUFFERED delta from S5 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1804) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.896836)
[S16] loaded HEAD from S9 (vec_in norm=1.896836)
[S16] cosine check vs S9: cos=0.8967
[S16] BUFFERED delta from S9 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1797) from S2
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.713204)
[S15] loaded HEAD from S2 (vec_in norm=1.713204)
[S15] cosine check vs S2: cos=0.6296
[S15] BUFFERED delta from S2 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1796) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.327974)
[S5] loaded HEAD from S15 (vec_in norm=1.327974)
[S5] cosine check vs S15: cos=0.9441
[S5] BUFFERED delta from S15 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1803) from S16
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.360065)
[S14] loaded HEAD from S16 (vec_in norm=1.360065)
[S14] cosine check vs S16: cos=-0.0610
[S14] DROPPED delta from S16 (cos=-0.0610 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1799) from S11
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.658580)
[S15] loaded HEAD from S11 (vec_in norm=1.658580)
[S15] cosine check vs S11: cos=0.7825
[S15] BUFFERED delta from S11 (total buffered=2)
[S2] RECEIVED delta(kind=head bytes=1799) from S3
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.688016)
[S2] loaded HEAD from S3 (vec_in norm=1.688016)
[S2] cosine check vs S3: cos=0.9968
[S2] BUFFERED delta from S3 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1802) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=2.009797)
[S11] loaded HEAD from S4 (vec_in norm=2.009797)
[S11] cosine check vs S4: cos=-0.0882
[S11] DROPPED delta from S4 (cos=-0.0882 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1802) from S13
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.776465)
[S10] loaded HEAD from S13 (vec_in norm=1.776465)
[S10] cosine check vs S13: cos=-0.0917
[S10] DROPPED delta from S13 (cos=-0.0917 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1802) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.897797)
[S8] loaded HEAD from S14 (vec_in norm=1.897797)
[S8] cosine check vs S14: cos=0.5796
[S8] BUFFERED delta from S14 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:49303
[S17] sending update (kind=head size=1802 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1802) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.915085)
[S3] loaded HEAD from S17 (vec_in norm=1.915085)
[S3] cosine check vs S17: cos=-0.0644
[S3] DROPPED delta from S17 (cos=-0.0644 < 0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=23 metric=0.9931 head_norm=1.500562
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.988054e-01
[S8] stored merged vector for next round verification (round=23)
[S8] DEBUG after merge:  round=23 metric=0.9935 head_norm=1.512802 delta_norm=0.798805
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=23 metric=0.7733 head_norm=1.327974
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.428092e-01
[S15] stored merged vector for next round verification (round=23)
[S15] DEBUG after merge:  round=23 metric=0.7729 head_norm=1.264255 delta_norm=0.142809
[S15] aggregate: ACCEPT kept=['S2', 'S11'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=23 metric=0.7003 head_norm=1.340100
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.231696e-01
[S5] stored merged vector for next round verification (round=23)
[S5] DEBUG after merge:  round=23 metric=0.7003 head_norm=1.315251 delta_norm=0.223170
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=23 metric=0.7074 head_norm=1.713204
[S2] _apply_head_vector_avg (torch): Δ‖w‖=6.902378e-02
[S2] stored merged vector for next round verification (round=23)
[S2] DEBUG after merge:  round=23 metric=0.7062 head_norm=1.699255 delta_norm=0.069024
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=23 metric=0.9903 head_norm=1.360065
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.202676e-01
[S16] stored merged vector for next round verification (round=23)
[S16] DEBUG after merge:  round=23 metric=0.9885 head_norm=1.250557 delta_norm=0.220268
[S16] aggregate: ACCEPT kept=['S5', 'S9'] (k=2/2) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.699255 cos_to_last_merge=1.0000 (last merge round=23)
[S2] round=24 local utility u=0.000000 metrics={'f1_val': 0.7157294459295576, 'auprc': 0.8009351329158761, 'loss_val': 0.3202897669040806, 'psi': 0.7498117207240851}-{'f1_val': 0.707384227725436, 'auprc': 0.9878288515643003, 'loss_val': 0.3003122229378495, 'psi': 0.8195620772609817}
[S3] START round=24 head_norm_before_train=1.688016 cos_to_last_merge=0.9996 (last merge round=22)
[S3] round=24 local utility u=0.925935 metrics={'f1_val': 0.9973386888198309, 'auprc': 0.9987226787805714, 'loss_val': 0.1445410368820608, 'psi': 0.9978922848041271}-{'f1_val': 0.7009355793019081, 'auprc': 0.9991557262580938, 'loss_val': 0.2192919466185512, 'psi': 0.8202236380843824}
[S4] START round=24 head_norm_before_train=2.009797 (no previous merge yet)
[S4] round=24 local utility u=0.000000 metrics={'f1_val': 0.9491664283246746, 'auprc': 0.971764296291979, 'loss_val': 0.1418585145653661, 'psi': 0.9582055755115964}-{'f1_val': 0.9703258019442934, 'auprc': 0.9783349992827971, 'loss_val': 0.12214348865557668, 'psi': 0.9735294808796949}
[S5] START round=24 head_norm_before_train=1.315251 cos_to_last_merge=1.0000 (last merge round=23)
[S5] round=24 local utility u=0.145965 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9864353223018727, 'loss_val': 0.41478402756763183, 'psi': 0.8147669193810974}-{'f1_val': 0.7003221706489986, 'auprc': 0.8961574910004262, 'loss_val': 0.43588537646427694, 'psi': 0.7786562987895697}
[S6] START round=24 head_norm_before_train=1.860034 (no previous merge yet)
[S6] round=24 local utility u=0.000000 metrics={'f1_val': 0.5956230147165751, 'auprc': 0.898712277644357, 'loss_val': 1.0147714346872923, 'psi': 0.7168587198876879}-{'f1_val': 0.8203181457515074, 'auprc': 0.9534263232141914, 'loss_val': 0.4831782290359646, 'psi': 0.873561416736581}
[S7] START round=24 head_norm_before_train=1.652106 (no previous merge yet)
[S7] round=24 local utility u=1.000000 metrics={'f1_val': 0.6489236048840268, 'auprc': 0.7838869385338115, 'loss_val': 0.5962940951440631, 'psi': 0.7029089383439406}-{'f1_val': 0.40679982100685863, 'auprc': 0.7755197313631986, 'loss_val': 1.1677248584696407, 'psi': 0.5542877851493946}
[S8] START round=24 head_norm_before_train=1.512802 cos_to_last_merge=1.0000 (last merge round=23)
[S8] round=24 local utility u=0.067194 metrics={'f1_val': 0.9928576189497129, 'auprc': 0.9978373618691864, 'loss_val': 0.086751202140957, 'psi': 0.9948495161175024}-{'f1_val': 0.9931022471969293, 'auprc': 0.9820832157723143, 'loss_val': 0.17534462769751127, 'psi': 0.9886946346270833}
[S9] START round=24 head_norm_before_train=1.896836 (no previous merge yet)
[S9] round=24 local utility u=0.000000 metrics={'f1_val': 0.9954158325366191, 'auprc': 0.9995960837888449, 'loss_val': 0.024952506743352365, 'psi': 0.9970879330375095}-{'f1_val': 0.9962461149658858, 'auprc': 0.9995924149185873, 'loss_val': 0.025759543944690586, 'psi': 0.9975846349469664}
[S10] START round=24 head_norm_before_train=2.076357 (no previous merge yet)
[S10] round=24 local utility u=0.000000 metrics={'f1_val': 0.9929110311196298, 'auprc': 0.9960195868552699, 'loss_val': 0.03757518443758514, 'psi': 0.9941544534138858}-{'f1_val': 0.9929110311196298, 'auprc': 0.9961823021886798, 'loss_val': 0.03744559409506606, 'psi': 0.9942195395472497}
[S11] START round=24 head_norm_before_train=1.658580 cos_to_last_merge=0.8125 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.813
[S11] round=24 local utility u=0.002135 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9982094304313699, 'loss_val': 0.04726121722805163, 'psi': 0.9970668726538645}-{'f1_val': 0.996305167468861, 'auprc': 0.9984839684101641, 'loss_val': 0.05235550489098717, 'psi': 0.9971766878453823}
[S13] START round=24 head_norm_before_train=1.776465 (no previous merge yet)
[S13] round=24 local utility u=0.051731 metrics={'f1_val': 0.6197063015242708, 'auprc': 0.6903910451329444, 'loss_val': 0.7525437588424683, 'psi': 0.6479801989677402}-{'f1_val': 0.5889142173683019, 'auprc': 0.6941469092525532, 'loss_val': 0.68252026286293, 'psi': 0.6310072941220024}
[S14] START round=24 head_norm_before_train=1.897797 (no previous merge yet)
[S14] round=24 local utility u=0.000491 metrics={'f1_val': 0.9974830777164877, 'auprc': 0.9968640759704087, 'loss_val': 0.03756960141341671, 'psi': 0.997235477018056}-{'f1_val': 0.9976538428159559, 'auprc': 0.9970447197494796, 'loss_val': 0.04011788383835403, 'psi': 0.9974101935893654}
[S15] START round=24 head_norm_before_train=1.264255 cos_to_last_merge=1.0000 (last merge round=23)
[S15] round=24 local utility u=0.599099 metrics={'f1_val': 0.9617678653322027, 'auprc': 0.9908392946003148, 'loss_val': 0.22413479587345975, 'psi': 0.9733964370394474}-{'f1_val': 0.7732902106260173, 'auprc': 0.9880601538465618, 'loss_val': 0.2831291779902807, 'psi': 0.8591981879142351}
[S16] START round=24 head_norm_before_train=1.250557 cos_to_last_merge=1.0000 (last merge round=23)
[S16] round=24 local utility u=0.000000 metrics={'f1_val': 0.8620685171957598, 'auprc': 0.994833660839853, 'loss_val': 0.5119700462797157, 'psi': 0.9151745746533971}-{'f1_val': 0.9902833583826779, 'auprc': 0.9958868273616142, 'loss_val': 0.1621393435394982, 'psi': 0.9925247459742524}
[S17] START round=24 head_norm_before_train=1.915085 (no previous merge yet)
[S17] round=24 local utility u=0.024619 metrics={'f1_val': 0.664249086341035, 'auprc': 0.8579055243676397, 'loss_val': 1.2873573939954313, 'psi': 0.7417116615516769}-{'f1_val': 0.6758169646552874, 'auprc': 0.8017550467030192, 'loss_val': 1.2375515821569398, 'psi': 0.7261921974743801}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:49305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:49316
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:49311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:49310
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:49303
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:49302
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:49315
[S3] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1805 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1801) from S13
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.782020)
[S10] loaded HEAD from S13 (vec_in norm=1.782020)
[S10] cosine check vs S13: cos=-0.0925
[S10] DROPPED delta from S13 (cos=-0.0925 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1802) from S8
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.587907)
[S9] loaded HEAD from S8 (vec_in norm=1.587907)
[S9] cosine check vs S8: cos=-0.0967
[S9] DROPPED delta from S8 (cos=-0.0967 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1805) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.914901)
[S8] loaded HEAD from S14 (vec_in norm=1.914901)
[S8] cosine check vs S14: cos=0.9112
[S8] BUFFERED delta from S14 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1804) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.341966)
[S16] loaded HEAD from S5 (vec_in norm=1.341966)
[S16] cosine check vs S5: cos=0.4847
[S16] BUFFERED delta from S5 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1801) from S11
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.681297)
[S15] loaded HEAD from S11 (vec_in norm=1.681297)
[S15] cosine check vs S11: cos=0.7505
[S15] BUFFERED delta from S11 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1802) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.328090)
[S5] loaded HEAD from S15 (vec_in norm=1.328090)
[S5] cosine check vs S15: cos=0.9847
[S5] BUFFERED delta from S15 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1801) from S3
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.711503)
[S2] loaded HEAD from S3 (vec_in norm=1.711503)
[S2] cosine check vs S3: cos=0.9969
[S2] BUFFERED delta from S3 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1801) from S7
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.657197)
[S3] loaded HEAD from S7 (vec_in norm=1.657197)
[S3] cosine check vs S7: cos=0.9931
[S3] BUFFERED delta from S7 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] → sending delta(kind=head bytes=1805) to S3@127.0.0.1:49303
[S17] sending update (kind=head size=1805 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1805) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.926489)
[S3] loaded HEAD from S17 (vec_in norm=1.926489)
[S3] cosine check vs S17: cos=-0.0696
[S3] DROPPED delta from S17 (cos=-0.0696 < 0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=24 metric=0.7157 head_norm=1.724405
[S2] _apply_head_vector_avg (torch): Δ‖w‖=6.743002e-02
[S2] stored merged vector for next round verification (round=24)
[S2] DEBUG after merge:  round=24 metric=0.7086 head_norm=1.716642 delta_norm=0.067430
[S2] aggregate: ROLLBACK (f1_val pre=0.716 post=0.709 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=24 metric=0.7003 head_norm=1.341966
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.170265e-01
[S5] stored merged vector for next round verification (round=24)
[S5] DEBUG after merge:  round=24 metric=0.7004 head_norm=1.329907 delta_norm=0.117027
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=24 metric=0.9973 head_norm=1.711503
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.022769e-01
[S3] stored merged vector for next round verification (round=24)
[S3] DEBUG after merge:  round=24 metric=0.9919 head_norm=1.681461 delta_norm=0.102277
[S3] aggregate: ROLLBACK (f1_val pre=0.997 post=0.992 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=24 metric=0.9618 head_norm=1.328090
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.565684e-01
[S15] stored merged vector for next round verification (round=24)
[S15] DEBUG after merge:  round=24 metric=0.9729 head_norm=1.409086 delta_norm=0.556568
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=24 metric=0.9929 head_norm=1.587907
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.022526e-01
[S8] stored merged vector for next round verification (round=24)
[S8] DEBUG after merge:  round=24 metric=0.9929 head_norm=1.712408 delta_norm=0.402253
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=24 metric=0.8621 head_norm=1.294611
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.694849e-01
[S16] stored merged vector for next round verification (round=24)
[S16] DEBUG after merge:  round=24 metric=0.8567 head_norm=1.135885 delta_norm=0.669485
[S16] aggregate: ROLLBACK (f1_val pre=0.862 post=0.857 tol_abs=0.005 tol_rel=0.0)
[S2] START round=25 head_norm_before_train=1.716642 cos_to_last_merge=1.0000 (last merge round=24)
[S2] round=25 local utility u=0.284160 metrics={'f1_val': 0.7089902850019278, 'auprc': 0.98822820442212, 'loss_val': 0.2734138630540862, 'psi': 0.8206854527700047}-{'f1_val': 0.7157294459295576, 'auprc': 0.8009351329158761, 'loss_val': 0.3202897669040806, 'psi': 0.7498117207240851}
[S3] START round=25 head_norm_before_train=1.681461 cos_to_last_merge=1.0000 (last merge round=24)
[S3] round=25 local utility u=0.000000 metrics={'f1_val': 0.917567909310905, 'auprc': 0.9992419627921075, 'loss_val': 0.17756422495289945, 'psi': 0.950237530703386}-{'f1_val': 0.9973386888198309, 'auprc': 0.9987226787805714, 'loss_val': 0.1445410368820608, 'psi': 0.9978922848041271}
[S4] START round=25 head_norm_before_train=2.018207 (no previous merge yet)
[S4] round=25 local utility u=0.000000 metrics={'f1_val': 0.9310660991493582, 'auprc': 0.9460728446040434, 'loss_val': 0.23386883521003313, 'psi': 0.9370687973312323}-{'f1_val': 0.9491664283246746, 'auprc': 0.971764296291979, 'loss_val': 0.1418585145653661, 'psi': 0.9582055755115964}
[S5] START round=25 head_norm_before_train=1.329907 cos_to_last_merge=1.0000 (last merge round=24)
[S5] round=25 local utility u=0.016996 metrics={'f1_val': 0.7004069097142683, 'auprc': 0.9898990454133592, 'loss_val': 0.39169635426336846, 'psi': 0.8162037639939047}-{'f1_val': 0.7003213174339138, 'auprc': 0.9864353223018727, 'loss_val': 0.41478402756763183, 'psi': 0.8147669193810974}
[S6] START round=25 head_norm_before_train=1.871599 (no previous merge yet)
[S6] round=25 local utility u=0.918756 metrics={'f1_val': 0.8057358563884719, 'auprc': 0.9238483455764616, 'loss_val': 0.5133439787565943, 'psi': 0.8529808520636677}-{'f1_val': 0.5956230147165751, 'auprc': 0.898712277644357, 'loss_val': 1.0147714346872923, 'psi': 0.7168587198876879}
[S7] START round=25 head_norm_before_train=1.657197 (no previous merge yet)
[S7] round=25 local utility u=0.000000 metrics={'f1_val': 0.5751555521655588, 'auprc': 0.7807206002299127, 'loss_val': 0.7202923729518658, 'psi': 0.6573815713913004}-{'f1_val': 0.6489236048840268, 'auprc': 0.7838869385338115, 'loss_val': 0.5962940951440631, 'psi': 0.7029089383439406}
[S8] START round=25 head_norm_before_train=1.712408 cos_to_last_merge=1.0000 (last merge round=24)
[S8] round=25 local utility u=0.006213 metrics={'f1_val': 0.9919561654725609, 'auprc': 0.9977759206566492, 'loss_val': 0.06873155065235947, 'psi': 0.9942840675461964}-{'f1_val': 0.9928576189497129, 'auprc': 0.9978373618691864, 'loss_val': 0.086751202140957, 'psi': 0.9948495161175024}
[S9] START round=25 head_norm_before_train=1.908968 (no previous merge yet)
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.9937421749897083, 'auprc': 0.9996024732000113, 'loss_val': 0.027754066175612966, 'psi': 0.9960862942738296}-{'f1_val': 0.9954158325366191, 'auprc': 0.9995960837888449, 'loss_val': 0.024952506743352365, 'psi': 0.9970879330375095}
[S10] START round=25 head_norm_before_train=2.091134 (no previous merge yet)
[S10] round=25 local utility u=0.000240 metrics={'f1_val': 0.9929110311196298, 'auprc': 0.9965214466004754, 'loss_val': 0.03860091523384095, 'psi': 0.994355197311968}-{'f1_val': 0.9929110311196298, 'auprc': 0.9960195868552699, 'loss_val': 0.03757518443758514, 'psi': 0.9941544534138858}
[S11] START round=25 head_norm_before_train=1.681297 cos_to_last_merge=0.8093 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.809
[S11] round=25 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9990086583416709, 'loss_val': 0.05009084263494231, 'psi': 0.9972959481831156}-{'f1_val': 0.996305167468861, 'auprc': 0.9982094304313699, 'loss_val': 0.04726121722805163, 'psi': 0.9970668726538645}
[S13] START round=25 head_norm_before_train=1.782020 (no previous merge yet)
[S13] round=25 local utility u=0.001771 metrics={'f1_val': 0.6118854458161049, 'auprc': 0.7245030216614927, 'loss_val': 0.8044128032239617, 'psi': 0.6569324761542601}-{'f1_val': 0.6197063015242708, 'auprc': 0.6903910451329444, 'loss_val': 0.7525437588424683, 'psi': 0.6479801989677402}
[S14] START round=25 head_norm_before_train=1.914901 (no previous merge yet)
[S14] round=25 local utility u=0.000000 metrics={'f1_val': 0.9940755032987544, 'auprc': 0.9970569683063838, 'loss_val': 0.04914822906415237, 'psi': 0.9952680893018062}-{'f1_val': 0.9974830777164877, 'auprc': 0.9968640759704087, 'loss_val': 0.03756960141341671, 'psi': 0.997235477018056}
[S15] START round=25 head_norm_before_train=1.409086 cos_to_last_merge=1.0000 (last merge round=24)
[S15] round=25 local utility u=0.140539 metrics={'f1_val': 0.9898994133182084, 'auprc': 0.9972245249412485, 'loss_val': 0.13100088598074042, 'psi': 0.9928294579674244}-{'f1_val': 0.9617678653322027, 'auprc': 0.9908392946003148, 'loss_val': 0.22413479587345975, 'psi': 0.9733964370394474}
[S16] START round=25 head_norm_before_train=1.135885 cos_to_last_merge=1.0000 (last merge round=24)
[S16] round=25 local utility u=0.197964 metrics={'f1_val': 0.9153780900012356, 'auprc': 0.9964834455908035, 'loss_val': 0.44084944859075226, 'psi': 0.9478202322370628}-{'f1_val': 0.8620685171957598, 'auprc': 0.994833660839853, 'loss_val': 0.5119700462797157, 'psi': 0.9151745746533971}
[S17] START round=25 head_norm_before_train=1.926489 (no previous merge yet)
[S17] round=25 local utility u=0.083259 metrics={'f1_val': 0.6892195693651226, 'auprc': 0.8058646742781974, 'loss_val': 1.1145406292599018, 'psi': 0.7358776113303526}-{'f1_val': 0.664249086341035, 'auprc': 0.8579055243676397, 'loss_val': 1.2873573939954313, 'psi': 0.7417116615516769}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:49315
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S16] → sending delta(kind=head bytes=1788) to S14@127.0.0.1:49314
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:49310
[S13] not sending this round → trigger blocked (psi=0.657)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.816)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:49309
[S8] not sending this round → trigger blocked (psi=0.994)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.993)
[S6] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1794 to 1 peers)
[S16] sending update (kind=head size=1788 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1800) from S2
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.751167)
[S15] loaded HEAD from S2 (vec_in norm=1.751167)
[S15] cosine check vs S2: cos=0.3413
[S15] BUFFERED delta from S2 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1788) from S16
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.179575)
[S14] loaded HEAD from S16 (vec_in norm=1.179575)
[S14] cosine check vs S16: cos=0.0116
[S14] BUFFERED delta from S16 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1794) from S10
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=2.106146)
[S9] loaded HEAD from S10 (vec_in norm=2.106146)
[S9] cosine check vs S10: cos=-0.0266
[S9] DROPPED delta from S10 (cos=-0.0266 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1801) from S6
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.886149)
[S8] loaded HEAD from S6 (vec_in norm=1.886149)
[S8] cosine check vs S6: cos=0.2775
[S8] BUFFERED delta from S6 (total buffered=1)
[S17] not sending this round → trigger blocked (psi=0.736)
[S13] ⇄ pheromone p=0.056 → S10@127.0.0.1:49311
[S5] ⇄ pheromone p=0.151 → S16@127.0.0.1:49316
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=25 metric=0.9941 head_norm=1.930876
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.125485e+00
[S14] stored merged vector for next round verification (round=25)
[S14] DEBUG after merge:  round=25 metric=0.9932 head_norm=1.137156 delta_norm=1.125485
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.029 → S8@127.0.0.1:49309
[S7] ⇄ pheromone p=0.387 → S3@127.0.0.1:49303
[S9] ⇄ pheromone p=0.038 → S16@127.0.0.1:49316
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=25 metric=0.9920 head_norm=1.769192
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.099472e+00
[S8] stored merged vector for next round verification (round=25)
[S8] DEBUG after merge:  round=25 metric=0.9916 head_norm=1.461150 delta_norm=1.099472
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.058 → S9@127.0.0.1:49310
[S4] ⇄ pheromone p=0.048 → S11@127.0.0.1:49312
[S11] ⇄ pheromone p=0.073 → S15@127.0.0.1:49315
[S3] ⇄ pheromone p=0.211 → S2@127.0.0.1:49302
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=25 metric=0.9899 head_norm=1.467505
[S15] _apply_head_vector_avg (torch): Δ‖w‖=9.308782e-01
[S15] stored merged vector for next round verification (round=25)
[S15] DEBUG after merge:  round=25 metric=0.9886 head_norm=1.320433 delta_norm=0.930878
[S15] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.214 → S5@127.0.0.1:49305
[S6] ⇄ pheromone p=0.351 → S8@127.0.0.1:49309
[S10] ⇄ pheromone p=0.014 → S9@127.0.0.1:49310
[S2] ⇄ pheromone p=0.100 → S15@127.0.0.1:49315
[S16] ⇄ pheromone p=0.192 → S14@127.0.0.1:49314
[S17] ⇄ pheromone p=0.081 → S3@127.0.0.1:49303
[S2] START round=26 head_norm_before_train=1.751167 cos_to_last_merge=0.9990 (last merge round=24)
[S2] round=26 local utility u=0.221665 metrics={'f1_val': 0.8279519434828246, 'auprc': 0.8999766275728609, 'loss_val': 0.2790991868853055, 'psi': 0.8567618171188391}-{'f1_val': 0.7089902850019278, 'auprc': 0.98822820442212, 'loss_val': 0.2734138630540862, 'psi': 0.8206854527700047}
[S3] START round=26 head_norm_before_train=1.704824 cos_to_last_merge=0.9996 (last merge round=24)
[S3] round=26 local utility u=0.241643 metrics={'f1_val': 0.9868414147913072, 'auprc': 0.999141096832501, 'loss_val': 0.10961681142491737, 'psi': 0.9917612876077847}-{'f1_val': 0.917567909310905, 'auprc': 0.9992419627921075, 'loss_val': 0.17756422495289945, 'psi': 0.950237530703386}
[S4] START round=26 head_norm_before_train=2.030341 (no previous merge yet)
[S4] round=26 local utility u=0.113995 metrics={'f1_val': 0.9417584041401947, 'auprc': 0.9798244077157308, 'loss_val': 0.17128741384376778, 'psi': 0.9569848055704092}-{'f1_val': 0.9310660991493582, 'auprc': 0.9460728446040434, 'loss_val': 0.23386883521003313, 'psi': 0.9370687973312323}
[S5] START round=26 head_norm_before_train=1.359555 cos_to_last_merge=0.9985 (last merge round=24)
[S5] round=26 local utility u=0.000000 metrics={'f1_val': 0.6726211456042206, 'auprc': 0.7871562602097436, 'loss_val': 0.5021005147974881, 'psi': 0.7184351914464298}-{'f1_val': 0.7004069097142683, 'auprc': 0.9898990454133592, 'loss_val': 0.39169635426336846, 'psi': 0.8162037639939047}
[S6] START round=26 head_norm_before_train=1.886149 (no previous merge yet)
[S6] round=26 local utility u=0.336354 metrics={'f1_val': 0.8601693230028549, 'auprc': 0.9573373013842823, 'loss_val': 0.2677026688498799, 'psi': 0.8990365143554259}-{'f1_val': 0.8057358563884719, 'auprc': 0.9238483455764616, 'loss_val': 0.5133439787565943, 'psi': 0.8529808520636677}
[S7] START round=26 head_norm_before_train=1.666976 (no previous merge yet)
[S7] round=26 local utility u=0.478052 metrics={'f1_val': 0.6806083990134286, 'auprc': 0.8023233188950271, 'loss_val': 0.46171360731212296, 'psi': 0.7292943669660681}-{'f1_val': 0.5751555521655588, 'auprc': 0.7807206002299127, 'loss_val': 0.7202923729518658, 'psi': 0.6573815713913004}
[S8] START round=26 head_norm_before_train=1.461150 cos_to_last_merge=1.0000 (last merge round=25)
[S8] round=26 local utility u=0.000000 metrics={'f1_val': 0.9934741586295472, 'auprc': 0.9947351216939818, 'loss_val': 0.11640830368548548, 'psi': 0.993978543855321}-{'f1_val': 0.9919561654725609, 'auprc': 0.9977759206566492, 'loss_val': 0.06873155065235947, 'psi': 0.9942840675461964}
[S9] START round=26 head_norm_before_train=1.921070 (no previous merge yet)
[S9] round=26 local utility u=0.009829 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9982343158459142, 'loss_val': 0.0241557461999837, 'psi': 0.9975554738456514}-{'f1_val': 0.9937421749897083, 'auprc': 0.9996024732000113, 'loss_val': 0.027754066175612966, 'psi': 0.9960862942738296}
[S10] START round=26 head_norm_before_train=2.106146 (no previous merge yet)
[S10] round=26 local utility u=0.000261 metrics={'f1_val': 0.9929110311196298, 'auprc': 0.9963801524725078, 'loss_val': 0.03765529393599995, 'psi': 0.9942986796607809}-{'f1_val': 0.9929110311196298, 'auprc': 0.9965214466004754, 'loss_val': 0.03860091523384095, 'psi': 0.994355197311968}
[S11] START round=26 head_norm_before_train=1.702671 cos_to_last_merge=0.8058 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.806
[S11] round=26 local utility u=0.000000 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9986920878443671, 'loss_val': 0.0555895217765481, 'psi': 0.9974195840050216}-{'f1_val': 0.9961541414107454, 'auprc': 0.9990086583416709, 'loss_val': 0.05009084263494231, 'psi': 0.9972959481831156}
[S13] START round=26 head_norm_before_train=1.789608 (no previous merge yet)
[S13] round=26 local utility u=0.196565 metrics={'f1_val': 0.6635449205264139, 'auprc': 0.7372591612687918, 'loss_val': 0.7595082058461092, 'psi': 0.6930306168233651}-{'f1_val': 0.6118854458161049, 'auprc': 0.7245030216614927, 'loss_val': 0.8044128032239617, 'psi': 0.6569324761542601}
[S14] START round=26 head_norm_before_train=1.137156 cos_to_last_merge=1.0000 (last merge round=25)
[S14] round=26 local utility u=0.000000 metrics={'f1_val': 0.997013656271678, 'auprc': 0.9971237659747177, 'loss_val': 0.16529012468061866, 'psi': 0.997057700152894}-{'f1_val': 0.9940755032987544, 'auprc': 0.9970569683063838, 'loss_val': 0.04914822906415237, 'psi': 0.9952680893018062}
[S15] START round=26 head_norm_before_train=1.320433 cos_to_last_merge=1.0000 (last merge round=25)
[S15] round=26 local utility u=0.000000 metrics={'f1_val': 0.9889520778479013, 'auprc': 0.9866100324782794, 'loss_val': 0.2002748728179216, 'psi': 0.9880152597000526}-{'f1_val': 0.9898994133182084, 'auprc': 0.9972245249412485, 'loss_val': 0.13100088598074042, 'psi': 0.9928294579674244}
[S16] START round=26 head_norm_before_train=1.179575 cos_to_last_merge=0.9984 (last merge round=24)
[S16] round=26 local utility u=0.254698 metrics={'f1_val': 0.9646311277939095, 'auprc': 0.9975145410554832, 'loss_val': 0.2300656665120655, 'psi': 0.9777844930985389}-{'f1_val': 0.9153780900012356, 'auprc': 0.9964834455908035, 'loss_val': 0.44084944859075226, 'psi': 0.9478202322370628}
[S17] START round=26 head_norm_before_train=1.940063 (no previous merge yet)
[S17] round=26 local utility u=0.054244 metrics={'f1_val': 0.6870693121251364, 'auprc': 0.8666476040243654, 'loss_val': 1.1755006118642277, 'psi': 0.758900628884828}-{'f1_val': 0.6892195693651226, 'auprc': 0.8058646742781974, 'loss_val': 1.1145406292599018, 'psi': 0.7358776113303526}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:49303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:49311
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:49312
[S16] not sending this round → trigger blocked (psi=0.978)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:49302
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.994)
[S2] not sending this round → trigger blocked (psi=0.857)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:49316
[S6] not sending this round → trigger blocked (psi=0.899)
[S9] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.933952)
[S16] loaded HEAD from S9 (vec_in norm=1.933952)
[S16] cosine check vs S9: cos=0.5435
[S16] BUFFERED delta from S9 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1802) from S3
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.727889)
[S2] loaded HEAD from S3 (vec_in norm=1.727889)
[S2] cosine check vs S3: cos=0.9922
[S2] BUFFERED delta from S3 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1800) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=2.048820)
[S11] loaded HEAD from S4 (vec_in norm=2.048820)
[S11] cosine check vs S4: cos=-0.0881
[S11] DROPPED delta from S4 (cos=-0.0881 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1797) from S7
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.678473)
[S3] loaded HEAD from S7 (vec_in norm=1.678473)
[S3] cosine check vs S7: cos=0.9934
[S3] BUFFERED delta from S7 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1799) from S13
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.796554)
[S10] loaded HEAD from S13 (vec_in norm=1.796554)
[S10] cosine check vs S13: cos=-0.0924
[S10] DROPPED delta from S13 (cos=-0.0924 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:49303
[S17] sending update (kind=head size=1799 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1799) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.956620)
[S3] loaded HEAD from S17 (vec_in norm=1.956620)
[S3] cosine check vs S17: cos=-0.0686
[S3] DROPPED delta from S17 (cos=-0.0686 < 0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=26 metric=0.8280 head_norm=1.788962
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.138575e-01
[S2] stored merged vector for next round verification (round=26)
[S2] DEBUG after merge:  round=26 metric=0.8259 head_norm=1.755001 delta_norm=0.113858
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=26 metric=0.9868 head_norm=1.727889
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.011181e-01
[S3] stored merged vector for next round verification (round=26)
[S3] DEBUG after merge:  round=26 metric=0.9733 head_norm=1.700356 delta_norm=0.101118
[S3] aggregate: ROLLBACK (f1_val pre=0.987 post=0.973 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=26 metric=0.9646 head_norm=1.232884
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.167322e-01
[S16] stored merged vector for next round verification (round=26)
[S16] DEBUG after merge:  round=26 metric=0.9649 head_norm=1.401083 delta_norm=0.816732
[S16] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.755001 cos_to_last_merge=1.0000 (last merge round=26)
[S2] round=27 local utility u=0.127508 metrics={'f1_val': 0.8257827690199837, 'auprc': 0.9846964563432264, 'loss_val': 0.2652271113668681, 'psi': 0.8893482439492808}-{'f1_val': 0.8279519434828246, 'auprc': 0.8999766275728609, 'loss_val': 0.2790991868853055, 'psi': 0.8567618171188391}
[S3] START round=27 head_norm_before_train=1.700356 cos_to_last_merge=1.0000 (last merge round=26)
[S3] round=27 local utility u=0.000000 metrics={'f1_val': 0.9611152572344858, 'auprc': 0.9996141714135137, 'loss_val': 0.1305053100883913, 'psi': 0.9765148229060969}-{'f1_val': 0.9868414147913072, 'auprc': 0.999141096832501, 'loss_val': 0.10961681142491737, 'psi': 0.9917612876077847}
[S4] START round=27 head_norm_before_train=2.048820 (no previous merge yet)
[S4] round=27 local utility u=0.000000 metrics={'f1_val': 0.9321702570969874, 'auprc': 0.9642934536513611, 'loss_val': 0.22978634377423476, 'psi': 0.9450195357187369}-{'f1_val': 0.9417584041401947, 'auprc': 0.9798244077157308, 'loss_val': 0.17128741384376778, 'psi': 0.9569848055704092}
[S5] START round=27 head_norm_before_train=1.392868 cos_to_last_merge=0.9947 (last merge round=24)
[S5] round=27 local utility u=0.478254 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9898275289265878, 'loss_val': 0.3198030581749476, 'psi': 0.8161233706654505}-{'f1_val': 0.6726211456042206, 'auprc': 0.7871562602097436, 'loss_val': 0.5021005147974881, 'psi': 0.7184351914464298}
[S6] START round=27 head_norm_before_train=1.912036 (no previous merge yet)
[S6] round=27 local utility u=0.000000 metrics={'f1_val': 0.8138549300276904, 'auprc': 0.9457708141380197, 'loss_val': 0.5881895398935142, 'psi': 0.8666212836718221}-{'f1_val': 0.8601693230028549, 'auprc': 0.9573373013842823, 'loss_val': 0.2677026688498799, 'psi': 0.8990365143554259}
[S7] START round=27 head_norm_before_train=1.678473 (no previous merge yet)
[S7] round=27 local utility u=0.000000 metrics={'f1_val': 0.5617531790529948, 'auprc': 0.7814622271702276, 'loss_val': 0.7771898324860891, 'psi': 0.6496367982998879}-{'f1_val': 0.6806083990134286, 'auprc': 0.8023233188950271, 'loss_val': 0.46171360731212296, 'psi': 0.7292943669660681}
[S8] START round=27 head_norm_before_train=1.520395 cos_to_last_merge=0.9983 (last merge round=25)
[S8] round=27 local utility u=0.021792 metrics={'f1_val': 0.9928576189497129, 'auprc': 0.9980463952286388, 'loss_val': 0.07905887240211365, 'psi': 0.9949331294612833}-{'f1_val': 0.9934741586295472, 'auprc': 0.9947351216939818, 'loss_val': 0.11640830368548548, 'psi': 0.993978543855321}
[S9] START round=27 head_norm_before_train=1.933952 (no previous merge yet)
[S9] round=27 local utility u=0.000000 metrics={'f1_val': 0.9941897064172326, 'auprc': 0.9996031431200469, 'loss_val': 0.02707686608562001, 'psi': 0.9963550810983584}-{'f1_val': 0.9971029125121428, 'auprc': 0.9982343158459142, 'loss_val': 0.0241557461999837, 'psi': 0.9975554738456514}
[S10] START round=27 head_norm_before_train=2.113462 (no previous merge yet)
[S10] round=27 local utility u=0.000387 metrics={'f1_val': 0.9931299445855843, 'auprc': 0.9958345404505267, 'loss_val': 0.03655850277737129, 'psi': 0.9942117829315613}-{'f1_val': 0.9929110311196298, 'auprc': 0.9963801524725078, 'loss_val': 0.03765529393599995, 'psi': 0.9942986796607809}
[S11] START round=27 head_norm_before_train=1.724273 cos_to_last_merge=0.8027 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.803
[S11] round=27 local utility u=0.009152 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9989767186274767, 'loss_val': 0.035513681920993176, 'psi': 0.9972708923989763}-{'f1_val': 0.9965712481121245, 'auprc': 0.9986920878443671, 'loss_val': 0.0555895217765481, 'psi': 0.9974195840050216}
[S13] START round=27 head_norm_before_train=1.796554 (no previous merge yet)
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.6155993138720686, 'auprc': 0.7736004387965197, 'loss_val': 0.931675662927641, 'psi': 0.678799763841849}-{'f1_val': 0.6635449205264139, 'auprc': 0.7372591612687918, 'loss_val': 0.7595082058461092, 'psi': 0.6930306168233651}
[S14] START round=27 head_norm_before_train=1.183892 cos_to_last_merge=0.9990 (last merge round=25)
[S14] round=27 local utility u=0.000000 metrics={'f1_val': 0.9749327684607099, 'auprc': 0.9968352796881013, 'loss_val': 0.13337924240169552, 'psi': 0.9836937729516665}-{'f1_val': 0.997013656271678, 'auprc': 0.9971237659747177, 'loss_val': 0.16529012468061866, 'psi': 0.997057700152894}
[S15] START round=27 head_norm_before_train=1.370345 cos_to_last_merge=0.9984 (last merge round=25)
[S15] round=27 local utility u=0.000000 metrics={'f1_val': 0.6991463226201102, 'auprc': 0.9891259848241056, 'loss_val': 0.4104487645131161, 'psi': 0.8151381875017084}-{'f1_val': 0.9889520778479013, 'auprc': 0.9866100324782794, 'loss_val': 0.2002748728179216, 'psi': 0.9880152597000526}
[S16] START round=27 head_norm_before_train=1.401083 cos_to_last_merge=1.0000 (last merge round=26)
[S16] round=27 local utility u=0.132858 metrics={'f1_val': 0.9901761154227819, 'auprc': 0.9971023453495562, 'loss_val': 0.11638363512624961, 'psi': 0.9929466073934916}-{'f1_val': 0.9646311277939095, 'auprc': 0.9975145410554832, 'loss_val': 0.2300656665120655, 'psi': 0.9777844930985389}
[S17] START round=27 head_norm_before_train=1.956620 (no previous merge yet)
[S17] round=27 local utility u=0.042113 metrics={'f1_val': 0.6888631951829007, 'auprc': 0.8735718085416859, 'loss_val': 1.1228106112220864, 'psi': 0.7627466405264148}-{'f1_val': 0.6870693121251364, 'auprc': 0.8666476040243654, 'loss_val': 1.1755006118642277, 'psi': 0.758900628884828}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:49316
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:49315
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S9@127.0.0.1:49310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:49310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:49315
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:49314
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1794 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1805 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1803) from S16
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.453190)
[S14] loaded HEAD from S16 (vec_in norm=1.453190)
[S14] cosine check vs S16: cos=0.3287
[S14] BUFFERED delta from S16 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1800) from S11
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.745377)
[S15] loaded HEAD from S11 (vec_in norm=1.745377)
[S15] cosine check vs S11: cos=0.5631
[S15] BUFFERED delta from S11 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1803) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.420082)
[S16] loaded HEAD from S5 (vec_in norm=1.420082)
[S16] cosine check vs S5: cos=0.3776
[S16] BUFFERED delta from S5 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1799) from S2
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.786862)
[S15] loaded HEAD from S2 (vec_in norm=1.786862)
[S15] cosine check vs S2: cos=0.8230
[S15] BUFFERED delta from S2 (total buffered=2)
[S9] RECEIVED delta(kind=head bytes=1794) from S10
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=2.123207)
[S9] loaded HEAD from S10 (vec_in norm=2.123207)
[S9] cosine check vs S10: cos=-0.0285
[S9] DROPPED delta from S10 (cos=-0.0285 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1805) from S8
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.584245)
[S9] loaded HEAD from S8 (vec_in norm=1.584245)
[S9] cosine check vs S8: cos=-0.1016
[S9] DROPPED delta from S8 (cos=-0.1016 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:49303
[S17] sending update (kind=head size=1794 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1794) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.971594)
[S3] loaded HEAD from S17 (vec_in norm=1.971594)
[S3] cosine check vs S17: cos=-0.0619
[S3] DROPPED delta from S17 (cos=-0.0619 < 0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=27 metric=0.9749 head_norm=1.253625
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.883283e-01
[S14] stored merged vector for next round verification (round=27)
[S14] DEBUG after merge:  round=27 metric=0.9373 head_norm=1.104630 delta_norm=0.788328
[S14] aggregate: ROLLBACK (f1_val pre=0.975 post=0.937 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=27 metric=0.9902 head_norm=1.453190
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.015242e-01
[S16] stored merged vector for next round verification (round=27)
[S16] DEBUG after merge:  round=27 metric=0.9867 head_norm=1.192374 delta_norm=0.801524
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=27 metric=0.6991 head_norm=1.434132
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.903454e-01
[S15] stored merged vector for next round verification (round=27)
[S15] DEBUG after merge:  round=27 metric=0.6991 head_norm=1.339954 delta_norm=0.190345
[S15] aggregate: ACCEPT kept=['S11', 'S2'] (k=2/2) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=1.786862 cos_to_last_merge=0.9994 (last merge round=26)
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.7350615878487214, 'auprc': 0.9893917399108989, 'loss_val': 0.26416888562005747, 'psi': 0.8367936486735925}-{'f1_val': 0.8257827690199837, 'auprc': 0.9846964563432264, 'loss_val': 0.2652271113668681, 'psi': 0.8893482439492808}
[S3] START round=28 head_norm_before_train=1.719198 cos_to_last_merge=0.9997 (last merge round=26)
[S3] round=28 local utility u=0.003095 metrics={'f1_val': 0.9608296089712303, 'auprc': 0.9999665097502956, 'loss_val': 0.12365866312245719, 'psi': 0.9764843692828564}-{'f1_val': 0.9611152572344858, 'auprc': 0.9996141714135137, 'loss_val': 0.1305053100883913, 'psi': 0.9765148229060969}
[S4] START round=28 head_norm_before_train=2.054091 (no previous merge yet)
[S4] round=28 local utility u=0.003238 metrics={'f1_val': 0.9321702570969874, 'auprc': 0.9649050906717511, 'loss_val': 0.22514511183073224, 'psi': 0.9452641905268928}-{'f1_val': 0.9321702570969874, 'auprc': 0.9642934536513611, 'loss_val': 0.22978634377423476, 'psi': 0.9450195357187369}
[S5] START round=28 head_norm_before_train=1.420082 cos_to_last_merge=0.9908 (last merge round=24)
[S5] round=28 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9046568239966876, 'loss_val': 0.3608153709693399, 'psi': 0.7820550886934905}-{'f1_val': 0.700320598491359, 'auprc': 0.9898275289265878, 'loss_val': 0.3198030581749476, 'psi': 0.8161233706654505}
[S6] START round=28 head_norm_before_train=1.939950 (no previous merge yet)
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.6827119560639338, 'auprc': 0.9064669481008099, 'loss_val': 0.7897719112256572, 'psi': 0.7722139528786842}-{'f1_val': 0.8138549300276904, 'auprc': 0.9457708141380197, 'loss_val': 0.5881895398935142, 'psi': 0.8666212836718221}
[S7] START round=28 head_norm_before_train=1.687439 (no previous merge yet)
[S7] round=28 local utility u=0.708502 metrics={'f1_val': 0.6878500455858526, 'auprc': 0.862358309576493, 'loss_val': 0.3594555506736214, 'psi': 0.7576533511821089}-{'f1_val': 0.5617531790529948, 'auprc': 0.7814622271702276, 'loss_val': 0.7771898324860891, 'psi': 0.6496367982998879}
[S8] START round=28 head_norm_before_train=1.584245 cos_to_last_merge=0.9939 (last merge round=25)
[S8] round=28 local utility u=0.007564 metrics={'f1_val': 0.9924932660920454, 'auprc': 0.9984677622734859, 'loss_val': 0.06300880886782989, 'psi': 0.9948830645646216}-{'f1_val': 0.9928576189497129, 'auprc': 0.9980463952286388, 'loss_val': 0.07905887240211365, 'psi': 0.9949331294612833}
[S9] START round=28 head_norm_before_train=1.946499 (no previous merge yet)
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.9890975148541, 'auprc': 0.9996088213919996, 'loss_val': 0.04000750111614914, 'psi': 0.9933020374692598}-{'f1_val': 0.9941897064172326, 'auprc': 0.9996031431200469, 'loss_val': 0.02707686608562001, 'psi': 0.9963550810983584}
[S10] START round=28 head_norm_before_train=2.123207 (no previous merge yet)
[S10] round=28 local utility u=0.000394 metrics={'f1_val': 0.9929110311196298, 'auprc': 0.9969137754900299, 'loss_val': 0.037694890586402456, 'psi': 0.9945121288677898}-{'f1_val': 0.9931299445855843, 'auprc': 0.9958345404505267, 'loss_val': 0.03655850277737129, 'psi': 0.9942117829315613}
[S11] START round=28 head_norm_before_train=1.745377 cos_to_last_merge=0.8001 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.800
[S11] round=28 local utility u=0.001827 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9985001524574119, 'loss_val': 0.03291033250601301, 'psi': 0.9973282636911185}-{'f1_val': 0.9961336749133093, 'auprc': 0.9989767186274767, 'loss_val': 0.035513681920993176, 'psi': 0.9972708923989763}
[S13] START round=28 head_norm_before_train=1.800105 (no previous merge yet)
[S13] round=28 local utility u=0.055452 metrics={'f1_val': 0.621828843515832, 'auprc': 0.7757833045647295, 'loss_val': 0.8646980757859278, 'psi': 0.6834106279353911}-{'f1_val': 0.6155993138720686, 'auprc': 0.7736004387965197, 'loss_val': 0.931675662927641, 'psi': 0.678799763841849}
[S14] START round=28 head_norm_before_train=1.104630 cos_to_last_merge=1.0000 (last merge round=27)
[S14] round=28 local utility u=0.000000 metrics={'f1_val': 0.9953280742010686, 'auprc': 0.9967716178217557, 'loss_val': 0.28757377699897185, 'psi': 0.9959054916493435}-{'f1_val': 0.9749327684607099, 'auprc': 0.9968352796881013, 'loss_val': 0.13337924240169552, 'psi': 0.9836937729516665}
[S15] START round=28 head_norm_before_train=1.339954 cos_to_last_merge=1.0000 (last merge round=27)
[S15] round=28 local utility u=0.801232 metrics={'f1_val': 0.925989962775723, 'auprc': 0.9948666254755615, 'loss_val': 0.18626821120611448, 'psi': 0.9535406278556584}-{'f1_val': 0.6991463226201102, 'auprc': 0.9891259848241056, 'loss_val': 0.4104487645131161, 'psi': 0.8151381875017084}
[S16] START round=28 head_norm_before_train=1.192374 cos_to_last_merge=1.0000 (last merge round=27)
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.9880326351624776, 'auprc': 0.9972305996933238, 'loss_val': 0.1836835484019755, 'psi': 0.9917118209748161}-{'f1_val': 0.9901761154227819, 'auprc': 0.9971023453495562, 'loss_val': 0.11638363512624961, 'psi': 0.9929466073934916}
[S17] START round=28 head_norm_before_train=1.971594 (no previous merge yet)
[S17] round=28 local utility u=0.000000 metrics={'f1_val': 0.6770040566934029, 'auprc': 0.8713280539287455, 'loss_val': 1.0719325869716252, 'psi': 0.7547336555875399}-{'f1_val': 0.6888631951829007, 'auprc': 0.8735718085416859, 'loss_val': 1.1228106112220864, 'psi': 0.7627466405264148}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] → sending delta(kind=head bytes=1792) to S7@127.0.0.1:49308
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:49307
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S13@127.0.0.1:49313
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:49304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:49302
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1792 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1803) from S15
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.402233)
[S2] loaded HEAD from S15 (vec_in norm=1.402233)
[S2] cosine check vs S15: cos=0.7712
[S2] BUFFERED delta from S15 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1792) from S3
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.739923)
[S7] loaded HEAD from S3 (vec_in norm=1.739923)
[S7] cosine check vs S3: cos=0.9945
[S7] BUFFERED delta from S3 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1800) from S8
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.636658)
[S6] loaded HEAD from S8 (vec_in norm=1.636658)
[S6] cosine check vs S8: cos=0.7726
[S6] BUFFERED delta from S8 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1801) from S11
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.767013)
[S4] loaded HEAD from S11 (vec_in norm=1.767013)
[S4] cosine check vs S11: cos=-0.0896
[S4] DROPPED delta from S11 (cos=-0.0896 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1794) from S10
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=2.135133)
[S13] loaded HEAD from S10 (vec_in norm=2.135133)
[S13] cosine check vs S10: cos=-0.0923
[S13] DROPPED delta from S10 (cos=-0.0923 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=28 metric=0.7351 head_norm=1.822007
[S2] _apply_head_vector_avg (torch): Δ‖w‖=5.799875e-01
[S2] stored merged vector for next round verification (round=28)
[S2] DEBUG after merge:  round=28 metric=0.7274 head_norm=1.518749 delta_norm=0.579987
[S2] aggregate: ROLLBACK (f1_val pre=0.735 post=0.727 tol_abs=0.005 tol_rel=0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=28 metric=0.6827 head_norm=1.955621
[S6] _apply_head_vector_avg (torch): Δ‖w‖=6.240005e-01
[S6] stored merged vector for next round verification (round=28)
[S6] DEBUG after merge:  round=28 metric=0.7284 head_norm=1.691796 delta_norm=0.624000
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=28 metric=0.6879 head_norm=1.697456
[S7] _apply_head_vector_avg (torch): Δ‖w‖=9.265623e-02
[S7] stored merged vector for next round verification (round=28)
[S7] DEBUG after merge:  round=28 metric=0.6869 head_norm=1.716322 delta_norm=0.092656
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=1.518749 cos_to_last_merge=1.0000 (last merge round=28)
[S2] round=29 local utility u=0.252583 metrics={'f1_val': 0.8279082775448054, 'auprc': 0.9825837694358452, 'loss_val': 0.29565826729535694, 'psi': 0.8897784743012214}-{'f1_val': 0.7350615878487214, 'auprc': 0.9893917399108989, 'loss_val': 0.26416888562005747, 'psi': 0.8367936486735925}
[S3] START round=29 head_norm_before_train=1.739923 cos_to_last_merge=0.9989 (last merge round=26)
[S3] round=29 local utility u=0.098311 metrics={'f1_val': 0.9890865600856051, 'auprc': 0.9999591976656952, 'loss_val': 0.09655658153730964, 'psi': 0.9934356151176411}-{'f1_val': 0.9608296089712303, 'auprc': 0.9999665097502956, 'loss_val': 0.12365866312245719, 'psi': 0.9764843692828564}
[S4] START round=29 head_norm_before_train=2.063167 (no previous merge yet)
[S4] round=29 local utility u=0.051673 metrics={'f1_val': 0.9388922378527399, 'auprc': 0.9801506246433183, 'loss_val': 0.20786819283983982, 'psi': 0.9553955925689712}-{'f1_val': 0.9321702570969874, 'auprc': 0.9649050906717511, 'loss_val': 0.22514511183073224, 'psi': 0.9452641905268928}
[S5] START round=29 head_norm_before_train=1.445138 cos_to_last_merge=0.9872 (last merge round=24)
[S5] round=29 local utility u=0.170180 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.989831945638012, 'loss_val': 0.2759858361619983, 'psi': 0.8161255687155531}-{'f1_val': 0.700320598491359, 'auprc': 0.9046568239966876, 'loss_val': 0.3608153709693399, 'psi': 0.7820550886934905}
[S6] START round=29 head_norm_before_train=1.691796 cos_to_last_merge=1.0000 (last merge round=28)
[S6] round=29 local utility u=1.000000 metrics={'f1_val': 0.9745586533981386, 'auprc': 0.9807050963442285, 'loss_val': 0.15566660163972376, 'psi': 0.9770172305765745}-{'f1_val': 0.6827119560639338, 'auprc': 0.9064669481008099, 'loss_val': 0.7897719112256572, 'psi': 0.7722139528786842}
[S7] START round=29 head_norm_before_train=1.716322 cos_to_last_merge=1.0000 (last merge round=28)
[S7] round=29 local utility u=0.000000 metrics={'f1_val': 0.5710298608812947, 'auprc': 0.7817058106175458, 'loss_val': 0.7297933487661946, 'psi': 0.6553002407757952}-{'f1_val': 0.6878500455858526, 'auprc': 0.862358309576493, 'loss_val': 0.3594555506736214, 'psi': 0.7576533511821089}
[S8] START round=29 head_norm_before_train=1.636658 cos_to_last_merge=0.9897 (last merge round=25)
[S8] round=29 local utility u=0.000000 metrics={'f1_val': 0.9897914618847321, 'auprc': 0.9985044691943687, 'loss_val': 0.05916378444486998, 'psi': 0.9932766648085867}-{'f1_val': 0.9924932660920454, 'auprc': 0.9984677622734859, 'loss_val': 0.06300880886782989, 'psi': 0.9948830645646216}
[S9] START round=29 head_norm_before_train=1.959238 (no previous merge yet)
[S9] round=29 local utility u=0.022009 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9945624051319676, 'loss_val': 0.0237665459895469, 'psi': 0.9955750189203536}-{'f1_val': 0.9890975148541, 'auprc': 0.9996088213919996, 'loss_val': 0.04000750111614914, 'psi': 0.9933020374692598}
[S10] START round=29 head_norm_before_train=2.135133 (no previous merge yet)
[S10] round=29 local utility u=0.000000 metrics={'f1_val': 0.9931299445855843, 'auprc': 0.995694460832276, 'loss_val': 0.03644552853557452, 'psi': 0.994155751084261}-{'f1_val': 0.9929110311196298, 'auprc': 0.9969137754900299, 'loss_val': 0.037694890586402456, 'psi': 0.9945121288677898}
[S11] START round=29 head_norm_before_train=1.767013 cos_to_last_merge=0.7976 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.798
[S11] round=29 local utility u=0.000445 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9982634823271079, 'loss_val': 0.03131070156839398, 'psi': 0.9972335956389969}-{'f1_val': 0.9965470045135896, 'auprc': 0.9985001524574119, 'loss_val': 0.03291033250601301, 'psi': 0.9973282636911185}
[S13] START round=29 head_norm_before_train=1.802243 (no previous merge yet)
[S13] round=29 local utility u=0.206970 metrics={'f1_val': 0.6570939687147356, 'auprc': 0.7695202412148394, 'loss_val': 0.6435604774034706, 'psi': 0.7020644777147771}-{'f1_val': 0.621828843515832, 'auprc': 0.7757833045647295, 'loss_val': 0.8646980757859278, 'psi': 0.6834106279353911}
[S14] START round=29 head_norm_before_train=1.166606 cos_to_last_merge=0.9951 (last merge round=27)
[S14] round=29 local utility u=0.000000 metrics={'f1_val': 0.9601327643634934, 'auprc': 0.9968471970928513, 'loss_val': 0.1874622272360641, 'psi': 0.9748185374552365}-{'f1_val': 0.9953280742010686, 'auprc': 0.9967716178217557, 'loss_val': 0.28757377699897185, 'psi': 0.9959054916493435}
[S15] START round=29 head_norm_before_train=1.402233 cos_to_last_merge=0.9983 (last merge round=27)
[S15] round=29 local utility u=0.000000 metrics={'f1_val': 0.8416635072095222, 'auprc': 0.994172506911602, 'loss_val': 0.21776989010838657, 'psi': 0.9026671070903541}-{'f1_val': 0.925989962775723, 'auprc': 0.9948666254755615, 'loss_val': 0.18626821120611448, 'psi': 0.9535406278556584}
[S16] START round=29 head_norm_before_train=1.238482 cos_to_last_merge=0.9988 (last merge round=27)
[S16] round=29 local utility u=0.000000 metrics={'f1_val': 0.8806919508576049, 'auprc': 0.9973441857199168, 'loss_val': 0.4477692013624486, 'psi': 0.9273528448025297}-{'f1_val': 0.9880326351624776, 'auprc': 0.9972305996933238, 'loss_val': 0.1836835484019755, 'psi': 0.9917118209748161}
[S17] START round=29 head_norm_before_train=1.983888 (no previous merge yet)
[S17] round=29 local utility u=0.000000 metrics={'f1_val': 0.6639546722130814, 'auprc': 0.7327512589780067, 'loss_val': 1.5089257799687585, 'psi': 0.6914733069190515}-{'f1_val': 0.6770040566934029, 'auprc': 0.8713280539287455, 'loss_val': 1.0719325869716252, 'psi': 0.7547336555875399}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] sending update (kind=head size=1795 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:49304
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:49315
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:49303
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:49308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:49309
[S5] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1801) from S2
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.562614)
[S3] loaded HEAD from S2 (vec_in norm=1.562614)
[S3] cosine check vs S2: cos=0.9401
[S3] BUFFERED delta from S2 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1803) from S5
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.466329)
[S15] loaded HEAD from S5 (vec_in norm=1.466329)
[S15] cosine check vs S5: cos=0.9620
[S15] BUFFERED delta from S5 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1803) from S9
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.970165)
[S8] loaded HEAD from S9 (vec_in norm=1.970165)
[S8] cosine check vs S9: cos=-0.0914
[S8] DROPPED delta from S9 (cos=-0.0914 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1797) from S11
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.787200)
[S4] loaded HEAD from S11 (vec_in norm=1.787200)
[S4] cosine check vs S11: cos=-0.0907
[S4] DROPPED delta from S11 (cos=-0.0907 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1799) from S3
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.761294)
[S7] loaded HEAD from S3 (vec_in norm=1.761294)
[S7] cosine check vs S3: cos=0.9973
[S7] BUFFERED delta from S3 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=29 metric=0.5710 head_norm=1.724811
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.622247e-02
[S7] stored merged vector for next round verification (round=29)
[S7] DEBUG after merge:  round=29 metric=0.5747 head_norm=1.741890 delta_norm=0.066222
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=29 metric=0.8417 head_norm=1.466186
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.020644e-01
[S15] stored merged vector for next round verification (round=29)
[S15] DEBUG after merge:  round=29 metric=0.8399 head_norm=1.452268 delta_norm=0.202064
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=29 metric=0.9891 head_norm=1.761294
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.038286e-01
[S3] stored merged vector for next round verification (round=29)
[S3] DEBUG after merge:  round=29 metric=0.9945 head_norm=1.636963 delta_norm=0.303829
[S3] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=1.562614 cos_to_last_merge=0.9990 (last merge round=28)
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.8306686295329426, 'auprc': 0.7918425752238202, 'loss_val': 0.310746988900613, 'psi': 0.8151382078092937}-{'f1_val': 0.8279082775448054, 'auprc': 0.9825837694358452, 'loss_val': 0.29565826729535694, 'psi': 0.8897784743012214}
[S3] START round=30 head_norm_before_train=1.636963 cos_to_last_merge=1.0000 (last merge round=29)
[S3] round=30 local utility u=0.029570 metrics={'f1_val': 0.9972450390152456, 'auprc': 0.9999738594952938, 'loss_val': 0.08641045183389416, 'psi': 0.9983365672072649}-{'f1_val': 0.9890865600856051, 'auprc': 0.9999591976656952, 'loss_val': 0.09655658153730964, 'psi': 0.9934356151176411}
[S4] START round=30 head_norm_before_train=2.070595 (no previous merge yet)
[S4] round=30 local utility u=0.000000 metrics={'f1_val': 0.926145262397126, 'auprc': 0.972364775836528, 'loss_val': 0.16679316696496402, 'psi': 0.9446330677728868}-{'f1_val': 0.9388922378527399, 'auprc': 0.9801506246433183, 'loss_val': 0.20786819283983982, 'psi': 0.9553955925689712}
[S5] START round=30 head_norm_before_train=1.466329 cos_to_last_merge=0.9843 (last merge round=24)
[S5] round=30 local utility u=0.000000 metrics={'f1_val': 0.592355349341487, 'auprc': 0.8555198892554084, 'loss_val': 0.496045373354793, 'psi': 0.6976211653070556}-{'f1_val': 0.7003213174339138, 'auprc': 0.989831945638012, 'loss_val': 0.2759858361619983, 'psi': 0.8161255687155531}
[S6] START round=30 head_norm_before_train=1.706475 cos_to_last_merge=0.9999 (last merge round=28)
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.6585602717739293, 'auprc': 0.8031567871333498, 'loss_val': 0.8656339191400654, 'psi': 0.7163988779176975}-{'f1_val': 0.9745586533981386, 'auprc': 0.9807050963442285, 'loss_val': 0.15566660163972376, 'psi': 0.9770172305765745}
[S7] START round=30 head_norm_before_train=1.741890 cos_to_last_merge=1.0000 (last merge round=29)
[S7] round=30 local utility u=0.473841 metrics={'f1_val': 0.676167641152088, 'auprc': 0.8021729399161954, 'loss_val': 0.47433866380801937, 'psi': 0.726569760657731}-{'f1_val': 0.5710298608812947, 'auprc': 0.7817058106175458, 'loss_val': 0.7297933487661946, 'psi': 0.6553002407757952}
[S8] START round=30 head_norm_before_train=1.678030 cos_to_last_merge=0.9861 (last merge round=25)
[S8] round=30 local utility u=0.014884 metrics={'f1_val': 0.9928576189497129, 'auprc': 0.998331138741296, 'loss_val': 0.04727230194210902, 'psi': 0.9950470268663462}-{'f1_val': 0.9897914618847321, 'auprc': 0.9985044691943687, 'loss_val': 0.05916378444486998, 'psi': 0.9932766648085867}
[S9] START round=30 head_norm_before_train=1.970165 (no previous merge yet)
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.9899455008418782, 'auprc': 0.9957238309302474, 'loss_val': 0.039366734897024566, 'psi': 0.9922568328772259}-{'f1_val': 0.9962500947792776, 'auprc': 0.9945624051319676, 'loss_val': 0.0237665459895469, 'psi': 0.9955750189203536}
[S10] START round=30 head_norm_before_train=2.142389 (no previous merge yet)
[S10] round=30 local utility u=0.000614 metrics={'f1_val': 0.9929110311196298, 'auprc': 0.9969236948215374, 'loss_val': 0.037591262770971426, 'psi': 0.9945160966003928}-{'f1_val': 0.9931299445855843, 'auprc': 0.995694460832276, 'loss_val': 0.03644552853557452, 'psi': 0.994155751084261}
[S11] START round=30 head_norm_before_train=1.787200 cos_to_last_merge=0.7952 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.795
[S11] round=30 local utility u=0.000851 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.998231663986583, 'loss_val': 0.029512429171258108, 'psi': 0.997220868302787}-{'f1_val': 0.9965470045135896, 'auprc': 0.9982634823271079, 'loss_val': 0.03131070156839398, 'psi': 0.9972335956389969}
[S13] START round=30 head_norm_before_train=1.814402 (no previous merge yet)
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.6027136094898079, 'auprc': 0.7662036439871805, 'loss_val': 0.8288926375540712, 'psi': 0.6681096232887569}-{'f1_val': 0.6570939687147356, 'auprc': 0.7695202412148394, 'loss_val': 0.6435604774034706, 'psi': 0.7020644777147771}
[S14] START round=30 head_norm_before_train=1.254882 cos_to_last_merge=0.9802 (last merge round=27)
[S14] round=30 local utility u=0.145020 metrics={'f1_val': 0.9965760575063591, 'auprc': 0.9967347754314044, 'loss_val': 0.115744089489414, 'psi': 0.9966395446763772}-{'f1_val': 0.9601327643634934, 'auprc': 0.9968471970928513, 'loss_val': 0.1874622272360641, 'psi': 0.9748185374552365}
[S15] START round=30 head_norm_before_train=1.452268 cos_to_last_merge=1.0000 (last merge round=29)
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.7655699438260505, 'auprc': 0.9886489269687601, 'loss_val': 0.3485180261288301, 'psi': 0.8548015370831343}-{'f1_val': 0.8416635072095222, 'auprc': 0.994172506911602, 'loss_val': 0.21776989010838657, 'psi': 0.9026671070903541}
[S16] START round=30 head_norm_before_train=1.288347 cos_to_last_merge=0.9958 (last merge round=27)
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.8509311560455713, 'auprc': 0.9971200912950577, 'loss_val': 0.6225011072759009, 'psi': 0.9094067301453659}-{'f1_val': 0.8806919508576049, 'auprc': 0.9973441857199168, 'loss_val': 0.4477692013624486, 'psi': 0.9273528448025297}
[S17] START round=30 head_norm_before_train=1.993889 (no previous merge yet)
[S17] round=30 local utility u=0.581556 metrics={'f1_val': 0.7016443724222834, 'auprc': 0.8788432631718243, 'loss_val': 1.010228281569988, 'psi': 0.7725239287220997}-{'f1_val': 0.6639546722130814, 'auprc': 0.7327512589780067, 'loss_val': 1.5089257799687585, 'psi': 0.6914733069190515}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S13@127.0.0.1:49313
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:49316
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:49304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:49308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] → sending delta(kind=head bytes=1806) to S6@127.0.0.1:49307
[S10] sending update (kind=head size=1794 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1806 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1794) from S10
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=2.148451)
[S13] loaded HEAD from S10 (vec_in norm=2.148451)
[S13] cosine check vs S10: cos=-0.0923
[S13] DROPPED delta from S10 (cos=-0.0923 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1799) from S3
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.662120)
[S7] loaded HEAD from S3 (vec_in norm=1.662120)
[S7] cosine check vs S3: cos=0.9856
[S7] BUFFERED delta from S3 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1806) from S8
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.710094)
[S6] loaded HEAD from S8 (vec_in norm=1.710094)
[S6] cosine check vs S8: cos=0.9175
[S6] BUFFERED delta from S8 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1802) from S11
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.802954)
[S4] loaded HEAD from S11 (vec_in norm=1.802954)
[S4] cosine check vs S11: cos=-0.0910
[S4] DROPPED delta from S11 (cos=-0.0910 < 0.0)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1795) from S14
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.345922)
[S16] loaded HEAD from S14 (vec_in norm=1.345922)
[S16] cosine check vs S14: cos=0.7026
[S16] BUFFERED delta from S14 (total buffered=1)
[S5] ⇄ pheromone p=0.126 → S15@127.0.0.1:49315
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=30 metric=0.6762 head_norm=1.752874
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.516637e-01
[S7] stored merged vector for next round verification (round=30)
[S7] DEBUG after merge:  round=30 metric=0.6774 head_norm=1.701353 delta_norm=0.151664
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.105 → S3@127.0.0.1:49303
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=30 metric=0.6586 head_norm=1.734936
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.499925e-01
[S6] stored merged vector for next round verification (round=30)
[S6] DEBUG after merge:  round=30 metric=0.6617 head_norm=1.686629 delta_norm=0.349992
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.025 → S6@127.0.0.1:49307
[S3] ⇄ pheromone p=0.111 → S7@127.0.0.1:49308
[S9] ⇄ pheromone p=0.017 → S8@127.0.0.1:49309
[S14] ⇄ pheromone p=0.038 → S16@127.0.0.1:49316
[S10] ⇄ pheromone p=0.005 → S13@127.0.0.1:49313
[S11] ⇄ pheromone p=0.025 → S4@127.0.0.1:49304
[S15] ⇄ pheromone p=0.173 → S5@127.0.0.1:49305
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=30 metric=0.8509 head_norm=1.336140
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.171801e-01
[S16] stored merged vector for next round verification (round=30)
[S16] DEBUG after merge:  round=30 metric=0.8506 head_norm=1.237300 delta_norm=0.517180
[S16] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.097 → S5@127.0.0.1:49305
[S13] ⇄ pheromone p=0.075 → S10@127.0.0.1:49311
[S2] START round=31 head_norm_before_train=1.606465 cos_to_last_merge=0.9969 (last merge round=28)
[S2] round=31 local utility u=0.294916 metrics={'f1_val': 0.8279876008925147, 'auprc': 0.9857736859680606, 'loss_val': 0.28662249222743624, 'psi': 0.891102034922733}-{'f1_val': 0.8306686295329426, 'auprc': 0.7918425752238202, 'loss_val': 0.310746988900613, 'psi': 0.8151382078092937}
[S3] START round=31 head_norm_before_train=1.662120 cos_to_last_merge=0.9997 (last merge round=29)
[S3] round=31 local utility u=0.000000 metrics={'f1_val': 0.9313672491280158, 'auprc': 0.9997651712771805, 'loss_val': 0.19173219812227713, 'psi': 0.9587264179876817}-{'f1_val': 0.9972450390152456, 'auprc': 0.9999738594952938, 'loss_val': 0.08641045183389416, 'psi': 0.9983365672072649}
[S4] START round=31 head_norm_before_train=2.079578 (no previous merge yet)
[S4] round=31 local utility u=0.037731 metrics={'f1_val': 0.9557588777954225, 'auprc': 0.9442189403039571, 'loss_val': 0.18457565253074867, 'psi': 0.9511429027988363}-{'f1_val': 0.926145262397126, 'auprc': 0.972364775836528, 'loss_val': 0.16679316696496402, 'psi': 0.9446330677728868}
[S5] START round=31 head_norm_before_train=1.488594 cos_to_last_merge=0.9811 (last merge round=24)
[S5] round=31 local utility u=0.140370 metrics={'f1_val': 0.6283471957521944, 'auprc': 0.8551672320550723, 'loss_val': 0.4301980210328755, 'psi': 0.7190752102733455}-{'f1_val': 0.592355349341487, 'auprc': 0.8555198892554084, 'loss_val': 0.496045373354793, 'psi': 0.6976211653070556}
[S6] START round=31 head_norm_before_train=1.686629 cos_to_last_merge=1.0000 (last merge round=30)
[S6] round=31 local utility u=1.000000 metrics={'f1_val': 0.9123488723930071, 'auprc': 0.9491137123849809, 'loss_val': 0.27717298310662297, 'psi': 0.9270548083897967}-{'f1_val': 0.6585602717739293, 'auprc': 0.8031567871333498, 'loss_val': 0.8656339191400654, 'psi': 0.7163988779176975}
[S7] START round=31 head_norm_before_train=1.701353 cos_to_last_merge=1.0000 (last merge round=30)
[S7] round=31 local utility u=0.000000 metrics={'f1_val': 0.6175477020660802, 'auprc': 0.7910321465767141, 'loss_val': 0.6210547772230923, 'psi': 0.6869414798703337}-{'f1_val': 0.676167641152088, 'auprc': 0.8021729399161954, 'loss_val': 0.47433866380801937, 'psi': 0.726569760657731}
[S8] START round=31 head_norm_before_train=1.710094 cos_to_last_merge=0.9833 (last merge round=25)
[S8] round=31 local utility u=0.000435 metrics={'f1_val': 0.9924932660920454, 'auprc': 0.9985908722561329, 'loss_val': 0.04499627394583817, 'psi': 0.9949323085576803}-{'f1_val': 0.9928576189497129, 'auprc': 0.998331138741296, 'loss_val': 0.04727230194210902, 'psi': 0.9950470268663462}
[S9] START round=31 head_norm_before_train=1.979270 (no previous merge yet)
[S9] round=31 local utility u=0.017326 metrics={'f1_val': 0.9920956129422706, 'auprc': 0.999605402294043, 'loss_val': 0.02925999212358754, 'psi': 0.9950995286829796}-{'f1_val': 0.9899455008418782, 'auprc': 0.9957238309302474, 'loss_val': 0.039366734897024566, 'psi': 0.9922568328772259}
[S10] START round=31 head_norm_before_train=2.148451 (no previous merge yet)
[S10] round=31 local utility u=0.000000 metrics={'f1_val': 0.9931299445855843, 'auprc': 0.9954778317565642, 'loss_val': 0.03613644138374692, 'psi': 0.9940690994539764}-{'f1_val': 0.9929110311196298, 'auprc': 0.9969236948215374, 'loss_val': 0.037591262770971426, 'psi': 0.9945160966003928}
[S11] START round=31 head_norm_before_train=1.802954 cos_to_last_merge=0.7931 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.793
[S11] round=31 local utility u=0.000000 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9983000158535206, 'loss_val': 0.028624366341422257, 'psi': 0.9971031068227247}-{'f1_val': 0.9965470045135896, 'auprc': 0.998231663986583, 'loss_val': 0.029512429171258108, 'psi': 0.997220868302787}
[S13] START round=31 head_norm_before_train=1.822855 (no previous merge yet)
[S13] round=31 local utility u=0.135555 metrics={'f1_val': 0.6291395280641343, 'auprc': 0.7853641907214953, 'loss_val': 0.7738201401069524, 'psi': 0.6916293931270787}-{'f1_val': 0.6027136094898079, 'auprc': 0.7662036439871805, 'loss_val': 0.8288926375540712, 'psi': 0.6681096232887569}
[S14] START round=31 head_norm_before_train=1.345922 cos_to_last_merge=0.9627 (last merge round=27)
[S14] round=31 local utility u=0.020677 metrics={'f1_val': 0.9968189060544872, 'auprc': 0.998432543351192, 'loss_val': 0.08094024615732989, 'psi': 0.9974643609731692}-{'f1_val': 0.9965760575063591, 'auprc': 0.9967347754314044, 'loss_val': 0.115744089489414, 'psi': 0.9966395446763772}
[S15] START round=31 head_norm_before_train=1.504258 cos_to_last_merge=0.9994 (last merge round=29)
[S15] round=31 local utility u=0.835346 metrics={'f1_val': 0.9921136733513103, 'auprc': 0.9980644034121633, 'loss_val': 0.06533560356978689, 'psi': 0.9944939653756515}-{'f1_val': 0.7655699438260505, 'auprc': 0.9886489269687601, 'loss_val': 0.3485180261288301, 'psi': 0.8548015370831343}
[S16] START round=31 head_norm_before_train=1.237300 cos_to_last_merge=1.0000 (last merge round=30)
[S16] round=31 local utility u=0.664688 metrics={'f1_val': 0.9908770957330659, 'auprc': 0.9965423725515155, 'loss_val': 0.13106713567043118, 'psi': 0.9931432064604457}-{'f1_val': 0.8509311560455713, 'auprc': 0.9971200912950577, 'loss_val': 0.6225011072759009, 'psi': 0.9094067301453659}
[S17] START round=31 head_norm_before_train=2.007471 (no previous merge yet)
[S17] round=31 local utility u=0.000000 metrics={'f1_val': 0.695517177490587, 'auprc': 0.8845785162035928, 'loss_val': 1.0022546159175312, 'psi': 0.7711417129757894}-{'f1_val': 0.7016443724222834, 'auprc': 0.8788432631718243, 'loss_val': 1.010228281569988, 'psi': 0.7725239287220997}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:49311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:49316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:49312
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:49305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:49303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S16] → sending delta(kind=head bytes=1807) to S5@127.0.0.1:49305
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:49307
[S16] sending update (kind=head size=1807 to 1 peers)
[S6] sending update (kind=head size=1804 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1794 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1799) from S5
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.509956)
[S15] loaded HEAD from S5 (vec_in norm=1.509956)
[S15] cosine check vs S5: cos=0.9851
[S15] BUFFERED delta from S5 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1801) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=2.078921)
[S11] loaded HEAD from S4 (vec_in norm=2.078921)
[S11] cosine check vs S4: cos=-0.0908
[S11] DROPPED delta from S4 (cos=-0.0908 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1802) from S2
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.639665)
[S3] loaded HEAD from S2 (vec_in norm=1.639665)
[S3] cosine check vs S2: cos=0.9756
[S3] BUFFERED delta from S2 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1798) from S13
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.826222)
[S10] loaded HEAD from S13 (vec_in norm=1.826222)
[S10] cosine check vs S13: cos=-0.0934
[S10] DROPPED delta from S13 (cos=-0.0934 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1804) from S6
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.718887)
[S8] loaded HEAD from S6 (vec_in norm=1.718887)
[S8] cosine check vs S6: cos=0.9747
[S8] BUFFERED delta from S6 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1794) from S9
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.985516)
[S8] loaded HEAD from S9 (vec_in norm=1.985516)
[S8] cosine check vs S9: cos=-0.0858
[S8] DROPPED delta from S9 (cos=-0.0858 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1801) from S8
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.732639)
[S6] loaded HEAD from S8 (vec_in norm=1.732639)
[S6] cosine check vs S8: cos=0.9747
[S6] BUFFERED delta from S8 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1807) from S16
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.278412)
[S5] loaded HEAD from S16 (vec_in norm=1.278412)
[S5] cosine check vs S16: cos=0.6609
[S5] BUFFERED delta from S16 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1795) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.545654)
[S5] loaded HEAD from S15 (vec_in norm=1.545654)
[S5] cosine check vs S15: cos=0.9851
[S5] BUFFERED delta from S15 (total buffered=2)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S14
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.420735)
[S16] loaded HEAD from S14 (vec_in norm=1.420735)
[S16] cosine check vs S14: cos=0.9006
[S16] BUFFERED delta from S14 (total buffered=1)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=31 metric=0.9314 head_norm=1.682845
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.848021e-01
[S3] stored merged vector for next round verification (round=31)
[S3] DEBUG after merge:  round=31 metric=0.9309 head_norm=1.651085 delta_norm=0.184802
[S3] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=31 metric=0.6283 head_norm=1.509956
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.981288e-01
[S5] stored merged vector for next round verification (round=31)
[S5] DEBUG after merge:  round=31 metric=0.6319 head_norm=1.369805 delta_norm=0.298129
[S5] aggregate: ACCEPT kept=['S16', 'S15'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=31 metric=0.9123 head_norm=1.718887
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.942218e-01
[S6] stored merged vector for next round verification (round=31)
[S6] DEBUG after merge:  round=31 metric=0.9492 head_norm=1.714813 delta_norm=0.194222
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=31 metric=0.9925 head_norm=1.732639
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.942218e-01
[S8] stored merged vector for next round verification (round=31)
[S8] DEBUG after merge:  round=31 metric=0.9925 head_norm=1.714813 delta_norm=0.194222
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=31 metric=0.9909 head_norm=1.278412
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.088186e-01
[S16] stored merged vector for next round verification (round=31)
[S16] DEBUG after merge:  round=31 metric=0.9910 head_norm=1.315691 delta_norm=0.308819
[S16] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=31 metric=0.9921 head_norm=1.545654
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.329533e-01
[S15] stored merged vector for next round verification (round=31)
[S15] DEBUG after merge:  round=31 metric=0.9921 head_norm=1.522114 delta_norm=0.132953
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=32 head_norm_before_train=1.639665 cos_to_last_merge=0.9948 (last merge round=28)
[S2] round=32 local utility u=0.000000 metrics={'f1_val': 0.8235640673467933, 'auprc': 0.9904441850027901, 'loss_val': 0.27783538633199933, 'psi': 0.890316114409192}-{'f1_val': 0.8279876008925147, 'auprc': 0.9857736859680606, 'loss_val': 0.28662249222743624, 'psi': 0.891102034922733}
[S3] START round=32 head_norm_before_train=1.651085 cos_to_last_merge=1.0000 (last merge round=31)
[S3] round=32 local utility u=0.142422 metrics={'f1_val': 0.969132423427775, 'auprc': 0.9997553578243918, 'loss_val': 0.13344989145538305, 'psi': 0.9813815971864217}-{'f1_val': 0.9313672491280158, 'auprc': 0.9997651712771805, 'loss_val': 0.19173219812227713, 'psi': 0.9587264179876817}
[S4] START round=32 head_norm_before_train=2.078921 (no previous merge yet)
[S4] round=32 local utility u=0.000000 metrics={'f1_val': 0.9289389999226081, 'auprc': 0.9566616051522088, 'loss_val': 0.26074891497985037, 'psi': 0.9400280420144485}-{'f1_val': 0.9557588777954225, 'auprc': 0.9442189403039571, 'loss_val': 0.18457565253074867, 'psi': 0.9511429027988363}
[S5] START round=32 head_norm_before_train=1.369805 cos_to_last_merge=1.0000 (last merge round=31)
[S5] round=32 local utility u=0.486547 metrics={'f1_val': 0.700407554886547, 'auprc': 0.9895937880507208, 'loss_val': 0.2927456659127887, 'psi': 0.8160820481522166}-{'f1_val': 0.6283471957521944, 'auprc': 0.8551672320550723, 'loss_val': 0.4301980210328755, 'psi': 0.7190752102733455}
[S6] START round=32 head_norm_before_train=1.714813 cos_to_last_merge=1.0000 (last merge round=31)
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.7360008453492645, 'auprc': 0.9217963861777345, 'loss_val': 0.531458893909924, 'psi': 0.8103190616806525}-{'f1_val': 0.9123488723930071, 'auprc': 0.9491137123849809, 'loss_val': 0.27717298310662297, 'psi': 0.9270548083897967}
[S7] START round=32 head_norm_before_train=1.711993 cos_to_last_merge=1.0000 (last merge round=30)
[S7] round=32 local utility u=0.000000 metrics={'f1_val': 0.5680608062839679, 'auprc': 0.7831982009128335, 'loss_val': 0.7380536128263917, 'psi': 0.6541157641355142}-{'f1_val': 0.6175477020660802, 'auprc': 0.7910321465767141, 'loss_val': 0.6210547772230923, 'psi': 0.6869414798703337}
[S8] START round=32 head_norm_before_train=1.714813 cos_to_last_merge=1.0000 (last merge round=31)
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.9920973070316986, 'auprc': 0.9983285809540925, 'loss_val': 0.051830421184320824, 'psi': 0.9945898166006562}-{'f1_val': 0.9924932660920454, 'auprc': 0.9985908722561329, 'loss_val': 0.04499627394583817, 'psi': 0.9949323085576803}
[S9] START round=32 head_norm_before_train=1.985516 (no previous merge yet)
[S9] round=32 local utility u=0.011204 metrics={'f1_val': 0.9950237510807955, 'auprc': 0.9996032253825835, 'loss_val': 0.024413991124453735, 'psi': 0.9968555408015107}-{'f1_val': 0.9920956129422706, 'auprc': 0.999605402294043, 'loss_val': 0.02925999212358754, 'psi': 0.9950995286829796}
[S10] START round=32 head_norm_before_train=2.158598 (no previous merge yet)
[S10] round=32 local utility u=0.001261 metrics={'f1_val': 0.9931299445855843, 'auprc': 0.9961738337340561, 'loss_val': 0.035702400449901424, 'psi': 0.9943475002449731}-{'f1_val': 0.9931299445855843, 'auprc': 0.9954778317565642, 'loss_val': 0.03613644138374692, 'psi': 0.9940690994539764}
[S11] START round=32 head_norm_before_train=1.815122 cos_to_last_merge=0.7912 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.791
[S11] round=32 local utility u=0.000740 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9988397838760766, 'loss_val': 0.027735609673978097, 'psi': 0.9972161184984163}-{'f1_val': 0.996305167468861, 'auprc': 0.9983000158535206, 'loss_val': 0.028624366341422257, 'psi': 0.9971031068227247}
[S13] START round=32 head_norm_before_train=1.826222 (no previous merge yet)
[S13] round=32 local utility u=0.149755 metrics={'f1_val': 0.7049875041273959, 'auprc': 0.7989471666195039, 'loss_val': 0.9701467290180653, 'psi': 0.742571369124239}-{'f1_val': 0.6291395280641343, 'auprc': 0.7853641907214953, 'loss_val': 0.7738201401069524, 'psi': 0.6916293931270787}
[S14] START round=32 head_norm_before_train=1.420735 cos_to_last_merge=0.9481 (last merge round=27)
[S14] ⚠️ Model drifted since last merge! cos=0.948
[S14] round=32 local utility u=0.012343 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9968608580105773, 'loss_val': 0.056532140971772435, 'psi': 0.997335014034143}-{'f1_val': 0.9968189060544872, 'auprc': 0.998432543351192, 'loss_val': 0.08094024615732989, 'psi': 0.9974643609731692}
[S15] START round=32 head_norm_before_train=1.522114 cos_to_last_merge=1.0000 (last merge round=31)
[S15] round=32 local utility u=0.000000 metrics={'f1_val': 0.7566345280848629, 'auprc': 0.9933148322093245, 'loss_val': 0.3840771888977984, 'psi': 0.8513066497346475}-{'f1_val': 0.9921136733513103, 'auprc': 0.9980644034121633, 'loss_val': 0.06533560356978689, 'psi': 0.9944939653756515}
[S16] START round=32 head_norm_before_train=1.315691 cos_to_last_merge=1.0000 (last merge round=31)
[S16] round=32 local utility u=0.000000 metrics={'f1_val': 0.9915097472062806, 'auprc': 0.9937350031584412, 'loss_val': 0.13004216174666222, 'psi': 0.9923998495871449}-{'f1_val': 0.9908770957330659, 'auprc': 0.9965423725515155, 'loss_val': 0.13106713567043118, 'psi': 0.9931432064604457}
[S17] START round=32 head_norm_before_train=2.021669 (no previous merge yet)
[S17] round=32 local utility u=0.000000 metrics={'f1_val': 0.6812120436007613, 'auprc': 0.8829809204521291, 'loss_val': 1.073965349070853, 'psi': 0.7619195943413084}-{'f1_val': 0.695517177490587, 'auprc': 0.8845785162035928, 'loss_val': 1.0022546159175312, 'psi': 0.7711417129757894}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:49308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S10] → sending delta(kind=head bytes=1789) to S13@127.0.0.1:49313
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:49316
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:49304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:49311
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1789 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1796) from S9
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.994746)
[S8] loaded HEAD from S9 (vec_in norm=1.994746)
[S8] cosine check vs S9: cos=-0.0927
[S8] DROPPED delta from S9 (cos=-0.0927 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1803) from S3
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.667393)
[S7] loaded HEAD from S3 (vec_in norm=1.667393)
[S7] cosine check vs S3: cos=0.9818
[S7] BUFFERED delta from S3 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1789) from S10
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=2.158465)
[S13] loaded HEAD from S10 (vec_in norm=2.158465)
[S13] cosine check vs S10: cos=-0.0931
[S13] DROPPED delta from S10 (cos=-0.0931 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1797) from S11
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.825225)
[S4] loaded HEAD from S11 (vec_in norm=1.825225)
[S4] cosine check vs S11: cos=-0.0905
[S4] DROPPED delta from S11 (cos=-0.0905 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1801) from S13
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.838582)
[S10] loaded HEAD from S13 (vec_in norm=1.838582)
[S10] cosine check vs S13: cos=-0.0931
[S10] DROPPED delta from S13 (cos=-0.0931 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1800) from S5
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.391541)
[S15] loaded HEAD from S5 (vec_in norm=1.391541)
[S15] cosine check vs S5: cos=0.9832
[S15] BUFFERED delta from S5 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1800) from S14
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.480581)
[S16] loaded HEAD from S14 (vec_in norm=1.480581)
[S16] cosine check vs S14: cos=0.9651
[S16] BUFFERED delta from S14 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=32 metric=0.5681 head_norm=1.721859
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.637703e-01
[S7] stored merged vector for next round verification (round=32)
[S7] DEBUG after merge:  round=32 metric=0.5715 head_norm=1.686914 delta_norm=0.163770
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=32 metric=0.7566 head_norm=1.552458
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.568962e-01
[S15] stored merged vector for next round verification (round=32)
[S15] DEBUG after merge:  round=32 metric=0.7487 head_norm=1.465824 delta_norm=0.156896
[S15] aggregate: ROLLBACK (f1_val pre=0.757 post=0.749 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=32 metric=0.9915 head_norm=1.354453
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.974993e-01
[S16] stored merged vector for next round verification (round=32)
[S16] DEBUG after merge:  round=32 metric=0.9915 head_norm=1.405107 delta_norm=0.197499
[S16] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=33 head_norm_before_train=1.673430 cos_to_last_merge=0.9924 (last merge round=28)
[S2] round=33 local utility u=0.000000 metrics={'f1_val': 0.7763030295474161, 'auprc': 0.9907678839526909, 'loss_val': 0.2981043897707024, 'psi': 0.8620889713095261}-{'f1_val': 0.8235640673467933, 'auprc': 0.9904441850027901, 'loss_val': 0.27783538633199933, 'psi': 0.890316114409192}
[S3] START round=33 head_norm_before_train=1.667393 cos_to_last_merge=0.9999 (last merge round=31)
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.9120120475759304, 'auprc': 0.9994035053748411, 'loss_val': 0.18258949946830932, 'psi': 0.9469686306954946}-{'f1_val': 0.969132423427775, 'auprc': 0.9997553578243918, 'loss_val': 0.13344989145538305, 'psi': 0.9813815971864217}
[S4] START round=33 head_norm_before_train=2.078894 (no previous merge yet)
[S4] round=33 local utility u=0.058597 metrics={'f1_val': 0.924355767619301, 'auprc': 0.9795026024425065, 'loss_val': 0.18457775550402428, 'psi': 0.9464145015485832}-{'f1_val': 0.9289389999226081, 'auprc': 0.9566616051522088, 'loss_val': 0.26074891497985037, 'psi': 0.9400280420144485}
[S5] START round=33 head_norm_before_train=1.391541 cos_to_last_merge=0.9998 (last merge round=31)
[S5] round=33 local utility u=0.000000 metrics={'f1_val': 0.43676623050537206, 'auprc': 0.8550080109851623, 'loss_val': 0.8324028699317669, 'psi': 0.6040629426972881}-{'f1_val': 0.700407554886547, 'auprc': 0.9895937880507208, 'loss_val': 0.2927456659127887, 'psi': 0.8160820481522166}
[S6] START round=33 head_norm_before_train=1.751746 cos_to_last_merge=0.9997 (last merge round=31)
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.7122036350779255, 'auprc': 0.9486111495452945, 'loss_val': 0.6257327552976005, 'psi': 0.806766640864873}-{'f1_val': 0.7360008453492645, 'auprc': 0.9217963861777345, 'loss_val': 0.531458893909924, 'psi': 0.8103190616806525}
[S7] START round=33 head_norm_before_train=1.686914 cos_to_last_merge=1.0000 (last merge round=32)
[S7] round=33 local utility u=0.561992 metrics={'f1_val': 0.6860798292509661, 'auprc': 0.8126651549918508, 'loss_val': 0.41058546510180716, 'psi': 0.73671395954732}-{'f1_val': 0.5680608062839679, 'auprc': 0.7831982009128335, 'loss_val': 0.7380536128263917, 'psi': 0.6541157641355142}
[S8] START round=33 head_norm_before_train=1.738720 cos_to_last_merge=0.9999 (last merge round=31)
[S8] round=33 local utility u=0.005209 metrics={'f1_val': 0.9928576189497129, 'auprc': 0.9981385241825167, 'loss_val': 0.04540379408931381, 'psi': 0.9949699810428345}-{'f1_val': 0.9920973070316986, 'auprc': 0.9983285809540925, 'loss_val': 0.051830421184320824, 'psi': 0.9945898166006562}
[S9] START round=33 head_norm_before_train=1.994746 (no previous merge yet)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.9878532334303461, 'auprc': 0.999616808272054, 'loss_val': 0.04322548422792473, 'psi': 0.9925586633670294}-{'f1_val': 0.9950237510807955, 'auprc': 0.9996032253825835, 'loss_val': 0.024413991124453735, 'psi': 0.9968555408015107}
[S10] START round=33 head_norm_before_train=2.158465 (no previous merge yet)
[S10] round=33 local utility u=0.000993 metrics={'f1_val': 0.9931299445855843, 'auprc': 0.9966867974684692, 'loss_val': 0.035255256772146804, 'psi': 0.9945526857387383}-{'f1_val': 0.9931299445855843, 'auprc': 0.9961738337340561, 'loss_val': 0.035702400449901424, 'psi': 0.9943475002449731}
[S11] START round=33 head_norm_before_train=1.825225 cos_to_last_merge=0.7900 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.790
[S11] round=33 local utility u=0.000000 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9985154439756162, 'loss_val': 0.02670057989475384, 'psi': 0.9969412803113948}-{'f1_val': 0.9961336749133093, 'auprc': 0.9988397838760766, 'loss_val': 0.027735609673978097, 'psi': 0.9972161184984163}
[S13] START round=33 head_norm_before_train=1.838582 (no previous merge yet)
[S13] round=33 local utility u=0.206805 metrics={'f1_val': 0.7414022753066125, 'auprc': 0.7798304966767658, 'loss_val': 0.7176762493913991, 'psi': 0.7567735638546739}-{'f1_val': 0.7049875041273959, 'auprc': 0.7989471666195039, 'loss_val': 0.9701467290180653, 'psi': 0.742571369124239}
[S14] START round=33 head_norm_before_train=1.480581 cos_to_last_merge=0.9372 (last merge round=27)
[S14] ⚠️ Model drifted since last merge! cos=0.937
[S14] round=33 local utility u=0.003089 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9968571883870679, 'loss_val': 0.05135358403320906, 'psi': 0.9974345861351582}-{'f1_val': 0.9976511180498535, 'auprc': 0.9968608580105773, 'loss_val': 0.056532140971772435, 'psi': 0.997335014034143}
[S15] START round=33 head_norm_before_train=1.465824 cos_to_last_merge=1.0000 (last merge round=32)
[S15] round=33 local utility u=0.855749 metrics={'f1_val': 0.9908263679617011, 'auprc': 0.9961099942399325, 'loss_val': 0.08611520422567995, 'psi': 0.9929398184729937}-{'f1_val': 0.7566345280848629, 'auprc': 0.9933148322093245, 'loss_val': 0.3840771888977984, 'psi': 0.8513066497346475}
[S16] START round=33 head_norm_before_train=1.405107 cos_to_last_merge=1.0000 (last merge round=32)
[S16] round=33 local utility u=0.006903 metrics={'f1_val': 0.9912906701717978, 'auprc': 0.9960667254071753, 'loss_val': 0.12191760606465436, 'psi': 0.9932010922659488}-{'f1_val': 0.9915097472062806, 'auprc': 0.9937350031584412, 'loss_val': 0.13004216174666222, 'psi': 0.9923998495871449}
[S17] START round=33 head_norm_before_train=2.034792 (no previous merge yet)
[S17] round=33 local utility u=0.120208 metrics={'f1_val': 0.6868280841009109, 'auprc': 0.8817321851118611, 'loss_val': 0.8634996241070932, 'psi': 0.764789724505291}-{'f1_val': 0.6812120436007613, 'auprc': 0.8829809204521291, 'loss_val': 1.073965349070853, 'psi': 0.7619195943413084}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:49303
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:49305
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:49311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:49316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:49307
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:49313
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:49312
[S8] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1799) from S13
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.849295)
[S10] loaded HEAD from S13 (vec_in norm=1.849295)
[S10] cosine check vs S13: cos=-0.0932
[S10] DROPPED delta from S13 (cos=-0.0932 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1803) from S8
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.766215)
[S6] loaded HEAD from S8 (vec_in norm=1.766215)
[S6] cosine check vs S8: cos=0.9982
[S6] BUFFERED delta from S8 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1801) from S7
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.696052)
[S3] loaded HEAD from S7 (vec_in norm=1.696052)
[S3] cosine check vs S7: cos=0.9947
[S3] BUFFERED delta from S7 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1799) from S14
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.530190)
[S16] loaded HEAD from S14 (vec_in norm=1.530190)
[S16] cosine check vs S14: cos=0.9844
[S16] BUFFERED delta from S14 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1801) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.499237)
[S5] loaded HEAD from S15 (vec_in norm=1.499237)
[S5] cosine check vs S15: cos=0.9941
[S5] BUFFERED delta from S15 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1796) from S10
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=2.160918)
[S13] loaded HEAD from S10 (vec_in norm=2.160918)
[S13] cosine check vs S10: cos=-0.0932
[S13] DROPPED delta from S10 (cos=-0.0932 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1798) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=2.088615)
[S11] loaded HEAD from S4 (vec_in norm=2.088615)
[S11] cosine check vs S4: cos=-0.0904
[S11] DROPPED delta from S4 (cos=-0.0904 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:49305
[S16] sending update (kind=head size=1801 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1801) from S16
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.444244)
[S5] loaded HEAD from S16 (vec_in norm=1.444244)
[S5] cosine check vs S16: cos=0.6294
[S5] BUFFERED delta from S16 (total buffered=2)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=33 metric=0.7122 head_norm=1.789483
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.471964e-02
[S6] stored merged vector for next round verification (round=33)
[S6] DEBUG after merge:  round=33 metric=0.7250 head_norm=1.777045 delta_norm=0.054720
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=33 metric=0.9120 head_norm=1.687116
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.721513e-02
[S3] stored merged vector for next round verification (round=33)
[S3] DEBUG after merge:  round=33 metric=0.9108 head_norm=1.689340 delta_norm=0.087215
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=33 metric=0.4368 head_norm=1.412179
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.711857e-01
[S5] stored merged vector for next round verification (round=33)
[S5] DEBUG after merge:  round=33 metric=0.4368 head_norm=1.329552 delta_norm=0.271186
[S5] aggregate: ACCEPT kept=['S15', 'S16'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=33 metric=0.9913 head_norm=1.444244
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.382288e-01
[S16] stored merged vector for next round verification (round=33)
[S16] DEBUG after merge:  round=33 metric=0.9913 head_norm=1.481402 delta_norm=0.138229
[S16] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=34 head_norm_before_train=1.706073 cos_to_last_merge=0.9900 (last merge round=28)
[S2] round=34 local utility u=0.176290 metrics={'f1_val': 0.8294202579110568, 'auprc': 0.9901108277281917, 'loss_val': 0.2622569706632386, 'psi': 0.8936964858379107}-{'f1_val': 0.7763030295474161, 'auprc': 0.9907678839526909, 'loss_val': 0.2981043897707024, 'psi': 0.8620889713095261}
[S3] START round=34 head_norm_before_train=1.689340 cos_to_last_merge=1.0000 (last merge round=33)
[S3] round=34 local utility u=0.237534 metrics={'f1_val': 0.9729015132078944, 'auprc': 0.9997935861215637, 'loss_val': 0.07402854782806036, 'psi': 0.9836583423733621}-{'f1_val': 0.9120120475759304, 'auprc': 0.9994035053748411, 'loss_val': 0.18258949946830932, 'psi': 0.9469686306954946}
[S4] START round=34 head_norm_before_train=2.088615 (no previous merge yet)
[S4] round=34 local utility u=0.032241 metrics={'f1_val': 0.9279536731424526, 'auprc': 0.982577680743818, 'loss_val': 0.15090769719238828, 'psi': 0.9498032761829988}-{'f1_val': 0.924355767619301, 'auprc': 0.9795026024425065, 'loss_val': 0.18457775550402428, 'psi': 0.9464145015485832}
[S5] START round=34 head_norm_before_train=1.329552 cos_to_last_merge=1.0000 (last merge round=33)
[S5] round=34 local utility u=1.000000 metrics={'f1_val': 0.6621751004570449, 'auprc': 0.9588507551601119, 'loss_val': 0.32433128080693063, 'psi': 0.7808453623382716}-{'f1_val': 0.43676623050537206, 'auprc': 0.8550080109851623, 'loss_val': 0.8324028699317669, 'psi': 0.6040629426972881}
[S6] START round=34 head_norm_before_train=1.777045 cos_to_last_merge=1.0000 (last merge round=33)
[S6] round=34 local utility u=0.504566 metrics={'f1_val': 0.8248658484548514, 'auprc': 0.9710140741662819, 'loss_val': 0.35978231608734795, 'psi': 0.8833251387394236}-{'f1_val': 0.7122036350779255, 'auprc': 0.9486111495452945, 'loss_val': 0.6257327552976005, 'psi': 0.806766640864873}
[S7] START round=34 head_norm_before_train=1.696052 cos_to_last_merge=0.9999 (last merge round=32)
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.6432986277609543, 'auprc': 0.7951920628408919, 'loss_val': 0.5437184093812113, 'psi': 0.7040560017929294}-{'f1_val': 0.6860798292509661, 'auprc': 0.8126651549918508, 'loss_val': 0.41058546510180716, 'psi': 0.73671395954732}
[S8] START round=34 head_norm_before_train=1.766215 cos_to_last_merge=0.9996 (last merge round=31)
[S8] round=34 local utility u=0.000000 metrics={'f1_val': 0.9921395546714198, 'auprc': 0.9983992944679164, 'loss_val': 0.04447928180026117, 'psi': 0.9946434505900185}-{'f1_val': 0.9928576189497129, 'auprc': 0.9981385241825167, 'loss_val': 0.04540379408931381, 'psi': 0.9949699810428345}
[S9] START round=34 head_norm_before_train=2.003180 (no previous merge yet)
[S9] round=34 local utility u=0.034393 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.997441710913456, 'loss_val': 0.020757963052738616, 'psi': 0.9969729914537173}-{'f1_val': 0.9878532334303461, 'auprc': 0.999616808272054, 'loss_val': 0.04322548422792473, 'psi': 0.9925586633670294}
[S10] START round=34 head_norm_before_train=2.160918 (no previous merge yet)
[S10] round=34 local utility u=0.000040 metrics={'f1_val': 0.9931299445855843, 'auprc': 0.9967458102353715, 'loss_val': 0.03535171215253954, 'psi': 0.9945762908454993}-{'f1_val': 0.9931299445855843, 'auprc': 0.9966867974684692, 'loss_val': 0.035255256772146804, 'psi': 0.9945526857387383}
[S11] START round=34 head_norm_before_train=1.837482 cos_to_last_merge=0.7885 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.789
[S11] round=34 local utility u=0.000973 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9989112235556089, 'loss_val': 0.025941268657915992, 'psi': 0.997099592143392}-{'f1_val': 0.9958918378685807, 'auprc': 0.9985154439756162, 'loss_val': 0.02670057989475384, 'psi': 0.9969412803113948}
[S13] START round=34 head_norm_before_train=1.849295 (no previous merge yet)
[S13] round=34 local utility u=0.000000 metrics={'f1_val': 0.6917663070545048, 'auprc': 0.7938996529348896, 'loss_val': 0.9838217093969565, 'psi': 0.7326196454066587}-{'f1_val': 0.7414022753066125, 'auprc': 0.7798304966767658, 'loss_val': 0.7176762493913991, 'psi': 0.7567735638546739}
[S14] START round=34 head_norm_before_train=1.530190 cos_to_last_merge=0.9289 (last merge round=27)
[S14] ⚠️ Model drifted since last merge! cos=0.929
[S14] round=34 local utility u=0.004607 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9967496833626858, 'loss_val': 0.04181612988753186, 'psi': 0.9973915841254053}-{'f1_val': 0.9978195179672185, 'auprc': 0.9968571883870679, 'loss_val': 0.05135358403320906, 'psi': 0.9974345861351582}
[S15] START round=34 head_norm_before_train=1.499237 cos_to_last_merge=0.9997 (last merge round=32)
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.7009202876340006, 'auprc': 0.9911828224001747, 'loss_val': 0.4654818096215068, 'psi': 0.8170253015404703}-{'f1_val': 0.9908263679617011, 'auprc': 0.9961099942399325, 'loss_val': 0.08611520422567995, 'psi': 0.9929398184729937}
[S16] START round=34 head_norm_before_train=1.481402 cos_to_last_merge=1.0000 (last merge round=33)
[S16] round=34 local utility u=0.003548 metrics={'f1_val': 0.9908527371557192, 'auprc': 0.9968498936495513, 'loss_val': 0.1145428678650504, 'psi': 0.9932515997532521}-{'f1_val': 0.9912906701717978, 'auprc': 0.9960667254071753, 'loss_val': 0.12191760606465436, 'psi': 0.9932010922659488}
[S17] START round=34 head_norm_before_train=2.046323 (no previous merge yet)
[S17] round=34 local utility u=0.119602 metrics={'f1_val': 0.7406572518447785, 'auprc': 0.8869408528132894, 'loss_val': 0.9628966082726622, 'psi': 0.7991706922321828}-{'f1_val': 0.6868280841009109, 'auprc': 0.8817321851118611, 'loss_val': 0.8634996241070932, 'psi': 0.764789724505291}
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S15
[S16]  timeout peer S17
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S7]  timeout peer S2
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S7
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:49304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:49313
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:49308
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:49312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:49303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:49309
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:49305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:49316
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1793 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1795) from S10
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=2.169800)
[S13] loaded HEAD from S10 (vec_in norm=2.169800)
[S13] cosine check vs S10: cos=-0.0928
[S13] DROPPED delta from S10 (cos=-0.0928 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1794) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=2.097351)
[S11] loaded HEAD from S4 (vec_in norm=2.097351)
[S11] cosine check vs S4: cos=-0.0903
[S11] DROPPED delta from S4 (cos=-0.0903 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1801) from S6
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.813666)
[S8] loaded HEAD from S6 (vec_in norm=1.813666)
[S8] cosine check vs S6: cos=0.9983
[S8] BUFFERED delta from S6 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1799) from S9
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=2.009433)
[S8] loaded HEAD from S9 (vec_in norm=2.009433)
[S8] cosine check vs S9: cos=-0.0876
[S8] DROPPED delta from S9 (cos=-0.0876 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1803) from S3
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.711715)
[S7] loaded HEAD from S3 (vec_in norm=1.711715)
[S7] cosine check vs S3: cos=0.9980
[S7] BUFFERED delta from S3 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1793) from S5
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.349157)
[S15] loaded HEAD from S5 (vec_in norm=1.349157)
[S15] cosine check vs S5: cos=0.9613
[S15] BUFFERED delta from S5 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1801) from S11
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.850831)
[S4] loaded HEAD from S11 (vec_in norm=1.850831)
[S4] cosine check vs S11: cos=-0.0903
[S4] DROPPED delta from S11 (cos=-0.0903 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1800) from S2
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.732606)
[S3] loaded HEAD from S2 (vec_in norm=1.732606)
[S3] cosine check vs S2: cos=0.9793
[S3] BUFFERED delta from S2 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1795) from S14
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.570398)
[S16] loaded HEAD from S14 (vec_in norm=1.570398)
[S16] cosine check vs S14: cos=0.9912
[S16] BUFFERED delta from S14 (total buffered=1)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=34 metric=0.9921 head_norm=1.789775
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.436774e-02
[S8] stored merged vector for next round verification (round=34)
[S8] DEBUG after merge:  round=34 metric=0.9920 head_norm=1.800939 delta_norm=0.054368
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=34 metric=0.9729 head_norm=1.711715
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.755900e-01
[S3] stored merged vector for next round verification (round=34)
[S3] DEBUG after merge:  round=34 metric=0.9729 head_norm=1.713217 delta_norm=0.175590
[S3] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S16] sending update (kind=head size=1799 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1799) from S16
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.518822)
[S5] loaded HEAD from S16 (vec_in norm=1.518822)
[S5] cosine check vs S16: cos=0.7308
[S5] BUFFERED delta from S16 (total buffered=1)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=34 metric=0.9909 head_norm=1.518822
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.054242e-01
[S16] stored merged vector for next round verification (round=34)
[S16] DEBUG after merge:  round=34 metric=0.9909 head_norm=1.541224 delta_norm=0.105424
[S16] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] CommDone barrier timeout: have=1 need=2 — continuing
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=34 metric=0.7009 head_norm=1.530667
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.196419e-01
[S15] stored merged vector for next round verification (round=34)
[S15] DEBUG after merge:  round=34 metric=0.7009 head_norm=1.425953 delta_norm=0.219642
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=35 head_norm_before_train=1.732606 cos_to_last_merge=0.9880 (last merge round=28)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.8269054846894428, 'auprc': 0.9864148812976907, 'loss_val': 0.33721622362742987, 'psi': 0.8907092433327419}-{'f1_val': 0.8294202579110568, 'auprc': 0.9901108277281917, 'loss_val': 0.2622569706632386, 'psi': 0.8936964858379107}
[S3] START round=35 head_norm_before_train=1.713217 cos_to_last_merge=1.0000 (last merge round=34)
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9998829883356568, 'loss_val': 0.1104957252025554, 'psi': 0.976598246573935}-{'f1_val': 0.9729015132078944, 'auprc': 0.9997935861215637, 'loss_val': 0.07402854782806036, 'psi': 0.9836583423733621}
[S4] START round=35 head_norm_before_train=2.097351 (no previous merge yet)
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.9249676818140993, 'auprc': 0.9661589733051917, 'loss_val': 0.22092866848175757, 'psi': 0.9414441984105363}-{'f1_val': 0.9279536731424526, 'auprc': 0.982577680743818, 'loss_val': 0.15090769719238828, 'psi': 0.9498032761829988}
[S5] START round=35 head_norm_before_train=1.349157 cos_to_last_merge=0.9998 (last merge round=33)
[S5] round=35 local utility u=0.000000 metrics={'f1_val': 0.6437073773307864, 'auprc': 0.8726236028554747, 'loss_val': 0.4111835509782334, 'psi': 0.7352738675406617}-{'f1_val': 0.6621751004570449, 'auprc': 0.9588507551601119, 'loss_val': 0.32433128080693063, 'psi': 0.7808453623382716}
[S6] START round=35 head_norm_before_train=1.813666 cos_to_last_merge=0.9997 (last merge round=33)
[S6] round=35 local utility u=0.158607 metrics={'f1_val': 0.867410680454398, 'auprc': 0.974974973681687, 'loss_val': 0.30971934433316867, 'psi': 0.9104363977453136}-{'f1_val': 0.8248658484548514, 'auprc': 0.9710140741662819, 'loss_val': 0.35978231608734795, 'psi': 0.8833251387394236}
[S7] START round=35 head_norm_before_train=1.706855 cos_to_last_merge=0.9997 (last merge round=32)
[S7] round=35 local utility u=0.000000 metrics={'f1_val': 0.5602954701936744, 'auprc': 0.7825828023745312, 'loss_val': 0.7599033979152096, 'psi': 0.6492104030660171}-{'f1_val': 0.6432986277609543, 'auprc': 0.7951920628408919, 'loss_val': 0.5437184093812113, 'psi': 0.7040560017929294}
[S8] START round=35 head_norm_before_train=1.800939 cos_to_last_merge=1.0000 (last merge round=34)
[S8] round=35 local utility u=0.000621 metrics={'f1_val': 0.9921294610699772, 'auprc': 0.9983966871158748, 'loss_val': 0.043168324451475004, 'psi': 0.9946363514883363}-{'f1_val': 0.9921395546714198, 'auprc': 0.9983992944679164, 'loss_val': 0.04447928180026117, 'psi': 0.9946434505900185}
[S9] START round=35 head_norm_before_train=2.009433 (no previous merge yet)
[S9] round=35 local utility u=0.000068 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9974005935369838, 'loss_val': 0.020498672328457413, 'psi': 0.9969565445031284}-{'f1_val': 0.9966605118138915, 'auprc': 0.997441710913456, 'loss_val': 0.020757963052738616, 'psi': 0.9969729914537173}
[S10] START round=35 head_norm_before_train=2.169800 (no previous merge yet)
[S10] round=35 local utility u=0.000000 metrics={'f1_val': 0.9931299445855843, 'auprc': 0.9966153805052705, 'loss_val': 0.035079566042942184, 'psi': 0.9945241189534588}-{'f1_val': 0.9931299445855843, 'auprc': 0.9967458102353715, 'loss_val': 0.03535171215253954, 'psi': 0.9945762908454993}
[S11] START round=35 head_norm_before_train=1.850831 cos_to_last_merge=0.7869 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.787
[S11] round=35 local utility u=0.000000 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9990783372137558, 'loss_val': 0.03172763738136588, 'psi': 0.9975740837527771}-{'f1_val': 0.9958918378685807, 'auprc': 0.9989112235556089, 'loss_val': 0.025941268657915992, 'psi': 0.997099592143392}
[S13] START round=35 head_norm_before_train=1.859084 (no previous merge yet)
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.6575983149804994, 'auprc': 0.7628676485902883, 'loss_val': 0.7889047298862459, 'psi': 0.699706048424415}-{'f1_val': 0.6917663070545048, 'auprc': 0.7938996529348896, 'loss_val': 0.9838217093969565, 'psi': 0.7326196454066587}
[S14] START round=35 head_norm_before_train=1.570398 cos_to_last_merge=0.9224 (last merge round=27)
[S14] ⚠️ Model drifted since last merge! cos=0.922
[S14] round=35 local utility u=0.004429 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9987313700533373, 'loss_val': 0.03643593828626157, 'psi': 0.9979375097223703}-{'f1_val': 0.9978195179672185, 'auprc': 0.9967496833626858, 'loss_val': 0.04181612988753186, 'psi': 0.9973915841254053}
[S15] START round=35 head_norm_before_train=1.425953 cos_to_last_merge=1.0000 (last merge round=34)
[S15] round=35 local utility u=0.856588 metrics={'f1_val': 0.927748205856058, 'auprc': 0.9967577426294625, 'loss_val': 0.1299980842787065, 'psi': 0.9553520205654198}-{'f1_val': 0.7009202876340006, 'auprc': 0.9911828224001747, 'loss_val': 0.4654818096215068, 'psi': 0.8170253015404703}
[S16] START round=35 head_norm_before_train=1.541224 cos_to_last_merge=1.0000 (last merge round=34)
[S16] round=35 local utility u=0.000000 metrics={'f1_val': 0.8431575542579794, 'auprc': 0.9446891799621887, 'loss_val': 0.7368082952943495, 'psi': 0.8837702045396632}-{'f1_val': 0.9908527371557192, 'auprc': 0.9968498936495513, 'loss_val': 0.1145428678650504, 'psi': 0.9932515997532521}
[S17] START round=35 head_norm_before_train=2.065104 (no previous merge yet)
[S17] round=35 local utility u=0.000000 metrics={'f1_val': 0.6964494670407368, 'auprc': 0.8772719168724827, 'loss_val': 1.2206339224892868, 'psi': 0.7687784469734352}-{'f1_val': 0.7406572518447785, 'auprc': 0.8869408528132894, 'loss_val': 0.9628966082726622, 'psi': 0.7991706922321828}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:49316
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:49309
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S4] ⇄ pheromone p=0.027 → S11@127.0.0.1:49312
[S13] ⇄ pheromone p=0.077 → S10@127.0.0.1:49311
[S11] ⇄ pheromone p=0.009 → S4@127.0.0.1:49304
[S10] ⇄ pheromone p=0.002 → S13@127.0.0.1:49313
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] ⇄ pheromone p=0.087 → S3@127.0.0.1:49303
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=35 metric=0.5603 head_norm=1.718190
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.806269e-02
[S7] stored merged vector for next round verification (round=35)
[S7] DEBUG after merge:  round=35 metric=0.5651 head_norm=1.713972 delta_norm=0.058063
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.187 → S3@127.0.0.1:49303
[S8] RECEIVED delta(kind=head bytes=1803) from S6
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.853294)
[S8] loaded HEAD from S6 (vec_in norm=1.853294)
[S8] cosine check vs S6: cos=0.9984
[S8] BUFFERED delta from S6 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1801) from S14
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.597880)
[S16] loaded HEAD from S14 (vec_in norm=1.597880)
[S16] cosine check vs S14: cos=0.9946
[S16] BUFFERED delta from S14 (total buffered=1)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:49307
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] ⇄ pheromone p=0.294 → S8@127.0.0.1:49309
[S14] ⇄ pheromone p=0.018 → S16@127.0.0.1:49316
[S8] sending update (kind=head size=1802 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1802) from S8
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.815935)
[S6] loaded HEAD from S8 (vec_in norm=1.815935)
[S6] cosine check vs S8: cos=0.9984
[S6] BUFFERED delta from S8 (total buffered=1)
[S3] ⇄ pheromone p=0.089 → S7@127.0.0.1:49308
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=35 metric=0.8432 head_norm=1.575362
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.336955e-02
[S16] stored merged vector for next round verification (round=35)
[S16] DEBUG after merge:  round=35 metric=0.8429 head_norm=1.584469 delta_norm=0.083370
[S16] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.088 → S5@127.0.0.1:49305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:49309
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=35 metric=0.6437 head_norm=1.369660
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.376061e-01
[S5] stored merged vector for next round verification (round=35)
[S5] DEBUG after merge:  round=35 metric=0.6418 head_norm=1.342525 delta_norm=0.537606
[S5] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.263 → S15@127.0.0.1:49315
[S9] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S9
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=2.017259)
[S8] loaded HEAD from S9 (vec_in norm=2.017259)
[S8] cosine check vs S9: cos=-0.0896
[S8] DROPPED delta from S9 (cos=-0.0896 < 0.0)
[S9] ⇄ pheromone p=0.014 → S8@127.0.0.1:49309
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=35 metric=0.9921 head_norm=1.815935
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.485576e-02
[S8] stored merged vector for next round verification (round=35)
[S8] DEBUG after merge:  round=35 metric=0.9921 head_norm=1.833890 delta_norm=0.054856
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.009 → S6@127.0.0.1:49307
[S14]  timeout peer S16
[S16]  timeout peer S5
[S16]  timeout peer S9
[S8]  timeout peer S14
[S3]  timeout peer S17
[S2]  timeout peer S3
[S9]  timeout peer S8
[S9]  timeout peer S10
[S15]  timeout peer S2
[S15]  timeout peer S11
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:49305
[S15] sending update (kind=head size=1800 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1800) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.459763)
[S5] loaded HEAD from S15 (vec_in norm=1.459763)
[S5] cosine check vs S15: cos=0.8532
[S5] BUFFERED delta from S15 (total buffered=1)
[S15] ⇄ pheromone p=0.406 → S5@127.0.0.1:49305
[S2] START round=36 head_norm_before_train=1.754926 cos_to_last_merge=0.9862 (last merge round=28)
[S2] round=36 local utility u=0.019325 metrics={'f1_val': 0.8302742077324969, 'auprc': 0.9857464725128325, 'loss_val': 0.31677245590333514, 'psi': 0.8924631136446312}-{'f1_val': 0.8269054846894428, 'auprc': 0.9864148812976907, 'loss_val': 0.33721622362742987, 'psi': 0.8907092433327419}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=36 head_norm_before_train=1.733932 cos_to_last_merge=0.9999 (last merge round=34)
[S3] round=36 local utility u=0.142312 metrics={'f1_val': 0.9978389274664787, 'auprc': 0.9998399984369035, 'loss_val': 0.04632490304809651, 'psi': 0.9986393558546487}-{'f1_val': 0.9610750853994537, 'auprc': 0.9998829883356568, 'loss_val': 0.1104957252025554, 'psi': 0.976598246573935}
[S4] START round=36 head_norm_before_train=2.107044 (no previous merge yet)
[S4] round=36 local utility u=0.024488 metrics={'f1_val': 0.9315512322118966, 'auprc': 0.979721619032188, 'loss_val': 0.25214181346787473, 'psi': 0.9508193869400132}-{'f1_val': 0.9249676818140993, 'auprc': 0.9661589733051917, 'loss_val': 0.22092866848175757, 'psi': 0.9414441984105363}
[S5] START round=36 head_norm_before_train=1.342525 cos_to_last_merge=1.0000 (last merge round=35)
[S5] round=36 local utility u=0.387293 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.989090588821903, 'loss_val': 0.3256816093530215, 'psi': 0.8158290259891094}-{'f1_val': 0.6437073773307864, 'auprc': 0.8726236028554747, 'loss_val': 0.4111835509782334, 'psi': 0.7352738675406617}
[S6] START round=36 head_norm_before_train=1.853294 cos_to_last_merge=0.9989 (last merge round=33)
[S6] round=36 local utility u=0.000000 metrics={'f1_val': 0.8292582891792876, 'auprc': 0.9545334143193017, 'loss_val': 0.4142758482878945, 'psi': 0.8793683392352932}-{'f1_val': 0.867410680454398, 'auprc': 0.974974973681687, 'loss_val': 0.30971934433316867, 'psi': 0.9104363977453136}
[S7] START round=36 head_norm_before_train=1.713972 cos_to_last_merge=1.0000 (last merge round=35)
[S7] round=36 local utility u=0.426224 metrics={'f1_val': 0.6519904408639916, 'auprc': 0.7994680469135618, 'loss_val': 0.5082819460625793, 'psi': 0.7109814832838197}-{'f1_val': 0.5602954701936744, 'auprc': 0.7825828023745312, 'loss_val': 0.7599033979152096, 'psi': 0.6492104030660171}
[S8] START round=36 head_norm_before_train=1.833890 cos_to_last_merge=1.0000 (last merge round=35)
[S8] round=36 local utility u=0.003226 metrics={'f1_val': 0.9927378939946618, 'auprc': 0.9982804283615314, 'loss_val': 0.04001910204017747, 'psi': 0.9949549077414097}-{'f1_val': 0.9921294610699772, 'auprc': 0.9983966871158748, 'loss_val': 0.043168324451475004, 'psi': 0.9946363514883363}
[S9] START round=36 head_norm_before_train=2.017259 (no previous merge yet)
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.990399656971262, 'auprc': 0.999622569636214, 'loss_val': 0.036030255274446754, 'psi': 0.9940888220372428}-{'f1_val': 0.9966605118138915, 'auprc': 0.9974005935369838, 'loss_val': 0.020498672328457413, 'psi': 0.9969565445031284}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=36 head_norm_before_train=2.173899 (no previous merge yet)
[S10] round=36 local utility u=0.000000 metrics={'f1_val': 0.9931299445855843, 'auprc': 0.996392903678585, 'loss_val': 0.03513098908470863, 'psi': 0.9944351282227847}-{'f1_val': 0.9931299445855843, 'auprc': 0.9966153805052705, 'loss_val': 0.035079566042942184, 'psi': 0.9945241189534588}
[S11] START round=36 head_norm_before_train=1.863483 cos_to_last_merge=0.7853 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.785
[S11] round=36 local utility u=0.003827 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9990493262207647, 'loss_val': 0.023986000334609722, 'psi': 0.9975624793555806}-{'f1_val': 0.9965712481121245, 'auprc': 0.9990783372137558, 'loss_val': 0.03172763738136588, 'psi': 0.9975740837527771}
[S13] START round=36 head_norm_before_train=1.867583 (no previous merge yet)
[S13] round=36 local utility u=0.068847 metrics={'f1_val': 0.7256994465651166, 'auprc': 0.7499321784998958, 'loss_val': 1.0210120258221564, 'psi': 0.7353925393390284}-{'f1_val': 0.6575983149804994, 'auprc': 0.7628676485902883, 'loss_val': 0.7889047298862459, 'psi': 0.699706048424415}
[S14] START round=36 head_norm_before_train=1.597880 cos_to_last_merge=0.9180 (last merge round=27)
[S14] ⚠️ Model drifted since last merge! cos=0.918
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9987594913234167, 'loss_val': 0.03923344316661946, 'psi': 0.9981955073096977}-{'f1_val': 0.9974082695017256, 'auprc': 0.9987313700533373, 'loss_val': 0.03643593828626157, 'psi': 0.9979375097223703}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=36 head_norm_before_train=1.459763 cos_to_last_merge=0.9996 (last merge round=34)
[S15] round=36 local utility u=0.246599 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9971712042176686, 'loss_val': 0.052031728279387096, 'psi': 0.9969164827195798}-{'f1_val': 0.927748205856058, 'auprc': 0.9967577426294625, 'loss_val': 0.1299980842787065, 'psi': 0.9553520205654198}
[S16] START round=36 head_norm_before_train=1.584469 cos_to_last_merge=1.0000 (last merge round=35)
[S16] round=36 local utility u=0.629646 metrics={'f1_val': 0.9404638142643832, 'auprc': 0.9960018477773936, 'loss_val': 0.21529232190137915, 'psi': 0.9626790276695874}-{'f1_val': 0.8431575542579794, 'auprc': 0.9446891799621887, 'loss_val': 0.7368082952943495, 'psi': 0.8837702045396632}
[S17] START round=36 head_norm_before_train=2.082807 (no previous merge yet)
[S17] round=36 local utility u=0.237057 metrics={'f1_val': 0.7209565431171667, 'auprc': 0.8907306558965848, 'loss_val': 0.9339378460079445, 'psi': 0.7888661882289341}-{'f1_val': 0.6964494670407368, 'auprc': 0.8772719168724827, 'loss_val': 1.2206339224892868, 'psi': 0.7687784469734352}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:49312
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S13] → sending delta(kind=head bytes=1791) to S10@127.0.0.1:49311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:49314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S11] → sending delta(kind=head bytes=1806) to S4@127.0.0.1:49304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:49303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:49308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:49315
[S7] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1794 to 1 peers)
[S13] sending update (kind=head size=1791 to 1 peers)
[S11] sending update (kind=head size=1806 to 1 peers)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=36 metric=0.8293 head_norm=1.890168
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.727824e-02
[S6] stored merged vector for next round verification (round=36)
[S6] DEBUG after merge:  round=36 metric=0.8289 head_norm=1.851812 delta_norm=0.077278
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:49307
[S4] RECEIVED delta(kind=head bytes=1806) from S11
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.877189)
[S4] loaded HEAD from S11 (vec_in norm=1.877189)
[S4] cosine check vs S11: cos=-0.0898
[S4] DROPPED delta from S11 (cos=-0.0898 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1797) from S7
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.728303)
[S3] loaded HEAD from S7 (vec_in norm=1.728303)
[S3] cosine check vs S7: cos=0.9922
[S3] BUFFERED delta from S7 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1803) from S16
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.617165)
[S14] loaded HEAD from S16 (vec_in norm=1.617165)
[S14] cosine check vs S16: cos=0.9962
[S14] BUFFERED delta from S16 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1794) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=2.114060)
[S11] loaded HEAD from S4 (vec_in norm=2.114060)
[S11] cosine check vs S4: cos=-0.0898
[S11] DROPPED delta from S4 (cos=-0.0898 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1791) from S13
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.875284)
[S10] loaded HEAD from S13 (vec_in norm=1.875284)
[S10] cosine check vs S13: cos=-0.0922
[S10] DROPPED delta from S13 (cos=-0.0922 < 0.0)
[S5] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1804) from S3
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.754131)
[S7] loaded HEAD from S3 (vec_in norm=1.754131)
[S7] cosine check vs S3: cos=0.9922
[S7] BUFFERED delta from S3 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1803) from S8
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.854639)
[S6] loaded HEAD from S8 (vec_in norm=1.854639)
[S6] cosine check vs S8: cos=0.9999
[S6] BUFFERED delta from S8 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1800) from S5
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.359926)
[S15] loaded HEAD from S5 (vec_in norm=1.359926)
[S15] cosine check vs S5: cos=0.8550
[S15] BUFFERED delta from S5 (total buffered=1)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=36 metric=0.9978 head_norm=1.754131
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.097902e-01
[S3] stored merged vector for next round verification (round=36)
[S3] DEBUG after merge:  round=36 metric=0.9978 head_norm=1.737800 delta_norm=0.109790
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=36 metric=0.7003 head_norm=1.359926
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.763518e-01
[S5] stored merged vector for next round verification (round=36)
[S5] DEBUG after merge:  round=36 metric=0.7003 head_norm=1.359600 delta_norm=0.376352
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=37 head_norm_before_train=1.772151 cos_to_last_merge=0.9847 (last merge round=28)
[S2] round=37 local utility u=0.003580 metrics={'f1_val': 0.8302475959207379, 'auprc': 0.9871150840127558, 'loss_val': 0.31355852263958683, 'psi': 0.8929945911575451}-{'f1_val': 0.8302742077324969, 'auprc': 0.9857464725128325, 'loss_val': 0.31677245590333514, 'psi': 0.8924631136446312}
[S2] not sending this round → trigger blocked (psi=0.893)
[S3] START round=37 head_norm_before_train=1.737800 cos_to_last_merge=1.0000 (last merge round=36)
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.9608296089712303, 'auprc': 0.9998677127352291, 'loss_val': 0.09999324897058656, 'psi': 0.9764448504768297}-{'f1_val': 0.9978389274664787, 'auprc': 0.9998399984369035, 'loss_val': 0.04632490304809651, 'psi': 0.9986393558546487}
[S4] START round=37 head_norm_before_train=2.114060 (no previous merge yet)
[S4] round=37 local utility u=0.021112 metrics={'f1_val': 0.9321435504067164, 'auprc': 0.9827512078565636, 'loss_val': 0.2225604395360495, 'psi': 0.9523866133866553}-{'f1_val': 0.9315512322118966, 'auprc': 0.979721619032188, 'loss_val': 0.25214181346787473, 'psi': 0.9508193869400132}
[S5] START round=37 head_norm_before_train=1.359600 cos_to_last_merge=1.0000 (last merge round=36)
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.8836083965381352, 'loss_val': 0.3563073065959832, 'psi': 0.7736357177100694}-{'f1_val': 0.7003213174339138, 'auprc': 0.989090588821903, 'loss_val': 0.3256816093530215, 'psi': 0.8158290259891094}
[S6] START round=37 head_norm_before_train=1.851812 cos_to_last_merge=1.0000 (last merge round=36)
[S6] round=37 local utility u=0.028682 metrics={'f1_val': 0.8543506200867077, 'auprc': 0.9237461458914422, 'loss_val': 0.41510390238786754, 'psi': 0.8821088304086016}-{'f1_val': 0.8292582891792876, 'auprc': 0.9545334143193017, 'loss_val': 0.4142758482878945, 'psi': 0.8793683392352932}
[S7] START round=37 head_norm_before_train=1.728303 cos_to_last_merge=0.9999 (last merge round=35)
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.5358340902997766, 'auprc': 0.7821737590399952, 'loss_val': 0.8783451159156573, 'psi': 0.634369957795864}-{'f1_val': 0.6519904408639916, 'auprc': 0.7994680469135618, 'loss_val': 0.5082819460625793, 'psi': 0.7109814832838197}
[S8] START round=37 head_norm_before_train=1.854639 cos_to_last_merge=0.9999 (last merge round=35)
[S8] round=37 local utility u=0.000000 metrics={'f1_val': 0.9920973070316986, 'auprc': 0.9986282724625057, 'loss_val': 0.040734941027099465, 'psi': 0.9947096932040214}-{'f1_val': 0.9927378939946618, 'auprc': 0.9982804283615314, 'loss_val': 0.04001910204017747, 'psi': 0.9949549077414097}
[S9] START round=37 head_norm_before_train=2.027149 (no previous merge yet)
[S9] round=37 local utility u=0.005765 metrics={'f1_val': 0.9912441468948172, 'auprc': 0.9996147896921672, 'loss_val': 0.029543201767792265, 'psi': 0.9945924040137573}-{'f1_val': 0.990399656971262, 'auprc': 0.999622569636214, 'loss_val': 0.036030255274446754, 'psi': 0.9940888220372428}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] sending update (kind=head size=1793 to 1 peers)
[S10] START round=37 head_norm_before_train=2.181968 (no previous merge yet)
[S10] round=37 local utility u=0.000000 metrics={'f1_val': 0.9931299445855843, 'auprc': 0.9965097757847368, 'loss_val': 0.0359029478686304, 'psi': 0.9944818770652454}-{'f1_val': 0.9931299445855843, 'auprc': 0.996392903678585, 'loss_val': 0.03513098908470863, 'psi': 0.9944351282227847}
[S11] START round=37 head_norm_before_train=1.877189 cos_to_last_merge=0.7838 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.784
[S11] round=37 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.999031995552577, 'loss_val': 0.022853648143545072, 'psi': 0.997305283067478}-{'f1_val': 0.9965712481121245, 'auprc': 0.9990493262207647, 'loss_val': 0.023986000334609722, 'psi': 0.9975624793555806}
[S13] START round=37 head_norm_before_train=1.875284 (no previous merge yet)
[S13] round=37 local utility u=0.000000 metrics={'f1_val': 0.6377321893309492, 'auprc': 0.7820769253892021, 'loss_val': 0.8286992676536806, 'psi': 0.6954700837542505}-{'f1_val': 0.7256994465651166, 'auprc': 0.7499321784998958, 'loss_val': 1.0210120258221564, 'psi': 0.7353925393390284}
[S14] START round=37 head_norm_before_train=1.617930 cos_to_last_merge=0.9148 (last merge round=27)
[S14] ⚠️ Model drifted since last merge! cos=0.915
[S14] round=37 local utility u=0.001938 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9984453576812222, 'loss_val': 0.03194808403011273, 'psi': 0.9978231047735242}-{'f1_val': 0.9978195179672185, 'auprc': 0.9987594913234167, 'loss_val': 0.03923344316661946, 'psi': 0.9981955073096977}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=37 metric=0.9974 head_norm=1.638457
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.656481e-02
[S14] stored merged vector for next round verification (round=37)
[S14] DEBUG after merge:  round=37 metric=0.9974 head_norm=1.626044 delta_norm=0.076565
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S15] START round=37 head_norm_before_train=1.492057 cos_to_last_merge=0.9988 (last merge round=34)
[S15] round=37 local utility u=0.000000 metrics={'f1_val': 0.7009601281218527, 'auprc': 0.9882808225339366, 'loss_val': 0.4932410472567296, 'psi': 0.8158884058866862}-{'f1_val': 0.9967466683875206, 'auprc': 0.9971712042176686, 'loss_val': 0.052031728279387096, 'psi': 0.9969164827195798}
[S16] START round=37 head_norm_before_train=1.617165 cos_to_last_merge=0.9995 (last merge round=35)
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.9024392772573119, 'auprc': 0.9872154446432011, 'loss_val': 0.4236056089605624, 'psi': 0.9363497442116675}-{'f1_val': 0.9404638142643832, 'auprc': 0.9960018477773936, 'loss_val': 0.21529232190137915, 'psi': 0.9626790276695874}
[S17] START round=37 head_norm_before_train=2.093575 (no previous merge yet)
[S17] round=37 local utility u=0.181067 metrics={'f1_val': 0.7455966486414629, 'auprc': 0.8970067059268954, 'loss_val': 0.7384724975248573, 'psi': 0.806160671555636}-{'f1_val': 0.7209565431171667, 'auprc': 0.8907306558965848, 'loss_val': 0.9339378460079445, 'psi': 0.7888661882289341}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S6] → sending delta(kind=head bytes=1807) to S8@127.0.0.1:49309
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S11@127.0.0.1:49312
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1793 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1807 to 1 peers)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=37 metric=0.5358 head_norm=1.741569
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.145544e-01
[S7] stored merged vector for next round verification (round=37)
[S7] DEBUG after merge:  round=37 metric=0.5415 head_norm=1.744104 delta_norm=0.114554
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=37 metric=0.7010 head_norm=1.516506
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.989425e-01
[S15] stored merged vector for next round verification (round=37)
[S15] DEBUG after merge:  round=37 metric=0.7011 head_norm=1.383994 delta_norm=0.398942
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] RECEIVED delta(kind=head bytes=1793) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=2.119225)
[S11] loaded HEAD from S4 (vec_in norm=2.119225)
[S11] cosine check vs S4: cos=-0.0905
[S11] DROPPED delta from S4 (cos=-0.0905 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1807) from S6
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.872029)
[S8] loaded HEAD from S6 (vec_in norm=1.872029)
[S8] cosine check vs S6: cos=0.9992
[S8] BUFFERED delta from S6 (total buffered=1)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=37 metric=0.8544 head_norm=1.872029
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.347981e-02
[S6] stored merged vector for next round verification (round=37)
[S6] DEBUG after merge:  round=37 metric=0.8596 head_norm=1.863054 delta_norm=0.033480
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=37 metric=0.9921 head_norm=1.872380
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.658146e-02
[S8] stored merged vector for next round verification (round=37)
[S8] DEBUG after merge:  round=37 metric=0.9921 head_norm=1.871847 delta_norm=0.036581
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=38 head_norm_before_train=1.792926 cos_to_last_merge=0.9829 (last merge round=28)
[S2] round=38 local utility u=0.023801 metrics={'f1_val': 0.8310145704262567, 'auprc': 0.9881719012227884, 'loss_val': 0.2737286864664412, 'psi': 0.8938775027448694}-{'f1_val': 0.8302475959207379, 'auprc': 0.9871150840127558, 'loss_val': 0.31355852263958683, 'psi': 0.8929945911575451}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=38 head_norm_before_train=1.756789 cos_to_last_merge=0.9999 (last merge round=36)
[S3] round=38 local utility u=0.000000 metrics={'f1_val': 0.960365708577172, 'auprc': 0.9998361540449135, 'loss_val': 0.13738180921534443, 'psi': 0.9761538867642686}-{'f1_val': 0.9608296089712303, 'auprc': 0.9998677127352291, 'loss_val': 0.09999324897058656, 'psi': 0.9764448504768297}
[S4] START round=38 head_norm_before_train=2.119225 (no previous merge yet)
[S4] round=38 local utility u=0.015423 metrics={'f1_val': 0.928255237091764, 'auprc': 0.9872471927829791, 'loss_val': 0.18187248238132123, 'psi': 0.95185201936825}-{'f1_val': 0.9321435504067164, 'auprc': 0.9827512078565636, 'loss_val': 0.2225604395360495, 'psi': 0.9523866133866553}
[S5] START round=38 head_norm_before_train=1.382086 cos_to_last_merge=0.9997 (last merge round=36)
[S5] round=38 local utility u=0.000000 metrics={'f1_val': 0.5815661092520485, 'auprc': 0.8250282232309593, 'loss_val': 0.6572734695492001, 'psi': 0.6789509548436128}-{'f1_val': 0.700320598491359, 'auprc': 0.8836083965381352, 'loss_val': 0.3563073065959832, 'psi': 0.7736357177100694}
[S6] START round=38 head_norm_before_train=1.863054 cos_to_last_merge=1.0000 (last merge round=37)
[S6] round=38 local utility u=0.000000 metrics={'f1_val': 0.7024177068843177, 'auprc': 0.9181247833315562, 'loss_val': 0.7961367345995791, 'psi': 0.7887005374632131}-{'f1_val': 0.8543506200867077, 'auprc': 0.9237461458914422, 'loss_val': 0.41510390238786754, 'psi': 0.8821088304086016}
[S7] START round=38 head_norm_before_train=1.744104 cos_to_last_merge=1.0000 (last merge round=37)
[S7] round=38 local utility u=0.812876 metrics={'f1_val': 0.6887435275001524, 'auprc': 0.8368394409135811, 'loss_val': 0.3340465539367531, 'psi': 0.747981892865524}-{'f1_val': 0.5358340902997766, 'auprc': 0.7821737590399952, 'loss_val': 0.8783451159156573, 'psi': 0.634369957795864}
[S8] START round=38 head_norm_before_train=1.871847 cos_to_last_merge=1.0000 (last merge round=37)
[S8] round=38 local utility u=0.000000 metrics={'f1_val': 0.9912324562030403, 'auprc': 0.9987805799788878, 'loss_val': 0.04347754236718829, 'psi': 0.9942517057133794}-{'f1_val': 0.9920973070316986, 'auprc': 0.9986282724625057, 'loss_val': 0.040734941027099465, 'psi': 0.9947096932040214}
[S9] START round=38 head_norm_before_train=2.036429 (no previous merge yet)
[S9] round=38 local utility u=0.000000 metrics={'f1_val': 0.9912441468948172, 'auprc': 0.9996161592666339, 'loss_val': 0.030018922407546684, 'psi': 0.9945929518435439}-{'f1_val': 0.9912441468948172, 'auprc': 0.9996147896921672, 'loss_val': 0.029543201767792265, 'psi': 0.9945924040137573}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=38 head_norm_before_train=2.192626 (no previous merge yet)
[S10] round=38 local utility u=0.000000 metrics={'f1_val': 0.992994663041229, 'auprc': 0.9959418152744893, 'loss_val': 0.035879508346227315, 'psi': 0.9941735239345331}-{'f1_val': 0.9931299445855843, 'auprc': 0.9965097757847368, 'loss_val': 0.0359029478686304, 'psi': 0.9944818770652454}
[S11] START round=38 head_norm_before_train=1.889667 cos_to_last_merge=0.7825 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.783
[S11] round=38 local utility u=0.000674 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9990258090815788, 'loss_val': 0.02398960179504766, 'psi': 0.9975530724999062}-{'f1_val': 0.9961541414107454, 'auprc': 0.999031995552577, 'loss_val': 0.022853648143545072, 'psi': 0.997305283067478}
[S13] START round=38 head_norm_before_train=1.882033 (no previous merge yet)
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.6334091171550692, 'auprc': 0.7758131988488304, 'loss_val': 0.9523155299002285, 'psi': 0.6903707498325737}-{'f1_val': 0.6377321893309492, 'auprc': 0.7820769253892021, 'loss_val': 0.8286992676536806, 'psi': 0.6954700837542505}
[S14] START round=38 head_norm_before_train=1.626044 cos_to_last_merge=1.0000 (last merge round=37)
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9933147311522686, 'loss_val': 0.03591591538236459, 'psi': 0.9955263203894542}-{'f1_val': 0.9974082695017256, 'auprc': 0.9984453576812222, 'loss_val': 0.03194808403011273, 'psi': 0.9978231047735242}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=38 head_norm_before_train=1.383994 cos_to_last_merge=1.0000 (last merge round=37)
[S15] round=38 local utility u=1.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9985969316032325, 'loss_val': 0.07902780245341916, 'psi': 0.9974867736738053}-{'f1_val': 0.7009601281218527, 'auprc': 0.9882808225339366, 'loss_val': 0.4932410472567296, 'psi': 0.8158884058866862}
[S16] START round=38 head_norm_before_train=1.649158 cos_to_last_merge=0.9984 (last merge round=35)
[S16] round=38 local utility u=0.134530 metrics={'f1_val': 0.9312361093682864, 'auprc': 0.9894429356245774, 'loss_val': 0.33400856673296236, 'psi': 0.9545188398708029}-{'f1_val': 0.9024392772573119, 'auprc': 0.9872154446432011, 'loss_val': 0.4236056089605624, 'psi': 0.9363497442116675}
[S17] START round=38 head_norm_before_train=2.104491 (no previous merge yet)
[S17] round=38 local utility u=0.000000 metrics={'f1_val': 0.6844846470867384, 'auprc': 0.8811599227750785, 'loss_val': 1.2618207568032296, 'psi': 0.7631547573620745}-{'f1_val': 0.7455966486414629, 'auprc': 0.8970067059268954, 'loss_val': 0.7384724975248573, 'psi': 0.806160671555636}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.952)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:49305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:49314
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:49304
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:49303
[S7] sending update (kind=head size=1801 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1798 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] RECEIVED delta(kind=head bytes=1798) from S11
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.901281)
[S4] loaded HEAD from S11 (vec_in norm=1.901281)
[S4] cosine check vs S11: cos=-0.0905
[S4] DROPPED delta from S11 (cos=-0.0905 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1804) from S16
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.677748)
[S14] loaded HEAD from S16 (vec_in norm=1.677748)
[S14] cosine check vs S16: cos=0.9954
[S14] BUFFERED delta from S16 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1804) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.413995)
[S5] loaded HEAD from S15 (vec_in norm=1.413995)
[S5] cosine check vs S15: cos=0.9983
[S5] BUFFERED delta from S15 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1801) from S7
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.754223)
[S3] loaded HEAD from S7 (vec_in norm=1.754223)
[S3] cosine check vs S7: cos=0.9995
[S3] BUFFERED delta from S7 (total buffered=1)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=38 metric=0.9604 head_norm=1.773162
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.855328e-02
[S3] stored merged vector for next round verification (round=38)
[S3] DEBUG after merge:  round=38 metric=0.9604 head_norm=1.763486 delta_norm=0.028553
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=38 metric=0.5816 head_norm=1.403530
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.198474e-02
[S5] stored merged vector for next round verification (round=38)
[S5] DEBUG after merge:  round=38 metric=0.5824 head_norm=1.408146 delta_norm=0.041985
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=39 head_norm_before_train=1.807791 cos_to_last_merge=0.9814 (last merge round=28)
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.8272145606551617, 'auprc': 0.9908786984088533, 'loss_val': 0.28321434171126697, 'psi': 0.8926802157566385}-{'f1_val': 0.8310145704262567, 'auprc': 0.9881719012227884, 'loss_val': 0.2737286864664412, 'psi': 0.8938775027448694}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=40 psi=0.893 u=0.0000 p_local=0.0417 f1=0.827 auprc=0.991 bytes=32379
[S3] START round=39 head_norm_before_train=1.763486 cos_to_last_merge=1.0000 (last merge round=38)
[S3] round=39 local utility u=0.144751 metrics={'f1_val': 0.9932557475002596, 'auprc': 0.9998206054629653, 'loss_val': 0.04517332258268781, 'psi': 0.9958816906853418}-{'f1_val': 0.960365708577172, 'auprc': 0.9998361540449135, 'loss_val': 0.13738180921534443, 'psi': 0.9761538867642686}
[S4] START round=39 head_norm_before_train=2.133779 (no previous merge yet)
[S4] round=39 local utility u=0.044159 metrics={'f1_val': 0.9391828229924422, 'auprc': 0.9889804472036052, 'loss_val': 0.1643203158315778, 'psi': 0.9591018726769074}-{'f1_val': 0.928255237091764, 'auprc': 0.9872471927829791, 'loss_val': 0.18187248238132123, 'psi': 0.95185201936825}
[S5] START round=39 head_norm_before_train=1.408146 cos_to_last_merge=1.0000 (last merge round=38)
[S5] round=39 local utility u=0.734914 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9588686965190938, 'loss_val': 0.30149414577746714, 'psi': 0.8037398377024529}-{'f1_val': 0.5815661092520485, 'auprc': 0.8250282232309593, 'loss_val': 0.6572734695492001, 'psi': 0.6789509548436128}
[S6] START round=39 head_norm_before_train=1.881123 cos_to_last_merge=0.9998 (last merge round=37)
[S6] round=39 local utility u=0.292427 metrics={'f1_val': 0.7757360153774655, 'auprc': 0.9221215170429663, 'loss_val': 0.6631818142496397, 'psi': 0.8342902160436658}-{'f1_val': 0.7024177068843177, 'auprc': 0.9181247833315562, 'loss_val': 0.7961367345995791, 'psi': 0.7887005374632131}
[S7] START round=39 head_norm_before_train=1.754223 cos_to_last_merge=1.0000 (last merge round=37)
[S7] round=39 local utility u=0.000000 metrics={'f1_val': 0.49521184781594063, 'auprc': 0.7806534779173202, 'loss_val': 0.9224022347858652, 'psi': 0.6093884998564925}-{'f1_val': 0.6887435275001524, 'auprc': 0.8368394409135811, 'loss_val': 0.3340465539367531, 'psi': 0.747981892865524}
[S8] START round=39 head_norm_before_train=1.887334 cos_to_last_merge=1.0000 (last merge round=37)
[S8] round=39 local utility u=0.000000 metrics={'f1_val': 0.9803062134042129, 'auprc': 0.9984219884969703, 'loss_val': 0.059753079486026386, 'psi': 0.9875525234413158}-{'f1_val': 0.9912324562030403, 'auprc': 0.9987805799788878, 'loss_val': 0.04347754236718829, 'psi': 0.9942517057133794}
[S9] START round=39 head_norm_before_train=2.045603 (no previous merge yet)
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.9908221688527771, 'auprc': 0.9996163776711497, 'loss_val': 0.031417306290353685, 'psi': 0.9943398523801261}-{'f1_val': 0.9912441468948172, 'auprc': 0.9996161592666339, 'loss_val': 0.030018922407546684, 'psi': 0.9945929518435439}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=40 psi=0.994 u=0.0000 p_local=0.0063 f1=0.991 auprc=1.000 bytes=35980
[S10] START round=39 head_norm_before_train=2.203819 (no previous merge yet)
[S10] round=39 local utility u=0.000000 metrics={'f1_val': 0.9927757495752743, 'auprc': 0.9965415559747328, 'loss_val': 0.03684923793905667, 'psi': 0.9942820721350577}-{'f1_val': 0.992994663041229, 'auprc': 0.9959418152744893, 'loss_val': 0.035879508346227315, 'psi': 0.9941735239345331}
[S11] START round=39 head_norm_before_train=1.901281 cos_to_last_merge=0.7811 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.781
[S11] round=39 local utility u=0.000000 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9990741636429596, 'loss_val': 0.02888713160234474, 'psi': 0.9975724143244586}-{'f1_val': 0.9965712481121245, 'auprc': 0.9990258090815788, 'loss_val': 0.02398960179504766, 'psi': 0.9975530724999062}
[S13] START round=39 head_norm_before_train=1.889328 (no previous merge yet)
[S13] round=39 local utility u=0.286365 metrics={'f1_val': 0.7166294767266517, 'auprc': 0.7666768252444112, 'loss_val': 0.8514984662581903, 'psi': 0.7366484161337554}-{'f1_val': 0.6334091171550692, 'auprc': 0.7758131988488304, 'loss_val': 0.9523155299002285, 'psi': 0.6903707498325737}
[S14] START round=39 head_norm_before_train=1.644031 cos_to_last_merge=1.0000 (last merge round=37)
[S14] round=39 local utility u=0.010460 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9988098432627753, 'loss_val': 0.03146143466167991, 'psi': 0.9977224421997092}-{'f1_val': 0.9970007132142444, 'auprc': 0.9933147311522686, 'loss_val': 0.03591591538236459, 'psi': 0.9955263203894542}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=39 metric=0.9970 head_norm=1.663680
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.509025e-02
[S14] stored merged vector for next round verification (round=39)
[S14] DEBUG after merge:  round=39 metric=0.9970 head_norm=1.668561 delta_norm=0.085090
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S14] r=40 psi=0.998 u=0.0105 p_local=0.0095 f1=0.997 auprc=0.999 bytes=41399
[S15] START round=39 head_norm_before_train=1.413995 cos_to_last_merge=0.9995 (last merge round=37)
[S15] round=39 local utility u=0.000000 metrics={'f1_val': 0.9650454121553215, 'auprc': 0.9969176685403658, 'loss_val': 0.09808366756939359, 'psi': 0.9777943147093392}-{'f1_val': 0.9967466683875206, 'auprc': 0.9985969316032325, 'loss_val': 0.07902780245341916, 'psi': 0.9974867736738053}
[S16] START round=39 head_norm_before_train=1.677748 cos_to_last_merge=0.9970 (last merge round=35)
[S16] round=39 local utility u=0.000000 metrics={'f1_val': 0.9303786907666867, 'auprc': 0.9887094378137773, 'loss_val': 0.33385415209546504, 'psi': 0.9537109895855229}-{'f1_val': 0.9312361093682864, 'auprc': 0.9894429356245774, 'loss_val': 0.33400856673296236, 'psi': 0.9545188398708029}
[S17] START round=39 head_norm_before_train=2.114107 (no previous merge yet)
[S17] round=39 local utility u=0.142490 metrics={'f1_val': 0.6945353460431453, 'auprc': 0.8860367220764824, 'loss_val': 1.051775086756386, 'psi': 0.7711358964564802}-{'f1_val': 0.6844846470867384, 'auprc': 0.8811599227750785, 'loss_val': 1.2618207568032296, 'psi': 0.7631547573620745}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S17] r=40 psi=0.771 u=0.1425 p_local=0.1105 f1=0.695 auprc=0.886 bytes=35973
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:49309
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:49311
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:49312
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1796 to 1 peers)
[S16] r=40 psi=0.954 u=0.0000 p_local=0.1219 f1=0.930 auprc=0.989 bytes=37754
[S15] r=40 psi=0.978 u=0.0000 p_local=0.3515 f1=0.965 auprc=0.997 bytes=34181
[S13] sending update (kind=head size=1802 to 1 peers)
[S7] r=40 psi=0.609 u=0.0000 p_local=0.2503 f1=0.495 auprc=0.781 bytes=37732
[S10] r=40 psi=0.994 u=0.0000 p_local=0.0008 f1=0.993 auprc=0.997 bytes=41323
[S11] r=40 psi=0.998 u=0.0000 p_local=0.0040 f1=0.997 auprc=0.999 bytes=46791
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:49308
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:49315
[S8] RECEIVED delta(kind=head bytes=1800) from S6
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.901449)
[S8] loaded HEAD from S6 (vec_in norm=1.901449)
[S8] cosine check vs S6: cos=0.9993
[S8] BUFFERED delta from S6 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1796) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=2.148405)
[S11] loaded HEAD from S4 (vec_in norm=2.148405)
[S11] cosine check vs S4: cos=-0.0905
[S11] DROPPED delta from S4 (cos=-0.0905 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1802) from S13
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.894152)
[S10] loaded HEAD from S13 (vec_in norm=1.894152)
[S10] cosine check vs S13: cos=-0.0929
[S10] DROPPED delta from S13 (cos=-0.0929 < 0.0)
[S5] sending update (kind=head size=1800 to 1 peers)
[S13] r=40 psi=0.737 u=0.2864 p_local=0.0960 f1=0.717 auprc=0.767 bytes=34169
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] r=40 psi=0.959 u=0.0442 p_local=0.0275 f1=0.939 auprc=0.989 bytes=35961
[S6] r=40 psi=0.834 u=0.2924 p_local=0.1824 f1=0.776 auprc=0.922 bytes=30605
[S7] RECEIVED delta(kind=head bytes=1800) from S3
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.779038)
[S7] loaded HEAD from S3 (vec_in norm=1.779038)
[S7] cosine check vs S3: cos=0.9996
[S7] BUFFERED delta from S3 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1800) from S5
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.424141)
[S15] loaded HEAD from S5 (vec_in norm=1.424141)
[S15] cosine check vs S5: cos=0.9979
[S15] BUFFERED delta from S5 (total buffered=1)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=39 metric=0.9803 head_norm=1.900730
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.428501e-02
[S8] stored merged vector for next round verification (round=39)
[S8] DEBUG after merge:  round=39 metric=0.9793 head_norm=1.900780 delta_norm=0.034285
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S8] r=40 psi=0.988 u=0.0000 p_local=0.0041 f1=0.980 auprc=0.998 bytes=36039
[S3] r=40 psi=0.996 u=0.1448 p_local=0.0799 f1=0.993 auprc=1.000 bytes=43152
[S5] r=40 psi=0.804 u=0.7349 p_local=0.2942 f1=0.700 auprc=0.959 bytes=34184
[S2] START round=40 head_norm_before_train=1.821550 cos_to_last_merge=0.9801 (last merge round=28)
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.8272946909019718, 'auprc': 0.9889902367543351, 'loss_val': 0.30943391404437676, 'psi': 0.8919729092429172}-{'f1_val': 0.8272145606551617, 'auprc': 0.9908786984088533, 'loss_val': 0.28321434171126697, 'psi': 0.8926802157566385}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=40 head_norm_before_train=1.779038 cos_to_last_merge=0.9999 (last merge round=38)
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.9115642016092446, 'auprc': 0.9985925683053563, 'loss_val': 0.18721205289990037, 'psi': 0.9463755482876892}-{'f1_val': 0.9932557475002596, 'auprc': 0.9998206054629653, 'loss_val': 0.04517332258268781, 'psi': 0.9958816906853418}
[S4] START round=40 head_norm_before_train=2.148405 (no previous merge yet)
[S4] round=40 local utility u=0.000000 metrics={'f1_val': 0.9265841776060969, 'auprc': 0.9784037829394622, 'loss_val': 0.21483502399865193, 'psi': 0.9473120197394429}-{'f1_val': 0.9391828229924422, 'auprc': 0.9889804472036052, 'loss_val': 0.1643203158315778, 'psi': 0.9591018726769074}
[S5] START round=40 head_norm_before_train=1.424141 cos_to_last_merge=0.9999 (last merge round=38)
[S5] round=40 local utility u=0.078041 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9911602753295303, 'loss_val': 0.2422877824559728, 'psi': 0.8166564692266276}-{'f1_val': 0.700320598491359, 'auprc': 0.9588686965190938, 'loss_val': 0.30149414577746714, 'psi': 0.8037398377024529}
[S6] START round=40 head_norm_before_train=1.901449 cos_to_last_merge=0.9997 (last merge round=37)
[S6] round=40 local utility u=0.338205 metrics={'f1_val': 0.8513428732449687, 'auprc': 0.9244517391291867, 'loss_val': 0.4474042508732443, 'psi': 0.8805864195986559}-{'f1_val': 0.7757360153774655, 'auprc': 0.9221215170429663, 'loss_val': 0.6631818142496397, 'psi': 0.8342902160436658}
[S7] START round=40 head_norm_before_train=1.762127 cos_to_last_merge=0.9999 (last merge round=37)
[S7] round=40 local utility u=1.000000 metrics={'f1_val': 0.6929211864915737, 'auprc': 0.8696937297093933, 'loss_val': 0.2746562441547179, 'psi': 0.7636302037787015}-{'f1_val': 0.49521184781594063, 'auprc': 0.7806534779173202, 'loss_val': 0.9224022347858652, 'psi': 0.6093884998564925}
[S8] START round=40 head_norm_before_train=1.900780 cos_to_last_merge=1.0000 (last merge round=39)
[S8] round=40 local utility u=0.048041 metrics={'f1_val': 0.992384245702453, 'auprc': 0.9991658521095681, 'loss_val': 0.03837149953723755, 'psi': 0.995096888265299}-{'f1_val': 0.9803062134042129, 'auprc': 0.9984219884969703, 'loss_val': 0.059753079486026386, 'psi': 0.9875525234413158}
[S9] START round=40 head_norm_before_train=2.054910 (no previous merge yet)
[S9] round=40 local utility u=0.014687 metrics={'f1_val': 0.9941897064172326, 'auprc': 0.9996112877716634, 'loss_val': 0.022233177964789727, 'psi': 0.9963583389590049}-{'f1_val': 0.9908221688527771, 'auprc': 0.9996163776711497, 'loss_val': 0.031417306290353685, 'psi': 0.9943398523801261}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=40 head_norm_before_train=2.206956 (no previous merge yet)
[S10] round=40 local utility u=0.000872 metrics={'f1_val': 0.992994663041229, 'auprc': 0.996235849389006, 'loss_val': 0.03550106641252037, 'psi': 0.9942911375803398}-{'f1_val': 0.9927757495752743, 'auprc': 0.9965415559747328, 'loss_val': 0.03684923793905667, 'psi': 0.9942820721350577}
[S11] START round=40 head_norm_before_train=1.912807 cos_to_last_merge=0.7799 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.780
[S11] round=40 local utility u=0.003061 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9990056509390588, 'loss_val': 0.022559451497181877, 'psi': 0.9975450092428982}-{'f1_val': 0.9965712481121245, 'auprc': 0.9990741636429596, 'loss_val': 0.02888713160234474, 'psi': 0.9975724143244586}
[S13] START round=40 head_norm_before_train=1.894152 (no previous merge yet)
[S13] round=40 local utility u=0.045204 metrics={'f1_val': 0.7313227577737424, 'auprc': 0.7679581215512864, 'loss_val': 0.853093931845472, 'psi': 0.7459769032847601}-{'f1_val': 0.7166294767266517, 'auprc': 0.7666768252444112, 'loss_val': 0.8514984662581903, 'psi': 0.7366484161337554}
[S14] START round=40 head_norm_before_train=1.668561 cos_to_last_merge=1.0000 (last merge round=39)
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9967481654760328, 'loss_val': 0.03427165736746197, 'psi': 0.9971442278914485}-{'f1_val': 0.9969975081576651, 'auprc': 0.9988098432627753, 'loss_val': 0.03146143466167991, 'psi': 0.9977224421997092}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=40 head_norm_before_train=1.461992 cos_to_last_merge=0.9976 (last merge round=37)
[S15] round=40 local utility u=0.107338 metrics={'f1_val': 0.994670400252284, 'auprc': 0.9969913576887353, 'loss_val': 0.06137914979132433, 'psi': 0.9955987832268645}-{'f1_val': 0.9650454121553215, 'auprc': 0.9969176685403658, 'loss_val': 0.09808366756939359, 'psi': 0.9777943147093392}
[S16] START round=40 head_norm_before_train=1.701528 cos_to_last_merge=0.9956 (last merge round=35)
[S16] round=40 local utility u=0.131554 metrics={'f1_val': 0.9426978023344212, 'auprc': 0.9940988761279232, 'loss_val': 0.16082933915429298, 'psi': 0.9632582318518221}-{'f1_val': 0.9303786907666867, 'auprc': 0.9887094378137773, 'loss_val': 0.33385415209546504, 'psi': 0.9537109895855229}
[S17] START round=40 head_norm_before_train=2.121677 (no previous merge yet)
[S17] round=40 local utility u=0.000000 metrics={'f1_val': 0.6945086338541507, 'auprc': 0.8700989575887491, 'loss_val': 1.2206035660812986, 'psi': 0.76474476334799}-{'f1_val': 0.6945353460431453, 'auprc': 0.8860367220764824, 'loss_val': 1.051775086756386, 'psi': 0.7711358964564802}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] → sending delta(kind=head bytes=1792) to S13@127.0.0.1:49313
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.881)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S11] → sending delta(kind=head bytes=1807) to S4@127.0.0.1:49304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:49305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S16] → sending delta(kind=head bytes=1807) to S14@127.0.0.1:49314
[S13] not sending this round → trigger blocked (psi=0.746)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:49303
[S5] not sending this round → trigger blocked (psi=0.817)
[S7] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:49307
[S16] sending update (kind=head size=1807 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1807 to 1 peers)
[S13] ⇄ pheromone p=0.086 → S10@127.0.0.1:49311
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] ⇄ pheromone p=0.214 → S8@127.0.0.1:49309
[S4] ⇄ pheromone p=0.022 → S11@127.0.0.1:49312
[S10] sending update (kind=head size=1792 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1807) from S16
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.722243)
[S14] loaded HEAD from S16 (vec_in norm=1.722243)
[S14] cosine check vs S16: cos=0.9967
[S14] BUFFERED delta from S16 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1792) from S10
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=2.210933)
[S13] loaded HEAD from S10 (vec_in norm=2.210933)
[S13] cosine check vs S10: cos=-0.0930
[S13] DROPPED delta from S10 (cos=-0.0930 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1807) from S11
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.923573)
[S4] loaded HEAD from S11 (vec_in norm=1.923573)
[S4] cosine check vs S11: cos=-0.0907
[S4] DROPPED delta from S11 (cos=-0.0907 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1803) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.507103)
[S5] loaded HEAD from S15 (vec_in norm=1.507103)
[S5] cosine check vs S15: cos=0.9954
[S5] BUFFERED delta from S15 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1800) from S7
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.769669)
[S3] loaded HEAD from S7 (vec_in norm=1.769669)
[S3] cosine check vs S7: cos=0.9992
[S3] BUFFERED delta from S7 (total buffered=1)
[S10] ⇄ pheromone p=0.001 → S13@127.0.0.1:49313
[S11] ⇄ pheromone p=0.004 → S4@127.0.0.1:49304
[S8] sending update (kind=head size=1804 to 1 peers)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=40 metric=0.9947 head_norm=1.507103
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.999974e-02
[S15] stored merged vector for next round verification (round=40)
[S15] DEBUG after merge:  round=40 metric=0.9930 head_norm=1.464025 delta_norm=0.080000
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.303 → S5@127.0.0.1:49305
[S16] ⇄ pheromone p=0.124 → S14@127.0.0.1:49314
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=40 metric=0.6929 head_norm=1.769669
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.769963e-02
[S7] stored merged vector for next round verification (round=40)
[S7] DEBUG after merge:  round=40 metric=0.6945 head_norm=1.774144 delta_norm=0.027700
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.400 → S3@127.0.0.1:49303
[S6] RECEIVED delta(kind=head bytes=1804) from S8
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.915665)
[S6] loaded HEAD from S8 (vec_in norm=1.915665)
[S6] cosine check vs S8: cos=0.9995
[S6] BUFFERED delta from S8 (total buffered=1)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=40 metric=0.7003 head_norm=1.439525
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.810421e-02
[S5] stored merged vector for next round verification (round=40)
[S5] DEBUG after merge:  round=40 metric=0.7003 head_norm=1.471631 delta_norm=0.078104
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.251 → S15@127.0.0.1:49315
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=40 metric=0.9116 head_norm=1.794032
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.780352e-02
[S3] stored merged vector for next round verification (round=40)
[S3] DEBUG after merge:  round=40 metric=0.9132 head_norm=1.781491 delta_norm=0.037804
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.064 → S7@127.0.0.1:49308
[S8] ⇄ pheromone p=0.013 → S6@127.0.0.1:49307
[S2] START round=41 head_norm_before_train=1.839254 cos_to_last_merge=0.9784 (last merge round=28)
[S2] round=41 local utility u=0.000000 metrics={'f1_val': 0.8294088607070358, 'auprc': 0.9803502660959212, 'loss_val': 0.32328334246663076, 'psi': 0.8897854228625899}-{'f1_val': 0.8272946909019718, 'auprc': 0.9889902367543351, 'loss_val': 0.30943391404437676, 'psi': 0.8919729092429172}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=41 head_norm_before_train=1.781491 cos_to_last_merge=1.0000 (last merge round=40)
[S3] round=41 local utility u=0.318994 metrics={'f1_val': 0.9950485984519298, 'auprc': 0.9996947790278586, 'loss_val': 0.053436383410722904, 'psi': 0.9969070706823013}-{'f1_val': 0.9115642016092446, 'auprc': 0.9985925683053563, 'loss_val': 0.18721205289990037, 'psi': 0.9463755482876892}
[S4] START round=41 head_norm_before_train=2.158926 (no previous merge yet)
[S4] round=41 local utility u=0.007735 metrics={'f1_val': 0.9236304352530869, 'auprc': 0.9843687034462097, 'loss_val': 0.19953831493354127, 'psi': 0.947925742530336}-{'f1_val': 0.9265841776060969, 'auprc': 0.9784037829394622, 'loss_val': 0.21483502399865193, 'psi': 0.9473120197394429}
[S5] START round=41 head_norm_before_train=1.471631 cos_to_last_merge=1.0000 (last merge round=40)
[S5] round=41 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9014230542451254, 'loss_val': 0.33495629730119386, 'psi': 0.7807615807928656}-{'f1_val': 0.700320598491359, 'auprc': 0.9911602753295303, 'loss_val': 0.2422877824559728, 'psi': 0.8166564692266276}
[S6] START round=41 head_norm_before_train=1.917898 cos_to_last_merge=0.9995 (last merge round=37)
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.7539254136727601, 'auprc': 0.9275922034827753, 'loss_val': 0.5361010221760935, 'psi': 0.8233921295967661}-{'f1_val': 0.8513428732449687, 'auprc': 0.9244517391291867, 'loss_val': 0.4474042508732443, 'psi': 0.8805864195986559}
[S7] START round=41 head_norm_before_train=1.774144 cos_to_last_merge=1.0000 (last merge round=40)
[S7] round=41 local utility u=0.000000 metrics={'f1_val': 0.6459064434777968, 'auprc': 0.7992938147265856, 'loss_val': 0.5055933781149519, 'psi': 0.7072613919773123}-{'f1_val': 0.6929211864915737, 'auprc': 0.8696937297093933, 'loss_val': 0.2746562441547179, 'psi': 0.7636302037787015}
[S8] START round=41 head_norm_before_train=1.915665 cos_to_last_merge=1.0000 (last merge round=39)
[S8] round=41 local utility u=0.000401 metrics={'f1_val': 0.9920108289094297, 'auprc': 0.9991175032204497, 'loss_val': 0.03518432615972772, 'psi': 0.9948534986338377}-{'f1_val': 0.992384245702453, 'auprc': 0.9991658521095681, 'loss_val': 0.03837149953723755, 'psi': 0.995096888265299}
[S9] START round=41 head_norm_before_train=2.061869 (no previous merge yet)
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.9909938198082651, 'auprc': 0.9998352814481747, 'loss_val': 0.03040246953047622, 'psi': 0.9945304044642289}-{'f1_val': 0.9941897064172326, 'auprc': 0.9996112877716634, 'loss_val': 0.022233177964789727, 'psi': 0.9963583389590049}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=41 head_norm_before_train=2.210933 (no previous merge yet)
[S10] round=41 local utility u=0.001017 metrics={'f1_val': 0.992994663041229, 'auprc': 0.9970659503126078, 'loss_val': 0.03595704301994601, 'psi': 0.9946231779497805}-{'f1_val': 0.992994663041229, 'auprc': 0.996235849389006, 'loss_val': 0.03550106641252037, 'psi': 0.9942911375803398}
[S11] START round=41 head_norm_before_train=1.923573 cos_to_last_merge=0.7789 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.779
[S11] round=41 local utility u=0.000000 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9988824337720523, 'loss_val': 0.021733533495242513, 'psi': 0.9973384242790422}-{'f1_val': 0.9965712481121245, 'auprc': 0.9990056509390588, 'loss_val': 0.022559451497181877, 'psi': 0.9975450092428982}
[S13] START round=41 head_norm_before_train=1.900555 (no previous merge yet)
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.6258533432255088, 'auprc': 0.768478762692033, 'loss_val': 0.8925118701825918, 'psi': 0.6829035110121184}-{'f1_val': 0.7313227577737424, 'auprc': 0.7679581215512864, 'loss_val': 0.853093931845472, 'psi': 0.7459769032847601}
[S14] START round=41 head_norm_before_train=1.681911 cos_to_last_merge=1.0000 (last merge round=39)
[S14] round=41 local utility u=0.002267 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9967579084626373, 'loss_val': 0.02976715935080095, 'psi': 0.9971481250860903}-{'f1_val': 0.9974082695017256, 'auprc': 0.9967481654760328, 'loss_val': 0.03427165736746197, 'psi': 0.9971442278914485}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=41 metric=0.9974 head_norm=1.696146
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.434640e-02
[S14] stored merged vector for next round verification (round=41)
[S14] DEBUG after merge:  round=41 metric=0.9974 head_norm=1.707627 delta_norm=0.074346
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S15] START round=41 head_norm_before_train=1.464025 cos_to_last_merge=1.0000 (last merge round=40)
[S15] round=41 local utility u=0.000000 metrics={'f1_val': 0.9659579114815917, 'auprc': 0.9963866724643227, 'loss_val': 0.08772676689317374, 'psi': 0.9781294158746842}-{'f1_val': 0.994670400252284, 'auprc': 0.9969913576887353, 'loss_val': 0.06137914979132433, 'psi': 0.9955987832268645}
[S16] START round=41 head_norm_before_train=1.722243 cos_to_last_merge=0.9943 (last merge round=35)
[S16] round=41 local utility u=0.201703 metrics={'f1_val': 0.9915097472062806, 'auprc': 0.9960095532945983, 'loss_val': 0.05602734530114844, 'psi': 0.9933096696416077}-{'f1_val': 0.9426978023344212, 'auprc': 0.9940988761279232, 'loss_val': 0.16082933915429298, 'psi': 0.9632582318518221}
[S17] START round=41 head_norm_before_train=2.133671 (no previous merge yet)
[S17] round=41 local utility u=0.089997 metrics={'f1_val': 0.6953719571562423, 'auprc': 0.8814209032012057, 'loss_val': 1.0797559204141332, 'psi': 0.7697915355742277}-{'f1_val': 0.6945086338541507, 'auprc': 0.8700989575887491, 'loss_val': 1.2206035660812986, 'psi': 0.76474476334799}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.993)
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:49312
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:49308
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.995)
[S4] sending update (kind=head size=1794 to 1 peers)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=41 metric=0.7539 head_norm=1.934836
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.766377e-02
[S6] stored merged vector for next round verification (round=41)
[S6] DEBUG after merge:  round=41 metric=0.7575 head_norm=1.924906 delta_norm=0.037664
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S11] RECEIVED delta(kind=head bytes=1794) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=2.166100)
[S11] loaded HEAD from S4 (vec_in norm=2.166100)
[S11] cosine check vs S4: cos=-0.0909
[S11] DROPPED delta from S4 (cos=-0.0909 < 0.0)
[S3] sending update (kind=head size=1797 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1797) from S3
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.795841)
[S7] loaded HEAD from S3 (vec_in norm=1.795841)
[S7] cosine check vs S3: cos=0.9999
[S7] BUFFERED delta from S3 (total buffered=1)
[S2] START round=42 head_norm_before_train=1.854525 cos_to_last_merge=0.9772 (last merge round=28)
[S2] round=42 local utility u=0.007396 metrics={'f1_val': 0.8291297560375565, 'auprc': 0.9795771200192128, 'loss_val': 0.3044963976548017, 'psi': 0.889308701630219}-{'f1_val': 0.8294088607070358, 'auprc': 0.9803502660959212, 'loss_val': 0.32328334246663076, 'psi': 0.8897854228625899}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=42 head_norm_before_train=1.795841 cos_to_last_merge=1.0000 (last merge round=40)
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9998170831560395, 'loss_val': 0.12498858566859185, 'psi': 0.9765718845020881}-{'f1_val': 0.9950485984519298, 'auprc': 0.9996947790278586, 'loss_val': 0.053436383410722904, 'psi': 0.9969070706823013}
[S4] START round=42 head_norm_before_train=2.166100 (no previous merge yet)
[S4] round=42 local utility u=0.022765 metrics={'f1_val': 0.9291696753467611, 'auprc': 0.9860139649226022, 'loss_val': 0.19218036952392326, 'psi': 0.9519073911770974}-{'f1_val': 0.9236304352530869, 'auprc': 0.9843687034462097, 'loss_val': 0.19953831493354127, 'psi': 0.947925742530336}
[S5] START round=42 head_norm_before_train=1.489297 cos_to_last_merge=0.9999 (last merge round=40)
[S5] round=42 local utility u=0.000000 metrics={'f1_val': 0.6070193300670437, 'auprc': 0.8694670750644451, 'loss_val': 0.5189387124114172, 'psi': 0.7119984280660042}-{'f1_val': 0.700320598491359, 'auprc': 0.9014230542451254, 'loss_val': 0.33495629730119386, 'psi': 0.7807615807928656}
[S6] START round=42 head_norm_before_train=1.924906 cos_to_last_merge=1.0000 (last merge round=41)
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.7194444257103709, 'auprc': 0.9184528081284663, 'loss_val': 0.6203066376145525, 'psi': 0.7990477786776091}-{'f1_val': 0.7539254136727601, 'auprc': 0.9275922034827753, 'loss_val': 0.5361010221760935, 'psi': 0.8233921295967661}
[S7] START round=42 head_norm_before_train=1.780182 cos_to_last_merge=1.0000 (last merge round=40)
[S7] round=42 local utility u=0.224325 metrics={'f1_val': 0.6817600993252253, 'auprc': 0.8286108897210797, 'loss_val': 0.3600165470208898, 'psi': 0.740500415483567}-{'f1_val': 0.6459064434777968, 'auprc': 0.7992938147265856, 'loss_val': 0.5055933781149519, 'psi': 0.7072613919773123}
[S8] START round=42 head_norm_before_train=1.929981 cos_to_last_merge=0.9999 (last merge round=39)
[S8] round=42 local utility u=0.000495 metrics={'f1_val': 0.9924932660920454, 'auprc': 0.9991242774544411, 'loss_val': 0.03710932977995118, 'psi': 0.9951456706370037}-{'f1_val': 0.9920108289094297, 'auprc': 0.9991175032204497, 'loss_val': 0.03518432615972772, 'psi': 0.9948534986338377}
[S9] START round=42 head_norm_before_train=2.069371 (no previous merge yet)
[S9] round=42 local utility u=0.021048 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9974533480242986, 'loss_val': 0.01781429059136825, 'psi': 0.9972430867170051}-{'f1_val': 0.9909938198082651, 'auprc': 0.9998352814481747, 'loss_val': 0.03040246953047622, 'psi': 0.9945304044642289}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=42 head_norm_before_train=2.215852 (no previous merge yet)
[S10] round=42 local utility u=0.000000 metrics={'f1_val': 0.992994663041229, 'auprc': 0.9970177869574623, 'loss_val': 0.036345434674482216, 'psi': 0.9946039126077224}-{'f1_val': 0.992994663041229, 'auprc': 0.9970659503126078, 'loss_val': 0.03595704301994601, 'psi': 0.9946231779497805}
[S11] START round=42 head_norm_before_train=1.933601 cos_to_last_merge=0.7779 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.778
[S11] round=42 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9988751580289241, 'loss_val': 0.020977004345138946, 'psi': 0.9972302681595553}-{'f1_val': 0.9963090846170353, 'auprc': 0.9988824337720523, 'loss_val': 0.021733533495242513, 'psi': 0.9973384242790422}
[S13] START round=42 head_norm_before_train=1.908975 (no previous merge yet)
[S13] round=42 local utility u=0.286365 metrics={'f1_val': 0.7227343307043474, 'auprc': 0.7468328671049421, 'loss_val': 0.8361302324534632, 'psi': 0.7323737452645853}-{'f1_val': 0.6258533432255088, 'auprc': 0.768478762692033, 'loss_val': 0.8925118701825918, 'psi': 0.6829035110121184}
[S14] START round=42 head_norm_before_train=1.707627 cos_to_last_merge=1.0000 (last merge round=41)
[S14] round=42 local utility u=0.000000 metrics={'f1_val': 0.9378492043471004, 'auprc': 0.9988211687438684, 'loss_val': 0.10145145080107369, 'psi': 0.9622379901058076}-{'f1_val': 0.9974082695017256, 'auprc': 0.9967579084626373, 'loss_val': 0.02976715935080095, 'psi': 0.9971481250860903}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=42 head_norm_before_train=1.506372 cos_to_last_merge=0.9995 (last merge round=40)
[S15] round=42 local utility u=0.000000 metrics={'f1_val': 0.7680112771965788, 'auprc': 0.992233374695888, 'loss_val': 0.4049308383125278, 'psi': 0.8577001161963025}-{'f1_val': 0.9659579114815917, 'auprc': 0.9963866724643227, 'loss_val': 0.08772676689317374, 'psi': 0.9781294158746842}
[S16] START round=42 head_norm_before_train=1.741184 cos_to_last_merge=0.9931 (last merge round=35)
[S16] round=42 local utility u=0.000000 metrics={'f1_val': 0.9915293093038144, 'auprc': 0.9896811611449355, 'loss_val': 0.057613862259608226, 'psi': 0.9907900500402629}-{'f1_val': 0.9915097472062806, 'auprc': 0.9960095532945983, 'loss_val': 0.05602734530114844, 'psi': 0.9933096696416077}
[S17] START round=42 head_norm_before_train=2.142948 (no previous merge yet)
[S17] round=42 local utility u=1.000000 metrics={'f1_val': 0.9088957438252224, 'auprc': 0.9913419174395909, 'loss_val': 0.23261911106090766, 'psi': 0.9418742132709699}-{'f1_val': 0.6953719571562423, 'auprc': 0.8814209032012057, 'loss_val': 1.0797559204141332, 'psi': 0.7697915355742277}
[S17] not sending this round → trigger blocked (psi=0.942)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:49303
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S13] → sending delta(kind=head bytes=1790) to S10@127.0.0.1:49311
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.952)
[S13] sending update (kind=head size=1790 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:49307
[S10] RECEIVED delta(kind=head bytes=1790) from S13
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.913350)
[S10] loaded HEAD from S13 (vec_in norm=1.913350)
[S10] cosine check vs S13: cos=-0.0942
[S10] DROPPED delta from S13 (cos=-0.0942 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1800) from S7
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.787368)
[S3] loaded HEAD from S7 (vec_in norm=1.787368)
[S3] cosine check vs S7: cos=0.9996
[S3] BUFFERED delta from S7 (total buffered=1)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=42 metric=0.6818 head_norm=1.787368
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.689139e-02
[S7] stored merged vector for next round verification (round=42)
[S7] DEBUG after merge:  round=42 metric=0.6828 head_norm=1.791530 delta_norm=0.016891
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S8] sending update (kind=head size=1799 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1799) from S8
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.942087)
[S6] loaded HEAD from S8 (vec_in norm=1.942087)
[S6] cosine check vs S8: cos=0.9994
[S6] BUFFERED delta from S8 (total buffered=1)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=42 metric=0.9611 head_norm=1.810245
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.703187e-02
[S3] stored merged vector for next round verification (round=42)
[S3] DEBUG after merge:  round=42 metric=0.9611 head_norm=1.798640 delta_norm=0.027032
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=43 head_norm_before_train=1.869848 cos_to_last_merge=0.9758 (last merge round=28)
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.8275249358345539, 'auprc': 0.8798211232595116, 'loss_val': 0.36436966756483974, 'psi': 0.8484434108045369}-{'f1_val': 0.8291297560375565, 'auprc': 0.9795771200192128, 'loss_val': 0.3044963976548017, 'psi': 0.889308701630219}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=43 head_norm_before_train=1.798640 cos_to_last_merge=1.0000 (last merge round=42)
[S3] round=43 local utility u=0.024218 metrics={'f1_val': 0.9615385219550141, 'auprc': 0.9996546943119597, 'loss_val': 0.07884650548443901, 'psi': 0.9767849908977924}-{'f1_val': 0.9610750853994537, 'auprc': 0.9998170831560395, 'loss_val': 0.12498858566859185, 'psi': 0.9765718845020881}
[S4] START round=43 head_norm_before_train=2.176004 (no previous merge yet)
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.9329071540474803, 'auprc': 0.9813549068829077, 'loss_val': 0.20934406951389506, 'psi': 0.9522862551816512}-{'f1_val': 0.9291696753467611, 'auprc': 0.9860139649226022, 'loss_val': 0.19218036952392326, 'psi': 0.9519073911770974}
[S5] START round=43 head_norm_before_train=1.503019 cos_to_last_merge=0.9998 (last merge round=40)
[S5] round=43 local utility u=0.762695 metrics={'f1_val': 0.7375101617749037, 'auprc': 0.9976982103305725, 'loss_val': 0.16118801223695936, 'psi': 0.8415853811971712}-{'f1_val': 0.6070193300670437, 'auprc': 0.8694670750644451, 'loss_val': 0.5189387124114172, 'psi': 0.7119984280660042}
[S6] START round=43 head_norm_before_train=1.942588 cos_to_last_merge=0.9999 (last merge round=41)
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.6685040993920133, 'auprc': 0.9075497898721383, 'loss_val': 0.6870044320909963, 'psi': 0.7641223755840634}-{'f1_val': 0.7194444257103709, 'auprc': 0.9184528081284663, 'loss_val': 0.6203066376145525, 'psi': 0.7990477786776091}
[S7] START round=43 head_norm_before_train=1.791530 cos_to_last_merge=1.0000 (last merge round=42)
[S7] round=43 local utility u=0.000000 metrics={'f1_val': 0.5697030762564507, 'auprc': 0.7852803003204717, 'loss_val': 0.7855267652328115, 'psi': 0.6559339658820591}-{'f1_val': 0.6817600993252253, 'auprc': 0.8286108897210797, 'loss_val': 0.3600165470208898, 'psi': 0.740500415483567}
[S8] START round=43 head_norm_before_train=1.942087 cos_to_last_merge=0.9998 (last merge round=39)
[S8] round=43 local utility u=0.000696 metrics={'f1_val': 0.9920973070316986, 'auprc': 0.9993093896379753, 'loss_val': 0.03389763485916855, 'psi': 0.9949821400742093}-{'f1_val': 0.9924932660920454, 'auprc': 0.9991242774544411, 'loss_val': 0.03710932977995118, 'psi': 0.9951456706370037}
[S9] START round=43 head_norm_before_train=2.077530 (no previous merge yet)
[S9] round=43 local utility u=0.000130 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9996102343131394, 'loss_val': 0.01903426433291185, 'psi': 0.9976067111634994}-{'f1_val': 0.9971029125121428, 'auprc': 0.9974533480242986, 'loss_val': 0.01781429059136825, 'psi': 0.9972430867170051}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=43 head_norm_before_train=2.224913 (no previous merge yet)
[S10] round=43 local utility u=0.000000 metrics={'f1_val': 0.992994663041229, 'auprc': 0.99607018144881, 'loss_val': 0.03598693757834518, 'psi': 0.9942248704042613}-{'f1_val': 0.992994663041229, 'auprc': 0.9970177869574623, 'loss_val': 0.036345434674482216, 'psi': 0.9946039126077224}
[S11] START round=43 head_norm_before_train=1.943961 cos_to_last_merge=0.7769 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.777
[S11] round=43 local utility u=0.000454 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9989326619248299, 'loss_val': 0.022866935959178804, 'psi': 0.9975158136372066}-{'f1_val': 0.9961336749133093, 'auprc': 0.9988751580289241, 'loss_val': 0.020977004345138946, 'psi': 0.9972302681595553}
[S13] START round=43 head_norm_before_train=1.913350 (no previous merge yet)
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.5946365012268812, 'auprc': 0.6704500455638904, 'loss_val': 1.2764327250420826, 'psi': 0.6249619189616848}-{'f1_val': 0.7227343307043474, 'auprc': 0.7468328671049421, 'loss_val': 0.8361302324534632, 'psi': 0.7323737452645853}
[S14] START round=43 head_norm_before_train=1.721396 cos_to_last_merge=1.0000 (last merge round=41)
[S14] round=43 local utility u=0.207780 metrics={'f1_val': 0.9965344645149313, 'auprc': 0.9968312944891182, 'loss_val': 0.03203380452697055, 'psi': 0.9966531965046062}-{'f1_val': 0.9378492043471004, 'auprc': 0.9988211687438684, 'loss_val': 0.10145145080107369, 'psi': 0.9622379901058076}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] START round=43 head_norm_before_train=1.546153 cos_to_last_merge=0.9985 (last merge round=40)
[S15] round=43 local utility u=0.644032 metrics={'f1_val': 0.9323192509628014, 'auprc': 0.9971406943335795, 'loss_val': 0.11743716944140012, 'psi': 0.9582478283111127}-{'f1_val': 0.7680112771965788, 'auprc': 0.992233374695888, 'loss_val': 0.4049308383125278, 'psi': 0.8577001161963025}
[S16] START round=43 head_norm_before_train=1.757143 cos_to_last_merge=0.9920 (last merge round=35)
[S16] round=43 local utility u=0.000000 metrics={'f1_val': 0.8304389387042924, 'auprc': 0.9291507237081705, 'loss_val': 1.0458798612447444, 'psi': 0.8699236527058436}-{'f1_val': 0.9915293093038144, 'auprc': 0.9896811611449355, 'loss_val': 0.057613862259608226, 'psi': 0.9907900500402629}
[S17] START round=43 head_norm_before_train=2.144934 (no previous merge yet)
[S17] round=43 local utility u=0.038074 metrics={'f1_val': 0.914217838756722, 'auprc': 0.9965884738017816, 'loss_val': 0.20414357000893235, 'psi': 0.9471660927747458}-{'f1_val': 0.9088957438252224, 'auprc': 0.9913419174395909, 'loss_val': 0.23261911106090766, 'psi': 0.9418742132709699}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:49304
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:49305
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:49315
[S15] sending update (kind=head size=1801 to 1 peers)
[S8] not sending this round → trigger blocked (psi=0.995)
[S11] sending update (kind=head size=1802 to 1 peers)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=43 metric=0.6685 head_norm=1.958636
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.150520e-02
[S6] stored merged vector for next round verification (round=43)
[S6] DEBUG after merge:  round=43 metric=0.6699 head_norm=1.949937 delta_norm=0.041505
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:49308
[S4] RECEIVED delta(kind=head bytes=1802) from S11
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.951436)
[S4] loaded HEAD from S11 (vec_in norm=1.951436)
[S4] cosine check vs S11: cos=-0.0910
[S4] DROPPED delta from S11 (cos=-0.0910 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1801) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.581867)
[S5] loaded HEAD from S15 (vec_in norm=1.581867)
[S5] cosine check vs S15: cos=0.9971
[S5] BUFFERED delta from S15 (total buffered=1)
[S5] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1796) from S3
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.811955)
[S7] loaded HEAD from S3 (vec_in norm=1.811955)
[S7] cosine check vs S3: cos=0.9999
[S7] BUFFERED delta from S3 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1798) from S5
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.514513)
[S15] loaded HEAD from S5 (vec_in norm=1.514513)
[S15] cosine check vs S5: cos=0.9971
[S15] BUFFERED delta from S5 (total buffered=1)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=43 metric=0.7375 head_norm=1.514513
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.797876e-02
[S5] stored merged vector for next round verification (round=43)
[S5] DEBUG after merge:  round=43 metric=0.9336 head_norm=1.547063 delta_norm=0.067979
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=44 head_norm_before_train=1.882408 cos_to_last_merge=0.9747 (last merge round=28)
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.8159091605329017, 'auprc': 0.8191242219772523, 'loss_val': 0.4124143479071263, 'psi': 0.817195185110642}-{'f1_val': 0.8275249358345539, 'auprc': 0.8798211232595116, 'loss_val': 0.36436966756483974, 'psi': 0.8484434108045369}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=44 head_norm_before_train=1.811955 cos_to_last_merge=1.0000 (last merge round=42)
[S3] round=44 local utility u=0.134961 metrics={'f1_val': 0.9978100342676263, 'auprc': 0.9998175741830693, 'loss_val': 0.02704294359674723, 'psi': 0.9986130502338035}-{'f1_val': 0.9615385219550141, 'auprc': 0.9996546943119597, 'loss_val': 0.07884650548443901, 'psi': 0.9767849908977924}
[S4] START round=44 head_norm_before_train=2.181446 (no previous merge yet)
[S4] round=44 local utility u=0.050839 metrics={'f1_val': 0.9380642139496799, 'auprc': 0.9805189212309343, 'loss_val': 0.1361005950882392, 'psi': 0.9550460968621817}-{'f1_val': 0.9329071540474803, 'auprc': 0.9813549068829077, 'loss_val': 0.20934406951389506, 'psi': 0.9522862551816512}
[S5] START round=44 head_norm_before_train=1.547063 cos_to_last_merge=1.0000 (last merge round=43)
[S5] round=44 local utility u=0.000000 metrics={'f1_val': 0.6433188420699356, 'auprc': 0.7391835033208372, 'loss_val': 0.5515258915444471, 'psi': 0.6816647065702962}-{'f1_val': 0.7375101617749037, 'auprc': 0.9976982103305725, 'loss_val': 0.16118801223695936, 'psi': 0.8415853811971712}
[S6] START round=44 head_norm_before_train=1.949937 cos_to_last_merge=1.0000 (last merge round=43)
[S6] round=44 local utility u=0.819471 metrics={'f1_val': 0.857032714190294, 'auprc': 0.9553208764615548, 'loss_val': 0.3225472818191011, 'psi': 0.8963479790987983}-{'f1_val': 0.6685040993920133, 'auprc': 0.9075497898721383, 'loss_val': 0.6870044320909963, 'psi': 0.7641223755840634}
[S7] START round=44 head_norm_before_train=1.797488 cos_to_last_merge=1.0000 (last merge round=42)
[S7] round=44 local utility u=0.301937 metrics={'f1_val': 0.6266563117406733, 'auprc': 0.7968097008338734, 'loss_val': 0.5579602447302826, 'psi': 0.6947176673779534}-{'f1_val': 0.5697030762564507, 'auprc': 0.7852803003204717, 'loss_val': 0.7855267652328115, 'psi': 0.6559339658820591}
[S8] START round=44 head_norm_before_train=1.952703 cos_to_last_merge=0.9997 (last merge round=39)
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.9915827617983686, 'auprc': 0.9992441975472481, 'loss_val': 0.03609906477016093, 'psi': 0.9946473360979204}-{'f1_val': 0.9920973070316986, 'auprc': 0.9993093896379753, 'loss_val': 0.03389763485916855, 'psi': 0.9949821400742093}
[S9] START round=44 head_norm_before_train=2.085473 (no previous merge yet)
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.9947734239942433, 'auprc': 0.9997967337722715, 'loss_val': 0.02056750540103667, 'psi': 0.9967827479054546}-{'f1_val': 0.9962710290637395, 'auprc': 0.9996102343131394, 'loss_val': 0.01903426433291185, 'psi': 0.9976067111634994}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=44 head_norm_before_train=2.234928 (no previous merge yet)
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.9927757495752743, 'auprc': 0.9966629022103818, 'loss_val': 0.03790310631263032, 'psi': 0.9943306106293173}-{'f1_val': 0.992994663041229, 'auprc': 0.99607018144881, 'loss_val': 0.03598693757834518, 'psi': 0.9942248704042613}
[S11] START round=44 head_norm_before_train=1.951436 cos_to_last_merge=0.7762 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.776
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9989554377743567, 'loss_val': 0.024281063335316096, 'psi': 0.9975249239770174}-{'f1_val': 0.9965712481121245, 'auprc': 0.9989326619248299, 'loss_val': 0.022866935959178804, 'psi': 0.9975158136372066}
[S13] START round=44 head_norm_before_train=1.922934 (no previous merge yet)
[S13] round=44 local utility u=0.484571 metrics={'f1_val': 0.629101691007456, 'auprc': 0.7879065077791185, 'loss_val': 0.866450905985045, 'psi': 0.6926236177161211}-{'f1_val': 0.5946365012268812, 'auprc': 0.6704500455638904, 'loss_val': 1.2764327250420826, 'psi': 0.6249619189616848}
[S14] START round=44 head_norm_before_train=1.733312 cos_to_last_merge=0.9999 (last merge round=41)
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.9971907882668205, 'auprc': 0.9948084536120042, 'loss_val': 0.03081834027268307, 'psi': 0.996237854404894}-{'f1_val': 0.9965344645149313, 'auprc': 0.9968312944891182, 'loss_val': 0.03203380452697055, 'psi': 0.9966531965046062}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=44 head_norm_before_train=1.581867 cos_to_last_merge=0.9973 (last merge round=40)
[S15] round=44 local utility u=0.230424 metrics={'f1_val': 0.9963324108488076, 'auprc': 0.9960852255878497, 'loss_val': 0.03750230661698062, 'psi': 0.9962335367444244}-{'f1_val': 0.9323192509628014, 'auprc': 0.9971406943335795, 'loss_val': 0.11743716944140012, 'psi': 0.9582478283111127}
[S16] START round=44 head_norm_before_train=1.770002 cos_to_last_merge=0.9912 (last merge round=35)
[S16] round=44 local utility u=1.000000 metrics={'f1_val': 0.9864506557306729, 'auprc': 0.992591463066846, 'loss_val': 0.08283567446827299, 'psi': 0.9889069786651421}-{'f1_val': 0.8304389387042924, 'auprc': 0.9291507237081705, 'loss_val': 1.0458798612447444, 'psi': 0.8699236527058436}
[S17] START round=44 head_norm_before_train=2.151163 (no previous merge yet)
[S17] round=44 local utility u=0.000000 metrics={'f1_val': 0.6897932761124019, 'auprc': 0.8858436982688744, 'loss_val': 1.1389054338736513, 'psi': 0.7682134449749909}-{'f1_val': 0.914217838756722, 'auprc': 0.9965884738017816, 'loss_val': 0.20414357000893235, 'psi': 0.9471660927747458}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:49314
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.996)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:49312
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:49311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:49303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:49309
[S7] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1804 to 1 peers)
[S3] not sending this round → trigger blocked (psi=0.999)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=44 metric=0.9963 head_norm=1.612620
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.605319e-02
[S15] stored merged vector for next round verification (round=44)
[S15] DEBUG after merge:  round=44 metric=0.9963 head_norm=1.561967 delta_norm=0.086053
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] sending update (kind=head size=1801 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1801) from S16
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.780544)
[S14] loaded HEAD from S16 (vec_in norm=1.780544)
[S14] cosine check vs S16: cos=0.9964
[S14] BUFFERED delta from S16 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1797) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=2.182222)
[S11] loaded HEAD from S4 (vec_in norm=2.182222)
[S11] cosine check vs S4: cos=-0.0912
[S11] DROPPED delta from S4 (cos=-0.0912 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1799) from S13
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.928931)
[S10] loaded HEAD from S13 (vec_in norm=1.928931)
[S10] cosine check vs S13: cos=-0.0933
[S10] DROPPED delta from S13 (cos=-0.0933 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1804) from S6
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.963902)
[S8] loaded HEAD from S6 (vec_in norm=1.963902)
[S8] cosine check vs S6: cos=0.9993
[S8] BUFFERED delta from S6 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1796) from S7
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.803619)
[S3] loaded HEAD from S7 (vec_in norm=1.803619)
[S3] cosine check vs S7: cos=0.9997
[S3] BUFFERED delta from S7 (total buffered=1)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=44 metric=0.6267 head_norm=1.803619
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.531234e-02
[S7] stored merged vector for next round verification (round=44)
[S7] DEBUG after merge:  round=44 metric=0.6286 head_norm=1.807727 delta_norm=0.015312
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=44 metric=0.9978 head_norm=1.825011
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.387849e-02
[S3] stored merged vector for next round verification (round=44)
[S3] DEBUG after merge:  round=44 metric=0.9978 head_norm=1.814189 delta_norm=0.023878
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=44 metric=0.9916 head_norm=1.958014
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.553563e-02
[S8] stored merged vector for next round verification (round=44)
[S8] DEBUG after merge:  round=44 metric=0.9916 head_norm=1.960638 delta_norm=0.035536
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=45 head_norm_before_train=1.892888 cos_to_last_merge=0.9738 (last merge round=28)
[S2] round=45 local utility u=0.147529 metrics={'f1_val': 0.8299529901236362, 'auprc': 0.8751417015959014, 'loss_val': 0.36967139736668897, 'psi': 0.8480284747125423}-{'f1_val': 0.8159091605329017, 'auprc': 0.8191242219772523, 'loss_val': 0.4124143479071263, 'psi': 0.817195185110642}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=45 head_norm_before_train=1.814189 cos_to_last_merge=1.0000 (last merge round=44)
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.9369653140244693, 'auprc': 0.9997894064331309, 'loss_val': 0.15604352611849265, 'psi': 0.9620949509879339}-{'f1_val': 0.9978100342676263, 'auprc': 0.9998175741830693, 'loss_val': 0.02704294359674723, 'psi': 0.9986130502338035}
[S4] START round=45 head_norm_before_train=2.182222 (no previous merge yet)
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.9253292486085318, 'auprc': 0.9760308249501213, 'loss_val': 0.19520460910334905, 'psi': 0.9456098791451677}-{'f1_val': 0.9380642139496799, 'auprc': 0.9805189212309343, 'loss_val': 0.1361005950882392, 'psi': 0.9550460968621817}
[S5] START round=45 head_norm_before_train=1.556727 cos_to_last_merge=1.0000 (last merge round=43)
[S5] round=45 local utility u=1.000000 metrics={'f1_val': 0.8554700743030952, 'auprc': 0.9957878783192898, 'loss_val': 0.15820025490209494, 'psi': 0.911597195909573}-{'f1_val': 0.6433188420699356, 'auprc': 0.7391835033208372, 'loss_val': 0.5515258915444471, 'psi': 0.6816647065702962}
[S6] START round=45 head_norm_before_train=1.963902 cos_to_last_merge=0.9999 (last merge round=43)
[S6] round=45 local utility u=0.000000 metrics={'f1_val': 0.6119960044923548, 'auprc': 0.9106062397939133, 'loss_val': 0.7593126938920837, 'psi': 0.7314400986129782}-{'f1_val': 0.857032714190294, 'auprc': 0.9553208764615548, 'loss_val': 0.3225472818191011, 'psi': 0.8963479790987983}
[S7] START round=45 head_norm_before_train=1.807727 cos_to_last_merge=1.0000 (last merge round=44)
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.5933467091258238, 'auprc': 0.7903113085193205, 'loss_val': 0.6916934923387201, 'psi': 0.6721325488832225}-{'f1_val': 0.6266563117406733, 'auprc': 0.7968097008338734, 'loss_val': 0.5579602447302826, 'psi': 0.6947176673779534}
[S8] START round=45 head_norm_before_train=1.960638 cos_to_last_merge=1.0000 (last merge round=44)
[S8] round=45 local utility u=0.011224 metrics={'f1_val': 0.9945651807947898, 'auprc': 0.9992034916383409, 'loss_val': 0.03142357103665116, 'psi': 0.9964205051322101}-{'f1_val': 0.9915827617983686, 'auprc': 0.9992441975472481, 'loss_val': 0.03609906477016093, 'psi': 0.9946473360979204}
[S9] START round=45 head_norm_before_train=2.090707 (no previous merge yet)
[S9] round=45 local utility u=0.002913 metrics={'f1_val': 0.9956054446615002, 'auprc': 0.9997603569579403, 'loss_val': 0.019624840424443343, 'psi': 0.9972674095800762}-{'f1_val': 0.9947734239942433, 'auprc': 0.9997967337722715, 'loss_val': 0.02056750540103667, 'psi': 0.9967827479054546}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=45 head_norm_before_train=2.244992 (no previous merge yet)
[S10] round=45 local utility u=0.000076 metrics={'f1_val': 0.9927757495752743, 'auprc': 0.996824046719394, 'loss_val': 0.03823495901398787, 'psi': 0.9943950684329221}-{'f1_val': 0.9927757495752743, 'auprc': 0.9966629022103818, 'loss_val': 0.03790310631263032, 'psi': 0.9943306106293173}
[S11] START round=45 head_norm_before_train=1.960301 cos_to_last_merge=0.7753 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.775
[S11] round=45 local utility u=0.001903 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9989107739581973, 'loss_val': 0.020340861865655202, 'psi': 0.9975070584505537}-{'f1_val': 0.9965712481121245, 'auprc': 0.9989554377743567, 'loss_val': 0.024281063335316096, 'psi': 0.9975249239770174}
[S13] START round=45 head_norm_before_train=1.928931 (no previous merge yet)
[S13] round=45 local utility u=0.000000 metrics={'f1_val': 0.6099570771491797, 'auprc': 0.6658656829905333, 'loss_val': 1.2819833174564585, 'psi': 0.6323205194857211}-{'f1_val': 0.629101691007456, 'auprc': 0.7879065077791185, 'loss_val': 0.866450905985045, 'psi': 0.6926236177161211}
[S14] START round=45 head_norm_before_train=1.746745 cos_to_last_merge=0.9998 (last merge round=41)
[S14] round=45 local utility u=0.008415 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9987868545737315, 'loss_val': 0.02622081232923487, 'psi': 0.9978589558529685}-{'f1_val': 0.9971907882668205, 'auprc': 0.9948084536120042, 'loss_val': 0.03081834027268307, 'psi': 0.996237854404894}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=45 metric=0.9972 head_norm=1.761051
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.932470e-02
[S14] stored merged vector for next round verification (round=45)
[S14] DEBUG after merge:  round=45 metric=0.9972 head_norm=1.769047 delta_norm=0.079325
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S15] START round=45 head_norm_before_train=1.561967 cos_to_last_merge=1.0000 (last merge round=44)
[S15] round=45 local utility u=0.000000 metrics={'f1_val': 0.7009202876340006, 'auprc': 0.9930185140462829, 'loss_val': 0.5297623043949945, 'psi': 0.8177595781989135}-{'f1_val': 0.9963324108488076, 'auprc': 0.9960852255878497, 'loss_val': 0.03750230661698062, 'psi': 0.9962335367444244}
[S16] START round=45 head_norm_before_train=1.780544 cos_to_last_merge=0.9905 (last merge round=35)
[S16] round=45 local utility u=0.032275 metrics={'f1_val': 0.9932513258991602, 'auprc': 0.9886121114000219, 'loss_val': 0.04715187625946501, 'psi': 0.991395640099505}-{'f1_val': 0.9864506557306729, 'auprc': 0.992591463066846, 'loss_val': 0.08283567446827299, 'psi': 0.9889069786651421}
[S17] START round=45 head_norm_before_train=2.160791 (no previous merge yet)
[S17] round=45 local utility u=1.000000 metrics={'f1_val': 0.935793440137634, 'auprc': 0.9155623859141059, 'loss_val': 0.3480584784730595, 'psi': 0.9277010184482227}-{'f1_val': 0.6897932761124019, 'auprc': 0.8858436982688744, 'loss_val': 1.1389054338736513, 'psi': 0.7682134449749909}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:49314
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] → sending delta(kind=head bytes=1793) to S13@127.0.0.1:49313
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:49304
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S8] → sending delta(kind=head bytes=1807) to S6@127.0.0.1:49307
[S11] sending update (kind=head size=1800 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1793 to 1 peers)
[S6] ⇄ pheromone p=0.201 → S8@127.0.0.1:49309
[S4] ⇄ pheromone p=0.018 → S11@127.0.0.1:49312
[S15] ⇄ pheromone p=0.218 → S5@127.0.0.1:49305
[S13] ⇄ pheromone p=0.135 → S10@127.0.0.1:49311
[S16] sending update (kind=head size=1804 to 1 peers)
[S7] ⇄ pheromone p=0.202 → S3@127.0.0.1:49303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:49315
[S13] RECEIVED delta(kind=head bytes=1793) from S10
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=2.252199)
[S13] loaded HEAD from S10 (vec_in norm=2.252199)
[S13] cosine check vs S10: cos=-0.0933
[S13] DROPPED delta from S10 (cos=-0.0933 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1800) from S11
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.969893)
[S4] loaded HEAD from S11 (vec_in norm=1.969893)
[S4] cosine check vs S11: cos=-0.0910
[S4] DROPPED delta from S11 (cos=-0.0910 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1804) from S16
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.790967)
[S14] loaded HEAD from S16 (vec_in norm=1.790967)
[S14] cosine check vs S16: cos=0.9988
[S14] BUFFERED delta from S16 (total buffered=1)
[S16] ⇄ pheromone p=0.224 → S14@127.0.0.1:49314
[S5] sending update (kind=head size=1804 to 1 peers)
[S10] ⇄ pheromone p=0.000 → S13@127.0.0.1:49313
[S8] sending update (kind=head size=1807 to 1 peers)
[S11] ⇄ pheromone p=0.002 → S4@127.0.0.1:49304
[S15] RECEIVED delta(kind=head bytes=1804) from S5
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.563666)
[S15] loaded HEAD from S5 (vec_in norm=1.563666)
[S15] cosine check vs S5: cos=0.9997
[S15] BUFFERED delta from S5 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1807) from S8
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.970040)
[S6] loaded HEAD from S8 (vec_in norm=1.970040)
[S6] cosine check vs S8: cos=0.9995
[S6] BUFFERED delta from S8 (total buffered=1)
[S3] ⇄ pheromone p=0.072 → S7@127.0.0.1:49308
[S8] ⇄ pheromone p=0.007 → S6@127.0.0.1:49307
[S5] ⇄ pheromone p=0.380 → S15@127.0.0.1:49315
[S2] START round=46 head_norm_before_train=1.901418 cos_to_last_merge=0.9732 (last merge round=28)
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.7172255425592047, 'auprc': 0.8582861182665839, 'loss_val': 0.5874201758232351, 'psi': 0.7736497728421563}-{'f1_val': 0.8299529901236362, 'auprc': 0.8751417015959014, 'loss_val': 0.36967139736668897, 'psi': 0.8480284747125423}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=46 head_norm_before_train=1.827495 cos_to_last_merge=1.0000 (last merge round=44)
[S3] round=46 local utility u=0.224504 metrics={'f1_val': 0.9919952467380473, 'auprc': 0.9997984565775395, 'loss_val': 0.037242012899673736, 'psi': 0.9951165306738441}-{'f1_val': 0.9369653140244693, 'auprc': 0.9997894064331309, 'loss_val': 0.15604352611849265, 'psi': 0.9620949509879339}
[S4] START round=46 head_norm_before_train=2.186238 (no previous merge yet)
[S4] round=46 local utility u=0.037094 metrics={'f1_val': 0.9271947364450572, 'auprc': 0.9865046530696546, 'loss_val': 0.16363041436043044, 'psi': 0.9509187030948962}-{'f1_val': 0.9253292486085318, 'auprc': 0.9760308249501213, 'loss_val': 0.19520460910334905, 'psi': 0.9456098791451677}
[S5] START round=46 head_norm_before_train=1.563666 cos_to_last_merge=0.9999 (last merge round=43)
[S5] round=46 local utility u=0.000000 metrics={'f1_val': 0.5804047724952044, 'auprc': 0.742514398503573, 'loss_val': 0.7413376200719857, 'psi': 0.6452486228985519}-{'f1_val': 0.8554700743030952, 'auprc': 0.9957878783192898, 'loss_val': 0.15820025490209494, 'psi': 0.911597195909573}
[S6] START round=46 head_norm_before_train=1.981055 cos_to_last_merge=0.9997 (last merge round=43)
[S6] round=46 local utility u=0.913619 metrics={'f1_val': 0.8640949872853585, 'auprc': 0.9018991847367417, 'loss_val': 0.4185469052699987, 'psi': 0.8792166662659118}-{'f1_val': 0.6119960044923548, 'auprc': 0.9106062397939133, 'loss_val': 0.7593126938920837, 'psi': 0.7314400986129782}
[S7] START round=46 head_norm_before_train=1.814192 cos_to_last_merge=1.0000 (last merge round=44)
[S7] round=46 local utility u=0.000000 metrics={'f1_val': 0.5951585686198297, 'auprc': 0.7920530031622027, 'loss_val': 0.7099673814551924, 'psi': 0.6739163424367789}-{'f1_val': 0.5933467091258238, 'auprc': 0.7903113085193205, 'loss_val': 0.6916934923387201, 'psi': 0.6721325488832225}
[S8] START round=46 head_norm_before_train=1.970040 cos_to_last_merge=1.0000 (last merge round=44)
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.9938326055531397, 'auprc': 0.9993466445363048, 'loss_val': 0.030594430260150615, 'psi': 0.9960382211464058}-{'f1_val': 0.9945651807947898, 'auprc': 0.9992034916383409, 'loss_val': 0.03142357103665116, 'psi': 0.9964205051322101}
[S9] START round=46 head_norm_before_train=2.097352 (no previous merge yet)
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9955868377466299, 'loss_val': 0.017750891065766043, 'psi': 0.9964964826059377}-{'f1_val': 0.9956054446615002, 'auprc': 0.9997603569579403, 'loss_val': 0.019624840424443343, 'psi': 0.9972674095800762}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=46 head_norm_before_train=2.252199 (no previous merge yet)
[S10] round=46 local utility u=0.001082 metrics={'f1_val': 0.9927757495752743, 'auprc': 0.9972864341608381, 'loss_val': 0.037458832659656674, 'psi': 0.9945800234094998}-{'f1_val': 0.9927757495752743, 'auprc': 0.996824046719394, 'loss_val': 0.03823495901398787, 'psi': 0.9943950684329221}
[S11] START round=46 head_norm_before_train=1.969893 cos_to_last_merge=0.7744 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.774
[S11] round=46 local utility u=0.000000 metrics={'f1_val': 0.9942288708308418, 'auprc': 0.9988817580830408, 'loss_val': 0.027676110206234027, 'psi': 0.9960900257317213}-{'f1_val': 0.9965712481121245, 'auprc': 0.9989107739581973, 'loss_val': 0.020340861865655202, 'psi': 0.9975070584505537}
[S13] START round=46 head_norm_before_train=1.933566 (no previous merge yet)
[S13] round=46 local utility u=0.736830 metrics={'f1_val': 0.7408977145401081, 'auprc': 0.7772932439177309, 'loss_val': 0.9282496443521523, 'psi': 0.7554559262911573}-{'f1_val': 0.6099570771491797, 'auprc': 0.6658656829905333, 'loss_val': 1.2819833174564585, 'psi': 0.6323205194857211}
[S14] START round=46 head_norm_before_train=1.769047 cos_to_last_merge=1.0000 (last merge round=45)
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.9972116069810506, 'auprc': 0.9979813793058129, 'loss_val': 0.03448703726042605, 'psi': 0.9975195159109554}-{'f1_val': 0.997240356705793, 'auprc': 0.9987868545737315, 'loss_val': 0.02622081232923487, 'psi': 0.9978589558529685}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=46 metric=0.9972 head_norm=1.783397
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.801011e-02
[S14] stored merged vector for next round verification (round=46)
[S14] DEBUG after merge:  round=46 metric=0.9968 head_norm=1.786541 delta_norm=0.048010
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S15] START round=46 head_norm_before_train=1.590707 cos_to_last_merge=0.9999 (last merge round=44)
[S15] round=46 local utility u=1.000000 metrics={'f1_val': 0.9962895101731264, 'auprc': 0.998274578721848, 'loss_val': 0.03661860792663665, 'psi': 0.997083537592615}-{'f1_val': 0.7009202876340006, 'auprc': 0.9930185140462829, 'loss_val': 0.5297623043949945, 'psi': 0.8177595781989135}
[S16] START round=46 head_norm_before_train=1.790967 cos_to_last_merge=0.9898 (last merge round=35)
[S16] round=46 local utility u=0.000000 metrics={'f1_val': 0.9126903450501149, 'auprc': 0.9909565085480897, 'loss_val': 0.21160809188385385, 'psi': 0.9439968104493048}-{'f1_val': 0.9932513258991602, 'auprc': 0.9886121114000219, 'loss_val': 0.04715187625946501, 'psi': 0.991395640099505}
[S17] START round=46 head_norm_before_train=2.170014 (no previous merge yet)
[S17] round=46 local utility u=0.000000 metrics={'f1_val': 0.8112734658435621, 'auprc': 0.897231075157199, 'loss_val': 0.6823893629495809, 'psi': 0.8456565095690168}-{'f1_val': 0.935793440137634, 'auprc': 0.9155623859141059, 'loss_val': 0.3480584784730595, 'psi': 0.9277010184482227}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:49311
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:49305
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.995)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S6] → sending delta(kind=head bytes=1806) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:49312
[S6] sending update (kind=head size=1806 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:49308
[S11] RECEIVED delta(kind=head bytes=1797) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=2.190041)
[S11] loaded HEAD from S4 (vec_in norm=2.190041)
[S11] cosine check vs S4: cos=-0.0910
[S11] DROPPED delta from S4 (cos=-0.0910 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1806) from S6
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=2.003446)
[S8] loaded HEAD from S6 (vec_in norm=2.003446)
[S8] cosine check vs S6: cos=0.9990
[S8] BUFFERED delta from S6 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1802) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.615485)
[S5] loaded HEAD from S15 (vec_in norm=1.615485)
[S5] cosine check vs S15: cos=0.9993
[S5] BUFFERED delta from S15 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1795) from S13
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.935884)
[S10] loaded HEAD from S13 (vec_in norm=1.935884)
[S10] cosine check vs S13: cos=-0.0935
[S10] DROPPED delta from S13 (cos=-0.0935 < 0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=46 metric=0.9963 head_norm=1.615485
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.907263e-02
[S15] stored merged vector for next round verification (round=46)
[S15] DEBUG after merge:  round=46 metric=0.9963 head_norm=1.589306 delta_norm=0.039073
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=46 metric=0.8641 head_norm=2.003446
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.501183e-02
[S6] stored merged vector for next round verification (round=46)
[S6] DEBUG after merge:  round=46 metric=0.8644 head_norm=1.986303 delta_norm=0.045012
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S3] sending update (kind=head size=1797 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1797) from S3
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.839508)
[S7] loaded HEAD from S3 (vec_in norm=1.839508)
[S7] cosine check vs S3: cos=0.9997
[S7] BUFFERED delta from S3 (total buffered=1)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=46 metric=0.9938 head_norm=1.979774
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.517844e-02
[S8] stored merged vector for next round verification (round=46)
[S8] DEBUG after merge:  round=46 metric=0.9938 head_norm=1.991133 delta_norm=0.045178
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=46 metric=0.5804 head_norm=1.570117
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.775730e-02
[S5] stored merged vector for next round verification (round=46)
[S5] DEBUG after merge:  round=46 metric=0.5807 head_norm=1.592515 delta_norm=0.037757
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=47 head_norm_before_train=1.913255 cos_to_last_merge=0.9722 (last merge round=28)
[S2] round=47 local utility u=0.206272 metrics={'f1_val': 0.7980872362427291, 'auprc': 0.8354810406472557, 'loss_val': 0.5916307862751466, 'psi': 0.8130447580045397}-{'f1_val': 0.7172255425592047, 'auprc': 0.8582861182665839, 'loss_val': 0.5874201758232351, 'psi': 0.7736497728421563}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] sending update (kind=head size=1794 to 1 peers)
[S3] START round=47 head_norm_before_train=1.839508 cos_to_last_merge=0.9999 (last merge round=44)
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.9391118481215419, 'auprc': 0.9987318454369076, 'loss_val': 0.14536053200386834, 'psi': 0.9629598470476882}-{'f1_val': 0.9919952467380473, 'auprc': 0.9997984565775395, 'loss_val': 0.037242012899673736, 'psi': 0.9951165306738441}
[S4] START round=47 head_norm_before_train=2.190041 (no previous merge yet)
[S4] round=47 local utility u=0.082614 metrics={'f1_val': 0.9524261432699395, 'auprc': 0.9808391325686292, 'loss_val': 0.1327952573909641, 'psi': 0.9637913389894153}-{'f1_val': 0.9271947364450572, 'auprc': 0.9865046530696546, 'loss_val': 0.16363041436043044, 'psi': 0.9509187030948962}
[S5] START round=47 head_norm_before_train=1.592515 cos_to_last_merge=1.0000 (last merge round=46)
[S5] round=47 local utility u=1.000000 metrics={'f1_val': 0.7110780217914221, 'auprc': 0.9829683983982274, 'loss_val': 0.23823715317052394, 'psi': 0.8198341724341442}-{'f1_val': 0.5804047724952044, 'auprc': 0.742514398503573, 'loss_val': 0.7413376200719857, 'psi': 0.6452486228985519}
[S6] START round=47 head_norm_before_train=1.986303 cos_to_last_merge=1.0000 (last merge round=46)
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.6614796222735497, 'auprc': 0.9180524367086988, 'loss_val': 0.7475020951637581, 'psi': 0.7641087480476094}-{'f1_val': 0.8640949872853585, 'auprc': 0.9018991847367417, 'loss_val': 0.4185469052699987, 'psi': 0.8792166662659118}
[S7] START round=47 head_norm_before_train=1.822034 cos_to_last_merge=0.9999 (last merge round=44)
[S7] round=47 local utility u=0.325660 metrics={'f1_val': 0.658494494116267, 'auprc': 0.8062684073734411, 'loss_val': 0.4813099476981091, 'psi': 0.7176040594191366}-{'f1_val': 0.5951585686198297, 'auprc': 0.7920530031622027, 'loss_val': 0.7099673814551924, 'psi': 0.6739163424367789}
[S8] START round=47 head_norm_before_train=1.991133 cos_to_last_merge=1.0000 (last merge round=46)
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.9920973070316986, 'auprc': 0.9993476127821274, 'loss_val': 0.037005431414636296, 'psi': 0.9949974293318701}-{'f1_val': 0.9938326055531397, 'auprc': 0.9993466445363048, 'loss_val': 0.030594430260150615, 'psi': 0.9960382211464058}
[S9] START round=47 head_norm_before_train=2.105084 (no previous merge yet)
[S9] round=47 local utility u=0.005312 metrics={'f1_val': 0.9966891482978385, 'auprc': 0.9996863765005586, 'loss_val': 0.01694251918061415, 'psi': 0.9978880395789266}-{'f1_val': 0.9971029125121428, 'auprc': 0.9955868377466299, 'loss_val': 0.017750891065766043, 'psi': 0.9964964826059377}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=47 head_norm_before_train=2.254442 (no previous merge yet)
[S10] round=47 local utility u=0.000617 metrics={'f1_val': 0.992994663041229, 'auprc': 0.9970596280385211, 'loss_val': 0.03685854414815029, 'psi': 0.9946206490401459}-{'f1_val': 0.9927757495752743, 'auprc': 0.9972864341608381, 'loss_val': 0.037458832659656674, 'psi': 0.9945800234094998}
[S11] START round=47 head_norm_before_train=1.978275 cos_to_last_merge=0.7737 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.774
[S11] round=47 local utility u=0.009321 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9987643086114673, 'loss_val': 0.020109892314230403, 'psi': 0.9971859283925725}-{'f1_val': 0.9942288708308418, 'auprc': 0.9988817580830408, 'loss_val': 0.027676110206234027, 'psi': 0.9960900257317213}
[S13] START round=47 head_norm_before_train=1.935884 (no previous merge yet)
[S13] round=47 local utility u=0.000000 metrics={'f1_val': 0.7263217286621348, 'auprc': 0.7815201835296592, 'loss_val': 0.9415061455774039, 'psi': 0.7484011106091446}-{'f1_val': 0.7408977145401081, 'auprc': 0.7772932439177309, 'loss_val': 0.9282496443521523, 'psi': 0.7554559262911573}
[S14] START round=47 head_norm_before_train=1.786541 cos_to_last_merge=1.0000 (last merge round=46)
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.9793432698777085, 'auprc': 0.9967245781176133, 'loss_val': 0.051778628274050165, 'psi': 0.9862957931736704}-{'f1_val': 0.9972116069810506, 'auprc': 0.9979813793058129, 'loss_val': 0.03448703726042605, 'psi': 0.9975195159109554}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=47 head_norm_before_train=1.589306 cos_to_last_merge=1.0000 (last merge round=46)
[S15] round=47 local utility u=0.000000 metrics={'f1_val': 0.8956455365161755, 'auprc': 0.9954244689086689, 'loss_val': 0.16953134083737967, 'psi': 0.9355571094731728}-{'f1_val': 0.9962895101731264, 'auprc': 0.998274578721848, 'loss_val': 0.03661860792663665, 'psi': 0.997083537592615}
[S16] START round=47 head_norm_before_train=1.801043 cos_to_last_merge=0.9891 (last merge round=35)
[S16] round=47 local utility u=0.318250 metrics={'f1_val': 0.9918696778245835, 'auprc': 0.9910418189933959, 'loss_val': 0.05044038457933429, 'psi': 0.9915385342921084}-{'f1_val': 0.9126903450501149, 'auprc': 0.9909565085480897, 'loss_val': 0.21160809188385385, 'psi': 0.9439968104493048}
[S17] START round=47 head_norm_before_train=2.181499 (no previous merge yet)
[S17] round=47 local utility u=0.767550 metrics={'f1_val': 0.9301492571936536, 'auprc': 0.9970453498581615, 'loss_val': 0.1599864613775227, 'psi': 0.9569076942594568}-{'f1_val': 0.8112734658435621, 'auprc': 0.897231075157199, 'loss_val': 0.6823893629495809, 'psi': 0.8456565095690168}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:49314
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:49303
[S4] not sending this round → trigger blocked (psi=0.964)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S10] → sending delta(kind=head bytes=1791) to S13@127.0.0.1:49313
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:49304
[S10] sending update (kind=head size=1791 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:49315
[S4] RECEIVED delta(kind=head bytes=1799) from S11
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.985636)
[S4] loaded HEAD from S11 (vec_in norm=1.985636)
[S4] cosine check vs S11: cos=-0.0909
[S4] DROPPED delta from S11 (cos=-0.0909 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1796) from S7
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.829511)
[S3] loaded HEAD from S7 (vec_in norm=1.829511)
[S3] cosine check vs S7: cos=0.9995
[S3] BUFFERED delta from S7 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1802) from S16
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.809857)
[S14] loaded HEAD from S16 (vec_in norm=1.809857)
[S14] cosine check vs S16: cos=0.9993
[S14] BUFFERED delta from S16 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1791) from S10
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=2.258508)
[S13] loaded HEAD from S10 (vec_in norm=2.258508)
[S13] cosine check vs S10: cos=-0.0940
[S13] DROPPED delta from S10 (cos=-0.0940 < 0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=47 metric=0.6585 head_norm=1.829511
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.396107e-02
[S7] stored merged vector for next round verification (round=47)
[S7] DEBUG after merge:  round=47 metric=0.6593 head_norm=1.834360 delta_norm=0.023961
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S5] sending update (kind=head size=1798 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1798) from S5
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.597185)
[S15] loaded HEAD from S5 (vec_in norm=1.597185)
[S15] cosine check vs S5: cos=0.9999
[S15] BUFFERED delta from S5 (total buffered=1)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=47 metric=0.9391 head_norm=1.849358
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.016446e-02
[S3] stored merged vector for next round verification (round=47)
[S3] DEBUG after merge:  round=47 metric=0.9403 head_norm=1.839214 delta_norm=0.030164
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=48 head_norm_before_train=1.921579 cos_to_last_merge=0.9714 (last merge round=28)
[S2] round=48 local utility u=0.200283 metrics={'f1_val': 0.8354038214533513, 'auprc': 0.8703505111624402, 'loss_val': 0.5195733246666565, 'psi': 0.849382497336987}-{'f1_val': 0.7980872362427291, 'auprc': 0.8354810406472557, 'loss_val': 0.5916307862751466, 'psi': 0.8130447580045397}
[S2] not sending this round → trigger blocked (psi=0.849)
[S3] START round=48 head_norm_before_train=1.839214 cos_to_last_merge=1.0000 (last merge round=47)
[S3] round=48 local utility u=0.049606 metrics={'f1_val': 0.9579681959211241, 'auprc': 0.9982000136059257, 'loss_val': 0.1576903422002071, 'psi': 0.9740609229950448}-{'f1_val': 0.9391118481215419, 'auprc': 0.9987318454369076, 'loss_val': 0.14536053200386834, 'psi': 0.9629598470476882}
[S4] START round=48 head_norm_before_train=2.197832 (no previous merge yet)
[S4] round=48 local utility u=0.000000 metrics={'f1_val': 0.9285970281582302, 'auprc': 0.9691042044988862, 'loss_val': 0.20716064292607095, 'psi': 0.9447998986944925}-{'f1_val': 0.9524261432699395, 'auprc': 0.9808391325686292, 'loss_val': 0.1327952573909641, 'psi': 0.9637913389894153}
[S5] START round=48 head_norm_before_train=1.597185 cos_to_last_merge=1.0000 (last merge round=46)
[S5] round=48 local utility u=0.890406 metrics={'f1_val': 0.9869780477554665, 'auprc': 0.9970447131246936, 'loss_val': 0.15505486374687805, 'psi': 0.9910047139031573}-{'f1_val': 0.7110780217914221, 'auprc': 0.9829683983982274, 'loss_val': 0.23823715317052394, 'psi': 0.8198341724341442}
[S6] START round=48 head_norm_before_train=2.007241 cos_to_last_merge=0.9999 (last merge round=46)
[S6] round=48 local utility u=0.931074 metrics={'f1_val': 0.8767563565737576, 'auprc': 0.9673143566685489, 'loss_val': 0.32479996024993846, 'psi': 0.9129795566116741}-{'f1_val': 0.6614796222735497, 'auprc': 0.9180524367086988, 'loss_val': 0.7475020951637581, 'psi': 0.7641087480476094}
[S7] START round=48 head_norm_before_train=1.834360 cos_to_last_merge=1.0000 (last merge round=47)
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.6588523247867005, 'auprc': 0.8048685259536388, 'loss_val': 0.48451316387445775, 'psi': 0.7172588052534759}-{'f1_val': 0.658494494116267, 'auprc': 0.8062684073734411, 'loss_val': 0.4813099476981091, 'psi': 0.7176040594191366}
[S8] START round=48 head_norm_before_train=2.001539 cos_to_last_merge=1.0000 (last merge round=46)
[S8] round=48 local utility u=0.006485 metrics={'f1_val': 0.9935879766866298, 'auprc': 0.9992810192678856, 'loss_val': 0.03277908150584835, 'psi': 0.9958651937191321}-{'f1_val': 0.9920973070316986, 'auprc': 0.9993476127821274, 'loss_val': 0.037005431414636296, 'psi': 0.9949974293318701}
[S9] START round=48 head_norm_before_train=2.113205 (no previous merge yet)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.9910040044536889, 'auprc': 0.9999276603138233, 'loss_val': 0.02798914645736403, 'psi': 0.9945734667977426}-{'f1_val': 0.9966891482978385, 'auprc': 0.9996863765005586, 'loss_val': 0.01694251918061415, 'psi': 0.9978880395789266}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=48 head_norm_before_train=2.258508 (no previous merge yet)
[S10] round=48 local utility u=0.000211 metrics={'f1_val': 0.992994663041229, 'auprc': 0.997171037088235, 'loss_val': 0.03677099050589985, 'psi': 0.9946652126600314}-{'f1_val': 0.992994663041229, 'auprc': 0.9970596280385211, 'loss_val': 0.03685854414815029, 'psi': 0.9946206490401459}
[S11] START round=48 head_norm_before_train=1.985636 cos_to_last_merge=0.7730 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.773
[S11] round=48 local utility u=0.001351 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.998789753529439, 'loss_val': 0.019987780863954294, 'psi': 0.997446454408834}-{'f1_val': 0.9961336749133093, 'auprc': 0.9987643086114673, 'loss_val': 0.020109892314230403, 'psi': 0.9971859283925725}
[S13] START round=48 head_norm_before_train=1.935625 (no previous merge yet)
[S13] round=48 local utility u=0.000000 metrics={'f1_val': 0.6138566221289332, 'auprc': 0.7139946293837707, 'loss_val': 1.1183556639357919, 'psi': 0.6539118250308682}-{'f1_val': 0.7263217286621348, 'auprc': 0.7815201835296592, 'loss_val': 0.9415061455774039, 'psi': 0.7484011106091446}
[S14] START round=48 head_norm_before_train=1.796994 cos_to_last_merge=1.0000 (last merge round=46)
[S14] round=48 local utility u=0.054721 metrics={'f1_val': 0.9943422431268973, 'auprc': 0.9989490574073482, 'loss_val': 0.039003124089540715, 'psi': 0.9961849688390776}-{'f1_val': 0.9793432698777085, 'auprc': 0.9967245781176133, 'loss_val': 0.051778628274050165, 'psi': 0.9862957931736704}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=48 metric=0.9943 head_norm=1.807145
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.839452e-02
[S14] stored merged vector for next round verification (round=48)
[S14] DEBUG after merge:  round=48 metric=0.9939 head_norm=1.808094 delta_norm=0.038395
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S15] START round=48 head_norm_before_train=1.613817 cos_to_last_merge=0.9999 (last merge round=46)
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.702122835660083, 'auprc': 0.9929819543083698, 'loss_val': 0.5390093501847177, 'psi': 0.8184664831193977}-{'f1_val': 0.8956455365161755, 'auprc': 0.9954244689086689, 'loss_val': 0.16953134083737967, 'psi': 0.9355571094731728}
[S16] START round=48 head_norm_before_train=1.809857 cos_to_last_merge=0.9886 (last merge round=35)
[S16] round=48 local utility u=0.000476 metrics={'f1_val': 0.9899286023683248, 'auprc': 0.996954004733001, 'loss_val': 0.055578048703124744, 'psi': 0.9927387633141953}-{'f1_val': 0.9918696778245835, 'auprc': 0.9910418189933959, 'loss_val': 0.05044038457933429, 'psi': 0.9915385342921084}
[S17] START round=48 head_norm_before_train=2.187637 (no previous merge yet)
[S17] round=48 local utility u=0.000000 metrics={'f1_val': 0.7967366971136581, 'auprc': 0.9963815572315446, 'loss_val': 0.42392631640945294, 'psi': 0.8765946411608128}-{'f1_val': 0.9301492571936536, 'auprc': 0.9970453498581615, 'loss_val': 0.1599864613775227, 'psi': 0.9569076942594568}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:49313
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:49314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:49304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:49309
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1805 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=48 metric=0.7021 head_norm=1.638978
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.922619e-02
[S15] stored merged vector for next round verification (round=48)
[S15] DEBUG after merge:  round=48 metric=0.7021 head_norm=1.617952 delta_norm=0.029226
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:49308
[S10] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:49307
[S8] RECEIVED delta(kind=head bytes=1805) from S6
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=2.026309)
[S8] loaded HEAD from S6 (vec_in norm=2.026309)
[S8] cosine check vs S6: cos=0.9997
[S8] BUFFERED delta from S6 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1794) from S11
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.993150)
[S4] loaded HEAD from S11 (vec_in norm=1.993150)
[S4] cosine check vs S11: cos=-0.0907
[S4] DROPPED delta from S11 (cos=-0.0907 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1804) from S16
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.819947)
[S14] loaded HEAD from S16 (vec_in norm=1.819947)
[S14] cosine check vs S16: cos=0.9997
[S14] BUFFERED delta from S16 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1795) from S10
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=2.262094)
[S13] loaded HEAD from S10 (vec_in norm=2.262094)
[S13] cosine check vs S10: cos=-0.0953
[S13] DROPPED delta from S10 (cos=-0.0953 < 0.0)
[S8] sending update (kind=head size=1805 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1805) from S8
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=2.012506)
[S6] loaded HEAD from S8 (vec_in norm=2.012506)
[S6] cosine check vs S8: cos=0.9997
[S6] BUFFERED delta from S8 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1800) from S5
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.602903)
[S15] loaded HEAD from S5 (vec_in norm=1.602903)
[S15] cosine check vs S5: cos=0.9999
[S15] BUFFERED delta from S5 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1795) from S3
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.848349)
[S7] loaded HEAD from S3 (vec_in norm=1.848349)
[S7] cosine check vs S3: cos=0.9999
[S7] BUFFERED delta from S3 (total buffered=1)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=48 metric=0.9936 head_norm=2.012506
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.723149e-02
[S8] stored merged vector for next round verification (round=48)
[S8] DEBUG after merge:  round=48 metric=0.9936 head_norm=2.019235 delta_norm=0.027231
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=49 head_norm_before_train=1.933871 cos_to_last_merge=0.9703 (last merge round=28)
[S2] round=49 local utility u=0.255390 metrics={'f1_val': 0.8304404331184194, 'auprc': 0.9880306274737712, 'loss_val': 0.3320541197877948, 'psi': 0.8934765108605601}-{'f1_val': 0.8354038214533513, 'auprc': 0.8703505111624402, 'loss_val': 0.5195733246666565, 'psi': 0.849382497336987}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=49 head_norm_before_train=1.848349 cos_to_last_merge=1.0000 (last merge round=47)
[S3] round=49 local utility u=0.149822 metrics={'f1_val': 0.9881856265962471, 'auprc': 0.9997009864847981, 'loss_val': 0.04385462605407887, 'psi': 0.9927917705516676}-{'f1_val': 0.9579681959211241, 'auprc': 0.9982000136059257, 'loss_val': 0.1576903422002071, 'psi': 0.9740609229950448}
[S4] START round=49 head_norm_before_train=2.208536 (no previous merge yet)
[S4] round=49 local utility u=0.008928 metrics={'f1_val': 0.9299171326505686, 'auprc': 0.97070532612966, 'loss_val': 0.2020291383229968, 'psi': 0.9462324100422052}-{'f1_val': 0.9285970281582302, 'auprc': 0.9691042044988862, 'loss_val': 0.20716064292607095, 'psi': 0.9447998986944925}
[S5] START round=49 head_norm_before_train=1.602903 cos_to_last_merge=0.9999 (last merge round=46)
[S5] round=49 local utility u=0.000000 metrics={'f1_val': 0.4438465565301329, 'auprc': 0.7798925811012799, 'loss_val': 0.9784496161194943, 'psi': 0.5782649663585917}-{'f1_val': 0.9869780477554665, 'auprc': 0.9970447131246936, 'loss_val': 0.15505486374687805, 'psi': 0.9910047139031573}
[S6] START round=49 head_norm_before_train=2.026309 cos_to_last_merge=0.9998 (last merge round=46)
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.6587778495580515, 'auprc': 0.911297020465931, 'loss_val': 0.8060974374289199, 'psi': 0.7597855179212033}-{'f1_val': 0.8767563565737576, 'auprc': 0.9673143566685489, 'loss_val': 0.32479996024993846, 'psi': 0.9129795566116741}
[S7] START round=49 head_norm_before_train=1.840204 cos_to_last_merge=1.0000 (last merge round=47)
[S7] round=49 local utility u=0.000000 metrics={'f1_val': 0.5718749183931926, 'auprc': 0.7849726768350744, 'loss_val': 0.7861820936297261, 'psi': 0.6571140217699454}-{'f1_val': 0.6588523247867005, 'auprc': 0.8048685259536388, 'loss_val': 0.48451316387445775, 'psi': 0.7172588052534759}
[S8] START round=49 head_norm_before_train=2.019235 cos_to_last_merge=1.0000 (last merge round=48)
[S8] round=49 local utility u=0.005249 metrics={'f1_val': 0.9945651807947898, 'auprc': 0.9993761688241982, 'loss_val': 0.02842989801787627, 'psi': 0.9964895760065531}-{'f1_val': 0.9935879766866298, 'auprc': 0.9992810192678856, 'loss_val': 0.03277908150584835, 'psi': 0.9958651937191321}
[S9] START round=49 head_norm_before_train=2.116741 (no previous merge yet)
[S9] round=49 local utility u=0.014649 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9952510328595371, 'loss_val': 0.018791409115837307, 'psi': 0.9961159079026721}-{'f1_val': 0.9910040044536889, 'auprc': 0.9999276603138233, 'loss_val': 0.02798914645736403, 'psi': 0.9945734667977426}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=49 head_norm_before_train=2.262094 (no previous merge yet)
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.9927757495752743, 'auprc': 0.9972475337964061, 'loss_val': 0.037433809081416136, 'psi': 0.9945644632637269}-{'f1_val': 0.992994663041229, 'auprc': 0.997171037088235, 'loss_val': 0.03677099050589985, 'psi': 0.9946652126600314}
[S11] START round=49 head_norm_before_train=1.993150 cos_to_last_merge=0.7722 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.772
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.9958483516692717, 'auprc': 0.9989941135044275, 'loss_val': 0.02862965995391568, 'psi': 0.997106656403334}-{'f1_val': 0.9965509216617638, 'auprc': 0.998789753529439, 'loss_val': 0.019987780863954294, 'psi': 0.997446454408834}
[S13] START round=49 head_norm_before_train=1.934685 (no previous merge yet)
[S13] round=49 local utility u=0.331226 metrics={'f1_val': 0.6392139118627946, 'auprc': 0.8026019192381573, 'loss_val': 0.8738699880665726, 'psi': 0.7045691148129396}-{'f1_val': 0.6138566221289332, 'auprc': 0.7139946293837707, 'loss_val': 1.1183556639357919, 'psi': 0.6539118250308682}
[S14] START round=49 head_norm_before_train=1.808094 cos_to_last_merge=1.0000 (last merge round=48)
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.9622344257187566, 'auprc': 0.9973676169180901, 'loss_val': 0.056222322546019575, 'psi': 0.9762877021984899}-{'f1_val': 0.9943422431268973, 'auprc': 0.9989490574073482, 'loss_val': 0.039003124089540715, 'psi': 0.9961849688390776}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=49 metric=0.9622 head_norm=1.821268
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.740764e-02
[S14] stored merged vector for next round verification (round=49)
[S14] DEBUG after merge:  round=49 metric=0.9604 head_norm=1.820401 delta_norm=0.027408
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S15] START round=49 head_norm_before_train=1.617952 cos_to_last_merge=1.0000 (last merge round=48)
[S15] round=49 local utility u=1.000000 metrics={'f1_val': 0.9962895101731264, 'auprc': 0.998501675120599, 'loss_val': 0.0319189476764905, 'psi': 0.9971743761521155}-{'f1_val': 0.702122835660083, 'auprc': 0.9929819543083698, 'loss_val': 0.5390093501847177, 'psi': 0.8184664831193977}
[S16] START round=49 head_norm_before_train=1.819947 cos_to_last_merge=0.9879 (last merge round=35)
[S16] round=49 local utility u=0.000000 metrics={'f1_val': 0.9272808424763948, 'auprc': 0.9946794675507115, 'loss_val': 0.3516560835877782, 'psi': 0.9542402925061214}-{'f1_val': 0.9899286023683248, 'auprc': 0.996954004733001, 'loss_val': 0.055578048703124744, 'psi': 0.9927387633141953}
[S17] START round=49 head_norm_before_train=2.192299 (no previous merge yet)
[S17] round=49 local utility u=0.141387 metrics={'f1_val': 0.8432144693407086, 'auprc': 0.9924240961451771, 'loss_val': 0.40814753367417206, 'psi': 0.902898320062496}-{'f1_val': 0.7967366971136581, 'auprc': 0.9963815572315446, 'loss_val': 0.42392631640945294, 'psi': 0.8765946411608128}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S11@127.0.0.1:49312
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:49305
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:49311
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1795 to 1 peers)
[S8] not sending this round → trigger blocked (psi=0.996)
[S15] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1793 to 1 peers)
[S3] not sending this round → trigger blocked (psi=0.993)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=49 metric=0.6588 head_norm=2.036483
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.947359e-02
[S6] stored merged vector for next round verification (round=49)
[S6] DEBUG after merge:  round=49 metric=0.6588 head_norm=2.024145 delta_norm=0.039474
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=49 metric=0.5719 head_norm=1.844079
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.091859e-02
[S7] stored merged vector for next round verification (round=49)
[S7] DEBUG after merge:  round=49 metric=0.5726 head_norm=1.846183 delta_norm=0.010919
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] RECEIVED delta(kind=head bytes=1801) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.641721)
[S5] loaded HEAD from S15 (vec_in norm=1.641721)
[S5] cosine check vs S15: cos=0.9997
[S5] BUFFERED delta from S15 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1793) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=2.214951)
[S11] loaded HEAD from S4 (vec_in norm=2.214951)
[S11] cosine check vs S4: cos=-0.0910
[S11] DROPPED delta from S4 (cos=-0.0910 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1795) from S13
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.940822)
[S10] loaded HEAD from S13 (vec_in norm=1.940822)
[S10] cosine check vs S13: cos=-0.0955
[S10] DROPPED delta from S13 (cos=-0.0955 < 0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=49 metric=0.9963 head_norm=1.641721
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.800206e-02
[S15] stored merged vector for next round verification (round=49)
[S15] DEBUG after merge:  round=49 metric=0.9963 head_norm=1.622187 delta_norm=0.028002
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=49 metric=0.4438 head_norm=1.609654
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.663927e-02
[S5] stored merged vector for next round verification (round=49)
[S5] DEBUG after merge:  round=49 metric=0.4438 head_norm=1.625549 delta_norm=0.026639
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[runner] rounds complete.
[runner] all agents stopped.
