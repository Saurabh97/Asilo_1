[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:39803
[S3] → join 127.0.0.1:39802
[S4] → join 127.0.0.1:39802
[S5] → join 127.0.0.1:39802
[S6] → join 127.0.0.1:39802
[S7] → join 127.0.0.1:39802
[S8] → join 127.0.0.1:39802
[S9] → join 127.0.0.1:39802
[S10] → join 127.0.0.1:39802
[S11] → join 127.0.0.1:39802
[S13] → join 127.0.0.1:39802
[S14] → join 127.0.0.1:39802
[S15] → join 127.0.0.1:39802
[S16] → join 127.0.0.1:39802
[S17] → join 127.0.0.1:39802
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.169046 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.154517 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.134815 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.109403 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.175187 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.165179 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.171581 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.224269 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.090421 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.117415 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.117493 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.189133 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.179563 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.126158 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.198443 (no previous merge yet)
[S7]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S3] + discovered S13
[S4] + discovered S3
[S4] + discovered S2
[S3] + discovered S10
[S3] + discovered S8
[S3] + discovered S5
[S3] + discovered S9
[S3] + discovered S17
[S3] + discovered S16
[S3] + discovered S15
[S3] + discovered S14
[S3] + discovered S11
[S3] + discovered S6
[S3] + discovered S4
[S3] + discovered S7
[S5] + discovered S3
[S5] + discovered S2
[S5] + discovered S4
[S4] + discovered S8
[S4] + discovered S10
[S4] + discovered S5
[S4] + discovered S9
[S4] + discovered S17
[S4] + discovered S16
[S4] + discovered S15
[S4] + discovered S14
[S4] + discovered S11
[S4] + discovered S6
[S4] + discovered S7
[S4] + discovered S13
[S6] + discovered S4
[S6] + discovered S5
[S6] + discovered S2
[S6] + discovered S3
[S5] + discovered S11
[S5] + discovered S17
[S5] + discovered S14
[S5] + discovered S15
[S5] + discovered S9
[S5] + discovered S10
[S5] + discovered S13
[S5] + discovered S7
[S5] + discovered S6
[S5] + discovered S16
[S5] + discovered S8
[S6] + discovered S13
[S6] + discovered S7
[S6] + discovered S16
[S7] + discovered S2
[S7] + discovered S4
[S7] + discovered S5
[S7] + discovered S6
[S7] + discovered S3
[S6] + discovered S17
[S6] + discovered S9
[S6] + discovered S10
[S6] + discovered S14
[S6] + discovered S8
[S6] + discovered S11
[S6] + discovered S15
[S8] + discovered S4
[S8] + discovered S2
[S7] + discovered S13
[S7] + discovered S16
[S7] + discovered S11
[S7] + discovered S15
[S7] + discovered S14
[S7] + discovered S9
[S7] + discovered S8
[S7] + discovered S10
[S7] + discovered S17
[S8] + discovered S7
[S8] + discovered S6
[S8] + discovered S5
[S8] + discovered S3
[S8] + discovered S11
[S8] + discovered S10
[S8] + discovered S14
[S8] + discovered S13
[S8] + discovered S16
[S8] + discovered S15
[S8] + discovered S9
[S8] + discovered S17
[S9] + discovered S7
[S9] + discovered S6
[S9] + discovered S5
[S9] + discovered S4
[S9] + discovered S3
[S9] + discovered S8
[S9] + discovered S2
[S10] + discovered S8
[S10] + discovered S3
[S10] + discovered S5
[S10] + discovered S7
[S10] + discovered S2
[S10] + discovered S9
[S10] + discovered S4
[S10] + discovered S6
[S9] + discovered S15
[S9] + discovered S13
[S9] + discovered S10
[S9] + discovered S14
[S9] + discovered S17
[S9] + discovered S16
[S9] + discovered S11
[S11] + discovered S6
[S11] + discovered S4
[S11] + discovered S2
[S11] + discovered S7
[S11] + discovered S3
[S11] + discovered S10
[S11] + discovered S9
[S11] + discovered S5
[S11] + discovered S8
[S10] + discovered S16
[S10] + discovered S14
[S10] + discovered S13
[S10] + discovered S11
[S10] + discovered S17
[S10] + discovered S15
[S11] + discovered S16
[S11] + discovered S13
[S11] + discovered S14
[S11] + discovered S15
[S11] + discovered S17
[S13] + discovered S11
[S13] + discovered S5
[S13] + discovered S9
[S13] + discovered S2
[S13] + discovered S6
[S13] + discovered S8
[S13] + discovered S10
[S13] + discovered S3
[S13] + discovered S7
[S13] + discovered S4
[S13] + discovered S17
[S13] + discovered S14
[S13] + discovered S15
[S13] + discovered S16
[S14] + discovered S4
[S14] + discovered S3
[S14] + discovered S8
[S14] + discovered S6
[S14] + discovered S13
[S14] + discovered S11
[S14] + discovered S5
[S14] + discovered S7
[S14] + discovered S10
[S14] + discovered S2
[S14] + discovered S9
[S15] + discovered S7
[S15] + discovered S6
[S15] + discovered S2
[S15] + discovered S9
[S15] + discovered S10
[S15] + discovered S5
[S15] + discovered S11
[S15] + discovered S14
[S15] + discovered S3
[S15] + discovered S8
[S15] + discovered S4
[S14] + discovered S16
[S14] + discovered S15
[S14] + discovered S17
[S15] + discovered S13
[S16] + discovered S9
[S16] + discovered S5
[S16] + discovered S3
[S16] + discovered S13
[S16] + discovered S15
[S16] + discovered S4
[S16] + discovered S8
[S16] + discovered S14
[S16] + discovered S10
[S16] + discovered S6
[S16] + discovered S7
[S16] + discovered S2
[S15] + discovered S17
[S15] + discovered S16
[S16] + discovered S11
[S17] + discovered S8
[S17] + discovered S14
[S17] + discovered S4
[S17] + discovered S15
[S17] + discovered S3
[S17] + discovered S9
[S17] + discovered S10
[S17] + discovered S5
[S17] + discovered S13
[S17] + discovered S2
[S17] + discovered S16
[S16] + discovered S17
[S17] + discovered S11
[S17] + discovered S7
[S17] + discovered S6
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] ⇄ pheromone p=1.000 → S7@127.0.0.1:39808
[S8] ⇄ pheromone p=1.000 → S5@127.0.0.1:39805
[S10] ⇄ pheromone p=1.000 → S5@127.0.0.1:39805
[S5] ⇄ pheromone p=1.000 → S3@127.0.0.1:39803
[S16] ⇄ pheromone p=1.000 → S14@127.0.0.1:39814
[S6] ⇄ pheromone p=1.000 → S7@127.0.0.1:39808
[S15] ⇄ pheromone p=1.000 → S14@127.0.0.1:39814
[S2] ⇄ pheromone p=1.000 → S6@127.0.0.1:39807
[S9] ⇄ pheromone p=1.000 → S7@127.0.0.1:39808
[S13] ⇄ pheromone p=1.000 → S10@127.0.0.1:39811
[S11] ⇄ pheromone p=1.000 → S2@127.0.0.1:39802
[S7] ⇄ pheromone p=1.000 → S13@127.0.0.1:39813
[S4] ⇄ pheromone p=1.000 → S14@127.0.0.1:39814
[S3] ⇄ pheromone p=1.000 → S14@127.0.0.1:39814
[S17] ⇄ pheromone p=1.000 → S8@127.0.0.1:39809
[S2] START round=1 head_norm_before_train=1.178197 (no previous merge yet)
[S2] round=1 local utility u=0.347102 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7453572744705292, 'loss_val': 1.266755092540951, 'psi': 0.38320918982135177}-{'f1_val': 0.1417771333885667, 'auprc': 0.5364875859162134, 'loss_val': 1.3343495059025652, 'psi': 0.2996613143996254}
[S3] START round=1 head_norm_before_train=1.159098 (no previous merge yet)
[S3] round=1 local utility u=0.218807 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.794782207988894, 'loss_val': 1.3064737954970569, 'psi': 0.4018169225640218}-{'f1_val': 0.13984006561410703, 'auprc': 0.6585048369041896, 'loss_val': 1.3352560665248938, 'psi': 0.3473059741301401}
[S4] START round=1 head_norm_before_train=1.153772 (no previous merge yet)
[S4] round=1 local utility u=0.000000 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7829450228524709, 'loss_val': 1.2473477138534501, 'psi': 0.39731398647809885}-{'f1_val': 0.3973667831267177, 'auprc': 0.7884113345267401, 'loss_val': 1.325878465721307, 'psi': 0.5537846036867267}
[S5] START round=1 head_norm_before_train=1.112681 (no previous merge yet)
[S5] round=1 local utility u=0.097329 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7718251403919686, 'loss_val': 1.3268400784741186, 'psi': 0.3940871990139303}-{'f1_val': 0.21116260902287873, 'auprc': 0.5801389518224502, 'loss_val': 1.3598442905703412, 'psi': 0.35875314614270737}
[S6] START round=1 head_norm_before_train=1.201198 (no previous merge yet)
[S6] round=1 local utility u=0.020760 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8045949400213266, 'loss_val': 1.2412306617487814, 'psi': 0.40669374523929985}-{'f1_val': 0.14142628205128205, 'auprc': 0.8150893842927629, 'loss_val': 1.3142341898349432, 'psi': 0.4108915229478744}
[S7] START round=1 head_norm_before_train=1.174983 (no previous merge yet)
[S7] round=1 local utility u=0.166995 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7773273388378369, 'loss_val': 1.313195156550916, 'psi': 0.3961650291725898}-{'f1_val': 0.14205682272909165, 'auprc': 0.675056268713598, 'loss_val': 1.3403726638270805, 'psi': 0.3552566011228942}
[S8] START round=1 head_norm_before_train=1.174352 (no previous merge yet)
[S8] round=1 local utility u=0.122808 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.6549639425189231, 'loss_val': 1.292124412950448, 'psi': 0.34595916644334357}-{'f1_val': 0.13995598239295717, 'auprc': 0.5889079288140309, 'loss_val': 1.339571843353156, 'psi': 0.31953676096138667}
[S9] START round=1 head_norm_before_train=1.226446 (no previous merge yet)
[S9] round=1 local utility u=0.096425 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8657283560081088, 'loss_val': 1.2970946392230471, 'psi': 0.43113011668724116}-{'f1_val': 0.141397957139996, 'auprc': 0.8173497198892717, 'loss_val': 1.3448087075130837, 'psi': 0.41177866223970633}
[S10] START round=1 head_norm_before_train=1.088623 (no previous merge yet)
[S10] round=1 local utility u=0.176523 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.5906778602728566, 'loss_val': 1.2937044151967914, 'psi': 0.319444126634177}-{'f1_val': 0.13862163754172394, 'auprc': 0.4938452186391766, 'loss_val': 1.3562523774227095, 'psi': 0.280711069980705}
[S11] START round=1 head_norm_before_train=1.125877 (no previous merge yet)
[S11] round=1 local utility u=0.164276 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.5298533031580693, 'loss_val': 1.333773417327078, 'psi': 0.2961895312870941}-{'f1_val': 0.14041368337311058, 'auprc': 0.4334086460370581, 'loss_val': 1.372990590822874, 'psi': 0.2576116684386896}
[S13] START round=1 head_norm_before_train=1.130030 (no previous merge yet)
[S13] round=1 local utility u=0.058970 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6347358330844555, 'loss_val': 1.282874440353266, 'psi': 0.33812579078001403}-{'f1_val': 0.1403857625770531, 'auprc': 0.6144363191156834, 'loss_val': 1.3399159063214927, 'psi': 0.33000598519250524}
[S14] START round=1 head_norm_before_train=1.195100 (no previous merge yet)
[S14] round=1 local utility u=0.039749 metrics={'f1_val': 0.15387968613775066, 'auprc': 0.630814165399833, 'loss_val': 1.328044951352544, 'psi': 0.3446534778425836}-{'f1_val': 0.14035785288270378, 'auprc': 0.6384851882647059, 'loss_val': 1.349424175173475, 'psi': 0.3396087870355046}
[S15] START round=1 head_norm_before_train=1.189918 (no previous merge yet)
[S15] round=1 local utility u=0.044685 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7776883255623124, 'loss_val': 1.2845626631665057, 'psi': 0.39491552104185995}-{'f1_val': 0.13973365136155833, 'auprc': 0.7700029880251924, 'loss_val': 1.350877100915295, 'psi': 0.39184138602701196}
[S16] START round=1 head_norm_before_train=1.129035 (no previous merge yet)
[S16] round=1 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7975730030735168, 'loss_val': 1.3178434434763315, 'psi': 0.40341167134892864}-{'f1_val': 0.4344606970437419, 'auprc': 0.7930759265401516, 'loss_val': 1.3526196252265472, 'psi': 0.5779067888423057}
[S17] START round=1 head_norm_before_train=1.214925 (no previous merge yet)
[S17] round=1 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6371845299697856, 'loss_val': 1.2647578198176153, 'psi': 0.3394431899783449}-{'f1_val': 0.14094896331738438, 'auprc': 0.83555668670407, 'loss_val': 1.3361320479312162, 'psi': 0.41879205267205866}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S10] → sending delta(kind=head bytes=1789) to S11@127.0.0.1:39812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:39816
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S14] → sending delta(kind=head bytes=1788) to S17@127.0.0.1:39817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:39810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:39810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S7] → sending delta(kind=head bytes=1786) to S11@127.0.0.1:39812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] → sending delta(kind=head bytes=1792) to S6@127.0.0.1:39807
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:39816
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S3] → sending delta(kind=head bytes=1788) to S10@127.0.0.1:39811
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S11] → sending delta(kind=head bytes=1790) to S15@127.0.0.1:39815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S6] → sending delta(kind=head bytes=1790) to S4@127.0.0.1:39804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] → sending delta(kind=head bytes=1792) to S14@127.0.0.1:39814
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1788 to 1 peers)
[S7] sending update (kind=head size=1786 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1790 to 1 peers)
[S6] sending update (kind=head size=1790 to 1 peers)
[S9] sending update (kind=head size=1792 to 1 peers)
[S15] sending update (kind=head size=1793 to 1 peers)
[S8] sending update (kind=head size=1793 to 1 peers)
[S14] sending update (kind=head size=1788 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1789 to 1 peers)
[S5] sending update (kind=head size=1792 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1793) from S8
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.206351)
[S9] loaded HEAD from S8 (vec_in norm=1.206351)
[S9] cosine check vs S8: cos=-0.1053
[S9] DROPPED delta from S8 (cos=-0.1053 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1795) from S2
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.215685)
[S16] loaded HEAD from S2 (vec_in norm=1.215685)
[S16] cosine check vs S2: cos=-0.0057
[S16] DROPPED delta from S2 (cos=-0.0057 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1796) from S13
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.169742)
[S9] loaded HEAD from S13 (vec_in norm=1.169742)
[S9] cosine check vs S13: cos=0.0457
[S9] BUFFERED delta from S13 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1793) from S15
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.223374)
[S16] loaded HEAD from S15 (vec_in norm=1.223374)
[S16] cosine check vs S15: cos=0.0767
[S16] BUFFERED delta from S15 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1788) from S14
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.212713)
[S17] loaded HEAD from S14 (vec_in norm=1.212713)
[S17] cosine check vs S14: cos=-0.0699
[S17] DROPPED delta from S14 (cos=-0.0699 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1790) from S11
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.142905)
[S15] loaded HEAD from S11 (vec_in norm=1.142905)
[S15] cosine check vs S11: cos=0.0197
[S15] BUFFERED delta from S11 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1790) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.248976)
[S4] loaded HEAD from S6 (vec_in norm=1.248976)
[S4] cosine check vs S6: cos=0.0375
[S4] BUFFERED delta from S6 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1788) from S3
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.174518)
[S10] loaded HEAD from S3 (vec_in norm=1.174518)
[S10] cosine check vs S3: cos=-0.0187
[S10] DROPPED delta from S3 (cos=-0.0187 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1792) from S9
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.239985)
[S6] loaded HEAD from S9 (vec_in norm=1.239985)
[S6] cosine check vs S9: cos=0.0748
[S6] BUFFERED delta from S9 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1786) from S7
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.191310)
[S11] loaded HEAD from S7 (vec_in norm=1.191310)
[S11] cosine check vs S7: cos=0.0422
[S11] BUFFERED delta from S7 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1792) from S5
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.130001)
[S14] loaded HEAD from S5 (vec_in norm=1.130001)
[S14] cosine check vs S5: cos=-0.0244
[S14] DROPPED delta from S5 (cos=-0.0244 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1789) from S10
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.121942)
[S11] loaded HEAD from S10 (vec_in norm=1.121942)
[S11] cosine check vs S10: cos=0.0892
[S11] BUFFERED delta from S10 (total buffered=2)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=1 metric=0.1402 head_norm=1.199744
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.495338e-01
[S4] stored merged vector for next round verification (round=1)
[S4] DEBUG after merge:  round=1 metric=0.1402 head_norm=0.882018 delta_norm=0.849534
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=1 metric=0.1397 head_norm=1.223374
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.288332e-01
[S15] stored merged vector for next round verification (round=1)
[S15] DEBUG after merge:  round=1 metric=0.2844 head_norm=0.845265 delta_norm=0.828833
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=1 metric=0.1404 head_norm=1.142905
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.682349e-01
[S11] stored merged vector for next round verification (round=1)
[S11] DEBUG after merge:  round=1 metric=0.1404 head_norm=0.729694 delta_norm=0.668235
[S11] aggregate: ACCEPT kept=['S7', 'S10'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=1 metric=0.1414 head_norm=1.239985
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.326393e-01
[S9] stored merged vector for next round verification (round=1)
[S9] DEBUG after merge:  round=1 metric=0.1414 head_norm=0.871574 delta_norm=0.832639
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=1 metric=0.1414 head_norm=1.248976
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.464403e-01
[S6] stored merged vector for next round verification (round=1)
[S6] DEBUG after merge:  round=1 metric=0.1414 head_norm=0.912300 delta_norm=0.846440
[S6] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=1 metric=0.1406 head_norm=1.140904
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.037758e-01
[S16] stored merged vector for next round verification (round=1)
[S16] DEBUG after merge:  round=1 metric=0.3828 head_norm=0.867812 delta_norm=0.803776
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=1.215685 (no previous merge yet)
[S2] round=2 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.615029934603026, 'loss_val': 1.1925295246483445, 'psi': 0.33107825387435047}-{'f1_val': 0.1417771333885667, 'auprc': 0.7453572744705292, 'loss_val': 1.266755092540951, 'psi': 0.38320918982135177}
[S3] START round=2 head_norm_before_train=1.174518 (no previous merge yet)
[S3] round=2 local utility u=0.016999 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7950418987552367, 'loss_val': 1.2732539234844158, 'psi': 0.40192079887055887}-{'f1_val': 0.13984006561410703, 'auprc': 0.794782207988894, 'loss_val': 1.3064737954970569, 'psi': 0.4018169225640218}
[S4] START round=2 head_norm_before_train=0.882018 cos_to_last_merge=1.0000 (last merge round=1)
[S4] round=2 local utility u=0.000000 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7671107951485665, 'loss_val': 1.2060463819559637, 'psi': 0.3909802953965371}-{'f1_val': 0.14022662889518414, 'auprc': 0.7829450228524709, 'loss_val': 1.2473477138534501, 'psi': 0.39731398647809885}
[S5] START round=2 head_norm_before_train=1.130001 (no previous merge yet)
[S5] round=2 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7485408658553695, 'loss_val': 1.2923107179891231, 'psi': 0.38477348919929066}-{'f1_val': 0.14226190476190476, 'auprc': 0.7718251403919686, 'loss_val': 1.3268400784741186, 'psi': 0.3940871990139303}
[S6] START round=2 head_norm_before_train=0.912300 cos_to_last_merge=1.0000 (last merge round=1)
[S6] round=2 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6119372631540804, 'loss_val': 1.1936290058406689, 'psi': 0.32963067449240135}-{'f1_val': 0.14142628205128205, 'auprc': 0.8045949400213266, 'loss_val': 1.2412306617487814, 'psi': 0.40669374523929985}
[S7] START round=2 head_norm_before_train=1.191310 (no previous merge yet)
[S7] round=2 local utility u=0.016683 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7786553240593662, 'loss_val': 1.2838121152935607, 'psi': 0.3966962232612015}-{'f1_val': 0.14205682272909165, 'auprc': 0.7773273388378369, 'loss_val': 1.313195156550916, 'psi': 0.3961650291725898}
[S8] START round=2 head_norm_before_train=1.206351 (no previous merge yet)
[S8] round=2 local utility u=0.129435 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7204796831667986, 'loss_val': 1.2298009348076668, 'psi': 0.37216546270249373}-{'f1_val': 0.13995598239295717, 'auprc': 0.6549639425189231, 'loss_val': 1.292124412950448, 'psi': 0.34595916644334357}
[S9] START round=2 head_norm_before_train=0.871574 cos_to_last_merge=1.0000 (last merge round=1)
[S9] round=2 local utility u=0.003435 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8658749723092656, 'loss_val': 1.2906654315609392, 'psi': 0.4311887632077039}-{'f1_val': 0.141397957139996, 'auprc': 0.8657283560081088, 'loss_val': 1.2970946392230471, 'psi': 0.43113011668724116}
[S10] START round=2 head_norm_before_train=1.121942 (no previous merge yet)
[S10] round=2 local utility u=0.073535 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6093441927103505, 'loss_val': 1.2026327556818288, 'psi': 0.32691065960917454}-{'f1_val': 0.13862163754172394, 'auprc': 0.5906778602728566, 'loss_val': 1.2937044151967914, 'psi': 0.319444126634177}
[S11] START round=2 head_norm_before_train=0.729694 cos_to_last_merge=1.0000 (last merge round=1)
[S11] round=2 local utility u=0.111237 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.59990629647908, 'loss_val': 1.3214588451049785, 'psi': 0.3242107286154984}-{'f1_val': 0.14041368337311058, 'auprc': 0.5298533031580693, 'loss_val': 1.333773417327078, 'psi': 0.2961895312870941}
[S13] START round=2 head_norm_before_train=1.169742 (no previous merge yet)
[S13] round=2 local utility u=0.129855 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7045884876827438, 'loss_val': 1.2327220499792682, 'psi': 0.3660668526193294}-{'f1_val': 0.1403857625770531, 'auprc': 0.6347358330844555, 'loss_val': 1.282874440353266, 'psi': 0.33812579078001403}
[S14] START round=2 head_norm_before_train=1.212713 (no previous merge yet)
[S14] round=2 local utility u=0.647262 metrics={'f1_val': 0.3964292957175209, 'auprc': 0.570197264782406, 'loss_val': 1.3069675609297506, 'psi': 0.4659364833434749}-{'f1_val': 0.15387968613775066, 'auprc': 0.630814165399833, 'loss_val': 1.328044951352544, 'psi': 0.3446534778425836}
[S15] START round=2 head_norm_before_train=0.845265 cos_to_last_merge=1.0000 (last merge round=1)
[S15] round=2 local utility u=0.004032 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.77465249636444, 'loss_val': 1.2673905283424638, 'psi': 0.39370118936271103}-{'f1_val': 0.13973365136155833, 'auprc': 0.7776883255623124, 'loss_val': 1.2845626631665057, 'psi': 0.39491552104185995}
[S16] START round=2 head_norm_before_train=0.867812 cos_to_last_merge=1.0000 (last merge round=1)
[S16] round=2 local utility u=0.843143 metrics={'f1_val': 0.41467924219943564, 'auprc': 0.8122664940247133, 'loss_val': 1.3198879869297249, 'psi': 0.5737141429295467}-{'f1_val': 0.14063745019920318, 'auprc': 0.7975730030735168, 'loss_val': 1.3178434434763315, 'psi': 0.40341167134892864}
[S17] START round=2 head_norm_before_train=1.256069 (no previous merge yet)
[S17] round=2 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.584970709516123, 'loss_val': 1.1494300014744891, 'psi': 0.31855766179687983}-{'f1_val': 0.14094896331738438, 'auprc': 0.6371845299697856, 'loss_val': 1.2647578198176153, 'psi': 0.3394431899783449}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.372)
[S9] not sending this round → trigger blocked (psi=0.431)
[S3] not sending this round → trigger blocked (psi=0.402)
[S13] not sending this round → trigger blocked (psi=0.366)
[S14] not sending this round → trigger blocked (psi=0.466)
[S7] not sending this round → trigger blocked (psi=0.397)
[S11] not sending this round → trigger blocked (psi=0.324)
[S15] not sending this round → trigger blocked (psi=0.394)
[S10] not sending this round → trigger blocked (psi=0.327)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:39810
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1799 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1799) from S16
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.882552)
[S9] loaded HEAD from S16 (vec_in norm=0.882552)
[S9] cosine check vs S16: cos=0.0800
[S9] BUFFERED delta from S16 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=2 metric=0.1414 head_norm=0.888528
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.006059e-01
[S9] stored merged vector for next round verification (round=2)
[S9] DEBUG after merge:  round=2 metric=0.4648 head_norm=0.650740 delta_norm=0.600606
[S9] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=1.265338 (no previous merge yet)
[S2] round=3 local utility u=1.000000 metrics={'f1_val': 0.4167275806938775, 'auprc': 0.7131518405683663, 'loss_val': 1.0347109985665188, 'psi': 0.535297284643673}-{'f1_val': 0.1417771333885667, 'auprc': 0.615029934603026, 'loss_val': 1.1925295246483445, 'psi': 0.33107825387435047}
[S3] START round=3 head_norm_before_train=1.198994 (no previous merge yet)
[S3] round=3 local utility u=0.018233 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7949725991652002, 'loss_val': 1.2365792562024334, 'psi': 0.4018930790345443}-{'f1_val': 0.13984006561410703, 'auprc': 0.7950418987552367, 'loss_val': 1.2732539234844158, 'psi': 0.40192079887055887}
[S4] START round=3 head_norm_before_train=0.936248 cos_to_last_merge=0.9920 (last merge round=1)
[S4] round=3 local utility u=1.000000 metrics={'f1_val': 0.6378056487079453, 'auprc': 0.7640568669776764, 'loss_val': 1.0551633463876902, 'psi': 0.6883061360158378}-{'f1_val': 0.14022662889518414, 'auprc': 0.7671107951485665, 'loss_val': 1.2060463819559637, 'psi': 0.3909802953965371}
[S5] START round=3 head_norm_before_train=1.152938 (no previous merge yet)
[S5] round=3 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7340020642334415, 'loss_val': 1.2521304124086603, 'psi': 0.37895796855051944}-{'f1_val': 0.14226190476190476, 'auprc': 0.7485408658553695, 'loss_val': 1.2923107179891231, 'psi': 0.38477348919929066}
[S6] START round=3 head_norm_before_train=0.958640 cos_to_last_merge=0.9935 (last merge round=1)
[S6] round=3 local utility u=1.000000 metrics={'f1_val': 0.4172560359570804, 'auprc': 0.7668355267446744, 'loss_val': 0.9970367407965134, 'psi': 0.557087832272118}-{'f1_val': 0.14142628205128205, 'auprc': 0.6119372631540804, 'loss_val': 1.1936290058406689, 'psi': 0.32963067449240135}
[S7] START round=3 head_norm_before_train=1.215720 (no previous merge yet)
[S7] round=3 local utility u=0.012992 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7791321051498705, 'loss_val': 1.2592579149125704, 'psi': 0.39688693569740324}-{'f1_val': 0.14205682272909165, 'auprc': 0.7786553240593662, 'loss_val': 1.2838121152935607, 'psi': 0.3966962232612015}
[S8] START round=3 head_norm_before_train=1.249695 (no previous merge yet)
[S8] round=3 local utility u=1.000000 metrics={'f1_val': 0.5679632916612044, 'auprc': 0.7661268777885705, 'loss_val': 1.1245943962942926, 'psi': 0.6472287261121508}-{'f1_val': 0.13995598239295717, 'auprc': 0.7204796831667986, 'loss_val': 1.2298009348076668, 'psi': 0.37216546270249373}
[S9] START round=3 head_norm_before_train=0.650740 cos_to_last_merge=1.0000 (last merge round=2)
[S9] round=3 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8657571413392016, 'loss_val': 1.2987135800274516, 'psi': 0.43114163081967827}-{'f1_val': 0.141397957139996, 'auprc': 0.8658749723092656, 'loss_val': 1.2906654315609392, 'psi': 0.4311887632077039}
[S10] START round=3 head_norm_before_train=1.172085 (no previous merge yet)
[S10] round=3 local utility u=0.936944 metrics={'f1_val': 0.41670936461107344, 'auprc': 0.610040778080604, 'loss_val': 0.9993615871189182, 'psi': 0.49404192999888563}-{'f1_val': 0.13862163754172394, 'auprc': 0.6093441927103505, 'loss_val': 1.2026327556818288, 'psi': 0.32691065960917454}
[S11] START round=3 head_norm_before_train=0.749918 cos_to_last_merge=0.9963 (last merge round=1)
[S11] round=3 local utility u=0.009632 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.590194012464157, 'loss_val': 1.2730577556473834, 'psi': 0.32032581500952917}-{'f1_val': 0.14041368337311058, 'auprc': 0.59990629647908, 'loss_val': 1.3214588451049785, 'psi': 0.3242107286154984}
[S13] START round=3 head_norm_before_train=1.208068 (no previous merge yet)
[S13] round=3 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5987644959823906, 'loss_val': 1.1646932249484199, 'psi': 0.3237372559391881}-{'f1_val': 0.1403857625770531, 'auprc': 0.7045884876827438, 'loss_val': 1.2327220499792682, 'psi': 0.3660668526193294}
[S14] START round=3 head_norm_before_train=1.236436 (no previous merge yet)
[S14] round=3 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.6828095532966075, 'loss_val': 1.275698694435318, 'psi': 0.3573385330482653}-{'f1_val': 0.3964292957175209, 'auprc': 0.570197264782406, 'loss_val': 1.3069675609297506, 'psi': 0.4659364833434749}
[S15] START round=3 head_norm_before_train=0.884421 cos_to_last_merge=0.9926 (last merge round=1)
[S15] round=3 local utility u=0.044345 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7767040796212282, 'loss_val': 1.1848552111636923, 'psi': 0.3945218226654263}-{'f1_val': 0.13973365136155833, 'auprc': 0.77465249636444, 'loss_val': 1.2673905283424638, 'psi': 0.39370118936271103}
[S16] START round=3 head_norm_before_train=0.882552 cos_to_last_merge=0.9968 (last merge round=1)
[S16] round=3 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8128589262611582, 'loss_val': 1.2688806686548817, 'psi': 0.40952604062398523}-{'f1_val': 0.41467924219943564, 'auprc': 0.8122664940247133, 'loss_val': 1.3198879869297249, 'psi': 0.5737141429295467}
[S17] START round=3 head_norm_before_train=1.302709 (no previous merge yet)
[S17] round=3 local utility u=0.974376 metrics={'f1_val': 0.3918227013590554, 'auprc': 0.6856658249779547, 'loss_val': 1.0080054206017264, 'psi': 0.5093599508066151}-{'f1_val': 0.14094896331738438, 'auprc': 0.584970709516123, 'loss_val': 1.1494300014744891, 'psi': 0.31855766179687983}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:39808
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:39805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1784 reason=None
[S3] → sending delta(kind=head bytes=1784) to S14@127.0.0.1:39814
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:39814
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S2@127.0.0.1:39802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:39805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:39813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:39807
[S3] sending update (kind=head size=1784 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S2] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1795) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.010401)
[S7] loaded HEAD from S6 (vec_in norm=1.010401)
[S7] cosine check vs S6: cos=0.0131
[S7] BUFFERED delta from S6 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1794) from S2
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.311484)
[S6] loaded HEAD from S2 (vec_in norm=1.311484)
[S6] cosine check vs S2: cos=-0.0661
[S6] DROPPED delta from S2 (cos=-0.0661 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1794) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.781992)
[S2] loaded HEAD from S11 (vec_in norm=0.781992)
[S2] cosine check vs S11: cos=0.0522
[S2] BUFFERED delta from S11 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1798) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.233770)
[S5] loaded HEAD from S10 (vec_in norm=1.233770)
[S5] cosine check vs S10: cos=0.1437
[S5] BUFFERED delta from S10 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1798) from S7
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.238457)
[S13] loaded HEAD from S7 (vec_in norm=1.238457)
[S13] cosine check vs S7: cos=0.0674
[S13] BUFFERED delta from S7 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1799) from S4
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.991960)
[S14] loaded HEAD from S4 (vec_in norm=0.991960)
[S14] cosine check vs S4: cos=0.0508
[S14] BUFFERED delta from S4 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1797) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.933782)
[S14] loaded HEAD from S15 (vec_in norm=0.933782)
[S14] cosine check vs S15: cos=0.1112
[S14] BUFFERED delta from S15 (total buffered=2)
[S14] RECEIVED delta(kind=head bytes=1784) from S3
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.227075)
[S14] loaded HEAD from S3 (vec_in norm=1.227075)
[S14] cosine check vs S3: cos=-0.1037
[S14] DROPPED delta from S3 (cos=-0.1037 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1800) from S8
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.293620)
[S5] loaded HEAD from S8 (vec_in norm=1.293620)
[S5] cosine check vs S8: cos=-0.0332
[S5] DROPPED delta from S8 (cos=-0.0332 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S17] → sending delta(kind=head bytes=1792) to S8@127.0.0.1:39809
[S17] sending update (kind=head size=1792 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1792) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.344303)
[S8] loaded HEAD from S17 (vec_in norm=1.344303)
[S8] cosine check vs S17: cos=-0.0652
[S8] DROPPED delta from S17 (cos=-0.0652 < 0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=3 metric=0.1423 head_norm=1.179403
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.897818e-01
[S5] stored merged vector for next round verification (round=3)
[S5] DEBUG after merge:  round=3 metric=0.1423 head_norm=0.912598 delta_norm=0.789782
[S5] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=3 metric=0.1404 head_norm=1.263177
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.792486e-01
[S14] stored merged vector for next round verification (round=3)
[S14] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.747517 delta_norm=0.679249
[S14] aggregate: ACCEPT kept=['S4', 'S15'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=3 metric=0.1404 head_norm=1.237789
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.454658e-01
[S13] stored merged vector for next round verification (round=3)
[S13] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.904508 delta_norm=0.845466
[S13] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=3 metric=0.1421 head_norm=1.238457
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.940436e-01
[S7] stored merged vector for next round verification (round=3)
[S7] DEBUG after merge:  round=3 metric=0.1421 head_norm=0.804262 delta_norm=0.794044
[S7] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=3 metric=0.4167 head_norm=1.311484
[S2] _apply_head_vector_avg (torch): Δ‖w‖=7.457216e-01
[S2] stored merged vector for next round verification (round=3)
[S2] DEBUG after merge:  round=3 metric=0.4166 head_norm=0.780801 delta_norm=0.745722
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=0.780801 cos_to_last_merge=1.0000 (last merge round=3)
[S2] round=4 local utility u=0.745570 metrics={'f1_val': 0.6089459173267877, 'auprc': 0.7783318640581318, 'loss_val': 0.892420276981753, 'psi': 0.6767002960193254}-{'f1_val': 0.4167275806938775, 'auprc': 0.7131518405683663, 'loss_val': 1.0347109985665188, 'psi': 0.535297284643673}
[S3] START round=4 head_norm_before_train=1.227075 (no previous merge yet)
[S3] round=4 local utility u=0.025211 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7935964618925536, 'loss_val': 1.1820279724160845, 'psi': 0.4013426241254857}-{'f1_val': 0.13984006561410703, 'auprc': 0.7949725991652002, 'loss_val': 1.2365792562024334, 'psi': 0.4018930790345443}
[S4] START round=4 head_norm_before_train=0.991960 cos_to_last_merge=0.9779 (last merge round=1)
[S4] round=4 local utility u=0.041815 metrics={'f1_val': 0.6711642132488429, 'auprc': 0.6418070295212922, 'loss_val': 0.8049354901370237, 'psi': 0.6594213397578226}-{'f1_val': 0.6378056487079453, 'auprc': 0.7640568669776764, 'loss_val': 1.0551633463876902, 'psi': 0.6883061360158378}
[S5] START round=4 head_norm_before_train=0.912598 cos_to_last_merge=1.0000 (last merge round=3)
[S5] round=4 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7291989341136738, 'loss_val': 1.2520365070069206, 'psi': 0.3770367165026124}-{'f1_val': 0.14226190476190476, 'auprc': 0.7340020642334415, 'loss_val': 1.2521304124086603, 'psi': 0.37895796855051944}
[S6] START round=4 head_norm_before_train=1.010401 cos_to_last_merge=0.9803 (last merge round=1)
[S6] round=4 local utility u=1.000000 metrics={'f1_val': 0.6995222757664563, 'auprc': 0.8283960780837358, 'loss_val': 0.7288884292140001, 'psi': 0.7510717966933681}-{'f1_val': 0.4172560359570804, 'auprc': 0.7668355267446744, 'loss_val': 0.9970367407965134, 'psi': 0.557087832272118}
[S7] START round=4 head_norm_before_train=0.804262 cos_to_last_merge=1.0000 (last merge round=3)
[S7] round=4 local utility u=0.004848 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7876027098105352, 'loss_val': 1.274973830434273, 'psi': 0.4002751775616691}-{'f1_val': 0.14205682272909165, 'auprc': 0.7791321051498705, 'loss_val': 1.2592579149125704, 'psi': 0.39688693569740324}
[S8] START round=4 head_norm_before_train=1.293620 (no previous merge yet)
[S8] round=4 local utility u=0.589556 metrics={'f1_val': 0.7150337453891538, 'auprc': 0.7787865994121235, 'loss_val': 0.8658837549453052, 'psi': 0.7405348869983417}-{'f1_val': 0.5679632916612044, 'auprc': 0.7661268777885705, 'loss_val': 1.1245943962942926, 'psi': 0.6472287261121508}
[S9] START round=4 head_norm_before_train=0.667015 cos_to_last_merge=0.9939 (last merge round=2)
[S9] round=4 local utility u=0.029596 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8655095153178536, 'loss_val': 1.2387785772259312, 'psi': 0.4310425804111391}-{'f1_val': 0.141397957139996, 'auprc': 0.8657571413392016, 'loss_val': 1.2987135800274516, 'psi': 0.43114163081967827}
[S10] START round=4 head_norm_before_train=1.233770 (no previous merge yet)
[S10] round=4 local utility u=0.384647 metrics={'f1_val': 0.38758917288329053, 'auprc': 0.8421611163218357, 'loss_val': 0.7517065640619475, 'psi': 0.5694179502587086}-{'f1_val': 0.41670936461107344, 'auprc': 0.610040778080604, 'loss_val': 0.9993615871189182, 'psi': 0.49404192999888563}
[S11] START round=4 head_norm_before_train=0.781992 cos_to_last_merge=0.9865 (last merge round=1)
[S11] round=4 local utility u=0.008543 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.5795596992809614, 'loss_val': 1.224068562649341, 'psi': 0.3160720897362509}-{'f1_val': 0.14041368337311058, 'auprc': 0.590194012464157, 'loss_val': 1.2730577556473834, 'psi': 0.32032581500952917}
[S13] START round=4 head_norm_before_train=0.904508 cos_to_last_merge=1.0000 (last merge round=3)
[S13] round=4 local utility u=1.000000 metrics={'f1_val': 0.415486691627877, 'auprc': 0.7075188555648643, 'loss_val': 1.0621322003708984, 'psi': 0.5322995572026719}-{'f1_val': 0.1403857625770531, 'auprc': 0.5987644959823906, 'loss_val': 1.1646932249484199, 'psi': 0.3237372559391881}
[S14] START round=4 head_norm_before_train=0.747517 cos_to_last_merge=1.0000 (last merge round=3)
[S14] round=4 local utility u=0.184861 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8112645168275536, 'loss_val': 1.2913410676041908, 'psi': 0.4087205184606437}-{'f1_val': 0.14035785288270378, 'auprc': 0.6828095532966075, 'loss_val': 1.275698694435318, 'psi': 0.3573385330482653}
[S15] START round=4 head_norm_before_train=0.933782 cos_to_last_merge=0.9783 (last merge round=1)
[S15] round=4 local utility u=1.000000 metrics={'f1_val': 0.6429823590991917, 'auprc': 0.77811418467025, 'loss_val': 0.9973882522763958, 'psi': 0.6970350893276149}-{'f1_val': 0.13973365136155833, 'auprc': 0.7767040796212282, 'loss_val': 1.1848552111636923, 'psi': 0.3945218226654263}
[S16] START round=4 head_norm_before_train=0.906425 cos_to_last_merge=0.9875 (last merge round=1)
[S16] round=4 local utility u=0.021581 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8068087891315623, 'loss_val': 1.207567524518768, 'psi': 0.40710598577214685}-{'f1_val': 0.14063745019920318, 'auprc': 0.8128589262611582, 'loss_val': 1.2688806686548817, 'psi': 0.40952604062398523}
[S17] START round=4 head_norm_before_train=1.344303 (no previous merge yet)
[S17] round=4 local utility u=0.395201 metrics={'f1_val': 0.37170817901302744, 'auprc': 0.9324236372333392, 'loss_val': 0.8371907124430455, 'psi': 0.5959943623011522}-{'f1_val': 0.3918227013590554, 'auprc': 0.6856658249779547, 'loss_val': 1.0080054206017264, 'psi': 0.5093599508066151}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:39808
[S7] not sending this round → trigger blocked (psi=0.400)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S14] → sending delta(kind=head bytes=1791) to S7@127.0.0.1:39808
[S10] not sending this round → trigger blocked (psi=0.569)
[S4] not sending this round → trigger blocked (psi=0.659)
[S3] not sending this round → trigger blocked (psi=0.401)
[S6] not sending this round → trigger blocked (psi=0.751)
[S11] not sending this round → trigger blocked (psi=0.316)
[S8] not sending this round → trigger blocked (psi=0.741)
[S2] not sending this round → trigger blocked (psi=0.677)
[S15] not sending this round → trigger blocked (psi=0.697)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S10@127.0.0.1:39811
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:39814
[S13] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1791 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1797) from S16
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.939964)
[S14] loaded HEAD from S16 (vec_in norm=0.939964)
[S14] cosine check vs S16: cos=0.2261
[S14] BUFFERED delta from S16 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1791) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.780053)
[S7] loaded HEAD from S14 (vec_in norm=0.780053)
[S7] cosine check vs S14: cos=0.1247
[S7] BUFFERED delta from S14 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1797) from S9
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.692866)
[S7] loaded HEAD from S9 (vec_in norm=0.692866)
[S7] cosine check vs S9: cos=0.2970
[S7] BUFFERED delta from S9 (total buffered=2)
[S10] RECEIVED delta(kind=head bytes=1794) from S13
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=0.957178)
[S10] loaded HEAD from S13 (vec_in norm=0.957178)
[S10] cosine check vs S13: cos=-0.0046
[S10] DROPPED delta from S13 (cos=-0.0046 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.596)
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=4 metric=0.1421 head_norm=0.824136
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.392359e-01
[S7] stored merged vector for next round verification (round=4)
[S7] DEBUG after merge:  round=4 metric=0.1421 head_norm=0.563736 delta_norm=0.439236
[S7] aggregate: ACCEPT kept=['S14', 'S9'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=4 metric=0.1404 head_norm=0.780053
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.386167e-01
[S14] stored merged vector for next round verification (round=4)
[S14] DEBUG after merge:  round=4 metric=0.1404 head_norm=0.675203 delta_norm=0.538617
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=0.863876 cos_to_last_merge=0.9892 (last merge round=3)
[S2] round=5 local utility u=0.084909 metrics={'f1_val': 0.6180553864951291, 'auprc': 0.7588120116652866, 'loss_val': 0.718700298285125, 'psi': 0.674358036563192}-{'f1_val': 0.6089459173267877, 'auprc': 0.7783318640581318, 'loss_val': 0.892420276981753, 'psi': 0.6767002960193254}
[S3] START round=5 head_norm_before_train=1.257972 (no previous merge yet)
[S3] round=5 local utility u=0.395094 metrics={'f1_val': 0.2528723466592444, 'auprc': 0.7954943951296418, 'loss_val': 1.0757273877026208, 'psi': 0.4699211660474034}-{'f1_val': 0.13984006561410703, 'auprc': 0.7935964618925536, 'loss_val': 1.1820279724160845, 'psi': 0.4013426241254857}
[S4] START round=5 head_norm_before_train=1.068083 cos_to_last_merge=0.9559 (last merge round=1)
[S4] round=5 local utility u=0.189071 metrics={'f1_val': 0.6711973542480185, 'auprc': 0.7013905073925479, 'loss_val': 0.6057433714634732, 'psi': 0.6832746155058302}-{'f1_val': 0.6711642132488429, 'auprc': 0.6418070295212922, 'loss_val': 0.8049354901370237, 'psi': 0.6594213397578226}
[S5] START round=5 head_norm_before_train=0.936460 cos_to_last_merge=0.9982 (last merge round=3)
[S5] round=5 local utility u=0.032493 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7373114564044034, 'loss_val': 1.2113889450396804, 'psi': 0.38028172541890426}-{'f1_val': 0.14226190476190476, 'auprc': 0.7291989341136738, 'loss_val': 1.2520365070069206, 'psi': 0.3770367165026124}
[S6] START round=5 head_norm_before_train=1.071961 cos_to_last_merge=0.9589 (last merge round=1)
[S6] round=5 local utility u=0.000000 metrics={'f1_val': 0.6212195859466425, 'auprc': 0.8078773474532581, 'loss_val': 0.6104907303698505, 'psi': 0.6958826905492888}-{'f1_val': 0.6995222757664563, 'auprc': 0.8283960780837358, 'loss_val': 0.7288884292140001, 'psi': 0.7510717966933681}
[S7] START round=5 head_norm_before_train=0.563736 cos_to_last_merge=1.0000 (last merge round=4)
[S7] round=5 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7762333191900187, 'loss_val': 1.2784234869975561, 'psi': 0.3957274213134625}-{'f1_val': 0.14205682272909165, 'auprc': 0.7876027098105352, 'loss_val': 1.274973830434273, 'psi': 0.4002751775616691}
[S8] START round=5 head_norm_before_train=1.338672 (no previous merge yet)
[S8] round=5 local utility u=0.462728 metrics={'f1_val': 0.714331594236135, 'auprc': 0.9991719240134872, 'loss_val': 0.5973717787391256, 'psi': 0.8282677261470759}-{'f1_val': 0.7150337453891538, 'auprc': 0.7787865994121235, 'loss_val': 0.8658837549453052, 'psi': 0.7405348869983417}
[S9] START round=5 head_norm_before_train=0.692866 cos_to_last_merge=0.9787 (last merge round=2)
[S9] round=5 local utility u=0.003669 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8463929166314053, 'loss_val': 1.1740913019884758, 'psi': 0.42339594093655974}-{'f1_val': 0.141397957139996, 'auprc': 0.8655095153178536, 'loss_val': 1.2387785772259312, 'psi': 0.4310425804111391}
[S10] START round=5 head_norm_before_train=1.307569 (no previous merge yet)
[S10] round=5 local utility u=1.000000 metrics={'f1_val': 0.6955418682854808, 'auprc': 0.9959603527479928, 'loss_val': 0.5254677652470949, 'psi': 0.8157092620704856}-{'f1_val': 0.38758917288329053, 'auprc': 0.8421611163218357, 'loss_val': 0.7517065640619475, 'psi': 0.5694179502587086}
[S11] START round=5 head_norm_before_train=0.814010 cos_to_last_merge=0.9751 (last merge round=1)
[S11] round=5 local utility u=0.049267 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.5904856903207176, 'loss_val': 1.1583119452515038, 'psi': 0.3204424861521534}-{'f1_val': 0.14041368337311058, 'auprc': 0.5795596992809614, 'loss_val': 1.224068562649341, 'psi': 0.3160720897362509}
[S13] START round=5 head_norm_before_train=0.957178 cos_to_last_merge=0.9954 (last merge round=3)
[S13] round=5 local utility u=0.194513 metrics={'f1_val': 0.4935977005673052, 'auprc': 0.631500263383918, 'loss_val': 0.913716506191438, 'psi': 0.5487587256939503}-{'f1_val': 0.415486691627877, 'auprc': 0.7075188555648643, 'loss_val': 1.0621322003708984, 'psi': 0.5322995572026719}
[S14] START round=5 head_norm_before_train=0.675203 cos_to_last_merge=1.0000 (last merge round=4)
[S14] round=5 local utility u=0.021870 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8248735237121034, 'loss_val': 1.2884277794137755, 'psi': 0.41416412121446367}-{'f1_val': 0.14035785288270378, 'auprc': 0.8112645168275536, 'loss_val': 1.2913410676041908, 'psi': 0.4087205184606437}
[S15] START round=5 head_norm_before_train=0.994611 cos_to_last_merge=0.9603 (last merge round=1)
[S15] round=5 local utility u=0.651545 metrics={'f1_val': 0.6934534606307412, 'auprc': 0.9966926291624351, 'loss_val': 0.6528606811117214, 'psi': 0.8147491280434187}-{'f1_val': 0.6429823590991917, 'auprc': 0.77811418467025, 'loss_val': 0.9973882522763958, 'psi': 0.6970350893276149}
[S16] START round=5 head_norm_before_train=0.939964 cos_to_last_merge=0.9734 (last merge round=1)
[S16] round=5 local utility u=0.126842 metrics={'f1_val': 0.27836581842685143, 'auprc': 0.5907513022458643, 'loss_val': 1.1320813873707425, 'psi': 0.40332001195445655}-{'f1_val': 0.14063745019920318, 'auprc': 0.8068087891315623, 'loss_val': 1.207567524518768, 'psi': 0.40710598577214685}
[S17] START round=5 head_norm_before_train=1.409671 (no previous merge yet)
[S17] round=5 local utility u=0.000000 metrics={'f1_val': 0.3521394294854705, 'auprc': 0.7602501076938981, 'loss_val': 0.896346684367431, 'psi': 0.5153837007688415}-{'f1_val': 0.37170817901302744, 'auprc': 0.9324236372333392, 'loss_val': 0.8371907124430455, 'psi': 0.5959943623011522}
[S14] not sending this round → trigger blocked (psi=0.414)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:39805
[S9] not sending this round → trigger blocked (psi=0.423)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:39807
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S3] → sending delta(kind=head bytes=1791) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] → sending delta(kind=head bytes=1792) to S3@127.0.0.1:39803
[S13] not sending this round → trigger blocked (psi=0.549)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:39814
[S16] not sending this round → trigger blocked (psi=0.403)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:39805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S11] → sending delta(kind=head bytes=1790) to S2@127.0.0.1:39802
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1790 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] sending update (kind=head size=1792 to 1 peers)
[S3] sending update (kind=head size=1791 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1791) from S3
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.291072)
[S14] loaded HEAD from S3 (vec_in norm=1.291072)
[S14] cosine check vs S3: cos=-0.1152
[S14] DROPPED delta from S3 (cos=-0.1152 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1799) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.077416)
[S14] loaded HEAD from S15 (vec_in norm=1.077416)
[S14] cosine check vs S15: cos=0.5630
[S14] BUFFERED delta from S15 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1790) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.843036)
[S2] loaded HEAD from S11 (vec_in norm=0.843036)
[S2] cosine check vs S11: cos=0.4342
[S2] BUFFERED delta from S11 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1797) from S8
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.399410)
[S5] loaded HEAD from S8 (vec_in norm=1.399410)
[S5] cosine check vs S8: cos=-0.0247
[S5] DROPPED delta from S8 (cos=-0.0247 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1804) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.385579)
[S5] loaded HEAD from S10 (vec_in norm=1.385579)
[S5] cosine check vs S10: cos=0.7256
[S5] BUFFERED delta from S10 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1792) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.961254)
[S3] loaded HEAD from S5 (vec_in norm=0.961254)
[S3] cosine check vs S5: cos=-0.0817
[S3] DROPPED delta from S5 (cos=-0.0817 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1804) from S4
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.166590)
[S14] loaded HEAD from S4 (vec_in norm=1.166590)
[S14] cosine check vs S4: cos=0.1682
[S14] BUFFERED delta from S4 (total buffered=2)
[S6] RECEIVED delta(kind=head bytes=1795) from S2
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=0.976339)
[S6] loaded HEAD from S2 (vec_in norm=0.976339)
[S6] cosine check vs S2: cos=-0.0315
[S6] DROPPED delta from S2 (cos=-0.0315 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] ⇄ pheromone p=0.341 → S7@127.0.0.1:39808
[S6] ⇄ pheromone p=0.617 → S7@127.0.0.1:39808
[S13] ⇄ pheromone p=0.545 → S10@127.0.0.1:39811
[S7] ⇄ pheromone p=0.346 → S13@127.0.0.1:39813
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=5 metric=0.1404 head_norm=0.708965
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.616117e-01
[S14] stored merged vector for next round verification (round=5)
[S14] DEBUG after merge:  round=5 metric=0.1404 head_norm=0.644469 delta_norm=0.361612
[S14] aggregate: ACCEPT kept=['S15', 'S4'] (k=2/2) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.431 → S7@127.0.0.1:39808
[S11] ⇄ pheromone p=0.365 → S2@127.0.0.1:39802
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=5 metric=0.6181 head_norm=0.976339
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.871091e-01
[S2] stored merged vector for next round verification (round=5)
[S2] DEBUG after merge:  round=5 metric=0.5837 head_norm=0.771167 delta_norm=0.487109
[S2] aggregate: ROLLBACK (f1_val pre=0.618 post=0.584 tol_abs=0.005 tol_rel=0.0)
[S2] ⇄ pheromone p=0.620 → S6@127.0.0.1:39807
[S8] ⇄ pheromone p=0.666 → S5@127.0.0.1:39805
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=5 metric=0.1423 head_norm=0.961254
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.772137e-01
[S5] stored merged vector for next round verification (round=5)
[S5] DEBUG after merge:  round=5 metric=0.1423 head_norm=1.092788 delta_norm=0.477214
[S5] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.342 → S3@127.0.0.1:39803
[S4] ⇄ pheromone p=0.500 → S14@127.0.0.1:39814
[S3] ⇄ pheromone p=0.433 → S14@127.0.0.1:39814
[S10] ⇄ pheromone p=0.731 → S5@127.0.0.1:39805
[S15] ⇄ pheromone p=0.628 → S14@127.0.0.1:39814
[S16] ⇄ pheromone p=0.443 → S14@127.0.0.1:39814
[S17] ⇄ pheromone p=0.516 → S8@127.0.0.1:39809
[S2] START round=6 head_norm_before_train=0.771167 cos_to_last_merge=1.0000 (last merge round=5)
[S2] round=6 local utility u=0.352524 metrics={'f1_val': 0.710799134356433, 'auprc': 0.7900155617578604, 'loss_val': 0.6637252441699206, 'psi': 0.742485705317004}-{'f1_val': 0.6180553864951291, 'auprc': 0.7588120116652866, 'loss_val': 0.718700298285125, 'psi': 0.674358036563192}
[S3] START round=6 head_norm_before_train=1.291072 (no previous merge yet)
[S3] round=6 local utility u=0.513876 metrics={'f1_val': 0.3923190208015843, 'auprc': 0.7961630547328173, 'loss_val': 0.8866612511762679, 'psi': 0.5538566343740776}-{'f1_val': 0.2528723466592444, 'auprc': 0.7954943951296418, 'loss_val': 1.0757273877026208, 'psi': 0.4699211660474034}
[S4] START round=6 head_norm_before_train=1.166590 cos_to_last_merge=0.9277 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.928
[S4] round=6 local utility u=0.000000 metrics={'f1_val': 0.6657939675755513, 'auprc': 0.665453039794632, 'loss_val': 0.467283910083974, 'psi': 0.6656575964631837}-{'f1_val': 0.6711973542480185, 'auprc': 0.7013905073925479, 'loss_val': 0.6057433714634732, 'psi': 0.6832746155058302}
[S5] START round=6 head_norm_before_train=1.092788 cos_to_last_merge=1.0000 (last merge round=5)
[S5] round=6 local utility u=0.061073 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7675453982562516, 'loss_val': 1.1799440023887806, 'psi': 0.3923753021596435}-{'f1_val': 0.14226190476190476, 'auprc': 0.7373114564044034, 'loss_val': 1.2113889450396804, 'psi': 0.38028172541890426}
[S6] START round=6 head_norm_before_train=1.150070 cos_to_last_merge=0.9344 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.934
[S6] round=6 local utility u=0.000000 metrics={'f1_val': 0.48757903108246275, 'auprc': 0.7763457928414943, 'loss_val': 0.7285519093398635, 'psi': 0.6030857357860754}-{'f1_val': 0.6212195859466425, 'auprc': 0.8078773474532581, 'loss_val': 0.6104907303698505, 'psi': 0.6958826905492888}
[S7] START round=6 head_norm_before_train=0.588564 cos_to_last_merge=0.9950 (last merge round=4)
[S7] round=6 local utility u=0.016348 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7773678422856528, 'loss_val': 1.2491302546629224, 'psi': 0.3961812305517161}-{'f1_val': 0.14205682272909165, 'auprc': 0.7762333191900187, 'loss_val': 1.2784234869975561, 'psi': 0.3957274213134625}
[S8] START round=6 head_norm_before_train=1.399410 (no previous merge yet)
[S8] round=6 local utility u=0.092721 metrics={'f1_val': 0.7144610111876308, 'auprc': 0.9984933740760714, 'loss_val': 0.41067132358989084, 'psi': 0.8280739563430071}-{'f1_val': 0.714331594236135, 'auprc': 0.9991719240134872, 'loss_val': 0.5973717787391256, 'psi': 0.8282677261470759}
[S9] START round=6 head_norm_before_train=0.723139 cos_to_last_merge=0.9601 (last merge round=2)
[S9] round=6 local utility u=0.919667 metrics={'f1_val': 0.41596643747099904, 'auprc': 0.8637105005562087, 'loss_val': 1.0341216196869047, 'psi': 0.5950640627050829}-{'f1_val': 0.141397957139996, 'auprc': 0.8463929166314053, 'loss_val': 1.1740913019884758, 'psi': 0.42339594093655974}
[S10] START round=6 head_norm_before_train=1.385579 (no previous merge yet)
[S10] round=6 local utility u=0.041804 metrics={'f1_val': 0.701116980599801, 'auprc': 0.9742765273183424, 'loss_val': 0.4102596692950642, 'psi': 0.8103807992872175}-{'f1_val': 0.6955418682854808, 'auprc': 0.9959603527479928, 'loss_val': 0.5254677652470949, 'psi': 0.8157092620704856}
[S11] START round=6 head_norm_before_train=0.843036 cos_to_last_merge=0.9635 (last merge round=1)
[S11] round=6 local utility u=1.000000 metrics={'f1_val': 0.4220374571106739, 'auprc': 0.7652833400295653, 'loss_val': 1.087252825706149, 'psi': 0.5593358102782304}-{'f1_val': 0.14041368337311058, 'auprc': 0.5904856903207176, 'loss_val': 1.1583119452515038, 'psi': 0.3204424861521534}
[S13] START round=6 head_norm_before_train=1.028611 cos_to_last_merge=0.9812 (last merge round=3)
[S13] round=6 local utility u=0.530587 metrics={'f1_val': 0.6121782860142057, 'auprc': 0.6974699194611058, 'loss_val': 0.7619347088627157, 'psi': 0.6462949393929658}-{'f1_val': 0.4935977005673052, 'auprc': 0.631500263383918, 'loss_val': 0.913716506191438, 'psi': 0.5487587256939503}
[S14] START round=6 head_norm_before_train=0.644469 cos_to_last_merge=1.0000 (last merge round=5)
[S14] round=6 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8043250762492515, 'loss_val': 1.25091363057307, 'psi': 0.40594474222932286}-{'f1_val': 0.14035785288270378, 'auprc': 0.8248735237121034, 'loss_val': 1.2884277794137755, 'psi': 0.41416412121446367}
[S15] START round=6 head_norm_before_train=1.077416 cos_to_last_merge=0.9353 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.935
[S15] round=6 local utility u=0.154710 metrics={'f1_val': 0.6989585615041851, 'auprc': 0.998891443562548, 'loss_val': 0.38306818026101125, 'psi': 0.8189317143275303}-{'f1_val': 0.6934534606307412, 'auprc': 0.9966926291624351, 'loss_val': 0.6528606811117214, 'psi': 0.8147491280434187}
[S16] START round=6 head_norm_before_train=0.977307 cos_to_last_merge=0.9567 (last merge round=1)
[S16] round=6 local utility u=0.652583 metrics={'f1_val': 0.4170395601558466, 'auprc': 0.7197623453639059, 'loss_val': 1.0459906606729992, 'psi': 0.5381286742390703}-{'f1_val': 0.27836581842685143, 'auprc': 0.5907513022458643, 'loss_val': 1.1320813873707425, 'psi': 0.40332001195445655}
[S17] START round=6 head_norm_before_train=1.472345 (no previous merge yet)
[S17] round=6 local utility u=0.000000 metrics={'f1_val': 0.3476468228758282, 'auprc': 0.7458085766255699, 'loss_val': 0.9778473029741368, 'psi': 0.506911524375725}-{'f1_val': 0.3521394294854705, 'auprc': 0.7602501076938981, 'loss_val': 0.896346684367431, 'psi': 0.5153837007688415}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:39814
[S5] not sending this round → trigger blocked (psi=0.392)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.819)
[S8] not sending this round → trigger blocked (psi=0.828)
[S2] not sending this round → trigger blocked (psi=0.742)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S13@127.0.0.1:39813
[S3] not sending this round → trigger blocked (psi=0.554)
[S10] not sending this round → trigger blocked (psi=0.810)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:39811
[S11] not sending this round → trigger blocked (psi=0.559)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1804 to 1 peers)
[S16] sending update (kind=head size=1805 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1798) from S9
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.754948)
[S7] loaded HEAD from S9 (vec_in norm=0.754948)
[S7] cosine check vs S9: cos=0.5647
[S7] BUFFERED delta from S9 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1801) from S13
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.100224)
[S10] loaded HEAD from S13 (vec_in norm=1.100224)
[S10] cosine check vs S13: cos=-0.0140
[S10] DROPPED delta from S13 (cos=-0.0140 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1804) from S7
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.622312)
[S13] loaded HEAD from S7 (vec_in norm=0.622312)
[S13] cosine check vs S7: cos=0.5553
[S13] BUFFERED delta from S7 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1805) from S16
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.013002)
[S14] loaded HEAD from S16 (vec_in norm=1.013002)
[S14] cosine check vs S16: cos=0.6136
[S14] BUFFERED delta from S16 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=6 metric=0.1404 head_norm=0.678763
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.009670e-01
[S14] stored merged vector for next round verification (round=6)
[S14] DEBUG after merge:  round=6 metric=0.1404 head_norm=0.763329 delta_norm=0.400967
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=6 metric=0.6122 head_norm=1.100224
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.575273e-01
[S13] stored merged vector for next round verification (round=6)
[S13] DEBUG after merge:  round=6 metric=0.4156 head_norm=0.767822 delta_norm=0.457527
[S13] aggregate: ROLLBACK (f1_val pre=0.612 post=0.416 tol_abs=0.005 tol_rel=0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=6 metric=0.1421 head_norm=0.622312
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.265816e-01
[S7] stored merged vector for next round verification (round=6)
[S7] DEBUG after merge:  round=6 metric=0.1421 head_norm=0.609881 delta_norm=0.326582
[S7] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=0.876628 cos_to_last_merge=0.9854 (last merge round=5)
[S2] round=7 local utility u=0.075475 metrics={'f1_val': 0.7009533202285976, 'auprc': 0.7963417614335823, 'loss_val': 0.4726798368438161, 'psi': 0.7391086967105914}-{'f1_val': 0.710799134356433, 'auprc': 0.7900155617578604, 'loss_val': 0.6637252441699206, 'psi': 0.742485705317004}
[S3] START round=7 head_norm_before_train=1.332366 (no previous merge yet)
[S3] round=7 local utility u=0.415217 metrics={'f1_val': 0.401708470248874, 'auprc': 0.9970275712393579, 'loss_val': 0.7151582734847266, 'psi': 0.6398361106450676}-{'f1_val': 0.3923190208015843, 'auprc': 0.7961630547328173, 'loss_val': 0.8866612511762679, 'psi': 0.5538566343740776}
[S4] START round=7 head_norm_before_train=1.268134 cos_to_last_merge=0.9027 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.903
[S4] round=7 local utility u=1.000000 metrics={'f1_val': 0.942224802528655, 'auprc': 0.9485755369635688, 'loss_val': 0.4869971707639062, 'psi': 0.9447650963026206}-{'f1_val': 0.6657939675755513, 'auprc': 0.665453039794632, 'loss_val': 0.467283910083974, 'psi': 0.6656575964631837}
[S5] START round=7 head_norm_before_train=1.106466 cos_to_last_merge=0.9990 (last merge round=5)
[S5] round=7 local utility u=0.878548 metrics={'f1_val': 0.41694544507090897, 'auprc': 0.7778219159548263, 'loss_val': 1.1017779801178826, 'psi': 0.5612960334244759}-{'f1_val': 0.14226190476190476, 'auprc': 0.7675453982562516, 'loss_val': 1.1799440023887806, 'psi': 0.3923753021596435}
[S6] START round=7 head_norm_before_train=1.226981 cos_to_last_merge=0.9143 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.914
[S6] round=7 local utility u=0.784056 metrics={'f1_val': 0.6200452692637366, 'auprc': 0.9521347391946626, 'loss_val': 0.4826042142743257, 'psi': 0.7528810572361071}-{'f1_val': 0.48757903108246275, 'auprc': 0.7763457928414943, 'loss_val': 0.7285519093398635, 'psi': 0.6030857357860754}
[S7] START round=7 head_norm_before_train=0.609881 cos_to_last_merge=1.0000 (last merge round=6)
[S7] round=7 local utility u=0.008419 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7775181220580852, 'loss_val': 1.2327427306471492, 'psi': 0.3962413424606891}-{'f1_val': 0.14205682272909165, 'auprc': 0.7773678422856528, 'loss_val': 1.2491302546629224, 'psi': 0.3961812305517161}
[S8] START round=7 head_norm_before_train=1.467608 (no previous merge yet)
[S8] round=7 local utility u=0.914479 metrics={'f1_val': 0.9838232672393987, 'auprc': 0.9991409597522939, 'loss_val': 0.19983015752887456, 'psi': 0.9899503442445567}-{'f1_val': 0.7144610111876308, 'auprc': 0.9984933740760714, 'loss_val': 0.41067132358989084, 'psi': 0.8280739563430071}
[S9] START round=7 head_norm_before_train=0.754948 cos_to_last_merge=0.9422 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.942
[S9] round=7 local utility u=0.140804 metrics={'f1_val': 0.43626036087486686, 'auprc': 0.8595753970683213, 'loss_val': 0.861872466641342, 'psi': 0.6055863753522486}-{'f1_val': 0.41596643747099904, 'auprc': 0.8637105005562087, 'loss_val': 1.0341216196869047, 'psi': 0.5950640627050829}
[S10] START round=7 head_norm_before_train=1.454799 (no previous merge yet)
[S10] round=7 local utility u=0.056981 metrics={'f1_val': 0.7000680725537874, 'auprc': 0.9846599100696146, 'loss_val': 0.3211549873882444, 'psi': 0.8139048075601183}-{'f1_val': 0.701116980599801, 'auprc': 0.9742765273183424, 'loss_val': 0.4102596692950642, 'psi': 0.8103807992872175}
[S11] START round=7 head_norm_before_train=0.868597 cos_to_last_merge=0.9515 (last merge round=1)
[S11] round=7 local utility u=0.336649 metrics={'f1_val': 0.41160296728347745, 'auprc': 0.9625407997127322, 'loss_val': 0.9431194950157257, 'psi': 0.6319781002551793}-{'f1_val': 0.4220374571106739, 'auprc': 0.7652833400295653, 'loss_val': 1.087252825706149, 'psi': 0.5593358102782304}
[S13] START round=7 head_norm_before_train=0.767822 cos_to_last_merge=1.0000 (last merge round=6)
[S13] round=7 local utility u=0.000000 metrics={'f1_val': 0.5751206503549867, 'auprc': 0.5880212545097943, 'loss_val': 0.8222170031267187, 'psi': 0.5802808920169098}-{'f1_val': 0.6121782860142057, 'auprc': 0.6974699194611058, 'loss_val': 0.7619347088627157, 'psi': 0.6462949393929658}
[S14] START round=7 head_norm_before_train=0.763329 cos_to_last_merge=1.0000 (last merge round=6)
[S14] round=7 local utility u=0.848046 metrics={'f1_val': 0.3966267743617936, 'auprc': 0.8331434505513913, 'loss_val': 1.1788911792073997, 'psi': 0.5712334448376326}-{'f1_val': 0.14035785288270378, 'auprc': 0.8043250762492515, 'loss_val': 1.25091363057307, 'psi': 0.40594474222932286}
[S15] START round=7 head_norm_before_train=1.169117 cos_to_last_merge=0.9091 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.909
[S15] round=7 local utility u=0.034811 metrics={'f1_val': 0.7042189760512777, 'auprc': 0.9914758510590642, 'loss_val': 0.32276231910846837, 'psi': 0.8191217260543924}-{'f1_val': 0.6989585615041851, 'auprc': 0.998891443562548, 'loss_val': 0.38306818026101125, 'psi': 0.8189317143275303}
[S16] START round=7 head_norm_before_train=1.013002 cos_to_last_merge=0.9403 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.940
[S16] round=7 local utility u=0.050198 metrics={'f1_val': 0.4115686929040774, 'auprc': 0.7392334068802785, 'loss_val': 0.9711820209186243, 'psi': 0.5426345784945579}-{'f1_val': 0.4170395601558466, 'auprc': 0.7197623453639059, 'loss_val': 1.0459906606729992, 'psi': 0.5381286742390703}
[S17] START round=7 head_norm_before_train=1.510202 (no previous merge yet)
[S17] round=7 local utility u=0.331386 metrics={'f1_val': 0.3559983526541455, 'auprc': 0.9006136478052835, 'loss_val': 0.8296006779559182, 'psi': 0.5738444707146007}-{'f1_val': 0.3476468228758282, 'auprc': 0.7458085766255699, 'loss_val': 0.9778473029741368, 'psi': 0.506911524375725}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:39805
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:39802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:39805
[S9] not sending this round → trigger blocked (psi=0.606)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] → sending delta(kind=head bytes=1792) to S3@127.0.0.1:39803
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:39807
[S7] not sending this round → trigger blocked (psi=0.396)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:39814
[S16] not sending this round → trigger blocked (psi=0.543)
[S3] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1792 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S6] sending update (kind=head size=1794 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S4] sending update (kind=head size=1805 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1796) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.909794)
[S2] loaded HEAD from S11 (vec_in norm=0.909794)
[S2] cosine check vs S11: cos=0.6662
[S2] BUFFERED delta from S11 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1797) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.509307)
[S5] loaded HEAD from S10 (vec_in norm=1.509307)
[S5] cosine check vs S10: cos=0.9274
[S5] BUFFERED delta from S10 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1799) from S3
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.383810)
[S14] loaded HEAD from S3 (vec_in norm=1.383810)
[S14] cosine check vs S3: cos=-0.0802
[S14] DROPPED delta from S3 (cos=-0.0802 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1798) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.258650)
[S14] loaded HEAD from S15 (vec_in norm=1.258650)
[S14] cosine check vs S15: cos=0.6106
[S14] BUFFERED delta from S15 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1794) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.278437)
[S7] loaded HEAD from S6 (vec_in norm=1.278437)
[S7] cosine check vs S6: cos=0.5476
[S7] BUFFERED delta from S6 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1794) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.790546)
[S7] loaded HEAD from S14 (vec_in norm=0.790546)
[S7] cosine check vs S14: cos=0.5631
[S7] BUFFERED delta from S14 (total buffered=2)
[S3] RECEIVED delta(kind=head bytes=1792) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.121667)
[S3] loaded HEAD from S5 (vec_in norm=1.121667)
[S3] cosine check vs S5: cos=-0.0458
[S3] DROPPED delta from S5 (cos=-0.0458 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1796) from S2
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=0.993276)
[S6] loaded HEAD from S2 (vec_in norm=0.993276)
[S6] cosine check vs S2: cos=-0.0018
[S6] DROPPED delta from S2 (cos=-0.0018 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1805) from S4
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.346038)
[S14] loaded HEAD from S4 (vec_in norm=1.346038)
[S14] cosine check vs S4: cos=0.1830
[S14] BUFFERED delta from S4 (total buffered=2)
[S5] RECEIVED delta(kind=head bytes=1803) from S8
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.530741)
[S5] loaded HEAD from S8 (vec_in norm=1.530741)
[S5] cosine check vs S8: cos=-0.0023
[S5] DROPPED delta from S8 (cos=-0.0023 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:39809
[S17] sending update (kind=head size=1803 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1803) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.534607)
[S8] loaded HEAD from S17 (vec_in norm=1.534607)
[S8] cosine check vs S17: cos=-0.0609
[S8] DROPPED delta from S17 (cos=-0.0609 < 0.0)
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=7 metric=0.1421 head_norm=0.631756
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.890773e-01
[S7] stored merged vector for next round verification (round=7)
[S7] DEBUG after merge:  round=7 metric=0.1421 head_norm=0.667332 delta_norm=0.289077
[S7] aggregate: ACCEPT kept=['S6', 'S14'] (k=2/2) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=7 metric=0.7010 head_norm=0.993276
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.906231e-01
[S2] stored merged vector for next round verification (round=7)
[S2] DEBUG after merge:  round=7 metric=0.7008 head_norm=0.868663 delta_norm=0.390623
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=7 metric=0.3966 head_norm=0.790546
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.905808e-01
[S14] stored merged vector for next round verification (round=7)
[S14] DEBUG after merge:  round=7 metric=0.3966 head_norm=0.744126 delta_norm=0.390581
[S14] aggregate: ACCEPT kept=['S15', 'S4'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=7 metric=0.4169 head_norm=1.121667
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.146400e-01
[S5] stored merged vector for next round verification (round=7)
[S5] DEBUG after merge:  round=7 metric=0.4165 head_norm=1.291926 delta_norm=0.314640
[S5] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=0.868663 cos_to_last_merge=1.0000 (last merge round=7)
[S2] round=8 local utility u=0.023897 metrics={'f1_val': 0.7013120848906231, 'auprc': 0.7972317248696273, 'loss_val': 0.42970877540145686, 'psi': 0.7396799408822248}-{'f1_val': 0.7009533202285976, 'auprc': 0.7963417614335823, 'loss_val': 0.4726798368438161, 'psi': 0.7391086967105914}
[S3] START round=8 head_norm_before_train=1.383810 (no previous merge yet)
[S3] round=8 local utility u=0.001673 metrics={'f1_val': 0.4024484509855121, 'auprc': 0.9987599547830295, 'loss_val': 0.7214491457752514, 'psi': 0.640973052504519}-{'f1_val': 0.401708470248874, 'auprc': 0.9970275712393579, 'loss_val': 0.7151582734847266, 'psi': 0.6398361106450676}
[S4] START round=8 head_norm_before_train=1.346038 cos_to_last_merge=0.8862 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.886
[S4] round=8 local utility u=0.077673 metrics={'f1_val': 0.9516788939263358, 'auprc': 0.9287176984680506, 'loss_val': 0.328802814168689, 'psi': 0.9424944157430217}-{'f1_val': 0.942224802528655, 'auprc': 0.9485755369635688, 'loss_val': 0.4869971707639062, 'psi': 0.9447650963026206}
[S5] START round=8 head_norm_before_train=1.291926 cos_to_last_merge=1.0000 (last merge round=7)
[S5] round=8 local utility u=0.056555 metrics={'f1_val': 0.41795135763108626, 'auprc': 0.7778220718638282, 'loss_val': 0.9947048529445778, 'psi': 0.5618996433241831}-{'f1_val': 0.41694544507090897, 'auprc': 0.7778219159548263, 'loss_val': 1.1017779801178826, 'psi': 0.5612960334244759}
[S6] START round=8 head_norm_before_train=1.278437 cos_to_last_merge=0.8995 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.899
[S6] round=8 local utility u=0.374539 metrics={'f1_val': 0.7093606346101187, 'auprc': 0.9755187859911023, 'loss_val': 0.33957037877965834, 'psi': 0.8158238951625121}-{'f1_val': 0.6200452692637366, 'auprc': 0.9521347391946626, 'loss_val': 0.4826042142743257, 'psi': 0.7528810572361071}
[S7] START round=8 head_norm_before_train=0.667332 cos_to_last_merge=1.0000 (last merge round=7)
[S7] round=8 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.5742007885137083, 'loss_val': 1.1925213928891627, 'psi': 0.3149144090429383}-{'f1_val': 0.14205682272909165, 'auprc': 0.7775181220580852, 'loss_val': 1.2327427306471492, 'psi': 0.3962413424606891}
[S8] START round=8 head_norm_before_train=1.530741 (no previous merge yet)
[S8] round=8 local utility u=0.000000 metrics={'f1_val': 0.7144610111876308, 'auprc': 0.9982221220892791, 'loss_val': 0.38950213628943076, 'psi': 0.8279654555482902}-{'f1_val': 0.9838232672393987, 'auprc': 0.9991409597522939, 'loss_val': 0.19983015752887456, 'psi': 0.9899503442445567}
[S9] START round=8 head_norm_before_train=0.805208 cos_to_last_merge=0.9168 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.917
[S9] round=8 local utility u=1.000000 metrics={'f1_val': 0.7016893154854569, 'auprc': 0.9992186141168937, 'loss_val': 0.6883185773084216, 'psi': 0.8207010349380317}-{'f1_val': 0.43626036087486686, 'auprc': 0.8595753970683213, 'loss_val': 0.861872466641342, 'psi': 0.6055863753522486}
[S10] START round=8 head_norm_before_train=1.509307 (no previous merge yet)
[S10] round=8 local utility u=0.030514 metrics={'f1_val': 0.6926059226568636, 'auprc': 0.9961513503900589, 'loss_val': 0.24982894153199783, 'psi': 0.8140240937501417}-{'f1_val': 0.7000680725537874, 'auprc': 0.9846599100696146, 'loss_val': 0.3211549873882444, 'psi': 0.8139048075601183}
[S11] START round=8 head_norm_before_train=0.909794 cos_to_last_merge=0.9356 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.936
[S11] round=8 local utility u=0.043370 metrics={'f1_val': 0.396484976660716, 'auprc': 0.9863785332174566, 'loss_val': 0.8371839463363849, 'psi': 0.6324423992834123}-{'f1_val': 0.41160296728347745, 'auprc': 0.9625407997127322, 'loss_val': 0.9431194950157257, 'psi': 0.6319781002551793}
[S13] START round=8 head_norm_before_train=0.847422 cos_to_last_merge=0.9914 (last merge round=6)
[S13] round=8 local utility u=0.343278 metrics={'f1_val': 0.6567129576891584, 'auprc': 0.616244421015285, 'loss_val': 0.7098837091210142, 'psi': 0.6405255430196091}-{'f1_val': 0.5751206503549867, 'auprc': 0.5880212545097943, 'loss_val': 0.8222170031267187, 'psi': 0.5802808920169098}
[S14] START round=8 head_norm_before_train=0.744126 cos_to_last_merge=1.0000 (last merge round=7)
[S14] round=8 local utility u=0.087115 metrics={'f1_val': 0.3959510702502804, 'auprc': 0.8457885226145976, 'loss_val': 1.038542384196554, 'psi': 0.5758860511960073}-{'f1_val': 0.3966267743617936, 'auprc': 0.8331434505513913, 'loss_val': 1.1788911792073997, 'psi': 0.5712334448376326}
[S15] START round=8 head_norm_before_train=1.258650 cos_to_last_merge=0.8865 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.887
[S15] round=8 local utility u=0.274375 metrics={'f1_val': 0.7766240637116748, 'auprc': 0.9936156688912468, 'loss_val': 0.21486159703462696, 'psi': 0.8634207057835035}-{'f1_val': 0.7042189760512777, 'auprc': 0.9914758510590642, 'loss_val': 0.32276231910846837, 'psi': 0.8191217260543924}
[S16] START round=8 head_norm_before_train=1.055815 cos_to_last_merge=0.9225 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.923
[S16] round=8 local utility u=0.000000 metrics={'f1_val': 0.40572598223023565, 'auprc': 0.7256916312315727, 'loss_val': 0.9383876812670163, 'psi': 0.5337122418307705}-{'f1_val': 0.4115686929040774, 'auprc': 0.7392334068802785, 'loss_val': 0.9711820209186243, 'psi': 0.5426345784945579}
[S17] START round=8 head_norm_before_train=1.534607 (no previous merge yet)
[S17] round=8 local utility u=0.970509 metrics={'f1_val': 0.6361374681130405, 'auprc': 0.9290868624877928, 'loss_val': 0.6548377359562526, 'psi': 0.7533172258629415}-{'f1_val': 0.3559983526541455, 'auprc': 0.9006136478052835, 'loss_val': 0.8296006779559182, 'psi': 0.5738444707146007}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.562)
[S10] not sending this round → trigger blocked (psi=0.814)
[S4] not sending this round → trigger blocked (psi=0.942)
[S3] not sending this round → trigger blocked (psi=0.641)
[S15] not sending this round → trigger blocked (psi=0.863)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.816)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S13] → sending delta(kind=head bytes=1788) to S10@127.0.0.1:39811
[S2] not sending this round → trigger blocked (psi=0.740)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S7@127.0.0.1:39808
[S11] not sending this round → trigger blocked (psi=0.632)
[S14] not sending this round → trigger blocked (psi=0.576)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1794 to 1 peers)
[S13] sending update (kind=head size=1788 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1794) from S9
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.863921)
[S7] loaded HEAD from S9 (vec_in norm=0.863921)
[S7] cosine check vs S9: cos=0.7789
[S7] BUFFERED delta from S9 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1788) from S13
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=0.935905)
[S10] loaded HEAD from S13 (vec_in norm=0.935905)
[S10] cosine check vs S13: cos=0.0003
[S10] BUFFERED delta from S13 (total buffered=1)
[S17] not sending this round → trigger blocked (psi=0.753)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=8 metric=0.1421 head_norm=0.682202
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.709688e-01
[S7] stored merged vector for next round verification (round=8)
[S7] DEBUG after merge:  round=8 metric=0.6923 head_norm=0.729695 delta_norm=0.270969
[S7] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=8 metric=0.6926 head_norm=1.553230
[S10] _apply_head_vector_avg (torch): Δ‖w‖=9.065866e-01
[S10] stored merged vector for next round verification (round=8)
[S10] DEBUG after merge:  round=8 metric=0.7369 head_norm=0.906820 delta_norm=0.906587
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=0.971811 cos_to_last_merge=0.9886 (last merge round=7)
[S2] round=9 local utility u=0.000000 metrics={'f1_val': 0.7010542679632784, 'auprc': 0.679139708353731, 'loss_val': 0.34654559219599856, 'psi': 0.6922884441194594}-{'f1_val': 0.7013120848906231, 'auprc': 0.7972317248696273, 'loss_val': 0.42970877540145686, 'psi': 0.7396799408822248}
[S3] START round=9 head_norm_before_train=1.431709 (no previous merge yet)
[S3] round=9 local utility u=0.843798 metrics={'f1_val': 0.6469816006145771, 'auprc': 0.9985059619048627, 'loss_val': 0.5002900971441255, 'psi': 0.7875913451306913}-{'f1_val': 0.4024484509855121, 'auprc': 0.9987599547830295, 'loss_val': 0.7214491457752514, 'psi': 0.640973052504519}
[S4] START round=9 head_norm_before_train=1.410612 cos_to_last_merge=0.8767 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.877
[S4] round=9 local utility u=0.033298 metrics={'f1_val': 0.9436600691175803, 'auprc': 0.9655487750013974, 'loss_val': 0.3245874431711888, 'psi': 0.9524155514711071}-{'f1_val': 0.9516788939263358, 'auprc': 0.9287176984680506, 'loss_val': 0.328802814168689, 'psi': 0.9424944157430217}
[S5] START round=9 head_norm_before_train=1.312901 cos_to_last_merge=0.9988 (last merge round=7)
[S5] round=9 local utility u=0.065364 metrics={'f1_val': 0.41778804395810054, 'auprc': 0.777653927760699, 'loss_val': 0.8624930790857122, 'psi': 0.56173439747914}-{'f1_val': 0.41795135763108626, 'auprc': 0.7778220718638282, 'loss_val': 0.9947048529445778, 'psi': 0.5618996433241831}
[S6] START round=9 head_norm_before_train=1.318946 cos_to_last_merge=0.8915 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.892
[S6] round=9 local utility u=0.000000 metrics={'f1_val': 0.6203975333601128, 'auprc': 0.8212386756711543, 'loss_val': 0.48412947041326126, 'psi': 0.7007339902845293}-{'f1_val': 0.7093606346101187, 'auprc': 0.9755187859911023, 'loss_val': 0.33957037877965834, 'psi': 0.8158238951625121}
[S7] START round=9 head_norm_before_train=0.729695 cos_to_last_merge=1.0000 (last merge round=8)
[S7] round=9 local utility u=1.000000 metrics={'f1_val': 0.4170778520170104, 'auprc': 0.7631939028881943, 'loss_val': 1.1102712209295573, 'psi': 0.5555242723654841}-{'f1_val': 0.14205682272909165, 'auprc': 0.5742007885137083, 'loss_val': 1.1925213928891627, 'psi': 0.3149144090429383}
[S8] START round=9 head_norm_before_train=1.580523 (no previous merge yet)
[S8] round=9 local utility u=0.969876 metrics={'f1_val': 0.9946517344210846, 'auprc': 0.9991074044087658, 'loss_val': 0.13355096541099834, 'psi': 0.9964340024161571}-{'f1_val': 0.7144610111876308, 'auprc': 0.9982221220892791, 'loss_val': 0.38950213628943076, 'psi': 0.8279654555482902}
[S9] START round=9 head_norm_before_train=0.863921 cos_to_last_merge=0.8904 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.890
[S9] round=9 local utility u=0.000000 metrics={'f1_val': 0.6271113138580939, 'auprc': 0.8668797715206769, 'loss_val': 0.6361931139588881, 'psi': 0.7230186969231271}-{'f1_val': 0.7016893154854569, 'auprc': 0.9992186141168937, 'loss_val': 0.6883185773084216, 'psi': 0.8207010349380317}
[S10] START round=9 head_norm_before_train=0.906820 cos_to_last_merge=1.0000 (last merge round=8)
[S10] round=9 local utility u=0.198889 metrics={'f1_val': 0.7764523407236953, 'auprc': 0.9943508622561852, 'loss_val': 0.34972885566632206, 'psi': 0.8636117493366913}-{'f1_val': 0.6926059226568636, 'auprc': 0.9961513503900589, 'loss_val': 0.24982894153199783, 'psi': 0.8140240937501417}
[S11] START round=9 head_norm_before_train=0.953262 cos_to_last_merge=0.9189 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.919
[S11] round=9 local utility u=0.053055 metrics={'f1_val': 0.396484976660716, 'auprc': 0.9905849360940417, 'loss_val': 0.7436931398256122, 'psi': 0.6341249604340463}-{'f1_val': 0.396484976660716, 'auprc': 0.9863785332174566, 'loss_val': 0.8371839463363849, 'psi': 0.6324423992834123}
[S13] START round=9 head_norm_before_train=0.935905 cos_to_last_merge=0.9734 (last merge round=6)
[S13] round=9 local utility u=0.090068 metrics={'f1_val': 0.6363468871884284, 'auprc': 0.6714607818897291, 'loss_val': 0.5731995170854498, 'psi': 0.6503924450689487}-{'f1_val': 0.6567129576891584, 'auprc': 0.616244421015285, 'loss_val': 0.7098837091210142, 'psi': 0.6405255430196091}
[S14] START round=9 head_norm_before_train=0.781773 cos_to_last_merge=0.9928 (last merge round=7)
[S14] round=9 local utility u=0.311846 metrics={'f1_val': 0.3956755881566165, 'auprc': 0.9852001864010063, 'loss_val': 0.831433011729305, 'psi': 0.6314854274543724}-{'f1_val': 0.3959510702502804, 'auprc': 0.8457885226145976, 'loss_val': 1.038542384196554, 'psi': 0.5758860511960073}
[S15] START round=9 head_norm_before_train=1.327967 cos_to_last_merge=0.8713 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.871
[S15] round=9 local utility u=0.404630 metrics={'f1_val': 0.8984854842091042, 'auprc': 0.9989036315624208, 'loss_val': 0.15263450992285846, 'psi': 0.9386527431504309}-{'f1_val': 0.7766240637116748, 'auprc': 0.9936156688912468, 'loss_val': 0.21486159703462696, 'psi': 0.8634207057835035}
[S16] START round=9 head_norm_before_train=1.098116 cos_to_last_merge=0.9049 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.905
[S16] round=9 local utility u=0.000000 metrics={'f1_val': 0.3158734264622772, 'auprc': 0.743621078851827, 'loss_val': 0.9342482306954587, 'psi': 0.48697248741809707}-{'f1_val': 0.40572598223023565, 'auprc': 0.7256916312315727, 'loss_val': 0.9383876812670163, 'psi': 0.5337122418307705}
[S17] START round=9 head_norm_before_train=1.555551 (no previous merge yet)
[S17] round=9 local utility u=0.000000 metrics={'f1_val': 0.39363619293471774, 'auprc': 0.8471482394436164, 'loss_val': 0.6348068968553457, 'psi': 0.5750410115382771}-{'f1_val': 0.6361374681130405, 'auprc': 0.9290868624877928, 'loss_val': 0.6548377359562526, 'psi': 0.7533172258629415}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S11] → sending delta(kind=head bytes=1790) to S2@127.0.0.1:39802
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:39813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:39805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:39805
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.650)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:39803
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:39814
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:39808
[S4] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1790 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1796) from S3
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.472584)
[S14] loaded HEAD from S3 (vec_in norm=1.472584)
[S14] cosine check vs S3: cos=-0.0699
[S14] DROPPED delta from S3 (cos=-0.0699 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1799) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.002438)
[S5] loaded HEAD from S10 (vec_in norm=1.002438)
[S5] cosine check vs S10: cos=0.8544
[S5] BUFFERED delta from S10 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1795) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.832728)
[S7] loaded HEAD from S14 (vec_in norm=0.832728)
[S7] cosine check vs S14: cos=0.5811
[S7] BUFFERED delta from S14 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1803) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.386066)
[S14] loaded HEAD from S15 (vec_in norm=1.386066)
[S14] cosine check vs S15: cos=0.6735
[S14] BUFFERED delta from S15 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1799) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.343473)
[S3] loaded HEAD from S5 (vec_in norm=1.343473)
[S3] cosine check vs S5: cos=-0.0291
[S3] DROPPED delta from S5 (cos=-0.0291 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1800) from S8
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.611411)
[S5] loaded HEAD from S8 (vec_in norm=1.611411)
[S5] cosine check vs S8: cos=0.0114
[S5] BUFFERED delta from S8 (total buffered=2)
[S13] RECEIVED delta(kind=head bytes=1796) from S7
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.747406)
[S13] loaded HEAD from S7 (vec_in norm=0.747406)
[S13] cosine check vs S7: cos=0.4743
[S13] BUFFERED delta from S7 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1790) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.001242)
[S2] loaded HEAD from S11 (vec_in norm=1.001242)
[S2] cosine check vs S11: cos=0.7846
[S2] BUFFERED delta from S11 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1801) from S4
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.470484)
[S14] loaded HEAD from S4 (vec_in norm=1.470484)
[S14] cosine check vs S4: cos=0.4904
[S14] BUFFERED delta from S4 (total buffered=2)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=9 metric=0.6363 head_norm=0.995125
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.591858e-01
[S13] stored merged vector for next round verification (round=9)
[S13] DEBUG after merge:  round=9 metric=0.6672 head_norm=0.750729 delta_norm=0.459186
[S13] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=9 metric=0.7011 head_norm=1.078530
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.432412e-01
[S2] stored merged vector for next round verification (round=9)
[S2] DEBUG after merge:  round=9 metric=0.7005 head_norm=0.982365 delta_norm=0.343241
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=9 metric=0.4171 head_norm=0.747406
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.635714e-01
[S7] stored merged vector for next round verification (round=9)
[S7] DEBUG after merge:  round=9 metric=0.4167 head_norm=0.702739 delta_norm=0.363571
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=9 metric=0.4178 head_norm=1.343473
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.195485e-01
[S5] stored merged vector for next round verification (round=9)
[S5] DEBUG after merge:  round=9 metric=0.4184 head_norm=0.985619 delta_norm=0.619548
[S5] aggregate: ACCEPT kept=['S10', 'S8'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=9 metric=0.3957 head_norm=0.832728
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.592684e-01
[S14] stored merged vector for next round verification (round=9)
[S14] DEBUG after merge:  round=9 metric=0.3957 head_norm=0.869571 delta_norm=0.259268
[S14] aggregate: ACCEPT kept=['S15', 'S4'] (k=2/2) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=0.982365 cos_to_last_merge=1.0000 (last merge round=9)
[S2] round=10 local utility u=0.037385 metrics={'f1_val': 0.7010442512460525, 'auprc': 0.7159913709201787, 'loss_val': 0.38227059047405704, 'psi': 0.7070230991157029}-{'f1_val': 0.7010542679632784, 'auprc': 0.679139708353731, 'loss_val': 0.34654559219599856, 'psi': 0.6922884441194594}
[S3] START round=10 head_norm_before_train=1.472584 (no previous merge yet)
[S3] round=10 local utility u=0.214323 metrics={'f1_val': 0.700330919019862, 'auprc': 0.998665991960758, 'loss_val': 0.39222030939638797, 'psi': 0.8196649481962204}-{'f1_val': 0.6469816006145771, 'auprc': 0.9985059619048627, 'loss_val': 0.5002900971441255, 'psi': 0.7875913451306913}
[S4] START round=10 head_norm_before_train=1.470484 cos_to_last_merge=0.8683 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.868
[S4] round=10 local utility u=0.000000 metrics={'f1_val': 0.940921601389373, 'auprc': 0.9422287230754689, 'loss_val': 0.2930098991992016, 'psi': 0.9414444500638113}-{'f1_val': 0.9436600691175803, 'auprc': 0.9655487750013974, 'loss_val': 0.3245874431711888, 'psi': 0.9524155514711071}
[S5] START round=10 head_norm_before_train=0.985619 cos_to_last_merge=1.0000 (last merge round=9)
[S5] round=10 local utility u=0.904384 metrics={'f1_val': 0.7152792945431001, 'auprc': 0.7773041527633687, 'loss_val': 0.8376242502784285, 'psi': 0.7400892378312076}-{'f1_val': 0.41778804395810054, 'auprc': 0.777653927760699, 'loss_val': 0.8624930790857122, 'psi': 0.56173439747914}
[S6] START round=10 head_norm_before_train=1.357700 cos_to_last_merge=0.8844 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.884
[S6] round=10 local utility u=0.076310 metrics={'f1_val': 0.6429970356288788, 'auprc': 0.8243015715701357, 'loss_val': 0.4762949406685018, 'psi': 0.7155188500053815}-{'f1_val': 0.6203975333601128, 'auprc': 0.8212386756711543, 'loss_val': 0.48412947041326126, 'psi': 0.7007339902845293}
[S7] START round=10 head_norm_before_train=0.702739 cos_to_last_merge=1.0000 (last merge round=9)
[S7] round=10 local utility u=0.000000 metrics={'f1_val': 0.4169130971024577, 'auprc': 0.6228614659506194, 'loss_val': 1.0969674207458247, 'psi': 0.4992924446417224}-{'f1_val': 0.4170778520170104, 'auprc': 0.7631939028881943, 'loss_val': 1.1102712209295573, 'psi': 0.5555242723654841}
[S8] START round=10 head_norm_before_train=1.611411 (no previous merge yet)
[S8] round=10 local utility u=0.000000 metrics={'f1_val': 0.9899101799650861, 'auprc': 0.9990884710601875, 'loss_val': 0.12072236700855354, 'psi': 0.9935814964031267}-{'f1_val': 0.9946517344210846, 'auprc': 0.9991074044087658, 'loss_val': 0.13355096541099834, 'psi': 0.9964340024161571}
[S9] START round=10 head_norm_before_train=0.927014 cos_to_last_merge=0.8664 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.866
[S9] round=10 local utility u=0.501518 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.9993747049596281, 'loss_val': 0.4761612733128229, 'psi': 0.8205686826153568}-{'f1_val': 0.6271113138580939, 'auprc': 0.8668797715206769, 'loss_val': 0.6361931139588881, 'psi': 0.7230186969231271}
[S10] START round=10 head_norm_before_train=1.002438 cos_to_last_merge=0.9947 (last merge round=8)
[S10] round=10 local utility u=0.069130 metrics={'f1_val': 0.7846521167867063, 'auprc': 0.9941603778766327, 'loss_val': 0.2600961761254128, 'psi': 0.8684554212226769}-{'f1_val': 0.7764523407236953, 'auprc': 0.9943508622561852, 'loss_val': 0.34972885566632206, 'psi': 0.8636117493366913}
[S11] START round=10 head_norm_before_train=1.001242 cos_to_last_merge=0.9011 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.901
[S11] round=10 local utility u=0.044941 metrics={'f1_val': 0.39651855440916606, 'auprc': 0.993562287715519, 'loss_val': 0.6629453738880294, 'psi': 0.6353360477317073}-{'f1_val': 0.396484976660716, 'auprc': 0.9905849360940417, 'loss_val': 0.7436931398256122, 'psi': 0.6341249604340463}
[S13] START round=10 head_norm_before_train=0.750729 cos_to_last_merge=1.0000 (last merge round=9)
[S13] round=10 local utility u=0.000000 metrics={'f1_val': 0.6381226151285829, 'auprc': 0.6147444342198195, 'loss_val': 0.7009956648851657, 'psi': 0.6287713427650776}-{'f1_val': 0.6363468871884284, 'auprc': 0.6714607818897291, 'loss_val': 0.5731995170854498, 'psi': 0.6503924450689487}
[S14] START round=10 head_norm_before_train=0.869571 cos_to_last_merge=1.0000 (last merge round=9)
[S14] round=10 local utility u=0.040398 metrics={'f1_val': 0.3958786349245693, 'auprc': 0.9917080758027762, 'loss_val': 0.7713780602473584, 'psi': 0.6342104112758521}-{'f1_val': 0.3956755881566165, 'auprc': 0.9852001864010063, 'loss_val': 0.831433011729305, 'psi': 0.6314854274543724}
[S15] START round=10 head_norm_before_train=1.386066 cos_to_last_merge=0.8608 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.861
[S15] round=10 local utility u=0.324630 metrics={'f1_val': 0.9975205504313366, 'auprc': 0.9981444978412591, 'loss_val': 0.09530715440738641, 'psi': 0.9977701293953056}-{'f1_val': 0.8984854842091042, 'auprc': 0.9989036315624208, 'loss_val': 0.15263450992285846, 'psi': 0.9386527431504309}
[S16] START round=10 head_norm_before_train=1.139182 cos_to_last_merge=0.8890 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.889
[S16] round=10 local utility u=0.358834 metrics={'f1_val': 0.4176961300251269, 'auprc': 0.746497226146778, 'loss_val': 0.8361443852598432, 'psi': 0.5492165684737873}-{'f1_val': 0.3158734264622772, 'auprc': 0.743621078851827, 'loss_val': 0.9342482306954587, 'psi': 0.48697248741809707}
[S17] START round=10 head_norm_before_train=1.579875 (no previous merge yet)
[S17] round=10 local utility u=0.172228 metrics={'f1_val': 0.4193923663146778, 'auprc': 0.8897258732871486, 'loss_val': 0.572621053062115, 'psi': 0.6075257691036662}-{'f1_val': 0.39363619293471774, 'auprc': 0.8471482394436164, 'loss_val': 0.6348068968553457, 'psi': 0.5750410115382771}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:39808
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.998)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S16] → sending delta(kind=head bytes=1806) to S14@127.0.0.1:39814
[S14] not sending this round → trigger blocked (psi=0.634)
[S11] not sending this round → trigger blocked (psi=0.635)
[S10] not sending this round → trigger blocked (psi=0.868)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:39807
[S5] not sending this round → trigger blocked (psi=0.740)
[S3] not sending this round → trigger blocked (psi=0.820)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1806 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1798) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.394568)
[S7] loaded HEAD from S6 (vec_in norm=1.394568)
[S7] cosine check vs S6: cos=0.4954
[S7] BUFFERED delta from S6 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1796) from S9
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.985609)
[S7] loaded HEAD from S9 (vec_in norm=0.985609)
[S7] cosine check vs S9: cos=0.7684
[S7] BUFFERED delta from S9 (total buffered=2)
[S14] RECEIVED delta(kind=head bytes=1806) from S16
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.176854)
[S14] loaded HEAD from S16 (vec_in norm=1.176854)
[S14] cosine check vs S16: cos=0.4349
[S14] BUFFERED delta from S16 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1796) from S2
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.067843)
[S6] loaded HEAD from S2 (vec_in norm=1.067843)
[S6] cosine check vs S2: cos=0.0373
[S6] BUFFERED delta from S2 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:39809
[S17] sending update (kind=head size=1795 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1795) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.610044)
[S8] loaded HEAD from S17 (vec_in norm=1.610044)
[S8] cosine check vs S17: cos=-0.0665
[S8] DROPPED delta from S17 (cos=-0.0665 < 0.0)
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=10 metric=0.4169 head_norm=0.726696
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.545447e-01
[S7] stored merged vector for next round verification (round=10)
[S7] DEBUG after merge:  round=10 metric=0.4169 head_norm=0.807405 delta_norm=0.354545
[S7] aggregate: ACCEPT kept=['S6', 'S9'] (k=2/2) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.275 → S13@127.0.0.1:39813
[S10] ⇄ pheromone p=0.298 → S5@127.0.0.1:39805
[S5] ⇄ pheromone p=0.406 → S3@127.0.0.1:39803
[S13] ⇄ pheromone p=0.280 → S10@127.0.0.1:39811
[S4] ⇄ pheromone p=0.282 → S14@127.0.0.1:39814
[S8] ⇄ pheromone p=0.475 → S5@127.0.0.1:39805
[S3] ⇄ pheromone p=0.404 → S14@127.0.0.1:39814
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=10 metric=0.3959 head_norm=0.921821
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.681565e-01
[S14] stored merged vector for next round verification (round=10)
[S14] DEBUG after merge:  round=10 metric=0.3959 head_norm=0.891385 delta_norm=0.568156
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.297 → S7@127.0.0.1:39808
[S11] ⇄ pheromone p=0.259 → S2@127.0.0.1:39802
[S9] ⇄ pheromone p=0.430 → S7@127.0.0.1:39808
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=10 metric=0.6430 head_norm=1.394568
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.622615e-01
[S6] stored merged vector for next round verification (round=10)
[S6] DEBUG after merge:  round=10 metric=0.8235 head_norm=0.893901 delta_norm=0.862261
[S6] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.346 → S7@127.0.0.1:39808
[S2] ⇄ pheromone p=0.250 → S6@127.0.0.1:39807
[S16] ⇄ pheromone p=0.275 → S14@127.0.0.1:39814
[S15] ⇄ pheromone p=0.387 → S14@127.0.0.1:39814
[S17] ⇄ pheromone p=0.362 → S8@127.0.0.1:39809
[S2] START round=11 head_norm_before_train=1.067843 cos_to_last_merge=0.9936 (last merge round=9)
[S2] round=11 local utility u=0.000000 metrics={'f1_val': 0.7010472986067986, 'auprc': 0.6637694648484762, 'loss_val': 0.33892997116071116, 'psi': 0.6861361651034696}-{'f1_val': 0.7010442512460525, 'auprc': 0.7159913709201787, 'loss_val': 0.38227059047405704, 'psi': 0.7070230991157029}
[S3] START round=11 head_norm_before_train=1.516185 (no previous merge yet)
[S3] round=11 local utility u=0.000000 metrics={'f1_val': 0.6937683940671988, 'auprc': 0.9969436671496209, 'loss_val': 0.3780016590675317, 'psi': 0.8150385033001677}-{'f1_val': 0.700330919019862, 'auprc': 0.998665991960758, 'loss_val': 0.39222030939638797, 'psi': 0.8196649481962204}
[S4] START round=11 head_norm_before_train=1.520088 cos_to_last_merge=0.8623 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.862
[S4] round=11 local utility u=0.000000 metrics={'f1_val': 0.9386070371272084, 'auprc': 0.938236649236075, 'loss_val': 0.2847679742647361, 'psi': 0.938458881970755}-{'f1_val': 0.940921601389373, 'auprc': 0.9422287230754689, 'loss_val': 0.2930098991992016, 'psi': 0.9414444500638113}
[S5] START round=11 head_norm_before_train=1.020860 cos_to_last_merge=0.9977 (last merge round=9)
[S5] round=11 local utility u=0.069865 metrics={'f1_val': 0.7032835269687674, 'auprc': 0.7947219140669834, 'loss_val': 0.6781731256953715, 'psi': 0.7398588818080538}-{'f1_val': 0.7152792945431001, 'auprc': 0.7773041527633687, 'loss_val': 0.8376242502784285, 'psi': 0.7400892378312076}
[S6] START round=11 head_norm_before_train=0.893901 cos_to_last_merge=1.0000 (last merge round=10)
[S6] round=11 local utility u=0.000000 metrics={'f1_val': 0.6184036772798175, 'auprc': 0.8225640065177341, 'loss_val': 0.5720749262263295, 'psi': 0.7000678089749841}-{'f1_val': 0.6429970356288788, 'auprc': 0.8243015715701357, 'loss_val': 0.4762949406685018, 'psi': 0.7155188500053815}
[S7] START round=11 head_norm_before_train=0.807405 cos_to_last_merge=1.0000 (last merge round=10)
[S7] round=11 local utility u=0.339920 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.8038042677374541, 'loss_val': 0.9587372471444942, 'psi': 0.5715477779615956}-{'f1_val': 0.4169130971024577, 'auprc': 0.6228614659506194, 'loss_val': 1.0969674207458247, 'psi': 0.4992924446417224}
[S8] START round=11 head_norm_before_train=1.646274 (no previous merge yet)
[S8] round=11 local utility u=0.029290 metrics={'f1_val': 0.9942060797282372, 'auprc': 0.9991549667110128, 'loss_val': 0.08811761460424193, 'psi': 0.9961856345213473}-{'f1_val': 0.9899101799650861, 'auprc': 0.9990884710601875, 'loss_val': 0.12072236700855354, 'psi': 0.9935814964031267}
[S9] START round=11 head_norm_before_train=0.985609 cos_to_last_merge=0.8473 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.847
[S9] round=11 local utility u=0.048149 metrics={'f1_val': 0.7010401564543445, 'auprc': 0.9987730003715731, 'loss_val': 0.3761113204689184, 'psi': 0.820133294021236}-{'f1_val': 0.7013646677191758, 'auprc': 0.9993747049596281, 'loss_val': 0.4761612733128229, 'psi': 0.8205686826153568}
[S10] START round=11 head_norm_before_train=1.117314 cos_to_last_merge=0.9820 (last merge round=8)
[S10] round=11 local utility u=0.684422 metrics={'f1_val': 0.9939487387271932, 'auprc': 0.9962789164096251, 'loss_val': 0.1533882105605661, 'psi': 0.994880809800166}-{'f1_val': 0.7846521167867063, 'auprc': 0.9941603778766327, 'loss_val': 0.2600961761254128, 'psi': 0.8684554212226769}
[S11] START round=11 head_norm_before_train=1.052072 cos_to_last_merge=0.8840 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.884
[S11] round=11 local utility u=0.473806 metrics={'f1_val': 0.5410958352523494, 'auprc': 0.995108364684585, 'loss_val': 0.5874347134205958, 'psi': 0.7227008470252436}-{'f1_val': 0.39651855440916606, 'auprc': 0.993562287715519, 'loss_val': 0.6629453738880294, 'psi': 0.6353360477317073}
[S13] START round=11 head_norm_before_train=0.812181 cos_to_last_merge=0.9951 (last merge round=9)
[S13] round=11 local utility u=0.000000 metrics={'f1_val': 0.6184290995808712, 'auprc': 0.6406678352498425, 'loss_val': 0.6770508292417287, 'psi': 0.6273245938484597}-{'f1_val': 0.6381226151285829, 'auprc': 0.6147444342198195, 'loss_val': 0.7009956648851657, 'psi': 0.6287713427650776}
[S14] START round=11 head_norm_before_train=0.891385 cos_to_last_merge=1.0000 (last merge round=10)
[S14] round=11 local utility u=0.027656 metrics={'f1_val': 0.3966267743617936, 'auprc': 0.9972516174687686, 'loss_val': 0.7371862384378598, 'psi': 0.6368767116045836}-{'f1_val': 0.3958786349245693, 'auprc': 0.9917080758027762, 'loss_val': 0.7713780602473584, 'psi': 0.6342104112758521}
[S15] START round=11 head_norm_before_train=1.448334 cos_to_last_merge=0.8510 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.851
[S15] round=11 local utility u=0.000000 metrics={'f1_val': 0.9791305869180535, 'auprc': 0.9986691150858195, 'loss_val': 0.0862646283808397, 'psi': 0.9869459981851599}-{'f1_val': 0.9975205504313366, 'auprc': 0.9981444978412591, 'loss_val': 0.09530715440738641, 'psi': 0.9977701293953056}
[S16] START round=11 head_norm_before_train=1.176854 cos_to_last_merge=0.8762 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.876
[S16] round=11 local utility u=0.000000 metrics={'f1_val': 0.4037320511785747, 'auprc': 0.7503682148096538, 'loss_val': 0.7687168450113477, 'psi': 0.5423865166310063}-{'f1_val': 0.4176961300251269, 'auprc': 0.746497226146778, 'loss_val': 0.8361443852598432, 'psi': 0.5492165684737873}
[S17] START round=11 head_norm_before_train=1.610044 (no previous merge yet)
[S17] round=11 local utility u=0.430556 metrics={'f1_val': 0.5517848532309889, 'auprc': 0.8938313374657199, 'loss_val': 0.518180679029247, 'psi': 0.6886034469248813}-{'f1_val': 0.4193923663146778, 'auprc': 0.8897258732871486, 'loss_val': 0.572621053062115, 'psi': 0.6075257691036662}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:39805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S11] → sending delta(kind=head bytes=1791) to S2@127.0.0.1:39802
[S9] not sending this round → trigger blocked (psi=0.820)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S14] → sending delta(kind=head bytes=1791) to S7@127.0.0.1:39808
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:39813
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:39805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:39803
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1791 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1791 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1796) from S7
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.837480)
[S13] loaded HEAD from S7 (vec_in norm=0.837480)
[S13] cosine check vs S7: cos=0.6769
[S13] BUFFERED delta from S7 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1799) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.208053)
[S5] loaded HEAD from S10 (vec_in norm=1.208053)
[S5] cosine check vs S10: cos=0.8196
[S5] BUFFERED delta from S10 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1791) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.936108)
[S7] loaded HEAD from S14 (vec_in norm=0.936108)
[S7] cosine check vs S14: cos=0.6269
[S7] BUFFERED delta from S14 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1791) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.099952)
[S2] loaded HEAD from S11 (vec_in norm=1.099952)
[S2] cosine check vs S11: cos=0.8544
[S2] BUFFERED delta from S11 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1803) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.066546)
[S3] loaded HEAD from S5 (vec_in norm=1.066546)
[S3] cosine check vs S5: cos=-0.0531
[S3] DROPPED delta from S5 (cos=-0.0531 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.689)
[S8] sending update (kind=head size=1797 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1797) from S8
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.677064)
[S5] loaded HEAD from S8 (vec_in norm=1.677064)
[S5] cosine check vs S8: cos=0.3984
[S5] BUFFERED delta from S8 (total buffered=2)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=11 metric=0.7010 head_norm=1.155707
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.055156e-01
[S2] stored merged vector for next round verification (round=11)
[S2] DEBUG after merge:  round=11 metric=0.7010 head_norm=1.086018 delta_norm=0.305516
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=11 metric=0.6184 head_norm=0.885358
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.469054e-01
[S13] stored merged vector for next round verification (round=11)
[S13] DEBUG after merge:  round=11 metric=0.6099 head_norm=0.788842 delta_norm=0.346905
[S13] aggregate: ROLLBACK (f1_val pre=0.618 post=0.610 tol_abs=0.005 tol_rel=0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=11 metric=0.4167 head_norm=0.837480
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.856007e-01
[S7] stored merged vector for next round verification (round=11)
[S7] DEBUG after merge:  round=11 metric=0.4167 head_norm=0.800092 delta_norm=0.385601
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=11 metric=0.7033 head_norm=1.066546
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.315841e-01
[S5] stored merged vector for next round verification (round=11)
[S5] DEBUG after merge:  round=11 metric=0.7011 head_norm=0.997138 delta_norm=0.331584
[S5] aggregate: ACCEPT kept=['S10', 'S8'] (k=2/2) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.086018 cos_to_last_merge=1.0000 (last merge round=11)
[S2] round=12 local utility u=0.000000 metrics={'f1_val': 0.7007873840050607, 'auprc': 0.6645756805103784, 'loss_val': 0.3678943364048339, 'psi': 0.6863027026071877}-{'f1_val': 0.7010472986067986, 'auprc': 0.6637694648484762, 'loss_val': 0.33892997116071116, 'psi': 0.6861361651034696}
[S3] START round=12 head_norm_before_train=1.560314 (no previous merge yet)
[S3] round=12 local utility u=0.000000 metrics={'f1_val': 0.6210077991616557, 'auprc': 0.9917721057080123, 'loss_val': 0.42657069947104537, 'psi': 0.7693135217801984}-{'f1_val': 0.6937683940671988, 'auprc': 0.9969436671496209, 'loss_val': 0.3780016590675317, 'psi': 0.8150385033001677}
[S4] START round=12 head_norm_before_train=1.556720 cos_to_last_merge=0.8583 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.858
[S4] round=12 local utility u=0.048595 metrics={'f1_val': 0.9400256957432969, 'auprc': 0.9625889173970691, 'loss_val': 0.26914716584318293, 'psi': 0.9490509844048057}-{'f1_val': 0.9386070371272084, 'auprc': 0.938236649236075, 'loss_val': 0.2847679742647361, 'psi': 0.938458881970755}
[S5] START round=12 head_norm_before_train=0.997138 cos_to_last_merge=1.0000 (last merge round=11)
[S5] round=12 local utility u=0.009377 metrics={'f1_val': 0.7033300124356763, 'auprc': 0.7901681070306614, 'loss_val': 0.6460371707843819, 'psi': 0.7380652502736704}-{'f1_val': 0.7032835269687674, 'auprc': 0.7947219140669834, 'loss_val': 0.6781731256953715, 'psi': 0.7398588818080538}
[S6] START round=12 head_norm_before_train=0.954656 cos_to_last_merge=0.9969 (last merge round=10)
[S6] round=12 local utility u=0.000000 metrics={'f1_val': 0.6181205235129197, 'auprc': 0.8188509141606806, 'loss_val': 0.5699818737289208, 'psi': 0.698412679772024}-{'f1_val': 0.6184036772798175, 'auprc': 0.8225640065177341, 'loss_val': 0.5720749262263295, 'psi': 0.7000678089749841}
[S7] START round=12 head_norm_before_train=0.800092 cos_to_last_merge=1.0000 (last merge round=11)
[S7] round=12 local utility u=0.010832 metrics={'f1_val': 0.416587999573199, 'auprc': 0.802116911230618, 'loss_val': 0.9312783874380106, 'psi': 0.5707995642361666}-{'f1_val': 0.41671011811102343, 'auprc': 0.8038042677374541, 'loss_val': 0.9587372471444942, 'psi': 0.5715477779615956}
[S8] START round=12 head_norm_before_train=1.677064 (no previous merge yet)
[S8] round=12 local utility u=0.015732 metrics={'f1_val': 0.9961331531268152, 'auprc': 0.999091233658357, 'loss_val': 0.06802550699803948, 'psi': 0.9973163853394318}-{'f1_val': 0.9942060797282372, 'auprc': 0.9991549667110128, 'loss_val': 0.08811761460424193, 'psi': 0.9961856345213473}
[S9] START round=12 head_norm_before_train=1.039760 cos_to_last_merge=0.8302 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.830
[S9] round=12 local utility u=0.037847 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9979447151992481, 'loss_val': 0.29899073929209236, 'psi': 0.8199078345437104}-{'f1_val': 0.7010401564543445, 'auprc': 0.9987730003715731, 'loss_val': 0.3761113204689184, 'psi': 0.820133294021236}
[S10] START round=12 head_norm_before_train=1.208053 cos_to_last_merge=0.9699 (last merge round=8)
[S10] round=12 local utility u=0.018628 metrics={'f1_val': 0.9937298155689185, 'auprc': 0.9961208183027679, 'loss_val': 0.11434503920988397, 'psi': 0.9946862166624582}-{'f1_val': 0.9939487387271932, 'auprc': 0.9962789164096251, 'loss_val': 0.1533882105605661, 'psi': 0.994880809800166}
[S11] START round=12 head_norm_before_train=1.099952 cos_to_last_merge=0.8687 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.869
[S11] round=12 local utility u=0.517462 metrics={'f1_val': 0.7018246587012323, 'auprc': 0.996617306772613, 'loss_val': 0.5214107878050047, 'psi': 0.8197417179297846}-{'f1_val': 0.5410958352523494, 'auprc': 0.995108364684585, 'loss_val': 0.5874347134205958, 'psi': 0.7227008470252436}
[S13] START round=12 head_norm_before_train=0.788842 cos_to_last_merge=1.0000 (last merge round=11)
[S13] round=12 local utility u=0.000000 metrics={'f1_val': 0.6120904321104884, 'auprc': 0.6618314793914539, 'loss_val': 0.7439944106401373, 'psi': 0.6319868510228746}-{'f1_val': 0.6184290995808712, 'auprc': 0.6406678352498425, 'loss_val': 0.6770508292417287, 'psi': 0.6273245938484597}
[S14] START round=12 head_norm_before_train=0.936108 cos_to_last_merge=0.9957 (last merge round=10)
[S14] round=12 local utility u=0.039398 metrics={'f1_val': 0.3964230218922832, 'auprc': 0.9979030245102405, 'loss_val': 0.6591219607476692, 'psi': 0.6370150229394661}-{'f1_val': 0.3966267743617936, 'auprc': 0.9972516174687686, 'loss_val': 0.7371862384378598, 'psi': 0.6368767116045836}
[S15] START round=12 head_norm_before_train=1.500509 cos_to_last_merge=0.8438 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.844
[S15] round=12 local utility u=0.070295 metrics={'f1_val': 0.9965781614883724, 'auprc': 0.9985384178865211, 'loss_val': 0.04996792678611387, 'psi': 0.9973622640476318}-{'f1_val': 0.9791305869180535, 'auprc': 0.9986691150858195, 'loss_val': 0.0862646283808397, 'psi': 0.9869459981851599}
[S16] START round=12 head_norm_before_train=1.211914 cos_to_last_merge=0.8651 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.865
[S16] round=12 local utility u=0.251213 metrics={'f1_val': 0.4771414460426876, 'auprc': 0.759168755203592, 'loss_val': 0.7331488549689597, 'psi': 0.5899523697070493}-{'f1_val': 0.4037320511785747, 'auprc': 0.7503682148096538, 'loss_val': 0.7687168450113477, 'psi': 0.5423865166310063}
[S17] START round=12 head_norm_before_train=1.647120 (no previous merge yet)
[S17] round=12 local utility u=0.478002 metrics={'f1_val': 0.6725680122569253, 'auprc': 0.946569522083889, 'loss_val': 0.4450894947795471, 'psi': 0.7821686161877108}-{'f1_val': 0.5517848532309889, 'auprc': 0.8938313374657199, 'loss_val': 0.518180679029247, 'psi': 0.6886034469248813}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:39813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:39805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:39803
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:39802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:39814
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:39814
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:39814
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:39805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S9] → sending delta(kind=head bytes=1790) to S7@127.0.0.1:39808
[S9] sending update (kind=head size=1790 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1804 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1802) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.291195)
[S5] loaded HEAD from S10 (vec_in norm=1.291195)
[S5] cosine check vs S10: cos=0.7383
[S5] BUFFERED delta from S10 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1801) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.548727)
[S14] loaded HEAD from S15 (vec_in norm=1.548727)
[S14] cosine check vs S15: cos=0.6287
[S14] BUFFERED delta from S15 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1799) from S8
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.712122)
[S5] loaded HEAD from S8 (vec_in norm=1.712122)
[S5] cosine check vs S8: cos=0.6147
[S5] BUFFERED delta from S8 (total buffered=2)
[S7] RECEIVED delta(kind=head bytes=1790) from S9
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.089654)
[S7] loaded HEAD from S9 (vec_in norm=1.089654)
[S7] cosine check vs S9: cos=0.7198
[S7] BUFFERED delta from S9 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1804) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.044024)
[S3] loaded HEAD from S5 (vec_in norm=1.044024)
[S3] cosine check vs S5: cos=-0.0735
[S3] DROPPED delta from S5 (cos=-0.0735 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1795) from S7
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.833311)
[S13] loaded HEAD from S7 (vec_in norm=0.833311)
[S13] cosine check vs S7: cos=0.7532
[S13] BUFFERED delta from S7 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1797) from S4
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.588855)
[S14] loaded HEAD from S4 (vec_in norm=1.588855)
[S14] cosine check vs S4: cos=0.2816
[S14] BUFFERED delta from S4 (total buffered=2)
[S14] RECEIVED delta(kind=head bytes=1801) from S16
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.249770)
[S14] loaded HEAD from S16 (vec_in norm=1.249770)
[S14] cosine check vs S16: cos=0.8431
[S14] BUFFERED delta from S16 (total buffered=3)
[S7] RECEIVED delta(kind=head bytes=1797) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.973760)
[S7] loaded HEAD from S14 (vec_in norm=0.973760)
[S7] cosine check vs S14: cos=0.8950
[S7] BUFFERED delta from S14 (total buffered=2)
[S2] RECEIVED delta(kind=head bytes=1795) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.147835)
[S2] loaded HEAD from S11 (vec_in norm=1.147835)
[S2] cosine check vs S11: cos=0.9287
[S2] BUFFERED delta from S11 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:39809
[S17] sending update (kind=head size=1805 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1805) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.701709)
[S8] loaded HEAD from S17 (vec_in norm=1.701709)
[S8] cosine check vs S17: cos=-0.0658
[S8] DROPPED delta from S17 (cos=-0.0658 < 0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=12 metric=0.6121 head_norm=0.860040
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.976629e-01
[S13] stored merged vector for next round verification (round=12)
[S13] DEBUG after merge:  round=12 metric=0.6139 head_norm=0.792738 delta_norm=0.297663
[S13] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=12 metric=0.7008 head_norm=1.158813
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.178668e-01
[S2] stored merged vector for next round verification (round=12)
[S2] DEBUG after merge:  round=12 metric=0.7004 head_norm=1.132573 delta_norm=0.217867
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=12 metric=0.4166 head_norm=0.833311
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.649323e-01
[S7] stored merged vector for next round verification (round=12)
[S7] DEBUG after merge:  round=12 metric=0.4166 head_norm=0.846827 delta_norm=0.164932
[S7] aggregate: ACCEPT kept=['S9', 'S14'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=12 metric=0.3964 head_norm=0.973760
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.652239e-01
[S14] stored merged vector for next round verification (round=12)
[S14] DEBUG after merge:  round=12 metric=0.3964 head_norm=0.950475 delta_norm=0.165224
[S14] aggregate: ACCEPT kept=['S15', 'S4', 'S16'] (k=3/3) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=12 metric=0.7033 head_norm=1.044024
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.917218e-01
[S5] stored merged vector for next round verification (round=12)
[S5] DEBUG after merge:  round=12 metric=0.7009 head_norm=1.041024 delta_norm=0.191722
[S5] aggregate: ACCEPT kept=['S10', 'S8'] (k=2/2) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.132573 cos_to_last_merge=1.0000 (last merge round=12)
[S2] round=13 local utility u=0.000000 metrics={'f1_val': 0.7007799878975967, 'auprc': 0.6660393842195107, 'loss_val': 0.37763484936178493, 'psi': 0.6868837464263623}-{'f1_val': 0.7007873840050607, 'auprc': 0.6645756805103784, 'loss_val': 0.3678943364048339, 'psi': 0.6863027026071877}
[S3] START round=13 head_norm_before_train=1.601069 (no previous merge yet)
[S3] round=13 local utility u=0.313727 metrics={'f1_val': 0.7005813959920884, 'auprc': 0.9952805289335862, 'loss_val': 0.2870838420471195, 'psi': 0.8184610491686874}-{'f1_val': 0.6210077991616557, 'auprc': 0.9917721057080123, 'loss_val': 0.42657069947104537, 'psi': 0.7693135217801984}
[S4] START round=13 head_norm_before_train=1.588855 cos_to_last_merge=0.8547 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.855
[S4] round=13 local utility u=0.000000 metrics={'f1_val': 0.9403435049880682, 'auprc': 0.9549097196075145, 'loss_val': 0.2702275904530657, 'psi': 0.9461699908358467}-{'f1_val': 0.9400256957432969, 'auprc': 0.9625889173970691, 'loss_val': 0.26914716584318293, 'psi': 0.9490509844048057}
[S5] START round=13 head_norm_before_train=1.041024 cos_to_last_merge=1.0000 (last merge round=12)
[S5] round=13 local utility u=0.000000 metrics={'f1_val': 0.7006570123684102, 'auprc': 0.6740706414028798, 'loss_val': 0.5480094998433815, 'psi': 0.690022463982198}-{'f1_val': 0.7033300124356763, 'auprc': 0.7901681070306614, 'loss_val': 0.6460371707843819, 'psi': 0.7380652502736704}
[S6] START round=13 head_norm_before_train=1.024012 cos_to_last_merge=0.9888 (last merge round=10)
[S6] round=13 local utility u=0.906854 metrics={'f1_val': 0.8220231267677683, 'auprc': 0.9672528913015818, 'loss_val': 0.4248945578314031, 'psi': 0.8801150325812936}-{'f1_val': 0.6181205235129197, 'auprc': 0.8188509141606806, 'loss_val': 0.5699818737289208, 'psi': 0.698412679772024}
[S7] START round=13 head_norm_before_train=0.846827 cos_to_last_merge=1.0000 (last merge round=12)
[S7] round=13 local utility u=0.055086 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.8249496663587558, 'loss_val': 0.8903373592047961, 'psi': 0.5800059374101163}-{'f1_val': 0.416587999573199, 'auprc': 0.802116911230618, 'loss_val': 0.9312783874380106, 'psi': 0.5707995642361666}
[S8] START round=13 head_norm_before_train=1.712122 (no previous merge yet)
[S8] round=13 local utility u=0.000000 metrics={'f1_val': 0.7142391053978291, 'auprc': 0.9989224538920409, 'loss_val': 0.23439626690597679, 'psi': 0.8281124447955139}-{'f1_val': 0.9961331531268152, 'auprc': 0.999091233658357, 'loss_val': 0.06802550699803948, 'psi': 0.9973163853394318}
[S9] START round=13 head_norm_before_train=1.089654 cos_to_last_merge=0.8150 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.815
[S9] round=13 local utility u=0.000000 metrics={'f1_val': 0.49971511711731603, 'auprc': 0.8645890842304389, 'loss_val': 0.5222374810518938, 'psi': 0.6456647039625651}-{'f1_val': 0.7012165807733519, 'auprc': 0.9979447151992481, 'loss_val': 0.29899073929209236, 'psi': 0.8199078345437104}
[S10] START round=13 head_norm_before_train=1.291195 cos_to_last_merge=0.9585 (last merge round=8)
[S10] round=13 local utility u=0.007546 metrics={'f1_val': 0.9942095620893685, 'auprc': 0.9934826342435172, 'loss_val': 0.0942159882156571, 'psi': 0.9939187909510281}-{'f1_val': 0.9937298155689185, 'auprc': 0.9961208183027679, 'loss_val': 0.11434503920988397, 'psi': 0.9946862166624582}
[S11] START round=13 head_norm_before_train=1.147835 cos_to_last_merge=0.8555 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.856
[S11] round=13 local utility u=0.041228 metrics={'f1_val': 0.7023082095754619, 'auprc': 0.9971147044205815, 'loss_val': 0.4433482928009089, 'psi': 0.8202308075135097}-{'f1_val': 0.7018246587012323, 'auprc': 0.996617306772613, 'loss_val': 0.5214107878050047, 'psi': 0.8197417179297846}
[S13] START round=13 head_norm_before_train=0.792738 cos_to_last_merge=1.0000 (last merge round=12)
[S13] round=13 local utility u=0.066309 metrics={'f1_val': 0.6345076511428507, 'auprc': 0.6480295725698689, 'loss_val': 0.704473935734362, 'psi': 0.639916419713658}-{'f1_val': 0.6120904321104884, 'auprc': 0.6618314793914539, 'loss_val': 0.7439944106401373, 'psi': 0.6319868510228746}
[S14] START round=13 head_norm_before_train=0.950475 cos_to_last_merge=1.0000 (last merge round=12)
[S14] round=13 local utility u=0.382972 metrics={'f1_val': 0.515611753269254, 'auprc': 0.9985201598512419, 'loss_val': 0.6101623653579595, 'psi': 0.7087751159020492}-{'f1_val': 0.3964230218922832, 'auprc': 0.9979030245102405, 'loss_val': 0.6591219607476692, 'psi': 0.6370150229394661}
[S15] START round=13 head_norm_before_train=1.548727 cos_to_last_merge=0.8380 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.838
[S15] round=13 local utility u=0.000000 metrics={'f1_val': 0.82757510721754, 'auprc': 0.9977662845484112, 'loss_val': 0.26432759285009944, 'psi': 0.8956515781498885}-{'f1_val': 0.9965781614883724, 'auprc': 0.9985384178865211, 'loss_val': 0.04996792678611387, 'psi': 0.9973622640476318}
[S16] START round=13 head_norm_before_train=1.249770 cos_to_last_merge=0.8556 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.856
[S16] round=13 local utility u=0.000000 metrics={'f1_val': 0.43592840956038403, 'auprc': 0.7678541573352206, 'loss_val': 0.7229607040649491, 'psi': 0.5686987086703186}-{'f1_val': 0.4771414460426876, 'auprc': 0.759168755203592, 'loss_val': 0.7331488549689597, 'psi': 0.5899523697070493}
[S17] START round=13 head_norm_before_train=1.701709 (no previous merge yet)
[S17] round=13 local utility u=0.000000 metrics={'f1_val': 0.6783680046319331, 'auprc': 0.9235351434591879, 'loss_val': 0.47508265400608496, 'psi': 0.776434860162835}-{'f1_val': 0.6725680122569253, 'auprc': 0.946569522083889, 'loss_val': 0.4450894947795471, 'psi': 0.7821686161877108}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:39802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:39808
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:39813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:39814
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:39805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] → sending delta(kind=head bytes=1792) to S7@127.0.0.1:39808
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:39811
[S14] sending update (kind=head size=1792 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1794 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1803) from S13
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=0.868405)
[S10] loaded HEAD from S13 (vec_in norm=0.868405)
[S10] cosine check vs S13: cos=0.2964
[S10] BUFFERED delta from S13 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1799) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.367037)
[S5] loaded HEAD from S10 (vec_in norm=1.367037)
[S5] cosine check vs S10: cos=0.6828
[S5] BUFFERED delta from S10 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1792) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.983331)
[S7] loaded HEAD from S14 (vec_in norm=0.983331)
[S7] cosine check vs S14: cos=0.8658
[S7] BUFFERED delta from S14 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1798) from S7
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.882022)
[S13] loaded HEAD from S7 (vec_in norm=0.882022)
[S13] cosine check vs S7: cos=0.8833
[S13] BUFFERED delta from S7 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1800) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.083848)
[S7] loaded HEAD from S6 (vec_in norm=1.083848)
[S7] cosine check vs S6: cos=0.4520
[S7] BUFFERED delta from S6 (total buffered=2)
[S14] RECEIVED delta(kind=head bytes=1794) from S3
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.639375)
[S14] loaded HEAD from S3 (vec_in norm=1.639375)
[S14] cosine check vs S3: cos=-0.0346
[S14] DROPPED delta from S3 (cos=-0.0346 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1798) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.194065)
[S2] loaded HEAD from S11 (vec_in norm=1.194065)
[S2] cosine check vs S11: cos=0.9528
[S2] BUFFERED delta from S11 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=13 metric=0.7008 head_norm=1.207254
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.846324e-01
[S2] stored merged vector for next round verification (round=13)
[S2] DEBUG after merge:  round=13 metric=0.7004 head_norm=1.186396 delta_norm=0.184632
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=13 metric=0.7007 head_norm=1.082772
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.049151e-01
[S5] stored merged vector for next round verification (round=13)
[S5] DEBUG after merge:  round=13 metric=0.7007 head_norm=1.125013 delta_norm=0.504915
[S5] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=13 metric=0.9942 head_norm=1.367037
[S10] _apply_head_vector_avg (torch): Δ‖w‖=6.926766e-01
[S10] stored merged vector for next round verification (round=13)
[S10] DEBUG after merge:  round=13 metric=0.9942 head_norm=0.911953 delta_norm=0.692677
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=13 metric=0.4167 head_norm=0.882022
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.613064e-01
[S7] stored merged vector for next round verification (round=13)
[S7] DEBUG after merge:  round=13 metric=0.4167 head_norm=0.812272 delta_norm=0.261306
[S7] aggregate: ACCEPT kept=['S14', 'S6'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=13 metric=0.6345 head_norm=0.868405
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.115093e-01
[S13] stored merged vector for next round verification (round=13)
[S13] DEBUG after merge:  round=13 metric=0.6405 head_norm=0.849299 delta_norm=0.211509
[S13] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.186396 cos_to_last_merge=1.0000 (last merge round=13)
[S2] round=14 local utility u=0.006465 metrics={'f1_val': 0.7000577232972898, 'auprc': 0.6710086783353669, 'loss_val': 0.3752784016564511, 'psi': 0.6884381053125206}-{'f1_val': 0.7007799878975967, 'auprc': 0.6660393842195107, 'loss_val': 0.37763484936178493, 'psi': 0.6868837464263623}
[S3] START round=14 head_norm_before_train=1.639375 (no previous merge yet)
[S3] round=14 local utility u=0.008050 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.9952799507049046, 'loss_val': 0.2724850099383511, 'psi': 0.8186110212972483}-{'f1_val': 0.7005813959920884, 'auprc': 0.9952805289335862, 'loss_val': 0.2870838420471195, 'psi': 0.8184610491686874}
[S4] START round=14 head_norm_before_train=1.618102 cos_to_last_merge=0.8514 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.851
[S4] round=14 local utility u=0.000000 metrics={'f1_val': 0.9397622363291247, 'auprc': 0.9212395089950177, 'loss_val': 0.31232396237427623, 'psi': 0.9323531453954819}-{'f1_val': 0.9403435049880682, 'auprc': 0.9549097196075145, 'loss_val': 0.2702275904530657, 'psi': 0.9461699908358467}
[S5] START round=14 head_norm_before_train=1.125013 cos_to_last_merge=1.0000 (last merge round=13)
[S5] round=14 local utility u=0.196124 metrics={'f1_val': 0.6996935283329517, 'auprc': 0.7999867524992202, 'loss_val': 0.5277298813053061, 'psi': 0.7398108179994591}-{'f1_val': 0.7006570123684102, 'auprc': 0.6740706414028798, 'loss_val': 0.5480094998433815, 'psi': 0.690022463982198}
[S6] START round=14 head_norm_before_train=1.083848 cos_to_last_merge=0.9816 (last merge round=10)
[S6] round=14 local utility u=0.507716 metrics={'f1_val': 0.9621476204798034, 'auprc': 0.9753300935025203, 'loss_val': 0.27444110800815885, 'psi': 0.9674206096888902}-{'f1_val': 0.8220231267677683, 'auprc': 0.9672528913015818, 'loss_val': 0.4248945578314031, 'psi': 0.8801150325812936}
[S7] START round=14 head_norm_before_train=0.812272 cos_to_last_merge=1.0000 (last merge round=13)
[S7] round=14 local utility u=0.048632 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.8530335560211318, 'loss_val': 0.8773251780653682, 'psi': 0.5912394932750669}-{'f1_val': 0.41671011811102343, 'auprc': 0.8249496663587558, 'loss_val': 0.8903373592047961, 'psi': 0.5800059374101163}
[S8] START round=14 head_norm_before_train=1.750300 (no previous merge yet)
[S8] round=14 local utility u=0.936984 metrics={'f1_val': 0.995245036696824, 'auprc': 0.9989414300730982, 'loss_val': 0.046521650766747975, 'psi': 0.9967235940473336}-{'f1_val': 0.7142391053978291, 'auprc': 0.9989224538920409, 'loss_val': 0.23439626690597679, 'psi': 0.8281124447955139}
[S9] START round=14 head_norm_before_train=1.136416 cos_to_last_merge=0.8012 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.801
[S9] round=14 local utility u=0.583845 metrics={'f1_val': 0.6283990095706079, 'auprc': 0.939022525886493, 'loss_val': 0.3499504238577686, 'psi': 0.752648416096962}-{'f1_val': 0.49971511711731603, 'auprc': 0.8645890842304389, 'loss_val': 0.5222374810518938, 'psi': 0.6456647039625651}
[S10] START round=14 head_norm_before_train=0.911953 cos_to_last_merge=1.0000 (last merge round=13)
[S10] round=14 local utility u=0.000000 metrics={'f1_val': 0.992869746824563, 'auprc': 0.9931724811276892, 'loss_val': 0.19017299363050363, 'psi': 0.9929908405458134}-{'f1_val': 0.9942095620893685, 'auprc': 0.9934826342435172, 'loss_val': 0.0942159882156571, 'psi': 0.9939187909510281}
[S11] START round=14 head_norm_before_train=1.194065 cos_to_last_merge=0.8448 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.845
[S11] round=14 local utility u=0.041106 metrics={'f1_val': 0.7023082095754619, 'auprc': 0.9967014756828723, 'loss_val': 0.35989575979266913, 'psi': 0.820065516018426}-{'f1_val': 0.7023082095754619, 'auprc': 0.9971147044205815, 'loss_val': 0.4433482928009089, 'psi': 0.8202308075135097}
[S13] START round=14 head_norm_before_train=0.849299 cos_to_last_merge=1.0000 (last merge round=13)
[S13] round=14 local utility u=0.001318 metrics={'f1_val': 0.6337073074415541, 'auprc': 0.6466374896405662, 'loss_val': 0.6928599625773944, 'psi': 0.638879380321159}-{'f1_val': 0.6345076511428507, 'auprc': 0.6480295725698689, 'loss_val': 0.704473935734362, 'psi': 0.639916419713658}
[S14] START round=14 head_norm_before_train=0.983331 cos_to_last_merge=0.9985 (last merge round=12)
[S14] round=14 local utility u=0.699157 metrics={'f1_val': 0.730006794491557, 'auprc': 0.9984740589670477, 'loss_val': 0.4980807399158224, 'psi': 0.8373937002817533}-{'f1_val': 0.515611753269254, 'auprc': 0.9985201598512419, 'loss_val': 0.6101623653579595, 'psi': 0.7087751159020492}
[S15] START round=14 head_norm_before_train=1.591450 cos_to_last_merge=0.8335 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.833
[S15] round=14 local utility u=0.607212 metrics={'f1_val': 0.9926967068528543, 'auprc': 0.9996977886831346, 'loss_val': 0.046428479938193254, 'psi': 0.9954971395849663}-{'f1_val': 0.82757510721754, 'auprc': 0.9977662845484112, 'loss_val': 0.26432759285009944, 'psi': 0.8956515781498885}
[S16] START round=14 head_norm_before_train=1.285663 cos_to_last_merge=0.8479 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.848
[S16] round=14 local utility u=0.274174 metrics={'f1_val': 0.49436945061945065, 'auprc': 0.7979611899923287, 'loss_val': 0.6155808876356108, 'psi': 0.6158061463686019}-{'f1_val': 0.43592840956038403, 'auprc': 0.7678541573352206, 'loss_val': 0.7229607040649491, 'psi': 0.5686987086703186}
[S17] START round=14 head_norm_before_train=1.757159 (no previous merge yet)
[S17] round=14 local utility u=0.000000 metrics={'f1_val': 0.5544458438115634, 'auprc': 0.7739156733731926, 'loss_val': 0.7840109505199174, 'psi': 0.6422337756362151}-{'f1_val': 0.6783680046319331, 'auprc': 0.9235351434591879, 'loss_val': 0.47508265400608496, 'psi': 0.776434860162835}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:39813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:39805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:39807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:39811
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:39814
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:39803
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:39802
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:39814
[S16] sending update (kind=head size=1804 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1804) from S16
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.321159)
[S14] loaded HEAD from S16 (vec_in norm=1.321159)
[S14] cosine check vs S16: cos=0.8115
[S14] BUFFERED delta from S16 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1796) from S9
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.176993)
[S7] loaded HEAD from S9 (vec_in norm=1.176993)
[S7] cosine check vs S9: cos=0.7004
[S7] BUFFERED delta from S9 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1800) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.141082)
[S7] loaded HEAD from S6 (vec_in norm=1.141082)
[S7] cosine check vs S6: cos=0.6533
[S7] BUFFERED delta from S6 (total buffered=2)
[S3] RECEIVED delta(kind=head bytes=1803) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.164561)
[S3] loaded HEAD from S5 (vec_in norm=1.164561)
[S3] cosine check vs S5: cos=-0.0750
[S3] DROPPED delta from S5 (cos=-0.0750 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1795) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.019390)
[S7] loaded HEAD from S14 (vec_in norm=1.019390)
[S7] cosine check vs S14: cos=0.8502
[S7] BUFFERED delta from S14 (total buffered=3)
[S5] RECEIVED delta(kind=head bytes=1802) from S8
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.781006)
[S5] loaded HEAD from S8 (vec_in norm=1.781006)
[S5] cosine check vs S8: cos=0.3363
[S5] BUFFERED delta from S8 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1802) from S13
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=0.936827)
[S10] loaded HEAD from S13 (vec_in norm=0.936827)
[S10] cosine check vs S13: cos=0.6210
[S10] BUFFERED delta from S13 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1795) from S7
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.843896)
[S13] loaded HEAD from S7 (vec_in norm=0.843896)
[S13] cosine check vs S7: cos=0.8950
[S13] BUFFERED delta from S7 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1799) from S2
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.254520)
[S6] loaded HEAD from S2 (vec_in norm=1.254520)
[S6] cosine check vs S2: cos=0.4967
[S6] BUFFERED delta from S2 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1799) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.237847)
[S2] loaded HEAD from S11 (vec_in norm=1.237847)
[S2] cosine check vs S11: cos=0.9648
[S2] BUFFERED delta from S11 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1795) from S3
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.670678)
[S14] loaded HEAD from S3 (vec_in norm=1.670678)
[S14] cosine check vs S3: cos=-0.0366
[S14] DROPPED delta from S3 (cos=-0.0366 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1801) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.625789)
[S14] loaded HEAD from S15 (vec_in norm=1.625789)
[S14] cosine check vs S15: cos=0.6987
[S14] BUFFERED delta from S15 (total buffered=2)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=14 metric=0.9929 head_norm=1.016732
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.267210e-01
[S10] stored merged vector for next round verification (round=14)
[S10] DEBUG after merge:  round=14 metric=0.9929 head_norm=0.879548 delta_norm=0.426721
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=14 metric=0.9621 head_norm=1.141082
[S6] _apply_head_vector_avg (torch): Δ‖w‖=6.028616e-01
[S6] stored merged vector for next round verification (round=14)
[S6] DEBUG after merge:  round=14 metric=0.9626 head_norm=1.036582 delta_norm=0.602862
[S6] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=14 metric=0.7001 head_norm=1.254520
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.655366e-01
[S2] stored merged vector for next round verification (round=14)
[S2] DEBUG after merge:  round=14 metric=0.6997 head_norm=1.235168 delta_norm=0.165537
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=14 metric=0.6997 head_norm=1.164561
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.850120e-01
[S5] stored merged vector for next round verification (round=14)
[S5] DEBUG after merge:  round=14 metric=0.7008 head_norm=1.216900 delta_norm=0.885012
[S5] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=14 metric=0.7300 head_norm=1.019390
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.906806e-01
[S14] stored merged vector for next round verification (round=14)
[S14] DEBUG after merge:  round=14 metric=0.6877 head_norm=1.099962 delta_norm=0.290681
[S14] aggregate: ROLLBACK (f1_val pre=0.730 post=0.688 tol_abs=0.005 tol_rel=0.0)
[S7] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=14 metric=0.4167 head_norm=0.843896
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.147722e-01
[S7] stored merged vector for next round verification (round=14)
[S7] DEBUG after merge:  round=14 metric=0.4167 head_norm=0.838830 delta_norm=0.114772
[S7] aggregate: ACCEPT kept=['S9', 'S6', 'S14'] (k=3/3) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=14 metric=0.6337 head_norm=0.936827
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.089818e-01
[S13] stored merged vector for next round verification (round=14)
[S13] DEBUG after merge:  round=14 metric=0.6345 head_norm=0.866735 delta_norm=0.208982
[S13] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.235168 cos_to_last_merge=1.0000 (last merge round=14)
[S2] round=15 local utility u=0.193201 metrics={'f1_val': 0.7071424858409158, 'auprc': 0.7859221776353364, 'loss_val': 0.3761258867893918, 'psi': 0.7386543625586841}-{'f1_val': 0.7000577232972898, 'auprc': 0.6710086783353669, 'loss_val': 0.3752784016564511, 'psi': 0.6884381053125206}
[S3] START round=15 head_norm_before_train=1.670678 (no previous merge yet)
[S3] round=15 local utility u=0.000000 metrics={'f1_val': 0.7008362290767893, 'auprc': 0.9941683700237558, 'loss_val': 0.27568482416406176, 'psi': 0.8181690854555759}-{'f1_val': 0.7008317350254774, 'auprc': 0.9952799507049046, 'loss_val': 0.2724850099383511, 'psi': 0.8186110212972483}
[S4] START round=15 head_norm_before_train=1.644224 cos_to_last_merge=0.8488 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.849
[S4] round=15 local utility u=0.000000 metrics={'f1_val': 0.755217094029541, 'auprc': 0.9119560333088428, 'loss_val': 0.4636798501854029, 'psi': 0.8179126697412616}-{'f1_val': 0.9397622363291247, 'auprc': 0.9212395089950177, 'loss_val': 0.31232396237427623, 'psi': 0.9323531453954819}
[S5] START round=15 head_norm_before_train=1.216900 cos_to_last_merge=1.0000 (last merge round=14)
[S5] round=15 local utility u=0.060315 metrics={'f1_val': 0.7006953490578625, 'auprc': 0.8347795383445915, 'loss_val': 0.517489458123421, 'psi': 0.754329024772554}-{'f1_val': 0.6996935283329517, 'auprc': 0.7999867524992202, 'loss_val': 0.5277298813053061, 'psi': 0.7398108179994591}
[S6] START round=15 head_norm_before_train=1.036582 cos_to_last_merge=1.0000 (last merge round=14)
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.8205780316636491, 'auprc': 0.8175704377879647, 'loss_val': 0.5510576171387318, 'psi': 0.8193749941133753}-{'f1_val': 0.9621476204798034, 'auprc': 0.9753300935025203, 'loss_val': 0.27444110800815885, 'psi': 0.9674206096888902}
[S7] START round=15 head_norm_before_train=0.838830 cos_to_last_merge=1.0000 (last merge round=14)
[S7] round=15 local utility u=0.000000 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.7897098051157736, 'loss_val': 0.8443594872088903, 'psi': 0.5659099929129234}-{'f1_val': 0.41671011811102343, 'auprc': 0.8530335560211318, 'loss_val': 0.8773251780653682, 'psi': 0.5912394932750669}
[S8] START round=15 head_norm_before_train=1.781006 (no previous merge yet)
[S8] round=15 local utility u=0.000000 metrics={'f1_val': 0.9930102130034458, 'auprc': 0.9989258713440986, 'loss_val': 0.04629574421401936, 'psi': 0.9953764763397068}-{'f1_val': 0.995245036696824, 'auprc': 0.9989414300730982, 'loss_val': 0.046521650766747975, 'psi': 0.9967235940473336}
[S9] START round=15 head_norm_before_train=1.176993 cos_to_last_merge=0.7903 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.790
[S9] round=15 local utility u=1.000000 metrics={'f1_val': 0.9886727075027679, 'auprc': 0.9949782752583298, 'loss_val': 0.19415711852969986, 'psi': 0.9911949346049926}-{'f1_val': 0.6283990095706079, 'auprc': 0.939022525886493, 'loss_val': 0.3499504238577686, 'psi': 0.752648416096962}
[S10] START round=15 head_norm_before_train=0.879548 cos_to_last_merge=1.0000 (last merge round=14)
[S10] round=15 local utility u=0.000000 metrics={'f1_val': 0.9865554262931129, 'auprc': 0.9856651855039188, 'loss_val': 0.2527839960006319, 'psi': 0.9861993299774353}-{'f1_val': 0.992869746824563, 'auprc': 0.9931724811276892, 'loss_val': 0.19017299363050363, 'psi': 0.9929908405458134}
[S11] START round=15 head_norm_before_train=1.237847 cos_to_last_merge=0.8359 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.836
[S11] round=15 local utility u=0.805521 metrics={'f1_val': 0.9554780858218375, 'auprc': 0.9976919462305941, 'loss_val': 0.27084452533660547, 'psi': 0.9723636299853401}-{'f1_val': 0.7023082095754619, 'auprc': 0.9967014756828723, 'loss_val': 0.35989575979266913, 'psi': 0.820065516018426}
[S13] START round=15 head_norm_before_train=0.866735 cos_to_last_merge=1.0000 (last merge round=14)
[S13] round=15 local utility u=0.000000 metrics={'f1_val': 0.626768711182468, 'auprc': 0.6458784521639149, 'loss_val': 0.7112180208624812, 'psi': 0.6344126075750467}-{'f1_val': 0.6337073074415541, 'auprc': 0.6466374896405662, 'loss_val': 0.6928599625773944, 'psi': 0.638879380321159}
[S14] START round=15 head_norm_before_train=1.099962 cos_to_last_merge=1.0000 (last merge round=14)
[S14] round=15 local utility u=0.840193 metrics={'f1_val': 0.9974938618384707, 'auprc': 0.9967030068657662, 'loss_val': 0.4173031388323436, 'psi': 0.9971775198493888}-{'f1_val': 0.730006794491557, 'auprc': 0.9984740589670477, 'loss_val': 0.4980807399158224, 'psi': 0.8373937002817533}
[S15] START round=15 head_norm_before_train=1.625789 cos_to_last_merge=0.8298 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.830
[S15] round=15 local utility u=0.017180 metrics={'f1_val': 0.9974605999319422, 'auprc': 0.9986560513995639, 'loss_val': 0.03752651480061836, 'psi': 0.997938780518991}-{'f1_val': 0.9926967068528543, 'auprc': 0.9996977886831346, 'loss_val': 0.046428479938193254, 'psi': 0.9954971395849663}
[S16] START round=15 head_norm_before_train=1.321159 cos_to_last_merge=0.8401 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.840
[S16] round=15 local utility u=0.317522 metrics={'f1_val': 0.5701608348523418, 'auprc': 0.8471501372796083, 'loss_val': 0.5828518418288422, 'psi': 0.6809565558232484}-{'f1_val': 0.49436945061945065, 'auprc': 0.7979611899923287, 'loss_val': 0.6155808876356108, 'psi': 0.6158061463686019}
[S17] START round=15 head_norm_before_train=1.809853 (no previous merge yet)
[S17] round=15 local utility u=0.417167 metrics={'f1_val': 0.6268083297282742, 'auprc': 0.8706726663053015, 'loss_val': 0.6741223735555152, 'psi': 0.7243540643590851}-{'f1_val': 0.5544458438115634, 'auprc': 0.7739156733731926, 'loss_val': 0.7840109505199174, 'psi': 0.6422337756362151}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:39802
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:39803
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S9] → sending delta(kind=head bytes=1789) to S7@127.0.0.1:39808
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:39814
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:39807
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:39814
[S16] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1789 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1800) from S2
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.297233)
[S6] loaded HEAD from S2 (vec_in norm=1.297233)
[S6] cosine check vs S2: cos=0.8420
[S6] BUFFERED delta from S2 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1789) from S9
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.212187)
[S7] loaded HEAD from S9 (vec_in norm=1.212187)
[S7] cosine check vs S9: cos=0.7705
[S7] BUFFERED delta from S9 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1796) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.137411)
[S7] loaded HEAD from S14 (vec_in norm=1.137411)
[S7] cosine check vs S14: cos=0.7728
[S7] BUFFERED delta from S14 (total buffered=2)
[S3] RECEIVED delta(kind=head bytes=1800) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.250541)
[S3] loaded HEAD from S5 (vec_in norm=1.250541)
[S3] cosine check vs S5: cos=-0.0943
[S3] DROPPED delta from S5 (cos=-0.0943 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1796) from S16
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.358247)
[S14] loaded HEAD from S16 (vec_in norm=1.358247)
[S14] cosine check vs S16: cos=0.8243
[S14] BUFFERED delta from S16 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1800) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.658282)
[S14] loaded HEAD from S15 (vec_in norm=1.658282)
[S14] cosine check vs S15: cos=0.8105
[S14] BUFFERED delta from S15 (total buffered=2)
[S2] RECEIVED delta(kind=head bytes=1795) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.279723)
[S2] loaded HEAD from S11 (vec_in norm=1.279723)
[S2] cosine check vs S11: cos=0.9736
[S2] BUFFERED delta from S11 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:39809
[S17] sending update (kind=head size=1803 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1803) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.856490)
[S8] loaded HEAD from S17 (vec_in norm=1.856490)
[S8] cosine check vs S17: cos=-0.0596
[S8] DROPPED delta from S17 (cos=-0.0596 < 0.0)
[S13] ⇄ pheromone p=0.101 → S10@127.0.0.1:39811
[S10] ⇄ pheromone p=0.157 → S5@127.0.0.1:39805
[S8] ⇄ pheromone p=0.309 → S5@127.0.0.1:39805
[S4] ⇄ pheromone p=0.097 → S14@127.0.0.1:39814
[S3] ⇄ pheromone p=0.174 → S14@127.0.0.1:39814
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=15 metric=0.8206 head_norm=1.088497
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.499591e-01
[S6] stored merged vector for next round verification (round=15)
[S6] DEBUG after merge:  round=15 metric=0.8216 head_norm=1.145141 delta_norm=0.349959
[S6] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.311 → S7@127.0.0.1:39808
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=15 metric=0.4167 head_norm=0.872148
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.176074e-01
[S7] stored merged vector for next round verification (round=15)
[S7] DEBUG after merge:  round=15 metric=0.4167 head_norm=0.915417 delta_norm=0.217607
[S7] aggregate: ACCEPT kept=['S9', 'S14'] (k=2/2) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.134 → S13@127.0.0.1:39813
[S16] ⇄ pheromone p=0.223 → S14@127.0.0.1:39814
[S5] ⇄ pheromone p=0.183 → S3@127.0.0.1:39803
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=15 metric=0.9975 head_norm=1.137411
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.667434e-01
[S14] stored merged vector for next round verification (round=15)
[S14] DEBUG after merge:  round=15 metric=0.9925 head_norm=1.195374 delta_norm=0.166743
[S14] aggregate: ROLLBACK (f1_val pre=0.997 post=0.992 tol_abs=0.005 tol_rel=0.0)
[S14] ⇄ pheromone p=0.433 → S7@127.0.0.1:39808
[S15] ⇄ pheromone p=0.235 → S14@127.0.0.1:39814
[S11] ⇄ pheromone p=0.350 → S2@127.0.0.1:39802
[S9] ⇄ pheromone p=0.442 → S7@127.0.0.1:39808
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=15 metric=0.7071 head_norm=1.297233
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.483497e-01
[S2] stored merged vector for next round verification (round=15)
[S2] DEBUG after merge:  round=15 metric=0.7065 head_norm=1.279940 delta_norm=0.148350
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.122 → S6@127.0.0.1:39807
[S17] ⇄ pheromone p=0.286 → S8@127.0.0.1:39809
[S2] START round=16 head_norm_before_train=1.279940 cos_to_last_merge=1.0000 (last merge round=15)
[S2] round=16 local utility u=0.000000 metrics={'f1_val': 0.713200843344836, 'auprc': 0.7779518954042126, 'loss_val': 0.4586068856879407, 'psi': 0.7391012641685867}-{'f1_val': 0.7071424858409158, 'auprc': 0.7859221776353364, 'loss_val': 0.3761258867893918, 'psi': 0.7386543625586841}
[S3] START round=16 head_norm_before_train=1.694591 (no previous merge yet)
[S3] round=16 local utility u=0.014538 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.996732813191529, 'loss_val': 0.2538211061357736, 'psi': 0.8191468475177914}-{'f1_val': 0.7008362290767893, 'auprc': 0.9941683700237558, 'loss_val': 0.27568482416406176, 'psi': 0.8181690854555759}
[S4] START round=16 head_norm_before_train=1.658492 cos_to_last_merge=0.8481 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.848
[S4] round=16 local utility u=0.678256 metrics={'f1_val': 0.9419188482348404, 'auprc': 0.9281418558609761, 'loss_val': 0.27593574555736816, 'psi': 0.9364080512852947}-{'f1_val': 0.755217094029541, 'auprc': 0.9119560333088428, 'loss_val': 0.4636798501854029, 'psi': 0.8179126697412616}
[S5] START round=16 head_norm_before_train=1.250541 cos_to_last_merge=0.9985 (last merge round=14)
[S5] round=16 local utility u=0.068795 metrics={'f1_val': 0.7006953490578625, 'auprc': 0.854495719601091, 'loss_val': 0.4390488819342334, 'psi': 0.7622154972751538}-{'f1_val': 0.7006953490578625, 'auprc': 0.8347795383445915, 'loss_val': 0.517489458123421, 'psi': 0.754329024772554}
[S6] START round=16 head_norm_before_train=1.145141 cos_to_last_merge=1.0000 (last merge round=15)
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.6785972254570211, 'auprc': 0.8081116380084459, 'loss_val': 0.6164002693928007, 'psi': 0.730402990477591}-{'f1_val': 0.8205780316636491, 'auprc': 0.8175704377879647, 'loss_val': 0.5510576171387318, 'psi': 0.8193749941133753}
[S7] START round=16 head_norm_before_train=0.915417 cos_to_last_merge=1.0000 (last merge round=15)
[S7] round=16 local utility u=0.000996 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.7849174462373556, 'loss_val': 0.8279900256302081, 'psi': 0.5639930493615564}-{'f1_val': 0.41671011811102343, 'auprc': 0.7897098051157736, 'loss_val': 0.8443594872088903, 'psi': 0.5659099929129234}
[S8] START round=16 head_norm_before_train=1.805781 (no previous merge yet)
[S8] round=16 local utility u=0.000000 metrics={'f1_val': 0.9938941842030629, 'auprc': 0.9977454529919301, 'loss_val': 0.06166060325227144, 'psi': 0.9954346917186097}-{'f1_val': 0.9930102130034458, 'auprc': 0.9989258713440986, 'loss_val': 0.04629574421401936, 'psi': 0.9953764763397068}
[S9] START round=16 head_norm_before_train=1.212187 cos_to_last_merge=0.7814 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.781
[S9] round=16 local utility u=0.000000 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9971113929606948, 'loss_val': 0.21377068423750395, 'psi': 0.819574505648289}-{'f1_val': 0.9886727075027679, 'auprc': 0.9949782752583298, 'loss_val': 0.19415711852969986, 'psi': 0.9911949346049926}
[S10] START round=16 head_norm_before_train=1.011495 cos_to_last_merge=0.9823 (last merge round=14)
[S10] round=16 local utility u=0.093437 metrics={'f1_val': 0.992869746824563, 'auprc': 0.9934740319072406, 'loss_val': 0.12722328467294153, 'psi': 0.9931114608576339}-{'f1_val': 0.9865554262931129, 'auprc': 0.9856651855039188, 'loss_val': 0.2527839960006319, 'psi': 0.9861993299774353}
[S11] START round=16 head_norm_before_train=1.279723 cos_to_last_merge=0.8282 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.828
[S11] round=16 local utility u=0.030144 metrics={'f1_val': 0.9581015134257738, 'auprc': 0.9982049711668873, 'loss_val': 0.2278351813302142, 'psi': 0.9741428965222192}-{'f1_val': 0.9554780858218375, 'auprc': 0.9976919462305941, 'loss_val': 0.27084452533660547, 'psi': 0.9723636299853401}
[S13] START round=16 head_norm_before_train=0.938598 cos_to_last_merge=0.9900 (last merge round=14)
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.6118407519349515, 'auprc': 0.6249092329566412, 'loss_val': 0.7202723696230651, 'psi': 0.6170681443436273}-{'f1_val': 0.626768711182468, 'auprc': 0.6458784521639149, 'loss_val': 0.7112180208624812, 'psi': 0.6344126075750467}
[S14] START round=16 head_norm_before_train=1.195374 cos_to_last_merge=1.0000 (last merge round=15)
[S14] round=16 local utility u=0.000000 metrics={'f1_val': 0.95260279405686, 'auprc': 0.998907990785029, 'loss_val': 0.3565430934932456, 'psi': 0.9711248727481275}-{'f1_val': 0.9974938618384707, 'auprc': 0.9967030068657662, 'loss_val': 0.4173031388323436, 'psi': 0.9971775198493888}
[S15] START round=16 head_norm_before_train=1.658282 cos_to_last_merge=0.8266 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.827
[S15] round=16 local utility u=0.000000 metrics={'f1_val': 0.8392373986840789, 'auprc': 0.9931206733505669, 'loss_val': 0.2794973935634137, 'psi': 0.9007907085506741}-{'f1_val': 0.9974605999319422, 'auprc': 0.9986560513995639, 'loss_val': 0.03752651480061836, 'psi': 0.997938780518991}
[S16] START round=16 head_norm_before_train=1.358247 cos_to_last_merge=0.8316 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.832
[S16] round=16 local utility u=0.159798 metrics={'f1_val': 0.5845123181344559, 'auprc': 0.9048034176291799, 'loss_val': 0.5223248187837619, 'psi': 0.7126287579323456}-{'f1_val': 0.5701608348523418, 'auprc': 0.8471501372796083, 'loss_val': 0.5828518418288422, 'psi': 0.6809565558232484}
[S17] START round=16 head_norm_before_train=1.856490 (no previous merge yet)
[S17] round=16 local utility u=0.000000 metrics={'f1_val': 0.5857491989298341, 'auprc': 0.8251365755038766, 'loss_val': 0.9141597913736101, 'psi': 0.6815041495594512}-{'f1_val': 0.6268083297282742, 'auprc': 0.8706726663053015, 'loss_val': 0.6741223735555152, 'psi': 0.7243540643590851}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S16] → sending delta(kind=head bytes=1806) to S14@127.0.0.1:39814
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:39803
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] → sending delta(kind=head bytes=1792) to S2@127.0.0.1:39802
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S13@127.0.0.1:39813
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:39805
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1794 to 1 peers)
[S11] sending update (kind=head size=1792 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1806 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1795) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.161706)
[S5] loaded HEAD from S10 (vec_in norm=1.161706)
[S5] cosine check vs S10: cos=0.3639
[S5] BUFFERED delta from S10 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1798) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.290069)
[S3] loaded HEAD from S5 (vec_in norm=1.290069)
[S3] cosine check vs S5: cos=-0.0962
[S3] DROPPED delta from S5 (cos=-0.0962 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1794) from S7
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.949132)
[S13] loaded HEAD from S7 (vec_in norm=0.949132)
[S13] cosine check vs S7: cos=0.8890
[S13] BUFFERED delta from S7 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1799) from S4
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.677915)
[S14] loaded HEAD from S4 (vec_in norm=1.677915)
[S14] cosine check vs S4: cos=0.0294
[S14] BUFFERED delta from S4 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1797) from S3
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.714534)
[S14] loaded HEAD from S3 (vec_in norm=1.714534)
[S14] cosine check vs S3: cos=-0.0280
[S14] DROPPED delta from S3 (cos=-0.0280 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1806) from S16
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.396999)
[S14] loaded HEAD from S16 (vec_in norm=1.396999)
[S14] cosine check vs S16: cos=0.8170
[S14] BUFFERED delta from S16 (total buffered=2)
[S2] RECEIVED delta(kind=head bytes=1792) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.319098)
[S2] loaded HEAD from S11 (vec_in norm=1.319098)
[S2] cosine check vs S11: cos=0.9796
[S2] BUFFERED delta from S11 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=16 metric=0.9526 head_norm=1.228812
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.422667e-01
[S14] stored merged vector for next round verification (round=16)
[S14] DEBUG after merge:  round=16 metric=0.9427 head_norm=1.012753 delta_norm=0.542267
[S14] aggregate: ROLLBACK (f1_val pre=0.953 post=0.943 tol_abs=0.005 tol_rel=0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=16 metric=0.6118 head_norm=1.001877
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.312047e-01
[S13] stored merged vector for next round verification (round=16)
[S13] DEBUG after merge:  round=16 metric=0.6120 head_norm=0.948077 delta_norm=0.231205
[S13] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=16 metric=0.7132 head_norm=1.336926
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.343997e-01
[S2] stored merged vector for next round verification (round=16)
[S2] DEBUG after merge:  round=16 metric=0.7138 head_norm=1.321224 delta_norm=0.134400
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=16 metric=0.7007 head_norm=1.290069
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.933540e-01
[S5] stored merged vector for next round verification (round=16)
[S5] DEBUG after merge:  round=16 metric=0.6655 head_norm=1.013005 delta_norm=0.693354
[S5] aggregate: ROLLBACK (f1_val pre=0.701 post=0.665 tol_abs=0.005 tol_rel=0.0)
[S2] START round=17 head_norm_before_train=1.321224 cos_to_last_merge=1.0000 (last merge round=16)
[S2] round=17 local utility u=0.118852 metrics={'f1_val': 0.713509988247859, 'auprc': 0.842578700306294, 'loss_val': 0.41663897350859475, 'psi': 0.765137473071233}-{'f1_val': 0.713200843344836, 'auprc': 0.7779518954042126, 'loss_val': 0.4586068856879407, 'psi': 0.7391012641685867}
[S3] START round=17 head_norm_before_train=1.714534 (no previous merge yet)
[S3] round=17 local utility u=0.002879 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9954868336625343, 'loss_val': 0.24432542750873432, 'psi': 0.8186484557061935}-{'f1_val': 0.7007562037352997, 'auprc': 0.996732813191529, 'loss_val': 0.2538211061357736, 'psi': 0.8191468475177914}
[S4] START round=17 head_norm_before_train=1.677915 cos_to_last_merge=0.8468 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.847
[S4] round=17 local utility u=0.040063 metrics={'f1_val': 0.9430013637740254, 'auprc': 0.9506786355649459, 'loss_val': 0.2699148888599956, 'psi': 0.9460722724903936}-{'f1_val': 0.9419188482348404, 'auprc': 0.9281418558609761, 'loss_val': 0.27593574555736816, 'psi': 0.9364080512852947}
[S5] START round=17 head_norm_before_train=1.013005 cos_to_last_merge=1.0000 (last merge round=16)
[S5] round=17 local utility u=0.005300 metrics={'f1_val': 0.6728134010707152, 'auprc': 0.9155410760899368, 'loss_val': 0.44429293153084987, 'psi': 0.7699044710784038}-{'f1_val': 0.7006953490578625, 'auprc': 0.854495719601091, 'loss_val': 0.4390488819342334, 'psi': 0.7622154972751538}
[S6] START round=17 head_norm_before_train=1.210555 cos_to_last_merge=0.9914 (last merge round=15)
[S6] round=17 local utility u=1.000000 metrics={'f1_val': 0.9634302487624311, 'auprc': 0.9749092440918782, 'loss_val': 0.2904987494498704, 'psi': 0.96802184689421}-{'f1_val': 0.6785972254570211, 'auprc': 0.8081116380084459, 'loss_val': 0.6164002693928007, 'psi': 0.730402990477591}
[S7] START round=17 head_norm_before_train=0.949132 cos_to_last_merge=0.9982 (last merge round=15)
[S7] round=17 local utility u=0.025402 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.7841240872726285, 'loss_val': 0.7748055290320656, 'psi': 0.5636757057756654}-{'f1_val': 0.41671011811102343, 'auprc': 0.7849174462373556, 'loss_val': 0.8279900256302081, 'psi': 0.5639930493615564}
[S8] START round=17 head_norm_before_train=1.822164 (no previous merge yet)
[S8] round=17 local utility u=0.012066 metrics={'f1_val': 0.9942884390087473, 'auprc': 0.9988422553294009, 'loss_val': 0.04318517388035815, 'psi': 0.9961099655370087}-{'f1_val': 0.9938941842030629, 'auprc': 0.9977454529919301, 'loss_val': 0.06166060325227144, 'psi': 0.9954346917186097}
[S9] START round=17 head_norm_before_train=1.242496 cos_to_last_merge=0.7740 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.774
[S9] round=17 local utility u=0.877228 metrics={'f1_val': 0.9865404245545528, 'auprc': 0.997648696300097, 'loss_val': 0.17286875502391208, 'psi': 0.9909837332527704}-{'f1_val': 0.7012165807733519, 'auprc': 0.9971113929606948, 'loss_val': 0.21377068423750395, 'psi': 0.819574505648289}
[S10] START round=17 head_norm_before_train=1.161706 cos_to_last_merge=0.9509 (last merge round=14)
[S10] round=17 local utility u=0.026410 metrics={'f1_val': 0.9937871219080217, 'auprc': 0.9950768782730447, 'loss_val': 0.08471578263086997, 'psi': 0.994303024454031}-{'f1_val': 0.992869746824563, 'auprc': 0.9934740319072406, 'loss_val': 0.12722328467294153, 'psi': 0.9931114608576339}
[S11] START round=17 head_norm_before_train=1.319098 cos_to_last_merge=0.8214 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.821
[S11] round=17 local utility u=0.106182 metrics={'f1_val': 0.9846098576669856, 'auprc': 0.9982200866333404, 'loss_val': 0.17456601518678, 'psi': 0.9900539492535275}-{'f1_val': 0.9581015134257738, 'auprc': 0.9982049711668873, 'loss_val': 0.2278351813302142, 'psi': 0.9741428965222192}
[S13] START round=17 head_norm_before_train=0.948077 cos_to_last_merge=1.0000 (last merge round=16)
[S13] round=17 local utility u=0.026052 metrics={'f1_val': 0.6095613258845225, 'auprc': 0.6562388635481242, 'loss_val': 0.7484801394525299, 'psi': 0.6282323409499632}-{'f1_val': 0.6118407519349515, 'auprc': 0.6249092329566412, 'loss_val': 0.7202723696230651, 'psi': 0.6170681443436273}
[S14] START round=17 head_norm_before_train=1.012753 cos_to_last_merge=1.0000 (last merge round=16)
[S14] round=17 local utility u=0.132912 metrics={'f1_val': 0.996820068750019, 'auprc': 0.9987404537643952, 'loss_val': 0.3555193934174247, 'psi': 0.9975882227557695}-{'f1_val': 0.95260279405686, 'auprc': 0.998907990785029, 'loss_val': 0.3565430934932456, 'psi': 0.9711248727481275}
[S15] START round=17 head_norm_before_train=1.687345 cos_to_last_merge=0.8238 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.824
[S15] round=17 local utility u=0.611151 metrics={'f1_val': 0.9974605999319422, 'auprc': 0.9987572527881177, 'loss_val': 0.023444083740750386, 'psi': 0.9979792610744125}-{'f1_val': 0.8392373986840789, 'auprc': 0.9931206733505669, 'loss_val': 0.2794973935634137, 'psi': 0.9007907085506741}
[S16] START round=17 head_norm_before_train=1.396999 cos_to_last_merge=0.8234 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.823
[S16] round=17 local utility u=0.759698 metrics={'f1_val': 0.8360124235061515, 'auprc': 0.922617969228343, 'loss_val': 0.565372664028971, 'psi': 0.8706546417950282}-{'f1_val': 0.5845123181344559, 'auprc': 0.9048034176291799, 'loss_val': 0.5223248187837619, 'psi': 0.7126287579323456}
[S17] START round=17 head_norm_before_train=1.893415 (no previous merge yet)
[S17] round=17 local utility u=0.298009 metrics={'f1_val': 0.6155517605142564, 'auprc': 0.9175289841817564, 'loss_val': 0.7741351247132436, 'psi': 0.7363426499812564}-{'f1_val': 0.5857491989298341, 'auprc': 0.8251365755038766, 'loss_val': 0.9141597913736101, 'psi': 0.6815041495594512}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:39813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:39807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] → sending delta(kind=head bytes=1805) to S10@127.0.0.1:39811
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:39803
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] → sending delta(kind=head bytes=1793) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:39805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:39805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S2@127.0.0.1:39802
[S6] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1793 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S3] sending update (kind=head size=1794 to 1 peers)
[S13] sending update (kind=head size=1805 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1793 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1802) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.711122)
[S14] loaded HEAD from S15 (vec_in norm=1.711122)
[S14] cosine check vs S15: cos=0.6305
[S14] BUFFERED delta from S15 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1798) from S4
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.693769)
[S14] loaded HEAD from S4 (vec_in norm=1.693769)
[S14] cosine check vs S4: cos=0.4109
[S14] BUFFERED delta from S4 (total buffered=2)
[S14] RECEIVED delta(kind=head bytes=1794) from S3
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.732753)
[S14] loaded HEAD from S3 (vec_in norm=1.732753)
[S14] cosine check vs S3: cos=-0.0203
[S14] DROPPED delta from S3 (cos=-0.0203 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1798) from S2
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.375910)
[S6] loaded HEAD from S2 (vec_in norm=1.375910)
[S6] cosine check vs S2: cos=0.8814
[S6] BUFFERED delta from S2 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1796) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.054645)
[S7] loaded HEAD from S14 (vec_in norm=1.054645)
[S7] cosine check vs S14: cos=0.8184
[S7] BUFFERED delta from S14 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1793) from S9
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.268757)
[S7] loaded HEAD from S9 (vec_in norm=1.268757)
[S7] cosine check vs S9: cos=0.8277
[S7] BUFFERED delta from S9 (total buffered=2)
[S7] RECEIVED delta(kind=head bytes=1797) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.293082)
[S7] loaded HEAD from S6 (vec_in norm=1.293082)
[S7] cosine check vs S6: cos=0.3553
[S7] BUFFERED delta from S6 (total buffered=3)
[S5] RECEIVED delta(kind=head bytes=1800) from S8
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.846730)
[S5] loaded HEAD from S8 (vec_in norm=1.846730)
[S5] cosine check vs S8: cos=0.5270
[S5] BUFFERED delta from S8 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1801) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.267115)
[S5] loaded HEAD from S10 (vec_in norm=1.267115)
[S5] cosine check vs S10: cos=0.8017
[S5] BUFFERED delta from S10 (total buffered=2)
[S3] RECEIVED delta(kind=head bytes=1795) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.062409)
[S3] loaded HEAD from S5 (vec_in norm=1.062409)
[S3] cosine check vs S5: cos=-0.1135
[S3] DROPPED delta from S5 (cos=-0.1135 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1805) from S13
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.007770)
[S10] loaded HEAD from S13 (vec_in norm=1.007770)
[S10] cosine check vs S13: cos=0.6763
[S10] BUFFERED delta from S13 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1798) from S7
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.981905)
[S13] loaded HEAD from S7 (vec_in norm=0.981905)
[S13] cosine check vs S7: cos=0.9475
[S13] BUFFERED delta from S7 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1793) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.360832)
[S2] loaded HEAD from S11 (vec_in norm=1.360832)
[S2] cosine check vs S11: cos=0.9831
[S2] BUFFERED delta from S11 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1799) from S16
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.434939)
[S14] loaded HEAD from S16 (vec_in norm=1.434939)
[S14] cosine check vs S16: cos=0.8116
[S14] BUFFERED delta from S16 (total buffered=3)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:39809
[S17] sending update (kind=head size=1802 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1802) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.915904)
[S8] loaded HEAD from S17 (vec_in norm=1.915904)
[S8] cosine check vs S17: cos=-0.0587
[S8] DROPPED delta from S17 (cos=-0.0587 < 0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=17 metric=0.6096 head_norm=1.007770
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.616167e-01
[S13] stored merged vector for next round verification (round=17)
[S13] DEBUG after merge:  round=17 metric=0.6086 head_norm=0.981707 delta_norm=0.161617
[S13] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=17 metric=0.4167 head_norm=0.981905
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.480383e-01
[S7] stored merged vector for next round verification (round=17)
[S7] DEBUG after merge:  round=17 metric=0.4167 head_norm=0.913208 delta_norm=0.148038
[S7] aggregate: ACCEPT kept=['S14', 'S9', 'S6'] (k=3/3) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=17 metric=0.7135 head_norm=1.375910
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.261232e-01
[S2] stored merged vector for next round verification (round=17)
[S2] DEBUG after merge:  round=17 metric=0.7143 head_norm=1.362567 delta_norm=0.126123
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=17 metric=0.6728 head_norm=1.062409
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.406435e-01
[S5] stored merged vector for next round verification (round=17)
[S5] DEBUG after merge:  round=17 metric=0.7019 head_norm=1.055722 delta_norm=0.240643
[S5] aggregate: ACCEPT kept=['S8', 'S10'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=17 metric=0.9968 head_norm=1.054645
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.288687e-01
[S14] stored merged vector for next round verification (round=17)
[S14] DEBUG after merge:  round=17 metric=0.9972 head_norm=1.051117 delta_norm=0.128869
[S14] aggregate: ACCEPT kept=['S15', 'S4', 'S16'] (k=3/3) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=17 metric=0.9634 head_norm=1.293082
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.274361e-01
[S6] stored merged vector for next round verification (round=17)
[S6] DEBUG after merge:  round=17 metric=0.9631 head_norm=1.294365 delta_norm=0.327436
[S6] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=17 metric=0.9938 head_norm=1.267115
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.727663e-01
[S10] stored merged vector for next round verification (round=17)
[S10] DEBUG after merge:  round=17 metric=0.9938 head_norm=1.042632 delta_norm=0.472766
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.362567 cos_to_last_merge=1.0000 (last merge round=17)
[S2] round=18 local utility u=0.229253 metrics={'f1_val': 0.7075811262224573, 'auprc': 0.9800183534592167, 'loss_val': 0.3348782548906219, 'psi': 0.8165560171171611}-{'f1_val': 0.713509988247859, 'auprc': 0.842578700306294, 'loss_val': 0.41663897350859475, 'psi': 0.765137473071233}
[S3] START round=18 head_norm_before_train=1.732753 (no previous merge yet)
[S3] round=18 local utility u=0.011128 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9970211295179449, 'loss_val': 0.2262214686522712, 'psi': 0.8192170276063788}-{'f1_val': 0.7007562037352997, 'auprc': 0.9954868336625343, 'loss_val': 0.24432542750873432, 'psi': 0.8186484557061935}
[S4] START round=18 head_norm_before_train=1.693769 cos_to_last_merge=0.8454 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.845
[S4] round=18 local utility u=0.029442 metrics={'f1_val': 0.9465235653251358, 'auprc': 0.9627920167451631, 'loss_val': 0.26850336421596904, 'psi': 0.9530309458931467}-{'f1_val': 0.9430013637740254, 'auprc': 0.9506786355649459, 'loss_val': 0.2699148888599956, 'psi': 0.9460722724903936}
[S5] START round=18 head_norm_before_train=1.055722 cos_to_last_merge=1.0000 (last merge round=17)
[S5] round=18 local utility u=0.160247 metrics={'f1_val': 0.7007418514877237, 'auprc': 0.9567768042772122, 'loss_val': 0.4150775677659881, 'psi': 0.8031558326035191}-{'f1_val': 0.6728134010707152, 'auprc': 0.9155410760899368, 'loss_val': 0.44429293153084987, 'psi': 0.7699044710784038}
[S6] START round=18 head_norm_before_train=1.294365 cos_to_last_merge=1.0000 (last merge round=17)
[S6] round=18 local utility u=0.000000 metrics={'f1_val': 0.8875839875158034, 'auprc': 0.9731958687429859, 'loss_val': 0.4002769881006356, 'psi': 0.9218287400066764}-{'f1_val': 0.9634302487624311, 'auprc': 0.9749092440918782, 'loss_val': 0.2904987494498704, 'psi': 0.96802184689421}
[S7] START round=18 head_norm_before_train=0.913208 cos_to_last_merge=1.0000 (last merge round=17)
[S7] round=18 local utility u=0.880499 metrics={'f1_val': 0.7131486179755095, 'auprc': 0.7871022269379753, 'loss_val': 0.8013736974931489, 'psi': 0.7427300615604958}-{'f1_val': 0.41671011811102343, 'auprc': 0.7841240872726285, 'loss_val': 0.7748055290320656, 'psi': 0.5636757057756654}
[S8] START round=18 head_norm_before_train=1.846730 (no previous merge yet)
[S8] round=18 local utility u=0.000000 metrics={'f1_val': 0.9831872218856248, 'auprc': 0.9988505759250488, 'loss_val': 0.06045353169217005, 'psi': 0.9894525635013943}-{'f1_val': 0.9942884390087473, 'auprc': 0.9988422553294009, 'loss_val': 0.04318517388035815, 'psi': 0.9961099655370087}
[S9] START round=18 head_norm_before_train=1.268757 cos_to_last_merge=0.7677 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.768
[S9] round=18 local utility u=0.039763 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9930113347264065, 'loss_val': 0.14015138058444931, 'psi': 0.9952008409788975}-{'f1_val': 0.9865404245545528, 'auprc': 0.997648696300097, 'loss_val': 0.17286875502391208, 'psi': 0.9909837332527704}
[S10] START round=18 head_norm_before_train=1.042632 cos_to_last_merge=1.0000 (last merge round=17)
[S10] round=18 local utility u=0.000000 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9925239799367366, 'loss_val': 0.15023466769736696, 'psi': 0.9937270560537312}-{'f1_val': 0.9937871219080217, 'auprc': 0.9950768782730447, 'loss_val': 0.08471578263086997, 'psi': 0.994303024454031}
[S11] START round=18 head_norm_before_train=1.360832 cos_to_last_merge=0.8148 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.815
[S11] round=18 local utility u=0.054217 metrics={'f1_val': 0.9969812955738739, 'auprc': 0.9983050972160616, 'loss_val': 0.14061513897715858, 'psi': 0.997510816230749}-{'f1_val': 0.9846098576669856, 'auprc': 0.9982200866333404, 'loss_val': 0.17456601518678, 'psi': 0.9900539492535275}
[S13] START round=18 head_norm_before_train=0.981707 cos_to_last_merge=1.0000 (last merge round=17)
[S13] round=18 local utility u=0.005240 metrics={'f1_val': 0.6125893860012626, 'auprc': 0.6620126146945124, 'loss_val': 0.773488999652337, 'psi': 0.6323586774785626}-{'f1_val': 0.6095613258845225, 'auprc': 0.6562388635481242, 'loss_val': 0.7484801394525299, 'psi': 0.6282323409499632}
[S14] START round=18 head_norm_before_train=1.051117 cos_to_last_merge=1.0000 (last merge round=17)
[S14] round=18 local utility u=0.034379 metrics={'f1_val': 0.9975788209428895, 'auprc': 0.9986332158780827, 'loss_val': 0.2909925741932376, 'psi': 0.9980005789169668}-{'f1_val': 0.996820068750019, 'auprc': 0.9987404537643952, 'loss_val': 0.3555193934174247, 'psi': 0.9975882227557695}
[S15] START round=18 head_norm_before_train=1.711122 cos_to_last_merge=0.8212 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.821
[S15] round=18 local utility u=0.000000 metrics={'f1_val': 0.8138136173048152, 'auprc': 0.9929385424720912, 'loss_val': 0.3374626156833869, 'psi': 0.8854635873717256}-{'f1_val': 0.9974605999319422, 'auprc': 0.9987572527881177, 'loss_val': 0.023444083740750386, 'psi': 0.9979792610744125}
[S16] START round=18 head_norm_before_train=1.434939 cos_to_last_merge=0.8146 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.815
[S16] round=18 local utility u=0.051232 metrics={'f1_val': 0.8427646372666249, 'auprc': 0.9337785148273166, 'loss_val': 0.5369034482265544, 'psi': 0.8791701882909015}-{'f1_val': 0.8360124235061515, 'auprc': 0.922617969228343, 'loss_val': 0.565372664028971, 'psi': 0.8706546417950282}
[S17] START round=18 head_norm_before_train=1.915904 (no previous merge yet)
[S17] round=18 local utility u=0.000000 metrics={'f1_val': 0.6040971252660161, 'auprc': 0.8257940964420561, 'loss_val': 0.9327772213421811, 'psi': 0.6927759137364322}-{'f1_val': 0.6155517605142564, 'auprc': 0.9175289841817564, 'loss_val': 0.7741351247132436, 'psi': 0.7363426499812564}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:39808
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:39814
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:39814
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:39813
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S10@127.0.0.1:39811
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:39807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S2@127.0.0.1:39802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:39803
[S5] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1793 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1804 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1804 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1802) from S2
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.406709)
[S6] loaded HEAD from S2 (vec_in norm=1.406709)
[S6] cosine check vs S2: cos=0.9504
[S6] BUFFERED delta from S2 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1796) from S9
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.292578)
[S7] loaded HEAD from S9 (vec_in norm=1.292578)
[S7] cosine check vs S9: cos=0.7986
[S7] BUFFERED delta from S9 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1804) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.100539)
[S7] loaded HEAD from S14 (vec_in norm=1.100539)
[S7] cosine check vs S14: cos=0.8358
[S7] BUFFERED delta from S14 (total buffered=2)
[S3] RECEIVED delta(kind=head bytes=1799) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.099350)
[S3] loaded HEAD from S5 (vec_in norm=1.099350)
[S3] cosine check vs S5: cos=-0.1203
[S3] DROPPED delta from S5 (cos=-0.1203 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1804) from S13
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.024612)
[S10] loaded HEAD from S13 (vec_in norm=1.024612)
[S10] cosine check vs S13: cos=0.8284
[S10] BUFFERED delta from S13 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1798) from S7
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.938865)
[S13] loaded HEAD from S7 (vec_in norm=0.938865)
[S13] cosine check vs S7: cos=0.9660
[S13] BUFFERED delta from S7 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1802) from S16
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.472266)
[S14] loaded HEAD from S16 (vec_in norm=1.472266)
[S14] cosine check vs S16: cos=0.8050
[S14] BUFFERED delta from S16 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1802) from S4
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.704445)
[S14] loaded HEAD from S4 (vec_in norm=1.704445)
[S14] cosine check vs S4: cos=0.3542
[S14] BUFFERED delta from S4 (total buffered=2)
[S14] RECEIVED delta(kind=head bytes=1795) from S3
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.751409)
[S14] loaded HEAD from S3 (vec_in norm=1.751409)
[S14] cosine check vs S3: cos=-0.0215
[S14] DROPPED delta from S3 (cos=-0.0215 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1793) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.403709)
[S2] loaded HEAD from S11 (vec_in norm=1.403709)
[S2] cosine check vs S11: cos=0.9869
[S2] BUFFERED delta from S11 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=18 metric=0.8876 head_norm=1.338352
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.187763e-01
[S6] stored merged vector for next round verification (round=18)
[S6] DEBUG after merge:  round=18 metric=0.8918 head_norm=1.355413 delta_norm=0.218776
[S6] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=18 metric=0.9945 head_norm=1.152055
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.245477e-01
[S10] stored merged vector for next round verification (round=18)
[S10] DEBUG after merge:  round=18 metric=0.9943 head_norm=1.040768 delta_norm=0.324548
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=18 metric=0.7076 head_norm=1.406709
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.137620e-01
[S2] stored merged vector for next round verification (round=18)
[S2] DEBUG after merge:  round=18 metric=0.7076 head_norm=1.400597 delta_norm=0.113762
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=18 metric=0.7131 head_norm=0.938865
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.541643e-01
[S7] stored merged vector for next round verification (round=18)
[S7] DEBUG after merge:  round=18 metric=0.6938 head_norm=0.969595 delta_norm=0.154164
[S7] aggregate: ROLLBACK (f1_val pre=0.713 post=0.694 tol_abs=0.005 tol_rel=0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=18 metric=0.6126 head_norm=1.024612
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.348800e-01
[S13] stored merged vector for next round verification (round=18)
[S13] DEBUG after merge:  round=18 metric=0.6131 head_norm=0.973373 delta_norm=0.134880
[S13] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=18 metric=0.9976 head_norm=1.100539
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.351057e-01
[S14] stored merged vector for next round verification (round=18)
[S14] DEBUG after merge:  round=18 metric=0.9978 head_norm=1.047245 delta_norm=0.335106
[S14] aggregate: ACCEPT kept=['S16', 'S4'] (k=2/2) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.400597 cos_to_last_merge=1.0000 (last merge round=18)
[S2] round=19 local utility u=0.000000 metrics={'f1_val': 0.7060888294795068, 'auprc': 0.8623830910012619, 'loss_val': 0.3676950752450605, 'psi': 0.7686065340882089}-{'f1_val': 0.7075811262224573, 'auprc': 0.9800183534592167, 'loss_val': 0.3348782548906219, 'psi': 0.8165560171171611}
[S3] START round=19 head_norm_before_train=1.751409 (no previous merge yet)
[S3] round=19 local utility u=0.001194 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.9981040081859327, 'loss_val': 0.22663154168382946, 'psi': 0.8196052047744964}-{'f1_val': 0.7006809596653347, 'auprc': 0.9970211295179449, 'loss_val': 0.2262214686522712, 'psi': 0.8192170276063788}
[S4] START round=19 head_norm_before_train=1.704445 cos_to_last_merge=0.8449 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.845
[S4] round=19 local utility u=0.000000 metrics={'f1_val': 0.9409626094899779, 'auprc': 0.9415594741639226, 'loss_val': 0.2789865691013503, 'psi': 0.9412013553595558}-{'f1_val': 0.9465235653251358, 'auprc': 0.9627920167451631, 'loss_val': 0.26850336421596904, 'psi': 0.9530309458931467}
[S5] START round=19 head_norm_before_train=1.099350 cos_to_last_merge=0.9985 (last merge round=17)
[S5] round=19 local utility u=0.073182 metrics={'f1_val': 0.7005691551769304, 'auprc': 0.9888479916164294, 'loss_val': 0.36389120561025423, 'psi': 0.81588068975273}-{'f1_val': 0.7007418514877237, 'auprc': 0.9567768042772122, 'loss_val': 0.4150775677659881, 'psi': 0.8031558326035191}
[S6] START round=19 head_norm_before_train=1.355413 cos_to_last_merge=1.0000 (last merge round=18)
[S6] round=19 local utility u=0.000000 metrics={'f1_val': 0.8216820660980418, 'auprc': 0.9554280484896354, 'loss_val': 0.5190725972211533, 'psi': 0.8751804590546792}-{'f1_val': 0.8875839875158034, 'auprc': 0.9731958687429859, 'loss_val': 0.4002769881006356, 'psi': 0.9218287400066764}
[S7] START round=19 head_norm_before_train=0.969595 cos_to_last_merge=1.0000 (last merge round=18)
[S7] round=19 local utility u=0.000000 metrics={'f1_val': 0.6759426839086502, 'auprc': 0.7894862204668025, 'loss_val': 0.7217250742631173, 'psi': 0.7213600985319111}-{'f1_val': 0.7131486179755095, 'auprc': 0.7871022269379753, 'loss_val': 0.8013736974931489, 'psi': 0.7427300615604958}
[S8] START round=19 head_norm_before_train=1.869517 (no previous merge yet)
[S8] round=19 local utility u=0.000000 metrics={'f1_val': 0.8880405618701612, 'auprc': 0.9880136456554443, 'loss_val': 0.12108695034900106, 'psi': 0.9280297953842744}-{'f1_val': 0.9831872218856248, 'auprc': 0.9988505759250488, 'loss_val': 0.06045353169217005, 'psi': 0.9894525635013943}
[S9] START round=19 head_norm_before_train=1.292578 cos_to_last_merge=0.7623 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.762
[S9] round=19 local utility u=0.000000 metrics={'f1_val': 0.9412188694097561, 'auprc': 0.9932086327200321, 'loss_val': 0.16129945535339682, 'psi': 0.9620147747338665}-{'f1_val': 0.9966605118138915, 'auprc': 0.9930113347264065, 'loss_val': 0.14015138058444931, 'psi': 0.9952008409788975}
[S10] START round=19 head_norm_before_train=1.040768 cos_to_last_merge=1.0000 (last merge round=18)
[S10] round=19 local utility u=0.000000 metrics={'f1_val': 0.9937871219080217, 'auprc': 0.9948328223936023, 'loss_val': 0.17408882634861816, 'psi': 0.9942054021022539}-{'f1_val': 0.9945291067983943, 'auprc': 0.9925239799367366, 'loss_val': 0.15023466769736696, 'psi': 0.9937270560537312}
[S11] START round=19 head_norm_before_train=1.403709 cos_to_last_merge=0.8082 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.808
[S11] round=19 local utility u=0.010944 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9982621741147012, 'loss_val': 0.1161149523572263, 'psi': 0.9972453520296087}-{'f1_val': 0.9969812955738739, 'auprc': 0.9983050972160616, 'loss_val': 0.14061513897715858, 'psi': 0.997510816230749}
[S13] START round=19 head_norm_before_train=0.973373 cos_to_last_merge=1.0000 (last merge round=18)
[S13] round=19 local utility u=0.025040 metrics={'f1_val': 0.6162926190397737, 'auprc': 0.6675556752495244, 'loss_val': 0.7622584463564253, 'psi': 0.636797841523674}-{'f1_val': 0.6125893860012626, 'auprc': 0.6620126146945124, 'loss_val': 0.773488999652337, 'psi': 0.6323586774785626}
[S14] START round=19 head_norm_before_train=1.047245 cos_to_last_merge=1.0000 (last merge round=18)
[S14] round=19 local utility u=0.012300 metrics={'f1_val': 0.997099581954165, 'auprc': 0.9987385341689035, 'loss_val': 0.2638339200834252, 'psi': 0.9977551628400605}-{'f1_val': 0.9975788209428895, 'auprc': 0.9986332158780827, 'loss_val': 0.2909925741932376, 'psi': 0.9980005789169668}
[S15] START round=19 head_norm_before_train=1.735923 cos_to_last_merge=0.8190 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.819
[S15] round=19 local utility u=0.719179 metrics={'f1_val': 0.997608451264256, 'auprc': 0.9989491776484065, 'loss_val': 0.01990618222641278, 'psi': 0.9981447418179162}-{'f1_val': 0.8138136173048152, 'auprc': 0.9929385424720912, 'loss_val': 0.3374626156833869, 'psi': 0.8854635873717256}
[S16] START round=19 head_norm_before_train=1.472266 cos_to_last_merge=0.8065 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.807
[S16] round=19 local utility u=0.242209 metrics={'f1_val': 0.8908889730907814, 'auprc': 0.9474282453116243, 'loss_val': 0.38217988240606593, 'psi': 0.9135046819791186}-{'f1_val': 0.8427646372666249, 'auprc': 0.9337785148273166, 'loss_val': 0.5369034482265544, 'psi': 0.8791701882909015}
[S17] START round=19 head_norm_before_train=1.938520 (no previous merge yet)
[S17] round=19 local utility u=0.178500 metrics={'f1_val': 0.6233792212619935, 'auprc': 0.8686554333975378, 'loss_val': 0.8200536051124075, 'psi': 0.7214897061162112}-{'f1_val': 0.6040971252660161, 'auprc': 0.8257940964420561, 'loss_val': 0.9327772213421811, 'psi': 0.6927759137364322}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:39811
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:39803
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:39802
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:39814
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1795 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1797) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.444206)
[S2] loaded HEAD from S11 (vec_in norm=1.444206)
[S2] cosine check vs S11: cos=0.9902
[S2] BUFFERED delta from S11 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1795) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.105747)
[S7] loaded HEAD from S14 (vec_in norm=1.105747)
[S7] cosine check vs S14: cos=0.8018
[S7] BUFFERED delta from S14 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1800) from S13
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.012764)
[S10] loaded HEAD from S13 (vec_in norm=1.012764)
[S10] cosine check vs S13: cos=0.8907
[S10] BUFFERED delta from S13 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1795) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.757287)
[S14] loaded HEAD from S15 (vec_in norm=1.757287)
[S14] cosine check vs S15: cos=0.4995
[S14] BUFFERED delta from S15 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1797) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.139150)
[S3] loaded HEAD from S5 (vec_in norm=1.139150)
[S3] cosine check vs S5: cos=-0.1209
[S3] DROPPED delta from S5 (cos=-0.1209 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1803) from S3
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.768723)
[S14] loaded HEAD from S3 (vec_in norm=1.768723)
[S14] cosine check vs S3: cos=-0.0157
[S14] DROPPED delta from S3 (cos=-0.0157 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1804) from S16
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.510335)
[S14] loaded HEAD from S16 (vec_in norm=1.510335)
[S14] cosine check vs S16: cos=0.7515
[S14] BUFFERED delta from S16 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:39809
[S17] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.959484)
[S8] loaded HEAD from S17 (vec_in norm=1.959484)
[S8] cosine check vs S17: cos=-0.0602
[S8] DROPPED delta from S17 (cos=-0.0602 < 0.0)
[S6] r=20 psi=0.875 u=0.0000 p_local=0.2552 f1=0.822 auprc=0.955 bytes=12574
[S4] r=20 psi=0.941 u=0.0000 p_local=0.1191 f1=0.941 auprc=0.942 bytes=14405
[S8] r=20 psi=0.928 u=0.0000 p_local=0.1283 f1=0.888 auprc=0.988 bytes=16191
[S9] r=20 psi=0.962 u=0.0000 p_local=0.2997 f1=0.941 auprc=0.993 bytes=17941
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=19 metric=0.7061 head_norm=1.437977
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.009736e-01
[S2] stored merged vector for next round verification (round=19)
[S2] DEBUG after merge:  round=19 metric=0.7086 head_norm=1.437553 delta_norm=0.100974
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] r=20 psi=0.769 u=0.0000 p_local=0.1018 f1=0.706 auprc=0.862 bytes=16175
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=19 metric=0.6759 head_norm=0.991333
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.345008e-01
[S7] stored merged vector for next round verification (round=19)
[S7] DEBUG after merge:  round=19 metric=0.7139 head_norm=0.995399 delta_norm=0.334501
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S7] r=20 psi=0.721 u=0.0000 p_local=0.1991 f1=0.676 auprc=0.789 bytes=19758
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=19 metric=0.9938 head_norm=1.166399
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.654274e-01
[S10] stored merged vector for next round verification (round=19)
[S10] DEBUG after merge:  round=19 metric=0.9936 head_norm=1.059545 delta_norm=0.265427
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S10] r=20 psi=0.994 u=0.0000 p_local=0.0771 f1=0.994 auprc=0.995 bytes=17983
[S3] r=20 psi=0.820 u=0.0012 p_local=0.0751 f1=0.701 auprc=0.998 bytes=19736
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=19 metric=0.9971 head_norm=1.105747
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.693728e-01
[S14] stored merged vector for next round verification (round=19)
[S14] DEBUG after merge:  round=19 metric=0.9971 head_norm=1.154610 delta_norm=0.469373
[S14] aggregate: ACCEPT kept=['S15', 'S16'] (k=2/2) mode=median trim_p=0.1
[S14] r=20 psi=0.998 u=0.0123 p_local=0.2022 f1=0.997 auprc=0.999 bytes=21534
[S5] r=20 psi=0.816 u=0.0732 p_local=0.1230 f1=0.701 auprc=0.989 bytes=21574
[S13] r=20 psi=0.637 u=0.0250 p_local=0.0504 f1=0.616 auprc=0.668 bytes=16193
[S16] r=20 psi=0.914 u=0.2422 p_local=0.2617 f1=0.891 auprc=0.947 bytes=19819
[S11] r=20 psi=0.997 u=0.0109 p_local=0.1708 f1=0.997 auprc=0.998 bytes=25113
[S15] r=20 psi=0.998 u=0.7192 p_local=0.3181 f1=0.998 auprc=0.999 bytes=17989
[S17] r=20 psi=0.721 u=0.1785 p_local=0.1910 f1=0.623 auprc=0.869 bytes=12599
[S2] START round=20 head_norm_before_train=1.437553 cos_to_last_merge=1.0000 (last merge round=19)
[S2] round=20 local utility u=0.018297 metrics={'f1_val': 0.7124266263567741, 'auprc': 0.8706861368537802, 'loss_val': 0.3940372032065609, 'psi': 0.7757304305555766}-{'f1_val': 0.7060888294795068, 'auprc': 0.8623830910012619, 'loss_val': 0.3676950752450605, 'psi': 0.7686065340882089}
[S3] START round=20 head_norm_before_train=1.768723 (no previous merge yet)
[S3] round=20 local utility u=0.028823 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.9984835117778961, 'loss_val': 0.1701234365148441, 'psi': 0.8197570062112818}-{'f1_val': 0.7006060025002057, 'auprc': 0.9981040081859327, 'loss_val': 0.22663154168382946, 'psi': 0.8196052047744964}
[S4] START round=20 head_norm_before_train=1.715649 cos_to_last_merge=0.8441 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.844
[S4] round=20 local utility u=0.000000 metrics={'f1_val': 0.9399536100624114, 'auprc': 0.9192319291753797, 'loss_val': 0.2938378241828583, 'psi': 0.9316649377075987}-{'f1_val': 0.9409626094899779, 'auprc': 0.9415594741639226, 'loss_val': 0.2789865691013503, 'psi': 0.9412013553595558}
[S5] START round=20 head_norm_before_train=1.139150 cos_to_last_merge=0.9949 (last merge round=17)
[S5] round=20 local utility u=0.000000 metrics={'f1_val': 0.42294979625361384, 'auprc': 0.7641746790571644, 'loss_val': 0.7180798227782962, 'psi': 0.559439749375034}-{'f1_val': 0.7005691551769304, 'auprc': 0.9888479916164294, 'loss_val': 0.36389120561025423, 'psi': 0.81588068975273}
[S6] START round=20 head_norm_before_train=1.406124 cos_to_last_merge=0.9963 (last merge round=18)
[S6] round=20 local utility u=0.000000 metrics={'f1_val': 0.8003484470984986, 'auprc': 0.9416807772715807, 'loss_val': 0.5067973694876075, 'psi': 0.8568813791677314}-{'f1_val': 0.8216820660980418, 'auprc': 0.9554280484896354, 'loss_val': 0.5190725972211533, 'psi': 0.8751804590546792}
[S7] START round=20 head_norm_before_train=0.995399 cos_to_last_merge=1.0000 (last merge round=19)
[S7] round=20 local utility u=0.000000 metrics={'f1_val': 0.6648407479874485, 'auprc': 0.7881867792165633, 'loss_val': 0.7942753400260926, 'psi': 0.7141791604790945}-{'f1_val': 0.6759426839086502, 'auprc': 0.7894862204668025, 'loss_val': 0.7217250742631173, 'psi': 0.7213600985319111}
[S8] START round=20 head_norm_before_train=1.886427 (no previous merge yet)
[S8] round=20 local utility u=0.342217 metrics={'f1_val': 0.9923946006913721, 'auprc': 0.9881177934737638, 'loss_val': 0.06308955583078342, 'psi': 0.9906838778043288}-{'f1_val': 0.8880405618701612, 'auprc': 0.9880136456554443, 'loss_val': 0.12108695034900106, 'psi': 0.9280297953842744}
[S9] START round=20 head_norm_before_train=1.318730 cos_to_last_merge=0.7565 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.757
[S9] round=20 local utility u=0.198958 metrics={'f1_val': 0.9962421144756511, 'auprc': 0.996559122561903, 'loss_val': 0.10357349807366746, 'psi': 0.9963689177101519}-{'f1_val': 0.9412188694097561, 'auprc': 0.9932086327200321, 'loss_val': 0.16129945535339682, 'psi': 0.9620147747338665}
[S10] START round=20 head_norm_before_train=1.059545 cos_to_last_merge=1.0000 (last merge round=19)
[S10] round=20 local utility u=0.000000 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9920576205793128, 'loss_val': 0.19079562761706595, 'psi': 0.9935405123107617}-{'f1_val': 0.9937871219080217, 'auprc': 0.9948328223936023, 'loss_val': 0.17408882634861816, 'psi': 0.9942054021022539}
[S11] START round=20 head_norm_before_train=1.444206 cos_to_last_merge=0.8021 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.802
[S11] round=20 local utility u=0.006029 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9980461138262601, 'loss_val': 0.10340834494658369, 'psi': 0.9971589279142323}-{'f1_val': 0.996567470639547, 'auprc': 0.9982621741147012, 'loss_val': 0.1161149523572263, 'psi': 0.9972453520296087}
[S13] START round=20 head_norm_before_train=1.012764 cos_to_last_merge=0.9974 (last merge round=18)
[S13] round=20 local utility u=0.000000 metrics={'f1_val': 0.6043211156341146, 'auprc': 0.6589610892590916, 'loss_val': 0.7407421085409795, 'psi': 0.6261771050841054}-{'f1_val': 0.6162926190397737, 'auprc': 0.6675556752495244, 'loss_val': 0.7622584463564253, 'psi': 0.636797841523674}
[S14] START round=20 head_norm_before_train=1.154610 cos_to_last_merge=1.0000 (last merge round=19)
[S14] round=20 local utility u=0.029071 metrics={'f1_val': 0.9964424345629549, 'auprc': 0.9969361614328913, 'loss_val': 0.19634249510522803, 'psi': 0.9966399253109295}-{'f1_val': 0.997099581954165, 'auprc': 0.9987385341689035, 'loss_val': 0.2638339200834252, 'psi': 0.9977551628400605}
[S15] START round=20 head_norm_before_train=1.757287 cos_to_last_merge=0.8169 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.817
[S15] round=20 local utility u=0.000000 metrics={'f1_val': 0.9017338965602832, 'auprc': 0.9977982648946986, 'loss_val': 0.24455739759333753, 'psi': 0.9401596438940494}-{'f1_val': 0.997608451264256, 'auprc': 0.9989491776484065, 'loss_val': 0.01990618222641278, 'psi': 0.9981447418179162}
[S16] START round=20 head_norm_before_train=1.510335 cos_to_last_merge=0.7989 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.799
[S16] round=20 local utility u=0.069336 metrics={'f1_val': 0.8822233459192624, 'auprc': 0.9703682945214804, 'loss_val': 0.26033448716623364, 'psi': 0.9174813253601497}-{'f1_val': 0.8908889730907814, 'auprc': 0.9474282453116243, 'loss_val': 0.38217988240606593, 'psi': 0.9135046819791186}
[S17] START round=20 head_norm_before_train=1.959484 (no previous merge yet)
[S17] round=20 local utility u=0.102203 metrics={'f1_val': 0.6492074599966289, 'auprc': 0.8684610672984413, 'loss_val': 0.7700336849289815, 'psi': 0.7369089029173539}-{'f1_val': 0.6233792212619935, 'auprc': 0.8686554333975378, 'loss_val': 0.8200536051124075, 'psi': 0.7214897061162112}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:39805
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:39807
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:39802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:39814
[S8] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1805 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1805 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1800) from S3
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.788243)
[S14] loaded HEAD from S3 (vec_in norm=1.788243)
[S14] cosine check vs S3: cos=-0.0242
[S14] DROPPED delta from S3 (cos=-0.0242 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1801) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.207428)
[S7] loaded HEAD from S14 (vec_in norm=1.207428)
[S7] cosine check vs S14: cos=0.9196
[S7] BUFFERED delta from S14 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1802) from S8
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.901134)
[S5] loaded HEAD from S8 (vec_in norm=1.901134)
[S5] cosine check vs S8: cos=0.6687
[S5] BUFFERED delta from S8 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1805) from S16
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.547538)
[S14] loaded HEAD from S16 (vec_in norm=1.547538)
[S14] cosine check vs S16: cos=0.8345
[S14] BUFFERED delta from S16 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1800) from S9
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.342010)
[S7] loaded HEAD from S9 (vec_in norm=1.342010)
[S7] cosine check vs S9: cos=0.6605
[S7] BUFFERED delta from S9 (total buffered=2)
[S6] RECEIVED delta(kind=head bytes=1805) from S2
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.482700)
[S6] loaded HEAD from S2 (vec_in norm=1.482700)
[S6] cosine check vs S2: cos=0.9451
[S6] BUFFERED delta from S2 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1796) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.477453)
[S2] loaded HEAD from S11 (vec_in norm=1.477453)
[S2] cosine check vs S11: cos=0.9910
[S2] BUFFERED delta from S11 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] → sending delta(kind=head bytes=1806) to S8@127.0.0.1:39809
[S17] sending update (kind=head size=1806 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1806) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.978176)
[S8] loaded HEAD from S17 (vec_in norm=1.978176)
[S8] cosine check vs S17: cos=-0.0612
[S8] DROPPED delta from S17 (cos=-0.0612 < 0.0)
[S10] ⇄ pheromone p=0.062 → S5@127.0.0.1:39805
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=20 metric=0.4229 head_norm=1.173088
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.084433e-01
[S5] stored merged vector for next round verification (round=20)
[S5] DEBUG after merge:  round=20 metric=0.6658 head_norm=1.411854 delta_norm=0.708443
[S5] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.098 → S3@127.0.0.1:39803
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=20 metric=0.6648 head_norm=1.016478
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.157932e-01
[S7] stored merged vector for next round verification (round=20)
[S7] DEBUG after merge:  round=20 metric=0.6246 head_norm=1.030249 delta_norm=0.215793
[S7] aggregate: ROLLBACK (f1_val pre=0.665 post=0.625 tol_abs=0.005 tol_rel=0.0)
[S7] ⇄ pheromone p=0.159 → S13@127.0.0.1:39813
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=20 metric=0.8003 head_norm=1.473775
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.449656e-01
[S6] stored merged vector for next round verification (round=20)
[S6] DEBUG after merge:  round=20 metric=0.8082 head_norm=1.457806 delta_norm=0.244966
[S6] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.204 → S7@127.0.0.1:39808
[S4] ⇄ pheromone p=0.095 → S14@127.0.0.1:39814
[S13] ⇄ pheromone p=0.040 → S10@127.0.0.1:39811
[S3] ⇄ pheromone p=0.066 → S14@127.0.0.1:39814
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=20 metric=0.7124 head_norm=1.482700
[S2] _apply_head_vector_avg (torch): Δ‖w‖=9.934682e-02
[S2] stored merged vector for next round verification (round=20)
[S2] DEBUG after merge:  round=20 metric=0.7122 head_norm=1.476741 delta_norm=0.099347
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.085 → S6@127.0.0.1:39807
[S11] ⇄ pheromone p=0.138 → S2@127.0.0.1:39802
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=20 metric=0.9964 head_norm=1.207428
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.284270e-01
[S14] stored merged vector for next round verification (round=20)
[S14] DEBUG after merge:  round=20 metric=0.9964 head_norm=1.320162 delta_norm=0.428427
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.168 → S7@127.0.0.1:39808
[S8] ⇄ pheromone p=0.171 → S5@127.0.0.1:39805
[S9] ⇄ pheromone p=0.280 → S7@127.0.0.1:39808
[S16] ⇄ pheromone p=0.223 → S14@127.0.0.1:39814
[S15] ⇄ pheromone p=0.254 → S14@127.0.0.1:39814
[S17] ⇄ pheromone p=0.173 → S8@127.0.0.1:39809
[S2] START round=21 head_norm_before_train=1.476741 cos_to_last_merge=1.0000 (last merge round=20)
[S2] round=21 local utility u=0.063994 metrics={'f1_val': 0.7078930545207412, 'auprc': 0.9157313203005354, 'loss_val': 0.3739825775788083, 'psi': 0.7910283608326589}-{'f1_val': 0.7124266263567741, 'auprc': 0.8706861368537802, 'loss_val': 0.3940372032065609, 'psi': 0.7757304305555766}
[S3] START round=21 head_norm_before_train=1.788243 (no previous merge yet)
[S3] round=21 local utility u=0.846089 metrics={'f1_val': 0.9744560407416312, 'auprc': 0.9986625180220557, 'loss_val': 0.12158272432933735, 'psi': 0.984138631653801}-{'f1_val': 0.7006060025002057, 'auprc': 0.9984835117778961, 'loss_val': 0.1701234365148441, 'psi': 0.8197570062112818}
[S4] START round=21 head_norm_before_train=1.728257 cos_to_last_merge=0.8431 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.843
[S4] round=21 local utility u=0.114178 metrics={'f1_val': 0.946784033970115, 'auprc': 0.9733329643192378, 'loss_val': 0.26876786816636783, 'psi': 0.9574036061097642}-{'f1_val': 0.9399536100624114, 'auprc': 0.9192319291753797, 'loss_val': 0.2938378241828583, 'psi': 0.9316649377075987}
[S5] START round=21 head_norm_before_train=1.411854 cos_to_last_merge=1.0000 (last merge round=20)
[S5] round=21 local utility u=1.000000 metrics={'f1_val': 0.7006548950925356, 'auprc': 0.9130507081630777, 'loss_val': 0.4139885715253068, 'psi': 0.7856132203207524}-{'f1_val': 0.42294979625361384, 'auprc': 0.7641746790571644, 'loss_val': 0.7180798227782962, 'psi': 0.559439749375034}
[S6] START round=21 head_norm_before_train=1.457806 cos_to_last_merge=1.0000 (last merge round=20)
[S6] round=21 local utility u=0.028091 metrics={'f1_val': 0.8131789602170038, 'auprc': 0.9325362630070865, 'loss_val': 0.5001644194739325, 'psi': 0.8609218813330368}-{'f1_val': 0.8003484470984986, 'auprc': 0.9416807772715807, 'loss_val': 0.5067973694876075, 'psi': 0.8568813791677314}
[S7] START round=21 head_norm_before_train=1.030249 cos_to_last_merge=1.0000 (last merge round=20)
[S7] round=21 local utility u=0.000000 metrics={'f1_val': 0.4674974271473733, 'auprc': 0.7879677680236381, 'loss_val': 0.8170760562756745, 'psi': 0.5956855634978793}-{'f1_val': 0.6648407479874485, 'auprc': 0.7881867792165633, 'loss_val': 0.7942753400260926, 'psi': 0.7141791604790945}
[S8] START round=21 head_norm_before_train=1.901134 (no previous merge yet)
[S8] round=21 local utility u=0.007646 metrics={'f1_val': 0.9867128099339056, 'auprc': 0.9988062352088725, 'loss_val': 0.04577221767192905, 'psi': 0.9915501800438924}-{'f1_val': 0.9923946006913721, 'auprc': 0.9881177934737638, 'loss_val': 0.06308955583078342, 'psi': 0.9906838778043288}
[S9] START round=21 head_norm_before_train=1.342010 cos_to_last_merge=0.7518 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.752
[S9] round=21 local utility u=0.010450 metrics={'f1_val': 0.9966570119660778, 'auprc': 0.9977163232653282, 'loss_val': 0.08863541546306658, 'psi': 0.997080736485778}-{'f1_val': 0.9962421144756511, 'auprc': 0.996559122561903, 'loss_val': 0.10357349807366746, 'psi': 0.9963689177101519}
[S10] START round=21 head_norm_before_train=1.191218 cos_to_last_merge=0.9844 (last merge round=19)
[S10] round=21 local utility u=0.041545 metrics={'f1_val': 0.9940063275949004, 'auprc': 0.9925619689765404, 'loss_val': 0.106081980726794, 'psi': 0.9934285841475563}-{'f1_val': 0.9945291067983943, 'auprc': 0.9920576205793128, 'loss_val': 0.19079562761706595, 'psi': 0.9935405123107617}
[S11] START round=21 head_norm_before_train=1.477453 cos_to_last_merge=0.7970 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.797
[S11] round=21 local utility u=0.007313 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9979349595470624, 'loss_val': 0.08844931508080231, 'psi': 0.9971144662025532}-{'f1_val': 0.996567470639547, 'auprc': 0.9980461138262601, 'loss_val': 0.10340834494658369, 'psi': 0.9971589279142323}
[S13] START round=21 head_norm_before_train=1.060798 cos_to_last_merge=0.9905 (last merge round=18)
[S13] round=21 local utility u=0.026939 metrics={'f1_val': 0.6101503694100949, 'auprc': 0.6537759695768841, 'loss_val': 0.7062842042183239, 'psi': 0.6276006094768105}-{'f1_val': 0.6043211156341146, 'auprc': 0.6589610892590916, 'loss_val': 0.7407421085409795, 'psi': 0.6261771050841054}
[S14] START round=21 head_norm_before_train=1.320162 cos_to_last_merge=1.0000 (last merge round=20)
[S14] round=21 local utility u=0.023224 metrics={'f1_val': 0.9969910436891155, 'auprc': 0.9987358487096002, 'loss_val': 0.15858421813276224, 'psi': 0.9976889656973094}-{'f1_val': 0.9964424345629549, 'auprc': 0.9969361614328913, 'loss_val': 0.19634249510522803, 'psi': 0.9966399253109295}
[S15] START round=21 head_norm_before_train=1.776403 cos_to_last_merge=0.8152 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.815
[S15] round=21 local utility u=0.402761 metrics={'f1_val': 0.9971773386779533, 'auprc': 0.9995650235338536, 'loss_val': 0.016997072226637266, 'psi': 0.9981324126203135}-{'f1_val': 0.9017338965602832, 'auprc': 0.9977982648946986, 'loss_val': 0.24455739759333753, 'psi': 0.9401596438940494}
[S16] START round=21 head_norm_before_train=1.547538 cos_to_last_merge=0.7919 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.792
[S16] round=21 local utility u=0.000000 metrics={'f1_val': 0.8377584364590158, 'auprc': 0.9707742925783142, 'loss_val': 0.6686360211856996, 'psi': 0.8909647789067351}-{'f1_val': 0.8822233459192624, 'auprc': 0.9703682945214804, 'loss_val': 0.26033448716623364, 'psi': 0.9174813253601497}
[S17] START round=21 head_norm_before_train=1.978176 (no previous merge yet)
[S17] round=21 local utility u=0.000000 metrics={'f1_val': 0.6007330738090164, 'auprc': 0.8312627295781752, 'loss_val': 1.2004085701413114, 'psi': 0.69294493611668}-{'f1_val': 0.6492074599966289, 'auprc': 0.8684610672984413, 'loss_val': 0.7700336849289815, 'psi': 0.7369089029173539}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:39802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:39805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:39803
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:39811
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:39807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:39808
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:39805
[S15] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1799) from S2
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.517659)
[S6] loaded HEAD from S2 (vec_in norm=1.517659)
[S6] cosine check vs S2: cos=0.9712
[S6] BUFFERED delta from S2 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1799) from S8
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.917914)
[S5] loaded HEAD from S8 (vec_in norm=1.917914)
[S5] cosine check vs S8: cos=0.9450
[S5] BUFFERED delta from S8 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1803) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.316699)
[S5] loaded HEAD from S10 (vec_in norm=1.316699)
[S5] cosine check vs S10: cos=0.2498
[S5] BUFFERED delta from S10 (total buffered=2)
[S7] RECEIVED delta(kind=head bytes=1795) from S9
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.366331)
[S7] loaded HEAD from S9 (vec_in norm=1.366331)
[S7] cosine check vs S9: cos=0.7822
[S7] BUFFERED delta from S9 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1801) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.363647)
[S7] loaded HEAD from S14 (vec_in norm=1.363647)
[S7] cosine check vs S14: cos=0.8503
[S7] BUFFERED delta from S14 (total buffered=2)
[S7] RECEIVED delta(kind=head bytes=1800) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.507710)
[S7] loaded HEAD from S6 (vec_in norm=1.507710)
[S7] cosine check vs S6: cos=0.1513
[S7] BUFFERED delta from S6 (total buffered=3)
[S3] RECEIVED delta(kind=head bytes=1797) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.433918)
[S3] loaded HEAD from S5 (vec_in norm=1.433918)
[S3] cosine check vs S5: cos=-0.1054
[S3] DROPPED delta from S5 (cos=-0.1054 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1803) from S13
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.112957)
[S10] loaded HEAD from S13 (vec_in norm=1.112957)
[S10] cosine check vs S13: cos=0.8643
[S10] BUFFERED delta from S13 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1799) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.503770)
[S2] loaded HEAD from S11 (vec_in norm=1.503770)
[S2] cosine check vs S11: cos=0.9925
[S2] BUFFERED delta from S11 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1796) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.795129)
[S14] loaded HEAD from S15 (vec_in norm=1.795129)
[S14] cosine check vs S15: cos=0.5827
[S14] BUFFERED delta from S15 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1802) from S3
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.810924)
[S14] loaded HEAD from S3 (vec_in norm=1.810924)
[S14] cosine check vs S3: cos=-0.0337
[S14] DROPPED delta from S3 (cos=-0.0337 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1798) from S4
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.748303)
[S14] loaded HEAD from S4 (vec_in norm=1.748303)
[S14] cosine check vs S4: cos=0.0949
[S14] BUFFERED delta from S4 (total buffered=2)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=21 metric=0.4675 head_norm=1.052215
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.901558e-01
[S7] stored merged vector for next round verification (round=21)
[S7] DEBUG after merge:  round=21 metric=0.5068 head_norm=1.000680 delta_norm=0.190156
[S7] aggregate: ACCEPT kept=['S9', 'S14', 'S6'] (k=3/3) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=21 metric=0.7079 head_norm=1.517659
[S2] _apply_head_vector_avg (torch): Δ‖w‖=9.264880e-02
[S2] stored merged vector for next round verification (round=21)
[S2] DEBUG after merge:  round=21 metric=0.7074 head_norm=1.507887 delta_norm=0.092649
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=21 metric=0.9970 head_norm=1.363647
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.522912e-01
[S14] stored merged vector for next round verification (round=21)
[S14] DEBUG after merge:  round=21 metric=0.9960 head_norm=1.118851 delta_norm=0.652291
[S14] aggregate: ACCEPT kept=['S15', 'S4'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=21 metric=0.8132 head_norm=1.507710
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.814847e-01
[S6] stored merged vector for next round verification (round=21)
[S6] DEBUG after merge:  round=21 metric=0.8133 head_norm=1.501766 delta_norm=0.181485
[S6] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=21 metric=0.9940 head_norm=1.316699
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.313202e-01
[S10] stored merged vector for next round verification (round=21)
[S10] DEBUG after merge:  round=21 metric=0.9940 head_norm=1.173206 delta_norm=0.331320
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=21 metric=0.7007 head_norm=1.433918
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.823733e-01
[S5] stored merged vector for next round verification (round=21)
[S5] DEBUG after merge:  round=21 metric=0.7006 head_norm=1.270837 delta_norm=0.282373
[S5] aggregate: ACCEPT kept=['S8', 'S10'] (k=2/2) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.507887 cos_to_last_merge=1.0000 (last merge round=21)
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.7145989326098279, 'auprc': 0.8396523212230707, 'loss_val': 0.46639755633839824, 'psi': 0.7646202880551249}-{'f1_val': 0.7078930545207412, 'auprc': 0.9157313203005354, 'loss_val': 0.3739825775788083, 'psi': 0.7910283608326589}
[S3] START round=22 head_norm_before_train=1.810924 (no previous merge yet)
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.9600662304203449, 'auprc': 0.998393898007472, 'loss_val': 0.14273873323295372, 'psi': 0.9753972974551957}-{'f1_val': 0.9744560407416312, 'auprc': 0.9986625180220557, 'loss_val': 0.12158272432933735, 'psi': 0.984138631653801}
[S4] START round=22 head_norm_before_train=1.748303 cos_to_last_merge=0.8413 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.841
[S4] round=22 local utility u=0.000000 metrics={'f1_val': 0.9383114277839315, 'auprc': 0.9166105861171403, 'loss_val': 0.30637337476875304, 'psi': 0.929631091117215}-{'f1_val': 0.946784033970115, 'auprc': 0.9733329643192378, 'loss_val': 0.26876786816636783, 'psi': 0.9574036061097642}
[S5] START round=22 head_norm_before_train=1.270837 cos_to_last_merge=1.0000 (last merge round=21)
[S5] round=22 local utility u=0.000000 metrics={'f1_val': 0.7007413541402552, 'auprc': 0.874451746003182, 'loss_val': 0.42810984675479347, 'psi': 0.7702255108854259}-{'f1_val': 0.7006548950925356, 'auprc': 0.9130507081630777, 'loss_val': 0.4139885715253068, 'psi': 0.7856132203207524}
[S6] START round=22 head_norm_before_train=1.501766 cos_to_last_merge=1.0000 (last merge round=21)
[S6] round=22 local utility u=0.635394 metrics={'f1_val': 0.9614234632811981, 'auprc': 0.9778493110160901, 'loss_val': 0.2547817186785, 'psi': 0.9679938023751549}-{'f1_val': 0.8131789602170038, 'auprc': 0.9325362630070865, 'loss_val': 0.5001644194739325, 'psi': 0.8609218813330368}
[S7] START round=22 head_norm_before_train=1.000680 cos_to_last_merge=1.0000 (last merge round=21)
[S7] round=22 local utility u=0.873946 metrics={'f1_val': 0.6727280556713737, 'auprc': 0.908108727978684, 'loss_val': 0.660989724690935, 'psi': 0.7668803245942979}-{'f1_val': 0.4674974271473733, 'auprc': 0.7879677680236381, 'loss_val': 0.8170760562756745, 'psi': 0.5956855634978793}
[S8] START round=22 head_norm_before_train=1.917914 (no previous merge yet)
[S8] round=22 local utility u=0.002121 metrics={'f1_val': 0.9927720833909908, 'auprc': 0.9909901465147379, 'loss_val': 0.05443803586552219, 'psi': 0.9920593086404896}-{'f1_val': 0.9867128099339056, 'auprc': 0.9988062352088725, 'loss_val': 0.04577221767192905, 'psi': 0.9915501800438924}
[S9] START round=22 head_norm_before_train=1.366331 cos_to_last_merge=0.7468 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.747
[S9] round=22 local utility u=0.002268 metrics={'f1_val': 0.9954108212552283, 'auprc': 0.9979820980314432, 'loss_val': 0.07742016771142303, 'psi': 0.9964393319657142}-{'f1_val': 0.9966570119660778, 'auprc': 0.9977163232653282, 'loss_val': 0.08863541546306658, 'psi': 0.997080736485778}
[S10] START round=22 head_norm_before_train=1.173206 cos_to_last_merge=1.0000 (last merge round=21)
[S10] round=22 local utility u=0.000000 metrics={'f1_val': 0.9930642379731851, 'auprc': 0.9954417231473316, 'loss_val': 0.13677678416027533, 'psi': 0.9940152320428437}-{'f1_val': 0.9940063275949004, 'auprc': 0.9925619689765404, 'loss_val': 0.106081980726794, 'psi': 0.9934285841475563}
[S11] START round=22 head_norm_before_train=1.503770 cos_to_last_merge=0.7930 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.793
[S11] round=22 local utility u=0.008297 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9981289548834619, 'loss_val': 0.07243696591870714, 'psi': 0.997192064337113}-{'f1_val': 0.996567470639547, 'auprc': 0.9979349595470624, 'loss_val': 0.08844931508080231, 'psi': 0.9971144662025532}
[S13] START round=22 head_norm_before_train=1.112957 cos_to_last_merge=0.9807 (last merge round=18)
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.6057539710364293, 'auprc': 0.6813027415386765, 'loss_val': 0.7920500484726685, 'psi': 0.6359734792373282}-{'f1_val': 0.6101503694100949, 'auprc': 0.6537759695768841, 'loss_val': 0.7062842042183239, 'psi': 0.6276006094768105}
[S14] START round=22 head_norm_before_train=1.118851 cos_to_last_merge=1.0000 (last merge round=21)
[S14] round=22 local utility u=0.000000 metrics={'f1_val': 0.9944935406943898, 'auprc': 0.9988694984937566, 'loss_val': 0.17857394461055054, 'psi': 0.9962439238141365}-{'f1_val': 0.9969910436891155, 'auprc': 0.9987358487096002, 'loss_val': 0.15858421813276224, 'psi': 0.9976889656973094}
[S15] START round=22 head_norm_before_train=1.795129 cos_to_last_merge=0.8136 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.814
[S15] round=22 local utility u=0.000000 metrics={'f1_val': 0.902256433010702, 'auprc': 0.9959841685605054, 'loss_val': 0.24341570447847008, 'psi': 0.9397475272306233}-{'f1_val': 0.9971773386779533, 'auprc': 0.9995650235338536, 'loss_val': 0.016997072226637266, 'psi': 0.9981324126203135}
[S16] START round=22 head_norm_before_train=1.581203 cos_to_last_merge=0.7859 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.786
[S16] round=22 local utility u=0.670095 metrics={'f1_val': 0.9704261759711743, 'auprc': 0.9852865327245075, 'loss_val': 0.1679887085216056, 'psi': 0.9763703186725076}-{'f1_val': 0.8377584364590158, 'auprc': 0.9707742925783142, 'loss_val': 0.6686360211856996, 'psi': 0.8909647789067351}
[S17] START round=22 head_norm_before_train=1.994556 (no previous merge yet)
[S17] round=22 local utility u=0.360005 metrics={'f1_val': 0.6425997991017613, 'auprc': 0.9065823246460952, 'loss_val': 0.9575567462509148, 'psi': 0.748192809319495}-{'f1_val': 0.6007330738090164, 'auprc': 0.8312627295781752, 'loss_val': 1.2004085701413114, 'psi': 0.69294493611668}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:39805
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:39813
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S16] → sending delta(kind=head bytes=1807) to S14@127.0.0.1:39814
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:39802
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] → sending delta(kind=head bytes=1792) to S7@127.0.0.1:39808
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1792 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S16] sending update (kind=head size=1807 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1803) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.528670)
[S2] loaded HEAD from S11 (vec_in norm=1.528670)
[S2] cosine check vs S11: cos=0.9936
[S2] BUFFERED delta from S11 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1800) from S7
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.021198)
[S13] loaded HEAD from S7 (vec_in norm=1.021198)
[S13] cosine check vs S7: cos=0.9015
[S13] BUFFERED delta from S7 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1807) from S16
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.614535)
[S14] loaded HEAD from S16 (vec_in norm=1.614535)
[S14] cosine check vs S16: cos=0.7289
[S14] BUFFERED delta from S16 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1802) from S8
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.938342)
[S5] loaded HEAD from S8 (vec_in norm=1.938342)
[S5] cosine check vs S8: cos=0.8980
[S5] BUFFERED delta from S8 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1792) from S9
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.388799)
[S7] loaded HEAD from S9 (vec_in norm=1.388799)
[S7] cosine check vs S9: cos=0.7794
[S7] BUFFERED delta from S9 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1796) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.561238)
[S7] loaded HEAD from S6 (vec_in norm=1.561238)
[S7] cosine check vs S6: cos=0.2736
[S7] BUFFERED delta from S6 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S17] → sending delta(kind=head bytes=1807) to S8@127.0.0.1:39809
[S17] sending update (kind=head size=1807 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1807) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=2.002983)
[S8] loaded HEAD from S17 (vec_in norm=2.002983)
[S8] cosine check vs S17: cos=-0.0611
[S8] DROPPED delta from S17 (cos=-0.0611 < 0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=22 metric=0.6058 head_norm=1.158808
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.509933e-01
[S13] stored merged vector for next round verification (round=22)
[S13] DEBUG after merge:  round=22 metric=0.6036 head_norm=1.062940 delta_norm=0.250993
[S13] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=22 metric=0.7007 head_norm=1.299208
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.801968e-01
[S5] stored merged vector for next round verification (round=22)
[S5] DEBUG after merge:  round=22 metric=0.7007 head_norm=1.578596 delta_norm=0.480197
[S5] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=22 metric=0.9945 head_norm=1.171324
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.527033e-01
[S14] stored merged vector for next round verification (round=22)
[S14] DEBUG after merge:  round=22 metric=0.9949 head_norm=1.297644 delta_norm=0.552703
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=22 metric=0.7146 head_norm=1.547978
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.721932e-02
[S2] stored merged vector for next round verification (round=22)
[S2] DEBUG after merge:  round=22 metric=0.7147 head_norm=1.535880 delta_norm=0.087219
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=22 metric=0.6727 head_norm=1.021198
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.838251e-01
[S7] stored merged vector for next round verification (round=22)
[S7] DEBUG after merge:  round=22 metric=0.6795 head_norm=0.958175 delta_norm=0.383825
[S7] aggregate: ACCEPT kept=['S9', 'S6'] (k=2/2) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.535880 cos_to_last_merge=1.0000 (last merge round=22)
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.6684526940440582, 'auprc': 0.8087749199810284, 'loss_val': 0.5469101739384807, 'psi': 0.7245815844188463}-{'f1_val': 0.7145989326098279, 'auprc': 0.8396523212230707, 'loss_val': 0.46639755633839824, 'psi': 0.7646202880551249}
[S3] START round=23 head_norm_before_train=1.835511 (no previous merge yet)
[S3] round=23 local utility u=0.024449 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9986759185126715, 'loss_val': 0.10050099599025711, 'psi': 0.9760915180683347}-{'f1_val': 0.9600662304203449, 'auprc': 0.998393898007472, 'loss_val': 0.14273873323295372, 'psi': 0.9753972974551957}
[S4] START round=23 head_norm_before_train=1.748848 cos_to_last_merge=0.8415 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.842
[S4] round=23 local utility u=0.018341 metrics={'f1_val': 0.9401505285045861, 'auprc': 0.9234709353119874, 'loss_val': 0.30130801414570496, 'psi': 0.9334786912275467}-{'f1_val': 0.9383114277839315, 'auprc': 0.9166105861171403, 'loss_val': 0.30637337476875304, 'psi': 0.929631091117215}
[S5] START round=23 head_norm_before_train=1.578596 cos_to_last_merge=1.0000 (last merge round=22)
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.6888661304184018, 'auprc': 0.8612693916463081, 'loss_val': 0.5148260620503937, 'psi': 0.7578274349095644}-{'f1_val': 0.7007413541402552, 'auprc': 0.874451746003182, 'loss_val': 0.42810984675479347, 'psi': 0.7702255108854259}
[S6] START round=23 head_norm_before_train=1.561238 cos_to_last_merge=0.9963 (last merge round=21)
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.6194029060491877, 'auprc': 0.8012561335209827, 'loss_val': 0.7001146467360279, 'psi': 0.6921441970379056}-{'f1_val': 0.9614234632811981, 'auprc': 0.9778493110160901, 'loss_val': 0.2547817186785, 'psi': 0.9679938023751549}
[S7] START round=23 head_norm_before_train=0.958175 cos_to_last_merge=1.0000 (last merge round=22)
[S7] round=23 local utility u=0.000000 metrics={'f1_val': 0.6620611237487938, 'auprc': 0.8958123868185703, 'loss_val': 0.6272547095682013, 'psi': 0.7555616289767044}-{'f1_val': 0.6727280556713737, 'auprc': 0.908108727978684, 'loss_val': 0.660989724690935, 'psi': 0.7668803245942979}
[S8] START round=23 head_norm_before_train=1.938342 (no previous merge yet)
[S8] round=23 local utility u=0.000000 metrics={'f1_val': 0.9699306628398235, 'auprc': 0.9985605210404249, 'loss_val': 0.08550719466603597, 'psi': 0.9813826061200641}-{'f1_val': 0.9927720833909908, 'auprc': 0.9909901465147379, 'loss_val': 0.05443803586552219, 'psi': 0.9920593086404896}
[S9] START round=23 head_norm_before_train=1.388799 cos_to_last_merge=0.7420 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.742
[S9] round=23 local utility u=0.007699 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9982021138662462, 'loss_val': 0.06517741316114344, 'psi': 0.9967768765650098}-{'f1_val': 0.9954108212552283, 'auprc': 0.9979820980314432, 'loss_val': 0.07742016771142303, 'psi': 0.9964393319657142}
[S10] START round=23 head_norm_before_train=1.272733 cos_to_last_merge=0.9939 (last merge round=21)
[S10] round=23 local utility u=0.023919 metrics={'f1_val': 0.9940063275949004, 'auprc': 0.9935117359958632, 'loss_val': 0.08880084456354248, 'psi': 0.9938084909552856}-{'f1_val': 0.9930642379731851, 'auprc': 0.9954417231473316, 'loss_val': 0.13677678416027533, 'psi': 0.9940152320428437}
[S11] START round=23 head_norm_before_train=1.528670 cos_to_last_merge=0.7892 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.789
[S11] round=23 local utility u=0.004752 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9982022640038047, 'loss_val': 0.06315328044062017, 'psi': 0.9972213879852501}-{'f1_val': 0.996567470639547, 'auprc': 0.9981289548834619, 'loss_val': 0.07243696591870714, 'psi': 0.997192064337113}
[S13] START round=23 head_norm_before_train=1.062940 cos_to_last_merge=1.0000 (last merge round=22)
[S13] round=23 local utility u=0.000000 metrics={'f1_val': 0.5835236552375147, 'auprc': 0.680795260256816, 'loss_val': 0.8020567224059133, 'psi': 0.6224322972452352}-{'f1_val': 0.6057539710364293, 'auprc': 0.6813027415386765, 'loss_val': 0.7920500484726685, 'psi': 0.6359734792373282}
[S14] START round=23 head_norm_before_train=1.297644 cos_to_last_merge=1.0000 (last merge round=22)
[S14] round=23 local utility u=0.038168 metrics={'f1_val': 0.9983050875260411, 'auprc': 0.9987197153544833, 'loss_val': 0.12465719858837356, 'psi': 0.998470938657418}-{'f1_val': 0.9944935406943898, 'auprc': 0.9988694984937566, 'loss_val': 0.17857394461055054, 'psi': 0.9962439238141365}
[S15] START round=23 head_norm_before_train=1.813545 cos_to_last_merge=0.8120 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.812
[S15] round=23 local utility u=0.000000 metrics={'f1_val': 0.860295492566265, 'auprc': 0.998251018816958, 'loss_val': 0.1631842485544985, 'psi': 0.9154777030665422}-{'f1_val': 0.902256433010702, 'auprc': 0.9959841685605054, 'loss_val': 0.24341570447847008, 'psi': 0.9397475272306233}
[S16] START round=23 head_norm_before_train=1.614535 cos_to_last_merge=0.7806 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.781
[S16] round=23 local utility u=0.000000 metrics={'f1_val': 0.8461456575064132, 'auprc': 0.9894617852061578, 'loss_val': 0.6484150038836849, 'psi': 0.9034721085863111}-{'f1_val': 0.9704261759711743, 'auprc': 0.9852865327245075, 'loss_val': 0.1679887085216056, 'psi': 0.9763703186725076}
[S17] START round=23 head_norm_before_train=2.002983 (no previous merge yet)
[S17] round=23 local utility u=0.098138 metrics={'f1_val': 0.6503547055621381, 'auprc': 0.8763375160219706, 'loss_val': 0.7170764103573583, 'psi': 0.7407478297460711}-{'f1_val': 0.6425997991017613, 'auprc': 0.9065823246460952, 'loss_val': 0.9575567462509148, 'psi': 0.748192809319495}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:39808
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S9] → sending delta(kind=head bytes=1791) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:39805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:39802
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:39814
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1791 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1799) from S3
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.859340)
[S14] loaded HEAD from S3 (vec_in norm=1.859340)
[S14] cosine check vs S3: cos=-0.0321
[S14] DROPPED delta from S3 (cos=-0.0321 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1796) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.362123)
[S5] loaded HEAD from S10 (vec_in norm=1.362123)
[S5] cosine check vs S10: cos=0.1694
[S5] BUFFERED delta from S10 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1791) from S9
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.413245)
[S7] loaded HEAD from S9 (vec_in norm=1.413245)
[S7] cosine check vs S9: cos=0.7722
[S7] BUFFERED delta from S9 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1802) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.345582)
[S7] loaded HEAD from S14 (vec_in norm=1.345582)
[S7] cosine check vs S14: cos=0.6597
[S7] BUFFERED delta from S14 (total buffered=2)
[S2] RECEIVED delta(kind=head bytes=1799) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.555476)
[S2] loaded HEAD from S11 (vec_in norm=1.555476)
[S2] cosine check vs S11: cos=0.9938
[S2] BUFFERED delta from S11 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1800) from S4
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.745529)
[S14] loaded HEAD from S4 (vec_in norm=1.745529)
[S14] cosine check vs S4: cos=0.1736
[S14] BUFFERED delta from S4 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:39809
[S17] sending update (kind=head size=1802 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1802) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=2.020885)
[S8] loaded HEAD from S17 (vec_in norm=2.020885)
[S8] cosine check vs S17: cos=-0.0609
[S8] DROPPED delta from S17 (cos=-0.0609 < 0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=23 metric=0.6889 head_norm=1.599743
[S5] _apply_head_vector_avg (torch): Δ‖w‖=9.587055e-01
[S5] stored merged vector for next round verification (round=23)
[S5] DEBUG after merge:  round=23 metric=0.5532 head_norm=1.134972 delta_norm=0.958705
[S5] aggregate: ROLLBACK (f1_val pre=0.689 post=0.553 tol_abs=0.005 tol_rel=0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=23 metric=0.6685 head_norm=1.580145
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.793649e-02
[S2] stored merged vector for next round verification (round=23)
[S2] DEBUG after merge:  round=23 metric=0.6707 head_norm=1.565391 delta_norm=0.087936
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=23 metric=0.6621 head_norm=0.984628
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.116823e-01
[S7] stored merged vector for next round verification (round=23)
[S7] DEBUG after merge:  round=23 metric=0.6454 head_norm=1.035096 delta_norm=0.311682
[S7] aggregate: ROLLBACK (f1_val pre=0.662 post=0.645 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=23 metric=0.9983 head_norm=1.345582
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.005232e+00
[S14] stored merged vector for next round verification (round=23)
[S14] DEBUG after merge:  round=23 metric=0.9979 head_norm=1.190899 delta_norm=1.005232
[S14] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.565391 cos_to_last_merge=1.0000 (last merge round=23)
[S2] round=24 local utility u=0.069912 metrics={'f1_val': 0.7221909756574058, 'auprc': 0.7739446715092327, 'loss_val': 0.6250251435182504, 'psi': 0.7428924539981365}-{'f1_val': 0.6684526940440582, 'auprc': 0.8087749199810284, 'loss_val': 0.5469101739384807, 'psi': 0.7245815844188463}
[S3] START round=24 head_norm_before_train=1.859340 (no previous merge yet)
[S3] round=24 local utility u=0.127215 metrics={'f1_val': 0.9974271292865575, 'auprc': 0.9985008394939539, 'loss_val': 0.06389751941770407, 'psi': 0.9978566133695161}-{'f1_val': 0.9610352511054436, 'auprc': 0.9986759185126715, 'loss_val': 0.10050099599025711, 'psi': 0.9760915180683347}
[S4] START round=24 head_norm_before_train=1.745529 cos_to_last_merge=0.8420 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.842
[S4] round=24 local utility u=0.008249 metrics={'f1_val': 0.9401278621516369, 'auprc': 0.9258987107474245, 'loss_val': 0.2919570319973746, 'psi': 0.9344362015899519}-{'f1_val': 0.9401505285045861, 'auprc': 0.9234709353119874, 'loss_val': 0.30130801414570496, 'psi': 0.9334786912275467}
[S5] START round=24 head_norm_before_train=1.134972 cos_to_last_merge=1.0000 (last merge round=23)
[S5] round=24 local utility u=0.645920 metrics={'f1_val': 0.8121630318120259, 'auprc': 0.9924147884837616, 'loss_val': 0.35620399962080734, 'psi': 0.8842637344807202}-{'f1_val': 0.6888661304184018, 'auprc': 0.8612693916463081, 'loss_val': 0.5148260620503937, 'psi': 0.7578274349095644}
[S6] START round=24 head_norm_before_train=1.615350 cos_to_last_merge=0.9894 (last merge round=21)
[S6] round=24 local utility u=0.796345 metrics={'f1_val': 0.780782101101257, 'auprc': 0.9536025075559929, 'loss_val': 0.5327396943971818, 'psi': 0.8499102636831513}-{'f1_val': 0.6194029060491877, 'auprc': 0.8012561335209827, 'loss_val': 0.7001146467360279, 'psi': 0.6921441970379056}
[S7] START round=24 head_norm_before_train=1.035096 cos_to_last_merge=1.0000 (last merge round=23)
[S7] round=24 local utility u=0.000000 metrics={'f1_val': 0.41044478380344074, 'auprc': 0.7733954047492817, 'loss_val': 0.9356018175777572, 'psi': 0.5556250321817772}-{'f1_val': 0.6620611237487938, 'auprc': 0.8958123868185703, 'loss_val': 0.6272547095682013, 'psi': 0.7555616289767044}
[S8] START round=24 head_norm_before_train=1.958244 (no previous merge yet)
[S8] round=24 local utility u=0.093886 metrics={'f1_val': 0.9926368238932805, 'auprc': 0.9988059495745725, 'loss_val': 0.0347081569471887, 'psi': 0.9951044741657973}-{'f1_val': 0.9699306628398235, 'auprc': 0.9985605210404249, 'loss_val': 0.08550719466603597, 'psi': 0.9813826061200641}
[S9] START round=24 head_norm_before_train=1.413245 cos_to_last_merge=0.7367 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.737
[S9] round=24 local utility u=0.000178 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9950567335617985, 'loss_val': 0.06038763713847323, 'psi': 0.9960190005130543}-{'f1_val': 0.9958267183641853, 'auprc': 0.9982021138662462, 'loss_val': 0.06517741316114344, 'psi': 0.9967768765650098}
[S10] START round=24 head_norm_before_train=1.362123 cos_to_last_merge=0.9830 (last merge round=21)
[S10] round=24 local utility u=0.000000 metrics={'f1_val': 0.9942227364018443, 'auprc': 0.9911946392596196, 'loss_val': 0.09045401778957424, 'psi': 0.9930114975449544}-{'f1_val': 0.9940063275949004, 'auprc': 0.9935117359958632, 'loss_val': 0.08880084456354248, 'psi': 0.9938084909552856}
[S11] START round=24 head_norm_before_train=1.555476 cos_to_last_merge=0.7852 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.785
[S11] round=24 local utility u=0.004130 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9982269329532363, 'loss_val': 0.054966923787833875, 'psi': 0.9972312555650227}-{'f1_val': 0.996567470639547, 'auprc': 0.9982022640038047, 'loss_val': 0.06315328044062017, 'psi': 0.9972213879852501}
[S13] START round=24 head_norm_before_train=1.103772 cos_to_last_merge=0.9984 (last merge round=22)
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.580434593104511, 'auprc': 0.658179897931962, 'loss_val': 0.8769875706894351, 'psi': 0.6115327150354913}-{'f1_val': 0.5835236552375147, 'auprc': 0.680795260256816, 'loss_val': 0.8020567224059133, 'psi': 0.6224322972452352}
[S14] START round=24 head_norm_before_train=1.190899 cos_to_last_merge=1.0000 (last merge round=23)
[S14] round=24 local utility u=0.000000 metrics={'f1_val': 0.9976943331204965, 'auprc': 0.9986988260103867, 'loss_val': 0.19523324121146893, 'psi': 0.9980961302764526}-{'f1_val': 0.9983050875260411, 'auprc': 0.9987197153544833, 'loss_val': 0.12465719858837356, 'psi': 0.998470938657418}
[S15] START round=24 head_norm_before_train=1.828907 cos_to_last_merge=0.8106 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.811
[S15] round=24 local utility u=0.487627 metrics={'f1_val': 0.9979790427547612, 'auprc': 0.9994955395262037, 'loss_val': 0.01776503412709558, 'psi': 0.9985856414633383}-{'f1_val': 0.860295492566265, 'auprc': 0.998251018816958, 'loss_val': 0.1631842485544985, 'psi': 0.9154777030665422}
[S16] START round=24 head_norm_before_train=1.645174 cos_to_last_merge=0.7760 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.776
[S16] round=24 local utility u=0.000000 metrics={'f1_val': 0.8379708419924967, 'auprc': 0.9887834964309243, 'loss_val': 0.7435190015440084, 'psi': 0.8982959037678678}-{'f1_val': 0.8461456575064132, 'auprc': 0.9894617852061578, 'loss_val': 0.6484150038836849, 'psi': 0.9034721085863111}
[S17] START round=24 head_norm_before_train=2.020885 (no previous merge yet)
[S17] round=24 local utility u=0.357768 metrics={'f1_val': 0.7324723865913749, 'auprc': 0.9548099094247006, 'loss_val': 0.7296643955614989, 'psi': 0.8214073957247052}-{'f1_val': 0.6503547055621381, 'auprc': 0.8763375160219706, 'loss_val': 0.7170764103573583, 'psi': 0.7407478297460711}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S3@127.0.0.1:39803
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:39805
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:39814
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:39807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:39814
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:39802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:39808
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:39814
[S9] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1793 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1797) from S8
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.968130)
[S5] loaded HEAD from S8 (vec_in norm=1.968130)
[S5] cosine check vs S8: cos=0.6808
[S5] BUFFERED delta from S8 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1800) from S3
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.882565)
[S14] loaded HEAD from S3 (vec_in norm=1.882565)
[S14] cosine check vs S3: cos=0.0076
[S14] BUFFERED delta from S3 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1798) from S9
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.436582)
[S7] loaded HEAD from S9 (vec_in norm=1.436582)
[S7] cosine check vs S9: cos=0.8454
[S7] BUFFERED delta from S9 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1798) from S2
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.602978)
[S6] loaded HEAD from S2 (vec_in norm=1.602978)
[S6] cosine check vs S2: cos=0.9529
[S6] BUFFERED delta from S2 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1801) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.652169)
[S7] loaded HEAD from S6 (vec_in norm=1.652169)
[S7] cosine check vs S6: cos=0.3123
[S7] BUFFERED delta from S6 (total buffered=2)
[S14] RECEIVED delta(kind=head bytes=1801) from S4
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.747627)
[S14] loaded HEAD from S4 (vec_in norm=1.747627)
[S14] cosine check vs S4: cos=0.8138
[S14] BUFFERED delta from S4 (total buffered=2)
[S2] RECEIVED delta(kind=head bytes=1799) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.581903)
[S2] loaded HEAD from S11 (vec_in norm=1.581903)
[S2] cosine check vs S11: cos=0.9947
[S2] BUFFERED delta from S11 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1793) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.164283)
[S3] loaded HEAD from S5 (vec_in norm=1.164283)
[S3] cosine check vs S5: cos=-0.1185
[S3] DROPPED delta from S5 (cos=-0.1185 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1795) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.843647)
[S14] loaded HEAD from S15 (vec_in norm=1.843647)
[S14] cosine check vs S15: cos=0.3121
[S14] BUFFERED delta from S15 (total buffered=3)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] → sending delta(kind=head bytes=1806) to S8@127.0.0.1:39809
[S17] sending update (kind=head size=1806 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1806) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=2.041081)
[S8] loaded HEAD from S17 (vec_in norm=2.041081)
[S8] cosine check vs S17: cos=-0.0605
[S8] DROPPED delta from S17 (cos=-0.0605 < 0.0)
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=24 metric=0.4104 head_norm=1.058458
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.541965e-01
[S7] stored merged vector for next round verification (round=24)
[S7] DEBUG after merge:  round=24 metric=0.4235 head_norm=1.020402 delta_norm=0.354196
[S7] aggregate: ACCEPT kept=['S9', 'S6'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=24 metric=0.9977 head_norm=1.239005
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.870982e-01
[S14] stored merged vector for next round verification (round=24)
[S14] DEBUG after merge:  round=24 metric=0.9977 head_norm=1.039923 delta_norm=0.487098
[S14] aggregate: ACCEPT kept=['S3', 'S4', 'S15'] (k=3/3) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=24 metric=0.7222 head_norm=1.602978
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.243291e-02
[S2] stored merged vector for next round verification (round=24)
[S2] DEBUG after merge:  round=24 metric=0.7222 head_norm=1.590340 delta_norm=0.082433
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=24 metric=0.8122 head_norm=1.164283
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.261067e-01
[S5] stored merged vector for next round verification (round=24)
[S5] DEBUG after merge:  round=24 metric=0.8551 head_norm=1.444754 delta_norm=0.726107
[S5] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=24 metric=0.7808 head_norm=1.652169
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.510132e-01
[S6] stored merged vector for next round verification (round=24)
[S6] DEBUG after merge:  round=24 metric=0.7999 head_norm=1.608289 delta_norm=0.251013
[S6] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.590340 cos_to_last_merge=1.0000 (last merge round=24)
[S2] round=25 local utility u=0.397721 metrics={'f1_val': 0.7079931538386547, 'auprc': 0.9643666561900849, 'loss_val': 0.3156612616603463, 'psi': 0.8105425547792268}-{'f1_val': 0.7221909756574058, 'auprc': 0.7739446715092327, 'loss_val': 0.6250251435182504, 'psi': 0.7428924539981365}
[S3] START round=25 head_norm_before_train=1.882565 (no previous merge yet)
[S3] round=25 local utility u=0.000000 metrics={'f1_val': 0.9394735208294531, 'auprc': 0.998491107952894, 'loss_val': 0.13157841274815782, 'psi': 0.9630805556788294}-{'f1_val': 0.9974271292865575, 'auprc': 0.9985008394939539, 'loss_val': 0.06389751941770407, 'psi': 0.9978566133695161}
[S4] START round=25 head_norm_before_train=1.747627 cos_to_last_merge=0.8418 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.842
[S4] round=25 local utility u=0.000000 metrics={'f1_val': 0.9391769644130539, 'auprc': 0.9239501082921373, 'loss_val': 0.291964475277201, 'psi': 0.9330862219646872}-{'f1_val': 0.9401278621516369, 'auprc': 0.9258987107474245, 'loss_val': 0.2919570319973746, 'psi': 0.9344362015899519}
[S5] START round=25 head_norm_before_train=1.444754 cos_to_last_merge=1.0000 (last merge round=24)
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.700781124122831, 'auprc': 0.8536419498279295, 'loss_val': 0.5342521459376584, 'psi': 0.7619254544048704}-{'f1_val': 0.8121630318120259, 'auprc': 0.9924147884837616, 'loss_val': 0.35620399962080734, 'psi': 0.8842637344807202}
[S6] START round=25 head_norm_before_train=1.608289 cos_to_last_merge=1.0000 (last merge round=24)
[S6] round=25 local utility u=0.000000 metrics={'f1_val': 0.6201135961902827, 'auprc': 0.8044404062585782, 'loss_val': 0.6858905637461872, 'psi': 0.6938443202176009}-{'f1_val': 0.780782101101257, 'auprc': 0.9536025075559929, 'loss_val': 0.5327396943971818, 'psi': 0.8499102636831513}
[S7] START round=25 head_norm_before_train=1.020402 cos_to_last_merge=1.0000 (last merge round=24)
[S7] round=25 local utility u=1.000000 metrics={'f1_val': 0.6510513982498044, 'auprc': 0.8416689527221805, 'loss_val': 0.5789177111973631, 'psi': 0.7272984200387549}-{'f1_val': 0.41044478380344074, 'auprc': 0.7733954047492817, 'loss_val': 0.9356018175777572, 'psi': 0.5556250321817772}
[S8] START round=25 head_norm_before_train=1.968130 (no previous merge yet)
[S8] round=25 local utility u=0.000000 metrics={'f1_val': 0.9888526342761694, 'auprc': 0.9987790487067856, 'loss_val': 0.0399592419803068, 'psi': 0.9928232000484158}-{'f1_val': 0.9926368238932805, 'auprc': 0.9988059495745725, 'loss_val': 0.0347081569471887, 'psi': 0.9951044741657973}
[S9] START round=25 head_norm_before_train=1.436582 cos_to_last_merge=0.7317 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.732
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.9875711251504857, 'auprc': 0.9974843805126792, 'loss_val': 0.07436794446912785, 'psi': 0.9915364272953632}-{'f1_val': 0.9966605118138915, 'auprc': 0.9950567335617985, 'loss_val': 0.06038763713847323, 'psi': 0.9960190005130543}
[S10] START round=25 head_norm_before_train=1.431668 cos_to_last_merge=0.9739 (last merge round=21)
[S10] round=25 local utility u=0.020637 metrics={'f1_val': 0.994201135124253, 'auprc': 0.9935999407464228, 'loss_val': 0.05626664153913339, 'psi': 0.993960657373121}-{'f1_val': 0.9942227364018443, 'auprc': 0.9911946392596196, 'loss_val': 0.09045401778957424, 'psi': 0.9930114975449544}
[S11] START round=25 head_norm_before_train=1.581903 cos_to_last_merge=0.7814 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.781
[S11] round=25 local utility u=0.003129 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9981510845650998, 'loss_val': 0.048481460143979416, 'psi': 0.9972009162097681}-{'f1_val': 0.996567470639547, 'auprc': 0.9982269329532363, 'loss_val': 0.054966923787833875, 'psi': 0.9972312555650227}
[S13] START round=25 head_norm_before_train=1.151595 cos_to_last_merge=0.9938 (last merge round=22)
[S13] round=25 local utility u=0.000000 metrics={'f1_val': 0.5971980059888896, 'auprc': 0.539533627858718, 'loss_val': 0.8092688986061448, 'psi': 0.574132254736821}-{'f1_val': 0.580434593104511, 'auprc': 0.658179897931962, 'loss_val': 0.8769875706894351, 'psi': 0.6115327150354913}
[S14] START round=25 head_norm_before_train=1.039923 cos_to_last_merge=1.0000 (last merge round=24)
[S14] round=25 local utility u=0.000000 metrics={'f1_val': 0.9974055297193176, 'auprc': 0.9986290688539139, 'loss_val': 0.24894321524824747, 'psi': 0.9978949453731562}-{'f1_val': 0.9976943331204965, 'auprc': 0.9986988260103867, 'loss_val': 0.19523324121146893, 'psi': 0.9980961302764526}
[S15] START round=25 head_norm_before_train=1.843647 cos_to_last_merge=0.8092 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.809
[S15] round=25 local utility u=0.000857 metrics={'f1_val': 0.9975479273409924, 'auprc': 0.9997246731942675, 'loss_val': 0.014151229755716156, 'psi': 0.9984186256823024}-{'f1_val': 0.9979790427547612, 'auprc': 0.9994955395262037, 'loss_val': 0.01776503412709558, 'psi': 0.9985856414633383}
[S16] START round=25 head_norm_before_train=1.674420 cos_to_last_merge=0.7725 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.773
[S16] round=25 local utility u=0.256743 metrics={'f1_val': 0.8765032387211372, 'auprc': 0.9903431372555931, 'loss_val': 0.46590581596306246, 'psi': 0.9220391981349196}-{'f1_val': 0.8379708419924967, 'auprc': 0.9887834964309243, 'loss_val': 0.7435190015440084, 'psi': 0.8982959037678678}
[S17] START round=25 head_norm_before_train=2.041081 (no previous merge yet)
[S17] round=25 local utility u=0.000000 metrics={'f1_val': 0.6398235190870898, 'auprc': 0.8589774230894658, 'loss_val': 1.0350148971492434, 'psi': 0.7274850806880402}-{'f1_val': 0.7324723865913749, 'auprc': 0.9548099094247006, 'loss_val': 0.7296643955614989, 'psi': 0.8214073957247052}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:39802
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:39805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S16] → sending delta(kind=head bytes=1806) to S14@127.0.0.1:39814
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:39813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:39807
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1806 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1799) from S2
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.632765)
[S6] loaded HEAD from S2 (vec_in norm=1.632765)
[S6] cosine check vs S2: cos=0.9811
[S6] BUFFERED delta from S2 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1802) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.481624)
[S5] loaded HEAD from S10 (vec_in norm=1.481624)
[S5] cosine check vs S10: cos=0.2915
[S5] BUFFERED delta from S10 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1796) from S7
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.041580)
[S13] loaded HEAD from S7 (vec_in norm=1.041580)
[S13] cosine check vs S7: cos=0.8620
[S13] BUFFERED delta from S7 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1806) from S16
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.700244)
[S14] loaded HEAD from S16 (vec_in norm=1.700244)
[S14] cosine check vs S16: cos=0.4218
[S14] BUFFERED delta from S16 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1797) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.859019)
[S14] loaded HEAD from S15 (vec_in norm=1.859019)
[S14] cosine check vs S15: cos=0.4663
[S14] BUFFERED delta from S15 (total buffered=2)
[S2] RECEIVED delta(kind=head bytes=1796) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.608914)
[S2] loaded HEAD from S11 (vec_in norm=1.608914)
[S2] cosine check vs S11: cos=0.9948
[S2] BUFFERED delta from S11 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=25 metric=0.7008 head_norm=1.466904
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.774884e-01
[S5] stored merged vector for next round verification (round=25)
[S5] DEBUG after merge:  round=25 metric=0.5417 head_norm=1.184704 delta_norm=0.877488
[S5] aggregate: ROLLBACK (f1_val pre=0.701 post=0.542 tol_abs=0.005 tol_rel=0.0)
[S5] ⇄ pheromone p=0.218 → S3@127.0.0.1:39803
[S4] ⇄ pheromone p=0.044 → S14@127.0.0.1:39814
[S8] ⇄ pheromone p=0.072 → S5@127.0.0.1:39805
[S3] ⇄ pheromone p=0.114 → S14@127.0.0.1:39814
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=25 metric=0.6201 head_norm=1.640754
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.591461e-01
[S6] stored merged vector for next round verification (round=25)
[S6] DEBUG after merge:  round=25 metric=0.6208 head_norm=1.629009 delta_norm=0.159146
[S6] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.262 → S7@127.0.0.1:39808
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=25 metric=0.5972 head_norm=1.187929
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.012191e-01
[S13] stored merged vector for next round verification (round=25)
[S13] DEBUG after merge:  round=25 metric=0.5984 head_norm=1.075778 delta_norm=0.301219
[S13] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.015 → S10@127.0.0.1:39811
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=25 metric=0.9974 head_norm=1.094843
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.475986e-01
[S14] stored merged vector for next round verification (round=25)
[S14] DEBUG after merge:  round=25 metric=0.9974 head_norm=1.134237 delta_norm=0.647599
[S14] aggregate: ACCEPT kept=['S16', 'S15'] (k=2/2) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.062 → S7@127.0.0.1:39808
[S9] ⇄ pheromone p=0.094 → S7@127.0.0.1:39808
[S11] ⇄ pheromone p=0.049 → S2@127.0.0.1:39802
[S16] ⇄ pheromone p=0.193 → S14@127.0.0.1:39814
[S10] ⇄ pheromone p=0.031 → S5@127.0.0.1:39805
[S7] ⇄ pheromone p=0.342 → S13@127.0.0.1:39813
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=25 metric=0.7080 head_norm=1.632765
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.363020e-02
[S2] stored merged vector for next round verification (round=25)
[S2] DEBUG after merge:  round=25 metric=0.7082 head_norm=1.618724 delta_norm=0.083630
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.124 → S6@127.0.0.1:39807
[S15] ⇄ pheromone p=0.195 → S14@127.0.0.1:39814
[S17] ⇄ pheromone p=0.163 → S8@127.0.0.1:39809
[S2] START round=26 head_norm_before_train=1.618724 cos_to_last_merge=1.0000 (last merge round=25)
[S2] round=26 local utility u=0.000000 metrics={'f1_val': 0.7138098522981293, 'auprc': 0.8957393910704805, 'loss_val': 0.4030462654559546, 'psi': 0.7865816678070698}-{'f1_val': 0.7079931538386547, 'auprc': 0.9643666561900849, 'loss_val': 0.3156612616603463, 'psi': 0.8105425547792268}
[S3] START round=26 head_norm_before_train=1.902485 (no previous merge yet)
[S3] round=26 local utility u=0.161230 metrics={'f1_val': 0.9837474416358228, 'auprc': 0.9985053205636525, 'loss_val': 0.07480537513055771, 'psi': 0.9896505932069546}-{'f1_val': 0.9394735208294531, 'auprc': 0.998491107952894, 'loss_val': 0.13157841274815782, 'psi': 0.9630805556788294}
[S4] START round=26 head_norm_before_train=1.754456 cos_to_last_merge=0.8413 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.841
[S4] round=26 local utility u=0.052191 metrics={'f1_val': 0.9434276311119228, 'auprc': 0.9463902351873401, 'loss_val': 0.2804061348874963, 'psi': 0.9446126727420897}-{'f1_val': 0.9391769644130539, 'auprc': 0.9239501082921373, 'loss_val': 0.291964475277201, 'psi': 0.9330862219646872}
[S5] START round=26 head_norm_before_train=1.184704 cos_to_last_merge=1.0000 (last merge round=25)
[S5] round=26 local utility u=0.538668 metrics={'f1_val': 0.7742858841055608, 'auprc': 0.9925436499743275, 'loss_val': 0.3146490636924056, 'psi': 0.8615889904530675}-{'f1_val': 0.700781124122831, 'auprc': 0.8536419498279295, 'loss_val': 0.5342521459376584, 'psi': 0.7619254544048704}
[S6] START round=26 head_norm_before_train=1.629009 cos_to_last_merge=1.0000 (last merge round=25)
[S6] round=26 local utility u=1.000000 metrics={'f1_val': 0.8767050071268387, 'auprc': 0.9672859957140182, 'loss_val': 0.33211335015045373, 'psi': 0.9129374025617105}-{'f1_val': 0.6201135961902827, 'auprc': 0.8044404062585782, 'loss_val': 0.6858905637461872, 'psi': 0.6938443202176009}
[S7] START round=26 head_norm_before_train=1.041580 cos_to_last_merge=0.9995 (last merge round=24)
[S7] round=26 local utility u=0.000000 metrics={'f1_val': 0.4466391305360637, 'auprc': 0.7810946675652914, 'loss_val': 0.9218440016212729, 'psi': 0.5804213453477548}-{'f1_val': 0.6510513982498044, 'auprc': 0.8416689527221805, 'loss_val': 0.5789177111973631, 'psi': 0.7272984200387549}
[S8] START round=26 head_norm_before_train=1.977559 (no previous merge yet)
[S8] round=26 local utility u=0.019335 metrics={'f1_val': 0.9942884390087473, 'auprc': 0.9986877470344665, 'loss_val': 0.03362947619627489, 'psi': 0.996048162219035}-{'f1_val': 0.9888526342761694, 'auprc': 0.9987790487067856, 'loss_val': 0.0399592419803068, 'psi': 0.9928232000484158}
[S9] START round=26 head_norm_before_train=1.458323 cos_to_last_merge=0.7274 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.727
[S9] round=26 local utility u=0.039072 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9982912146271732, 'loss_val': 0.04817830247690032, 'psi': 0.9968125168693805}-{'f1_val': 0.9875711251504857, 'auprc': 0.9974843805126792, 'loss_val': 0.07436794446912785, 'psi': 0.9915364272953632}
[S10] START round=26 head_norm_before_train=1.481624 cos_to_last_merge=0.9674 (last merge round=21)
[S10] round=26 local utility u=0.003409 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9926729614195988, 'loss_val': 0.049447299350413615, 'psi': 0.9938678175734894}-{'f1_val': 0.994201135124253, 'auprc': 0.9935999407464228, 'loss_val': 0.05626664153913339, 'psi': 0.993960657373121}
[S11] START round=26 head_norm_before_train=1.608914 cos_to_last_merge=0.7777 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.778
[S11] round=26 local utility u=0.002725 metrics={'f1_val': 0.996567470639547, 'auprc': 0.998123452945081, 'loss_val': 0.04294907078697198, 'psi': 0.9971898635617606}-{'f1_val': 0.996567470639547, 'auprc': 0.9981510845650998, 'loss_val': 0.048481460143979416, 'psi': 0.9972009162097681}
[S13] START round=26 head_norm_before_train=1.075778 cos_to_last_merge=1.0000 (last merge round=25)
[S13] round=26 local utility u=0.196569 metrics={'f1_val': 0.5931260549739613, 'auprc': 0.6667507561704149, 'loss_val': 0.7733507394100698, 'psi': 0.6225759354525428}-{'f1_val': 0.5971980059888896, 'auprc': 0.539533627858718, 'loss_val': 0.8092688986061448, 'psi': 0.574132254736821}
[S14] START round=26 head_norm_before_train=1.134237 cos_to_last_merge=1.0000 (last merge round=25)
[S14] round=26 local utility u=0.025344 metrics={'f1_val': 0.9880243095977533, 'auprc': 0.9990959469790761, 'loss_val': 0.14336883074386994, 'psi': 0.9924529645502824}-{'f1_val': 0.9974055297193176, 'auprc': 0.9986290688539139, 'loss_val': 0.24894321524824747, 'psi': 0.9978949453731562}
[S15] START round=26 head_norm_before_train=1.859019 cos_to_last_merge=0.8079 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.808
[S15] round=26 local utility u=0.000000 metrics={'f1_val': 0.7714350047873728, 'auprc': 0.9868270011718939, 'loss_val': 0.4446612866084598, 'psi': 0.8575918033411812}-{'f1_val': 0.9975479273409924, 'auprc': 0.9997246731942675, 'loss_val': 0.014151229755716156, 'psi': 0.9984186256823024}
[S16] START round=26 head_norm_before_train=1.700244 cos_to_last_merge=0.7699 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.770
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.8779653118276385, 'auprc': 0.989488455210442, 'loss_val': 0.47732720527176764, 'psi': 0.92257456918076}-{'f1_val': 0.8765032387211372, 'auprc': 0.9903431372555931, 'loss_val': 0.46590581596306246, 'psi': 0.9220391981349196}
[S17] START round=26 head_norm_before_train=2.058255 (no previous merge yet)
[S17] round=26 local utility u=1.000000 metrics={'f1_val': 0.8529402452839714, 'auprc': 0.9323906241930296, 'loss_val': 0.2719852090640135, 'psi': 0.8847203968475946}-{'f1_val': 0.6398235190870898, 'auprc': 0.8589774230894658, 'loss_val': 1.0350148971492434, 'psi': 0.7274850806880402}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:39803
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:39814
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.994)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:39805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] → sending delta(kind=head bytes=1793) to S10@127.0.0.1:39811
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:39808
[S11] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:39808
[S9] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1793 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1802) from S4
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.761846)
[S14] loaded HEAD from S4 (vec_in norm=1.761846)
[S14] cosine check vs S4: cos=0.3318
[S14] BUFFERED delta from S4 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1796) from S8
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.990941)
[S5] loaded HEAD from S8 (vec_in norm=1.990941)
[S5] cosine check vs S8: cos=0.5837
[S5] BUFFERED delta from S8 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1796) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.648310)
[S7] loaded HEAD from S6 (vec_in norm=1.648310)
[S7] cosine check vs S6: cos=0.5178
[S7] BUFFERED delta from S6 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1799) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.212838)
[S3] loaded HEAD from S5 (vec_in norm=1.212838)
[S3] cosine check vs S5: cos=-0.1165
[S3] DROPPED delta from S5 (cos=-0.1165 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1799) from S9
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.476879)
[S7] loaded HEAD from S9 (vec_in norm=1.476879)
[S7] cosine check vs S9: cos=0.7894
[S7] BUFFERED delta from S9 (total buffered=2)
[S7] RECEIVED delta(kind=head bytes=1802) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.197710)
[S7] loaded HEAD from S14 (vec_in norm=1.197710)
[S7] cosine check vs S14: cos=0.6068
[S7] BUFFERED delta from S14 (total buffered=3)
[S10] RECEIVED delta(kind=head bytes=1793) from S13
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.119197)
[S10] loaded HEAD from S13 (vec_in norm=1.119197)
[S10] cosine check vs S13: cos=0.8438
[S10] BUFFERED delta from S13 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1796) from S3
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.920532)
[S14] loaded HEAD from S3 (vec_in norm=1.920532)
[S14] cosine check vs S3: cos=0.1143
[S14] BUFFERED delta from S3 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:39809
[S17] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=2.066041)
[S8] loaded HEAD from S17 (vec_in norm=2.066041)
[S8] cosine check vs S17: cos=-0.0616
[S8] DROPPED delta from S17 (cos=-0.0616 < 0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=26 metric=0.9947 head_norm=1.523071
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.170509e-01
[S10] stored merged vector for next round verification (round=26)
[S10] DEBUG after merge:  round=26 metric=0.9942 head_norm=1.269741 delta_norm=0.417051
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=26 metric=0.4466 head_norm=1.059361
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.167388e-01
[S7] stored merged vector for next round verification (round=26)
[S7] DEBUG after merge:  round=26 metric=0.4445 head_norm=0.988755 delta_norm=0.216739
[S7] aggregate: ACCEPT kept=['S6', 'S9', 'S14'] (k=3/3) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=26 metric=0.7743 head_norm=1.212838
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.086721e-01
[S5] stored merged vector for next round verification (round=26)
[S5] DEBUG after merge:  round=26 metric=0.9157 head_norm=1.436475 delta_norm=0.808672
[S5] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=26 metric=0.9880 head_norm=1.197710
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.485309e-01
[S14] stored merged vector for next round verification (round=26)
[S14] DEBUG after merge:  round=26 metric=0.9927 head_norm=1.020687 delta_norm=0.748531
[S14] aggregate: ACCEPT kept=['S4', 'S3'] (k=2/2) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.662375 cos_to_last_merge=0.9988 (last merge round=25)
[S2] round=27 local utility u=0.000000 metrics={'f1_val': 0.717307326019855, 'auprc': 0.7948677805250568, 'loss_val': 0.5293396345571451, 'psi': 0.7483315078219357}-{'f1_val': 0.7138098522981293, 'auprc': 0.8957393910704805, 'loss_val': 0.4030462654559546, 'psi': 0.7865816678070698}
[S3] START round=27 head_norm_before_train=1.920532 (no previous merge yet)
[S3] round=27 local utility u=0.000000 metrics={'f1_val': 0.9041829502372453, 'auprc': 0.9986884119458028, 'loss_val': 0.18748996927866038, 'psi': 0.9419851349206683}-{'f1_val': 0.9837474416358228, 'auprc': 0.9985053205636525, 'loss_val': 0.07480537513055771, 'psi': 0.9896505932069546}
[S4] START round=27 head_norm_before_train=1.761846 cos_to_last_merge=0.8404 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.840
[S4] round=27 local utility u=0.003990 metrics={'f1_val': 0.9436461338717462, 'auprc': 0.9493065562217102, 'loss_val': 0.2824870418218985, 'psi': 0.9459103028117317}-{'f1_val': 0.9434276311119228, 'auprc': 0.9463902351873401, 'loss_val': 0.2804061348874963, 'psi': 0.9446126727420897}
[S5] START round=27 head_norm_before_train=1.436475 cos_to_last_merge=1.0000 (last merge round=26)
[S5] round=27 local utility u=0.000000 metrics={'f1_val': 0.7008676007203419, 'auprc': 0.9074130925154991, 'loss_val': 0.44271173929724517, 'psi': 0.7834857974384049}-{'f1_val': 0.7742858841055608, 'auprc': 0.9925436499743275, 'loss_val': 0.3146490636924056, 'psi': 0.8615889904530675}
[S6] START round=27 head_norm_before_train=1.648310 cos_to_last_merge=0.9997 (last merge round=25)
[S6] round=27 local utility u=0.000000 metrics={'f1_val': 0.866114341982032, 'auprc': 0.9671195495139381, 'loss_val': 0.3741433236208567, 'psi': 0.9065164249947945}-{'f1_val': 0.8767050071268387, 'auprc': 0.9672859957140182, 'loss_val': 0.33211335015045373, 'psi': 0.9129374025617105}
[S7] START round=27 head_norm_before_train=0.988755 cos_to_last_merge=1.0000 (last merge round=26)
[S7] round=27 local utility u=0.730091 metrics={'f1_val': 0.6288699093613819, 'auprc': 0.8109364283270967, 'loss_val': 0.6445722460851965, 'psi': 0.7016965169476679}-{'f1_val': 0.4466391305360637, 'auprc': 0.7810946675652914, 'loss_val': 0.9218440016212729, 'psi': 0.5804213453477548}
[S8] START round=27 head_norm_before_train=1.990941 (no previous merge yet)
[S8] round=27 local utility u=0.000000 metrics={'f1_val': 0.9835375302390839, 'auprc': 0.9987912997380026, 'loss_val': 0.04894957217131266, 'psi': 0.9896390380386514}-{'f1_val': 0.9942884390087473, 'auprc': 0.9986877470344665, 'loss_val': 0.03362947619627489, 'psi': 0.996048162219035}
[S9] START round=27 head_norm_before_train=1.476879 cos_to_last_merge=0.7237 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.724
[S9] round=27 local utility u=0.000000 metrics={'f1_val': 0.9954158325366191, 'auprc': 0.9973561315531938, 'loss_val': 0.043607251838916644, 'psi': 0.996191952143249}-{'f1_val': 0.9958267183641853, 'auprc': 0.9982912146271732, 'loss_val': 0.04817830247690032, 'psi': 0.9968125168693805}
[S10] START round=27 head_norm_before_train=1.269741 cos_to_last_merge=1.0000 (last merge round=26)
[S10] round=27 local utility u=0.000000 metrics={'f1_val': 0.9948838907637279, 'auprc': 0.9916120832926073, 'loss_val': 0.11238053162836198, 'psi': 0.9935751677752797}-{'f1_val': 0.9946643883427498, 'auprc': 0.9926729614195988, 'loss_val': 0.049447299350413615, 'psi': 0.9938678175734894}
[S11] START round=27 head_norm_before_train=1.635333 cos_to_last_merge=0.7744 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.774
[S11] round=27 local utility u=0.001843 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9978979710640578, 'loss_val': 0.03858729127467973, 'psi': 0.9970996708093514}-{'f1_val': 0.996567470639547, 'auprc': 0.998123452945081, 'loss_val': 0.04294907078697198, 'psi': 0.9971898635617606}
[S13] START round=27 head_norm_before_train=1.119197 cos_to_last_merge=0.9987 (last merge round=25)
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.5716157224841935, 'auprc': 0.6696448691058234, 'loss_val': 0.7306539526026368, 'psi': 0.6108273811328455}-{'f1_val': 0.5931260549739613, 'auprc': 0.6667507561704149, 'loss_val': 0.7733507394100698, 'psi': 0.6225759354525428}
[S14] START round=27 head_norm_before_train=1.020687 cos_to_last_merge=1.0000 (last merge round=26)
[S14] round=27 local utility u=0.000000 metrics={'f1_val': 0.9974515471354712, 'auprc': 0.9985200900108122, 'loss_val': 0.2738577348472567, 'psi': 0.9978789642856076}-{'f1_val': 0.9880243095977533, 'auprc': 0.9990959469790761, 'loss_val': 0.14336883074386994, 'psi': 0.9924529645502824}
[S15] START round=27 head_norm_before_train=1.872310 cos_to_last_merge=0.8068 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.807
[S15] round=27 local utility u=0.911037 metrics={'f1_val': 0.9971773386779533, 'auprc': 0.999294271005199, 'loss_val': 0.014443805029297332, 'psi': 0.9980241116088515}-{'f1_val': 0.7714350047873728, 'auprc': 0.9868270011718939, 'loss_val': 0.4446612866084598, 'psi': 0.8575918033411812}
[S16] START round=27 head_norm_before_train=1.720981 cos_to_last_merge=0.7679 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.768
[S16] round=27 local utility u=0.223349 metrics={'f1_val': 0.9241963288683326, 'auprc': 0.9911006845904247, 'loss_val': 0.31285109846208276, 'psi': 0.9509580711571693}-{'f1_val': 0.8779653118276385, 'auprc': 0.989488455210442, 'loss_val': 0.47732720527176764, 'psi': 0.92257456918076}
[S17] START round=27 head_norm_before_train=2.066041 (no previous merge yet)
[S17] round=27 local utility u=0.000000 metrics={'f1_val': 0.6189723739526041, 'auprc': 0.8736451279595918, 'loss_val': 1.3007765308413795, 'psi': 0.7208414755553991}-{'f1_val': 0.8529402452839714, 'auprc': 0.9323906241930296, 'loss_val': 0.2719852090640135, 'psi': 0.8847203968475946}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:39813
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1803) from S4
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.765192)
[S14] loaded HEAD from S4 (vec_in norm=1.765192)
[S14] cosine check vs S4: cos=0.6381
[S14] BUFFERED delta from S4 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1800) from S7
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.002987)
[S13] loaded HEAD from S7 (vec_in norm=1.002987)
[S13] cosine check vs S7: cos=0.9479
[S13] BUFFERED delta from S7 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:39802
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1799 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1799) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.658854)
[S2] loaded HEAD from S11 (vec_in norm=1.658854)
[S2] cosine check vs S11: cos=0.9909
[S2] BUFFERED delta from S11 (total buffered=1)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S16] → sending delta(kind=head bytes=1806) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:39814
[S15] sending update (kind=head size=1796 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1796) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.886017)
[S14] loaded HEAD from S15 (vec_in norm=1.886017)
[S14] cosine check vs S15: cos=0.4485
[S14] BUFFERED delta from S15 (total buffered=2)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1806 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1806) from S16
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.738579)
[S14] loaded HEAD from S16 (vec_in norm=1.738579)
[S14] cosine check vs S16: cos=0.4215
[S14] BUFFERED delta from S16 (total buffered=3)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=27 metric=0.7173 head_norm=1.697736
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.147723e-01
[S2] stored merged vector for next round verification (round=27)
[S2] DEBUG after merge:  round=27 metric=0.7173 head_norm=1.674479 delta_norm=0.114772
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=27 metric=0.5716 head_norm=1.159368
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.907767e-01
[S13] stored merged vector for next round verification (round=27)
[S13] DEBUG after merge:  round=27 metric=0.5697 head_norm=1.067081 delta_norm=0.190777
[S13] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=27 metric=0.9975 head_norm=1.070038
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.280483e-01
[S14] stored merged vector for next round verification (round=27)
[S14] DEBUG after merge:  round=27 metric=0.9975 head_norm=1.054433 delta_norm=0.428048
[S14] aggregate: ACCEPT kept=['S4', 'S15', 'S16'] (k=3/3) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=1.674479 cos_to_last_merge=1.0000 (last merge round=27)
[S2] round=28 local utility u=0.030403 metrics={'f1_val': 0.7161886289791697, 'auprc': 0.8200999867619081, 'loss_val': 0.5375174257011316, 'psi': 0.757753172092265}-{'f1_val': 0.717307326019855, 'auprc': 0.7948677805250568, 'loss_val': 0.5293396345571451, 'psi': 0.7483315078219357}
[S3] START round=28 head_norm_before_train=1.939046 (no previous merge yet)
[S3] round=28 local utility u=0.286903 metrics={'f1_val': 0.978685818553173, 'auprc': 0.9985056906989929, 'loss_val': 0.06015368150713544, 'psi': 0.986613767411501}-{'f1_val': 0.9041829502372453, 'auprc': 0.9986884119458028, 'loss_val': 0.18748996927866038, 'psi': 0.9419851349206683}
[S4] START round=28 head_norm_before_train=1.765192 cos_to_last_merge=0.8402 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.840
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.9395966352951712, 'auprc': 0.9289582727987707, 'loss_val': 0.2974311662241383, 'psi': 0.9353412902966111}-{'f1_val': 0.9436461338717462, 'auprc': 0.9493065562217102, 'loss_val': 0.2824870418218985, 'psi': 0.9459103028117317}
[S5] START round=28 head_norm_before_train=1.459376 cos_to_last_merge=0.9995 (last merge round=26)
[S5] round=28 local utility u=0.140248 metrics={'f1_val': 0.7020603460463012, 'auprc': 0.9673289404462242, 'loss_val': 0.3491206733719569, 'psi': 0.8081677838062704}-{'f1_val': 0.7008676007203419, 'auprc': 0.9074130925154991, 'loss_val': 0.44271173929724517, 'psi': 0.7834857974384049}
[S6] START round=28 head_norm_before_train=1.662695 cos_to_last_merge=0.9991 (last merge round=25)
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.7818309146365626, 'auprc': 0.9601215519122798, 'loss_val': 0.4776755771059128, 'psi': 0.8531471695468495}-{'f1_val': 0.866114341982032, 'auprc': 0.9671195495139381, 'loss_val': 0.3741433236208567, 'psi': 0.9065164249947945}
[S7] START round=28 head_norm_before_train=1.002987 cos_to_last_merge=0.9997 (last merge round=26)
[S7] round=28 local utility u=0.000000 metrics={'f1_val': 0.5485937181065218, 'auprc': 0.7843668973072764, 'loss_val': 0.7963534133549223, 'psi': 0.6429029897868237}-{'f1_val': 0.6288699093613819, 'auprc': 0.8109364283270967, 'loss_val': 0.6445722460851965, 'psi': 0.7016965169476679}
[S8] START round=28 head_norm_before_train=2.007748 (no previous merge yet)
[S8] round=28 local utility u=0.035810 metrics={'f1_val': 0.9926368238932805, 'auprc': 0.9988700151390604, 'loss_val': 0.032161371403270196, 'psi': 0.9951301003915924}-{'f1_val': 0.9835375302390839, 'auprc': 0.9987912997380026, 'loss_val': 0.04894957217131266, 'psi': 0.9896390380386514}
[S9] START round=28 head_norm_before_train=1.498732 cos_to_last_merge=0.7197 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.720
[S9] round=28 local utility u=0.005006 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9984086913885369, 'loss_val': 0.03921868388556878, 'psi': 0.996859507573926}-{'f1_val': 0.9954158325366191, 'auprc': 0.9973561315531938, 'loss_val': 0.043607251838916644, 'psi': 0.996191952143249}
[S10] START round=28 head_norm_before_train=1.325187 cos_to_last_merge=0.9987 (last merge round=26)
[S10] round=28 local utility u=0.014759 metrics={'f1_val': 0.9940063275949004, 'auprc': 0.9917056056379661, 'loss_val': 0.07787805260328318, 'psi': 0.9930860388121266}-{'f1_val': 0.9948838907637279, 'auprc': 0.9916120832926073, 'loss_val': 0.11238053162836198, 'psi': 0.9935751677752797}
[S11] START round=28 head_norm_before_train=1.658854 cos_to_last_merge=0.7717 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.772
[S11] round=28 local utility u=0.001127 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9977841228111892, 'loss_val': 0.03586844281185051, 'psi': 0.9970418518326294}-{'f1_val': 0.996567470639547, 'auprc': 0.9978979710640578, 'loss_val': 0.03858729127467973, 'psi': 0.9970996708093514}
[S13] START round=28 head_norm_before_train=1.067081 cos_to_last_merge=1.0000 (last merge round=27)
[S13] round=28 local utility u=0.021937 metrics={'f1_val': 0.5960881637085929, 'auprc': 0.6682144177512217, 'loss_val': 0.8293227745691304, 'psi': 0.6249386653256443}-{'f1_val': 0.5716157224841935, 'auprc': 0.6696448691058234, 'loss_val': 0.7306539526026368, 'psi': 0.6108273811328455}
[S14] START round=28 head_norm_before_train=1.054433 cos_to_last_merge=1.0000 (last merge round=27)
[S14] round=28 local utility u=0.062796 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9986836608808541, 'loss_val': 0.14995344282293366, 'psi': 0.9980641351822538}-{'f1_val': 0.9974515471354712, 'auprc': 0.9985200900108122, 'loss_val': 0.2738577348472567, 'psi': 0.9978789642856076}
[S15] START round=28 head_norm_before_train=1.886017 cos_to_last_merge=0.8056 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.806
[S15] round=28 local utility u=0.000030 metrics={'f1_val': 0.9971773386779533, 'auprc': 0.9992716668354018, 'loss_val': 0.014315218467650773, 'psi': 0.9980150699409327}-{'f1_val': 0.9971773386779533, 'auprc': 0.999294271005199, 'loss_val': 0.014443805029297332, 'psi': 0.9980241116088515}
[S16] START round=28 head_norm_before_train=1.738579 cos_to_last_merge=0.7665 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.767
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.913336515343199, 'auprc': 0.9932253677561071, 'loss_val': 0.3690508395052943, 'psi': 0.9452920563083622}-{'f1_val': 0.9241963288683326, 'auprc': 0.9911006845904247, 'loss_val': 0.31285109846208276, 'psi': 0.9509580711571693}
[S17] START round=28 head_norm_before_train=2.068161 (no previous merge yet)
[S17] round=28 local utility u=1.000000 metrics={'f1_val': 0.8668634196170344, 'auprc': 0.9998626047937524, 'loss_val': 0.2907640461782347, 'psi': 0.9200630936877217}-{'f1_val': 0.6189723739526041, 'auprc': 0.8736451279595918, 'loss_val': 1.3007765308413795, 'psi': 0.7208414755553991}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:39811
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:39805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:39807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:39805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:39802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S7@127.0.0.1:39808
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1794 to 1 peers)
[S2] sending update (kind=head size=1804 to 1 peers)
[S13] sending update (kind=head size=1795 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1804) from S2
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.701442)
[S6] loaded HEAD from S2 (vec_in norm=1.701442)
[S6] cosine check vs S2: cos=0.9857
[S6] BUFFERED delta from S2 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1796) from S3
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.957248)
[S14] loaded HEAD from S3 (vec_in norm=1.957248)
[S14] cosine check vs S3: cos=0.2405
[S14] BUFFERED delta from S3 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1795) from S13
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.111161)
[S10] loaded HEAD from S13 (vec_in norm=1.111161)
[S10] cosine check vs S13: cos=0.9048
[S10] BUFFERED delta from S13 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1794) from S9
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.521948)
[S7] loaded HEAD from S9 (vec_in norm=1.521948)
[S7] cosine check vs S9: cos=0.7523
[S7] BUFFERED delta from S9 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1800) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.679925)
[S2] loaded HEAD from S11 (vec_in norm=1.679925)
[S2] cosine check vs S11: cos=0.9952
[S2] BUFFERED delta from S11 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:39814
[S15] sending update (kind=head size=1801 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1801) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.898728)
[S14] loaded HEAD from S15 (vec_in norm=1.898728)
[S14] cosine check vs S15: cos=0.6649
[S14] BUFFERED delta from S15 (total buffered=2)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:39803
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:39809
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1794 to 1 peers)
[S17] sending update (kind=head size=1803 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1794) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.478744)
[S3] loaded HEAD from S5 (vec_in norm=1.478744)
[S3] cosine check vs S5: cos=-0.1115
[S3] DROPPED delta from S5 (cos=-0.1115 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1803) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=2.070827)
[S8] loaded HEAD from S17 (vec_in norm=2.070827)
[S8] cosine check vs S17: cos=-0.0628
[S8] DROPPED delta from S17 (cos=-0.0628 < 0.0)
[S8] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1801) from S8
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=2.022575)
[S5] loaded HEAD from S8 (vec_in norm=2.022575)
[S5] cosine check vs S8: cos=0.9312
[S5] BUFFERED delta from S8 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1796) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.389275)
[S5] loaded HEAD from S10 (vec_in norm=1.389275)
[S5] cosine check vs S10: cos=0.3515
[S5] BUFFERED delta from S10 (total buffered=2)
[S14] sending update (kind=head size=1800 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1800) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.118280)
[S7] loaded HEAD from S14 (vec_in norm=1.118280)
[S7] cosine check vs S14: cos=0.7053
[S7] BUFFERED delta from S14 (total buffered=2)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=28 metric=0.7162 head_norm=1.701442
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.338931e-02
[S2] stored merged vector for next round verification (round=28)
[S2] DEBUG after merge:  round=28 metric=0.7162 head_norm=1.688660 delta_norm=0.083389
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=28 metric=0.5486 head_norm=1.017109
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.638207e-01
[S7] stored merged vector for next round verification (round=28)
[S7] DEBUG after merge:  round=28 metric=0.5372 head_norm=1.026146 delta_norm=0.263821
[S7] aggregate: ROLLBACK (f1_val pre=0.549 post=0.537 tol_abs=0.005 tol_rel=0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=28 metric=0.7818 head_norm=1.685777
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.431733e-01
[S6] stored merged vector for next round verification (round=28)
[S6] DEBUG after merge:  round=28 metric=0.7888 head_norm=1.687565 delta_norm=0.143173
[S6] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=28 metric=0.7021 head_norm=1.478744
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.181585e-01
[S5] stored merged vector for next round verification (round=28)
[S5] DEBUG after merge:  round=28 metric=0.7021 head_norm=1.342060 delta_norm=0.218159
[S5] aggregate: ACCEPT kept=['S8', 'S10'] (k=2/2) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=28 metric=0.9940 head_norm=1.389275
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.046022e-01
[S10] stored merged vector for next round verification (round=28)
[S10] DEBUG after merge:  round=28 metric=0.9940 head_norm=1.220491 delta_norm=0.304602
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=28 metric=0.9977 head_norm=1.118280
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.397052e-01
[S14] stored merged vector for next round verification (round=28)
[S14] DEBUG after merge:  round=28 metric=0.9977 head_norm=1.122651 delta_norm=0.539705
[S14] aggregate: ACCEPT kept=['S3', 'S15'] (k=2/2) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=1.688660 cos_to_last_merge=1.0000 (last merge round=28)
[S2] round=29 local utility u=0.142653 metrics={'f1_val': 0.7113327254742209, 'auprc': 0.8846697314293391, 'loss_val': 0.4167860754925057, 'psi': 0.7806675278562683}-{'f1_val': 0.7161886289791697, 'auprc': 0.8200999867619081, 'loss_val': 0.5375174257011316, 'psi': 0.757753172092265}
[S3] START round=29 head_norm_before_train=1.957248 (no previous merge yet)
[S3] round=29 local utility u=0.040797 metrics={'f1_val': 0.9904355961860295, 'auprc': 0.9985108949721887, 'loss_val': 0.04907408085102661, 'psi': 0.9936657157004932}-{'f1_val': 0.978685818553173, 'auprc': 0.9985056906989929, 'loss_val': 0.06015368150713544, 'psi': 0.986613767411501}
[S4] START round=29 head_norm_before_train=1.777927 cos_to_last_merge=0.8390 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.839
[S4] round=29 local utility u=0.041431 metrics={'f1_val': 0.9410427862951415, 'auprc': 0.9517714528040799, 'loss_val': 0.29168494563784025, 'psi': 0.9453342528987169}-{'f1_val': 0.9395966352951712, 'auprc': 0.9289582727987707, 'loss_val': 0.2974311662241383, 'psi': 0.9353412902966111}
[S5] START round=29 head_norm_before_train=1.342060 cos_to_last_merge=1.0000 (last merge round=28)
[S5] round=29 local utility u=0.042757 metrics={'f1_val': 0.7020607518057955, 'auprc': 0.9892994628979802, 'loss_val': 0.3295203547887444, 'psi': 0.8169562362426694}-{'f1_val': 0.7020603460463012, 'auprc': 0.9673289404462242, 'loss_val': 0.3491206733719569, 'psi': 0.8081677838062704}
[S6] START round=29 head_norm_before_train=1.687565 cos_to_last_merge=1.0000 (last merge round=28)
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.6096479185189123, 'auprc': 0.8369885857629258, 'loss_val': 0.6762679288296908, 'psi': 0.7005841854165178}-{'f1_val': 0.7818309146365626, 'auprc': 0.9601215519122798, 'loss_val': 0.4776755771059128, 'psi': 0.8531471695468495}
[S7] START round=29 head_norm_before_train=1.026146 cos_to_last_merge=1.0000 (last merge round=28)
[S7] round=29 local utility u=0.793683 metrics={'f1_val': 0.69103314797874, 'auprc': 0.9169676346845825, 'loss_val': 0.4614261093514841, 'psi': 0.781406942661077}-{'f1_val': 0.5485937181065218, 'auprc': 0.7843668973072764, 'loss_val': 0.7963534133549223, 'psi': 0.6429029897868237}
[S8] START round=29 head_norm_before_train=2.022575 (no previous merge yet)
[S8] round=29 local utility u=0.000000 metrics={'f1_val': 0.9924399374978184, 'auprc': 0.9950906790644676, 'loss_val': 0.032370039808220404, 'psi': 0.9935002341244781}-{'f1_val': 0.9926368238932805, 'auprc': 0.9988700151390604, 'loss_val': 0.032161371403270196, 'psi': 0.9951301003915924}
[S9] START round=29 head_norm_before_train=1.521948 cos_to_last_merge=0.7156 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.716
[S9] round=29 local utility u=0.000000 metrics={'f1_val': 0.9947440946163844, 'auprc': 0.9984553778883392, 'loss_val': 0.03740303962483467, 'psi': 0.9962286079251663}-{'f1_val': 0.9958267183641853, 'auprc': 0.9984086913885369, 'loss_val': 0.03921868388556878, 'psi': 0.996859507573926}
[S10] START round=29 head_norm_before_train=1.220491 cos_to_last_merge=1.0000 (last merge round=28)
[S10] round=29 local utility u=0.000000 metrics={'f1_val': 0.9940063275949004, 'auprc': 0.9916669905116979, 'loss_val': 0.11382469232516741, 'psi': 0.9930705927616195}-{'f1_val': 0.9940063275949004, 'auprc': 0.9917056056379661, 'loss_val': 0.07787805260328318, 'psi': 0.9930860388121266}
[S11] START round=29 head_norm_before_train=1.679925 cos_to_last_merge=0.7691 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.769
[S11] round=29 local utility u=0.000000 metrics={'f1_val': 0.9963958538641108, 'auprc': 0.9974366652867138, 'loss_val': 0.03867410161978256, 'psi': 0.9968121784331521}-{'f1_val': 0.9965470045135896, 'auprc': 0.9977841228111892, 'loss_val': 0.03586844281185051, 'psi': 0.9970418518326294}
[S13] START round=29 head_norm_before_train=1.111161 cos_to_last_merge=0.9984 (last merge round=27)
[S13] round=29 local utility u=0.011184 metrics={'f1_val': 0.6035842430044762, 'auprc': 0.6375414456020237, 'loss_val': 0.7599115963158046, 'psi': 0.6171671240434953}-{'f1_val': 0.5960881637085929, 'auprc': 0.6682144177512217, 'loss_val': 0.8293227745691304, 'psi': 0.6249386653256443}
[S14] START round=29 head_norm_before_train=1.122651 cos_to_last_merge=1.0000 (last merge round=28)
[S14] round=29 local utility u=0.000000 metrics={'f1_val': 0.9978938390605482, 'auprc': 0.9986559640215322, 'loss_val': 0.22464061047771708, 'psi': 0.9981986890449418}-{'f1_val': 0.9976511180498535, 'auprc': 0.9986836608808541, 'loss_val': 0.14995344282293366, 'psi': 0.9980641351822538}
[S15] START round=29 head_norm_before_train=1.898728 cos_to_last_merge=0.8045 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.804
[S15] round=29 local utility u=0.000000 metrics={'f1_val': 0.9974605999319422, 'auprc': 0.9990004749176893, 'loss_val': 0.015637957702453405, 'psi': 0.9980765499262412}-{'f1_val': 0.9971773386779533, 'auprc': 0.9992716668354018, 'loss_val': 0.014315218467650773, 'psi': 0.9980150699409327}
[S16] START round=29 head_norm_before_train=1.756481 cos_to_last_merge=0.7653 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.765
[S16] round=29 local utility u=0.000000 metrics={'f1_val': 0.8957888417538528, 'auprc': 0.9932160769588346, 'loss_val': 0.4284894220233855, 'psi': 0.9347597358358455}-{'f1_val': 0.913336515343199, 'auprc': 0.9932253677561071, 'loss_val': 0.3690508395052943, 'psi': 0.9452920563083622}
[S17] START round=29 head_norm_before_train=2.070827 (no previous merge yet)
[S17] round=29 local utility u=0.000000 metrics={'f1_val': 0.671239114706041, 'auprc': 0.8752408695516165, 'loss_val': 0.8870318127087865, 'psi': 0.7528398166442712}-{'f1_val': 0.8668634196170344, 'auprc': 0.9998626047937524, 'loss_val': 0.2907640461782347, 'psi': 0.9200630936877217}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] → sending delta(kind=head bytes=1806) to S7@127.0.0.1:39808
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S3] → sending delta(kind=head bytes=1787) to S5@127.0.0.1:39805
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S2] → sending delta(kind=head bytes=1807) to S11@127.0.0.1:39812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:39807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:39809
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1787 to 1 peers)
[S2] sending update (kind=head size=1807 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1807) from S2
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.723097)
[S11] loaded HEAD from S2 (vec_in norm=1.723097)
[S11] cosine check vs S2: cos=0.9965
[S11] BUFFERED delta from S2 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1798) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.038031)
[S6] loaded HEAD from S7 (vec_in norm=1.038031)
[S6] cosine check vs S7: cos=0.2625
[S6] BUFFERED delta from S7 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1797) from S5
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.361582)
[S8] loaded HEAD from S5 (vec_in norm=1.361582)
[S8] cosine check vs S5: cos=0.8869
[S8] BUFFERED delta from S5 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1787) from S3
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.973530)
[S5] loaded HEAD from S3 (vec_in norm=1.973530)
[S5] cosine check vs S3: cos=-0.1133
[S5] DROPPED delta from S3 (cos=-0.1133 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1806 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1806) from S13
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.159760)
[S7] loaded HEAD from S13 (vec_in norm=1.159760)
[S7] cosine check vs S13: cos=0.9466
[S7] BUFFERED delta from S13 (total buffered=1)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=29 metric=0.9924 head_norm=2.032497
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.186408e-01
[S8] stored merged vector for next round verification (round=29)
[S8] DEBUG after merge:  round=29 metric=0.9924 head_norm=1.650299 delta_norm=0.518641
[S8] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=29 metric=0.6096 head_norm=1.721005
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.805489e-01
[S6] stored merged vector for next round verification (round=29)
[S6] DEBUG after merge:  round=29 metric=0.6248 head_norm=1.115489 delta_norm=0.880549
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=29 metric=0.6910 head_norm=1.038031
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.892857e-01
[S7] stored merged vector for next round verification (round=29)
[S7] DEBUG after merge:  round=29 metric=0.6903 head_norm=1.084180 delta_norm=0.189286
[S7] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=29 metric=0.9964 head_norm=1.698330
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.308514e-02
[S11] stored merged vector for next round verification (round=29)
[S11] DEBUG after merge:  round=29 metric=0.9964 head_norm=1.709196 delta_norm=0.073085
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=1.723097 cos_to_last_merge=0.9994 (last merge round=28)
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.69680511602219, 'auprc': 0.8522546502321986, 'loss_val': 0.4328790647771781, 'psi': 0.7589849297061935}-{'f1_val': 0.7113327254742209, 'auprc': 0.8846697314293391, 'loss_val': 0.4167860754925057, 'psi': 0.7806675278562683}
[S3] START round=30 head_norm_before_train=1.973530 (no previous merge yet)
[S3] round=30 local utility u=0.000000 metrics={'f1_val': 0.9602580484078469, 'auprc': 0.9986841458897594, 'loss_val': 0.11579078616896565, 'psi': 0.9756284874006119}-{'f1_val': 0.9904355961860295, 'auprc': 0.9985108949721887, 'loss_val': 0.04907408085102661, 'psi': 0.9936657157004932}
[S4] START round=30 head_norm_before_train=1.791415 cos_to_last_merge=0.8374 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.837
[S4] round=30 local utility u=0.072252 metrics={'f1_val': 0.9477570613650255, 'auprc': 0.9801402148695378, 'loss_val': 0.2725736455707546, 'psi': 0.9607103227668304}-{'f1_val': 0.9410427862951415, 'auprc': 0.9517714528040799, 'loss_val': 0.29168494563784025, 'psi': 0.9453342528987169}
[S5] START round=30 head_norm_before_train=1.361582 cos_to_last_merge=0.9997 (last merge round=28)
[S5] round=30 local utility u=0.000000 metrics={'f1_val': 0.7001378716009663, 'auprc': 0.8689425123773212, 'loss_val': 0.4501932168142466, 'psi': 0.7676597279115083}-{'f1_val': 0.7020607518057955, 'auprc': 0.9892994628979802, 'loss_val': 0.3295203547887444, 'psi': 0.8169562362426694}
[S6] START round=30 head_norm_before_train=1.115489 cos_to_last_merge=1.0000 (last merge round=29)
[S6] round=30 local utility u=1.000000 metrics={'f1_val': 0.8582567322830806, 'auprc': 0.9499671822676913, 'loss_val': 0.4503717014558041, 'psi': 0.894940912276925}-{'f1_val': 0.6096479185189123, 'auprc': 0.8369885857629258, 'loss_val': 0.6762679288296908, 'psi': 0.7005841854165178}
[S7] START round=30 head_norm_before_train=1.084180 cos_to_last_merge=1.0000 (last merge round=29)
[S7] round=30 local utility u=0.000000 metrics={'f1_val': 0.5492525969412856, 'auprc': 0.7818314878063192, 'loss_val': 0.7747047289120785, 'psi': 0.642284153287299}-{'f1_val': 0.69103314797874, 'auprc': 0.9169676346845825, 'loss_val': 0.4614261093514841, 'psi': 0.781406942661077}
[S8] START round=30 head_norm_before_train=1.650299 cos_to_last_merge=1.0000 (last merge round=29)
[S8] round=30 local utility u=0.000620 metrics={'f1_val': 0.9926368238932805, 'auprc': 0.9989483535815766, 'loss_val': 0.04388406782090302, 'psi': 0.995161435768599}-{'f1_val': 0.9924399374978184, 'auprc': 0.9950906790644676, 'loss_val': 0.032370039808220404, 'psi': 0.9935002341244781}
[S9] START round=30 head_norm_before_train=1.543284 cos_to_last_merge=0.7118 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.712
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.9934918488430377, 'auprc': 0.9984667118205242, 'loss_val': 0.03634081925552976, 'psi': 0.9954817940340323}-{'f1_val': 0.9947440946163844, 'auprc': 0.9984553778883392, 'loss_val': 0.03740303962483467, 'psi': 0.9962286079251663}
[S10] START round=30 head_norm_before_train=1.298406 cos_to_last_merge=0.9966 (last merge round=28)
[S10] round=30 local utility u=0.020369 metrics={'f1_val': 0.9940063275949004, 'auprc': 0.9926207452680043, 'loss_val': 0.07594696825345311, 'psi': 0.9934520946641419}-{'f1_val': 0.9940063275949004, 'auprc': 0.9916669905116979, 'loss_val': 0.11382469232516741, 'psi': 0.9930705927616195}
[S11] START round=30 head_norm_before_train=1.709196 cos_to_last_merge=1.0000 (last merge round=29)
[S11] round=30 local utility u=0.004760 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.997898739599019, 'loss_val': 0.03144675602246701, 'psi': 0.9970876985477614}-{'f1_val': 0.9963958538641108, 'auprc': 0.9974366652867138, 'loss_val': 0.03867410161978256, 'psi': 0.9968121784331521}
[S13] START round=30 head_norm_before_train=1.159760 cos_to_last_merge=0.9939 (last merge round=27)
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.48594849880965824, 'auprc': 0.6686092691737365, 'loss_val': 0.9061280233628322, 'psi': 0.5590128069552895}-{'f1_val': 0.6035842430044762, 'auprc': 0.6375414456020237, 'loss_val': 0.7599115963158046, 'psi': 0.6171671240434953}
[S14] START round=30 head_norm_before_train=1.165299 cos_to_last_merge=0.9983 (last merge round=28)
[S14] round=30 local utility u=0.016862 metrics={'f1_val': 0.9957445751558393, 'auprc': 0.9985734198206491, 'loss_val': 0.1777737371912138, 'psi': 0.9968761130217632}-{'f1_val': 0.9978938390605482, 'auprc': 0.9986559640215322, 'loss_val': 0.22464061047771708, 'psi': 0.9981986890449418}
[S15] START round=30 head_norm_before_train=1.911062 cos_to_last_merge=0.8035 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.803
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.9977564388490278, 'auprc': 0.9989436223504694, 'loss_val': 0.020201219337953193, 'psi': 0.9982313122496044}-{'f1_val': 0.9974605999319422, 'auprc': 0.9990004749176893, 'loss_val': 0.015637957702453405, 'psi': 0.9980765499262412}
[S16] START round=30 head_norm_before_train=1.774264 cos_to_last_merge=0.7639 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.764
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.8623758284541235, 'auprc': 0.9929334965707679, 'loss_val': 0.6127173350115488, 'psi': 0.9145988957007813}-{'f1_val': 0.8957888417538528, 'auprc': 0.9932160769588346, 'loss_val': 0.4284894220233855, 'psi': 0.9347597358358455}
[S17] START round=30 head_norm_before_train=2.078872 (no previous merge yet)
[S17] round=30 local utility u=0.000000 metrics={'f1_val': 0.6244074830975974, 'auprc': 0.850508279245346, 'loss_val': 1.2621244086165377, 'psi': 0.7148478015566968}-{'f1_val': 0.671239114706041, 'auprc': 0.8752408695516165, 'loss_val': 0.8870318127087865, 'psi': 0.7528398166442712}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:39802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:39815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:39813
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:39817
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1800) from S6
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.175981)
[S2] loaded HEAD from S6 (vec_in norm=1.175981)
[S2] cosine check vs S6: cos=0.8672
[S2] BUFFERED delta from S6 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1799) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.679312)
[S17] loaded HEAD from S8 (vec_in norm=1.679312)
[S17] cosine check vs S8: cos=-0.0667
[S17] DROPPED delta from S8 (cos=-0.0667 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1801) from S10
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.383085)
[S13] loaded HEAD from S10 (vec_in norm=1.383085)
[S13] cosine check vs S10: cos=0.9254
[S13] BUFFERED delta from S10 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1796) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.210860)
[S15] loaded HEAD from S14 (vec_in norm=1.210860)
[S15] cosine check vs S14: cos=0.7522
[S15] BUFFERED delta from S14 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=30 metric=0.4859 head_norm=1.189503
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.659500e-01
[S13] stored merged vector for next round verification (round=30)
[S13] DEBUG after merge:  round=30 metric=0.5084 head_norm=1.262217 delta_norm=0.265950
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.026 → S7@127.0.0.1:39808
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=30 metric=0.6968 head_norm=1.755284
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.700741e-01
[S2] stored merged vector for next round verification (round=30)
[S2] DEBUG after merge:  round=30 metric=0.6968 head_norm=1.418100 delta_norm=0.470074
[S2] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.067 → S11@127.0.0.1:39812
[S5] ⇄ pheromone p=0.140 → S8@127.0.0.1:39809
[S7] ⇄ pheromone p=0.314 → S6@127.0.0.1:39807
[S6] ⇄ pheromone p=0.368 → S2@127.0.0.1:39802
[S8] ⇄ pheromone p=0.030 → S17@127.0.0.1:39817
[S10] ⇄ pheromone p=0.016 → S13@127.0.0.1:39813
[S3] ⇄ pheromone p=0.094 → S5@127.0.0.1:39805
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=30 metric=0.9978 head_norm=1.923393
[S15] _apply_head_vector_avg (torch): Δ‖w‖=6.445841e-01
[S15] stored merged vector for next round verification (round=30)
[S15] DEBUG after merge:  round=30 metric=0.9978 head_norm=1.472183 delta_norm=0.644584
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.034 → S15@127.0.0.1:39815
[S17] ⇄ pheromone p=0.263 → S8@127.0.0.1:39809
[S2] START round=31 head_norm_before_train=1.418100 cos_to_last_merge=1.0000 (last merge round=30)
[S2] round=31 local utility u=0.000000 metrics={'f1_val': 0.7183167296785669, 'auprc': 0.8055721417003378, 'loss_val': 0.5629677452176242, 'psi': 0.7532188944872753}-{'f1_val': 0.69680511602219, 'auprc': 0.8522546502321986, 'loss_val': 0.4328790647771781, 'psi': 0.7589849297061935}
[S3] START round=31 head_norm_before_train=1.989998 (no previous merge yet)
[S3] round=31 local utility u=0.000000 metrics={'f1_val': 0.8564603751380515, 'auprc': 0.9986875602719731, 'loss_val': 0.26863674479760513, 'psi': 0.9133512491916203}-{'f1_val': 0.9602580484078469, 'auprc': 0.9986841458897594, 'loss_val': 0.11579078616896565, 'psi': 0.9756284874006119}
[S4] START round=31 head_norm_before_train=1.799528 cos_to_last_merge=0.8371 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.837
[S4] round=31 local utility u=0.019818 metrics={'f1_val': 0.955527443423559, 'auprc': 0.9765347097425519, 'loss_val': 0.2687442009500646, 'psi': 0.9639303499511561}-{'f1_val': 0.9477570613650255, 'auprc': 0.9801402148695378, 'loss_val': 0.2725736455707546, 'psi': 0.9607103227668304}
[S5] START round=31 head_norm_before_train=1.387684 cos_to_last_merge=0.9985 (last merge round=28)
[S5] round=31 local utility u=0.513636 metrics={'f1_val': 0.7714999366558347, 'auprc': 0.9923344898562961, 'loss_val': 0.22126875556007602, 'psi': 0.8598337579360193}-{'f1_val': 0.7001378716009663, 'auprc': 0.8689425123773212, 'loss_val': 0.4501932168142466, 'psi': 0.7676597279115083}
[S6] START round=31 head_norm_before_train=1.175981 cos_to_last_merge=0.9971 (last merge round=29)
[S6] round=31 local utility u=0.464799 metrics={'f1_val': 0.9618800650456727, 'auprc': 0.9739635415298075, 'loss_val': 0.21450271561751105, 'psi': 0.9667134556393266}-{'f1_val': 0.8582567322830806, 'auprc': 0.9499671822676913, 'loss_val': 0.4503717014558041, 'psi': 0.894940912276925}
[S7] START round=31 head_norm_before_train=1.095592 cos_to_last_merge=0.9999 (last merge round=29)
[S7] round=31 local utility u=0.329181 metrics={'f1_val': 0.6248438162510074, 'auprc': 0.7983113206834986, 'loss_val': 0.6193304400615083, 'psi': 0.6942308180240039}-{'f1_val': 0.5492525969412856, 'auprc': 0.7818314878063192, 'loss_val': 0.7747047289120785, 'psi': 0.642284153287299}
[S8] START round=31 head_norm_before_train=1.679312 cos_to_last_merge=0.9999 (last merge round=29)
[S8] round=31 local utility u=0.000022 metrics={'f1_val': 0.9922724065265219, 'auprc': 0.998790389811337, 'loss_val': 0.04117956558803671, 'psi': 0.9948795998404479}-{'f1_val': 0.9926368238932805, 'auprc': 0.9989483535815766, 'loss_val': 0.04388406782090302, 'psi': 0.995161435768599}
[S9] START round=31 head_norm_before_train=1.563023 cos_to_last_merge=0.7086 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.709
[S9] round=31 local utility u=0.005954 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9952244304582205, 'loss_val': 0.03371705236850885, 'psi': 0.9960860792716231}-{'f1_val': 0.9934918488430377, 'auprc': 0.9984667118205242, 'loss_val': 0.03634081925552976, 'psi': 0.9954817940340323}
[S10] START round=31 head_norm_before_train=1.383085 cos_to_last_merge=0.9883 (last merge round=28)
[S10] round=31 local utility u=0.010454 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9949799908757477, 'loss_val': 0.059487598434565025, 'psi': 0.9941327901694558}-{'f1_val': 0.9940063275949004, 'auprc': 0.9926207452680043, 'loss_val': 0.07594696825345311, 'psi': 0.9934520946641419}
[S11] START round=31 head_norm_before_train=1.727736 cos_to_last_merge=1.0000 (last merge round=29)
[S11] round=31 local utility u=0.000865 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.997776049596571, 'loss_val': 0.029349575148573066, 'psi': 0.9970386225467821}-{'f1_val': 0.9965470045135896, 'auprc': 0.997898739599019, 'loss_val': 0.03144675602246701, 'psi': 0.9970876985477614}
[S13] START round=31 head_norm_before_train=1.262217 cos_to_last_merge=1.0000 (last merge round=30)
[S13] round=31 local utility u=0.192987 metrics={'f1_val': 0.5662200992096916, 'auprc': 0.6239346893049278, 'loss_val': 0.8677601208403112, 'psi': 0.5893059352477861}-{'f1_val': 0.48594849880965824, 'auprc': 0.6686092691737365, 'loss_val': 0.9061280233628322, 'psi': 0.5590128069552895}
[S14] START round=31 head_norm_before_train=1.210860 cos_to_last_merge=0.9939 (last merge round=28)
[S14] round=31 local utility u=0.026071 metrics={'f1_val': 0.9970407855713329, 'auprc': 0.998607551544618, 'loss_val': 0.13351054336831836, 'psi': 0.997667491960647}-{'f1_val': 0.9957445751558393, 'auprc': 0.9985734198206491, 'loss_val': 0.1777737371912138, 'psi': 0.9968761130217632}
[S15] START round=31 head_norm_before_train=1.472183 cos_to_last_merge=1.0000 (last merge round=30)
[S15] round=31 local utility u=0.000000 metrics={'f1_val': 0.9794743042872577, 'auprc': 0.9990796877768431, 'loss_val': 0.05574626007676135, 'psi': 0.9873164576830918}-{'f1_val': 0.9977564388490278, 'auprc': 0.9989436223504694, 'loss_val': 0.020201219337953193, 'psi': 0.9982313122496044}
[S16] START round=31 head_norm_before_train=1.787919 cos_to_last_merge=0.7627 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.763
[S16] round=31 local utility u=0.000000 metrics={'f1_val': 0.8517671431526516, 'auprc': 0.9840516071296205, 'loss_val': 0.7561501270986299, 'psi': 0.9046809287434392}-{'f1_val': 0.8623758284541235, 'auprc': 0.9929334965707679, 'loss_val': 0.6127173350115488, 'psi': 0.9145988957007813}
[S17] START round=31 head_norm_before_train=2.092871 (no previous merge yet)
[S17] round=31 local utility u=0.974493 metrics={'f1_val': 0.7642490944646618, 'auprc': 0.99659349625002, 'loss_val': 0.5904438835678097, 'psi': 0.8571868551788051}-{'f1_val': 0.6244074830975974, 'auprc': 0.850508279245346, 'loss_val': 1.2621244086165377, 'psi': 0.7148478015566968}
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S8
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S9
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S16
[S15]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:39817
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S13@127.0.0.1:39813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:39809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:39803
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:39815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:39807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:39802
[S14] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1805 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S17] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1802) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.106648)
[S6] loaded HEAD from S7 (vec_in norm=1.106648)
[S6] cosine check vs S7: cos=0.7028
[S6] BUFFERED delta from S7 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1803) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.408760)
[S3] loaded HEAD from S5 (vec_in norm=1.408760)
[S3] cosine check vs S5: cos=-0.1175
[S3] DROPPED delta from S5 (cos=-0.1175 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1805) from S10
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.450889)
[S13] loaded HEAD from S10 (vec_in norm=1.450889)
[S13] cosine check vs S10: cos=0.9742
[S13] BUFFERED delta from S10 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1795) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.254009)
[S15] loaded HEAD from S14 (vec_in norm=1.254009)
[S15] cosine check vs S14: cos=0.8973
[S15] BUFFERED delta from S14 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1799) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.715146)
[S17] loaded HEAD from S8 (vec_in norm=1.715146)
[S17] cosine check vs S8: cos=-0.0662
[S17] DROPPED delta from S8 (cos=-0.0662 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1797) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.745035)
[S2] loaded HEAD from S11 (vec_in norm=1.745035)
[S2] cosine check vs S11: cos=0.9704
[S2] BUFFERED delta from S11 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1799) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=2.102869)
[S8] loaded HEAD from S17 (vec_in norm=2.102869)
[S8] cosine check vs S17: cos=-0.0662
[S8] DROPPED delta from S17 (cos=-0.0662 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1803) from S13
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.286126)
[S7] loaded HEAD from S13 (vec_in norm=1.286126)
[S7] cosine check vs S13: cos=0.9621
[S7] BUFFERED delta from S13 (total buffered=1)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=31 metric=0.5662 head_norm=1.286126
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.756442e-01
[S13] stored merged vector for next round verification (round=31)
[S13] DEBUG after merge:  round=31 metric=0.5647 head_norm=1.359687 delta_norm=0.175644
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=31 metric=0.7183 head_norm=1.458776
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.410389e-01
[S2] stored merged vector for next round verification (round=31)
[S2] DEBUG after merge:  round=31 metric=0.7190 head_norm=1.590122 delta_norm=0.241039
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1797) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.261105)
[S7] loaded HEAD from S6 (vec_in norm=1.261105)
[S7] cosine check vs S6: cos=0.7028
[S7] BUFFERED delta from S6 (total buffered=2)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=31 metric=0.9619 head_norm=1.261105
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.619234e-01
[S6] stored merged vector for next round verification (round=31)
[S6] DEBUG after merge:  round=31 metric=0.9618 head_norm=1.092774 delta_norm=0.461923
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] CommDone barrier timeout: have=2 need=3 — continuing
[S7] CommDone barrier timeout: have=2 need=3 — continuing
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=31 metric=0.6248 head_norm=1.106648
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.560968e-01
[S7] stored merged vector for next round verification (round=31)
[S7] DEBUG after merge:  round=31 metric=0.6325 head_norm=1.113830 delta_norm=0.256097
[S7] aggregate: ACCEPT kept=['S13', 'S6'] (k=2/2) mode=median trim_p=0.1
[S2] START round=32 head_norm_before_train=1.590122 cos_to_last_merge=1.0000 (last merge round=31)
[S2] round=32 local utility u=0.058416 metrics={'f1_val': 0.713201982060316, 'auprc': 0.8324580197447731, 'loss_val': 0.49610570841640234, 'psi': 0.7609043971340989}-{'f1_val': 0.7183167296785669, 'auprc': 0.8055721417003378, 'loss_val': 0.5629677452176242, 'psi': 0.7532188944872753}
[S3] START round=32 head_norm_before_train=2.006482 (no previous merge yet)
[S3] round=32 local utility u=0.178893 metrics={'f1_val': 0.9018236963731836, 'auprc': 0.9985114802999111, 'loss_val': 0.18250296042880776, 'psi': 0.9404988099438746}-{'f1_val': 0.8564603751380515, 'auprc': 0.9986875602719731, 'loss_val': 0.26863674479760513, 'psi': 0.9133512491916203}
[S4] START round=32 head_norm_before_train=1.801890 cos_to_last_merge=0.8371 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.837
[S4] round=32 local utility u=0.000000 metrics={'f1_val': 0.9520503570427413, 'auprc': 0.9571670770000987, 'loss_val': 0.2679754665229838, 'psi': 0.9540970450256843}-{'f1_val': 0.955527443423559, 'auprc': 0.9765347097425519, 'loss_val': 0.2687442009500646, 'psi': 0.9639303499511561}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=32 head_norm_before_train=1.408760 cos_to_last_merge=0.9971 (last merge round=28)
[S5] round=32 local utility u=0.000000 metrics={'f1_val': 0.7010292018116783, 'auprc': 0.9785435894131083, 'loss_val': 0.32015180641576635, 'psi': 0.8120349568522502}-{'f1_val': 0.7714999366558347, 'auprc': 0.9923344898562961, 'loss_val': 0.22126875556007602, 'psi': 0.8598337579360193}
[S6] START round=32 head_norm_before_train=1.092774 cos_to_last_merge=1.0000 (last merge round=31)
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.5970691808858134, 'auprc': 0.8018289865258053, 'loss_val': 0.7070810024160302, 'psi': 0.6789731031418101}-{'f1_val': 0.9618800650456727, 'auprc': 0.9739635415298075, 'loss_val': 0.21450271561751105, 'psi': 0.9667134556393266}
[S7] START round=32 head_norm_before_train=1.113830 cos_to_last_merge=1.0000 (last merge round=31)
[S7] round=32 local utility u=0.312314 metrics={'f1_val': 0.6793662303639798, 'auprc': 0.8413392023883365, 'loss_val': 0.45092028944999407, 'psi': 0.7441554191737225}-{'f1_val': 0.6248438162510074, 'auprc': 0.7983113206834986, 'loss_val': 0.6193304400615083, 'psi': 0.6942308180240039}
[S8] START round=32 head_norm_before_train=1.715146 cos_to_last_merge=0.9997 (last merge round=29)
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.9897367044659179, 'auprc': 0.9988016763395321, 'loss_val': 0.04134423253670211, 'psi': 0.9933626932153635}-{'f1_val': 0.9922724065265219, 'auprc': 0.998790389811337, 'loss_val': 0.04117956558803671, 'psi': 0.9948795998404479}
[S9] START round=32 head_norm_before_train=1.577198 cos_to_last_merge=0.7067 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.707
[S9] round=32 local utility u=0.000000 metrics={'f1_val': 0.9590455094646616, 'auprc': 0.9791103058319619, 'loss_val': 0.11309432655048164, 'psi': 0.9670714280115817}-{'f1_val': 0.9966605118138915, 'auprc': 0.9952244304582205, 'loss_val': 0.03371705236850885, 'psi': 0.9960860792716231}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=32 head_norm_before_train=1.450889 cos_to_last_merge=0.9806 (last merge round=28)
[S10] round=32 local utility u=0.004279 metrics={'f1_val': 0.9940063275949004, 'auprc': 0.9938684588816085, 'loss_val': 0.05022475511845078, 'psi': 0.9939511801095836}-{'f1_val': 0.9935679896985945, 'auprc': 0.9949799908757477, 'loss_val': 0.059487598434565025, 'psi': 0.9941327901694558}
[S11] START round=32 head_norm_before_train=1.745035 cos_to_last_merge=0.9998 (last merge round=29)
[S11] round=32 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9972309146810049, 'loss_val': 0.03932080143374319, 'psi': 0.9965848507188492}-{'f1_val': 0.9965470045135896, 'auprc': 0.997776049596571, 'loss_val': 0.029349575148573066, 'psi': 0.9970386225467821}
[S13] START round=32 head_norm_before_train=1.359687 cos_to_last_merge=1.0000 (last merge round=31)
[S13] round=32 local utility u=0.142424 metrics={'f1_val': 0.6062263287755805, 'auprc': 0.6274276635514753, 'loss_val': 0.8334292224989169, 'psi': 0.6147068626859384}-{'f1_val': 0.5662200992096916, 'auprc': 0.6239346893049278, 'loss_val': 0.8677601208403112, 'psi': 0.5893059352477861}
[S14] START round=32 head_norm_before_train=1.254009 cos_to_last_merge=0.9885 (last merge round=28)
[S14] round=32 local utility u=0.007338 metrics={'f1_val': 0.9962732611389397, 'auprc': 0.9984320000546109, 'loss_val': 0.11370321946234234, 'psi': 0.9971367567052082}-{'f1_val': 0.9970407855713329, 'auprc': 0.998607551544618, 'loss_val': 0.13351054336831836, 'psi': 0.997667491960647}
[S15] START round=32 head_norm_before_train=1.503749 cos_to_last_merge=0.9999 (last merge round=30)
[S15] round=32 local utility u=0.000000 metrics={'f1_val': 0.9447487574463058, 'auprc': 0.9988611469336872, 'loss_val': 0.08541988147956094, 'psi': 0.9663937132412583}-{'f1_val': 0.9794743042872577, 'auprc': 0.9990796877768431, 'loss_val': 0.05574626007676135, 'psi': 0.9873164576830918}
[S16] START round=32 head_norm_before_train=1.800632 cos_to_last_merge=0.7616 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.762
[S16] round=32 local utility u=0.739668 metrics={'f1_val': 0.9833512763383125, 'auprc': 0.9912046521896173, 'loss_val': 0.08777743876186235, 'psi': 0.9864926266788344}-{'f1_val': 0.8517671431526516, 'auprc': 0.9840516071296205, 'loss_val': 0.7561501270986299, 'psi': 0.9046809287434392}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=32 head_norm_before_train=2.102869 (no previous merge yet)
[S17] round=32 local utility u=0.000000 metrics={'f1_val': 0.6191332518987818, 'auprc': 0.8585694453767257, 'loss_val': 1.2547185292692404, 'psi': 0.7149077292899594}-{'f1_val': 0.7642490944646618, 'auprc': 0.99659349625002, 'loss_val': 0.5904438835678097, 'psi': 0.8571868551788051}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S3] → sending delta(kind=head bytes=1790) to S5@127.0.0.1:39805
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:39813
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:39808
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1790 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=32 metric=0.9447 head_norm=1.550298
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.556812e-01
[S15] stored merged vector for next round verification (round=32)
[S15] DEBUG after merge:  round=32 metric=0.9452 head_norm=1.364358 delta_norm=0.355681
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:39807
[S13] RECEIVED delta(kind=head bytes=1802) from S10
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.502136)
[S13] loaded HEAD from S10 (vec_in norm=1.502136)
[S13] cosine check vs S10: cos=0.9895
[S13] BUFFERED delta from S10 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1790) from S3
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=2.021348)
[S5] loaded HEAD from S3 (vec_in norm=2.021348)
[S5] cosine check vs S3: cos=-0.1188
[S5] DROPPED delta from S3 (cos=-0.1188 < 0.0)
[S2] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] RECEIVED delta(kind=head bytes=1796) from S2
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.629053)
[S6] loaded HEAD from S2 (vec_in norm=1.629053)
[S6] cosine check vs S2: cos=0.7244
[S6] BUFFERED delta from S2 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1801) from S13
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.384052)
[S7] loaded HEAD from S13 (vec_in norm=1.384052)
[S7] cosine check vs S13: cos=0.9445
[S7] BUFFERED delta from S13 (total buffered=1)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=32 metric=0.6062 head_norm=1.384052
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.201503e-01
[S13] stored merged vector for next round verification (round=32)
[S13] DEBUG after merge:  round=32 metric=0.5934 head_norm=1.439295 delta_norm=0.120150
[S13] aggregate: ROLLBACK (f1_val pre=0.606 post=0.593 tol_abs=0.005 tol_rel=0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=32 metric=0.5971 head_norm=1.158483
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.616017e-01
[S6] stored merged vector for next round verification (round=32)
[S6] DEBUG after merge:  round=32 metric=0.5954 head_norm=1.297132 delta_norm=0.561602
[S6] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2]  timeout peer S11
[S5]  timeout peer S8
[S5]  timeout peer S10
[S3]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S9
[S7]  timeout peer S14
[S10]  timeout peer S13
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S15
[S14]  timeout peer S16
[S6]  timeout peer S2
[S13]  timeout peer S7
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:39813
[S7] sending update (kind=head size=1798 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1798) from S7
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.129500)
[S13] loaded HEAD from S7 (vec_in norm=1.129500)
[S13] cosine check vs S7: cos=0.9259
[S13] BUFFERED delta from S7 (total buffered=1)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=32 metric=0.6794 head_norm=1.129500
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.441227e-01
[S7] stored merged vector for next round verification (round=32)
[S7] DEBUG after merge:  round=32 metric=0.6743 head_norm=1.239391 delta_norm=0.244123
[S7] aggregate: ROLLBACK (f1_val pre=0.679 post=0.674 tol_abs=0.005 tol_rel=0.0)
[S2] START round=33 head_norm_before_train=1.629053 cos_to_last_merge=0.9996 (last merge round=31)
[S2] round=33 local utility u=0.112434 metrics={'f1_val': 0.7331399722153116, 'auprc': 0.8427526306568688, 'loss_val': 0.42175025296327245, 'psi': 0.7769850355919345}-{'f1_val': 0.713201982060316, 'auprc': 0.8324580197447731, 'loss_val': 0.49610570841640234, 'psi': 0.7609043971340989}
[S3] START round=33 head_norm_before_train=2.021348 (no previous merge yet)
[S3] round=33 local utility u=0.158894 metrics={'f1_val': 0.9470038283884862, 'auprc': 0.9984992962582366, 'loss_val': 0.135758683178649, 'psi': 0.9676020155363864}-{'f1_val': 0.9018236963731836, 'auprc': 0.9985114802999111, 'loss_val': 0.18250296042880776, 'psi': 0.9404988099438746}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S3] sending update (kind=head size=1790 to 1 peers)
[S4] START round=33 head_norm_before_train=1.805506 cos_to_last_merge=0.8370 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.837
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.9461308245376732, 'auprc': 0.9571906913860477, 'loss_val': 0.2817598889205744, 'psi': 0.950554771277023}-{'f1_val': 0.9520503570427413, 'auprc': 0.9571670770000987, 'loss_val': 0.2679754665229838, 'psi': 0.9540970450256843}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=33 head_norm_before_train=1.426378 cos_to_last_merge=0.9958 (last merge round=28)
[S5] round=33 local utility u=0.044997 metrics={'f1_val': 0.7020603460463012, 'auprc': 0.9903619058213247, 'loss_val': 0.271799436614025, 'psi': 0.8173809699563106}-{'f1_val': 0.7010292018116783, 'auprc': 0.9785435894131083, 'loss_val': 0.32015180641576635, 'psi': 0.8120349568522502}
[S6] START round=33 head_norm_before_train=1.297132 cos_to_last_merge=1.0000 (last merge round=32)
[S6] round=33 local utility u=1.000000 metrics={'f1_val': 0.9075749606602495, 'auprc': 0.9738325375384536, 'loss_val': 0.27387332567895406, 'psi': 0.9340779914115311}-{'f1_val': 0.5970691808858134, 'auprc': 0.8018289865258053, 'loss_val': 0.7070810024160302, 'psi': 0.6789731031418101}
[S7] START round=33 head_norm_before_train=1.239391 cos_to_last_merge=1.0000 (last merge round=32)
[S7] round=33 local utility u=0.000000 metrics={'f1_val': 0.5771120083840926, 'auprc': 0.7851458949411738, 'loss_val': 0.7153291020249938, 'psi': 0.6603255630069251}-{'f1_val': 0.6793662303639798, 'auprc': 0.8413392023883365, 'loss_val': 0.45092028944999407, 'psi': 0.7441554191737225}
[S8] START round=33 head_norm_before_train=1.750108 cos_to_last_merge=0.9993 (last merge round=29)
[S8] round=33 local utility u=0.000000 metrics={'f1_val': 0.9865324998004762, 'auprc': 0.9988574771990617, 'loss_val': 0.04692196758299295, 'psi': 0.9914624907599103}-{'f1_val': 0.9897367044659179, 'auprc': 0.9988016763395321, 'loss_val': 0.04134423253670211, 'psi': 0.9933626932153635}
[S9] START round=33 head_norm_before_train=1.591308 cos_to_last_merge=0.7049 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.705
[S9] round=33 local utility u=0.171076 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9927942484739098, 'loss_val': 0.03522074869562364, 'psi': 0.9948677562571305}-{'f1_val': 0.9590455094646616, 'auprc': 0.9791103058319619, 'loss_val': 0.11309432655048164, 'psi': 0.9670714280115817}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=33 head_norm_before_train=1.502136 cos_to_last_merge=0.9745 (last merge round=28)
[S10] round=33 local utility u=0.000000 metrics={'f1_val': 0.9948838907637279, 'auprc': 0.9916701500630098, 'loss_val': 0.049357011005137244, 'psi': 0.9935983944834407}-{'f1_val': 0.9940063275949004, 'auprc': 0.9938684588816085, 'loss_val': 0.05022475511845078, 'psi': 0.9939511801095836}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=33 head_norm_before_train=1.758871 cos_to_last_merge=0.9997 (last merge round=29)
[S11] round=33 local utility u=0.005414 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9976243402338587, 'loss_val': 0.02967270893800373, 'psi': 0.9967422209399908}-{'f1_val': 0.9961541414107454, 'auprc': 0.9972309146810049, 'loss_val': 0.03932080143374319, 'psi': 0.9965848507188492}
[S13] START round=33 head_norm_before_train=1.439295 cos_to_last_merge=1.0000 (last merge round=32)
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.5745673361492393, 'auprc': 0.5608435956743991, 'loss_val': 1.043795608415679, 'psi': 0.5690778399593033}-{'f1_val': 0.6062263287755805, 'auprc': 0.6274276635514753, 'loss_val': 0.8334292224989169, 'psi': 0.6147068626859384}
[S14] START round=33 head_norm_before_train=1.290570 cos_to_last_merge=0.9834 (last merge round=28)
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.9959778002902165, 'auprc': 0.9958690336564008, 'loss_val': 0.11281176854925173, 'psi': 0.9959342936366902}-{'f1_val': 0.9962732611389397, 'auprc': 0.9984320000546109, 'loss_val': 0.11370321946234234, 'psi': 0.9971367567052082}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=33 head_norm_before_train=1.364358 cos_to_last_merge=1.0000 (last merge round=32)
[S15] round=33 local utility u=0.182030 metrics={'f1_val': 0.9971773386779533, 'auprc': 0.9997083806883221, 'loss_val': 0.038473067684157806, 'psi': 0.9981897554821009}-{'f1_val': 0.9447487574463058, 'auprc': 0.9988611469336872, 'loss_val': 0.08541988147956094, 'psi': 0.9663937132412583}
[S16] START round=33 head_norm_before_train=1.811697 cos_to_last_merge=0.7607 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.761
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.8770154696556128, 'auprc': 0.9925652079650819, 'loss_val': 0.293942261085753, 'psi': 0.9232353649794005}-{'f1_val': 0.9833512763383125, 'auprc': 0.9912046521896173, 'loss_val': 0.08777743876186235, 'psi': 0.9864926266788344}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=33 head_norm_before_train=2.117322 (no previous merge yet)
[S17] round=33 local utility u=0.773017 metrics={'f1_val': 0.775396111291476, 'auprc': 0.8646384355229437, 'loss_val': 0.6644694942044281, 'psi': 0.8110930409840631}-{'f1_val': 0.6191332518987818, 'auprc': 0.8585694453767257, 'loss_val': 1.2547185292692404, 'psi': 0.7149077292899594}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:39809
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:39808
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:39803
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:39807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:39802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:39814
[S17] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=33 metric=0.5746 head_norm=1.455331
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.957855e-01
[S13] stored merged vector for next round verification (round=33)
[S13] DEBUG after merge:  round=33 metric=0.5773 head_norm=1.268618 delta_norm=0.295785
[S13] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S7] RECEIVED delta(kind=head bytes=1802) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.354019)
[S7] loaded HEAD from S6 (vec_in norm=1.354019)
[S7] cosine check vs S6: cos=0.7133
[S7] BUFFERED delta from S6 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1797) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.447280)
[S3] loaded HEAD from S5 (vec_in norm=1.447280)
[S3] cosine check vs S5: cos=-0.1192
[S3] DROPPED delta from S5 (cos=-0.1192 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1799) from S2
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.663724)
[S6] loaded HEAD from S2 (vec_in norm=1.663724)
[S6] cosine check vs S2: cos=0.9470
[S6] BUFFERED delta from S2 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1797) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.431780)
[S14] loaded HEAD from S15 (vec_in norm=1.431780)
[S14] cosine check vs S15: cos=0.9549
[S14] BUFFERED delta from S15 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1795) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=2.132281)
[S8] loaded HEAD from S17 (vec_in norm=2.132281)
[S8] cosine check vs S17: cos=-0.0661
[S8] DROPPED delta from S17 (cos=-0.0661 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1799) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.773127)
[S2] loaded HEAD from S11 (vec_in norm=1.773127)
[S2] cosine check vs S11: cos=0.9893
[S2] BUFFERED delta from S11 (total buffered=1)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=33 metric=0.9076 head_norm=1.354019
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.892174e-01
[S6] stored merged vector for next round verification (round=33)
[S6] DEBUG after merge:  round=33 metric=0.8867 head_norm=1.488968 delta_norm=0.289217
[S6] aggregate: ROLLBACK (f1_val pre=0.908 post=0.887 tol_abs=0.005 tol_rel=0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=33 metric=0.7331 head_norm=1.663724
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.368757e-01
[S2] stored merged vector for next round verification (round=33)
[S2] DEBUG after merge:  round=33 metric=0.7420 head_norm=1.713839 delta_norm=0.136876
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=34 head_norm_before_train=1.713839 cos_to_last_merge=1.0000 (last merge round=33)
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.7138550748730044, 'auprc': 0.8080351058179246, 'loss_val': 0.542812154241379, 'psi': 0.7515270872509725}-{'f1_val': 0.7331399722153116, 'auprc': 0.8427526306568688, 'loss_val': 0.42175025296327245, 'psi': 0.7769850355919345}
[S3] START round=34 head_norm_before_train=2.035300 (no previous merge yet)
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.9233158243809967, 'auprc': 0.9984662892086817, 'loss_val': 0.15023022155876975, 'psi': 0.9533760103120708}-{'f1_val': 0.9470038283884862, 'auprc': 0.9984992962582366, 'loss_val': 0.135758683178649, 'psi': 0.9676020155363864}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=34 head_norm_before_train=1.813691 cos_to_last_merge=0.8359 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.836
[S4] round=34 local utility u=0.009448 metrics={'f1_val': 0.9495591903222271, 'auprc': 0.9548906254596745, 'loss_val': 0.27653318929221415, 'psi': 0.951691764377206}-{'f1_val': 0.9461308245376732, 'auprc': 0.9571906913860477, 'loss_val': 0.2817598889205744, 'psi': 0.950554771277023}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S4] sending update (kind=head size=1807 to 1 peers)
[S5] START round=34 head_norm_before_train=1.447280 cos_to_last_merge=0.9943 (last merge round=28)
[S5] round=34 local utility u=0.526725 metrics={'f1_val': 0.8643474479886991, 'auprc': 0.9918299544552217, 'loss_val': 0.19647523250925586, 'psi': 0.9153404505753081}-{'f1_val': 0.7020603460463012, 'auprc': 0.9903619058213247, 'loss_val': 0.271799436614025, 'psi': 0.8173809699563106}
[S6] START round=34 head_norm_before_train=1.488968 cos_to_last_merge=1.0000 (last merge round=33)
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.8203518365593704, 'auprc': 0.9673017092795148, 'loss_val': 0.43378980693814345, 'psi': 0.8791317856474281}-{'f1_val': 0.9075749606602495, 'auprc': 0.9738325375384536, 'loss_val': 0.27387332567895406, 'psi': 0.9340779914115311}
[S7] START round=34 head_norm_before_train=1.253229 cos_to_last_merge=0.9998 (last merge round=32)
[S7] round=34 local utility u=0.219813 metrics={'f1_val': 0.6236390529566198, 'auprc': 0.7973991639609558, 'loss_val': 0.591625319250652, 'psi': 0.6931430973583542}-{'f1_val': 0.5771120083840926, 'auprc': 0.7851458949411738, 'loss_val': 0.7153291020249938, 'psi': 0.6603255630069251}
[S8] START round=34 head_norm_before_train=1.785328 cos_to_last_merge=0.9987 (last merge round=29)
[S8] round=34 local utility u=0.017512 metrics={'f1_val': 0.990820193592503, 'auprc': 0.9988973160638305, 'loss_val': 0.037744175235628605, 'psi': 0.994051042581034}-{'f1_val': 0.9865324998004762, 'auprc': 0.9988574771990617, 'loss_val': 0.04692196758299295, 'psi': 0.9914624907599103}
[S9] START round=34 head_norm_before_train=1.601143 cos_to_last_merge=0.7032 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.703
[S9] round=34 local utility u=0.011349 metrics={'f1_val': 0.9959957888192151, 'auprc': 0.9984573451012224, 'loss_val': 0.02798554127096942, 'psi': 0.996980411332018}-{'f1_val': 0.9962500947792776, 'auprc': 0.9927942484739098, 'loss_val': 0.03522074869562364, 'psi': 0.9948677562571305}
[S9] not sending this round → trigger blocked (psi=0.997)
[S10] START round=34 head_norm_before_train=1.538217 cos_to_last_merge=0.9704 (last merge round=28)
[S10] round=34 local utility u=0.000625 metrics={'f1_val': 0.9948838907637279, 'auprc': 0.9916586085513984, 'loss_val': 0.04807190552533278, 'psi': 0.9935937778787961}-{'f1_val': 0.9948838907637279, 'auprc': 0.9916701500630098, 'loss_val': 0.049357011005137244, 'psi': 0.9935983944834407}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=34 head_norm_before_train=1.773127 cos_to_last_merge=0.9995 (last merge round=29)
[S11] round=34 local utility u=0.003304 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9976780200698437, 'loss_val': 0.025582657015841836, 'psi': 0.9969994107360912}-{'f1_val': 0.9961541414107454, 'auprc': 0.9976243402338587, 'loss_val': 0.02967270893800373, 'psi': 0.9967422209399908}
[S13] START round=34 head_norm_before_train=1.268618 cos_to_last_merge=1.0000 (last merge round=33)
[S13] round=34 local utility u=0.109747 metrics={'f1_val': 0.532090258515603, 'auprc': 0.6733886955717278, 'loss_val': 0.9070749904075983, 'psi': 0.5886096333380528}-{'f1_val': 0.5745673361492393, 'auprc': 0.5608435956743991, 'loss_val': 1.043795608415679, 'psi': 0.5690778399593033}
[S14] START round=34 head_norm_before_train=1.319550 cos_to_last_merge=0.9791 (last merge round=28)
[S14] round=34 local utility u=0.023165 metrics={'f1_val': 0.9976291097282272, 'auprc': 0.9986468774742329, 'loss_val': 0.08472289804024105, 'psi': 0.9980362168266295}-{'f1_val': 0.9959778002902165, 'auprc': 0.9958690336564008, 'loss_val': 0.11281176854925173, 'psi': 0.9959342936366902}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=34 metric=0.9976 head_norm=1.342643
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.165583e-01
[S14] stored merged vector for next round verification (round=34)
[S14] DEBUG after merge:  round=34 metric=0.9972 head_norm=1.370928 delta_norm=0.216558
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] START round=34 head_norm_before_train=1.431780 cos_to_last_merge=0.9991 (last merge round=32)
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.8326902699942231, 'auprc': 0.9943399578783265, 'loss_val': 0.3092709778739752, 'psi': 0.8973501451478645}-{'f1_val': 0.9971773386779533, 'auprc': 0.9997083806883221, 'loss_val': 0.038473067684157806, 'psi': 0.9981897554821009}
[S16] START round=34 head_norm_before_train=1.821491 cos_to_last_merge=0.7597 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.760
[S16] round=34 local utility u=0.000000 metrics={'f1_val': 0.8612438280532851, 'auprc': 0.9839230500346231, 'loss_val': 0.6914566965288351, 'psi': 0.9103155168458203}-{'f1_val': 0.8770154696556128, 'auprc': 0.9925652079650819, 'loss_val': 0.293942261085753, 'psi': 0.9232353649794005}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=34 head_norm_before_train=2.132281 (no previous merge yet)
[S17] round=34 local utility u=0.000000 metrics={'f1_val': 0.6309499244003802, 'auprc': 0.8535802914449447, 'loss_val': 1.2381238330697495, 'psi': 0.720002071218206}-{'f1_val': 0.775396111291476, 'auprc': 0.8646384355229437, 'loss_val': 0.6644694942044281, 'psi': 0.8110930409840631}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.915)
[S11] not sending this round → trigger blocked (psi=0.997)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] → sending delta(kind=head bytes=1806) to S13@127.0.0.1:39813
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:39811
[S13] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:39817
[S7] sending update (kind=head size=1806 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1803) from S13
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.288727)
[S10] loaded HEAD from S13 (vec_in norm=1.288727)
[S10] cosine check vs S13: cos=0.9669
[S10] BUFFERED delta from S13 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1806) from S7
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.267290)
[S13] loaded HEAD from S7 (vec_in norm=1.267290)
[S13] cosine check vs S7: cos=0.9980
[S13] BUFFERED delta from S7 (total buffered=1)
[S8] sending update (kind=head size=1792 to 1 peers)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=34 metric=0.6236 head_norm=1.267290
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.978034e-01
[S7] stored merged vector for next round verification (round=34)
[S7] DEBUG after merge:  round=34 metric=0.6408 head_norm=1.213214 delta_norm=0.497803
[S7] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=34 metric=0.5321 head_norm=1.288727
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.134018e-02
[S13] stored merged vector for next round verification (round=34)
[S13] DEBUG after merge:  round=34 metric=0.5275 head_norm=1.277385 delta_norm=0.041340
[S13] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S17] RECEIVED delta(kind=head bytes=1792) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.810934)
[S17] loaded HEAD from S8 (vec_in norm=1.810934)
[S17] cosine check vs S8: cos=-0.0670
[S17] DROPPED delta from S8 (cos=-0.0670 < 0.0)
[S2] START round=35 head_norm_before_train=1.739439 cos_to_last_merge=0.9998 (last merge round=33)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.7208688053411045, 'auprc': 0.7774460049541712, 'loss_val': 0.6818878863712277, 'psi': 0.7434996851863311}-{'f1_val': 0.7138550748730044, 'auprc': 0.8080351058179246, 'loss_val': 0.542812154241379, 'psi': 0.7515270872509725}
[S3] START round=35 head_norm_before_train=2.047694 (no previous merge yet)
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.8773323053286846, 'auprc': 0.99858854588711, 'loss_val': 0.25479653562278143, 'psi': 0.9258348015520548}-{'f1_val': 0.9233158243809967, 'auprc': 0.9984662892086817, 'loss_val': 0.15023022155876975, 'psi': 0.9533760103120708}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=35 head_norm_before_train=1.821226 cos_to_last_merge=0.8351 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.835
[S4] round=35 local utility u=0.004828 metrics={'f1_val': 0.9532824885666542, 'auprc': 0.94929851865209, 'loss_val': 0.272440052176206, 'psi': 0.9516889006008284}-{'f1_val': 0.9495591903222271, 'auprc': 0.9548906254596745, 'loss_val': 0.27653318929221415, 'psi': 0.951691764377206}
[S4] not sending this round → trigger blocked (psi=0.952)
[S5] START round=35 head_norm_before_train=1.470955 cos_to_last_merge=0.9926 (last merge round=28)
[S5] round=35 local utility u=0.000000 metrics={'f1_val': 0.7046542835399721, 'auprc': 0.9585504571400725, 'loss_val': 0.42799165065829925, 'psi': 0.8062127529800123}-{'f1_val': 0.8643474479886991, 'auprc': 0.9918299544552217, 'loss_val': 0.19647523250925586, 'psi': 0.9153404505753081}
[S6] START round=35 head_norm_before_train=1.529688 cos_to_last_merge=0.9992 (last merge round=33)
[S6] round=35 local utility u=0.000000 metrics={'f1_val': 0.5952349562449522, 'auprc': 0.8069883224940747, 'loss_val': 0.8680071420503559, 'psi': 0.6799363027446013}-{'f1_val': 0.8203518365593704, 'auprc': 0.9673017092795148, 'loss_val': 0.43378980693814345, 'psi': 0.8791317856474281}
[S7] START round=35 head_norm_before_train=1.213214 cos_to_last_merge=1.0000 (last merge round=34)
[S7] round=35 local utility u=0.254349 metrics={'f1_val': 0.6713158537667643, 'auprc': 0.8268570850841777, 'loss_val': 0.4573623274345567, 'psi': 0.7335323462937297}-{'f1_val': 0.6236390529566198, 'auprc': 0.7973991639609558, 'loss_val': 0.591625319250652, 'psi': 0.6931430973583542}
[S8] START round=35 head_norm_before_train=1.810934 cos_to_last_merge=0.9984 (last merge round=29)
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.9750800033050409, 'auprc': 0.9987842401096325, 'loss_val': 0.0625176573381456, 'psi': 0.9845616980268775}-{'f1_val': 0.990820193592503, 'auprc': 0.9988973160638305, 'loss_val': 0.037744175235628605, 'psi': 0.994051042581034}
[S9] START round=35 head_norm_before_train=1.612023 cos_to_last_merge=0.7018 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.702
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9952507589239288, 'loss_val': 0.02817023551732383, 'psi': 0.995946414969904}-{'f1_val': 0.9959957888192151, 'auprc': 0.9984573451012224, 'loss_val': 0.02798554127096942, 'psi': 0.996980411332018}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=35 head_norm_before_train=1.569359 cos_to_last_merge=0.9669 (last merge round=28)
[S10] round=35 local utility u=0.001771 metrics={'f1_val': 0.9929110311196298, 'auprc': 0.9951362782976916, 'loss_val': 0.043125035490385814, 'psi': 0.9938011299908545}-{'f1_val': 0.9948838907637279, 'auprc': 0.9916586085513984, 'loss_val': 0.04807190552533278, 'psi': 0.9935937778787961}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=35 metric=0.9929 head_norm=1.597252
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.468072e-01
[S10] stored merged vector for next round verification (round=35)
[S10] DEBUG after merge:  round=35 metric=0.9929 head_norm=1.430071 delta_norm=0.246807
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S11] START round=35 head_norm_before_train=1.787649 cos_to_last_merge=0.9993 (last merge round=29)
[S11] round=35 local utility u=0.000000 metrics={'f1_val': 0.9910563322225553, 'auprc': 0.9976721843339323, 'loss_val': 0.04365709261461735, 'psi': 0.9937026730671061}-{'f1_val': 0.9965470045135896, 'auprc': 0.9976780200698437, 'loss_val': 0.025582657015841836, 'psi': 0.9969994107360912}
[S13] START round=35 head_norm_before_train=1.277385 cos_to_last_merge=1.0000 (last merge round=34)
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.5686469271779242, 'auprc': 0.5912447612290371, 'loss_val': 0.9475156451962017, 'psi': 0.5776860607983694}-{'f1_val': 0.532090258515603, 'auprc': 0.6733886955717278, 'loss_val': 0.9070749904075983, 'psi': 0.5886096333380528}
[S14] START round=35 head_norm_before_train=1.370928 cos_to_last_merge=1.0000 (last merge round=34)
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.9947368952937303, 'auprc': 0.9966380862853047, 'loss_val': 0.09092361925987769, 'psi': 0.99549737169036}-{'f1_val': 0.9976291097282272, 'auprc': 0.9986468774742329, 'loss_val': 0.08472289804024105, 'psi': 0.9980362168266295}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=35 head_norm_before_train=1.507513 cos_to_last_merge=0.9966 (last merge round=32)
[S15] round=35 local utility u=0.645588 metrics={'f1_val': 0.9974605999319422, 'auprc': 0.9996217607757694, 'loss_val': 0.022562650775285617, 'psi': 0.9983250642694732}-{'f1_val': 0.8326902699942231, 'auprc': 0.9943399578783265, 'loss_val': 0.3092709778739752, 'psi': 0.8973501451478645}
[S16] START round=35 head_norm_before_train=1.829998 cos_to_last_merge=0.7585 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.758
[S16] round=35 local utility u=0.422197 metrics={'f1_val': 0.9331754801579238, 'auprc': 0.9917247982800911, 'loss_val': 0.3020584782888005, 'psi': 0.9565952074067907}-{'f1_val': 0.8612438280532851, 'auprc': 0.9839230500346231, 'loss_val': 0.6914566965288351, 'psi': 0.9103155168458203}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=35 head_norm_before_train=2.147969 (no previous merge yet)
[S17] round=35 local utility u=0.957424 metrics={'f1_val': 0.8256699886169411, 'auprc': 0.9056956004861577, 'loss_val': 0.6479415984233966, 'psi': 0.8576802333646277}-{'f1_val': 0.6309499244003802, 'auprc': 0.8535802914449447, 'loss_val': 1.2381238330697495, 'psi': 0.720002071218206}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] ⇄ pheromone p=0.287 → S7@127.0.0.1:39808
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=36 head_norm_before_train=1.759508 cos_to_last_merge=0.9995 (last merge round=33)
[S2] round=36 local utility u=0.346436 metrics={'f1_val': 0.7067516786559473, 'auprc': 0.9405222284605725, 'loss_val': 0.3935416897809665, 'psi': 0.8002598985777974}-{'f1_val': 0.7208688053411045, 'auprc': 0.7774460049541712, 'loss_val': 0.6818878863712277, 'psi': 0.7434996851863311}
[S3] START round=36 head_norm_before_train=2.060285 (no previous merge yet)
[S3] round=36 local utility u=0.463402 metrics={'f1_val': 0.9954616546126973, 'auprc': 0.99850458251692, 'loss_val': 0.03651723160437181, 'psi': 0.9966788257743864}-{'f1_val': 0.8773323053286846, 'auprc': 0.99858854588711, 'loss_val': 0.25479653562278143, 'psi': 0.9258348015520548}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S4] START round=36 head_norm_before_train=1.826724 cos_to_last_merge=0.8342 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.834
[S4] round=36 local utility u=0.000000 metrics={'f1_val': 0.9447735890197971, 'auprc': 0.9440503555631287, 'loss_val': 0.2884192526495976, 'psi': 0.9444842956371298}-{'f1_val': 0.9532824885666542, 'auprc': 0.94929851865209, 'loss_val': 0.272440052176206, 'psi': 0.9516889006008284}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=36 head_norm_before_train=1.486431 cos_to_last_merge=0.9913 (last merge round=28)
[S5] round=36 local utility u=1.000000 metrics={'f1_val': 0.9967280377725878, 'auprc': 0.9940009347314779, 'loss_val': 0.1171562218973747, 'psi': 0.9956371965561438}-{'f1_val': 0.7046542835399721, 'auprc': 0.9585504571400725, 'loss_val': 0.42799165065829925, 'psi': 0.8062127529800123}
[S6] START round=36 head_norm_before_train=1.566572 cos_to_last_merge=0.9973 (last merge round=33)
[S6] round=36 local utility u=1.000000 metrics={'f1_val': 0.8653488847252675, 'auprc': 0.9696766281332939, 'loss_val': 0.3344579335665337, 'psi': 0.9070799820884781}-{'f1_val': 0.5952349562449522, 'auprc': 0.8069883224940747, 'loss_val': 0.8680071420503559, 'psi': 0.6799363027446013}
[S7] START round=36 head_norm_before_train=1.230260 cos_to_last_merge=0.9998 (last merge round=34)
[S7] round=36 local utility u=0.000000 metrics={'f1_val': 0.5101750572921447, 'auprc': 0.7816085557022352, 'loss_val': 0.8708522758392402, 'psi': 0.618748456656181}-{'f1_val': 0.6713158537667643, 'auprc': 0.8268570850841777, 'loss_val': 0.4573623274345567, 'psi': 0.7335323462937297}
[S8] START round=36 head_norm_before_train=1.836661 cos_to_last_merge=0.9980 (last merge round=29)
[S8] round=36 local utility u=0.054178 metrics={'f1_val': 0.9890170474955197, 'auprc': 0.9989138456192305, 'loss_val': 0.03817176147200807, 'psi': 0.9929757667450039}-{'f1_val': 0.9750800033050409, 'auprc': 0.9987842401096325, 'loss_val': 0.0625176573381456, 'psi': 0.9845616980268775}
[S9] START round=36 head_norm_before_train=1.625937 cos_to_last_merge=0.6999 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.700
[S9] round=36 local utility u=0.004576 metrics={'f1_val': 0.9959957888192151, 'auprc': 0.9984620433264773, 'loss_val': 0.026165525160118067, 'psi': 0.99698229062212}-{'f1_val': 0.9964101856672208, 'auprc': 0.9952507589239288, 'loss_val': 0.02817023551732383, 'psi': 0.995946414969904}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=36 head_norm_before_train=1.430071 cos_to_last_merge=1.0000 (last merge round=35)
[S10] round=36 local utility u=0.000000 metrics={'f1_val': 0.9940063275949004, 'auprc': 0.9918123485080088, 'loss_val': 0.05638902541149143, 'psi': 0.9931287359601437}-{'f1_val': 0.9929110311196298, 'auprc': 0.9951362782976916, 'loss_val': 0.043125035490385814, 'psi': 0.9938011299908545}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=36 head_norm_before_train=1.801235 cos_to_last_merge=0.9991 (last merge round=29)
[S11] round=36 local utility u=0.025401 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9971082420133843, 'loss_val': 0.02410718511471884, 'psi': 0.9967714995135075}-{'f1_val': 0.9910563322225553, 'auprc': 0.9976721843339323, 'loss_val': 0.04365709261461735, 'psi': 0.9937026730671061}
[S13] START round=36 head_norm_before_train=1.298377 cos_to_last_merge=0.9997 (last merge round=34)
[S13] round=36 local utility u=0.238118 metrics={'f1_val': 0.6094549088222001, 'auprc': 0.6140381400140178, 'loss_val': 0.7845082922524069, 'psi': 0.6112882012989271}-{'f1_val': 0.5686469271779242, 'auprc': 0.5912447612290371, 'loss_val': 0.9475156451962017, 'psi': 0.5776860607983694}
[S14] START round=36 head_norm_before_train=1.396263 cos_to_last_merge=0.9998 (last merge round=34)
[S14] round=36 local utility u=0.015529 metrics={'f1_val': 0.9964236557997356, 'auprc': 0.9986293783797618, 'loss_val': 0.07595979449825543, 'psi': 0.9973059448317461}-{'f1_val': 0.9947368952937303, 'auprc': 0.9966380862853047, 'loss_val': 0.09092361925987769, 'psi': 0.99549737169036}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=36 head_norm_before_train=1.570974 cos_to_last_merge=0.9940 (last merge round=32)
[S15] round=36 local utility u=0.002461 metrics={'f1_val': 0.9975479273409924, 'auprc': 0.9997390960215766, 'loss_val': 0.018517343953158318, 'psi': 0.9984243948132261}-{'f1_val': 0.9974605999319422, 'auprc': 0.9996217607757694, 'loss_val': 0.022562650775285617, 'psi': 0.9983250642694732}
[S16] START round=36 head_norm_before_train=1.838988 cos_to_last_merge=0.7576 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.758
[S16] round=36 local utility u=0.000000 metrics={'f1_val': 0.9277425733381025, 'auprc': 0.9919584941569239, 'loss_val': 0.3316408794616063, 'psi': 0.9534289416656311}-{'f1_val': 0.9331754801579238, 'auprc': 0.9917247982800911, 'loss_val': 0.3020584782888005, 'psi': 0.9565952074067907}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=36 head_norm_before_train=2.162792 (no previous merge yet)
[S17] round=36 local utility u=0.000000 metrics={'f1_val': 0.7263690366514046, 'auprc': 0.8939924441577032, 'loss_val': 0.9292681070520669, 'psi': 0.7934183996539241}-{'f1_val': 0.8256699886169411, 'auprc': 0.9056956004861577, 'loss_val': 0.6479415984233966, 'psi': 0.8576802333646277}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S15] not sending this round → trigger blocked (psi=0.998)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S6] → sending delta(kind=head bytes=1807) to S7@127.0.0.1:39808
[S6] sending update (kind=head size=1807 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1807) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.596840)
[S7] loaded HEAD from S6 (vec_in norm=1.596840)
[S7] cosine check vs S6: cos=0.8609
[S7] BUFFERED delta from S6 (total buffered=1)
[S2] START round=37 head_norm_before_train=1.779901 cos_to_last_merge=0.9991 (last merge round=33)
[S2] round=37 local utility u=0.000000 metrics={'f1_val': 0.7134701852550042, 'auprc': 0.8286333912785793, 'loss_val': 0.5438082326177646, 'psi': 0.7595354676644341}-{'f1_val': 0.7067516786559473, 'auprc': 0.9405222284605725, 'loss_val': 0.3935416897809665, 'psi': 0.8002598985777974}
[S3] START round=37 head_norm_before_train=2.072267 (no previous merge yet)
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.9608296089712303, 'auprc': 0.9984959107339796, 'loss_val': 0.1165792749098892, 'psi': 0.97589612967633}-{'f1_val': 0.9954616546126973, 'auprc': 0.99850458251692, 'loss_val': 0.03651723160437181, 'psi': 0.9966788257743864}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=37 head_norm_before_train=1.835940 cos_to_last_merge=0.8334 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.833
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.943942097968262, 'auprc': 0.9200603771461199, 'loss_val': 0.2950074726986646, 'psi': 0.9343894096394052}-{'f1_val': 0.9447735890197971, 'auprc': 0.9440503555631287, 'loss_val': 0.2884192526495976, 'psi': 0.9444842956371298}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=37 head_norm_before_train=1.497194 cos_to_last_merge=0.9904 (last merge round=28)
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.7013566097176281, 'auprc': 0.9866402380207719, 'loss_val': 0.36955320972281935, 'psi': 0.8154700610388856}-{'f1_val': 0.9967280377725878, 'auprc': 0.9940009347314779, 'loss_val': 0.1171562218973747, 'psi': 0.9956371965561438}
[S6] START round=37 head_norm_before_train=1.596840 cos_to_last_merge=0.9955 (last merge round=33)
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.6005342653663994, 'auprc': 0.9538441518495842, 'loss_val': 0.7556443294887456, 'psi': 0.7418582199596733}-{'f1_val': 0.8653488847252675, 'auprc': 0.9696766281332939, 'loss_val': 0.3344579335665337, 'psi': 0.9070799820884781}
[S7] START round=37 head_norm_before_train=1.244935 cos_to_last_merge=0.9991 (last merge round=34)
[S7] round=37 local utility u=0.555324 metrics={'f1_val': 0.6356088598803292, 'auprc': 0.8004378064248558, 'loss_val': 0.5692946104848595, 'psi': 0.7015404384981399}-{'f1_val': 0.5101750572921447, 'auprc': 0.7816085557022352, 'loss_val': 0.8708522758392402, 'psi': 0.618748456656181}
[S8] START round=37 head_norm_before_train=1.859389 cos_to_last_merge=0.9976 (last merge round=29)
[S8] round=37 local utility u=0.000000 metrics={'f1_val': 0.9886727134413368, 'auprc': 0.9987910779360625, 'loss_val': 0.04069450989367311, 'psi': 0.9927200592392271}-{'f1_val': 0.9890170474955197, 'auprc': 0.9989138456192305, 'loss_val': 0.03817176147200807, 'psi': 0.9929757667450039}
[S9] START round=37 head_norm_before_train=1.639410 cos_to_last_merge=0.6985 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.699
[S9] round=37 local utility u=0.001766 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9984595909677529, 'loss_val': 0.025113411814167052, 'psi': 0.9972299477874337}-{'f1_val': 0.9959957888192151, 'auprc': 0.9984620433264773, 'loss_val': 0.026165525160118067, 'psi': 0.99698229062212}
[S9] not sending this round → trigger blocked (psi=0.997)
[S10] START round=37 head_norm_before_train=1.463255 cos_to_last_merge=0.9998 (last merge round=35)
[S10] round=37 local utility u=0.005317 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9949269555015472, 'loss_val': 0.05246902176165612, 'psi': 0.9941115760197755}-{'f1_val': 0.9940063275949004, 'auprc': 0.9918123485080088, 'loss_val': 0.05638902541149143, 'psi': 0.9931287359601437}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=37 head_norm_before_train=1.813817 cos_to_last_merge=0.9988 (last merge round=29)
[S11] round=37 local utility u=0.000971 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9974307383633636, 'loss_val': 0.02325594404473372, 'psi': 0.9969127777290736}-{'f1_val': 0.9965470045135896, 'auprc': 0.9971082420133843, 'loss_val': 0.02410718511471884, 'psi': 0.9967714995135075}
[S13] START round=37 head_norm_before_train=1.323681 cos_to_last_merge=0.9989 (last merge round=34)
[S13] round=37 local utility u=0.000000 metrics={'f1_val': 0.572664742469007, 'auprc': 0.5669465194946486, 'loss_val': 1.015479725517728, 'psi': 0.5703774532792636}-{'f1_val': 0.6094549088222001, 'auprc': 0.6140381400140178, 'loss_val': 0.7845082922524069, 'psi': 0.6112882012989271}
[S14] START round=37 head_norm_before_train=1.420029 cos_to_last_merge=0.9993 (last merge round=34)
[S14] round=37 local utility u=0.003114 metrics={'f1_val': 0.9967774409524363, 'auprc': 0.9968425328297453, 'loss_val': 0.06649458891115273, 'psi': 0.9968034777033599}-{'f1_val': 0.9964236557997356, 'auprc': 0.9986293783797618, 'loss_val': 0.07595979449825543, 'psi': 0.9973059448317461}
[S14] not sending this round → trigger blocked (psi=0.997)
[S15] START round=37 head_norm_before_train=1.622117 cos_to_last_merge=0.9916 (last merge round=32)
[S15] round=37 local utility u=0.000000 metrics={'f1_val': 0.9031969557877157, 'auprc': 0.9980226200186944, 'loss_val': 0.21818387184768614, 'psi': 0.9411272214801072}-{'f1_val': 0.9975479273409924, 'auprc': 0.9997390960215766, 'loss_val': 0.018517343953158318, 'psi': 0.9984243948132261}
[S16] START round=37 head_norm_before_train=1.845582 cos_to_last_merge=0.7570 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.757
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.8721451178021968, 'auprc': 0.9875527719638252, 'loss_val': 0.6013753887993284, 'psi': 0.9183081794668482}-{'f1_val': 0.9277425733381025, 'auprc': 0.9919584941569239, 'loss_val': 0.3316408794616063, 'psi': 0.9534289416656311}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=37 head_norm_before_train=2.177144 (no previous merge yet)
[S17] round=37 local utility u=0.206207 metrics={'f1_val': 0.7717203004717599, 'auprc': 0.9093018222531573, 'loss_val': 0.8348905311510487, 'psi': 0.8267529091843189}-{'f1_val': 0.7263690366514046, 'auprc': 0.8939924441577032, 'loss_val': 0.9292681070520669, 'psi': 0.7934183996539241}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S11] not sending this round → trigger blocked (psi=0.997)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=37 metric=0.6356 head_norm=1.256737
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.137358e-01
[S7] stored merged vector for next round verification (round=37)
[S7] DEBUG after merge:  round=37 metric=0.6430 head_norm=1.376032 delta_norm=0.413736
[S7] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=38 head_norm_before_train=1.800483 cos_to_last_merge=0.9985 (last merge round=33)
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.7137859827020009, 'auprc': 0.8320823460324636, 'loss_val': 0.5730471618513876, 'psi': 0.7611045280341859}-{'f1_val': 0.7134701852550042, 'auprc': 0.8286333912785793, 'loss_val': 0.5438082326177646, 'psi': 0.7595354676644341}
[S3] START round=38 head_norm_before_train=2.083699 (no previous merge yet)
[S3] round=38 local utility u=0.000000 metrics={'f1_val': 0.8985074408113424, 'auprc': 0.9986185200047466, 'loss_val': 0.1990772744994929, 'psi': 0.9385518724887041}-{'f1_val': 0.9608296089712303, 'auprc': 0.9984959107339796, 'loss_val': 0.1165792749098892, 'psi': 0.97589612967633}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=38 head_norm_before_train=1.841437 cos_to_last_merge=0.8328 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.833
[S4] round=38 local utility u=0.092029 metrics={'f1_val': 0.9558491447544695, 'auprc': 0.9519528859625785, 'loss_val': 0.27806956006728556, 'psi': 0.9542906412377131}-{'f1_val': 0.943942097968262, 'auprc': 0.9200603771461199, 'loss_val': 0.2950074726986646, 'psi': 0.9343894096394052}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=38 head_norm_before_train=1.506798 cos_to_last_merge=0.9895 (last merge round=28)
[S5] round=38 local utility u=1.000000 metrics={'f1_val': 0.996288981767675, 'auprc': 0.9923386859950771, 'loss_val': 0.10513326932867093, 'psi': 0.9947088634586359}-{'f1_val': 0.7013566097176281, 'auprc': 0.9866402380207719, 'loss_val': 0.36955320972281935, 'psi': 0.8154700610388856}
[S6] START round=38 head_norm_before_train=1.624271 cos_to_last_merge=0.9938 (last merge round=33)
[S6] round=38 local utility u=0.456231 metrics={'f1_val': 0.7111940119981751, 'auprc': 0.9565388077858722, 'loss_val': 0.5152243983813454, 'psi': 0.809331930313254}-{'f1_val': 0.6005342653663994, 'auprc': 0.9538441518495842, 'loss_val': 0.7556443294887456, 'psi': 0.7418582199596733}
[S7] START round=38 head_norm_before_train=1.376032 cos_to_last_merge=1.0000 (last merge round=37)
[S7] round=38 local utility u=0.157203 metrics={'f1_val': 0.6680003029755209, 'auprc': 0.8151855212099774, 'loss_val': 0.4934813902521379, 'psi': 0.7268743902693036}-{'f1_val': 0.6356088598803292, 'auprc': 0.8004378064248558, 'loss_val': 0.5692946104848595, 'psi': 0.7015404384981399}
[S8] START round=38 head_norm_before_train=1.871137 cos_to_last_merge=0.9972 (last merge round=29)
[S8] round=38 local utility u=0.000162 metrics={'f1_val': 0.9886727134413368, 'auprc': 0.9988011312984648, 'loss_val': 0.040399965186528164, 'psi': 0.992724080584188}-{'f1_val': 0.9886727134413368, 'auprc': 0.9987910779360625, 'loss_val': 0.04069450989367311, 'psi': 0.9927200592392271}
[S9] START round=38 head_norm_before_train=1.653973 cos_to_last_merge=0.6968 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.697
[S9] round=38 local utility u=0.000000 metrics={'f1_val': 0.9955763922175147, 'auprc': 0.9984591807519326, 'loss_val': 0.025434421135027144, 'psi': 0.9967295076312819}-{'f1_val': 0.9964101856672208, 'auprc': 0.9984595909677529, 'loss_val': 0.025113411814167052, 'psi': 0.9972299477874337}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=38 head_norm_before_train=1.501287 cos_to_last_merge=0.9991 (last merge round=35)
[S10] round=38 local utility u=0.001531 metrics={'f1_val': 0.9940063275949004, 'auprc': 0.9928905364121138, 'loss_val': 0.04592848818068435, 'psi': 0.9935600111217857}-{'f1_val': 0.9935679896985945, 'auprc': 0.9949269555015472, 'loss_val': 0.05246902176165612, 'psi': 0.9941115760197755}
[S10] not sending this round → trigger blocked (psi=0.994)
[S11] START round=38 head_norm_before_train=1.825547 cos_to_last_merge=0.9986 (last merge round=29)
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.8418412509433604, 'auprc': 0.9965286048079935, 'loss_val': 0.18708614459886538, 'psi': 0.9037161924892136}-{'f1_val': 0.996567470639547, 'auprc': 0.9974307383633636, 'loss_val': 0.02325594404473372, 'psi': 0.9969127777290736}
[S13] START round=38 head_norm_before_train=1.347925 cos_to_last_merge=0.9979 (last merge round=34)
[S13] round=38 local utility u=0.129097 metrics={'f1_val': 0.582504944830515, 'auprc': 0.5982519615008377, 'loss_val': 0.9102434682089587, 'psi': 0.5888037514986441}-{'f1_val': 0.572664742469007, 'auprc': 0.5669465194946486, 'loss_val': 1.015479725517728, 'psi': 0.5703774532792636}
[S14] START round=38 head_norm_before_train=1.441538 cos_to_last_merge=0.9987 (last merge round=34)
[S14] round=38 local utility u=0.010645 metrics={'f1_val': 0.997871830388708, 'auprc': 0.9986497647549328, 'loss_val': 0.057192967749308085, 'psi': 0.998183004135198}-{'f1_val': 0.9967774409524363, 'auprc': 0.9968425328297453, 'loss_val': 0.06649458891115273, 'psi': 0.9968034777033599}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=38 head_norm_before_train=1.661348 cos_to_last_merge=0.9896 (last merge round=32)
[S15] round=38 local utility u=0.063216 metrics={'f1_val': 0.9102757027090371, 'auprc': 0.9980182237531181, 'loss_val': 0.1342119231798308, 'psi': 0.9453727111266695}-{'f1_val': 0.9031969557877157, 'auprc': 0.9980226200186944, 'loss_val': 0.21818387184768614, 'psi': 0.9411272214801072}
[S16] START round=38 head_norm_before_train=1.851525 cos_to_last_merge=0.7565 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.756
[S16] round=38 local utility u=0.132931 metrics={'f1_val': 0.8956547091991726, 'auprc': 0.9903126744652956, 'loss_val': 0.48485060593667023, 'psi': 0.9335178953056218}-{'f1_val': 0.8721451178021968, 'auprc': 0.9875527719638252, 'loss_val': 0.6013753887993284, 'psi': 0.9183081794668482}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] sending update (kind=head size=1804 to 1 peers)
[S17] START round=38 head_norm_before_train=2.188714 (no previous merge yet)
[S17] round=38 local utility u=0.000000 metrics={'f1_val': 0.7084053420856313, 'auprc': 0.9331729296742157, 'loss_val': 0.9665611571104016, 'psi': 0.7983123771210652}-{'f1_val': 0.7717203004717599, 'auprc': 0.9093018222531573, 'loss_val': 0.8348905311510487, 'psi': 0.8267529091843189}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.727)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] sending update (kind=head size=1795 to 1 peers)
[S2] START round=39 head_norm_before_train=1.817944 cos_to_last_merge=0.9979 (last merge round=33)
[S2] round=39 local utility u=0.045921 metrics={'f1_val': 0.7135157137395354, 'auprc': 0.8563895152107579, 'loss_val': 0.552504928750841, 'psi': 0.7706652343280245}-{'f1_val': 0.7137859827020009, 'auprc': 0.8320823460324636, 'loss_val': 0.5730471618513876, 'psi': 0.7611045280341859}
[S3] START round=39 head_norm_before_train=2.094309 (no previous merge yet)
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.731485802299117, 'auprc': 0.9963248918627012, 'loss_val': 0.6481536070261021, 'psi': 0.8374214381245506}-{'f1_val': 0.8985074408113424, 'auprc': 0.9986185200047466, 'loss_val': 0.1990772744994929, 'psi': 0.9385518724887041}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=40 psi=0.837 u=0.0000 p_local=0.0759 f1=0.731 auprc=0.996 bytes=37690
[S4] START round=39 head_norm_before_train=1.850220 cos_to_last_merge=0.8319 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.832
[S4] round=39 local utility u=0.009652 metrics={'f1_val': 0.9580347669511229, 'auprc': 0.9557724640872169, 'loss_val': 0.2833388884126944, 'psi': 0.9571298458055605}-{'f1_val': 0.9558491447544695, 'auprc': 0.9519528859625785, 'loss_val': 0.27806956006728556, 'psi': 0.9542906412377131}
[S4] not sending this round → trigger blocked (psi=0.957)
[S4] r=40 psi=0.957 u=0.0097 p_local=0.0237 f1=0.958 auprc=0.956 bytes=32410
[S5] START round=39 head_norm_before_train=1.517819 cos_to_last_merge=0.9886 (last merge round=28)
[S5] round=39 local utility u=0.000000 metrics={'f1_val': 0.7016159976799538, 'auprc': 0.988562407802805, 'loss_val': 0.3265575832490501, 'psi': 0.8163945617290942}-{'f1_val': 0.996288981767675, 'auprc': 0.9923386859950771, 'loss_val': 0.10513326932867093, 'psi': 0.9947088634586359}
[S6] START round=39 head_norm_before_train=1.654214 cos_to_last_merge=0.9916 (last merge round=33)
[S6] round=39 local utility u=0.165221 metrics={'f1_val': 0.7606965674560303, 'auprc': 0.9592062153959746, 'loss_val': 0.4898001647430493, 'psi': 0.840100426632008}-{'f1_val': 0.7111940119981751, 'auprc': 0.9565388077858722, 'loss_val': 0.5152243983813454, 'psi': 0.809331930313254}
[S7] START round=39 head_norm_before_train=1.383451 cos_to_last_merge=1.0000 (last merge round=37)
[S7] round=39 local utility u=0.000000 metrics={'f1_val': 0.5758803741650766, 'auprc': 0.7856165287417755, 'loss_val': 0.6979457969925632, 'psi': 0.6597748359957561}-{'f1_val': 0.6680003029755209, 'auprc': 0.8151855212099774, 'loss_val': 0.4934813902521379, 'psi': 0.7268743902693036}
[S8] START round=39 head_norm_before_train=1.876850 cos_to_last_merge=0.9968 (last merge round=29)
[S8] round=39 local utility u=0.000000 metrics={'f1_val': 0.9749235053803817, 'auprc': 0.9987815353908831, 'loss_val': 0.06031350890789447, 'psi': 0.9844667173845822}-{'f1_val': 0.9886727134413368, 'auprc': 0.9988011312984648, 'loss_val': 0.040399965186528164, 'psi': 0.992724080584188}
[S9] START round=39 head_norm_before_train=1.668206 cos_to_last_merge=0.6952 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.695
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9957431594456938, 'loss_val': 0.024639013979940817, 'psi': 0.9962935708666124}-{'f1_val': 0.9955763922175147, 'auprc': 0.9984591807519326, 'loss_val': 0.025434421135027144, 'psi': 0.9967295076312819}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=40 psi=0.996 u=0.0000 p_local=0.0152 f1=0.997 auprc=0.996 bytes=35908
[S10] START round=39 head_norm_before_train=1.537713 cos_to_last_merge=0.9981 (last merge round=35)
[S10] round=39 local utility u=0.001877 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9943900496745361, 'loss_val': 0.044042731819836756, 'psi': 0.9938968136889711}-{'f1_val': 0.9940063275949004, 'auprc': 0.9928905364121138, 'loss_val': 0.04592848818068435, 'psi': 0.9935600111217857}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S10] r=40 psi=0.994 u=0.0019 p_local=0.0042 f1=0.994 auprc=0.994 bytes=37792
[S11] START round=39 head_norm_before_train=1.835689 cos_to_last_merge=0.9983 (last merge round=29)
[S11] round=39 local utility u=0.531738 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9970368236852553, 'loss_val': 0.053515677889517284, 'psi': 0.9967574783413768}-{'f1_val': 0.8418412509433604, 'auprc': 0.9965286048079935, 'loss_val': 0.18708614459886538, 'psi': 0.9037161924892136}
[S13] START round=39 head_norm_before_train=1.361467 cos_to_last_merge=0.9971 (last merge round=34)
[S13] round=39 local utility u=0.213103 metrics={'f1_val': 0.6246033832154343, 'auprc': 0.620183239806473, 'loss_val': 0.8024224155919337, 'psi': 0.6228353258518498}-{'f1_val': 0.582504944830515, 'auprc': 0.5982519615008377, 'loss_val': 0.9102434682089587, 'psi': 0.5888037514986441}
[S14] START round=39 head_norm_before_train=1.461758 cos_to_last_merge=0.9980 (last merge round=34)
[S14] round=39 local utility u=0.000000 metrics={'f1_val': 0.9970430872115695, 'auprc': 0.9986473604036676, 'loss_val': 0.05345215475709931, 'psi': 0.9976847964884088}-{'f1_val': 0.997871830388708, 'auprc': 0.9986497647549328, 'loss_val': 0.057192967749308085, 'psi': 0.998183004135198}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=40 psi=0.998 u=0.0000 p_local=0.0109 f1=0.997 auprc=0.999 bytes=41331
[S15] START round=39 head_norm_before_train=1.692153 cos_to_last_merge=0.9880 (last merge round=32)
[S15] round=39 local utility u=0.305956 metrics={'f1_val': 0.9941471706240588, 'auprc': 0.9989046187096572, 'loss_val': 0.028188854195544396, 'psi': 0.9960501498582982}-{'f1_val': 0.9102757027090371, 'auprc': 0.9980182237531181, 'loss_val': 0.1342119231798308, 'psi': 0.9453727111266695}
[S16] START round=39 head_norm_before_train=1.860443 cos_to_last_merge=0.7560 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.756
[S16] round=39 local utility u=0.186721 metrics={'f1_val': 0.9310892601766261, 'auprc': 0.9914660137314539, 'loss_val': 0.3274766084467262, 'psi': 0.9552399615985573}-{'f1_val': 0.8956547091991726, 'auprc': 0.9903126744652956, 'loss_val': 0.48485060593667023, 'psi': 0.9335178953056218}
[S16] not sending this round → trigger blocked (psi=0.955)
[S16] r=40 psi=0.955 u=0.1867 p_local=0.1358 f1=0.931 auprc=0.991 bytes=32448
[S17] START round=39 head_norm_before_train=2.202218 (no previous merge yet)
[S17] round=39 local utility u=0.000000 metrics={'f1_val': 0.6680450920094665, 'auprc': 0.9587006710899592, 'loss_val': 1.0337923645586846, 'psi': 0.7843073236416636}-{'f1_val': 0.7084053420856313, 'auprc': 0.9331729296742157, 'loss_val': 0.9665611571104016, 'psi': 0.7983123771210652}
[S6] not sending this round → trigger blocked (psi=0.840)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] not sending this round → trigger blocked (psi=0.623)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.996)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] r=40 psi=0.660 u=0.0000 p_local=0.1977 f1=0.576 auprc=0.786 bytes=35959
[S15] r=40 psi=0.996 u=0.3060 p_local=0.1551 f1=0.994 auprc=0.999 bytes=32362
[S5] r=40 psi=0.816 u=0.0000 p_local=0.3353 f1=0.702 auprc=0.989 bytes=37751
[S2] r=40 psi=0.771 u=0.0459 p_local=0.0620 f1=0.714 auprc=0.856 bytes=34187
[S11] r=40 psi=0.997 u=0.5317 p_local=0.1119 f1=0.997 auprc=0.997 bytes=48500
[S17] r=40 psi=0.784 u=0.0000 p_local=0.2134 f1=0.668 auprc=0.959 bytes=30615
[S13] r=40 psi=0.623 u=0.2131 p_local=0.1108 f1=0.625 auprc=0.620 bytes=32402
[S6] r=40 psi=0.840 u=0.1652 p_local=0.3258 f1=0.761 auprc=0.959 bytes=28774
[S8] r=40 psi=0.984 u=0.0000 p_local=0.0107 f1=0.975 auprc=0.999 bytes=35971
[S2] START round=40 head_norm_before_train=1.834390 cos_to_last_merge=0.9971 (last merge round=33)
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.6852960360813808, 'auprc': 0.8073032383672021, 'loss_val': 0.6480442288122044, 'psi': 0.7340989169957093}-{'f1_val': 0.7135157137395354, 'auprc': 0.8563895152107579, 'loss_val': 0.552504928750841, 'psi': 0.7706652343280245}
[S3] START round=40 head_norm_before_train=2.104891 (no previous merge yet)
[S3] round=40 local utility u=1.000000 metrics={'f1_val': 0.9916548226418828, 'auprc': 0.998498095723397, 'loss_val': 0.03817061736774691, 'psi': 0.9943921318744884}-{'f1_val': 0.731485802299117, 'auprc': 0.9963248918627012, 'loss_val': 0.6481536070261021, 'psi': 0.8374214381245506}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] START round=40 head_norm_before_train=1.856584 cos_to_last_merge=0.8312 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.831
[S4] round=40 local utility u=0.000000 metrics={'f1_val': 0.9487697347946685, 'auprc': 0.9522551145109596, 'loss_val': 0.2873185192058622, 'psi': 0.950163886681185}-{'f1_val': 0.9580347669511229, 'auprc': 0.9557724640872169, 'loss_val': 0.2833388884126944, 'psi': 0.9571298458055605}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=40 head_norm_before_train=1.530843 cos_to_last_merge=0.9873 (last merge round=28)
[S5] round=40 local utility u=0.998807 metrics={'f1_val': 0.996288981767675, 'auprc': 0.9920906383535735, 'loss_val': 0.10756686821504988, 'psi': 0.9946096444020344}-{'f1_val': 0.7016159976799538, 'auprc': 0.988562407802805, 'loss_val': 0.3265575832490501, 'psi': 0.8163945617290942}
[S6] START round=40 head_norm_before_train=1.677421 cos_to_last_merge=0.9898 (last merge round=33)
[S6] round=40 local utility u=0.000000 metrics={'f1_val': 0.7225027094075922, 'auprc': 0.9622908967714803, 'loss_val': 0.5912424546119757, 'psi': 0.8184179843531474}-{'f1_val': 0.7606965674560303, 'auprc': 0.9592062153959746, 'loss_val': 0.4898001647430493, 'psi': 0.840100426632008}
[S7] START round=40 head_norm_before_train=1.392160 cos_to_last_merge=0.9998 (last merge round=37)
[S7] round=40 local utility u=0.258090 metrics={'f1_val': 0.6332437898869514, 'auprc': 0.799463727994301, 'loss_val': 0.5674869262054868, 'psi': 0.6997317651298913}-{'f1_val': 0.5758803741650766, 'auprc': 0.7856165287417755, 'loss_val': 0.6979457969925632, 'psi': 0.6597748359957561}
[S8] START round=40 head_norm_before_train=1.894239 cos_to_last_merge=0.9965 (last merge round=29)
[S8] round=40 local utility u=0.068204 metrics={'f1_val': 0.9931883555373179, 'auprc': 0.9986710324166056, 'loss_val': 0.03316336871502098, 'psi': 0.9953814262890329}-{'f1_val': 0.9749235053803817, 'auprc': 0.9987815353908831, 'loss_val': 0.06031350890789447, 'psi': 0.9844667173845822}
[S9] START round=40 head_norm_before_train=1.680725 cos_to_last_merge=0.6939 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.694
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9952291419666343, 'loss_val': 0.024184566354792502, 'psi': 0.9960879638749885}-{'f1_val': 0.9966605118138915, 'auprc': 0.9957431594456938, 'loss_val': 0.024639013979940817, 'psi': 0.9962935708666124}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=40 head_norm_before_train=1.569993 cos_to_last_merge=0.9969 (last merge round=35)
[S10] round=40 local utility u=0.001867 metrics={'f1_val': 0.9937871219080217, 'auprc': 0.9941675959398615, 'loss_val': 0.04095683435522902, 'psi': 0.9939393115207577}-{'f1_val': 0.9935679896985945, 'auprc': 0.9943900496745361, 'loss_val': 0.044042731819836756, 'psi': 0.9938968136889711}
[S10] not sending this round → trigger blocked (psi=0.994)
[S11] START round=40 head_norm_before_train=1.845061 cos_to_last_merge=0.9981 (last merge round=29)
[S11] round=40 local utility u=0.013288 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9972231189318812, 'loss_val': 0.023422169210740425, 'psi': 0.996424350293901}-{'f1_val': 0.9965712481121245, 'auprc': 0.9970368236852553, 'loss_val': 0.053515677889517284, 'psi': 0.9967574783413768}
[S13] START round=40 head_norm_before_train=1.375284 cos_to_last_merge=0.9959 (last merge round=34)
[S13] round=40 local utility u=0.004332 metrics={'f1_val': 0.6403204123946429, 'auprc': 0.6471876146387626, 'loss_val': 0.9690738533926494, 'psi': 0.6430672932922907}-{'f1_val': 0.6246033832154343, 'auprc': 0.620183239806473, 'loss_val': 0.8024224155919337, 'psi': 0.6228353258518498}
[S14] START round=40 head_norm_before_train=1.482584 cos_to_last_merge=0.9971 (last merge round=34)
[S14] round=40 local utility u=0.004112 metrics={'f1_val': 0.9974310505072961, 'auprc': 0.9986469360901167, 'loss_val': 0.047554558029665114, 'psi': 0.9979174047404243}-{'f1_val': 0.9970430872115695, 'auprc': 0.9986473604036676, 'loss_val': 0.05345215475709931, 'psi': 0.9976847964884088}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=40 head_norm_before_train=1.715432 cos_to_last_merge=0.9867 (last merge round=32)
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.9121388526309179, 'auprc': 0.9991007280746107, 'loss_val': 0.1203074083105279, 'psi': 0.9469236028083949}-{'f1_val': 0.9941471706240588, 'auprc': 0.9989046187096572, 'loss_val': 0.028188854195544396, 'psi': 0.9960501498582982}
[S16] START round=40 head_norm_before_train=1.870740 cos_to_last_merge=0.7555 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.756
[S16] round=40 local utility u=0.098608 metrics={'f1_val': 0.9404740032005247, 'auprc': 0.993930845883696, 'loss_val': 0.19396391260976142, 'psi': 0.9618567402737932}-{'f1_val': 0.9310892601766261, 'auprc': 0.9914660137314539, 'loss_val': 0.3274766084467262, 'psi': 0.9552399615985573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=40 head_norm_before_train=2.207504 (no previous merge yet)
[S17] round=40 local utility u=1.000000 metrics={'f1_val': 0.9025593312831475, 'auprc': 0.9640084710991861, 'loss_val': 0.3917915770924355, 'psi': 0.9271389872095629}-{'f1_val': 0.6680450920094665, 'auprc': 0.9587006710899592, 'loss_val': 1.0337923645586846, 'psi': 0.7843073236416636}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S2] START round=41 head_norm_before_train=1.850169 cos_to_last_merge=0.9965 (last merge round=33)
[S2] round=41 local utility u=0.144418 metrics={'f1_val': 0.7140782604075677, 'auprc': 0.8302824472254773, 'loss_val': 0.6008396149248284, 'psi': 0.7605599351347315}-{'f1_val': 0.6852960360813808, 'auprc': 0.8073032383672021, 'loss_val': 0.6480442288122044, 'psi': 0.7340989169957093}
[S3] START round=41 head_norm_before_train=2.115993 (no previous merge yet)
[S3] round=41 local utility u=0.000000 metrics={'f1_val': 0.9420456500641247, 'auprc': 0.9984719470921407, 'loss_val': 0.14864248265992164, 'psi': 0.9646161688753311}-{'f1_val': 0.9916548226418828, 'auprc': 0.998498095723397, 'loss_val': 0.03817061736774691, 'psi': 0.9943921318744884}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=41 head_norm_before_train=1.864661 cos_to_last_merge=0.8306 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.831
[S4] round=41 local utility u=0.000000 metrics={'f1_val': 0.9458558377257857, 'auprc': 0.9583367957641592, 'loss_val': 0.29229802247312947, 'psi': 0.9508482209411351}-{'f1_val': 0.9487697347946685, 'auprc': 0.9522551145109596, 'loss_val': 0.2873185192058622, 'psi': 0.950163886681185}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=41 head_norm_before_train=1.543272 cos_to_last_merge=0.9861 (last merge round=28)
[S5] round=41 local utility u=0.000000 metrics={'f1_val': 0.7088149153409077, 'auprc': 0.9735817635843209, 'loss_val': 0.3838748116007772, 'psi': 0.814721654638273}-{'f1_val': 0.996288981767675, 'auprc': 0.9920906383535735, 'loss_val': 0.10756686821504988, 'psi': 0.9946096444020344}
[S6] START round=41 head_norm_before_train=1.701280 cos_to_last_merge=0.9884 (last merge round=33)
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.603576214573131, 'auprc': 0.9429052266146937, 'loss_val': 0.8622854894364478, 'psi': 0.7393078193897561}-{'f1_val': 0.7225027094075922, 'auprc': 0.9622908967714803, 'loss_val': 0.5912424546119757, 'psi': 0.8184179843531474}
[S7] START round=41 head_norm_before_train=1.400487 cos_to_last_merge=0.9995 (last merge round=37)
[S7] round=41 local utility u=0.000000 metrics={'f1_val': 0.590992583336042, 'auprc': 0.7958126855389598, 'loss_val': 0.6813594567728836, 'psi': 0.6729206242172091}-{'f1_val': 0.6332437898869514, 'auprc': 0.799463727994301, 'loss_val': 0.5674869262054868, 'psi': 0.6997317651298913}
[S8] START round=41 head_norm_before_train=1.910221 cos_to_last_merge=0.9960 (last merge round=29)
[S8] round=41 local utility u=0.000000 metrics={'f1_val': 0.9915452129742699, 'auprc': 0.9988796396157335, 'loss_val': 0.035001547386856735, 'psi': 0.9944789836308553}-{'f1_val': 0.9931883555373179, 'auprc': 0.9986710324166056, 'loss_val': 0.03316336871502098, 'psi': 0.9953814262890329}
[S9] START round=41 head_norm_before_train=1.690516 cos_to_last_merge=0.6929 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.693
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.9951604951085576, 'auprc': 0.998448214649517, 'loss_val': 0.02518159857345427, 'psi': 0.9964755829249414}-{'f1_val': 0.9966605118138915, 'auprc': 0.9952291419666343, 'loss_val': 0.024184566354792502, 'psi': 0.9960879638749885}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=41 head_norm_before_train=1.599003 cos_to_last_merge=0.9957 (last merge round=35)
[S10] round=41 local utility u=0.000870 metrics={'f1_val': 0.9937871219080217, 'auprc': 0.994290613130819, 'loss_val': 0.03958520263963534, 'psi': 0.9939885183971406}-{'f1_val': 0.9937871219080217, 'auprc': 0.9941675959398615, 'loss_val': 0.04095683435522902, 'psi': 0.9939393115207577}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=41 head_norm_before_train=1.853624 cos_to_last_merge=0.9979 (last merge round=29)
[S11] round=41 local utility u=0.000000 metrics={'f1_val': 0.8859428814661973, 'auprc': 0.997827807583654, 'loss_val': 0.47912058714185585, 'psi': 0.93069685191318}-{'f1_val': 0.9958918378685807, 'auprc': 0.9972231189318812, 'loss_val': 0.023422169210740425, 'psi': 0.996424350293901}
[S13] START round=41 head_norm_before_train=1.384973 cos_to_last_merge=0.9950 (last merge round=34)
[S13] round=41 local utility u=0.163498 metrics={'f1_val': 0.6359342713515661, 'auprc': 0.7085074523868214, 'loss_val': 0.7997211771188932, 'psi': 0.6649635437656682}-{'f1_val': 0.6403204123946429, 'auprc': 0.6471876146387626, 'loss_val': 0.9690738533926494, 'psi': 0.6430672932922907}
[S14] START round=41 head_norm_before_train=1.502761 cos_to_last_merge=0.9963 (last merge round=34)
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.9969755000837764, 'auprc': 0.9986239729873525, 'loss_val': 0.04584932328139123, 'psi': 0.9976348892452068}-{'f1_val': 0.9974310505072961, 'auprc': 0.9986469360901167, 'loss_val': 0.047554558029665114, 'psi': 0.9979174047404243}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=41 head_norm_before_train=1.738135 cos_to_last_merge=0.9856 (last merge round=32)
[S15] round=41 local utility u=0.306864 metrics={'f1_val': 0.9971773386779533, 'auprc': 0.9988927130146874, 'loss_val': 0.01618678972140565, 'psi': 0.9978634884126469}-{'f1_val': 0.9121388526309179, 'auprc': 0.9991007280746107, 'loss_val': 0.1203074083105279, 'psi': 0.9469236028083949}
[S16] START round=41 head_norm_before_train=1.881644 cos_to_last_merge=0.7549 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.755
[S16] round=41 local utility u=0.046111 metrics={'f1_val': 0.9477611527065368, 'auprc': 0.9938628627025765, 'loss_val': 0.14526031460331118, 'psi': 0.9662018367049527}-{'f1_val': 0.9404740032005247, 'auprc': 0.993930845883696, 'loss_val': 0.19396391260976142, 'psi': 0.9618567402737932}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=41 head_norm_before_train=2.217980 (no previous merge yet)
[S17] round=41 local utility u=0.000000 metrics={'f1_val': 0.6573072206750357, 'auprc': 0.9576233458196366, 'loss_val': 1.11223158940096, 'psi': 0.7774336707328761}-{'f1_val': 0.9025593312831475, 'auprc': 0.9640084710991861, 'loss_val': 0.3917915770924355, 'psi': 0.9271389872095629}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] sending update (kind=head size=1805 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=42 head_norm_before_train=1.865165 cos_to_last_merge=0.9959 (last merge round=33)
[S2] round=42 local utility u=0.000000 metrics={'f1_val': 0.7218076952396743, 'auprc': 0.7727248971572043, 'loss_val': 0.8279592494912476, 'psi': 0.7421745760066862}-{'f1_val': 0.7140782604075677, 'auprc': 0.8302824472254773, 'loss_val': 0.6008396149248284, 'psi': 0.7605599351347315}
[S3] START round=42 head_norm_before_train=2.125286 (no previous merge yet)
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.9148290692213936, 'auprc': 0.9984503342090726, 'loss_val': 0.16412332367282248, 'psi': 0.9482775752164652}-{'f1_val': 0.9420456500641247, 'auprc': 0.9984719470921407, 'loss_val': 0.14864248265992164, 'psi': 0.9646161688753311}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=42 head_norm_before_train=1.877015 cos_to_last_merge=0.8295 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.829
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.9403584897643052, 'auprc': 0.918338989590487, 'loss_val': 0.3182475755986665, 'psi': 0.931550689694778}-{'f1_val': 0.9458558377257857, 'auprc': 0.9583367957641592, 'loss_val': 0.29229802247312947, 'psi': 0.9508482209411351}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=42 head_norm_before_train=1.554519 cos_to_last_merge=0.9849 (last merge round=28)
[S5] round=42 local utility u=1.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9919409552025042, 'loss_val': 0.10159173972224002, 'psi': 0.9945766692591358}-{'f1_val': 0.7088149153409077, 'auprc': 0.9735817635843209, 'loss_val': 0.3838748116007772, 'psi': 0.814721654638273}
[S6] START round=42 head_norm_before_train=1.725285 cos_to_last_merge=0.9866 (last merge round=33)
[S6] round=42 local utility u=1.000000 metrics={'f1_val': 0.8665666243359301, 'auprc': 0.9753218045382462, 'loss_val': 0.3255415481373515, 'psi': 0.9100686964168565}-{'f1_val': 0.603576214573131, 'auprc': 0.9429052266146937, 'loss_val': 0.8622854894364478, 'psi': 0.7393078193897561}
[S7] START round=42 head_norm_before_train=1.412894 cos_to_last_merge=0.9988 (last merge round=37)
[S7] round=42 local utility u=0.000176 metrics={'f1_val': 0.5918981550734872, 'auprc': 0.7978694833940068, 'loss_val': 0.6926122443359785, 'psi': 0.674286686401695}-{'f1_val': 0.590992583336042, 'auprc': 0.7958126855389598, 'loss_val': 0.6813594567728836, 'psi': 0.6729206242172091}
[S8] START round=42 head_norm_before_train=1.926028 cos_to_last_merge=0.9958 (last merge round=29)
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.9852247221213126, 'auprc': 0.9988136503952136, 'loss_val': 0.04533832610054979, 'psi': 0.990660293430873}-{'f1_val': 0.9915452129742699, 'auprc': 0.9988796396157335, 'loss_val': 0.035001547386856735, 'psi': 0.9944789836308553}
[S9] START round=42 head_norm_before_train=1.700324 cos_to_last_merge=0.6920 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.692
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.9934918488430377, 'auprc': 0.9984588503861642, 'loss_val': 0.027637483803394425, 'psi': 0.9954786494602883}-{'f1_val': 0.9951604951085576, 'auprc': 0.998448214649517, 'loss_val': 0.02518159857345427, 'psi': 0.9964755829249414}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=42 head_norm_before_train=1.625280 cos_to_last_merge=0.9946 (last merge round=35)
[S10] round=42 local utility u=0.000515 metrics={'f1_val': 0.9937871219080217, 'auprc': 0.9940795436246275, 'loss_val': 0.037922590492671854, 'psi': 0.993904090594664}-{'f1_val': 0.9937871219080217, 'auprc': 0.994290613130819, 'loss_val': 0.03958520263963534, 'psi': 0.9939885183971406}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=42 head_norm_before_train=1.859634 cos_to_last_merge=0.9977 (last merge round=29)
[S11] round=42 local utility u=0.557741 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9968255835878744, 'loss_val': 0.022805318292693465, 'psi': 0.9965133339164663}-{'f1_val': 0.8859428814661973, 'auprc': 0.997827807583654, 'loss_val': 0.47912058714185585, 'psi': 0.93069685191318}
[S13] START round=42 head_norm_before_train=1.397395 cos_to_last_merge=0.9940 (last merge round=34)
[S13] round=42 local utility u=0.000000 metrics={'f1_val': 0.6184322952521727, 'auprc': 0.6502174973944007, 'loss_val': 0.8943098353051403, 'psi': 0.6311463761090639}-{'f1_val': 0.6359342713515661, 'auprc': 0.7085074523868214, 'loss_val': 0.7997211771188932, 'psi': 0.6649635437656682}
[S14] START round=42 head_norm_before_train=1.521789 cos_to_last_merge=0.9954 (last merge round=34)
[S14] round=42 local utility u=0.000000 metrics={'f1_val': 0.9953287081621296, 'auprc': 0.9986485621279317, 'loss_val': 0.047626147305983337, 'psi': 0.9966566497484505}-{'f1_val': 0.9969755000837764, 'auprc': 0.9986239729873525, 'loss_val': 0.04584932328139123, 'psi': 0.9976348892452068}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=42 head_norm_before_train=1.760015 cos_to_last_merge=0.9844 (last merge round=32)
[S15] round=42 local utility u=0.000000 metrics={'f1_val': 0.899140743927745, 'auprc': 0.9948093994643931, 'loss_val': 0.3213577061655061, 'psi': 0.9374082061424042}-{'f1_val': 0.9971773386779533, 'auprc': 0.9988927130146874, 'loss_val': 0.01618678972140565, 'psi': 0.9978634884126469}
[S16] START round=42 head_norm_before_train=1.889627 cos_to_last_merge=0.7545 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.754
[S16] round=42 local utility u=0.000000 metrics={'f1_val': 0.9371410966340504, 'auprc': 0.9923194615875265, 'loss_val': 0.2959976907346558, 'psi': 0.9592124426154409}-{'f1_val': 0.9477611527065368, 'auprc': 0.9938628627025765, 'loss_val': 0.14526031460331118, 'psi': 0.9662018367049527}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=42 head_norm_before_train=2.226608 (no previous merge yet)
[S17] round=42 local utility u=0.192948 metrics={'f1_val': 0.7032719357862149, 'auprc': 0.9634497587136477, 'loss_val': 1.0196033375883582, 'psi': 0.807343064957188}-{'f1_val': 0.6573072206750357, 'auprc': 0.9576233458196366, 'loss_val': 1.11223158940096, 'psi': 0.7774336707328761}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] sending update (kind=head size=1794 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=43 head_norm_before_train=1.878599 cos_to_last_merge=0.9953 (last merge round=33)
[S2] round=43 local utility u=0.382412 metrics={'f1_val': 0.7060909328911904, 'auprc': 0.9285684612931595, 'loss_val': 0.43636623733352387, 'psi': 0.7950819442519781}-{'f1_val': 0.7218076952396743, 'auprc': 0.7727248971572043, 'loss_val': 0.8279592494912476, 'psi': 0.7421745760066862}
[S3] START round=43 head_norm_before_train=2.135573 (no previous merge yet)
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.9001110128490581, 'auprc': 0.9984356059819781, 'loss_val': 0.23017004032911578, 'psi': 0.9394408501022261}-{'f1_val': 0.9148290692213936, 'auprc': 0.9984503342090726, 'loss_val': 0.16412332367282248, 'psi': 0.9482775752164652}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=43 head_norm_before_train=1.885106 cos_to_last_merge=0.8287 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.829
[S4] round=43 local utility u=0.027568 metrics={'f1_val': 0.9437836902700842, 'auprc': 0.9280636854385241, 'loss_val': 0.31283706283380325, 'psi': 0.9374956883374601}-{'f1_val': 0.9403584897643052, 'auprc': 0.918338989590487, 'loss_val': 0.3182475755986665, 'psi': 0.931550689694778}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=43 head_norm_before_train=1.564341 cos_to_last_merge=0.9839 (last merge round=28)
[S5] round=43 local utility u=0.008714 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9921876385627629, 'loss_val': 0.0849046293706076, 'psi': 0.9946753426032393}-{'f1_val': 0.9963338119635569, 'auprc': 0.9919409552025042, 'loss_val': 0.10159173972224002, 'psi': 0.9945766692591358}
[S6] START round=43 head_norm_before_train=1.740810 cos_to_last_merge=0.9852 (last merge round=33)
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.609860723763225, 'auprc': 0.9514570327104545, 'loss_val': 0.9211288107790208, 'psi': 0.7464992473421168}-{'f1_val': 0.8665666243359301, 'auprc': 0.9753218045382462, 'loss_val': 0.3255415481373515, 'psi': 0.9100686964168565}
[S7] START round=43 head_norm_before_train=1.425416 cos_to_last_merge=0.9981 (last merge round=37)
[S7] round=43 local utility u=0.000000 metrics={'f1_val': 0.5742235670028573, 'auprc': 0.7912568321569262, 'loss_val': 0.7009391934542817, 'psi': 0.6610368730644849}-{'f1_val': 0.5918981550734872, 'auprc': 0.7978694833940068, 'loss_val': 0.6926122443359785, 'psi': 0.674286686401695}
[S8] START round=43 head_norm_before_train=1.939592 cos_to_last_merge=0.9956 (last merge round=29)
[S8] round=43 local utility u=0.016942 metrics={'f1_val': 0.9920648610389395, 'auprc': 0.9930684306955576, 'loss_val': 0.035260007655267885, 'psi': 0.9924662889015867}-{'f1_val': 0.9852247221213126, 'auprc': 0.9988136503952136, 'loss_val': 0.04533832610054979, 'psi': 0.990660293430873}
[S9] START round=43 head_norm_before_train=1.708469 cos_to_last_merge=0.6912 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.691
[S9] round=43 local utility u=0.003615 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9936576039118424, 'loss_val': 0.025015480068279545, 'psi': 0.9954593486530718}-{'f1_val': 0.9934918488430377, 'auprc': 0.9984588503861642, 'loss_val': 0.027637483803394425, 'psi': 0.9954786494602883}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=43 head_norm_before_train=1.646430 cos_to_last_merge=0.9936 (last merge round=35)
[S10] round=43 local utility u=0.000524 metrics={'f1_val': 0.9937871219080217, 'auprc': 0.994155016294656, 'loss_val': 0.03710039072306988, 'psi': 0.9939342796626754}-{'f1_val': 0.9937871219080217, 'auprc': 0.9940795436246275, 'loss_val': 0.037922590492671854, 'psi': 0.993904090594664}
[S10] not sending this round → trigger blocked (psi=0.994)
[S11] START round=43 head_norm_before_train=1.864701 cos_to_last_merge=0.9976 (last merge round=29)
[S11] round=43 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9969737193470665, 'loss_val': 0.028347505819571652, 'psi': 0.9964696926868122}-{'f1_val': 0.996305167468861, 'auprc': 0.9968255835878744, 'loss_val': 0.022805318292693465, 'psi': 0.9965133339164663}
[S13] START round=43 head_norm_before_train=1.410116 cos_to_last_merge=0.9930 (last merge round=34)
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.5889486989540972, 'auprc': 0.6023957386481633, 'loss_val': 1.1103258529712803, 'psi': 0.5943275148317236}-{'f1_val': 0.6184322952521727, 'auprc': 0.6502174973944007, 'loss_val': 0.8943098353051403, 'psi': 0.6311463761090639}
[S14] START round=43 head_norm_before_train=1.538948 cos_to_last_merge=0.9945 (last merge round=34)
[S14] round=43 local utility u=0.000197 metrics={'f1_val': 0.9950858601261725, 'auprc': 0.9987069377132354, 'loss_val': 0.04595093555833325, 'psi': 0.9965342911609977}-{'f1_val': 0.9953287081621296, 'auprc': 0.9986485621279317, 'loss_val': 0.047626147305983337, 'psi': 0.9966566497484505}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] START round=43 head_norm_before_train=1.780801 cos_to_last_merge=0.9833 (last merge round=32)
[S15] round=43 local utility u=0.453450 metrics={'f1_val': 0.9971773386779533, 'auprc': 0.9992869562069077, 'loss_val': 0.016110067893055576, 'psi': 0.9980211856895351}-{'f1_val': 0.899140743927745, 'auprc': 0.9948093994643931, 'loss_val': 0.3213577061655061, 'psi': 0.9374082061424042}
[S16] START round=43 head_norm_before_train=1.894838 cos_to_last_merge=0.7542 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.754
[S16] round=43 local utility u=0.000000 metrics={'f1_val': 0.924640601258246, 'auprc': 0.9913914431135434, 'loss_val': 0.38075599271581384, 'psi': 0.9513409380003649}-{'f1_val': 0.9371410966340504, 'auprc': 0.9923194615875265, 'loss_val': 0.2959976907346558, 'psi': 0.9592124426154409}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=43 head_norm_before_train=2.235887 (no previous merge yet)
[S17] round=43 local utility u=0.000000 metrics={'f1_val': 0.6730877657226946, 'auprc': 0.9691010638391173, 'loss_val': 1.1141769503476033, 'psi': 0.7914930849692636}-{'f1_val': 0.7032719357862149, 'auprc': 0.9634497587136477, 'loss_val': 1.0196033375883582, 'psi': 0.807343064957188}
[S7]  timeout peer S13
[S5]  timeout peer S3
[S2]  timeout peer S6
[S17]  timeout peer S8
[S6]  timeout peer S7
[S11]  timeout peer S2
[S8]  timeout peer S5
[S8]  timeout peer S17
[S13]  timeout peer S10
[S15]  timeout peer S14
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S5] not sending this round → trigger blocked (psi=0.995)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S2] START round=44 head_norm_before_train=1.890436 cos_to_last_merge=0.9948 (last merge round=33)
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.7151357635392511, 'auprc': 0.9061633438569155, 'loss_val': 0.4692696875912033, 'psi': 0.7915467956663169}-{'f1_val': 0.7060909328911904, 'auprc': 0.9285684612931595, 'loss_val': 0.43636623733352387, 'psi': 0.7950819442519781}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=44 head_norm_before_train=2.145947 (no previous merge yet)
[S3] round=44 local utility u=0.000000 metrics={'f1_val': 0.7378323325934444, 'auprc': 0.9985706250307944, 'loss_val': 0.5931449562303251, 'psi': 0.8421276495683845}-{'f1_val': 0.9001110128490581, 'auprc': 0.9984356059819781, 'loss_val': 0.23017004032911578, 'psi': 0.9394408501022261}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=44 head_norm_before_train=1.876110 cos_to_last_merge=0.8283 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.828
[S4] round=44 local utility u=0.039169 metrics={'f1_val': 0.9545979430543338, 'auprc': 0.9278411738657141, 'loss_val': 0.2987174670962493, 'psi': 0.9438952353788859}-{'f1_val': 0.9437836902700842, 'auprc': 0.9280636854385241, 'loss_val': 0.31283706283380325, 'psi': 0.9374956883374601}
[S4] not sending this round → trigger blocked (psi=0.944)
[S5] START round=44 head_norm_before_train=1.580575 cos_to_last_merge=0.9822 (last merge round=28)
[S5] round=44 local utility u=0.000000 metrics={'f1_val': 0.7058236088935177, 'auprc': 0.9891908316101692, 'loss_val': 0.2743225235881265, 'psi': 0.8191704979801784}-{'f1_val': 0.9963338119635569, 'auprc': 0.9921876385627629, 'loss_val': 0.0849046293706076, 'psi': 0.9946753426032393}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=44 head_norm_before_train=1.747190 cos_to_last_merge=0.9845 (last merge round=33)
[S6] round=44 local utility u=0.126145 metrics={'f1_val': 0.6279030189280708, 'auprc': 0.9578065600929444, 'loss_val': 0.7961415487075004, 'psi': 0.7598644353940203}-{'f1_val': 0.609860723763225, 'auprc': 0.9514570327104545, 'loss_val': 0.9211288107790208, 'psi': 0.7464992473421168}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=44 head_norm_before_train=1.435909 cos_to_last_merge=0.9975 (last merge round=37)
[S7] round=44 local utility u=0.755200 metrics={'f1_val': 0.6970013539174301, 'auprc': 0.9108294785907212, 'loss_val': 0.28592317880910284, 'psi': 0.7825326037867466}-{'f1_val': 0.5742235670028573, 'auprc': 0.7912568321569262, 'loss_val': 0.7009391934542817, 'psi': 0.6610368730644849}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=44 head_norm_before_train=1.955136 cos_to_last_merge=0.9954 (last merge round=29)
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.9777664913679451, 'auprc': 0.9988822927415254, 'loss_val': 0.05496087824101116, 'psi': 0.9862128119173772}-{'f1_val': 0.9920648610389395, 'auprc': 0.9930684306955576, 'loss_val': 0.035260007655267885, 'psi': 0.9924662889015867}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=44 head_norm_before_train=1.717670 cos_to_last_merge=0.6901 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.690
[S9] round=44 local utility u=0.005127 metrics={'f1_val': 0.9955763922175147, 'auprc': 0.9984489862729854, 'loss_val': 0.022631752811466514, 'psi': 0.996725429839703}-{'f1_val': 0.9966605118138915, 'auprc': 0.9936576039118424, 'loss_val': 0.025015480068279545, 'psi': 0.9954593486530718}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S9] sending update (kind=head size=1791 to 1 peers)
[S10] START round=44 head_norm_before_train=1.666373 cos_to_last_merge=0.9926 (last merge round=35)
[S10] round=44 local utility u=0.001115 metrics={'f1_val': 0.9940063275949004, 'auprc': 0.9940906869218713, 'loss_val': 0.035992772531352274, 'psi': 0.9940400713256887}-{'f1_val': 0.9937871219080217, 'auprc': 0.994155016294656, 'loss_val': 0.03710039072306988, 'psi': 0.9939342796626754}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] sending update (kind=head size=1805 to 1 peers)
[S11] START round=44 head_norm_before_train=1.869458 cos_to_last_merge=0.9975 (last merge round=29)
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.8788304955777642, 'auprc': 0.9968571380910543, 'loss_val': 0.13330515713236163, 'psi': 0.9260411525830802}-{'f1_val': 0.9961336749133093, 'auprc': 0.9969737193470665, 'loss_val': 0.028347505819571652, 'psi': 0.9964696926868122}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=44 head_norm_before_train=1.416616 cos_to_last_merge=0.9923 (last merge round=34)
[S13] round=44 local utility u=0.439549 metrics={'f1_val': 0.6429651338378352, 'auprc': 0.674489911752908, 'loss_val': 0.7716096834256795, 'psi': 0.6555750450038642}-{'f1_val': 0.5889486989540972, 'auprc': 0.6023957386481633, 'loss_val': 1.1103258529712803, 'psi': 0.5943275148317236}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=44 head_norm_before_train=1.554789 cos_to_last_merge=0.9936 (last merge round=34)
[S14] round=44 local utility u=0.007156 metrics={'f1_val': 0.9965536345053762, 'auprc': 0.9987142930282308, 'loss_val': 0.04046740011436659, 'psi': 0.997417897914518}-{'f1_val': 0.9950858601261725, 'auprc': 0.9987069377132354, 'loss_val': 0.04595093555833325, 'psi': 0.9965342911609977}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=44 head_norm_before_train=1.799074 cos_to_last_merge=0.9823 (last merge round=32)
[S15] round=44 local utility u=0.000000 metrics={'f1_val': 0.9040289668162744, 'auprc': 0.9979803889263579, 'loss_val': 0.21974162351055823, 'psi': 0.9416095356603078}-{'f1_val': 0.9971773386779533, 'auprc': 0.9992869562069077, 'loss_val': 0.016110067893055576, 'psi': 0.9980211856895351}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=44 head_norm_before_train=1.902568 cos_to_last_merge=0.7537 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.754
[S16] round=44 local utility u=0.000000 metrics={'f1_val': 0.8477105002158697, 'auprc': 0.8940143893750121, 'loss_val': 0.9424274335293202, 'psi': 0.8662320558795267}-{'f1_val': 0.924640601258246, 'auprc': 0.9913914431135434, 'loss_val': 0.38075599271581384, 'psi': 0.9513409380003649}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=44 head_norm_before_train=2.248806 (no previous merge yet)
[S17] round=44 local utility u=0.994836 metrics={'f1_val': 0.8936472196755878, 'auprc': 0.9480380220406701, 'loss_val': 0.3846729127764789, 'psi': 0.9154035406216208}-{'f1_val': 0.6730877657226946, 'auprc': 0.9691010638391173, 'loss_val': 1.1141769503476033, 'psi': 0.7914930849692636}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=45 head_norm_before_train=1.899949 cos_to_last_merge=0.9943 (last merge round=33)
[S2] round=45 local utility u=0.090870 metrics={'f1_val': 0.8159190324163271, 'auprc': 0.8081415602340174, 'loss_val': 0.5981633065784874, 'psi': 0.8128080435434033}-{'f1_val': 0.7151357635392511, 'auprc': 0.9061633438569155, 'loss_val': 0.4692696875912033, 'psi': 0.7915467956663169}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=45 head_norm_before_train=2.155378 (no previous merge yet)
[S3] round=45 local utility u=0.896173 metrics={'f1_val': 0.9537526919724539, 'auprc': 0.9984597322661843, 'loss_val': 0.09598843062973082, 'psi': 0.9716355080899461}-{'f1_val': 0.7378323325934444, 'auprc': 0.9985706250307944, 'loss_val': 0.5931449562303251, 'psi': 0.8421276495683845}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] sending update (kind=head size=1793 to 1 peers)
[S4] START round=45 head_norm_before_train=1.866307 cos_to_last_merge=0.8281 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.828
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.9538568526211421, 'auprc': 0.9139696297971749, 'loss_val': 0.28617734609452417, 'psi': 0.9379019634915552}-{'f1_val': 0.9545979430543338, 'auprc': 0.9278411738657141, 'loss_val': 0.2987174670962493, 'psi': 0.9438952353788859}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=45 head_norm_before_train=1.603593 cos_to_last_merge=0.9798 (last merge round=28)
[S5] round=45 local utility u=0.971197 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9919130155918436, 'loss_val': 0.08315688777068589, 'psi': 0.9945654934148715}-{'f1_val': 0.7058236088935177, 'auprc': 0.9891908316101692, 'loss_val': 0.2743225235881265, 'psi': 0.8191704979801784}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S5] sending update (kind=head size=1790 to 1 peers)
[S6] START round=45 head_norm_before_train=1.748129 cos_to_last_merge=0.9835 (last merge round=33)
[S6] round=45 local utility u=0.496307 metrics={'f1_val': 0.7426232979622526, 'auprc': 0.9714923207026327, 'loss_val': 0.5329063645767123, 'psi': 0.8341709070584047}-{'f1_val': 0.6279030189280708, 'auprc': 0.9578065600929444, 'loss_val': 0.7961415487075004, 'psi': 0.7598644353940203}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S6] sending update (kind=head size=1808 to 1 peers)
[S7] START round=45 head_norm_before_train=1.448097 cos_to_last_merge=0.9966 (last merge round=37)
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.4967475668627779, 'auprc': 0.7818484780584676, 'loss_val': 1.0863341785019216, 'psi': 0.6107879313410538}-{'f1_val': 0.6970013539174301, 'auprc': 0.9108294785907212, 'loss_val': 0.28592317880910284, 'psi': 0.7825326037867466}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=45 head_norm_before_train=1.970239 cos_to_last_merge=0.9951 (last merge round=29)
[S8] round=45 local utility u=0.057953 metrics={'f1_val': 0.9931883555373179, 'auprc': 0.9985749775695738, 'loss_val': 0.030664241368562134, 'psi': 0.9953430043502203}-{'f1_val': 0.9777664913679451, 'auprc': 0.9988822927415254, 'loss_val': 0.05496087824101116, 'psi': 0.9862128119173772}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=45 head_norm_before_train=1.727927 cos_to_last_merge=0.6889 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.689
[S9] round=45 local utility u=0.002934 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9984594771375415, 'loss_val': 0.021798481202517997, 'psi': 0.9972299022553491}-{'f1_val': 0.9955763922175147, 'auprc': 0.9984489862729854, 'loss_val': 0.022631752811466514, 'psi': 0.996725429839703}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=45 head_norm_before_train=1.683468 cos_to_last_merge=0.9918 (last merge round=35)
[S10] round=45 local utility u=0.000386 metrics={'f1_val': 0.9940063275949004, 'auprc': 0.994128904999388, 'loss_val': 0.03533510721502548, 'psi': 0.9940553585566954}-{'f1_val': 0.9940063275949004, 'auprc': 0.9940906869218713, 'loss_val': 0.035992772531352274, 'psi': 0.9940400713256887}
[S10] not sending this round → trigger blocked (psi=0.994)
[S11] START round=45 head_norm_before_train=1.875313 cos_to_last_merge=0.9973 (last merge round=29)
[S11] round=45 local utility u=0.408421 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9970879936738062, 'loss_val': 0.020974264216878254, 'psi': 0.996515402417508}-{'f1_val': 0.8788304955777642, 'auprc': 0.9968571380910543, 'loss_val': 0.13330515713236163, 'psi': 0.9260411525830802}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=45 head_norm_before_train=1.426008 cos_to_last_merge=0.9912 (last merge round=34)
[S13] round=45 local utility u=0.116268 metrics={'f1_val': 0.6943486232926521, 'auprc': 0.689302080465144, 'loss_val': 0.8918116763625459, 'psi': 0.6923300061616489}-{'f1_val': 0.6429651338378352, 'auprc': 0.674489911752908, 'loss_val': 0.7716096834256795, 'psi': 0.6555750450038642}
[S13] not sending this round → trigger blocked (psi=0.692)
[S14] START round=45 head_norm_before_train=1.569411 cos_to_last_merge=0.9927 (last merge round=34)
[S14] round=45 local utility u=0.004471 metrics={'f1_val': 0.9973833833620065, 'auprc': 0.9986394497583428, 'loss_val': 0.036279845603099915, 'psi': 0.997885809920541}-{'f1_val': 0.9965536345053762, 'auprc': 0.9987142930282308, 'loss_val': 0.04046740011436659, 'psi': 0.997417897914518}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=45 head_norm_before_train=1.815279 cos_to_last_merge=0.9815 (last merge round=32)
[S15] round=45 local utility u=0.000000 metrics={'f1_val': 0.9025825386509887, 'auprc': 0.9942546467271991, 'loss_val': 0.29433715708513575, 'psi': 0.939251381881473}-{'f1_val': 0.9040289668162744, 'auprc': 0.9979803889263579, 'loss_val': 0.21974162351055823, 'psi': 0.9416095356603078}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=45 head_norm_before_train=1.911323 cos_to_last_merge=0.7532 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.753
[S16] round=45 local utility u=0.714517 metrics={'f1_val': 0.9376387976307354, 'auprc': 0.9848594393368412, 'loss_val': 0.3254991773656551, 'psi': 0.9565270543131777}-{'f1_val': 0.8477105002158697, 'auprc': 0.8940143893750121, 'loss_val': 0.9424274335293202, 'psi': 0.8662320558795267}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=45 head_norm_before_train=2.259315 (no previous merge yet)
[S17] round=45 local utility u=0.000000 metrics={'f1_val': 0.5909518767935366, 'auprc': 0.8588835406784503, 'loss_val': 1.532428459954069, 'psi': 0.698124542347502}-{'f1_val': 0.8936472196755878, 'auprc': 0.9480380220406701, 'loss_val': 0.3846729127764789, 'psi': 0.9154035406216208}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=46 head_norm_before_train=1.907038 cos_to_last_merge=0.9941 (last merge round=33)
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.7131372113436893, 'auprc': 0.8685391531334231, 'loss_val': 0.5410288043916643, 'psi': 0.7752979880595828}-{'f1_val': 0.8159190324163271, 'auprc': 0.8081415602340174, 'loss_val': 0.5981633065784874, 'psi': 0.8128080435434033}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=46 head_norm_before_train=2.165404 (no previous merge yet)
[S3] round=46 local utility u=0.000000 metrics={'f1_val': 0.9499648319315751, 'auprc': 0.9986116998069776, 'loss_val': 0.09632245364344812, 'psi': 0.9694235790817362}-{'f1_val': 0.9537526919724539, 'auprc': 0.9984597322661843, 'loss_val': 0.09598843062973082, 'psi': 0.9716355080899461}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=46 head_norm_before_train=1.860365 cos_to_last_merge=0.8280 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.828
[S4] round=46 local utility u=0.026645 metrics={'f1_val': 0.9581689327413658, 'auprc': 0.9213033532106676, 'loss_val': 0.2807604008347026, 'psi': 0.9434227009290865}-{'f1_val': 0.9538568526211421, 'auprc': 0.9139696297971749, 'loss_val': 0.28617734609452417, 'psi': 0.9379019634915552}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] sending update (kind=head size=1805 to 1 peers)
[S5] START round=46 head_norm_before_train=1.621597 cos_to_last_merge=0.9779 (last merge round=28)
[S5] round=46 local utility u=0.000000 metrics={'f1_val': 0.9806436288119422, 'auprc': 0.9900720080882178, 'loss_val': 0.0964308490846263, 'psi': 0.9844149805224525}-{'f1_val': 0.9963338119635569, 'auprc': 0.9919130155918436, 'loss_val': 0.08315688777068589, 'psi': 0.9945654934148715}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=46 head_norm_before_train=1.756920 cos_to_last_merge=0.9824 (last merge round=33)
[S6] round=46 local utility u=0.223579 metrics={'f1_val': 0.8193321374522613, 'auprc': 0.9615502657474924, 'loss_val': 0.5161745649769289, 'psi': 0.8762193887703538}-{'f1_val': 0.7426232979622526, 'auprc': 0.9714923207026327, 'loss_val': 0.5329063645767123, 'psi': 0.8341709070584047}
[S6] not sending this round → trigger blocked (psi=0.876)
[S7] START round=46 head_norm_before_train=1.456709 cos_to_last_merge=0.9959 (last merge round=37)
[S7] round=46 local utility u=0.903861 metrics={'f1_val': 0.6661112305835314, 'auprc': 0.8372767108333807, 'loss_val': 0.4610792753104689, 'psi': 0.7345774226834711}-{'f1_val': 0.4967475668627779, 'auprc': 0.7818484780584676, 'loss_val': 1.0863341785019216, 'psi': 0.6107879313410538}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=46 head_norm_before_train=1.985412 cos_to_last_merge=0.9948 (last merge round=29)
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.963376721808572, 'auprc': 0.9982408463089564, 'loss_val': 0.10077891670479022, 'psi': 0.9773223716087258}-{'f1_val': 0.9931883555373179, 'auprc': 0.9985749775695738, 'loss_val': 0.030664241368562134, 'psi': 0.9953430043502203}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=46 head_norm_before_train=1.737166 cos_to_last_merge=0.6877 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.688
[S9] round=46 local utility u=0.000279 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9984591018126325, 'loss_val': 0.021239776706549463, 'psi': 0.9972297521253856}-{'f1_val': 0.9964101856672208, 'auprc': 0.9984594771375415, 'loss_val': 0.021798481202517997, 'psi': 0.9972299022553491}
[S9] not sending this round → trigger blocked (psi=0.997)
[S10] START round=46 head_norm_before_train=1.699957 cos_to_last_merge=0.9909 (last merge round=35)
[S10] round=46 local utility u=0.000280 metrics={'f1_val': 0.9940063275949004, 'auprc': 0.9941303575882553, 'loss_val': 0.034779154041296154, 'psi': 0.9940559395922424}-{'f1_val': 0.9940063275949004, 'auprc': 0.994128904999388, 'loss_val': 0.03533510721502548, 'psi': 0.9940553585566954}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] sending update (kind=head size=1804 to 1 peers)
[S11] START round=46 head_norm_before_train=1.883057 cos_to_last_merge=0.9971 (last merge round=29)
[S11] round=46 local utility u=0.001891 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.997378134706449, 'loss_val': 0.02068824469836927, 'psi': 0.9968940027498543}-{'f1_val': 0.9961336749133093, 'auprc': 0.9970879936738062, 'loss_val': 0.020974264216878254, 'psi': 0.996515402417508}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=46 head_norm_before_train=1.434508 cos_to_last_merge=0.9904 (last merge round=34)
[S13] round=46 local utility u=0.230708 metrics={'f1_val': 0.6858704251737366, 'auprc': 0.7588063285214756, 'loss_val': 0.5880394482664569, 'psi': 0.7150447865128322}-{'f1_val': 0.6943486232926521, 'auprc': 0.689302080465144, 'loss_val': 0.8918116763625459, 'psi': 0.6923300061616489}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=46 head_norm_before_train=1.583893 cos_to_last_merge=0.9918 (last merge round=34)
[S14] round=46 local utility u=0.000415 metrics={'f1_val': 0.9969949189805283, 'auprc': 0.9986149210372106, 'loss_val': 0.03304582675065885, 'psi': 0.9976429198032013}-{'f1_val': 0.9973833833620065, 'auprc': 0.9986394497583428, 'loss_val': 0.036279845603099915, 'psi': 0.997885809920541}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] START round=46 head_norm_before_train=1.830418 cos_to_last_merge=0.9807 (last merge round=32)
[S15] round=46 local utility u=0.429536 metrics={'f1_val': 0.9971773386779533, 'auprc': 0.9988293678225711, 'loss_val': 0.0165588011965886, 'psi': 0.9978381503358005}-{'f1_val': 0.9025825386509887, 'auprc': 0.9942546467271991, 'loss_val': 0.29433715708513575, 'psi': 0.939251381881473}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=46 head_norm_before_train=1.920172 cos_to_last_merge=0.7527 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.753
[S16] round=46 local utility u=0.290145 metrics={'f1_val': 0.9882256957949537, 'auprc': 0.9910076566043936, 'loss_val': 0.0671745844049109, 'psi': 0.9893384801187297}-{'f1_val': 0.9376387976307354, 'auprc': 0.9848594393368412, 'loss_val': 0.3254991773656551, 'psi': 0.9565270543131777}
[S16] not sending this round → trigger blocked (psi=0.989)
[S17] START round=46 head_norm_before_train=2.261953 (no previous merge yet)
[S17] round=46 local utility u=1.000000 metrics={'f1_val': 0.8870582479854314, 'auprc': 0.9915145341079014, 'loss_val': 0.4546564456043848, 'psi': 0.9288407624344195}-{'f1_val': 0.5909518767935366, 'auprc': 0.8588835406784503, 'loss_val': 1.532428459954069, 'psi': 0.698124542347502}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S2] START round=47 head_norm_before_train=1.914846 cos_to_last_merge=0.9937 (last merge round=33)
[S2] round=47 local utility u=0.024918 metrics={'f1_val': 0.7039672587393446, 'auprc': 0.9032993880083612, 'loss_val': 0.5404538432650504, 'psi': 0.7837001104469512}-{'f1_val': 0.7131372113436893, 'auprc': 0.8685391531334231, 'loss_val': 0.5410288043916643, 'psi': 0.7752979880595828}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] sending update (kind=head size=1794 to 1 peers)
[S3] START round=47 head_norm_before_train=2.175036 (no previous merge yet)
[S3] round=47 local utility u=0.018322 metrics={'f1_val': 0.9608296089712303, 'auprc': 0.9984826883749225, 'loss_val': 0.12447971309114418, 'psi': 0.9758908407327072}-{'f1_val': 0.9499648319315751, 'auprc': 0.9986116998069776, 'loss_val': 0.09632245364344812, 'psi': 0.9694235790817362}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=47 head_norm_before_train=1.866079 cos_to_last_merge=0.8274 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.827
[S4] round=47 local utility u=0.000000 metrics={'f1_val': 0.9447980203404135, 'auprc': 0.9004926912027666, 'loss_val': 0.30048722113480086, 'psi': 0.9270758886853547}-{'f1_val': 0.9581689327413658, 'auprc': 0.9213033532106676, 'loss_val': 0.2807604008347026, 'psi': 0.9434227009290865}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=47 head_norm_before_train=1.636375 cos_to_last_merge=0.9764 (last merge round=28)
[S5] round=47 local utility u=0.059976 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9913195888659837, 'loss_val': 0.07436318408429375, 'psi': 0.9943281227245275}-{'f1_val': 0.9806436288119422, 'auprc': 0.9900720080882178, 'loss_val': 0.0964308490846263, 'psi': 0.9844149805224525}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=47 head_norm_before_train=1.770387 cos_to_last_merge=0.9812 (last merge round=33)
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.6090573938034443, 'auprc': 0.9552892773691679, 'loss_val': 0.769755794759, 'psi': 0.7475501472297337}-{'f1_val': 0.8193321374522613, 'auprc': 0.9615502657474924, 'loss_val': 0.5161745649769289, 'psi': 0.8762193887703538}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=47 head_norm_before_train=1.461707 cos_to_last_merge=0.9955 (last merge round=37)
[S7] round=47 local utility u=0.000000 metrics={'f1_val': 0.547855946795137, 'auprc': 0.7880202406256374, 'loss_val': 0.884642465273108, 'psi': 0.6439216643273372}-{'f1_val': 0.6661112305835314, 'auprc': 0.8372767108333807, 'loss_val': 0.4610792753104689, 'psi': 0.7345774226834711}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=47 head_norm_before_train=1.993025 cos_to_last_merge=0.9945 (last merge round=29)
[S8] round=47 local utility u=0.125346 metrics={'f1_val': 0.9930017911527874, 'auprc': 0.9988279830708944, 'loss_val': 0.029597825552342683, 'psi': 0.9953322679200303}-{'f1_val': 0.963376721808572, 'auprc': 0.9982408463089564, 'loss_val': 0.10077891670479022, 'psi': 0.9773223716087258}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=47 head_norm_before_train=1.746612 cos_to_last_merge=0.6865 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.687
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.995215024219804, 'loss_val': 0.021875419317664298, 'psi': 0.9960823167762565}-{'f1_val': 0.9964101856672208, 'auprc': 0.9984591018126325, 'loss_val': 0.021239776706549463, 'psi': 0.9972297521253856}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=47 head_norm_before_train=1.716518 cos_to_last_merge=0.9900 (last merge round=35)
[S10] round=47 local utility u=0.000318 metrics={'f1_val': 0.9940063275949004, 'auprc': 0.994244287741608, 'loss_val': 0.03448544540121661, 'psi': 0.9941015116535834}-{'f1_val': 0.9940063275949004, 'auprc': 0.9941303575882553, 'loss_val': 0.034779154041296154, 'psi': 0.9940559395922424}
[S10] not sending this round → trigger blocked (psi=0.994)
[S11] START round=47 head_norm_before_train=1.888836 cos_to_last_merge=0.9969 (last merge round=29)
[S11] round=47 local utility u=0.000000 metrics={'f1_val': 0.9835920561903134, 'auprc': 0.9969666071751313, 'loss_val': 0.08402858261432868, 'psi': 0.9889418765842406}-{'f1_val': 0.9965712481121245, 'auprc': 0.997378134706449, 'loss_val': 0.02068824469836927, 'psi': 0.9968940027498543}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=47 head_norm_before_train=1.442602 cos_to_last_merge=0.9897 (last merge round=34)
[S13] round=47 local utility u=0.000000 metrics={'f1_val': 0.6439444846035445, 'auprc': 0.7282322889407251, 'loss_val': 0.8426105557453805, 'psi': 0.6776596063384167}-{'f1_val': 0.6858704251737366, 'auprc': 0.7588063285214756, 'loss_val': 0.5880394482664569, 'psi': 0.7150447865128322}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=47 head_norm_before_train=1.598495 cos_to_last_merge=0.9909 (last merge round=34)
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.9961612027526012, 'auprc': 0.9986194502497189, 'loss_val': 0.03255490950443498, 'psi': 0.9971445017514483}-{'f1_val': 0.9969949189805283, 'auprc': 0.9986149210372106, 'loss_val': 0.03304582675065885, 'psi': 0.9976429198032013}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=47 head_norm_before_train=1.845373 cos_to_last_merge=0.9799 (last merge round=32)
[S15] round=47 local utility u=0.000000 metrics={'f1_val': 0.941969230596766, 'auprc': 0.9994126151999534, 'loss_val': 0.08235171002788118, 'psi': 0.9649465844380409}-{'f1_val': 0.9971773386779533, 'auprc': 0.9988293678225711, 'loss_val': 0.0165588011965886, 'psi': 0.9978381503358005}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=47 head_norm_before_train=1.929387 cos_to_last_merge=0.7522 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.752
[S16] round=47 local utility u=0.025821 metrics={'f1_val': 0.9928814568495776, 'auprc': 0.9909845691471385, 'loss_val': 0.04339721308928691, 'psi': 0.992122701768602}-{'f1_val': 0.9882256957949537, 'auprc': 0.9910076566043936, 'loss_val': 0.0671745844049109, 'psi': 0.9893384801187297}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=47 head_norm_before_train=2.259596 (no previous merge yet)
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.7240752935487085, 'auprc': 0.9332833342721711, 'loss_val': 0.8147755357695663, 'psi': 0.8077585098380935}-{'f1_val': 0.8870582479854314, 'auprc': 0.9915145341079014, 'loss_val': 0.4546564456043848, 'psi': 0.9288407624344195}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=48 head_norm_before_train=1.922274 cos_to_last_merge=0.9934 (last merge round=33)
[S2] round=48 local utility u=0.097620 metrics={'f1_val': 0.7559241130150517, 'auprc': 0.8556461557273265, 'loss_val': 0.5139956662433363, 'psi': 0.7958129300999616}-{'f1_val': 0.7039672587393446, 'auprc': 0.9032993880083612, 'loss_val': 0.5404538432650504, 'psi': 0.7837001104469512}
[S2] not sending this round → trigger blocked (psi=0.796)
[S3] START round=48 head_norm_before_train=2.184051 (no previous merge yet)
[S3] round=48 local utility u=0.000000 metrics={'f1_val': 0.9416219759222448, 'auprc': 0.9984585237165946, 'loss_val': 0.14212228265817525, 'psi': 0.9643565950399847}-{'f1_val': 0.9608296089712303, 'auprc': 0.9984826883749225, 'loss_val': 0.12447971309114418, 'psi': 0.9758908407327072}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=48 head_norm_before_train=1.875454 cos_to_last_merge=0.8265 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.826
[S4] round=48 local utility u=0.049145 metrics={'f1_val': 0.9574065251062283, 'auprc': 0.9042508893925169, 'loss_val': 0.2891231306052485, 'psi': 0.9361442708207437}-{'f1_val': 0.9447980203404135, 'auprc': 0.9004926912027666, 'loss_val': 0.30048722113480086, 'psi': 0.9270758886853547}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] sending update (kind=head size=1806 to 1 peers)
[S5] START round=48 head_norm_before_train=1.648773 cos_to_last_merge=0.9751 (last merge round=28)
[S5] round=48 local utility u=0.002863 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.991161987451382, 'loss_val': 0.06816366301631084, 'psi': 0.9942650821586869}-{'f1_val': 0.9963338119635569, 'auprc': 0.9913195888659837, 'loss_val': 0.07436318408429375, 'psi': 0.9943281227245275}
[S5] not sending this round → trigger blocked (psi=0.994)
[S6] START round=48 head_norm_before_train=1.783418 cos_to_last_merge=0.9801 (last merge round=33)
[S6] round=48 local utility u=1.000000 metrics={'f1_val': 0.8660630178125626, 'auprc': 0.970711522614227, 'loss_val': 0.3414150948627029, 'psi': 0.9079224197332284}-{'f1_val': 0.6090573938034443, 'auprc': 0.9552892773691679, 'loss_val': 0.769755794759, 'psi': 0.7475501472297337}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=48 head_norm_before_train=1.466103 cos_to_last_merge=0.9953 (last merge round=37)
[S7] round=48 local utility u=0.268252 metrics={'f1_val': 0.59869211088728, 'auprc': 0.7940237096285507, 'loss_val': 0.6711655529389569, 'psi': 0.6768247503837883}-{'f1_val': 0.547855946795137, 'auprc': 0.7880202406256374, 'loss_val': 0.884642465273108, 'psi': 0.6439216643273372}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=48 head_norm_before_train=2.004271 cos_to_last_merge=0.9943 (last merge round=29)
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.9868456538979733, 'auprc': 0.9988181105555451, 'loss_val': 0.03913957128946982, 'psi': 0.991634636561002}-{'f1_val': 0.9930017911527874, 'auprc': 0.9988279830708944, 'loss_val': 0.029597825552342683, 'psi': 0.9953322679200303}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=48 head_norm_before_train=1.756764 cos_to_last_merge=0.6854 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.685
[S9] round=48 local utility u=0.005452 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9984533177172767, 'loss_val': 0.02068684054311698, 'psi': 0.9973776341752456}-{'f1_val': 0.9966605118138915, 'auprc': 0.995215024219804, 'loss_val': 0.021875419317664298, 'psi': 0.9960823167762565}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=48 head_norm_before_train=1.730375 cos_to_last_merge=0.9893 (last merge round=35)
[S10] round=48 local utility u=0.000000 metrics={'f1_val': 0.9937871219080217, 'auprc': 0.994440924219695, 'loss_val': 0.03461449802236743, 'psi': 0.994048642832691}-{'f1_val': 0.9940063275949004, 'auprc': 0.994244287741608, 'loss_val': 0.03448544540121661, 'psi': 0.9941015116535834}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=48 head_norm_before_train=1.896081 cos_to_last_merge=0.9967 (last merge round=29)
[S11] round=48 local utility u=0.070779 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9973099079463228, 'loss_val': 0.021374810244830178, 'psi': 0.9968667120458039}-{'f1_val': 0.9835920561903134, 'auprc': 0.9969666071751313, 'loss_val': 0.08402858261432868, 'psi': 0.9889418765842406}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=48 head_norm_before_train=1.449333 cos_to_last_merge=0.9890 (last merge round=34)
[S13] round=48 local utility u=0.218212 metrics={'f1_val': 0.7301725058127108, 'auprc': 0.7086447255118015, 'loss_val': 0.8647925728019081, 'psi': 0.7215613936923471}-{'f1_val': 0.6439444846035445, 'auprc': 0.7282322889407251, 'loss_val': 0.8426105557453805, 'psi': 0.6776596063384167}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=48 head_norm_before_train=1.613147 cos_to_last_merge=0.9900 (last merge round=34)
[S14] round=48 local utility u=0.005408 metrics={'f1_val': 0.9973862616479148, 'auprc': 0.9987180991073368, 'loss_val': 0.029385076530225016, 'psi': 0.9979189966316836}-{'f1_val': 0.9961612027526012, 'auprc': 0.9986194502497189, 'loss_val': 0.03255490950443498, 'psi': 0.9971445017514483}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S14] sending update (kind=head size=1806 to 1 peers)
[S15] START round=48 head_norm_before_train=1.860394 cos_to_last_merge=0.9791 (last merge round=32)
[S15] round=48 local utility u=0.199853 metrics={'f1_val': 0.9971773386779533, 'auprc': 0.9994052652635883, 'loss_val': 0.013871506654530902, 'psi': 0.9980685093122073}-{'f1_val': 0.941969230596766, 'auprc': 0.9994126151999534, 'loss_val': 0.08235171002788118, 'psi': 0.9649465844380409}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] sending update (kind=head size=1803 to 1 peers)
[S16] START round=48 head_norm_before_train=1.936964 cos_to_last_merge=0.7516 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.752
[S16] round=48 local utility u=0.000000 metrics={'f1_val': 0.9257271010592665, 'auprc': 0.9812985489779984, 'loss_val': 0.41288366410016125, 'psi': 0.9479556802267592}-{'f1_val': 0.9928814568495776, 'auprc': 0.9909845691471385, 'loss_val': 0.04339721308928691, 'psi': 0.992122701768602}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=48 head_norm_before_train=2.263753 (no previous merge yet)
[S17] round=48 local utility u=0.000000 metrics={'f1_val': 0.5814771407204524, 'auprc': 0.9048674369985428, 'loss_val': 1.2611094345041889, 'psi': 0.7108332592316886}-{'f1_val': 0.7240752935487085, 'auprc': 0.9332833342721711, 'loss_val': 0.8147755357695663, 'psi': 0.8077585098380935}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=49 head_norm_before_train=1.930665 cos_to_last_merge=0.9929 (last merge round=33)
[S2] round=49 local utility u=0.040956 metrics={'f1_val': 0.714248119363717, 'auprc': 0.9534700155752669, 'loss_val': 0.47549921469548245, 'psi': 0.8099368778483369}-{'f1_val': 0.7559241130150517, 'auprc': 0.8556461557273265, 'loss_val': 0.5139956662433363, 'psi': 0.7958129300999616}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=49 head_norm_before_train=2.191010 (no previous merge yet)
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.7476280007379217, 'auprc': 0.9982566049871133, 'loss_val': 0.5722336689429491, 'psi': 0.8478794424375984}-{'f1_val': 0.9416219759222448, 'auprc': 0.9984585237165946, 'loss_val': 0.14212228265817525, 'psi': 0.9643565950399847}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=49 head_norm_before_train=1.882274 cos_to_last_merge=0.8264 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.826
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.9554324224010916, 'auprc': 0.8984449047016128, 'loss_val': 0.29495170504316043, 'psi': 0.9326374153213002}-{'f1_val': 0.9574065251062283, 'auprc': 0.9042508893925169, 'loss_val': 0.2891231306052485, 'psi': 0.9361442708207437}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=49 head_norm_before_train=1.662963 cos_to_last_merge=0.9737 (last merge round=28)
[S5] round=49 local utility u=0.013310 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9927604895119433, 'loss_val': 0.04854906425601456, 'psi': 0.995125376891852}-{'f1_val': 0.9963338119635569, 'auprc': 0.991161987451382, 'loss_val': 0.06816366301631084, 'psi': 0.9942650821586869}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] sending update (kind=head size=1794 to 1 peers)
[S6] START round=49 head_norm_before_train=1.796773 cos_to_last_merge=0.9795 (last merge round=33)
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.6054987561501816, 'auprc': 0.8334310068949423, 'loss_val': 0.8536920759664457, 'psi': 0.6966716564480859}-{'f1_val': 0.8660630178125626, 'auprc': 0.970711522614227, 'loss_val': 0.3414150948627029, 'psi': 0.9079224197332284}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=49 head_norm_before_train=1.469706 cos_to_last_merge=0.9952 (last merge round=37)
[S7] round=49 local utility u=0.352227 metrics={'f1_val': 0.6603376861692867, 'auprc': 0.8219028417358825, 'loss_val': 0.42022321080755953, 'psi': 0.724963748395925}-{'f1_val': 0.59869211088728, 'auprc': 0.7940237096285507, 'loss_val': 0.6711655529389569, 'psi': 0.6768247503837883}
[S7] not sending this round → trigger blocked (psi=0.725)
[S8] START round=49 head_norm_before_train=2.016246 cos_to_last_merge=0.9940 (last merge round=29)
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.9832928559309241, 'auprc': 0.9988101963678891, 'loss_val': 0.04818254603705446, 'psi': 0.98949979210571}-{'f1_val': 0.9868456538979733, 'auprc': 0.9988181105555451, 'loss_val': 0.03913957128946982, 'psi': 0.991634636561002}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=49 head_norm_before_train=1.763932 cos_to_last_merge=0.6847 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.685
[S9] round=49 local utility u=0.000000 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9985462145851492, 'loss_val': 0.021379628015900598, 'psi': 0.9969145168525709}-{'f1_val': 0.9966605118138915, 'auprc': 0.9984533177172767, 'loss_val': 0.02068684054311698, 'psi': 0.9973776341752456}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=49 head_norm_before_train=1.743929 cos_to_last_merge=0.9885 (last merge round=35)
[S10] round=49 local utility u=0.000089 metrics={'f1_val': 0.9940063275949004, 'auprc': 0.993696677175445, 'loss_val': 0.03351968949409038, 'psi': 0.9938824674271183}-{'f1_val': 0.9937871219080217, 'auprc': 0.994440924219695, 'loss_val': 0.03461449802236743, 'psi': 0.994048642832691}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=49 head_norm_before_train=1.904568 cos_to_last_merge=0.9964 (last merge round=29)
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9970422490227657, 'loss_val': 0.01984877651432046, 'psi': 0.9964971045570918}-{'f1_val': 0.9965712481121245, 'auprc': 0.9973099079463228, 'loss_val': 0.021374810244830178, 'psi': 0.9968667120458039}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=49 head_norm_before_train=1.465424 cos_to_last_merge=0.9873 (last merge round=34)
[S13] round=49 local utility u=0.086919 metrics={'f1_val': 0.7250062295362227, 'auprc': 0.7429713929083461, 'loss_val': 0.7629366525925985, 'psi': 0.7321922948850721}-{'f1_val': 0.7301725058127108, 'auprc': 0.7086447255118015, 'loss_val': 0.8647925728019081, 'psi': 0.7215613936923471}
[S13] not sending this round → trigger blocked (psi=0.732)
[S14] START round=49 head_norm_before_train=1.625599 cos_to_last_merge=0.9892 (last merge round=34)
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.9941175410717178, 'auprc': 0.9990347145119343, 'loss_val': 0.043438173513887755, 'psi': 0.9960844104478044}-{'f1_val': 0.9973862616479148, 'auprc': 0.9987180991073368, 'loss_val': 0.029385076530225016, 'psi': 0.9979189966316836}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=49 head_norm_before_train=1.874441 cos_to_last_merge=0.9783 (last merge round=32)
[S15] round=49 local utility u=0.000000 metrics={'f1_val': 0.9973248746508501, 'auprc': 0.998544045887959, 'loss_val': 0.01655800744514608, 'psi': 0.9978125431456937}-{'f1_val': 0.9971773386779533, 'auprc': 0.9994052652635883, 'loss_val': 0.013871506654530902, 'psi': 0.9980685093122073}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=49 head_norm_before_train=1.941267 cos_to_last_merge=0.7513 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.751
[S16] round=49 local utility u=0.000000 metrics={'f1_val': 0.8537587753097365, 'auprc': 0.8924478609590367, 'loss_val': 0.8900750097909647, 'psi': 0.8692344095694566}-{'f1_val': 0.9257271010592665, 'auprc': 0.9812985489779984, 'loss_val': 0.41288366410016125, 'psi': 0.9479556802267592}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=49 head_norm_before_train=2.273234 (no previous merge yet)
[S17] round=49 local utility u=1.000000 metrics={'f1_val': 0.8472810423141338, 'auprc': 0.9596381898771533, 'loss_val': 0.5402590523593687, 'psi': 0.8922239013393416}-{'f1_val': 0.5814771407204524, 'auprc': 0.9048674369985428, 'loss_val': 1.2611094345041889, 'psi': 0.7108332592316886}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] sending update (kind=head size=1793 to 1 peers)
[runner] rounds complete.
[runner] all agents stopped.
