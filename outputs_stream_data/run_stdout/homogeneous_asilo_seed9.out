[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:39003
[S3] → join 127.0.0.1:39002
[S4] → join 127.0.0.1:39002
[S5] → join 127.0.0.1:39002
[S6] → join 127.0.0.1:39002
[S7] → join 127.0.0.1:39002
[S8] → join 127.0.0.1:39002
[S9] → join 127.0.0.1:39002
[S10] → join 127.0.0.1:39002
[S11] → join 127.0.0.1:39002
[S13] → join 127.0.0.1:39002
[S14] → join 127.0.0.1:39002
[S15] → join 127.0.0.1:39002
[S16] → join 127.0.0.1:39002
[S17] → join 127.0.0.1:39002
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.179882 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.191960 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.124611 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.084158 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.189077 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.193134 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.156868 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.212381 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.167055 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.177311 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.147884 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.140977 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.167163 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.150737 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.181512 (no previous merge yet)
[S14]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S3] + discovered S6
[S3] + discovered S8
[S3] + discovered S13
[S3] + discovered S5
[S3] + discovered S7
[S4] + discovered S2
[S4] + discovered S3
[S3] + discovered S14
[S3] + discovered S17
[S3] + discovered S16
[S3] + discovered S11
[S3] + discovered S15
[S3] + discovered S9
[S3] + discovered S10
[S3] + discovered S4
[S4] + discovered S7
[S4] + discovered S5
[S5] + discovered S2
[S4] + discovered S14
[S4] + discovered S16
[S4] + discovered S17
[S4] + discovered S11
[S5] + discovered S4
[S4] + discovered S9
[S5] + discovered S3
[S4] + discovered S15
[S4] + discovered S10
[S4] + discovered S6
[S4] + discovered S8
[S4] + discovered S13
[S5] + discovered S17
[S5] + discovered S9
[S5] + discovered S7
[S5] + discovered S8
[S5] + discovered S6
[S5] + discovered S10
[S5] + discovered S15
[S5] + discovered S16
[S5] + discovered S13
[S5] + discovered S14
[S5] + discovered S11
[S6] + discovered S4
[S6] + discovered S5
[S6] + discovered S3
[S6] + discovered S2
[S7] + discovered S4
[S6] + discovered S7
[S6] + discovered S9
[S6] + discovered S17
[S6] + discovered S13
[S6] + discovered S11
[S6] + discovered S15
[S7] + discovered S5
[S6] + discovered S16
[S7] + discovered S6
[S6] + discovered S10
[S6] + discovered S14
[S7] + discovered S3
[S6] + discovered S8
[S7] + discovered S2
[S7] + discovered S14
[S7] + discovered S17
[S7] + discovered S9
[S7] + discovered S16
[S7] + discovered S15
[S7] + discovered S11
[S7] + discovered S10
[S7] + discovered S8
[S7] + discovered S13
[S8] + discovered S2
[S8] + discovered S6
[S8] + discovered S3
[S8] + discovered S7
[S8] + discovered S5
[S8] + discovered S4
[S9] + discovered S7
[S9] + discovered S6
[S8] + discovered S9
[S8] + discovered S11
[S8] + discovered S17
[S8] + discovered S13
[S8] + discovered S10
[S8] + discovered S16
[S9] + discovered S3
[S8] + discovered S14
[S9] + discovered S5
[S9] + discovered S4
[S9] + discovered S2
[S8] + discovered S15
[S9] + discovered S8
[S10] + discovered S4
[S10] + discovered S7
[S10] + discovered S8
[S10] + discovered S9
[S10] + discovered S5
[S10] + discovered S3
[S10] + discovered S2
[S10] + discovered S6
[S9] + discovered S13
[S9] + discovered S10
[S9] + discovered S17
[S9] + discovered S15
[S9] + discovered S11
[S9] + discovered S16
[S9] + discovered S14
[S10] + discovered S16
[S10] + discovered S17
[S10] + discovered S13
[S10] + discovered S11
[S10] + discovered S14
[S10] + discovered S15
[S11] + discovered S9
[S11] + discovered S8
[S11] + discovered S10
[S11] + discovered S4
[S11] + discovered S3
[S11] + discovered S6
[S11] + discovered S2
[S11] + discovered S7
[S11] + discovered S5
[S11] + discovered S17
[S11] + discovered S15
[S11] + discovered S14
[S13] + discovered S6
[S13] + discovered S3
[S13] + discovered S9
[S13] + discovered S11
[S13] + discovered S10
[S13] + discovered S2
[S13] + discovered S4
[S13] + discovered S5
[S13] + discovered S7
[S13] + discovered S8
[S11] + discovered S13
[S11] + discovered S16
[S13] + discovered S14
[S13] + discovered S16
[S14] + discovered S3
[S13] + discovered S15
[S14] + discovered S7
[S14] + discovered S2
[S14] + discovered S4
[S14] + discovered S10
[S14] + discovered S5
[S14] + discovered S11
[S14] + discovered S9
[S14] + discovered S6
[S14] + discovered S13
[S14] + discovered S8
[S13] + discovered S17
[S14] + discovered S16
[S14] + discovered S15
[S14] + discovered S17
[S15] + discovered S9
[S15] + discovered S3
[S15] + discovered S2
[S15] + discovered S7
[S15] + discovered S14
[S15] + discovered S6
[S15] + discovered S8
[S15] + discovered S13
[S15] + discovered S11
[S15] + discovered S5
[S15] + discovered S10
[S15] + discovered S4
[S16] + discovered S6
[S16] + discovered S15
[S16] + discovered S13
[S16] + discovered S7
[S16] + discovered S9
[S16] + discovered S3
[S16] + discovered S10
[S16] + discovered S14
[S16] + discovered S2
[S16] + discovered S5
[S16] + discovered S11
[S16] + discovered S4
[S15] + discovered S17
[S15] + discovered S16
[S16] + discovered S8
[S17] + discovered S16
[S17] + discovered S7
[S17] + discovered S6
[S17] + discovered S4
[S17] + discovered S2
[S17] + discovered S11
[S17] + discovered S14
[S17] + discovered S8
[S17] + discovered S10
[S17] + discovered S15
[S17] + discovered S5
[S17] + discovered S3
[S16] + discovered S17
[S17] + discovered S13
[S17] + discovered S9
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] ⇄ pheromone p=1.000 → S15@127.0.0.1:39015
[S7] ⇄ pheromone p=1.000 → S2@127.0.0.1:39002
[S11] ⇄ pheromone p=1.000 → S5@127.0.0.1:39005
[S5] ⇄ pheromone p=1.000 → S17@127.0.0.1:39017
[S6] ⇄ pheromone p=1.000 → S17@127.0.0.1:39017
[S2] ⇄ pheromone p=1.000 → S9@127.0.0.1:39010
[S8] ⇄ pheromone p=1.000 → S5@127.0.0.1:39005
[S15] ⇄ pheromone p=1.000 → S6@127.0.0.1:39007
[S14] ⇄ pheromone p=1.000 → S17@127.0.0.1:39017
[S16] ⇄ pheromone p=1.000 → S7@127.0.0.1:39008
[S13] ⇄ pheromone p=1.000 → S4@127.0.0.1:39004
[S10] ⇄ pheromone p=1.000 → S14@127.0.0.1:39014
[S3] ⇄ pheromone p=1.000 → S8@127.0.0.1:39009
[S4] ⇄ pheromone p=1.000 → S10@127.0.0.1:39011
[S17] ⇄ pheromone p=1.000 → S16@127.0.0.1:39016
[S2] START round=1 head_norm_before_train=1.186809 (no previous merge yet)
[S2] round=1 local utility u=0.022989 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6096709121751928, 'loss_val': 1.2924773470547906, 'psi': 0.32893464490321717}-{'f1_val': 0.1417771333885667, 'auprc': 0.607216155264535, 'loss_val': 1.3310915579606402, 'psi': 0.32795274213895403}
[S3] START round=1 head_norm_before_train=1.198818 (no previous merge yet)
[S3] round=1 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8012403170072032, 'loss_val': 1.322763082280626, 'psi': 0.40440016617134555}-{'f1_val': 0.41163924284401254, 'auprc': 0.6902836602136004, 'loss_val': 1.352044995727067, 'psi': 0.5230970097918477}
[S4] START round=1 head_norm_before_train=1.130792 (no previous merge yet)
[S4] round=1 local utility u=1.000000 metrics={'f1_val': 0.41464193270060395, 'auprc': 0.7914065597661426, 'loss_val': 1.3253920995066801, 'psi': 0.5653477835268195}-{'f1_val': 0.08883296351889317, 'auprc': 0.5912847426283259, 'loss_val': 1.3576761920525149, 'psi': 0.28981367516266626}
[S5] START round=1 head_norm_before_train=1.083289 (no previous merge yet)
[S5] round=1 local utility u=0.930301 metrics={'f1_val': 0.4250421882769406, 'auprc': 0.7468714329124031, 'loss_val': 1.3348854591116095, 'psi': 0.5537738861311257}-{'f1_val': 0.11288402000476304, 'auprc': 0.76057564084691, 'loss_val': 1.363650131013351, 'psi': 0.3719606683416218}
[S6] START round=1 head_norm_before_train=1.191770 (no previous merge yet)
[S6] round=1 local utility u=1.000000 metrics={'f1_val': 0.3817502160957791, 'auprc': 0.655621594818585, 'loss_val': 1.3415360745162814, 'psi': 0.49129876758490143}-{'f1_val': 0.08954368264159597, 'auprc': 0.45907064254639773, 'loss_val': 1.3786450322968302, 'psi': 0.2373544666035167}
[S7] START round=1 head_norm_before_train=1.197028 (no previous merge yet)
[S7] round=1 local utility u=0.000000 metrics={'f1_val': 0.10438344033650652, 'auprc': 0.4331834911858057, 'loss_val': 1.3599766483077353, 'psi': 0.2359034606762262}-{'f1_val': 0.10429108604291086, 'auprc': 0.4450028352132842, 'loss_val': 1.3919669807913322, 'psi': 0.24057578571106022}
[S8] START round=1 head_norm_before_train=1.162715 (no previous merge yet)
[S8] round=1 local utility u=0.000000 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.6603828508741357, 'loss_val': 1.3247290130617397, 'psi': 0.34812672978542863}-{'f1_val': 0.3761722163042047, 'auprc': 0.4029044067143384, 'loss_val': 1.354451634488724, 'psi': 0.3868650924682582}
[S9] START round=1 head_norm_before_train=1.210642 (no previous merge yet)
[S9] round=1 local utility u=0.128693 metrics={'f1_val': 0.41596643747099904, 'auprc': 0.6610768578540488, 'loss_val': 1.3141477921427194, 'psi': 0.514010605624219}-{'f1_val': 0.38095705508484, 'auprc': 0.6601849433183004, 'loss_val': 1.3588010097664853, 'psi': 0.49264821037822415}
[S10] START round=1 head_norm_before_train=1.170894 (no previous merge yet)
[S10] round=1 local utility u=0.029645 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.807053051145406, 'loss_val': 1.3216774008937013, 'psi': 0.4059942029831968}-{'f1_val': 0.13862163754172394, 'auprc': 0.7962639355013512, 'loss_val': 1.3486003724510283, 'psi': 0.40167855672557484}
[S11] START round=1 head_norm_before_train=1.179296 (no previous merge yet)
[S11] round=1 local utility u=0.096588 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7990352783159999, 'loss_val': 1.3294417443776865, 'psi': 0.4038623213502663}-{'f1_val': 0.14041368337311058, 'auprc': 0.7477230813306803, 'loss_val': 1.3686805165096876, 'psi': 0.3833374425561385}
[S13] START round=1 head_norm_before_train=1.151028 (no previous merge yet)
[S13] round=1 local utility u=0.028688 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5866108843328957, 'loss_val': 1.3052321664853928, 'psi': 0.31887581127939013}-{'f1_val': 0.1403857625770531, 'auprc': 0.5785204460409868, 'loss_val': 1.3383359361862008, 'psi': 0.3156396359626266}
[S14] START round=1 head_norm_before_train=1.142730 (no previous merge yet)
[S14] round=1 local utility u=0.181217 metrics={'f1_val': 0.12346965355561344, 'auprc': 0.4773343313025545, 'loss_val': 1.3600439861355358, 'psi': 0.2650155246543899}-{'f1_val': 0.08260267651130596, 'auprc': 0.44512120229342605, 'loss_val': 1.3806358316123113, 'psi': 0.227610086824154}
[S15] START round=1 head_norm_before_train=1.174531 (no previous merge yet)
[S15] round=1 local utility u=0.015884 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7722155005760007, 'loss_val': 1.3142180673249477, 'psi': 0.3927263910473353}-{'f1_val': 0.13973365136155833, 'auprc': 0.7715929664965309, 'loss_val': 1.3441175414945343, 'psi': 0.3924773774155474}
[S16] START round=1 head_norm_before_train=1.159195 (no previous merge yet)
[S16] round=1 local utility u=0.315579 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.9889768773115559, 'loss_val': 1.3106765063763857, 'psi': 0.4799732210441443}-{'f1_val': 0.14063745019920318, 'auprc': 0.7864968757629585, 'loss_val': 1.334394086440692, 'psi': 0.3989812204247053}
[S17] START round=1 head_norm_before_train=1.183666 (no previous merge yet)
[S17] round=1 local utility u=0.877561 metrics={'f1_val': 0.35273268957802617, 'auprc': 0.6868519631687394, 'loss_val': 1.339015947139979, 'psi': 0.4863803990143115}-{'f1_val': 0.09754189944134078, 'auprc': 0.621800861811332, 'loss_val': 1.367840544060653, 'psi': 0.3072454843893373}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] → sending delta(kind=head bytes=1792) to S7@127.0.0.1:39008
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S10] → sending delta(kind=head bytes=1786) to S15@127.0.0.1:39015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1785 reason=None
[S9] → sending delta(kind=head bytes=1785) to S4@127.0.0.1:39004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S16] → sending delta(kind=head bytes=1791) to S4@127.0.0.1:39004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S2] → sending delta(kind=head bytes=1792) to S14@127.0.0.1:39014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S6] → sending delta(kind=head bytes=1786) to S15@127.0.0.1:39015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S15] → sending delta(kind=head bytes=1791) to S7@127.0.0.1:39008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S10@127.0.0.1:39011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S4] → sending delta(kind=head bytes=1789) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S13] → sending delta(kind=head bytes=1791) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S14] → sending delta(kind=head bytes=1791) to S8@127.0.0.1:39009
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1789 to 1 peers)
[S2] sending update (kind=head size=1792 to 1 peers)
[S15] sending update (kind=head size=1791 to 1 peers)
[S13] sending update (kind=head size=1791 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1791 to 1 peers)
[S16] sending update (kind=head size=1791 to 1 peers)
[S9] sending update (kind=head size=1785 to 1 peers)
[S11] sending update (kind=head size=1792 to 1 peers)
[S6] sending update (kind=head size=1786 to 1 peers)
[S10] sending update (kind=head size=1786 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1794) from S5
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.092073)
[S10] loaded HEAD from S5 (vec_in norm=1.092073)
[S10] cosine check vs S5: cos=0.0214
[S10] BUFFERED delta from S5 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1792) from S11
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.191344)
[S7] loaded HEAD from S11 (vec_in norm=1.191344)
[S7] cosine check vs S11: cos=0.1026
[S7] BUFFERED delta from S11 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1791) from S15
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.192870)
[S7] loaded HEAD from S15 (vec_in norm=1.192870)
[S7] cosine check vs S15: cos=-0.0905
[S7] DROPPED delta from S15 (cos=-0.0905 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1791) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.155010)
[S8] loaded HEAD from S14 (vec_in norm=1.155010)
[S8] cosine check vs S14: cos=-0.0548
[S8] DROPPED delta from S14 (cos=-0.0548 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1792) from S2
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.202077)
[S14] loaded HEAD from S2 (vec_in norm=1.202077)
[S14] cosine check vs S2: cos=0.0567
[S14] BUFFERED delta from S2 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1791) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.176463)
[S4] loaded HEAD from S16 (vec_in norm=1.176463)
[S4] cosine check vs S16: cos=-0.0131
[S4] DROPPED delta from S16 (cos=-0.0131 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1785) from S9
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.223830)
[S4] loaded HEAD from S9 (vec_in norm=1.223830)
[S4] cosine check vs S9: cos=0.0329
[S4] BUFFERED delta from S9 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1791) from S13
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.164594)
[S5] loaded HEAD from S13 (vec_in norm=1.164594)
[S5] cosine check vs S13: cos=0.0364
[S5] BUFFERED delta from S13 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1786) from S6
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.199132)
[S15] loaded HEAD from S6 (vec_in norm=1.199132)
[S15] cosine check vs S6: cos=0.0242
[S15] BUFFERED delta from S6 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1789) from S4
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.145420)
[S5] loaded HEAD from S4 (vec_in norm=1.145420)
[S5] cosine check vs S4: cos=0.0723
[S5] BUFFERED delta from S4 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1786) from S10
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.185199)
[S15] loaded HEAD from S10 (vec_in norm=1.185199)
[S15] cosine check vs S10: cos=0.1086
[S15] BUFFERED delta from S10 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S17] → sending delta(kind=head bytes=1790) to S9@127.0.0.1:39010
[S17] sending update (kind=head size=1790 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1790) from S17
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.198456)
[S9] loaded HEAD from S17 (vec_in norm=1.198456)
[S9] cosine check vs S17: cos=0.0776
[S9] BUFFERED delta from S17 (total buffered=1)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=1 metric=0.1044 head_norm=1.209341
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.040671e-01
[S7] stored merged vector for next round verification (round=1)
[S7] DEBUG after merge:  round=1 metric=0.1256 head_norm=0.891279 delta_norm=0.804067
[S7] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=1 metric=0.4146 head_norm=1.145420
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.242573e-01
[S4] stored merged vector for next round verification (round=1)
[S4] DEBUG after merge:  round=1 metric=0.3716 head_norm=0.851747 delta_norm=0.824257
[S4] aggregate: ROLLBACK (f1_val pre=0.415 post=0.372 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=1 metric=0.4160 head_norm=1.223830
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.225436e-01
[S9] stored merged vector for next round verification (round=1)
[S9] DEBUG after merge:  round=1 metric=0.3115 head_norm=0.889072 delta_norm=0.822544
[S9] aggregate: ROLLBACK (f1_val pre=0.416 post=0.311 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=1 metric=0.1397 head_norm=1.192870
[S15] _apply_head_vector_avg (torch): Δ‖w‖=6.792197e-01
[S15] stored merged vector for next round verification (round=1)
[S15] DEBUG after merge:  round=1 metric=0.1397 head_norm=0.745271 delta_norm=0.679220
[S15] aggregate: ACCEPT kept=['S6', 'S10'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=1 metric=0.1235 head_norm=1.155010
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.095865e-01
[S14] stored merged vector for next round verification (round=1)
[S14] DEBUG after merge:  round=1 metric=0.0409 head_norm=0.856789 delta_norm=0.809587
[S14] aggregate: ROLLBACK (f1_val pre=0.123 post=0.041 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=1 metric=0.4250 head_norm=1.092073
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.543712e-01
[S5] stored merged vector for next round verification (round=1)
[S5] DEBUG after merge:  round=1 metric=0.1423 head_norm=0.704665 delta_norm=0.654371
[S5] aggregate: ROLLBACK (f1_val pre=0.425 post=0.142 tol_abs=0.005 tol_rel=0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=1 metric=0.1386 head_norm=1.185199
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.971819e-01
[S10] stored merged vector for next round verification (round=1)
[S10] DEBUG after merge:  round=1 metric=0.1386 head_norm=0.814347 delta_norm=0.797182
[S10] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=1.202077 (no previous merge yet)
[S2] round=2 local utility u=0.027299 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6123040391626915, 'loss_val': 1.2457786072916486, 'psi': 0.3299878956982166}-{'f1_val': 0.1417771333885667, 'auprc': 0.6096709121751928, 'loss_val': 1.2924773470547906, 'psi': 0.32893464490321717}
[S3] START round=2 head_norm_before_train=1.214720 (no previous merge yet)
[S3] round=2 local utility u=0.283666 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9789920061338235, 'loss_val': 1.2886860810518812, 'psi': 0.4755008418219937}-{'f1_val': 0.13984006561410703, 'auprc': 0.8012403170072032, 'loss_val': 1.322763082280626, 'psi': 0.40440016617134555}
[S4] START round=2 head_norm_before_train=0.851747 cos_to_last_merge=1.0000 (last merge round=1)
[S4] round=2 local utility u=0.002899 metrics={'f1_val': 0.4147655686485733, 'auprc': 0.7922478459172424, 'loss_val': 1.3228593630755563, 'psi': 0.565758479556041}-{'f1_val': 0.41464193270060395, 'auprc': 0.7914065597661426, 'loss_val': 1.3253920995066801, 'psi': 0.5653477835268195}
[S5] START round=2 head_norm_before_train=0.704665 cos_to_last_merge=1.0000 (last merge round=1)
[S5] round=2 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7414864197820817, 'loss_val': 1.3320560375237487, 'psi': 0.3819517107699756}-{'f1_val': 0.4250421882769406, 'auprc': 0.7468714329124031, 'loss_val': 1.3348854591116095, 'psi': 0.5537738861311257}
[S6] START round=2 head_norm_before_train=1.199132 (no previous merge yet)
[S6] round=2 local utility u=0.000000 metrics={'f1_val': 0.2089352307844401, 'auprc': 0.7974477624414947, 'loss_val': 1.3014813880695904, 'psi': 0.444340243447262}-{'f1_val': 0.3817502160957791, 'auprc': 0.655621594818585, 'loss_val': 1.3415360745162814, 'psi': 0.49129876758490143}
[S7] START round=2 head_norm_before_train=0.891279 cos_to_last_merge=1.0000 (last merge round=1)
[S7] round=2 local utility u=0.809936 metrics={'f1_val': 0.20861636674186246, 'auprc': 0.75958492258641, 'loss_val': 1.3447055730263746, 'psi': 0.4290037890796815}-{'f1_val': 0.10438344033650652, 'auprc': 0.4331834911858057, 'loss_val': 1.3599766483077353, 'psi': 0.2359034606762262}
[S8] START round=2 head_norm_before_train=1.175457 (no previous merge yet)
[S8] round=2 local utility u=0.033787 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.6717162025417869, 'loss_val': 1.2911547379239405, 'psi': 0.3526600704524891}-{'f1_val': 0.13995598239295717, 'auprc': 0.6603828508741357, 'loss_val': 1.3247290130617397, 'psi': 0.34812672978542863}
[S9] START round=2 head_norm_before_train=0.889072 cos_to_last_merge=1.0000 (last merge round=1)
[S9] round=2 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.686902996006417, 'loss_val': 1.3152682100457254, 'psi': 0.3595999726865644}-{'f1_val': 0.41596643747099904, 'auprc': 0.6610768578540488, 'loss_val': 1.3141477921427194, 'psi': 0.514010605624219}
[S10] START round=2 head_norm_before_train=0.814347 cos_to_last_merge=1.0000 (last merge round=1)
[S10] round=2 local utility u=0.110523 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.8820639038443574, 'loss_val': 1.3256648041938672, 'psi': 0.4359985440627773}-{'f1_val': 0.13862163754172394, 'auprc': 0.807053051145406, 'loss_val': 1.3216774008937013, 'psi': 0.4059942029831968}
[S11] START round=2 head_norm_before_train=1.191344 (no previous merge yet)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7640839421738662, 'loss_val': 1.2858963211137822, 'psi': 0.38988178689341285}-{'f1_val': 0.14041368337311058, 'auprc': 0.7990352783159999, 'loss_val': 1.3294417443776865, 'psi': 0.4038623213502663}
[S13] START round=2 head_norm_before_train=1.164594 (no previous merge yet)
[S13] round=2 local utility u=0.165118 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6838193796270237, 'loss_val': 1.2666206834652303, 'psi': 0.3577592093970413}-{'f1_val': 0.1403857625770531, 'auprc': 0.5866108843328957, 'loss_val': 1.3052321664853928, 'psi': 0.31887581127939013}
[S14] START round=2 head_norm_before_train=0.856789 cos_to_last_merge=1.0000 (last merge round=1)
[S14] round=2 local utility u=0.318046 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.6522158740781004, 'loss_val': 1.349926798229323, 'psi': 0.34510106136086244}-{'f1_val': 0.12346965355561344, 'auprc': 0.4773343313025545, 'loss_val': 1.3600439861355358, 'psi': 0.2650155246543899}
[S15] START round=2 head_norm_before_train=0.745271 cos_to_last_merge=1.0000 (last merge round=1)
[S15] round=2 local utility u=0.002860 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7733172607176068, 'loss_val': 1.3118032080245547, 'psi': 0.39316709510397774}-{'f1_val': 0.13973365136155833, 'auprc': 0.7722155005760007, 'loss_val': 1.3142180673249477, 'psi': 0.3927263910473353}
[S16] START round=2 head_norm_before_train=1.176463 (no previous merge yet)
[S16] round=2 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.9613985086961621, 'loss_val': 1.2777980603047772, 'psi': 0.4689418735979868}-{'f1_val': 0.14063745019920318, 'auprc': 0.9889768773115559, 'loss_val': 1.3106765063763857, 'psi': 0.4799732210441443}
[S17] START round=2 head_norm_before_train=1.198456 (no previous merge yet)
[S17] round=2 local utility u=0.000000 metrics={'f1_val': 0.17663075719075177, 'auprc': 0.7241343086778523, 'loss_val': 1.300734040440411, 'psi': 0.395632177785592}-{'f1_val': 0.35273268957802617, 'auprc': 0.6868519631687394, 'loss_val': 1.339015947139979, 'psi': 0.4863803990143115}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:39008
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:39015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S13] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:39017
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S7@127.0.0.1:39008
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S8] → sending delta(kind=head bytes=1789) to S15@127.0.0.1:39015
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S2] → sending delta(kind=head bytes=1790) to S7@127.0.0.1:39008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:39016
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:39015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:39002
[S13] sending update (kind=head size=1792 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1790 to 1 peers)
[S8] sending update (kind=head size=1789 to 1 peers)
[S4] sending update (kind=head size=1794 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1789) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.194919)
[S15] loaded HEAD from S8 (vec_in norm=1.194919)
[S15] cosine check vs S8: cos=0.0846
[S15] BUFFERED delta from S8 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1790) from S2
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.225611)
[S7] loaded HEAD from S2 (vec_in norm=1.225611)
[S7] cosine check vs S2: cos=-0.0539
[S7] DROPPED delta from S2 (cos=-0.0539 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1798) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=0.836261)
[S7] loaded HEAD from S10 (vec_in norm=0.836261)
[S7] cosine check vs S10: cos=-0.0554
[S7] DROPPED delta from S10 (cos=-0.0554 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1796) from S15
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.776363)
[S16] loaded HEAD from S15 (vec_in norm=0.776363)
[S16] cosine check vs S15: cos=0.0474
[S16] BUFFERED delta from S15 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1798) from S7
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.910626)
[S2] loaded HEAD from S7 (vec_in norm=0.910626)
[S2] cosine check vs S7: cos=-0.0539
[S2] DROPPED delta from S7 (cos=-0.0539 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1792) from S13
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.187894)
[S17] loaded HEAD from S13 (vec_in norm=1.187894)
[S17] cosine check vs S13: cos=-0.0529
[S17] DROPPED delta from S13 (cos=-0.0529 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1795) from S3
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.239478)
[S15] loaded HEAD from S3 (vec_in norm=1.239478)
[S15] cosine check vs S3: cos=0.0433
[S15] BUFFERED delta from S3 (total buffered=2)
[S7] RECEIVED delta(kind=head bytes=1794) from S4
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.873188)
[S7] loaded HEAD from S4 (vec_in norm=0.873188)
[S7] cosine check vs S4: cos=0.0775
[S7] BUFFERED delta from S4 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1797) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.872872)
[S15] loaded HEAD from S14 (vec_in norm=0.872872)
[S15] cosine check vs S14: cos=0.0356
[S15] BUFFERED delta from S14 (total buffered=3)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=2 metric=0.1397 head_norm=0.776363
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.756006e-01
[S15] stored merged vector for next round verification (round=2)
[S15] DEBUG after merge:  round=2 metric=0.1397 head_norm=0.520348 delta_norm=0.475601
[S15] aggregate: ACCEPT kept=['S8', 'S3', 'S14'] (k=3/3) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=2 metric=0.2086 head_norm=0.910626
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.059085e-01
[S7] stored merged vector for next round verification (round=2)
[S7] DEBUG after merge:  round=2 metric=0.1043 head_norm=0.654769 delta_norm=0.605909
[S7] aggregate: ROLLBACK (f1_val pre=0.209 post=0.104 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=2 metric=0.1406 head_norm=1.203451
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.004353e-01
[S16] stored merged vector for next round verification (round=2)
[S16] DEBUG after merge:  round=2 metric=0.1406 head_norm=0.731373 delta_norm=0.700435
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=1.225611 (no previous merge yet)
[S2] round=3 local utility u=0.028389 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6144456870682494, 'loss_val': 1.1954263702620858, 'psi': 0.3308445548604398}-{'f1_val': 0.1417771333885667, 'auprc': 0.6123040391626915, 'loss_val': 1.2457786072916486, 'psi': 0.3299878956982166}
[S3] START round=3 head_norm_before_train=1.239478 (no previous merge yet)
[S3] round=3 local utility u=0.053187 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9983311924555094, 'loss_val': 1.240329071493019, 'psi': 0.483236516350668}-{'f1_val': 0.13984006561410703, 'auprc': 0.9789920061338235, 'loss_val': 1.2886860810518812, 'psi': 0.4755008418219937}
[S4] START round=3 head_norm_before_train=0.873188 cos_to_last_merge=0.9965 (last merge round=1)
[S4] round=3 local utility u=0.000000 metrics={'f1_val': 0.14697925420911984, 'auprc': 0.793625388175859, 'loss_val': 1.2742848126024604, 'psi': 0.40563770779581554}-{'f1_val': 0.4147655686485733, 'auprc': 0.7922478459172424, 'loss_val': 1.3228593630755563, 'psi': 0.565758479556041}
[S5] START round=3 head_norm_before_train=0.717382 cos_to_last_merge=0.9958 (last merge round=1)
[S5] round=3 local utility u=0.017257 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7430726867477386, 'loss_val': 1.3023017023037053, 'psi': 0.38258621755623834}-{'f1_val': 0.14226190476190476, 'auprc': 0.7414864197820817, 'loss_val': 1.3320560375237487, 'psi': 0.3819517107699756}
[S6] START round=3 head_norm_before_train=1.217177 (no previous merge yet)
[S6] round=3 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8036658056303165, 'loss_val': 1.2539004471270396, 'psi': 0.40632209148289583}-{'f1_val': 0.2089352307844401, 'auprc': 0.7974477624414947, 'loss_val': 1.3014813880695904, 'psi': 0.444340243447262}
[S7] START round=3 head_norm_before_train=0.654769 cos_to_last_merge=1.0000 (last merge round=2)
[S7] round=3 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.6562691622938461, 'loss_val': 1.350690728449261, 'psi': 0.34774175855499345}-{'f1_val': 0.20861636674186246, 'auprc': 0.75958492258641, 'loss_val': 1.3447055730263746, 'psi': 0.4290037890796815}
[S8] START round=3 head_norm_before_train=1.194919 (no previous merge yet)
[S8] round=3 local utility u=0.148262 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7570306753824861, 'loss_val': 1.2505737136416615, 'psi': 0.3867858595887688}-{'f1_val': 0.13995598239295717, 'auprc': 0.6717162025417869, 'loss_val': 1.2911547379239405, 'psi': 0.3526600704524891}
[S9] START round=3 head_norm_before_train=0.906809 cos_to_last_merge=0.9966 (last merge round=1)
[S9] round=3 local utility u=0.348441 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8977095551322969, 'loss_val': 1.2508049012372746, 'psi': 0.4439225963369164}-{'f1_val': 0.141397957139996, 'auprc': 0.686902996006417, 'loss_val': 1.3152682100457254, 'psi': 0.3595999726865644}
[S10] START round=3 head_norm_before_train=0.836261 cos_to_last_merge=0.9965 (last merge round=1)
[S10] round=3 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6684407581444172, 'loss_val': 1.2881295817323608, 'psi': 0.35054928578280126}-{'f1_val': 0.13862163754172394, 'auprc': 0.8820639038443574, 'loss_val': 1.3256648041938672, 'psi': 0.4359985440627773}
[S11] START round=3 head_norm_before_train=1.209709 (no previous merge yet)
[S11] round=3 local utility u=0.025603 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7629157186843729, 'loss_val': 1.2311850959140846, 'psi': 0.38941449749761553}-{'f1_val': 0.14041368337311058, 'auprc': 0.7640839421738662, 'loss_val': 1.2858963211137822, 'psi': 0.38988178689341285}
[S13] START round=3 head_norm_before_train=1.187894 (no previous merge yet)
[S13] round=3 local utility u=0.035327 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6904490535635015, 'loss_val': 1.2158550424991845, 'psi': 0.36041107897163244}-{'f1_val': 0.1403857625770531, 'auprc': 0.6838193796270237, 'loss_val': 1.2666206834652303, 'psi': 0.3577592093970413}
[S14] START round=3 head_norm_before_train=0.872872 cos_to_last_merge=0.9970 (last merge round=1)
[S14] round=3 local utility u=0.161078 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7517216070973258, 'loss_val': 1.3262878479592992, 'psi': 0.3849033545685526}-{'f1_val': 0.14035785288270378, 'auprc': 0.6522158740781004, 'loss_val': 1.349926798229323, 'psi': 0.34510106136086244}
[S15] START round=3 head_norm_before_train=0.520348 cos_to_last_merge=1.0000 (last merge round=2)
[S15] round=3 local utility u=0.006593 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7746308190242936, 'loss_val': 1.3025570682397074, 'psi': 0.3936925184266525}-{'f1_val': 0.13973365136155833, 'auprc': 0.7733172607176068, 'loss_val': 1.3118032080245547, 'psi': 0.39316709510397774}
[S16] START round=3 head_norm_before_train=0.731373 cos_to_last_merge=1.0000 (last merge round=2)
[S16] round=3 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7735330456601581, 'loss_val': 1.2723857855427407, 'psi': 0.39379568838358514}-{'f1_val': 0.14063745019920318, 'auprc': 0.9613985086961621, 'loss_val': 1.2777980603047772, 'psi': 0.4689418735979868}
[S17] START round=3 head_norm_before_train=1.222777 (no previous merge yet)
[S17] round=3 local utility u=0.044590 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.8056084470433333, 'loss_val': 1.2418863369619437, 'psi': 0.40681275680776396}-{'f1_val': 0.17663075719075177, 'auprc': 0.7241343086778523, 'loss_val': 1.300734040440411, 'psi': 0.395632177785592}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:39004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:39009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:39010
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S17@127.0.0.1:39017
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:39007
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:39015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S8] → sending delta(kind=head bytes=1791) to S5@127.0.0.1:39005
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1792 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1794 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1793 to 1 peers)
[S8] sending update (kind=head size=1791 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1796) from S13
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.219754)
[S4] loaded HEAD from S13 (vec_in norm=1.219754)
[S4] cosine check vs S13: cos=0.0590
[S4] BUFFERED delta from S13 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1794) from S15
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.555596)
[S6] loaded HEAD from S15 (vec_in norm=0.555596)
[S6] cosine check vs S15: cos=0.3291
[S6] BUFFERED delta from S15 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1791) from S8
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.220850)
[S5] loaded HEAD from S8 (vec_in norm=1.220850)
[S5] cosine check vs S8: cos=-0.0489
[S5] DROPPED delta from S8 (cos=-0.0489 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1794) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.235972)
[S5] loaded HEAD from S11 (vec_in norm=1.235972)
[S5] cosine check vs S11: cos=-0.0067
[S5] DROPPED delta from S11 (cos=-0.0067 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1797) from S3
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.273648)
[S8] loaded HEAD from S3 (vec_in norm=1.273648)
[S8] cosine check vs S3: cos=-0.0149
[S8] DROPPED delta from S3 (cos=-0.0149 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1793) from S5
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.740444)
[S17] loaded HEAD from S5 (vec_in norm=0.740444)
[S17] cosine check vs S5: cos=-0.1259
[S17] DROPPED delta from S5 (cos=-0.1259 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1798) from S2
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.251531)
[S9] loaded HEAD from S2 (vec_in norm=1.251531)
[S9] cosine check vs S2: cos=-0.0391
[S9] DROPPED delta from S2 (cos=-0.0391 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1792) from S14
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.898799)
[S17] loaded HEAD from S14 (vec_in norm=0.898799)
[S17] cosine check vs S14: cos=0.0663
[S17] BUFFERED delta from S14 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1796) from S9
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.937384)
[S15] loaded HEAD from S9 (vec_in norm=0.937384)
[S15] cosine check vs S9: cos=-0.1372
[S15] DROPPED delta from S9 (cos=-0.1372 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:39016
[S17] sending update (kind=head size=1796 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1796) from S17
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.256948)
[S16] loaded HEAD from S17 (vec_in norm=1.256948)
[S16] cosine check vs S17: cos=0.0585
[S16] BUFFERED delta from S17 (total buffered=1)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=3 metric=0.1470 head_norm=0.903645
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.372751e-01
[S4] stored merged vector for next round verification (round=3)
[S4] DEBUG after merge:  round=3 metric=0.1523 head_norm=0.780136 delta_norm=0.737275
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=3 metric=0.1414 head_norm=1.243717
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.917593e-01
[S6] stored merged vector for next round verification (round=3)
[S6] DEBUG after merge:  round=3 metric=0.1414 head_norm=0.759987 delta_norm=0.591759
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=3 metric=0.1406 head_norm=0.767140
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.168735e-01
[S16] stored merged vector for next round verification (round=3)
[S16] DEBUG after merge:  round=3 metric=0.1406 head_norm=0.755185 delta_norm=0.716873
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=3 metric=0.1409 head_norm=1.256948
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.479836e-01
[S17] stored merged vector for next round verification (round=3)
[S17] DEBUG after merge:  round=3 metric=0.1409 head_norm=0.796492 delta_norm=0.747984
[S17] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=1.251531 (no previous merge yet)
[S2] round=4 local utility u=0.031003 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.614513244473514, 'loss_val': 1.1336226450906157, 'psi': 0.3308715778225456}-{'f1_val': 0.1417771333885667, 'auprc': 0.6144456870682494, 'loss_val': 1.1954263702620858, 'psi': 0.3308445548604398}
[S3] START round=4 head_norm_before_train=1.273648 (no previous merge yet)
[S3] round=4 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9670566151633623, 'loss_val': 1.1806800041273386, 'psi': 0.47072668543380913}-{'f1_val': 0.13984006561410703, 'auprc': 0.9983311924555094, 'loss_val': 1.240329071493019, 'psi': 0.483236516350668}
[S4] START round=4 head_norm_before_train=0.780136 cos_to_last_merge=1.0000 (last merge round=3)
[S4] round=4 local utility u=0.500173 metrics={'f1_val': 0.3091674145201514, 'auprc': 0.793532845823671, 'loss_val': 1.2467908538054426, 'psi': 0.5029135870415593}-{'f1_val': 0.14697925420911984, 'auprc': 0.793625388175859, 'loss_val': 1.2742848126024604, 'psi': 0.40563770779581554}
[S5] START round=4 head_norm_before_train=0.740444 cos_to_last_merge=0.9842 (last merge round=1)
[S5] round=4 local utility u=0.008095 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7345802950148469, 'loss_val': 1.2606335544325744, 'psi': 0.37918926086308163}-{'f1_val': 0.14226190476190476, 'auprc': 0.7430726867477386, 'loss_val': 1.3023017023037053, 'psi': 0.38258621755623834}
[S6] START round=4 head_norm_before_train=0.759987 cos_to_last_merge=1.0000 (last merge round=3)
[S6] round=4 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.7894336138138347, 'loss_val': 1.2430739458974893, 'psi': 0.4006292147563031}-{'f1_val': 0.14142628205128205, 'auprc': 0.8036658056303165, 'loss_val': 1.2539004471270396, 'psi': 0.40632209148289583}
[S7] START round=4 head_norm_before_train=0.670541 cos_to_last_merge=0.9935 (last merge round=2)
[S7] round=4 local utility u=0.219837 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7888805479750581, 'loss_val': 1.3088518183576494, 'psi': 0.4007863128274783}-{'f1_val': 0.14205682272909165, 'auprc': 0.6562691622938461, 'loss_val': 1.350690728449261, 'psi': 0.34774175855499345}
[S8] START round=4 head_norm_before_train=1.220850 (no previous merge yet)
[S8] round=4 local utility u=0.043160 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7715081437162757, 'loss_val': 1.2076856599556294, 'psi': 0.3925768469222846}-{'f1_val': 0.13995598239295717, 'auprc': 0.7570306753824861, 'loss_val': 1.2505737136416615, 'psi': 0.3867858595887688}
[S9] START round=4 head_norm_before_train=0.937384 cos_to_last_merge=0.9874 (last merge round=1)
[S9] round=4 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8673607331272257, 'loss_val': 1.1933191945572432, 'psi': 0.43178306753488793}-{'f1_val': 0.141397957139996, 'auprc': 0.8977095551322969, 'loss_val': 1.2508049012372746, 'psi': 0.4439225963369164}
[S10] START round=4 head_norm_before_train=0.866504 cos_to_last_merge=0.9872 (last merge round=1)
[S10] round=4 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.616660133494606, 'loss_val': 1.2263931476861947, 'psi': 0.3298370359228768}-{'f1_val': 0.13862163754172394, 'auprc': 0.6684407581444172, 'loss_val': 1.2881295817323608, 'psi': 0.35054928578280126}
[S11] START round=4 head_norm_before_train=1.235972 (no previous merge yet)
[S11] round=4 local utility u=0.030269 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7628266530601873, 'loss_val': 1.1703789557844049, 'psi': 0.3893788712479413}-{'f1_val': 0.14041368337311058, 'auprc': 0.7629157186843729, 'loss_val': 1.2311850959140846, 'psi': 0.38941449749761553}
[S13] START round=4 head_norm_before_train=1.219754 (no previous merge yet)
[S13] round=4 local utility u=0.094307 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7311147617196811, 'loss_val': 1.1492388907992515, 'psi': 0.3766773622341043}-{'f1_val': 0.1403857625770531, 'auprc': 0.6904490535635015, 'loss_val': 1.2158550424991845, 'psi': 0.36041107897163244}
[S14] START round=4 head_norm_before_train=0.898799 cos_to_last_merge=0.9888 (last merge round=1)
[S14] round=4 local utility u=0.187572 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8659001349586908, 'loss_val': 1.2936785432318298, 'psi': 0.4305747657130986}-{'f1_val': 0.14035785288270378, 'auprc': 0.7517216070973258, 'loss_val': 1.3262878479592992, 'psi': 0.3849033545685526}
[S15] START round=4 head_norm_before_train=0.555596 cos_to_last_merge=0.9924 (last merge round=2)
[S15] round=4 local utility u=0.023762 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.776848835587044, 'loss_val': 1.261687735063337, 'psi': 0.3945797250517526}-{'f1_val': 0.13973365136155833, 'auprc': 0.7746308190242936, 'loss_val': 1.3025570682397074, 'psi': 0.3936925184266525}
[S16] START round=4 head_norm_before_train=0.755185 cos_to_last_merge=1.0000 (last merge round=3)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.6365673627339448, 'loss_val': 1.2568375655064856, 'psi': 0.3390094152130998}-{'f1_val': 0.14063745019920318, 'auprc': 0.7735330456601581, 'loss_val': 1.2723857855427407, 'psi': 0.39379568838358514}
[S17] START round=4 head_norm_before_train=0.796492 cos_to_last_merge=1.0000 (last merge round=3)
[S17] round=4 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5540565607115209, 'loss_val': 1.2265226768213404, 'psi': 0.30619200227503895}-{'f1_val': 0.14094896331738438, 'auprc': 0.8056084470433333, 'loss_val': 1.2418863369619437, 'psi': 0.40681275680776396}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:39002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:39010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:39007
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:39011
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:39004
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1797) from S14
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.931603)
[S17] loaded HEAD from S14 (vec_in norm=0.931603)
[S17] cosine check vs S14: cos=0.5938
[S17] BUFFERED delta from S14 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1798) from S7
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.698850)
[S2] loaded HEAD from S7 (vec_in norm=0.698850)
[S2] cosine check vs S7: cos=-0.0952
[S2] DROPPED delta from S7 (cos=-0.0952 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1796) from S5
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.772425)
[S17] loaded HEAD from S5 (vec_in norm=0.772425)
[S17] cosine check vs S5: cos=-0.0480
[S17] DROPPED delta from S5 (cos=-0.0480 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1799) from S15
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.595182)
[S6] loaded HEAD from S15 (vec_in norm=0.595182)
[S6] cosine check vs S15: cos=0.6189
[S6] BUFFERED delta from S15 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1801) from S13
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.255530)
[S4] loaded HEAD from S13 (vec_in norm=1.255530)
[S4] cosine check vs S13: cos=0.7922
[S4] BUFFERED delta from S13 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1800) from S2
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.278127)
[S9] loaded HEAD from S2 (vec_in norm=1.278127)
[S9] cosine check vs S2: cos=-0.0392
[S9] DROPPED delta from S2 (cos=-0.0392 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1801) from S4
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.810676)
[S10] loaded HEAD from S4 (vec_in norm=0.810676)
[S10] cosine check vs S4: cos=0.1065
[S10] BUFFERED delta from S4 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1802) from S8
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.243957)
[S5] loaded HEAD from S8 (vec_in norm=1.243957)
[S5] cosine check vs S8: cos=-0.0582
[S5] DROPPED delta from S8 (cos=-0.0582 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1796) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.259783)
[S5] loaded HEAD from S11 (vec_in norm=1.259783)
[S5] cosine check vs S11: cos=-0.0047
[S5] DROPPED delta from S11 (cos=-0.0047 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=4 metric=0.1414 head_norm=0.797070
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.171594e-01
[S6] stored merged vector for next round verification (round=4)
[S6] DEBUG after merge:  round=4 metric=0.1414 head_norm=0.627846 delta_norm=0.317159
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=4 metric=0.1386 head_norm=0.903385
[S10] _apply_head_vector_avg (torch): Δ‖w‖=5.738721e-01
[S10] stored merged vector for next round verification (round=4)
[S10] DEBUG after merge:  round=4 metric=0.1386 head_norm=0.638217 delta_norm=0.573872
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=4 metric=0.3092 head_norm=0.810676
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.940170e-01
[S4] stored merged vector for next round verification (round=4)
[S4] DEBUG after merge:  round=4 metric=0.4150 head_norm=0.980575 delta_norm=0.394017
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=4 metric=0.1409 head_norm=0.831779
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.998291e-01
[S17] stored merged vector for next round verification (round=4)
[S17] DEBUG after merge:  round=4 metric=0.1409 head_norm=0.787405 delta_norm=0.399829
[S17] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=1.278127 (no previous merge yet)
[S2] round=5 local utility u=1.000000 metrics={'f1_val': 0.4163869835967063, 'auprc': 0.7762955444327442, 'loss_val': 1.0464022330448595, 'psi': 0.5603504079311215}-{'f1_val': 0.1417771333885667, 'auprc': 0.614513244473514, 'loss_val': 1.1336226450906157, 'psi': 0.3308715778225456}
[S3] START round=5 head_norm_before_train=1.308310 (no previous merge yet)
[S3] round=5 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8464297134840559, 'loss_val': 1.078582328918928, 'psi': 0.4224759247620866}-{'f1_val': 0.13984006561410703, 'auprc': 0.9670566151633623, 'loss_val': 1.1806800041273386, 'psi': 0.47072668543380913}
[S4] START round=5 head_norm_before_train=0.980575 cos_to_last_merge=1.0000 (last merge round=4)
[S4] round=5 local utility u=0.352775 metrics={'f1_val': 0.4148091473984988, 'auprc': 0.7939972354598042, 'loss_val': 1.1764834704865468, 'psi': 0.5664843826230209}-{'f1_val': 0.3091674145201514, 'auprc': 0.793532845823671, 'loss_val': 1.2467908538054426, 'psi': 0.5029135870415593}
[S5] START round=5 head_norm_before_train=0.772425 cos_to_last_merge=0.9675 (last merge round=1)
[S5] round=5 local utility u=0.031535 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7368394038048027, 'loss_val': 1.2043414614290477, 'psi': 0.38009290437906396}-{'f1_val': 0.14226190476190476, 'auprc': 0.7345802950148469, 'loss_val': 1.2606335544325744, 'psi': 0.37918926086308163}
[S6] START round=5 head_norm_before_train=0.627846 cos_to_last_merge=1.0000 (last merge round=4)
[S6] round=5 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6160964270007523, 'loss_val': 1.2278778759244546, 'psi': 0.33129434003107017}-{'f1_val': 0.14142628205128205, 'auprc': 0.7894336138138347, 'loss_val': 1.2430739458974893, 'psi': 0.4006292147563031}
[S7] START round=5 head_norm_before_train=0.698850 cos_to_last_merge=0.9764 (last merge round=2)
[S7] round=5 local utility u=0.025778 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7904321271401505, 'loss_val': 1.2619500007136437, 'psi': 0.4014069444935152}-{'f1_val': 0.14205682272909165, 'auprc': 0.7888805479750581, 'loss_val': 1.3088518183576494, 'psi': 0.4007863128274783}
[S8] START round=5 head_norm_before_train=1.243957 (no previous merge yet)
[S8] round=5 local utility u=0.278533 metrics={'f1_val': 0.2194207355783474, 'auprc': 0.777241985935391, 'loss_val': 1.1446106432453034, 'psi': 0.44254923572116484}-{'f1_val': 0.13995598239295717, 'auprc': 0.7715081437162757, 'loss_val': 1.2076856599556294, 'psi': 0.3925768469222846}
[S9] START round=5 head_norm_before_train=0.968267 cos_to_last_merge=0.9772 (last merge round=1)
[S9] round=5 local utility u=0.034643 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8659660284963782, 'loss_val': 1.1198499004798623, 'psi': 0.4312251856825489}-{'f1_val': 0.141397957139996, 'auprc': 0.8673607331272257, 'loss_val': 1.1933191945572432, 'psi': 0.43178306753488793}
[S10] START round=5 head_norm_before_train=0.638217 cos_to_last_merge=1.0000 (last merge round=4)
[S10] round=5 local utility u=0.005164 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6098598514827761, 'loss_val': 1.1956650769624808, 'psi': 0.3271169231181448}-{'f1_val': 0.13862163754172394, 'auprc': 0.616660133494606, 'loss_val': 1.2263931476861947, 'psi': 0.3298370359228768}
[S11] START round=5 head_norm_before_train=1.259783 (no previous merge yet)
[S11] round=5 local utility u=0.048240 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7662190553547832, 'loss_val': 1.084076440556667, 'psi': 0.3907358321657796}-{'f1_val': 0.14041368337311058, 'auprc': 0.7628266530601873, 'loss_val': 1.1703789557844049, 'psi': 0.3893788712479413}
[S13] START round=5 head_norm_before_train=1.255530 (no previous merge yet)
[S13] round=5 local utility u=0.885926 metrics={'f1_val': 0.41655034241240063, 'auprc': 0.7365070435679518, 'loss_val': 1.0505511529831157, 'psi': 0.5445330228746211}-{'f1_val': 0.1403857625770531, 'auprc': 0.7311147617196811, 'loss_val': 1.1492388907992515, 'psi': 0.3766773622341043}
[S14] START round=5 head_norm_before_train=0.931603 cos_to_last_merge=0.9780 (last merge round=1)
[S14] round=5 local utility u=0.027728 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8672518047596842, 'loss_val': 1.242277374921739, 'psi': 0.43111543363349597}-{'f1_val': 0.14035785288270378, 'auprc': 0.8659001349586908, 'loss_val': 1.2936785432318298, 'psi': 0.4305747657130986}
[S15] START round=5 head_norm_before_train=0.595182 cos_to_last_merge=0.9768 (last merge round=2)
[S15] round=5 local utility u=0.024022 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7770541775161044, 'loss_val': 1.2142604691217425, 'psi': 0.39466186182337676}-{'f1_val': 0.13973365136155833, 'auprc': 0.776848835587044, 'loss_val': 1.261687735063337, 'psi': 0.3945797250517526}
[S16] START round=5 head_norm_before_train=0.786583 cos_to_last_merge=0.9950 (last merge round=3)
[S16] round=5 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.5692510010111, 'loss_val': 1.1971700422306608, 'psi': 0.31208287052396194}-{'f1_val': 0.14063745019920318, 'auprc': 0.6365673627339448, 'loss_val': 1.2568375655064856, 'psi': 0.3390094152130998}
[S17] START round=5 head_norm_before_train=0.787405 cos_to_last_merge=1.0000 (last merge round=4)
[S17] round=5 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5325354532720907, 'loss_val': 1.1875640459857524, 'psi': 0.29758355929926694}-{'f1_val': 0.14094896331738438, 'auprc': 0.5540565607115209, 'loss_val': 1.2265226768213404, 'psi': 0.30619200227503895}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:39014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:39002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:39017
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:39015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:39007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:39004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:39010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S10@127.0.0.1:39011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:39017
[S5] sending update (kind=head size=1794 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1804 to 1 peers)
[S4] sending update (kind=head size=1793 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1794 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1793) from S4
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.005137)
[S10] loaded HEAD from S4 (vec_in norm=1.005137)
[S10] cosine check vs S4: cos=0.6425
[S10] BUFFERED delta from S4 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1798) from S7
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.730807)
[S2] loaded HEAD from S7 (vec_in norm=0.730807)
[S2] cosine check vs S7: cos=-0.0900
[S2] DROPPED delta from S7 (cos=-0.0900 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1804) from S14
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.974836)
[S17] loaded HEAD from S14 (vec_in norm=0.974836)
[S17] cosine check vs S14: cos=0.8747
[S17] BUFFERED delta from S14 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1798) from S15
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.631149)
[S6] loaded HEAD from S15 (vec_in norm=0.631149)
[S6] cosine check vs S15: cos=0.8385
[S6] BUFFERED delta from S15 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1794) from S5
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.812233)
[S17] loaded HEAD from S5 (vec_in norm=0.812233)
[S17] cosine check vs S5: cos=0.0231
[S17] BUFFERED delta from S5 (total buffered=2)
[S4] RECEIVED delta(kind=head bytes=1803) from S13
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.295485)
[S4] loaded HEAD from S13 (vec_in norm=1.295485)
[S4] cosine check vs S13: cos=0.9522
[S4] BUFFERED delta from S13 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1794) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=0.676899)
[S14] loaded HEAD from S10 (vec_in norm=0.676899)
[S14] cosine check vs S10: cos=0.0787
[S14] BUFFERED delta from S10 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1801) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.282146)
[S5] loaded HEAD from S11 (vec_in norm=1.282146)
[S5] cosine check vs S11: cos=-0.0012
[S5] DROPPED delta from S11 (cos=-0.0012 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1799) from S8
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.269402)
[S5] loaded HEAD from S8 (vec_in norm=1.269402)
[S5] cosine check vs S8: cos=-0.0673
[S5] DROPPED delta from S8 (cos=-0.0673 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1794) from S9
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.006589)
[S15] loaded HEAD from S9 (vec_in norm=1.006589)
[S15] cosine check vs S9: cos=-0.1533
[S15] DROPPED delta from S9 (cos=-0.1533 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1800) from S2
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.306561)
[S9] loaded HEAD from S2 (vec_in norm=1.306561)
[S9] cosine check vs S2: cos=-0.0390
[S9] DROPPED delta from S2 (cos=-0.0390 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=5 metric=0.1414 head_norm=0.664938
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.848388e-01
[S6] stored merged vector for next round verification (round=5)
[S6] DEBUG after merge:  round=5 metric=0.1414 head_norm=0.621354 delta_norm=0.184839
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.410 → S17@127.0.0.1:39017
[S3] ⇄ pheromone p=0.364 → S8@127.0.0.1:39009
[S9] ⇄ pheromone p=0.390 → S15@127.0.0.1:39015
[S8] ⇄ pheromone p=0.413 → S5@127.0.0.1:39005
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=5 metric=0.1404 head_norm=0.974836
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.711092e-01
[S14] stored merged vector for next round verification (round=5)
[S14] DEBUG after merge:  round=5 metric=0.1404 head_norm=0.614884 delta_norm=0.571109
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.431 → S17@127.0.0.1:39017
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=5 metric=0.4148 head_norm=1.005137
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.284936e-01
[S4] stored merged vector for next round verification (round=5)
[S4] DEBUG after merge:  round=5 metric=0.4156 head_norm=1.136698 delta_norm=0.228494
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.560 → S10@127.0.0.1:39011
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=5 metric=0.1386 head_norm=0.676899
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.854114e-01
[S10] stored merged vector for next round verification (round=5)
[S10] DEBUG after merge:  round=5 metric=0.1386 head_norm=0.765313 delta_norm=0.385411
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.342 → S14@127.0.0.1:39014
[S15] ⇄ pheromone p=0.339 → S6@127.0.0.1:39007
[S11] ⇄ pheromone p=0.353 → S5@127.0.0.1:39005
[S7] ⇄ pheromone p=0.451 → S2@127.0.0.1:39002
[S5] ⇄ pheromone p=0.414 → S17@127.0.0.1:39017
[S2] ⇄ pheromone p=0.541 → S9@127.0.0.1:39010
[S13] ⇄ pheromone p=0.544 → S4@127.0.0.1:39004
[S16] ⇄ pheromone p=0.354 → S7@127.0.0.1:39008
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=5 metric=0.1409 head_norm=0.815412
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.107179e-01
[S17] stored merged vector for next round verification (round=5)
[S17] DEBUG after merge:  round=5 metric=0.1409 head_norm=0.672193 delta_norm=0.310718
[S17] aggregate: ACCEPT kept=['S14', 'S5'] (k=2/2) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.405 → S16@127.0.0.1:39016
[S2] START round=6 head_norm_before_train=1.306561 (no previous merge yet)
[S2] round=6 local utility u=0.597942 metrics={'f1_val': 0.594374886151287, 'auprc': 0.7768105019309496, 'loss_val': 0.9199914572421525, 'psi': 0.667349132463152}-{'f1_val': 0.4163869835967063, 'auprc': 0.7762955444327442, 'loss_val': 1.0464022330448595, 'psi': 0.5603504079311215}
[S3] START round=6 head_norm_before_train=1.348241 (no previous merge yet)
[S3] round=6 local utility u=1.000000 metrics={'f1_val': 0.39638969140647473, 'auprc': 0.9967891027321203, 'loss_val': 0.929402773546249, 'psi': 0.636549455936733}-{'f1_val': 0.13984006561410703, 'auprc': 0.8464297134840559, 'loss_val': 1.078582328918928, 'psi': 0.4224759247620866}
[S4] START round=6 head_norm_before_train=1.136698 cos_to_last_merge=1.0000 (last merge round=5)
[S4] round=6 local utility u=0.076845 metrics={'f1_val': 0.415625539257981, 'auprc': 0.7942263730145052, 'loss_val': 1.0283792496054676, 'psi': 0.5670658727605906}-{'f1_val': 0.4148091473984988, 'auprc': 0.7939972354598042, 'loss_val': 1.1764834704865468, 'psi': 0.5664843826230209}
[S5] START round=6 head_norm_before_train=0.812233 cos_to_last_merge=0.9474 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.947
[S5] round=6 local utility u=0.149608 metrics={'f1_val': 0.1703440801421625, 'auprc': 0.7525046388468861, 'loss_val': 1.1206143288743113, 'psi': 0.40320830362405197}-{'f1_val': 0.14226190476190476, 'auprc': 0.7368394038048027, 'loss_val': 1.2043414614290477, 'psi': 0.38009290437906396}
[S6] START round=6 head_norm_before_train=0.621354 cos_to_last_merge=1.0000 (last merge round=5)
[S6] round=6 local utility u=0.014375 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6135938854689432, 'loss_val': 1.1916208978710467, 'psi': 0.3302933234183465}-{'f1_val': 0.14142628205128205, 'auprc': 0.6160964270007523, 'loss_val': 1.2278778759244546, 'psi': 0.33129434003107017}
[S7] START round=6 head_norm_before_train=0.730807 cos_to_last_merge=0.9562 (last merge round=2)
[S7] round=6 local utility u=0.034264 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.794807640786836, 'loss_val': 1.206547962103733, 'psi': 0.4031571499521894}-{'f1_val': 0.14205682272909165, 'auprc': 0.7904321271401505, 'loss_val': 1.2619500007136437, 'psi': 0.4014069444935152}
[S8] START round=6 head_norm_before_train=1.269402 (no previous merge yet)
[S8] round=6 local utility u=1.000000 metrics={'f1_val': 0.6724784454596111, 'auprc': 0.7945082613768606, 'loss_val': 1.0599806285079518, 'psi': 0.7212903718265109}-{'f1_val': 0.2194207355783474, 'auprc': 0.777241985935391, 'loss_val': 1.1446106432453034, 'psi': 0.44254923572116484}
[S9] START round=6 head_norm_before_train=1.006589 cos_to_last_merge=0.9654 (last merge round=1)
[S9] round=6 local utility u=0.076644 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8659712025059496, 'loss_val': 0.9665768197887329, 'psi': 0.43122725528637745}-{'f1_val': 0.141397957139996, 'auprc': 0.8659660284963782, 'loss_val': 1.1198499004798623, 'psi': 0.4312251856825489}
[S10] START round=6 head_norm_before_train=0.765313 cos_to_last_merge=1.0000 (last merge round=5)
[S10] round=6 local utility u=0.035991 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.609808142646143, 'loss_val': 1.1235270979092584, 'psi': 0.32709623958349154}-{'f1_val': 0.13862163754172394, 'auprc': 0.6098598514827761, 'loss_val': 1.1956650769624808, 'psi': 0.3271169231181448}
[S11] START round=6 head_norm_before_train=1.282146 (no previous merge yet)
[S11] round=6 local utility u=0.923945 metrics={'f1_val': 0.42264301917280384, 'auprc': 0.773457378252369, 'loss_val': 0.95127739930702, 'psi': 0.5629687628046299}-{'f1_val': 0.14041368337311058, 'auprc': 0.7662190553547832, 'loss_val': 1.084076440556667, 'psi': 0.3907358321657796}
[S13] START round=6 head_norm_before_train=1.295485 (no previous merge yet)
[S13] round=6 local utility u=0.000000 metrics={'f1_val': 0.3716637628096784, 'auprc': 0.7573355272708264, 'loss_val': 0.9064595158398356, 'psi': 0.5259324685941377}-{'f1_val': 0.41655034241240063, 'auprc': 0.7365070435679518, 'loss_val': 1.0505511529831157, 'psi': 0.5445330228746211}
[S14] START round=6 head_norm_before_train=0.614884 cos_to_last_merge=1.0000 (last merge round=5)
[S14] round=6 local utility u=0.041843 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8871214701287358, 'loss_val': 1.2181997796378525, 'psi': 0.4390632997811166}-{'f1_val': 0.14035785288270378, 'auprc': 0.8672518047596842, 'loss_val': 1.242277374921739, 'psi': 0.43111543363349597}
[S15] START round=6 head_norm_before_train=0.631149 cos_to_last_merge=0.9599 (last merge round=2)
[S15] round=6 local utility u=0.860880 metrics={'f1_val': 0.41093575636524216, 'auprc': 0.7769958190199268, 'loss_val': 1.1195374918381384, 'psi': 0.5573597814271161}-{'f1_val': 0.13973365136155833, 'auprc': 0.7770541775161044, 'loss_val': 1.2142604691217425, 'psi': 0.39466186182337676}
[S16] START round=6 head_norm_before_train=0.827812 cos_to_last_merge=0.9809 (last merge round=3)
[S16] round=6 local utility u=1.000000 metrics={'f1_val': 0.4166416798666154, 'auprc': 0.6481300660416113, 'loss_val': 1.0738687137319585, 'psi': 0.5092370343366137}-{'f1_val': 0.14063745019920318, 'auprc': 0.5692510010111, 'loss_val': 1.1971700422306608, 'psi': 0.31208287052396194}
[S17] START round=6 head_norm_before_train=0.672193 cos_to_last_merge=1.0000 (last merge round=5)
[S17] round=6 local utility u=0.286447 metrics={'f1_val': 0.2272702922040915, 'auprc': 0.5315532342745363, 'loss_val': 1.1296521491128746, 'psi': 0.3489834690322694}-{'f1_val': 0.14094896331738438, 'auprc': 0.5325354532720907, 'loss_val': 1.1875640459857524, 'psi': 0.29758355929926694}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:39011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:39010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S7@127.0.0.1:39008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:39009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:39002
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:39007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] → sending delta(kind=head bytes=1793) to S14@127.0.0.1:39014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] → sending delta(kind=head bytes=1792) to S15@127.0.0.1:39015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:39017
[S5] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1793 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1792 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S16] sending update (kind=head size=1794 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1796) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.656958)
[S17] loaded HEAD from S6 (vec_in norm=0.656958)
[S17] cosine check vs S6: cos=0.1990
[S17] BUFFERED delta from S6 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1793) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=0.793942)
[S14] loaded HEAD from S10 (vec_in norm=0.793942)
[S14] cosine check vs S10: cos=0.4965
[S14] BUFFERED delta from S10 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1794) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.861832)
[S7] loaded HEAD from S16 (vec_in norm=0.861832)
[S7] cosine check vs S16: cos=-0.1486
[S7] DROPPED delta from S16 (cos=-0.1486 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1804) from S3
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.386578)
[S8] loaded HEAD from S3 (vec_in norm=1.386578)
[S8] cosine check vs S3: cos=-0.0104
[S8] DROPPED delta from S3 (cos=-0.0104 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1799) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.315103)
[S5] loaded HEAD from S11 (vec_in norm=1.315103)
[S5] cosine check vs S11: cos=0.0013
[S5] BUFFERED delta from S11 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1797) from S15
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.675651)
[S6] loaded HEAD from S15 (vec_in norm=0.675651)
[S6] cosine check vs S15: cos=0.9266
[S6] BUFFERED delta from S15 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1792) from S9
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.049440)
[S15] loaded HEAD from S9 (vec_in norm=1.049440)
[S15] cosine check vs S9: cos=-0.1659
[S15] DROPPED delta from S9 (cos=-0.1659 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1797) from S8
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.291711)
[S5] loaded HEAD from S8 (vec_in norm=1.291711)
[S5] cosine check vs S8: cos=-0.0726
[S5] DROPPED delta from S8 (cos=-0.0726 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1796) from S7
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.764119)
[S2] loaded HEAD from S7 (vec_in norm=0.764119)
[S2] cosine check vs S7: cos=-0.0844
[S2] DROPPED delta from S7 (cos=-0.0844 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1796) from S2
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.341686)
[S9] loaded HEAD from S2 (vec_in norm=1.341686)
[S9] cosine check vs S2: cos=-0.0393
[S9] DROPPED delta from S2 (cos=-0.0393 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1797) from S4
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.159383)
[S10] loaded HEAD from S4 (vec_in norm=1.159383)
[S10] cosine check vs S4: cos=0.8953
[S10] BUFFERED delta from S4 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1797) from S14
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.658337)
[S17] loaded HEAD from S14 (vec_in norm=0.658337)
[S17] cosine check vs S14: cos=0.8234
[S17] BUFFERED delta from S14 (total buffered=2)
[S17] RECEIVED delta(kind=head bytes=1799) from S5
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.852204)
[S17] loaded HEAD from S5 (vec_in norm=0.852204)
[S17] cosine check vs S5: cos=0.3288
[S17] BUFFERED delta from S5 (total buffered=3)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:39016
[S17] sending update (kind=head size=1796 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1796) from S17
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.699024)
[S16] loaded HEAD from S17 (vec_in norm=0.699024)
[S16] cosine check vs S17: cos=0.2614
[S16] BUFFERED delta from S17 (total buffered=1)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=6 metric=0.1404 head_norm=0.658337
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.690290e-01
[S14] stored merged vector for next round verification (round=6)
[S14] DEBUG after merge:  round=6 metric=0.1404 head_norm=0.629042 delta_norm=0.369029
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=6 metric=0.1414 head_norm=0.656958
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.279392e-01
[S6] stored merged vector for next round verification (round=6)
[S6] DEBUG after merge:  round=6 metric=0.1414 head_norm=0.653973 delta_norm=0.127939
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=6 metric=0.4166 head_norm=0.861832
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.786599e-01
[S16] stored merged vector for next round verification (round=6)
[S16] DEBUG after merge:  round=6 metric=0.4174 head_norm=0.621755 delta_norm=0.478660
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=6 metric=0.1703 head_norm=0.852204
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.830831e-01
[S5] stored merged vector for next round verification (round=6)
[S5] DEBUG after merge:  round=6 metric=0.1423 head_norm=0.783999 delta_norm=0.783083
[S5] aggregate: ROLLBACK (f1_val pre=0.170 post=0.142 tol_abs=0.005 tol_rel=0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=6 metric=0.1386 head_norm=0.793942
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.856495e-01
[S10] stored merged vector for next round verification (round=6)
[S10] DEBUG after merge:  round=6 metric=0.1386 head_norm=0.951662 delta_norm=0.285649
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=6 metric=0.2273 head_norm=0.699024
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.385360e-01
[S17] stored merged vector for next round verification (round=6)
[S17] DEBUG after merge:  round=6 metric=0.1409 head_norm=0.564713 delta_norm=0.238536
[S17] aggregate: ROLLBACK (f1_val pre=0.227 post=0.141 tol_abs=0.005 tol_rel=0.0)
[S2] START round=7 head_norm_before_train=1.341686 (no previous merge yet)
[S2] round=7 local utility u=0.431998 metrics={'f1_val': 0.7144370663918894, 'auprc': 0.7782803967304146, 'loss_val': 0.7807789074217789, 'psi': 0.7399743985272995}-{'f1_val': 0.594374886151287, 'auprc': 0.7768105019309496, 'loss_val': 0.9199914572421525, 'psi': 0.667349132463152}
[S3] START round=7 head_norm_before_train=1.386578 (no previous merge yet)
[S3] round=7 local utility u=0.051903 metrics={'f1_val': 0.3918832853705713, 'auprc': 0.9965437445743288, 'loss_val': 0.7978224910944185, 'psi': 0.6337474690520744}-{'f1_val': 0.39638969140647473, 'auprc': 0.9967891027321203, 'loss_val': 0.929402773546249, 'psi': 0.636549455936733}
[S4] START round=7 head_norm_before_train=1.159383 cos_to_last_merge=0.9975 (last merge round=5)
[S4] round=7 local utility u=0.084555 metrics={'f1_val': 0.4139930282181375, 'auprc': 0.7941256534254529, 'loss_val': 0.8491718483736573, 'psi': 0.5660460783010637}-{'f1_val': 0.415625539257981, 'auprc': 0.7942263730145052, 'loss_val': 1.0283792496054676, 'psi': 0.5670658727605906}
[S5] START round=7 head_norm_before_train=0.783999 cos_to_last_merge=1.0000 (last merge round=6)
[S5] round=7 local utility u=0.698406 metrics={'f1_val': 0.4177505557824055, 'auprc': 0.7141664753173964, 'loss_val': 1.0932270682271656, 'psi': 0.5363169235964018}-{'f1_val': 0.1703440801421625, 'auprc': 0.7525046388468861, 'loss_val': 1.1206143288743113, 'psi': 0.40320830362405197}
[S6] START round=7 head_norm_before_train=0.653973 cos_to_last_merge=1.0000 (last merge round=6)
[S6] round=7 local utility u=1.000000 metrics={'f1_val': 0.41463700409720844, 'auprc': 0.7112880868808392, 'loss_val': 1.1071580495309696, 'psi': 0.5332974372106607}-{'f1_val': 0.14142628205128205, 'auprc': 0.6135938854689432, 'loss_val': 1.1916208978710467, 'psi': 0.3302933234183465}
[S7] START round=7 head_norm_before_train=0.764119 cos_to_last_merge=0.9379 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.938
[S7] round=7 local utility u=0.023875 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7776673788734213, 'loss_val': 1.1073771876149061, 'psi': 0.3963010451868235}-{'f1_val': 0.14205682272909165, 'auprc': 0.794807640786836, 'loss_val': 1.206547962103733, 'psi': 0.4031571499521894}
[S8] START round=7 head_norm_before_train=1.291711 (no previous merge yet)
[S8] round=7 local utility u=0.217278 metrics={'f1_val': 0.7144151859135719, 'auprc': 0.7943381447518593, 'loss_val': 0.8765344902106101, 'psi': 0.7463843694488869}-{'f1_val': 0.6724784454596111, 'auprc': 0.7945082613768606, 'loss_val': 1.0599806285079518, 'psi': 0.7212903718265109}
[S9] START round=7 head_norm_before_train=1.049440 cos_to_last_merge=0.9533 (last merge round=1)
[S9] round=7 local utility u=1.000000 metrics={'f1_val': 0.700521824310019, 'auprc': 0.9482089344980589, 'loss_val': 0.7927547390161098, 'psi': 0.7995966683852349}-{'f1_val': 0.141397957139996, 'auprc': 0.8659712025059496, 'loss_val': 0.9665768197887329, 'psi': 0.43122725528637745}
[S10] START round=7 head_norm_before_train=0.951662 cos_to_last_merge=1.0000 (last merge round=6)
[S10] round=7 local utility u=1.000000 metrics={'f1_val': 0.4377075811882871, 'auprc': 0.7873294925733677, 'loss_val': 0.9903648394162965, 'psi': 0.5775563457423194}-{'f1_val': 0.13862163754172394, 'auprc': 0.609808142646143, 'loss_val': 1.1235270979092584, 'psi': 0.32709623958349154}
[S11] START round=7 head_norm_before_train=1.315103 (no previous merge yet)
[S11] round=7 local utility u=0.172257 metrics={'f1_val': 0.39651855440916606, 'auprc': 0.8951178472892986, 'loss_val': 0.8149972903494058, 'psi': 0.595958271561219}-{'f1_val': 0.42264301917280384, 'auprc': 0.773457378252369, 'loss_val': 0.95127739930702, 'psi': 0.5629687628046299}
[S13] START round=7 head_norm_before_train=1.332799 (no previous merge yet)
[S13] round=7 local utility u=0.082381 metrics={'f1_val': 0.3732260285257306, 'auprc': 0.7696141133391189, 'loss_val': 0.7879075697660202, 'psi': 0.5317812624510859}-{'f1_val': 0.3716637628096784, 'auprc': 0.7573355272708264, 'loss_val': 0.9064595158398356, 'psi': 0.5259324685941377}
[S14] START round=7 head_norm_before_train=0.629042 cos_to_last_merge=1.0000 (last merge round=6)
[S14] round=7 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7761149475524091, 'loss_val': 1.183470001744323, 'psi': 0.3946606907505859}-{'f1_val': 0.14035785288270378, 'auprc': 0.8871214701287358, 'loss_val': 1.2181997796378525, 'psi': 0.4390632997811166}
[S15] START round=7 head_norm_before_train=0.675651 cos_to_last_merge=0.9377 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.938
[S15] round=7 local utility u=0.100083 metrics={'f1_val': 0.41680775938714587, 'auprc': 0.7770563247176889, 'loss_val': 0.9547847776847668, 'psi': 0.560907185519363}-{'f1_val': 0.41093575636524216, 'auprc': 0.7769958190199268, 'loss_val': 1.1195374918381384, 'psi': 0.5573597814271161}
[S16] START round=7 head_norm_before_train=0.621755 cos_to_last_merge=1.0000 (last merge round=6)
[S16] round=7 local utility u=0.126712 metrics={'f1_val': 0.4170779150236796, 'auprc': 0.7228002686737375, 'loss_val': 1.047073090373748, 'psi': 0.5393668564837028}-{'f1_val': 0.4166416798666154, 'auprc': 0.6481300660416113, 'loss_val': 1.0738687137319585, 'psi': 0.5092370343366137}
[S17] START round=7 head_norm_before_train=0.564713 cos_to_last_merge=1.0000 (last merge round=6)
[S17] round=7 local utility u=0.549426 metrics={'f1_val': 0.38142698781076273, 'auprc': 0.5765339786376755, 'loss_val': 1.090683268140513, 'psi': 0.45946978414152784}-{'f1_val': 0.2272702922040915, 'auprc': 0.5315532342745363, 'loss_val': 1.1296521491128746, 'psi': 0.3489834690322694}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:39007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S10] → sending delta(kind=head bytes=1788) to S14@127.0.0.1:39014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:39015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:39004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:39008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:39010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:39011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:39005
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:39002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:39009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:39017
[S5] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1788 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1804 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1793 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1793) from S9
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.095053)
[S15] loaded HEAD from S9 (vec_in norm=1.095053)
[S15] cosine check vs S9: cos=-0.1745
[S15] DROPPED delta from S9 (cos=-0.1745 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1796) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.660590)
[S7] loaded HEAD from S16 (vec_in norm=0.660590)
[S7] cosine check vs S16: cos=-0.1753
[S7] DROPPED delta from S16 (cos=-0.1753 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1800) from S5
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.813234)
[S17] loaded HEAD from S5 (vec_in norm=0.813234)
[S17] cosine check vs S5: cos=0.2351
[S17] BUFFERED delta from S5 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1801) from S3
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.429627)
[S8] loaded HEAD from S3 (vec_in norm=1.429627)
[S8] cosine check vs S3: cos=-0.0104
[S8] DROPPED delta from S3 (cos=-0.0104 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1802) from S15
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.734589)
[S6] loaded HEAD from S15 (vec_in norm=0.734589)
[S6] cosine check vs S15: cos=0.9568
[S6] BUFFERED delta from S15 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1798) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.687637)
[S17] loaded HEAD from S6 (vec_in norm=0.687637)
[S17] cosine check vs S6: cos=0.3187
[S17] BUFFERED delta from S6 (total buffered=2)
[S4] RECEIVED delta(kind=head bytes=1801) from S13
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.372740)
[S4] loaded HEAD from S13 (vec_in norm=1.372740)
[S4] cosine check vs S13: cos=0.9638
[S4] BUFFERED delta from S13 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1797) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.350951)
[S5] loaded HEAD from S11 (vec_in norm=1.350951)
[S5] cosine check vs S11: cos=0.8125
[S5] BUFFERED delta from S11 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1801) from S8
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.329479)
[S5] loaded HEAD from S8 (vec_in norm=1.329479)
[S5] cosine check vs S8: cos=-0.0746
[S5] DROPPED delta from S8 (cos=-0.0746 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1795) from S7
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.797343)
[S2] loaded HEAD from S7 (vec_in norm=0.797343)
[S2] cosine check vs S7: cos=-0.0796
[S2] DROPPED delta from S7 (cos=-0.0796 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1804) from S2
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.384690)
[S9] loaded HEAD from S2 (vec_in norm=1.384690)
[S9] cosine check vs S2: cos=-0.0390
[S9] DROPPED delta from S2 (cos=-0.0390 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1798) from S4
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.195820)
[S10] loaded HEAD from S4 (vec_in norm=1.195820)
[S10] cosine check vs S4: cos=0.9669
[S10] BUFFERED delta from S4 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1788) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=0.980018)
[S14] loaded HEAD from S10 (vec_in norm=0.980018)
[S14] cosine check vs S10: cos=0.8012
[S14] BUFFERED delta from S10 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:39016
[S17] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S17
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.597940)
[S16] loaded HEAD from S17 (vec_in norm=0.597940)
[S16] cosine check vs S17: cos=0.6633
[S16] BUFFERED delta from S17 (total buffered=1)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=7 metric=0.1404 head_norm=0.664646
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.993517e-01
[S14] stored merged vector for next round verification (round=7)
[S14] DEBUG after merge:  round=7 metric=0.1404 head_norm=0.781974 delta_norm=0.299352
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=7 metric=0.4146 head_norm=0.687637
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.071027e-01
[S6] stored merged vector for next round verification (round=7)
[S6] DEBUG after merge:  round=7 metric=0.3785 head_norm=0.703393 delta_norm=0.107103
[S6] aggregate: ROLLBACK (f1_val pre=0.415 post=0.378 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=7 metric=0.4178 head_norm=0.813234
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.186366e-01
[S5] stored merged vector for next round verification (round=7)
[S5] DEBUG after merge:  round=7 metric=0.4175 head_norm=1.033418 delta_norm=0.418637
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=7 metric=0.4140 head_norm=1.195820
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.936482e-01
[S4] stored merged vector for next round verification (round=7)
[S4] DEBUG after merge:  round=7 metric=0.4140 head_norm=1.272674 delta_norm=0.193648
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=7 metric=0.4377 head_norm=0.980018
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.760991e-01
[S10] stored merged vector for next round verification (round=7)
[S10] DEBUG after merge:  round=7 metric=0.4376 head_norm=1.078981 delta_norm=0.176099
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=7 metric=0.4171 head_norm=0.660590
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.597477e-01
[S16] stored merged vector for next round verification (round=7)
[S16] DEBUG after merge:  round=7 metric=0.4364 head_norm=0.574009 delta_norm=0.259748
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=7 metric=0.3814 head_norm=0.597940
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.105018e-01
[S17] stored merged vector for next round verification (round=7)
[S17] DEBUG after merge:  round=7 metric=0.3498 head_norm=0.468072 delta_norm=0.310502
[S17] aggregate: ROLLBACK (f1_val pre=0.381 post=0.350 tol_abs=0.005 tol_rel=0.0)
[S2] START round=8 head_norm_before_train=1.384690 (no previous merge yet)
[S2] round=8 local utility u=0.056933 metrics={'f1_val': 0.7130704937958028, 'auprc': 0.7784431813468617, 'loss_val': 0.6592028030266042, 'psi': 0.7392195688162264}-{'f1_val': 0.7144370663918894, 'auprc': 0.7782803967304146, 'loss_val': 0.7807789074217789, 'psi': 0.7399743985272995}
[S3] START round=8 head_norm_before_train=1.429627 (no previous merge yet)
[S3] round=8 local utility u=0.422528 metrics={'f1_val': 0.5203321492964053, 'auprc': 0.9890225093184224, 'loss_val': 0.7008968535165703, 'psi': 0.7078082933052121}-{'f1_val': 0.3918832853705713, 'auprc': 0.9965437445743288, 'loss_val': 0.7978224910944185, 'psi': 0.6337474690520744}
[S4] START round=8 head_norm_before_train=1.272674 cos_to_last_merge=1.0000 (last merge round=7)
[S4] round=8 local utility u=0.000000 metrics={'f1_val': 0.4126791804955305, 'auprc': 0.6710904770073987, 'loss_val': 0.7595997906839664, 'psi': 0.5160436991002778}-{'f1_val': 0.4139930282181375, 'auprc': 0.7941256534254529, 'loss_val': 0.8491718483736573, 'psi': 0.5660460783010637}
[S5] START round=8 head_norm_before_train=1.033418 cos_to_last_merge=1.0000 (last merge round=7)
[S5] round=8 local utility u=0.000000 metrics={'f1_val': 0.4173865207428088, 'auprc': 0.6202564829647227, 'loss_val': 1.02815310705338, 'psi': 0.4985345056315743}-{'f1_val': 0.4177505557824055, 'auprc': 0.7141664753173964, 'loss_val': 1.0932270682271656, 'psi': 0.5363169235964018}
[S6] START round=8 head_norm_before_train=0.703393 cos_to_last_merge=1.0000 (last merge round=7)
[S6] round=8 local utility u=0.056046 metrics={'f1_val': 0.4172560359570804, 'auprc': 0.7088438790667356, 'loss_val': 1.0034470047258794, 'psi': 0.5338911732009425}-{'f1_val': 0.41463700409720844, 'auprc': 0.7112880868808392, 'loss_val': 1.1071580495309696, 'psi': 0.5332974372106607}
[S7] START round=8 head_norm_before_train=0.797343 cos_to_last_merge=0.9213 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.921
[S7] round=8 local utility u=0.709125 metrics={'f1_val': 0.41703542715461484, 'auprc': 0.6601612380389328, 'loss_val': 0.9864800974376414, 'psi': 0.514285751508342}-{'f1_val': 0.14205682272909165, 'auprc': 0.7776673788734213, 'loss_val': 1.1073771876149061, 'psi': 0.3963010451868235}
[S8] START round=8 head_norm_before_train=1.329479 (no previous merge yet)
[S8] round=8 local utility u=0.076250 metrics={'f1_val': 0.7142391053978291, 'auprc': 0.7940459210654532, 'loss_val': 0.7221014427070291, 'psi': 0.7461618316648788}-{'f1_val': 0.7144151859135719, 'auprc': 0.7943381447518593, 'loss_val': 0.8765344902106101, 'psi': 0.7463843694488869}
[S9] START round=8 head_norm_before_train=1.095053 cos_to_last_merge=0.9411 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.941
[S9] round=8 local utility u=0.000000 metrics={'f1_val': 0.7007683179598201, 'auprc': 0.8839190744293752, 'loss_val': 0.6645953228662008, 'psi': 0.7740286205476421}-{'f1_val': 0.700521824310019, 'auprc': 0.9482089344980589, 'loss_val': 0.7927547390161098, 'psi': 0.7995966683852349}
[S10] START round=8 head_norm_before_train=1.078981 cos_to_last_merge=1.0000 (last merge round=7)
[S10] round=8 local utility u=0.000000 metrics={'f1_val': 0.39594243073959784, 'auprc': 0.7067083119528208, 'loss_val': 0.843931828362669, 'psi': 0.520248783224887}-{'f1_val': 0.4377075811882871, 'auprc': 0.7873294925733677, 'loss_val': 0.9903648394162965, 'psi': 0.5775563457423194}
[S11] START round=8 head_norm_before_train=1.350951 (no previous merge yet)
[S11] round=8 local utility u=0.234135 metrics={'f1_val': 0.4103371653312913, 'auprc': 0.9932389251228382, 'loss_val': 0.7240018719830921, 'psi': 0.6434978692479101}-{'f1_val': 0.39651855440916606, 'auprc': 0.8951178472892986, 'loss_val': 0.8149972903494058, 'psi': 0.595958271561219}
[S13] START round=8 head_norm_before_train=1.372740 (no previous merge yet)
[S13] round=8 local utility u=0.000000 metrics={'f1_val': 0.4140336504453284, 'auprc': 0.6556825068531102, 'loss_val': 0.7843227085381609, 'psi': 0.5106931930084411}-{'f1_val': 0.3732260285257306, 'auprc': 0.7696141133391189, 'loss_val': 0.7879075697660202, 'psi': 0.5317812624510859}
[S14] START round=8 head_norm_before_train=0.781974 cos_to_last_merge=1.0000 (last merge round=7)
[S14] round=8 local utility u=0.356770 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.9874601817822722, 'loss_val': 1.1039656073384752, 'psi': 0.47919878444253117}-{'f1_val': 0.14035785288270378, 'auprc': 0.7761149475524091, 'loss_val': 1.183470001744323, 'psi': 0.3946606907505859}
[S15] START round=8 head_norm_before_train=0.734589 cos_to_last_merge=0.9110 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.911
[S15] round=8 local utility u=0.761363 metrics={'f1_val': 0.6388182605870024, 'auprc': 0.7811381771645168, 'loss_val': 0.7763664800229104, 'psi': 0.6957462272180082}-{'f1_val': 0.41680775938714587, 'auprc': 0.7770563247176889, 'loss_val': 0.9547847776847668, 'psi': 0.560907185519363}
[S16] START round=8 head_norm_before_train=0.574009 cos_to_last_merge=1.0000 (last merge round=7)
[S16] round=8 local utility u=0.000000 metrics={'f1_val': 0.4168831021970758, 'auprc': 0.5464826808779495, 'loss_val': 1.0298996887372327, 'psi': 0.4687229336694253}-{'f1_val': 0.4170779150236796, 'auprc': 0.7228002686737375, 'loss_val': 1.047073090373748, 'psi': 0.5393668564837028}
[S17] START round=8 head_norm_before_train=0.468072 cos_to_last_merge=1.0000 (last merge round=7)
[S17] round=8 local utility u=0.100131 metrics={'f1_val': 0.3892045086510505, 'auprc': 0.6242231980400874, 'loss_val': 1.080154409260298, 'psi': 0.48321198440666524}-{'f1_val': 0.38142698781076273, 'auprc': 0.5765339786376755, 'loss_val': 1.090683268140513, 'psi': 0.45946978414152784}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:39007
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:39017
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:39010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:39005
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:39005
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:39009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:39002
[S11] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1793 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S3
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.476906)
[S8] loaded HEAD from S3 (vec_in norm=1.476906)
[S8] cosine check vs S3: cos=-0.0096
[S8] DROPPED delta from S3 (cos=-0.0096 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1801) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.390849)
[S5] loaded HEAD from S11 (vec_in norm=1.390849)
[S5] cosine check vs S11: cos=0.9561
[S5] BUFFERED delta from S11 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1793) from S15
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.804804)
[S6] loaded HEAD from S15 (vec_in norm=0.804804)
[S6] cosine check vs S15: cos=0.9677
[S6] BUFFERED delta from S15 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1795) from S7
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.830396)
[S2] loaded HEAD from S7 (vec_in norm=0.830396)
[S2] cosine check vs S7: cos=-0.0779
[S2] DROPPED delta from S7 (cos=-0.0779 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1800) from S8
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.376939)
[S5] loaded HEAD from S8 (vec_in norm=1.376939)
[S5] cosine check vs S8: cos=-0.0481
[S5] DROPPED delta from S8 (cos=-0.0481 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1804) from S2
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.431936)
[S9] loaded HEAD from S2 (vec_in norm=1.431936)
[S9] cosine check vs S2: cos=-0.0385
[S9] DROPPED delta from S2 (cos=-0.0385 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1799) from S14
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.807587)
[S17] loaded HEAD from S14 (vec_in norm=0.807587)
[S17] cosine check vs S14: cos=0.3984
[S17] BUFFERED delta from S14 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1799) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.738034)
[S17] loaded HEAD from S6 (vec_in norm=0.738034)
[S17] cosine check vs S6: cos=0.4788
[S17] BUFFERED delta from S6 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:39016
[S17] sending update (kind=head size=1803 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1803) from S17
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.511178)
[S16] loaded HEAD from S17 (vec_in norm=0.511178)
[S16] cosine check vs S17: cos=0.7653
[S16] BUFFERED delta from S17 (total buffered=1)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=8 metric=0.4174 head_norm=1.056578
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.454047e-01
[S5] stored merged vector for next round verification (round=8)
[S5] DEBUG after merge:  round=8 metric=0.4174 head_norm=1.210449 delta_norm=0.245405
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=8 metric=0.4173 head_norm=0.738034
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.034487e-01
[S6] stored merged vector for next round verification (round=8)
[S6] DEBUG after merge:  round=8 metric=0.4173 head_norm=0.765180 delta_norm=0.103449
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=8 metric=0.4169 head_norm=0.613082
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.984397e-01
[S16] stored merged vector for next round verification (round=8)
[S16] DEBUG after merge:  round=8 metric=0.4169 head_norm=0.528401 delta_norm=0.198440
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=8 metric=0.3892 head_norm=0.511178
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.455777e-01
[S17] stored merged vector for next round verification (round=8)
[S17] DEBUG after merge:  round=8 metric=0.3893 head_norm=0.482554 delta_norm=0.245578
[S17] aggregate: ACCEPT kept=['S14', 'S6'] (k=2/2) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.431936 (no previous merge yet)
[S2] round=9 local utility u=0.042543 metrics={'f1_val': 0.7136689859212908, 'auprc': 0.7774468517333646, 'loss_val': 0.57471843713094, 'psi': 0.7391801322461203}-{'f1_val': 0.7130704937958028, 'auprc': 0.7784431813468617, 'loss_val': 0.6592028030266042, 'psi': 0.7392195688162264}
[S3] START round=9 head_norm_before_train=1.476906 (no previous merge yet)
[S3] round=9 local utility u=0.285823 metrics={'f1_val': 0.5959106908505537, 'auprc': 0.9925718234342136, 'loss_val': 0.5933704891792898, 'psi': 0.7545751438840176}-{'f1_val': 0.5203321492964053, 'auprc': 0.9890225093184224, 'loss_val': 0.7008968535165703, 'psi': 0.7078082933052121}
[S4] START round=9 head_norm_before_train=1.306242 cos_to_last_merge=0.9978 (last merge round=7)
[S4] round=9 local utility u=0.845838 metrics={'f1_val': 0.6807990669090032, 'auprc': 0.6790797906399254, 'loss_val': 0.7006104563142596, 'psi': 0.6801113564013721}-{'f1_val': 0.4126791804955305, 'auprc': 0.6710904770073987, 'loss_val': 0.7595997906839664, 'psi': 0.5160436991002778}
[S5] START round=9 head_norm_before_train=1.210449 cos_to_last_merge=1.0000 (last merge round=8)
[S5] round=9 local utility u=0.250070 metrics={'f1_val': 0.4173865207428088, 'auprc': 0.7713004666247198, 'loss_val': 0.9811454563087317, 'psi': 0.5589520990955732}-{'f1_val': 0.4173865207428088, 'auprc': 0.6202564829647227, 'loss_val': 1.02815310705338, 'psi': 0.4985345056315743}
[S6] START round=9 head_norm_before_train=0.765180 cos_to_last_merge=1.0000 (last merge round=8)
[S6] round=9 local utility u=0.164888 metrics={'f1_val': 0.37166184454659834, 'auprc': 0.8682268616484813, 'loss_val': 0.8782539709139968, 'psi': 0.5702878513873515}-{'f1_val': 0.4172560359570804, 'auprc': 0.7088438790667356, 'loss_val': 1.0034470047258794, 'psi': 0.5338911732009425}
[S7] START round=9 head_norm_before_train=0.830396 cos_to_last_merge=0.9047 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.905
[S7] round=9 local utility u=0.670908 metrics={'f1_val': 0.5620849426595087, 'auprc': 0.7873725550519538, 'loss_val': 0.8965956534625759, 'psi': 0.6521999876164868}-{'f1_val': 0.41703542715461484, 'auprc': 0.6601612380389328, 'loss_val': 0.9864800974376414, 'psi': 0.514285751508342}
[S8] START round=9 head_norm_before_train=1.376939 (no previous merge yet)
[S8] round=9 local utility u=0.098536 metrics={'f1_val': 0.7000326645897077, 'auprc': 0.8354300021298342, 'loss_val': 0.5639433343261361, 'psi': 0.7541915996057583}-{'f1_val': 0.7142391053978291, 'auprc': 0.7940459210654532, 'loss_val': 0.7221014427070291, 'psi': 0.7461618316648788}
[S9] START round=9 head_norm_before_train=1.148107 cos_to_last_merge=0.9268 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.927
[S9] round=9 local utility u=0.237170 metrics={'f1_val': 0.7012675768428742, 'auprc': 0.9994353183050453, 'loss_val': 0.5397989348060993, 'psi': 0.8205346734277426}-{'f1_val': 0.7007683179598201, 'auprc': 0.8839190744293752, 'loss_val': 0.6645953228662008, 'psi': 0.7740286205476421}
[S10] START round=9 head_norm_before_train=1.111606 cos_to_last_merge=0.9961 (last merge round=7)
[S10] round=9 local utility u=0.232018 metrics={'f1_val': 0.40698952528367704, 'auprc': 0.8018322638279961, 'loss_val': 0.7315503135664289, 'psi': 0.5649266207014048}-{'f1_val': 0.39594243073959784, 'auprc': 0.7067083119528208, 'loss_val': 0.843931828362669, 'psi': 0.520248783224887}
[S11] START round=9 head_norm_before_train=1.390849 (no previous merge yet)
[S11] round=9 local utility u=0.746780 metrics={'f1_val': 0.6339413803165928, 'auprc': 0.9965377018625915, 'loss_val': 0.5819642661579866, 'psi': 0.7789799089349922}-{'f1_val': 0.4103371653312913, 'auprc': 0.9932389251228382, 'loss_val': 0.7240018719830921, 'psi': 0.6434978692479101}
[S13] START round=9 head_norm_before_train=1.410157 (no previous merge yet)
[S13] round=9 local utility u=1.000000 metrics={'f1_val': 0.7094211880166909, 'auprc': 0.7700712219098229, 'loss_val': 0.575006654519499, 'psi': 0.7336812015739437}-{'f1_val': 0.4140336504453284, 'auprc': 0.6556825068531102, 'loss_val': 0.7843227085381609, 'psi': 0.5106931930084411}
[S14] START round=9 head_norm_before_train=0.807587 cos_to_last_merge=0.9943 (last merge round=7)
[S14] round=9 local utility u=1.000000 metrics={'f1_val': 0.5079465790092623, 'auprc': 0.9944833057017515, 'loss_val': 0.9747540196157239, 'psi': 0.702561269686258}-{'f1_val': 0.14035785288270378, 'auprc': 0.9874601817822722, 'loss_val': 1.1039656073384752, 'psi': 0.47919878444253117}
[S15] START round=9 head_norm_before_train=0.804804 cos_to_last_merge=0.8808 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.881
[S15] round=9 local utility u=0.213752 metrics={'f1_val': 0.7014204425338278, 'auprc': 0.7542780790927656, 'loss_val': 0.6438945205921276, 'psi': 0.7225634971574029}-{'f1_val': 0.6388182605870024, 'auprc': 0.7811381771645168, 'loss_val': 0.7763664800229104, 'psi': 0.6957462272180082}
[S16] START round=9 head_norm_before_train=0.528401 cos_to_last_merge=1.0000 (last merge round=8)
[S16] round=9 local utility u=0.023774 metrics={'f1_val': 0.41676889153789465, 'auprc': 0.5495048527940947, 'loss_val': 0.990733300949288, 'psi': 0.4698632760403747}-{'f1_val': 0.4168831021970758, 'auprc': 0.5464826808779495, 'loss_val': 1.0298996887372327, 'psi': 0.4687229336694253}
[S17] START round=9 head_norm_before_train=0.482554 cos_to_last_merge=1.0000 (last merge round=8)
[S17] round=9 local utility u=0.000000 metrics={'f1_val': 0.35644100580270793, 'auprc': 0.5847083734556602, 'loss_val': 1.0880194890040205, 'psi': 0.4477479528638888}-{'f1_val': 0.3892045086510505, 'auprc': 0.6242231980400874, 'loss_val': 1.080154409260298, 'psi': 0.48321198440666524}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:39008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:39009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:39014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:39011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S15] → sending delta(kind=head bytes=1788) to S6@127.0.0.1:39007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] → sending delta(kind=head bytes=1805) to S4@127.0.0.1:39004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S14] → sending delta(kind=head bytes=1789) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:39010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S2@127.0.0.1:39002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:39015
[S7] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1805 to 1 peers)
[S15] sending update (kind=head size=1788 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1789 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1794 to 1 peers)
[S16] sending update (kind=head size=1804 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1804) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.573622)
[S7] loaded HEAD from S16 (vec_in norm=0.573622)
[S7] cosine check vs S16: cos=-0.0628
[S7] DROPPED delta from S16 (cos=-0.0628 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1794) from S3
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.522308)
[S8] loaded HEAD from S3 (vec_in norm=1.522308)
[S8] cosine check vs S3: cos=-0.0093
[S8] DROPPED delta from S3 (cos=-0.0093 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1788) from S15
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.875032)
[S6] loaded HEAD from S15 (vec_in norm=0.875032)
[S6] cosine check vs S15: cos=0.9735
[S6] BUFFERED delta from S15 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1805) from S13
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.444414)
[S4] loaded HEAD from S13 (vec_in norm=1.444414)
[S4] cosine check vs S13: cos=0.9648
[S4] BUFFERED delta from S13 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1798) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.432915)
[S5] loaded HEAD from S11 (vec_in norm=1.432915)
[S5] cosine check vs S11: cos=0.9786
[S5] BUFFERED delta from S11 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1800) from S8
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.423234)
[S5] loaded HEAD from S8 (vec_in norm=1.423234)
[S5] cosine check vs S8: cos=-0.0310
[S5] DROPPED delta from S8 (cos=-0.0310 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1801) from S2
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.480430)
[S9] loaded HEAD from S2 (vec_in norm=1.480430)
[S9] cosine check vs S2: cos=-0.0394
[S9] DROPPED delta from S2 (cos=-0.0394 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1794) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.798099)
[S17] loaded HEAD from S6 (vec_in norm=0.798099)
[S17] cosine check vs S6: cos=0.5898
[S17] BUFFERED delta from S6 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1798) from S4
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.342716)
[S10] loaded HEAD from S4 (vec_in norm=1.342716)
[S10] cosine check vs S4: cos=0.9590
[S10] BUFFERED delta from S4 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1800) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.153848)
[S14] loaded HEAD from S10 (vec_in norm=1.153848)
[S14] cosine check vs S10: cos=0.8991
[S14] BUFFERED delta from S10 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1789) from S14
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.843507)
[S17] loaded HEAD from S14 (vec_in norm=0.843507)
[S17] cosine check vs S14: cos=0.6160
[S17] BUFFERED delta from S14 (total buffered=2)
[S17] RECEIVED delta(kind=head bytes=1801) from S5
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.233337)
[S17] loaded HEAD from S5 (vec_in norm=1.233337)
[S17] cosine check vs S5: cos=0.1855
[S17] BUFFERED delta from S5 (total buffered=3)
[S15] RECEIVED delta(kind=head bytes=1799) from S9
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.204863)
[S15] loaded HEAD from S9 (vec_in norm=1.204863)
[S15] cosine check vs S9: cos=-0.1955
[S15] DROPPED delta from S9 (cos=-0.1955 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1794) from S7
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.868315)
[S2] loaded HEAD from S7 (vec_in norm=0.868315)
[S2] cosine check vs S7: cos=-0.0751
[S2] DROPPED delta from S7 (cos=-0.0751 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=9 metric=0.3717 head_norm=0.798099
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.036632e-01
[S6] stored merged vector for next round verification (round=9)
[S6] DEBUG after merge:  round=9 metric=0.3717 head_norm=0.831009 delta_norm=0.103663
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=9 metric=0.4070 head_norm=1.153848
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.016630e-01
[S10] stored merged vector for next round verification (round=9)
[S10] DEBUG after merge:  round=9 metric=0.4033 head_norm=1.235499 delta_norm=0.201663
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=9 metric=0.6808 head_norm=1.342716
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.915718e-01
[S4] stored merged vector for next round verification (round=9)
[S4] DEBUG after merge:  round=9 metric=0.6807 head_norm=1.381270 delta_norm=0.191572
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=9 metric=0.5079 head_norm=0.843507
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.705218e-01
[S14] stored merged vector for next round verification (round=9)
[S14] DEBUG after merge:  round=9 metric=0.3157 head_norm=0.973783 delta_norm=0.270522
[S14] aggregate: ROLLBACK (f1_val pre=0.508 post=0.316 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=9 metric=0.4174 head_norm=1.233337
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.698144e-01
[S5] stored merged vector for next round verification (round=9)
[S5] DEBUG after merge:  round=9 metric=0.4173 head_norm=1.326026 delta_norm=0.169814
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=9 metric=0.3564 head_norm=0.522907
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.669997e-01
[S17] stored merged vector for next round verification (round=9)
[S17] DEBUG after merge:  round=9 metric=0.3714 head_norm=0.504351 delta_norm=0.167000
[S17] aggregate: ACCEPT kept=['S6', 'S14', 'S5'] (k=3/3) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.480430 (no previous merge yet)
[S2] round=10 local utility u=0.002333 metrics={'f1_val': 0.7008408655373038, 'auprc': 0.7519493730255489, 'loss_val': 0.41659191230476367, 'psi': 0.7212842685326019}-{'f1_val': 0.7136689859212908, 'auprc': 0.7774468517333646, 'loss_val': 0.57471843713094, 'psi': 0.7391801322461203}
[S3] START round=10 head_norm_before_train=1.522308 (no previous merge yet)
[S3] round=10 local utility u=0.273165 metrics={'f1_val': 0.6608643567021537, 'auprc': 0.9974989331944092, 'loss_val': 0.45154383047801305, 'psi': 0.795518187299056}-{'f1_val': 0.5959106908505537, 'auprc': 0.9925718234342136, 'loss_val': 0.5933704891792898, 'psi': 0.7545751438840176}
[S4] START round=10 head_norm_before_train=1.381270 cos_to_last_merge=1.0000 (last merge round=9)
[S4] round=10 local utility u=0.252861 metrics={'f1_val': 0.6720941143663727, 'auprc': 0.8442250421021535, 'loss_val': 0.6380946971773587, 'psi': 0.7409464854606851}-{'f1_val': 0.6807990669090032, 'auprc': 0.6790797906399254, 'loss_val': 0.7006104563142596, 'psi': 0.6801113564013721}
[S5] START round=10 head_norm_before_train=1.326026 cos_to_last_merge=1.0000 (last merge round=9)
[S5] round=10 local utility u=0.000000 metrics={'f1_val': 0.4255676975766991, 'auprc': 0.6613057752688033, 'loss_val': 0.8686787461109434, 'psi': 0.5198629286535408}-{'f1_val': 0.4173865207428088, 'auprc': 0.7713004666247198, 'loss_val': 0.9811454563087317, 'psi': 0.5589520990955732}
[S6] START round=10 head_norm_before_train=0.831009 cos_to_last_merge=1.0000 (last merge round=9)
[S6] round=10 local utility u=0.000000 metrics={'f1_val': 0.3895553283770912, 'auprc': 0.7852433655693118, 'loss_val': 0.8102484493468279, 'psi': 0.5478305432539795}-{'f1_val': 0.37166184454659834, 'auprc': 0.8682268616484813, 'loss_val': 0.8782539709139968, 'psi': 0.5702878513873515}
[S7] START round=10 head_norm_before_train=0.868315 cos_to_last_merge=0.8863 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.886
[S7] round=10 local utility u=0.000000 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.7833921317225299, 'loss_val': 0.8384488783358254, 'psi': 0.563382923555626}-{'f1_val': 0.5620849426595087, 'auprc': 0.7873725550519538, 'loss_val': 0.8965956534625759, 'psi': 0.6521999876164868}
[S8] START round=10 head_norm_before_train=1.423234 (no previous merge yet)
[S8] round=10 local utility u=0.030730 metrics={'f1_val': 0.7140170479737811, 'auprc': 0.79394136629098, 'loss_val': 0.46192333818604436, 'psi': 0.7459867753006606}-{'f1_val': 0.7000326645897077, 'auprc': 0.8354300021298342, 'loss_val': 0.5639433343261361, 'psi': 0.7541915996057583}
[S9] START round=10 head_norm_before_train=1.204863 cos_to_last_merge=0.9121 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.912
[S9] round=10 local utility u=0.078484 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.9985795151668055, 'loss_val': 0.3808452368389233, 'psi': 0.8202506066982278}-{'f1_val': 0.7012675768428742, 'auprc': 0.9994353183050453, 'loss_val': 0.5397989348060993, 'psi': 0.8205346734277426}
[S10] START round=10 head_norm_before_train=1.235499 cos_to_last_merge=1.0000 (last merge round=9)
[S10] round=10 local utility u=1.000000 metrics={'f1_val': 0.701696512414446, 'auprc': 0.9922795000283491, 'loss_val': 0.5788928413580269, 'psi': 0.8179297074600071}-{'f1_val': 0.40698952528367704, 'auprc': 0.8018322638279961, 'loss_val': 0.7315503135664289, 'psi': 0.5649266207014048}
[S11] START round=10 head_norm_before_train=1.432915 (no previous merge yet)
[S11] round=10 local utility u=0.257210 metrics={'f1_val': 0.7020664967782734, 'auprc': 0.9979882002904337, 'loss_val': 0.4806460581321256, 'psi': 0.8204351781831375}-{'f1_val': 0.6339413803165928, 'auprc': 0.9965377018625915, 'loss_val': 0.5819642661579866, 'psi': 0.7789799089349922}
[S13] START round=10 head_norm_before_train=1.444414 (no previous merge yet)
[S13] round=10 local utility u=0.000000 metrics={'f1_val': 0.6835127307519235, 'auprc': 0.7625659005649718, 'loss_val': 0.5490524631258582, 'psi': 0.7151339986771428}-{'f1_val': 0.7094211880166909, 'auprc': 0.7700712219098229, 'loss_val': 0.575006654519499, 'psi': 0.7336812015739437}
[S14] START round=10 head_norm_before_train=0.973783 cos_to_last_merge=1.0000 (last merge round=9)
[S14] round=10 local utility u=0.409276 metrics={'f1_val': 0.6197468906630688, 'auprc': 0.9944174264622556, 'loss_val': 0.8268057293134884, 'psi': 0.7696151049827435}-{'f1_val': 0.5079465790092623, 'auprc': 0.9944833057017515, 'loss_val': 0.9747540196157239, 'psi': 0.702561269686258}
[S15] START round=10 head_norm_before_train=0.875032 cos_to_last_merge=0.8524 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.852
[S15] round=10 local utility u=0.000000 metrics={'f1_val': 0.6385063992257931, 'auprc': 0.669003858694529, 'loss_val': 0.6789894749520661, 'psi': 0.6507053830132874}-{'f1_val': 0.7014204425338278, 'auprc': 0.7542780790927656, 'loss_val': 0.6438945205921276, 'psi': 0.7225634971574029}
[S16] START round=10 head_norm_before_train=0.573622 cos_to_last_merge=0.9853 (last merge round=8)
[S16] round=10 local utility u=0.247211 metrics={'f1_val': 0.38360776588363565, 'auprc': 0.7512354912625756, 'loss_val': 0.9025364327255384, 'psi': 0.5306588560352117}-{'f1_val': 0.41676889153789465, 'auprc': 0.5495048527940947, 'loss_val': 0.990733300949288, 'psi': 0.4698632760403747}
[S17] START round=10 head_norm_before_train=0.504351 cos_to_last_merge=1.0000 (last merge round=9)
[S17] round=10 local utility u=0.011339 metrics={'f1_val': 0.3537107970317006, 'auprc': 0.5883708913017971, 'loss_val': 1.0599476657613704, 'psi': 0.4475748347397392}-{'f1_val': 0.35644100580270793, 'auprc': 0.5847083734556602, 'loss_val': 1.0880194890040205, 'psi': 0.4477479528638888}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:39005
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:39011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:39009
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:39015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:39008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S2] → sending delta(kind=head bytes=1806) to S9@127.0.0.1:39010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S14] → sending delta(kind=head bytes=1791) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:39014
[S14] sending update (kind=head size=1791 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1806 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1800) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.627938)
[S7] loaded HEAD from S16 (vec_in norm=0.627938)
[S7] cosine check vs S16: cos=-0.0859
[S7] DROPPED delta from S16 (cos=-0.0859 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1797) from S9
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.263402)
[S15] loaded HEAD from S9 (vec_in norm=1.263402)
[S15] cosine check vs S9: cos=-0.2037
[S15] DROPPED delta from S9 (cos=-0.2037 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1804) from S3
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.566903)
[S8] loaded HEAD from S3 (vec_in norm=1.566903)
[S8] cosine check vs S3: cos=-0.0082
[S8] DROPPED delta from S3 (cos=-0.0082 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1798) from S8
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.465192)
[S5] loaded HEAD from S8 (vec_in norm=1.465192)
[S5] cosine check vs S8: cos=-0.0252
[S5] DROPPED delta from S8 (cos=-0.0252 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1795) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.473260)
[S5] loaded HEAD from S11 (vec_in norm=1.473260)
[S5] cosine check vs S11: cos=0.9862
[S5] BUFFERED delta from S11 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1806) from S2
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.526263)
[S9] loaded HEAD from S2 (vec_in norm=1.526263)
[S9] cosine check vs S2: cos=-0.0392
[S9] DROPPED delta from S2 (cos=-0.0392 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1799) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.276192)
[S14] loaded HEAD from S10 (vec_in norm=1.276192)
[S14] cosine check vs S10: cos=0.9495
[S14] BUFFERED delta from S10 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1798) from S4
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.416192)
[S10] loaded HEAD from S4 (vec_in norm=1.416192)
[S10] cosine check vs S4: cos=0.9742
[S10] BUFFERED delta from S4 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1791) from S14
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.005733)
[S17] loaded HEAD from S14 (vec_in norm=1.005733)
[S17] cosine check vs S14: cos=0.5399
[S17] BUFFERED delta from S14 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:39016
[S17] sending update (kind=head size=1802 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1802) from S17
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.545647)
[S16] loaded HEAD from S17 (vec_in norm=0.545647)
[S16] cosine check vs S17: cos=0.7190
[S16] BUFFERED delta from S17 (total buffered=1)
[S13] ⇄ pheromone p=0.347 → S4@127.0.0.1:39004
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=10 metric=0.4256 head_norm=1.347812
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.329350e-01
[S5] stored merged vector for next round verification (round=10)
[S5] DEBUG after merge:  round=10 metric=0.5485 head_norm=1.405658 delta_norm=0.132935
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.259 → S17@127.0.0.1:39017
[S6] ⇄ pheromone p=0.271 → S17@127.0.0.1:39017
[S7] ⇄ pheromone p=0.351 → S2@127.0.0.1:39002
[S4] ⇄ pheromone p=0.385 → S10@127.0.0.1:39011
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=10 metric=0.6197 head_norm=1.005733
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.251750e-01
[S14] stored merged vector for next round verification (round=10)
[S14] DEBUG after merge:  round=10 metric=0.6200 head_norm=1.126667 delta_norm=0.225175
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.432 → S17@127.0.0.1:39017
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=10 metric=0.7017 head_norm=1.276192
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.680576e-01
[S10] stored merged vector for next round verification (round=10)
[S10] DEBUG after merge:  round=10 metric=0.7013 head_norm=1.337494 delta_norm=0.168058
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.455 → S14@127.0.0.1:39014
[S9] ⇄ pheromone p=0.290 → S15@127.0.0.1:39015
[S8] ⇄ pheromone p=0.271 → S5@127.0.0.1:39005
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=10 metric=0.3836 head_norm=0.627938
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.232418e-01
[S16] stored merged vector for next round verification (round=10)
[S16] DEBUG after merge:  round=10 metric=0.3842 head_norm=0.544226 delta_norm=0.223242
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.264 → S7@127.0.0.1:39008
[S11] ⇄ pheromone p=0.410 → S5@127.0.0.1:39005
[S3] ⇄ pheromone p=0.361 → S8@127.0.0.1:39009
[S2] ⇄ pheromone p=0.285 → S9@127.0.0.1:39010
[S15] ⇄ pheromone p=0.323 → S6@127.0.0.1:39007
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=10 metric=0.3537 head_norm=0.545647
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.232815e-01
[S17] stored merged vector for next round verification (round=10)
[S17] DEBUG after merge:  round=10 metric=0.3832 head_norm=0.689528 delta_norm=0.423281
[S17] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.228 → S16@127.0.0.1:39016
[S2] START round=11 head_norm_before_train=1.526263 (no previous merge yet)
[S2] round=11 local utility u=0.074763 metrics={'f1_val': 0.7141184586279148, 'auprc': 0.7931942990136658, 'loss_val': 0.47046591186685816, 'psi': 0.7457487947822152}-{'f1_val': 0.7008408655373038, 'auprc': 0.7519493730255489, 'loss_val': 0.41659191230476367, 'psi': 0.7212842685326019}
[S3] START round=11 head_norm_before_train=1.566903 (no previous merge yet)
[S3] round=11 local utility u=0.000000 metrics={'f1_val': 0.5773826823901724, 'auprc': 0.9865697301929331, 'loss_val': 0.5361495374448164, 'psi': 0.7410575015112768}-{'f1_val': 0.6608643567021537, 'auprc': 0.9974989331944092, 'loss_val': 0.45154383047801305, 'psi': 0.795518187299056}
[S4] START round=11 head_norm_before_train=1.416192 cos_to_last_merge=0.9985 (last merge round=9)
[S4] round=11 local utility u=0.053391 metrics={'f1_val': 0.666310816024772, 'auprc': 0.8735074907264252, 'loss_val': 0.5844592595139916, 'psi': 0.7491894859054333}-{'f1_val': 0.6720941143663727, 'auprc': 0.8442250421021535, 'loss_val': 0.6380946971773587, 'psi': 0.7409464854606851}
[S5] START round=11 head_norm_before_train=1.405658 cos_to_last_merge=1.0000 (last merge round=10)
[S5] round=11 local utility u=0.047739 metrics={'f1_val': 0.43218663075986535, 'auprc': 0.6660048363864197, 'loss_val': 0.8270107330950912, 'psi': 0.5257139130104871}-{'f1_val': 0.4255676975766991, 'auprc': 0.6613057752688033, 'loss_val': 0.8686787461109434, 'psi': 0.5198629286535408}
[S6] START round=11 head_norm_before_train=0.872619 cos_to_last_merge=0.9962 (last merge round=9)
[S6] round=11 local utility u=0.209218 metrics={'f1_val': 0.40826697651730504, 'auprc': 0.851643368230762, 'loss_val': 0.7032820200911215, 'psi': 0.5856175332026878}-{'f1_val': 0.3895553283770912, 'auprc': 0.7852433655693118, 'loss_val': 0.8102484493468279, 'psi': 0.5478305432539795}
[S7] START round=11 head_norm_before_train=0.910811 cos_to_last_merge=0.8666 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.867
[S7] round=11 local utility u=0.016047 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.7806393593985006, 'loss_val': 0.7980958223158965, 'psi': 0.5622818146260142}-{'f1_val': 0.41671011811102343, 'auprc': 0.7833921317225299, 'loss_val': 0.8384488783358254, 'psi': 0.563382923555626}
[S8] START round=11 head_norm_before_train=1.465192 (no previous merge yet)
[S8] round=11 local utility u=0.308323 metrics={'f1_val': 0.7003840873377247, 'auprc': 0.9859681150607291, 'loss_val': 0.33955890187782, 'psi': 0.8146176984269264}-{'f1_val': 0.7140170479737811, 'auprc': 0.79394136629098, 'loss_val': 0.46192333818604436, 'psi': 0.7459867753006606}
[S9] START round=11 head_norm_before_train=1.263402 cos_to_last_merge=0.8967 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.897
[S9] round=11 local utility u=0.029505 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9983282921824153, 'loss_val': 0.3206356612781515, 'psi': 0.8201056069975041}-{'f1_val': 0.7013646677191758, 'auprc': 0.9985795151668055, 'loss_val': 0.3808452368389233, 'psi': 0.8202506066982278}
[S10] START round=11 head_norm_before_train=1.337494 cos_to_last_merge=1.0000 (last merge round=10)
[S10] round=11 local utility u=0.056803 metrics={'f1_val': 0.6983743919755209, 'auprc': 0.9972008296713906, 'loss_val': 0.4601176783425987, 'psi': 0.8179049670538687}-{'f1_val': 0.701696512414446, 'auprc': 0.9922795000283491, 'loss_val': 0.5788928413580269, 'psi': 0.8179297074600071}
[S11] START round=11 head_norm_before_train=1.473260 (no previous merge yet)
[S11] round=11 local utility u=0.023422 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9958174122908792, 'loss_val': 0.42505193633941774, 'psi': 0.8193430526685066}-{'f1_val': 0.7020664967782734, 'auprc': 0.9979882002904337, 'loss_val': 0.4806460581321256, 'psi': 0.8204351781831375}
[S13] START round=11 head_norm_before_train=1.478284 (no previous merge yet)
[S13] round=11 local utility u=0.000000 metrics={'f1_val': 0.5789804853433873, 'auprc': 0.8332813418304295, 'loss_val': 0.623561064390858, 'psi': 0.6807008279382042}-{'f1_val': 0.6835127307519235, 'auprc': 0.7625659005649718, 'loss_val': 0.5490524631258582, 'psi': 0.7151339986771428}
[S14] START round=11 head_norm_before_train=1.126667 cos_to_last_merge=1.0000 (last merge round=10)
[S14] round=11 local utility u=0.075125 metrics={'f1_val': 0.6203210244220432, 'auprc': 0.9935960893357533, 'loss_val': 0.6775356211557373, 'psi': 0.7696310503875272}-{'f1_val': 0.6197468906630688, 'auprc': 0.9944174264622556, 'loss_val': 0.8268057293134884, 'psi': 0.7696151049827435}
[S15] START round=11 head_norm_before_train=0.937231 cos_to_last_merge=0.8289 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.829
[S15] round=11 local utility u=0.241545 metrics={'f1_val': 0.701112287123778, 'auprc': 0.6487699660253192, 'loss_val': 0.5108335937007822, 'psi': 0.6801753586843945}-{'f1_val': 0.6385063992257931, 'auprc': 0.669003858694529, 'loss_val': 0.6789894749520661, 'psi': 0.6507053830132874}
[S16] START round=11 head_norm_before_train=0.544226 cos_to_last_merge=1.0000 (last merge round=10)
[S16] round=11 local utility u=0.000000 metrics={'f1_val': 0.4189886936822361, 'auprc': 0.5581711928250288, 'loss_val': 0.9457545264230915, 'psi': 0.4746616933393532}-{'f1_val': 0.38360776588363565, 'auprc': 0.7512354912625756, 'loss_val': 0.9025364327255384, 'psi': 0.5306588560352117}
[S17] START round=11 head_norm_before_train=0.689528 cos_to_last_merge=1.0000 (last merge round=10)
[S17] round=11 local utility u=0.000000 metrics={'f1_val': 0.35525092528221547, 'auprc': 0.5867248817241579, 'loss_val': 1.0671990981762935, 'psi': 0.44784050785899243}-{'f1_val': 0.3537107970317006, 'auprc': 0.5883708913017971, 'loss_val': 1.0599476657613704, 'psi': 0.4475748347397392}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:39007
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:39010
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] → sending delta(kind=head bytes=1793) to S2@127.0.0.1:39002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] → sending delta(kind=head bytes=1792) to S5@127.0.0.1:39005
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:39014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] → sending delta(kind=head bytes=1805) to S10@127.0.0.1:39011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:39015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:39017
[S4] sending update (kind=head size=1805 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1793 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1792 to 1 peers)
[S6] sending update (kind=head size=1794 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1796) from S15
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.992747)
[S6] loaded HEAD from S15 (vec_in norm=0.992747)
[S6] cosine check vs S15: cos=0.9561
[S6] BUFFERED delta from S15 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1792) from S8
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.499389)
[S5] loaded HEAD from S8 (vec_in norm=1.499389)
[S5] cosine check vs S8: cos=-0.0188
[S5] DROPPED delta from S8 (cos=-0.0188 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1796) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.512169)
[S5] loaded HEAD from S11 (vec_in norm=1.512169)
[S5] cosine check vs S11: cos=0.9907
[S5] BUFFERED delta from S11 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1805) from S4
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.454192)
[S10] loaded HEAD from S4 (vec_in norm=1.454192)
[S10] cosine check vs S4: cos=0.9885
[S10] BUFFERED delta from S4 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1795) from S14
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.160717)
[S17] loaded HEAD from S14 (vec_in norm=1.160717)
[S17] cosine check vs S14: cos=0.8747
[S17] BUFFERED delta from S14 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1793) from S7
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.951598)
[S2] loaded HEAD from S7 (vec_in norm=0.951598)
[S2] cosine check vs S7: cos=-0.0633
[S2] DROPPED delta from S7 (cos=-0.0633 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1794) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.916085)
[S17] loaded HEAD from S6 (vec_in norm=0.916085)
[S17] cosine check vs S6: cos=0.2256
[S17] BUFFERED delta from S6 (total buffered=2)
[S14] RECEIVED delta(kind=head bytes=1801) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.379830)
[S14] loaded HEAD from S10 (vec_in norm=1.379830)
[S14] cosine check vs S10: cos=0.9666
[S14] BUFFERED delta from S10 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1800) from S2
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.572338)
[S9] loaded HEAD from S2 (vec_in norm=1.572338)
[S9] cosine check vs S2: cos=-0.0389
[S9] DROPPED delta from S2 (cos=-0.0389 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1795) from S9
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.318258)
[S15] loaded HEAD from S9 (vec_in norm=1.318258)
[S15] cosine check vs S9: cos=-0.2079
[S15] DROPPED delta from S9 (cos=-0.2079 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1799) from S5
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.425228)
[S17] loaded HEAD from S5 (vec_in norm=1.425228)
[S17] cosine check vs S5: cos=0.0904
[S17] BUFFERED delta from S5 (total buffered=3)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=11 metric=0.4322 head_norm=1.425228
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.092367e-01
[S5] stored merged vector for next round verification (round=11)
[S5] DEBUG after merge:  round=11 metric=0.5471 head_norm=1.465275 delta_norm=0.109237
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=11 metric=0.6984 head_norm=1.379830
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.137679e-01
[S10] stored merged vector for next round verification (round=11)
[S10] DEBUG after merge:  round=11 metric=0.6930 head_norm=1.412926 delta_norm=0.113768
[S10] aggregate: ROLLBACK (f1_val pre=0.698 post=0.693 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=11 metric=0.6203 head_norm=1.160717
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.968072e-01
[S14] stored merged vector for next round verification (round=11)
[S14] DEBUG after merge:  round=11 metric=0.6203 head_norm=1.259708 delta_norm=0.196807
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=11 metric=0.4083 head_norm=0.916085
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.463600e-01
[S6] stored merged vector for next round verification (round=11)
[S6] DEBUG after merge:  round=11 metric=0.4083 head_norm=0.943906 delta_norm=0.146360
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=11 metric=0.3553 head_norm=0.718697
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.648000e-01
[S17] stored merged vector for next round verification (round=11)
[S17] DEBUG after merge:  round=11 metric=0.3548 head_norm=0.626825 delta_norm=0.264800
[S17] aggregate: ACCEPT kept=['S14', 'S6', 'S5'] (k=3/3) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.572338 (no previous merge yet)
[S2] round=12 local utility u=0.009056 metrics={'f1_val': 0.7012982561431278, 'auprc': 0.7902699998736434, 'loss_val': 0.36665969061177556, 'psi': 0.736886953635334}-{'f1_val': 0.7141184586279148, 'auprc': 0.7931942990136658, 'loss_val': 0.47046591186685816, 'psi': 0.7457487947822152}
[S3] START round=12 head_norm_before_train=1.602648 (no previous merge yet)
[S3] round=12 local utility u=0.445476 metrics={'f1_val': 0.6924948654681071, 'auprc': 0.9946475991422329, 'loss_val': 0.3601035623532881, 'psi': 0.8133559589377575}-{'f1_val': 0.5773826823901724, 'auprc': 0.9865697301929331, 'loss_val': 0.5361495374448164, 'psi': 0.7410575015112768}
[S4] START round=12 head_norm_before_train=1.454192 cos_to_last_merge=0.9946 (last merge round=9)
[S4] round=12 local utility u=0.011287 metrics={'f1_val': 0.666960176412553, 'auprc': 0.8603620260476628, 'loss_val': 0.5263442797624039, 'psi': 0.7443209162665969}-{'f1_val': 0.666310816024772, 'auprc': 0.8735074907264252, 'loss_val': 0.5844592595139916, 'psi': 0.7491894859054333}
[S5] START round=12 head_norm_before_train=1.465275 cos_to_last_merge=1.0000 (last merge round=11)
[S5] round=12 local utility u=0.925362 metrics={'f1_val': 0.6714729233140044, 'auprc': 0.7664667769956688, 'loss_val': 0.7133897771021291, 'psi': 0.7094704647866702}-{'f1_val': 0.43218663075986535, 'auprc': 0.6660048363864197, 'loss_val': 0.8270107330950912, 'psi': 0.5257139130104871}
[S6] START round=12 head_norm_before_train=0.943906 cos_to_last_merge=1.0000 (last merge round=11)
[S6] round=12 local utility u=0.746876 metrics={'f1_val': 0.6841985149631388, 'auprc': 0.7886524368517097, 'loss_val': 0.6761470013359872, 'psi': 0.7259800837185671}-{'f1_val': 0.40826697651730504, 'auprc': 0.851643368230762, 'loss_val': 0.7032820200911215, 'psi': 0.5856175332026878}
[S7] START round=12 head_norm_before_train=0.951598 cos_to_last_merge=0.8487 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.849
[S7] round=12 local utility u=0.760102 metrics={'f1_val': 0.66647411389486, 'auprc': 0.7854720670693671, 'loss_val': 0.7909731990632305, 'psi': 0.7140732951646629}-{'f1_val': 0.41671011811102343, 'auprc': 0.7806393593985006, 'loss_val': 0.7980958223158965, 'psi': 0.5622818146260142}
[S8] START round=12 head_norm_before_train=1.499389 (no previous merge yet)
[S8] round=12 local utility u=0.078132 metrics={'f1_val': 0.7116761651512594, 'auprc': 0.9962858607761074, 'loss_val': 0.2820010881386725, 'psi': 0.8255200434011987}-{'f1_val': 0.7003840873377247, 'auprc': 0.9859681150607291, 'loss_val': 0.33955890187782, 'psi': 0.8146176984269264}
[S9] START round=12 head_norm_before_train=1.318258 cos_to_last_merge=0.8817 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.882
[S9] round=12 local utility u=0.014567 metrics={'f1_val': 0.7015406642019387, 'auprc': 0.9984423880276954, 'loss_val': 0.2933444542568174, 'psi': 0.8203013537322414}-{'f1_val': 0.7012904835408967, 'auprc': 0.9983282921824153, 'loss_val': 0.3206356612781515, 'psi': 0.8201056069975041}
[S10] START round=12 head_norm_before_train=1.412926 cos_to_last_merge=1.0000 (last merge round=11)
[S10] round=12 local utility u=0.024921 metrics={'f1_val': 0.6921465684906996, 'auprc': 0.9968703664685818, 'loss_val': 0.3719181643039744, 'psi': 0.8140360876818524}-{'f1_val': 0.6983743919755209, 'auprc': 0.9972008296713906, 'loss_val': 0.4601176783425987, 'psi': 0.8179049670538687}
[S11] START round=12 head_norm_before_train=1.512169 (no previous merge yet)
[S11] round=12 local utility u=0.000000 metrics={'f1_val': 0.6627411677795301, 'auprc': 0.9968082905886513, 'loss_val': 0.4514910994192955, 'psi': 0.7963680169031786}-{'f1_val': 0.7016934795869249, 'auprc': 0.9958174122908792, 'loss_val': 0.42505193633941774, 'psi': 0.8193430526685066}
[S13] START round=12 head_norm_before_train=1.505376 (no previous merge yet)
[S13] round=12 local utility u=0.320418 metrics={'f1_val': 0.7092395430049584, 'auprc': 0.7379147634241822, 'loss_val': 0.47817973693048976, 'psi': 0.7207096311726479}-{'f1_val': 0.5789804853433873, 'auprc': 0.8332813418304295, 'loss_val': 0.623561064390858, 'psi': 0.6807008279382042}
[S14] START round=12 head_norm_before_train=1.259708 cos_to_last_merge=1.0000 (last merge round=11)
[S14] round=12 local utility u=1.000000 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9970541796769361, 'loss_val': 0.5162686283170351, 'psi': 0.9974123427006866}-{'f1_val': 0.6203210244220432, 'auprc': 0.9935960893357533, 'loss_val': 0.6775356211557373, 'psi': 0.7696310503875272}
[S15] START round=12 head_norm_before_train=0.992747 cos_to_last_merge=0.8096 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.810
[S15] round=12 local utility u=0.183159 metrics={'f1_val': 0.7010722616442422, 'auprc': 0.7438981318167421, 'loss_val': 0.42966025932937607, 'psi': 0.7182026097132421}-{'f1_val': 0.701112287123778, 'auprc': 0.6487699660253192, 'loss_val': 0.5108335937007822, 'psi': 0.6801753586843945}
[S16] START round=12 head_norm_before_train=0.589714 cos_to_last_merge=0.9904 (last merge round=10)
[S16] round=12 local utility u=0.246653 metrics={'f1_val': 0.3842371275775912, 'auprc': 0.7641149551265128, 'loss_val': 0.8617704863775277, 'psi': 0.5361882585971599}-{'f1_val': 0.4189886936822361, 'auprc': 0.5581711928250288, 'loss_val': 0.9457545264230915, 'psi': 0.4746616933393532}
[S17] START round=12 head_norm_before_train=0.626825 cos_to_last_merge=1.0000 (last merge round=11)
[S17] round=12 local utility u=0.039525 metrics={'f1_val': 0.35478144341290896, 'auprc': 0.6093264974834544, 'loss_val': 1.0531362000552669, 'psi': 0.45659946504112714}-{'f1_val': 0.35525092528221547, 'auprc': 0.5867248817241579, 'loss_val': 1.0671990981762935, 'psi': 0.44784050785899243}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:39011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:39008
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:39015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S6] → sending delta(kind=head bytes=1790) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:39014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:39002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:39007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:39009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:39010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:39004
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1805 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1790 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1790) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.980588)
[S17] loaded HEAD from S6 (vec_in norm=0.980588)
[S17] cosine check vs S6: cos=0.3927
[S17] BUFFERED delta from S6 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1796) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.640672)
[S7] loaded HEAD from S16 (vec_in norm=0.640672)
[S7] cosine check vs S16: cos=-0.0521
[S7] DROPPED delta from S16 (cos=-0.0521 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1796) from S15
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.040012)
[S6] loaded HEAD from S15 (vec_in norm=1.040012)
[S6] cosine check vs S15: cos=0.9779
[S6] BUFFERED delta from S15 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1799) from S13
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.518910)
[S4] loaded HEAD from S13 (vec_in norm=1.518910)
[S4] cosine check vs S13: cos=0.9586
[S4] BUFFERED delta from S13 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1798) from S8
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.524624)
[S5] loaded HEAD from S8 (vec_in norm=1.524624)
[S5] cosine check vs S8: cos=-0.0142
[S5] DROPPED delta from S8 (cos=-0.0142 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1796) from S7
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.989436)
[S2] loaded HEAD from S7 (vec_in norm=0.989436)
[S2] cosine check vs S7: cos=-0.0614
[S2] DROPPED delta from S7 (cos=-0.0614 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1797) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.456214)
[S14] loaded HEAD from S10 (vec_in norm=1.456214)
[S14] cosine check vs S10: cos=0.9793
[S14] BUFFERED delta from S10 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1803) from S2
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.615142)
[S9] loaded HEAD from S2 (vec_in norm=1.615142)
[S9] cosine check vs S2: cos=-0.0399
[S9] DROPPED delta from S2 (cos=-0.0399 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1803) from S5
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.488944)
[S17] loaded HEAD from S5 (vec_in norm=1.488944)
[S17] cosine check vs S5: cos=0.3050
[S17] BUFFERED delta from S5 (total buffered=2)
[S17] RECEIVED delta(kind=head bytes=1796) from S14
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.296228)
[S17] loaded HEAD from S14 (vec_in norm=1.296228)
[S17] cosine check vs S14: cos=0.7283
[S17] BUFFERED delta from S14 (total buffered=3)
[S10] RECEIVED delta(kind=head bytes=1801) from S4
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.493747)
[S10] loaded HEAD from S4 (vec_in norm=1.493747)
[S10] cosine check vs S4: cos=0.9919
[S10] BUFFERED delta from S4 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1800) from S9
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.362192)
[S15] loaded HEAD from S9 (vec_in norm=1.362192)
[S15] cosine check vs S9: cos=-0.2087
[S15] DROPPED delta from S9 (cos=-0.2087 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1805) from S3
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.628630)
[S8] loaded HEAD from S3 (vec_in norm=1.628630)
[S8] cosine check vs S3: cos=-0.0066
[S8] DROPPED delta from S3 (cos=-0.0066 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:39016
[S17] sending update (kind=head size=1797 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1797) from S17
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.658898)
[S16] loaded HEAD from S17 (vec_in norm=0.658898)
[S16] cosine check vs S17: cos=0.7081
[S16] BUFFERED delta from S17 (total buffered=1)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=12 metric=0.9977 head_norm=1.296228
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.611181e-01
[S14] stored merged vector for next round verification (round=12)
[S14] DEBUG after merge:  round=12 metric=0.9972 head_norm=1.369096 delta_norm=0.161118
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=12 metric=0.6921 head_norm=1.456214
[S10] _apply_head_vector_avg (torch): Δ‖w‖=9.565917e-02
[S10] stored merged vector for next round verification (round=12)
[S10] DEBUG after merge:  round=12 metric=0.6924 head_norm=1.471995 delta_norm=0.095659
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=12 metric=0.3842 head_norm=0.640672
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.483760e-01
[S16] stored merged vector for next round verification (round=12)
[S16] DEBUG after merge:  round=12 metric=0.3843 head_norm=0.600511 delta_norm=0.248376
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=12 metric=0.6842 head_norm=0.980588
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.102686e-01
[S6] stored merged vector for next round verification (round=12)
[S6] DEBUG after merge:  round=12 metric=0.6847 head_norm=1.004704 delta_norm=0.110269
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=12 metric=0.6670 head_norm=1.493747
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.171235e-01
[S4] stored merged vector for next round verification (round=12)
[S4] DEBUG after merge:  round=12 metric=0.6689 head_norm=1.490651 delta_norm=0.217124
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=12 metric=0.3548 head_norm=0.658898
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.867918e-01
[S17] stored merged vector for next round verification (round=12)
[S17] DEBUG after merge:  round=12 metric=0.3557 head_norm=0.644391 delta_norm=0.186792
[S17] aggregate: ACCEPT kept=['S6', 'S5', 'S14'] (k=3/3) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.615142 (no previous merge yet)
[S2] round=13 local utility u=0.000000 metrics={'f1_val': 0.7011221683038497, 'auprc': 0.7759087584894112, 'loss_val': 0.3356792514850488, 'psi': 0.7310368043780743}-{'f1_val': 0.7012982561431278, 'auprc': 0.7902699998736434, 'loss_val': 0.36665969061177556, 'psi': 0.736886953635334}
[S3] START round=13 head_norm_before_train=1.628630 (no previous merge yet)
[S3] round=13 local utility u=0.053902 metrics={'f1_val': 0.7005813959920884, 'auprc': 0.9956956986462163, 'loss_val': 0.30396293635375143, 'psi': 0.8186271170537396}-{'f1_val': 0.6924948654681071, 'auprc': 0.9946475991422329, 'loss_val': 0.3601035623532881, 'psi': 0.8133559589377575}
[S4] START round=13 head_norm_before_train=1.490651 cos_to_last_merge=1.0000 (last merge round=12)
[S4] round=13 local utility u=0.005985 metrics={'f1_val': 0.6635362174548205, 'auprc': 0.8643055534342978, 'loss_val': 0.505661190982347, 'psi': 0.7438439518466115}-{'f1_val': 0.666960176412553, 'auprc': 0.8603620260476628, 'loss_val': 0.5263442797624039, 'psi': 0.7443209162665969}
[S5] START round=13 head_norm_before_train=1.488944 cos_to_last_merge=0.9987 (last merge round=11)
[S5] round=13 local utility u=0.221686 metrics={'f1_val': 0.7009351540145, 'auprc': 0.792474801356743, 'loss_val': 0.5248143075490518, 'psi': 0.7375510129513971}-{'f1_val': 0.6714729233140044, 'auprc': 0.7664667769956688, 'loss_val': 0.7133897771021291, 'psi': 0.7094704647866702}
[S6] START round=13 head_norm_before_train=1.004704 cos_to_last_merge=1.0000 (last merge round=12)
[S6] round=13 local utility u=0.086631 metrics={'f1_val': 0.7022884746714576, 'auprc': 0.7879953944938952, 'loss_val': 0.6094527521329037, 'psi': 0.7365712426004327}-{'f1_val': 0.6841985149631388, 'auprc': 0.7886524368517097, 'loss_val': 0.6761470013359872, 'psi': 0.7259800837185671}
[S7] START round=13 head_norm_before_train=0.989436 cos_to_last_merge=0.8337 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.834
[S7] round=13 local utility u=0.082617 metrics={'f1_val': 0.6839240266953619, 'auprc': 0.7831255865333142, 'loss_val': 0.7233982590599354, 'psi': 0.7236046506305428}-{'f1_val': 0.66647411389486, 'auprc': 0.7854720670693671, 'loss_val': 0.7909731990632305, 'psi': 0.7140732951646629}
[S8] START round=13 head_norm_before_train=1.524624 (no previous merge yet)
[S8] round=13 local utility u=0.008704 metrics={'f1_val': 0.7057293678977744, 'auprc': 0.9977753725839519, 'loss_val': 0.23338079320566382, 'psi': 0.8225477697722454}-{'f1_val': 0.7116761651512594, 'auprc': 0.9962858607761074, 'loss_val': 0.2820010881386725, 'psi': 0.8255200434011987}
[S9] START round=13 head_norm_before_train=1.362192 cos_to_last_merge=0.8689 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.869
[S9] round=13 local utility u=0.007190 metrics={'f1_val': 0.7015406642019387, 'auprc': 0.9984430266383875, 'loss_val': 0.2789661764194945, 'psi': 0.8203016091765183}-{'f1_val': 0.7015406642019387, 'auprc': 0.9984423880276954, 'loss_val': 0.2933444542568174, 'psi': 0.8203013537322414}
[S10] START round=13 head_norm_before_train=1.471995 cos_to_last_merge=1.0000 (last merge round=12)
[S10] round=13 local utility u=0.000000 metrics={'f1_val': 0.6635633461912026, 'auprc': 0.9950376809158833, 'loss_val': 0.40642513855261914, 'psi': 0.796153080081075}-{'f1_val': 0.6921465684906996, 'auprc': 0.9968703664685818, 'loss_val': 0.3719181643039744, 'psi': 0.8140360876818524}
[S11] START round=13 head_norm_before_train=1.544990 (no previous merge yet)
[S11] round=13 local utility u=0.000000 metrics={'f1_val': 0.647700292400142, 'auprc': 0.9964238411827127, 'loss_val': 0.3864973478651467, 'psi': 0.7871897119131703}-{'f1_val': 0.6627411677795301, 'auprc': 0.9968082905886513, 'loss_val': 0.4514910994192955, 'psi': 0.7963680169031786}
[S13] START round=13 head_norm_before_train=1.518910 (no previous merge yet)
[S13] round=13 local utility u=0.000000 metrics={'f1_val': 0.634910738446176, 'auprc': 0.7599458495155733, 'loss_val': 0.5313873932046406, 'psi': 0.6849247828739349}-{'f1_val': 0.7092395430049584, 'auprc': 0.7379147634241822, 'loss_val': 0.47817973693048976, 'psi': 0.7207096311726479}
[S14] START round=13 head_norm_before_train=1.369096 cos_to_last_merge=1.0000 (last merge round=12)
[S14] round=13 local utility u=0.007239 metrics={'f1_val': 0.987935484875396, 'auprc': 0.9969234907077756, 'loss_val': 0.44310521630096683, 'psi': 0.9915306872083478}-{'f1_val': 0.9976511180498535, 'auprc': 0.9970541796769361, 'loss_val': 0.5162686283170351, 'psi': 0.9974123427006866}
[S15] START round=13 head_norm_before_train=1.040012 cos_to_last_merge=0.7945 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.794
[S15] round=13 local utility u=0.006920 metrics={'f1_val': 0.6959343504773781, 'auprc': 0.760314900759951, 'loss_val': 0.43424283213880066, 'psi': 0.7216865705904072}-{'f1_val': 0.7010722616442422, 'auprc': 0.7438981318167421, 'loss_val': 0.42966025932937607, 'psi': 0.7182026097132421}
[S16] START round=13 head_norm_before_train=0.600511 cos_to_last_merge=1.0000 (last merge round=12)
[S16] round=13 local utility u=0.005159 metrics={'f1_val': 0.3847038785992656, 'auprc': 0.7740909034582535, 'loss_val': 0.8841810927065038, 'psi': 0.5404586885428607}-{'f1_val': 0.3842371275775912, 'auprc': 0.7641149551265128, 'loss_val': 0.8617704863775277, 'psi': 0.5361882585971599}
[S17] START round=13 head_norm_before_train=0.644391 cos_to_last_merge=1.0000 (last merge round=12)
[S17] round=13 local utility u=0.060126 metrics={'f1_val': 0.3578530536049874, 'auprc': 0.6398562522884519, 'loss_val': 1.0429037494536255, 'psi': 0.47065433307837323}-{'f1_val': 0.35478144341290896, 'auprc': 0.6093264974834544, 'loss_val': 1.0531362000552669, 'psi': 0.45659946504112714}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:39009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:39008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:39002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:39011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:39007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S6] → sending delta(kind=head bytes=1787) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:39015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:39017
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:39017
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1787 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1797) from S15
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.083508)
[S6] loaded HEAD from S15 (vec_in norm=1.083508)
[S6] cosine check vs S15: cos=0.9865
[S6] BUFFERED delta from S15 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1798) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.641744)
[S7] loaded HEAD from S16 (vec_in norm=0.641744)
[S7] cosine check vs S16: cos=0.0012
[S7] BUFFERED delta from S16 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1798) from S8
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.547747)
[S5] loaded HEAD from S8 (vec_in norm=1.547747)
[S5] cosine check vs S8: cos=-0.0155
[S5] DROPPED delta from S8 (cos=-0.0155 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1803) from S3
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.653333)
[S8] loaded HEAD from S3 (vec_in norm=1.653333)
[S8] cosine check vs S3: cos=-0.0056
[S8] DROPPED delta from S3 (cos=-0.0056 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1797) from S4
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.526694)
[S10] loaded HEAD from S4 (vec_in norm=1.526694)
[S10] cosine check vs S4: cos=0.9893
[S10] BUFFERED delta from S4 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1787) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.038594)
[S17] loaded HEAD from S6 (vec_in norm=1.038594)
[S17] cosine check vs S6: cos=0.4745
[S17] BUFFERED delta from S6 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1799) from S7
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.023323)
[S2] loaded HEAD from S7 (vec_in norm=1.023323)
[S2] cosine check vs S7: cos=-0.0592
[S2] DROPPED delta from S7 (cos=-0.0592 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1803) from S5
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.513949)
[S17] loaded HEAD from S5 (vec_in norm=1.513949)
[S17] cosine check vs S5: cos=0.4265
[S17] BUFFERED delta from S5 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1797) from S9
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.396141)
[S15] loaded HEAD from S9 (vec_in norm=1.396141)
[S15] cosine check vs S9: cos=-0.2080
[S15] DROPPED delta from S9 (cos=-0.2080 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1797) from S14
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.405536)
[S17] loaded HEAD from S14 (vec_in norm=1.405536)
[S17] cosine check vs S14: cos=0.6139
[S17] BUFFERED delta from S14 (total buffered=3)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:39016
[S17] sending update (kind=head size=1800 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1800) from S17
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.675573)
[S16] loaded HEAD from S17 (vec_in norm=0.675573)
[S16] cosine check vs S17: cos=0.8729
[S16] BUFFERED delta from S17 (total buffered=1)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=13 metric=0.6636 head_norm=1.508820
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.112536e-01
[S10] stored merged vector for next round verification (round=13)
[S10] DEBUG after merge:  round=13 metric=0.6850 head_norm=1.513700 delta_norm=0.111254
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=13 metric=0.7023 head_norm=1.038594
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.991536e-02
[S6] stored merged vector for next round verification (round=13)
[S6] DEBUG after merge:  round=13 metric=0.6984 head_norm=1.057473 delta_norm=0.089915
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=13 metric=0.3847 head_norm=0.641744
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.668401e-01
[S16] stored merged vector for next round verification (round=13)
[S16] DEBUG after merge:  round=13 metric=0.3853 head_norm=0.637402 delta_norm=0.166840
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=13 metric=0.6839 head_norm=1.023323
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.036317e-01
[S7] stored merged vector for next round verification (round=13)
[S7] DEBUG after merge:  round=13 metric=0.6613 head_norm=0.604269 delta_norm=0.603632
[S7] aggregate: ROLLBACK (f1_val pre=0.684 post=0.661 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=13 metric=0.3579 head_norm=0.675573
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.520035e-01
[S17] stored merged vector for next round verification (round=13)
[S17] DEBUG after merge:  round=13 metric=0.3579 head_norm=0.678868 delta_norm=0.152003
[S17] aggregate: ACCEPT kept=['S6', 'S5', 'S14'] (k=3/3) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.648678 (no previous merge yet)
[S2] round=14 local utility u=0.000000 metrics={'f1_val': 0.7070738394104226, 'auprc': 0.7322910413377381, 'loss_val': 0.34928097573565037, 'psi': 0.7171607201813488}-{'f1_val': 0.7011221683038497, 'auprc': 0.7759087584894112, 'loss_val': 0.3356792514850488, 'psi': 0.7310368043780743}
[S3] START round=14 head_norm_before_train=1.653333 (no previous merge yet)
[S3] round=14 local utility u=0.009653 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.9956853203302359, 'loss_val': 0.2861285164772735, 'psi': 0.8187731691473807}-{'f1_val': 0.7005813959920884, 'auprc': 0.9956956986462163, 'loss_val': 0.30396293635375143, 'psi': 0.8186271170537396}
[S4] START round=14 head_norm_before_train=1.526694 cos_to_last_merge=0.9989 (last merge round=12)
[S4] round=14 local utility u=0.000000 metrics={'f1_val': 0.6680070490428552, 'auprc': 0.8086019399366807, 'loss_val': 0.4527676571171847, 'psi': 0.7242450054003855}-{'f1_val': 0.6635362174548205, 'auprc': 0.8643055534342978, 'loss_val': 0.505661190982347, 'psi': 0.7438439518466115}
[S5] START round=14 head_norm_before_train=1.513949 cos_to_last_merge=0.9961 (last merge round=11)
[S5] round=14 local utility u=0.051545 metrics={'f1_val': 0.7005685100046517, 'auprc': 0.7944040742604305, 'loss_val': 0.4253113835002593, 'psi': 0.7381027357069632}-{'f1_val': 0.7009351540145, 'auprc': 0.792474801356743, 'loss_val': 0.5248143075490518, 'psi': 0.7375510129513971}
[S6] START round=14 head_norm_before_train=1.057473 cos_to_last_merge=1.0000 (last merge round=13)
[S6] round=14 local utility u=0.016073 metrics={'f1_val': 0.7001349205142613, 'auprc': 0.7887650550214091, 'loss_val': 0.5666952328789396, 'psi': 0.7355869743171204}-{'f1_val': 0.7022884746714576, 'auprc': 0.7879953944938952, 'loss_val': 0.6094527521329037, 'psi': 0.7365712426004327}
[S7] START round=14 head_norm_before_train=0.604269 cos_to_last_merge=1.0000 (last merge round=13)
[S7] round=14 local utility u=0.000000 metrics={'f1_val': 0.6816059476922716, 'auprc': 0.7857965012318749, 'loss_val': 0.8175588837965051, 'psi': 0.7232821691081129}-{'f1_val': 0.6839240266953619, 'auprc': 0.7831255865333142, 'loss_val': 0.7233982590599354, 'psi': 0.7236046506305428}
[S8] START round=14 head_norm_before_train=1.547747 (no previous merge yet)
[S8] round=14 local utility u=0.015809 metrics={'f1_val': 0.7142391053978291, 'auprc': 0.9969790446023146, 'loss_val': 0.2504325109792419, 'psi': 0.8273350810796234}-{'f1_val': 0.7057293678977744, 'auprc': 0.9977753725839519, 'loss_val': 0.23338079320566382, 'psi': 0.8225477697722454}
[S9] START round=14 head_norm_before_train=1.396141 cos_to_last_merge=0.8579 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.858
[S9] round=14 local utility u=0.004529 metrics={'f1_val': 0.7015406642019387, 'auprc': 0.9984416557974269, 'loss_val': 0.26990329310004463, 'psi': 0.820301060840134}-{'f1_val': 0.7015406642019387, 'auprc': 0.9984430266383875, 'loss_val': 0.2789661764194945, 'psi': 0.8203016091765183}
[S10] START round=14 head_norm_before_train=1.513700 cos_to_last_merge=1.0000 (last merge round=13)
[S10] round=14 local utility u=1.000000 metrics={'f1_val': 0.9952004603848853, 'auprc': 0.9965707624150135, 'loss_val': 0.2690684066719741, 'psi': 0.9957485811969365}-{'f1_val': 0.6635633461912026, 'auprc': 0.9950376809158833, 'loss_val': 0.40642513855261914, 'psi': 0.796153080081075}
[S11] START round=14 head_norm_before_train=1.577283 (no previous merge yet)
[S11] round=14 local utility u=0.207792 metrics={'f1_val': 0.7020007759458987, 'auprc': 0.9963794100914942, 'loss_val': 0.296582454667525, 'psi': 0.8197522296041369}-{'f1_val': 0.647700292400142, 'auprc': 0.9964238411827127, 'loss_val': 0.3864973478651467, 'psi': 0.7871897119131703}
[S13] START round=14 head_norm_before_train=1.527897 (no previous merge yet)
[S13] round=14 local utility u=0.000000 metrics={'f1_val': 0.5669125827056365, 'auprc': 0.8037731337111433, 'loss_val': 0.6432550613554135, 'psi': 0.6616568031078393}-{'f1_val': 0.634910738446176, 'auprc': 0.7599458495155733, 'loss_val': 0.5313873932046406, 'psi': 0.6849247828739349}
[S14] START round=14 head_norm_before_train=1.405536 cos_to_last_merge=0.9982 (last merge round=12)
[S14] round=14 local utility u=0.067302 metrics={'f1_val': 0.9970728011695729, 'auprc': 0.9969753447332804, 'loss_val': 0.363481430357675, 'psi': 0.9970338185950559}-{'f1_val': 0.987935484875396, 'auprc': 0.9969234907077756, 'loss_val': 0.44310521630096683, 'psi': 0.9915306872083478}
[S15] START round=14 head_norm_before_train=1.083508 cos_to_last_merge=0.7827 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.783
[S15] round=14 local utility u=0.335797 metrics={'f1_val': 0.6921522090764547, 'auprc': 0.966857981249479, 'loss_val': 0.3595854964387555, 'psi': 0.8020345179456645}-{'f1_val': 0.6959343504773781, 'auprc': 0.760314900759951, 'loss_val': 0.43424283213880066, 'psi': 0.7216865705904072}
[S16] START round=14 head_norm_before_train=0.637402 cos_to_last_merge=1.0000 (last merge round=13)
[S16] round=14 local utility u=0.000000 metrics={'f1_val': 0.3855631999270109, 'auprc': 0.7723211740541615, 'loss_val': 0.8897199154033373, 'psi': 0.5402663895778711}-{'f1_val': 0.3847038785992656, 'auprc': 0.7740909034582535, 'loss_val': 0.8841810927065038, 'psi': 0.5404586885428607}
[S17] START round=14 head_norm_before_train=0.678868 cos_to_last_merge=1.0000 (last merge round=13)
[S17] round=14 local utility u=0.000000 metrics={'f1_val': 0.36478254310902275, 'auprc': 0.6110551671625379, 'loss_val': 1.03748746565422, 'psi': 0.46329159273042886}-{'f1_val': 0.3578530536049874, 'auprc': 0.6398562522884519, 'loss_val': 1.0429037494536255, 'psi': 0.47065433307837323}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:39015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:39017
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:39017
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:39014
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:39009
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:39007
[S9] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1797) from S14
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.442841)
[S17] loaded HEAD from S14 (vec_in norm=1.442841)
[S17] cosine check vs S14: cos=0.5665
[S17] BUFFERED delta from S14 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1801) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.095293)
[S17] loaded HEAD from S6 (vec_in norm=1.095293)
[S17] cosine check vs S6: cos=0.5064
[S17] BUFFERED delta from S6 (total buffered=2)
[S8] RECEIVED delta(kind=head bytes=1798) from S3
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.675407)
[S8] loaded HEAD from S3 (vec_in norm=1.675407)
[S8] cosine check vs S3: cos=-0.0054
[S8] DROPPED delta from S3 (cos=-0.0054 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1799) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.543809)
[S14] loaded HEAD from S10 (vec_in norm=1.543809)
[S14] cosine check vs S10: cos=0.9746
[S14] BUFFERED delta from S10 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1795) from S15
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.122136)
[S6] loaded HEAD from S15 (vec_in norm=1.122136)
[S6] cosine check vs S15: cos=0.9897
[S6] BUFFERED delta from S15 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1799) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.603589)
[S5] loaded HEAD from S11 (vec_in norm=1.603589)
[S5] cosine check vs S11: cos=0.9829
[S5] BUFFERED delta from S11 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1801) from S5
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.542729)
[S17] loaded HEAD from S5 (vec_in norm=1.542729)
[S17] cosine check vs S5: cos=0.4849
[S17] BUFFERED delta from S5 (total buffered=3)
[S5] RECEIVED delta(kind=head bytes=1795) from S8
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.572795)
[S5] loaded HEAD from S8 (vec_in norm=1.572795)
[S5] cosine check vs S8: cos=-0.0161
[S5] DROPPED delta from S8 (cos=-0.0161 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1800) from S9
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.428510)
[S15] loaded HEAD from S9 (vec_in norm=1.428510)
[S15] cosine check vs S9: cos=-0.2075
[S15] DROPPED delta from S9 (cos=-0.2075 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=14 metric=0.7006 head_norm=1.542729
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.487078e-01
[S5] stored merged vector for next round verification (round=14)
[S5] DEBUG after merge:  round=14 metric=0.7006 head_norm=1.566410 delta_norm=0.148708
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=14 metric=0.9971 head_norm=1.442841
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.757159e-01
[S14] stored merged vector for next round verification (round=14)
[S14] DEBUG after merge:  round=14 metric=0.9862 head_norm=1.483810 delta_norm=0.175716
[S14] aggregate: ROLLBACK (f1_val pre=0.997 post=0.986 tol_abs=0.005 tol_rel=0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=14 metric=0.7001 head_norm=1.095293
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.059609e-02
[S6] stored merged vector for next round verification (round=14)
[S6] DEBUG after merge:  round=14 metric=0.6978 head_norm=1.105862 delta_norm=0.080596
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=14 metric=0.3648 head_norm=0.708906
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.322890e-01
[S17] stored merged vector for next round verification (round=14)
[S17] DEBUG after merge:  round=14 metric=0.3628 head_norm=0.711974 delta_norm=0.132289
[S17] aggregate: ACCEPT kept=['S14', 'S6', 'S5'] (k=3/3) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.673970 (no previous merge yet)
[S2] round=15 local utility u=0.000000 metrics={'f1_val': 0.717244701033635, 'auprc': 0.6909342862086818, 'loss_val': 0.3778836899320497, 'psi': 0.7067205351036537}-{'f1_val': 0.7070738394104226, 'auprc': 0.7322910413377381, 'loss_val': 0.34928097573565037, 'psi': 0.7171607201813488}
[S3] START round=15 head_norm_before_train=1.675407 (no previous merge yet)
[S3] round=15 local utility u=0.000000 metrics={'f1_val': 0.6998248967704441, 'auprc': 0.9947433965812678, 'loss_val': 0.2919747115481512, 'psi': 0.8177922966947736}-{'f1_val': 0.7008317350254774, 'auprc': 0.9956853203302359, 'loss_val': 0.2861285164772735, 'psi': 0.8187731691473807}
[S4] START round=15 head_norm_before_train=1.565413 cos_to_last_merge=0.9960 (last merge round=12)
[S4] round=15 local utility u=0.454769 metrics={'f1_val': 0.7404120079674945, 'auprc': 0.9517404869290998, 'loss_val': 0.4070755662237708, 'psi': 0.8249433995521367}-{'f1_val': 0.6680070490428552, 'auprc': 0.8086019399366807, 'loss_val': 0.4527676571171847, 'psi': 0.7242450054003855}
[S5] START round=15 head_norm_before_train=1.566410 cos_to_last_merge=1.0000 (last merge round=14)
[S5] round=15 local utility u=0.057957 metrics={'f1_val': 0.700320598491359, 'auprc': 0.8219004340891998, 'loss_val': 0.3903985012532178, 'psi': 0.7489525327304953}-{'f1_val': 0.7005685100046517, 'auprc': 0.7944040742604305, 'loss_val': 0.4253113835002593, 'psi': 0.7381027357069632}
[S6] START round=15 head_norm_before_train=1.105862 cos_to_last_merge=1.0000 (last merge round=14)
[S6] round=15 local utility u=0.338946 metrics={'f1_val': 0.7163240635279609, 'auprc': 0.9535731779029563, 'loss_val': 0.48036345393099084, 'psi': 0.8112237092779591}-{'f1_val': 0.7001349205142613, 'auprc': 0.7887650550214091, 'loss_val': 0.5666952328789396, 'psi': 0.7355869743171204}
[S7] START round=15 head_norm_before_train=0.644982 cos_to_last_merge=0.9953 (last merge round=13)
[S7] round=15 local utility u=0.000000 metrics={'f1_val': 0.623717789635983, 'auprc': 0.7871770202276789, 'loss_val': 0.8175919778453711, 'psi': 0.6891014818726614}-{'f1_val': 0.6816059476922716, 'auprc': 0.7857965012318749, 'loss_val': 0.8175588837965051, 'psi': 0.7232821691081129}
[S8] START round=15 head_norm_before_train=1.572795 (no previous merge yet)
[S8] round=15 local utility u=0.889071 metrics={'f1_val': 0.9961325992454066, 'auprc': 0.9980830617824037, 'loss_val': 0.16696342283260523, 'psi': 0.9969127842602055}-{'f1_val': 0.7142391053978291, 'auprc': 0.9969790446023146, 'loss_val': 0.2504325109792419, 'psi': 0.8273350810796234}
[S9] START round=15 head_norm_before_train=1.428510 cos_to_last_merge=0.8487 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.849
[S9] round=15 local utility u=0.005214 metrics={'f1_val': 0.7015406642019387, 'auprc': 0.9985272807409254, 'loss_val': 0.25973295743275265, 'psi': 0.8203353108175334}-{'f1_val': 0.7015406642019387, 'auprc': 0.9984416557974269, 'loss_val': 0.26990329310004463, 'psi': 0.820301060840134}
[S10] START round=15 head_norm_before_train=1.543809 cos_to_last_merge=0.9995 (last merge round=13)
[S10] round=15 local utility u=0.033249 metrics={'f1_val': 0.9950444545353663, 'auprc': 0.9970769385766811, 'loss_val': 0.2031538644104932, 'psi': 0.9958574481518923}-{'f1_val': 0.9952004603848853, 'auprc': 0.9965707624150135, 'loss_val': 0.2690684066719741, 'psi': 0.9957485811969365}
[S11] START round=15 head_norm_before_train=1.603589 (no previous merge yet)
[S11] round=15 local utility u=0.013581 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9962959333005129, 'loss_val': 0.26877759864871054, 'psi': 0.8196795632991972}-{'f1_val': 0.7020007759458987, 'auprc': 0.9963794100914942, 'loss_val': 0.296582454667525, 'psi': 0.8197522296041369}
[S13] START round=15 head_norm_before_train=1.537405 (no previous merge yet)
[S13] round=15 local utility u=0.264549 metrics={'f1_val': 0.6801239074382823, 'auprc': 0.7244355677596531, 'loss_val': 0.5554114077747132, 'psi': 0.6978485715668306}-{'f1_val': 0.5669125827056365, 'auprc': 0.8037731337111433, 'loss_val': 0.6432550613554135, 'psi': 0.6616568031078393}
[S14] START round=15 head_norm_before_train=1.483810 cos_to_last_merge=1.0000 (last merge round=14)
[S14] round=15 local utility u=0.030607 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9969742939002832, 'loss_val': 0.3018132394542651, 'psi': 0.9969882224547124}-{'f1_val': 0.9970728011695729, 'auprc': 0.9969753447332804, 'loss_val': 0.363481430357675, 'psi': 0.9970338185950559}
[S15] START round=15 head_norm_before_train=1.122136 cos_to_last_merge=0.7729 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.773
[S15] round=15 local utility u=0.000000 metrics={'f1_val': 0.6952955210630375, 'auprc': 0.9127037797060453, 'loss_val': 0.363575089128051, 'psi': 0.7822588245202406}-{'f1_val': 0.6921522090764547, 'auprc': 0.966857981249479, 'loss_val': 0.3595854964387555, 'psi': 0.8020345179456645}
[S16] START round=15 head_norm_before_train=0.677454 cos_to_last_merge=0.9919 (last merge round=13)
[S16] round=15 local utility u=0.032269 metrics={'f1_val': 0.38547559770511425, 'auprc': 0.7733931150106463, 'loss_val': 0.8278724151056909, 'psi': 0.5406426046273272}-{'f1_val': 0.3855631999270109, 'auprc': 0.7723211740541615, 'loss_val': 0.8897199154033373, 'psi': 0.5402663895778711}
[S17] START round=15 head_norm_before_train=0.711974 cos_to_last_merge=1.0000 (last merge round=14)
[S17] round=15 local utility u=0.000000 metrics={'f1_val': 0.3599371307066471, 'auprc': 0.6052086972282111, 'loss_val': 1.0352992921267088, 'psi': 0.45804575731527275}-{'f1_val': 0.36478254310902275, 'auprc': 0.6110551671625379, 'loss_val': 1.03748746565422, 'psi': 0.46329159273042886}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:39008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:39015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S10@127.0.0.1:39011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:39017
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:39014
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S13] → sending delta(kind=head bytes=1807) to S4@127.0.0.1:39004
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:39017
[S5] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1807 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1793 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1799) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.728442)
[S7] loaded HEAD from S16 (vec_in norm=0.728442)
[S7] cosine check vs S16: cos=0.4454
[S7] BUFFERED delta from S16 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1807) from S13
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.549183)
[S4] loaded HEAD from S13 (vec_in norm=1.549183)
[S4] cosine check vs S13: cos=0.9670
[S4] BUFFERED delta from S13 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1799) from S9
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.455229)
[S15] loaded HEAD from S9 (vec_in norm=1.455229)
[S15] cosine check vs S9: cos=-0.2071
[S15] DROPPED delta from S9 (cos=-0.2071 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1793) from S8
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.596407)
[S5] loaded HEAD from S8 (vec_in norm=1.596407)
[S5] cosine check vs S8: cos=-0.0075
[S5] DROPPED delta from S8 (cos=-0.0075 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1801) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.628404)
[S5] loaded HEAD from S11 (vec_in norm=1.628404)
[S5] cosine check vs S11: cos=0.9924
[S5] BUFFERED delta from S11 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1804) from S4
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.601420)
[S10] loaded HEAD from S4 (vec_in norm=1.601420)
[S10] cosine check vs S4: cos=0.9927
[S10] BUFFERED delta from S4 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1801) from S5
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.594878)
[S17] loaded HEAD from S5 (vec_in norm=1.594878)
[S17] cosine check vs S5: cos=0.5112
[S17] BUFFERED delta from S5 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1800) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.142555)
[S17] loaded HEAD from S6 (vec_in norm=1.142555)
[S17] cosine check vs S6: cos=0.5223
[S17] BUFFERED delta from S6 (total buffered=2)
[S17] RECEIVED delta(kind=head bytes=1804) from S14
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.517200)
[S17] loaded HEAD from S14 (vec_in norm=1.517200)
[S17] cosine check vs S14: cos=0.5303
[S17] BUFFERED delta from S14 (total buffered=3)
[S14] RECEIVED delta(kind=head bytes=1801) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.576432)
[S14] loaded HEAD from S10 (vec_in norm=1.576432)
[S14] cosine check vs S10: cos=0.9896
[S14] BUFFERED delta from S10 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] ⇄ pheromone p=0.172 → S8@127.0.0.1:39009
[S2] ⇄ pheromone p=0.100 → S9@127.0.0.1:39010
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=15 metric=0.6237 head_norm=0.696432
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.754021e-01
[S7] stored merged vector for next round verification (round=15)
[S7] DEBUG after merge:  round=15 metric=0.5365 head_norm=0.605720 delta_norm=0.375402
[S7] aggregate: ROLLBACK (f1_val pre=0.624 post=0.537 tol_abs=0.005 tol_rel=0.0)
[S7] ⇄ pheromone p=0.205 → S2@127.0.0.1:39002
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=15 metric=0.9970 head_norm=1.517200
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.154176e-01
[S14] stored merged vector for next round verification (round=15)
[S14] DEBUG after merge:  round=15 metric=0.9970 head_norm=1.542789 delta_norm=0.115418
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.268 → S17@127.0.0.1:39017
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=15 metric=0.7404 head_norm=1.601420
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.040135e-01
[S4] stored merged vector for next round verification (round=15)
[S4] DEBUG after merge:  round=15 metric=0.8175 head_norm=1.562253 delta_norm=0.204013
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.223 → S10@127.0.0.1:39011
[S8] ⇄ pheromone p=0.304 → S5@127.0.0.1:39005
[S9] ⇄ pheromone p=0.102 → S15@127.0.0.1:39015
[S16] ⇄ pheromone p=0.119 → S7@127.0.0.1:39008
[S13] ⇄ pheromone p=0.199 → S4@127.0.0.1:39004
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=15 metric=0.7003 head_norm=1.594878
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.008478e-01
[S5] stored merged vector for next round verification (round=15)
[S5] DEBUG after merge:  round=15 metric=0.7003 head_norm=1.608570 delta_norm=0.100848
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.232 → S17@127.0.0.1:39017
[S11] ⇄ pheromone p=0.172 → S5@127.0.0.1:39005
[S6] ⇄ pheromone p=0.264 → S17@127.0.0.1:39017
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=15 metric=0.9950 head_norm=1.576432
[S10] _apply_head_vector_avg (torch): Δ‖w‖=9.682741e-02
[S10] stored merged vector for next round verification (round=15)
[S10] DEBUG after merge:  round=15 metric=0.9955 head_norm=1.586022 delta_norm=0.096827
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.323 → S14@127.0.0.1:39014
[S17] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=15 metric=0.3599 head_norm=0.741750
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.308084e-01
[S17] stored merged vector for next round verification (round=15)
[S17] DEBUG after merge:  round=15 metric=0.3597 head_norm=0.743865 delta_norm=0.130808
[S17] aggregate: ACCEPT kept=['S5', 'S6', 'S14'] (k=3/3) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.086 → S16@127.0.0.1:39016
[S15] ⇄ pheromone p=0.199 → S6@127.0.0.1:39007
[S2] START round=16 head_norm_before_train=1.694991 (no previous merge yet)
[S2] round=16 local utility u=0.000000 metrics={'f1_val': 0.686959722263939, 'auprc': 0.7049312331984172, 'loss_val': 0.41219196951205345, 'psi': 0.6941483266377303}-{'f1_val': 0.717244701033635, 'auprc': 0.6909342862086818, 'loss_val': 0.3778836899320497, 'psi': 0.7067205351036537}
[S3] START round=16 head_norm_before_train=1.693836 (no previous merge yet)
[S3] round=16 local utility u=0.000000 metrics={'f1_val': 0.6390570012680562, 'auprc': 0.9610381227082828, 'loss_val': 0.38134449931988434, 'psi': 0.7678494498441468}-{'f1_val': 0.6998248967704441, 'auprc': 0.9947433965812678, 'loss_val': 0.2919747115481512, 'psi': 0.8177922966947736}
[S4] START round=16 head_norm_before_train=1.562253 cos_to_last_merge=1.0000 (last merge round=15)
[S4] round=16 local utility u=0.601467 metrics={'f1_val': 0.9454527041412287, 'auprc': 0.936173492586119, 'loss_val': 0.3876854093054368, 'psi': 0.9417410195191849}-{'f1_val': 0.7404120079674945, 'auprc': 0.9517404869290998, 'loss_val': 0.4070755662237708, 'psi': 0.8249433995521367}
[S5] START round=16 head_norm_before_train=1.608570 cos_to_last_merge=1.0000 (last merge round=15)
[S5] round=16 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.8021072747493744, 'loss_val': 0.37551925259014934, 'psi': 0.7410352689945652}-{'f1_val': 0.700320598491359, 'auprc': 0.8219004340891998, 'loss_val': 0.3903985012532178, 'psi': 0.7489525327304953}
[S6] START round=16 head_norm_before_train=1.142555 cos_to_last_merge=0.9985 (last merge round=14)
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.6486491364047233, 'auprc': 0.7832731860879483, 'loss_val': 0.535010964407192, 'psi': 0.7024987562780133}-{'f1_val': 0.7163240635279609, 'auprc': 0.9535731779029563, 'loss_val': 0.48036345393099084, 'psi': 0.8112237092779591}
[S7] START round=16 head_norm_before_train=0.605720 cos_to_last_merge=1.0000 (last merge round=15)
[S7] round=16 local utility u=0.000000 metrics={'f1_val': 0.38128706752657204, 'auprc': 0.7450906420181663, 'loss_val': 1.0553751826659976, 'psi': 0.5268084973232098}-{'f1_val': 0.623717789635983, 'auprc': 0.7871770202276789, 'loss_val': 0.8175919778453711, 'psi': 0.6891014818726614}
[S8] START round=16 head_norm_before_train=1.596407 (no previous merge yet)
[S8] round=16 local utility u=0.005729 metrics={'f1_val': 0.9948741547680577, 'auprc': 0.9982838892284448, 'loss_val': 0.14855730420169655, 'psi': 0.9962380485522125}-{'f1_val': 0.9961325992454066, 'auprc': 0.9980830617824037, 'loss_val': 0.16696342283260523, 'psi': 0.9969127842602055}
[S9] START round=16 head_norm_before_train=1.455229 cos_to_last_merge=0.8414 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.841
[S9] round=16 local utility u=0.016903 metrics={'f1_val': 0.7014667606303384, 'auprc': 0.9982261523996443, 'loss_val': 0.22457986233953303, 'psi': 0.8201705173380608}-{'f1_val': 0.7015406642019387, 'auprc': 0.9985272807409254, 'loss_val': 0.25973295743275265, 'psi': 0.8203353108175334}
[S10] START round=16 head_norm_before_train=1.586022 cos_to_last_merge=1.0000 (last merge round=15)
[S10] round=16 local utility u=0.008511 metrics={'f1_val': 0.9946649101882683, 'auprc': 0.9972013728822255, 'loss_val': 0.1842285339997842, 'psi': 0.9956794952658512}-{'f1_val': 0.9950444545353663, 'auprc': 0.9970769385766811, 'loss_val': 0.2031538644104932, 'psi': 0.9958574481518923}
[S11] START round=16 head_norm_before_train=1.628404 (no previous merge yet)
[S11] round=16 local utility u=0.013958 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9962068563551126, 'loss_val': 0.2405937495495062, 'psi': 0.8196439325210372}-{'f1_val': 0.7019353166316534, 'auprc': 0.9962959333005129, 'loss_val': 0.26877759864871054, 'psi': 0.8196795632991972}
[S13] START round=16 head_norm_before_train=1.549183 (no previous merge yet)
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.631096809981323, 'auprc': 0.7143356143648185, 'loss_val': 0.5669604841501686, 'psi': 0.6643923317347212}-{'f1_val': 0.6801239074382823, 'auprc': 0.7244355677596531, 'loss_val': 0.5554114077747132, 'psi': 0.6978485715668306}
[S14] START round=16 head_norm_before_train=1.542789 cos_to_last_merge=1.0000 (last merge round=15)
[S14] round=16 local utility u=0.027801 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9955432634486162, 'loss_val': 0.24583935742819005, 'psi': 0.9968079762093587}-{'f1_val': 0.9969975081576651, 'auprc': 0.9969742939002832, 'loss_val': 0.3018132394542651, 'psi': 0.9969882224547124}
[S15] START round=16 head_norm_before_train=1.161645 cos_to_last_merge=0.7644 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.764
[S15] round=16 local utility u=0.000000 metrics={'f1_val': 0.7004591771403846, 'auprc': 0.7984935868038422, 'loss_val': 0.3801069439653768, 'psi': 0.7396729410057676}-{'f1_val': 0.6952955210630375, 'auprc': 0.9127037797060453, 'loss_val': 0.363575089128051, 'psi': 0.7822588245202406}
[S16] START round=16 head_norm_before_train=0.728442 cos_to_last_merge=0.9731 (last merge round=13)
[S16] round=16 local utility u=0.064589 metrics={'f1_val': 0.38684511539008576, 'auprc': 0.7907959271889429, 'loss_val': 0.7591197780505907, 'psi': 0.5484254401096287}-{'f1_val': 0.38547559770511425, 'auprc': 0.7733931150106463, 'loss_val': 0.8278724151056909, 'psi': 0.5406426046273272}
[S17] START round=16 head_norm_before_train=0.743865 cos_to_last_merge=1.0000 (last merge round=15)
[S17] round=16 local utility u=0.341002 metrics={'f1_val': 0.4701770787699079, 'auprc': 0.6062193997959241, 'loss_val': 1.0177679181505273, 'psi': 0.5245940071803143}-{'f1_val': 0.3599371307066471, 'auprc': 0.6052086972282111, 'loss_val': 1.0352992921267088, 'psi': 0.45804575731527275}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:39005
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:39017
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:39015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:39014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:39011
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] → sending delta(kind=head bytes=1792) to S5@127.0.0.1:39005
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:39008
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1792 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1799) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.788343)
[S7] loaded HEAD from S16 (vec_in norm=0.788343)
[S7] cosine check vs S16: cos=0.7745
[S7] BUFFERED delta from S16 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1802) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.655769)
[S5] loaded HEAD from S11 (vec_in norm=1.655769)
[S5] cosine check vs S11: cos=0.9959
[S5] BUFFERED delta from S11 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1792) from S8
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.616681)
[S5] loaded HEAD from S8 (vec_in norm=1.616681)
[S5] cosine check vs S8: cos=-0.0028
[S5] DROPPED delta from S8 (cos=-0.0028 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1801) from S4
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.594158)
[S10] loaded HEAD from S4 (vec_in norm=1.594158)
[S10] cosine check vs S4: cos=0.9909
[S10] BUFFERED delta from S4 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1800) from S14
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.575466)
[S17] loaded HEAD from S14 (vec_in norm=1.575466)
[S17] cosine check vs S14: cos=0.5123
[S17] BUFFERED delta from S14 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1800) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.611250)
[S14] loaded HEAD from S10 (vec_in norm=1.611250)
[S14] cosine check vs S10: cos=0.9924
[S14] BUFFERED delta from S10 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1797) from S9
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.478260)
[S15] loaded HEAD from S9 (vec_in norm=1.478260)
[S15] cosine check vs S9: cos=-0.2070
[S15] DROPPED delta from S9 (cos=-0.2070 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:39016
[S17] sending update (kind=head size=1798 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1798) from S17
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.773475)
[S16] loaded HEAD from S17 (vec_in norm=0.773475)
[S16] cosine check vs S17: cos=0.8099
[S16] BUFFERED delta from S17 (total buffered=1)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=16 metric=0.7003 head_norm=1.631569
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.517442e-02
[S5] stored merged vector for next round verification (round=16)
[S5] DEBUG after merge:  round=16 metric=0.7003 head_norm=1.641993 delta_norm=0.075174
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=16 metric=0.3813 head_norm=0.644186
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.498846e-01
[S7] stored merged vector for next round verification (round=16)
[S7] DEBUG after merge:  round=16 metric=0.3215 head_norm=0.675121 delta_norm=0.249885
[S7] aggregate: ROLLBACK (f1_val pre=0.381 post=0.321 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=16 metric=0.3868 head_norm=0.788343
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.408499e-01
[S16] stored merged vector for next round verification (round=16)
[S16] DEBUG after merge:  round=16 metric=0.3826 head_norm=0.742876 delta_norm=0.240850
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=16 metric=0.9977 head_norm=1.575466
[S14] _apply_head_vector_avg (torch): Δ‖w‖=9.974974e-02
[S14] stored merged vector for next round verification (round=16)
[S14] DEBUG after merge:  round=16 metric=0.9977 head_norm=1.590333 delta_norm=0.099750
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=16 metric=0.9947 head_norm=1.611250
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.086280e-01
[S10] stored merged vector for next round verification (round=16)
[S10] DEBUG after merge:  round=16 metric=0.9947 head_norm=1.599041 delta_norm=0.108628
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=16 metric=0.4702 head_norm=0.773475
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.767001e-01
[S17] stored merged vector for next round verification (round=16)
[S17] DEBUG after merge:  round=16 metric=0.3524 head_norm=1.040315 delta_norm=0.676700
[S17] aggregate: ROLLBACK (f1_val pre=0.470 post=0.352 tol_abs=0.005 tol_rel=0.0)
[S2] START round=17 head_norm_before_train=1.713719 (no previous merge yet)
[S2] round=17 local utility u=0.369837 metrics={'f1_val': 0.7745210964212157, 'auprc': 0.7700679385377938, 'loss_val': 0.3932956867907447, 'psi': 0.772739833267847}-{'f1_val': 0.686959722263939, 'auprc': 0.7049312331984172, 'loss_val': 0.41219196951205345, 'psi': 0.6941483266377303}
[S3] START round=17 head_norm_before_train=1.713126 (no previous merge yet)
[S3] round=17 local utility u=0.169014 metrics={'f1_val': 0.6712739518685666, 'auprc': 0.9934891177111923, 'loss_val': 0.3339720335216147, 'psi': 0.800160018205617}-{'f1_val': 0.6390570012680562, 'auprc': 0.9610381227082828, 'loss_val': 0.38134449931988434, 'psi': 0.7678494498441468}
[S4] START round=17 head_norm_before_train=1.594158 cos_to_last_merge=0.9993 (last merge round=15)
[S4] round=17 local utility u=0.000000 metrics={'f1_val': 0.9325563029900109, 'auprc': 0.9522598663872578, 'loss_val': 0.36735380952474267, 'psi': 0.9404377283489096}-{'f1_val': 0.9454527041412287, 'auprc': 0.936173492586119, 'loss_val': 0.3876854093054368, 'psi': 0.9417410195191849}
[S5] START round=17 head_norm_before_train=1.641993 cos_to_last_merge=1.0000 (last merge round=16)
[S5] round=17 local utility u=0.000000 metrics={'f1_val': 0.6453900443932961, 'auprc': 0.7909048945674735, 'loss_val': 0.6601690811324131, 'psi': 0.703595984462967}-{'f1_val': 0.700320598491359, 'auprc': 0.8021072747493744, 'loss_val': 0.37551925259014934, 'psi': 0.7410352689945652}
[S6] START round=17 head_norm_before_train=1.176611 cos_to_last_merge=0.9955 (last merge round=14)
[S6] round=17 local utility u=0.847313 metrics={'f1_val': 0.8265448611809508, 'auprc': 0.9544061438589503, 'loss_val': 0.42115728113520096, 'psi': 0.8776893742521505}-{'f1_val': 0.6486491364047233, 'auprc': 0.7832731860879483, 'loss_val': 0.535010964407192, 'psi': 0.7024987562780133}
[S7] START round=17 head_norm_before_train=0.675121 cos_to_last_merge=1.0000 (last merge round=16)
[S7] round=17 local utility u=0.941093 metrics={'f1_val': 0.6573108309330489, 'auprc': 0.7844340887954118, 'loss_val': 0.9473611075479884, 'psi': 0.708160134077994}-{'f1_val': 0.38128706752657204, 'auprc': 0.7450906420181663, 'loss_val': 1.0553751826659976, 'psi': 0.5268084973232098}
[S8] START round=17 head_norm_before_train=1.616681 (no previous merge yet)
[S8] round=17 local utility u=0.002584 metrics={'f1_val': 0.9950886061981945, 'auprc': 0.9980511419133984, 'loss_val': 0.14397719995596275, 'psi': 0.9962736204842761}-{'f1_val': 0.9948741547680577, 'auprc': 0.9982838892284448, 'loss_val': 0.14855730420169655, 'psi': 0.9962380485522125}
[S9] START round=17 head_norm_before_train=1.478260 cos_to_last_merge=0.8355 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.835
[S9] round=17 local utility u=0.004394 metrics={'f1_val': 0.7014667606303384, 'auprc': 0.9982312420830897, 'loss_val': 0.21580796216333512, 'psi': 0.8201725532114389}-{'f1_val': 0.7014667606303384, 'auprc': 0.9982261523996443, 'loss_val': 0.22457986233953303, 'psi': 0.8201705173380608}
[S10] START round=17 head_norm_before_train=1.599041 cos_to_last_merge=1.0000 (last merge round=16)
[S10] round=17 local utility u=0.000000 metrics={'f1_val': 0.9947723700160056, 'auprc': 0.9941902855798295, 'loss_val': 0.19735910584797223, 'psi': 0.9945395362415351}-{'f1_val': 0.9946649101882683, 'auprc': 0.9972013728822255, 'loss_val': 0.1842285339997842, 'psi': 0.9956794952658512}
[S11] START round=17 head_norm_before_train=1.655769 (no previous merge yet)
[S11] round=17 local utility u=0.766258 metrics={'f1_val': 0.955449761603214, 'auprc': 0.9977688540314392, 'loss_val': 0.23385002779825578, 'psi': 0.9723773985745041}-{'f1_val': 0.7019353166316534, 'auprc': 0.9962068563551126, 'loss_val': 0.2405937495495062, 'psi': 0.8196439325210372}
[S13] START round=17 head_norm_before_train=1.560134 (no previous merge yet)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.5597988990445595, 'auprc': 0.7846676747977577, 'loss_val': 0.7090827715540726, 'psi': 0.6497464093458387}-{'f1_val': 0.631096809981323, 'auprc': 0.7143356143648185, 'loss_val': 0.5669604841501686, 'psi': 0.6643923317347212}
[S14] START round=17 head_norm_before_train=1.590333 cos_to_last_merge=1.0000 (last merge round=16)
[S14] round=17 local utility u=0.018778 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9968388618362909, 'loss_val': 0.20578705640312012, 'psi': 0.9966878837009665}-{'f1_val': 0.9976511180498535, 'auprc': 0.9955432634486162, 'loss_val': 0.24583935742819005, 'psi': 0.9968079762093587}
[S15] START round=17 head_norm_before_train=1.199978 cos_to_last_merge=0.7570 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.757
[S15] round=17 local utility u=0.316496 metrics={'f1_val': 0.6932836492745436, 'auprc': 0.9855984389839578, 'loss_val': 0.26537651111048693, 'psi': 0.8102095651583092}-{'f1_val': 0.7004591771403846, 'auprc': 0.7984935868038422, 'loss_val': 0.3801069439653768, 'psi': 0.7396729410057676}
[S16] START round=17 head_norm_before_train=0.742876 cos_to_last_merge=1.0000 (last merge round=16)
[S16] round=17 local utility u=0.093037 metrics={'f1_val': 0.4203558669516202, 'auprc': 0.7936959882128174, 'loss_val': 0.7828111733993007, 'psi': 0.5696919154560991}-{'f1_val': 0.38684511539008576, 'auprc': 0.7907959271889429, 'loss_val': 0.7591197780505907, 'psi': 0.5484254401096287}
[S17] START round=17 head_norm_before_train=1.040315 cos_to_last_merge=1.0000 (last merge round=16)
[S17] round=17 local utility u=0.000000 metrics={'f1_val': 0.3536296557603551, 'auprc': 0.6169408792831265, 'loss_val': 1.0174997474296845, 'psi': 0.45895414516946365}-{'f1_val': 0.4701770787699079, 'auprc': 0.6062193997959241, 'loss_val': 1.0177679181505273, 'psi': 0.5245940071803143}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:39008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:39015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:39002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:39007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:39009
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:39010
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:39005
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1797) from S14
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.625714)
[S17] loaded HEAD from S14 (vec_in norm=1.625714)
[S17] cosine check vs S14: cos=0.9274
[S17] BUFFERED delta from S14 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1795) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.798427)
[S7] loaded HEAD from S16 (vec_in norm=0.798427)
[S7] cosine check vs S16: cos=0.8997
[S7] BUFFERED delta from S16 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1798) from S3
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.734248)
[S8] loaded HEAD from S3 (vec_in norm=1.734248)
[S8] cosine check vs S3: cos=-0.0056
[S8] DROPPED delta from S3 (cos=-0.0056 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1797) from S9
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.498644)
[S15] loaded HEAD from S9 (vec_in norm=1.498644)
[S15] cosine check vs S9: cos=-0.2076
[S15] DROPPED delta from S9 (cos=-0.2076 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1796) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.686207)
[S5] loaded HEAD from S11 (vec_in norm=1.686207)
[S5] cosine check vs S11: cos=0.9974
[S5] BUFFERED delta from S11 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1798) from S15
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.235287)
[S6] loaded HEAD from S15 (vec_in norm=1.235287)
[S6] cosine check vs S15: cos=0.9741
[S6] BUFFERED delta from S15 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1795) from S8
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.633157)
[S5] loaded HEAD from S8 (vec_in norm=1.633157)
[S5] cosine check vs S8: cos=-0.0011
[S5] DROPPED delta from S8 (cos=-0.0011 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1802) from S7
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.702567)
[S2] loaded HEAD from S7 (vec_in norm=0.702567)
[S2] cosine check vs S7: cos=0.1614
[S2] BUFFERED delta from S7 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1801) from S2
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.731225)
[S9] loaded HEAD from S2 (vec_in norm=1.731225)
[S9] cosine check vs S2: cos=-0.0427
[S9] DROPPED delta from S2 (cos=-0.0427 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1798) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.209891)
[S17] loaded HEAD from S6 (vec_in norm=1.209891)
[S17] cosine check vs S6: cos=0.1586
[S17] BUFFERED delta from S6 (total buffered=2)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=17 metric=0.6454 head_norm=1.660448
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.126437e-02
[S5] stored merged vector for next round verification (round=17)
[S5] DEBUG after merge:  round=17 metric=0.6466 head_norm=1.672255 delta_norm=0.061264
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=17 metric=0.8265 head_norm=1.209891
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.398133e-01
[S6] stored merged vector for next round verification (round=17)
[S6] DEBUG after merge:  round=17 metric=0.8256 head_norm=1.214635 delta_norm=0.139813
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=17 metric=0.6573 head_norm=0.702567
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.744202e-01
[S7] stored merged vector for next round verification (round=17)
[S7] DEBUG after merge:  round=17 metric=0.5901 head_norm=0.731520 delta_norm=0.174420
[S7] aggregate: ROLLBACK (f1_val pre=0.657 post=0.590 tol_abs=0.005 tol_rel=0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=17 metric=0.7745 head_norm=1.731225
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.800790e-01
[S2] stored merged vector for next round verification (round=17)
[S2] DEBUG after merge:  round=17 metric=0.8276 head_norm=0.985308 delta_norm=0.880079
[S2] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=17 metric=0.3536 head_norm=1.061218
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.711576e-01
[S17] stored merged vector for next round verification (round=17)
[S17] DEBUG after merge:  round=17 metric=0.3529 head_norm=0.987606 delta_norm=0.271158
[S17] aggregate: ACCEPT kept=['S14', 'S6'] (k=2/2) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=0.985308 cos_to_last_merge=1.0000 (last merge round=17)
[S2] round=18 local utility u=0.170591 metrics={'f1_val': 0.8254512787485891, 'auprc': 0.8079190230463252, 'loss_val': 0.47124865412210015, 'psi': 0.8184383764676836}-{'f1_val': 0.7745210964212157, 'auprc': 0.7700679385377938, 'loss_val': 0.3932956867907447, 'psi': 0.772739833267847}
[S3] START round=18 head_norm_before_train=1.734248 (no previous merge yet)
[S3] round=18 local utility u=0.130810 metrics={'f1_val': 0.700330919019862, 'auprc': 0.9960440097064732, 'loss_val': 0.2543580234684828, 'psi': 0.8186161552945065}-{'f1_val': 0.6712739518685666, 'auprc': 0.9934891177111923, 'loss_val': 0.3339720335216147, 'psi': 0.800160018205617}
[S4] START round=18 head_norm_before_train=1.625432 cos_to_last_merge=0.9978 (last merge round=15)
[S4] round=18 local utility u=0.071172 metrics={'f1_val': 0.9379675348901396, 'auprc': 0.9635716788686022, 'loss_val': 0.2914118482721525, 'psi': 0.9482091924815246}-{'f1_val': 0.9325563029900109, 'auprc': 0.9522598663872578, 'loss_val': 0.36735380952474267, 'psi': 0.9404377283489096}
[S5] START round=18 head_norm_before_train=1.672255 cos_to_last_merge=1.0000 (last merge round=17)
[S5] round=18 local utility u=0.351113 metrics={'f1_val': 0.700320598491359, 'auprc': 0.8157082921542648, 'loss_val': 0.36193570149698046, 'psi': 0.7464756759565213}-{'f1_val': 0.6453900443932961, 'auprc': 0.7909048945674735, 'loss_val': 0.6601690811324131, 'psi': 0.703595984462967}
[S6] START round=18 head_norm_before_train=1.214635 cos_to_last_merge=1.0000 (last merge round=17)
[S6] round=18 local utility u=0.000000 metrics={'f1_val': 0.7980643528406752, 'auprc': 0.7808841240281534, 'loss_val': 0.523336012426297, 'psi': 0.7911922613156666}-{'f1_val': 0.8265448611809508, 'auprc': 0.9544061438589503, 'loss_val': 0.42115728113520096, 'psi': 0.8776893742521505}
[S7] START round=18 head_norm_before_train=0.731520 cos_to_last_merge=1.0000 (last merge round=17)
[S7] round=18 local utility u=0.000000 metrics={'f1_val': 0.6123829350444883, 'auprc': 0.78604792313842, 'loss_val': 1.0058640144993323, 'psi': 0.681848930282061}-{'f1_val': 0.6573108309330489, 'auprc': 0.7844340887954118, 'loss_val': 0.9473611075479884, 'psi': 0.708160134077994}
[S8] START round=18 head_norm_before_train=1.633157 (no previous merge yet)
[S8] round=18 local utility u=0.005944 metrics={'f1_val': 0.9952852018591252, 'auprc': 0.999016610316999, 'loss_val': 0.13616555106070213, 'psi': 0.9967777652422747}-{'f1_val': 0.9950886061981945, 'auprc': 0.9980511419133984, 'loss_val': 0.14397719995596275, 'psi': 0.9962736204842761}
[S9] START round=18 head_norm_before_train=1.498644 cos_to_last_merge=0.8309 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.831
[S9] round=18 local utility u=0.013029 metrics={'f1_val': 0.7014667606303384, 'auprc': 0.998135772291135, 'loss_val': 0.189463573931282, 'psi': 0.8201343652946571}-{'f1_val': 0.7014667606303384, 'auprc': 0.9982312420830897, 'loss_val': 0.21580796216333512, 'psi': 0.8201725532114389}
[S10] START round=18 head_norm_before_train=1.617971 cos_to_last_merge=0.9998 (last merge round=16)
[S10] round=18 local utility u=0.024115 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.994386726383843, 'loss_val': 0.15089373883858176, 'psi': 0.9947356024725829}-{'f1_val': 0.9947723700160056, 'auprc': 0.9941902855798295, 'loss_val': 0.19735910584797223, 'psi': 0.9945395362415351}
[S11] START round=18 head_norm_before_train=1.686207 (no previous merge yet)
[S11] round=18 local utility u=0.034892 metrics={'f1_val': 0.9573527113557667, 'auprc': 0.9978851249808454, 'loss_val': 0.17583162600568059, 'psi': 0.9735656768057982}-{'f1_val': 0.955449761603214, 'auprc': 0.9977688540314392, 'loss_val': 0.23385002779825578, 'psi': 0.9723773985745041}
[S13] START round=18 head_norm_before_train=1.575738 (no previous merge yet)
[S13] round=18 local utility u=0.000000 metrics={'f1_val': 0.6076607375372809, 'auprc': 0.5938311350696269, 'loss_val': 0.6143743704339858, 'psi': 0.6021288965502193}-{'f1_val': 0.5597988990445595, 'auprc': 0.7846676747977577, 'loss_val': 0.7090827715540726, 'psi': 0.6497464093458387}
[S14] START round=18 head_norm_before_train=1.625714 cos_to_last_merge=0.9992 (last merge round=16)
[S14] round=18 local utility u=0.037437 metrics={'f1_val': 0.9972408627570057, 'auprc': 0.9986413760061109, 'loss_val': 0.14024210696337377, 'psi': 0.9978010680566478}-{'f1_val': 0.9965872316107504, 'auprc': 0.9968388618362909, 'loss_val': 0.20578705640312012, 'psi': 0.9966878837009665}
[S15] START round=18 head_norm_before_train=1.235287 cos_to_last_merge=0.7509 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.751
[S15] round=18 local utility u=0.000000 metrics={'f1_val': 0.6969545527257656, 'auprc': 0.9746639480100476, 'loss_val': 0.3025655322248493, 'psi': 0.8080383108394784}-{'f1_val': 0.6932836492745436, 'auprc': 0.9855984389839578, 'loss_val': 0.26537651111048693, 'psi': 0.8102095651583092}
[S16] START round=18 head_norm_before_train=0.798427 cos_to_last_merge=0.9946 (last merge round=16)
[S16] round=18 local utility u=0.435985 metrics={'f1_val': 0.5427809890980486, 'auprc': 0.8168815064346935, 'loss_val': 0.7149476940103997, 'psi': 0.6524211960327065}-{'f1_val': 0.4203558669516202, 'auprc': 0.7936959882128174, 'loss_val': 0.7828111733993007, 'psi': 0.5696919154560991}
[S17] START round=18 head_norm_before_train=0.987606 cos_to_last_merge=1.0000 (last merge round=17)
[S17] round=18 local utility u=0.001136 metrics={'f1_val': 0.35267701428013964, 'auprc': 0.6129087126522255, 'loss_val': 0.9974161691885673, 'psi': 0.456769693628974}-{'f1_val': 0.3536296557603551, 'auprc': 0.6169408792831265, 'loss_val': 1.0174997474296845, 'psi': 0.45895414516946365}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:39014
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S16] → sending delta(kind=head bytes=1790) to S7@127.0.0.1:39008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:39015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:39009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S10@127.0.0.1:39011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S2] → sending delta(kind=head bytes=1788) to S9@127.0.0.1:39010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:39005
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:39017
[S5] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1790 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1805 to 1 peers)
[S2] sending update (kind=head size=1788 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1790) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.862238)
[S7] loaded HEAD from S16 (vec_in norm=0.862238)
[S7] cosine check vs S16: cos=0.9386
[S7] BUFFERED delta from S16 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1805) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.640075)
[S14] loaded HEAD from S10 (vec_in norm=1.640075)
[S14] cosine check vs S10: cos=0.9886
[S14] BUFFERED delta from S10 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1788) from S2
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.013997)
[S9] loaded HEAD from S2 (vec_in norm=1.013997)
[S9] cosine check vs S2: cos=0.0080
[S9] BUFFERED delta from S2 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1804) from S4
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.653764)
[S10] loaded HEAD from S4 (vec_in norm=1.653764)
[S10] cosine check vs S4: cos=0.9955
[S10] BUFFERED delta from S4 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1801) from S14
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.665337)
[S17] loaded HEAD from S14 (vec_in norm=1.665337)
[S17] cosine check vs S14: cos=0.8769
[S17] BUFFERED delta from S14 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1795) from S8
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.650517)
[S5] loaded HEAD from S8 (vec_in norm=1.650517)
[S5] cosine check vs S8: cos=-0.0014
[S5] DROPPED delta from S8 (cos=-0.0014 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1796) from S5
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.685175)
[S17] loaded HEAD from S5 (vec_in norm=1.685175)
[S17] cosine check vs S5: cos=0.0618
[S17] BUFFERED delta from S5 (total buffered=2)
[S8] RECEIVED delta(kind=head bytes=1800) from S3
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.759843)
[S8] loaded HEAD from S3 (vec_in norm=1.759843)
[S8] cosine check vs S3: cos=-0.0056
[S8] DROPPED delta from S3 (cos=-0.0056 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1800) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.721354)
[S5] loaded HEAD from S11 (vec_in norm=1.721354)
[S5] cosine check vs S11: cos=0.9982
[S5] BUFFERED delta from S11 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1798) from S9
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.516907)
[S15] loaded HEAD from S9 (vec_in norm=1.516907)
[S15] cosine check vs S9: cos=-0.2085
[S15] DROPPED delta from S9 (cos=-0.2085 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:39016
[S17] sending update (kind=head size=1798 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1798) from S17
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.010238)
[S16] loaded HEAD from S17 (vec_in norm=1.010238)
[S16] cosine check vs S17: cos=0.7330
[S16] BUFFERED delta from S17 (total buffered=1)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=18 metric=0.6124 head_norm=0.755083
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.511591e-01
[S7] stored merged vector for next round verification (round=18)
[S7] DEBUG after merge:  round=18 metric=0.5206 head_norm=0.796211 delta_norm=0.151159
[S7] aggregate: ROLLBACK (f1_val pre=0.612 post=0.521 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=18 metric=0.7015 head_norm=1.516907
[S9] _apply_head_vector_avg (torch): Δ‖w‖=9.089152e-01
[S9] stored merged vector for next round verification (round=18)
[S9] DEBUG after merge:  round=18 metric=0.7015 head_norm=0.915681 delta_norm=0.908915
[S9] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=18 metric=0.7003 head_norm=1.685175
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.381643e-02
[S5] stored merged vector for next round verification (round=18)
[S5] DEBUG after merge:  round=18 metric=0.7003 head_norm=1.702510 delta_norm=0.053816
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=18 metric=0.9972 head_norm=1.665337
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.252431e-01
[S14] stored merged vector for next round verification (round=18)
[S14] DEBUG after merge:  round=18 metric=0.9972 head_norm=1.648002 delta_norm=0.125243
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=18 metric=0.5428 head_norm=0.862238
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.489632e-01
[S16] stored merged vector for next round verification (round=18)
[S16] DEBUG after merge:  round=18 metric=0.5290 head_norm=0.871919 delta_norm=0.348963
[S16] aggregate: ROLLBACK (f1_val pre=0.543 post=0.529 tol_abs=0.005 tol_rel=0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=18 metric=0.9950 head_norm=1.640075
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.882015e-02
[S10] stored merged vector for next round verification (round=18)
[S10] DEBUG after merge:  round=18 metric=0.9950 head_norm=1.645046 delta_norm=0.078820
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=18 metric=0.3527 head_norm=1.010238
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.371895e-01
[S17] stored merged vector for next round verification (round=18)
[S17] DEBUG after merge:  round=18 metric=0.3685 head_norm=0.990637 delta_norm=0.437190
[S17] aggregate: ACCEPT kept=['S14', 'S5'] (k=2/2) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.013997 cos_to_last_merge=0.9994 (last merge round=17)
[S2] round=19 local utility u=0.000000 metrics={'f1_val': 0.7083633179830393, 'auprc': 0.8595865228079922, 'loss_val': 0.42381184154479273, 'psi': 0.7688525999130205}-{'f1_val': 0.8254512787485891, 'auprc': 0.8079190230463252, 'loss_val': 0.47124865412210015, 'psi': 0.8184383764676836}
[S3] START round=19 head_norm_before_train=1.759843 (no previous merge yet)
[S3] round=19 local utility u=0.034438 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.998565160329692, 'loss_val': 0.19559781668007586, 'psi': 0.8198797863730566}-{'f1_val': 0.700330919019862, 'auprc': 0.9960440097064732, 'loss_val': 0.2543580234684828, 'psi': 0.8186161552945065}
[S4] START round=19 head_norm_before_train=1.653764 cos_to_last_merge=0.9958 (last merge round=15)
[S4] round=19 local utility u=0.000000 metrics={'f1_val': 0.7727467783835295, 'auprc': 0.956192758087712, 'loss_val': 0.4174142633585637, 'psi': 0.8461251702652024}-{'f1_val': 0.9379675348901396, 'auprc': 0.9635716788686022, 'loss_val': 0.2914118482721525, 'psi': 0.9482091924815246}
[S5] START round=19 head_norm_before_train=1.702510 cos_to_last_merge=1.0000 (last merge round=18)
[S5] round=19 local utility u=0.031915 metrics={'f1_val': 0.700320598491359, 'auprc': 0.8340345719060653, 'loss_val': 0.35308386656000973, 'psi': 0.7538061878572415}-{'f1_val': 0.700320598491359, 'auprc': 0.8157082921542648, 'loss_val': 0.36193570149698046, 'psi': 0.7464756759565213}
[S6] START round=19 head_norm_before_train=1.241397 cos_to_last_merge=0.9995 (last merge round=17)
[S6] round=19 local utility u=0.000000 metrics={'f1_val': 0.7848447343153211, 'auprc': 0.7913294010169883, 'loss_val': 0.5016506938362001, 'psi': 0.787438600995988}-{'f1_val': 0.7980643528406752, 'auprc': 0.7808841240281534, 'loss_val': 0.523336012426297, 'psi': 0.7911922613156666}
[S7] START round=19 head_norm_before_train=0.796211 cos_to_last_merge=1.0000 (last merge round=18)
[S7] round=19 local utility u=0.000000 metrics={'f1_val': 0.5604777158864978, 'auprc': 0.7823714303853639, 'loss_val': 0.9991358335445335, 'psi': 0.6492352016860443}-{'f1_val': 0.6123829350444883, 'auprc': 0.78604792313842, 'loss_val': 1.0058640144993323, 'psi': 0.681848930282061}
[S8] START round=19 head_norm_before_train=1.650517 (no previous merge yet)
[S8] round=19 local utility u=0.010051 metrics={'f1_val': 0.9950223643478788, 'auprc': 0.9989461213564153, 'loss_val': 0.1142740934328231, 'psi': 0.9965918671512934}-{'f1_val': 0.9952852018591252, 'auprc': 0.999016610316999, 'loss_val': 0.13616555106070213, 'psi': 0.9967777652422747}
[S9] START round=19 head_norm_before_train=0.915681 cos_to_last_merge=1.0000 (last merge round=18)
[S9] round=19 local utility u=0.000000 metrics={'f1_val': 0.7014667606303384, 'auprc': 0.9981670451587944, 'loss_val': 0.3151273193583622, 'psi': 0.8201468744417209}-{'f1_val': 0.7014667606303384, 'auprc': 0.998135772291135, 'loss_val': 0.189463573931282, 'psi': 0.8201343652946571}
[S10] START round=19 head_norm_before_train=1.645046 cos_to_last_merge=1.0000 (last merge round=18)
[S10] round=19 local utility u=0.012370 metrics={'f1_val': 0.9943096789853013, 'auprc': 0.9958408937364955, 'loss_val': 0.12656478540379792, 'psi': 0.9949221648857789}-{'f1_val': 0.9949681865317428, 'auprc': 0.994386726383843, 'loss_val': 0.15089373883858176, 'psi': 0.9947356024725829}
[S11] START round=19 head_norm_before_train=1.721354 (no previous merge yet)
[S11] round=19 local utility u=0.047017 metrics={'f1_val': 0.9742630612091, 'auprc': 0.9967251112547787, 'loss_val': 0.17977950065692777, 'psi': 0.9832478812273715}-{'f1_val': 0.9573527113557667, 'auprc': 0.9978851249808454, 'loss_val': 0.17583162600568059, 'psi': 0.9735656768057982}
[S13] START round=19 head_norm_before_train=1.589443 (no previous merge yet)
[S13] round=19 local utility u=0.197820 metrics={'f1_val': 0.6152373141429756, 'auprc': 0.6851299661029007, 'loss_val': 0.538091259898341, 'psi': 0.6431943749269456}-{'f1_val': 0.6076607375372809, 'auprc': 0.5938311350696269, 'loss_val': 0.6143743704339858, 'psi': 0.6021288965502193}
[S14] START round=19 head_norm_before_train=1.648002 cos_to_last_merge=1.0000 (last merge round=18)
[S14] round=19 local utility u=0.000000 metrics={'f1_val': 0.9967774409524363, 'auprc': 0.9968548675748986, 'loss_val': 0.1415204277063164, 'psi': 0.9968084116014212}-{'f1_val': 0.9972408627570057, 'auprc': 0.9986413760061109, 'loss_val': 0.14024210696337377, 'psi': 0.9978010680566478}
[S15] START round=19 head_norm_before_train=1.272971 cos_to_last_merge=0.7446 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.745
[S15] round=19 local utility u=0.000000 metrics={'f1_val': 0.6985310452118054, 'auprc': 0.9475933329262558, 'loss_val': 0.3112649305382421, 'psi': 0.7981559602975856}-{'f1_val': 0.6969545527257656, 'auprc': 0.9746639480100476, 'loss_val': 0.3025655322248493, 'psi': 0.8080383108394784}
[S16] START round=19 head_norm_before_train=0.871919 cos_to_last_merge=1.0000 (last merge round=18)
[S16] round=19 local utility u=0.490687 metrics={'f1_val': 0.6947652068104606, 'auprc': 0.8360707949341558, 'loss_val': 0.7030473719500346, 'psi': 0.7512874420599387}-{'f1_val': 0.5427809890980486, 'auprc': 0.8168815064346935, 'loss_val': 0.7149476940103997, 'psi': 0.6524211960327065}
[S17] START round=19 head_norm_before_train=0.990637 cos_to_last_merge=1.0000 (last merge round=18)
[S17] round=19 local utility u=0.226002 metrics={'f1_val': 0.38856678908517894, 'auprc': 0.6759601178342871, 'loss_val': 0.9499045065560866, 'psi': 0.5035241205848222}-{'f1_val': 0.35267701428013964, 'auprc': 0.6129087126522255, 'loss_val': 0.9974161691885673, 'psi': 0.456769693628974}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] → sending delta(kind=head bytes=1805) to S4@127.0.0.1:39004
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S10] → sending delta(kind=head bytes=1806) to S14@127.0.0.1:39014
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:39008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:39009
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:39005
[S16] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1805 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1805 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1799) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.921363)
[S7] loaded HEAD from S16 (vec_in norm=0.921363)
[S7] cosine check vs S16: cos=0.8940
[S7] BUFFERED delta from S16 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1801) from S3
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.786302)
[S8] loaded HEAD from S3 (vec_in norm=1.786302)
[S8] cosine check vs S3: cos=-0.0054
[S8] DROPPED delta from S3 (cos=-0.0054 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1805) from S13
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.599420)
[S4] loaded HEAD from S13 (vec_in norm=1.599420)
[S4] cosine check vs S13: cos=0.9746
[S4] BUFFERED delta from S13 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1798) from S8
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.671868)
[S5] loaded HEAD from S8 (vec_in norm=1.671868)
[S5] cosine check vs S8: cos=-0.0031
[S5] DROPPED delta from S8 (cos=-0.0031 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1802) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.754256)
[S5] loaded HEAD from S11 (vec_in norm=1.754256)
[S5] cosine check vs S11: cos=0.9985
[S5] BUFFERED delta from S11 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1805) from S5
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.715285)
[S17] loaded HEAD from S5 (vec_in norm=1.715285)
[S17] cosine check vs S5: cos=0.4270
[S17] BUFFERED delta from S5 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:39016
[S10] sending update (kind=head size=1806 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1806) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.669954)
[S14] loaded HEAD from S10 (vec_in norm=1.669954)
[S14] cosine check vs S10: cos=0.9932
[S14] BUFFERED delta from S10 (total buffered=1)
[S17] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S17
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.014389)
[S16] loaded HEAD from S17 (vec_in norm=1.014389)
[S16] cosine check vs S17: cos=0.8841
[S16] BUFFERED delta from S17 (total buffered=1)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=19 metric=0.7727 head_norm=1.680427
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.889959e-01
[S4] stored merged vector for next round verification (round=19)
[S4] DEBUG after merge:  round=19 metric=0.8049 head_norm=1.629500 delta_norm=0.188996
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S4] r=20 psi=0.846 u=0.0000 p_local=0.1644 f1=0.773 auprc=0.956 bytes=25180
[S3] r=20 psi=0.820 u=0.0344 p_local=0.1200 f1=0.701 auprc=0.999 bytes=23400
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=19 metric=0.7003 head_norm=1.715285
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.063443e-02
[S5] stored merged vector for next round verification (round=19)
[S5] DEBUG after merge:  round=19 metric=0.7003 head_norm=1.734141 delta_norm=0.050634
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] r=20 psi=0.754 u=0.0319 p_local=0.1575 f1=0.700 auprc=0.834 bytes=25185
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=19 metric=0.5605 head_norm=0.822451
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.064529e-01
[S7] stored merged vector for next round verification (round=19)
[S7] DEBUG after merge:  round=19 metric=0.5577 head_norm=0.848555 delta_norm=0.206453
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S7] r=20 psi=0.649 u=0.0000 p_local=0.2043 f1=0.560 auprc=0.782 bytes=19764
[S6] r=20 psi=0.787 u=0.0000 p_local=0.2166 f1=0.785 auprc=0.791 bytes=19743
[S9] r=20 psi=0.820 u=0.0000 p_local=0.0460 f1=0.701 auprc=0.998 bytes=26939
[S11] r=20 psi=0.983 u=0.0470 p_local=0.1850 f1=0.974 auprc=0.997 bytes=28769
[S13] r=20 psi=0.643 u=0.1978 p_local=0.1212 f1=0.615 auprc=0.685 bytes=18000
[S8] r=20 psi=0.997 u=0.0101 p_local=0.1282 f1=0.995 auprc=0.999 bytes=32333
[S10] r=20 psi=0.995 u=0.0124 p_local=0.1394 f1=0.994 auprc=0.996 bytes=25167
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=19 metric=0.9968 head_norm=1.678075
[S14] _apply_head_vector_avg (torch): Δ‖w‖=9.804853e-02
[S14] stored merged vector for next round verification (round=19)
[S14] DEBUG after merge:  round=19 metric=0.9964 head_norm=1.671146 delta_norm=0.098049
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] r=20 psi=0.997 u=0.0000 p_local=0.1210 f1=0.997 auprc=0.997 bytes=30544
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=19 metric=0.3886 head_norm=1.014389
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.882195e-01
[S17] stored merged vector for next round verification (round=19)
[S17] DEBUG after merge:  round=19 metric=0.3618 head_norm=1.168034 delta_norm=0.788220
[S17] aggregate: ROLLBACK (f1_val pre=0.389 post=0.362 tol_abs=0.005 tol_rel=0.0)
[S17] r=20 psi=0.504 u=0.2260 p_local=0.1157 f1=0.389 auprc=0.676 bytes=19778
[S2] r=20 psi=0.769 u=0.0000 p_local=0.1158 f1=0.708 auprc=0.860 bytes=25183
[S15] r=20 psi=0.798 u=0.0000 p_local=0.1221 f1=0.699 auprc=0.948 bytes=25140
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=19 metric=0.6948 head_norm=0.921363
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.372994e-01
[S16] stored merged vector for next round verification (round=19)
[S16] DEBUG after merge:  round=19 metric=0.7556 head_norm=0.939487 delta_norm=0.237299
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] r=20 psi=0.751 u=0.4907 p_local=0.2351 f1=0.695 auprc=0.836 bytes=21561
[S2] START round=20 head_norm_before_train=1.049607 cos_to_last_merge=0.9977 (last merge round=17)
[S2] round=20 local utility u=0.157687 metrics={'f1_val': 0.8257773404183718, 'auprc': 0.7443648738965054, 'loss_val': 0.46725624641668007, 'psi': 0.7932123538096252}-{'f1_val': 0.7083633179830393, 'auprc': 0.8595865228079922, 'loss_val': 0.42381184154479273, 'psi': 0.7688525999130205}
[S3] START round=20 head_norm_before_train=1.786302 (no previous merge yet)
[S3] round=20 local utility u=0.875290 metrics={'f1_val': 0.9812358185924561, 'auprc': 0.997113118433741, 'loss_val': 0.12353909192550176, 'psi': 0.98758673852897}-{'f1_val': 0.7007562037352997, 'auprc': 0.998565160329692, 'loss_val': 0.19559781668007586, 'psi': 0.8198797863730566}
[S4] START round=20 head_norm_before_train=1.629500 cos_to_last_merge=1.0000 (last merge round=19)
[S4] round=20 local utility u=0.533309 metrics={'f1_val': 0.9345904723483476, 'auprc': 0.9519827909730093, 'loss_val': 0.309229121592869, 'psi': 0.9415473997982123}-{'f1_val': 0.7727467783835295, 'auprc': 0.956192758087712, 'loss_val': 0.4174142633585637, 'psi': 0.8461251702652024}
[S5] START round=20 head_norm_before_train=1.734141 cos_to_last_merge=1.0000 (last merge round=19)
[S5] round=20 local utility u=0.271272 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9969926141118094, 'loss_val': 0.29941466973841097, 'psi': 0.8189894047395392}-{'f1_val': 0.700320598491359, 'auprc': 0.8340345719060653, 'loss_val': 0.35308386656000973, 'psi': 0.7538061878572415}
[S6] START round=20 head_norm_before_train=1.268918 cos_to_last_merge=0.9980 (last merge round=17)
[S6] round=20 local utility u=0.722715 metrics={'f1_val': 0.9259496642529844, 'auprc': 0.9432286113168273, 'loss_val': 0.35854766475748334, 'psi': 0.9328612430785217}-{'f1_val': 0.7848447343153211, 'auprc': 0.7913294010169883, 'loss_val': 0.5016506938362001, 'psi': 0.787438600995988}
[S7] START round=20 head_norm_before_train=0.848555 cos_to_last_merge=1.0000 (last merge round=19)
[S7] round=20 local utility u=0.411706 metrics={'f1_val': 0.6744847400181909, 'auprc': 0.7907757060702526, 'loss_val': 0.8849782693405208, 'psi': 0.7210011264390156}-{'f1_val': 0.5604777158864978, 'auprc': 0.7823714303853639, 'loss_val': 0.9991358335445335, 'psi': 0.6492352016860443}
[S8] START round=20 head_norm_before_train=1.671868 (no previous merge yet)
[S8] round=20 local utility u=0.000000 metrics={'f1_val': 0.9808073467968352, 'auprc': 0.9977156618542098, 'loss_val': 0.12429483073390925, 'psi': 0.9875706728197851}-{'f1_val': 0.9950223643478788, 'auprc': 0.9989461213564153, 'loss_val': 0.1142740934328231, 'psi': 0.9965918671512934}
[S9] START round=20 head_norm_before_train=0.956543 cos_to_last_merge=0.9985 (last merge round=18)
[S9] round=20 local utility u=0.032611 metrics={'f1_val': 0.7014667606303384, 'auprc': 0.9981850257150465, 'loss_val': 0.24995906896343612, 'psi': 0.8201540666642216}-{'f1_val': 0.7014667606303384, 'auprc': 0.9981670451587944, 'loss_val': 0.3151273193583622, 'psi': 0.8201468744417209}
[S10] START round=20 head_norm_before_train=1.669954 cos_to_last_merge=0.9997 (last merge round=18)
[S10] round=20 local utility u=0.012540 metrics={'f1_val': 0.9936100131187782, 'auprc': 0.9972269240570653, 'loss_val': 0.10144420474582057, 'psi': 0.9950567774940929}-{'f1_val': 0.9943096789853013, 'auprc': 0.9958408937364955, 'loss_val': 0.12656478540379792, 'psi': 0.9949221648857789}
[S11] START round=20 head_norm_before_train=1.754256 (no previous merge yet)
[S11] round=20 local utility u=0.000000 metrics={'f1_val': 0.959779555599099, 'auprc': 0.9979407635363043, 'loss_val': 0.1348645294491904, 'psi': 0.9750440387739812}-{'f1_val': 0.9742630612091, 'auprc': 0.9967251112547787, 'loss_val': 0.17977950065692777, 'psi': 0.9832478812273715}
[S13] START round=20 head_norm_before_train=1.599420 (no previous merge yet)
[S13] round=20 local utility u=0.024071 metrics={'f1_val': 0.6261958897875205, 'auprc': 0.6846102516527701, 'loss_val': 0.5541418839230265, 'psi': 0.6495616345336204}-{'f1_val': 0.6152373141429756, 'auprc': 0.6851299661029007, 'loss_val': 0.538091259898341, 'psi': 0.6431943749269456}
[S14] START round=20 head_norm_before_train=1.671146 cos_to_last_merge=1.0000 (last merge round=19)
[S14] round=20 local utility u=0.003628 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9953917840176442, 'loss_val': 0.13365992633755325, 'psi': 0.9966016753080931}-{'f1_val': 0.9967774409524363, 'auprc': 0.9968548675748986, 'loss_val': 0.1415204277063164, 'psi': 0.9968084116014212}
[S15] START round=20 head_norm_before_train=1.312614 cos_to_last_merge=0.7386 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.739
[S15] round=20 local utility u=0.000000 metrics={'f1_val': 0.699843268246131, 'auprc': 0.7993578575423942, 'loss_val': 0.4839841927518394, 'psi': 0.7396491039646362}-{'f1_val': 0.6985310452118054, 'auprc': 0.9475933329262558, 'loss_val': 0.3112649305382421, 'psi': 0.7981559602975856}
[S16] START round=20 head_norm_before_train=0.939487 cos_to_last_merge=1.0000 (last merge round=19)
[S16] round=20 local utility u=0.568878 metrics={'f1_val': 0.8527579271761225, 'auprc': 0.8929039481170802, 'loss_val': 0.6837479715687218, 'psi': 0.8688163355525056}-{'f1_val': 0.6947652068104606, 'auprc': 0.8360707949341558, 'loss_val': 0.7030473719500346, 'psi': 0.7512874420599387}
[S17] START round=20 head_norm_before_train=1.168034 cos_to_last_merge=1.0000 (last merge round=19)
[S17] round=20 local utility u=0.294917 metrics={'f1_val': 0.386909752514725, 'auprc': 0.8393511770929805, 'loss_val': 0.8403019277639002, 'psi': 0.5678863223460272}-{'f1_val': 0.38856678908517894, 'auprc': 0.6759601178342871, 'loss_val': 0.9499045065560866, 'psi': 0.5035241205848222}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:39009
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:39015
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:39011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:39008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:39004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:39014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:39017
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:39002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:39010
[S7] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1793 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1795) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.298249)
[S17] loaded HEAD from S6 (vec_in norm=1.298249)
[S17] cosine check vs S6: cos=0.0763
[S17] BUFFERED delta from S6 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1793) from S2
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.087120)
[S9] loaded HEAD from S2 (vec_in norm=1.087120)
[S9] cosine check vs S2: cos=0.4995
[S9] BUFFERED delta from S2 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1801) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.696041)
[S14] loaded HEAD from S10 (vec_in norm=1.696041)
[S14] cosine check vs S10: cos=0.9966
[S14] BUFFERED delta from S10 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1794) from S5
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.750291)
[S17] loaded HEAD from S5 (vec_in norm=1.750291)
[S17] cosine check vs S5: cos=0.9071
[S17] BUFFERED delta from S5 (total buffered=2)
[S17] RECEIVED delta(kind=head bytes=1801) from S14
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.700879)
[S17] loaded HEAD from S14 (vec_in norm=1.700879)
[S17] cosine check vs S14: cos=0.3177
[S17] BUFFERED delta from S14 (total buffered=3)
[S10] RECEIVED delta(kind=head bytes=1802) from S4
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.656315)
[S10] loaded HEAD from S4 (vec_in norm=1.656315)
[S10] cosine check vs S4: cos=0.9921
[S10] BUFFERED delta from S4 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1796) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.982694)
[S7] loaded HEAD from S16 (vec_in norm=0.982694)
[S7] cosine check vs S16: cos=0.9294
[S7] BUFFERED delta from S16 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1801) from S9
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.021419)
[S15] loaded HEAD from S9 (vec_in norm=1.021419)
[S15] cosine check vs S9: cos=-0.1053
[S15] DROPPED delta from S9 (cos=-0.1053 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1798) from S3
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.811929)
[S8] loaded HEAD from S3 (vec_in norm=1.811929)
[S8] cosine check vs S3: cos=-0.0054
[S8] DROPPED delta from S3 (cos=-0.0054 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1801) from S13
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.612322)
[S4] loaded HEAD from S13 (vec_in norm=1.612322)
[S4] cosine check vs S13: cos=0.9905
[S4] BUFFERED delta from S13 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1800) from S7
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.875315)
[S2] loaded HEAD from S7 (vec_in norm=0.875315)
[S2] cosine check vs S7: cos=0.4162
[S2] BUFFERED delta from S7 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:39016
[S17] sending update (kind=head size=1800 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1800) from S17
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.188827)
[S16] loaded HEAD from S17 (vec_in norm=1.188827)
[S16] cosine check vs S17: cos=0.6877
[S16] BUFFERED delta from S17 (total buffered=1)
[S8] ⇄ pheromone p=0.103 → S5@127.0.0.1:39005
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=20 metric=0.7015 head_norm=1.021419
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.281463e-01
[S9] stored merged vector for next round verification (round=20)
[S9] DEBUG after merge:  round=20 metric=0.9846 head_norm=0.913030 delta_norm=0.528146
[S9] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.043 → S15@127.0.0.1:39015
[S5] ⇄ pheromone p=0.180 → S17@127.0.0.1:39017
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=20 metric=0.8258 head_norm=1.087120
[S2] _apply_head_vector_avg (torch): Δ‖w‖=5.375814e-01
[S2] stored merged vector for next round verification (round=20)
[S2] DEBUG after merge:  round=20 metric=0.8248 head_norm=0.827653 delta_norm=0.537581
[S2] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.124 → S9@127.0.0.1:39010
[S3] ⇄ pheromone p=0.271 → S8@127.0.0.1:39009
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=20 metric=0.9936 head_norm=1.696041
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.069053e-01
[S10] stored merged vector for next round verification (round=20)
[S10] DEBUG after merge:  round=20 metric=0.9936 head_norm=1.672883 delta_norm=0.106905
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.114 → S14@127.0.0.1:39014
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=20 metric=0.9346 head_norm=1.656315
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.149032e-01
[S4] stored merged vector for next round verification (round=20)
[S4] DEBUG after merge:  round=20 metric=0.9350 head_norm=1.630423 delta_norm=0.114903
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.238 → S10@127.0.0.1:39011
[S11] ⇄ pheromone p=0.148 → S5@127.0.0.1:39005
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=20 metric=0.6745 head_norm=0.875315
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.823567e-01
[S7] stored merged vector for next round verification (round=20)
[S7] DEBUG after merge:  round=20 metric=0.6687 head_norm=0.912512 delta_norm=0.182357
[S7] aggregate: ROLLBACK (f1_val pre=0.674 post=0.669 tol_abs=0.005 tol_rel=0.0)
[S7] ⇄ pheromone p=0.246 → S2@127.0.0.1:39002
[S6] ⇄ pheromone p=0.318 → S17@127.0.0.1:39017
[S13] ⇄ pheromone p=0.102 → S4@127.0.0.1:39004
[S15] ⇄ pheromone p=0.098 → S6@127.0.0.1:39007
[S17] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=20 metric=0.3869 head_norm=1.188827
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.714309e-01
[S17] stored merged vector for next round verification (round=20)
[S17] DEBUG after merge:  round=20 metric=0.3753 head_norm=0.970580 delta_norm=0.371431
[S17] aggregate: ROLLBACK (f1_val pre=0.387 post=0.375 tol_abs=0.005 tol_rel=0.0)
[S17] ⇄ pheromone p=0.152 → S16@127.0.0.1:39016
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=20 metric=0.8528 head_norm=0.982694
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.393899e-01
[S16] stored merged vector for next round verification (round=20)
[S16] DEBUG after merge:  round=20 metric=0.8622 head_norm=0.998216 delta_norm=0.439390
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.302 → S7@127.0.0.1:39008
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=20 metric=0.9974 head_norm=1.700879
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.978105e-02
[S14] stored merged vector for next round verification (round=20)
[S14] DEBUG after merge:  round=20 metric=0.9974 head_norm=1.697028 delta_norm=0.069781
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.098 → S17@127.0.0.1:39017
[S2] START round=21 head_norm_before_train=0.827653 cos_to_last_merge=1.0000 (last merge round=20)
[S2] round=21 local utility u=0.000000 metrics={'f1_val': 0.7074338009279685, 'auprc': 0.8511445939379536, 'loss_val': 0.5818573345307071, 'psi': 0.7649181181319625}-{'f1_val': 0.8257773404183718, 'auprc': 0.7443648738965054, 'loss_val': 0.46725624641668007, 'psi': 0.7932123538096252}
[S3] START round=21 head_norm_before_train=1.811929 (no previous merge yet)
[S3] round=21 local utility u=0.068331 metrics={'f1_val': 0.997083924432355, 'auprc': 0.9987463820530782, 'loss_val': 0.08686573014726823, 'psi': 0.9977489074806443}-{'f1_val': 0.9812358185924561, 'auprc': 0.997113118433741, 'loss_val': 0.12353909192550176, 'psi': 0.98758673852897}
[S4] START round=21 head_norm_before_train=1.630423 cos_to_last_merge=1.0000 (last merge round=20)
[S4] round=21 local utility u=0.032981 metrics={'f1_val': 0.9352350482042742, 'auprc': 0.9604707750061703, 'loss_val': 0.27259837509013257, 'psi': 0.9453293389250326}-{'f1_val': 0.9345904723483476, 'auprc': 0.9519827909730093, 'loss_val': 0.309229121592869, 'psi': 0.9415473997982123}
[S5] START round=21 head_norm_before_train=1.750291 cos_to_last_merge=0.9998 (last merge round=19)
[S5] round=21 local utility u=0.000000 metrics={'f1_val': 0.7039769802740529, 'auprc': 0.8459719674595101, 'loss_val': 0.34773993862374847, 'psi': 0.7607749751482358}-{'f1_val': 0.700320598491359, 'auprc': 0.9969926141118094, 'loss_val': 0.29941466973841097, 'psi': 0.8189894047395392}
[S6] START round=21 head_norm_before_train=1.298249 cos_to_last_merge=0.9955 (last merge round=17)
[S6] round=21 local utility u=0.000000 metrics={'f1_val': 0.6172992088407648, 'auprc': 0.767653831850019, 'loss_val': 0.6047209161830436, 'psi': 0.6774410580444665}-{'f1_val': 0.9259496642529844, 'auprc': 0.9432286113168273, 'loss_val': 0.35854766475748334, 'psi': 0.9328612430785217}
[S7] START round=21 head_norm_before_train=0.912512 cos_to_last_merge=1.0000 (last merge round=20)
[S7] round=21 local utility u=0.000000 metrics={'f1_val': 0.6213450195466276, 'auprc': 0.7750262707560576, 'loss_val': 0.907061124750062, 'psi': 0.6828175200303996}-{'f1_val': 0.6744847400181909, 'auprc': 0.7907757060702526, 'loss_val': 0.8849782693405208, 'psi': 0.7210011264390156}
[S8] START round=21 head_norm_before_train=1.695827 (no previous merge yet)
[S8] round=21 local utility u=0.061330 metrics={'f1_val': 0.9934116751513793, 'auprc': 0.9989208488131102, 'loss_val': 0.08087646198681957, 'psi': 0.9956153446160716}-{'f1_val': 0.9808073467968352, 'auprc': 0.9977156618542098, 'loss_val': 0.12429483073390925, 'psi': 0.9875706728197851}
[S9] START round=21 head_norm_before_train=0.913030 cos_to_last_merge=1.0000 (last merge round=20)
[S9] round=21 local utility u=0.812602 metrics={'f1_val': 0.9897719583083633, 'auprc': 0.9984390231537701, 'loss_val': 0.355347584082934, 'psi': 0.993238784246526}-{'f1_val': 0.7014667606303384, 'auprc': 0.9981850257150465, 'loss_val': 0.24995906896343612, 'psi': 0.8201540666642216}
[S10] START round=21 head_norm_before_train=1.672883 cos_to_last_merge=1.0000 (last merge round=20)
[S10] round=21 local utility u=0.002157 metrics={'f1_val': 0.9931720938432163, 'auprc': 0.9981806422822698, 'loss_val': 0.09736483490277872, 'psi': 0.9951755132188377}-{'f1_val': 0.9936100131187782, 'auprc': 0.9972269240570653, 'loss_val': 0.10144420474582057, 'psi': 0.9950567774940929}
[S11] START round=21 head_norm_before_train=1.789472 (no previous merge yet)
[S11] round=21 local utility u=0.000000 metrics={'f1_val': 0.8607795870878995, 'auprc': 0.9876282107729684, 'loss_val': 0.4802569138517324, 'psi': 0.911519036561927}-{'f1_val': 0.959779555599099, 'auprc': 0.9979407635363043, 'loss_val': 0.1348645294491904, 'psi': 0.9750440387739812}
[S13] START round=21 head_norm_before_train=1.612322 (no previous merge yet)
[S13] round=21 local utility u=0.000000 metrics={'f1_val': 0.6223821361714397, 'auprc': 0.6813298252226571, 'loss_val': 0.5932602095425942, 'psi': 0.6459612117919267}-{'f1_val': 0.6261958897875205, 'auprc': 0.6846102516527701, 'loss_val': 0.5541418839230265, 'psi': 0.6495616345336204}
[S14] START round=21 head_norm_before_train=1.697028 cos_to_last_merge=1.0000 (last merge round=20)
[S14] round=21 local utility u=0.012410 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9954705199278615, 'loss_val': 0.11053272853163147, 'psi': 0.9967788788010568}-{'f1_val': 0.9974082695017256, 'auprc': 0.9953917840176442, 'loss_val': 0.13365992633755325, 'psi': 0.9966016753080931}
[S15] START round=21 head_norm_before_train=1.348737 cos_to_last_merge=0.7337 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.734
[S15] round=21 local utility u=0.713489 metrics={'f1_val': 0.7996338497070958, 'auprc': 0.9879626613923171, 'loss_val': 0.22156506968334383, 'psi': 0.8749653743811843}-{'f1_val': 0.699843268246131, 'auprc': 0.7993578575423942, 'loss_val': 0.4839841927518394, 'psi': 0.7396491039646362}
[S16] START round=21 head_norm_before_train=0.998216 cos_to_last_merge=1.0000 (last merge round=20)
[S16] round=21 local utility u=0.006177 metrics={'f1_val': 0.8267163011241416, 'auprc': 0.9275942163672685, 'loss_val': 0.6192152515322168, 'psi': 0.8670674672213923}-{'f1_val': 0.8527579271761225, 'auprc': 0.8929039481170802, 'loss_val': 0.6837479715687218, 'psi': 0.8688163355525056}
[S17] START round=21 head_norm_before_train=0.970580 cos_to_last_merge=1.0000 (last merge round=20)
[S17] round=21 local utility u=0.039074 metrics={'f1_val': 0.3892045086510505, 'auprc': 0.8399734883625452, 'loss_val': 0.7777900649759111, 'psi': 0.5695121005356484}-{'f1_val': 0.386909752514725, 'auprc': 0.8393511770929805, 'loss_val': 0.8403019277639002, 'psi': 0.5678863223460272}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:39009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:39011
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:39014
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:39008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:39015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:39007
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:39017
[S15] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1805 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1805 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1799) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.040510)
[S7] loaded HEAD from S16 (vec_in norm=1.040510)
[S7] cosine check vs S16: cos=0.8978
[S7] BUFFERED delta from S16 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1802) from S3
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.839191)
[S8] loaded HEAD from S3 (vec_in norm=1.839191)
[S8] cosine check vs S3: cos=-0.0059
[S8] DROPPED delta from S3 (cos=-0.0059 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1795) from S8
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.718166)
[S5] loaded HEAD from S8 (vec_in norm=1.718166)
[S5] cosine check vs S8: cos=-0.0042
[S5] DROPPED delta from S8 (cos=-0.0042 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1805) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.697892)
[S14] loaded HEAD from S10 (vec_in norm=1.697892)
[S14] cosine check vs S10: cos=0.9954
[S14] BUFFERED delta from S10 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1799) from S4
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.657051)
[S10] loaded HEAD from S4 (vec_in norm=1.657051)
[S10] cosine check vs S4: cos=0.9931
[S10] BUFFERED delta from S4 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1805) from S14
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.729177)
[S17] loaded HEAD from S14 (vec_in norm=1.729177)
[S17] cosine check vs S14: cos=0.4221
[S17] BUFFERED delta from S14 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1801) from S9
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.971103)
[S15] loaded HEAD from S9 (vec_in norm=0.971103)
[S15] cosine check vs S9: cos=0.0020
[S15] BUFFERED delta from S9 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1794) from S15
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.380017)
[S6] loaded HEAD from S15 (vec_in norm=1.380017)
[S6] cosine check vs S15: cos=0.9626
[S6] BUFFERED delta from S15 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:39016
[S17] sending update (kind=head size=1794 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1794) from S17
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.996749)
[S16] loaded HEAD from S17 (vec_in norm=0.996749)
[S16] cosine check vs S17: cos=0.9610
[S16] BUFFERED delta from S17 (total buffered=1)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=21 metric=0.6213 head_norm=0.943400
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.291711e-01
[S7] stored merged vector for next round verification (round=21)
[S7] DEBUG after merge:  round=21 metric=0.5442 head_norm=0.966340 delta_norm=0.229171
[S7] aggregate: ROLLBACK (f1_val pre=0.621 post=0.544 tol_abs=0.005 tol_rel=0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=21 metric=0.6173 head_norm=1.324951
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.869729e-01
[S6] stored merged vector for next round verification (round=21)
[S6] DEBUG after merge:  round=21 metric=0.6073 head_norm=1.339781 delta_norm=0.186973
[S6] aggregate: ROLLBACK (f1_val pre=0.617 post=0.607 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=21 metric=0.7996 head_norm=1.380017
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.429347e-01
[S15] stored merged vector for next round verification (round=21)
[S15] DEBUG after merge:  round=21 metric=0.7939 head_norm=0.844515 delta_norm=0.842935
[S15] aggregate: ROLLBACK (f1_val pre=0.800 post=0.794 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=21 metric=0.9977 head_norm=1.729177
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.329573e-02
[S14] stored merged vector for next round verification (round=21)
[S14] DEBUG after merge:  round=21 metric=0.9977 head_norm=1.711580 delta_norm=0.083296
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=21 metric=0.8267 head_norm=1.040510
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.438643e-01
[S16] stored merged vector for next round verification (round=21)
[S16] DEBUG after merge:  round=21 metric=0.8257 head_norm=1.008657 delta_norm=0.143864
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=21 metric=0.9932 head_norm=1.697892
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.007773e-01
[S10] stored merged vector for next round verification (round=21)
[S10] DEBUG after merge:  round=21 metric=0.9932 head_norm=1.674566 delta_norm=0.100777
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=21 metric=0.3892 head_norm=0.996749
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.950841e-01
[S17] stored merged vector for next round verification (round=21)
[S17] DEBUG after merge:  round=21 metric=0.3891 head_norm=1.166028 delta_norm=0.795084
[S17] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=0.866213 cos_to_last_merge=0.9976 (last merge round=20)
[S2] round=22 local utility u=0.173227 metrics={'f1_val': 0.825585740303156, 'auprc': 0.7353315187456808, 'loss_val': 0.5968762038663337, 'psi': 0.789484051680166}-{'f1_val': 0.7074338009279685, 'auprc': 0.8511445939379536, 'loss_val': 0.5818573345307071, 'psi': 0.7649181181319625}
[S3] START round=22 head_norm_before_train=1.839191 (no previous merge yet)
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.9607409897453603, 'auprc': 0.9984056339900085, 'loss_val': 0.10354133121974295, 'psi': 0.9758068474432195}-{'f1_val': 0.997083924432355, 'auprc': 0.9987463820530782, 'loss_val': 0.08686573014726823, 'psi': 0.9977489074806443}
[S4] START round=22 head_norm_before_train=1.657051 cos_to_last_merge=0.9997 (last merge round=20)
[S4] round=22 local utility u=0.000000 metrics={'f1_val': 0.9301510622882638, 'auprc': 0.9628917236728276, 'loss_val': 0.27665335372239375, 'psi': 0.9432473268420893}-{'f1_val': 0.9352350482042742, 'auprc': 0.9604707750061703, 'loss_val': 0.27259837509013257, 'psi': 0.9453293389250326}
[S5] START round=22 head_norm_before_train=1.768007 cos_to_last_merge=0.9992 (last merge round=19)
[S5] round=22 local utility u=0.000000 metrics={'f1_val': 0.7041405915589758, 'auprc': 0.8051585393676927, 'loss_val': 0.3521057864310469, 'psi': 0.7445477706824626}-{'f1_val': 0.7039769802740529, 'auprc': 0.8459719674595101, 'loss_val': 0.34773993862374847, 'psi': 0.7607749751482358}
[S6] START round=22 head_norm_before_train=1.339781 cos_to_last_merge=1.0000 (last merge round=21)
[S6] round=22 local utility u=0.640162 metrics={'f1_val': 0.7719246533732138, 'auprc': 0.8429817234318622, 'loss_val': 0.4781337585192801, 'psi': 0.8003474813966731}-{'f1_val': 0.6172992088407648, 'auprc': 0.767653831850019, 'loss_val': 0.6047209161830436, 'psi': 0.6774410580444665}
[S7] START round=22 head_norm_before_train=0.966340 cos_to_last_merge=1.0000 (last merge round=21)
[S7] round=22 local utility u=0.376635 metrics={'f1_val': 0.6988749997065619, 'auprc': 0.7926941539458977, 'loss_val': 0.6719755653103315, 'psi': 0.7364026614022963}-{'f1_val': 0.6213450195466276, 'auprc': 0.7750262707560576, 'loss_val': 0.907061124750062, 'psi': 0.6828175200303996}
[S8] START round=22 head_norm_before_train=1.718166 (no previous merge yet)
[S8] round=22 local utility u=0.000000 metrics={'f1_val': 0.9294050782837906, 'auprc': 0.9927043026605933, 'loss_val': 0.12639418571820632, 'psi': 0.9547247680345117}-{'f1_val': 0.9934116751513793, 'auprc': 0.9989208488131102, 'loss_val': 0.08087646198681957, 'psi': 0.9956153446160716}
[S9] START round=22 head_norm_before_train=0.971103 cos_to_last_merge=0.9941 (last merge round=20)
[S9] round=22 local utility u=0.033553 metrics={'f1_val': 0.9843941596541771, 'auprc': 0.9975688765206382, 'loss_val': 0.25336373711899834, 'psi': 0.9896640464007616}-{'f1_val': 0.9897719583083633, 'auprc': 0.9984390231537701, 'loss_val': 0.355347584082934, 'psi': 0.993238784246526}
[S10] START round=22 head_norm_before_train=1.674566 cos_to_last_merge=1.0000 (last merge round=21)
[S10] round=22 local utility u=0.003031 metrics={'f1_val': 0.9931720938432163, 'auprc': 0.9988069168008078, 'loss_val': 0.09318252245354235, 'psi': 0.9954260230262529}-{'f1_val': 0.9931720938432163, 'auprc': 0.9981806422822698, 'loss_val': 0.09736483490277872, 'psi': 0.9951755132188377}
[S11] START round=22 head_norm_before_train=1.823995 (no previous merge yet)
[S11] round=22 local utility u=0.598763 metrics={'f1_val': 0.9931824016695383, 'auprc': 0.997884456739281, 'loss_val': 0.10791742927620501, 'psi': 0.9950632236974353}-{'f1_val': 0.8607795870878995, 'auprc': 0.9876282107729684, 'loss_val': 0.4802569138517324, 'psi': 0.911519036561927}
[S13] START round=22 head_norm_before_train=1.630311 (no previous merge yet)
[S13] round=22 local utility u=0.011192 metrics={'f1_val': 0.6124170150481438, 'auprc': 0.7306501303427383, 'loss_val': 0.65904574276534, 'psi': 0.6597102611659816}-{'f1_val': 0.6223821361714397, 'auprc': 0.6813298252226571, 'loss_val': 0.5932602095425942, 'psi': 0.6459612117919267}
[S14] START round=22 head_norm_before_train=1.711580 cos_to_last_merge=1.0000 (last merge round=21)
[S14] round=22 local utility u=0.002973 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9952367677613331, 'loss_val': 0.10242827456044747, 'psi': 0.9965396688055685}-{'f1_val': 0.9976511180498535, 'auprc': 0.9954705199278615, 'loss_val': 0.11053272853163147, 'psi': 0.9967788788010568}
[S15] START round=22 head_norm_before_train=0.844515 cos_to_last_merge=1.0000 (last merge round=21)
[S15] round=22 local utility u=0.000000 metrics={'f1_val': 0.7322614055055789, 'auprc': 0.9323029499090828, 'loss_val': 0.4122270596115928, 'psi': 0.8122780232669805}-{'f1_val': 0.7996338497070958, 'auprc': 0.9879626613923171, 'loss_val': 0.22156506968334383, 'psi': 0.8749653743811843}
[S16] START round=22 head_norm_before_train=1.008657 cos_to_last_merge=1.0000 (last merge round=21)
[S16] round=22 local utility u=0.006863 metrics={'f1_val': 0.8349880823833329, 'auprc': 0.9403941220896184, 'loss_val': 0.6935189696531708, 'psi': 0.877150498265847}-{'f1_val': 0.8267163011241416, 'auprc': 0.9275942163672685, 'loss_val': 0.6192152515322168, 'psi': 0.8670674672213923}
[S17] START round=22 head_norm_before_train=1.166028 cos_to_last_merge=1.0000 (last merge round=21)
[S17] round=22 local utility u=0.542509 metrics={'f1_val': 0.5502914621244148, 'auprc': 0.8626729684565995, 'loss_val': 0.7273930222050315, 'psi': 0.6752440646572887}-{'f1_val': 0.3892045086510505, 'auprc': 0.8399734883625452, 'loss_val': 0.7777900649759111, 'psi': 0.5695121005356484}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S2] → sending delta(kind=head bytes=1787) to S9@127.0.0.1:39010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] → sending delta(kind=head bytes=1806) to S4@127.0.0.1:39004
[S16] not sending this round → trigger blocked (psi=0.877)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.990)
[S14] not sending this round → trigger blocked (psi=0.997)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:39002
[S10] not sending this round → trigger blocked (psi=0.995)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1806 to 1 peers)
[S2] sending update (kind=head size=1787 to 1 peers)
[S6] sending update (kind=head size=1804 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1806) from S13
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.646428)
[S4] loaded HEAD from S13 (vec_in norm=1.646428)
[S4] cosine check vs S13: cos=0.9916
[S4] BUFFERED delta from S13 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1804) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.362221)
[S17] loaded HEAD from S6 (vec_in norm=1.362221)
[S17] cosine check vs S6: cos=0.0990
[S17] BUFFERED delta from S6 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1801) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.849126)
[S5] loaded HEAD from S11 (vec_in norm=1.849126)
[S5] cosine check vs S11: cos=0.9944
[S5] BUFFERED delta from S11 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1802) from S7
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.001449)
[S2] loaded HEAD from S7 (vec_in norm=1.001449)
[S2] cosine check vs S7: cos=0.6748
[S2] BUFFERED delta from S7 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1787) from S2
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=0.914691)
[S9] loaded HEAD from S2 (vec_in norm=0.914691)
[S9] cosine check vs S2: cos=0.7338
[S9] BUFFERED delta from S2 (total buffered=1)
[S17] not sending this round → trigger blocked (psi=0.675)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=22 metric=0.7041 head_norm=1.783818
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.017816e-01
[S5] stored merged vector for next round verification (round=22)
[S5] DEBUG after merge:  round=22 metric=0.7035 head_norm=1.813912 delta_norm=0.101782
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=22 metric=0.9844 head_norm=1.044112
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.623726e-01
[S9] stored merged vector for next round verification (round=22)
[S9] DEBUG after merge:  round=22 metric=0.9887 head_norm=0.912196 delta_norm=0.362373
[S9] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=22 metric=0.9302 head_norm=1.683354
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.092821e-01
[S4] stored merged vector for next round verification (round=22)
[S4] DEBUG after merge:  round=22 metric=0.9299 head_norm=1.661403 delta_norm=0.109282
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=22 metric=0.8256 head_norm=0.914691
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.883490e-01
[S2] stored merged vector for next round verification (round=22)
[S2] DEBUG after merge:  round=22 metric=0.8255 head_norm=0.876907 delta_norm=0.388349
[S2] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=22 metric=0.5503 head_norm=1.189018
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.585959e-01
[S17] stored merged vector for next round verification (round=22)
[S17] DEBUG after merge:  round=22 metric=0.5829 head_norm=0.947374 delta_norm=0.858596
[S17] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=0.876907 cos_to_last_merge=1.0000 (last merge round=22)
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.7074331183246881, 'auprc': 0.8537198422806618, 'loss_val': 0.6170487161438126, 'psi': 0.7659478079070776}-{'f1_val': 0.825585740303156, 'auprc': 0.7353315187456808, 'loss_val': 0.5968762038663337, 'psi': 0.789484051680166}
[S3] START round=23 head_norm_before_train=1.863700 (no previous merge yet)
[S3] round=23 local utility u=0.135922 metrics={'f1_val': 0.9977814963782642, 'auprc': 0.9988209285733487, 'loss_val': 0.05518555924774981, 'psi': 0.998197269256298}-{'f1_val': 0.9607409897453603, 'auprc': 0.9984056339900085, 'loss_val': 0.10354133121974295, 'psi': 0.9758068474432195}
[S4] START round=23 head_norm_before_train=1.661403 cos_to_last_merge=1.0000 (last merge round=22)
[S4] round=23 local utility u=0.051620 metrics={'f1_val': 0.9410847125492787, 'auprc': 0.9667734695288381, 'loss_val': 0.25066020069492856, 'psi': 0.9513602153411025}-{'f1_val': 0.9301510622882638, 'auprc': 0.9628917236728276, 'loss_val': 0.27665335372239375, 'psi': 0.9432473268420893}
[S5] START round=23 head_norm_before_train=1.813912 cos_to_last_merge=1.0000 (last merge round=22)
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.7059440046791193, 'auprc': 0.791986500830582, 'loss_val': 0.3797890769721393, 'psi': 0.7403610031397044}-{'f1_val': 0.7041405915589758, 'auprc': 0.8051585393676927, 'loss_val': 0.3521057864310469, 'psi': 0.7445477706824626}
[S6] START round=23 head_norm_before_train=1.362221 cos_to_last_merge=0.9997 (last merge round=21)
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.7456551629871349, 'auprc': 0.7558253643828861, 'loss_val': 0.550469563709747, 'psi': 0.7497232435454353}-{'f1_val': 0.7719246533732138, 'auprc': 0.8429817234318622, 'loss_val': 0.4781337585192801, 'psi': 0.8003474813966731}
[S7] START round=23 head_norm_before_train=1.001449 cos_to_last_merge=0.9952 (last merge round=21)
[S7] round=23 local utility u=0.000000 metrics={'f1_val': 0.5017202038465807, 'auprc': 0.6710382981544347, 'loss_val': 0.8616922791978185, 'psi': 0.5694474415697224}-{'f1_val': 0.6988749997065619, 'auprc': 0.7926941539458977, 'loss_val': 0.6719755653103315, 'psi': 0.7364026614022963}
[S8] START round=23 head_norm_before_train=1.739110 (no previous merge yet)
[S8] round=23 local utility u=0.224453 metrics={'f1_val': 0.9919528555747477, 'auprc': 0.9988659627093548, 'loss_val': 0.07125925521321998, 'psi': 0.9947180984285905}-{'f1_val': 0.9294050782837906, 'auprc': 0.9927043026605933, 'loss_val': 0.12639418571820632, 'psi': 0.9547247680345117}
[S9] START round=23 head_norm_before_train=0.912196 cos_to_last_merge=1.0000 (last merge round=22)
[S9] round=23 local utility u=0.000000 metrics={'f1_val': 0.9945775144926113, 'auprc': 0.9975416486290422, 'loss_val': 0.32053390011334787, 'psi': 0.9957631681471837}-{'f1_val': 0.9843941596541771, 'auprc': 0.9975688765206382, 'loss_val': 0.25336373711899834, 'psi': 0.9896640464007616}
[S10] START round=23 head_norm_before_train=1.698379 cos_to_last_merge=0.9997 (last merge round=21)
[S10] round=23 local utility u=0.007507 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9984045035057114, 'loss_val': 0.07852435284974858, 'psi': 0.9954214262948281}-{'f1_val': 0.9931720938432163, 'auprc': 0.9988069168008078, 'loss_val': 0.09318252245354235, 'psi': 0.9954260230262529}
[S11] START round=23 head_norm_before_train=1.849126 (no previous merge yet)
[S11] round=23 local utility u=0.009120 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9964161441065077, 'loss_val': 0.1054599602768564, 'psi': 0.9964946603507568}-{'f1_val': 0.9931824016695383, 'auprc': 0.997884456739281, 'loss_val': 0.10791742927620501, 'psi': 0.9950632236974353}
[S13] START round=23 head_norm_before_train=1.646428 (no previous merge yet)
[S13] round=23 local utility u=0.149700 metrics={'f1_val': 0.6333308179243401, 'auprc': 0.7579942250904128, 'loss_val': 0.5671605645694865, 'psi': 0.6831961807907692}-{'f1_val': 0.6124170150481438, 'auprc': 0.7306501303427383, 'loss_val': 0.65904574276534, 'psi': 0.6597102611659816}
[S14] START round=23 head_norm_before_train=1.744605 cos_to_last_merge=0.9994 (last merge round=21)
[S14] round=23 local utility u=0.013803 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9968129817075738, 'loss_val': 0.0770861886252043, 'psi': 0.9969236975776286}-{'f1_val': 0.9974082695017256, 'auprc': 0.9952367677613331, 'loss_val': 0.10242827456044747, 'psi': 0.9965396688055685}
[S15] START round=23 head_norm_before_train=0.893198 cos_to_last_merge=0.9981 (last merge round=21)
[S15] round=23 local utility u=0.339163 metrics={'f1_val': 0.8010677781306924, 'auprc': 0.9895270736677758, 'loss_val': 0.31841119648425065, 'psi': 0.8764514963455258}-{'f1_val': 0.7322614055055789, 'auprc': 0.9323029499090828, 'loss_val': 0.4122270596115928, 'psi': 0.8122780232669805}
[S16] START round=23 head_norm_before_train=1.054498 cos_to_last_merge=0.9965 (last merge round=21)
[S16] round=23 local utility u=0.000000 metrics={'f1_val': 0.7911588115421319, 'auprc': 0.9072443223551572, 'loss_val': 0.6060885572425276, 'psi': 0.8375930158673419}-{'f1_val': 0.8349880823833329, 'auprc': 0.9403941220896184, 'loss_val': 0.6935189696531708, 'psi': 0.877150498265847}
[S17] START round=23 head_norm_before_train=0.947374 cos_to_last_merge=1.0000 (last merge round=22)
[S17] round=23 local utility u=0.000000 metrics={'f1_val': 0.4279948183794508, 'auprc': 0.833301025651654, 'loss_val': 0.8396443641023703, 'psi': 0.5901173012883321}-{'f1_val': 0.5502914621244148, 'auprc': 0.8626729684565995, 'loss_val': 0.7273930222050315, 'psi': 0.6752440646572887}
[S13] not sending this round → trigger blocked (psi=0.683)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:39007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] → sending delta(kind=head bytes=1805) to S10@127.0.0.1:39011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:39017
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:39005
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:39009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:39014
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.996)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1805 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S3
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.886855)
[S8] loaded HEAD from S3 (vec_in norm=1.886855)
[S8] cosine check vs S3: cos=-0.0074
[S8] DROPPED delta from S3 (cos=-0.0074 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1800) from S15
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.969577)
[S6] loaded HEAD from S15 (vec_in norm=0.969577)
[S6] cosine check vs S15: cos=0.8567
[S6] BUFFERED delta from S15 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1801) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.722083)
[S14] loaded HEAD from S10 (vec_in norm=1.722083)
[S14] cosine check vs S10: cos=0.9924
[S14] BUFFERED delta from S10 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1798) from S8
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.759664)
[S5] loaded HEAD from S8 (vec_in norm=1.759664)
[S5] cosine check vs S8: cos=-0.0091
[S5] DROPPED delta from S8 (cos=-0.0091 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1805) from S4
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.685484)
[S10] loaded HEAD from S4 (vec_in norm=1.685484)
[S10] cosine check vs S4: cos=0.9936
[S10] BUFFERED delta from S4 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1801) from S14
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.778114)
[S17] loaded HEAD from S14 (vec_in norm=1.778114)
[S17] cosine check vs S14: cos=0.5417
[S17] BUFFERED delta from S14 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=23 metric=0.7457 head_norm=1.386695
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.739463e-01
[S6] stored merged vector for next round verification (round=23)
[S6] DEBUG after merge:  round=23 metric=0.7455 head_norm=1.136515 delta_norm=0.373946
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=23 metric=0.9934 head_norm=1.722083
[S10] _apply_head_vector_avg (torch): Δ‖w‖=9.783277e-02
[S10] stored merged vector for next round verification (round=23)
[S10] DEBUG after merge:  round=23 metric=0.9934 head_norm=1.701071 delta_norm=0.097833
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=23 metric=0.9970 head_norm=1.778114
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.113491e-01
[S14] stored merged vector for next round verification (round=23)
[S14] DEBUG after merge:  round=23 metric=0.9970 head_norm=1.746777 delta_norm=0.111349
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=23 metric=0.4280 head_norm=0.965550
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.473379e-01
[S17] stored merged vector for next round verification (round=23)
[S17] DEBUG after merge:  round=23 metric=0.5614 head_norm=1.220031 delta_norm=0.747338
[S17] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=0.919097 cos_to_last_merge=0.9944 (last merge round=22)
[S2] round=24 local utility u=0.021352 metrics={'f1_val': 0.7090654348346194, 'auprc': 0.8301886082389064, 'loss_val': 0.5135444200306163, 'psi': 0.7575147041963342}-{'f1_val': 0.7074331183246881, 'auprc': 0.8537198422806618, 'loss_val': 0.6170487161438126, 'psi': 0.7659478079070776}
[S3] START round=24 head_norm_before_train=1.886855 (no previous merge yet)
[S3] round=24 local utility u=0.000000 metrics={'f1_val': 0.960531351117436, 'auprc': 0.9980430763088985, 'loss_val': 0.1180727725498391, 'psi': 0.975536041194021}-{'f1_val': 0.9977814963782642, 'auprc': 0.9988209285733487, 'loss_val': 0.05518555924774981, 'psi': 0.998197269256298}
[S4] START round=24 head_norm_before_train=1.685484 cos_to_last_merge=0.9996 (last merge round=22)
[S4] round=24 local utility u=0.044850 metrics={'f1_val': 0.9534744376257858, 'auprc': 0.96764317945454, 'loss_val': 0.23790824305092684, 'psi': 0.9591419343572875}-{'f1_val': 0.9410847125492787, 'auprc': 0.9667734695288381, 'loss_val': 0.25066020069492856, 'psi': 0.9513602153411025}
[S5] START round=24 head_norm_before_train=1.828846 cos_to_last_merge=0.9998 (last merge round=22)
[S5] round=24 local utility u=0.344384 metrics={'f1_val': 0.700320598491359, 'auprc': 0.991588483375246, 'loss_val': 0.2560873045259311, 'psi': 0.8168277524449138}-{'f1_val': 0.7059440046791193, 'auprc': 0.791986500830582, 'loss_val': 0.3797890769721393, 'psi': 0.7403610031397044}
[S6] START round=24 head_norm_before_train=1.136515 cos_to_last_merge=1.0000 (last merge round=23)
[S6] round=24 local utility u=0.525285 metrics={'f1_val': 0.8117582362758125, 'auprc': 0.9314503365703035, 'loss_val': 0.42339382385487523, 'psi': 0.8596350763936089}-{'f1_val': 0.7456551629871349, 'auprc': 0.7558253643828861, 'loss_val': 0.550469563709747, 'psi': 0.7497232435454353}
[S7] START round=24 head_norm_before_train=1.035671 cos_to_last_merge=0.9861 (last merge round=21)
[S7] round=24 local utility u=1.000000 metrics={'f1_val': 0.6424453458972952, 'auprc': 0.9927513722614993, 'loss_val': 0.6641558704389002, 'psi': 0.7825677564429769}-{'f1_val': 0.5017202038465807, 'auprc': 0.6710382981544347, 'loss_val': 0.8616922791978185, 'psi': 0.5694474415697224}
[S8] START round=24 head_norm_before_train=1.759664 (no previous merge yet)
[S8] round=24 local utility u=0.013318 metrics={'f1_val': 0.9941380936044745, 'auprc': 0.9985661785474003, 'loss_val': 0.05683555016828281, 'psi': 0.9959093275816449}-{'f1_val': 0.9919528555747477, 'auprc': 0.9988659627093548, 'loss_val': 0.07125925521321998, 'psi': 0.9947180984285905}
[S9] START round=24 head_norm_before_train=0.979288 cos_to_last_merge=0.9924 (last merge round=22)
[S9] round=24 local utility u=0.029263 metrics={'f1_val': 0.9878532334303461, 'auprc': 0.996267493316942, 'loss_val': 0.21784027243971696, 'psi': 0.9912189373849845}-{'f1_val': 0.9945775144926113, 'auprc': 0.9975416486290422, 'loss_val': 0.32053390011334787, 'psi': 0.9957631681471837}
[S10] START round=24 head_norm_before_train=1.701071 cos_to_last_merge=1.0000 (last merge round=23)
[S10] round=24 local utility u=0.001197 metrics={'f1_val': 0.993871046050545, 'auprc': 0.998905269213564, 'loss_val': 0.08026171114060211, 'psi': 0.9958847353157526}-{'f1_val': 0.9934327081542391, 'auprc': 0.9984045035057114, 'loss_val': 0.07852435284974858, 'psi': 0.9954214262948281}
[S11] START round=24 head_norm_before_train=1.872919 (no previous merge yet)
[S11] round=24 local utility u=0.000000 metrics={'f1_val': 0.9154897388757642, 'auprc': 0.9932225038286749, 'loss_val': 0.3298252461671478, 'psi': 0.9465828448569285}-{'f1_val': 0.9965470045135896, 'auprc': 0.9964161441065077, 'loss_val': 0.1054599602768564, 'psi': 0.9964946603507568}
[S13] START round=24 head_norm_before_train=1.660498 (no previous merge yet)
[S13] round=24 local utility u=0.087707 metrics={'f1_val': 0.6459711425134618, 'auprc': 0.7676429272995546, 'loss_val': 0.4965353447113104, 'psi': 0.6946398564278989}-{'f1_val': 0.6333308179243401, 'auprc': 0.7579942250904128, 'loss_val': 0.5671605645694865, 'psi': 0.6831961807907692}
[S14] START round=24 head_norm_before_train=1.746777 cos_to_last_merge=1.0000 (last merge round=23)
[S14] round=24 local utility u=0.001403 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9968515117723982, 'loss_val': 0.07585320736396048, 'psi': 0.997084818732435}-{'f1_val': 0.9969975081576651, 'auprc': 0.9968129817075738, 'loss_val': 0.0770861886252043, 'psi': 0.9969236975776286}
[S15] START round=24 head_norm_before_train=0.969577 cos_to_last_merge=0.9902 (last merge round=21)
[S15] round=24 local utility u=0.000000 metrics={'f1_val': 0.7174951003438808, 'auprc': 0.8789249159848807, 'loss_val': 0.3733995192137987, 'psi': 0.7820670266002807}-{'f1_val': 0.8010677781306924, 'auprc': 0.9895270736677758, 'loss_val': 0.31841119648425065, 'psi': 0.8764514963455258}
[S16] START round=24 head_norm_before_train=1.103948 cos_to_last_merge=0.9881 (last merge round=21)
[S16] round=24 local utility u=0.203753 metrics={'f1_val': 0.8310364887815997, 'auprc': 0.9840640187806455, 'loss_val': 0.6683087072710606, 'psi': 0.8922475007812181}-{'f1_val': 0.7911588115421319, 'auprc': 0.9072443223551572, 'loss_val': 0.6060885572425276, 'psi': 0.8375930158673419}
[S17] START round=24 head_norm_before_train=1.220031 cos_to_last_merge=1.0000 (last merge round=23)
[S17] round=24 local utility u=0.000000 metrics={'f1_val': 0.3535765828037247, 'auprc': 0.6559012871112873, 'loss_val': 1.029820809257683, 'psi': 0.4745064645267497}-{'f1_val': 0.4279948183794508, 'auprc': 0.833301025651654, 'loss_val': 0.8396443641023703, 'psi': 0.5901173012883321}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:39015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:39008
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.996)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:39004
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.996)
[S14] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:39010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:39002
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.959)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:39017
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1801) from S5
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.842011)
[S17] loaded HEAD from S5 (vec_in norm=1.842011)
[S17] cosine check vs S5: cos=0.0459
[S17] BUFFERED delta from S5 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1794) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.163888)
[S17] loaded HEAD from S6 (vec_in norm=1.163888)
[S17] cosine check vs S6: cos=0.3090
[S17] BUFFERED delta from S6 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1801) from S9
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.063542)
[S15] loaded HEAD from S9 (vec_in norm=1.063542)
[S15] cosine check vs S9: cos=0.4956
[S15] BUFFERED delta from S9 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1803) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.151580)
[S7] loaded HEAD from S16 (vec_in norm=1.151580)
[S7] cosine check vs S16: cos=0.9266
[S7] BUFFERED delta from S16 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1801) from S13
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.667418)
[S4] loaded HEAD from S13 (vec_in norm=1.667418)
[S4] cosine check vs S13: cos=0.9926
[S4] BUFFERED delta from S13 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1797) from S7
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.070428)
[S2] loaded HEAD from S7 (vec_in norm=1.070428)
[S2] cosine check vs S7: cos=0.8296
[S2] BUFFERED delta from S7 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1798) from S2
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=0.982985)
[S9] loaded HEAD from S2 (vec_in norm=0.982985)
[S9] cosine check vs S2: cos=0.7656
[S9] BUFFERED delta from S2 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=24 metric=0.9535 head_norm=1.706186
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.043352e-01
[S4] stored merged vector for next round verification (round=24)
[S4] DEBUG after merge:  round=24 metric=0.9542 head_norm=1.683684 delta_norm=0.104335
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=24 metric=0.7091 head_norm=0.982985
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.025725e-01
[S2] stored merged vector for next round verification (round=24)
[S2] DEBUG after merge:  round=24 metric=0.7088 head_norm=0.982083 delta_norm=0.302573
[S2] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=24 metric=0.9879 head_norm=1.063542
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.523762e-01
[S9] stored merged vector for next round verification (round=24)
[S9] DEBUG after merge:  round=24 metric=0.9887 head_norm=0.961521 delta_norm=0.352376
[S9] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=24 metric=0.6424 head_norm=1.070428
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.165117e-01
[S7] stored merged vector for next round verification (round=24)
[S7] DEBUG after merge:  round=24 metric=0.6311 head_norm=1.090458 delta_norm=0.216512
[S7] aggregate: ROLLBACK (f1_val pre=0.642 post=0.631 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=24 metric=0.7175 head_norm=1.031294
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.261944e-01
[S15] stored merged vector for next round verification (round=24)
[S15] DEBUG after merge:  round=24 metric=0.7083 head_norm=0.905795 delta_norm=0.526194
[S15] aggregate: ROLLBACK (f1_val pre=0.717 post=0.708 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=24 metric=0.3536 head_norm=1.240040
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.417765e-01
[S17] stored merged vector for next round verification (round=24)
[S17] DEBUG after merge:  round=24 metric=0.3638 head_norm=0.908624 delta_norm=0.741776
[S17] aggregate: ACCEPT kept=['S5', 'S6'] (k=2/2) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=0.982083 cos_to_last_merge=1.0000 (last merge round=24)
[S2] round=25 local utility u=0.029083 metrics={'f1_val': 0.7115440126606088, 'auprc': 0.8523648788576305, 'loss_val': 0.5367778033314443, 'psi': 0.7678723591394174}-{'f1_val': 0.7090654348346194, 'auprc': 0.8301886082389064, 'loss_val': 0.5135444200306163, 'psi': 0.7575147041963342}
[S3] START round=25 head_norm_before_train=1.908780 (no previous merge yet)
[S3] round=25 local utility u=0.150143 metrics={'f1_val': 0.9977814963782642, 'auprc': 0.9987620261139306, 'loss_val': 0.043444308202884654, 'psi': 0.9981737082725308}-{'f1_val': 0.960531351117436, 'auprc': 0.9980430763088985, 'loss_val': 0.1180727725498391, 'psi': 0.975536041194021}
[S4] START round=25 head_norm_before_train=1.683684 cos_to_last_merge=1.0000 (last merge round=24)
[S4] round=25 local utility u=0.000000 metrics={'f1_val': 0.9397809444278574, 'auprc': 0.9706060316097369, 'loss_val': 0.25378781391514366, 'psi': 0.9521109793006093}-{'f1_val': 0.9534744376257858, 'auprc': 0.96764317945454, 'loss_val': 0.23790824305092684, 'psi': 0.9591419343572875}
[S5] START round=25 head_norm_before_train=1.842011 cos_to_last_merge=0.9994 (last merge round=22)
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9618266103119925, 'loss_val': 0.29038660828752494, 'psi': 0.8049230032196124}-{'f1_val': 0.700320598491359, 'auprc': 0.991588483375246, 'loss_val': 0.2560873045259311, 'psi': 0.8168277524449138}
[S6] START round=25 head_norm_before_train=1.163888 cos_to_last_merge=0.9995 (last merge round=23)
[S6] round=25 local utility u=0.043771 metrics={'f1_val': 0.8214508904654568, 'auprc': 0.9475733626320308, 'loss_val': 0.442376972813562, 'psi': 0.8718998793320865}-{'f1_val': 0.8117582362758125, 'auprc': 0.9314503365703035, 'loss_val': 0.42339382385487523, 'psi': 0.8596350763936089}
[S7] START round=25 head_norm_before_train=1.090458 cos_to_last_merge=1.0000 (last merge round=24)
[S7] round=25 local utility u=0.000000 metrics={'f1_val': 0.6754062657908527, 'auprc': 0.8971289402188858, 'loss_val': 0.6107744082648295, 'psi': 0.764095335562066}-{'f1_val': 0.6424453458972952, 'auprc': 0.9927513722614993, 'loss_val': 0.6641558704389002, 'psi': 0.7825677564429769}
[S8] START round=25 head_norm_before_train=1.781160 (no previous merge yet)
[S8] round=25 local utility u=0.000000 metrics={'f1_val': 0.9923498862294302, 'auprc': 0.9987566307469619, 'loss_val': 0.055862849961419596, 'psi': 0.9949125840364429}-{'f1_val': 0.9941380936044745, 'auprc': 0.9985661785474003, 'loss_val': 0.05683555016828281, 'psi': 0.9959093275816449}
[S9] START round=25 head_norm_before_train=0.961521 cos_to_last_merge=1.0000 (last merge round=24)
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.9958601375429889, 'auprc': 0.9968168474359231, 'loss_val': 0.27117252824651616, 'psi': 0.9962428215001625}-{'f1_val': 0.9878532334303461, 'auprc': 0.996267493316942, 'loss_val': 0.21784027243971696, 'psi': 0.9912189373849845}
[S10] START round=25 head_norm_before_train=1.724572 cos_to_last_merge=0.9998 (last merge round=23)
[S10] round=25 local utility u=0.004713 metrics={'f1_val': 0.993391017001491, 'auprc': 0.9990117184818792, 'loss_val': 0.06827510900599341, 'psi': 0.9956392975936462}-{'f1_val': 0.993871046050545, 'auprc': 0.998905269213564, 'loss_val': 0.08026171114060211, 'psi': 0.9958847353157526}
[S11] START round=25 head_norm_before_train=1.895618 (no previous merge yet)
[S11] round=25 local utility u=0.365183 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.996380867277918, 'loss_val': 0.09527807104650876, 'psi': 0.996480549619321}-{'f1_val': 0.9154897388757642, 'auprc': 0.9932225038286749, 'loss_val': 0.3298252461671478, 'psi': 0.9465828448569285}
[S13] START round=25 head_norm_before_train=1.667418 (no previous merge yet)
[S13] round=25 local utility u=0.000000 metrics={'f1_val': 0.6053930778060129, 'auprc': 0.7261786585842659, 'loss_val': 0.7424107732257424, 'psi': 0.6537073101173141}-{'f1_val': 0.6459711425134618, 'auprc': 0.7676429272995546, 'loss_val': 0.4965353447113104, 'psi': 0.6946398564278989}
[S14] START round=25 head_norm_before_train=1.775871 cos_to_last_merge=0.9997 (last merge round=23)
[S14] round=25 local utility u=0.006538 metrics={'f1_val': 0.9976291097282272, 'auprc': 0.9967657427705268, 'loss_val': 0.06485307285874672, 'psi': 0.997283762945147}-{'f1_val': 0.997240356705793, 'auprc': 0.9968515117723982, 'loss_val': 0.07585320736396048, 'psi': 0.997084818732435}
[S15] START round=25 head_norm_before_train=0.905795 cos_to_last_merge=1.0000 (last merge round=24)
[S15] round=25 local utility u=0.000000 metrics={'f1_val': 0.6834397264897993, 'auprc': 0.8114355185783495, 'loss_val': 0.5919093595158058, 'psi': 0.7346380433252193}-{'f1_val': 0.7174951003438808, 'auprc': 0.8789249159848807, 'loss_val': 0.3733995192137987, 'psi': 0.7820670266002807}
[S16] START round=25 head_norm_before_train=1.151580 cos_to_last_merge=0.9792 (last merge round=21)
[S16] round=25 local utility u=0.671193 metrics={'f1_val': 0.9854843542647329, 'auprc': 0.9767037838929686, 'loss_val': 0.2305292787681092, 'psi': 0.9819721261160272}-{'f1_val': 0.8310364887815997, 'auprc': 0.9840640187806455, 'loss_val': 0.6683087072710606, 'psi': 0.8922475007812181}
[S17] START round=25 head_norm_before_train=0.908624 cos_to_last_merge=1.0000 (last merge round=24)
[S17] round=25 local utility u=1.000000 metrics={'f1_val': 0.6009960800619354, 'auprc': 0.8744021393102354, 'loss_val': 0.7085472446468226, 'psi': 0.7103585037612554}-{'f1_val': 0.3535765828037247, 'auprc': 0.6559012871112873, 'loss_val': 1.029820809257683, 'psi': 0.4745064645267497}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:39005
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.982)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.768)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S14] → sending delta(kind=head bytes=1806) to S17@127.0.0.1:39017
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.872)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:39014
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:39009
[S10] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1806 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1795) from S3
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.923309)
[S8] loaded HEAD from S3 (vec_in norm=1.923309)
[S8] cosine check vs S3: cos=-0.0086
[S8] DROPPED delta from S3 (cos=-0.0086 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1801) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.914763)
[S5] loaded HEAD from S11 (vec_in norm=1.914763)
[S5] cosine check vs S11: cos=0.9945
[S5] BUFFERED delta from S11 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1798) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.751626)
[S14] loaded HEAD from S10 (vec_in norm=1.751626)
[S14] cosine check vs S10: cos=0.9929
[S14] BUFFERED delta from S10 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1806) from S14
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.802931)
[S17] loaded HEAD from S14 (vec_in norm=1.802931)
[S17] cosine check vs S14: cos=0.6082
[S17] BUFFERED delta from S14 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:39016
[S17] sending update (kind=head size=1801 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1801) from S17
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.936889)
[S16] loaded HEAD from S17 (vec_in norm=0.936889)
[S16] cosine check vs S17: cos=0.8988
[S16] BUFFERED delta from S17 (total buffered=1)
[S13] ⇄ pheromone p=0.068 → S4@127.0.0.1:39004
[S2] ⇄ pheromone p=0.068 → S9@127.0.0.1:39010
[S15] ⇄ pheromone p=0.134 → S6@127.0.0.1:39007
[S6] ⇄ pheromone p=0.262 → S17@127.0.0.1:39017
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=25 metric=0.7003 head_norm=1.853301
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.035722e-01
[S5] stored merged vector for next round verification (round=25)
[S5] DEBUG after merge:  round=25 metric=0.7003 head_norm=1.881434 delta_norm=0.103572
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.114 → S17@127.0.0.1:39017
[S8] ⇄ pheromone p=0.069 → S5@127.0.0.1:39005
[S7] ⇄ pheromone p=0.279 → S2@127.0.0.1:39002
[S4] ⇄ pheromone p=0.095 → S10@127.0.0.1:39011
[S9] ⇄ pheromone p=0.089 → S15@127.0.0.1:39015
[S3] ⇄ pheromone p=0.142 → S8@127.0.0.1:39009
[S10] ⇄ pheromone p=0.040 → S14@127.0.0.1:39014
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=25 metric=0.9976 head_norm=1.802931
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.088741e-01
[S14] stored merged vector for next round verification (round=25)
[S14] DEBUG after merge:  round=25 metric=0.9976 head_norm=1.774126 delta_norm=0.108874
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.037 → S17@127.0.0.1:39017
[S11] ⇄ pheromone p=0.184 → S5@127.0.0.1:39005
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=25 metric=0.9855 head_norm=1.200768
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.726241e-01
[S16] stored merged vector for next round verification (round=25)
[S16] DEBUG after merge:  round=25 metric=0.9730 head_norm=1.041863 delta_norm=0.272624
[S16] aggregate: ROLLBACK (f1_val pre=0.985 post=0.973 tol_abs=0.005 tol_rel=0.0)
[S16] ⇄ pheromone p=0.267 → S7@127.0.0.1:39008
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=25 metric=0.6010 head_norm=0.936889
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.200357e-01
[S17] stored merged vector for next round verification (round=25)
[S17] DEBUG after merge:  round=25 metric=0.6038 head_norm=1.243265 delta_norm=0.720036
[S17] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.308 → S16@127.0.0.1:39016
[S2] START round=26 head_norm_before_train=1.038803 cos_to_last_merge=0.9920 (last merge round=24)
[S2] round=26 local utility u=0.002793 metrics={'f1_val': 0.7080605305195827, 'auprc': 0.8333522380826299, 'loss_val': 0.45325378554364915, 'psi': 0.7581772135448016}-{'f1_val': 0.7115440126606088, 'auprc': 0.8523648788576305, 'loss_val': 0.5367778033314443, 'psi': 0.7678723591394174}
[S3] START round=26 head_norm_before_train=1.923309 (no previous merge yet)
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.960995754132836, 'auprc': 0.9973926127857476, 'loss_val': 0.11226621110623047, 'psi': 0.9755544975940007}-{'f1_val': 0.9977814963782642, 'auprc': 0.9987620261139306, 'loss_val': 0.043444308202884654, 'psi': 0.9981737082725308}
[S4] START round=26 head_norm_before_train=1.700118 cos_to_last_merge=0.9998 (last merge round=24)
[S4] round=26 local utility u=0.000000 metrics={'f1_val': 0.9385613773039736, 'auprc': 0.955791357015405, 'loss_val': 0.2604957102416516, 'psi': 0.9454533691885462}-{'f1_val': 0.9397809444278574, 'auprc': 0.9706060316097369, 'loss_val': 0.25378781391514366, 'psi': 0.9521109793006093}
[S5] START round=26 head_norm_before_train=1.881434 cos_to_last_merge=1.0000 (last merge round=25)
[S5] round=26 local utility u=0.000000 metrics={'f1_val': 0.7010414965223207, 'auprc': 0.8845764909630245, 'loss_val': 0.2916966857016617, 'psi': 0.7744554942986022}-{'f1_val': 0.700320598491359, 'auprc': 0.9618266103119925, 'loss_val': 0.29038660828752494, 'psi': 0.8049230032196124}
[S6] START round=26 head_norm_before_train=1.197966 cos_to_last_merge=0.9981 (last merge round=23)
[S6] round=26 local utility u=0.000000 metrics={'f1_val': 0.7812603024480471, 'auprc': 0.7809732918579397, 'loss_val': 0.5499670057233411, 'psi': 0.7811454982120042}-{'f1_val': 0.8214508904654568, 'auprc': 0.9475733626320308, 'loss_val': 0.442376972813562, 'psi': 0.8718998793320865}
[S7] START round=26 head_norm_before_train=1.116445 cos_to_last_merge=0.9988 (last merge round=24)
[S7] round=26 local utility u=0.000000 metrics={'f1_val': 0.5360749293535416, 'auprc': 0.8004653304995111, 'loss_val': 0.8471347059206443, 'psi': 0.6418310898119295}-{'f1_val': 0.6754062657908527, 'auprc': 0.8971289402188858, 'loss_val': 0.6107744082648295, 'psi': 0.764095335562066}
[S8] START round=26 head_norm_before_train=1.799997 (no previous merge yet)
[S8] round=26 local utility u=0.000000 metrics={'f1_val': 0.9926726816424898, 'auprc': 0.9911588810965113, 'loss_val': 0.0512292217706894, 'psi': 0.9920671614240983}-{'f1_val': 0.9923498862294302, 'auprc': 0.9987566307469619, 'loss_val': 0.055862849961419596, 'psi': 0.9949125840364429}
[S9] START round=26 head_norm_before_train=1.028813 cos_to_last_merge=0.9932 (last merge round=24)
[S9] round=26 local utility u=0.044458 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9930488559842368, 'loss_val': 0.17840994922535378, 'psi': 0.9954812899009804}-{'f1_val': 0.9958601375429889, 'auprc': 0.9968168474359231, 'loss_val': 0.27117252824651616, 'psi': 0.9962428215001625}
[S10] START round=26 head_norm_before_train=1.751626 cos_to_last_merge=0.9991 (last merge round=23)
[S10] round=26 local utility u=0.001402 metrics={'f1_val': 0.993391017001491, 'auprc': 0.9972101067123276, 'loss_val': 0.060066522825833225, 'psi': 0.9949186528858256}-{'f1_val': 0.993391017001491, 'auprc': 0.9990117184818792, 'loss_val': 0.06827510900599341, 'psi': 0.9956392975936462}
[S11] START round=26 head_norm_before_train=1.914763 (no previous merge yet)
[S11] round=26 local utility u=0.009607 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.997463609434444, 'loss_val': 0.07931236930817948, 'psi': 0.9969136464819314}-{'f1_val': 0.9965470045135896, 'auprc': 0.996380867277918, 'loss_val': 0.09527807104650876, 'psi': 0.996480549619321}
[S13] START round=26 head_norm_before_train=1.675059 (no previous merge yet)
[S13] round=26 local utility u=0.308633 metrics={'f1_val': 0.6528541137304792, 'auprc': 0.7378889538273744, 'loss_val': 0.44504268331234337, 'psi': 0.6868680497692372}-{'f1_val': 0.6053930778060129, 'auprc': 0.7261786585842659, 'loss_val': 0.7424107732257424, 'psi': 0.6537073101173141}
[S14] START round=26 head_norm_before_train=1.774126 cos_to_last_merge=1.0000 (last merge round=25)
[S14] round=26 local utility u=0.000000 metrics={'f1_val': 0.9967774409524363, 'auprc': 0.9951862718198704, 'loss_val': 0.07207825854570386, 'psi': 0.99614097329941}-{'f1_val': 0.9976291097282272, 'auprc': 0.9967657427705268, 'loss_val': 0.06485307285874672, 'psi': 0.997283762945147}
[S15] START round=26 head_norm_before_train=0.945893 cos_to_last_merge=0.9969 (last merge round=24)
[S15] round=26 local utility u=0.606488 metrics={'f1_val': 0.7668962319652661, 'auprc': 0.9875036431161086, 'loss_val': 0.40787581085315555, 'psi': 0.8551391964256032}-{'f1_val': 0.6834397264897993, 'auprc': 0.8114355185783495, 'loss_val': 0.5919093595158058, 'psi': 0.7346380433252193}
[S16] START round=26 head_norm_before_train=1.041863 cos_to_last_merge=1.0000 (last merge round=25)
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.8496871188284687, 'auprc': 0.989056423803209, 'loss_val': 0.5951978238934065, 'psi': 0.9054348408183648}-{'f1_val': 0.9854843542647329, 'auprc': 0.9767037838929686, 'loss_val': 0.2305292787681092, 'psi': 0.9819721261160272}
[S17] START round=26 head_norm_before_train=1.243265 cos_to_last_merge=1.0000 (last merge round=25)
[S17] round=26 local utility u=0.197954 metrics={'f1_val': 0.6969506038450917, 'auprc': 0.7983007857507025, 'loss_val': 0.6600614031160209, 'psi': 0.737490676607336}-{'f1_val': 0.6009960800619354, 'auprc': 0.8744021393102354, 'loss_val': 0.7085472446468226, 'psi': 0.7103585037612554}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:39004
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.997)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:39010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:39007
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:39015
[S10] not sending this round → trigger blocked (psi=0.995)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1798) from S15
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.005092)
[S6] loaded HEAD from S15 (vec_in norm=1.005092)
[S6] cosine check vs S15: cos=0.7715
[S6] BUFFERED delta from S15 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1799) from S9
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.105592)
[S15] loaded HEAD from S9 (vec_in norm=1.105592)
[S15] cosine check vs S9: cos=0.7931
[S15] BUFFERED delta from S9 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1800) from S13
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.679864)
[S4] loaded HEAD from S13 (vec_in norm=1.679864)
[S4] cosine check vs S13: cos=0.9945
[S4] BUFFERED delta from S13 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1801) from S2
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.105732)
[S9] loaded HEAD from S2 (vec_in norm=1.105732)
[S9] cosine check vs S2: cos=0.8314
[S9] BUFFERED delta from S2 (total buffered=1)
[S17] not sending this round → trigger blocked (psi=0.737)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=26 metric=0.7813 head_norm=1.238067
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.946507e-01
[S6] stored merged vector for next round verification (round=26)
[S6] DEBUG after merge:  round=26 metric=0.7831 head_norm=1.056295 delta_norm=0.394651
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=26 metric=0.9386 head_norm=1.722490
[S4] _apply_head_vector_avg (torch): Δ‖w‖=9.137129e-02
[S4] stored merged vector for next round verification (round=26)
[S4] DEBUG after merge:  round=26 metric=0.9386 head_norm=1.698855 delta_norm=0.091371
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=26 metric=0.7669 head_norm=1.005092
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.427481e-01
[S15] stored merged vector for next round verification (round=26)
[S15] DEBUG after merge:  round=26 metric=0.7645 head_norm=0.999397 delta_norm=0.342748
[S15] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=26 metric=0.9971 head_norm=1.105592
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.209808e-01
[S9] stored merged vector for next round verification (round=26)
[S9] DEBUG after merge:  round=26 metric=0.9971 head_norm=1.058045 delta_norm=0.320981
[S9] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.105732 cos_to_last_merge=0.9749 (last merge round=24)
[S2] round=27 local utility u=0.032220 metrics={'f1_val': 0.7151034355165884, 'auprc': 0.8327272386550193, 'loss_val': 0.42919633671791474, 'psi': 0.7621529567719607}-{'f1_val': 0.7080605305195827, 'auprc': 0.8333522380826299, 'loss_val': 0.45325378554364915, 'psi': 0.7581772135448016}
[S3] START round=27 head_norm_before_train=1.937041 (no previous merge yet)
[S3] round=27 local utility u=0.079869 metrics={'f1_val': 0.9785814939268872, 'auprc': 0.9977801203107497, 'loss_val': 0.05920500686725957, 'psi': 0.9862609444804322}-{'f1_val': 0.960995754132836, 'auprc': 0.9973926127857476, 'loss_val': 0.11226621110623047, 'psi': 0.9755544975940007}
[S4] START round=27 head_norm_before_train=1.698855 cos_to_last_merge=1.0000 (last merge round=26)
[S4] round=27 local utility u=0.000000 metrics={'f1_val': 0.9390960656113327, 'auprc': 0.9503948446078851, 'loss_val': 0.25676520382820667, 'psi': 0.9436155772099537}-{'f1_val': 0.9385613773039736, 'auprc': 0.955791357015405, 'loss_val': 0.2604957102416516, 'psi': 0.9454533691885462}
[S5] START round=27 head_norm_before_train=1.891265 cos_to_last_merge=1.0000 (last merge round=25)
[S5] round=27 local utility u=0.177614 metrics={'f1_val': 0.7003200138525959, 'auprc': 0.9910005009313876, 'loss_val': 0.25141110702686575, 'psi': 0.8165922086841126}-{'f1_val': 0.7010414965223207, 'auprc': 0.8845764909630245, 'loss_val': 0.2916966857016617, 'psi': 0.7744554942986022}
[S6] START round=27 head_norm_before_train=1.056295 cos_to_last_merge=1.0000 (last merge round=26)
[S6] round=27 local utility u=0.000000 metrics={'f1_val': 0.6507412240978564, 'auprc': 0.7141902622058725, 'loss_val': 0.7009064936385873, 'psi': 0.6761208393410628}-{'f1_val': 0.7812603024480471, 'auprc': 0.7809732918579397, 'loss_val': 0.5499670057233411, 'psi': 0.7811454982120042}
[S7] START round=27 head_norm_before_train=1.143752 cos_to_last_merge=0.9959 (last merge round=24)
[S7] round=27 local utility u=0.919163 metrics={'f1_val': 0.6893381349079328, 'auprc': 0.9711983301948668, 'loss_val': 0.4405874333277261, 'psi': 0.8020822130227063}-{'f1_val': 0.5360749293535416, 'auprc': 0.8004653304995111, 'loss_val': 0.8471347059206443, 'psi': 0.6418310898119295}
[S8] START round=27 head_norm_before_train=1.818182 (no previous merge yet)
[S8] round=27 local utility u=0.005434 metrics={'f1_val': 0.9905027553548844, 'auprc': 0.9988999736514235, 'loss_val': 0.05056525801279346, 'psi': 0.9938616426735001}-{'f1_val': 0.9926726816424898, 'auprc': 0.9911588810965113, 'loss_val': 0.0512292217706894, 'psi': 0.9920671614240983}
[S9] START round=27 head_norm_before_train=1.058045 cos_to_last_merge=1.0000 (last merge round=26)
[S9] round=27 local utility u=0.000000 metrics={'f1_val': 0.985716065895656, 'auprc': 0.9873709105273047, 'loss_val': 0.27411280631733714, 'psi': 0.9863780037483155}-{'f1_val': 0.9971029125121428, 'auprc': 0.9930488559842368, 'loss_val': 0.17840994922535378, 'psi': 0.9954812899009804}
[S10] START round=27 head_norm_before_train=1.778353 cos_to_last_merge=0.9981 (last merge round=23)
[S10] round=27 local utility u=0.003133 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9947436016505468, 'loss_val': 0.05454749526670179, 'psi': 0.9947466061918422}-{'f1_val': 0.993391017001491, 'auprc': 0.9972101067123276, 'loss_val': 0.060066522825833225, 'psi': 0.9949186528858256}
[S11] START round=27 head_norm_before_train=1.938138 (no previous merge yet)
[S11] round=27 local utility u=0.000000 metrics={'f1_val': 0.9122393371812384, 'auprc': 0.9975213815068478, 'loss_val': 0.2393258250611439, 'psi': 0.9463521549114822}-{'f1_val': 0.9965470045135896, 'auprc': 0.997463609434444, 'loss_val': 0.07931236930817948, 'psi': 0.9969136464819314}
[S13] START round=27 head_norm_before_train=1.679864 (no previous merge yet)
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.6126326250742861, 'auprc': 0.7029663771885476, 'loss_val': 0.7129210094860337, 'psi': 0.6487661259199906}-{'f1_val': 0.6528541137304792, 'auprc': 0.7378889538273744, 'loss_val': 0.44504268331234337, 'psi': 0.6868680497692372}
[S14] START round=27 head_norm_before_train=1.795694 cos_to_last_merge=0.9998 (last merge round=25)
[S14] round=27 local utility u=0.000000 metrics={'f1_val': 0.9915563358382661, 'auprc': 0.9953396452940189, 'loss_val': 0.0779817816656656, 'psi': 0.9930696596205671}-{'f1_val': 0.9967774409524363, 'auprc': 0.9951862718198704, 'loss_val': 0.07207825854570386, 'psi': 0.99614097329941}
[S15] START round=27 head_norm_before_train=0.999397 cos_to_last_merge=1.0000 (last merge round=26)
[S15] round=27 local utility u=0.000000 metrics={'f1_val': 0.7020253722290903, 'auprc': 0.9782866473000971, 'loss_val': 0.5139747761395032, 'psi': 0.8125298822574931}-{'f1_val': 0.7668962319652661, 'auprc': 0.9875036431161086, 'loss_val': 0.40787581085315555, 'psi': 0.8551391964256032}
[S16] START round=27 head_norm_before_train=1.091251 cos_to_last_merge=0.9986 (last merge round=25)
[S16] round=27 local utility u=0.584706 metrics={'f1_val': 0.9889459610178515, 'auprc': 0.97654024393906, 'loss_val': 0.22378956212877768, 'psi': 0.9839836741863348}-{'f1_val': 0.8496871188284687, 'auprc': 0.989056423803209, 'loss_val': 0.5951978238934065, 'psi': 0.9054348408183648}
[S17] START round=27 head_norm_before_train=1.266568 cos_to_last_merge=0.9987 (last merge round=25)
[S17] round=27 local utility u=0.161857 metrics={'f1_val': 0.6967396030092855, 'auprc': 0.8771214108881431, 'loss_val': 0.5715436044107268, 'psi': 0.7688923261608285}-{'f1_val': 0.6969506038450917, 'auprc': 0.7983007857507025, 'loss_val': 0.6600614031160209, 'psi': 0.737490676607336}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:39008
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:39016
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:39004
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.762)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:39012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:39003
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1801) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.834458)
[S3] loaded HEAD from S8 (vec_in norm=1.834458)
[S3] cosine check vs S8: cos=-0.0091
[S3] DROPPED delta from S8 (cos=-0.0091 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1802) from S7
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.172879)
[S16] loaded HEAD from S7 (vec_in norm=1.172879)
[S16] cosine check vs S7: cos=0.9472
[S16] BUFFERED delta from S7 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1800) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.803513)
[S4] loaded HEAD from S10 (vec_in norm=1.803513)
[S4] cosine check vs S10: cos=0.9893
[S4] BUFFERED delta from S10 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1801) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.147277)
[S7] loaded HEAD from S16 (vec_in norm=1.147277)
[S7] cosine check vs S16: cos=0.9472
[S7] BUFFERED delta from S16 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1799) from S5
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.902624)
[S11] loaded HEAD from S5 (vec_in norm=1.902624)
[S11] cosine check vs S5: cos=0.9966
[S11] BUFFERED delta from S5 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:39007
[S17] sending update (kind=head size=1802 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1802) from S17
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.294474)
[S6] loaded HEAD from S17 (vec_in norm=1.294474)
[S6] cosine check vs S17: cos=0.2825
[S6] BUFFERED delta from S17 (total buffered=1)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=27 metric=0.9391 head_norm=1.720195
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.354046e-01
[S4] stored merged vector for next round verification (round=27)
[S4] DEBUG after merge:  round=27 metric=0.9383 head_norm=1.757137 delta_norm=0.135405
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=27 metric=0.9122 head_norm=1.963156
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.541857e-02
[S11] stored merged vector for next round verification (round=27)
[S11] DEBUG after merge:  round=27 metric=0.9116 head_norm=1.931239 delta_norm=0.085419
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=27 metric=0.6507 head_norm=1.096431
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.204167e-01
[S6] stored merged vector for next round verification (round=27)
[S6] DEBUG after merge:  round=27 metric=0.6354 head_norm=0.959121 delta_norm=0.720417
[S6] aggregate: ROLLBACK (f1_val pre=0.651 post=0.635 tol_abs=0.005 tol_rel=0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=27 metric=0.6893 head_norm=1.172879
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.889388e-01
[S7] stored merged vector for next round verification (round=27)
[S7] DEBUG after merge:  round=27 metric=0.6883 head_norm=1.144660 delta_norm=0.188939
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=27 metric=0.9889 head_norm=1.147277
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.889388e-01
[S16] stored merged vector for next round verification (round=27)
[S16] DEBUG after merge:  round=27 metric=0.9883 head_norm=1.144660 delta_norm=0.188939
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=1.174653 cos_to_last_merge=0.9564 (last merge round=24)
[S2] round=28 local utility u=0.175825 metrics={'f1_val': 0.7734222035581666, 'auprc': 0.8426624042601218, 'loss_val': 0.457263755177831, 'psi': 0.8011182838389487}-{'f1_val': 0.7151034355165884, 'auprc': 0.8327272386550193, 'loss_val': 0.42919633671791474, 'psi': 0.7621529567719607}
[S3] START round=28 head_norm_before_train=1.949887 (no previous merge yet)
[S3] round=28 local utility u=0.000000 metrics={'f1_val': 0.964226756090844, 'auprc': 0.9980658332928932, 'loss_val': 0.0693108478957406, 'psi': 0.9777623869716636}-{'f1_val': 0.9785814939268872, 'auprc': 0.9977801203107497, 'loss_val': 0.05920500686725957, 'psi': 0.9862609444804322}
[S4] START round=28 head_norm_before_train=1.757137 cos_to_last_merge=1.0000 (last merge round=27)
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.934240028447853, 'auprc': 0.9344534616398065, 'loss_val': 0.29690285859956034, 'psi': 0.9343254017246344}-{'f1_val': 0.9390960656113327, 'auprc': 0.9503948446078851, 'loss_val': 0.25676520382820667, 'psi': 0.9436155772099537}
[S5] START round=28 head_norm_before_train=1.902624 cos_to_last_merge=0.9998 (last merge round=25)
[S5] round=28 local utility u=0.000000 metrics={'f1_val': 0.7030176632232185, 'auprc': 0.9882029641528819, 'loss_val': 0.29577345439319885, 'psi': 0.8170917835950838}-{'f1_val': 0.7003200138525959, 'auprc': 0.9910005009313876, 'loss_val': 0.25141110702686575, 'psi': 0.8165922086841126}
[S6] START round=28 head_norm_before_train=0.959121 cos_to_last_merge=1.0000 (last merge round=27)
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.6550790250463391, 'auprc': 0.6934229526861873, 'loss_val': 0.7557753666449276, 'psi': 0.6704165961022783}-{'f1_val': 0.6507412240978564, 'auprc': 0.7141902622058725, 'loss_val': 0.7009064936385873, 'psi': 0.6761208393410628}
[S7] START round=28 head_norm_before_train=1.144660 cos_to_last_merge=1.0000 (last merge round=27)
[S7] round=28 local utility u=0.000000 metrics={'f1_val': 0.4325450954374602, 'auprc': 0.773730843631159, 'loss_val': 1.0477570686624678, 'psi': 0.5690193947149398}-{'f1_val': 0.6893381349079328, 'auprc': 0.9711983301948668, 'loss_val': 0.4405874333277261, 'psi': 0.8020822130227063}
[S8] START round=28 head_norm_before_train=1.834458 (no previous merge yet)
[S8] round=28 local utility u=0.000000 metrics={'f1_val': 0.9555698783303647, 'auprc': 0.9990223418855668, 'loss_val': 0.12814649144977153, 'psi': 0.9729508637524455}-{'f1_val': 0.9905027553548844, 'auprc': 0.9988999736514235, 'loss_val': 0.05056525801279346, 'psi': 0.9938616426735001}
[S9] START round=28 head_norm_before_train=1.114174 cos_to_last_merge=0.9958 (last merge round=26)
[S9] round=28 local utility u=0.090114 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9916232150047413, 'loss_val': 0.17249986297529485, 'psi': 0.9946647807607538}-{'f1_val': 0.985716065895656, 'auprc': 0.9873709105273047, 'loss_val': 0.27411280631733714, 'psi': 0.9863780037483155}
[S10] START round=28 head_norm_before_train=1.803513 cos_to_last_merge=0.9968 (last merge round=23)
[S10] round=28 local utility u=0.002042 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9970175468517104, 'loss_val': 0.04939013357704355, 'psi': 0.9948666436332276}-{'f1_val': 0.9947486092193725, 'auprc': 0.9947436016505468, 'loss_val': 0.05454749526670179, 'psi': 0.9947466061918422}
[S11] START round=28 head_norm_before_train=1.931239 cos_to_last_merge=1.0000 (last merge round=27)
[S11] round=28 local utility u=0.340578 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9977825406478473, 'loss_val': 0.06479978365483455, 'psi': 0.9970412189672927}-{'f1_val': 0.9122393371812384, 'auprc': 0.9975213815068478, 'loss_val': 0.2393258250611439, 'psi': 0.9463521549114822}
[S13] START round=28 head_norm_before_train=1.684069 (no previous merge yet)
[S13] round=28 local utility u=0.060680 metrics={'f1_val': 0.6270914338710993, 'auprc': 0.690014574987306, 'loss_val': 0.6394587938850619, 'psi': 0.652260690317582}-{'f1_val': 0.6126326250742861, 'auprc': 0.7029663771885476, 'loss_val': 0.7129210094860337, 'psi': 0.6487661259199906}
[S14] START round=28 head_norm_before_train=1.815195 cos_to_last_merge=0.9994 (last merge round=25)
[S14] round=28 local utility u=0.030704 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9968268266051759, 'loss_val': 0.053681754123903205, 'psi': 0.9969292355366695}-{'f1_val': 0.9915563358382661, 'auprc': 0.9953396452940189, 'loss_val': 0.0779817816656656, 'psi': 0.9930696596205671}
[S15] START round=28 head_norm_before_train=1.048853 cos_to_last_merge=0.9943 (last merge round=26)
[S15] round=28 local utility u=0.075351 metrics={'f1_val': 0.7250262892877403, 'auprc': 0.9517961472770403, 'loss_val': 0.42180721567698165, 'psi': 0.8157342324834602}-{'f1_val': 0.7020253722290903, 'auprc': 0.9782866473000971, 'loss_val': 0.5139747761395032, 'psi': 0.8125298822574931}
[S16] START round=28 head_norm_before_train=1.144660 cos_to_last_merge=1.0000 (last merge round=27)
[S16] round=28 local utility u=0.037674 metrics={'f1_val': 0.9904533445582239, 'auprc': 0.9829246170439085, 'loss_val': 0.17663916240696279, 'psi': 0.9874418535524978}-{'f1_val': 0.9889459610178515, 'auprc': 0.97654024393906, 'loss_val': 0.22378956212877768, 'psi': 0.9839836741863348}
[S17] START round=28 head_norm_before_train=1.294474 cos_to_last_merge=0.9957 (last merge round=25)
[S17] round=28 local utility u=0.000000 metrics={'f1_val': 0.6182950556925497, 'auprc': 0.866145716362766, 'loss_val': 0.5586280747453456, 'psi': 0.7174353199606363}-{'f1_val': 0.6967396030092855, 'auprc': 0.8771214108881431, 'loss_val': 0.5715436044107268, 'psi': 0.7688923261608285}
[S10] not sending this round → trigger blocked (psi=0.995)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:39011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:39002
[S16] not sending this round → trigger blocked (psi=0.987)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:39010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:39008
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1801) from S9
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.171808)
[S2] loaded HEAD from S9 (vec_in norm=1.171808)
[S2] cosine check vs S9: cos=0.9060
[S2] BUFFERED delta from S9 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1798) from S14
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.835188)
[S10] loaded HEAD from S14 (vec_in norm=1.835188)
[S10] cosine check vs S14: cos=0.9945
[S10] BUFFERED delta from S14 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1802) from S15
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.119463)
[S9] loaded HEAD from S15 (vec_in norm=1.119463)
[S9] cosine check vs S15: cos=0.8705
[S9] BUFFERED delta from S15 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1803) from S2
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.235656)
[S7] loaded HEAD from S2 (vec_in norm=1.235656)
[S7] cosine check vs S2: cos=0.8023
[S7] BUFFERED delta from S2 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=28 metric=0.4325 head_norm=1.168090
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.792758e-01
[S7] stored merged vector for next round verification (round=28)
[S7] DEBUG after merge:  round=28 metric=0.4225 head_norm=1.140960 delta_norm=0.379276
[S7] aggregate: ROLLBACK (f1_val pre=0.433 post=0.423 tol_abs=0.005 tol_rel=0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=28 metric=0.9934 head_norm=1.826368
[S10] _apply_head_vector_avg (torch): Δ‖w‖=9.611080e-02
[S10] stored merged vector for next round verification (round=28)
[S10] DEBUG after merge:  round=28 metric=0.9934 head_norm=1.828259 delta_norm=0.096111
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=28 metric=0.9967 head_norm=1.171808
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.925914e-01
[S9] stored merged vector for next round verification (round=28)
[S9] DEBUG after merge:  round=28 metric=0.9971 head_norm=1.107951 delta_norm=0.292591
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=28 metric=0.7734 head_norm=1.235656
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.628469e-01
[S2] stored merged vector for next round verification (round=28)
[S2] DEBUG after merge:  round=28 metric=0.7749 head_norm=1.175118 delta_norm=0.262847
[S2] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=1.175118 cos_to_last_merge=1.0000 (last merge round=28)
[S2] round=29 local utility u=0.101992 metrics={'f1_val': 0.8290908564123327, 'auprc': 0.8074831375081882, 'loss_val': 0.4817541271308829, 'psi': 0.8204477688506748}-{'f1_val': 0.7734222035581666, 'auprc': 0.8426624042601218, 'loss_val': 0.457263755177831, 'psi': 0.8011182838389487}
[S3] START round=29 head_norm_before_train=1.963398 (no previous merge yet)
[S3] round=29 local utility u=0.108043 metrics={'f1_val': 0.9954205624364705, 'auprc': 0.9981240388560554, 'loss_val': 0.04056254839159061, 'psi': 0.9965019530043044}-{'f1_val': 0.964226756090844, 'auprc': 0.9980658332928932, 'loss_val': 0.0693108478957406, 'psi': 0.9777623869716636}
[S4] START round=29 head_norm_before_train=1.777696 cos_to_last_merge=0.9998 (last merge round=27)
[S4] round=29 local utility u=0.065285 metrics={'f1_val': 0.9398537146882731, 'auprc': 0.9551396520950163, 'loss_val': 0.2620727395874906, 'psi': 0.9459680896509703}-{'f1_val': 0.934240028447853, 'auprc': 0.9344534616398065, 'loss_val': 0.29690285859956034, 'psi': 0.9343254017246344}
[S5] START round=29 head_norm_before_train=1.913836 cos_to_last_merge=0.9996 (last merge round=25)
[S5] round=29 local utility u=0.056720 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9935761699918093, 'loss_val': 0.18227072183826307, 'psi': 0.8176228270915391}-{'f1_val': 0.7030176632232185, 'auprc': 0.9882029641528819, 'loss_val': 0.29577345439319885, 'psi': 0.8170917835950838}
[S6] START round=29 head_norm_before_train=1.002714 cos_to_last_merge=0.9975 (last merge round=27)
[S6] round=29 local utility u=1.000000 metrics={'f1_val': 0.9244324895114844, 'auprc': 0.9487551927087197, 'loss_val': 0.3790107000474836, 'psi': 0.9341615707903785}-{'f1_val': 0.6550790250463391, 'auprc': 0.6934229526861873, 'loss_val': 0.7557753666449276, 'psi': 0.6704165961022783}
[S7] START round=29 head_norm_before_train=1.140960 cos_to_last_merge=1.0000 (last merge round=28)
[S7] round=29 local utility u=1.000000 metrics={'f1_val': 0.6858569497302991, 'auprc': 0.9235113870313136, 'loss_val': 0.467316110402387, 'psi': 0.780918724650705}-{'f1_val': 0.4325450954374602, 'auprc': 0.773730843631159, 'loss_val': 1.0477570686624678, 'psi': 0.5690193947149398}
[S8] START round=29 head_norm_before_train=1.852912 (no previous merge yet)
[S8] round=29 local utility u=0.131145 metrics={'f1_val': 0.9932456999636199, 'auprc': 0.9857385247688057, 'loss_val': 0.05206078775857727, 'psi': 0.9902428298856942}-{'f1_val': 0.9555698783303647, 'auprc': 0.9990223418855668, 'loss_val': 0.12814649144977153, 'psi': 0.9729508637524455}
[S9] START round=29 head_norm_before_train=1.107951 cos_to_last_merge=1.0000 (last merge round=28)
[S9] round=29 local utility u=0.000000 metrics={'f1_val': 0.9895343037577012, 'auprc': 0.9961392582431272, 'loss_val': 0.16156953555454334, 'psi': 0.9921762855518717}-{'f1_val': 0.9966924912647621, 'auprc': 0.9916232150047413, 'loss_val': 0.17249986297529485, 'psi': 0.9946647807607538}
[S10] START round=29 head_norm_before_train=1.828259 cos_to_last_merge=1.0000 (last merge round=28)
[S10] round=29 local utility u=0.001476 metrics={'f1_val': 0.993391017001491, 'auprc': 0.9974850253856853, 'loss_val': 0.04758955452120045, 'psi': 0.9950286203551687}-{'f1_val': 0.9934327081542391, 'auprc': 0.9970175468517104, 'loss_val': 0.04939013357704355, 'psi': 0.9948666436332276}
[S11] START round=29 head_norm_before_train=1.948784 cos_to_last_merge=0.9999 (last merge round=27)
[S11] round=29 local utility u=0.000000 metrics={'f1_val': 0.9963753869090841, 'auprc': 0.9977070203508885, 'loss_val': 0.07076788301109738, 'psi': 0.9969080402858059}-{'f1_val': 0.9965470045135896, 'auprc': 0.9977825406478473, 'loss_val': 0.06479978365483455, 'psi': 0.9970412189672927}
[S13] START round=29 head_norm_before_train=1.691957 (no previous merge yet)
[S13] round=29 local utility u=0.076463 metrics={'f1_val': 0.6362472313129063, 'auprc': 0.6917644188868992, 'loss_val': 0.5467177178877114, 'psi': 0.6584541063425035}-{'f1_val': 0.6270914338710993, 'auprc': 0.690014574987306, 'loss_val': 0.6394587938850619, 'psi': 0.652260690317582}
[S14] START round=29 head_norm_before_train=1.835188 cos_to_last_merge=0.9987 (last merge round=25)
[S14] round=29 local utility u=0.001371 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.996932815683968, 'loss_val': 0.051258042051383686, 'psi': 0.9969716311681862}-{'f1_val': 0.9969975081576651, 'auprc': 0.9968268266051759, 'loss_val': 0.053681754123903205, 'psi': 0.9969292355366695}
[S15] START round=29 head_norm_before_train=1.119463 cos_to_last_merge=0.9783 (last merge round=26)
[S15] round=29 local utility u=0.534560 metrics={'f1_val': 0.8545029188849266, 'auprc': 0.990344834618299, 'loss_val': 0.24519278506077488, 'psi': 0.9088396851782756}-{'f1_val': 0.7250262892877403, 'auprc': 0.9517961472770403, 'loss_val': 0.42180721567698165, 'psi': 0.8157342324834602}
[S16] START round=29 head_norm_before_train=1.197818 cos_to_last_merge=0.9989 (last merge round=27)
[S16] round=29 local utility u=0.000000 metrics={'f1_val': 0.8449471692885077, 'auprc': 0.9881270520612592, 'loss_val': 0.6283482103586013, 'psi': 0.9022191223976083}-{'f1_val': 0.9904533445582239, 'auprc': 0.9829246170439085, 'loss_val': 0.17663916240696279, 'psi': 0.9874418535524978}
[S17] START round=29 head_norm_before_train=1.324136 cos_to_last_merge=0.9918 (last merge round=25)
[S17] round=29 local utility u=0.000000 metrics={'f1_val': 0.5678987883271571, 'auprc': 0.757102933949457, 'loss_val': 0.6608089504887942, 'psi': 0.643580446576077}-{'f1_val': 0.6182950556925497, 'auprc': 0.866145716362766, 'loss_val': 0.5586280747453456, 'psi': 0.7174353199606363}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:39003
[S13] not sending this round → trigger blocked (psi=0.658)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:39016
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:39013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S11@127.0.0.1:39012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:39004
[S14] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:39015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S15] not sending this round → trigger blocked (psi=0.909)
[S2] not sending this round → trigger blocked (psi=0.820)
[S6] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1793 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1796) from S6
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.056224)
[S15] loaded HEAD from S6 (vec_in norm=1.056224)
[S15] cosine check vs S6: cos=0.7947
[S15] BUFFERED delta from S6 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1802) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.848917)
[S4] loaded HEAD from S10 (vec_in norm=1.848917)
[S4] cosine check vs S10: cos=0.9957
[S4] BUFFERED delta from S10 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1798) from S7
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.162871)
[S16] loaded HEAD from S7 (vec_in norm=1.162871)
[S16] cosine check vs S7: cos=0.9366
[S16] BUFFERED delta from S7 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1802) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.870658)
[S3] loaded HEAD from S8 (vec_in norm=1.870658)
[S3] cosine check vs S8: cos=-0.0095
[S3] DROPPED delta from S8 (cos=-0.0095 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1793) from S5
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.924396)
[S11] loaded HEAD from S5 (vec_in norm=1.924396)
[S11] cosine check vs S5: cos=0.9977
[S11] BUFFERED delta from S5 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1800) from S4
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.792071)
[S13] loaded HEAD from S4 (vec_in norm=1.792071)
[S13] cosine check vs S4: cos=0.9876
[S13] BUFFERED delta from S4 (total buffered=1)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=29 metric=0.9964 head_norm=1.966550
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.911313e-02
[S11] stored merged vector for next round verification (round=29)
[S11] DEBUG after merge:  round=29 metric=0.9968 head_norm=1.944359 delta_norm=0.069113
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=29 metric=0.8449 head_norm=1.247750
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.185812e-01
[S16] stored merged vector for next round verification (round=29)
[S16] DEBUG after merge:  round=29 metric=0.8443 head_norm=1.186084 delta_norm=0.218581
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=29 metric=0.6362 head_norm=1.701220
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.450102e-01
[S13] stored merged vector for next round verification (round=29)
[S13] DEBUG after merge:  round=29 metric=0.6371 head_norm=1.741208 delta_norm=0.145010
[S13] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=29 metric=0.8545 head_norm=1.196965
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.670768e-01
[S15] stored merged vector for next round verification (round=29)
[S15] DEBUG after merge:  round=29 metric=0.8130 head_norm=1.067437 delta_norm=0.367077
[S15] aggregate: ROLLBACK (f1_val pre=0.855 post=0.813 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=29 metric=0.9399 head_norm=1.792071
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.931550e-02
[S4] stored merged vector for next round verification (round=29)
[S4] DEBUG after merge:  round=29 metric=0.9399 head_norm=1.818524 delta_norm=0.089316
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=1.227483 cos_to_last_merge=0.9989 (last merge round=28)
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.6924163815365895, 'auprc': 0.7816008945039639, 'loss_val': 0.5241314047732472, 'psi': 0.7280901867235392}-{'f1_val': 0.8290908564123327, 'auprc': 0.8074831375081882, 'loss_val': 0.4817541271308829, 'psi': 0.8204477688506748}
[S3] START round=30 head_norm_before_train=1.978895 (no previous merge yet)
[S3] round=30 local utility u=0.000000 metrics={'f1_val': 0.9353108894608357, 'auprc': 0.9980217727143885, 'loss_val': 0.14572700798097069, 'psi': 0.9603952427622569}-{'f1_val': 0.9954205624364705, 'auprc': 0.9981240388560554, 'loss_val': 0.04056254839159061, 'psi': 0.9965019530043044}
[S4] START round=30 head_norm_before_train=1.818524 cos_to_last_merge=1.0000 (last merge round=29)
[S4] round=30 local utility u=0.000000 metrics={'f1_val': 0.8275723812349236, 'auprc': 0.9322805406091255, 'loss_val': 0.4086934736568352, 'psi': 0.8694556449846044}-{'f1_val': 0.9398537146882731, 'auprc': 0.9551396520950163, 'loss_val': 0.2620727395874906, 'psi': 0.9459680896509703}
[S5] START round=30 head_norm_before_train=1.924396 cos_to_last_merge=0.9993 (last merge round=25)
[S5] round=30 local utility u=0.000000 metrics={'f1_val': 0.7002451011760882, 'auprc': 0.9907532770008907, 'loss_val': 0.21304590395105677, 'psi': 0.8164483715060091}-{'f1_val': 0.700320598491359, 'auprc': 0.9935761699918093, 'loss_val': 0.18227072183826307, 'psi': 0.8176228270915391}
[S6] START round=30 head_norm_before_train=1.056224 cos_to_last_merge=0.9906 (last merge round=27)
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.7559058730033377, 'auprc': 0.8649400612227269, 'loss_val': 0.6030390352916977, 'psi': 0.7995195482910934}-{'f1_val': 0.9244324895114844, 'auprc': 0.9487551927087197, 'loss_val': 0.3790107000474836, 'psi': 0.9341615707903785}
[S7] START round=30 head_norm_before_train=1.162871 cos_to_last_merge=0.9995 (last merge round=28)
[S7] round=30 local utility u=0.000000 metrics={'f1_val': 0.6469130956656242, 'auprc': 0.8461493341310788, 'loss_val': 0.5975946102999098, 'psi': 0.726607591051806}-{'f1_val': 0.6858569497302991, 'auprc': 0.9235113870313136, 'loss_val': 0.467316110402387, 'psi': 0.780918724650705}
[S8] START round=30 head_norm_before_train=1.870658 (no previous merge yet)
[S8] round=30 local utility u=0.000098 metrics={'f1_val': 0.9931610516152387, 'auprc': 0.9857717435095559, 'loss_val': 0.051456890503763016, 'psi': 0.9902053283729656}-{'f1_val': 0.9932456999636199, 'auprc': 0.9857385247688057, 'loss_val': 0.05206078775857727, 'psi': 0.9902428298856942}
[S9] START round=30 head_norm_before_train=1.166488 cos_to_last_merge=0.9977 (last merge round=28)
[S9] round=30 local utility u=0.037057 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9914045555087699, 'loss_val': 0.11354696437208948, 'psi': 0.9943118790710745}-{'f1_val': 0.9895343037577012, 'auprc': 0.9961392582431272, 'loss_val': 0.16156953555454334, 'psi': 0.9921762855518717}
[S10] START round=30 head_norm_before_train=1.848917 cos_to_last_merge=0.9999 (last merge round=28)
[S10] round=30 local utility u=0.000240 metrics={'f1_val': 0.9940903254969471, 'auprc': 0.9952891416146394, 'loss_val': 0.04471768303694706, 'psi': 0.994569851944024}-{'f1_val': 0.993391017001491, 'auprc': 0.9974850253856853, 'loss_val': 0.04758955452120045, 'psi': 0.9950286203551687}
[S11] START round=30 head_norm_before_train=1.944359 cos_to_last_merge=1.0000 (last merge round=29)
[S11] round=30 local utility u=0.007352 metrics={'f1_val': 0.9967887165093644, 'auprc': 0.9979884365295393, 'loss_val': 0.059388209681731405, 'psi': 0.9972686045174344}-{'f1_val': 0.9963753869090841, 'auprc': 0.9977070203508885, 'loss_val': 0.07076788301109738, 'psi': 0.9969080402858059}
[S13] START round=30 head_norm_before_train=1.741208 cos_to_last_merge=1.0000 (last merge round=29)
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.6153104345596467, 'auprc': 0.7349219646588596, 'loss_val': 0.6857372324852355, 'psi': 0.6631550465993319}-{'f1_val': 0.6362472313129063, 'auprc': 0.6917644188868992, 'loss_val': 0.5467177178877114, 'psi': 0.6584541063425035}
[S14] START round=30 head_norm_before_train=1.855040 cos_to_last_merge=0.9979 (last merge round=25)
[S14] round=30 local utility u=0.004272 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9971430751405619, 'loss_val': 0.04334484127592744, 'psi': 0.9970557349508238}-{'f1_val': 0.9969975081576651, 'auprc': 0.996932815683968, 'loss_val': 0.051258042051383686, 'psi': 0.9969716311681862}
[S15] START round=30 head_norm_before_train=1.067437 cos_to_last_merge=1.0000 (last merge round=29)
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.7691375119380429, 'auprc': 0.9653100024545673, 'loss_val': 0.34948911659218584, 'psi': 0.8476065081446527}-{'f1_val': 0.8545029188849266, 'auprc': 0.990344834618299, 'loss_val': 0.24519278506077488, 'psi': 0.9088396851782756}
[S16] START round=30 head_norm_before_train=1.186084 cos_to_last_merge=1.0000 (last merge round=29)
[S16] round=30 local utility u=0.673773 metrics={'f1_val': 0.9897992763796466, 'auprc': 0.9858405693582676, 'loss_val': 0.14305558117129516, 'psi': 0.9882157935710949}-{'f1_val': 0.8449471692885077, 'auprc': 0.9881270520612592, 'loss_val': 0.6283482103586013, 'psi': 0.9022191223976083}
[S17] START round=30 head_norm_before_train=1.353360 cos_to_last_merge=0.9879 (last merge round=25)
[S17] round=30 local utility u=0.000000 metrics={'f1_val': 0.5412148809754673, 'auprc': 0.7532617046213939, 'loss_val': 0.7367788778029929, 'psi': 0.626033610433838}-{'f1_val': 0.5678987883271571, 'auprc': 0.757102933949457, 'loss_val': 0.6608089504887942, 'psi': 0.643580446576077}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:39003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:39002
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1801) from S9
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.226233)
[S2] loaded HEAD from S9 (vec_in norm=1.226233)
[S2] cosine check vs S9: cos=0.9146
[S2] BUFFERED delta from S9 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1800) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.882963)
[S3] loaded HEAD from S8 (vec_in norm=1.882963)
[S3] cosine check vs S8: cos=-0.0100
[S3] DROPPED delta from S8 (cos=-0.0100 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:39004
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1802 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1802) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.868554)
[S4] loaded HEAD from S10 (vec_in norm=1.868554)
[S4] cosine check vs S10: cos=0.9986
[S4] BUFFERED delta from S10 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:39011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:39017
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1802 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1802) from S14
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.874335)
[S10] loaded HEAD from S14 (vec_in norm=1.874335)
[S10] cosine check vs S14: cos=0.9967
[S10] BUFFERED delta from S14 (total buffered=1)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1796) from S16
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.228920)
[S17] loaded HEAD from S16 (vec_in norm=1.228920)
[S17] cosine check vs S16: cos=0.7434
[S17] BUFFERED delta from S16 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] ⇄ pheromone p=0.065 → S11@127.0.0.1:39012
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=30 metric=0.6924 head_norm=1.270585
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.588656e-01
[S2] stored merged vector for next round verification (round=30)
[S2] DEBUG after merge:  round=30 metric=0.6935 head_norm=1.221477 delta_norm=0.258866
[S2] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.065 → S7@127.0.0.1:39008
[S3]  timeout peer S2
[S2]  timeout peer S3
[S14] ⇄ pheromone p=0.017 → S10@127.0.0.1:39011
[S9] ⇄ pheromone p=0.052 → S2@127.0.0.1:39002
[S8] ⇄ pheromone p=0.044 → S3@127.0.0.1:39003
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=30 metric=0.9941 head_norm=1.868554
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.568801e-02
[S10] stored merged vector for next round verification (round=30)
[S10] DEBUG after merge:  round=30 metric=0.9943 head_norm=1.869915 delta_norm=0.075688
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.014 → S4@127.0.0.1:39004
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=30 metric=0.8276 head_norm=1.828426
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.329756e-02
[S4] stored merged vector for next round verification (round=30)
[S4] DEBUG after merge:  round=30 metric=0.8290 head_norm=1.847830 delta_norm=0.053298
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.041 → S13@127.0.0.1:39013
[S11] ⇄ pheromone p=0.106 → S5@127.0.0.1:39005
[S7] ⇄ pheromone p=0.346 → S16@127.0.0.1:39016
[S13] ⇄ pheromone p=0.067 → S4@127.0.0.1:39004
[S6] ⇄ pheromone p=0.246 → S15@127.0.0.1:39015
[S15] ⇄ pheromone p=0.189 → S9@127.0.0.1:39010
[S16] ⇄ pheromone p=0.287 → S7@127.0.0.1:39008
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=30 metric=0.5412 head_norm=1.382226
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.730785e-01
[S17] stored merged vector for next round verification (round=30)
[S17] DEBUG after merge:  round=30 metric=0.5445 head_norm=1.219260 delta_norm=0.473078
[S17] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.134 → S6@127.0.0.1:39007
[S2] START round=31 head_norm_before_train=1.221477 cos_to_last_merge=1.0000 (last merge round=30)
[S2] round=31 local utility u=0.210286 metrics={'f1_val': 0.7132277515141628, 'auprc': 0.8506475463419491, 'loss_val': 0.43556855664379607, 'psi': 0.7681956694452774}-{'f1_val': 0.6924163815365895, 'auprc': 0.7816008945039639, 'loss_val': 0.5241314047732472, 'psi': 0.7280901867235392}
[S3] START round=31 head_norm_before_train=1.993678 (no previous merge yet)
[S3] round=31 local utility u=0.245634 metrics={'f1_val': 0.9977814963782642, 'auprc': 0.9986503033517603, 'loss_val': 0.03116760586622712, 'psi': 0.9981290191676626}-{'f1_val': 0.9353108894608357, 'auprc': 0.9980217727143885, 'loss_val': 0.14572700798097069, 'psi': 0.9603952427622569}
[S4] START round=31 head_norm_before_train=1.847830 cos_to_last_merge=1.0000 (last merge round=30)
[S4] round=31 local utility u=0.421745 metrics={'f1_val': 0.9358664196541543, 'auprc': 0.9500752170563154, 'loss_val': 0.26835073968984785, 'psi': 0.9415499386150187}-{'f1_val': 0.8275723812349236, 'auprc': 0.9322805406091255, 'loss_val': 0.4086934736568352, 'psi': 0.8694556449846044}
[S5] START round=31 head_norm_before_train=1.934399 cos_to_last_merge=0.9989 (last merge round=25)
[S5] round=31 local utility u=0.000000 metrics={'f1_val': 0.7141078891838717, 'auprc': 0.8442350479114453, 'loss_val': 0.4367658805088715, 'psi': 0.7661587526749012}-{'f1_val': 0.7002451011760882, 'auprc': 0.9907532770008907, 'loss_val': 0.21304590395105677, 'psi': 0.8164483715060091}
[S6] START round=31 head_norm_before_train=1.113819 cos_to_last_merge=0.9810 (last merge round=27)
[S6] round=31 local utility u=0.107613 metrics={'f1_val': 0.7674462306409181, 'auprc': 0.8843135405322492, 'loss_val': 0.5151764707369526, 'psi': 0.8141931545974506}-{'f1_val': 0.7559058730033377, 'auprc': 0.8649400612227269, 'loss_val': 0.6030390352916977, 'psi': 0.7995195482910934}
[S7] START round=31 head_norm_before_train=1.179920 cos_to_last_merge=0.9985 (last merge round=28)
[S7] round=31 local utility u=0.000000 metrics={'f1_val': 0.4001582405215555, 'auprc': 0.7802953143602289, 'loss_val': 1.122059064029124, 'psi': 0.5522130700570249}-{'f1_val': 0.6469130956656242, 'auprc': 0.8461493341310788, 'loss_val': 0.5975946102999098, 'psi': 0.726607591051806}
[S8] START round=31 head_norm_before_train=1.882963 (no previous merge yet)
[S8] round=31 local utility u=0.021424 metrics={'f1_val': 0.9918109678295097, 'auprc': 0.9988944847791555, 'loss_val': 0.03987667083132183, 'psi': 0.994644374609368}-{'f1_val': 0.9931610516152387, 'auprc': 0.9857717435095559, 'loss_val': 0.051456890503763016, 'psi': 0.9902053283729656}
[S9] START round=31 head_norm_before_train=1.226233 cos_to_last_merge=0.9927 (last merge round=28)
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.8266333891894784, 'auprc': 0.9734060701014947, 'loss_val': 0.23675261035975276, 'psi': 0.8853424615542849}-{'f1_val': 0.9962500947792776, 'auprc': 0.9914045555087699, 'loss_val': 0.11354696437208948, 'psi': 0.9943118790710745}
[S10] START round=31 head_norm_before_train=1.869915 cos_to_last_merge=1.0000 (last merge round=30)
[S10] round=31 local utility u=0.002141 metrics={'f1_val': 0.993391017001491, 'auprc': 0.9975599668620709, 'loss_val': 0.043052629484085066, 'psi': 0.995058596945723}-{'f1_val': 0.9940903254969471, 'auprc': 0.9952891416146394, 'loss_val': 0.04471768303694706, 'psi': 0.994569851944024}
[S11] START round=31 head_norm_before_train=1.964861 cos_to_last_merge=0.9999 (last merge round=29)
[S11] round=31 local utility u=0.004096 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.998032561271487, 'loss_val': 0.04987885912345865, 'psi': 0.9971412272167486}-{'f1_val': 0.9967887165093644, 'auprc': 0.9979884365295393, 'loss_val': 0.059388209681731405, 'psi': 0.9972686045174344}
[S13] START round=31 head_norm_before_train=1.743550 cos_to_last_merge=0.9999 (last merge round=29)
[S13] round=31 local utility u=0.246149 metrics={'f1_val': 0.649228858313729, 'auprc': 0.763741499686275, 'loss_val': 0.48340811615031193, 'psi': 0.6950339148627475}-{'f1_val': 0.6153104345596467, 'auprc': 0.7349219646588596, 'loss_val': 0.6857372324852355, 'psi': 0.6631550465993319}
[S14] START round=31 head_norm_before_train=1.874335 cos_to_last_merge=0.9971 (last merge round=25)
[S14] round=31 local utility u=0.000000 metrics={'f1_val': 0.9926172140104469, 'auprc': 0.9965253969160595, 'loss_val': 0.05203951292685748, 'psi': 0.9941804871726919}-{'f1_val': 0.9969975081576651, 'auprc': 0.9971430751405619, 'loss_val': 0.04334484127592744, 'psi': 0.9970557349508238}
[S15] START round=31 head_norm_before_train=1.147531 cos_to_last_merge=0.9979 (last merge round=29)
[S15] round=31 local utility u=0.000000 metrics={'f1_val': 0.7057575950333851, 'auprc': 0.8669348421449299, 'loss_val': 0.42071109850396043, 'psi': 0.7702284938780031}-{'f1_val': 0.7691375119380429, 'auprc': 0.9653100024545673, 'loss_val': 0.34948911659218584, 'psi': 0.8476065081446527}
[S16] START round=31 head_norm_before_train=1.228920 cos_to_last_merge=0.9994 (last merge round=29)
[S16] round=31 local utility u=0.007858 metrics={'f1_val': 0.9897992763796466, 'auprc': 0.984006022344851, 'loss_val': 0.12183654078435252, 'psi': 0.9874819747657283}-{'f1_val': 0.9897992763796466, 'auprc': 0.9858405693582676, 'loss_val': 0.14305558117129516, 'psi': 0.9882157935710949}
[S17] START round=31 head_norm_before_train=1.219260 cos_to_last_merge=1.0000 (last merge round=30)
[S17] round=31 local utility u=0.136137 metrics={'f1_val': 0.5521070863032811, 'auprc': 0.801704926887327, 'loss_val': 0.6751885413023403, 'psi': 0.6519462225368995}-{'f1_val': 0.5412148809754673, 'auprc': 0.7532617046213939, 'loss_val': 0.7367788778029929, 'psi': 0.626033610433838}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:39009
[S3] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:39008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:39005
[S8] RECEIVED delta(kind=head bytes=1797) from S3
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=2.007278)
[S8] loaded HEAD from S3 (vec_in norm=2.007278)
[S8] cosine check vs S3: cos=-0.0103
[S8] DROPPED delta from S3 (cos=-0.0103 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:39013
[S2] sending update (kind=head size=1798 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1798) from S2
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.255997)
[S7] loaded HEAD from S2 (vec_in norm=1.255997)
[S7] cosine check vs S2: cos=0.8613
[S7] BUFFERED delta from S2 (total buffered=1)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:39015
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:39003
[S4] sending update (kind=head size=1801 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1801) from S4
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.858320)
[S13] loaded HEAD from S4 (vec_in norm=1.858320)
[S13] cosine check vs S4: cos=0.9879
[S13] BUFFERED delta from S4 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:39004
[S6] sending update (kind=head size=1803 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] RECEIVED delta(kind=head bytes=1803) from S6
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.169655)
[S15] loaded HEAD from S6 (vec_in norm=1.169655)
[S15] cosine check vs S6: cos=0.9300
[S15] BUFFERED delta from S6 (total buffered=1)
[S8] sending update (kind=head size=1798 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1798) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.894924)
[S3] loaded HEAD from S8 (vec_in norm=1.894924)
[S3] cosine check vs S8: cos=-0.0103
[S3] DROPPED delta from S8 (cos=-0.0103 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:39004
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:39008
[S13] sending update (kind=head size=1800 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1800) from S13
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.749131)
[S4] loaded HEAD from S13 (vec_in norm=1.749131)
[S4] cosine check vs S13: cos=0.9879
[S4] BUFFERED delta from S13 (total buffered=1)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1803) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.269549)
[S7] loaded HEAD from S16 (vec_in norm=1.269549)
[S7] cosine check vs S16: cos=0.9722
[S7] BUFFERED delta from S16 (total buffered=2)
[S4] RECEIVED delta(kind=head bytes=1802) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.887591)
[S4] loaded HEAD from S10 (vec_in norm=1.887591)
[S4] cosine check vs S10: cos=0.9985
[S4] BUFFERED delta from S10 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:39007
[S17] sending update (kind=head size=1798 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1798) from S17
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.249602)
[S6] loaded HEAD from S17 (vec_in norm=1.249602)
[S6] cosine check vs S17: cos=0.7813
[S6] BUFFERED delta from S17 (total buffered=1)
[S11] sending update (kind=head size=1802 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1802) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.988487)
[S5] loaded HEAD from S11 (vec_in norm=1.988487)
[S5] cosine check vs S11: cos=0.9981
[S5] BUFFERED delta from S11 (total buffered=1)
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=31 metric=0.4002 head_norm=1.193556
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.452536e-01
[S7] stored merged vector for next round verification (round=31)
[S7] DEBUG after merge:  round=31 metric=0.3995 head_norm=1.184622 delta_norm=0.145254
[S7] aggregate: ACCEPT kept=['S2', 'S16'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=31 metric=0.9359 head_norm=1.858320
[S4] _apply_head_vector_avg (torch): Δ‖w‖=6.466375e-02
[S4] stored merged vector for next round verification (round=31)
[S4] DEBUG after merge:  round=31 metric=0.9363 head_norm=1.833308 delta_norm=0.064664
[S4] aggregate: ACCEPT kept=['S13', 'S10'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=31 metric=0.7141 head_norm=1.942287
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.457310e-02
[S5] stored merged vector for next round verification (round=31)
[S5] DEBUG after merge:  round=31 metric=0.7141 head_norm=1.964462 delta_norm=0.064573
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=31 metric=0.6492 head_norm=1.749131
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.504327e-01
[S13] stored merged vector for next round verification (round=31)
[S13] DEBUG after merge:  round=31 metric=0.6541 head_norm=1.798271 delta_norm=0.150433
[S13] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=31 metric=0.7674 head_norm=1.169655
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.017542e-01
[S6] stored merged vector for next round verification (round=31)
[S6] DEBUG after merge:  round=31 metric=0.7674 head_norm=1.141662 delta_norm=0.401754
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=31 metric=0.7058 head_norm=1.211567
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.236718e-01
[S15] stored merged vector for next round verification (round=31)
[S15] DEBUG after merge:  round=31 metric=0.7010 head_norm=1.169600 delta_norm=0.223672
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=32 head_norm_before_train=1.255997 cos_to_last_merge=0.9995 (last merge round=30)
[S2] round=32 local utility u=0.217202 metrics={'f1_val': 0.7976267824214844, 'auprc': 0.8440592950576086, 'loss_val': 0.4877932485659389, 'psi': 0.8161997874759341}-{'f1_val': 0.7132277515141628, 'auprc': 0.8506475463419491, 'loss_val': 0.43556855664379607, 'psi': 0.7681956694452774}
[S3] START round=32 head_norm_before_train=2.007278 (no previous merge yet)
[S3] round=32 local utility u=0.001667 metrics={'f1_val': 0.9977814963782642, 'auprc': 0.9986736903512727, 'loss_val': 0.027903894843325908, 'psi': 0.9981383739674676}-{'f1_val': 0.9977814963782642, 'auprc': 0.9986503033517603, 'loss_val': 0.03116760586622712, 'psi': 0.9981290191676626}
[S4] START round=32 head_norm_before_train=1.833308 cos_to_last_merge=1.0000 (last merge round=31)
[S4] round=32 local utility u=0.036884 metrics={'f1_val': 0.9404436890943964, 'auprc': 0.9623972773569719, 'loss_val': 0.25901193334339195, 'psi': 0.9492251243994265}-{'f1_val': 0.9358664196541543, 'auprc': 0.9500752170563154, 'loss_val': 0.26835073968984785, 'psi': 0.9415499386150187}
[S5] START round=32 head_norm_before_train=1.964462 cos_to_last_merge=1.0000 (last merge round=31)
[S5] round=32 local utility u=0.266838 metrics={'f1_val': 0.7007116207970769, 'auprc': 0.9902211064683176, 'loss_val': 0.26067119272829503, 'psi': 0.8165154150655732}-{'f1_val': 0.7141078891838717, 'auprc': 0.8442350479114453, 'loss_val': 0.4367658805088715, 'psi': 0.7661587526749012}
[S6] START round=32 head_norm_before_train=1.141662 cos_to_last_merge=1.0000 (last merge round=31)
[S6] round=32 local utility u=0.265542 metrics={'f1_val': 0.8244970330303898, 'auprc': 0.901485808188576, 'loss_val': 0.3779145298994946, 'psi': 0.8552925430936643}-{'f1_val': 0.7674462306409181, 'auprc': 0.8843135405322492, 'loss_val': 0.5151764707369526, 'psi': 0.8141931545974506}
[S7] START round=32 head_norm_before_train=1.184622 cos_to_last_merge=1.0000 (last merge round=31)
[S7] round=32 local utility u=1.000000 metrics={'f1_val': 0.6997493224373046, 'auprc': 0.9970207094305811, 'loss_val': 0.39547184303502925, 'psi': 0.8186578772346151}-{'f1_val': 0.4001582405215555, 'auprc': 0.7802953143602289, 'loss_val': 1.122059064029124, 'psi': 0.5522130700570249}
[S8] START round=32 head_norm_before_train=1.894924 (no previous merge yet)
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.9934042750107773, 'auprc': 0.9935176241012078, 'loss_val': 0.03698443883869237, 'psi': 0.9934496146469495}-{'f1_val': 0.9918109678295097, 'auprc': 0.9988944847791555, 'loss_val': 0.03987667083132183, 'psi': 0.994644374609368}
[S9] START round=32 head_norm_before_train=1.280183 cos_to_last_merge=0.9870 (last merge round=28)
[S9] round=32 local utility u=0.623054 metrics={'f1_val': 0.9962461149658858, 'auprc': 0.9958984153348854, 'loss_val': 0.07579721828409862, 'psi': 0.9961070351134856}-{'f1_val': 0.8266333891894784, 'auprc': 0.9734060701014947, 'loss_val': 0.23675261035975276, 'psi': 0.8853424615542849}
[S10] START round=32 head_norm_before_train=1.887591 cos_to_last_merge=1.0000 (last merge round=30)
[S10] round=32 local utility u=0.000896 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9973036341412356, 'loss_val': 0.04074263391562799, 'psi': 0.9949810785490377}-{'f1_val': 0.993391017001491, 'auprc': 0.9975599668620709, 'loss_val': 0.043052629484085066, 'psi': 0.995058596945723}
[S11] START round=32 head_norm_before_train=1.988487 cos_to_last_merge=0.9997 (last merge round=29)
[S11] round=32 local utility u=0.002474 metrics={'f1_val': 0.9967894001465077, 'auprc': 0.9979843930863612, 'loss_val': 0.04624068398998368, 'psi': 0.9972673973224492}-{'f1_val': 0.9965470045135896, 'auprc': 0.998032561271487, 'loss_val': 0.04987885912345865, 'psi': 0.9971412272167486}
[S13] START round=32 head_norm_before_train=1.798271 cos_to_last_merge=1.0000 (last merge round=31)
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.6173425220918589, 'auprc': 0.770768195606794, 'loss_val': 0.6530180806214757, 'psi': 0.678712791497833}-{'f1_val': 0.649228858313729, 'auprc': 0.763741499686275, 'loss_val': 0.48340811615031193, 'psi': 0.6950339148627475}
[S14] START round=32 head_norm_before_train=1.891028 cos_to_last_merge=0.9962 (last merge round=25)
[S14] round=32 local utility u=0.021806 metrics={'f1_val': 0.9971882020035234, 'auprc': 0.9966126877822363, 'loss_val': 0.036115841985009965, 'psi': 0.9969579963150086}-{'f1_val': 0.9926172140104469, 'auprc': 0.9965253969160595, 'loss_val': 0.05203951292685748, 'psi': 0.9941804871726919}
[S15] START round=32 head_norm_before_train=1.169600 cos_to_last_merge=1.0000 (last merge round=31)
[S15] round=32 local utility u=0.444150 metrics={'f1_val': 0.7773180039064336, 'auprc': 0.9765850109858393, 'loss_val': 0.29072411495666245, 'psi': 0.8570248067381958}-{'f1_val': 0.7057575950333851, 'auprc': 0.8669348421449299, 'loss_val': 0.42071109850396043, 'psi': 0.7702284938780031}
[S16] START round=32 head_norm_before_train=1.269549 cos_to_last_merge=0.9980 (last merge round=29)
[S16] round=32 local utility u=0.000000 metrics={'f1_val': 0.9396600120890456, 'auprc': 0.9925525547369294, 'loss_val': 0.23648117705484895, 'psi': 0.9608170291481992}-{'f1_val': 0.9897992763796466, 'auprc': 0.984006022344851, 'loss_val': 0.12183654078435252, 'psi': 0.9874819747657283}
[S17] START round=32 head_norm_before_train=1.249602 cos_to_last_merge=0.9995 (last merge round=30)
[S17] round=32 local utility u=0.000000 metrics={'f1_val': 0.5062630259707837, 'auprc': 0.7202991549875648, 'loss_val': 0.8458492164594692, 'psi': 0.5918774775774961}-{'f1_val': 0.5521070863032811, 'auprc': 0.801704926887327, 'loss_val': 0.6751885413023403, 'psi': 0.6519462225368995}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:39009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:39008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:39007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:39015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S9] → sending delta(kind=head bytes=1806) to S15@127.0.0.1:39015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:39011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:39005
[S2] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:39013
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:39012
[S3] sending update (kind=head size=1796 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:39016
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:39004
[S7] RECEIVED delta(kind=head bytes=1798) from S2
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.289790)
[S7] loaded HEAD from S2 (vec_in norm=1.289790)
[S7] cosine check vs S2: cos=0.9051
[S7] BUFFERED delta from S2 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1796) from S3
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=2.019492)
[S8] loaded HEAD from S3 (vec_in norm=2.019492)
[S8] cosine check vs S3: cos=-0.0103
[S8] DROPPED delta from S3 (cos=-0.0103 < 0.0)
[S7] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1804 to 1 peers)
[S9] sending update (kind=head size=1806 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1803) from S7
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.195337)
[S16] loaded HEAD from S7 (vec_in norm=1.195337)
[S16] cosine check vs S7: cos=0.9623
[S16] BUFFERED delta from S7 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1804) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=2.014075)
[S5] loaded HEAD from S11 (vec_in norm=2.014075)
[S5] cosine check vs S11: cos=0.9989
[S5] BUFFERED delta from S11 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1803) from S6
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.183707)
[S15] loaded HEAD from S6 (vec_in norm=1.183707)
[S15] cosine check vs S6: cos=0.9223
[S15] BUFFERED delta from S6 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1800) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.904433)
[S4] loaded HEAD from S10 (vec_in norm=1.904433)
[S4] cosine check vs S10: cos=0.9975
[S4] BUFFERED delta from S10 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1799) from S14
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.904882)
[S10] loaded HEAD from S14 (vec_in norm=1.904882)
[S10] cosine check vs S14: cos=0.9981
[S10] BUFFERED delta from S14 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1806) from S9
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.315942)
[S15] loaded HEAD from S9 (vec_in norm=1.315942)
[S15] cosine check vs S9: cos=0.7235
[S15] BUFFERED delta from S9 (total buffered=2)
[S6] RECEIVED delta(kind=head bytes=1799) from S15
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.218686)
[S6] loaded HEAD from S15 (vec_in norm=1.218686)
[S6] cosine check vs S15: cos=0.9223
[S6] BUFFERED delta from S15 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1799) from S4
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.845083)
[S13] loaded HEAD from S4 (vec_in norm=1.845083)
[S13] cosine check vs S4: cos=0.9984
[S13] BUFFERED delta from S4 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1795) from S5
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.970673)
[S11] loaded HEAD from S5 (vec_in norm=1.970673)
[S11] cosine check vs S5: cos=0.9989
[S11] BUFFERED delta from S5 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=32 metric=0.6173 head_norm=1.804237
[S13] _apply_head_vector_avg (torch): Δ‖w‖=5.560936e-02
[S13] stored merged vector for next round verification (round=32)
[S13] DEBUG after merge:  round=32 metric=0.6175 head_norm=1.823926 delta_norm=0.055609
[S13] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=32 metric=0.8245 head_norm=1.183707
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.373238e-01
[S6] stored merged vector for next round verification (round=32)
[S6] DEBUG after merge:  round=32 metric=0.8238 head_norm=1.177649 delta_norm=0.237324
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=32 metric=0.9404 head_norm=1.845083
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.284943e-02
[S4] stored merged vector for next round verification (round=32)
[S4] DEBUG after merge:  round=32 metric=0.9404 head_norm=1.873577 delta_norm=0.072849
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=32 metric=0.7007 head_norm=1.970673
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.084640e-02
[S5] stored merged vector for next round verification (round=32)
[S5] DEBUG after merge:  round=32 metric=0.7007 head_norm=1.991843 delta_norm=0.050846
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=32 metric=0.9968 head_norm=2.014075
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.084639e-02
[S11] stored merged vector for next round verification (round=32)
[S11] DEBUG after merge:  round=32 metric=0.9968 head_norm=1.991843 delta_norm=0.050846
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=32 metric=0.9934 head_norm=1.904433
[S10] _apply_head_vector_avg (torch): Δ‖w‖=5.920780e-02
[S10] stored merged vector for next round verification (round=32)
[S10] DEBUG after merge:  round=32 metric=0.9934 head_norm=1.903737 delta_norm=0.059208
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=32 metric=0.6997 head_norm=1.195337
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.745426e-01
[S7] stored merged vector for next round verification (round=32)
[S7] DEBUG after merge:  round=32 metric=0.6997 head_norm=1.212774 delta_norm=0.274543
[S7] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=32 metric=0.7773 head_norm=1.218686
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.684895e-01
[S15] stored merged vector for next round verification (round=32)
[S15] DEBUG after merge:  round=32 metric=0.7782 head_norm=1.147831 delta_norm=0.268490
[S15] aggregate: ACCEPT kept=['S6', 'S9'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=32 metric=0.9397 head_norm=1.307442
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.805677e-01
[S16] stored merged vector for next round verification (round=32)
[S16] DEBUG after merge:  round=32 metric=0.9386 head_norm=1.239562 delta_norm=0.180568
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=33 head_norm_before_train=1.289790 cos_to_last_merge=0.9984 (last merge round=30)
[S2] round=33 local utility u=0.000000 metrics={'f1_val': 0.7163484468454702, 'auprc': 0.814634754488436, 'loss_val': 0.5325324622820761, 'psi': 0.7556629699026565}-{'f1_val': 0.7976267824214844, 'auprc': 0.8440592950576086, 'loss_val': 0.4877932485659389, 'psi': 0.8161997874759341}
[S3] START round=33 head_norm_before_train=2.019492 (no previous merge yet)
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.9612046783862453, 'auprc': 0.9978224542392898, 'loss_val': 0.09597384891440291, 'psi': 0.9758517887274631}-{'f1_val': 0.9977814963782642, 'auprc': 0.9986736903512727, 'loss_val': 0.027903894843325908, 'psi': 0.9981383739674676}
[S4] START round=33 head_norm_before_train=1.873577 cos_to_last_merge=1.0000 (last merge round=32)
[S4] round=33 local utility u=0.034702 metrics={'f1_val': 0.9485429408866122, 'auprc': 0.9665456694648937, 'loss_val': 0.25064850307753217, 'psi': 0.9557440323179248}-{'f1_val': 0.9404436890943964, 'auprc': 0.9623972773569719, 'loss_val': 0.25901193334339195, 'psi': 0.9492251243994265}
[S5] START round=33 head_norm_before_train=1.991843 cos_to_last_merge=1.0000 (last merge round=32)
[S5] round=33 local utility u=0.044919 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9945020558421133, 'loss_val': 0.18132962012172646, 'psi': 0.8179931814316608}-{'f1_val': 0.7007116207970769, 'auprc': 0.9902211064683176, 'loss_val': 0.26067119272829503, 'psi': 0.8165154150655732}
[S6] START round=33 head_norm_before_train=1.177649 cos_to_last_merge=1.0000 (last merge round=32)
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.7729719067259366, 'auprc': 0.8916701653590929, 'loss_val': 0.5012270104765373, 'psi': 0.8204512101791992}-{'f1_val': 0.8244970330303898, 'auprc': 0.901485808188576, 'loss_val': 0.3779145298994946, 'psi': 0.8552925430936643}
[S7] START round=33 head_norm_before_train=1.212774 cos_to_last_merge=1.0000 (last merge round=32)
[S7] round=33 local utility u=0.000000 metrics={'f1_val': 0.47133386889656587, 'auprc': 0.781936409505096, 'loss_val': 1.008683226284122, 'psi': 0.595574885139978}-{'f1_val': 0.6997493224373046, 'auprc': 0.9970207094305811, 'loss_val': 0.39547184303502925, 'psi': 0.8186578772346151}
[S8] START round=33 head_norm_before_train=1.907229 (no previous merge yet)
[S8] round=33 local utility u=0.000000 metrics={'f1_val': 0.9847869053219069, 'auprc': 0.9988134024953051, 'loss_val': 0.049819805277518864, 'psi': 0.9903975041912663}-{'f1_val': 0.9934042750107773, 'auprc': 0.9935176241012078, 'loss_val': 0.03698443883869237, 'psi': 0.9934496146469495}
[S9] START round=33 head_norm_before_train=1.315942 cos_to_last_merge=0.9830 (last merge round=28)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9912045984821521, 'loss_val': 0.0682967894964557, 'psi': 0.9942318962604274}-{'f1_val': 0.9962461149658858, 'auprc': 0.9958984153348854, 'loss_val': 0.07579721828409862, 'psi': 0.9961070351134856}
[S10] START round=33 head_norm_before_train=1.903737 cos_to_last_merge=1.0000 (last merge round=32)
[S10] round=33 local utility u=0.000731 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9949134919019592, 'loss_val': 0.04000492558629919, 'psi': 0.9948145622924072}-{'f1_val': 0.9934327081542391, 'auprc': 0.9973036341412356, 'loss_val': 0.04074263391562799, 'psi': 0.9949810785490377}
[S11] START round=33 head_norm_before_train=1.991843 cos_to_last_merge=1.0000 (last merge round=32)
[S11] round=33 local utility u=0.000000 metrics={'f1_val': 0.9902706029722889, 'auprc': 0.9958220111570206, 'loss_val': 0.12594890644464363, 'psi': 0.9924911662461816}-{'f1_val': 0.9967894001465077, 'auprc': 0.9979843930863612, 'loss_val': 0.04624068398998368, 'psi': 0.9972673973224492}
[S13] START round=33 head_norm_before_train=1.823926 cos_to_last_merge=1.0000 (last merge round=32)
[S13] round=33 local utility u=0.015337 metrics={'f1_val': 0.6279022115457166, 'auprc': 0.7484620408120937, 'loss_val': 0.6187842569571866, 'psi': 0.6761261432522674}-{'f1_val': 0.6173425220918589, 'auprc': 0.770768195606794, 'loss_val': 0.6530180806214757, 'psi': 0.678712791497833}
[S14] START round=33 head_norm_before_train=1.904882 cos_to_last_merge=0.9955 (last merge round=25)
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.9967774409524363, 'auprc': 0.9966080073635957, 'loss_val': 0.03506829414708087, 'psi': 0.9967096675169}-{'f1_val': 0.9971882020035234, 'auprc': 0.9966126877822363, 'loss_val': 0.036115841985009965, 'psi': 0.9969579963150086}
[S15] START round=33 head_norm_before_train=1.147831 cos_to_last_merge=1.0000 (last merge round=32)
[S15] round=33 local utility u=0.703019 metrics={'f1_val': 0.9826577691508264, 'auprc': 0.9946120372536001, 'loss_val': 0.1708057628121473, 'psi': 0.9874394763919359}-{'f1_val': 0.7773180039064336, 'auprc': 0.9765850109858393, 'loss_val': 0.29072411495666245, 'psi': 0.8570248067381958}
[S16] START round=33 head_norm_before_train=1.239562 cos_to_last_merge=1.0000 (last merge round=32)
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.9213042551166011, 'auprc': 0.9902941349512621, 'loss_val': 0.3747265711356798, 'psi': 0.9489002070504655}-{'f1_val': 0.9396600120890456, 'auprc': 0.9925525547369294, 'loss_val': 0.23648117705484895, 'psi': 0.9608170291481992}
[S17] START round=33 head_norm_before_train=1.280215 cos_to_last_merge=0.9980 (last merge round=30)
[S17] round=33 local utility u=0.000000 metrics={'f1_val': 0.5194932495865707, 'auprc': 0.6898073237049885, 'loss_val': 0.9343596339713347, 'psi': 0.5876188792339379}-{'f1_val': 0.5062630259707837, 'auprc': 0.7202991549875648, 'loss_val': 0.8458492164594692, 'psi': 0.5918774775774961}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:39012
[S5] sending update (kind=head size=1800 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1800) from S5
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.995772)
[S11] loaded HEAD from S5 (vec_in norm=1.995772)
[S11] cosine check vs S5: cos=0.9999
[S11] BUFFERED delta from S5 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:39004
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1801 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1801) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.918042)
[S4] loaded HEAD from S10 (vec_in norm=1.918042)
[S4] cosine check vs S10: cos=0.9985
[S4] BUFFERED delta from S10 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:39007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] → sending delta(kind=head bytes=1805) to S4@127.0.0.1:39004
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1805 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1805) from S13
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.829708)
[S4] loaded HEAD from S13 (vec_in norm=1.829708)
[S4] cosine check vs S13: cos=0.9977
[S4] BUFFERED delta from S13 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:39013
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1796 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1796) from S4
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.881549)
[S13] loaded HEAD from S4 (vec_in norm=1.881549)
[S13] cosine check vs S4: cos=0.9977
[S13] BUFFERED delta from S4 (total buffered=1)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1803 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1803) from S15
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.193793)
[S6] loaded HEAD from S15 (vec_in norm=1.193793)
[S6] cosine check vs S15: cos=0.9740
[S6] BUFFERED delta from S15 (total buffered=1)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=33 metric=0.7730 head_norm=1.215549
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.376562e-01
[S6] stored merged vector for next round verification (round=33)
[S6] DEBUG after merge:  round=33 metric=0.7730 head_norm=1.196829 delta_norm=0.137656
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=33 metric=0.9485 head_norm=1.881549
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.060021e-02
[S4] stored merged vector for next round verification (round=33)
[S4] DEBUG after merge:  round=33 metric=0.9485 head_norm=1.876032 delta_norm=0.020600
[S4] aggregate: ACCEPT kept=['S10', 'S13'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=33 metric=0.9903 head_norm=2.016066
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.964191e-02
[S11] stored merged vector for next round verification (round=33)
[S11] DEBUG after merge:  round=33 metric=0.9952 head_norm=2.005848 delta_norm=0.019642
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=33 metric=0.6279 head_norm=1.829708
[S13] _apply_head_vector_avg (torch): Δ‖w‖=6.841932e-02
[S13] stored merged vector for next round verification (round=33)
[S13] DEBUG after merge:  round=33 metric=0.6281 head_norm=1.854548 delta_norm=0.068419
[S13] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=34 head_norm_before_train=1.314540 cos_to_last_merge=0.9972 (last merge round=30)
[S2] round=34 local utility u=0.039865 metrics={'f1_val': 0.7088011741109066, 'auprc': 0.8227959504685416, 'loss_val': 0.43200198505773696, 'psi': 0.7543990846539605}-{'f1_val': 0.7163484468454702, 'auprc': 0.814634754488436, 'loss_val': 0.5325324622820761, 'psi': 0.7556629699026565}
[S3] START round=34 head_norm_before_train=2.029377 (no previous merge yet)
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.9600662304203449, 'auprc': 0.9982979885952293, 'loss_val': 0.13403135092332671, 'psi': 0.9753589336902986}-{'f1_val': 0.9612046783862453, 'auprc': 0.9978224542392898, 'loss_val': 0.09597384891440291, 'psi': 0.9758517887274631}
[S4] START round=34 head_norm_before_train=1.876032 cos_to_last_merge=1.0000 (last merge round=33)
[S4] round=34 local utility u=0.024023 metrics={'f1_val': 0.9555770368709848, 'auprc': 0.9658638270165993, 'loss_val': 0.24276068544155072, 'psi': 0.9596917529292306}-{'f1_val': 0.9485429408866122, 'auprc': 0.9665456694648937, 'loss_val': 0.25064850307753217, 'psi': 0.9557440323179248}
[S5] START round=34 head_norm_before_train=1.995772 cos_to_last_merge=1.0000 (last merge round=32)
[S5] round=34 local utility u=0.000000 metrics={'f1_val': 0.7041747159191594, 'auprc': 0.8562187873448016, 'loss_val': 0.2983986251240025, 'psi': 0.7649923444894162}-{'f1_val': 0.700320598491359, 'auprc': 0.9945020558421133, 'loss_val': 0.18132962012172646, 'psi': 0.8179931814316608}
[S6] START round=34 head_norm_before_train=1.196829 cos_to_last_merge=1.0000 (last merge round=33)
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.7189692992604557, 'auprc': 0.7046981723097095, 'loss_val': 0.7098290866929581, 'psi': 0.7132608484801573}-{'f1_val': 0.7729719067259366, 'auprc': 0.8916701653590929, 'loss_val': 0.5012270104765373, 'psi': 0.8204512101791992}
[S7] START round=34 head_norm_before_train=1.222349 cos_to_last_merge=0.9999 (last merge round=32)
[S7] round=34 local utility u=0.794064 metrics={'f1_val': 0.64369773842636, 'auprc': 0.8361147567222094, 'loss_val': 0.6172743625950404, 'psi': 0.7206645457446997}-{'f1_val': 0.47133386889656587, 'auprc': 0.781936409505096, 'loss_val': 1.008683226284122, 'psi': 0.595574885139978}
[S8] START round=34 head_norm_before_train=1.917967 (no previous merge yet)
[S8] round=34 local utility u=0.026730 metrics={'f1_val': 0.9918109678295097, 'auprc': 0.9987621805837591, 'loss_val': 0.038350231114120364, 'psi': 0.9945914529312094}-{'f1_val': 0.9847869053219069, 'auprc': 0.9988134024953051, 'loss_val': 0.049819805277518864, 'psi': 0.9903975041912663}
[S9] START round=34 head_norm_before_train=1.342953 cos_to_last_merge=0.9800 (last merge round=28)
[S9] round=34 local utility u=0.000000 metrics={'f1_val': 0.9878214512971564, 'auprc': 0.9903159187117976, 'loss_val': 0.07976289587444042, 'psi': 0.9888192382630129}-{'f1_val': 0.9962500947792776, 'auprc': 0.9912045984821521, 'loss_val': 0.0682967894964557, 'psi': 0.9942318962604274}
[S10] START round=34 head_norm_before_train=1.918042 cos_to_last_merge=1.0000 (last merge round=32)
[S10] round=34 local utility u=0.000164 metrics={'f1_val': 0.993391017001491, 'auprc': 0.9975207778380515, 'loss_val': 0.03935396764974299, 'psi': 0.9950429213361152}-{'f1_val': 0.9947486092193725, 'auprc': 0.9949134919019592, 'loss_val': 0.04000492558629919, 'psi': 0.9948145622924072}
[S11] START round=34 head_norm_before_train=2.005848 cos_to_last_merge=1.0000 (last merge round=33)
[S11] round=34 local utility u=0.063129 metrics={'f1_val': 0.9963760705462275, 'auprc': 0.9971241079101578, 'loss_val': 0.0402295843132656, 'psi': 0.9966752854917996}-{'f1_val': 0.9902706029722889, 'auprc': 0.9958220111570206, 'loss_val': 0.12594890644464363, 'psi': 0.9924911662461816}
[S13] START round=34 head_norm_before_train=1.854548 cos_to_last_merge=1.0000 (last merge round=33)
[S13] round=34 local utility u=0.000000 metrics={'f1_val': 0.5889134696415856, 'auprc': 0.7437666165016736, 'loss_val': 0.8180184402395413, 'psi': 0.6508547283856208}-{'f1_val': 0.6279022115457166, 'auprc': 0.7484620408120937, 'loss_val': 0.6187842569571866, 'psi': 0.6761261432522674}
[S14] START round=34 head_norm_before_train=1.919519 cos_to_last_merge=0.9947 (last merge round=25)
[S14] round=34 local utility u=0.003681 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9987287977814496, 'loss_val': 0.03292777756315304, 'psi': 0.99744385807903}-{'f1_val': 0.9967774409524363, 'auprc': 0.9966080073635957, 'loss_val': 0.03506829414708087, 'psi': 0.9967096675169}
[S15] START round=34 head_norm_before_train=1.193793 cos_to_last_merge=0.9992 (last merge round=32)
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.6970639330318791, 'auprc': 0.8294041798522253, 'loss_val': 0.4993989464304601, 'psi': 0.7500000317600175}-{'f1_val': 0.9826577691508264, 'auprc': 0.9946120372536001, 'loss_val': 0.1708057628121473, 'psi': 0.9874394763919359}
[S16] START round=34 head_norm_before_train=1.274397 cos_to_last_merge=0.9997 (last merge round=32)
[S16] round=34 local utility u=0.043027 metrics={'f1_val': 0.929474067825756, 'auprc': 0.9885804153576342, 'loss_val': 0.33255115789183, 'psi': 0.9531166068385073}-{'f1_val': 0.9213042551166011, 'auprc': 0.9902941349512621, 'loss_val': 0.3747265711356798, 'psi': 0.9489002070504655}
[S17] START round=34 head_norm_before_train=1.304292 cos_to_last_merge=0.9965 (last merge round=30)
[S17] round=34 local utility u=0.856887 metrics={'f1_val': 0.6761491811154854, 'auprc': 0.8703399703978919, 'loss_val': 0.7021192599299069, 'psi': 0.753825496828448}-{'f1_val': 0.5194932495865707, 'auprc': 0.6898073237049885, 'loss_val': 0.9343596339713347, 'psi': 0.5876188792339379}
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S16
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S11
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S8
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S16
[S9]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S15
[S17]  timeout peer S16
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S17
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:39004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:39005
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:39003
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:39013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:39011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:39008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:39016
[S7] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1804) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.306168)
[S7] loaded HEAD from S16 (vec_in norm=1.306168)
[S7] cosine check vs S16: cos=0.9316
[S7] BUFFERED delta from S16 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1801) from S4
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.878896)
[S13] loaded HEAD from S4 (vec_in norm=1.878896)
[S13] cosine check vs S4: cos=0.9992
[S13] BUFFERED delta from S4 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1804) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.932053)
[S4] loaded HEAD from S10 (vec_in norm=1.932053)
[S4] cosine check vs S10: cos=0.9984
[S4] BUFFERED delta from S10 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1798) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.930851)
[S3] loaded HEAD from S8 (vec_in norm=1.930851)
[S3] cosine check vs S8: cos=-0.0115
[S3] DROPPED delta from S8 (cos=-0.0115 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1802) from S7
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.234025)
[S16] loaded HEAD from S7 (vec_in norm=1.234025)
[S16] cosine check vs S7: cos=0.9316
[S16] BUFFERED delta from S7 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1803) from S14
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.932732)
[S10] loaded HEAD from S14 (vec_in norm=1.932732)
[S10] cosine check vs S14: cos=0.9987
[S10] BUFFERED delta from S14 (total buffered=1)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=34 metric=0.6437 head_norm=1.234025
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.375588e-01
[S7] stored merged vector for next round verification (round=34)
[S7] DEBUG after merge:  round=34 metric=0.6424 head_norm=1.248204 delta_norm=0.237559
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=34 metric=0.9556 head_norm=1.878896
[S4] _apply_head_vector_avg (torch): Δ‖w‖=6.011108e-02
[S4] stored merged vector for next round verification (round=34)
[S4] DEBUG after merge:  round=34 metric=0.9556 head_norm=1.904711 delta_norm=0.060111
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=34 metric=0.9934 head_norm=1.932053
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.895770e-02
[S10] stored merged vector for next round verification (round=34)
[S10] DEBUG after merge:  round=34 metric=0.9934 head_norm=1.931772 delta_norm=0.048958
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S17] → sending delta(kind=head bytes=1807) to S6@127.0.0.1:39007
[S17] sending update (kind=head size=1807 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1807) from S17
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.327398)
[S6] loaded HEAD from S17 (vec_in norm=1.327398)
[S6] cosine check vs S17: cos=0.8107
[S6] BUFFERED delta from S17 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:39008
[S2] sending update (kind=head size=1799 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1799) from S2
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.334219)
[S7] loaded HEAD from S2 (vec_in norm=1.334219)
[S7] cosine check vs S2: cos=0.9155
[S7] BUFFERED delta from S2 (total buffered=1)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=34 metric=0.9295 head_norm=1.306168
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.375588e-01
[S16] stored merged vector for next round verification (round=34)
[S16] DEBUG after merge:  round=34 metric=0.9255 head_norm=1.248204 delta_norm=0.237559
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S11] sending update (kind=head size=1803 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1803) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=2.030308)
[S5] loaded HEAD from S11 (vec_in norm=2.030308)
[S5] cosine check vs S11: cos=0.9998
[S5] BUFFERED delta from S11 (total buffered=1)
[S2] START round=35 head_norm_before_train=1.334219 cos_to_last_merge=0.9961 (last merge round=30)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.723179156343978, 'auprc': 0.7529861425309701, 'loss_val': 0.5014881141536829, 'psi': 0.7351019508187748}-{'f1_val': 0.7088011741109066, 'auprc': 0.8227959504685416, 'loss_val': 0.43200198505773696, 'psi': 0.7543990846539605}
[S3] START round=35 head_norm_before_train=2.036191 (no previous merge yet)
[S3] round=35 local utility u=0.164386 metrics={'f1_val': 0.9978100342676263, 'auprc': 0.9988550841273639, 'loss_val': 0.03339408782159943, 'psi': 0.9982280542115214}-{'f1_val': 0.9600662304203449, 'auprc': 0.9982979885952293, 'loss_val': 0.13403135092332671, 'psi': 0.9753589336902986}
[S4] START round=35 head_norm_before_train=1.904711 cos_to_last_merge=1.0000 (last merge round=34)
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.939302775903204, 'auprc': 0.9631647438767278, 'loss_val': 0.26824151029495946, 'psi': 0.9488475630926134}-{'f1_val': 0.9555770368709848, 'auprc': 0.9658638270165993, 'loss_val': 0.24276068544155072, 'psi': 0.9596917529292306}
[S5] START round=35 head_norm_before_train=1.999518 cos_to_last_merge=1.0000 (last merge round=32)
[S5] round=35 local utility u=0.265514 metrics={'f1_val': 0.7013562122871992, 'auprc': 0.9919655293164151, 'loss_val': 0.1576995405298487, 'psi': 0.8175999390988856}-{'f1_val': 0.7041747159191594, 'auprc': 0.8562187873448016, 'loss_val': 0.2983986251240025, 'psi': 0.7649923444894162}
[S6] START round=35 head_norm_before_train=1.227013 cos_to_last_merge=0.9996 (last merge round=33)
[S6] round=35 local utility u=0.526424 metrics={'f1_val': 0.7775248527996664, 'auprc': 0.8966333955078453, 'loss_val': 0.5841208090203787, 'psi': 0.825168269882938}-{'f1_val': 0.7189692992604557, 'auprc': 0.7046981723097095, 'loss_val': 0.7098290866929581, 'psi': 0.7132608484801573}
[S7] START round=35 head_norm_before_train=1.248204 cos_to_last_merge=1.0000 (last merge round=34)
[S7] round=35 local utility u=0.311996 metrics={'f1_val': 0.6842903756880672, 'auprc': 0.9049753307970217, 'loss_val': 0.4434198046931713, 'psi': 0.772564357731649}-{'f1_val': 0.64369773842636, 'auprc': 0.8361147567222094, 'loss_val': 0.6172743625950404, 'psi': 0.7206645457446997}
[S8] START round=35 head_norm_before_train=1.930851 (no previous merge yet)
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.9802638829985881, 'auprc': 0.9988460611865833, 'loss_val': 0.06074266104024725, 'psi': 0.9876967542737862}-{'f1_val': 0.9918109678295097, 'auprc': 0.9987621805837591, 'loss_val': 0.038350231114120364, 'psi': 0.9945914529312094}
[S9] START round=35 head_norm_before_train=1.368903 cos_to_last_merge=0.9772 (last merge round=28)
[S9] round=35 local utility u=0.043894 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9929633329405623, 'loss_val': 0.05560516902833894, 'psi': 0.9954470806835106}-{'f1_val': 0.9878214512971564, 'auprc': 0.9903159187117976, 'loss_val': 0.07976289587444042, 'psi': 0.9888192382630129}
[S10] START round=35 head_norm_before_train=1.931772 cos_to_last_merge=1.0000 (last merge round=34)
[S10] round=35 local utility u=0.000145 metrics={'f1_val': 0.993391017001491, 'auprc': 0.9974491145821616, 'loss_val': 0.03884800174435218, 'psi': 0.9950142560337591}-{'f1_val': 0.993391017001491, 'auprc': 0.9975207778380515, 'loss_val': 0.03935396764974299, 'psi': 0.9950429213361152}
[S11] START round=35 head_norm_before_train=2.030308 cos_to_last_merge=0.9999 (last merge round=33)
[S11] round=35 local utility u=0.005388 metrics={'f1_val': 0.9967887165093644, 'auprc': 0.9983224273541395, 'loss_val': 0.03552351406188976, 'psi': 0.9974022008472745}-{'f1_val': 0.9963760705462275, 'auprc': 0.9971241079101578, 'loss_val': 0.0402295843132656, 'psi': 0.9966752854917996}
[S13] START round=35 head_norm_before_train=1.864545 cos_to_last_merge=0.9999 (last merge round=33)
[S13] round=35 local utility u=0.228863 metrics={'f1_val': 0.6155074066506361, 'auprc': 0.7982438043676647, 'loss_val': 0.6832874810369733, 'psi': 0.6886019657374476}-{'f1_val': 0.5889134696415856, 'auprc': 0.7437666165016736, 'loss_val': 0.8180184402395413, 'psi': 0.6508547283856208}
[S14] START round=35 head_norm_before_train=1.932732 cos_to_last_merge=0.9940 (last merge round=25)
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.9969755000837764, 'auprc': 0.9968302863411023, 'loss_val': 0.030783913508336046, 'psi': 0.9969174145867068}-{'f1_val': 0.9965872316107504, 'auprc': 0.9987287977814496, 'loss_val': 0.03292777756315304, 'psi': 0.99744385807903}
[S15] START round=35 head_norm_before_train=1.243323 cos_to_last_merge=0.9973 (last merge round=32)
[S15] round=35 local utility u=1.000000 metrics={'f1_val': 0.9280177859388545, 'auprc': 0.9916063993548445, 'loss_val': 0.15786054055199353, 'psi': 0.9534532313052505}-{'f1_val': 0.6970639330318791, 'auprc': 0.8294041798522253, 'loss_val': 0.4993989464304601, 'psi': 0.7500000317600175}
[S16] START round=35 head_norm_before_train=1.248204 cos_to_last_merge=1.0000 (last merge round=34)
[S16] round=35 local utility u=0.009770 metrics={'f1_val': 0.9211794579051544, 'auprc': 0.9768988062355134, 'loss_val': 0.22819793128037916, 'psi': 0.9434671972372981}-{'f1_val': 0.929474067825756, 'auprc': 0.9885804153576342, 'loss_val': 0.33255115789183, 'psi': 0.9531166068385073}
[S17] START round=35 head_norm_before_train=1.327398 cos_to_last_merge=0.9949 (last merge round=30)
[S17] round=35 local utility u=0.000000 metrics={'f1_val': 0.5837980060445231, 'auprc': 0.856095792120716, 'loss_val': 0.8352333500752707, 'psi': 0.6927171204750002}-{'f1_val': 0.6761491811154854, 'auprc': 0.8703399703978919, 'loss_val': 0.7021192599299069, 'psi': 0.753825496828448}
[S11] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:39004
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] ⇄ pheromone p=0.021 → S3@127.0.0.1:39003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:39007
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.773)
[S14] ⇄ pheromone p=0.008 → S10@127.0.0.1:39011
[S13] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:39015
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.995)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:39012
[S11] ⇄ pheromone p=0.047 → S5@127.0.0.1:39005
[S4] RECEIVED delta(kind=head bytes=1803) from S13
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.872588)
[S4] loaded HEAD from S13 (vec_in norm=1.872588)
[S4] cosine check vs S13: cos=0.9971
[S4] BUFFERED delta from S13 (total buffered=1)
[S6] sending update (kind=head size=1800 to 1 peers)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=35 metric=0.6155 head_norm=1.872588
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.926447e-02
[S13] stored merged vector for next round verification (round=35)
[S13] DEBUG after merge:  round=35 metric=0.6157 head_norm=1.875097 delta_norm=0.049264
[S13] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.090 → S4@127.0.0.1:39004
[S15] sending update (kind=head size=1802 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1802) from S15
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.290734)
[S6] loaded HEAD from S15 (vec_in norm=1.290734)
[S6] cosine check vs S15: cos=0.9892
[S6] BUFFERED delta from S15 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1800) from S6
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.259250)
[S15] loaded HEAD from S6 (vec_in norm=1.259250)
[S15] cosine check vs S6: cos=0.9892
[S15] BUFFERED delta from S6 (total buffered=1)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=35 metric=0.6843 head_norm=1.267066
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.730731e-01
[S7] stored merged vector for next round verification (round=35)
[S7] DEBUG after merge:  round=35 metric=0.6851 head_norm=1.272096 delta_norm=0.273073
[S7] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.405 → S16@127.0.0.1:39016
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=35 metric=0.9393 head_norm=1.908509
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.428682e-02
[S4] stored merged vector for next round verification (round=35)
[S4] DEBUG after merge:  round=35 metric=0.9393 head_norm=1.889174 delta_norm=0.074287
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.060 → S13@127.0.0.1:39013
[S2] ⇄ pheromone p=0.067 → S7@127.0.0.1:39008
[S10] ⇄ pheromone p=0.005 → S4@127.0.0.1:39004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] → sending delta(kind=head bytes=1805) to S15@127.0.0.1:39015
[S16] not sending this round → trigger blocked (psi=0.943)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=35 metric=0.9280 head_norm=1.290734
[S15] _apply_head_vector_avg (torch): Δ‖w‖=9.520073e-02
[S15] stored merged vector for next round verification (round=35)
[S15] DEBUG after merge:  round=35 metric=0.9201 head_norm=1.271530 delta_norm=0.095201
[S15] aggregate: ROLLBACK (f1_val pre=0.928 post=0.920 tol_abs=0.005 tol_rel=0.0)
[S15] ⇄ pheromone p=0.397 → S6@127.0.0.1:39007
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=35 metric=0.7775 head_norm=1.259250
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.976665e-01
[S6] stored merged vector for next round verification (round=35)
[S6] DEBUG after merge:  round=35 metric=0.7766 head_norm=1.230127 delta_norm=0.197666
[S6] aggregate: ACCEPT kept=['S17', 'S15'] (k=2/2) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.222 → S15@127.0.0.1:39015
[S9] sending update (kind=head size=1805 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:39009
[S5] sending update (kind=head size=1796 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1796) from S5
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=2.003290)
[S11] loaded HEAD from S5 (vec_in norm=2.003290)
[S11] cosine check vs S5: cos=0.9995
[S11] BUFFERED delta from S5 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1805) from S9
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.392098)
[S15] loaded HEAD from S9 (vec_in norm=1.392098)
[S15] cosine check vs S9: cos=0.7724
[S15] BUFFERED delta from S9 (total buffered=1)
[S16] ⇄ pheromone p=0.104 → S7@127.0.0.1:39008
[S3] sending update (kind=head size=1796 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1796) from S3
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=2.039922)
[S8] loaded HEAD from S3 (vec_in norm=2.039922)
[S8] cosine check vs S3: cos=-0.0123
[S8] DROPPED delta from S3 (cos=-0.0123 < 0.0)
[S9] ⇄ pheromone p=0.090 → S15@127.0.0.1:39015
[S3] ⇄ pheromone p=0.077 → S8@127.0.0.1:39009
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=35 metric=0.7014 head_norm=2.003290
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.615046e-02
[S5] stored merged vector for next round verification (round=35)
[S5] DEBUG after merge:  round=35 metric=0.7025 head_norm=2.016675 delta_norm=0.026150
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.107 → S8@127.0.0.1:39009
[S17] ⇄ pheromone p=0.192 → S6@127.0.0.1:39007
[S2] START round=36 head_norm_before_train=1.353523 cos_to_last_merge=0.9950 (last merge round=30)
[S2] round=36 local utility u=0.195766 metrics={'f1_val': 0.708425003473132, 'auprc': 0.9052256000459669, 'loss_val': 0.4781495768400413, 'psi': 0.787145242102266}-{'f1_val': 0.723179156343978, 'auprc': 0.7529861425309701, 'loss_val': 0.5014881141536829, 'psi': 0.7351019508187748}
[S3] START round=36 head_norm_before_train=2.039922 (no previous merge yet)
[S3] round=36 local utility u=0.000000 metrics={'f1_val': 0.9620012470396173, 'auprc': 0.9987413658751176, 'loss_val': 0.0844223465646743, 'psi': 0.9766972945738174}-{'f1_val': 0.9978100342676263, 'auprc': 0.9988550841273639, 'loss_val': 0.03339408782159943, 'psi': 0.9982280542115214}
[S4] START round=36 head_norm_before_train=1.889174 cos_to_last_merge=1.0000 (last merge round=35)
[S4] round=36 local utility u=0.000000 metrics={'f1_val': 0.6235340446263791, 'auprc': 0.9381777087646852, 'loss_val': 0.7564278943115931, 'psi': 0.7493915102817015}-{'f1_val': 0.939302775903204, 'auprc': 0.9631647438767278, 'loss_val': 0.26824151029495946, 'psi': 0.9488475630926134}
[S5] START round=36 head_norm_before_train=2.016675 cos_to_last_merge=1.0000 (last merge round=35)
[S5] round=36 local utility u=0.000000 metrics={'f1_val': 0.7138808545923863, 'auprc': 0.8081567407111359, 'loss_val': 0.41918013766521256, 'psi': 0.7515912090398862}-{'f1_val': 0.7013562122871992, 'auprc': 0.9919655293164151, 'loss_val': 0.1576995405298487, 'psi': 0.8175999390988856}
[S6] START round=36 head_norm_before_train=1.230127 cos_to_last_merge=1.0000 (last merge round=35)
[S6] round=36 local utility u=0.632528 metrics={'f1_val': 0.9202351202252006, 'auprc': 0.9412378744566311, 'loss_val': 0.30914053924055956, 'psi': 0.9286362219177728}-{'f1_val': 0.7775248527996664, 'auprc': 0.8966333955078453, 'loss_val': 0.5841208090203787, 'psi': 0.825168269882938}
[S7] START round=36 head_norm_before_train=1.272096 cos_to_last_merge=1.0000 (last merge round=35)
[S7] round=36 local utility u=0.000000 metrics={'f1_val': 0.5037608538936748, 'auprc': 0.7903375723759218, 'loss_val': 0.8971851140317607, 'psi': 0.6183915412865736}-{'f1_val': 0.6842903756880672, 'auprc': 0.9049753307970217, 'loss_val': 0.4434198046931713, 'psi': 0.772564357731649}
[S8] START round=36 head_norm_before_train=1.945477 (no previous merge yet)
[S8] round=36 local utility u=0.044456 metrics={'f1_val': 0.9912267239616498, 'auprc': 0.9988834205117822, 'loss_val': 0.037720699004321935, 'psi': 0.9942894025817028}-{'f1_val': 0.9802638829985881, 'auprc': 0.9988460611865833, 'loss_val': 0.06074266104024725, 'psi': 0.9876967542737862}
[S9] START round=36 head_norm_before_train=1.392098 cos_to_last_merge=0.9746 (last merge round=28)
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9910618142268018, 'loss_val': 0.05241645463147071, 'psi': 0.994440220449578}-{'f1_val': 0.9971029125121428, 'auprc': 0.9929633329405623, 'loss_val': 0.05560516902833894, 'psi': 0.9954470806835106}
[S10] START round=36 head_norm_before_train=1.945932 cos_to_last_merge=1.0000 (last merge round=34)
[S10] round=36 local utility u=0.000000 metrics={'f1_val': 0.9943096789853013, 'auprc': 0.9948888949596923, 'loss_val': 0.036850921319692975, 'psi': 0.9945413653750577}-{'f1_val': 0.993391017001491, 'auprc': 0.9974491145821616, 'loss_val': 0.03884800174435218, 'psi': 0.9950142560337591}
[S11] START round=36 head_norm_before_train=2.053185 cos_to_last_merge=0.9997 (last merge round=33)
[S11] round=36 local utility u=0.000000 metrics={'f1_val': 0.9912817849077695, 'auprc': 0.998005630016669, 'loss_val': 0.04379170480678483, 'psi': 0.9939713229513293}-{'f1_val': 0.9967887165093644, 'auprc': 0.9983224273541395, 'loss_val': 0.03552351406188976, 'psi': 0.9974022008472745}
[S13] START round=36 head_norm_before_train=1.875097 cos_to_last_merge=1.0000 (last merge round=35)
[S13] round=36 local utility u=0.000000 metrics={'f1_val': 0.612244611313455, 'auprc': 0.7160949477901978, 'loss_val': 0.709229652065555, 'psi': 0.6537847459041521}-{'f1_val': 0.6155074066506361, 'auprc': 0.7982438043676647, 'loss_val': 0.6832874810369733, 'psi': 0.6886019657374476}
[S14] START round=36 head_norm_before_train=1.943415 cos_to_last_merge=0.9933 (last merge round=25)
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.9963442551067831, 'auprc': 0.9967131922375547, 'loss_val': 0.03258029796804685, 'psi': 0.9964918299590917}-{'f1_val': 0.9969755000837764, 'auprc': 0.9968302863411023, 'loss_val': 0.030783913508336046, 'psi': 0.9969174145867068}
[S15] START round=36 head_norm_before_train=1.271530 cos_to_last_merge=1.0000 (last merge round=35)
[S15] round=36 local utility u=0.000000 metrics={'f1_val': 0.7344910458858392, 'auprc': 0.860459482341433, 'loss_val': 0.46427908760177167, 'psi': 0.7848784204680768}-{'f1_val': 0.9280177859388545, 'auprc': 0.9916063993548445, 'loss_val': 0.15786054055199353, 'psi': 0.9534532313052505}
[S16] START round=36 head_norm_before_train=1.278331 cos_to_last_merge=0.9997 (last merge round=34)
[S16] round=36 local utility u=0.000000 metrics={'f1_val': 0.849421433408959, 'auprc': 0.9849741398482779, 'loss_val': 0.7037912902535212, 'psi': 0.9036425159846866}-{'f1_val': 0.9211794579051544, 'auprc': 0.9768988062355134, 'loss_val': 0.22819793128037916, 'psi': 0.9434671972372981}
[S17] START round=36 head_norm_before_train=1.346206 cos_to_last_merge=0.9934 (last merge round=30)
[S17] round=36 local utility u=0.160191 metrics={'f1_val': 0.5962523815589844, 'auprc': 0.9249063954825902, 'loss_val': 0.7960100235783304, 'psi': 0.7277139871284268}-{'f1_val': 0.5837980060445231, 'auprc': 0.856095792120716, 'loss_val': 0.8352333500752707, 'psi': 0.6927171204750002}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:39003
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1794 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=36 metric=0.9913 head_norm=2.071403
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.470764e-02
[S11] stored merged vector for next round verification (round=36)
[S11] DEBUG after merge:  round=36 metric=0.9913 head_norm=2.036897 delta_norm=0.054708
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] → sending delta(kind=head bytes=1805) to S7@127.0.0.1:39008
[S3] RECEIVED delta(kind=head bytes=1794) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.958581)
[S3] loaded HEAD from S8 (vec_in norm=1.958581)
[S3] cosine check vs S8: cos=-0.0127
[S3] DROPPED delta from S8 (cos=-0.0127 < 0.0)
[S2] sending update (kind=head size=1805 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1805) from S2
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.378400)
[S7] loaded HEAD from S2 (vec_in norm=1.378400)
[S7] cosine check vs S2: cos=0.9743
[S7] BUFFERED delta from S2 (total buffered=1)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.929)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=36 metric=0.5038 head_norm=1.291133
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.572568e-01
[S7] stored merged vector for next round verification (round=36)
[S7] DEBUG after merge:  round=36 metric=0.4938 head_norm=1.326188 delta_norm=0.157257
[S7] aggregate: ROLLBACK (f1_val pre=0.504 post=0.494 tol_abs=0.005 tol_rel=0.0)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:39007
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=36 metric=0.7345 head_norm=1.314110
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.633431e-01
[S15] stored merged vector for next round verification (round=36)
[S15] DEBUG after merge:  round=36 metric=0.7478 head_norm=1.271898 delta_norm=0.463343
[S15] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S17] sending update (kind=head size=1799 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1799) from S17
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.364855)
[S6] loaded HEAD from S17 (vec_in norm=1.364855)
[S6] cosine check vs S17: cos=0.8728
[S6] BUFFERED delta from S17 (total buffered=1)
[S2] START round=37 head_norm_before_train=1.378400 cos_to_last_merge=0.9934 (last merge round=30)
[S2] round=37 local utility u=0.211483 metrics={'f1_val': 0.826152663990327, 'auprc': 0.79787039317776, 'loss_val': 0.4394836708064269, 'psi': 0.8148397556653002}-{'f1_val': 0.708425003473132, 'auprc': 0.9052256000459669, 'loss_val': 0.4781495768400413, 'psi': 0.787145242102266}
[S3] START round=37 head_norm_before_train=2.047340 (no previous merge yet)
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.9615785680382265, 'auprc': 0.9988539124307372, 'loss_val': 0.10304727528057703, 'psi': 0.9764887057952307}-{'f1_val': 0.9620012470396173, 'auprc': 0.9987413658751176, 'loss_val': 0.0844223465646743, 'psi': 0.9766972945738174}
[S4] START round=37 head_norm_before_train=1.892967 cos_to_last_merge=1.0000 (last merge round=35)
[S4] round=37 local utility u=1.000000 metrics={'f1_val': 0.9405086947039634, 'auprc': 0.9657469365520956, 'loss_val': 0.26560740372234676, 'psi': 0.9506039914432163}-{'f1_val': 0.6235340446263791, 'auprc': 0.9381777087646852, 'loss_val': 0.7564278943115931, 'psi': 0.7493915102817015}
[S5] START round=37 head_norm_before_train=2.020552 cos_to_last_merge=1.0000 (last merge round=35)
[S5] round=37 local utility u=0.370106 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9947554833842902, 'loss_val': 0.15740339897066036, 'psi': 0.8180945524485315}-{'f1_val': 0.7138808545923863, 'auprc': 0.8081567407111359, 'loss_val': 0.41918013766521256, 'psi': 0.7515912090398862}
[S6] START round=37 head_norm_before_train=1.257346 cos_to_last_merge=0.9997 (last merge round=35)
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.7556657616316902, 'auprc': 0.7511679192690213, 'loss_val': 0.6354314008893094, 'psi': 0.7538666246866226}-{'f1_val': 0.9202351202252006, 'auprc': 0.9412378744566311, 'loss_val': 0.30914053924055956, 'psi': 0.9286362219177728}
[S7] START round=37 head_norm_before_train=1.326188 cos_to_last_merge=1.0000 (last merge round=36)
[S7] round=37 local utility u=0.929074 metrics={'f1_val': 0.6811565557722068, 'auprc': 0.916096232377541, 'loss_val': 0.48068714179098104, 'psi': 0.7751324264143404}-{'f1_val': 0.5037608538936748, 'auprc': 0.7903375723759218, 'loss_val': 0.8971851140317607, 'psi': 0.6183915412865736}
[S8] START round=37 head_norm_before_train=1.958581 (no previous merge yet)
[S8] round=37 local utility u=0.002515 metrics={'f1_val': 0.9919528555747477, 'auprc': 0.998712404851151, 'loss_val': 0.03653503353616162, 'psi': 0.994656675285309}-{'f1_val': 0.9912267239616498, 'auprc': 0.9988834205117822, 'loss_val': 0.037720699004321935, 'psi': 0.9942894025817028}
[S9] START round=37 head_norm_before_train=1.411710 cos_to_last_merge=0.9724 (last merge round=28)
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.9232968813495784, 'auprc': 0.9770997089333975, 'loss_val': 0.1374270514065484, 'psi': 0.944818012383106}-{'f1_val': 0.9966924912647621, 'auprc': 0.9910618142268018, 'loss_val': 0.05241645463147071, 'psi': 0.994440220449578}
[S10] START round=37 head_norm_before_train=1.959083 cos_to_last_merge=0.9999 (last merge round=34)
[S10] round=37 local utility u=0.000000 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9960888954374676, 'loss_val': 0.036697183390248606, 'psi': 0.9944951830675306}-{'f1_val': 0.9943096789853013, 'auprc': 0.9948888949596923, 'loss_val': 0.036850921319692975, 'psi': 0.9945413653750577}
[S11] START round=37 head_norm_before_train=2.036897 cos_to_last_merge=1.0000 (last merge round=36)
[S11] round=37 local utility u=0.019443 metrics={'f1_val': 0.9963753869090841, 'auprc': 0.9973076243148001, 'loss_val': 0.03337302432126401, 'psi': 0.9967482818713705}-{'f1_val': 0.9912817849077695, 'auprc': 0.998005630016669, 'loss_val': 0.04379170480678483, 'psi': 0.9939713229513293}
[S13] START round=37 head_norm_before_train=1.881292 cos_to_last_merge=1.0000 (last merge round=35)
[S13] round=37 local utility u=0.049970 metrics={'f1_val': 0.6283192101579813, 'auprc': 0.6903883242329477, 'loss_val': 0.6286181838757556, 'psi': 0.6531468557879678}-{'f1_val': 0.612244611313455, 'auprc': 0.7160949477901978, 'loss_val': 0.709229652065555, 'psi': 0.6537847459041521}
[S14] START round=37 head_norm_before_train=1.952959 cos_to_last_merge=0.9928 (last merge round=25)
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.9963442551067831, 'auprc': 0.9967332242434586, 'loss_val': 0.032662393454952525, 'psi': 0.9964998427614533}-{'f1_val': 0.9963442551067831, 'auprc': 0.9967131922375547, 'loss_val': 0.03258029796804685, 'psi': 0.9964918299590917}
[S15] START round=37 head_norm_before_train=1.271898 cos_to_last_merge=1.0000 (last merge round=36)
[S15] round=37 local utility u=1.000000 metrics={'f1_val': 0.9735356258372438, 'auprc': 0.9914107984101216, 'loss_val': 0.16482067878437745, 'psi': 0.980685694866395}-{'f1_val': 0.7344910458858392, 'auprc': 0.860459482341433, 'loss_val': 0.46427908760177167, 'psi': 0.7848784204680768}
[S16] START round=37 head_norm_before_train=1.309000 cos_to_last_merge=0.9987 (last merge round=34)
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.8433484866410265, 'auprc': 0.9832432216769506, 'loss_val': 0.7664625270692376, 'psi': 0.899306380655396}-{'f1_val': 0.849421433408959, 'auprc': 0.9849741398482779, 'loss_val': 0.7037912902535212, 'psi': 0.9036425159846866}
[S17] START round=37 head_norm_before_train=1.364855 cos_to_last_merge=0.9918 (last merge round=30)
[S17] round=37 local utility u=0.000000 metrics={'f1_val': 0.5485093927458873, 'auprc': 0.7083279162656667, 'loss_val': 1.0018283605855278, 'psi': 0.6124368021537991}-{'f1_val': 0.5962523815589844, 'auprc': 0.9249063954825902, 'loss_val': 0.7960100235783304, 'psi': 0.7277139871284268}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:39004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:39005
[S8] not sending this round → trigger blocked (psi=0.995)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:39007
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:39009
[S11] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:39013
[S5] RECEIVED delta(kind=head bytes=1801) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=2.054370)
[S5] loaded HEAD from S11 (vec_in norm=2.054370)
[S5] cosine check vs S11: cos=0.9997
[S5] BUFFERED delta from S11 (total buffered=1)
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1797) from S5
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=2.024466)
[S8] loaded HEAD from S5 (vec_in norm=2.024466)
[S8] cosine check vs S5: cos=-0.0153
[S8] DROPPED delta from S5 (cos=-0.0153 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1803) from S15
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.311891)
[S6] loaded HEAD from S15 (vec_in norm=1.311891)
[S6] cosine check vs S15: cos=0.9169
[S6] BUFFERED delta from S15 (total buffered=2)
[S13] RECEIVED delta(kind=head bytes=1798) from S4
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.894888)
[S13] loaded HEAD from S4 (vec_in norm=1.894888)
[S13] cosine check vs S4: cos=0.9997
[S13] BUFFERED delta from S4 (total buffered=1)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=37 metric=0.7003 head_norm=2.024466
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.813445e-02
[S5] stored merged vector for next round verification (round=37)
[S5] DEBUG after merge:  round=37 metric=0.7003 head_norm=2.039279 delta_norm=0.028134
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=37 metric=0.7557 head_norm=1.289168
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.776741e-01
[S6] stored merged vector for next round verification (round=37)
[S6] DEBUG after merge:  round=37 metric=0.7530 head_norm=1.251899 delta_norm=0.177674
[S6] aggregate: ACCEPT kept=['S17', 'S15'] (k=2/2) mode=median trim_p=0.1
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:39016
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1801 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1801) from S7
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.341089)
[S16] loaded HEAD from S7 (vec_in norm=1.341089)
[S16] cosine check vs S7: cos=0.9386
[S16] BUFFERED delta from S7 (total buffered=1)
[S13] sending update (kind=head size=1803 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1803) from S13
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.886106)
[S4] loaded HEAD from S13 (vec_in norm=1.886106)
[S4] cosine check vs S13: cos=0.9997
[S4] BUFFERED delta from S13 (total buffered=1)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.815)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=37 metric=0.6283 head_norm=1.886106
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.479944e-02
[S13] stored merged vector for next round verification (round=37)
[S13] DEBUG after merge:  round=37 metric=0.6285 head_norm=1.890340 delta_norm=0.024799
[S13] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=37 metric=0.9405 head_norm=1.894888
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.479944e-02
[S4] stored merged vector for next round verification (round=37)
[S4] DEBUG after merge:  round=37 metric=0.9405 head_norm=1.890340 delta_norm=0.024799
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=37 metric=0.8433 head_norm=1.339726
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.349461e-01
[S16] stored merged vector for next round verification (round=37)
[S16] DEBUG after merge:  round=37 metric=0.8431 head_norm=1.319656 delta_norm=0.234946
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=38 head_norm_before_train=1.398968 cos_to_last_merge=0.9921 (last merge round=30)
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.7304451541070449, 'auprc': 0.7948334601628334, 'loss_val': 0.6375230123293367, 'psi': 0.7562004765293604}-{'f1_val': 0.826152663990327, 'auprc': 0.79787039317776, 'loss_val': 0.4394836708064269, 'psi': 0.8148397556653002}
[S3] START round=38 head_norm_before_train=2.056765 (no previous merge yet)
[S3] round=38 local utility u=0.013555 metrics={'f1_val': 0.9620012470396173, 'auprc': 0.9988530997622032, 'loss_val': 0.07847100614493012, 'psi': 0.9767419881286517}-{'f1_val': 0.9615785680382265, 'auprc': 0.9988539124307372, 'loss_val': 0.10304727528057703, 'psi': 0.9764887057952307}
[S4] START round=38 head_norm_before_train=1.890340 cos_to_last_merge=1.0000 (last merge round=37)
[S4] round=38 local utility u=0.005588 metrics={'f1_val': 0.9410619172241415, 'auprc': 0.9685525621161754, 'loss_val': 0.2661684387141039, 'psi': 0.9520581751809549}-{'f1_val': 0.9405086947039634, 'auprc': 0.9657469365520956, 'loss_val': 0.26560740372234676, 'psi': 0.9506039914432163}
[S5] START round=38 head_norm_before_train=2.039279 cos_to_last_merge=1.0000 (last merge round=37)
[S5] round=38 local utility u=0.000000 metrics={'f1_val': 0.7139470373384927, 'auprc': 0.7933621807003501, 'loss_val': 0.5103402662137702, 'psi': 0.7457130946832358}-{'f1_val': 0.700320598491359, 'auprc': 0.9947554833842902, 'loss_val': 0.15740339897066036, 'psi': 0.8180945524485315}
[S6] START round=38 head_norm_before_train=1.251899 cos_to_last_merge=1.0000 (last merge round=37)
[S6] round=38 local utility u=0.757311 metrics={'f1_val': 0.8823886840366734, 'auprc': 0.9124830849389267, 'loss_val': 0.3650925842967863, 'psi': 0.8944264443975747}-{'f1_val': 0.7556657616316902, 'auprc': 0.7511679192690213, 'loss_val': 0.6354314008893094, 'psi': 0.7538666246866226}
[S7] START round=38 head_norm_before_train=1.341089 cos_to_last_merge=0.9998 (last merge round=36)
[S7] round=38 local utility u=0.000000 metrics={'f1_val': 0.6290980600817069, 'auprc': 0.8331457230168047, 'loss_val': 0.633125467458825, 'psi': 0.710717125255746}-{'f1_val': 0.6811565557722068, 'auprc': 0.916096232377541, 'loss_val': 0.48068714179098104, 'psi': 0.7751324264143404}
[S8] START round=38 head_norm_before_train=1.970348 (no previous merge yet)
[S8] round=38 local utility u=0.000482 metrics={'f1_val': 0.9919528555747477, 'auprc': 0.998695834978122, 'loss_val': 0.03552127693357319, 'psi': 0.9946500473360973}-{'f1_val': 0.9919528555747477, 'auprc': 0.998712404851151, 'loss_val': 0.03653503353616162, 'psi': 0.994656675285309}
[S9] START round=38 head_norm_before_train=1.429849 cos_to_last_merge=0.9704 (last merge round=28)
[S9] round=38 local utility u=0.289472 metrics={'f1_val': 0.9962461149658858, 'auprc': 0.9931682224301367, 'loss_val': 0.04438469015768049, 'psi': 0.9950149579515861}-{'f1_val': 0.9232968813495784, 'auprc': 0.9770997089333975, 'loss_val': 0.1374270514065484, 'psi': 0.944818012383106}
[S10] START round=38 head_norm_before_train=1.970754 cos_to_last_merge=0.9998 (last merge round=34)
[S10] round=38 local utility u=0.000989 metrics={'f1_val': 0.9931720938432163, 'auprc': 0.9972990690475139, 'loss_val': 0.036785199914410045, 'psi': 0.9948228839249353}-{'f1_val': 0.9934327081542391, 'auprc': 0.9960888954374676, 'loss_val': 0.036697183390248606, 'psi': 0.9944951830675306}
[S11] START round=38 head_norm_before_train=2.054370 cos_to_last_merge=0.9999 (last merge round=36)
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.9963753869090841, 'auprc': 0.997394089321353, 'loss_val': 0.03754567519597519, 'psi': 0.9967828678739916}-{'f1_val': 0.9963753869090841, 'auprc': 0.9973076243148001, 'loss_val': 0.03337302432126401, 'psi': 0.9967482818713705}
[S13] START round=38 head_norm_before_train=1.890340 cos_to_last_merge=1.0000 (last merge round=37)
[S13] round=38 local utility u=0.132035 metrics={'f1_val': 0.6343790387628929, 'auprc': 0.7348868638617579, 'loss_val': 0.5344028964658099, 'psi': 0.6745821688024389}-{'f1_val': 0.6283192101579813, 'auprc': 0.6903883242329477, 'loss_val': 0.6286181838757556, 'psi': 0.6531468557879678}
[S14] START round=38 head_norm_before_train=1.964028 cos_to_last_merge=0.9921 (last merge round=25)
[S14] round=38 local utility u=0.000258 metrics={'f1_val': 0.9969755000837764, 'auprc': 0.9964944695411408, 'loss_val': 0.03521817858370449, 'psi': 0.9967830878667222}-{'f1_val': 0.9963442551067831, 'auprc': 0.9967332242434586, 'loss_val': 0.032662393454952525, 'psi': 0.9964998427614533}
[S15] START round=38 head_norm_before_train=1.311891 cos_to_last_merge=0.9995 (last merge round=36)
[S15] round=38 local utility u=0.000000 metrics={'f1_val': 0.7416908097366601, 'auprc': 0.9854231648649204, 'loss_val': 0.41468981086485684, 'psi': 0.8391837517879642}-{'f1_val': 0.9735356258372438, 'auprc': 0.9914107984101216, 'loss_val': 0.16482067878437745, 'psi': 0.980685694866395}
[S16] START round=38 head_norm_before_train=1.319656 cos_to_last_merge=1.0000 (last merge round=37)
[S16] round=38 local utility u=0.054494 metrics={'f1_val': 0.832086060488423, 'auprc': 0.9565929273299348, 'loss_val': 0.5099489580562957, 'psi': 0.8818888072250277}-{'f1_val': 0.8433484866410265, 'auprc': 0.9832432216769506, 'loss_val': 0.7664625270692376, 'psi': 0.899306380655396}
[S17] START round=38 head_norm_before_train=1.382066 cos_to_last_merge=0.9903 (last merge round=30)
[S17] round=38 local utility u=0.316917 metrics={'f1_val': 0.599872212332799, 'auprc': 0.7786287081046439, 'loss_val': 0.8870735192698035, 'psi': 0.6713748106415369}-{'f1_val': 0.5485093927458873, 'auprc': 0.7083279162656667, 'loss_val': 1.0018283605855278, 'psi': 0.6124368021537991}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.675)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:39011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:39003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:39009
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1798 to 1 peers)
[S4] not sending this round → trigger blocked (psi=0.952)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:39004
[S14] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:39015
[S10] RECEIVED delta(kind=head bytes=1802) from S14
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.971403)
[S10] loaded HEAD from S14 (vec_in norm=1.971403)
[S10] cosine check vs S14: cos=0.9984
[S10] BUFFERED delta from S14 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1798) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.982231)
[S3] loaded HEAD from S8 (vec_in norm=1.982231)
[S3] cosine check vs S8: cos=-0.0126
[S3] DROPPED delta from S8 (cos=-0.0126 < 0.0)
[S6] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1800) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.982925)
[S4] loaded HEAD from S10 (vec_in norm=1.982925)
[S4] cosine check vs S10: cos=0.9961
[S4] BUFFERED delta from S10 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1802) from S6
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.287297)
[S15] loaded HEAD from S6 (vec_in norm=1.287297)
[S15] cosine check vs S6: cos=0.9306
[S15] BUFFERED delta from S6 (total buffered=1)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=38 metric=0.9411 head_norm=1.894107
[S4] _apply_head_vector_avg (torch): Δ‖w‖=9.660259e-02
[S4] stored merged vector for next round verification (round=38)
[S4] DEBUG after merge:  round=38 metric=0.9411 head_norm=1.936617 delta_norm=0.096603
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=38 metric=0.9932 head_norm=1.982925
[S10] _apply_head_vector_avg (torch): Δ‖w‖=5.592686e-02
[S10] stored merged vector for next round verification (round=38)
[S10] DEBUG after merge:  round=38 metric=0.9934 head_norm=1.976381 delta_norm=0.055927
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1796 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1796) from S3
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=2.068750)
[S8] loaded HEAD from S3 (vec_in norm=2.068750)
[S8] cosine check vs S3: cos=-0.0126
[S8] DROPPED delta from S3 (cos=-0.0126 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:39008
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1800 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1800) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.348256)
[S7] loaded HEAD from S16 (vec_in norm=1.348256)
[S7] cosine check vs S16: cos=0.9815
[S7] BUFFERED delta from S16 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:39007
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:39015
[S17] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1800) from S9
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.446631)
[S15] loaded HEAD from S9 (vec_in norm=1.446631)
[S15] cosine check vs S9: cos=0.9212
[S15] BUFFERED delta from S9 (total buffered=2)
[S6] RECEIVED delta(kind=head bytes=1802) from S17
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.398157)
[S6] loaded HEAD from S17 (vec_in norm=1.398157)
[S6] cosine check vs S17: cos=0.8938
[S6] BUFFERED delta from S17 (total buffered=1)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=38 metric=0.6291 head_norm=1.356639
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.302714e-01
[S7] stored merged vector for next round verification (round=38)
[S7] DEBUG after merge:  round=38 metric=0.6225 head_norm=1.346165 delta_norm=0.130271
[S7] aggregate: ROLLBACK (f1_val pre=0.629 post=0.622 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=38 metric=0.7417 head_norm=1.352275
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.200653e-01
[S15] stored merged vector for next round verification (round=38)
[S15] DEBUG after merge:  round=38 metric=0.7417 head_norm=1.313567 delta_norm=0.120065
[S15] aggregate: ACCEPT kept=['S6', 'S9'] (k=2/2) mode=median trim_p=0.1
[S2] START round=39 head_norm_before_train=1.415980 cos_to_last_merge=0.9910 (last merge round=30)
[S2] round=39 local utility u=0.182411 metrics={'f1_val': 0.7115137502732839, 'auprc': 0.8928621914350634, 'loss_val': 0.45319792353652627, 'psi': 0.7840531267379958}-{'f1_val': 0.7304451541070449, 'auprc': 0.7948334601628334, 'loss_val': 0.6375230123293367, 'psi': 0.7562004765293604}
[S3] START round=39 head_norm_before_train=2.068750 (no previous merge yet)
[S3] round=39 local utility u=0.017729 metrics={'f1_val': 0.9727978228450531, 'auprc': 0.9988537689845204, 'loss_val': 0.10779388245061647, 'psi': 0.98322020130084}-{'f1_val': 0.9620012470396173, 'auprc': 0.9988530997622032, 'loss_val': 0.07847100614493012, 'psi': 0.9767419881286517}
[S4] START round=39 head_norm_before_train=1.936617 cos_to_last_merge=1.0000 (last merge round=38)
[S4] round=39 local utility u=0.043195 metrics={'f1_val': 0.9524829523539506, 'auprc': 0.969245890493888, 'loss_val': 0.2503843041411321, 'psi': 0.9591881276099256}-{'f1_val': 0.9410619172241415, 'auprc': 0.9685525621161754, 'loss_val': 0.2661684387141039, 'psi': 0.9520581751809549}
[S5] START round=39 head_norm_before_train=2.042534 cos_to_last_merge=1.0000 (last merge round=37)
[S5] round=39 local utility u=0.438988 metrics={'f1_val': 0.7000725525005456, 'auprc': 0.9955150500533825, 'loss_val': 0.15557676015432292, 'psi': 0.8182495515216803}-{'f1_val': 0.7139470373384927, 'auprc': 0.7933621807003501, 'loss_val': 0.5103402662137702, 'psi': 0.7457130946832358}
[S6] START round=39 head_norm_before_train=1.287297 cos_to_last_merge=0.9994 (last merge round=37)
[S6] round=39 local utility u=0.000000 metrics={'f1_val': 0.7666664853373215, 'auprc': 0.9166559461779409, 'loss_val': 0.5736410878291383, 'psi': 0.8266622696735693}-{'f1_val': 0.8823886840366734, 'auprc': 0.9124830849389267, 'loss_val': 0.3650925842967863, 'psi': 0.8944264443975747}
[S7] START round=39 head_norm_before_train=1.346165 cos_to_last_merge=1.0000 (last merge round=38)
[S7] round=39 local utility u=0.013943 metrics={'f1_val': 0.6332802359045698, 'auprc': 0.8255205245710523, 'loss_val': 0.6074572768341268, 'psi': 0.7101763513711628}-{'f1_val': 0.6290980600817069, 'auprc': 0.8331457230168047, 'loss_val': 0.633125467458825, 'psi': 0.710717125255746}
[S8] START round=39 head_norm_before_train=1.982231 (no previous merge yet)
[S8] round=39 local utility u=0.000000 metrics={'f1_val': 0.9932456999636199, 'auprc': 0.9937087068451762, 'loss_val': 0.03527223612486806, 'psi': 0.9934309027162425}-{'f1_val': 0.9919528555747477, 'auprc': 0.998695834978122, 'loss_val': 0.03552127693357319, 'psi': 0.9946500473360973}
[S9] START round=39 head_norm_before_train=1.446631 cos_to_last_merge=0.9686 (last merge round=28)
[S9] round=39 local utility u=0.003449 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9948998101309814, 'loss_val': 0.04270617166038618, 'psi': 0.9957099809199591}-{'f1_val': 0.9962461149658858, 'auprc': 0.9931682224301367, 'loss_val': 0.04438469015768049, 'psi': 0.9950149579515861}
[S10] START round=39 head_norm_before_train=1.976381 cos_to_last_merge=1.0000 (last merge round=38)
[S10] round=39 local utility u=0.000134 metrics={'f1_val': 0.993871046050545, 'auprc': 0.9955888853908313, 'loss_val': 0.0355802476665935, 'psi': 0.9945581817866596}-{'f1_val': 0.9931720938432163, 'auprc': 0.9972990690475139, 'loss_val': 0.036785199914410045, 'psi': 0.9948228839249353}
[S11] START round=39 head_norm_before_train=2.072806 cos_to_last_merge=0.9998 (last merge round=36)
[S11] round=39 local utility u=0.002563 metrics={'f1_val': 0.9966169742661891, 'auprc': 0.997585665311166, 'loss_val': 0.0344442786966939, 'psi': 0.9970044506841798}-{'f1_val': 0.9963753869090841, 'auprc': 0.997394089321353, 'loss_val': 0.03754567519597519, 'psi': 0.9967828678739916}
[S13] START round=39 head_norm_before_train=1.892038 cos_to_last_merge=1.0000 (last merge round=37)
[S13] round=39 local utility u=0.000000 metrics={'f1_val': 0.6002776765083424, 'auprc': 0.7170934645644383, 'loss_val': 0.7832838185913275, 'psi': 0.6470039917307808}-{'f1_val': 0.6343790387628929, 'auprc': 0.7348868638617579, 'loss_val': 0.5344028964658099, 'psi': 0.6745821688024389}
[S14] START round=39 head_norm_before_train=1.971403 cos_to_last_merge=0.9917 (last merge round=25)
[S14] round=39 local utility u=0.007894 metrics={'f1_val': 0.9969981421187261, 'auprc': 0.9990474914079388, 'loss_val': 0.027224557861326062, 'psi': 0.9978178818344112}-{'f1_val': 0.9969755000837764, 'auprc': 0.9964944695411408, 'loss_val': 0.03521817858370449, 'psi': 0.9967830878667222}
[S15] START round=39 head_norm_before_train=1.313567 cos_to_last_merge=1.0000 (last merge round=38)
[S15] round=39 local utility u=0.110509 metrics={'f1_val': 0.7742211202993871, 'auprc': 0.9822297863697351, 'loss_val': 0.3792733209467624, 'psi': 0.8574245867275263}-{'f1_val': 0.7416908097366601, 'auprc': 0.9854231648649204, 'loss_val': 0.41468981086485684, 'psi': 0.8391837517879642}
[S16] START round=39 head_norm_before_train=1.348256 cos_to_last_merge=0.9997 (last merge round=37)
[S16] round=39 local utility u=0.735608 metrics={'f1_val': 0.991069678885818, 'auprc': 0.9908924630820322, 'loss_val': 0.09553390568652018, 'psi': 0.9909987925643036}-{'f1_val': 0.832086060488423, 'auprc': 0.9565929273299348, 'loss_val': 0.5099489580562957, 'psi': 0.8818888072250277}
[S17] START round=39 head_norm_before_train=1.398157 cos_to_last_merge=0.9889 (last merge round=30)
[S17] round=39 local utility u=0.000000 metrics={'f1_val': 0.5399689582983394, 'auprc': 0.7166306828726937, 'loss_val': 1.1119880019580324, 'psi': 0.6106336481280811}-{'f1_val': 0.599872212332799, 'auprc': 0.7786287081046439, 'loss_val': 0.8870735192698035, 'psi': 0.6713748106415369}
[S14] not sending this round → trigger blocked (psi=0.998)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.983)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:39005
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:39007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:39013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:39009
[S11] sending update (kind=head size=1801 to 1 peers)
[S8] r=40 psi=0.993 u=0.0000 p_local=0.0134 f1=0.993 auprc=0.994 bytes=48517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:39008
[S3] r=40 psi=0.983 u=0.0177 p_local=0.0371 f1=0.973 auprc=0.999 bytes=41384
[S13] r=40 psi=0.647 u=0.0000 p_local=0.0644 f1=0.600 auprc=0.717 bytes=34223
[S14] r=40 psi=0.998 u=0.0079 p_local=0.0051 f1=0.997 auprc=0.999 bytes=46761
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:39016
[S10] not sending this round → trigger blocked (psi=0.995)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] RECEIVED delta(kind=head bytes=1801) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=2.087396)
[S5] loaded HEAD from S11 (vec_in norm=2.087396)
[S5] cosine check vs S11: cos=0.9996
[S5] BUFFERED delta from S11 (total buffered=1)
[S5] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1804 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S11] r=40 psi=0.997 u=0.0026 p_local=0.0221 f1=0.997 auprc=0.998 bytes=44979
[S6] RECEIVED delta(kind=head bytes=1800) from S15
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.353145)
[S6] loaded HEAD from S15 (vec_in norm=1.353145)
[S6] cosine check vs S15: cos=0.9367
[S6] BUFFERED delta from S15 (total buffered=2)
[S13] RECEIVED delta(kind=head bytes=1802) from S4
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.941140)
[S13] loaded HEAD from S4 (vec_in norm=1.941140)
[S13] cosine check vs S4: cos=0.9985
[S13] BUFFERED delta from S4 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1804) from S7
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.366361)
[S16] loaded HEAD from S7 (vec_in norm=1.366361)
[S16] cosine check vs S7: cos=0.9929
[S16] BUFFERED delta from S7 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1798) from S2
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.433932)
[S7] loaded HEAD from S2 (vec_in norm=1.433932)
[S7] cosine check vs S2: cos=0.9713
[S7] BUFFERED delta from S2 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1799) from S5
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=2.045118)
[S8] loaded HEAD from S5 (vec_in norm=2.045118)
[S8] cosine check vs S5: cos=-0.0157
[S8] DROPPED delta from S5 (cos=-0.0157 < 0.0)
[S10] r=40 psi=0.995 u=0.0001 p_local=0.0022 f1=0.994 auprc=0.996 bytes=46783
[S4] r=40 psi=0.959 u=0.0432 p_local=0.1622 f1=0.952 auprc=0.969 bytes=43183
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=39 metric=0.7001 head_norm=2.045118
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.716897e-02
[S5] stored merged vector for next round verification (round=39)
[S5] DEBUG after merge:  round=39 metric=0.7001 head_norm=2.066031 delta_norm=0.037169
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] r=40 psi=0.818 u=0.4390 p_local=0.1791 f1=0.700 auprc=0.996 bytes=41359
[S2] r=40 psi=0.784 u=0.1824 p_local=0.1110 f1=0.712 auprc=0.893 bytes=43163
[S15] r=40 psi=0.857 u=0.1105 p_local=0.3128 f1=0.774 auprc=0.982 bytes=41341
[S9] not sending this round → trigger blocked (psi=0.996)
[S16] not sending this round → trigger blocked (psi=0.991)
[S9] r=40 psi=0.996 u=0.0034 p_local=0.0837 f1=0.996 auprc=0.995 bytes=43154
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=39 metric=0.7667 head_norm=1.321302
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.389468e-01
[S6] stored merged vector for next round verification (round=39)
[S6] DEBUG after merge:  round=39 metric=0.7641 head_norm=1.294186 delta_norm=0.138947
[S6] aggregate: ACCEPT kept=['S17', 'S15'] (k=2/2) mode=median trim_p=0.1
[S6] r=40 psi=0.827 u=0.0000 p_local=0.2768 f1=0.767 auprc=0.917 bytes=34140
[S17] r=40 psi=0.611 u=0.0000 p_local=0.1458 f1=0.540 auprc=0.717 bytes=34181
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=39 metric=0.6333 head_norm=1.366361
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.710273e-01
[S7] stored merged vector for next round verification (round=39)
[S7] DEBUG after merge:  round=39 metric=0.6278 head_norm=1.390072 delta_norm=0.171027
[S7] aggregate: ROLLBACK (f1_val pre=0.633 post=0.628 tol_abs=0.005 tol_rel=0.0)
[S7] r=40 psi=0.710 u=0.0139 p_local=0.2876 f1=0.633 auprc=0.826 bytes=35973
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=39 metric=0.9911 head_norm=1.375412
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.179708e-02
[S16] stored merged vector for next round verification (round=39)
[S16] DEBUG after merge:  round=39 metric=0.9909 head_norm=1.368451 delta_norm=0.081797
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] r=40 psi=0.991 u=0.7356 p_local=0.1982 f1=0.991 auprc=0.991 bytes=35963
[S2] START round=40 head_norm_before_train=1.433932 cos_to_last_merge=0.9898 (last merge round=30)
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.665037583843032, 'auprc': 0.7509763466643201, 'loss_val': 0.646155387177849, 'psi': 0.6994130889715473}-{'f1_val': 0.7115137502732839, 'auprc': 0.8928621914350634, 'loss_val': 0.45319792353652627, 'psi': 0.7840531267379958}
[S3] START round=40 head_norm_before_train=2.080867 (no previous merge yet)
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.9611152572344858, 'auprc': 0.9989147782414338, 'loss_val': 0.12045633505476167, 'psi': 0.9762350656372649}-{'f1_val': 0.9727978228450531, 'auprc': 0.9988537689845204, 'loss_val': 0.10779388245061647, 'psi': 0.98322020130084}
[S4] START round=40 head_norm_before_train=1.941140 cos_to_last_merge=1.0000 (last merge round=38)
[S4] round=40 local utility u=0.000000 metrics={'f1_val': 0.9415327917725721, 'auprc': 0.9685396299200224, 'loss_val': 0.2710102089405676, 'psi': 0.9523355270315522}-{'f1_val': 0.9524829523539506, 'auprc': 0.969245890493888, 'loss_val': 0.2503843041411321, 'psi': 0.9591881276099256}
[S5] START round=40 head_norm_before_train=2.066031 cos_to_last_merge=1.0000 (last merge round=39)
[S5] round=40 local utility u=0.000000 metrics={'f1_val': 0.7004887085110637, 'auprc': 0.9903312117830826, 'loss_val': 0.19550247526109854, 'psi': 0.8164257098198713}-{'f1_val': 0.7000725525005456, 'auprc': 0.9955150500533825, 'loss_val': 0.15557676015432292, 'psi': 0.8182495515216803}
[S6] START round=40 head_norm_before_train=1.294186 cos_to_last_merge=1.0000 (last merge round=39)
[S6] round=40 local utility u=0.000000 metrics={'f1_val': 0.6030633986785406, 'auprc': 0.6813432937245114, 'loss_val': 0.841279298791234, 'psi': 0.634375356696929}-{'f1_val': 0.7666664853373215, 'auprc': 0.9166559461779409, 'loss_val': 0.5736410878291383, 'psi': 0.8266622696735693}
[S7] START round=40 head_norm_before_train=1.390072 cos_to_last_merge=1.0000 (last merge round=39)
[S7] round=40 local utility u=0.000000 metrics={'f1_val': 0.5918704884179168, 'auprc': 0.7987553715168082, 'loss_val': 0.7435307462143274, 'psi': 0.6746244416574734}-{'f1_val': 0.6332802359045698, 'auprc': 0.8255205245710523, 'loss_val': 0.6074572768341268, 'psi': 0.7101763513711628}
[S8] START round=40 head_norm_before_train=1.993639 (no previous merge yet)
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.982001271692374, 'auprc': 0.9989164413914793, 'loss_val': 0.05732379465989332, 'psi': 0.988767339572016}-{'f1_val': 0.9932456999636199, 'auprc': 0.9937087068451762, 'loss_val': 0.03527223612486806, 'psi': 0.9934309027162425}
[S9] START round=40 head_norm_before_train=1.464219 cos_to_last_merge=0.9667 (last merge round=28)
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.9941961205231895, 'auprc': 0.9950679288106745, 'loss_val': 0.04339266506801584, 'psi': 0.9945448438381835}-{'f1_val': 0.9962500947792776, 'auprc': 0.9948998101309814, 'loss_val': 0.04270617166038618, 'psi': 0.9957099809199591}
[S10] START round=40 head_norm_before_train=1.988537 cos_to_last_merge=1.0000 (last merge round=38)
[S10] round=40 local utility u=0.000000 metrics={'f1_val': 0.9936518403636662, 'auprc': 0.9959113688031718, 'loss_val': 0.03526470512224483, 'psi': 0.9945556517394684}-{'f1_val': 0.993871046050545, 'auprc': 0.9955888853908313, 'loss_val': 0.0355802476665935, 'psi': 0.9945581817866596}
[S11] START round=40 head_norm_before_train=2.087396 cos_to_last_merge=0.9996 (last merge round=36)
[S11] round=40 local utility u=0.001123 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9976574227754508, 'loss_val': 0.02951293152363139, 'psi': 0.9967431740581659}-{'f1_val': 0.9966169742661891, 'auprc': 0.997585665311166, 'loss_val': 0.0344442786966939, 'psi': 0.9970044506841798}
[S13] START round=40 head_norm_before_train=1.898841 cos_to_last_merge=0.9999 (last merge round=37)
[S13] round=40 local utility u=0.000000 metrics={'f1_val': 0.5908284900358002, 'auprc': 0.657250923636095, 'loss_val': 0.8687312393638923, 'psi': 0.6173974634759181}-{'f1_val': 0.6002776765083424, 'auprc': 0.7170934645644383, 'loss_val': 0.7832838185913275, 'psi': 0.6470039917307808}
[S14] START round=40 head_norm_before_train=1.978299 cos_to_last_merge=0.9912 (last merge round=25)
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.9963442551067831, 'auprc': 0.9967496949975685, 'loss_val': 0.031007564644803226, 'psi': 0.9965064310630972}-{'f1_val': 0.9969981421187261, 'auprc': 0.9990474914079388, 'loss_val': 0.027224557861326062, 'psi': 0.9978178818344112}
[S15] START round=40 head_norm_before_train=1.353145 cos_to_last_merge=0.9994 (last merge round=38)
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.7679821296150723, 'auprc': 0.9893990481335377, 'loss_val': 0.37905051174612625, 'psi': 0.8565488970224584}-{'f1_val': 0.7742211202993871, 'auprc': 0.9822297863697351, 'loss_val': 0.3792733209467624, 'psi': 0.8574245867275263}
[S16] START round=40 head_norm_before_train=1.368451 cos_to_last_merge=1.0000 (last merge round=39)
[S16] round=40 local utility u=0.000000 metrics={'f1_val': 0.8327368091806433, 'auprc': 0.8385319927456872, 'loss_val': 0.8998246761755352, 'psi': 0.8350548826066608}-{'f1_val': 0.991069678885818, 'auprc': 0.9908924630820322, 'loss_val': 0.09553390568652018, 'psi': 0.9909987925643036}
[S17] START round=40 head_norm_before_train=1.412990 cos_to_last_merge=0.9877 (last merge round=30)
[S17] round=40 local utility u=1.000000 metrics={'f1_val': 0.755793932117961, 'auprc': 0.9584379892173965, 'loss_val': 0.656824584158727, 'psi': 0.8368515549577352}-{'f1_val': 0.5399689582983394, 'auprc': 0.7166306828726937, 'loss_val': 1.1119880019580324, 'psi': 0.6106336481280811}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:39005
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=40 metric=0.5908 head_norm=1.903354
[S13] _apply_head_vector_avg (torch): Δ‖w‖=5.985573e-02
[S13] stored merged vector for next round verification (round=40)
[S13] DEBUG after merge:  round=40 metric=0.5912 head_norm=1.921407 delta_norm=0.059856
[S13] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.052 → S4@127.0.0.1:39004
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] ⇄ pheromone p=0.004 → S10@127.0.0.1:39011
[S11] sending update (kind=head size=1796 to 1 peers)
[S8] ⇄ pheromone p=0.011 → S3@127.0.0.1:39003
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] ⇄ pheromone p=0.030 → S8@127.0.0.1:39009
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] RECEIVED delta(kind=head bytes=1796) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=2.101904)
[S5] loaded HEAD from S11 (vec_in norm=2.101904)
[S5] cosine check vs S11: cos=0.9998
[S5] BUFFERED delta from S11 (total buffered=1)
[S11] ⇄ pheromone p=0.018 → S5@127.0.0.1:39005
[S10] ⇄ pheromone p=0.002 → S4@127.0.0.1:39004
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=40 metric=0.7005 head_norm=2.068690
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.812025e-02
[S5] stored merged vector for next round verification (round=40)
[S5] DEBUG after merge:  round=40 metric=0.7006 head_norm=2.085174 delta_norm=0.028120
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.143 → S8@127.0.0.1:39009
[S6] ⇄ pheromone p=0.221 → S15@127.0.0.1:39015
[S4] ⇄ pheromone p=0.130 → S13@127.0.0.1:39013
[S15] ⇄ pheromone p=0.250 → S6@127.0.0.1:39007
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] ⇄ pheromone p=0.089 → S7@127.0.0.1:39008
[S9] ⇄ pheromone p=0.067 → S15@127.0.0.1:39015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:39007
[S17] sending update (kind=head size=1800 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1800) from S17
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.425171)
[S6] loaded HEAD from S17 (vec_in norm=1.425171)
[S6] cosine check vs S17: cos=0.9075
[S6] BUFFERED delta from S17 (total buffered=1)
[S7] ⇄ pheromone p=0.230 → S16@127.0.0.1:39016
[S17] ⇄ pheromone p=0.317 → S6@127.0.0.1:39007
[S16] ⇄ pheromone p=0.159 → S17@127.0.0.1:39017
[S2] START round=41 head_norm_before_train=1.450742 cos_to_last_merge=0.9886 (last merge round=30)
[S2] round=41 local utility u=0.293912 metrics={'f1_val': 0.7151537313771934, 'auprc': 0.8411890270047367, 'loss_val': 0.6296671201414356, 'psi': 0.7655678496282108}-{'f1_val': 0.665037583843032, 'auprc': 0.7509763466643201, 'loss_val': 0.646155387177849, 'psi': 0.6994130889715473}
[S3] START round=41 head_norm_before_train=2.094543 (no previous merge yet)
[S3] round=41 local utility u=0.137827 metrics={'f1_val': 0.9923851879828639, 'auprc': 0.9987948026261144, 'loss_val': 0.03206158931775312, 'psi': 0.9949490338401641}-{'f1_val': 0.9611152572344858, 'auprc': 0.9989147782414338, 'loss_val': 0.12045633505476167, 'psi': 0.9762350656372649}
[S4] START round=41 head_norm_before_train=1.946150 cos_to_last_merge=0.9999 (last merge round=38)
[S4] round=41 local utility u=0.003643 metrics={'f1_val': 0.9422714396630361, 'auprc': 0.968973618715748, 'loss_val': 0.2694580129727052, 'psi': 0.952952311284121}-{'f1_val': 0.9415327917725721, 'auprc': 0.9685396299200224, 'loss_val': 0.2710102089405676, 'psi': 0.9523355270315522}
[S5] START round=41 head_norm_before_train=2.085174 cos_to_last_merge=1.0000 (last merge round=40)
[S5] round=41 local utility u=0.914874 metrics={'f1_val': 0.9960398919057053, 'auprc': 0.9928950275530786, 'loss_val': 0.14675254511018637, 'psi': 0.9947819461646545}-{'f1_val': 0.7004887085110637, 'auprc': 0.9903312117830826, 'loss_val': 0.19550247526109854, 'psi': 0.8164257098198713}
[S6] START round=41 head_norm_before_train=1.322367 cos_to_last_merge=0.9996 (last merge round=39)
[S6] round=41 local utility u=0.809773 metrics={'f1_val': 0.7406135061206766, 'auprc': 0.8771158457330297, 'loss_val': 0.6343516676579378, 'psi': 0.7952144419656177}-{'f1_val': 0.6030633986785406, 'auprc': 0.6813432937245114, 'loss_val': 0.841279298791234, 'psi': 0.634375356696929}
[S7] START round=41 head_norm_before_train=1.412197 cos_to_last_merge=0.9996 (last merge round=39)
[S7] round=41 local utility u=0.463880 metrics={'f1_val': 0.6768010875418619, 'auprc': 0.8461259856442633, 'loss_val': 0.46746639586409783, 'psi': 0.7445310467828224}-{'f1_val': 0.5918704884179168, 'auprc': 0.7987553715168082, 'loss_val': 0.7435307462143274, 'psi': 0.6746244416574734}
[S8] START round=41 head_norm_before_train=2.002207 (no previous merge yet)
[S8] round=41 local utility u=0.033372 metrics={'f1_val': 0.989780933099827, 'auprc': 0.9988185971759415, 'loss_val': 0.036963805987503394, 'psi': 0.9933959987302727}-{'f1_val': 0.982001271692374, 'auprc': 0.9989164413914793, 'loss_val': 0.05732379465989332, 'psi': 0.988767339572016}
[S9] START round=41 head_norm_before_train=1.479469 cos_to_last_merge=0.9650 (last merge round=28)
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.9880286744602689, 'auprc': 0.9954394233133258, 'loss_val': 0.05912053438303776, 'psi': 0.9909929740014916}-{'f1_val': 0.9941961205231895, 'auprc': 0.9950679288106745, 'loss_val': 0.04339266506801584, 'psi': 0.9945448438381835}
[S10] START round=41 head_norm_before_train=2.000425 cos_to_last_merge=0.9999 (last merge round=38)
[S10] round=41 local utility u=0.000619 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.996849183949029, 'loss_val': 0.035525497206688725, 'psi': 0.9947992984721551}-{'f1_val': 0.9936518403636662, 'auprc': 0.9959113688031718, 'loss_val': 0.03526470512224483, 'psi': 0.9945556517394684}
[S11] START round=41 head_norm_before_train=2.101904 cos_to_last_merge=0.9995 (last merge round=36)
[S11] round=41 local utility u=0.000000 metrics={'f1_val': 0.9903924504077068, 'auprc': 0.9979346247092904, 'loss_val': 0.03979614821858632, 'psi': 0.9934093201283403}-{'f1_val': 0.9961336749133093, 'auprc': 0.9976574227754508, 'loss_val': 0.02951293152363139, 'psi': 0.9967431740581659}
[S13] START round=41 head_norm_before_train=1.921407 cos_to_last_merge=1.0000 (last merge round=40)
[S13] round=41 local utility u=0.506161 metrics={'f1_val': 0.6372624956871207, 'auprc': 0.7843861737046358, 'loss_val': 0.516419125505859, 'psi': 0.6961119668941267}-{'f1_val': 0.5908284900358002, 'auprc': 0.657250923636095, 'loss_val': 0.8687312393638923, 'psi': 0.6173974634759181}
[S14] START round=41 head_norm_before_train=1.985955 cos_to_last_merge=0.9907 (last merge round=25)
[S14] round=41 local utility u=0.002741 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.996845682687118, 'loss_val': 0.029733221489038095, 'psi': 0.9969367779694462}-{'f1_val': 0.9963442551067831, 'auprc': 0.9967496949975685, 'loss_val': 0.031007564644803226, 'psi': 0.9965064310630972}
[S15] START round=41 head_norm_before_train=1.396328 cos_to_last_merge=0.9975 (last merge round=38)
[S15] round=41 local utility u=0.835891 metrics={'f1_val': 0.9941594364890942, 'auprc': 0.9933340380761291, 'loss_val': 0.07613745499757357, 'psi': 0.9938292771239081}-{'f1_val': 0.7679821296150723, 'auprc': 0.9893990481335377, 'loss_val': 0.37905051174612625, 'psi': 0.8565488970224584}
[S16] START round=41 head_norm_before_train=1.393115 cos_to_last_merge=0.9998 (last merge round=39)
[S16] round=41 local utility u=1.000000 metrics={'f1_val': 0.9890074989036386, 'auprc': 0.9836526309262904, 'loss_val': 0.08826258795720643, 'psi': 0.9868655517126993}-{'f1_val': 0.8327368091806433, 'auprc': 0.8385319927456872, 'loss_val': 0.8998246761755352, 'psi': 0.8350548826066608}
[S17] START round=41 head_norm_before_train=1.425171 cos_to_last_merge=0.9868 (last merge round=30)
[S17] round=41 local utility u=0.000000 metrics={'f1_val': 0.6005320805611356, 'auprc': 0.9267050035447821, 'loss_val': 0.9617484115618364, 'psi': 0.7310012497545941}-{'f1_val': 0.755793932117961, 'auprc': 0.9584379892173965, 'loss_val': 0.656824584158727, 'psi': 0.8368515549577352}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:39011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:39003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:39009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:39004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:39008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:39013
[S8] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:39004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:39009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:39016
[S8] RECEIVED delta(kind=head bytes=1797) from S3
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=2.105724)
[S8] loaded HEAD from S3 (vec_in norm=2.105724)
[S8] cosine check vs S3: cos=-0.0114
[S8] DROPPED delta from S3 (cos=-0.0114 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1803) from S14
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.994512)
[S10] loaded HEAD from S14 (vec_in norm=1.994512)
[S10] cosine check vs S14: cos=0.9989
[S10] BUFFERED delta from S14 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1797) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=2.008547)
[S3] loaded HEAD from S8 (vec_in norm=2.008547)
[S3] cosine check vs S8: cos=-0.0114
[S3] DROPPED delta from S8 (cos=-0.0114 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1797) from S13
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.924857)
[S4] loaded HEAD from S13 (vec_in norm=1.924857)
[S4] cosine check vs S13: cos=0.9992
[S4] BUFFERED delta from S13 (total buffered=1)
[S10] sending update (kind=head size=1803 to 1 peers)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1803) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=2.011807)
[S4] loaded HEAD from S10 (vec_in norm=2.011807)
[S4] cosine check vs S10: cos=0.9980
[S4] BUFFERED delta from S10 (total buffered=2)
[S7] RECEIVED delta(kind=head bytes=1796) from S2
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.463316)
[S7] loaded HEAD from S2 (vec_in norm=1.463316)
[S7] cosine check vs S2: cos=0.9871
[S7] BUFFERED delta from S2 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1801) from S4
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.949600)
[S13] loaded HEAD from S4 (vec_in norm=1.949600)
[S13] cosine check vs S4: cos=0.9992
[S13] BUFFERED delta from S4 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1799) from S7
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.434221)
[S16] loaded HEAD from S7 (vec_in norm=1.434221)
[S16] cosine check vs S7: cos=0.9818
[S16] BUFFERED delta from S7 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:39017
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=41 metric=0.9934 head_norm=2.011807
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.748594e-02
[S10] stored merged vector for next round verification (round=41)
[S10] DEBUG after merge:  round=41 metric=0.9934 head_norm=2.002615 delta_norm=0.047486
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=41 metric=0.6768 head_norm=1.434221
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.172183e-01
[S7] stored merged vector for next round verification (round=41)
[S7] DEBUG after merge:  round=41 metric=0.6724 head_norm=1.444092 delta_norm=0.117218
[S7] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=41 metric=0.9423 head_norm=1.949600
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.888476e-02
[S4] stored merged vector for next round verification (round=41)
[S4] DEBUG after merge:  round=41 metric=0.9423 head_norm=1.957781 delta_norm=0.028885
[S4] aggregate: ACCEPT kept=['S13', 'S10'] (k=2/2) mode=median trim_p=0.1
[S6] sending update (kind=head size=1802 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1802) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.346326)
[S17] loaded HEAD from S6 (vec_in norm=1.346326)
[S17] cosine check vs S6: cos=0.9022
[S17] BUFFERED delta from S6 (total buffered=1)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:39017
[S16] sending update (kind=head size=1804 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] RECEIVED delta(kind=head bytes=1804) from S16
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.416403)
[S17] loaded HEAD from S16 (vec_in norm=1.416403)
[S17] cosine check vs S16: cos=0.7794
[S17] BUFFERED delta from S16 (total buffered=2)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=41 metric=0.7406 head_norm=1.346326
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.081293e-01
[S6] stored merged vector for next round verification (round=41)
[S6] DEBUG after merge:  round=41 metric=0.7401 head_norm=1.351632 delta_norm=0.308129
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=41 metric=0.9890 head_norm=1.416403
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.362170e-01
[S16] stored merged vector for next round verification (round=41)
[S16] DEBUG after merge:  round=41 metric=0.9884 head_norm=1.418815 delta_norm=0.136217
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=41 metric=0.6005 head_norm=1.432426
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.635083e-01
[S17] stored merged vector for next round verification (round=41)
[S17] DEBUG after merge:  round=41 metric=0.6011 head_norm=1.338967 delta_norm=0.363508
[S17] aggregate: ACCEPT kept=['S6', 'S16'] (k=2/2) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:39007
[S15] sending update (kind=head size=1804 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1804) from S15
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.438686)
[S6] loaded HEAD from S15 (vec_in norm=1.438686)
[S6] cosine check vs S15: cos=0.8515
[S6] BUFFERED delta from S15 (total buffered=1)
[S5] sending update (kind=head size=1802 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1802) from S5
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=2.090267)
[S8] loaded HEAD from S5 (vec_in norm=2.090267)
[S8] cosine check vs S5: cos=-0.0187
[S8] DROPPED delta from S5 (cos=-0.0187 < 0.0)
[S2] START round=42 head_norm_before_train=1.463316 cos_to_last_merge=0.9876 (last merge round=30)
[S2] round=42 local utility u=0.265112 metrics={'f1_val': 0.8223808257299539, 'auprc': 0.7540686602739742, 'loss_val': 0.48144424228650956, 'psi': 0.795055959547562}-{'f1_val': 0.7151537313771934, 'auprc': 0.8411890270047367, 'loss_val': 0.6296671201414356, 'psi': 0.7655678496282108}
[S3] START round=42 head_norm_before_train=2.105724 (no previous merge yet)
[S3] round=42 local utility u=0.010563 metrics={'f1_val': 0.9948698793475903, 'auprc': 0.9990649007143368, 'loss_val': 0.026654536753513494, 'psi': 0.9965478878942888}-{'f1_val': 0.9923851879828639, 'auprc': 0.9987948026261144, 'loss_val': 0.03206158931775312, 'psi': 0.9949490338401641}
[S4] START round=42 head_norm_before_train=1.957781 cos_to_last_merge=1.0000 (last merge round=41)
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.9401078723167646, 'auprc': 0.964985309861299, 'loss_val': 0.2817337797119665, 'psi': 0.9500588473345783}-{'f1_val': 0.9422714396630361, 'auprc': 0.968973618715748, 'loss_val': 0.2694580129727052, 'psi': 0.952952311284121}
[S5] START round=42 head_norm_before_train=2.090267 cos_to_last_merge=1.0000 (last merge round=40)
[S5] round=42 local utility u=0.000000 metrics={'f1_val': 0.7162939457799973, 'auprc': 0.9400303037977591, 'loss_val': 0.38161089132543174, 'psi': 0.8057884889871021}-{'f1_val': 0.9960398919057053, 'auprc': 0.9928950275530786, 'loss_val': 0.14675254511018637, 'psi': 0.9947819461646545}
[S6] START round=42 head_norm_before_train=1.351632 cos_to_last_merge=1.0000 (last merge round=41)
[S6] round=42 local utility u=0.524658 metrics={'f1_val': 0.8312310758567257, 'auprc': 0.9425744626712269, 'loss_val': 0.32511789022608645, 'psi': 0.8757684305825262}-{'f1_val': 0.7406135061206766, 'auprc': 0.8771158457330297, 'loss_val': 0.6343516676579378, 'psi': 0.7952144419656177}
[S7] START round=42 head_norm_before_train=1.444092 cos_to_last_merge=1.0000 (last merge round=41)
[S7] round=42 local utility u=0.000000 metrics={'f1_val': 0.6437175128474443, 'auprc': 0.8218491213396084, 'loss_val': 0.567254562786046, 'psi': 0.7149701562443099}-{'f1_val': 0.6768010875418619, 'auprc': 0.8461259856442633, 'loss_val': 0.46746639586409783, 'psi': 0.7445310467828224}
[S8] START round=42 head_norm_before_train=2.008547 (no previous merge yet)
[S8] round=42 local utility u=0.013638 metrics={'f1_val': 0.9938130760262815, 'auprc': 0.9981701640641224, 'loss_val': 0.031934907095181514, 'psi': 0.9955559112414178}-{'f1_val': 0.989780933099827, 'auprc': 0.9988185971759415, 'loss_val': 0.036963805987503394, 'psi': 0.9933959987302727}
[S9] START round=42 head_norm_before_train=1.490780 cos_to_last_merge=0.9637 (last merge round=28)
[S9] round=42 local utility u=0.029105 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9910062233319412, 'loss_val': 0.03959332796004253, 'psi': 0.9944179840916338}-{'f1_val': 0.9880286744602689, 'auprc': 0.9954394233133258, 'loss_val': 0.05912053438303776, 'psi': 0.9909929740014916}
[S10] START round=42 head_norm_before_train=2.002615 cos_to_last_merge=1.0000 (last merge round=41)
[S10] round=42 local utility u=0.000000 metrics={'f1_val': 0.9936518403636662, 'auprc': 0.996087778830416, 'loss_val': 0.03500342809738183, 'psi': 0.994626215750366}-{'f1_val': 0.9934327081542391, 'auprc': 0.996849183949029, 'loss_val': 0.035525497206688725, 'psi': 0.9947992984721551}
[S11] START round=42 head_norm_before_train=2.112900 cos_to_last_merge=0.9992 (last merge round=36)
[S11] round=42 local utility u=0.024490 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9980725374643247, 'loss_val': 0.02567698069342041, 'psi': 0.9969092199337155}-{'f1_val': 0.9903924504077068, 'auprc': 0.9979346247092904, 'loss_val': 0.03979614821858632, 'psi': 0.9934093201283403}
[S13] START round=42 head_norm_before_train=1.924857 cos_to_last_merge=1.0000 (last merge round=40)
[S13] round=42 local utility u=0.000000 metrics={'f1_val': 0.6027684929422861, 'auprc': 0.6730234808003916, 'loss_val': 0.8137421834451252, 'psi': 0.6308704880855283}-{'f1_val': 0.6372624956871207, 'auprc': 0.7843861737046358, 'loss_val': 0.516419125505859, 'psi': 0.6961119668941267}
[S14] START round=42 head_norm_before_train=1.994512 cos_to_last_merge=0.9902 (last merge round=25)
[S14] round=42 local utility u=0.006127 metrics={'f1_val': 0.9968305862100909, 'auprc': 0.9990463794310003, 'loss_val': 0.023079917068786898, 'psi': 0.9977169034984547}-{'f1_val': 0.9969975081576651, 'auprc': 0.996845682687118, 'loss_val': 0.029733221489038095, 'psi': 0.9969367779694462}
[S15] START round=42 head_norm_before_train=1.438686 cos_to_last_merge=0.9950 (last merge round=38)
[S15] round=42 local utility u=0.000000 metrics={'f1_val': 0.7563652343037198, 'auprc': 0.9710054531779807, 'loss_val': 0.4172137300526358, 'psi': 0.8422213218534242}-{'f1_val': 0.9941594364890942, 'auprc': 0.9933340380761291, 'loss_val': 0.07613745499757357, 'psi': 0.9938292771239081}
[S16] START round=42 head_norm_before_train=1.418815 cos_to_last_merge=1.0000 (last merge round=41)
[S16] round=42 local utility u=0.006746 metrics={'f1_val': 0.9911520112052127, 'auprc': 0.9852252129874166, 'loss_val': 0.09235631220922583, 'psi': 0.9887812919180943}-{'f1_val': 0.9890074989036386, 'auprc': 0.9836526309262904, 'loss_val': 0.08826258795720643, 'psi': 0.9868655517126993}
[S17] START round=42 head_norm_before_train=1.338967 cos_to_last_merge=1.0000 (last merge round=41)
[S17] round=42 local utility u=0.000000 metrics={'f1_val': 0.567098918193057, 'auprc': 0.7859359607703518, 'loss_val': 0.822428333869608, 'psi': 0.6546337352239749}-{'f1_val': 0.6005320805611356, 'auprc': 0.9267050035447821, 'loss_val': 0.9617484115618364, 'psi': 0.7310012497545941}
[S3] not sending this round → trigger blocked (psi=0.997)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.998)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:39005
[S8] not sending this round → trigger blocked (psi=0.996)
[S2] not sending this round → trigger blocked (psi=0.795)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1799 to 1 peers)
[S6] not sending this round → trigger blocked (psi=0.876)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=42 metric=0.6028 head_norm=1.929066
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.076430e-02
[S13] stored merged vector for next round verification (round=42)
[S13] DEBUG after merge:  round=42 metric=0.6038 head_norm=1.938932 delta_norm=0.040764
[S13] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] RECEIVED delta(kind=head bytes=1799) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=2.126593)
[S5] loaded HEAD from S11 (vec_in norm=2.126593)
[S5] cosine check vs S11: cos=0.9995
[S5] BUFFERED delta from S11 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=42 metric=0.7163 head_norm=2.098465
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.483720e-02
[S5] stored merged vector for next round verification (round=42)
[S5] DEBUG after merge:  round=42 metric=0.7175 head_norm=2.112288 delta_norm=0.034837
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=42 metric=0.8312 head_norm=1.370863
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.795343e-01
[S6] stored merged vector for next round verification (round=42)
[S6] DEBUG after merge:  round=42 metric=0.8444 head_norm=1.352958 delta_norm=0.379534
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:39015
[S16] not sending this round → trigger blocked (psi=0.989)
[S9] sending update (kind=head size=1801 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1801) from S9
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.502263)
[S15] loaded HEAD from S9 (vec_in norm=1.502263)
[S15] cosine check vs S9: cos=0.8973
[S15] BUFFERED delta from S9 (total buffered=1)
[S2] START round=43 head_norm_before_train=1.476892 cos_to_last_merge=0.9866 (last merge round=30)
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.7092004238955941, 'auprc': 0.8571341804377327, 'loss_val': 0.4852772389655922, 'psi': 0.7683739265124496}-{'f1_val': 0.8223808257299539, 'auprc': 0.7540686602739742, 'loss_val': 0.48144424228650956, 'psi': 0.795055959547562}
[S3] START round=43 head_norm_before_train=2.114686 (no previous merge yet)
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9983095535799198, 'loss_val': 0.11995222953701565, 'psi': 0.975944972095234}-{'f1_val': 0.9948698793475903, 'auprc': 0.9990649007143368, 'loss_val': 0.026654536753513494, 'psi': 0.9965478878942888}
[S4] START round=43 head_norm_before_train=1.960951 cos_to_last_merge=1.0000 (last merge round=41)
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.9397099268156024, 'auprc': 0.9654583594136102, 'loss_val': 0.2848965400336333, 'psi': 0.9500092998548055}-{'f1_val': 0.9401078723167646, 'auprc': 0.964985309861299, 'loss_val': 0.2817337797119665, 'psi': 0.9500588473345783}
[S5] START round=43 head_norm_before_train=2.112288 cos_to_last_merge=1.0000 (last merge round=42)
[S5] round=43 local utility u=0.140271 metrics={'f1_val': 0.7000725525005456, 'auprc': 0.9920008796080751, 'loss_val': 0.15965303076656073, 'psi': 0.8168438833435574}-{'f1_val': 0.7162939457799973, 'auprc': 0.9400303037977591, 'loss_val': 0.38161089132543174, 'psi': 0.8057884889871021}
[S6] START round=43 head_norm_before_train=1.352958 cos_to_last_merge=1.0000 (last merge round=42)
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.4938918359156522, 'auprc': 0.6698987186907441, 'loss_val': 1.0523845021047085, 'psi': 0.564294589025689}-{'f1_val': 0.8312310758567257, 'auprc': 0.9425744626712269, 'loss_val': 0.32511789022608645, 'psi': 0.8757684305825262}
[S7] START round=43 head_norm_before_train=1.463561 cos_to_last_merge=0.9997 (last merge round=41)
[S7] round=43 local utility u=0.248147 metrics={'f1_val': 0.6851820543862768, 'auprc': 0.8608680995468727, 'loss_val': 0.4368039934435934, 'psi': 0.7554564724505152}-{'f1_val': 0.6437175128474443, 'auprc': 0.8218491213396084, 'loss_val': 0.567254562786046, 'psi': 0.7149701562443099}
[S8] START round=43 head_norm_before_train=2.014243 (no previous merge yet)
[S8] round=43 local utility u=0.000000 metrics={'f1_val': 0.9939592667089093, 'auprc': 0.9892284137240542, 'loss_val': 0.03241789917032023, 'psi': 0.9920669255149672}-{'f1_val': 0.9938130760262815, 'auprc': 0.9981701640641224, 'loss_val': 0.031934907095181514, 'psi': 0.9955559112414178}
[S9] START round=43 head_norm_before_train=1.502263 cos_to_last_merge=0.9625 (last merge round=28)
[S9] round=43 local utility u=0.000593 metrics={'f1_val': 0.9956098104564366, 'auprc': 0.9926186158579133, 'loss_val': 0.03674826404473465, 'psi': 0.9944133326170272}-{'f1_val': 0.9966924912647621, 'auprc': 0.9910062233319412, 'loss_val': 0.03959332796004253, 'psi': 0.9944179840916338}
[S10] START round=43 head_norm_before_train=2.012799 cos_to_last_merge=1.0000 (last merge round=41)
[S10] round=43 local utility u=0.000000 metrics={'f1_val': 0.9931720938432163, 'auprc': 0.9971057678420276, 'loss_val': 0.036261222960802454, 'psi': 0.9947455634427409}-{'f1_val': 0.9936518403636662, 'auprc': 0.996087778830416, 'loss_val': 0.03500342809738183, 'psi': 0.994626215750366}
[S11] START round=43 head_norm_before_train=2.126593 cos_to_last_merge=0.9989 (last merge round=36)
[S11] round=43 local utility u=0.000000 metrics={'f1_val': 0.9908684553074892, 'auprc': 0.9979209587078144, 'loss_val': 0.041390034236229244, 'psi': 0.9936894566676193}-{'f1_val': 0.9961336749133093, 'auprc': 0.9980725374643247, 'loss_val': 0.02567698069342041, 'psi': 0.9969092199337155}
[S13] START round=43 head_norm_before_train=1.938932 cos_to_last_merge=1.0000 (last merge round=42)
[S13] round=43 local utility u=0.264498 metrics={'f1_val': 0.6281711159852942, 'auprc': 0.735416151586413, 'loss_val': 0.6243406292827886, 'psi': 0.6710691302257418}-{'f1_val': 0.6027684929422861, 'auprc': 0.6730234808003916, 'loss_val': 0.8137421834451252, 'psi': 0.6308704880855283}
[S14] START round=43 head_norm_before_train=2.003484 cos_to_last_merge=0.9897 (last merge round=25)
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.9963671647723179, 'auprc': 0.9990342776900439, 'loss_val': 0.023841812328954836, 'psi': 0.9974340099394083}-{'f1_val': 0.9968305862100909, 'auprc': 0.9990463794310003, 'loss_val': 0.023079917068786898, 'psi': 0.9977169034984547}
[S15] START round=43 head_norm_before_train=1.476858 cos_to_last_merge=0.9925 (last merge round=38)
[S15] round=43 local utility u=0.000000 metrics={'f1_val': 0.70196819164474, 'auprc': 0.9121588868392291, 'loss_val': 0.4927045861749826, 'psi': 0.7860444697225357}-{'f1_val': 0.7563652343037198, 'auprc': 0.9710054531779807, 'loss_val': 0.4172137300526358, 'psi': 0.8422213218534242}
[S16] START round=43 head_norm_before_train=1.441766 cos_to_last_merge=0.9998 (last merge round=41)
[S16] round=43 local utility u=0.005606 metrics={'f1_val': 0.990947224670232, 'auprc': 0.9857799689983886, 'loss_val': 0.08157914195552811, 'psi': 0.9888803224014947}-{'f1_val': 0.9911520112052127, 'auprc': 0.9852252129874166, 'loss_val': 0.09235631220922583, 'psi': 0.9887812919180943}
[S17] START round=43 head_norm_before_train=1.351140 cos_to_last_merge=0.9999 (last merge round=41)
[S17] round=43 local utility u=0.000000 metrics={'f1_val': 0.5291335524604733, 'auprc': 0.6909547683280649, 'loss_val': 0.9996457370964856, 'psi': 0.59386203880751}-{'f1_val': 0.567098918193057, 'auprc': 0.7859359607703518, 'loss_val': 0.822428333869608, 'psi': 0.6546337352239749}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:39004
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:39009
[S13] sending update (kind=head size=1799 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:39016
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] RECEIVED delta(kind=head bytes=1799) from S13
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.941613)
[S4] loaded HEAD from S13 (vec_in norm=1.941613)
[S4] cosine check vs S13: cos=0.9997
[S4] BUFFERED delta from S13 (total buffered=1)
[S7] sending update (kind=head size=1799 to 1 peers)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1800 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S7
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.479667)
[S16] loaded HEAD from S7 (vec_in norm=1.479667)
[S16] cosine check vs S7: cos=0.9836
[S16] BUFFERED delta from S7 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1800) from S5
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=2.116364)
[S8] loaded HEAD from S5 (vec_in norm=2.116364)
[S8] cosine check vs S5: cos=-0.0185
[S8] DROPPED delta from S5 (cos=-0.0185 < 0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=43 metric=0.7020 head_norm=1.510503
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.517067e-01
[S15] stored merged vector for next round verification (round=43)
[S15] DEBUG after merge:  round=43 metric=0.7032 head_norm=1.464756 delta_norm=0.351707
[S15] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=43 metric=0.9397 head_norm=1.962377
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.708956e-02
[S4] stored merged vector for next round verification (round=43)
[S4] DEBUG after merge:  round=43 metric=0.9397 head_norm=1.951834 delta_norm=0.027090
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:39017
[S9] not sending this round → trigger blocked (psi=0.994)
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1803) from S16
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.465599)
[S17] loaded HEAD from S16 (vec_in norm=1.465599)
[S17] cosine check vs S16: cos=0.8788
[S17] BUFFERED delta from S16 (total buffered=1)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=43 metric=0.9909 head_norm=1.465599
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.334784e-01
[S16] stored merged vector for next round verification (round=43)
[S16] DEBUG after merge:  round=43 metric=0.9907 head_norm=1.466588 delta_norm=0.133478
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=43 metric=0.5291 head_norm=1.365755
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.518393e-01
[S17] stored merged vector for next round verification (round=43)
[S17] DEBUG after merge:  round=43 metric=0.5277 head_norm=1.372167 delta_norm=0.351839
[S17] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=44 head_norm_before_train=1.488730 cos_to_last_merge=0.9857 (last merge round=30)
[S2] round=44 local utility u=0.181302 metrics={'f1_val': 0.7642903298452188, 'auprc': 0.8485774486522812, 'loss_val': 0.42754161850877587, 'psi': 0.7980051773680438}-{'f1_val': 0.7092004238955941, 'auprc': 0.8571341804377327, 'loss_val': 0.4852772389655922, 'psi': 0.7683739265124496}
[S3] START round=44 head_norm_before_train=2.120261 (no previous merge yet)
[S3] round=44 local utility u=0.159474 metrics={'f1_val': 0.9973696976584205, 'auprc': 0.9988616424984936, 'loss_val': 0.020666291992391367, 'psi': 0.9979664755944497}-{'f1_val': 0.9610352511054436, 'auprc': 0.9983095535799198, 'loss_val': 0.11995222953701565, 'psi': 0.975944972095234}
[S4] START round=44 head_norm_before_train=1.951834 cos_to_last_merge=1.0000 (last merge round=43)
[S4] round=44 local utility u=0.016833 metrics={'f1_val': 0.9417214219017751, 'auprc': 0.9693598384790445, 'loss_val': 0.27500483040590457, 'psi': 0.9527767885326828}-{'f1_val': 0.9397099268156024, 'auprc': 0.9654583594136102, 'loss_val': 0.2848965400336333, 'psi': 0.9500092998548055}
[S5] START round=44 head_norm_before_train=2.116364 cos_to_last_merge=1.0000 (last merge round=42)
[S5] round=44 local utility u=0.000000 metrics={'f1_val': 0.7000725525005456, 'auprc': 0.9906756741758822, 'loss_val': 0.16463264076328724, 'psi': 0.8163138011706802}-{'f1_val': 0.7000725525005456, 'auprc': 0.9920008796080751, 'loss_val': 0.15965303076656073, 'psi': 0.8168438833435574}
[S6] START round=44 head_norm_before_train=1.370759 cos_to_last_merge=0.9999 (last merge round=42)
[S6] round=44 local utility u=1.000000 metrics={'f1_val': 0.7190185716249945, 'auprc': 0.8149934845233157, 'loss_val': 0.7290319075002676, 'psi': 0.757408536784323}-{'f1_val': 0.4938918359156522, 'auprc': 0.6698987186907441, 'loss_val': 1.0523845021047085, 'psi': 0.564294589025689}
[S7] START round=44 head_norm_before_train=1.479667 cos_to_last_merge=0.9992 (last merge round=41)
[S7] round=44 local utility u=0.000000 metrics={'f1_val': 0.6708851958321571, 'auprc': 0.8406874141964237, 'loss_val': 0.4631441951100826, 'psi': 0.7388060831778638}-{'f1_val': 0.6851820543862768, 'auprc': 0.8608680995468727, 'loss_val': 0.4368039934435934, 'psi': 0.7554564724505152}
[S8] START round=44 head_norm_before_train=2.021060 (no previous merge yet)
[S8] round=44 local utility u=0.009007 metrics={'f1_val': 0.9923167377520978, 'auprc': 0.9988171287944755, 'loss_val': 0.033315190377164766, 'psi': 0.9949168941690489}-{'f1_val': 0.9939592667089093, 'auprc': 0.9892284137240542, 'loss_val': 0.03241789917032023, 'psi': 0.9920669255149672}
[S9] START round=44 head_norm_before_train=1.515231 cos_to_last_merge=0.9611 (last merge round=28)
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.9910040044536889, 'auprc': 0.9949318175518181, 'loss_val': 0.044765270501019305, 'psi': 0.9925751296929406}-{'f1_val': 0.9956098104564366, 'auprc': 0.9926186158579133, 'loss_val': 0.03674826404473465, 'psi': 0.9944133326170272}
[S10] START round=44 head_norm_before_train=2.022178 cos_to_last_merge=1.0000 (last merge round=41)
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9959215253072095, 'loss_val': 0.03436399817676994, 'psi': 0.9944282350154273}-{'f1_val': 0.9931720938432163, 'auprc': 0.9971057678420276, 'loss_val': 0.036261222960802454, 'psi': 0.9947455634427409}
[S11] START round=44 head_norm_before_train=2.139354 cos_to_last_merge=0.9986 (last merge round=36)
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.9639584705193301, 'auprc': 0.9977303983891286, 'loss_val': 0.101545661731938, 'psi': 0.9774672416672495}-{'f1_val': 0.9908684553074892, 'auprc': 0.9979209587078144, 'loss_val': 0.041390034236229244, 'psi': 0.9936894566676193}
[S13] START round=44 head_norm_before_train=1.941613 cos_to_last_merge=1.0000 (last merge round=42)
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.5746784153032056, 'auprc': 0.7903268100612212, 'loss_val': 0.9174537002221244, 'psi': 0.6609377732064119}-{'f1_val': 0.6281711159852942, 'auprc': 0.735416151586413, 'loss_val': 0.6243406292827886, 'psi': 0.6710691302257418}
[S14] START round=44 head_norm_before_train=2.011021 cos_to_last_merge=0.9892 (last merge round=25)
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.9973862616479148, 'auprc': 0.9967425199787183, 'loss_val': 0.02707421193421569, 'psi': 0.9971287649802362}-{'f1_val': 0.9963671647723179, 'auprc': 0.9990342776900439, 'loss_val': 0.023841812328954836, 'psi': 0.9974340099394083}
[S15] START round=44 head_norm_before_train=1.464756 cos_to_last_merge=1.0000 (last merge round=43)
[S15] round=44 local utility u=0.638563 metrics={'f1_val': 0.8400846955683854, 'auprc': 0.9870161235067935, 'loss_val': 0.26884859640564823, 'psi': 0.8988572667437487}-{'f1_val': 0.70196819164474, 'auprc': 0.9121588868392291, 'loss_val': 0.4927045861749826, 'psi': 0.7860444697225357}
[S16] START round=44 head_norm_before_train=1.466588 cos_to_last_merge=1.0000 (last merge round=43)
[S16] round=44 local utility u=0.000000 metrics={'f1_val': 0.9907042626824083, 'auprc': 0.9856839231125447, 'loss_val': 0.09060632796473732, 'psi': 0.9886961268544628}-{'f1_val': 0.990947224670232, 'auprc': 0.9857799689983886, 'loss_val': 0.08157914195552811, 'psi': 0.9888803224014947}
[S17] START round=44 head_norm_before_train=1.372167 cos_to_last_merge=1.0000 (last merge round=43)
[S17] round=44 local utility u=0.888734 metrics={'f1_val': 0.6114645587569144, 'auprc': 0.992053232289526, 'loss_val': 0.6194597410954241, 'psi': 0.7637000281699591}-{'f1_val': 0.5291335524604733, 'auprc': 0.6909547683280649, 'loss_val': 0.9996457370964856, 'psi': 0.59386203880751}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:39009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:39003
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] → sending delta(kind=head bytes=1805) to S13@127.0.0.1:39013
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1799 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:39008
[S3] sending update (kind=head size=1802 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:39007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:39017
[S8] RECEIVED delta(kind=head bytes=1802) from S3
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=2.125636)
[S8] loaded HEAD from S3 (vec_in norm=2.125636)
[S8] cosine check vs S3: cos=-0.0109
[S8] DROPPED delta from S3 (cos=-0.0109 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1799) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=2.030220)
[S3] loaded HEAD from S8 (vec_in norm=2.030220)
[S3] cosine check vs S8: cos=-0.0109
[S3] DROPPED delta from S8 (cos=-0.0109 < 0.0)
[S15] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1805 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:39007
[S17] RECEIVED delta(kind=head bytes=1802) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.387085)
[S17] loaded HEAD from S6 (vec_in norm=1.387085)
[S17] cosine check vs S6: cos=0.9538
[S17] BUFFERED delta from S6 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1801) from S2
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.501175)
[S7] loaded HEAD from S2 (vec_in norm=1.501175)
[S7] cosine check vs S2: cos=0.9912
[S7] BUFFERED delta from S2 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1802) from S15
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.498624)
[S6] loaded HEAD from S15 (vec_in norm=1.498624)
[S6] cosine check vs S15: cos=0.9201
[S6] BUFFERED delta from S15 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1805) from S4
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.954135)
[S13] loaded HEAD from S4 (vec_in norm=1.954135)
[S13] cosine check vs S4: cos=0.9998
[S13] BUFFERED delta from S4 (total buffered=1)
[S17] sending update (kind=head size=1802 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1802) from S17
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.388457)
[S6] loaded HEAD from S17 (vec_in norm=1.388457)
[S6] cosine check vs S17: cos=0.9538
[S6] BUFFERED delta from S17 (total buffered=2)
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=44 metric=0.7190 head_norm=1.387085
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.843466e-01
[S6] stored merged vector for next round verification (round=44)
[S6] DEBUG after merge:  round=44 metric=0.7190 head_norm=1.381574 delta_norm=0.184347
[S6] aggregate: ACCEPT kept=['S15', 'S17'] (k=2/2) mode=median trim_p=0.1
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=44 metric=0.6709 head_norm=1.493108
[S7] _apply_head_vector_avg (torch): Δ‖w‖=9.934145e-02
[S7] stored merged vector for next round verification (round=44)
[S7] DEBUG after merge:  round=44 metric=0.6680 head_norm=1.493847 delta_norm=0.099341
[S7] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=44 metric=0.6115 head_norm=1.388457
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.110238e-01
[S17] stored merged vector for next round verification (round=44)
[S17] DEBUG after merge:  round=44 metric=0.6106 head_norm=1.371633 delta_norm=0.211024
[S17] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=45 head_norm_before_train=1.501175 cos_to_last_merge=0.9847 (last merge round=30)
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.7150692205328615, 'auprc': 0.8513744512167569, 'loss_val': 0.6256848657967622, 'psi': 0.7695913128064197}-{'f1_val': 0.7642903298452188, 'auprc': 0.8485774486522812, 'loss_val': 0.42754161850877587, 'psi': 0.7980051773680438}
[S3] START round=45 head_norm_before_train=2.125636 (no previous merge yet)
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.9348034872792208, 'auprc': 0.9977370110247451, 'loss_val': 0.1521301860353856, 'psi': 0.9599768967774306}-{'f1_val': 0.9973696976584205, 'auprc': 0.9988616424984936, 'loss_val': 0.020666291992391367, 'psi': 0.9979664755944497}
[S4] START round=45 head_norm_before_train=1.954135 cos_to_last_merge=1.0000 (last merge round=43)
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.9382668782291026, 'auprc': 0.962092618184736, 'loss_val': 0.2941003450457716, 'psi': 0.947797174211356}-{'f1_val': 0.9417214219017751, 'auprc': 0.9693598384790445, 'loss_val': 0.27500483040590457, 'psi': 0.9527767885326828}
[S5] START round=45 head_norm_before_train=2.119955 cos_to_last_merge=0.9999 (last merge round=42)
[S5] round=45 local utility u=0.010651 metrics={'f1_val': 0.7000725525005456, 'auprc': 0.9921240413989755, 'loss_val': 0.14767480957728907, 'psi': 0.8168931480599175}-{'f1_val': 0.7000725525005456, 'auprc': 0.9906756741758822, 'loss_val': 0.16463264076328724, 'psi': 0.8163138011706802}
[S6] START round=45 head_norm_before_train=1.381574 cos_to_last_merge=1.0000 (last merge round=44)
[S6] round=45 local utility u=1.000000 metrics={'f1_val': 0.9504919961943039, 'auprc': 0.9413054602530057, 'loss_val': 0.2795839450007889, 'psi': 0.9468173818177846}-{'f1_val': 0.7190185716249945, 'auprc': 0.8149934845233157, 'loss_val': 0.7290319075002676, 'psi': 0.757408536784323}
[S7] START round=45 head_norm_before_train=1.493847 cos_to_last_merge=1.0000 (last merge round=44)
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.6494466864396191, 'auprc': 0.805878459560895, 'loss_val': 0.6114127151375107, 'psi': 0.7120193956881296}-{'f1_val': 0.6708851958321571, 'auprc': 0.8406874141964237, 'loss_val': 0.4631441951100826, 'psi': 0.7388060831778638}
[S8] START round=45 head_norm_before_train=2.030220 (no previous merge yet)
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.9837508313543211, 'auprc': 0.9989614571439697, 'loss_val': 0.051866275284220685, 'psi': 0.9898350816701805}-{'f1_val': 0.9923167377520978, 'auprc': 0.9988171287944755, 'loss_val': 0.033315190377164766, 'psi': 0.9949168941690489}
[S9] START round=45 head_norm_before_train=1.528303 cos_to_last_merge=0.9597 (last merge round=28)
[S9] round=45 local utility u=0.017409 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9910665161526763, 'loss_val': 0.03248183034519739, 'psi': 0.9944421012199278}-{'f1_val': 0.9910040044536889, 'auprc': 0.9949318175518181, 'loss_val': 0.044765270501019305, 'psi': 0.9925751296929406}
[S10] START round=45 head_norm_before_train=2.032339 cos_to_last_merge=0.9999 (last merge round=41)
[S10] round=45 local utility u=0.000000 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.995861442350648, 'loss_val': 0.034267795769168066, 'psi': 0.9944042018328028}-{'f1_val': 0.9934327081542391, 'auprc': 0.9959215253072095, 'loss_val': 0.03436399817676994, 'psi': 0.9944282350154273}
[S11] START round=45 head_norm_before_train=2.151182 cos_to_last_merge=0.9984 (last merge round=36)
[S11] round=45 local utility u=0.132486 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9977080926290547, 'loss_val': 0.029558906836149146, 'psi': 0.9967634419996074}-{'f1_val': 0.9639584705193301, 'auprc': 0.9977303983891286, 'loss_val': 0.101545661731938, 'psi': 0.9774672416672495}
[S13] START round=45 head_norm_before_train=1.943532 cos_to_last_merge=0.9999 (last merge round=42)
[S13] round=45 local utility u=0.000000 metrics={'f1_val': 0.613594098506861, 'auprc': 0.6375184421477026, 'loss_val': 0.7489930729864109, 'psi': 0.6231638359631977}-{'f1_val': 0.5746784153032056, 'auprc': 0.7903268100612212, 'loss_val': 0.9174537002221244, 'psi': 0.6609377732064119}
[S14] START round=45 head_norm_before_train=2.017087 cos_to_last_merge=0.9888 (last merge round=25)
[S14] round=45 local utility u=0.001448 metrics={'f1_val': 0.9973862616479148, 'auprc': 0.997243581031013, 'loss_val': 0.025681650963053988, 'psi': 0.997329189401154}-{'f1_val': 0.9973862616479148, 'auprc': 0.9967425199787183, 'loss_val': 0.02707421193421569, 'psi': 0.9971287649802362}
[S15] START round=45 head_norm_before_train=1.498624 cos_to_last_merge=0.9996 (last merge round=43)
[S15] round=45 local utility u=0.437416 metrics={'f1_val': 0.9576851163879017, 'auprc': 0.9923294608233205, 'loss_val': 0.11555849104824634, 'psi': 0.9715428541620692}-{'f1_val': 0.8400846955683854, 'auprc': 0.9870161235067935, 'loss_val': 0.26884859640564823, 'psi': 0.8988572667437487}
[S16] START round=45 head_norm_before_train=1.490444 cos_to_last_merge=0.9998 (last merge round=43)
[S16] round=45 local utility u=0.011805 metrics={'f1_val': 0.991356625350989, 'auprc': 0.9877732836879433, 'loss_val': 0.07717913126218875, 'psi': 0.9899232886857707}-{'f1_val': 0.9907042626824083, 'auprc': 0.9856839231125447, 'loss_val': 0.09060632796473732, 'psi': 0.9886961268544628}
[S17] START round=45 head_norm_before_train=1.371633 cos_to_last_merge=1.0000 (last merge round=44)
[S17] round=45 local utility u=0.000000 metrics={'f1_val': 0.6079796122626405, 'auprc': 0.9839384937848241, 'loss_val': 0.7190858350421153, 'psi': 0.7583631648715139}-{'f1_val': 0.6114645587569144, 'auprc': 0.992053232289526, 'loss_val': 0.6194597410954241, 'psi': 0.7637000281699591}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:39011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:39005
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] ⇄ pheromone p=0.048 → S8@127.0.0.1:39009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:39009
[S11] sending update (kind=head size=1800 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1799 to 1 peers)
[S8] ⇄ pheromone p=0.009 → S3@127.0.0.1:39003
[S15] not sending this round → trigger blocked (psi=0.972)
[S6] not sending this round → trigger blocked (psi=0.947)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=45 metric=0.6136 head_norm=1.947464
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.412469e-02
[S13] stored merged vector for next round verification (round=45)
[S13] DEBUG after merge:  round=45 metric=0.6140 head_norm=1.950653 delta_norm=0.024125
[S13] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.092 → S4@127.0.0.1:39004
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] RECEIVED delta(kind=head bytes=1799) from S14
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=2.022879)
[S10] loaded HEAD from S14 (vec_in norm=2.022879)
[S10] cosine check vs S14: cos=0.9990
[S10] BUFFERED delta from S14 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1800) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=2.163967)
[S5] loaded HEAD from S11 (vec_in norm=2.163967)
[S5] cosine check vs S11: cos=0.9994
[S5] BUFFERED delta from S11 (total buffered=1)
[S14] ⇄ pheromone p=0.002 → S10@127.0.0.1:39011
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] ⇄ pheromone p=0.035 → S5@127.0.0.1:39005
[S5] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S5
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=2.126082)
[S8] loaded HEAD from S5 (vec_in norm=2.126082)
[S8] cosine check vs S5: cos=-0.0193
[S8] DROPPED delta from S5 (cos=-0.0193 < 0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=45 metric=0.9934 head_norm=2.040331
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.697030e-02
[S10] stored merged vector for next round verification (round=45)
[S10] DEBUG after merge:  round=45 metric=0.9934 head_norm=2.031081 delta_norm=0.046970
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.001 → S4@127.0.0.1:39004
[S2] ⇄ pheromone p=0.109 → S7@127.0.0.1:39008
[S4] ⇄ pheromone p=0.046 → S13@127.0.0.1:39013
[S7] ⇄ pheromone p=0.145 → S16@127.0.0.1:39016
[S15] ⇄ pheromone p=0.340 → S6@127.0.0.1:39007
[S6] ⇄ pheromone p=0.553 → S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:39017
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=45 metric=0.7001 head_norm=2.126082
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.206066e-02
[S5] stored merged vector for next round verification (round=45)
[S5] DEBUG after merge:  round=45 metric=0.7049 head_norm=2.144696 delta_norm=0.042061
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.142 → S8@127.0.0.1:39009
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1801) from S16
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.515333)
[S17] loaded HEAD from S16 (vec_in norm=1.515333)
[S17] cosine check vs S16: cos=0.9252
[S17] BUFFERED delta from S16 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] → sending delta(kind=head bytes=1805) to S15@127.0.0.1:39015
[S9] sending update (kind=head size=1805 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1805) from S9
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.541607)
[S15] loaded HEAD from S9 (vec_in norm=1.541607)
[S15] cosine check vs S9: cos=0.9577
[S15] BUFFERED delta from S9 (total buffered=1)
[S16] ⇄ pheromone p=0.138 → S17@127.0.0.1:39017
[S9] ⇄ pheromone p=0.028 → S15@127.0.0.1:39015
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=45 metric=0.6080 head_norm=1.394400
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.874791e-01
[S17] stored merged vector for next round verification (round=45)
[S17] DEBUG after merge:  round=45 metric=0.6111 head_norm=1.427462 delta_norm=0.287479
[S17] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.246 → S6@127.0.0.1:39007
[S2] START round=46 head_norm_before_train=1.513237 cos_to_last_merge=0.9837 (last merge round=30)
[S2] round=46 local utility u=0.184821 metrics={'f1_val': 0.7771900475033242, 'auprc': 0.833332939432068, 'loss_val': 0.5746425913921274, 'psi': 0.7996472042748217}-{'f1_val': 0.7150692205328615, 'auprc': 0.8513744512167569, 'loss_val': 0.6256848657967622, 'psi': 0.7695913128064197}
[S3] START round=46 head_norm_before_train=2.128982 (no previous merge yet)
[S3] round=46 local utility u=0.000000 metrics={'f1_val': 0.9234008616971144, 'auprc': 0.9935353130582558, 'loss_val': 0.19678631405895278, 'psi': 0.951454642241571}-{'f1_val': 0.9348034872792208, 'auprc': 0.9977370110247451, 'loss_val': 0.1521301860353856, 'psi': 0.9599768967774306}
[S4] START round=46 head_norm_before_train=1.959295 cos_to_last_merge=1.0000 (last merge round=43)
[S4] round=46 local utility u=0.023843 metrics={'f1_val': 0.9414013739973959, 'auprc': 0.96693357843042, 'loss_val': 0.2797439374026014, 'psi': 0.9516142557706055}-{'f1_val': 0.9382668782291026, 'auprc': 0.962092618184736, 'loss_val': 0.2941003450457716, 'psi': 0.947797174211356}
[S5] START round=46 head_norm_before_train=2.144696 cos_to_last_merge=1.0000 (last merge round=45)
[S5] round=46 local utility u=0.447205 metrics={'f1_val': 0.8596125175491268, 'auprc': 0.9902993449616582, 'loss_val': 0.20502992151675192, 'psi': 0.9118872485141394}-{'f1_val': 0.7000725525005456, 'auprc': 0.9921240413989755, 'loss_val': 0.14767480957728907, 'psi': 0.8168931480599175}
[S6] START round=46 head_norm_before_train=1.403742 cos_to_last_merge=0.9998 (last merge round=44)
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.9269616209708209, 'auprc': 0.9382829558103806, 'loss_val': 0.2612104011684558, 'psi': 0.9314901549066448}-{'f1_val': 0.9504919961943039, 'auprc': 0.9413054602530057, 'loss_val': 0.2795839450007889, 'psi': 0.9468173818177846}
[S7] START round=46 head_norm_before_train=1.508733 cos_to_last_merge=0.9999 (last merge round=44)
[S7] round=46 local utility u=0.495392 metrics={'f1_val': 0.6986346193833923, 'auprc': 0.9403646530923853, 'loss_val': 0.3192143394284211, 'psi': 0.7953266328669895}-{'f1_val': 0.6494466864396191, 'auprc': 0.805878459560895, 'loss_val': 0.6114127151375107, 'psi': 0.7120193956881296}
[S8] START round=46 head_norm_before_train=2.037419 (no previous merge yet)
[S8] round=46 local utility u=0.001388 metrics={'f1_val': 0.9837298055796642, 'auprc': 0.9990488409434926, 'loss_val': 0.04922535249237942, 'psi': 0.9898574197251955}-{'f1_val': 0.9837508313543211, 'auprc': 0.9989614571439697, 'loss_val': 0.051866275284220685, 'psi': 0.9898350816701805}
[S9] START round=46 head_norm_before_train=1.541607 cos_to_last_merge=0.9582 (last merge round=28)
[S9] round=46 local utility u=0.002393 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9919977068453305, 'loss_val': 0.030488823546282746, 'psi': 0.9948145774969895}-{'f1_val': 0.9966924912647621, 'auprc': 0.9910665161526763, 'loss_val': 0.03248183034519739, 'psi': 0.9944421012199278}
[S10] START round=46 head_norm_before_train=2.031081 cos_to_last_merge=1.0000 (last merge round=45)
[S10] round=46 local utility u=0.000000 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9957685075880902, 'loss_val': 0.03443711737993585, 'psi': 0.9943670279277796}-{'f1_val': 0.9934327081542391, 'auprc': 0.995861442350648, 'loss_val': 0.034267795769168066, 'psi': 0.9944042018328028}
[S11] START round=46 head_norm_before_train=2.163967 cos_to_last_merge=0.9981 (last merge round=36)
[S11] round=46 local utility u=0.006061 metrics={'f1_val': 0.9963753869090841, 'auprc': 0.9983575067028523, 'loss_val': 0.02083548103856713, 'psi': 0.9971682348265913}-{'f1_val': 0.9961336749133093, 'auprc': 0.9977080926290547, 'loss_val': 0.029558906836149146, 'psi': 0.9967634419996074}
[S13] START round=46 head_norm_before_train=1.950653 cos_to_last_merge=1.0000 (last merge round=45)
[S13] round=46 local utility u=0.242138 metrics={'f1_val': 0.6263279787506832, 'auprc': 0.7456397285101772, 'loss_val': 0.6654850778362946, 'psi': 0.6740526786544808}-{'f1_val': 0.613594098506861, 'auprc': 0.6375184421477026, 'loss_val': 0.7489930729864109, 'psi': 0.6231638359631977}
[S14] START round=46 head_norm_before_train=2.022879 cos_to_last_merge=0.9884 (last merge round=25)
[S14] round=46 local utility u=0.001474 metrics={'f1_val': 0.9967774409524363, 'auprc': 0.9989357357642168, 'loss_val': 0.024157599615736176, 'psi': 0.9976407588771485}-{'f1_val': 0.9973862616479148, 'auprc': 0.997243581031013, 'loss_val': 0.025681650963053988, 'psi': 0.997329189401154}
[S15] START round=46 head_norm_before_train=1.532507 cos_to_last_merge=0.9986 (last merge round=43)
[S15] round=46 local utility u=0.000000 metrics={'f1_val': 0.7526385233862323, 'auprc': 0.9917245793143185, 'loss_val': 0.4144795401228723, 'psi': 0.8482729457574667}-{'f1_val': 0.9576851163879017, 'auprc': 0.9923294608233205, 'loss_val': 0.11555849104824634, 'psi': 0.9715428541620692}
[S16] START round=46 head_norm_before_train=1.515333 cos_to_last_merge=0.9990 (last merge round=43)
[S16] round=46 local utility u=0.006720 metrics={'f1_val': 0.9917951252582332, 'auprc': 0.9888196553747608, 'loss_val': 0.06951013023451574, 'psi': 0.9906049373048442}-{'f1_val': 0.991356625350989, 'auprc': 0.9877732836879433, 'loss_val': 0.07717913126218875, 'psi': 0.9899232886857707}
[S17] START round=46 head_norm_before_train=1.427462 cos_to_last_merge=1.0000 (last merge round=45)
[S17] round=46 local utility u=0.000000 metrics={'f1_val': 0.5648603930059166, 'auprc': 0.7745749060484997, 'loss_val': 0.7679245359169519, 'psi': 0.6487461982229499}-{'f1_val': 0.6079796122626405, 'auprc': 0.9839384937848241, 'loss_val': 0.7190858350421153, 'psi': 0.7583631648715139}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:39003
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:39004
[S14] not sending this round → trigger blocked (psi=0.998)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:39002
[S5] not sending this round → trigger blocked (psi=0.912)
[S13] sending update (kind=head size=1803 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:39013
[S8] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:39008
[S3] RECEIVED delta(kind=head bytes=1795) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=2.042493)
[S3] loaded HEAD from S8 (vec_in norm=2.042493)
[S3] cosine check vs S8: cos=-0.0106
[S3] DROPPED delta from S8 (cos=-0.0106 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1803) from S13
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.954637)
[S4] loaded HEAD from S13 (vec_in norm=1.954637)
[S4] cosine check vs S13: cos=0.9998
[S4] BUFFERED delta from S13 (total buffered=1)
[S2] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1800 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1800) from S7
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.522357)
[S2] loaded HEAD from S7 (vec_in norm=1.522357)
[S2] cosine check vs S7: cos=0.9953
[S2] BUFFERED delta from S7 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1801) from S2
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.524901)
[S7] loaded HEAD from S2 (vec_in norm=1.524901)
[S7] cosine check vs S2: cos=0.9953
[S7] BUFFERED delta from S2 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1800) from S4
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.964750)
[S13] loaded HEAD from S4 (vec_in norm=1.964750)
[S13] cosine check vs S4: cos=0.9998
[S13] BUFFERED delta from S4 (total buffered=1)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=46 metric=0.7526 head_norm=1.564734
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.422058e-01
[S15] stored merged vector for next round verification (round=46)
[S15] DEBUG after merge:  round=46 metric=0.7586 head_norm=1.534213 delta_norm=0.242206
[S15] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=46 metric=0.9414 head_norm=1.964750
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.090392e-02
[S4] stored merged vector for next round verification (round=46)
[S4] DEBUG after merge:  round=46 metric=0.9414 head_norm=1.959589 delta_norm=0.020904
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=46 metric=0.6986 head_norm=1.522357
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.372094e-02
[S7] stored merged vector for next round verification (round=46)
[S7] DEBUG after merge:  round=46 metric=0.6980 head_norm=1.521845 delta_norm=0.073721
[S7] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=46 metric=0.7772 head_norm=1.524901
[S2] _apply_head_vector_avg (torch): Δ‖w‖=7.372094e-02
[S2] stored merged vector for next round verification (round=46)
[S2] DEBUG after merge:  round=46 metric=0.7731 head_norm=1.521845 delta_norm=0.073721
[S2] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S9] not sending this round → trigger blocked (psi=0.995)
[S16] not sending this round → trigger blocked (psi=0.991)
[S2] START round=47 head_norm_before_train=1.521845 cos_to_last_merge=1.0000 (last merge round=46)
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.7160598005399014, 'auprc': 0.8318818139833302, 'loss_val': 0.637569252418712, 'psi': 0.7623886059172729}-{'f1_val': 0.7771900475033242, 'auprc': 0.833332939432068, 'loss_val': 0.5746425913921274, 'psi': 0.7996472042748217}
[S3] START round=47 head_norm_before_train=2.130459 (no previous merge yet)
[S3] round=47 local utility u=0.318741 metrics={'f1_val': 0.9977814963782642, 'auprc': 0.9989151584286525, 'loss_val': 0.021726886534570392, 'psi': 0.9982349611984196}-{'f1_val': 0.9234008616971144, 'auprc': 0.9935353130582558, 'loss_val': 0.19678631405895278, 'psi': 0.951454642241571}
[S4] START round=47 head_norm_before_train=1.959589 cos_to_last_merge=1.0000 (last merge round=46)
[S4] round=47 local utility u=0.003413 metrics={'f1_val': 0.9416277499418946, 'auprc': 0.9685884521711865, 'loss_val': 0.2792404550583566, 'psi': 0.9524120308336114}-{'f1_val': 0.9414013739973959, 'auprc': 0.96693357843042, 'loss_val': 0.2797439374026014, 'psi': 0.9516142557706055}
[S5] START round=47 head_norm_before_train=2.149674 cos_to_last_merge=1.0000 (last merge round=45)
[S5] round=47 local utility u=0.460206 metrics={'f1_val': 0.9963332086366786, 'auprc': 0.9946069336940448, 'loss_val': 0.11786457706516289, 'psi': 0.9956426986596252}-{'f1_val': 0.8596125175491268, 'auprc': 0.9902993449616582, 'loss_val': 0.20502992151675192, 'psi': 0.9118872485141394}
[S6] START round=47 head_norm_before_train=1.428903 cos_to_last_merge=0.9992 (last merge round=44)
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.8413119908179856, 'auprc': 0.8659652539209051, 'loss_val': 0.4567295162546797, 'psi': 0.8511732960591534}-{'f1_val': 0.9269616209708209, 'auprc': 0.9382829558103806, 'loss_val': 0.2612104011684558, 'psi': 0.9314901549066448}
[S7] START round=47 head_norm_before_train=1.521845 cos_to_last_merge=1.0000 (last merge round=46)
[S7] round=47 local utility u=0.000000 metrics={'f1_val': 0.5653569385314214, 'auprc': 0.785943961496023, 'loss_val': 0.9399074228906205, 'psi': 0.653591747717262}-{'f1_val': 0.6986346193833923, 'auprc': 0.9403646530923853, 'loss_val': 0.3192143394284211, 'psi': 0.7953266328669895}
[S8] START round=47 head_norm_before_train=2.042493 (no previous merge yet)
[S8] round=47 local utility u=0.019946 metrics={'f1_val': 0.9885656966123193, 'auprc': 0.9989020341210341, 'loss_val': 0.03790738952872471, 'psi': 0.9927002316158052}-{'f1_val': 0.9837298055796642, 'auprc': 0.9990488409434926, 'loss_val': 0.04922535249237942, 'psi': 0.9898574197251955}
[S9] START round=47 head_norm_before_train=1.554350 cos_to_last_merge=0.9569 (last merge round=28)
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.9895654130089716, 'auprc': 0.9878214129849471, 'loss_val': 0.05236907704903712, 'psi': 0.9888678129993618}-{'f1_val': 0.9966924912647621, 'auprc': 0.9919977068453305, 'loss_val': 0.030488823546282746, 'psi': 0.9948145774969895}
[S10] START round=47 head_norm_before_train=2.040054 cos_to_last_merge=1.0000 (last merge round=45)
[S10] round=47 local utility u=0.000000 metrics={'f1_val': 0.9927344652802075, 'auprc': 0.9974222179993488, 'loss_val': 0.03666834117654179, 'psi': 0.994609566367864}-{'f1_val': 0.9934327081542391, 'auprc': 0.9957685075880902, 'loss_val': 0.03443711737993585, 'psi': 0.9943670279277796}
[S11] START round=47 head_norm_before_train=2.175355 cos_to_last_merge=0.9979 (last merge round=36)
[S11] round=47 local utility u=0.000000 metrics={'f1_val': 0.9814400812334457, 'auprc': 0.9980389138924604, 'loss_val': 0.07452975037892166, 'psi': 0.9880796142970516}-{'f1_val': 0.9963753869090841, 'auprc': 0.9983575067028523, 'loss_val': 0.02083548103856713, 'psi': 0.9971682348265913}
[S13] START round=47 head_norm_before_train=1.954637 cos_to_last_merge=1.0000 (last merge round=45)
[S13] round=47 local utility u=0.503652 metrics={'f1_val': 0.7354287064882814, 'auprc': 0.8848336134028514, 'loss_val': 0.7303665653607394, 'psi': 0.7951906692541094}-{'f1_val': 0.6263279787506832, 'auprc': 0.7456397285101772, 'loss_val': 0.6654850778362946, 'psi': 0.6740526786544808}
[S14] START round=47 head_norm_before_train=2.029548 cos_to_last_merge=0.9880 (last merge round=25)
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.9971882020035234, 'auprc': 0.9972414255731114, 'loss_val': 0.023660980021240553, 'psi': 0.9972094914313585}-{'f1_val': 0.9967774409524363, 'auprc': 0.9989357357642168, 'loss_val': 0.024157599615736176, 'psi': 0.9976407588771485}
[S15] START round=47 head_norm_before_train=1.534213 cos_to_last_merge=1.0000 (last merge round=46)
[S15] round=47 local utility u=0.086754 metrics={'f1_val': 0.7772971059929645, 'auprc': 0.9876260539057811, 'loss_val': 0.3766266223140858, 'psi': 0.8614286851580912}-{'f1_val': 0.7526385233862323, 'auprc': 0.9917245793143185, 'loss_val': 0.4144795401228723, 'psi': 0.8482729457574667}
[S16] START round=47 head_norm_before_train=1.539120 cos_to_last_merge=0.9981 (last merge round=43)
[S16] round=47 local utility u=0.000000 metrics={'f1_val': 0.9907575210750393, 'auprc': 0.988579916243586, 'loss_val': 0.07269809729812167, 'psi': 0.989886479142458}-{'f1_val': 0.9917951252582332, 'auprc': 0.9888196553747608, 'loss_val': 0.06951013023451574, 'psi': 0.9906049373048442}
[S17] START round=47 head_norm_before_train=1.448876 cos_to_last_merge=0.9995 (last merge round=45)
[S17] round=47 local utility u=0.048698 metrics={'f1_val': 0.5874095161024665, 'auprc': 0.7832855991396883, 'loss_val': 0.8319544419962333, 'psi': 0.6657599493173552}-{'f1_val': 0.5648603930059166, 'auprc': 0.7745749060484997, 'loss_val': 0.7679245359169519, 'psi': 0.6487461982229499}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:39009
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.993)
[S13] not sending this round → trigger blocked (psi=0.795)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:39009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:39007
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=47 metric=0.7354 head_norm=1.958575
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.686535e-02
[S13] stored merged vector for next round verification (round=47)
[S13] DEBUG after merge:  round=47 metric=0.6809 head_norm=1.961481 delta_norm=0.026865
[S13] aggregate: ROLLBACK (f1_val pre=0.735 post=0.681 tol_abs=0.005 tol_rel=0.0)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] not sending this round → trigger blocked (psi=0.952)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] RECEIVED delta(kind=head bytes=1801) from S3
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=2.133354)
[S8] loaded HEAD from S3 (vec_in norm=2.133354)
[S8] cosine check vs S3: cos=-0.0108
[S8] DROPPED delta from S3 (cos=-0.0108 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:39007
[S15] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1802) from S15
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.565676)
[S6] loaded HEAD from S15 (vec_in norm=1.565676)
[S6] cosine check vs S15: cos=0.9245
[S6] BUFFERED delta from S15 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1795) from S5
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=2.154027)
[S8] loaded HEAD from S5 (vec_in norm=2.154027)
[S8] cosine check vs S5: cos=-0.0196
[S8] DROPPED delta from S5 (cos=-0.0196 < 0.0)
[S17] sending update (kind=head size=1800 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1800) from S17
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.475509)
[S6] loaded HEAD from S17 (vec_in norm=1.475509)
[S6] cosine check vs S17: cos=0.9724
[S6] BUFFERED delta from S17 (total buffered=2)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=47 metric=0.8413 head_norm=1.456755
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.732760e-01
[S6] stored merged vector for next round verification (round=47)
[S6] DEBUG after merge:  round=47 metric=0.8417 head_norm=1.459252 delta_norm=0.173276
[S6] aggregate: ACCEPT kept=['S15', 'S17'] (k=2/2) mode=median trim_p=0.1
[S2] START round=48 head_norm_before_train=1.537931 cos_to_last_merge=1.0000 (last merge round=46)
[S2] round=48 local utility u=0.066973 metrics={'f1_val': 0.7162151862811907, 'auprc': 0.8520570998965142, 'loss_val': 0.5650821536994771, 'psi': 0.7705519517273202}-{'f1_val': 0.7160598005399014, 'auprc': 0.8318818139833302, 'loss_val': 0.637569252418712, 'psi': 0.7623886059172729}
[S3] START round=48 head_norm_before_train=2.133354 (no previous merge yet)
[S3] round=48 local utility u=0.000000 metrics={'f1_val': 0.9973670153333725, 'auprc': 0.9991367530257513, 'loss_val': 0.02602736812058116, 'psi': 0.998074910410324}-{'f1_val': 0.9977814963782642, 'auprc': 0.9989151584286525, 'loss_val': 0.021726886534570392, 'psi': 0.9982349611984196}
[S4] START round=48 head_norm_before_train=1.961066 cos_to_last_merge=1.0000 (last merge round=46)
[S4] round=48 local utility u=0.004438 metrics={'f1_val': 0.943283379753731, 'auprc': 0.9684087069077061, 'loss_val': 0.2797590357598164, 'psi': 0.9533335106153211}-{'f1_val': 0.9416277499418946, 'auprc': 0.9685884521711865, 'loss_val': 0.2792404550583566, 'psi': 0.9524120308336114}
[S5] START round=48 head_norm_before_train=2.154027 cos_to_last_merge=1.0000 (last merge round=45)
[S5] round=48 local utility u=0.000000 metrics={'f1_val': 0.9960398919057053, 'auprc': 0.9927696539276011, 'loss_val': 0.11586934462072886, 'psi': 0.9947317967144635}-{'f1_val': 0.9963332086366786, 'auprc': 0.9946069336940448, 'loss_val': 0.11786457706516289, 'psi': 0.9956426986596252}
[S6] START round=48 head_norm_before_train=1.459252 cos_to_last_merge=1.0000 (last merge round=47)
[S6] round=48 local utility u=0.000000 metrics={'f1_val': 0.6538890522084532, 'auprc': 0.6684614070159312, 'loss_val': 0.8983004016348988, 'psi': 0.6597179941314444}-{'f1_val': 0.8413119908179856, 'auprc': 0.8659652539209051, 'loss_val': 0.4567295162546797, 'psi': 0.8511732960591534}
[S7] START round=48 head_norm_before_train=1.531323 cos_to_last_merge=1.0000 (last merge round=46)
[S7] round=48 local utility u=1.000000 metrics={'f1_val': 0.6996583456524053, 'auprc': 0.9843290720315464, 'loss_val': 0.26669989439913383, 'psi': 0.8135266362040617}-{'f1_val': 0.5653569385314214, 'auprc': 0.785943961496023, 'loss_val': 0.9399074228906205, 'psi': 0.653591747717262}
[S8] START round=48 head_norm_before_train=2.046580 (no previous merge yet)
[S8] round=48 local utility u=0.013763 metrics={'f1_val': 0.9923167377520978, 'auprc': 0.9988241651744239, 'loss_val': 0.03265416318095003, 'psi': 0.9949197087210283}-{'f1_val': 0.9885656966123193, 'auprc': 0.9989020341210341, 'loss_val': 0.03790738952872471, 'psi': 0.9927002316158052}
[S9] START round=48 head_norm_before_train=1.565501 cos_to_last_merge=0.9557 (last merge round=28)
[S9] round=48 local utility u=0.004151 metrics={'f1_val': 0.9876029063437939, 'auprc': 0.9950385279258249, 'loss_val': 0.053943012301154905, 'psi': 0.9905771549766064}-{'f1_val': 0.9895654130089716, 'auprc': 0.9878214129849471, 'loss_val': 0.05236907704903712, 'psi': 0.9888678129993618}
[S10] START round=48 head_norm_before_train=2.048703 cos_to_last_merge=1.0000 (last merge round=45)
[S10] round=48 local utility u=0.004282 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.994503809912343, 'loss_val': 0.03143302579575028, 'psi': 0.9946506894965608}-{'f1_val': 0.9927344652802075, 'auprc': 0.9974222179993488, 'loss_val': 0.03666834117654179, 'psi': 0.994609566367864}
[S11] START round=48 head_norm_before_train=2.186176 cos_to_last_merge=0.9976 (last merge round=36)
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.9535731057875573, 'auprc': 0.9977782366267983, 'loss_val': 0.10456422630188442, 'psi': 0.9712551581232537}-{'f1_val': 0.9814400812334457, 'auprc': 0.9980389138924604, 'loss_val': 0.07452975037892166, 'psi': 0.9880796142970516}
[S13] START round=48 head_norm_before_train=1.961481 cos_to_last_merge=1.0000 (last merge round=47)
[S13] round=48 local utility u=0.000000 metrics={'f1_val': 0.6198902858872842, 'auprc': 0.8002635450447877, 'loss_val': 0.7684130769862774, 'psi': 0.6920395895502855}-{'f1_val': 0.7354287064882814, 'auprc': 0.8848336134028514, 'loss_val': 0.7303665653607394, 'psi': 0.7951906692541094}
[S14] START round=48 head_norm_before_train=2.035647 cos_to_last_merge=0.9876 (last merge round=25)
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9972497171838971, 'loss_val': 0.02554382197488812, 'psi': 0.997098391768158}-{'f1_val': 0.9971882020035234, 'auprc': 0.9972414255731114, 'loss_val': 0.023660980021240553, 'psi': 0.9972094914313585}
[S15] START round=48 head_norm_before_train=1.565676 cos_to_last_merge=0.9995 (last merge round=46)
[S15] round=48 local utility u=0.445894 metrics={'f1_val': 0.8944122138662982, 'auprc': 0.9895366718419024, 'loss_val': 0.1932605813998399, 'psi': 0.9324619970565399}-{'f1_val': 0.7772971059929645, 'auprc': 0.9876260539057811, 'loss_val': 0.3766266223140858, 'psi': 0.8614286851580912}
[S16] START round=48 head_norm_before_train=1.560179 cos_to_last_merge=0.9970 (last merge round=43)
[S16] round=48 local utility u=0.013394 metrics={'f1_val': 0.991575838119279, 'auprc': 0.991862032869208, 'loss_val': 0.06066724098988426, 'psi': 0.9916903160192505}-{'f1_val': 0.9907575210750393, 'auprc': 0.988579916243586, 'loss_val': 0.07269809729812167, 'psi': 0.989886479142458}
[S17] START round=48 head_norm_before_train=1.475509 cos_to_last_merge=0.9978 (last merge round=45)
[S17] round=48 local utility u=0.000000 metrics={'f1_val': 0.5399454547019521, 'auprc': 0.7268840204570658, 'loss_val': 1.0651357363324778, 'psi': 0.6147208810039976}-{'f1_val': 0.5874095161024665, 'auprc': 0.7832855991396883, 'loss_val': 0.8319544419962333, 'psi': 0.6657599493173552}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:39003
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:39013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:39004
[S15] not sending this round → trigger blocked (psi=0.932)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S2@127.0.0.1:39002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:39008
[S3] RECEIVED delta(kind=head bytes=1799) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=2.054693)
[S3] loaded HEAD from S8 (vec_in norm=2.054693)
[S3] cosine check vs S8: cos=-0.0111
[S3] DROPPED delta from S8 (cos=-0.0111 < 0.0)
[S10] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1804 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1802) from S2
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.552119)
[S7] loaded HEAD from S2 (vec_in norm=1.552119)
[S7] cosine check vs S2: cos=0.9996
[S7] BUFFERED delta from S2 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1804) from S7
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.538069)
[S2] loaded HEAD from S7 (vec_in norm=1.538069)
[S2] cosine check vs S7: cos=0.9996
[S2] BUFFERED delta from S7 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1802) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=2.057628)
[S4] loaded HEAD from S10 (vec_in norm=2.057628)
[S4] cosine check vs S10: cos=0.9956
[S4] BUFFERED delta from S10 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1799) from S4
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.966090)
[S13] loaded HEAD from S4 (vec_in norm=1.966090)
[S13] cosine check vs S4: cos=0.9999
[S13] BUFFERED delta from S4 (total buffered=1)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=48 metric=0.7162 head_norm=1.552119
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.328915e-02
[S2] stored merged vector for next round verification (round=48)
[S2] DEBUG after merge:  round=48 metric=0.7162 head_norm=1.544934 delta_norm=0.023289
[S2] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=48 metric=0.9433 head_norm=1.966090
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.049324e-01
[S4] stored merged vector for next round verification (round=48)
[S4] DEBUG after merge:  round=48 metric=0.9429 head_norm=2.009642 delta_norm=0.104932
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=48 metric=0.6997 head_norm=1.538069
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.328915e-02
[S7] stored merged vector for next round verification (round=48)
[S7] DEBUG after merge:  round=48 metric=0.6997 head_norm=1.544934 delta_norm=0.023289
[S7] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:39015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:39017
[S9] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1798) from S16
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.578887)
[S17] loaded HEAD from S16 (vec_in norm=1.578887)
[S17] cosine check vs S16: cos=0.9684
[S17] BUFFERED delta from S16 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1802) from S9
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.574679)
[S15] loaded HEAD from S9 (vec_in norm=1.574679)
[S15] cosine check vs S9: cos=0.9755
[S15] BUFFERED delta from S9 (total buffered=1)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=48 metric=0.5399 head_norm=1.500190
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.975103e-01
[S17] stored merged vector for next round verification (round=48)
[S17] DEBUG after merge:  round=48 metric=0.5390 head_norm=1.527323 delta_norm=0.197510
[S17] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=49 head_norm_before_train=1.544934 cos_to_last_merge=1.0000 (last merge round=48)
[S2] round=49 local utility u=0.374935 metrics={'f1_val': 0.8122060430938935, 'auprc': 0.8604178934253607, 'loss_val': 0.4162406381140442, 'psi': 0.8314907832264804}-{'f1_val': 0.7162151862811907, 'auprc': 0.8520570998965142, 'loss_val': 0.5650821536994771, 'psi': 0.7705519517273202}
[S3] START round=49 head_norm_before_train=2.139144 (no previous merge yet)
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9987367683879043, 'loss_val': 0.11116149689187706, 'psi': 0.9761158580184279}-{'f1_val': 0.9973670153333725, 'auprc': 0.9991367530257513, 'loss_val': 0.02602736812058116, 'psi': 0.998074910410324}
[S4] START round=49 head_norm_before_train=2.009642 cos_to_last_merge=1.0000 (last merge round=48)
[S4] round=49 local utility u=0.041064 metrics={'f1_val': 0.955648098325943, 'auprc': 0.9667770254960577, 'loss_val': 0.2669236498511303, 'psi': 0.9600996691939889}-{'f1_val': 0.943283379753731, 'auprc': 0.9684087069077061, 'loss_val': 0.2797590357598164, 'psi': 0.9533335106153211}
[S5] START round=49 head_norm_before_train=2.158452 cos_to_last_merge=0.9999 (last merge round=45)
[S5] round=49 local utility u=0.000000 metrics={'f1_val': 0.8291013863355009, 'auprc': 0.990261156047618, 'loss_val': 0.2161968542377905, 'psi': 0.8935652942203478}-{'f1_val': 0.9960398919057053, 'auprc': 0.9927696539276011, 'loss_val': 0.11586934462072886, 'psi': 0.9947317967144635}
[S6] START round=49 head_norm_before_train=1.481936 cos_to_last_merge=0.9998 (last merge round=47)
[S6] round=49 local utility u=0.839885 metrics={'f1_val': 0.8191490437940057, 'auprc': 0.7847659462774959, 'loss_val': 0.5590037241260624, 'psi': 0.8053958047874017}-{'f1_val': 0.6538890522084532, 'auprc': 0.6684614070159312, 'loss_val': 0.8983004016348988, 'psi': 0.6597179941314444}
[S7] START round=49 head_norm_before_train=1.544934 cos_to_last_merge=1.0000 (last merge round=48)
[S7] round=49 local utility u=0.000000 metrics={'f1_val': 0.5993689630686498, 'auprc': 0.7924787055192599, 'loss_val': 0.7838808918143155, 'psi': 0.6766128600488939}-{'f1_val': 0.6996583456524053, 'auprc': 0.9843290720315464, 'loss_val': 0.26669989439913383, 'psi': 0.8135266362040617}
[S8] START round=49 head_norm_before_train=2.054693 (no previous merge yet)
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.7136010659665415, 'auprc': 0.984961670603758, 'loss_val': 0.36759902121786026, 'psi': 0.8221453078214281}-{'f1_val': 0.9923167377520978, 'auprc': 0.9988241651744239, 'loss_val': 0.03265416318095003, 'psi': 0.9949197087210283}
[S9] START round=49 head_norm_before_train=1.574679 cos_to_last_merge=0.9547 (last merge round=28)
[S9] round=49 local utility u=0.041079 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9953755899460812, 'loss_val': 0.029795342798853375, 'psi': 0.9964119834857181}-{'f1_val': 0.9876029063437939, 'auprc': 0.9950385279258249, 'loss_val': 0.053943012301154905, 'psi': 0.9905771549766064}
[S10] START round=49 head_norm_before_train=2.057628 cos_to_last_merge=0.9999 (last merge round=45)
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.9931720938432163, 'auprc': 0.9972134931222438, 'loss_val': 0.034607424760812466, 'psi': 0.9947886535548274}-{'f1_val': 0.9947486092193725, 'auprc': 0.994503809912343, 'loss_val': 0.03143302579575028, 'psi': 0.9946506894965608}
[S11] START round=49 head_norm_before_train=2.195513 cos_to_last_merge=0.9974 (last merge round=36)
[S11] round=49 local utility u=0.165832 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9977988555941055, 'loss_val': 0.02687382762902895, 'psi': 0.9966546449587906}-{'f1_val': 0.9535731057875573, 'auprc': 0.9977782366267983, 'loss_val': 0.10456422630188442, 'psi': 0.9712551581232537}
[S13] START round=49 head_norm_before_train=1.965814 cos_to_last_merge=1.0000 (last merge round=47)
[S13] round=49 local utility u=0.070048 metrics={'f1_val': 0.6502474684756065, 'auprc': 0.7830347651030474, 'loss_val': 0.7587730930360946, 'psi': 0.7033623871265828}-{'f1_val': 0.6198902858872842, 'auprc': 0.8002635450447877, 'loss_val': 0.7684130769862774, 'psi': 0.6920395895502855}
[S14] START round=49 head_norm_before_train=2.041052 cos_to_last_merge=0.9872 (last merge round=25)
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.9971652929977585, 'auprc': 0.9973405046348393, 'loss_val': 0.027119777876117808, 'psi': 0.9972353776525908}-{'f1_val': 0.9969975081576651, 'auprc': 0.9972497171838971, 'loss_val': 0.02554382197488812, 'psi': 0.997098391768158}
[S15] START round=49 head_norm_before_train=1.601106 cos_to_last_merge=0.9981 (last merge round=46)
[S15] round=49 local utility u=0.358353 metrics={'f1_val': 0.9934061928437574, 'auprc': 0.9907011976256538, 'loss_val': 0.07401296147896963, 'psi': 0.992324194756516}-{'f1_val': 0.8944122138662982, 'auprc': 0.9895366718419024, 'loss_val': 0.1932605813998399, 'psi': 0.9324619970565399}
[S16] START round=49 head_norm_before_train=1.578887 cos_to_last_merge=0.9960 (last merge round=43)
[S16] round=49 local utility u=0.000000 metrics={'f1_val': 0.9165369759615721, 'auprc': 0.9801783028982815, 'loss_val': 0.21473388037027608, 'psi': 0.9419935067362559}-{'f1_val': 0.991575838119279, 'auprc': 0.991862032869208, 'loss_val': 0.06066724098988426, 'psi': 0.9916903160192505}
[S17] START round=49 head_norm_before_train=1.527323 cos_to_last_merge=1.0000 (last merge round=48)
[S17] round=49 local utility u=0.970515 metrics={'f1_val': 0.7009088558328169, 'auprc': 0.9116571543150613, 'loss_val': 0.6442050433023981, 'psi': 0.7852081752257147}-{'f1_val': 0.5399454547019521, 'auprc': 0.7268840204570658, 'loss_val': 1.0651357363324778, 'psi': 0.6147208810039976}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:39004
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:39005
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:39015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:39007
[S2] not sending this round → trigger blocked (psi=0.831)
[S13] sending update (kind=head size=1801 to 1 peers)
[S4] not sending this round → trigger blocked (psi=0.960)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] RECEIVED delta(kind=head bytes=1801) from S13
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.972518)
[S4] loaded HEAD from S13 (vec_in norm=1.972518)
[S4] cosine check vs S13: cos=0.9985
[S4] BUFFERED delta from S13 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1797) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=2.206048)
[S5] loaded HEAD from S11 (vec_in norm=2.206048)
[S5] cosine check vs S11: cos=0.9992
[S5] BUFFERED delta from S11 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:39007
[S15] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=49 metric=0.6502 head_norm=1.972518
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.597560e-02
[S13] stored merged vector for next round verification (round=49)
[S13] DEBUG after merge:  round=49 metric=0.6624 head_norm=1.969136 delta_norm=0.025976
[S13] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S15] RECEIVED delta(kind=head bytes=1800) from S6
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.503955)
[S15] loaded HEAD from S6 (vec_in norm=1.503955)
[S15] cosine check vs S6: cos=0.9577
[S15] BUFFERED delta from S6 (total buffered=2)
[S6] RECEIVED delta(kind=head bytes=1799) from S15
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.635022)
[S6] loaded HEAD from S15 (vec_in norm=1.635022)
[S6] cosine check vs S15: cos=0.9577
[S6] BUFFERED delta from S15 (total buffered=1)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=49 metric=0.8291 head_norm=2.161939
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.913060e-02
[S5] stored merged vector for next round verification (round=49)
[S5] DEBUG after merge:  round=49 metric=0.8402 head_norm=2.183553 delta_norm=0.049131
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S17] sending update (kind=head size=1802 to 1 peers)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=49 metric=0.9556 head_norm=2.015435
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.928981e-02
[S4] stored merged vector for next round verification (round=49)
[S4] DEBUG after merge:  round=49 metric=0.9556 head_norm=1.993210 delta_norm=0.059290
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S6] RECEIVED delta(kind=head bytes=1802) from S17
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.545179)
[S6] loaded HEAD from S17 (vec_in norm=1.545179)
[S6] cosine check vs S17: cos=0.9670
[S6] BUFFERED delta from S17 (total buffered=2)
[S9] not sending this round → trigger blocked (psi=0.996)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=49 metric=0.9934 head_norm=1.635022
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.345399e-01
[S15] stored merged vector for next round verification (round=49)
[S15] DEBUG after merge:  round=49 metric=0.9934 head_norm=1.563286 delta_norm=0.134540
[S15] aggregate: ACCEPT kept=['S9', 'S6'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=49 metric=0.8191 head_norm=1.503955
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.281855e-01
[S6] stored merged vector for next round verification (round=49)
[S6] DEBUG after merge:  round=49 metric=0.8194 head_norm=1.522323 delta_norm=0.128185
[S6] aggregate: ACCEPT kept=['S15', 'S17'] (k=2/2) mode=median trim_p=0.1
[runner] rounds complete.
[runner] all agents stopped.
