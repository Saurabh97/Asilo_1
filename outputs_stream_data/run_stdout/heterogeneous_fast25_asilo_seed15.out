[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:42003
[S3] → join 127.0.0.1:42002
[S4] → join 127.0.0.1:42002
[S5] → join 127.0.0.1:42002
[S6] → join 127.0.0.1:42002
[S7] → join 127.0.0.1:42002
[S8] → join 127.0.0.1:42002
[S9] → join 127.0.0.1:42002
[S10] → join 127.0.0.1:42002
[S11] → join 127.0.0.1:42002
[S13] → join 127.0.0.1:42002
[S14] → join 127.0.0.1:42002
[S15] → join 127.0.0.1:42002
[S16] → join 127.0.0.1:42002
[S17] → join 127.0.0.1:42002
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.165876 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.113454 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.218474 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.144484 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.187327 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.123975 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.187820 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.167664 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.213392 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.203606 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.145488 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.156565 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.194224 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.203535 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.123627 (no previous merge yet)
[S4]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S3] + discovered S6
[S4] + discovered S3
[S3] + discovered S16
[S3] + discovered S7
[S3] + discovered S8
[S3] + discovered S14
[S3] + discovered S13
[S3] + discovered S5
[S3] + discovered S4
[S3] + discovered S9
[S3] + discovered S17
[S3] + discovered S10
[S3] + discovered S15
[S4] + discovered S2
[S3] + discovered S11
[S5] + discovered S3
[S5] + discovered S4
[S5] + discovered S2
[S4] + discovered S6
[S4] + discovered S11
[S4] + discovered S15
[S4] + discovered S10
[S4] + discovered S17
[S4] + discovered S5
[S4] + discovered S13
[S4] + discovered S14
[S4] + discovered S8
[S4] + discovered S9
[S4] + discovered S16
[S4] + discovered S7
[S6] + discovered S5
[S6] + discovered S4
[S6] + discovered S3
[S6] + discovered S2
[S5] + discovered S6
[S5] + discovered S14
[S5] + discovered S15
[S5] + discovered S17
[S5] + discovered S10
[S5] + discovered S13
[S5] + discovered S9
[S5] + discovered S16
[S5] + discovered S7
[S5] + discovered S11
[S5] + discovered S8
[S6] + discovered S10
[S6] + discovered S13
[S6] + discovered S7
[S6] + discovered S8
[S6] + discovered S14
[S6] + discovered S15
[S7] + discovered S3
[S7] + discovered S2
[S6] + discovered S11
[S7] + discovered S4
[S7] + discovered S5
[S7] + discovered S6
[S6] + discovered S17
[S6] + discovered S9
[S6] + discovered S16
[S8] + discovered S6
[S8] + discovered S5
[S8] + discovered S4
[S8] + discovered S7
[S8] + discovered S3
[S7] + discovered S14
[S8] + discovered S2
[S7] + discovered S10
[S7] + discovered S11
[S7] + discovered S17
[S7] + discovered S9
[S7] + discovered S15
[S7] + discovered S8
[S7] + discovered S13
[S7] + discovered S16
[S8] + discovered S15
[S8] + discovered S16
[S8] + discovered S10
[S8] + discovered S13
[S8] + discovered S14
[S8] + discovered S9
[S8] + discovered S17
[S8] + discovered S11
[S9] + discovered S7
[S9] + discovered S8
[S9] + discovered S5
[S9] + discovered S2
[S9] + discovered S3
[S9] + discovered S4
[S9] + discovered S6
[S10] + discovered S4
[S10] + discovered S7
[S10] + discovered S8
[S10] + discovered S9
[S10] + discovered S6
[S10] + discovered S5
[S10] + discovered S2
[S10] + discovered S3
[S9] + discovered S15
[S9] + discovered S17
[S9] + discovered S11
[S9] + discovered S16
[S9] + discovered S10
[S9] + discovered S13
[S9] + discovered S14
[S11] + discovered S7
[S11] + discovered S6
[S10] + discovered S16
[S10] + discovered S17
[S11] + discovered S9
[S11] + discovered S8
[S10] + discovered S13
[S11] + discovered S3
[S11] + discovered S2
[S10] + discovered S15
[S10] + discovered S11
[S11] + discovered S5
[S10] + discovered S14
[S11] + discovered S10
[S11] + discovered S4
[S13] + discovered S7
[S11] + discovered S17
[S11] + discovered S16
[S13] + discovered S8
[S13] + discovered S10
[S13] + discovered S4
[S13] + discovered S2
[S11] + discovered S13
[S13] + discovered S5
[S11] + discovered S15
[S13] + discovered S9
[S13] + discovered S3
[S13] + discovered S6
[S11] + discovered S14
[S13] + discovered S11
[S13] + discovered S16
[S13] + discovered S17
[S14] + discovered S4
[S14] + discovered S7
[S14] + discovered S5
[S14] + discovered S2
[S13] + discovered S14
[S14] + discovered S10
[S14] + discovered S13
[S14] + discovered S9
[S14] + discovered S3
[S14] + discovered S11
[S14] + discovered S6
[S14] + discovered S8
[S13] + discovered S15
[S14] + discovered S16
[S15] + discovered S6
[S15] + discovered S8
[S15] + discovered S11
[S15] + discovered S14
[S15] + discovered S3
[S15] + discovered S9
[S15] + discovered S10
[S15] + discovered S2
[S15] + discovered S13
[S15] + discovered S7
[S15] + discovered S5
[S14] + discovered S17
[S15] + discovered S4
[S14] + discovered S15
[S16] + discovered S4
[S16] + discovered S2
[S16] + discovered S10
[S16] + discovered S11
[S16] + discovered S14
[S16] + discovered S9
[S16] + discovered S6
[S16] + discovered S7
[S16] + discovered S5
[S16] + discovered S8
[S16] + discovered S13
[S16] + discovered S3
[S16] + discovered S15
[S15] + discovered S17
[S15] + discovered S16
[S17] + discovered S2
[S16] + discovered S17
[S17] + discovered S10
[S17] + discovered S4
[S17] + discovered S8
[S17] + discovered S11
[S17] + discovered S14
[S17] + discovered S5
[S17] + discovered S7
[S17] + discovered S9
[S17] + discovered S3
[S17] + discovered S16
[S17] + discovered S15
[S17] + discovered S6
[S17] + discovered S13
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] ⇄ pheromone p=1.000 → S17@127.0.0.1:42017
[S7] ⇄ pheromone p=1.000 → S14@127.0.0.1:42014
[S15] ⇄ pheromone p=1.000 → S11@127.0.0.1:42012
[S13] ⇄ pheromone p=1.000 → S4@127.0.0.1:42004
[S8] ⇄ pheromone p=1.000 → S4@127.0.0.1:42004
[S3] ⇄ pheromone p=1.000 → S9@127.0.0.1:42010
[S5] ⇄ pheromone p=1.000 → S16@127.0.0.1:42016
[S6] ⇄ pheromone p=1.000 → S11@127.0.0.1:42012
[S2] ⇄ pheromone p=1.000 → S13@127.0.0.1:42013
[S9] ⇄ pheromone p=1.000 → S17@127.0.0.1:42017
[S11] ⇄ pheromone p=1.000 → S13@127.0.0.1:42013
[S4] ⇄ pheromone p=1.000 → S8@127.0.0.1:42009
[S14] ⇄ pheromone p=1.000 → S15@127.0.0.1:42015
[S10] ⇄ pheromone p=1.000 → S3@127.0.0.1:42003
[S17] ⇄ pheromone p=1.000 → S3@127.0.0.1:42003
[S2] START round=1 head_norm_before_train=1.174234 (no previous merge yet)
[S2] round=1 local utility u=0.241653 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.694838641159035, 'loss_val': 1.3100812018313228, 'psi': 0.36300173649675405}-{'f1_val': 0.17993320902204943, 'auprc': 0.46903573007000865, 'loss_val': 1.344915597124348, 'psi': 0.29557421744123313}
[S3] START round=1 head_norm_before_train=1.125090 (no previous merge yet)
[S3] round=1 local utility u=0.658194 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9852788242874316, 'loss_val': 1.2852222773191977, 'psi': 0.4780155690834369}-{'f1_val': 0.13984006561410703, 'auprc': 0.5634840751314181, 'loss_val': 1.3362251575563453, 'psi': 0.30929766942103143}
[S4] START round=1 head_norm_before_train=1.219973 (no previous merge yet)
[S4] round=1 local utility u=0.703556 metrics={'f1_val': 0.3143201186048803, 'auprc': 0.767351133376346, 'loss_val': 1.3410412324697287, 'psi': 0.49553252451346663}-{'f1_val': 0.08833063209076175, 'auprc': 0.7621073960277416, 'loss_val': 1.3764849378157664, 'psi': 0.3578413376655537}
[S5] START round=1 head_norm_before_train=1.152309 (no previous merge yet)
[S5] round=1 local utility u=0.014840 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7345248997340619, 'loss_val': 1.2564710874815668, 'psi': 0.3791671027507676}-{'f1_val': 0.14226190476190476, 'auprc': 0.7486239057948663, 'loss_val': 1.328447386076373, 'psi': 0.38480670517508936}
[S6] START round=1 head_norm_before_train=1.188444 (no previous merge yet)
[S6] round=1 local utility u=1.000000 metrics={'f1_val': 0.38625722424008846, 'auprc': 0.7596174982396937, 'loss_val': 1.3302982982326141, 'psi': 0.5356013338399306}-{'f1_val': 0.08954368264159597, 'auprc': 0.6227212322538453, 'loss_val': 1.3593587144944297, 'psi': 0.3028147024864957}
[S7] START round=1 head_norm_before_train=1.144511 (no previous merge yet)
[S7] round=1 local utility u=0.000845 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7801626854197338, 'loss_val': 1.2731788580294456, 'psi': 0.3972991678053485}-{'f1_val': 0.14205682272909165, 'auprc': 0.7993821607784278, 'loss_val': 1.332527979176508, 'psi': 0.40498695794882617}
[S8] START round=1 head_norm_before_train=1.192223 (no previous merge yet)
[S8] round=1 local utility u=0.228975 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7827520519654485, 'loss_val': 1.3046942109056876, 'psi': 0.3970744102219537}-{'f1_val': 0.13995598239295717, 'auprc': 0.6401442310804522, 'loss_val': 1.3348209483919264, 'psi': 0.34003128186795517}
[S9] START round=1 head_norm_before_train=1.175653 (no previous merge yet)
[S9] round=1 local utility u=0.109558 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8656001901209938, 'loss_val': 1.263205173919494, 'psi': 0.4310788503323951}-{'f1_val': 0.141397957139996, 'auprc': 0.8133711978843181, 'loss_val': 1.3256349849130311, 'psi': 0.4101872534377249}
[S10] START round=1 head_norm_before_train=1.221247 (no previous merge yet)
[S10] round=1 local utility u=0.878233 metrics={'f1_val': 0.3900661720720554, 'auprc': 0.7933430965880875, 'loss_val': 1.319951663668128, 'psi': 0.5513769418784683}-{'f1_val': 0.11038389861184615, 'auprc': 0.7794055476428575, 'loss_val': 1.3565122855206555, 'psi': 0.3779925582242507}
[S11] START round=1 head_norm_before_train=1.208369 (no previous merge yet)
[S11] round=1 local utility u=0.051708 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.9481870975325237, 'loss_val': 1.3112131974270296, 'psi': 0.46352304903687586}-{'f1_val': 0.14041368337311058, 'auprc': 0.9242863489939627, 'loss_val': 1.3429268879528549, 'psi': 0.45396274962145144}
[S13] START round=1 head_norm_before_train=1.150286 (no previous merge yet)
[S13] round=1 local utility u=0.066347 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6187019245602308, 'loss_val': 1.321855115083699, 'psi': 0.3317122273703242}-{'f1_val': 0.1403857625770531, 'auprc': 0.5850389722756455, 'loss_val': 1.3535594795180133, 'psi': 0.31824704645649005}
[S14] START round=1 head_norm_before_train=1.165933 (no previous merge yet)
[S14] round=1 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.6879675992814587, 'loss_val': 1.3398699505513463, 'psi': 0.3594017514422057}-{'f1_val': 0.246505434046133, 'auprc': 0.660767198113175, 'loss_val': 1.3703158663357795, 'psi': 0.41221013967294984}
[S15] START round=1 head_norm_before_train=1.194921 (no previous merge yet)
[S15] round=1 local utility u=0.588982 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7383252955277659, 'loss_val': 1.3480885736570967, 'psi': 0.3791703090280414}-{'f1_val': 0.07497510174251977, 'auprc': 0.48611344906543896, 'loss_val': 1.380865297028965, 'psi': 0.23943044067168745}
[S16] START round=1 head_norm_before_train=1.214996 (no previous merge yet)
[S16] round=1 local utility u=0.000000 metrics={'f1_val': 0.19595269013047314, 'auprc': 0.7902435874048, 'loss_val': 1.3156866084992067, 'psi': 0.4336690490402039}-{'f1_val': 0.3954697038559911, 'auprc': 0.5653291716688504, 'loss_val': 1.3527512794947223, 'psi': 0.4634134909811348}
[S17] START round=1 head_norm_before_train=1.134127 (no previous merge yet)
[S17] round=1 local utility u=1.000000 metrics={'f1_val': 0.38378438944284887, 'auprc': 0.782867918766931, 'loss_val': 1.3377636878993497, 'psi': 0.5434178011724817}-{'f1_val': 0.09754189944134078, 'auprc': 0.6470908084981511, 'loss_val': 1.3611388964254416, 'psi': 0.317361463064065}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] → sending delta(kind=head bytes=1792) to S2@127.0.0.1:42002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S11] → sending delta(kind=head bytes=1790) to S9@127.0.0.1:42010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1784 reason=None
[S6] → sending delta(kind=head bytes=1784) to S10@127.0.0.1:42011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S4] → sending delta(kind=head bytes=1791) to S13@127.0.0.1:42013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S7] → sending delta(kind=head bytes=1787) to S2@127.0.0.1:42002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:42012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] → sending delta(kind=head bytes=1793) to S7@127.0.0.1:42008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S10] → sending delta(kind=head bytes=1791) to S5@127.0.0.1:42005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S13] → sending delta(kind=head bytes=1791) to S8@127.0.0.1:42009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:42009
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S15] → sending delta(kind=head bytes=1790) to S9@127.0.0.1:42010
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:42005
[S15] sending update (kind=head size=1790 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1791 to 1 peers)
[S10] sending update (kind=head size=1791 to 1 peers)
[S9] sending update (kind=head size=1793 to 1 peers)
[S3] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1787 to 1 peers)
[S4] sending update (kind=head size=1791 to 1 peers)
[S6] sending update (kind=head size=1784 to 1 peers)
[S11] sending update (kind=head size=1790 to 1 peers)
[S5] sending update (kind=head size=1792 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1794) from S3
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.156771)
[S5] loaded HEAD from S3 (vec_in norm=1.156771)
[S5] cosine check vs S3: cos=0.0180
[S5] BUFFERED delta from S3 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1791) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.240015)
[S5] loaded HEAD from S10 (vec_in norm=1.240015)
[S5] cosine check vs S10: cos=0.0202
[S5] BUFFERED delta from S10 (total buffered=2)
[S7] RECEIVED delta(kind=head bytes=1793) from S9
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.205460)
[S7] loaded HEAD from S9 (vec_in norm=1.205460)
[S7] cosine check vs S9: cos=0.0003
[S7] BUFFERED delta from S9 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1791) from S4
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.232971)
[S13] loaded HEAD from S4 (vec_in norm=1.232971)
[S13] cosine check vs S4: cos=0.0980
[S13] BUFFERED delta from S4 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1792) from S5
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.188510)
[S2] loaded HEAD from S5 (vec_in norm=1.188510)
[S2] cosine check vs S5: cos=-0.0150
[S2] DROPPED delta from S5 (cos=-0.0150 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1795) from S8
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.204800)
[S11] loaded HEAD from S8 (vec_in norm=1.204800)
[S11] cosine check vs S8: cos=-0.0016
[S11] DROPPED delta from S8 (cos=-0.0016 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1784) from S6
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.196156)
[S10] loaded HEAD from S6 (vec_in norm=1.196156)
[S10] cosine check vs S6: cos=0.0099
[S10] BUFFERED delta from S6 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1790) from S15
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.205405)
[S9] loaded HEAD from S15 (vec_in norm=1.205405)
[S9] cosine check vs S15: cos=0.0491
[S9] BUFFERED delta from S15 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1791) from S13
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.164520)
[S8] loaded HEAD from S13 (vec_in norm=1.164520)
[S8] cosine check vs S13: cos=-0.0172
[S8] DROPPED delta from S13 (cos=-0.0172 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1795) from S2
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.190079)
[S8] loaded HEAD from S2 (vec_in norm=1.190079)
[S8] cosine check vs S2: cos=0.0098
[S8] BUFFERED delta from S2 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1790) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.223046)
[S9] loaded HEAD from S11 (vec_in norm=1.223046)
[S9] cosine check vs S11: cos=-0.0292
[S9] DROPPED delta from S11 (cos=-0.0292 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1787) from S7
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.182822)
[S2] loaded HEAD from S7 (vec_in norm=1.182822)
[S2] cosine check vs S7: cos=0.1392
[S2] BUFFERED delta from S7 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S2@127.0.0.1:42002
[S17] sending update (kind=head size=1794 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1794) from S17
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.150136)
[S2] loaded HEAD from S17 (vec_in norm=1.150136)
[S2] cosine check vs S17: cos=-0.0662
[S2] DROPPED delta from S17 (cos=-0.0662 < 0.0)
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=1 metric=0.1423 head_norm=1.188510
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.258385e-01
[S5] stored merged vector for next round verification (round=1)
[S5] DEBUG after merge:  round=1 metric=0.1423 head_norm=0.744343 delta_norm=0.725838
[S5] aggregate: ACCEPT kept=['S3', 'S10'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=1 metric=0.1404 head_norm=1.164520
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.054376e-01
[S13] stored merged vector for next round verification (round=1)
[S13] DEBUG after merge:  round=1 metric=0.1404 head_norm=0.888500 delta_norm=0.805438
[S13] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=1 metric=0.1400 head_norm=1.204800
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.425608e-01
[S8] stored merged vector for next round verification (round=1)
[S8] DEBUG after merge:  round=1 metric=0.1400 head_norm=0.850886 delta_norm=0.842561
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=1 metric=0.1421 head_norm=1.182822
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.442996e-01
[S7] stored merged vector for next round verification (round=1)
[S7] DEBUG after merge:  round=1 metric=0.1421 head_norm=0.844547 delta_norm=0.844300
[S7] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=1 metric=0.1414 head_norm=1.205460
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.311958e-01
[S9] stored merged vector for next round verification (round=1)
[S9] DEBUG after merge:  round=1 metric=0.1414 head_norm=0.873029 delta_norm=0.831196
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=1 metric=0.3901 head_norm=1.240015
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.571864e-01
[S10] stored merged vector for next round verification (round=1)
[S10] DEBUG after merge:  round=1 metric=0.4164 head_norm=0.865705 delta_norm=0.857186
[S10] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=1 metric=0.1418 head_norm=1.190079
[S2] _apply_head_vector_avg (torch): Δ‖w‖=7.783873e-01
[S2] stored merged vector for next round verification (round=1)
[S2] DEBUG after merge:  round=1 metric=0.1418 head_norm=0.895428 delta_norm=0.778387
[S2] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=0.895428 cos_to_last_merge=1.0000 (last merge round=1)
[S2] round=2 local utility u=0.021619 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7049589160523788, 'loss_val': 1.2972047981089625, 'psi': 0.36704984645409156}-{'f1_val': 0.1417771333885667, 'auprc': 0.694838641159035, 'loss_val': 1.3100812018313228, 'psi': 0.36300173649675405}
[S3] START round=2 head_norm_before_train=1.156771 (no previous merge yet)
[S3] round=2 local utility u=0.016695 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9797243519978165, 'loss_val': 1.2351679632593884, 'psi': 0.4757937801675909}-{'f1_val': 0.13984006561410703, 'auprc': 0.9852788242874316, 'loss_val': 1.2852222773191977, 'psi': 0.4780155690834369}
[S4] START round=2 head_norm_before_train=1.232971 (no previous merge yet)
[S4] round=2 local utility u=1.000000 metrics={'f1_val': 0.6851042255095489, 'auprc': 0.7715981912265051, 'loss_val': 1.3007164369641497, 'psi': 0.7197018117963314}-{'f1_val': 0.3143201186048803, 'auprc': 0.767351133376346, 'loss_val': 1.3410412324697287, 'psi': 0.49553252451346663}
[S5] START round=2 head_norm_before_train=0.744343 cos_to_last_merge=1.0000 (last merge round=1)
[S5] round=2 local utility u=0.012673 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7346471885560839, 'loss_val': 1.231492312125087, 'psi': 0.3792160182795764}-{'f1_val': 0.14226190476190476, 'auprc': 0.7345248997340619, 'loss_val': 1.2564710874815668, 'psi': 0.3791671027507676}
[S6] START round=2 head_norm_before_train=1.196156 (no previous merge yet)
[S6] round=2 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.9148713600817835, 'loss_val': 1.3014473092978862, 'psi': 0.45080431326348264}-{'f1_val': 0.38625722424008846, 'auprc': 0.7596174982396937, 'loss_val': 1.3302982982326141, 'psi': 0.5356013338399306}
[S7] START round=2 head_norm_before_train=0.844547 cos_to_last_merge=1.0000 (last merge round=1)
[S7] round=2 local utility u=0.022948 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7913695649357614, 'loss_val': 1.2609028570659535, 'psi': 0.4017819196117596}-{'f1_val': 0.14205682272909165, 'auprc': 0.7801626854197338, 'loss_val': 1.2731788580294456, 'psi': 0.3972991678053485}
[S8] START round=2 head_norm_before_train=0.850886 cos_to_last_merge=1.0000 (last merge round=1)
[S8] round=2 local utility u=0.000000 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7743192849101573, 'loss_val': 1.321344970867702, 'psi': 0.3937013033998373}-{'f1_val': 0.13995598239295717, 'auprc': 0.7827520519654485, 'loss_val': 1.3046942109056876, 'psi': 0.3970744102219537}
[S9] START round=2 head_norm_before_train=0.873029 cos_to_last_merge=1.0000 (last merge round=1)
[S9] round=2 local utility u=0.019058 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8659425772859695, 'loss_val': 1.2261156602155845, 'psi': 0.4312158051983854}-{'f1_val': 0.141397957139996, 'auprc': 0.8656001901209938, 'loss_val': 1.263205173919494, 'psi': 0.4310788503323951}
[S10] START round=2 head_norm_before_train=0.865705 cos_to_last_merge=1.0000 (last merge round=1)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.8165894085640595, 'loss_val': 1.2922961208250106, 'psi': 0.4098087459506582}-{'f1_val': 0.3900661720720554, 'auprc': 0.7933430965880875, 'loss_val': 1.319951663668128, 'psi': 0.5513769418784683}
[S11] START round=2 head_norm_before_train=1.223046 (no previous merge yet)
[S11] round=2 local utility u=0.022032 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.9501028583401232, 'loss_val': 1.2728972566388033, 'psi': 0.46428935335991567}-{'f1_val': 0.14041368337311058, 'auprc': 0.9481870975325237, 'loss_val': 1.3112131974270296, 'psi': 0.46352304903687586}
[S13] START round=2 head_norm_before_train=0.888500 cos_to_last_merge=1.0000 (last merge round=1)
[S13] round=2 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.570848932013213, 'loss_val': 1.320861627036169, 'psi': 0.31257103035151707}-{'f1_val': 0.1403857625770531, 'auprc': 0.6187019245602308, 'loss_val': 1.321855115083699, 'psi': 0.3317122273703242}
[S14] START round=2 head_norm_before_train=1.184100 (no previous merge yet)
[S14] round=2 local utility u=0.078437 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.728177857001638, 'loss_val': 1.303627051569062, 'psi': 0.37548585453027744}-{'f1_val': 0.14035785288270378, 'auprc': 0.6879675992814587, 'loss_val': 1.3398699505513463, 'psi': 0.3594017514422057}
[S15] START round=2 head_norm_before_train=1.205405 (no previous merge yet)
[S15] round=2 local utility u=0.061463 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7683568637668565, 'loss_val': 1.3152563685328722, 'psi': 0.3911829363236776}-{'f1_val': 0.13973365136155833, 'auprc': 0.7383252955277659, 'loss_val': 1.3480885736570967, 'psi': 0.3791703090280414}
[S16] START round=2 head_norm_before_train=1.237314 (no previous merge yet)
[S16] round=2 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8254661598865571, 'loss_val': 1.2689187357480005, 'psi': 0.41456893407414475}-{'f1_val': 0.19595269013047314, 'auprc': 0.7902435874048, 'loss_val': 1.3156866084992067, 'psi': 0.4336690490402039}
[S17] START round=2 head_norm_before_train=1.150136 (no previous merge yet)
[S17] round=2 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.781457979287846, 'loss_val': 1.3082929705779849, 'psi': 0.39715256970556906}-{'f1_val': 0.38378438944284887, 'auprc': 0.782867918766931, 'loss_val': 1.3377636878993497, 'psi': 0.5434178011724817}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:42016
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S15] → sending delta(kind=head bytes=1789) to S7@127.0.0.1:42008
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] → sending delta(kind=head bytes=1792) to S13@127.0.0.1:42013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:42004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:42010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:42005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S9] → sending delta(kind=head bytes=1791) to S10@127.0.0.1:42011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S4] → sending delta(kind=head bytes=1789) to S9@127.0.0.1:42010
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:42011
[S5] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1789 to 1 peers)
[S9] sending update (kind=head size=1791 to 1 peers)
[S3] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1792 to 1 peers)
[S15] sending update (kind=head size=1789 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1791) from S9
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.921007)
[S10] loaded HEAD from S9 (vec_in norm=0.921007)
[S10] cosine check vs S9: cos=0.0624
[S10] BUFFERED delta from S9 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1795) from S2
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=0.916323)
[S10] loaded HEAD from S2 (vec_in norm=0.916323)
[S10] cosine check vs S2: cos=-0.1934
[S10] DROPPED delta from S2 (cos=-0.1934 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1794) from S3
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.187794)
[S4] loaded HEAD from S3 (vec_in norm=1.187794)
[S4] cosine check vs S3: cos=-0.0307
[S4] DROPPED delta from S3 (cos=-0.0307 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1789) from S4
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.254781)
[S9] loaded HEAD from S4 (vec_in norm=1.254781)
[S9] cosine check vs S4: cos=0.0073
[S9] BUFFERED delta from S4 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1797) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.788953)
[S9] loaded HEAD from S5 (vec_in norm=0.788953)
[S9] cosine check vs S5: cos=-0.0005
[S9] DROPPED delta from S5 (cos=-0.0005 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1797) from S7
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.875331)
[S5] loaded HEAD from S7 (vec_in norm=0.875331)
[S5] cosine check vs S7: cos=-0.1931
[S5] DROPPED delta from S7 (cos=-0.1931 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1796) from S14
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.211285)
[S16] loaded HEAD from S14 (vec_in norm=1.211285)
[S16] cosine check vs S14: cos=0.1238
[S16] BUFFERED delta from S14 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1789) from S15
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.223732)
[S7] loaded HEAD from S15 (vec_in norm=1.223732)
[S7] cosine check vs S15: cos=0.0758
[S7] BUFFERED delta from S15 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1792) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.245160)
[S13] loaded HEAD from S11 (vec_in norm=1.245160)
[S13] cosine check vs S11: cos=-0.0258
[S13] DROPPED delta from S11 (cos=-0.0258 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=2 metric=0.1386 head_norm=0.892608
[S10] _apply_head_vector_avg (torch): Δ‖w‖=6.209609e-01
[S10] stored merged vector for next round verification (round=2)
[S10] DEBUG after merge:  round=2 metric=0.1386 head_norm=0.660991 delta_norm=0.620961
[S10] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=2 metric=0.1414 head_norm=0.921007
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.755302e-01
[S9] stored merged vector for next round verification (round=2)
[S9] DEBUG after merge:  round=2 metric=0.1414 head_norm=0.780972 delta_norm=0.775530
[S9] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=2 metric=0.1421 head_norm=0.875331
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.248172e-01
[S7] stored merged vector for next round verification (round=2)
[S7] DEBUG after merge:  round=2 metric=0.1421 head_norm=0.778782 delta_norm=0.724817
[S7] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=2 metric=0.1406 head_norm=1.268782
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.210531e-01
[S16] stored merged vector for next round verification (round=2)
[S16] DEBUG after merge:  round=2 metric=0.1406 head_norm=0.929721 delta_norm=0.821053
[S16] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=0.916323 cos_to_last_merge=0.9969 (last merge round=1)
[S2] round=3 local utility u=0.068960 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7359340826257855, 'loss_val': 1.2522106747719377, 'psi': 0.37943991308345426}-{'f1_val': 0.1417771333885667, 'auprc': 0.7049589160523788, 'loss_val': 1.2972047981089625, 'psi': 0.36704984645409156}
[S3] START round=3 head_norm_before_train=1.187794 (no previous merge yet)
[S3] round=3 local utility u=0.078326 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9978901823431326, 'loss_val': 1.1330130901154993, 'psi': 0.4830601123057173}-{'f1_val': 0.13984006561410703, 'auprc': 0.9797243519978165, 'loss_val': 1.2351679632593884, 'psi': 0.4757937801675909}
[S4] START round=3 head_norm_before_train=1.254781 (no previous merge yet)
[S4] round=3 local utility u=0.000000 metrics={'f1_val': 0.4245940634236377, 'auprc': 0.7792191973776853, 'loss_val': 1.2414501390556456, 'psi': 0.5664441170052568}-{'f1_val': 0.6851042255095489, 'auprc': 0.7715981912265051, 'loss_val': 1.3007164369641497, 'psi': 0.7197018117963314}
[S5] START round=3 head_norm_before_train=0.788953 cos_to_last_merge=0.9939 (last merge round=1)
[S5] round=3 local utility u=0.942642 metrics={'f1_val': 0.41754956401939425, 'auprc': 0.773191197020195, 'loss_val': 1.1135663457022773, 'psi': 0.5598062172197146}-{'f1_val': 0.14226190476190476, 'auprc': 0.7346471885560839, 'loss_val': 1.231492312125087, 'psi': 0.3792160182795764}
[S6] START round=3 head_norm_before_train=1.210925 (no previous merge yet)
[S6] round=3 local utility u=0.016714 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.9156351486385482, 'loss_val': 1.270310651529125, 'psi': 0.45110982868618854}-{'f1_val': 0.14142628205128205, 'auprc': 0.9148713600817835, 'loss_val': 1.3014473092978862, 'psi': 0.45080431326348264}
[S7] START round=3 head_norm_before_train=0.778782 cos_to_last_merge=1.0000 (last merge round=2)
[S7] round=3 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7778124925948057, 'loss_val': 1.2244273559992527, 'psi': 0.3963590906753773}-{'f1_val': 0.14205682272909165, 'auprc': 0.7913695649357614, 'loss_val': 1.2609028570659535, 'psi': 0.4017819196117596}
[S8] START round=3 head_norm_before_train=0.860063 cos_to_last_merge=0.9969 (last merge round=1)
[S8] round=3 local utility u=0.000000 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7638530523326842, 'loss_val': 1.2907876185266136, 'psi': 0.389514810368848}-{'f1_val': 0.13995598239295717, 'auprc': 0.7743192849101573, 'loss_val': 1.321344970867702, 'psi': 0.3937013033998373}
[S9] START round=3 head_norm_before_train=0.780972 cos_to_last_merge=1.0000 (last merge round=2)
[S9] round=3 local utility u=0.015526 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8661937509262458, 'loss_val': 1.1958181754485602, 'psi': 0.43131627465449596}-{'f1_val': 0.141397957139996, 'auprc': 0.8659425772859695, 'loss_val': 1.2261156602155845, 'psi': 0.4312158051983854}
[S10] START round=3 head_norm_before_train=0.660991 cos_to_last_merge=1.0000 (last merge round=2)
[S10] round=3 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6495506669390367, 'loss_val': 1.2909286609836004, 'psi': 0.34299324930064906}-{'f1_val': 0.13862163754172394, 'auprc': 0.8165894085640595, 'loss_val': 1.2922961208250106, 'psi': 0.4098087459506582}
[S11] START round=3 head_norm_before_train=1.245160 (no previous merge yet)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8840383321405023, 'loss_val': 1.218852725029086, 'psi': 0.4378635428800673}-{'f1_val': 0.14041368337311058, 'auprc': 0.9501028583401232, 'loss_val': 1.2728972566388033, 'psi': 0.46428935335991567}
[S13] START round=3 head_norm_before_train=0.907625 cos_to_last_merge=0.9978 (last merge round=1)
[S13] round=3 local utility u=0.009140 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5643971434692052, 'loss_val': 1.2832254707652921, 'psi': 0.30999031493391394}-{'f1_val': 0.1403857625770531, 'auprc': 0.570848932013213, 'loss_val': 1.320861627036169, 'psi': 0.31257103035151707}
[S14] START round=3 head_norm_before_train=1.211285 (no previous merge yet)
[S14] round=3 local utility u=0.022044 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7281491395745019, 'loss_val': 1.2594531984392745, 'psi': 0.37547436755942304}-{'f1_val': 0.14035785288270378, 'auprc': 0.728177857001638, 'loss_val': 1.303627051569062, 'psi': 0.37548585453027744}
[S15] START round=3 head_norm_before_train=1.223732 (no previous merge yet)
[S15] round=3 local utility u=0.027737 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7739704986549323, 'loss_val': 1.27662409897046, 'psi': 0.3934283902789079}-{'f1_val': 0.13973365136155833, 'auprc': 0.7683568637668565, 'loss_val': 1.3152563685328722, 'psi': 0.3911829363236776}
[S16] START round=3 head_norm_before_train=0.929721 cos_to_last_merge=1.0000 (last merge round=2)
[S16] round=3 local utility u=0.192462 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.950347317971076, 'loss_val': 1.258637964569675, 'psi': 0.4645213973079523}-{'f1_val': 0.14063745019920318, 'auprc': 0.8254661598865571, 'loss_val': 1.2689187357480005, 'psi': 0.41456893407414475}
[S17] START round=3 head_norm_before_train=1.175190 (no previous merge yet)
[S17] round=3 local utility u=0.004519 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.7695027407251529, 'loss_val': 1.2633897289351612, 'psi': 0.3923704742804918}-{'f1_val': 0.14094896331738438, 'auprc': 0.781457979287846, 'loss_val': 1.3082929705779849, 'psi': 0.39715256970556906}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S6] → sending delta(kind=head bytes=1791) to S11@127.0.0.1:42012
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:42004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:42013
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:42015
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:42016
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:42010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:42012
[S5] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1791 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1796) from S15
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.249419)
[S11] loaded HEAD from S15 (vec_in norm=1.249419)
[S11] cosine check vs S15: cos=-0.0767
[S11] DROPPED delta from S15 (cos=-0.0767 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1798) from S13
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=0.937361)
[S4] loaded HEAD from S13 (vec_in norm=0.937361)
[S4] cosine check vs S13: cos=0.7360
[S4] BUFFERED delta from S13 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1791) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.231080)
[S11] loaded HEAD from S6 (vec_in norm=1.231080)
[S11] cosine check vs S6: cos=0.0053
[S11] BUFFERED delta from S6 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1800) from S3
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.215690)
[S9] loaded HEAD from S3 (vec_in norm=1.215690)
[S9] cosine check vs S3: cos=0.0010
[S9] BUFFERED delta from S3 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1800) from S2
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=0.942715)
[S13] loaded HEAD from S2 (vec_in norm=0.942715)
[S13] cosine check vs S2: cos=0.0891
[S13] BUFFERED delta from S2 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1796) from S16
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.962609)
[S17] loaded HEAD from S16 (vec_in norm=0.962609)
[S17] cosine check vs S16: cos=0.0520
[S17] BUFFERED delta from S16 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1798) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.831344)
[S17] loaded HEAD from S9 (vec_in norm=0.831344)
[S17] cosine check vs S9: cos=0.0150
[S17] BUFFERED delta from S9 (total buffered=2)
[S16] RECEIVED delta(kind=head bytes=1799) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.834381)
[S16] loaded HEAD from S5 (vec_in norm=0.834381)
[S16] cosine check vs S5: cos=0.1133
[S16] BUFFERED delta from S5 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1797) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.246014)
[S15] loaded HEAD from S14 (vec_in norm=1.246014)
[S15] cosine check vs S14: cos=-0.0103
[S15] DROPPED delta from S14 (cos=-0.0103 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S17] → sending delta(kind=head bytes=1792) to S3@127.0.0.1:42003
[S17] sending update (kind=head size=1792 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1792) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.209920)
[S3] loaded HEAD from S17 (vec_in norm=1.209920)
[S3] cosine check vs S17: cos=-0.1191
[S3] DROPPED delta from S17 (cos=-0.1191 < 0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=3 metric=0.1404 head_norm=1.275580
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.840449e-01
[S11] stored merged vector for next round verification (round=3)
[S11] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.888704 delta_norm=0.884045
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=3 metric=0.4246 head_norm=1.286309
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.354423e-01
[S4] stored merged vector for next round verification (round=3)
[S4] DEBUG after merge:  round=3 metric=0.4130 head_norm=1.037790 delta_norm=0.435442
[S4] aggregate: ROLLBACK (f1_val pre=0.425 post=0.413 tol_abs=0.005 tol_rel=0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=3 metric=0.1404 head_norm=0.937361
[S13] _apply_head_vector_avg (torch): Δ‖w‖=6.344215e-01
[S13] stored merged vector for next round verification (round=3)
[S13] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.693677 delta_norm=0.634421
[S13] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=3 metric=0.1414 head_norm=0.831344
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.360266e-01
[S9] stored merged vector for next round verification (round=3)
[S9] DEBUG after merge:  round=3 metric=0.1414 head_norm=0.736737 delta_norm=0.736027
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=3 metric=0.1406 head_norm=0.962609
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.001612e-01
[S16] stored merged vector for next round verification (round=3)
[S16] DEBUG after merge:  round=3 metric=0.1406 head_norm=0.671722 delta_norm=0.600161
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=3 metric=0.1409 head_norm=1.209920
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.565961e-01
[S17] stored merged vector for next round verification (round=3)
[S17] DEBUG after merge:  round=3 metric=0.1409 head_norm=0.684785 delta_norm=0.656596
[S17] aggregate: ACCEPT kept=['S16', 'S9'] (k=2/2) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=0.942715 cos_to_last_merge=0.9893 (last merge round=1)
[S2] round=4 local utility u=0.040230 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7484678171876227, 'loss_val': 1.2093517866756682, 'psi': 0.38445340690818913}-{'f1_val': 0.1417771333885667, 'auprc': 0.7359340826257855, 'loss_val': 1.2522106747719377, 'psi': 0.37943991308345426}
[S3] START round=4 head_norm_before_train=1.215690 (no previous merge yet)
[S3] round=4 local utility u=0.879137 metrics={'f1_val': 0.39680407515740423, 'auprc': 0.9961699375267347, 'loss_val': 0.911361842999912, 'psi': 0.6365504201051364}-{'f1_val': 0.13984006561410703, 'auprc': 0.9978901823431326, 'loss_val': 1.1330130901154993, 'psi': 0.4830601123057173}
[S4] START round=4 head_norm_before_train=1.037790 cos_to_last_merge=1.0000 (last merge round=3)
[S4] round=4 local utility u=0.000000 metrics={'f1_val': 0.33441167466067967, 'auprc': 0.7813361675448172, 'loss_val': 1.1924428774092926, 'psi': 0.5131814718143346}-{'f1_val': 0.4245940634236377, 'auprc': 0.7792191973776853, 'loss_val': 1.2414501390556456, 'psi': 0.5664441170052568}
[S5] START round=4 head_norm_before_train=0.834381 cos_to_last_merge=0.9809 (last merge round=1)
[S5] round=4 local utility u=0.096893 metrics={'f1_val': 0.4176671856330787, 'auprc': 0.7771137052879082, 'loss_val': 0.9322545011098237, 'psi': 0.5614457934950106}-{'f1_val': 0.41754956401939425, 'auprc': 0.773191197020195, 'loss_val': 1.1135663457022773, 'psi': 0.5598062172197146}
[S6] START round=4 head_norm_before_train=1.231080 (no previous merge yet)
[S6] round=4 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.9002692654128753, 'loss_val': 1.2335958340175737, 'psi': 0.44496347539591935}-{'f1_val': 0.14142628205128205, 'auprc': 0.9156351486385482, 'loss_val': 1.270310651529125, 'psi': 0.45110982868618854}
[S7] START round=4 head_norm_before_train=0.811450 cos_to_last_merge=0.9937 (last merge round=2)
[S7] round=4 local utility u=0.581203 metrics={'f1_val': 0.4168747328879592, 'auprc': 0.5765926066369933, 'loss_val': 1.1072699059057824, 'psi': 0.48076188238757284}-{'f1_val': 0.14205682272909165, 'auprc': 0.7778124925948057, 'loss_val': 1.2244273559992527, 'psi': 0.3963590906753773}
[S8] START round=4 head_norm_before_train=0.877974 cos_to_last_merge=0.9886 (last merge round=1)
[S8] round=4 local utility u=0.024540 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7661146052709841, 'loss_val': 1.2484932239733328, 'psi': 0.39041943154416797}-{'f1_val': 0.13995598239295717, 'auprc': 0.7638530523326842, 'loss_val': 1.2907876185266136, 'psi': 0.389514810368848}
[S9] START round=4 head_norm_before_train=0.736737 cos_to_last_merge=1.0000 (last merge round=3)
[S9] round=4 local utility u=0.059127 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8662411556373274, 'loss_val': 1.0777058335661474, 'psi': 0.4313352365389286}-{'f1_val': 0.141397957139996, 'auprc': 0.8661937509262458, 'loss_val': 1.1958181754485602, 'psi': 0.43131627465449596}
[S10] START round=4 head_norm_before_train=0.683914 cos_to_last_merge=0.9943 (last merge round=2)
[S10] round=4 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6102773158379146, 'loss_val': 1.230568305761599, 'psi': 0.3272839088602002}-{'f1_val': 0.13862163754172394, 'auprc': 0.6495506669390367, 'loss_val': 1.2909286609836004, 'psi': 0.34299324930064906}
[S11] START round=4 head_norm_before_train=0.888704 cos_to_last_merge=1.0000 (last merge round=3)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7836487480834227, 'loss_val': 1.2101305178262112, 'psi': 0.3977077092572354}-{'f1_val': 0.14041368337311058, 'auprc': 0.8840383321405023, 'loss_val': 1.218852725029086, 'psi': 0.4378635428800673}
[S13] START round=4 head_norm_before_train=0.693677 cos_to_last_merge=1.0000 (last merge round=3)
[S13] round=4 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5256847875202693, 'loss_val': 1.2763688512615698, 'psi': 0.29450537255433956}-{'f1_val': 0.1403857625770531, 'auprc': 0.5643971434692052, 'loss_val': 1.2832254707652921, 'psi': 0.30999031493391394}
[S14] START round=4 head_norm_before_train=1.246014 (no previous merge yet)
[S14] round=4 local utility u=0.022930 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7300844993649453, 'loss_val': 1.21939945476878, 'psi': 0.3762485114756004}-{'f1_val': 0.14035785288270378, 'auprc': 0.7281491395745019, 'loss_val': 1.2594531984392745, 'psi': 0.37547436755942304}
[S15] START round=4 head_norm_before_train=1.249419 (no previous merge yet)
[S15] round=4 local utility u=0.017527 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7743996320376934, 'loss_val': 1.242858189102124, 'psi': 0.39360004363201234}-{'f1_val': 0.13973365136155833, 'auprc': 0.7739704986549323, 'loss_val': 1.27662409897046, 'psi': 0.3934283902789079}
[S16] START round=4 head_norm_before_train=0.671722 cos_to_last_merge=1.0000 (last merge round=3)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.19804229875024282, 'auprc': 0.7788991459583265, 'loss_val': 1.256397987306651, 'psi': 0.43038503763347635}-{'f1_val': 0.14063745019920318, 'auprc': 0.950347317971076, 'loss_val': 1.258637964569675, 'psi': 0.4645213973079523}
[S17] START round=4 head_norm_before_train=0.684785 cos_to_last_merge=1.0000 (last merge round=3)
[S17] round=4 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.581541924075226, 'loss_val': 1.2579896239879655, 'psi': 0.317186147620521}-{'f1_val': 0.14094896331738438, 'auprc': 0.7695027407251529, 'loss_val': 1.2633897289351612, 'psi': 0.3923704742804918}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S7] → sending delta(kind=head bytes=1786) to S14@127.0.0.1:42014
[S3] not sending this round → trigger blocked (psi=0.637)
[S5] not sending this round → trigger blocked (psi=0.561)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.394)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:42017
[S2] not sending this round → trigger blocked (psi=0.384)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.431)
[S14] not sending this round → trigger blocked (psi=0.376)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1786 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1786) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.846508)
[S14] loaded HEAD from S7 (vec_in norm=0.846508)
[S14] cosine check vs S7: cos=-0.0179
[S14] DROPPED delta from S7 (cos=-0.0179 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1798) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.904314)
[S17] loaded HEAD from S8 (vec_in norm=0.904314)
[S17] cosine check vs S8: cos=-0.0956
[S17] DROPPED delta from S8 (cos=-0.0956 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=5 head_norm_before_train=0.972613 cos_to_last_merge=0.9803 (last merge round=1)
[S2] round=5 local utility u=0.043528 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.761883191683396, 'loss_val': 1.1625413929761361, 'psi': 0.3898195567064985}-{'f1_val': 0.1417771333885667, 'auprc': 0.7484678171876227, 'loss_val': 1.2093517866756682, 'psi': 0.38445340690818913}
[S3] START round=5 head_norm_before_train=1.270521 (no previous merge yet)
[S3] round=5 local utility u=0.000000 metrics={'f1_val': 0.4058701688477675, 'auprc': 0.9041126956892463, 'loss_val': 0.7418227462172773, 'psi': 0.6051671795843591}-{'f1_val': 0.39680407515740423, 'auprc': 0.9961699375267347, 'loss_val': 0.911361842999912, 'psi': 0.6365504201051364}
[S4] START round=5 head_norm_before_train=1.077867 cos_to_last_merge=0.9977 (last merge round=3)
[S4] round=5 local utility u=0.237159 metrics={'f1_val': 0.39215522101605343, 'auprc': 0.782824139059761, 'loss_val': 1.0690507250062118, 'psi': 0.5484227882335365}-{'f1_val': 0.33441167466067967, 'auprc': 0.7813361675448172, 'loss_val': 1.1924428774092926, 'psi': 0.5131814718143346}
[S5] START round=5 head_norm_before_train=0.897393 cos_to_last_merge=0.9574 (last merge round=1)
[S5] round=5 local utility u=0.120299 metrics={'f1_val': 0.4175465518408786, 'auprc': 0.7947340093909914, 'loss_val': 0.7437939507948049, 'psi': 0.5684215348609237}-{'f1_val': 0.4176671856330787, 'auprc': 0.7771137052879082, 'loss_val': 0.9322545011098237, 'psi': 0.5614457934950106}
[S6] START round=5 head_norm_before_train=1.258137 (no previous merge yet)
[S6] round=5 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8195963328315441, 'loss_val': 1.1777098376749549, 'psi': 0.4126943023633869}-{'f1_val': 0.14142628205128205, 'auprc': 0.9002692654128753, 'loss_val': 1.2335958340175737, 'psi': 0.44496347539591935}
[S7] START round=5 head_norm_before_train=0.846508 cos_to_last_merge=0.9800 (last merge round=2)
[S7] round=5 local utility u=0.420805 metrics={'f1_val': 0.4169130971024577, 'auprc': 0.7944647557221725, 'loss_val': 0.9195073911740047, 'psi': 0.5679337605503436}-{'f1_val': 0.4168747328879592, 'auprc': 0.5765926066369933, 'loss_val': 1.1072699059057824, 'psi': 0.48076188238757284}
[S8] START round=5 head_norm_before_train=0.904314 cos_to_last_merge=0.9771 (last merge round=1)
[S8] round=5 local utility u=0.034863 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7660966381869719, 'loss_val': 1.1787139804709834, 'psi': 0.3904122447105631}-{'f1_val': 0.13995598239295717, 'auprc': 0.7661146052709841, 'loss_val': 1.2484932239733328, 'psi': 0.39041943154416797}
[S9] START round=5 head_norm_before_train=0.783892 cos_to_last_merge=0.9863 (last merge round=3)
[S9] round=5 local utility u=0.978334 metrics={'f1_val': 0.41677243415667764, 'auprc': 0.8662577943246942, 'loss_val': 0.7733351905387652, 'psi': 0.5965665782238843}-{'f1_val': 0.141397957139996, 'auprc': 0.8662411556373274, 'loss_val': 1.0777058335661474, 'psi': 0.4313352365389286}
[S10] START round=5 head_norm_before_train=0.714330 cos_to_last_merge=0.9798 (last merge round=2)
[S10] round=5 local utility u=0.035700 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.609896259929789, 'loss_val': 1.1580249740901578, 'psi': 0.32713148649695}-{'f1_val': 0.13862163754172394, 'auprc': 0.6102773158379146, 'loss_val': 1.230568305761599, 'psi': 0.3272839088602002}
[S11] START round=5 head_norm_before_train=0.919267 cos_to_last_merge=0.9974 (last merge round=3)
[S11] round=5 local utility u=0.031711 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7707149990132888, 'loss_val': 1.107906746303424, 'psi': 0.3925342096291819}-{'f1_val': 0.14041368337311058, 'auprc': 0.7836487480834227, 'loss_val': 1.2101305178262112, 'psi': 0.3977077092572354}
[S13] START round=5 head_norm_before_train=0.725849 cos_to_last_merge=0.9959 (last merge round=3)
[S13] round=5 local utility u=0.029166 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5274521770851311, 'loss_val': 1.2233397737155658, 'psi': 0.29521232838028433}-{'f1_val': 0.1403857625770531, 'auprc': 0.5256847875202693, 'loss_val': 1.2763688512615698, 'psi': 0.29450537255433956}
[S14] START round=5 head_norm_before_train=1.280008 (no previous merge yet)
[S14] round=5 local utility u=1.000000 metrics={'f1_val': 0.39649470961585787, 'auprc': 0.8753345767383929, 'loss_val': 1.1624339855746268, 'psi': 0.5880306564648718}-{'f1_val': 0.14035785288270378, 'auprc': 0.7300844993649453, 'loss_val': 1.21939945476878, 'psi': 0.3762485114756004}
[S15] START round=5 head_norm_before_train=1.277487 (no previous merge yet)
[S15] round=5 local utility u=0.016286 metrics={'f1_val': 0.14036675828804415, 'auprc': 0.7687581956267294, 'loss_val': 1.1971610525451457, 'psi': 0.39172333322351827}-{'f1_val': 0.13973365136155833, 'auprc': 0.7743996320376934, 'loss_val': 1.242858189102124, 'psi': 0.39360004363201234}
[S16] START round=5 head_norm_before_train=0.697872 cos_to_last_merge=0.9961 (last merge round=3)
[S16] round=5 local utility u=0.654753 metrics={'f1_val': 0.41467924219943564, 'auprc': 0.7416748375253237, 'loss_val': 1.1350408666402962, 'psi': 0.5454774803297908}-{'f1_val': 0.19804229875024282, 'auprc': 0.7788991459583265, 'loss_val': 1.256397987306651, 'psi': 0.43038503763347635}
[S17] START round=5 head_norm_before_train=0.723605 cos_to_last_merge=0.9959 (last merge round=3)
[S17] round=5 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5441485904261416, 'loss_val': 1.1724361485961923, 'psi': 0.3022288141608873}-{'f1_val': 0.14094896331738438, 'auprc': 0.581541924075226, 'loss_val': 1.2579896239879655, 'psi': 0.317186147620521}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:42015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:42004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S4] → sending delta(kind=head bytes=1791) to S10@127.0.0.1:42011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:42013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:42012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S9] → sending delta(kind=head bytes=1807) to S17@127.0.0.1:42017
[S8] not sending this round → trigger blocked (psi=0.390)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:42016
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:42013
[S7] not sending this round → trigger blocked (psi=0.568)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:42003
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1807 to 1 peers)
[S4] sending update (kind=head size=1791 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1798) from S16
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.738373)
[S17] loaded HEAD from S16 (vec_in norm=0.738373)
[S17] cosine check vs S16: cos=0.2016
[S17] BUFFERED delta from S16 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1801) from S2
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=0.998700)
[S13] loaded HEAD from S2 (vec_in norm=0.998700)
[S13] cosine check vs S2: cos=0.6880
[S13] BUFFERED delta from S2 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1791) from S4
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.125622)
[S10] loaded HEAD from S4 (vec_in norm=1.125622)
[S10] cosine check vs S4: cos=-0.0325
[S10] DROPPED delta from S4 (cos=-0.0325 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1795) from S15
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.303276)
[S11] loaded HEAD from S15 (vec_in norm=1.303276)
[S11] cosine check vs S15: cos=0.0167
[S11] BUFFERED delta from S15 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1798) from S13
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=0.767856)
[S4] loaded HEAD from S13 (vec_in norm=0.767856)
[S4] cosine check vs S13: cos=0.6725
[S4] BUFFERED delta from S13 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1807) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.868173)
[S17] loaded HEAD from S9 (vec_in norm=0.868173)
[S17] cosine check vs S9: cos=0.0622
[S17] BUFFERED delta from S9 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1799) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.310632)
[S15] loaded HEAD from S14 (vec_in norm=1.310632)
[S15] cosine check vs S14: cos=-0.0051
[S15] DROPPED delta from S14 (cos=-0.0051 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1799) from S10
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=0.746464)
[S3] loaded HEAD from S10 (vec_in norm=0.746464)
[S3] cosine check vs S10: cos=0.0583
[S3] BUFFERED delta from S10 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1795) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.964465)
[S16] loaded HEAD from S5 (vec_in norm=0.964465)
[S16] cosine check vs S5: cos=0.6481
[S16] BUFFERED delta from S5 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1797) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.957125)
[S13] loaded HEAD from S11 (vec_in norm=0.957125)
[S13] cosine check vs S11: cos=-0.0980
[S13] DROPPED delta from S11 (cos=-0.0980 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] ⇄ pheromone p=0.412 → S11@127.0.0.1:42012
[S7] ⇄ pheromone p=0.507 → S14@127.0.0.1:42014
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=5 metric=0.4059 head_norm=1.342279
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.486917e-01
[S3] stored merged vector for next round verification (round=5)
[S3] DEBUG after merge:  round=5 metric=0.4187 head_norm=0.786716 delta_norm=0.748692
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.534 → S9@127.0.0.1:42010
[S8] ⇄ pheromone p=0.357 → S17@127.0.0.1:42017
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=5 metric=0.4147 head_norm=0.738373
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.715706e-01
[S16] stored merged vector for next round verification (round=5)
[S16] DEBUG after merge:  round=5 metric=0.4143 head_norm=0.774357 delta_norm=0.371571
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.483 → S17@127.0.0.1:42017
[S10] ⇄ pheromone p=0.407 → S3@127.0.0.1:42003
[S5] ⇄ pheromone p=0.490 → S16@127.0.0.1:42016
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=5 metric=0.3922 head_norm=1.125622
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.165587e-01
[S4] stored merged vector for next round verification (round=5)
[S4] DEBUG after merge:  round=5 metric=0.3683 head_norm=0.868788 delta_norm=0.416559
[S4] aggregate: ROLLBACK (f1_val pre=0.392 post=0.368 tol_abs=0.005 tol_rel=0.0)
[S4] ⇄ pheromone p=0.535 → S10@127.0.0.1:42011
[S9] ⇄ pheromone p=0.546 → S17@127.0.0.1:42017
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=5 metric=0.1404 head_norm=0.957125
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.020055e-01
[S11] stored merged vector for next round verification (round=5)
[S11] DEBUG after merge:  round=5 metric=0.1404 head_norm=0.814920 delta_norm=0.802006
[S11] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.341 → S13@127.0.0.1:42013
[S15] ⇄ pheromone p=0.392 → S11@127.0.0.1:42012
[S14] ⇄ pheromone p=0.542 → S15@127.0.0.1:42015
[S2] ⇄ pheromone p=0.374 → S13@127.0.0.1:42013
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=5 metric=0.1404 head_norm=0.767856
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.646225e-01
[S13] stored merged vector for next round verification (round=5)
[S13] DEBUG after merge:  round=5 metric=0.1404 head_norm=0.812744 delta_norm=0.364623
[S13] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.340 → S4@127.0.0.1:42004
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=5 metric=0.1409 head_norm=0.771340
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.344960e-01
[S17] stored merged vector for next round verification (round=5)
[S17] DEBUG after merge:  round=5 metric=0.1409 head_norm=0.516736 delta_norm=0.434496
[S17] aggregate: ACCEPT kept=['S16', 'S9'] (k=2/2) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.410 → S3@127.0.0.1:42003
[S2] START round=6 head_norm_before_train=0.998700 cos_to_last_merge=0.9719 (last merge round=1)
[S2] round=6 local utility u=0.854939 metrics={'f1_val': 0.4156703010573377, 'auprc': 0.7649579667432134, 'loss_val': 1.1052468846348473, 'psi': 0.555385367331688}-{'f1_val': 0.1417771333885667, 'auprc': 0.761883191683396, 'loss_val': 1.1625413929761361, 'psi': 0.3898195567064985}
[S3] START round=6 head_norm_before_train=0.786716 cos_to_last_merge=1.0000 (last merge round=5)
[S3] round=6 local utility u=1.000000 metrics={'f1_val': 0.7000803035935849, 'auprc': 0.9946637274911652, 'loss_val': 0.6673809608754037, 'psi': 0.817913673152617}-{'f1_val': 0.4058701688477675, 'auprc': 0.9041126956892463, 'loss_val': 0.7418227462172773, 'psi': 0.6051671795843591}
[S4] START round=6 head_norm_before_train=0.868788 cos_to_last_merge=1.0000 (last merge round=5)
[S4] round=6 local utility u=0.913941 metrics={'f1_val': 0.6824947667668655, 'auprc': 0.7818707612904517, 'loss_val': 0.9803453920150981, 'psi': 0.7222451645763}-{'f1_val': 0.39215522101605343, 'auprc': 0.782824139059761, 'loss_val': 1.0690507250062118, 'psi': 0.5484227882335365}
[S5] START round=6 head_norm_before_train=0.964465 cos_to_last_merge=0.9265 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.927
[S5] round=6 local utility u=0.000000 metrics={'f1_val': 0.41762564480671754, 'auprc': 0.7325587458656904, 'loss_val': 0.663183074292271, 'psi': 0.5435988852303066}-{'f1_val': 0.4175465518408786, 'auprc': 0.7947340093909914, 'loss_val': 0.7437939507948049, 'psi': 0.5684215348609237}
[S6] START round=6 head_norm_before_train=1.291541 (no previous merge yet)
[S6] round=6 local utility u=0.646966 metrics={'f1_val': 0.4156481186360783, 'auprc': 0.6658536105752756, 'loss_val': 1.0678800440236138, 'psi': 0.5157303154117572}-{'f1_val': 0.14142628205128205, 'auprc': 0.8195963328315441, 'loss_val': 1.1777098376749549, 'psi': 0.4126943023633869}
[S7] START round=6 head_norm_before_train=0.902443 cos_to_last_merge=0.9582 (last merge round=2)
[S7] round=6 local utility u=0.041491 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.7897910095603895, 'loss_val': 0.8212869723148113, 'psi': 0.5659424746907699}-{'f1_val': 0.4169130971024577, 'auprc': 0.7944647557221725, 'loss_val': 0.9195073911740047, 'psi': 0.5679337605503436}
[S8] START round=6 head_norm_before_train=0.936728 cos_to_last_merge=0.9638 (last merge round=1)
[S8] round=6 local utility u=0.929988 metrics={'f1_val': 0.42605196018221286, 'auprc': 0.7728234184776229, 'loss_val': 1.0554938976771686, 'psi': 0.5647605435003769}-{'f1_val': 0.13995598239295717, 'auprc': 0.7660966381869719, 'loss_val': 1.1787139804709834, 'psi': 0.3904122447105631}
[S9] START round=6 head_norm_before_train=0.868173 cos_to_last_merge=0.9482 (last merge round=3)
[S9] ⚠️ Model drifted since last merge! cos=0.948
[S9] round=6 local utility u=1.000000 metrics={'f1_val': 0.7015406642019387, 'auprc': 0.998542617511372, 'loss_val': 0.4596570804001495, 'psi': 0.8203414455257121}-{'f1_val': 0.41677243415667764, 'auprc': 0.8662577943246942, 'loss_val': 0.7733351905387652, 'psi': 0.5965665782238843}
[S10] START round=6 head_norm_before_train=0.746464 cos_to_last_merge=0.9614 (last merge round=2)
[S10] round=6 local utility u=1.000000 metrics={'f1_val': 0.43138471007373913, 'auprc': 0.6640999781369564, 'loss_val': 1.0597720934502812, 'psi': 0.524470817299026}-{'f1_val': 0.13862163754172394, 'auprc': 0.609896259929789, 'loss_val': 1.1580249740901578, 'psi': 0.32713148649695}
[S11] START round=6 head_norm_before_train=0.814920 cos_to_last_merge=1.0000 (last merge round=5)
[S11] round=6 local utility u=0.385816 metrics={'f1_val': 0.17274284316124297, 'auprc': 0.9469898238944461, 'loss_val': 1.0590738221130707, 'psi': 0.48244163545452423}-{'f1_val': 0.14041368337311058, 'auprc': 0.7707149990132888, 'loss_val': 1.107906746303424, 'psi': 0.3925342096291819}
[S13] START round=6 head_norm_before_train=0.812744 cos_to_last_merge=1.0000 (last merge round=5)
[S13] round=6 local utility u=0.854593 metrics={'f1_val': 0.4108995334140799, 'auprc': 0.5393758539017965, 'loss_val': 1.1730073617640615, 'psi': 0.4622900616091665}-{'f1_val': 0.1403857625770531, 'auprc': 0.5274521770851311, 'loss_val': 1.2233397737155658, 'psi': 0.29521232838028433}
[S14] START round=6 head_norm_before_train=1.310632 (no previous merge yet)
[S14] round=6 local utility u=1.000000 metrics={'f1_val': 0.6996262764984602, 'auprc': 0.995010532617687, 'loss_val': 1.0011129935284677, 'psi': 0.817779978946151}-{'f1_val': 0.39649470961585787, 'auprc': 0.8753345767383929, 'loss_val': 1.1624339855746268, 'psi': 0.5880306564648718}
[S15] START round=6 head_norm_before_train=1.303276 (no previous merge yet)
[S15] round=6 local utility u=0.880013 metrics={'f1_val': 0.416567672447929, 'auprc': 0.7760720188802666, 'loss_val': 1.116281686190482, 'psi': 0.5603694110208641}-{'f1_val': 0.14036675828804415, 'auprc': 0.7687581956267294, 'loss_val': 1.1971610525451457, 'psi': 0.39172333322351827}
[S16] START round=6 head_norm_before_train=0.774357 cos_to_last_merge=1.0000 (last merge round=5)
[S16] round=6 local utility u=0.000000 metrics={'f1_val': 0.41672208089815915, 'auprc': 0.5366079539795844, 'loss_val': 1.0336574864866392, 'psi': 0.46467643013072923}-{'f1_val': 0.41467924219943564, 'auprc': 0.7416748375253237, 'loss_val': 1.1350408666402962, 'psi': 0.5454774803297908}
[S17] START round=6 head_norm_before_train=0.516736 cos_to_last_merge=1.0000 (last merge round=5)
[S17] round=6 local utility u=0.592350 metrics={'f1_val': 0.3108896209551474, 'auprc': 0.5899658815658189, 'loss_val': 1.1448321399366284, 'psi': 0.42252012519941595}-{'f1_val': 0.14094896331738438, 'auprc': 0.5441485904261416, 'loss_val': 1.1724361485961923, 'psi': 0.3022288141608873}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:42014
[S13] not sending this round → trigger blocked (psi=0.462)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:42010
[S14] not sending this round → trigger blocked (psi=0.818)
[S15] not sending this round → trigger blocked (psi=0.560)
[S4] not sending this round → trigger blocked (psi=0.722)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:42012
[S10] not sending this round → trigger blocked (psi=0.524)
[S2] not sending this round → trigger blocked (psi=0.555)
[S9] not sending this round → trigger blocked (psi=0.820)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.482)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1794 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1794) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.322433)
[S11] loaded HEAD from S6 (vec_in norm=1.322433)
[S11] cosine check vs S6: cos=0.4423
[S11] BUFFERED delta from S6 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1802) from S3
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=0.886402)
[S9] loaded HEAD from S3 (vec_in norm=0.886402)
[S9] cosine check vs S3: cos=0.7007
[S9] BUFFERED delta from S3 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1797) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.976867)
[S17] loaded HEAD from S8 (vec_in norm=0.976867)
[S17] cosine check vs S8: cos=-0.0783
[S17] DROPPED delta from S8 (cos=-0.0783 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1794) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.964003)
[S14] loaded HEAD from S7 (vec_in norm=0.964003)
[S14] cosine check vs S7: cos=-0.0078
[S14] DROPPED delta from S7 (cos=-0.0078 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S17] → sending delta(kind=head bytes=1808) to S3@127.0.0.1:42003
[S17] sending update (kind=head size=1808 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1808) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.559256)
[S3] loaded HEAD from S17 (vec_in norm=0.559256)
[S3] cosine check vs S17: cos=0.2743
[S3] BUFFERED delta from S17 (total buffered=1)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=6 metric=0.7015 head_norm=0.981977
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.640402e-01
[S9] stored merged vector for next round verification (round=6)
[S9] DEBUG after merge:  round=6 metric=0.7015 head_norm=0.861666 delta_norm=0.364040
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=6 metric=0.1727 head_norm=0.850910
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.077724e-01
[S11] stored merged vector for next round verification (round=6)
[S11] DEBUG after merge:  round=6 metric=0.1729 head_norm=0.931156 delta_norm=0.607772
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=6 metric=0.7001 head_norm=0.886402
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.545719e-01
[S3] stored merged vector for next round verification (round=6)
[S3] DEBUG after merge:  round=6 metric=0.7003 head_norm=0.585322 delta_norm=0.454572
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=1.027770 cos_to_last_merge=0.9629 (last merge round=1)
[S2] round=7 local utility u=0.060438 metrics={'f1_val': 0.416397774005704, 'auprc': 0.7756318896332587, 'loss_val': 1.020756893194911, 'psi': 0.5600914202567259}-{'f1_val': 0.4156703010573377, 'auprc': 0.7649579667432134, 'loss_val': 1.1052468846348473, 'psi': 0.555385367331688}
[S3] START round=7 head_norm_before_train=0.585322 cos_to_last_merge=1.0000 (last merge round=6)
[S3] round=7 local utility u=0.020945 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9927016399651634, 'loss_val': 0.6232093585828404, 'psi': 0.8174892317852662}-{'f1_val': 0.7000803035935849, 'auprc': 0.9946637274911652, 'loss_val': 0.6673809608754037, 'psi': 0.817913673152617}
[S4] START round=7 head_norm_before_train=0.920001 cos_to_last_merge=0.9966 (last merge round=5)
[S4] round=7 local utility u=0.000000 metrics={'f1_val': 0.6669862706632047, 'auprc': 0.66016288146395, 'loss_val': 0.7866180443533382, 'psi': 0.6642569149835028}-{'f1_val': 0.6824947667668655, 'auprc': 0.7818707612904517, 'loss_val': 0.9803453920150981, 'psi': 0.7222451645763}
[S5] START round=7 head_norm_before_train=1.027784 cos_to_last_merge=0.8993 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.899
[S5] round=7 local utility u=0.911135 metrics={'f1_val': 0.6420789674441347, 'auprc': 0.864638626533186, 'loss_val': 0.5838734894228952, 'psi': 0.7311028310797553}-{'f1_val': 0.41762564480671754, 'auprc': 0.7325587458656904, 'loss_val': 0.663183074292271, 'psi': 0.5435988852303066}
[S6] START round=7 head_norm_before_train=1.322433 (no previous merge yet)
[S6] round=7 local utility u=0.103021 metrics={'f1_val': 0.4172560359570804, 'auprc': 0.6746010906224769, 'loss_val': 0.8977272078314763, 'psi': 0.5201940578232389}-{'f1_val': 0.4156481186360783, 'auprc': 0.6658536105752756, 'loss_val': 1.0678800440236138, 'psi': 0.5157303154117572}
[S7] START round=7 head_norm_before_train=0.964003 cos_to_last_merge=0.9329 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.933
[S7] round=7 local utility u=0.038137 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.7963717482324933, 'loss_val': 0.7647550985046165, 'psi': 0.5685747701596113}-{'f1_val': 0.41671011811102343, 'auprc': 0.7897910095603895, 'loss_val': 0.8212869723148113, 'psi': 0.5659424746907699}
[S8] START round=7 head_norm_before_train=0.976867 cos_to_last_merge=0.9488 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.949
[S8] round=7 local utility u=0.927097 metrics={'f1_val': 0.7142034452617962, 'auprc': 0.777018659647797, 'loss_val': 0.9427946407519053, 'psi': 0.7393295310161966}-{'f1_val': 0.42605196018221286, 'auprc': 0.7728234184776229, 'loss_val': 1.0554938976771686, 'psi': 0.5647605435003769}
[S9] START round=7 head_norm_before_train=0.861666 cos_to_last_merge=1.0000 (last merge round=6)
[S9] round=7 local utility u=0.036733 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.998518457734722, 'loss_val': 0.3846181695623202, 'psi': 0.8201816732184268}-{'f1_val': 0.7015406642019387, 'auprc': 0.998542617511372, 'loss_val': 0.4596570804001495, 'psi': 0.8203414455257121}
[S10] START round=7 head_norm_before_train=0.782572 cos_to_last_merge=0.9427 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.943
[S10] round=7 local utility u=0.098933 metrics={'f1_val': 0.4371539378131648, 'auprc': 0.6634922634531982, 'loss_val': 0.8946989870122014, 'psi': 0.5276892680691782}-{'f1_val': 0.43138471007373913, 'auprc': 0.6640999781369564, 'loss_val': 1.0597720934502812, 'psi': 0.524470817299026}
[S11] START round=7 head_norm_before_train=0.931156 cos_to_last_merge=1.0000 (last merge round=6)
[S11] round=7 local utility u=0.217850 metrics={'f1_val': 0.2480202538888172, 'auprc': 0.8933328999485673, 'loss_val': 0.9140672828288721, 'psi': 0.5061453123127173}-{'f1_val': 0.17274284316124297, 'auprc': 0.9469898238944461, 'loss_val': 1.0590738221130707, 'psi': 0.48244163545452423}
[S13] START round=7 head_norm_before_train=0.840366 cos_to_last_merge=0.9976 (last merge round=5)
[S13] round=7 local utility u=0.088192 metrics={'f1_val': 0.4163167573796875, 'auprc': 0.5657372554725275, 'loss_val': 1.1082106586242502, 'psi': 0.4760849566168235}-{'f1_val': 0.4108995334140799, 'auprc': 0.5393758539017965, 'loss_val': 1.1730073617640615, 'psi': 0.4622900616091665}
[S14] START round=7 head_norm_before_train=1.343880 (no previous merge yet)
[S14] round=7 local utility u=0.989296 metrics={'f1_val': 0.9974936690910665, 'auprc': 0.9973076258140798, 'loss_val': 0.8166170123268609, 'psi': 0.9974192517802718}-{'f1_val': 0.6996262764984602, 'auprc': 0.995010532617687, 'loss_val': 1.0011129935284677, 'psi': 0.817779978946151}
[S15] START round=7 head_norm_before_train=1.329655 (no previous merge yet)
[S15] round=7 local utility u=0.089174 metrics={'f1_val': 0.41699057080661284, 'auprc': 0.7829056063180054, 'loss_val': 0.9609726908912352, 'psi': 0.5633565850111699}-{'f1_val': 0.416567672447929, 'auprc': 0.7760720188802666, 'loss_val': 1.116281686190482, 'psi': 0.5603694110208641}
[S16] START round=7 head_norm_before_train=0.812009 cos_to_last_merge=0.9937 (last merge round=5)
[S16] round=7 local utility u=0.189210 metrics={'f1_val': 0.3850491388228049, 'auprc': 0.7039591324925674, 'loss_val': 0.9672539932490941, 'psi': 0.5126131362907099}-{'f1_val': 0.41672208089815915, 'auprc': 0.5366079539795844, 'loss_val': 1.0336574864866392, 'psi': 0.46467643013072923}
[S17] START round=7 head_norm_before_train=0.559256 cos_to_last_merge=0.9890 (last merge round=5)
[S17] round=7 local utility u=0.398556 metrics={'f1_val': 0.39194328393368116, 'auprc': 0.6510692582081862, 'loss_val': 1.0173520063003307, 'psi': 0.49559367364348317}-{'f1_val': 0.3108896209551474, 'auprc': 0.5899658815658189, 'loss_val': 1.1448321399366284, 'psi': 0.42252012519941595}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:42015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:42017
[S3] not sending this round → trigger blocked (psi=0.817)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S13@127.0.0.1:42013
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] → sending delta(kind=head bytes=1792) to S16@127.0.0.1:42016
[S8] not sending this round → trigger blocked (psi=0.739)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S11] → sending delta(kind=head bytes=1791) to S13@127.0.0.1:42013
[S7] not sending this round → trigger blocked (psi=0.569)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S13] → sending delta(kind=head bytes=1791) to S4@127.0.0.1:42004
[S6] not sending this round → trigger blocked (psi=0.520)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:42012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:42003
[S15] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1791 to 1 peers)
[S11] sending update (kind=head size=1791 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1792 to 1 peers)
[S2] sending update (kind=head size=1804 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1804) from S2
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.054896)
[S13] loaded HEAD from S2 (vec_in norm=1.054896)
[S13] cosine check vs S2: cos=0.9099
[S13] BUFFERED delta from S2 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1795) from S15
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.359433)
[S11] loaded HEAD from S15 (vec_in norm=1.359433)
[S11] cosine check vs S15: cos=0.4049
[S11] BUFFERED delta from S15 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1799) from S10
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=0.827851)
[S3] loaded HEAD from S10 (vec_in norm=0.827851)
[S3] cosine check vs S10: cos=0.3808
[S3] BUFFERED delta from S10 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1791) from S13
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=0.862052)
[S4] loaded HEAD from S13 (vec_in norm=0.862052)
[S4] cosine check vs S13: cos=0.6344
[S4] BUFFERED delta from S13 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1798) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.973251)
[S17] loaded HEAD from S9 (vec_in norm=0.973251)
[S17] cosine check vs S9: cos=0.3153
[S17] BUFFERED delta from S9 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1792) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.087358)
[S16] loaded HEAD from S5 (vec_in norm=1.087358)
[S16] cosine check vs S5: cos=0.8649
[S16] BUFFERED delta from S5 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1801) from S16
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.854140)
[S17] loaded HEAD from S16 (vec_in norm=0.854140)
[S17] cosine check vs S16: cos=0.3266
[S17] BUFFERED delta from S16 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1797) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.389620)
[S15] loaded HEAD from S14 (vec_in norm=1.389620)
[S15] cosine check vs S14: cos=-0.0104
[S15] DROPPED delta from S14 (cos=-0.0104 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1791) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.968438)
[S13] loaded HEAD from S11 (vec_in norm=0.968438)
[S13] cosine check vs S11: cos=-0.0897
[S13] DROPPED delta from S11 (cos=-0.0897 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.496)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=7 metric=0.6670 head_norm=0.982792
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.981444e-01
[S4] stored merged vector for next round verification (round=7)
[S4] DEBUG after merge:  round=7 metric=0.6661 head_norm=0.834259 delta_norm=0.398144
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=7 metric=0.7007 head_norm=0.712653
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.312322e-01
[S3] stored merged vector for next round verification (round=7)
[S3] DEBUG after merge:  round=7 metric=0.7008 head_norm=0.640816 delta_norm=0.431232
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=7 metric=0.3850 head_norm=0.854140
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.762775e-01
[S16] stored merged vector for next round verification (round=7)
[S16] DEBUG after merge:  round=7 metric=0.3922 head_norm=0.937882 delta_norm=0.276277
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=7 metric=0.4163 head_norm=0.862052
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.242038e-01
[S13] stored merged vector for next round verification (round=7)
[S13] DEBUG after merge:  round=7 metric=0.4163 head_norm=0.936858 delta_norm=0.224204
[S13] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=7 metric=0.2480 head_norm=0.968438
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.557013e-01
[S11] stored merged vector for next round verification (round=7)
[S11] DEBUG after merge:  round=7 metric=0.5238 head_norm=0.981337 delta_norm=0.655701
[S11] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=7 metric=0.3919 head_norm=0.620968
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.487810e-01
[S17] stored merged vector for next round verification (round=7)
[S17] DEBUG after merge:  round=7 metric=0.3919 head_norm=0.550940 delta_norm=0.348781
[S17] aggregate: ACCEPT kept=['S9', 'S16'] (k=2/2) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=1.054896 cos_to_last_merge=0.9552 (last merge round=1)
[S2] round=8 local utility u=0.033365 metrics={'f1_val': 0.4161443568226506, 'auprc': 0.7750118547323233, 'loss_val': 0.9506460347904583, 'psi': 0.5596913559865196}-{'f1_val': 0.416397774005704, 'auprc': 0.7756318896332587, 'loss_val': 1.020756893194911, 'psi': 0.5600914202567259}
[S3] START round=8 head_norm_before_train=0.640816 cos_to_last_merge=1.0000 (last merge round=7)
[S3] round=8 local utility u=0.036864 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.9939899901054698, 'loss_val': 0.5528966197493155, 'psi': 0.8179595975423113}-{'f1_val': 0.7006809596653347, 'auprc': 0.9927016399651634, 'loss_val': 0.6232093585828404, 'psi': 0.8174892317852662}
[S4] START round=8 head_norm_before_train=0.834259 cos_to_last_merge=1.0000 (last merge round=7)
[S4] round=8 local utility u=0.028850 metrics={'f1_val': 0.665944596656441, 'auprc': 0.6598867292710484, 'loss_val': 0.7218400509274782, 'psi': 0.663521449702284}-{'f1_val': 0.6669862706632047, 'auprc': 0.66016288146395, 'loss_val': 0.7866180443533382, 'psi': 0.6642569149835028}
[S5] START round=8 head_norm_before_train=1.087358 cos_to_last_merge=0.8802 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.880
[S5] round=8 local utility u=0.286763 metrics={'f1_val': 0.7010658272644434, 'auprc': 0.910708048429246, 'loss_val': 0.5024777870473688, 'psi': 0.7849227157303644}-{'f1_val': 0.6420789674441347, 'auprc': 0.864638626533186, 'loss_val': 0.5838734894228952, 'psi': 0.7311028310797553}
[S6] START round=8 head_norm_before_train=1.358736 (no previous merge yet)
[S6] round=8 local utility u=0.232774 metrics={'f1_val': 0.41625250229074906, 'auprc': 0.7961334465392653, 'loss_val': 0.790755765267259, 'psi': 0.5682048799901556}-{'f1_val': 0.4172560359570804, 'auprc': 0.6746010906224769, 'loss_val': 0.8977272078314763, 'psi': 0.5201940578232389}
[S7] START round=8 head_norm_before_train=1.025271 cos_to_last_merge=0.9119 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.912
[S7] round=8 local utility u=0.712232 metrics={'f1_val': 0.6473176047815925, 'auprc': 0.7904724925755036, 'loss_val': 0.7062378285290828, 'psi': 0.7045795598991569}-{'f1_val': 0.41671011811102343, 'auprc': 0.7963717482324933, 'loss_val': 0.7647550985046165, 'psi': 0.5685747701596113}
[S8] START round=8 head_norm_before_train=1.014863 cos_to_last_merge=0.9356 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.936
[S8] round=8 local utility u=0.128818 metrics={'f1_val': 0.7146823382599172, 'auprc': 0.7946018636490739, 'loss_val': 0.7407824856980129, 'psi': 0.7466501484155799}-{'f1_val': 0.7142034452617962, 'auprc': 0.777018659647797, 'loss_val': 0.9427946407519053, 'psi': 0.7393295310161966}
[S9] START round=8 head_norm_before_train=0.973251 cos_to_last_merge=0.9887 (last merge round=6)
[S9] round=8 local utility u=0.045942 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9980598978399954, 'loss_val': 0.29091508178906056, 'psi': 0.8199539076000093}-{'f1_val': 0.7012904835408967, 'auprc': 0.998518457734722, 'loss_val': 0.3846181695623202, 'psi': 0.8201816732184268}
[S10] START round=8 head_norm_before_train=0.827851 cos_to_last_merge=0.9209 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.921
[S10] round=8 local utility u=1.000000 metrics={'f1_val': 0.6954171540021203, 'auprc': 0.8855678554220112, 'loss_val': 0.7839230159389624, 'psi': 0.7714774345700768}-{'f1_val': 0.4371539378131648, 'auprc': 0.6634922634531982, 'loss_val': 0.8946989870122014, 'psi': 0.5276892680691782}
[S11] START round=8 head_norm_before_train=0.981337 cos_to_last_merge=1.0000 (last merge round=7)
[S11] round=8 local utility u=1.000000 metrics={'f1_val': 0.862983588689262, 'auprc': 0.9961638431629135, 'loss_val': 0.8738264851985823, 'psi': 0.9162556904787226}-{'f1_val': 0.2480202538888172, 'auprc': 0.8933328999485673, 'loss_val': 0.9140672828288721, 'psi': 0.5061453123127173}
[S13] START round=8 head_norm_before_train=0.936858 cos_to_last_merge=1.0000 (last merge round=7)
[S13] round=8 local utility u=0.026830 metrics={'f1_val': 0.4161203556905605, 'auprc': 0.548885566361238, 'loss_val': 1.0028174578844296, 'psi': 0.4692264399588315}-{'f1_val': 0.4163167573796875, 'auprc': 0.5657372554725275, 'loss_val': 1.1082106586242502, 'psi': 0.4760849566168235}
[S14] START round=8 head_norm_before_train=1.389620 (no previous merge yet)
[S14] round=8 local utility u=0.088031 metrics={'f1_val': 0.9970683588150004, 'auprc': 0.992483083436905, 'loss_val': 0.6235293260871501, 'psi': 0.9952342486637622}-{'f1_val': 0.9974936690910665, 'auprc': 0.9973076258140798, 'loss_val': 0.8166170123268609, 'psi': 0.9974192517802718}
[S15] START round=8 head_norm_before_train=1.359433 (no previous merge yet)
[S15] round=8 local utility u=0.938518 metrics={'f1_val': 0.6936326946357161, 'auprc': 0.8000481445496026, 'loss_val': 0.7952169317414863, 'psi': 0.7361988746012706}-{'f1_val': 0.41699057080661284, 'auprc': 0.7829056063180054, 'loss_val': 0.9609726908912352, 'psi': 0.5633565850111699}
[S16] START round=8 head_norm_before_train=0.937882 cos_to_last_merge=1.0000 (last merge round=7)
[S16] round=8 local utility u=0.226131 metrics={'f1_val': 0.435352612919954, 'auprc': 0.7350282313195906, 'loss_val': 0.910019257537881, 'psi': 0.5552228602798086}-{'f1_val': 0.3850491388228049, 'auprc': 0.7039591324925674, 'loss_val': 0.9672539932490941, 'psi': 0.5126131362907099}
[S17] START round=8 head_norm_before_train=0.550940 cos_to_last_merge=1.0000 (last merge round=7)
[S17] round=8 local utility u=0.029600 metrics={'f1_val': 0.3910215094004868, 'auprc': 0.6694323813619998, 'loss_val': 1.0077102603575827, 'psi': 0.502385858185092}-{'f1_val': 0.39194328393368116, 'auprc': 0.6510692582081862, 'loss_val': 1.0173520063003307, 'psi': 0.49559367364348317}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:42016
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:42010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S10@127.0.0.1:42011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:42012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:42014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:42013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:42004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:42003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S11@127.0.0.1:42012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:42015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S13@127.0.0.1:42013
[S14] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1793 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1800) from S15
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.398147)
[S11] loaded HEAD from S15 (vec_in norm=1.398147)
[S11] cosine check vs S15: cos=0.8671
[S11] BUFFERED delta from S15 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1796) from S13
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=0.960871)
[S4] loaded HEAD from S13 (vec_in norm=0.960871)
[S4] cosine check vs S13: cos=0.7639
[S4] BUFFERED delta from S13 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1800) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.139911)
[S16] loaded HEAD from S5 (vec_in norm=1.139911)
[S16] cosine check vs S5: cos=0.9548
[S16] BUFFERED delta from S5 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1803) from S16
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.974229)
[S17] loaded HEAD from S16 (vec_in norm=0.974229)
[S17] cosine check vs S16: cos=0.5366
[S17] BUFFERED delta from S16 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1797) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.076178)
[S14] loaded HEAD from S7 (vec_in norm=1.076178)
[S14] cosine check vs S7: cos=0.0070
[S14] BUFFERED delta from S7 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1801) from S2
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.091305)
[S13] loaded HEAD from S2 (vec_in norm=1.091305)
[S13] cosine check vs S2: cos=0.9733
[S13] BUFFERED delta from S2 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1794) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.017438)
[S13] loaded HEAD from S11 (vec_in norm=1.017438)
[S13] cosine check vs S11: cos=-0.0436
[S13] DROPPED delta from S11 (cos=-0.0436 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1803) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.396584)
[S11] loaded HEAD from S6 (vec_in norm=1.396584)
[S11] cosine check vs S6: cos=0.4949
[S11] BUFFERED delta from S6 (total buffered=2)
[S3] RECEIVED delta(kind=head bytes=1795) from S10
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=0.881805)
[S3] loaded HEAD from S10 (vec_in norm=0.881805)
[S3] cosine check vs S10: cos=0.7403
[S3] BUFFERED delta from S10 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1801) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.444918)
[S15] loaded HEAD from S14 (vec_in norm=1.444918)
[S15] cosine check vs S14: cos=-0.0122
[S15] DROPPED delta from S14 (cos=-0.0122 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1799) from S3
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=0.763483)
[S9] loaded HEAD from S3 (vec_in norm=0.763483)
[S9] cosine check vs S3: cos=0.7524
[S9] BUFFERED delta from S3 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1796) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.055187)
[S17] loaded HEAD from S8 (vec_in norm=1.055187)
[S17] cosine check vs S8: cos=-0.0500
[S17] DROPPED delta from S8 (cos=-0.0500 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1793) from S4
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.896112)
[S10] loaded HEAD from S4 (vec_in norm=0.896112)
[S10] cosine check vs S4: cos=-0.1114
[S10] DROPPED delta from S4 (cos=-0.1114 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1797) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.085185)
[S17] loaded HEAD from S9 (vec_in norm=1.085185)
[S17] cosine check vs S9: cos=0.5794
[S17] BUFFERED delta from S9 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:42003
[S17] sending update (kind=head size=1800 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1800) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.601039)
[S3] loaded HEAD from S17 (vec_in norm=0.601039)
[S3] cosine check vs S17: cos=0.6054
[S3] BUFFERED delta from S17 (total buffered=2)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=8 metric=0.9971 head_norm=1.444918
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.978011e-01
[S14] stored merged vector for next round verification (round=8)
[S14] DEBUG after merge:  round=8 metric=0.9654 head_norm=0.903840 delta_norm=0.897801
[S14] aggregate: ROLLBACK (f1_val pre=0.997 post=0.965 tol_abs=0.005 tol_rel=0.0)
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=8 metric=0.7006 head_norm=0.763483
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.062875e-01
[S3] stored merged vector for next round verification (round=8)
[S3] DEBUG after merge:  round=8 metric=0.7006 head_norm=0.656264 delta_norm=0.206288
[S3] aggregate: ACCEPT kept=['S10', 'S17'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=8 metric=0.8630 head_norm=1.017438
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.947093e-01
[S11] stored merged vector for next round verification (round=8)
[S11] DEBUG after merge:  round=8 metric=0.5891 head_norm=1.003112 delta_norm=0.194709
[S11] aggregate: ROLLBACK (f1_val pre=0.863 post=0.589 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=8 metric=0.6659 head_norm=0.896112
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.204866e-01
[S4] stored merged vector for next round verification (round=8)
[S4] DEBUG after merge:  round=8 metric=0.6647 head_norm=0.872029 delta_norm=0.320487
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=8 metric=0.7012 head_norm=1.085185
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.583809e-01
[S9] stored merged vector for next round verification (round=8)
[S9] DEBUG after merge:  round=8 metric=0.7012 head_norm=0.867081 delta_norm=0.358381
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=8 metric=0.4161 head_norm=0.960871
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.350058e-01
[S13] stored merged vector for next round verification (round=8)
[S13] DEBUG after merge:  round=8 metric=0.4161 head_norm=1.019257 delta_norm=0.135006
[S13] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=8 metric=0.4354 head_norm=0.974229
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.787050e-01
[S16] stored merged vector for next round verification (round=8)
[S16] DEBUG after merge:  round=8 metric=0.4355 head_norm=1.045144 delta_norm=0.178705
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=8 metric=0.3910 head_norm=0.601039
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.617665e-01
[S17] stored merged vector for next round verification (round=8)
[S17] DEBUG after merge:  round=8 metric=0.3904 head_norm=0.643872 delta_norm=0.261767
[S17] aggregate: ACCEPT kept=['S16', 'S9'] (k=2/2) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.091305 cos_to_last_merge=0.9443 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.944
[S2] round=9 local utility u=0.645513 metrics={'f1_val': 0.6138132976310324, 'auprc': 0.778865854715154, 'loss_val': 0.8571958979372444, 'psi': 0.6798343204646811}-{'f1_val': 0.4161443568226506, 'auprc': 0.7750118547323233, 'loss_val': 0.9506460347904583, 'psi': 0.5596913559865196}
[S3] START round=9 head_norm_before_train=0.656264 cos_to_last_merge=1.0000 (last merge round=8)
[S3] round=9 local utility u=0.030740 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9961933487989036, 'loss_val': 0.4984770546309084, 'psi': 0.8188859153187623}-{'f1_val': 0.7006060025002057, 'auprc': 0.9939899901054698, 'loss_val': 0.5528966197493155, 'psi': 0.8179595975423113}
[S4] START round=9 head_norm_before_train=0.872029 cos_to_last_merge=1.0000 (last merge round=8)
[S4] round=9 local utility u=0.013813 metrics={'f1_val': 0.6647420447131955, 'auprc': 0.6587794113569126, 'loss_val': 0.6836774982100147, 'psi': 0.6623569913706824}-{'f1_val': 0.665944596656441, 'auprc': 0.6598867292710484, 'loss_val': 0.7218400509274782, 'psi': 0.663521449702284}
[S5] START round=9 head_norm_before_train=1.139911 cos_to_last_merge=0.8671 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.867
[S5] round=9 local utility u=0.000000 metrics={'f1_val': 0.43349531248701534, 'auprc': 0.8538323618184316, 'loss_val': 0.5871898666139166, 'psi': 0.6016301322195818}-{'f1_val': 0.7010658272644434, 'auprc': 0.910708048429246, 'loss_val': 0.5024777870473688, 'psi': 0.7849227157303644}
[S6] START round=9 head_norm_before_train=1.396584 (no previous merge yet)
[S6] round=9 local utility u=0.054367 metrics={'f1_val': 0.41689493363097396, 'auprc': 0.7949475883622759, 'loss_val': 0.6823187648363088, 'psi': 0.5681159955234947}-{'f1_val': 0.41625250229074906, 'auprc': 0.7961334465392653, 'loss_val': 0.790755765267259, 'psi': 0.5682048799901556}
[S7] START round=9 head_norm_before_train=1.076178 cos_to_last_merge=0.8963 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.896
[S7] round=9 local utility u=0.000000 metrics={'f1_val': 0.43901824304122006, 'auprc': 0.8732883596689571, 'loss_val': 0.8093730937699655, 'psi': 0.6127262896923149}-{'f1_val': 0.6473176047815925, 'auprc': 0.7904724925755036, 'loss_val': 0.7062378285290828, 'psi': 0.7045795598991569}
[S8] START round=9 head_norm_before_train=1.055187 cos_to_last_merge=0.9204 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.920
[S8] round=9 local utility u=0.384059 metrics={'f1_val': 0.7142671658282026, 'auprc': 0.9951184315932922, 'loss_val': 0.5717231205289985, 'psi': 0.8266076721342384}-{'f1_val': 0.7146823382599172, 'auprc': 0.7946018636490739, 'loss_val': 0.7407824856980129, 'psi': 0.7466501484155799}
[S9] START round=9 head_norm_before_train=0.867081 cos_to_last_merge=1.0000 (last merge round=8)
[S9] round=9 local utility u=0.002951 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9980714613145376, 'loss_val': 0.28504693995230534, 'psi': 0.8199585329898262}-{'f1_val': 0.7012165807733519, 'auprc': 0.9980598978399954, 'loss_val': 0.29091508178906056, 'psi': 0.8199539076000093}
[S10] START round=9 head_norm_before_train=0.881805 cos_to_last_merge=0.8959 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.896
[S10] round=9 local utility u=0.203094 metrics={'f1_val': 0.6951237566286788, 'auprc': 0.9864918966622226, 'loss_val': 0.6787475523689744, 'psi': 0.8116710126420963}-{'f1_val': 0.6954171540021203, 'auprc': 0.8855678554220112, 'loss_val': 0.7839230159389624, 'psi': 0.7714774345700768}
[S11] START round=9 head_norm_before_train=1.003112 cos_to_last_merge=1.0000 (last merge round=8)
[S11] round=9 local utility u=0.000000 metrics={'f1_val': 0.7018246587012323, 'auprc': 0.9391685877977987, 'loss_val': 0.7489651920560022, 'psi': 0.7967622303398589}-{'f1_val': 0.862983588689262, 'auprc': 0.9961638431629135, 'loss_val': 0.8738264851985823, 'psi': 0.9162556904787226}
[S13] START round=9 head_norm_before_train=1.019257 cos_to_last_merge=1.0000 (last merge round=8)
[S13] round=9 local utility u=0.328985 metrics={'f1_val': 0.4161203556905605, 'auprc': 0.7379028871123033, 'loss_val': 0.911898438754542, 'psi': 0.5448333682592577}-{'f1_val': 0.4161203556905605, 'auprc': 0.548885566361238, 'loss_val': 1.0028174578844296, 'psi': 0.4692264399588315}
[S14] START round=9 head_norm_before_train=0.903840 cos_to_last_merge=1.0000 (last merge round=8)
[S14] round=9 local utility u=0.000000 metrics={'f1_val': 0.9975421968354906, 'auprc': 0.9956977681247513, 'loss_val': 0.654565972643371, 'psi': 0.996804425351195}-{'f1_val': 0.9970683588150004, 'auprc': 0.992483083436905, 'loss_val': 0.6235293260871501, 'psi': 0.9952342486637622}
[S15] START round=9 head_norm_before_train=1.398147 (no previous merge yet)
[S15] round=9 local utility u=0.298840 metrics={'f1_val': 0.6911800763979801, 'auprc': 0.953395715037163, 'loss_val': 0.642862961515239, 'psi': 0.7960663318536532}-{'f1_val': 0.6936326946357161, 'auprc': 0.8000481445496026, 'loss_val': 0.7952169317414863, 'psi': 0.7361988746012706}
[S16] START round=9 head_norm_before_train=1.045144 cos_to_last_merge=1.0000 (last merge round=8)
[S16] round=9 local utility u=0.000000 metrics={'f1_val': 0.3518958178143201, 'auprc': 0.740127641874067, 'loss_val': 0.9197063228471601, 'psi': 0.5071885474382188}-{'f1_val': 0.435352612919954, 'auprc': 0.7350282313195906, 'loss_val': 0.910019257537881, 'psi': 0.5552228602798086}
[S17] START round=9 head_norm_before_train=0.643872 cos_to_last_merge=1.0000 (last merge round=8)
[S17] round=9 local utility u=0.000000 metrics={'f1_val': 0.37783225684075594, 'auprc': 0.6671010930562026, 'loss_val': 1.0237729787182042, 'psi': 0.4935397913269346}-{'f1_val': 0.3910215094004868, 'auprc': 0.6694323813619998, 'loss_val': 1.0077102603575827, 'psi': 0.502385858185092}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] → sending delta(kind=head bytes=1792) to S10@127.0.0.1:42011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:42012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:42012
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:42013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:42004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:42010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:42003
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1792 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1801) from S10
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=0.936498)
[S3] loaded HEAD from S10 (vec_in norm=0.936498)
[S3] cosine check vs S10: cos=0.7293
[S3] BUFFERED delta from S10 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1801) from S13
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.043774)
[S4] loaded HEAD from S13 (vec_in norm=1.043774)
[S4] cosine check vs S13: cos=0.8811
[S4] BUFFERED delta from S13 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1800) from S3
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=0.771908)
[S9] loaded HEAD from S3 (vec_in norm=0.771908)
[S9] cosine check vs S3: cos=0.8660
[S9] BUFFERED delta from S3 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1799) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.106880)
[S17] loaded HEAD from S8 (vec_in norm=1.106880)
[S17] cosine check vs S8: cos=-0.0168
[S17] DROPPED delta from S8 (cos=-0.0168 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1795) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.964002)
[S17] loaded HEAD from S9 (vec_in norm=0.964002)
[S17] cosine check vs S9: cos=0.7220
[S17] BUFFERED delta from S9 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1798) from S2
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.137145)
[S13] loaded HEAD from S2 (vec_in norm=1.137145)
[S13] cosine check vs S2: cos=0.9871
[S13] BUFFERED delta from S2 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1792) from S4
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.928587)
[S10] loaded HEAD from S4 (vec_in norm=0.928587)
[S10] cosine check vs S4: cos=-0.1457
[S10] DROPPED delta from S4 (cos=-0.1457 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1795) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.434618)
[S11] loaded HEAD from S6 (vec_in norm=1.434618)
[S11] cosine check vs S6: cos=0.6239
[S11] BUFFERED delta from S6 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1801) from S15
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.443906)
[S11] loaded HEAD from S15 (vec_in norm=1.443906)
[S11] cosine check vs S15: cos=0.7903
[S11] BUFFERED delta from S15 (total buffered=2)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=9 metric=0.7018 head_norm=1.045738
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.402128e-01
[S11] stored merged vector for next round verification (round=9)
[S11] DEBUG after merge:  round=9 metric=0.7018 head_norm=1.041321 delta_norm=0.140213
[S11] aggregate: ACCEPT kept=['S6', 'S15'] (k=2/2) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=9 metric=0.7007 head_norm=0.771908
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.234547e-01
[S3] stored merged vector for next round verification (round=9)
[S3] DEBUG after merge:  round=9 metric=0.7007 head_norm=0.794866 delta_norm=0.323455
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=9 metric=0.6647 head_norm=0.928587
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.468695e-01
[S4] stored merged vector for next round verification (round=9)
[S4] DEBUG after merge:  round=9 metric=0.6639 head_norm=0.956517 delta_norm=0.246870
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=9 metric=0.4161 head_norm=1.043774
[S13] _apply_head_vector_avg (torch): Δ‖w‖=9.906727e-02
[S13] stored merged vector for next round verification (round=9)
[S13] DEBUG after merge:  round=9 metric=0.4161 head_norm=1.086953 delta_norm=0.099067
[S13] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=9 metric=0.7012 head_norm=0.964002
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.430726e-01
[S9] stored merged vector for next round verification (round=9)
[S9] DEBUG after merge:  round=9 metric=0.7012 head_norm=0.838741 delta_norm=0.243073
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=9 metric=0.3778 head_norm=0.681265
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.335803e-01
[S17] stored merged vector for next round verification (round=9)
[S17] DEBUG after merge:  round=9 metric=0.3759 head_norm=0.765137 delta_norm=0.333580
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.137145 cos_to_last_merge=0.9306 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.931
[S2] round=10 local utility u=0.043431 metrics={'f1_val': 0.6258702508453262, 'auprc': 0.7762456226367096, 'loss_val': 0.8348157215616907, 'psi': 0.6860203995618797}-{'f1_val': 0.6138132976310324, 'auprc': 0.778865854715154, 'loss_val': 0.8571958979372444, 'psi': 0.6798343204646811}
[S3] START round=10 head_norm_before_train=0.794866 cos_to_last_merge=1.0000 (last merge round=9)
[S3] round=10 local utility u=0.027918 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.9978827290678934, 'loss_val': 0.4472588475755504, 'psi': 0.8195166931272808}-{'f1_val': 0.7006809596653347, 'auprc': 0.9961933487989036, 'loss_val': 0.4984770546309084, 'psi': 0.8188859153187623}
[S4] START round=10 head_norm_before_train=0.956517 cos_to_last_merge=1.0000 (last merge round=9)
[S4] round=10 local utility u=0.012894 metrics={'f1_val': 0.664119464359977, 'auprc': 0.6582722183190702, 'loss_val': 0.6526323353674308, 'psi': 0.6617805659436142}-{'f1_val': 0.6647420447131955, 'auprc': 0.6587794113569126, 'loss_val': 0.6836774982100147, 'psi': 0.6623569913706824}
[S5] START round=10 head_norm_before_train=1.186901 cos_to_last_merge=0.8570 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.857
[S5] round=10 local utility u=0.784257 metrics={'f1_val': 0.668467674976184, 'auprc': 0.8539420218382262, 'loss_val': 0.428838356137415, 'psi': 0.7426574137210009}-{'f1_val': 0.43349531248701534, 'auprc': 0.8538323618184316, 'loss_val': 0.5871898666139166, 'psi': 0.6016301322195818}
[S6] START round=10 head_norm_before_train=1.434618 (no previous merge yet)
[S6] round=10 local utility u=0.667054 metrics={'f1_val': 0.620301554463625, 'auprc': 0.7940869855266655, 'loss_val': 0.5660696707273253, 'psi': 0.6898157268888412}-{'f1_val': 0.41689493363097396, 'auprc': 0.7949475883622759, 'loss_val': 0.6823187648363088, 'psi': 0.5681159955234947}
[S7] START round=10 head_norm_before_train=1.118406 cos_to_last_merge=0.8838 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.884
[S7] round=10 local utility u=0.000000 metrics={'f1_val': 0.42728128508296614, 'auprc': 0.7842822955712174, 'loss_val': 0.8579001894245597, 'psi': 0.5700816892782667}-{'f1_val': 0.43901824304122006, 'auprc': 0.8732883596689571, 'loss_val': 0.8093730937699655, 'psi': 0.6127262896923149}
[S8] START round=10 head_norm_before_train=1.106880 cos_to_last_merge=0.9023 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.902
[S8] round=10 local utility u=0.072695 metrics={'f1_val': 0.7137258999321696, 'auprc': 0.9952204609167483, 'loss_val': 0.4233909090260529, 'psi': 0.8263237243260011}-{'f1_val': 0.7142671658282026, 'auprc': 0.9951184315932922, 'loss_val': 0.5717231205289985, 'psi': 0.8266076721342384}
[S9] START round=10 head_norm_before_train=0.838741 cos_to_last_merge=1.0000 (last merge round=9)
[S9] round=10 local utility u=0.863163 metrics={'f1_val': 0.9873949972964658, 'auprc': 0.9975245400643011, 'loss_val': 0.2741505011782455, 'psi': 0.9914468144035999}-{'f1_val': 0.7012165807733519, 'auprc': 0.9980714613145376, 'loss_val': 0.28504693995230534, 'psi': 0.8199585329898262}
[S10] START round=10 head_norm_before_train=0.936498 cos_to_last_merge=0.8723 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.872
[S10] round=10 local utility u=0.000000 metrics={'f1_val': 0.5648684534860662, 'auprc': 0.9234126107439946, 'loss_val': 0.6443109278942223, 'psi': 0.7082861163892376}-{'f1_val': 0.6951237566286788, 'auprc': 0.9864918966622226, 'loss_val': 0.6787475523689744, 'psi': 0.8116710126420963}
[S11] START round=10 head_norm_before_train=1.041321 cos_to_last_merge=1.0000 (last merge round=9)
[S11] round=10 local utility u=0.053662 metrics={'f1_val': 0.7017589383281313, 'auprc': 0.9391298902108215, 'loss_val': 0.641130197063582, 'psi': 0.7967073190812074}-{'f1_val': 0.7018246587012323, 'auprc': 0.9391685877977987, 'loss_val': 0.7489651920560022, 'psi': 0.7967622303398589}
[S13] START round=10 head_norm_before_train=1.086953 cos_to_last_merge=1.0000 (last merge round=9)
[S13] round=10 local utility u=0.000000 metrics={'f1_val': 0.38824091783305903, 'auprc': 0.5895849280056518, 'loss_val': 0.8964368575169847, 'psi': 0.4687785219020961}-{'f1_val': 0.4161203556905605, 'auprc': 0.7379028871123033, 'loss_val': 0.911898438754542, 'psi': 0.5448333682592577}
[S14] START round=10 head_norm_before_train=0.956572 cos_to_last_merge=0.9969 (last merge round=8)
[S14] round=10 local utility u=0.070744 metrics={'f1_val': 0.9960294594381027, 'auprc': 0.9931486182030457, 'loss_val': 0.49635408139533616, 'psi': 0.9948771229440799}-{'f1_val': 0.9975421968354906, 'auprc': 0.9956977681247513, 'loss_val': 0.654565972643371, 'psi': 0.996804425351195}
[S15] START round=10 head_norm_before_train=1.443906 (no previous merge yet)
[S15] round=10 local utility u=0.000000 metrics={'f1_val': 0.6986079960532545, 'auprc': 0.8642570694250212, 'loss_val': 0.515510534927266, 'psi': 0.7648676254019612}-{'f1_val': 0.6911800763979801, 'auprc': 0.953395715037163, 'loss_val': 0.642862961515239, 'psi': 0.7960663318536532}
[S16] START round=10 head_norm_before_train=1.079090 cos_to_last_merge=0.9975 (last merge round=8)
[S16] round=10 local utility u=0.280046 metrics={'f1_val': 0.43641518309272553, 'auprc': 0.7362045360600911, 'loss_val': 0.854960346081236, 'psi': 0.5563309242796717}-{'f1_val': 0.3518958178143201, 'auprc': 0.740127641874067, 'loss_val': 0.9197063228471601, 'psi': 0.5071885474382188}
[S17] START round=10 head_norm_before_train=0.765137 cos_to_last_merge=1.0000 (last merge round=9)
[S17] round=10 local utility u=0.000000 metrics={'f1_val': 0.3547618595344832, 'auprc': 0.5992666185339495, 'loss_val': 1.0226401056101684, 'psi': 0.4525637631342697}-{'f1_val': 0.37783225684075594, 'auprc': 0.6671010930562026, 'loss_val': 1.0237729787182042, 'psi': 0.4935397913269346}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.662)
[S6] not sending this round → trigger blocked (psi=0.690)
[S9] not sending this round → trigger blocked (psi=0.991)
[S8] not sending this round → trigger blocked (psi=0.826)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S13@127.0.0.1:42013
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:42016
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:42017
[S3] not sending this round → trigger blocked (psi=0.820)
[S2] not sending this round → trigger blocked (psi=0.686)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:42015
[S16] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1793 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1798) from S16
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.115003)
[S17] loaded HEAD from S16 (vec_in norm=1.115003)
[S17] cosine check vs S16: cos=0.3859
[S17] BUFFERED delta from S16 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1793) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.235681)
[S16] loaded HEAD from S5 (vec_in norm=1.235681)
[S16] cosine check vs S5: cos=0.9639
[S16] BUFFERED delta from S5 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1797) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.014792)
[S15] loaded HEAD from S14 (vec_in norm=1.014792)
[S15] cosine check vs S14: cos=0.3337
[S15] BUFFERED delta from S14 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1794) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.086519)
[S13] loaded HEAD from S11 (vec_in norm=1.086519)
[S13] cosine check vs S11: cos=-0.0461
[S13] DROPPED delta from S11 (cos=-0.0461 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] ⇄ pheromone p=0.315 → S13@127.0.0.1:42013
[S7] ⇄ pheromone p=0.265 → S14@127.0.0.1:42014
[S10] ⇄ pheromone p=0.386 → S3@127.0.0.1:42003
[S8] ⇄ pheromone p=0.381 → S17@127.0.0.1:42017
[S6] ⇄ pheromone p=0.370 → S11@127.0.0.1:42012
[S3] ⇄ pheromone p=0.274 → S9@127.0.0.1:42010
[S9] ⇄ pheromone p=0.443 → S17@127.0.0.1:42017
[S13] ⇄ pheromone p=0.247 → S4@127.0.0.1:42004
[S4] ⇄ pheromone p=0.259 → S10@127.0.0.1:42011
[S14] ⇄ pheromone p=0.386 → S15@127.0.0.1:42015
[S11] ⇄ pheromone p=0.304 → S13@127.0.0.1:42013
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=10 metric=0.4364 head_norm=1.115003
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.688424e-01
[S16] stored merged vector for next round verification (round=10)
[S16] DEBUG after merge:  round=10 metric=0.4368 head_norm=1.164715 delta_norm=0.168842
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.263 → S17@127.0.0.1:42017
[S5] ⇄ pheromone p=0.448 → S16@127.0.0.1:42016
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=10 metric=0.3548 head_norm=0.799971
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.465446e-01
[S17] stored merged vector for next round verification (round=10)
[S17] DEBUG after merge:  round=10 metric=0.3536 head_norm=0.801799 delta_norm=0.546545
[S17] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.228 → S3@127.0.0.1:42003
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=10 metric=0.6986 head_norm=1.491436
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.489921e-01
[S15] stored merged vector for next round verification (round=10)
[S15] DEBUG after merge:  round=10 metric=0.6986 head_norm=1.032522 delta_norm=0.748992
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.378 → S11@127.0.0.1:42012
[S2] START round=11 head_norm_before_train=1.189026 cos_to_last_merge=0.9159 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.916
[S2] round=11 local utility u=0.207198 metrics={'f1_val': 0.6735539928001539, 'auprc': 0.7768481024280056, 'loss_val': 0.7083305291200718, 'psi': 0.7148716366512946}-{'f1_val': 0.6258702508453262, 'auprc': 0.7762456226367096, 'loss_val': 0.8348157215616907, 'psi': 0.6860203995618797}
[S3] START round=11 head_norm_before_train=0.896172 cos_to_last_merge=0.9789 (last merge round=9)
[S3] round=11 local utility u=0.066729 metrics={'f1_val': 0.7003512381127298, 'auprc': 0.9978770578130602, 'loss_val': 0.3122544407119425, 'psi': 0.8193615659928619}-{'f1_val': 0.7006060025002057, 'auprc': 0.9978827290678934, 'loss_val': 0.4472588475755504, 'psi': 0.8195166931272808}
[S4] START round=11 head_norm_before_train=1.005862 cos_to_last_merge=0.9938 (last merge round=9)
[S4] round=11 local utility u=0.045307 metrics={'f1_val': 0.6664700489963007, 'auprc': 0.6582727353944555, 'loss_val': 0.5761239660597526, 'psi': 0.6631911235555625}-{'f1_val': 0.664119464359977, 'auprc': 0.6582722183190702, 'loss_val': 0.6526323353674308, 'psi': 0.6617805659436142}
[S5] START round=11 head_norm_before_train=1.235681 cos_to_last_merge=0.8481 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.848
[S5] round=11 local utility u=0.016583 metrics={'f1_val': 0.6644320949608227, 'auprc': 0.8541118320997697, 'loss_val': 0.3719678452666751, 'psi': 0.7403039898164014}-{'f1_val': 0.668467674976184, 'auprc': 0.8539420218382262, 'loss_val': 0.428838356137415, 'psi': 0.7426574137210009}
[S6] START round=11 head_norm_before_train=1.475835 (no previous merge yet)
[S6] round=11 local utility u=0.588270 metrics={'f1_val': 0.7121847612527392, 'auprc': 0.9632586801646538, 'loss_val': 0.44834323526132047, 'psi': 0.8126143288175051}-{'f1_val': 0.620301554463625, 'auprc': 0.7940869855266655, 'loss_val': 0.5660696707273253, 'psi': 0.6898157268888412}
[S7] START round=11 head_norm_before_train=1.157108 cos_to_last_merge=0.8728 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.873
[S7] round=11 local utility u=0.000000 metrics={'f1_val': 0.3941709370278018, 'auprc': 0.7794683309064253, 'loss_val': 0.9908909454358372, 'psi': 0.5482898945792513}-{'f1_val': 0.42728128508296614, 'auprc': 0.7842822955712174, 'loss_val': 0.8579001894245597, 'psi': 0.5700816892782667}
[S8] START round=11 head_norm_before_train=1.157233 cos_to_last_merge=0.8847 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.885
[S8] round=11 local utility u=0.053860 metrics={'f1_val': 0.7141738056351523, 'auprc': 0.9942937993473188, 'loss_val': 0.31557782197933587, 'psi': 0.8262218031200189}-{'f1_val': 0.7137258999321696, 'auprc': 0.9952204609167483, 'loss_val': 0.4233909090260529, 'psi': 0.8263237243260011}
[S9] START round=11 head_norm_before_train=0.939266 cos_to_last_merge=0.9913 (last merge round=9)
[S9] round=11 local utility u=0.049828 metrics={'f1_val': 0.9899455008418782, 'auprc': 0.997790825651856, 'loss_val': 0.1905960706305287, 'psi': 0.9930836307658693}-{'f1_val': 0.9873949972964658, 'auprc': 0.9975245400643011, 'loss_val': 0.2741505011782455, 'psi': 0.9914468144035999}
[S10] START round=11 head_norm_before_train=0.982881 cos_to_last_merge=0.8555 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.855
[S10] round=11 local utility u=0.442224 metrics={'f1_val': 0.7018166910238366, 'auprc': 0.9096064498122535, 'loss_val': 0.5401345986331259, 'psi': 0.7849325945392034}-{'f1_val': 0.5648684534860662, 'auprc': 0.9234126107439946, 'loss_val': 0.6443109278942223, 'psi': 0.7082861163892376}
[S11] START round=11 head_norm_before_train=1.086519 cos_to_last_merge=0.9956 (last merge round=9)
[S11] round=11 local utility u=0.032350 metrics={'f1_val': 0.7012129785687009, 'auprc': 0.9401126294144507, 'loss_val': 0.5761021242501605, 'psi': 0.7967728389070008}-{'f1_val': 0.7017589383281313, 'auprc': 0.9391298902108215, 'loss_val': 0.641130197063582, 'psi': 0.7967073190812074}
[S13] START round=11 head_norm_before_train=1.111031 cos_to_last_merge=0.9983 (last merge round=9)
[S13] round=11 local utility u=0.336580 metrics={'f1_val': 0.41580726865236384, 'auprc': 0.7372314812161278, 'loss_val': 0.8316138094415482, 'psi': 0.5443769536778694}-{'f1_val': 0.38824091783305903, 'auprc': 0.5895849280056518, 'loss_val': 0.8964368575169847, 'psi': 0.4687785219020961}
[S14] START round=11 head_norm_before_train=1.014792 cos_to_last_merge=0.9893 (last merge round=8)
[S14] round=11 local utility u=0.014700 metrics={'f1_val': 0.9778500310501528, 'auprc': 0.9970604878990912, 'loss_val': 0.36961260521556566, 'psi': 0.9855342137897282}-{'f1_val': 0.9960294594381027, 'auprc': 0.9931486182030457, 'loss_val': 0.49635408139533616, 'psi': 0.9948771229440799}
[S15] START round=11 head_norm_before_train=1.032522 cos_to_last_merge=1.0000 (last merge round=10)
[S15] round=11 local utility u=0.000000 metrics={'f1_val': 0.6943482873912493, 'auprc': 0.8017598275235226, 'loss_val': 0.5838213495122678, 'psi': 0.7373129034441587}-{'f1_val': 0.6986079960532545, 'auprc': 0.8642570694250212, 'loss_val': 0.515510534927266, 'psi': 0.7648676254019612}
[S16] START round=11 head_norm_before_train=1.164715 cos_to_last_merge=1.0000 (last merge round=10)
[S16] round=11 local utility u=0.000000 metrics={'f1_val': 0.3652820918229044, 'auprc': 0.7318228431309968, 'loss_val': 0.8242588386177866, 'psi': 0.5118983923461413}-{'f1_val': 0.43641518309272553, 'auprc': 0.7362045360600911, 'loss_val': 0.854960346081236, 'psi': 0.5563309242796717}
[S17] START round=11 head_norm_before_train=0.801799 cos_to_last_merge=1.0000 (last merge round=10)
[S17] round=11 local utility u=0.136205 metrics={'f1_val': 0.35298479666097704, 'auprc': 0.6908102459176397, 'loss_val': 1.014199566706337, 'psi': 0.4881149763636421}-{'f1_val': 0.3547618595344832, 'auprc': 0.5992666185339495, 'loss_val': 1.0226401056101684, 'psi': 0.4525637631342697}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:42012
[S5] not sending this round → trigger blocked (psi=0.740)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] → sending delta(kind=head bytes=1793) to S13@127.0.0.1:42013
[S11] not sending this round → trigger blocked (psi=0.797)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.986)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:42004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:42011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:42010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:42003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:42017
[S10] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1793 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1798) from S10
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.024547)
[S3] loaded HEAD from S10 (vec_in norm=1.024547)
[S3] cosine check vs S10: cos=0.7933
[S3] BUFFERED delta from S10 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1799) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.198688)
[S17] loaded HEAD from S8 (vec_in norm=1.198688)
[S17] cosine check vs S8: cos=0.0199
[S17] BUFFERED delta from S8 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1799) from S13
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.138589)
[S4] loaded HEAD from S13 (vec_in norm=1.138589)
[S4] cosine check vs S13: cos=0.9118
[S4] BUFFERED delta from S13 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1793) from S2
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.239187)
[S13] loaded HEAD from S2 (vec_in norm=1.239187)
[S13] cosine check vs S2: cos=0.9811
[S13] BUFFERED delta from S2 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1796) from S3
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.005709)
[S9] loaded HEAD from S3 (vec_in norm=1.005709)
[S9] cosine check vs S3: cos=0.8446
[S9] BUFFERED delta from S3 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1798) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.029559)
[S17] loaded HEAD from S9 (vec_in norm=1.029559)
[S17] cosine check vs S9: cos=0.5918
[S17] BUFFERED delta from S9 (total buffered=2)
[S11] RECEIVED delta(kind=head bytes=1800) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.520069)
[S11] loaded HEAD from S6 (vec_in norm=1.520069)
[S11] cosine check vs S6: cos=0.6750
[S11] BUFFERED delta from S6 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1801) from S4
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.065497)
[S10] loaded HEAD from S4 (vec_in norm=1.065497)
[S10] cosine check vs S4: cos=-0.1538
[S10] DROPPED delta from S4 (cos=-0.1538 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:42003
[S17] sending update (kind=head size=1795 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1795) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.834601)
[S3] loaded HEAD from S17 (vec_in norm=0.834601)
[S3] cosine check vs S17: cos=0.5538
[S3] BUFFERED delta from S17 (total buffered=2)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=11 metric=0.7012 head_norm=1.135227
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.633919e-01
[S11] stored merged vector for next round verification (round=11)
[S11] DEBUG after merge:  round=11 metric=0.7019 head_norm=1.217483 delta_norm=0.563392
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=11 metric=0.6665 head_norm=1.065497
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.341658e-01
[S4] stored merged vector for next round verification (round=11)
[S4] DEBUG after merge:  round=11 metric=0.6657 head_norm=1.077498 delta_norm=0.234166
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=11 metric=0.9899 head_norm=1.029559
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.839353e-01
[S9] stored merged vector for next round verification (round=11)
[S9] DEBUG after merge:  round=11 metric=0.9895 head_norm=0.977293 delta_norm=0.283935
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=11 metric=0.4158 head_norm=1.138589
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.260798e-01
[S13] stored merged vector for next round verification (round=11)
[S13] DEBUG after merge:  round=11 metric=0.4158 head_norm=1.183254 delta_norm=0.126080
[S13] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=11 metric=0.7004 head_norm=1.005709
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.795783e-01
[S3] stored merged vector for next round verification (round=11)
[S3] DEBUG after merge:  round=11 metric=0.7004 head_norm=0.848127 delta_norm=0.279578
[S3] aggregate: ACCEPT kept=['S10', 'S17'] (k=2/2) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=11 metric=0.3530 head_norm=0.834601
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.433680e-01
[S17] stored merged vector for next round verification (round=11)
[S17] DEBUG after merge:  round=11 metric=0.3527 head_norm=0.678799 delta_norm=0.443368
[S17] aggregate: ACCEPT kept=['S8', 'S9'] (k=2/2) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.239187 cos_to_last_merge=0.9018 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.902
[S2] round=12 local utility u=0.173037 metrics={'f1_val': 0.7118439981592104, 'auprc': 0.7777327506491722, 'loss_val': 0.5946514653960033, 'psi': 0.7381994991551951}-{'f1_val': 0.6735539928001539, 'auprc': 0.7768481024280056, 'loss_val': 0.7083305291200718, 'psi': 0.7148716366512946}
[S3] START round=12 head_norm_before_train=0.848127 cos_to_last_merge=1.0000 (last merge round=11)
[S3] round=12 local utility u=0.702289 metrics={'f1_val': 0.9348034872792208, 'auprc': 0.9980990109207366, 'loss_val': 0.31505492278585207, 'psi': 0.9601216967358271}-{'f1_val': 0.7003512381127298, 'auprc': 0.9978770578130602, 'loss_val': 0.3122544407119425, 'psi': 0.8193615659928619}
[S4] START round=12 head_norm_before_train=1.077498 cos_to_last_merge=1.0000 (last merge round=11)
[S4] round=12 local utility u=0.000000 metrics={'f1_val': 0.664730613386724, 'auprc': 0.6569866393964506, 'loss_val': 0.5795771790149372, 'psi': 0.6616330237906146}-{'f1_val': 0.6664700489963007, 'auprc': 0.6582727353944555, 'loss_val': 0.5761239660597526, 'psi': 0.6631911235555625}
[S5] START round=12 head_norm_before_train=1.280406 cos_to_last_merge=0.8404 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.840
[S5] round=12 local utility u=0.000000 metrics={'f1_val': 0.5866031179942265, 'auprc': 0.8547714311184703, 'loss_val': 0.42819312056198605, 'psi': 0.693870443243924}-{'f1_val': 0.6644320949608227, 'auprc': 0.8541118320997697, 'loss_val': 0.3719678452666751, 'psi': 0.7403039898164014}
[S6] START round=12 head_norm_before_train=1.520069 (no previous merge yet)
[S6] round=12 local utility u=0.000000 metrics={'f1_val': 0.7090528520440441, 'auprc': 0.7991071299030958, 'loss_val': 0.41823606892474285, 'psi': 0.7450745631876649}-{'f1_val': 0.7121847612527392, 'auprc': 0.9632586801646538, 'loss_val': 0.44834323526132047, 'psi': 0.8126143288175051}
[S7] START round=12 head_norm_before_train=1.186967 cos_to_last_merge=0.8649 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.865
[S7] round=12 local utility u=0.169194 metrics={'f1_val': 0.43901824304122006, 'auprc': 0.7817771103756201, 'loss_val': 0.9285134758273994, 'psi': 0.5761217899749801}-{'f1_val': 0.3941709370278018, 'auprc': 0.7794683309064253, 'loss_val': 0.9908909454358372, 'psi': 0.5482898945792513}
[S8] START round=12 head_norm_before_train=1.198688 cos_to_last_merge=0.8692 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.869
[S8] round=12 local utility u=0.882019 metrics={'f1_val': 0.9956712880364682, 'auprc': 0.9960477380683798, 'loss_val': 0.24578683373138424, 'psi': 0.9958218680492328}-{'f1_val': 0.7141738056351523, 'auprc': 0.9942937993473188, 'loss_val': 0.31557782197933587, 'psi': 0.8262218031200189}
[S9] START round=12 head_norm_before_train=0.977293 cos_to_last_merge=1.0000 (last merge round=11)
[S9] round=12 local utility u=0.022170 metrics={'f1_val': 0.9954158325366191, 'auprc': 0.9977960940441559, 'loss_val': 0.1790934511569829, 'psi': 0.9963679371396339}-{'f1_val': 0.9899455008418782, 'auprc': 0.997790825651856, 'loss_val': 0.1905960706305287, 'psi': 0.9930836307658693}
[S10] START round=12 head_norm_before_train=1.024547 cos_to_last_merge=0.8436 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.844
[S10] round=12 local utility u=0.073824 metrics={'f1_val': 0.6883210723388503, 'auprc': 0.9646035284556298, 'loss_val': 0.4765039127402825, 'psi': 0.7988340547855621}-{'f1_val': 0.7018166910238366, 'auprc': 0.9096064498122535, 'loss_val': 0.5401345986331259, 'psi': 0.7849325945392034}
[S11] START round=12 head_norm_before_train=1.217483 cos_to_last_merge=1.0000 (last merge round=11)
[S11] round=12 local utility u=0.065331 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9459071963292198, 'loss_val': 0.46570601019064317, 'psi': 0.7993789662838429}-{'f1_val': 0.7012129785687009, 'auprc': 0.9401126294144507, 'loss_val': 0.5761021242501605, 'psi': 0.7967728389070008}
[S13] START round=12 head_norm_before_train=1.183254 cos_to_last_merge=1.0000 (last merge round=11)
[S13] round=12 local utility u=0.576863 metrics={'f1_val': 0.61774470189182, 'auprc': 0.7073460273643296, 'loss_val': 0.7998557228534587, 'psi': 0.6535852320808238}-{'f1_val': 0.41580726865236384, 'auprc': 0.7372314812161278, 'loss_val': 0.8316138094415482, 'psi': 0.5443769536778694}
[S14] START round=12 head_norm_before_train=1.071081 cos_to_last_merge=0.9800 (last merge round=8)
[S14] round=12 local utility u=0.106151 metrics={'f1_val': 0.9979077116553055, 'auprc': 0.9970638409084418, 'loss_val': 0.27766576481276206, 'psi': 0.9975701633565599}-{'f1_val': 0.9778500310501528, 'auprc': 0.9970604878990912, 'loss_val': 0.36961260521556566, 'psi': 0.9855342137897282}
[S15] START round=12 head_norm_before_train=1.081672 cos_to_last_merge=0.9978 (last merge round=10)
[S15] round=12 local utility u=0.311133 metrics={'f1_val': 0.6912210581503413, 'auprc': 0.9746417871087291, 'loss_val': 0.46143778038575123, 'psi': 0.8045893497336964}-{'f1_val': 0.6943482873912493, 'auprc': 0.8017598275235226, 'loss_val': 0.5838213495122678, 'psi': 0.7373129034441587}
[S16] START round=12 head_norm_before_train=1.203872 cos_to_last_merge=0.9988 (last merge round=10)
[S16] round=12 local utility u=0.587514 metrics={'f1_val': 0.542803131197652, 'auprc': 0.7596682644852029, 'loss_val': 0.7978924917166187, 'psi': 0.6295491845126724}-{'f1_val': 0.3652820918229044, 'auprc': 0.7318228431309968, 'loss_val': 0.8242588386177866, 'psi': 0.5118983923461413}
[S17] START round=12 head_norm_before_train=0.678799 cos_to_last_merge=1.0000 (last merge round=11)
[S17] round=12 local utility u=0.013036 metrics={'f1_val': 0.3526844617224346, 'auprc': 0.7063096862880347, 'loss_val': 1.0328235893518654, 'psi': 0.49413455154867464}-{'f1_val': 0.35298479666097704, 'auprc': 0.6908102459176397, 'loss_val': 1.014199566706337, 'psi': 0.4881149763636421}
[S3] not sending this round → trigger blocked (psi=0.960)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:42017
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:42013
[S13] not sending this round → trigger blocked (psi=0.654)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:42012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:42014
[S2] not sending this round → trigger blocked (psi=0.738)
[S10] not sending this round → trigger blocked (psi=0.799)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.996)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:42015
[S9] not sending this round → trigger blocked (psi=0.996)
[S14] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1798) from S15
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.140047)
[S11] loaded HEAD from S15 (vec_in norm=1.140047)
[S11] cosine check vs S15: cos=0.3418
[S11] BUFFERED delta from S15 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1801) from S16
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.245506)
[S17] loaded HEAD from S16 (vec_in norm=1.245506)
[S17] cosine check vs S16: cos=0.6071
[S17] BUFFERED delta from S16 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1800) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.255041)
[S13] loaded HEAD from S11 (vec_in norm=1.255041)
[S13] cosine check vs S11: cos=-0.0633
[S13] DROPPED delta from S11 (cos=-0.0633 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1801) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.208443)
[S14] loaded HEAD from S7 (vec_in norm=1.208443)
[S14] cosine check vs S7: cos=0.4679
[S14] BUFFERED delta from S7 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1797) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.132401)
[S15] loaded HEAD from S14 (vec_in norm=1.132401)
[S15] cosine check vs S14: cos=0.6500
[S15] BUFFERED delta from S14 (total buffered=1)
[S17] not sending this round → trigger blocked (psi=0.494)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=12 metric=0.7017 head_norm=1.255041
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.886168e-01
[S11] stored merged vector for next round verification (round=12)
[S11] DEBUG after merge:  round=12 metric=0.7017 head_norm=0.981440 delta_norm=0.688617
[S11] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=12 metric=0.9979 head_norm=1.132401
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.045648e-01
[S14] stored merged vector for next round verification (round=12)
[S14] DEBUG after merge:  round=12 metric=0.9977 head_norm=1.002913 delta_norm=0.604565
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=12 metric=0.6912 head_norm=1.140047
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.753541e-01
[S15] stored merged vector for next round verification (round=12)
[S15] DEBUG after merge:  round=12 metric=0.6904 head_norm=1.032017 delta_norm=0.475354
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=12 metric=0.3527 head_norm=0.718073
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.952126e-01
[S17] stored merged vector for next round verification (round=12)
[S17] DEBUG after merge:  round=12 metric=0.3523 head_norm=0.887819 delta_norm=0.495213
[S17] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.291704 cos_to_last_merge=0.8879 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.888
[S2] round=13 local utility u=0.064258 metrics={'f1_val': 0.7116169142942013, 'auprc': 0.7929821498601615, 'loss_val': 0.5105219482740048, 'psi': 0.7441630085205854}-{'f1_val': 0.7118439981592104, 'auprc': 0.7777327506491722, 'loss_val': 0.5946514653960033, 'psi': 0.7381994991551951}
[S3] START round=13 head_norm_before_train=0.938640 cos_to_last_merge=0.9924 (last merge round=11)
[S3] round=13 local utility u=0.126032 metrics={'f1_val': 0.960995754132836, 'auprc': 0.9978578509926099, 'loss_val': 0.21942077331529442, 'psi': 0.9757405928767456}-{'f1_val': 0.9348034872792208, 'auprc': 0.9980990109207366, 'loss_val': 0.31505492278585207, 'psi': 0.9601216967358271}
[S4] START round=13 head_norm_before_train=1.125445 cos_to_last_merge=0.9964 (last merge round=11)
[S4] round=13 local utility u=0.293683 metrics={'f1_val': 0.6645085983389646, 'auprc': 0.8355688740450482, 'loss_val': 0.5266264528975614, 'psi': 0.732932708621398}-{'f1_val': 0.664730613386724, 'auprc': 0.6569866393964506, 'loss_val': 0.5795771790149372, 'psi': 0.6616330237906146}
[S5] START round=13 head_norm_before_train=1.329623 cos_to_last_merge=0.8329 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.833
[S5] round=13 local utility u=0.000000 metrics={'f1_val': 0.43728526697303427, 'auprc': 0.8533439329726858, 'loss_val': 0.7646946293351243, 'psi': 0.603708733372895}-{'f1_val': 0.5866031179942265, 'auprc': 0.8547714311184703, 'loss_val': 0.42819312056198605, 'psi': 0.693870443243924}
[S6] START round=13 head_norm_before_train=1.561684 (no previous merge yet)
[S6] round=13 local utility u=0.341954 metrics={'f1_val': 0.7122498052434422, 'auprc': 0.980048953252088, 'loss_val': 0.29633446588135565, 'psi': 0.8193694644469005}-{'f1_val': 0.7090528520440441, 'auprc': 0.7991071299030958, 'loss_val': 0.41823606892474285, 'psi': 0.7450745631876649}
[S7] START round=13 head_norm_before_train=1.208443 cos_to_last_merge=0.8597 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.860
[S7] round=13 local utility u=0.230796 metrics={'f1_val': 0.5005063202630224, 'auprc': 0.7863501711308231, 'loss_val': 0.8495692042340307, 'psi': 0.6148438606101427}-{'f1_val': 0.43901824304122006, 'auprc': 0.7817771103756201, 'loss_val': 0.9285134758273994, 'psi': 0.5761217899749801}
[S8] START round=13 head_norm_before_train=1.236859 cos_to_last_merge=0.8554 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.855
[S8] round=13 local utility u=0.000000 metrics={'f1_val': 0.7144610111876308, 'auprc': 0.9986411468227212, 'loss_val': 0.3162117924181484, 'psi': 0.828133065441667}-{'f1_val': 0.9956712880364682, 'auprc': 0.9960477380683798, 'loss_val': 0.24578683373138424, 'psi': 0.9958218680492328}
[S9] START round=13 head_norm_before_train=1.060029 cos_to_last_merge=0.9954 (last merge round=11)
[S9] round=13 local utility u=0.030643 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9952585712813475, 'loss_val': 0.11520126091435325, 'psi': 0.9958534853801055}-{'f1_val': 0.9954158325366191, 'auprc': 0.9977960940441559, 'loss_val': 0.1790934511569829, 'psi': 0.9963679371396339}
[S10] START round=13 head_norm_before_train=1.062822 cos_to_last_merge=0.8348 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.835
[S10] round=13 local utility u=0.133110 metrics={'f1_val': 0.700982326484651, 'auprc': 0.9956335082372356, 'loss_val': 0.37934221416933367, 'psi': 0.8188427991856848}-{'f1_val': 0.6883210723388503, 'auprc': 0.9646035284556298, 'loss_val': 0.4765039127402825, 'psi': 0.7988340547855621}
[S11] START round=13 head_norm_before_train=0.981440 cos_to_last_merge=1.0000 (last merge round=12)
[S11] round=13 local utility u=0.055948 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9960581993039687, 'loss_val': 0.5042630010328654, 'psi': 0.8194393674737424}-{'f1_val': 0.7016934795869249, 'auprc': 0.9459071963292198, 'loss_val': 0.46570601019064317, 'psi': 0.7993789662838429}
[S13] START round=13 head_norm_before_train=1.205817 cos_to_last_merge=0.9991 (last merge round=11)
[S13] round=13 local utility u=0.000000 metrics={'f1_val': 0.41580726865236384, 'auprc': 0.6665194804115002, 'loss_val': 0.7840861148018918, 'psi': 0.5160921533560184}-{'f1_val': 0.61774470189182, 'auprc': 0.7073460273643296, 'loss_val': 0.7998557228534587, 'psi': 0.6535852320808238}
[S14] START round=13 head_norm_before_train=1.002913 cos_to_last_merge=1.0000 (last merge round=12)
[S14] round=13 local utility u=0.000000 metrics={'f1_val': 0.9787088521801437, 'auprc': 0.998401937771425, 'loss_val': 0.418546446247233, 'psi': 0.9865860864166562}-{'f1_val': 0.9979077116553055, 'auprc': 0.9970638409084418, 'loss_val': 0.27766576481276206, 'psi': 0.9975701633565599}
[S15] START round=13 head_norm_before_train=1.032017 cos_to_last_merge=1.0000 (last merge round=12)
[S15] round=13 local utility u=0.000000 metrics={'f1_val': 0.6966916034417664, 'auprc': 0.9809517342964587, 'loss_val': 0.5363296354335821, 'psi': 0.8103956557836434}-{'f1_val': 0.6912210581503413, 'auprc': 0.9746417871087291, 'loss_val': 0.46143778038575123, 'psi': 0.8045893497336964}
[S16] START round=13 head_norm_before_train=1.245506 cos_to_last_merge=0.9961 (last merge round=10)
[S16] round=13 local utility u=0.000000 metrics={'f1_val': 0.40010949786669997, 'auprc': 0.7405865232307479, 'loss_val': 0.8532530035700239, 'psi': 0.5363003080123192}-{'f1_val': 0.542803131197652, 'auprc': 0.7596682644852029, 'loss_val': 0.7978924917166187, 'psi': 0.6295491845126724}
[S17] START round=13 head_norm_before_train=0.887819 cos_to_last_merge=1.0000 (last merge round=12)
[S17] round=13 local utility u=0.000000 metrics={'f1_val': 0.35273268957802617, 'auprc': 0.6397677417669458, 'loss_val': 0.997749974441517, 'psi': 0.4675467104535941}-{'f1_val': 0.3526844617224346, 'auprc': 0.7063096862880347, 'loss_val': 1.0328235893518654, 'psi': 0.49413455154867464}
[S7] not sending this round → trigger blocked (psi=0.615)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:42003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:42013
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.819)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:42010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:42011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S9] → sending delta(kind=head bytes=1791) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:42012
[S9] sending update (kind=head size=1791 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1798) from S4
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.175953)
[S10] loaded HEAD from S4 (vec_in norm=1.175953)
[S10] cosine check vs S4: cos=-0.1627
[S10] DROPPED delta from S4 (cos=-0.1627 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1799) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.593666)
[S11] loaded HEAD from S6 (vec_in norm=1.593666)
[S11] cosine check vs S6: cos=0.6338
[S11] BUFFERED delta from S6 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1797) from S10
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.103285)
[S3] loaded HEAD from S10 (vec_in norm=1.103285)
[S3] cosine check vs S10: cos=0.7514
[S3] BUFFERED delta from S10 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1798) from S3
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.040609)
[S9] loaded HEAD from S3 (vec_in norm=1.040609)
[S9] cosine check vs S3: cos=0.8940
[S9] BUFFERED delta from S3 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1795) from S2
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.347617)
[S13] loaded HEAD from S2 (vec_in norm=1.347617)
[S13] cosine check vs S2: cos=0.9830
[S13] BUFFERED delta from S2 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1791) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.144640)
[S17] loaded HEAD from S9 (vec_in norm=1.144640)
[S17] cosine check vs S9: cos=0.4504
[S17] BUFFERED delta from S9 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=13 metric=0.4158 head_norm=1.232945
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.319179e-01
[S13] stored merged vector for next round verification (round=13)
[S13] DEBUG after merge:  round=13 metric=0.4158 head_norm=1.284799 delta_norm=0.131918
[S13] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=13 metric=0.7017 head_norm=1.026338
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.164277e-01
[S11] stored merged vector for next round verification (round=13)
[S11] DEBUG after merge:  round=13 metric=0.7017 head_norm=1.190205 delta_norm=0.616428
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=13 metric=0.9610 head_norm=1.040609
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.790335e-01
[S3] stored merged vector for next round verification (round=13)
[S3] DEBUG after merge:  round=13 metric=0.9628 head_norm=1.003188 delta_norm=0.379034
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=13 metric=0.9963 head_norm=1.144640
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.566065e-01
[S9] stored merged vector for next round verification (round=13)
[S9] DEBUG after merge:  round=13 metric=0.9963 head_norm=1.063338 delta_norm=0.256606
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=13 metric=0.3527 head_norm=0.918968
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.493562e-01
[S17] stored merged vector for next round verification (round=13)
[S17] DEBUG after merge:  round=13 metric=0.3527 head_norm=0.880659 delta_norm=0.549356
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.347617 cos_to_last_merge=0.8747 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.875
[S2] round=14 local utility u=0.011426 metrics={'f1_val': 0.7107349342189779, 'auprc': 0.7954024927248654, 'loss_val': 0.4896394896427817, 'psi': 0.744601957621333}-{'f1_val': 0.7116169142942013, 'auprc': 0.7929821498601615, 'loss_val': 0.5105219482740048, 'psi': 0.7441630085205854}
[S3] START round=14 head_norm_before_train=1.003188 cos_to_last_merge=1.0000 (last merge round=13)
[S3] round=14 local utility u=0.105045 metrics={'f1_val': 0.9975267313009194, 'auprc': 0.9983828200380926, 'loss_val': 0.23009130228762983, 'psi': 0.9978691667957886}-{'f1_val': 0.960995754132836, 'auprc': 0.9978578509926099, 'loss_val': 0.21942077331529442, 'psi': 0.9757405928767456}
[S4] START round=14 head_norm_before_train=1.175953 cos_to_last_merge=0.9884 (last merge round=11)
[S4] round=14 local utility u=0.184159 metrics={'f1_val': 0.6656655791647152, 'auprc': 0.9439698717242297, 'loss_val': 0.49045405216175825, 'psi': 0.7769872961885211}-{'f1_val': 0.6645085983389646, 'auprc': 0.8355688740450482, 'loss_val': 0.5266264528975614, 'psi': 0.732932708621398}
[S5] START round=14 head_norm_before_train=1.369007 cos_to_last_merge=0.8276 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.828
[S5] round=14 local utility u=0.000000 metrics={'f1_val': 0.43728526697303427, 'auprc': 0.8532810451782435, 'loss_val': 0.7652750840909025, 'psi': 0.603683578255118}-{'f1_val': 0.43728526697303427, 'auprc': 0.8533439329726858, 'loss_val': 0.7646946293351243, 'psi': 0.603708733372895}
[S6] START round=14 head_norm_before_train=1.593666 (no previous merge yet)
[S6] round=14 local utility u=0.000000 metrics={'f1_val': 0.7071242209914712, 'auprc': 0.8016906742655123, 'loss_val': 0.39104521087145894, 'psi': 0.7449508023010877}-{'f1_val': 0.7122498052434422, 'auprc': 0.980048953252088, 'loss_val': 0.29633446588135565, 'psi': 0.8193694644469005}
[S7] START round=14 head_norm_before_train=1.228881 cos_to_last_merge=0.8551 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.855
[S7] round=14 local utility u=0.579289 metrics={'f1_val': 0.6308733799444082, 'auprc': 0.8185214174206109, 'loss_val': 0.56970678001416, 'psi': 0.7059325949348894}-{'f1_val': 0.5005063202630224, 'auprc': 0.7863501711308231, 'loss_val': 0.8495692042340307, 'psi': 0.6148438606101427}
[S8] START round=14 head_norm_before_train=1.273866 cos_to_last_merge=0.8439 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.844
[S8] round=14 local utility u=0.912157 metrics={'f1_val': 0.9951656890340317, 'auprc': 0.9973333264707209, 'loss_val': 0.1722020870867757, 'psi': 0.9960327440087073}-{'f1_val': 0.7144610111876308, 'auprc': 0.9986411468227212, 'loss_val': 0.3162117924181484, 'psi': 0.828133065441667}
[S9] START round=14 head_norm_before_train=1.063338 cos_to_last_merge=1.0000 (last merge round=13)
[S9] round=14 local utility u=0.000000 metrics={'f1_val': 0.9937421749897083, 'auprc': 0.9974072220976942, 'loss_val': 0.12968330814153542, 'psi': 0.9952081938329027}-{'f1_val': 0.9962500947792776, 'auprc': 0.9952585712813475, 'loss_val': 0.11520126091435325, 'psi': 0.9958534853801055}
[S10] START round=14 head_norm_before_train=1.103285 cos_to_last_merge=0.8260 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.826
[S10] round=14 local utility u=0.001423 metrics={'f1_val': 0.6940812248126353, 'auprc': 0.9963578039900608, 'loss_val': 0.3372630468358627, 'psi': 0.8149918564836056}-{'f1_val': 0.700982326484651, 'auprc': 0.9956335082372356, 'loss_val': 0.37934221416933367, 'psi': 0.8188427991856848}
[S11] START round=14 head_norm_before_train=1.190205 cos_to_last_merge=1.0000 (last merge round=13)
[S11] round=14 local utility u=0.000000 metrics={'f1_val': 0.6060353318427782, 'auprc': 0.9963103404748168, 'loss_val': 0.5528449755628551, 'psi': 0.7621453352955937}-{'f1_val': 0.7016934795869249, 'auprc': 0.9960581993039687, 'loss_val': 0.5042630010328654, 'psi': 0.8194393674737424}
[S13] START round=14 head_norm_before_train=1.284799 cos_to_last_merge=1.0000 (last merge round=13)
[S13] round=14 local utility u=0.017059 metrics={'f1_val': 0.41580726865236384, 'auprc': 0.6696813738163947, 'loss_val': 0.7594533877125013, 'psi': 0.5173569107179762}-{'f1_val': 0.41580726865236384, 'auprc': 0.6665194804115002, 'loss_val': 0.7840861148018918, 'psi': 0.5160921533560184}
[S14] START round=14 head_norm_before_train=1.048734 cos_to_last_merge=0.9969 (last merge round=12)
[S14] round=14 local utility u=0.094396 metrics={'f1_val': 0.9909557398080825, 'auprc': 0.9985910131003619, 'loss_val': 0.3038038950169765, 'psi': 0.9940098491249942}-{'f1_val': 0.9787088521801437, 'auprc': 0.998401937771425, 'loss_val': 0.418546446247233, 'psi': 0.9865860864166562}
[S15] START round=14 head_norm_before_train=1.070918 cos_to_last_merge=0.9970 (last merge round=12)
[S15] round=14 local utility u=0.044592 metrics={'f1_val': 0.6890936251008248, 'auprc': 0.9860608355001644, 'loss_val': 0.4168843140928604, 'psi': 0.8078805092605607}-{'f1_val': 0.6966916034417664, 'auprc': 0.9809517342964587, 'loss_val': 0.5363296354335821, 'psi': 0.8103956557836434}
[S16] START round=14 head_norm_before_train=1.286599 cos_to_last_merge=0.9926 (last merge round=10)
[S16] round=14 local utility u=1.000000 metrics={'f1_val': 0.8178974144746634, 'auprc': 0.7727903042616286, 'loss_val': 0.7401770729876141, 'psi': 0.7998545703894495}-{'f1_val': 0.40010949786669997, 'auprc': 0.7405865232307479, 'loss_val': 0.8532530035700239, 'psi': 0.5363003080123192}
[S17] START round=14 head_norm_before_train=0.880659 cos_to_last_merge=1.0000 (last merge round=13)
[S17] round=14 local utility u=0.111551 metrics={'f1_val': 0.35288462554833255, 'auprc': 0.7036714777589264, 'loss_val': 0.9672705029953592, 'psi': 0.49319936643257006}-{'f1_val': 0.35273268957802617, 'auprc': 0.6397677417669458, 'loss_val': 0.997749974441517, 'psi': 0.4675467104535941}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:42013
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:42014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:42004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:42003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] → sending delta(kind=head bytes=1805) to S15@127.0.0.1:42015
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:42010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:42012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:42011
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1805 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1804 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1798) from S10
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.146999)
[S3] loaded HEAD from S10 (vec_in norm=1.146999)
[S3] cosine check vs S10: cos=0.8925
[S3] BUFFERED delta from S10 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1801) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.243292)
[S14] loaded HEAD from S7 (vec_in norm=1.243292)
[S14] cosine check vs S7: cos=0.7940
[S14] BUFFERED delta from S7 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1804) from S13
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.303497)
[S4] loaded HEAD from S13 (vec_in norm=1.303497)
[S4] cosine check vs S13: cos=0.9129
[S4] BUFFERED delta from S13 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1800) from S16
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.320929)
[S17] loaded HEAD from S16 (vec_in norm=1.320929)
[S17] cosine check vs S16: cos=0.6099
[S17] BUFFERED delta from S16 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1805) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.103174)
[S15] loaded HEAD from S14 (vec_in norm=1.103174)
[S15] cosine check vs S14: cos=0.8800
[S15] BUFFERED delta from S14 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1800) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.303199)
[S17] loaded HEAD from S8 (vec_in norm=1.303199)
[S17] cosine check vs S8: cos=0.0890
[S17] BUFFERED delta from S8 (total buffered=2)
[S13] RECEIVED delta(kind=head bytes=1803) from S2
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.395100)
[S13] loaded HEAD from S2 (vec_in norm=1.395100)
[S13] cosine check vs S2: cos=0.9917
[S13] BUFFERED delta from S2 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1799) from S4
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.218958)
[S10] loaded HEAD from S4 (vec_in norm=1.218958)
[S10] cosine check vs S4: cos=-0.1546
[S10] DROPPED delta from S4 (cos=-0.1546 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1800) from S15
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.125094)
[S11] loaded HEAD from S15 (vec_in norm=1.125094)
[S11] cosine check vs S15: cos=0.3361
[S11] BUFFERED delta from S15 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1799) from S3
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.089846)
[S9] loaded HEAD from S3 (vec_in norm=1.089846)
[S9] cosine check vs S3: cos=0.9109
[S9] BUFFERED delta from S3 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:42003
[S17] sending update (kind=head size=1794 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1794) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.918165)
[S3] loaded HEAD from S17 (vec_in norm=0.918165)
[S3] cosine check vs S17: cos=0.7817
[S3] BUFFERED delta from S17 (total buffered=2)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=14 metric=0.6060 head_norm=1.232507
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.805691e-01
[S11] stored merged vector for next round verification (round=14)
[S11] DEBUG after merge:  round=14 metric=0.6008 head_norm=0.963992 delta_norm=0.680569
[S11] aggregate: ROLLBACK (f1_val pre=0.606 post=0.601 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=14 metric=0.9937 head_norm=1.144678
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.373889e-01
[S9] stored merged vector for next round verification (round=14)
[S9] DEBUG after merge:  round=14 metric=0.9937 head_norm=1.092095 delta_norm=0.237389
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=14 metric=0.6657 head_norm=1.218958
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.664062e-01
[S4] stored merged vector for next round verification (round=14)
[S4] DEBUG after merge:  round=14 metric=0.6657 head_norm=1.233495 delta_norm=0.266406
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=14 metric=0.6891 head_norm=1.125094
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.731493e-01
[S15] stored merged vector for next round verification (round=14)
[S15] DEBUG after merge:  round=14 metric=0.6887 head_norm=1.080187 delta_norm=0.273149
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=14 metric=0.9975 head_norm=1.089846
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.799705e-01
[S3] stored merged vector for next round verification (round=14)
[S3] DEBUG after merge:  round=14 metric=0.9967 head_norm=0.990624 delta_norm=0.179970
[S3] aggregate: ACCEPT kept=['S10', 'S17'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=14 metric=0.4158 head_norm=1.303497
[S13] _apply_head_vector_avg (torch): Δ‖w‖=9.809524e-02
[S13] stored merged vector for next round verification (round=14)
[S13] DEBUG after merge:  round=14 metric=0.4158 head_norm=1.346507 delta_norm=0.098095
[S13] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=14 metric=0.9910 head_norm=1.103174
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.823709e-01
[S14] stored merged vector for next round verification (round=14)
[S14] DEBUG after merge:  round=14 metric=0.9952 head_norm=1.111385 delta_norm=0.382371
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=14 metric=0.3529 head_norm=0.918165
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.806610e-01
[S17] stored merged vector for next round verification (round=14)
[S17] DEBUG after merge:  round=14 metric=0.3527 head_norm=0.808783 delta_norm=0.480661
[S17] aggregate: ACCEPT kept=['S16', 'S8'] (k=2/2) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.395100 cos_to_last_merge=0.8624 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.862
[S2] round=15 local utility u=0.018047 metrics={'f1_val': 0.7043645523701866, 'auprc': 0.7941125732577781, 'loss_val': 0.41145269558991937, 'psi': 0.7402637607252232}-{'f1_val': 0.7107349342189779, 'auprc': 0.7954024927248654, 'loss_val': 0.4896394896427817, 'psi': 0.744601957621333}
[S3] START round=15 head_norm_before_train=0.990624 cos_to_last_merge=1.0000 (last merge round=14)
[S3] round=15 local utility u=0.007316 metrics={'f1_val': 0.9973982357793907, 'auprc': 0.9977593209977643, 'loss_val': 0.21281710655914962, 'psi': 0.9975426698667402}-{'f1_val': 0.9975267313009194, 'auprc': 0.9983828200380926, 'loss_val': 0.23009130228762983, 'psi': 0.9978691667957886}
[S4] START round=15 head_norm_before_train=1.233495 cos_to_last_merge=1.0000 (last merge round=14)
[S4] round=15 local utility u=0.000000 metrics={'f1_val': 0.6650239873591304, 'auprc': 0.8967695464621326, 'loss_val': 0.512326845847895, 'psi': 0.7577222110003312}-{'f1_val': 0.6656655791647152, 'auprc': 0.9439698717242297, 'loss_val': 0.49045405216175825, 'psi': 0.7769872961885211}
[S5] START round=15 head_norm_before_train=1.390680 cos_to_last_merge=0.8247 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.825
[S5] round=15 local utility u=0.686216 metrics={'f1_val': 0.6214592138295946, 'auprc': 0.8518570818066908, 'loss_val': 0.4936147080373988, 'psi': 0.7136183610204331}-{'f1_val': 0.43728526697303427, 'auprc': 0.8532810451782435, 'loss_val': 0.7652750840909025, 'psi': 0.603683578255118}
[S6] START round=15 head_norm_before_train=1.617365 (no previous merge yet)
[S6] round=15 local utility u=0.037510 metrics={'f1_val': 0.7076728961432913, 'auprc': 0.808321539589454, 'loss_val': 0.33920917717994215, 'psi': 0.7479323535217564}-{'f1_val': 0.7071242209914712, 'auprc': 0.8016906742655123, 'loss_val': 0.39104521087145894, 'psi': 0.7449508023010877}
[S7] START round=15 head_norm_before_train=1.243292 cos_to_last_merge=0.8520 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.852
[S7] round=15 local utility u=0.275419 metrics={'f1_val': 0.6793755512998952, 'auprc': 0.8598628667989642, 'loss_val': 0.43390698108205816, 'psi': 0.7515704774995229}-{'f1_val': 0.6308733799444082, 'auprc': 0.8185214174206109, 'loss_val': 0.56970678001416, 'psi': 0.7059325949348894}
[S8] START round=15 head_norm_before_train=1.303199 cos_to_last_merge=0.8353 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.835
[S8] round=15 local utility u=0.007151 metrics={'f1_val': 0.9944307359796796, 'auprc': 0.9975227444973915, 'loss_val': 0.15405867378200824, 'psi': 0.9956675393867643}-{'f1_val': 0.9951656890340317, 'auprc': 0.9973333264707209, 'loss_val': 0.1722020870867757, 'psi': 0.9960327440087073}
[S9] START round=15 head_norm_before_train=1.092095 cos_to_last_merge=1.0000 (last merge round=14)
[S9] round=15 local utility u=0.008439 metrics={'f1_val': 0.9949999422209534, 'auprc': 0.9984204558181534, 'loss_val': 0.12339151220078268, 'psi': 0.9963681476598334}-{'f1_val': 0.9937421749897083, 'auprc': 0.9974072220976942, 'loss_val': 0.12968330814153542, 'psi': 0.9952081938329027}
[S10] START round=15 head_norm_before_train=1.146999 cos_to_last_merge=0.8173 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.817
[S10] round=15 local utility u=0.272409 metrics={'f1_val': 0.78520072491364, 'auprc': 0.9958831741659426, 'loss_val': 0.3377373045005734, 'psi': 0.8694737046145611}-{'f1_val': 0.6940812248126353, 'auprc': 0.9963578039900608, 'loss_val': 0.3372630468358627, 'psi': 0.8149918564836056}
[S11] START round=15 head_norm_before_train=0.963992 cos_to_last_merge=1.0000 (last merge round=14)
[S11] round=15 local utility u=0.315197 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9963807601508164, 'loss_val': 0.4966110617700104, 'psi': 0.8195683918124814}-{'f1_val': 0.6060353318427782, 'auprc': 0.9963103404748168, 'loss_val': 0.5528449755628551, 'psi': 0.7621453352955937}
[S13] START round=15 head_norm_before_train=1.346507 cos_to_last_merge=1.0000 (last merge round=14)
[S13] round=15 local utility u=0.935419 metrics={'f1_val': 0.7113104823159138, 'auprc': 0.6980106474051448, 'loss_val': 0.746623248194571, 'psi': 0.7059905483516062}-{'f1_val': 0.41580726865236384, 'auprc': 0.6696813738163947, 'loss_val': 0.7594533877125013, 'psi': 0.5173569107179762}
[S14] START round=15 head_norm_before_train=1.111385 cos_to_last_merge=1.0000 (last merge round=14)
[S14] round=15 local utility u=0.000000 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9956798104237463, 'loss_val': 0.40481259841905193, 'psi': 0.9968625949994107}-{'f1_val': 0.9909557398080825, 'auprc': 0.9985910131003619, 'loss_val': 0.3038038950169765, 'psi': 0.9940098491249942}
[S15] START round=15 head_norm_before_train=1.080187 cos_to_last_merge=1.0000 (last merge round=14)
[S15] round=15 local utility u=0.000000 metrics={'f1_val': 0.6947705251003172, 'auprc': 0.9120805996200153, 'loss_val': 0.4879446785009331, 'psi': 0.7816945549081965}-{'f1_val': 0.6890936251008248, 'auprc': 0.9860608355001644, 'loss_val': 0.4168843140928604, 'psi': 0.8078805092605607}
[S16] START round=15 head_norm_before_train=1.320929 cos_to_last_merge=0.9893 (last merge round=10)
[S16] round=15 local utility u=0.000000 metrics={'f1_val': 0.7237544169464392, 'auprc': 0.7838441893297415, 'loss_val': 0.6784954662317998, 'psi': 0.74779032589976}-{'f1_val': 0.8178974144746634, 'auprc': 0.7727903042616286, 'loss_val': 0.7401770729876141, 'psi': 0.7998545703894495}
[S17] START round=15 head_norm_before_train=0.808783 cos_to_last_merge=1.0000 (last merge round=14)
[S17] round=15 local utility u=0.000000 metrics={'f1_val': 0.35348113499621747, 'auprc': 0.6840039566115987, 'loss_val': 0.9875956804982751, 'psi': 0.48569026364237}-{'f1_val': 0.35288462554833255, 'auprc': 0.7036714777589264, 'loss_val': 0.9672705029953592, 'psi': 0.49319936643257006}
[S13] not sending this round → trigger blocked (psi=0.706)
[S8] not sending this round → trigger blocked (psi=0.996)
[S10] not sending this round → trigger blocked (psi=0.869)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:42016
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] → sending delta(kind=head bytes=1792) to S13@127.0.0.1:42013
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:42017
[S7] not sending this round → trigger blocked (psi=0.752)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:42012
[S3] not sending this round → trigger blocked (psi=0.998)
[S2] not sending this round → trigger blocked (psi=0.740)
[S6] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1792 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1795) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.178273)
[S17] loaded HEAD from S9 (vec_in norm=1.178273)
[S17] cosine check vs S9: cos=0.5975
[S17] BUFFERED delta from S9 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1801) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.405033)
[S16] loaded HEAD from S5 (vec_in norm=1.405033)
[S16] cosine check vs S5: cos=0.9561
[S16] BUFFERED delta from S5 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1798) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.638627)
[S11] loaded HEAD from S6 (vec_in norm=1.638627)
[S11] cosine check vs S6: cos=0.6341
[S11] BUFFERED delta from S6 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1792) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.993206)
[S13] loaded HEAD from S11 (vec_in norm=0.993206)
[S13] cosine check vs S11: cos=0.0361
[S13] BUFFERED delta from S11 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] ⇄ pheromone p=0.202 → S9@127.0.0.1:42010
[S14] ⇄ pheromone p=0.154 → S15@127.0.0.1:42015
[S7] ⇄ pheromone p=0.281 → S14@127.0.0.1:42014
[S2] ⇄ pheromone p=0.152 → S13@127.0.0.1:42013
[S4] ⇄ pheromone p=0.156 → S10@127.0.0.1:42011
[S8] ⇄ pheromone p=0.367 → S17@127.0.0.1:42017
[S15] ⇄ pheromone p=0.163 → S11@127.0.0.1:42012
[S10] ⇄ pheromone p=0.242 → S3@127.0.0.1:42003
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=15 metric=0.7113 head_norm=1.364147
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.290816e-01
[S13] stored merged vector for next round verification (round=15)
[S13] DEBUG after merge:  round=15 metric=0.6249 head_norm=0.858080 delta_norm=0.829082
[S13] aggregate: ROLLBACK (f1_val pre=0.711 post=0.625 tol_abs=0.005 tol_rel=0.0)
[S13] ⇄ pheromone p=0.357 → S4@127.0.0.1:42004
[S5] ⇄ pheromone p=0.285 → S16@127.0.0.1:42016
[S9] ⇄ pheromone p=0.157 → S17@127.0.0.1:42017
[S6] ⇄ pheromone p=0.221 → S11@127.0.0.1:42012
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=15 metric=0.7017 head_norm=0.993206
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.339216e-01
[S11] stored merged vector for next round verification (round=15)
[S11] DEBUG after merge:  round=15 metric=0.7017 head_norm=1.197465 delta_norm=0.633922
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.179 → S13@127.0.0.1:42013
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=15 metric=0.7238 head_norm=1.355901
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.058501e-01
[S16] stored merged vector for next round verification (round=15)
[S16] DEBUG after merge:  round=15 metric=0.7454 head_norm=1.365254 delta_norm=0.205850
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.306 → S17@127.0.0.1:42017
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=15 metric=0.3535 head_norm=0.843485
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.775138e-01
[S17] stored merged vector for next round verification (round=15)
[S17] DEBUG after merge:  round=15 metric=0.3535 head_norm=0.906575 delta_norm=0.477514
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.105 → S3@127.0.0.1:42003
[S2] START round=16 head_norm_before_train=1.433932 cos_to_last_merge=0.8522 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.852
[S2] round=16 local utility u=0.000000 metrics={'f1_val': 0.7116016335215279, 'auprc': 0.7919280491041895, 'loss_val': 0.5546344446653297, 'psi': 0.7437321997545926}-{'f1_val': 0.7043645523701866, 'auprc': 0.7941125732577781, 'loss_val': 0.41145269558991937, 'psi': 0.7402637607252232}
[S3] START round=16 head_norm_before_train=1.075947 cos_to_last_merge=0.9937 (last merge round=14)
[S3] round=16 local utility u=0.000000 metrics={'f1_val': 0.9816369354330233, 'auprc': 0.9983880457171627, 'loss_val': 0.1470721082245263, 'psi': 0.988337379546679}-{'f1_val': 0.9973982357793907, 'auprc': 0.9977593209977643, 'loss_val': 0.21281710655914962, 'psi': 0.9975426698667402}
[S4] START round=16 head_norm_before_train=1.262878 cos_to_last_merge=0.9991 (last merge round=14)
[S4] round=16 local utility u=0.086376 metrics={'f1_val': 0.6649082020569648, 'auprc': 0.937802894350855, 'loss_val': 0.4619792906962706, 'psi': 0.7740660789745208}-{'f1_val': 0.6650239873591304, 'auprc': 0.8967695464621326, 'loss_val': 0.512326845847895, 'psi': 0.7577222110003312}
[S5] START round=16 head_norm_before_train=1.405033 cos_to_last_merge=0.8231 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.823
[S5] round=16 local utility u=0.313490 metrics={'f1_val': 0.6862236290508554, 'auprc': 0.8789023963942775, 'loss_val': 0.3363561734652287, 'psi': 0.7632951359882243}-{'f1_val': 0.6214592138295946, 'auprc': 0.8518570818066908, 'loss_val': 0.4936147080373988, 'psi': 0.7136183610204331}
[S6] START round=16 head_norm_before_train=1.638627 (no previous merge yet)
[S6] round=16 local utility u=0.810684 metrics={'f1_val': 0.8903056241483613, 'auprc': 0.9489391718804859, 'loss_val': 0.23549116184602376, 'psi': 0.9137590432412112}-{'f1_val': 0.7076728961432913, 'auprc': 0.808321539589454, 'loss_val': 0.33920917717994215, 'psi': 0.7479323535217564}
[S7] START round=16 head_norm_before_train=1.249603 cos_to_last_merge=0.8504 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.850
[S7] round=16 local utility u=0.000000 metrics={'f1_val': 0.3917251932741621, 'auprc': 0.7799921188723374, 'loss_val': 1.1032094169164022, 'psi': 0.5470319635134322}-{'f1_val': 0.6793755512998952, 'auprc': 0.8598628667989642, 'loss_val': 0.43390698108205816, 'psi': 0.7515704774995229}
[S8] START round=16 head_norm_before_train=1.328722 cos_to_last_merge=0.8287 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.829
[S8] round=16 local utility u=0.000000 metrics={'f1_val': 0.7142391053978291, 'auprc': 0.9992303639086879, 'loss_val': 0.2301568601210255, 'psi': 0.8282356088021727}-{'f1_val': 0.9944307359796796, 'auprc': 0.9975227444973915, 'loss_val': 0.15405867378200824, 'psi': 0.9956675393867643}
[S9] START round=16 head_norm_before_train=1.178273 cos_to_last_merge=0.9949 (last merge round=14)
[S9] round=16 local utility u=0.022693 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9964043979776493, 'loss_val': 0.08192102273004861, 'psi': 0.9965580662793946}-{'f1_val': 0.9949999422209534, 'auprc': 0.9984204558181534, 'loss_val': 0.12339151220078268, 'psi': 0.9963681476598334}
[S10] START round=16 head_norm_before_train=1.185905 cos_to_last_merge=0.8095 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.810
[S10] round=16 local utility u=0.540519 metrics={'f1_val': 0.9591140276483212, 'auprc': 0.9902704625115599, 'loss_val': 0.2833402341040956, 'psi': 0.9715766015936167}-{'f1_val': 0.78520072491364, 'auprc': 0.9958831741659426, 'loss_val': 0.3377373045005734, 'psi': 0.8694737046145611}
[S11] START round=16 head_norm_before_train=1.197465 cos_to_last_merge=1.0000 (last merge round=15)
[S11] round=16 local utility u=0.070464 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9969174028708577, 'loss_val': 0.3572921110491179, 'psi': 0.819783048900498}-{'f1_val': 0.7016934795869249, 'auprc': 0.9963807601508164, 'loss_val': 0.4966110617700104, 'psi': 0.8195683918124814}
[S13] START round=16 head_norm_before_train=0.858080 cos_to_last_merge=1.0000 (last merge round=15)
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.6498438679926644, 'auprc': 0.6456034966442483, 'loss_val': 0.8382015871743574, 'psi': 0.648147719453298}-{'f1_val': 0.7113104823159138, 'auprc': 0.6980106474051448, 'loss_val': 0.746623248194571, 'psi': 0.7059905483516062}
[S14] START round=16 head_norm_before_train=1.149724 cos_to_last_merge=0.9965 (last merge round=14)
[S14] round=16 local utility u=0.000000 metrics={'f1_val': 0.943087237562441, 'auprc': 0.9965987108921708, 'loss_val': 0.29357443548837997, 'psi': 0.9644918268943329}-{'f1_val': 0.9976511180498535, 'auprc': 0.9956798104237463, 'loss_val': 0.40481259841905193, 'psi': 0.9968625949994107}
[S15] START round=16 head_norm_before_train=1.137963 cos_to_last_merge=0.9964 (last merge round=14)
[S15] round=16 local utility u=0.155586 metrics={'f1_val': 0.6910333336931125, 'auprc': 0.9886101667760904, 'loss_val': 0.3839374696110037, 'psi': 0.8100640669263037}-{'f1_val': 0.6947705251003172, 'auprc': 0.9120805996200153, 'loss_val': 0.4879446785009331, 'psi': 0.7816945549081965}
[S16] START round=16 head_norm_before_train=1.365254 cos_to_last_merge=1.0000 (last merge round=15)
[S16] round=16 local utility u=0.552896 metrics={'f1_val': 0.8495628945747069, 'auprc': 0.8567149443846044, 'loss_val': 0.5461661217771259, 'psi': 0.8524237144986659}-{'f1_val': 0.7237544169464392, 'auprc': 0.7838441893297415, 'loss_val': 0.6784954662317998, 'psi': 0.74779032589976}
[S17] START round=16 head_norm_before_train=0.906575 cos_to_last_merge=1.0000 (last merge round=15)
[S17] round=16 local utility u=0.107816 metrics={'f1_val': 0.35358139409357164, 'auprc': 0.7405923925375555, 'loss_val': 0.9423300681773108, 'psi': 0.5083857934711652}-{'f1_val': 0.35348113499621747, 'auprc': 0.6840039566115987, 'loss_val': 0.9875956804982751, 'psi': 0.48569026364237}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:42003
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:42012
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:42012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:42016
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:42017
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:42011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:42013
[S4] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1792 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1793 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1794 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1793) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.418319)
[S16] loaded HEAD from S5 (vec_in norm=1.418319)
[S16] cosine check vs S5: cos=0.9858
[S16] BUFFERED delta from S5 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1801) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.656388)
[S11] loaded HEAD from S6 (vec_in norm=1.656388)
[S11] cosine check vs S6: cos=0.9430
[S11] BUFFERED delta from S6 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1797) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.230415)
[S13] loaded HEAD from S11 (vec_in norm=1.230415)
[S13] cosine check vs S11: cos=0.4554
[S13] BUFFERED delta from S11 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1799) from S15
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.189188)
[S11] loaded HEAD from S15 (vec_in norm=1.189188)
[S11] cosine check vs S15: cos=0.3708
[S11] BUFFERED delta from S15 (total buffered=2)
[S10] RECEIVED delta(kind=head bytes=1798) from S4
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.297638)
[S10] loaded HEAD from S4 (vec_in norm=1.297638)
[S10] cosine check vs S4: cos=-0.1697
[S10] DROPPED delta from S4 (cos=-0.1697 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1794) from S10
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.217641)
[S3] loaded HEAD from S10 (vec_in norm=1.217641)
[S3] cosine check vs S10: cos=0.8280
[S3] BUFFERED delta from S10 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1803) from S16
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.405117)
[S17] loaded HEAD from S16 (vec_in norm=1.405117)
[S17] cosine check vs S16: cos=0.5349
[S17] BUFFERED delta from S16 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1792) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.256158)
[S17] loaded HEAD from S9 (vec_in norm=1.256158)
[S17] cosine check vs S9: cos=0.9070
[S17] BUFFERED delta from S9 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S17] → sending delta(kind=head bytes=1789) to S3@127.0.0.1:42003
[S17] sending update (kind=head size=1789 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1789) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.944901)
[S3] loaded HEAD from S17 (vec_in norm=0.944901)
[S3] cosine check vs S17: cos=0.9024
[S3] BUFFERED delta from S17 (total buffered=2)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=16 metric=0.6498 head_norm=0.883199
[S13] _apply_head_vector_avg (torch): Δ‖w‖=5.710132e-01
[S13] stored merged vector for next round verification (round=16)
[S13] DEBUG after merge:  round=16 metric=0.6082 head_norm=0.906049 delta_norm=0.571013
[S13] aggregate: ROLLBACK (f1_val pre=0.650 post=0.608 tol_abs=0.005 tol_rel=0.0)
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=16 metric=0.9816 head_norm=1.165181
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.047222e-01
[S3] stored merged vector for next round verification (round=16)
[S3] DEBUG after merge:  round=16 metric=0.9808 head_norm=1.061146 delta_norm=0.204722
[S3] aggregate: ACCEPT kept=['S10', 'S17'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=16 metric=0.8496 head_norm=1.405117
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.192649e-01
[S16] stored merged vector for next round verification (round=16)
[S16] DEBUG after merge:  round=16 metric=0.8466 head_norm=1.406687 delta_norm=0.119265
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=16 metric=0.7017 head_norm=1.230415
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.968540e-01
[S11] stored merged vector for next round verification (round=16)
[S11] DEBUG after merge:  round=16 metric=0.7017 head_norm=1.127392 delta_norm=0.196854
[S11] aggregate: ACCEPT kept=['S6', 'S15'] (k=2/2) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=16 metric=0.3536 head_norm=0.944901
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.490977e-01
[S17] stored merged vector for next round verification (round=16)
[S17] DEBUG after merge:  round=16 metric=0.3536 head_norm=0.977458 delta_norm=0.249098
[S17] aggregate: ACCEPT kept=['S16', 'S9'] (k=2/2) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.466163 cos_to_last_merge=0.8438 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.844
[S2] round=17 local utility u=0.000000 metrics={'f1_val': 0.6904262057768934, 'auprc': 0.7769716926294012, 'loss_val': 0.7690483502414756, 'psi': 0.7250444005178965}-{'f1_val': 0.7116016335215279, 'auprc': 0.7919280491041895, 'loss_val': 0.5546344446653297, 'psi': 0.7437321997545926}
[S3] START round=17 head_norm_before_train=1.061146 cos_to_last_merge=1.0000 (last merge round=16)
[S3] round=17 local utility u=0.000000 metrics={'f1_val': 0.960995754132836, 'auprc': 0.9989151156658411, 'loss_val': 0.1974351717074177, 'psi': 0.9761634987460381}-{'f1_val': 0.9816369354330233, 'auprc': 0.9983880457171627, 'loss_val': 0.1470721082245263, 'psi': 0.988337379546679}
[S4] START round=17 head_norm_before_train=1.297638 cos_to_last_merge=0.9965 (last merge round=14)
[S4] round=17 local utility u=0.808428 metrics={'f1_val': 0.9528076410288507, 'auprc': 0.9033816231147112, 'loss_val': 0.4692566374102568, 'psi': 0.9330372338631949}-{'f1_val': 0.6649082020569648, 'auprc': 0.937802894350855, 'loss_val': 0.4619792906962706, 'psi': 0.7740660789745208}
[S5] START round=17 head_norm_before_train=1.418319 cos_to_last_merge=0.8220 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.822
[S5] round=17 local utility u=0.000000 metrics={'f1_val': 0.6041836401878069, 'auprc': 0.8942346796983173, 'loss_val': 0.3936771288976643, 'psi': 0.7202040559920111}-{'f1_val': 0.6862236290508554, 'auprc': 0.8789023963942775, 'loss_val': 0.3363561734652287, 'psi': 0.7632951359882243}
[S6] START round=17 head_norm_before_train=1.656388 (no previous merge yet)
[S6] round=17 local utility u=0.000000 metrics={'f1_val': 0.691674167687972, 'auprc': 0.8129395762608804, 'loss_val': 0.323187982399553, 'psi': 0.7401803311171353}-{'f1_val': 0.8903056241483613, 'auprc': 0.9489391718804859, 'loss_val': 0.23549116184602376, 'psi': 0.9137590432412112}
[S7] START round=17 head_norm_before_train=1.259543 cos_to_last_merge=0.8478 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.848
[S7] round=17 local utility u=0.335210 metrics={'f1_val': 0.4718824730981308, 'auprc': 0.7813428760546824, 'loss_val': 0.9177862272572259, 'psi': 0.5956666342807515}-{'f1_val': 0.3917251932741621, 'auprc': 0.7799921188723374, 'loss_val': 1.1032094169164022, 'psi': 0.5470319635134322}
[S8] START round=17 head_norm_before_train=1.358332 cos_to_last_merge=0.8219 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.822
[S8] round=17 local utility u=0.900053 metrics={'f1_val': 0.9947267123181514, 'auprc': 0.9991623520694572, 'loss_val': 0.1127729368749436, 'psi': 0.9965009682186737}-{'f1_val': 0.7142391053978291, 'auprc': 0.9992303639086879, 'loss_val': 0.2301568601210255, 'psi': 0.8282356088021727}
[S9] START round=17 head_norm_before_train=1.256158 cos_to_last_merge=0.9858 (last merge round=14)
[S9] round=17 local utility u=0.003488 metrics={'f1_val': 0.9934918488430377, 'auprc': 0.9994709716427036, 'loss_val': 0.06513237631449015, 'psi': 0.995883497962904}-{'f1_val': 0.9966605118138915, 'auprc': 0.9964043979776493, 'loss_val': 0.08192102273004861, 'psi': 0.9965580662793946}
[S10] START round=17 head_norm_before_train=1.217641 cos_to_last_merge=0.8036 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.804
[S10] round=17 local utility u=0.149531 metrics={'f1_val': 0.9932458082131452, 'auprc': 0.9928901822932915, 'loss_val': 0.19692735945526538, 'psi': 0.9931035578452037}-{'f1_val': 0.9591140276483212, 'auprc': 0.9902704625115599, 'loss_val': 0.2833402341040956, 'psi': 0.9715766015936167}
[S11] START round=17 head_norm_before_train=1.127392 cos_to_last_merge=1.0000 (last merge round=16)
[S11] round=17 local utility u=0.000000 metrics={'f1_val': 0.6593006574604047, 'auprc': 0.9978759713911444, 'loss_val': 0.39760407628707, 'psi': 0.7947307830327006}-{'f1_val': 0.7016934795869249, 'auprc': 0.9969174028708577, 'loss_val': 0.3572921110491179, 'psi': 0.819783048900498}
[S13] START round=17 head_norm_before_train=0.906049 cos_to_last_merge=1.0000 (last merge round=16)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.3733035546829162, 'auprc': 0.4415165083577992, 'loss_val': 0.9661815712822358, 'psi': 0.4005887361528694}-{'f1_val': 0.6498438679926644, 'auprc': 0.6456034966442483, 'loss_val': 0.8382015871743574, 'psi': 0.648147719453298}
[S14] START round=17 head_norm_before_train=1.202634 cos_to_last_merge=0.9863 (last merge round=14)
[S14] round=17 local utility u=0.202690 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9967112689042056, 'loss_val': 0.214459274356607, 'psi': 0.9971294692627176}-{'f1_val': 0.943087237562441, 'auprc': 0.9965987108921708, 'loss_val': 0.29357443548837997, 'psi': 0.9644918268943329}
[S15] START round=17 head_norm_before_train=1.189188 cos_to_last_merge=0.9896 (last merge round=14)
[S15] round=17 local utility u=0.754390 metrics={'f1_val': 0.9214298853462084, 'auprc': 0.9899692872601501, 'loss_val': 0.26161444258447947, 'psi': 0.948845646111785}-{'f1_val': 0.6910333336931125, 'auprc': 0.9886101667760904, 'loss_val': 0.3839374696110037, 'psi': 0.8100640669263037}
[S16] START round=17 head_norm_before_train=1.406687 cos_to_last_merge=1.0000 (last merge round=16)
[S16] round=17 local utility u=0.000000 metrics={'f1_val': 0.8199784625768728, 'auprc': 0.8513301938743307, 'loss_val': 0.7371532509082747, 'psi': 0.832519155095856}-{'f1_val': 0.8495628945747069, 'auprc': 0.8567149443846044, 'loss_val': 0.5461661217771259, 'psi': 0.8524237144986659}
[S17] START round=17 head_norm_before_train=0.977458 cos_to_last_merge=1.0000 (last merge round=16)
[S17] round=17 local utility u=0.051496 metrics={'f1_val': 0.3692937239749249, 'auprc': 0.7337781101350394, 'loss_val': 0.9131695536899332, 'psi': 0.5150874784389706}-{'f1_val': 0.35358139409357164, 'auprc': 0.7405923925375555, 'loss_val': 0.9423300681773108, 'psi': 0.5083857934711652}
[S10] not sending this round → trigger blocked (psi=0.993)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:42014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:42017
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.933)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:42015
[S15] not sending this round → trigger blocked (psi=0.949)
[S9] not sending this round → trigger blocked (psi=0.996)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1805 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1801) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.390195)
[S17] loaded HEAD from S8 (vec_in norm=1.390195)
[S17] cosine check vs S8: cos=0.1167
[S17] BUFFERED delta from S8 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1805) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.270878)
[S14] loaded HEAD from S7 (vec_in norm=1.270878)
[S14] cosine check vs S7: cos=0.8690
[S14] BUFFERED delta from S7 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1798) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.254671)
[S15] loaded HEAD from S14 (vec_in norm=1.254671)
[S15] cosine check vs S14: cos=0.8964
[S15] BUFFERED delta from S14 (total buffered=1)
[S17] not sending this round → trigger blocked (psi=0.515)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=17 metric=0.9214 head_norm=1.241940
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.841659e-01
[S15] stored merged vector for next round verification (round=17)
[S15] DEBUG after merge:  round=17 metric=0.9596 head_norm=1.215548 delta_norm=0.284166
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=17 metric=0.9974 head_norm=1.254671
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.232383e-01
[S14] stored merged vector for next round verification (round=17)
[S14] DEBUG after merge:  round=17 metric=0.9970 head_norm=1.220730 delta_norm=0.323238
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=17 metric=0.3693 head_norm=1.012584
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.107695e-01
[S17] stored merged vector for next round verification (round=17)
[S17] DEBUG after merge:  round=17 metric=0.3536 head_norm=0.906442 delta_norm=0.810769
[S17] aggregate: ROLLBACK (f1_val pre=0.369 post=0.354 tol_abs=0.005 tol_rel=0.0)
[S2] START round=18 head_norm_before_train=1.495183 cos_to_last_merge=0.8375 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.837
[S2] round=18 local utility u=0.145592 metrics={'f1_val': 0.7116016335215279, 'auprc': 0.7846465789836854, 'loss_val': 0.6279412956898335, 'psi': 0.740819611706391}-{'f1_val': 0.6904262057768934, 'auprc': 0.7769716926294012, 'loss_val': 0.7690483502414756, 'psi': 0.7250444005178965}
[S3] START round=18 head_norm_before_train=1.138249 cos_to_last_merge=0.9965 (last merge round=16)
[S3] round=18 local utility u=0.151358 metrics={'f1_val': 0.9977814963782642, 'auprc': 0.9970205835629193, 'loss_val': 0.10974913642324352, 'psi': 0.9974771312521262}-{'f1_val': 0.960995754132836, 'auprc': 0.9989151156658411, 'loss_val': 0.1974351717074177, 'psi': 0.9761634987460381}
[S4] START round=18 head_norm_before_train=1.335420 cos_to_last_merge=0.9926 (last merge round=14)
[S4] round=18 local utility u=0.000000 metrics={'f1_val': 0.8953478097900888, 'auprc': 0.9465351690183791, 'loss_val': 0.35008251954970543, 'psi': 0.915822753481405}-{'f1_val': 0.9528076410288507, 'auprc': 0.9033816231147112, 'loss_val': 0.4692566374102568, 'psi': 0.9330372338631949}
[S5] START round=18 head_norm_before_train=1.432433 cos_to_last_merge=0.8208 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.821
[S5] round=18 local utility u=0.000000 metrics={'f1_val': 0.43371181617480437, 'auprc': 0.8493957009091683, 'loss_val': 0.8089289502003592, 'psi': 0.59998537006855}-{'f1_val': 0.6041836401878069, 'auprc': 0.8942346796983173, 'loss_val': 0.3936771288976643, 'psi': 0.7202040559920111}
[S6] START round=18 head_norm_before_train=1.670187 (no previous merge yet)
[S6] round=18 local utility u=0.911273 metrics={'f1_val': 0.9010596062924752, 'auprc': 0.9612589604447681, 'loss_val': 0.20191252688880257, 'psi': 0.9251393479533923}-{'f1_val': 0.691674167687972, 'auprc': 0.8129395762608804, 'loss_val': 0.323187982399553, 'psi': 0.7401803311171353}
[S7] START round=18 head_norm_before_train=1.270878 cos_to_last_merge=0.8454 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.845
[S7] round=18 local utility u=0.761680 metrics={'f1_val': 0.6390084787116237, 'auprc': 0.8212266689228497, 'loss_val': 0.516832739177952, 'psi': 0.7118957547961141}-{'f1_val': 0.4718824730981308, 'auprc': 0.7813428760546824, 'loss_val': 0.9177862272572259, 'psi': 0.5956666342807515}
[S8] START round=18 head_norm_before_train=1.390195 cos_to_last_merge=0.8146 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.815
[S8] round=18 local utility u=0.005975 metrics={'f1_val': 0.9950136499820015, 'auprc': 0.9991510544042027, 'loss_val': 0.10251035981109, 'psi': 0.9966686117508821}-{'f1_val': 0.9947267123181514, 'auprc': 0.9991623520694572, 'loss_val': 0.1127729368749436, 'psi': 0.9965009682186737}
[S9] START round=18 head_norm_before_train=1.318451 cos_to_last_merge=0.9778 (last merge round=14)
[S9] round=18 local utility u=0.000000 metrics={'f1_val': 0.9897071435092063, 'auprc': 0.9993134035046307, 'loss_val': 0.061594599250613884, 'psi': 0.9935496475073761}-{'f1_val': 0.9934918488430377, 'auprc': 0.9994709716427036, 'loss_val': 0.06513237631449015, 'psi': 0.995883497962904}
[S10] START round=18 head_norm_before_train=1.247455 cos_to_last_merge=0.7985 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.798
[S10] round=18 local utility u=0.000000 metrics={'f1_val': 0.9890605451244792, 'auprc': 0.9959106440287083, 'loss_val': 0.19074670229680574, 'psi': 0.9918005846861708}-{'f1_val': 0.9932458082131452, 'auprc': 0.9928901822932915, 'loss_val': 0.19692735945526538, 'psi': 0.9931035578452037}
[S11] START round=18 head_norm_before_train=1.163890 cos_to_last_merge=0.9989 (last merge round=16)
[S11] round=18 local utility u=0.450796 metrics={'f1_val': 0.7891323231991203, 'auprc': 0.9978996689684351, 'loss_val': 0.2750723348125942, 'psi': 0.8726392615068461}-{'f1_val': 0.6593006574604047, 'auprc': 0.9978759713911444, 'loss_val': 0.39760407628707, 'psi': 0.7947307830327006}
[S13] START round=18 head_norm_before_train=0.931771 cos_to_last_merge=0.9967 (last merge round=16)
[S13] round=18 local utility u=0.841072 metrics={'f1_val': 0.5970949206026273, 'auprc': 0.5195219622899495, 'loss_val': 0.8608017636357498, 'psi': 0.5660657372775562}-{'f1_val': 0.3733035546829162, 'auprc': 0.4415165083577992, 'loss_val': 0.9661815712822358, 'psi': 0.4005887361528694}
[S14] START round=18 head_norm_before_train=1.220730 cos_to_last_merge=1.0000 (last merge round=17)
[S14] round=18 local utility u=0.000000 metrics={'f1_val': 0.9962301447146618, 'auprc': 0.9956909633187616, 'loss_val': 0.2920849163657443, 'psi': 0.9960144721563017}-{'f1_val': 0.9974082695017256, 'auprc': 0.9967112689042056, 'loss_val': 0.214459274356607, 'psi': 0.9971294692627176}
[S15] START round=18 head_norm_before_train=1.215548 cos_to_last_merge=1.0000 (last merge round=17)
[S15] round=18 local utility u=0.000000 metrics={'f1_val': 0.6955777274645996, 'auprc': 0.9894228028312494, 'loss_val': 0.3421869105448281, 'psi': 0.8131157576112595}-{'f1_val': 0.9214298853462084, 'auprc': 0.9899692872601501, 'loss_val': 0.26161444258447947, 'psi': 0.948845646111785}
[S16] START round=18 head_norm_before_train=1.444932 cos_to_last_merge=0.9994 (last merge round=16)
[S16] round=18 local utility u=0.367673 metrics={'f1_val': 0.8605153164667655, 'auprc': 0.9365581939842805, 'loss_val': 0.500713245030493, 'psi': 0.8909324674737715}-{'f1_val': 0.8199784625768728, 'auprc': 0.8513301938743307, 'loss_val': 0.7371532509082747, 'psi': 0.832519155095856}
[S17] START round=18 head_norm_before_train=0.906442 cos_to_last_merge=1.0000 (last merge round=17)
[S17] round=18 local utility u=0.000000 metrics={'f1_val': 0.37741926271089243, 'auprc': 0.6960773159037066, 'loss_val': 0.9463450548841916, 'psi': 0.5048824839880182}-{'f1_val': 0.3692937239749249, 'auprc': 0.7337781101350394, 'loss_val': 0.9131695536899332, 'psi': 0.5150874784389706}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:42013
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:42012
[S7] not sending this round → trigger blocked (psi=0.712)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:42004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] → sending delta(kind=head bytes=1805) to S13@127.0.0.1:42013
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:42010
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1805 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1795) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.686996)
[S11] loaded HEAD from S6 (vec_in norm=1.686996)
[S11] cosine check vs S6: cos=0.8907
[S11] BUFFERED delta from S6 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1796) from S3
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.208770)
[S9] loaded HEAD from S3 (vec_in norm=1.208770)
[S9] cosine check vs S3: cos=0.9299
[S9] BUFFERED delta from S3 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1795) from S13
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=0.963744)
[S4] loaded HEAD from S13 (vec_in norm=0.963744)
[S4] cosine check vs S13: cos=0.4198
[S4] BUFFERED delta from S13 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1803) from S16
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.484460)
[S17] loaded HEAD from S16 (vec_in norm=1.484460)
[S17] cosine check vs S16: cos=0.4477
[S17] BUFFERED delta from S16 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1805) from S2
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.520380)
[S13] loaded HEAD from S2 (vec_in norm=1.520380)
[S13] cosine check vs S2: cos=0.4429
[S13] BUFFERED delta from S2 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1800) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.205718)
[S13] loaded HEAD from S11 (vec_in norm=1.205718)
[S13] cosine check vs S11: cos=0.8749
[S13] BUFFERED delta from S11 (total buffered=2)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=18 metric=0.8953 head_norm=1.370093
[S4] _apply_head_vector_avg (torch): Δ‖w‖=6.514338e-01
[S4] stored merged vector for next round verification (round=18)
[S4] DEBUG after merge:  round=18 metric=0.6653 head_norm=0.989249 delta_norm=0.651434
[S4] aggregate: ROLLBACK (f1_val pre=0.895 post=0.665 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=18 metric=0.9897 head_norm=1.365426
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.528909e-01
[S9] stored merged vector for next round verification (round=18)
[S9] DEBUG after merge:  round=18 metric=0.9901 head_norm=1.264438 delta_norm=0.252891
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=18 metric=0.7891 head_norm=1.205718
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.111938e-01
[S11] stored merged vector for next round verification (round=18)
[S11] DEBUG after merge:  round=18 metric=0.7016 head_norm=1.407400 delta_norm=0.411194
[S11] aggregate: ROLLBACK (f1_val pre=0.789 post=0.702 tol_abs=0.005 tol_rel=0.0)
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=18 metric=0.5971 head_norm=0.963744
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.239797e-01
[S13] stored merged vector for next round verification (round=18)
[S13] DEBUG after merge:  round=18 metric=0.6081 head_norm=0.939649 delta_norm=0.223980
[S13] aggregate: ACCEPT kept=['S2', 'S11'] (k=2/2) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=18 metric=0.3774 head_norm=0.934960
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.773156e-01
[S17] stored merged vector for next round verification (round=18)
[S17] DEBUG after merge:  round=18 metric=0.3644 head_norm=1.039293 delta_norm=0.677316
[S17] aggregate: ROLLBACK (f1_val pre=0.377 post=0.364 tol_abs=0.005 tol_rel=0.0)
[S2] START round=19 head_norm_before_train=1.520380 cos_to_last_merge=0.8330 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.833
[S2] round=19 local utility u=0.000000 metrics={'f1_val': 0.7113968079383843, 'auprc': 0.7798264976169539, 'loss_val': 0.6740643790324924, 'psi': 0.7387686838098122}-{'f1_val': 0.7116016335215279, 'auprc': 0.7846465789836854, 'loss_val': 0.6279412956898335, 'psi': 0.740819611706391}
[S3] START round=19 head_norm_before_train=1.208770 cos_to_last_merge=0.9897 (last merge round=16)
[S3] round=19 local utility u=0.002218 metrics={'f1_val': 0.9940335392918865, 'auprc': 0.9987576573000698, 'loss_val': 0.08803563943103884, 'psi': 0.9959231864951599}-{'f1_val': 0.9977814963782642, 'auprc': 0.9970205835629193, 'loss_val': 0.10974913642324352, 'psi': 0.9974771312521262}
[S4] START round=19 head_norm_before_train=0.989249 cos_to_last_merge=1.0000 (last merge round=18)
[S4] round=19 local utility u=0.120360 metrics={'f1_val': 0.9540597018183604, 'auprc': 0.9543745268034203, 'loss_val': 0.485151293897757, 'psi': 0.9541856318123844}-{'f1_val': 0.8953478097900888, 'auprc': 0.9465351690183791, 'loss_val': 0.35008251954970543, 'psi': 0.915822753481405}
[S5] START round=19 head_norm_before_train=1.449119 cos_to_last_merge=0.8189 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.819
[S5] round=19 local utility u=1.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9878933698976853, 'loss_val': 0.2134650279964541, 'psi': 0.8153501384194224}-{'f1_val': 0.43371181617480437, 'auprc': 0.8493957009091683, 'loss_val': 0.8089289502003592, 'psi': 0.59998537006855}
[S6] START round=19 head_norm_before_train=1.686996 (no previous merge yet)
[S6] round=19 local utility u=0.000000 metrics={'f1_val': 0.8939388116136018, 'auprc': 0.9412128283253772, 'loss_val': 0.21418237088775552, 'psi': 0.912848418298312}-{'f1_val': 0.9010596062924752, 'auprc': 0.9612589604447681, 'loss_val': 0.20191252688880257, 'psi': 0.9251393479533923}
[S7] START round=19 head_norm_before_train=1.288294 cos_to_last_merge=0.8423 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.842
[S7] round=19 local utility u=0.000000 metrics={'f1_val': 0.46963827266446845, 'auprc': 0.7833510274886186, 'loss_val': 0.9524329726125573, 'psi': 0.5951233745941285}-{'f1_val': 0.6390084787116237, 'auprc': 0.8212266689228497, 'loss_val': 0.516832739177952, 'psi': 0.7118957547961141}
[S8] START round=19 head_norm_before_train=1.426822 cos_to_last_merge=0.8069 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.807
[S8] round=19 local utility u=0.000000 metrics={'f1_val': 0.9923167377520978, 'auprc': 0.9993705338747128, 'loss_val': 0.09231001920323217, 'psi': 0.9951382562011438}-{'f1_val': 0.9950136499820015, 'auprc': 0.9991510544042027, 'loss_val': 0.10251035981109, 'psi': 0.9966686117508821}
[S9] START round=19 head_norm_before_train=1.264438 cos_to_last_merge=1.0000 (last merge round=18)
[S9] round=19 local utility u=0.002380 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9933567260823315, 'loss_val': 0.07822226968662804, 'psi': 0.9950927473004991}-{'f1_val': 0.9897071435092063, 'auprc': 0.9993134035046307, 'loss_val': 0.061594599250613884, 'psi': 0.9935496475073761}
[S10] START round=19 head_norm_before_train=1.278700 cos_to_last_merge=0.7933 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.793
[S10] round=19 local utility u=0.036261 metrics={'f1_val': 0.9946892565352771, 'auprc': 0.9954244726247142, 'loss_val': 0.15053851278016783, 'psi': 0.994983342971052}-{'f1_val': 0.9890605451244792, 'auprc': 0.9959106440287083, 'loss_val': 0.19074670229680574, 'psi': 0.9918005846861708}
[S11] START round=19 head_norm_before_train=1.407400 cos_to_last_merge=1.0000 (last merge round=18)
[S11] round=19 local utility u=0.631709 metrics={'f1_val': 0.9971333159512151, 'auprc': 0.9959349151269312, 'loss_val': 0.25376535630447034, 'psi': 0.9966539556215015}-{'f1_val': 0.7891323231991203, 'auprc': 0.9978996689684351, 'loss_val': 0.2750723348125942, 'psi': 0.8726392615068461}
[S13] START round=19 head_norm_before_train=0.939649 cos_to_last_merge=1.0000 (last merge round=18)
[S13] round=19 local utility u=0.094433 metrics={'f1_val': 0.5632108354814678, 'auprc': 0.6327313800527021, 'loss_val': 0.8082599143408062, 'psi': 0.5910190533099615}-{'f1_val': 0.5970949206026273, 'auprc': 0.5195219622899495, 'loss_val': 0.8608017636357498, 'psi': 0.5660657372775562}
[S14] START round=19 head_norm_before_train=1.262877 cos_to_last_merge=0.9974 (last merge round=17)
[S14] round=19 local utility u=0.043494 metrics={'f1_val': 0.9969942850194674, 'auprc': 0.9968588930187283, 'loss_val': 0.21318461462789817, 'psi': 0.9969401282191718}-{'f1_val': 0.9962301447146618, 'auprc': 0.9956909633187616, 'loss_val': 0.2920849163657443, 'psi': 0.9960144721563017}
[S15] START round=19 head_norm_before_train=1.254079 cos_to_last_merge=0.9991 (last merge round=17)
[S15] round=19 local utility u=0.118560 metrics={'f1_val': 0.7317359794115851, 'auprc': 0.9904981727501451, 'loss_val': 0.32524173222001557, 'psi': 0.8352408567470091}-{'f1_val': 0.6955777274645996, 'auprc': 0.9894228028312494, 'loss_val': 0.3421869105448281, 'psi': 0.8131157576112595}
[S16] START round=19 head_norm_before_train=1.484460 cos_to_last_merge=0.9978 (last merge round=16)
[S16] round=19 local utility u=0.443268 metrics={'f1_val': 0.9464493481248135, 'auprc': 0.975643956276134, 'loss_val': 0.24703776612190986, 'psi': 0.9581271913853417}-{'f1_val': 0.8605153164667655, 'auprc': 0.9365581939842805, 'loss_val': 0.500713245030493, 'psi': 0.8909324674737715}
[S17] START round=19 head_norm_before_train=1.039293 cos_to_last_merge=1.0000 (last merge round=18)
[S17] round=19 local utility u=0.178534 metrics={'f1_val': 0.388388823110546, 'auprc': 0.7421759393710089, 'loss_val': 0.7933911290516523, 'psi': 0.5299036696147312}-{'f1_val': 0.37741926271089243, 'auprc': 0.6960773159037066, 'loss_val': 0.9463450548841916, 'psi': 0.5048824839880182}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:42011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:42017
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:42016
[S13] not sending this round → trigger blocked (psi=0.591)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:42003
[S11] not sending this round → trigger blocked (psi=0.997)
[S16] not sending this round → trigger blocked (psi=0.958)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:42012
[S3] not sending this round → trigger blocked (psi=0.996)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:42015
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1801) from S4
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.016334)
[S10] loaded HEAD from S4 (vec_in norm=1.016334)
[S10] cosine check vs S4: cos=0.0261
[S10] BUFFERED delta from S4 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1799) from S10
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.310336)
[S3] loaded HEAD from S10 (vec_in norm=1.310336)
[S3] cosine check vs S10: cos=0.8066
[S3] BUFFERED delta from S10 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1796) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.300421)
[S17] loaded HEAD from S9 (vec_in norm=1.300421)
[S17] cosine check vs S9: cos=0.4648
[S17] BUFFERED delta from S9 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1798) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.465451)
[S16] loaded HEAD from S5 (vec_in norm=1.465451)
[S16] cosine check vs S5: cos=0.9859
[S16] BUFFERED delta from S5 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1802) from S15
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.297695)
[S11] loaded HEAD from S15 (vec_in norm=1.297695)
[S11] cosine check vs S15: cos=0.2670
[S11] BUFFERED delta from S15 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1800) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.313403)
[S15] loaded HEAD from S14 (vec_in norm=1.313403)
[S15] cosine check vs S14: cos=0.9350
[S15] BUFFERED delta from S14 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] → sending delta(kind=head bytes=1793) to S3@127.0.0.1:42003
[S17] sending update (kind=head size=1793 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1793) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.066753)
[S3] loaded HEAD from S17 (vec_in norm=1.066753)
[S3] cosine check vs S17: cos=0.4957
[S3] BUFFERED delta from S17 (total buffered=2)
[S13] r=20 psi=0.591 u=0.0944 p_local=0.2998 f1=0.563 auprc=0.633 bytes=16173
[S2] r=20 psi=0.739 u=0.0000 p_local=0.0854 f1=0.711 auprc=0.780 bytes=19790
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=19 metric=0.9971 head_norm=1.445494
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.324147e-01
[S11] stored merged vector for next round verification (round=19)
[S11] DEBUG after merge:  round=19 metric=0.9965 head_norm=1.092620 delta_norm=0.832415
[S11] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S11] r=20 psi=0.997 u=0.6317 p_local=0.2791 f1=0.997 auprc=0.996 bytes=17947
[S6] r=20 psi=0.913 u=0.0000 p_local=0.3193 f1=0.894 auprc=0.941 bytes=17960
[S7] r=20 psi=0.595 u=0.0000 p_local=0.2800 f1=0.470 auprc=0.783 bytes=14368
[S8] r=20 psi=0.995 u=0.0000 p_local=0.2664 f1=0.992 auprc=0.999 bytes=14385
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=19 metric=0.9940 head_norm=1.266267
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.447596e-01
[S3] stored merged vector for next round verification (round=19)
[S3] DEBUG after merge:  round=19 metric=0.9936 head_norm=1.059634 delta_norm=0.344760
[S3] aggregate: ACCEPT kept=['S10', 'S17'] (k=2/2) mode=median trim_p=0.1
[S3] r=20 psi=0.996 u=0.0022 p_local=0.1073 f1=0.994 auprc=0.999 bytes=17978
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=19 metric=0.9464 head_norm=1.523942
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.286239e-01
[S16] stored merged vector for next round verification (round=19)
[S16] DEBUG after merge:  round=19 metric=0.9358 head_norm=1.489439 delta_norm=0.128624
[S16] aggregate: ROLLBACK (f1_val pre=0.946 post=0.936 tol_abs=0.005 tol_rel=0.0)
[S16] r=20 psi=0.958 u=0.4433 p_local=0.3295 f1=0.946 auprc=0.976 bytes=16203
[S9] r=20 psi=0.995 u=0.0024 p_local=0.0677 f1=0.996 auprc=0.993 bytes=21551
[S4] r=20 psi=0.954 u=0.1204 p_local=0.2001 f1=0.954 auprc=0.954 bytes=17953
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=19 metric=0.7317 head_norm=1.297695
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.354365e-01
[S15] stored merged vector for next round verification (round=19)
[S15] DEBUG after merge:  round=19 metric=0.7437 head_norm=1.284169 delta_norm=0.235437
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] r=20 psi=0.835 u=0.1186 p_local=0.2029 f1=0.732 auprc=0.990 bytes=19765
[S14] r=20 psi=0.997 u=0.0435 p_local=0.0976 f1=0.997 auprc=0.997 bytes=17987
[S5] r=20 psi=0.815 u=1.0000 p_local=0.3489 f1=0.700 auprc=0.988 bytes=17960
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=19 metric=0.9947 head_norm=1.310336
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.186083e-01
[S10] stored merged vector for next round verification (round=19)
[S10] DEBUG after merge:  round=19 metric=0.9938 head_norm=0.839546 delta_norm=0.818608
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S10] r=20 psi=0.995 u=0.0363 p_local=0.1808 f1=0.995 auprc=0.995 bytes=17971
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=19 metric=0.3884 head_norm=1.066753
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.203657e-01
[S17] stored merged vector for next round verification (round=19)
[S17] DEBUG after merge:  round=19 metric=0.3961 head_norm=1.014729 delta_norm=0.620366
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S17] r=20 psi=0.530 u=0.1785 p_local=0.0963 f1=0.388 auprc=0.742 bytes=14365
[S2] START round=20 head_norm_before_train=1.543530 cos_to_last_merge=0.8292 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.829
[S2] round=20 local utility u=0.000000 metrics={'f1_val': 0.71146142054669, 'auprc': 0.7795935181131742, 'loss_val': 0.6947765624358323, 'psi': 0.7387142595732837}-{'f1_val': 0.7113968079383843, 'auprc': 0.7798264976169539, 'loss_val': 0.6740643790324924, 'psi': 0.7387686838098122}
[S3] START round=20 head_norm_before_train=1.059634 cos_to_last_merge=1.0000 (last merge round=19)
[S3] round=20 local utility u=0.000000 metrics={'f1_val': 0.9833701494118764, 'auprc': 0.9988866285829568, 'loss_val': 0.152518114670083, 'psi': 0.9895767410803085}-{'f1_val': 0.9940335392918865, 'auprc': 0.9987576573000698, 'loss_val': 0.08803563943103884, 'psi': 0.9959231864951599}
[S4] START round=20 head_norm_before_train=1.016334 cos_to_last_merge=0.9991 (last merge round=18)
[S4] round=20 local utility u=0.025521 metrics={'f1_val': 0.9521052511600698, 'auprc': 0.9523098358952652, 'loss_val': 0.41618929874835103, 'psi': 0.952187085054148}-{'f1_val': 0.9540597018183604, 'auprc': 0.9543745268034203, 'loss_val': 0.485151293897757, 'psi': 0.9541856318123844}
[S5] START round=20 head_norm_before_train=1.465451 cos_to_last_merge=0.8168 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.817
[S5] round=20 local utility u=0.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9892082454959974, 'loss_val': 0.2341746797751676, 'psi': 0.8158760886587473}-{'f1_val': 0.7003213174339138, 'auprc': 0.9878933698976853, 'loss_val': 0.2134650279964541, 'psi': 0.8153501384194224}
[S6] START round=20 head_norm_before_train=1.708466 (no previous merge yet)
[S6] round=20 local utility u=0.000000 metrics={'f1_val': 0.7650049749862753, 'auprc': 0.7520846516419835, 'loss_val': 0.4560210961750413, 'psi': 0.7598368456485586}-{'f1_val': 0.8939388116136018, 'auprc': 0.9412128283253772, 'loss_val': 0.21418237088775552, 'psi': 0.912848418298312}
[S7] START round=20 head_norm_before_train=1.314699 cos_to_last_merge=0.8367 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.837
[S7] round=20 local utility u=0.000000 metrics={'f1_val': 0.39534315041779544, 'auprc': 0.780886084724457, 'loss_val': 1.2109360844323553, 'psi': 0.5495603241404601}-{'f1_val': 0.46963827266446845, 'auprc': 0.7833510274886186, 'loss_val': 0.9524329726125573, 'psi': 0.5951233745941285}
[S8] START round=20 head_norm_before_train=1.460431 cos_to_last_merge=0.8000 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.800
[S8] round=20 local utility u=0.000000 metrics={'f1_val': 0.7141514111793891, 'auprc': 0.9900833805933051, 'loss_val': 0.24493904552624826, 'psi': 0.8245241989449554}-{'f1_val': 0.9923167377520978, 'auprc': 0.9993705338747128, 'loss_val': 0.09231001920323217, 'psi': 0.9951382562011438}
[S9] START round=20 head_norm_before_train=1.300421 cos_to_last_merge=0.9995 (last merge round=18)
[S9] round=20 local utility u=0.007236 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9931498508295106, 'loss_val': 0.06312906315241416, 'psi': 0.9950099971993708}-{'f1_val': 0.9962500947792776, 'auprc': 0.9933567260823315, 'loss_val': 0.07822226968662804, 'psi': 0.9950927473004991}
[S10] START round=20 head_norm_before_train=0.839546 cos_to_last_merge=1.0000 (last merge round=19)
[S10] round=20 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9918538657701773, 'loss_val': 0.37773314477570863, 'psi': 0.9938542497196958}-{'f1_val': 0.9946892565352771, 'auprc': 0.9954244726247142, 'loss_val': 0.15053851278016783, 'psi': 0.994983342971052}
[S11] START round=20 head_norm_before_train=1.092620 cos_to_last_merge=1.0000 (last merge round=19)
[S11] round=20 local utility u=0.000000 metrics={'f1_val': 0.9966988539245482, 'auprc': 0.9980838851619409, 'loss_val': 0.2713549661337726, 'psi': 0.9972528664195053}-{'f1_val': 0.9971333159512151, 'auprc': 0.9959349151269312, 'loss_val': 0.25376535630447034, 'psi': 0.9966539556215015}
[S13] START round=20 head_norm_before_train=0.980199 cos_to_last_merge=0.9974 (last merge round=18)
[S13] round=20 local utility u=0.159675 metrics={'f1_val': 0.5894509371359913, 'auprc': 0.6606040513707965, 'loss_val': 0.729969156201441, 'psi': 0.6179121828299134}-{'f1_val': 0.5632108354814678, 'auprc': 0.6327313800527021, 'loss_val': 0.8082599143408062, 'psi': 0.5910190533099615}
[S14] START round=20 head_norm_before_train=1.313403 cos_to_last_merge=0.9903 (last merge round=17)
[S14] round=20 local utility u=0.033222 metrics={'f1_val': 0.9969942850194674, 'auprc': 0.9983906917207963, 'loss_val': 0.15133618382287814, 'psi': 0.997552847699999}-{'f1_val': 0.9969942850194674, 'auprc': 0.9968588930187283, 'loss_val': 0.21318461462789817, 'psi': 0.9969401282191718}
[S15] START round=20 head_norm_before_train=1.284169 cos_to_last_merge=1.0000 (last merge round=19)
[S15] round=20 local utility u=0.000000 metrics={'f1_val': 0.6925788856041603, 'auprc': 0.9867102822245559, 'loss_val': 0.40148237686878263, 'psi': 0.8102314442523186}-{'f1_val': 0.7317359794115851, 'auprc': 0.9904981727501451, 'loss_val': 0.32524173222001557, 'psi': 0.8352408567470091}
[S16] START round=20 head_norm_before_train=1.489439 cos_to_last_merge=1.0000 (last merge round=19)
[S16] round=20 local utility u=0.088722 metrics={'f1_val': 0.9682614888521978, 'auprc': 0.980687483391059, 'loss_val': 0.21559763463723497, 'psi': 0.9732318866677423}-{'f1_val': 0.9464493481248135, 'auprc': 0.975643956276134, 'loss_val': 0.24703776612190986, 'psi': 0.9581271913853417}
[S17] START round=20 head_norm_before_train=1.014729 cos_to_last_merge=1.0000 (last merge round=19)
[S17] round=20 local utility u=0.022620 metrics={'f1_val': 0.3958602239167406, 'auprc': 0.7217977982461161, 'loss_val': 0.7318460948134556, 'psi': 0.5262352536484908}-{'f1_val': 0.388388823110546, 'auprc': 0.7421759393710089, 'loss_val': 0.7933911290516523, 'psi': 0.5299036696147312}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S10@127.0.0.1:42011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:42017
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S14] → sending delta(kind=head bytes=1806) to S15@127.0.0.1:42015
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S13] → sending delta(kind=head bytes=1792) to S4@127.0.0.1:42004
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:42017
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1792 to 1 peers)
[S14] sending update (kind=head size=1806 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1794 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1801) from S16
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.527936)
[S17] loaded HEAD from S16 (vec_in norm=1.527936)
[S17] cosine check vs S16: cos=0.6679
[S17] BUFFERED delta from S16 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1792) from S13
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.020606)
[S4] loaded HEAD from S13 (vec_in norm=1.020606)
[S4] cosine check vs S13: cos=0.8661
[S4] BUFFERED delta from S13 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1806) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.369206)
[S15] loaded HEAD from S14 (vec_in norm=1.369206)
[S15] cosine check vs S14: cos=0.9792
[S15] BUFFERED delta from S14 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1798) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.343332)
[S17] loaded HEAD from S9 (vec_in norm=1.343332)
[S17] cosine check vs S9: cos=0.8765
[S17] BUFFERED delta from S9 (total buffered=2)
[S10] RECEIVED delta(kind=head bytes=1794) from S4
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.054074)
[S10] loaded HEAD from S4 (vec_in norm=1.054074)
[S10] cosine check vs S4: cos=0.5895
[S10] BUFFERED delta from S4 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:42003
[S17] sending update (kind=head size=1797 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1797) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.047840)
[S3] loaded HEAD from S17 (vec_in norm=1.047840)
[S3] cosine check vs S17: cos=0.9263
[S3] BUFFERED delta from S17 (total buffered=1)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=20 metric=0.9834 head_norm=1.126155
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.121534e-01
[S3] stored merged vector for next round verification (round=20)
[S3] DEBUG after merge:  round=20 metric=0.9786 head_norm=1.066812 delta_norm=0.212153
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.086 → S9@127.0.0.1:42010
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=20 metric=0.9952 head_norm=0.881970
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.452141e-01
[S10] stored merged vector for next round verification (round=20)
[S10] DEBUG after merge:  round=20 metric=0.9942 head_norm=0.863861 delta_norm=0.445214
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.145 → S3@127.0.0.1:42003
[S7] ⇄ pheromone p=0.224 → S14@127.0.0.1:42014
[S8] ⇄ pheromone p=0.213 → S17@127.0.0.1:42017
[S2] ⇄ pheromone p=0.068 → S13@127.0.0.1:42013
[S6] ⇄ pheromone p=0.255 → S11@127.0.0.1:42012
[S5] ⇄ pheromone p=0.279 → S16@127.0.0.1:42016
[S11] ⇄ pheromone p=0.223 → S13@127.0.0.1:42013
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=20 metric=0.6926 head_norm=1.321002
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.391192e-01
[S15] stored merged vector for next round verification (round=20)
[S15] DEBUG after merge:  round=20 metric=0.6924 head_norm=1.338108 delta_norm=0.139119
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.162 → S11@127.0.0.1:42012
[S13] ⇄ pheromone p=0.272 → S4@127.0.0.1:42004
[S16] ⇄ pheromone p=0.281 → S17@127.0.0.1:42017
[S14] ⇄ pheromone p=0.085 → S15@127.0.0.1:42015
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=20 metric=0.9521 head_norm=1.054074
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.688518e-01
[S4] stored merged vector for next round verification (round=20)
[S4] DEBUG after merge:  round=20 metric=0.9541 head_norm=1.002034 delta_norm=0.268852
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.165 → S10@127.0.0.1:42011
[S9] ⇄ pheromone p=0.056 → S17@127.0.0.1:42017
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=20 metric=0.3959 head_norm=1.047840
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.966508e-01
[S17] stored merged vector for next round verification (round=20)
[S17] DEBUG after merge:  round=20 metric=0.5062 head_norm=1.090967 delta_norm=0.196651
[S17] aggregate: ACCEPT kept=['S16', 'S9'] (k=2/2) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.082 → S3@127.0.0.1:42003
[S2] START round=21 head_norm_before_train=1.564424 cos_to_last_merge=0.8262 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.826
[S2] round=21 local utility u=0.085783 metrics={'f1_val': 0.7040713623639534, 'auprc': 0.7857586408366085, 'loss_val': 0.497364627372606, 'psi': 0.7367462737530155}-{'f1_val': 0.71146142054669, 'auprc': 0.7795935181131742, 'loss_val': 0.6947765624358323, 'psi': 0.7387142595732837}
[S3] START round=21 head_norm_before_train=1.066812 cos_to_last_merge=1.0000 (last merge round=20)
[S3] round=21 local utility u=0.051306 metrics={'f1_val': 0.9952582588558114, 'auprc': 0.9990087388520582, 'loss_val': 0.12160192356034684, 'psi': 0.9967584508543101}-{'f1_val': 0.9833701494118764, 'auprc': 0.9988866285829568, 'loss_val': 0.152518114670083, 'psi': 0.9895767410803085}
[S4] START round=21 head_norm_before_train=1.002034 cos_to_last_merge=1.0000 (last merge round=20)
[S4] round=21 local utility u=0.000000 metrics={'f1_val': 0.9471395481226089, 'auprc': 0.9422404860464402, 'loss_val': 0.47302680415718135, 'psi': 0.9451799232921414}-{'f1_val': 0.9521052511600698, 'auprc': 0.9523098358952652, 'loss_val': 0.41618929874835103, 'psi': 0.952187085054148}
[S5] START round=21 head_norm_before_train=1.476236 cos_to_last_merge=0.8162 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.816
[S5] round=21 local utility u=0.027294 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9898662164613599, 'loss_val': 0.18156038202588304, 'psi': 0.8161392770448922}-{'f1_val': 0.7003213174339138, 'auprc': 0.9892082454959974, 'loss_val': 0.2341746797751676, 'psi': 0.8158760886587473}
[S6] START round=21 head_norm_before_train=1.728869 (no previous merge yet)
[S6] round=21 local utility u=1.000000 metrics={'f1_val': 0.9410871083971903, 'auprc': 0.9774782009115739, 'loss_val': 0.16404992845681604, 'psi': 0.9556435454029438}-{'f1_val': 0.7650049749862753, 'auprc': 0.7520846516419835, 'loss_val': 0.4560210961750413, 'psi': 0.7598368456485586}
[S7] START round=21 head_norm_before_train=1.329933 cos_to_last_merge=0.8331 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.833
[S7] round=21 local utility u=1.000000 metrics={'f1_val': 0.6995747691051115, 'auprc': 0.9922669226202854, 'loss_val': 0.24900845592772786, 'psi': 0.8166516305111811}-{'f1_val': 0.39534315041779544, 'auprc': 0.780886084724457, 'loss_val': 1.2109360844323553, 'psi': 0.5495603241404601}
[S8] START round=21 head_norm_before_train=1.492489 cos_to_last_merge=0.7940 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.794
[S8] round=21 local utility u=0.875797 metrics={'f1_val': 0.9830713843675121, 'auprc': 0.9897516769149617, 'loss_val': 0.10587014182355751, 'psi': 0.9857435013864919}-{'f1_val': 0.7141514111793891, 'auprc': 0.9900833805933051, 'loss_val': 0.24493904552624826, 'psi': 0.8245241989449554}
[S9] START round=21 head_norm_before_train=1.343332 cos_to_last_merge=0.9982 (last merge round=18)
[S9] round=21 local utility u=0.000000 metrics={'f1_val': 0.9895343037577012, 'auprc': 0.997818056139263, 'loss_val': 0.06687944822592444, 'psi': 0.992847804710326}-{'f1_val': 0.9962500947792776, 'auprc': 0.9931498508295106, 'loss_val': 0.06312906315241416, 'psi': 0.9950099971993708}
[S10] START round=21 head_norm_before_train=0.863861 cos_to_last_merge=1.0000 (last merge round=20)
[S10] round=21 local utility u=0.000000 metrics={'f1_val': 0.9928357895898154, 'auprc': 0.9930667133148858, 'loss_val': 0.5872297396394874, 'psi': 0.9929281590798436}-{'f1_val': 0.9951878390193748, 'auprc': 0.9918538657701773, 'loss_val': 0.37773314477570863, 'psi': 0.9938542497196958}
[S11] START round=21 head_norm_before_train=1.135375 cos_to_last_merge=0.9986 (last merge round=19)
[S11] round=21 local utility u=0.029955 metrics={'f1_val': 0.996960829744628, 'auprc': 0.9978718442806739, 'loss_val': 0.21238086964359282, 'psi': 0.9973252355590463}-{'f1_val': 0.9966988539245482, 'auprc': 0.9980838851619409, 'loss_val': 0.2713549661337726, 'psi': 0.9972528664195053}
[S13] START round=21 head_norm_before_train=1.020606 cos_to_last_merge=0.9919 (last merge round=18)
[S13] round=21 local utility u=0.075695 metrics={'f1_val': 0.6086246896326993, 'auprc': 0.6580441479718662, 'loss_val': 0.6859413469674029, 'psi': 0.6283924729683661}-{'f1_val': 0.5894509371359913, 'auprc': 0.6606040513707965, 'loss_val': 0.729969156201441, 'psi': 0.6179121828299134}
[S14] START round=21 head_norm_before_train=1.369206 cos_to_last_merge=0.9815 (last merge round=17)
[S14] round=21 local utility u=0.000000 metrics={'f1_val': 0.9913774762385958, 'auprc': 0.9975977215039113, 'loss_val': 0.11958872791456254, 'psi': 0.993865574344722}-{'f1_val': 0.9969942850194674, 'auprc': 0.9983906917207963, 'loss_val': 0.15133618382287814, 'psi': 0.997552847699999}
[S15] START round=21 head_norm_before_train=1.338108 cos_to_last_merge=1.0000 (last merge round=20)
[S15] round=21 local utility u=0.623527 metrics={'f1_val': 0.8752630772518617, 'auprc': 0.9900143420061686, 'loss_val': 0.260445541868381, 'psi': 0.9211635831535844}-{'f1_val': 0.6925788856041603, 'auprc': 0.9867102822245559, 'loss_val': 0.40148237686878263, 'psi': 0.8102314442523186}
[S16] START round=21 head_norm_before_train=1.527936 cos_to_last_merge=0.9995 (last merge round=19)
[S16] round=21 local utility u=0.000000 metrics={'f1_val': 0.8484923446093317, 'auprc': 0.9654034992097803, 'loss_val': 0.6533891463736146, 'psi': 0.8952568064495111}-{'f1_val': 0.9682614888521978, 'auprc': 0.980687483391059, 'loss_val': 0.21559763463723497, 'psi': 0.9732318866677423}
[S17] START round=21 head_norm_before_train=1.090967 cos_to_last_merge=1.0000 (last merge round=20)
[S17] round=21 local utility u=0.226460 metrics={'f1_val': 0.39652716364044865, 'auprc': 0.8690369022465242, 'loss_val': 0.7246458933209313, 'psi': 0.5855310590828788}-{'f1_val': 0.3958602239167406, 'auprc': 0.7217977982461161, 'loss_val': 0.7318460948134556, 'psi': 0.5262352536484908}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:42013
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:42017
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:42016
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:42013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:42010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:42014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:42012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:42004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:42012
[S15] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1793 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1797) from S2
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.582098)
[S13] loaded HEAD from S2 (vec_in norm=1.582098)
[S13] cosine check vs S2: cos=0.6611
[S13] BUFFERED delta from S2 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1796) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.747215)
[S11] loaded HEAD from S6 (vec_in norm=1.747215)
[S11] cosine check vs S6: cos=0.7056
[S11] BUFFERED delta from S6 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1803) from S13
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.061912)
[S4] loaded HEAD from S13 (vec_in norm=1.061912)
[S4] cosine check vs S13: cos=0.9477
[S4] BUFFERED delta from S13 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1793) from S3
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.136260)
[S9] loaded HEAD from S3 (vec_in norm=1.136260)
[S9] cosine check vs S3: cos=0.9280
[S9] BUFFERED delta from S3 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1798) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.516620)
[S17] loaded HEAD from S8 (vec_in norm=1.516620)
[S17] cosine check vs S8: cos=0.1367
[S17] BUFFERED delta from S8 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1801) from S15
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.376585)
[S11] loaded HEAD from S15 (vec_in norm=1.376585)
[S11] cosine check vs S15: cos=0.7284
[S11] BUFFERED delta from S15 (total buffered=2)
[S16] RECEIVED delta(kind=head bytes=1800) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.484875)
[S16] loaded HEAD from S5 (vec_in norm=1.484875)
[S16] cosine check vs S5: cos=0.9900
[S16] BUFFERED delta from S5 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1802) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.337996)
[S14] loaded HEAD from S7 (vec_in norm=1.337996)
[S14] cosine check vs S7: cos=0.8839
[S14] BUFFERED delta from S7 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1801) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.184342)
[S13] loaded HEAD from S11 (vec_in norm=1.184342)
[S13] cosine check vs S11: cos=0.7181
[S13] BUFFERED delta from S11 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S17] → sending delta(kind=head bytes=1791) to S3@127.0.0.1:42003
[S17] sending update (kind=head size=1791 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1791) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.117149)
[S3] loaded HEAD from S17 (vec_in norm=1.117149)
[S3] cosine check vs S17: cos=0.9536
[S3] BUFFERED delta from S17 (total buffered=1)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=21 metric=0.9914 head_norm=1.421862
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.348886e-01
[S14] stored merged vector for next round verification (round=21)
[S14] DEBUG after merge:  round=21 metric=0.9956 head_norm=1.339333 delta_norm=0.334889
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=21 metric=0.9895 head_norm=1.380270
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.671458e-01
[S9] stored merged vector for next round verification (round=21)
[S9] DEBUG after merge:  round=21 metric=0.9895 head_norm=1.235617 delta_norm=0.267146
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=21 metric=0.9471 head_norm=1.044265
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.705337e-01
[S4] stored merged vector for next round verification (round=21)
[S4] DEBUG after merge:  round=21 metric=0.9527 head_norm=1.039226 delta_norm=0.170534
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=21 metric=0.8485 head_norm=1.565899
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.149607e-01
[S16] stored merged vector for next round verification (round=21)
[S16] DEBUG after merge:  round=21 metric=0.8487 head_norm=1.521588 delta_norm=0.114961
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=21 metric=0.9970 head_norm=1.184342
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.631475e-01
[S11] stored merged vector for next round verification (round=21)
[S11] DEBUG after merge:  round=21 metric=0.9970 head_norm=1.162059 delta_norm=0.163148
[S11] aggregate: ACCEPT kept=['S6', 'S15'] (k=2/2) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=21 metric=0.9953 head_norm=1.136260
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.718397e-01
[S3] stored merged vector for next round verification (round=21)
[S3] DEBUG after merge:  round=21 metric=0.9911 head_norm=1.113564 delta_norm=0.171840
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=21 metric=0.6086 head_norm=1.061912
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.007149e-01
[S13] stored merged vector for next round verification (round=21)
[S13] DEBUG after merge:  round=21 metric=0.6084 head_norm=1.023336 delta_norm=0.200715
[S13] aggregate: ACCEPT kept=['S2', 'S11'] (k=2/2) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=21 metric=0.3965 head_norm=1.117149
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.781801e-01
[S17] stored merged vector for next round verification (round=21)
[S17] DEBUG after merge:  round=21 metric=0.3948 head_norm=1.001438 delta_norm=0.878180
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.582098 cos_to_last_merge=0.8243 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.824
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.7028691821039771, 'auprc': 0.7888150488284725, 'loss_val': 0.532889680053129, 'psi': 0.7372475287937752}-{'f1_val': 0.7040713623639534, 'auprc': 0.7857586408366085, 'loss_val': 0.497364627372606, 'psi': 0.7367462737530155}
[S3] START round=22 head_norm_before_train=1.113564 cos_to_last_merge=1.0000 (last merge round=21)
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.9353108894608357, 'auprc': 0.9988463750574839, 'loss_val': 0.18843660768660536, 'psi': 0.9607250836994949}-{'f1_val': 0.9952582588558114, 'auprc': 0.9990087388520582, 'loss_val': 0.12160192356034684, 'psi': 0.9967584508543101}
[S4] START round=22 head_norm_before_train=1.039226 cos_to_last_merge=1.0000 (last merge round=21)
[S4] round=22 local utility u=0.000000 metrics={'f1_val': 0.9426623586738145, 'auprc': 0.947312622302061, 'loss_val': 0.4650281259968089, 'psi': 0.9445224641251132}-{'f1_val': 0.9471395481226089, 'auprc': 0.9422404860464402, 'loss_val': 0.47302680415718135, 'psi': 0.9451799232921414}
[S5] START round=22 head_norm_before_train=1.484875 cos_to_last_merge=0.8154 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.815
[S5] round=22 local utility u=0.000000 metrics={'f1_val': 0.6823372107381016, 'auprc': 0.8779967133390594, 'loss_val': 0.35434514142679846, 'psi': 0.7606010117784847}-{'f1_val': 0.7003213174339138, 'auprc': 0.9898662164613599, 'loss_val': 0.18156038202588304, 'psi': 0.8161392770448922}
[S6] START round=22 head_norm_before_train=1.747215 (no previous merge yet)
[S6] round=22 local utility u=0.000000 metrics={'f1_val': 0.6414112672992318, 'auprc': 0.8096598589471216, 'loss_val': 0.49900282677849295, 'psi': 0.7087107039583878}-{'f1_val': 0.9410871083971903, 'auprc': 0.9774782009115739, 'loss_val': 0.16404992845681604, 'psi': 0.9556435454029438}
[S7] START round=22 head_norm_before_train=1.337996 cos_to_last_merge=0.8320 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.832
[S7] round=22 local utility u=0.000000 metrics={'f1_val': 0.6415598327120212, 'auprc': 0.8294542966210475, 'loss_val': 0.47234723744850854, 'psi': 0.7167176182756317}-{'f1_val': 0.6995747691051115, 'auprc': 0.9922669226202854, 'loss_val': 0.24900845592772786, 'psi': 0.8166516305111811}
[S8] START round=22 head_norm_before_train=1.516620 cos_to_last_merge=0.7899 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.790
[S8] round=22 local utility u=0.000000 metrics={'f1_val': 0.7142391053978291, 'auprc': 0.9865937241175375, 'loss_val': 0.41358100489888877, 'psi': 0.8231809528857126}-{'f1_val': 0.9830713843675121, 'auprc': 0.9897516769149617, 'loss_val': 0.10587014182355751, 'psi': 0.9857435013864919}
[S9] START round=22 head_norm_before_train=1.235617 cos_to_last_merge=1.0000 (last merge round=21)
[S9] round=22 local utility u=0.003330 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.99069437608058, 'loss_val': 0.07914253007884062, 'psi': 0.9940278072997986}-{'f1_val': 0.9895343037577012, 'auprc': 0.997818056139263, 'loss_val': 0.06687944822592444, 'psi': 0.992847804710326}
[S10] START round=22 head_norm_before_train=0.899245 cos_to_last_merge=0.9932 (last merge round=20)
[S10] round=22 local utility u=0.093448 metrics={'f1_val': 0.9920785626156365, 'auprc': 0.9948581338650193, 'loss_val': 0.4011642684318228, 'psi': 0.9931903911153896}-{'f1_val': 0.9928357895898154, 'auprc': 0.9930667133148858, 'loss_val': 0.5872297396394874, 'psi': 0.9929281590798436}
[S11] START round=22 head_norm_before_train=1.162059 cos_to_last_merge=1.0000 (last merge round=21)
[S11] round=22 local utility u=0.013652 metrics={'f1_val': 0.9967189926998994, 'auprc': 0.9979062211491819, 'loss_val': 0.18372913364735893, 'psi': 0.9971938840796124}-{'f1_val': 0.996960829744628, 'auprc': 0.9978718442806739, 'loss_val': 0.21238086964359282, 'psi': 0.9973252355590463}
[S13] START round=22 head_norm_before_train=1.023336 cos_to_last_merge=1.0000 (last merge round=21)
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.5452557514028291, 'auprc': 0.6631320769489936, 'loss_val': 0.8339337610666513, 'psi': 0.5924062816212949}-{'f1_val': 0.6086246896326993, 'auprc': 0.6580441479718662, 'loss_val': 0.6859413469674029, 'psi': 0.6283924729683661}
[S14] START round=22 head_norm_before_train=1.339333 cos_to_last_merge=1.0000 (last merge round=21)
[S14] round=22 local utility u=0.000000 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9971786507526424, 'loss_val': 0.18918221532703558, 'psi': 0.9972156743245328}-{'f1_val': 0.9913774762385958, 'auprc': 0.9975977215039113, 'loss_val': 0.11958872791456254, 'psi': 0.993865574344722}
[S15] START round=22 head_norm_before_train=1.376585 cos_to_last_merge=0.9988 (last merge round=20)
[S15] round=22 local utility u=0.000000 metrics={'f1_val': 0.8355512276154917, 'auprc': 0.9905273263507339, 'loss_val': 0.2302475214441378, 'psi': 0.8975416671095886}-{'f1_val': 0.8752630772518617, 'auprc': 0.9900143420061686, 'loss_val': 0.260445541868381, 'psi': 0.9211635831535844}
[S16] START round=22 head_norm_before_train=1.521588 cos_to_last_merge=1.0000 (last merge round=21)
[S16] round=22 local utility u=0.405779 metrics={'f1_val': 0.9233444216750661, 'auprc': 0.9821386370184816, 'loss_val': 0.3411492949783679, 'psi': 0.9468621078124324}-{'f1_val': 0.8484923446093317, 'auprc': 0.9654034992097803, 'loss_val': 0.6533891463736146, 'psi': 0.8952568064495111}
[S17] START round=22 head_norm_before_train=1.001438 cos_to_last_merge=1.0000 (last merge round=21)
[S17] round=22 local utility u=0.491485 metrics={'f1_val': 0.574771332232126, 'auprc': 0.8675212555398388, 'loss_val': 0.80659314458444, 'psi': 0.6918713015552111}-{'f1_val': 0.39652716364044865, 'auprc': 0.8690369022465242, 'loss_val': 0.7246458933209313, 'psi': 0.5855310590828788}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:42017
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:42003
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.997)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:42017
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1797) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.278021)
[S17] loaded HEAD from S9 (vec_in norm=1.278021)
[S17] cosine check vs S9: cos=0.5711
[S17] BUFFERED delta from S9 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1798) from S10
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=0.956392)
[S3] loaded HEAD from S10 (vec_in norm=0.956392)
[S3] cosine check vs S10: cos=0.3710
[S3] BUFFERED delta from S10 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1799) from S16
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.556199)
[S17] loaded HEAD from S16 (vec_in norm=1.556199)
[S17] cosine check vs S16: cos=0.4889
[S17] BUFFERED delta from S16 (total buffered=2)
[S17] not sending this round → trigger blocked (psi=0.692)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=22 metric=0.9353 head_norm=1.183668
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.074064e-01
[S3] stored merged vector for next round verification (round=22)
[S3] DEBUG after merge:  round=22 metric=0.9458 head_norm=0.888221 delta_norm=0.607406
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=22 metric=0.5748 head_norm=1.023341
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.891077e-01
[S17] stored merged vector for next round verification (round=22)
[S17] DEBUG after merge:  round=22 metric=0.6349 head_norm=1.000977 delta_norm=0.489108
[S17] aggregate: ACCEPT kept=['S9', 'S16'] (k=2/2) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.598891 cos_to_last_merge=0.8224 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.822
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.71146142054669, 'auprc': 0.7754345596141216, 'loss_val': 0.7375190114964688, 'psi': 0.7370506761736626}-{'f1_val': 0.7028691821039771, 'auprc': 0.7888150488284725, 'loss_val': 0.532889680053129, 'psi': 0.7372475287937752}
[S3] START round=23 head_norm_before_train=0.888221 cos_to_last_merge=1.0000 (last merge round=22)
[S3] round=23 local utility u=0.084405 metrics={'f1_val': 0.969687363177882, 'auprc': 0.9989014688529811, 'loss_val': 0.22605021819479168, 'psi': 0.9813730054479216}-{'f1_val': 0.9353108894608357, 'auprc': 0.9988463750574839, 'loss_val': 0.18843660768660536, 'psi': 0.9607250836994949}
[S4] START round=23 head_norm_before_train=1.085663 cos_to_last_merge=0.9953 (last merge round=21)
[S4] round=23 local utility u=0.038379 metrics={'f1_val': 0.9468657936189846, 'auprc': 0.9332383510227353, 'loss_val': 0.37126777925328985, 'psi': 0.9414148165804849}-{'f1_val': 0.9426623586738145, 'auprc': 0.947312622302061, 'loss_val': 0.4650281259968089, 'psi': 0.9445224641251132}
[S5] START round=23 head_norm_before_train=1.496141 cos_to_last_merge=0.8149 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.815
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.630591881738325, 'auprc': 0.8593785627913287, 'loss_val': 0.46779136988425557, 'psi': 0.7221065541595265}-{'f1_val': 0.6823372107381016, 'auprc': 0.8779967133390594, 'loss_val': 0.35434514142679846, 'psi': 0.7606010117784847}
[S6] START round=23 head_norm_before_train=1.759566 (no previous merge yet)
[S6] round=23 local utility u=1.000000 metrics={'f1_val': 0.9832535186387424, 'auprc': 0.9744035425251087, 'loss_val': 0.1248632073181025, 'psi': 0.9797135281932889}-{'f1_val': 0.6414112672992318, 'auprc': 0.8096598589471216, 'loss_val': 0.49900282677849295, 'psi': 0.7087107039583878}
[S7] START round=23 head_norm_before_train=1.344416 cos_to_last_merge=0.8310 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.831
[S7] round=23 local utility u=0.000000 metrics={'f1_val': 0.49338278729053675, 'auprc': 0.7826688564582326, 'loss_val': 0.9128000253073341, 'psi': 0.609097214957615}-{'f1_val': 0.6415598327120212, 'auprc': 0.8294542966210475, 'loss_val': 0.47234723744850854, 'psi': 0.7167176182756317}
[S8] START round=23 head_norm_before_train=1.538710 cos_to_last_merge=0.7866 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.787
[S8] round=23 local utility u=1.000000 metrics={'f1_val': 0.9890749152454698, 'auprc': 0.9965909775856183, 'loss_val': 0.07031116380032654, 'psi': 0.9920813401815292}-{'f1_val': 0.7142391053978291, 'auprc': 0.9865937241175375, 'loss_val': 0.41358100489888877, 'psi': 0.8231809528857126}
[S9] START round=23 head_norm_before_train=1.278021 cos_to_last_merge=0.9993 (last merge round=21)
[S9] round=23 local utility u=0.000000 metrics={'f1_val': 0.938219811008719, 'auprc': 0.9752819414115219, 'loss_val': 0.13118576164771364, 'psi': 0.9530446631698402}-{'f1_val': 0.9962500947792776, 'auprc': 0.99069437608058, 'loss_val': 0.07914253007884062, 'psi': 0.9940278072997986}
[S10] START round=23 head_norm_before_train=0.956392 cos_to_last_merge=0.9714 (last merge round=20)
[S10] round=23 local utility u=0.062577 metrics={'f1_val': 0.9927344652802075, 'auprc': 0.9949668448972406, 'loss_val': 0.28027105718412365, 'psi': 0.9936274171270207}-{'f1_val': 0.9920785626156365, 'auprc': 0.9948581338650193, 'loss_val': 0.4011642684318228, 'psi': 0.9931903911153896}
[S11] START round=23 head_norm_before_train=1.211657 cos_to_last_merge=0.9984 (last merge round=21)
[S11] round=23 local utility u=0.022075 metrics={'f1_val': 0.996960829744628, 'auprc': 0.99787079858938, 'loss_val': 0.14092414594900782, 'psi': 0.9973248172825288}-{'f1_val': 0.9967189926998994, 'auprc': 0.9979062211491819, 'loss_val': 0.18372913364735893, 'psi': 0.9971938840796124}
[S13] START round=23 head_norm_before_train=1.055724 cos_to_last_merge=0.9989 (last merge round=21)
[S13] round=23 local utility u=0.022176 metrics={'f1_val': 0.5932880335478934, 'auprc': 0.5525212695856578, 'loss_val': 0.7459430534020164, 'psi': 0.5769813279629992}-{'f1_val': 0.5452557514028291, 'auprc': 0.6631320769489936, 'loss_val': 0.8339337610666513, 'psi': 0.5924062816212949}
[S14] START round=23 head_norm_before_train=1.376351 cos_to_last_merge=0.9991 (last merge round=21)
[S14] round=23 local utility u=0.012541 metrics={'f1_val': 0.9953280742010686, 'auprc': 0.9953598336239932, 'loss_val': 0.14716960617191543, 'psi': 0.9953407779702385}-{'f1_val': 0.997240356705793, 'auprc': 0.9971786507526424, 'loss_val': 0.18918221532703558, 'psi': 0.9972156743245328}
[S15] START round=23 head_norm_before_train=1.422007 cos_to_last_merge=0.9954 (last merge round=20)
[S15] round=23 local utility u=0.000000 metrics={'f1_val': 0.7705627735224987, 'auprc': 0.9922473883030896, 'loss_val': 0.2687535140809068, 'psi': 0.8592366194347351}-{'f1_val': 0.8355512276154917, 'auprc': 0.9905273263507339, 'loss_val': 0.2302475214441378, 'psi': 0.8975416671095886}
[S16] START round=23 head_norm_before_train=1.556199 cos_to_last_merge=0.9995 (last merge round=21)
[S16] round=23 local utility u=0.000000 metrics={'f1_val': 0.828971410088945, 'auprc': 0.9045437302329495, 'loss_val': 0.8429004673979252, 'psi': 0.8592003381465468}-{'f1_val': 0.9233444216750661, 'auprc': 0.9821386370184816, 'loss_val': 0.3411492949783679, 'psi': 0.9468621078124324}
[S17] START round=23 head_norm_before_train=1.000977 cos_to_last_merge=1.0000 (last merge round=22)
[S17] round=23 local utility u=0.000000 metrics={'f1_val': 0.3703855192702583, 'auprc': 0.7876647940984691, 'loss_val': 0.9231786797168283, 'psi': 0.5372972292015427}-{'f1_val': 0.574771332232126, 'auprc': 0.8675212555398388, 'loss_val': 0.80659314458444, 'psi': 0.6918713015552111}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:42010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:42015
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:42017
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:42004
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:42013
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:42011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] → sending delta(kind=head bytes=1793) to S11@127.0.0.1:42012
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:42003
[S13] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1794 to 1 peers)
[S6] sending update (kind=head size=1793 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1794) from S3
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=0.969422)
[S9] loaded HEAD from S3 (vec_in norm=0.969422)
[S9] cosine check vs S3: cos=0.8896
[S9] BUFFERED delta from S3 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1804) from S10
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.027691)
[S3] loaded HEAD from S10 (vec_in norm=1.027691)
[S3] cosine check vs S10: cos=0.7619
[S3] BUFFERED delta from S10 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1803) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.556979)
[S17] loaded HEAD from S8 (vec_in norm=1.556979)
[S17] cosine check vs S8: cos=0.4652
[S17] BUFFERED delta from S8 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1801) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.422068)
[S15] loaded HEAD from S14 (vec_in norm=1.422068)
[S15] cosine check vs S14: cos=0.9647
[S15] BUFFERED delta from S14 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1793) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.769842)
[S11] loaded HEAD from S6 (vec_in norm=1.769842)
[S11] cosine check vs S6: cos=0.7657
[S11] BUFFERED delta from S6 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1800) from S13
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.081309)
[S4] loaded HEAD from S13 (vec_in norm=1.081309)
[S4] cosine check vs S13: cos=0.9521
[S4] BUFFERED delta from S13 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1802) from S4
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.134277)
[S10] loaded HEAD from S4 (vec_in norm=1.134277)
[S10] cosine check vs S4: cos=0.7670
[S10] BUFFERED delta from S4 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1801) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.258596)
[S13] loaded HEAD from S11 (vec_in norm=1.258596)
[S13] cosine check vs S11: cos=0.6752
[S13] BUFFERED delta from S11 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=23 metric=0.9382 head_norm=1.326933
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.208971e-01
[S9] stored merged vector for next round verification (round=23)
[S9] DEBUG after merge:  round=23 metric=0.9382 head_norm=1.116822 delta_norm=0.320897
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=23 metric=0.7706 head_norm=1.459435
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.922536e-01
[S15] stored merged vector for next round verification (round=23)
[S15] DEBUG after merge:  round=23 metric=0.7680 head_norm=1.427989 delta_norm=0.192254
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=23 metric=0.9970 head_norm=1.258596
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.711834e-01
[S11] stored merged vector for next round verification (round=23)
[S11] DEBUG after merge:  round=23 metric=0.9970 head_norm=1.425465 delta_norm=0.571183
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=23 metric=0.9697 head_norm=0.969422
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.455943e-01
[S3] stored merged vector for next round verification (round=23)
[S3] DEBUG after merge:  round=23 metric=0.9738 head_norm=0.937298 delta_norm=0.345594
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=23 metric=0.9927 head_norm=1.027691
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.723641e-01
[S10] stored merged vector for next round verification (round=23)
[S10] DEBUG after merge:  round=23 metric=0.9922 head_norm=1.016224 delta_norm=0.372364
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=23 metric=0.5933 head_norm=1.081309
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.784192e-01
[S13] stored merged vector for next round verification (round=23)
[S13] DEBUG after merge:  round=23 metric=0.6103 head_norm=1.071336 delta_norm=0.478419
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=23 metric=0.9469 head_norm=1.134277
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.733624e-01
[S4] stored merged vector for next round verification (round=23)
[S4] DEBUG after merge:  round=23 metric=0.9480 head_norm=1.094465 delta_norm=0.173362
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=23 metric=0.3704 head_norm=1.029432
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.058044e-01
[S17] stored merged vector for next round verification (round=23)
[S17] DEBUG after merge:  round=23 metric=0.3693 head_norm=1.115256 delta_norm=0.705804
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.613032 cos_to_last_merge=0.8203 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.820
[S2] round=24 local utility u=0.000000 metrics={'f1_val': 0.7138113459483089, 'auprc': 0.7724702427168597, 'loss_val': 0.761711287392176, 'psi': 0.7372749046557292}-{'f1_val': 0.71146142054669, 'auprc': 0.7754345596141216, 'loss_val': 0.7375190114964688, 'psi': 0.7370506761736626}
[S3] START round=24 head_norm_before_train=0.937298 cos_to_last_merge=1.0000 (last merge round=23)
[S3] round=24 local utility u=0.084153 metrics={'f1_val': 0.9977533136161222, 'auprc': 0.9986290219488057, 'loss_val': 0.22532213685696187, 'psi': 0.9981035969491956}-{'f1_val': 0.969687363177882, 'auprc': 0.9989014688529811, 'loss_val': 0.22605021819479168, 'psi': 0.9813730054479216}
[S4] START round=24 head_norm_before_train=1.094465 cos_to_last_merge=1.0000 (last merge round=23)
[S4] round=24 local utility u=0.000000 metrics={'f1_val': 0.9481094190640977, 'auprc': 0.9030870579766803, 'loss_val': 0.3873593202535305, 'psi': 0.9301004746291307}-{'f1_val': 0.9468657936189846, 'auprc': 0.9332383510227353, 'loss_val': 0.37126777925328985, 'psi': 0.9414148165804849}
[S5] START round=24 head_norm_before_train=1.508321 cos_to_last_merge=0.8139 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.814
[S5] round=24 local utility u=0.356542 metrics={'f1_val': 0.6763421186092394, 'auprc': 0.9461291735934194, 'loss_val': 0.2894607478903257, 'psi': 0.7842569406029114}-{'f1_val': 0.630591881738325, 'auprc': 0.8593785627913287, 'loss_val': 0.46779136988425557, 'psi': 0.7221065541595265}
[S6] START round=24 head_norm_before_train=1.769842 (no previous merge yet)
[S6] round=24 local utility u=0.000000 metrics={'f1_val': 0.8273943903621335, 'auprc': 0.9205013541052376, 'loss_val': 0.33986817300790845, 'psi': 0.8646371758593752}-{'f1_val': 0.9832535186387424, 'auprc': 0.9744035425251087, 'loss_val': 0.1248632073181025, 'psi': 0.9797135281932889}
[S7] START round=24 head_norm_before_train=1.356301 cos_to_last_merge=0.8293 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.829
[S7] round=24 local utility u=0.000000 metrics={'f1_val': 0.45444281807326925, 'auprc': 0.7821209327691989, 'loss_val': 0.9804514937561315, 'psi': 0.5855140639516412}-{'f1_val': 0.49338278729053675, 'auprc': 0.7826688564582326, 'loss_val': 0.9128000253073341, 'psi': 0.609097214957615}
[S8] START round=24 head_norm_before_train=1.556979 cos_to_last_merge=0.7839 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.784
[S8] round=24 local utility u=0.025755 metrics={'f1_val': 0.993919739519144, 'auprc': 0.9990846830968352, 'loss_val': 0.05535195166221716, 'psi': 0.9959857169502205}-{'f1_val': 0.9890749152454698, 'auprc': 0.9965909775856183, 'loss_val': 0.07031116380032654, 'psi': 0.9920813401815292}
[S9] START round=24 head_norm_before_train=1.116822 cos_to_last_merge=1.0000 (last merge round=23)
[S9] round=24 local utility u=0.214883 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9921043545069903, 'loss_val': 0.10006897628922794, 'psi': 0.9945917986703627}-{'f1_val': 0.938219811008719, 'auprc': 0.9752819414115219, 'loss_val': 0.13118576164771364, 'psi': 0.9530446631698402}
[S10] START round=24 head_norm_before_train=1.016224 cos_to_last_merge=1.0000 (last merge round=23)
[S10] round=24 local utility u=0.000000 metrics={'f1_val': 0.9926168664315407, 'auprc': 0.991718923768854, 'loss_val': 0.39271382784492015, 'psi': 0.992257689366466}-{'f1_val': 0.9927344652802075, 'auprc': 0.9949668448972406, 'loss_val': 0.28027105718412365, 'psi': 0.9936274171270207}
[S11] START round=24 head_norm_before_train=1.425465 cos_to_last_merge=1.0000 (last merge round=23)
[S11] round=24 local utility u=0.010695 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9975808940122303, 'loss_val': 0.11473056171210942, 'psi': 0.9968154580862087}-{'f1_val': 0.996960829744628, 'auprc': 0.99787079858938, 'loss_val': 0.14092414594900782, 'psi': 0.9973248172825288}
[S13] START round=24 head_norm_before_train=1.071336 cos_to_last_merge=1.0000 (last merge round=23)
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.5645794878919397, 'auprc': 0.6433836323344518, 'loss_val': 0.8897978493817664, 'psi': 0.5961011456689446}-{'f1_val': 0.5932880335478934, 'auprc': 0.5525212695856578, 'loss_val': 0.7459430534020164, 'psi': 0.5769813279629992}
[S14] START round=24 head_norm_before_train=1.422068 cos_to_last_merge=0.9961 (last merge round=21)
[S14] round=24 local utility u=0.024944 metrics={'f1_val': 0.9967774409524363, 'auprc': 0.9964146606894966, 'loss_val': 0.10914305435810291, 'psi': 0.9966323288472604}-{'f1_val': 0.9953280742010686, 'auprc': 0.9953598336239932, 'loss_val': 0.14716960617191543, 'psi': 0.9953407779702385}
[S15] START round=24 head_norm_before_train=1.427989 cos_to_last_merge=1.0000 (last merge round=23)
[S15] round=24 local utility u=0.000000 metrics={'f1_val': 0.6834397264897993, 'auprc': 0.9807551884930795, 'loss_val': 0.4597852250533905, 'psi': 0.8023659112911115}-{'f1_val': 0.7705627735224987, 'auprc': 0.9922473883030896, 'loss_val': 0.2687535140809068, 'psi': 0.8592366194347351}
[S16] START round=24 head_norm_before_train=1.590460 cos_to_last_merge=0.9984 (last merge round=21)
[S16] round=24 local utility u=0.966734 metrics={'f1_val': 0.9885370177532451, 'auprc': 0.9855351675510665, 'loss_val': 0.1098000738935277, 'psi': 0.9873362776723736}-{'f1_val': 0.828971410088945, 'auprc': 0.9045437302329495, 'loss_val': 0.8429004673979252, 'psi': 0.8592003381465468}
[S17] START round=24 head_norm_before_train=1.115256 cos_to_last_merge=1.0000 (last merge round=23)
[S17] round=24 local utility u=0.217889 metrics={'f1_val': 0.49241305582630324, 'auprc': 0.6539252562289548, 'loss_val': 0.8183473952455658, 'psi': 0.5570179359873638}-{'f1_val': 0.3703855192702583, 'auprc': 0.7876647940984691, 'loss_val': 0.9231786797168283, 'psi': 0.5372972292015427}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:42010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:42013
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] → sending delta(kind=head bytes=1793) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:42016
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:42015
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1793 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1797) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.521461)
[S16] loaded HEAD from S5 (vec_in norm=1.521461)
[S16] cosine check vs S5: cos=0.9895
[S16] BUFFERED delta from S5 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1796) from S3
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.027785)
[S9] loaded HEAD from S3 (vec_in norm=1.027785)
[S9] cosine check vs S3: cos=0.8736
[S9] BUFFERED delta from S3 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1801) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.577808)
[S17] loaded HEAD from S8 (vec_in norm=1.577808)
[S17] cosine check vs S8: cos=0.9012
[S17] BUFFERED delta from S8 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1793) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.169095)
[S17] loaded HEAD from S9 (vec_in norm=1.169095)
[S17] cosine check vs S9: cos=0.4628
[S17] BUFFERED delta from S9 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1799) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.466796)
[S15] loaded HEAD from S14 (vec_in norm=1.466796)
[S15] cosine check vs S14: cos=0.9883
[S15] BUFFERED delta from S14 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1800) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.464410)
[S13] loaded HEAD from S11 (vec_in norm=1.464410)
[S13] cosine check vs S11: cos=0.8309
[S13] BUFFERED delta from S11 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S17] → sending delta(kind=head bytes=1792) to S3@127.0.0.1:42003
[S17] sending update (kind=head size=1792 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1792) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.133590)
[S3] loaded HEAD from S17 (vec_in norm=1.133590)
[S3] cosine check vs S17: cos=0.4238
[S3] BUFFERED delta from S17 (total buffered=1)
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1799) from S16
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.620039)
[S17] loaded HEAD from S16 (vec_in norm=1.620039)
[S17] cosine check vs S16: cos=0.4177
[S17] BUFFERED delta from S16 (total buffered=3)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=24 metric=0.9978 head_norm=1.027785
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.817944e-01
[S3] stored merged vector for next round verification (round=24)
[S3] DEBUG after merge:  round=24 metric=0.9978 head_norm=0.912249 delta_norm=0.581794
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=24 metric=0.9885 head_norm=1.620039
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.240297e-01
[S16] stored merged vector for next round verification (round=24)
[S16] DEBUG after merge:  round=24 metric=0.9885 head_norm=1.566621 delta_norm=0.124030
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=24 metric=0.9963 head_norm=1.169095
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.845024e-01
[S9] stored merged vector for next round verification (round=24)
[S9] DEBUG after merge:  round=24 metric=0.9963 head_norm=1.063307 delta_norm=0.284502
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=24 metric=0.5646 head_norm=1.090774
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.123040e-01
[S13] stored merged vector for next round verification (round=24)
[S13] DEBUG after merge:  round=24 metric=0.5625 head_norm=1.223580 delta_norm=0.412304
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=24 metric=0.6834 head_norm=1.457701
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.121594e-01
[S15] stored merged vector for next round verification (round=24)
[S15] DEBUG after merge:  round=24 metric=0.6827 head_norm=1.457948 delta_norm=0.112159
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=24 metric=0.4924 head_norm=1.133590
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.453771e-01
[S17] stored merged vector for next round verification (round=24)
[S17] DEBUG after merge:  round=24 metric=0.4724 head_norm=1.004594 delta_norm=0.345377
[S17] aggregate: ROLLBACK (f1_val pre=0.492 post=0.472 tol_abs=0.005 tol_rel=0.0)
[S2] START round=25 head_norm_before_train=1.623409 cos_to_last_merge=0.8191 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.819
[S2] round=25 local utility u=0.008354 metrics={'f1_val': 0.7125364917458679, 'auprc': 0.7696761057834358, 'loss_val': 0.7289713850017912, 'psi': 0.735392337360895}-{'f1_val': 0.7138113459483089, 'auprc': 0.7724702427168597, 'loss_val': 0.761711287392176, 'psi': 0.7372749046557292}
[S3] START round=25 head_norm_before_train=0.912249 cos_to_last_merge=1.0000 (last merge round=24)
[S3] round=25 local utility u=0.000000 metrics={'f1_val': 0.960995754132836, 'auprc': 0.9985603050878304, 'loss_val': 0.237691899541999, 'psi': 0.9760215745148338}-{'f1_val': 0.9977533136161222, 'auprc': 0.9986290219488057, 'loss_val': 0.22532213685696187, 'psi': 0.9981035969491956}
[S4] START round=25 head_norm_before_train=1.130854 cos_to_last_merge=0.9980 (last merge round=23)
[S4] round=25 local utility u=0.036159 metrics={'f1_val': 0.9402262207442962, 'auprc': 0.9301146989748533, 'loss_val': 0.3488243273841097, 'psi': 0.936181612036519}-{'f1_val': 0.9481094190640977, 'auprc': 0.9030870579766803, 'loss_val': 0.3873593202535305, 'psi': 0.9301004746291307}
[S5] START round=25 head_norm_before_train=1.521461 cos_to_last_merge=0.8131 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.813
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.6137005500091294, 'auprc': 0.8552762682893825, 'loss_val': 0.6059607491360245, 'psi': 0.7103308373212307}-{'f1_val': 0.6763421186092394, 'auprc': 0.9461291735934194, 'loss_val': 0.2894607478903257, 'psi': 0.7842569406029114}
[S6] START round=25 head_norm_before_train=1.783918 (no previous merge yet)
[S6] round=25 local utility u=0.462994 metrics={'f1_val': 0.9376187143932552, 'auprc': 0.9563528922911384, 'loss_val': 0.18278002936433124, 'psi': 0.9451123855524085}-{'f1_val': 0.8273943903621335, 'auprc': 0.9205013541052376, 'loss_val': 0.33986817300790845, 'psi': 0.8646371758593752}
[S7] START round=25 head_norm_before_train=1.370100 cos_to_last_merge=0.8266 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.827
[S7] round=25 local utility u=0.728991 metrics={'f1_val': 0.6210752274430715, 'auprc': 0.8008564959459042, 'loss_val': 0.5784697551315383, 'psi': 0.6929877348442046}-{'f1_val': 0.45444281807326925, 'auprc': 0.7821209327691989, 'loss_val': 0.9804514937561315, 'psi': 0.5855140639516412}
[S8] START round=25 head_norm_before_train=1.577808 cos_to_last_merge=0.7810 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.781
[S8] round=25 local utility u=0.001496 metrics={'f1_val': 0.993919739519144, 'auprc': 0.9988115906503047, 'loss_val': 0.0515399853058675, 'psi': 0.9958764799716083}-{'f1_val': 0.993919739519144, 'auprc': 0.9990846830968352, 'loss_val': 0.05535195166221716, 'psi': 0.9959857169502205}
[S9] START round=25 head_norm_before_train=1.063307 cos_to_last_merge=1.0000 (last merge round=24)
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.9891106000703147, 'auprc': 0.9883183266151696, 'loss_val': 0.13273369435070687, 'psi': 0.9887936906882566}-{'f1_val': 0.9962500947792776, 'auprc': 0.9921043545069903, 'loss_val': 0.10006897628922794, 'psi': 0.9945917986703627}
[S10] START round=25 head_norm_before_train=1.066802 cos_to_last_merge=0.9937 (last merge round=23)
[S10] round=25 local utility u=0.066541 metrics={'f1_val': 0.9928357895898154, 'auprc': 0.992503092059893, 'loss_val': 0.26329781432122107, 'psi': 0.9927027105778465}-{'f1_val': 0.9926168664315407, 'auprc': 0.991718923768854, 'loss_val': 0.39271382784492015, 'psi': 0.992257689366466}
[S11] START round=25 head_norm_before_train=1.464410 cos_to_last_merge=0.9994 (last merge round=23)
[S11] round=25 local utility u=0.010705 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9974075579290738, 'loss_val': 0.09425096878943408, 'psi': 0.9968912258797833}-{'f1_val': 0.996305167468861, 'auprc': 0.9975808940122303, 'loss_val': 0.11473056171210942, 'psi': 0.9968154580862087}
[S13] START round=25 head_norm_before_train=1.223580 cos_to_last_merge=1.0000 (last merge round=24)
[S13] round=25 local utility u=0.113869 metrics={'f1_val': 0.5973884137034999, 'auprc': 0.6383765482107094, 'loss_val': 0.8438927783405188, 'psi': 0.6137836675063837}-{'f1_val': 0.5645794878919397, 'auprc': 0.6433836323344518, 'loss_val': 0.8897978493817664, 'psi': 0.5961011456689446}
[S14] START round=25 head_norm_before_train=1.466796 cos_to_last_merge=0.9918 (last merge round=21)
[S14] round=25 local utility u=0.004058 metrics={'f1_val': 0.995965419164117, 'auprc': 0.9955120313991757, 'loss_val': 0.09344730112112984, 'psi': 0.9957840640581404}-{'f1_val': 0.9967774409524363, 'auprc': 0.9964146606894966, 'loss_val': 0.10914305435810291, 'psi': 0.9966323288472604}
[S15] START round=25 head_norm_before_train=1.457948 cos_to_last_merge=1.0000 (last merge round=24)
[S15] round=25 local utility u=0.902706 metrics={'f1_val': 0.9337989485803702, 'auprc': 0.9932606582860142, 'loss_val': 0.19404466243835047, 'psi': 0.9575836324626278}-{'f1_val': 0.6834397264897993, 'auprc': 0.9807551884930795, 'loss_val': 0.4597852250533905, 'psi': 0.8023659112911115}
[S16] START round=25 head_norm_before_train=1.566621 cos_to_last_merge=1.0000 (last merge round=24)
[S16] round=25 local utility u=0.000000 metrics={'f1_val': 0.9358952363051458, 'auprc': 0.9897102987542197, 'loss_val': 0.27597603336604215, 'psi': 0.9574212612847753}-{'f1_val': 0.9885370177532451, 'auprc': 0.9855351675510665, 'loss_val': 0.1098000738935277, 'psi': 0.9873362776723736}
[S17] START round=25 head_norm_before_train=1.004594 cos_to_last_merge=1.0000 (last merge round=24)
[S17] round=25 local utility u=0.000000 metrics={'f1_val': 0.3711928268339176, 'auprc': 0.7948760074704696, 'loss_val': 0.9991308347132963, 'psi': 0.5406660990885385}-{'f1_val': 0.49241305582630324, 'auprc': 0.6539252562289548, 'loss_val': 0.8183473952455658, 'psi': 0.5570179359873638}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:42014
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:42012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:42013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S13] → sending delta(kind=head bytes=1792) to S4@127.0.0.1:42004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:42003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:42015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:42017
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] → sending delta(kind=head bytes=1805) to S13@127.0.0.1:42013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:42011
[S8] sending update (kind=head size=1805 to 1 peers)
[S11] sending update (kind=head size=1805 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1792 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1805) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.500715)
[S13] loaded HEAD from S11 (vec_in norm=1.500715)
[S13] cosine check vs S11: cos=0.9610
[S13] BUFFERED delta from S11 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1802) from S2
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.633792)
[S13] loaded HEAD from S2 (vec_in norm=1.633792)
[S13] cosine check vs S2: cos=0.1954
[S13] BUFFERED delta from S2 (total buffered=2)
[S11] RECEIVED delta(kind=head bytes=1798) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.798881)
[S11] loaded HEAD from S6 (vec_in norm=1.798881)
[S11] cosine check vs S6: cos=0.9481
[S11] BUFFERED delta from S6 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1800) from S10
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.131499)
[S3] loaded HEAD from S10 (vec_in norm=1.131499)
[S3] cosine check vs S10: cos=0.5993
[S3] BUFFERED delta from S10 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1798) from S4
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.178969)
[S10] loaded HEAD from S4 (vec_in norm=1.178969)
[S10] cosine check vs S4: cos=0.8589
[S10] BUFFERED delta from S4 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1792) from S13
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.246930)
[S4] loaded HEAD from S13 (vec_in norm=1.246930)
[S4] cosine check vs S13: cos=0.7070
[S4] BUFFERED delta from S13 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1805) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.601458)
[S17] loaded HEAD from S8 (vec_in norm=1.601458)
[S17] cosine check vs S8: cos=0.7302
[S17] BUFFERED delta from S8 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1801) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.379914)
[S14] loaded HEAD from S7 (vec_in norm=1.379914)
[S14] cosine check vs S7: cos=0.9196
[S14] BUFFERED delta from S7 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1799) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.504277)
[S15] loaded HEAD from S14 (vec_in norm=1.504277)
[S15] cosine check vs S14: cos=0.9947
[S15] BUFFERED delta from S14 (total buffered=1)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:42012
[S15] sending update (kind=head size=1801 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1801) from S15
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.484385)
[S11] loaded HEAD from S15 (vec_in norm=1.484385)
[S11] cosine check vs S15: cos=0.3679
[S11] BUFFERED delta from S15 (total buffered=2)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] ⇄ pheromone p=0.151 → S16@127.0.0.1:42016
[S8] ⇄ pheromone p=0.274 → S17@127.0.0.1:42017
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=25 metric=0.9402 head_norm=1.178969
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.652923e-01
[S4] stored merged vector for next round verification (round=25)
[S4] DEBUG after merge:  round=25 metric=0.9409 head_norm=1.120671 delta_norm=0.465292
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.066 → S10@127.0.0.1:42011
[S2] ⇄ pheromone p=0.031 → S13@127.0.0.1:42013
[S7] ⇄ pheromone p=0.301 → S14@127.0.0.1:42014
[S6] ⇄ pheromone p=0.386 → S11@127.0.0.1:42012
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=25 metric=0.9928 head_norm=1.131499
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.077445e-01
[S10] stored merged vector for next round verification (round=25)
[S10] DEBUG after merge:  round=25 metric=0.9924 head_norm=1.113742 delta_norm=0.307744
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.078 → S3@127.0.0.1:42003
[S9] ⇄ pheromone p=0.053 → S17@127.0.0.1:42017
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=25 metric=0.5974 head_norm=1.246930
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.728087e-01
[S13] stored merged vector for next round verification (round=25)
[S13] DEBUG after merge:  round=25 metric=0.5994 head_norm=1.112285 delta_norm=0.372809
[S13] aggregate: ACCEPT kept=['S11', 'S2'] (k=2/2) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.121 → S4@127.0.0.1:42004
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=25 metric=0.3712 head_norm=1.026724
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.517407e-01
[S17] stored merged vector for next round verification (round=25)
[S17] DEBUG after merge:  round=25 metric=0.3716 head_norm=1.226784 delta_norm=0.551741
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.130 → S3@127.0.0.1:42003
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=25 metric=0.9965 head_norm=1.500715
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.034202e-01
[S11] stored merged vector for next round verification (round=25)
[S11] DEBUG after merge:  round=25 metric=0.9965 head_norm=1.334795 delta_norm=0.303420
[S11] aggregate: ACCEPT kept=['S6', 'S15'] (k=2/2) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.084 → S13@127.0.0.1:42013
[S16] ⇄ pheromone p=0.288 → S17@127.0.0.1:42017
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=25 metric=0.9960 head_norm=1.504277
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.954670e-01
[S14] stored merged vector for next round verification (round=25)
[S14] DEBUG after merge:  round=25 metric=0.9972 head_norm=1.412871 delta_norm=0.295467
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.034 → S15@127.0.0.1:42015
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=25 metric=0.9338 head_norm=1.484385
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.739255e-02
[S15] stored merged vector for next round verification (round=25)
[S15] DEBUG after merge:  round=25 metric=0.9468 head_norm=1.492359 delta_norm=0.077393
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.285 → S11@127.0.0.1:42012
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=25 metric=0.9610 head_norm=1.019169
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.839450e-01
[S3] stored merged vector for next round verification (round=25)
[S3] DEBUG after merge:  round=25 metric=0.9610 head_norm=0.961922 delta_norm=0.483945
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.057 → S9@127.0.0.1:42010
[S2] START round=26 head_norm_before_train=1.633792 cos_to_last_merge=0.8183 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.818
[S2] round=26 local utility u=0.000000 metrics={'f1_val': 0.572908243682422, 'auprc': 0.6602626855031244, 'loss_val': 0.8816348447817788, 'psi': 0.6078500204107029}-{'f1_val': 0.7125364917458679, 'auprc': 0.7696761057834358, 'loss_val': 0.7289713850017912, 'psi': 0.735392337360895}
[S3] START round=26 head_norm_before_train=0.961922 cos_to_last_merge=1.0000 (last merge round=25)
[S3] round=26 local utility u=0.061152 metrics={'f1_val': 0.9808006349781107, 'auprc': 0.9973556535133767, 'loss_val': 0.2306023461435397, 'psi': 0.9874226423922171}-{'f1_val': 0.960995754132836, 'auprc': 0.9985603050878304, 'loss_val': 0.237691899541999, 'psi': 0.9760215745148338}
[S4] START round=26 head_norm_before_train=1.120671 cos_to_last_merge=1.0000 (last merge round=25)
[S4] round=26 local utility u=0.000000 metrics={'f1_val': 0.9422163323573453, 'auprc': 0.9236978308698482, 'loss_val': 0.43945534375995043, 'psi': 0.9348089317623465}-{'f1_val': 0.9402262207442962, 'auprc': 0.9301146989748533, 'loss_val': 0.3488243273841097, 'psi': 0.936181612036519}
[S5] START round=26 head_norm_before_train=1.533095 cos_to_last_merge=0.8123 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.812
[S5] round=26 local utility u=0.330524 metrics={'f1_val': 0.6702043864893842, 'auprc': 0.8827005869689584, 'loss_val': 0.3662090979477473, 'psi': 0.7552028666812138}-{'f1_val': 0.6137005500091294, 'auprc': 0.8552762682893825, 'loss_val': 0.6059607491360245, 'psi': 0.7103308373212307}
[S6] START round=26 head_norm_before_train=1.798881 (no previous merge yet)
[S6] round=26 local utility u=0.000000 metrics={'f1_val': 0.5155461450948958, 'auprc': 0.7259426706088656, 'loss_val': 0.9014123402423029, 'psi': 0.5997047553004837}-{'f1_val': 0.9376187143932552, 'auprc': 0.9563528922911384, 'loss_val': 0.18278002936433124, 'psi': 0.9451123855524085}
[S7] START round=26 head_norm_before_train=1.379914 cos_to_last_merge=0.8248 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.825
[S7] round=26 local utility u=0.000000 metrics={'f1_val': 0.5015199892369364, 'auprc': 0.7825496767520607, 'loss_val': 0.9259401462885696, 'psi': 0.6139318642429861}-{'f1_val': 0.6210752274430715, 'auprc': 0.8008564959459042, 'loss_val': 0.5784697551315383, 'psi': 0.6929877348442046}
[S8] START round=26 head_norm_before_train=1.601458 cos_to_last_merge=0.7772 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.777
[S8] round=26 local utility u=0.000000 metrics={'f1_val': 0.9914588715117574, 'auprc': 0.9989854198100382, 'loss_val': 0.051875864889550524, 'psi': 0.9944694908310696}-{'f1_val': 0.993919739519144, 'auprc': 0.9988115906503047, 'loss_val': 0.0515399853058675, 'psi': 0.9958764799716083}
[S9] START round=26 head_norm_before_train=1.134966 cos_to_last_merge=0.9968 (last merge round=24)
[S9] round=26 local utility u=0.047790 metrics={'f1_val': 0.9924853119792197, 'auprc': 0.9973373148877174, 'loss_val': 0.08445865412198317, 'psi': 0.9944261131426188}-{'f1_val': 0.9891106000703147, 'auprc': 0.9883183266151696, 'loss_val': 0.13273369435070687, 'psi': 0.9887936906882566}
[S10] START round=26 head_norm_before_train=1.113742 cos_to_last_merge=1.0000 (last merge round=25)
[S10] round=26 local utility u=0.000000 metrics={'f1_val': 0.9928357895898154, 'auprc': 0.9934878925205284, 'loss_val': 0.3523293633692869, 'psi': 0.9930966307621006}-{'f1_val': 0.9928357895898154, 'auprc': 0.992503092059893, 'loss_val': 0.26329781432122107, 'psi': 0.9927027105778465}
[S11] START round=26 head_norm_before_train=1.334795 cos_to_last_merge=1.0000 (last merge round=25)
[S11] round=26 local utility u=0.000000 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9977198748545186, 'loss_val': 0.10941144283329696, 'psi': 0.996871050423124}-{'f1_val': 0.9965470045135896, 'auprc': 0.9974075579290738, 'loss_val': 0.09425096878943408, 'psi': 0.9968912258797833}
[S13] START round=26 head_norm_before_train=1.112285 cos_to_last_merge=1.0000 (last merge round=25)
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.5673823294544866, 'auprc': 0.6589434569363519, 'loss_val': 0.8180651992846286, 'psi': 0.6040067804472328}-{'f1_val': 0.5973884137034999, 'auprc': 0.6383765482107094, 'loss_val': 0.8438927783405188, 'psi': 0.6137836675063837}
[S14] START round=26 head_norm_before_train=1.412871 cos_to_last_merge=1.0000 (last merge round=25)
[S14] round=26 local utility u=0.000000 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9974237680955076, 'loss_val': 0.15083514500155273, 'psi': 0.9971680121328022}-{'f1_val': 0.995965419164117, 'auprc': 0.9955120313991757, 'loss_val': 0.09344730112112984, 'psi': 0.9957840640581404}
[S15] START round=26 head_norm_before_train=1.492359 cos_to_last_merge=1.0000 (last merge round=25)
[S15] round=26 local utility u=0.000000 metrics={'f1_val': 0.839931396517176, 'auprc': 0.9928471124040951, 'loss_val': 0.22916352116522531, 'psi': 0.9010976828719437}-{'f1_val': 0.9337989485803702, 'auprc': 0.9932606582860142, 'loss_val': 0.19404466243835047, 'psi': 0.9575836324626278}
[S16] START round=26 head_norm_before_train=1.592338 cos_to_last_merge=0.9998 (last merge round=24)
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.843516627570441, 'auprc': 0.9820872602903629, 'loss_val': 0.7454050378518684, 'psi': 0.8989448806584097}-{'f1_val': 0.9358952363051458, 'auprc': 0.9897102987542197, 'loss_val': 0.27597603336604215, 'psi': 0.9574212612847753}
[S17] START round=26 head_norm_before_train=1.226784 cos_to_last_merge=1.0000 (last merge round=25)
[S17] round=26 local utility u=0.001634 metrics={'f1_val': 0.370666830050042, 'auprc': 0.8069256867292027, 'loss_val': 1.028856066011405, 'psi': 0.5451703727217063}-{'f1_val': 0.3711928268339176, 'auprc': 0.7948760074704696, 'loss_val': 0.9991308347132963, 'psi': 0.5406660990885385}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:42017
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:42010
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:42016
[S3] sending update (kind=head size=1804 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1799) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.221555)
[S17] loaded HEAD from S9 (vec_in norm=1.221555)
[S17] cosine check vs S9: cos=0.3687
[S17] BUFFERED delta from S9 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1799) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.541877)
[S16] loaded HEAD from S5 (vec_in norm=1.541877)
[S16] cosine check vs S5: cos=0.9937
[S16] BUFFERED delta from S5 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1804) from S3
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.056307)
[S9] loaded HEAD from S3 (vec_in norm=1.056307)
[S9] cosine check vs S3: cos=0.8652
[S9] BUFFERED delta from S3 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] → sending delta(kind=head bytes=1793) to S3@127.0.0.1:42003
[S17] sending update (kind=head size=1793 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1793) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.241814)
[S3] loaded HEAD from S17 (vec_in norm=1.241814)
[S3] cosine check vs S17: cos=0.5528
[S3] BUFFERED delta from S17 (total buffered=1)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=26 metric=0.9808 head_norm=1.056307
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.494408e-01
[S3] stored merged vector for next round verification (round=26)
[S3] DEBUG after merge:  round=26 metric=0.9755 head_norm=1.013439 delta_norm=0.549441
[S3] aggregate: ROLLBACK (f1_val pre=0.981 post=0.976 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=26 metric=0.9925 head_norm=1.221555
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.062764e-01
[S9] stored merged vector for next round verification (round=26)
[S9] DEBUG after merge:  round=26 metric=0.9925 head_norm=1.100084 delta_norm=0.306276
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=26 metric=0.8435 head_norm=1.619145
[S16] _apply_head_vector_avg (torch): Δ‖w‖=9.677310e-02
[S16] stored merged vector for next round verification (round=26)
[S16] DEBUG after merge:  round=26 metric=0.8437 head_norm=1.578019 delta_norm=0.096773
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=26 metric=0.3707 head_norm=1.241814
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.920651e-01
[S17] stored merged vector for next round verification (round=26)
[S17] DEBUG after merge:  round=26 metric=0.3704 head_norm=1.018919 delta_norm=0.692065
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.642894 cos_to_last_merge=0.8172 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.817
[S2] round=27 local utility u=0.277336 metrics={'f1_val': 0.6437442786859917, 'auprc': 0.7533390595496869, 'loss_val': 1.0312072191786812, 'psi': 0.6875821910314698}-{'f1_val': 0.572908243682422, 'auprc': 0.6602626855031244, 'loss_val': 0.8816348447817788, 'psi': 0.6078500204107029}
[S3] START round=27 head_norm_before_train=1.013439 cos_to_last_merge=1.0000 (last merge round=26)
[S3] round=27 local utility u=0.017637 metrics={'f1_val': 0.982682937499592, 'auprc': 0.9983241427908089, 'loss_val': 0.2095281180419086, 'psi': 0.9889394196160788}-{'f1_val': 0.9808006349781107, 'auprc': 0.9973556535133767, 'loss_val': 0.2306023461435397, 'psi': 0.9874226423922171}
[S4] START round=27 head_norm_before_train=1.159461 cos_to_last_merge=0.9969 (last merge round=25)
[S4] round=27 local utility u=0.097268 metrics={'f1_val': 0.9479119599658455, 'auprc': 0.9485234733330263, 'loss_val': 0.353569133114926, 'psi': 0.9481565653127179}-{'f1_val': 0.9422163323573453, 'auprc': 0.9236978308698482, 'loss_val': 0.43945534375995043, 'psi': 0.9348089317623465}
[S5] START round=27 head_norm_before_train=1.541877 cos_to_last_merge=0.8116 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.812
[S5] round=27 local utility u=0.000000 metrics={'f1_val': 0.43257799117326656, 'auprc': 0.8542503699065622, 'loss_val': 0.9383654066043776, 'psi': 0.6012469426665848}-{'f1_val': 0.6702043864893842, 'auprc': 0.8827005869689584, 'loss_val': 0.3662090979477473, 'psi': 0.7552028666812138}
[S6] START round=27 head_norm_before_train=1.813854 (no previous merge yet)
[S6] round=27 local utility u=1.000000 metrics={'f1_val': 0.8189616959405442, 'auprc': 0.9110880639511174, 'loss_val': 0.3160402277414653, 'psi': 0.8558122431447734}-{'f1_val': 0.5155461450948958, 'auprc': 0.7259426706088656, 'loss_val': 0.9014123402423029, 'psi': 0.5997047553004837}
[S7] START round=27 head_norm_before_train=1.393310 cos_to_last_merge=0.8221 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.822
[S7] round=27 local utility u=0.227250 metrics={'f1_val': 0.5603698561929352, 'auprc': 0.7845674240026445, 'loss_val': 0.8305934573686344, 'psi': 0.650048883316819}-{'f1_val': 0.5015199892369364, 'auprc': 0.7825496767520607, 'loss_val': 0.9259401462885696, 'psi': 0.6139318642429861}
[S8] START round=27 head_norm_before_train=1.622543 cos_to_last_merge=0.7738 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.774
[S8] round=27 local utility u=0.000000 metrics={'f1_val': 0.9927720833909908, 'auprc': 0.9891561951745446, 'loss_val': 0.06595413765939064, 'psi': 0.9913257281044123}-{'f1_val': 0.9914588715117574, 'auprc': 0.9989854198100382, 'loss_val': 0.051875864889550524, 'psi': 0.9944694908310696}
[S9] START round=27 head_norm_before_train=1.100084 cos_to_last_merge=1.0000 (last merge round=26)
[S9] round=27 local utility u=0.000000 metrics={'f1_val': 0.9958601375429889, 'auprc': 0.9987564337878334, 'loss_val': 0.10906770182325336, 'psi': 0.9970186560409267}-{'f1_val': 0.9924853119792197, 'auprc': 0.9973373148877174, 'loss_val': 0.08445865412198317, 'psi': 0.9944261131426188}
[S10] START round=27 head_norm_before_train=1.158950 cos_to_last_merge=0.9954 (last merge round=25)
[S10] round=27 local utility u=0.059199 metrics={'f1_val': 0.9927344652802075, 'auprc': 0.9946706459702214, 'loss_val': 0.23687135957551841, 'psi': 0.9935089375562131}-{'f1_val': 0.9928357895898154, 'auprc': 0.9934878925205284, 'loss_val': 0.3523293633692869, 'psi': 0.9930966307621006}
[S11] START round=27 head_norm_before_train=1.372804 cos_to_last_merge=0.9994 (last merge round=25)
[S11] round=27 local utility u=0.011822 metrics={'f1_val': 0.9967189926998994, 'auprc': 0.9979376048046721, 'loss_val': 0.08890412305382472, 'psi': 0.9972064375418084}-{'f1_val': 0.996305167468861, 'auprc': 0.9977198748545186, 'loss_val': 0.10941144283329696, 'psi': 0.996871050423124}
[S13] START round=27 head_norm_before_train=1.144199 cos_to_last_merge=0.9983 (last merge round=25)
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.5472002181786972, 'auprc': 0.6586571059605613, 'loss_val': 0.8605660101214754, 'psi': 0.5917829732914428}-{'f1_val': 0.5673823294544866, 'auprc': 0.6589434569363519, 'loss_val': 0.8180651992846286, 'psi': 0.6040067804472328}
[S14] START round=27 head_norm_before_train=1.440318 cos_to_last_merge=0.9995 (last merge round=25)
[S14] round=27 local utility u=0.008127 metrics={'f1_val': 0.996754531653698, 'auprc': 0.9950683836832003, 'loss_val': 0.12605668450348906, 'psi': 0.9960800724654989}-{'f1_val': 0.9969975081576651, 'auprc': 0.9974237680955076, 'loss_val': 0.15083514500155273, 'psi': 0.9971680121328022}
[S15] START round=27 head_norm_before_train=1.524591 cos_to_last_merge=0.9994 (last merge round=25)
[S15] round=27 local utility u=0.000000 metrics={'f1_val': 0.69651978793496, 'auprc': 0.9526357024785285, 'loss_val': 0.45748414331103515, 'psi': 0.7989661537523874}-{'f1_val': 0.839931396517176, 'auprc': 0.9928471124040951, 'loss_val': 0.22916352116522531, 'psi': 0.9010976828719437}
[S16] START round=27 head_norm_before_train=1.578019 cos_to_last_merge=1.0000 (last merge round=26)
[S16] round=27 local utility u=0.499785 metrics={'f1_val': 0.9321591188736353, 'auprc': 0.9910340165612063, 'loss_val': 0.3045305755993238, 'psi': 0.9557090779486638}-{'f1_val': 0.843516627570441, 'auprc': 0.9820872602903629, 'loss_val': 0.7454050378518684, 'psi': 0.8989448806584097}
[S17] START round=27 head_norm_before_train=1.018919 cos_to_last_merge=1.0000 (last merge round=26)
[S17] round=27 local utility u=0.239590 metrics={'f1_val': 0.39968219269066296, 'auprc': 0.829518468262278, 'loss_val': 0.7915457539497217, 'psi': 0.571616702919309}-{'f1_val': 0.370666830050042, 'auprc': 0.8069256867292027, 'loss_val': 1.028856066011405, 'psi': 0.5451703727217063}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:42011
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:42014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:42013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:42013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:42012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:42015
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:42003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:42010
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1803) from S3
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.109347)
[S9] loaded HEAD from S3 (vec_in norm=1.109347)
[S9] cosine check vs S3: cos=0.8203
[S9] BUFFERED delta from S3 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1797) from S16
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.605381)
[S17] loaded HEAD from S16 (vec_in norm=1.605381)
[S17] cosine check vs S16: cos=0.4035
[S17] BUFFERED delta from S16 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1799) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.411065)
[S13] loaded HEAD from S11 (vec_in norm=1.411065)
[S13] cosine check vs S11: cos=0.8606
[S13] BUFFERED delta from S11 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1803) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.476383)
[S15] loaded HEAD from S14 (vec_in norm=1.476383)
[S15] cosine check vs S14: cos=0.9833
[S15] BUFFERED delta from S14 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1800) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.407279)
[S14] loaded HEAD from S7 (vec_in norm=1.407279)
[S14] cosine check vs S7: cos=0.9624
[S14] BUFFERED delta from S7 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1804) from S10
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.216558)
[S3] loaded HEAD from S10 (vec_in norm=1.216558)
[S3] cosine check vs S10: cos=0.5702
[S3] BUFFERED delta from S10 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1798) from S2
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.651186)
[S13] loaded HEAD from S2 (vec_in norm=1.651186)
[S13] cosine check vs S2: cos=0.4902
[S13] BUFFERED delta from S2 (total buffered=2)
[S11] RECEIVED delta(kind=head bytes=1799) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.824224)
[S11] loaded HEAD from S6 (vec_in norm=1.824224)
[S11] cosine check vs S6: cos=0.8881
[S11] BUFFERED delta from S6 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1800) from S4
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.203852)
[S10] loaded HEAD from S4 (vec_in norm=1.203852)
[S10] cosine check vs S4: cos=0.8924
[S10] BUFFERED delta from S4 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:42003
[S17] sending update (kind=head size=1795 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1795) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.049678)
[S3] loaded HEAD from S17 (vec_in norm=1.049678)
[S3] cosine check vs S17: cos=0.9662
[S3] BUFFERED delta from S17 (total buffered=2)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=27 metric=0.9959 head_norm=1.178021
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.444217e-01
[S9] stored merged vector for next round verification (round=27)
[S9] DEBUG after merge:  round=27 metric=0.9959 head_norm=1.091131 delta_norm=0.344422
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=27 metric=0.5472 head_norm=1.178686
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.275274e-01
[S13] stored merged vector for next round verification (round=27)
[S13] DEBUG after merge:  round=27 metric=0.5443 head_norm=1.115562 delta_norm=0.227527
[S13] aggregate: ACCEPT kept=['S11', 'S2'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=27 metric=0.9968 head_norm=1.476383
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.006072e-01
[S14] stored merged vector for next round verification (round=27)
[S14] DEBUG after merge:  round=27 metric=0.9968 head_norm=1.428225 delta_norm=0.200607
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=27 metric=0.9967 head_norm=1.411065
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.320905e-01
[S11] stored merged vector for next round verification (round=27)
[S11] DEBUG after merge:  round=27 metric=0.9967 head_norm=1.572497 delta_norm=0.432091
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=27 metric=0.9827 head_norm=1.109347
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.712950e-01
[S3] stored merged vector for next round verification (round=27)
[S3] DEBUG after merge:  round=27 metric=0.9827 head_norm=1.010398 delta_norm=0.271295
[S3] aggregate: ACCEPT kept=['S10', 'S17'] (k=2/2) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=27 metric=0.9927 head_norm=1.216558
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.807128e-01
[S10] stored merged vector for next round verification (round=27)
[S10] DEBUG after merge:  round=27 metric=0.9923 head_norm=1.177215 delta_norm=0.280713
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=27 metric=0.6965 head_norm=1.558516
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.444781e-01
[S15] stored merged vector for next round verification (round=27)
[S15] DEBUG after merge:  round=27 metric=0.6960 head_norm=1.511114 delta_norm=0.144478
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=27 metric=0.3997 head_norm=1.049678
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.614495e-01
[S17] stored merged vector for next round verification (round=27)
[S17] DEBUG after merge:  round=27 metric=0.4941 head_norm=1.122377 delta_norm=0.761449
[S17] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=1.651186 cos_to_last_merge=0.8163 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.816
[S2] round=28 local utility u=0.095615 metrics={'f1_val': 0.664371872889203, 'auprc': 0.7509954905078684, 'loss_val': 0.9567128114741313, 'psi': 0.6990213199366692}-{'f1_val': 0.6437442786859917, 'auprc': 0.7533390595496869, 'loss_val': 1.0312072191786812, 'psi': 0.6875821910314698}
[S3] START round=28 head_norm_before_train=1.010398 cos_to_last_merge=1.0000 (last merge round=27)
[S3] round=28 local utility u=0.055403 metrics={'f1_val': 0.996718896605481, 'auprc': 0.9956567926911533, 'loss_val': 0.17493625965056933, 'psi': 0.9962940550397499}-{'f1_val': 0.982682937499592, 'auprc': 0.9983241427908089, 'loss_val': 0.2095281180419086, 'psi': 0.9889394196160788}
[S4] START round=28 head_norm_before_train=1.203852 cos_to_last_merge=0.9892 (last merge round=25)
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.9387983953259185, 'auprc': 0.9236924109237158, 'loss_val': 0.3294001069459754, 'psi': 0.9327560015650374}-{'f1_val': 0.9479119599658455, 'auprc': 0.9485234733330263, 'loss_val': 0.353569133114926, 'psi': 0.9481565653127179}
[S5] START round=28 head_norm_before_train=1.558141 cos_to_last_merge=0.8100 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.810
[S5] round=28 local utility u=1.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.8680789395950474, 'loss_val': 0.4199577220836524, 'psi': 0.7674239349328345}-{'f1_val': 0.43257799117326656, 'auprc': 0.8542503699065622, 'loss_val': 0.9383654066043776, 'psi': 0.6012469426665848}
[S6] START round=28 head_norm_before_train=1.824224 (no previous merge yet)
[S6] round=28 local utility u=0.372938 metrics={'f1_val': 0.9090346644669066, 'auprc': 0.9537332358117442, 'loss_val': 0.23853713198788287, 'psi': 0.9269140930048416}-{'f1_val': 0.8189616959405442, 'auprc': 0.9110880639511174, 'loss_val': 0.3160402277414653, 'psi': 0.8558122431447734}
[S7] START round=28 head_norm_before_train=1.407279 cos_to_last_merge=0.8197 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.820
[S7] round=28 local utility u=0.082085 metrics={'f1_val': 0.5777782507808866, 'auprc': 0.7831238541852559, 'loss_val': 0.766543798480971, 'psi': 0.6599164921426344}-{'f1_val': 0.5603698561929352, 'auprc': 0.7845674240026445, 'loss_val': 0.8305934573686344, 'psi': 0.650048883316819}
[S8] START round=28 head_norm_before_train=1.644259 cos_to_last_merge=0.7701 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.770
[S8] round=28 local utility u=0.000000 metrics={'f1_val': 0.9857540367148059, 'auprc': 0.9991528720813312, 'loss_val': 0.06332987998815037, 'psi': 0.991113570861416}-{'f1_val': 0.9927720833909908, 'auprc': 0.9891561951745446, 'loss_val': 0.06595413765939064, 'psi': 0.9913257281044123}
[S9] START round=28 head_norm_before_train=1.091131 cos_to_last_merge=1.0000 (last merge round=27)
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.9935285262166678, 'auprc': 0.9987062443920708, 'loss_val': 0.11327319217974093, 'psi': 0.9955996134868289}-{'f1_val': 0.9958601375429889, 'auprc': 0.9987564337878334, 'loss_val': 0.10906770182325336, 'psi': 0.9970186560409267}
[S10] START round=28 head_norm_before_train=1.177215 cos_to_last_merge=1.0000 (last merge round=27)
[S10] round=28 local utility u=0.000000 metrics={'f1_val': 0.9923980159513162, 'auprc': 0.9935640773150276, 'loss_val': 0.26424646591391565, 'psi': 0.9928644404968008}-{'f1_val': 0.9927344652802075, 'auprc': 0.9946706459702214, 'loss_val': 0.23687135957551841, 'psi': 0.9935089375562131}
[S11] START round=28 head_norm_before_train=1.572497 cos_to_last_merge=1.0000 (last merge round=27)
[S11] round=28 local utility u=0.005138 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.997432736830872, 'loss_val': 0.07608130888619113, 'psi': 0.9969012974405025}-{'f1_val': 0.9967189926998994, 'auprc': 0.9979376048046721, 'loss_val': 0.08890412305382472, 'psi': 0.9972064375418084}
[S13] START round=28 head_norm_before_train=1.115562 cos_to_last_merge=1.0000 (last merge round=27)
[S13] round=28 local utility u=0.139468 metrics={'f1_val': 0.5869539829653447, 'auprc': 0.6415932774673456, 'loss_val': 0.7689604626622185, 'psi': 0.608809700766145}-{'f1_val': 0.5472002181786972, 'auprc': 0.6586571059605613, 'loss_val': 0.8605660101214754, 'psi': 0.5917829732914428}
[S14] START round=28 head_norm_before_train=1.428225 cos_to_last_merge=1.0000 (last merge round=27)
[S14] round=28 local utility u=0.000000 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9959457791078207, 'loss_val': 0.15202349848183316, 'psi': 0.9969689824730404}-{'f1_val': 0.996754531653698, 'auprc': 0.9950683836832003, 'loss_val': 0.12605668450348906, 'psi': 0.9960800724654989}
[S15] START round=28 head_norm_before_train=1.511114 cos_to_last_merge=1.0000 (last merge round=27)
[S15] round=28 local utility u=1.000000 metrics={'f1_val': 0.9833907871272894, 'auprc': 0.9972860301029072, 'loss_val': 0.15152785558723697, 'psi': 0.9889488843175365}-{'f1_val': 0.69651978793496, 'auprc': 0.9526357024785285, 'loss_val': 0.45748414331103515, 'psi': 0.7989661537523874}
[S16] START round=28 head_norm_before_train=1.605381 cos_to_last_merge=0.9998 (last merge round=26)
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.865980365678579, 'auprc': 0.9895163049068804, 'loss_val': 0.5311152668678579, 'psi': 0.9153947413698995}-{'f1_val': 0.9321591188736353, 'auprc': 0.9910340165612063, 'loss_val': 0.3045305755993238, 'psi': 0.9557090779486638}
[S17] START round=28 head_norm_before_train=1.122377 cos_to_last_merge=1.0000 (last merge round=27)
[S17] round=28 local utility u=0.000000 metrics={'f1_val': 0.3798552400317779, 'auprc': 0.8031456871988161, 'loss_val': 1.0175837632504474, 'psi': 0.5491714188985932}-{'f1_val': 0.39968219269066296, 'auprc': 0.829518468262278, 'loss_val': 0.7915457539497217, 'psi': 0.571616702919309}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:42014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S11@127.0.0.1:42012
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:42016
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:42010
[S3] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1795) from S3
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.098995)
[S9] loaded HEAD from S3 (vec_in norm=1.098995)
[S9] cosine check vs S3: cos=0.9619
[S9] BUFFERED delta from S3 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1801) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.567760)
[S16] loaded HEAD from S5 (vec_in norm=1.567760)
[S16] cosine check vs S5: cos=0.9955
[S16] BUFFERED delta from S5 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1797) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.421484)
[S14] loaded HEAD from S7 (vec_in norm=1.421484)
[S14] cosine check vs S7: cos=0.9837
[S14] BUFFERED delta from S7 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1803) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.831919)
[S11] loaded HEAD from S6 (vec_in norm=1.831919)
[S11] cosine check vs S6: cos=0.9745
[S11] BUFFERED delta from S6 (total buffered=1)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:42013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:42013
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:42004
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:42012
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1799) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.603805)
[S13] loaded HEAD from S11 (vec_in norm=1.603805)
[S13] cosine check vs S11: cos=0.7160
[S13] BUFFERED delta from S11 (total buffered=1)
[S15] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1798) from S13
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.141136)
[S4] loaded HEAD from S13 (vec_in norm=1.141136)
[S4] cosine check vs S13: cos=0.9368
[S4] BUFFERED delta from S13 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1800) from S15
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.537785)
[S11] loaded HEAD from S15 (vec_in norm=1.537785)
[S11] cosine check vs S15: cos=0.2986
[S11] BUFFERED delta from S15 (total buffered=2)
[S13] RECEIVED delta(kind=head bytes=1801) from S2
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.656844)
[S13] loaded HEAD from S2 (vec_in norm=1.656844)
[S13] cosine check vs S2: cos=0.6376
[S13] BUFFERED delta from S2 (total buffered=2)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=28 metric=0.9388 head_norm=1.253103
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.197881e-01
[S4] stored merged vector for next round verification (round=28)
[S4] DEBUG after merge:  round=28 metric=0.9389 head_norm=1.178101 delta_norm=0.219788
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=28 metric=0.5870 head_norm=1.141136
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.185725e-01
[S13] stored merged vector for next round verification (round=28)
[S13] DEBUG after merge:  round=28 metric=0.5822 head_norm=1.127855 delta_norm=0.118573
[S13] aggregate: ACCEPT kept=['S11', 'S2'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=28 metric=0.9977 head_norm=1.464393
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.321781e-01
[S14] stored merged vector for next round verification (round=28)
[S14] DEBUG after merge:  round=28 metric=0.9977 head_norm=1.437032 delta_norm=0.132178
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=28 metric=0.9965 head_norm=1.603805
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.698606e-01
[S11] stored merged vector for next round verification (round=28)
[S11] DEBUG after merge:  round=28 metric=0.9965 head_norm=1.391615 delta_norm=0.369861
[S11] aggregate: ACCEPT kept=['S6', 'S15'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=28 metric=0.9935 head_norm=1.190031
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.641761e-01
[S9] stored merged vector for next round verification (round=28)
[S9] DEBUG after merge:  round=28 metric=0.9935 head_norm=1.133591 delta_norm=0.164176
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=28 metric=0.8660 head_norm=1.629714
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.186183e-02
[S16] stored merged vector for next round verification (round=28)
[S16] DEBUG after merge:  round=28 metric=0.8677 head_norm=1.596940 delta_norm=0.081862
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=1.656844 cos_to_last_merge=0.8157 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.816
[S2] round=29 local utility u=0.000000 metrics={'f1_val': 0.6459864706329722, 'auprc': 0.7502871223240668, 'loss_val': 1.0102257392829757, 'psi': 0.6877067313094101}-{'f1_val': 0.664371872889203, 'auprc': 0.7509954905078684, 'loss_val': 0.9567128114741313, 'psi': 0.6990213199366692}
[S3] START round=29 head_norm_before_train=1.098995 cos_to_last_merge=0.9946 (last merge round=27)
[S3] round=29 local utility u=0.000000 metrics={'f1_val': 0.8741496699715448, 'auprc': 0.9452050456043183, 'loss_val': 0.28655421163986716, 'psi': 0.9025718202246542}-{'f1_val': 0.996718896605481, 'auprc': 0.9956567926911533, 'loss_val': 0.17493625965056933, 'psi': 0.9962940550397499}
[S4] START round=29 head_norm_before_train=1.178101 cos_to_last_merge=1.0000 (last merge round=28)
[S4] round=29 local utility u=0.061611 metrics={'f1_val': 0.9428900596320445, 'auprc': 0.9581470339547986, 'loss_val': 0.3340914940885253, 'psi': 0.9489928493611461}-{'f1_val': 0.9387983953259185, 'auprc': 0.9236924109237158, 'loss_val': 0.3294001069459754, 'psi': 0.9327560015650374}
[S5] START round=29 head_norm_before_train=1.567760 cos_to_last_merge=0.8088 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.809
[S5] round=29 local utility u=1.000000 metrics={'f1_val': 0.992278056357246, 'auprc': 0.991968577256273, 'loss_val': 0.11753748610722221, 'psi': 0.9921542647168567}-{'f1_val': 0.700320598491359, 'auprc': 0.8680789395950474, 'loss_val': 0.4199577220836524, 'psi': 0.7674239349328345}
[S6] START round=29 head_norm_before_train=1.831919 (no previous merge yet)
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.6946126085562943, 'auprc': 0.8420189191760556, 'loss_val': 0.6635967596089176, 'psi': 0.7535751328041989}-{'f1_val': 0.9090346644669066, 'auprc': 0.9537332358117442, 'loss_val': 0.23853713198788287, 'psi': 0.9269140930048416}
[S7] START round=29 head_norm_before_train=1.421484 cos_to_last_merge=0.8175 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.817
[S7] round=29 local utility u=0.216391 metrics={'f1_val': 0.6139933857541378, 'auprc': 0.7935117360277929, 'loss_val': 0.582217050214998, 'psi': 0.6858007258635999}-{'f1_val': 0.5777782507808866, 'auprc': 0.7831238541852559, 'loss_val': 0.766543798480971, 'psi': 0.6599164921426344}
[S8] START round=29 head_norm_before_train=1.664181 cos_to_last_merge=0.7670 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.767
[S8] round=29 local utility u=0.024197 metrics={'f1_val': 0.991097207355627, 'auprc': 0.9990720095977259, 'loss_val': 0.04675309025905148, 'psi': 0.9942871282524666}-{'f1_val': 0.9857540367148059, 'auprc': 0.9991528720813312, 'loss_val': 0.06332987998815037, 'psi': 0.991113570861416}
[S9] START round=29 head_norm_before_train=1.133591 cos_to_last_merge=1.0000 (last merge round=28)
[S9] round=29 local utility u=0.014426 metrics={'f1_val': 0.9956098104564366, 'auprc': 0.9986467975350269, 'loss_val': 0.09673000214835192, 'psi': 0.9968246052878726}-{'f1_val': 0.9935285262166678, 'auprc': 0.9987062443920708, 'loss_val': 0.11327319217974093, 'psi': 0.9955996134868289}
[S10] START round=29 head_norm_before_train=1.227403 cos_to_last_merge=0.9960 (last merge round=27)
[S10] round=29 local utility u=0.050320 metrics={'f1_val': 0.9934496907403657, 'auprc': 0.9940637804806169, 'loss_val': 0.17141517219231683, 'psi': 0.9936953266364661}-{'f1_val': 0.9923980159513162, 'auprc': 0.9935640773150276, 'loss_val': 0.26424646591391565, 'psi': 0.9928644404968008}
[S11] START round=29 head_norm_before_train=1.391615 cos_to_last_merge=1.0000 (last merge round=28)
[S11] round=29 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.997683455628066, 'loss_val': 0.09758159354511167, 'psi': 0.9970015849593802}-{'f1_val': 0.9965470045135896, 'auprc': 0.997432736830872, 'loss_val': 0.07608130888619113, 'psi': 0.9969012974405025}
[S13] START round=29 head_norm_before_train=1.127855 cos_to_last_merge=1.0000 (last merge round=28)
[S13] round=29 local utility u=0.000000 metrics={'f1_val': 0.49942281762615637, 'auprc': 0.6995784034890489, 'loss_val': 0.9359715074345641, 'psi': 0.5794850519713133}-{'f1_val': 0.5869539829653447, 'auprc': 0.6415932774673456, 'loss_val': 0.7689604626622185, 'psi': 0.608809700766145}
[S14] START round=29 head_norm_before_train=1.437032 cos_to_last_merge=1.0000 (last merge round=28)
[S14] round=29 local utility u=0.001777 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9975710586115316, 'loss_val': 0.14942408597789741, 'psi': 0.9972269283392117}-{'f1_val': 0.9976511180498535, 'auprc': 0.9959457791078207, 'loss_val': 0.15202349848183316, 'psi': 0.9969689824730404}
[S15] START round=29 head_norm_before_train=1.537785 cos_to_last_merge=0.9996 (last merge round=27)
[S15] round=29 local utility u=0.000000 metrics={'f1_val': 0.6974153433997211, 'auprc': 0.9850610420197041, 'loss_val': 0.4287783993948531, 'psi': 0.8124736228477143}-{'f1_val': 0.9833907871272894, 'auprc': 0.9972860301029072, 'loss_val': 0.15152785558723697, 'psi': 0.9889488843175365}
[S16] START round=29 head_norm_before_train=1.596940 cos_to_last_merge=1.0000 (last merge round=28)
[S16] round=29 local utility u=0.317239 metrics={'f1_val': 0.9325467444676505, 'auprc': 0.9917624426153646, 'loss_val': 0.30277412225521294, 'psi': 0.9562330237267362}-{'f1_val': 0.865980365678579, 'auprc': 0.9895163049068804, 'loss_val': 0.5311152668678579, 'psi': 0.9153947413698995}
[S17] START round=29 head_norm_before_train=1.149140 cos_to_last_merge=0.9991 (last merge round=27)
[S17] round=29 local utility u=0.000000 metrics={'f1_val': 0.3074636965783697, 'auprc': 0.7578499867546882, 'loss_val': 1.2944053729728635, 'psi': 0.48761821264889715}-{'f1_val': 0.3798552400317779, 'auprc': 0.8031456871988161, 'loss_val': 1.0175837632504474, 'psi': 0.5491714188985932}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:42016
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S3@127.0.0.1:42003
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:42011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] → sending delta(kind=head bytes=1806) to S14@127.0.0.1:42014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:42015
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:42017
[S5] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1806 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1805 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1800) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.235517)
[S17] loaded HEAD from S9 (vec_in norm=1.235517)
[S17] cosine check vs S9: cos=0.6873
[S17] BUFFERED delta from S9 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1799) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.577704)
[S16] loaded HEAD from S5 (vec_in norm=1.577704)
[S16] cosine check vs S5: cos=0.9977
[S16] BUFFERED delta from S5 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1801) from S4
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.222368)
[S10] loaded HEAD from S4 (vec_in norm=1.222368)
[S10] cosine check vs S4: cos=0.9262
[S10] BUFFERED delta from S4 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1805) from S10
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.288480)
[S3] loaded HEAD from S10 (vec_in norm=1.288480)
[S3] cosine check vs S10: cos=0.6845
[S3] BUFFERED delta from S10 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1801) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.681558)
[S17] loaded HEAD from S8 (vec_in norm=1.681558)
[S17] cosine check vs S8: cos=0.3697
[S17] BUFFERED delta from S8 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1799) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.480451)
[S15] loaded HEAD from S14 (vec_in norm=1.480451)
[S15] cosine check vs S14: cos=0.9689
[S15] BUFFERED delta from S14 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1806) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.434113)
[S14] loaded HEAD from S7 (vec_in norm=1.434113)
[S14] cosine check vs S7: cos=0.9897
[S14] BUFFERED delta from S7 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:42017
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1800) from S16
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.622065)
[S17] loaded HEAD from S16 (vec_in norm=1.622065)
[S17] cosine check vs S16: cos=0.8896
[S17] BUFFERED delta from S16 (total buffered=3)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=29 metric=0.8741 head_norm=1.158484
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.896198e-01
[S3] stored merged vector for next round verification (round=29)
[S3] DEBUG after merge:  round=29 metric=0.8890 head_norm=1.123123 delta_norm=0.489620
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=29 metric=0.6974 head_norm=1.566148
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.947966e-01
[S15] stored merged vector for next round verification (round=29)
[S15] DEBUG after merge:  round=29 metric=0.6974 head_norm=1.511401 delta_norm=0.194797
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=29 metric=0.9970 head_norm=1.480451
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.068763e-01
[S14] stored merged vector for next round verification (round=29)
[S14] DEBUG after merge:  round=29 metric=0.9970 head_norm=1.453542 delta_norm=0.106876
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=29 metric=0.9325 head_norm=1.622065
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.812348e-02
[S16] stored merged vector for next round verification (round=29)
[S16] DEBUG after merge:  round=29 metric=0.9332 head_norm=1.598983 delta_norm=0.058123
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=29 metric=0.9934 head_norm=1.288480
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.433939e-01
[S10] stored merged vector for next round verification (round=29)
[S10] DEBUG after merge:  round=29 metric=0.9931 head_norm=1.232048 delta_norm=0.243394
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=29 metric=0.3075 head_norm=1.171333
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.152021e-01
[S17] stored merged vector for next round verification (round=29)
[S17] DEBUG after merge:  round=29 metric=0.3016 head_norm=1.084337 delta_norm=0.315202
[S17] aggregate: ROLLBACK (f1_val pre=0.307 post=0.302 tol_abs=0.005 tol_rel=0.0)
[S2] START round=30 head_norm_before_train=1.663066 cos_to_last_merge=0.8155 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.815
[S2] round=30 local utility u=0.210508 metrics={'f1_val': 0.6830772762267696, 'auprc': 0.7347201615386814, 'loss_val': 0.765054449446698, 'psi': 0.7037344303515343}-{'f1_val': 0.6459864706329722, 'auprc': 0.7502871223240668, 'loss_val': 1.0102257392829757, 'psi': 0.6877067313094101}
[S3] START round=30 head_norm_before_train=1.123123 cos_to_last_merge=1.0000 (last merge round=29)
[S3] round=30 local utility u=0.499706 metrics={'f1_val': 0.9966688156992842, 'auprc': 0.9995782325250457, 'loss_val': 0.18537572125216625, 'psi': 0.9978325824295888}-{'f1_val': 0.8741496699715448, 'auprc': 0.9452050456043183, 'loss_val': 0.28655421163986716, 'psi': 0.9025718202246542}
[S4] START round=30 head_norm_before_train=1.222368 cos_to_last_merge=0.9981 (last merge round=28)
[S4] round=30 local utility u=0.008587 metrics={'f1_val': 0.9483096300285501, 'auprc': 0.9434031290268359, 'loss_val': 0.3052029039657327, 'psi': 0.9463470296278644}-{'f1_val': 0.9428900596320445, 'auprc': 0.9581470339547986, 'loss_val': 0.3340914940885253, 'psi': 0.9489928493611461}
[S5] START round=30 head_norm_before_train=1.577704 cos_to_last_merge=0.8086 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.809
[S5] round=30 local utility u=0.000000 metrics={'f1_val': 0.7636770745893848, 'auprc': 0.9808876374432295, 'loss_val': 0.21240970341628662, 'psi': 0.8505612997309226}-{'f1_val': 0.992278056357246, 'auprc': 0.991968577256273, 'loss_val': 0.11753748610722221, 'psi': 0.9921542647168567}
[S6] START round=30 head_norm_before_train=1.841693 (no previous merge yet)
[S6] round=30 local utility u=1.000000 metrics={'f1_val': 0.9347863790744351, 'auprc': 0.9649158278657786, 'loss_val': 0.18281951066716648, 'psi': 0.9468381585909724}-{'f1_val': 0.6946126085562943, 'auprc': 0.8420189191760556, 'loss_val': 0.6635967596089176, 'psi': 0.7535751328041989}
[S7] START round=30 head_norm_before_train=1.434113 cos_to_last_merge=0.8151 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.815
[S7] round=30 local utility u=0.030084 metrics={'f1_val': 0.6314155537774648, 'auprc': 0.7962889833772951, 'loss_val': 0.6349144427803348, 'psi': 0.6973649256173969}-{'f1_val': 0.6139933857541378, 'auprc': 0.7935117360277929, 'loss_val': 0.582217050214998, 'psi': 0.6858007258635999}
[S8] START round=30 head_norm_before_train=1.681558 cos_to_last_merge=0.7644 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.764
[S8] round=30 local utility u=0.008129 metrics={'f1_val': 0.9941000136901317, 'auprc': 0.9962361508809092, 'loss_val': 0.04000456915197775, 'psi': 0.9949544685664427}-{'f1_val': 0.991097207355627, 'auprc': 0.9990720095977259, 'loss_val': 0.04675309025905148, 'psi': 0.9942871282524666}
[S9] START round=30 head_norm_before_train=1.235517 cos_to_last_merge=0.9936 (last merge round=28)
[S9] round=30 local utility u=0.016089 metrics={'f1_val': 0.9956098104564366, 'auprc': 0.9987319370207594, 'loss_val': 0.0648084076271406, 'psi': 0.9968586610821657}-{'f1_val': 0.9956098104564366, 'auprc': 0.9986467975350269, 'loss_val': 0.09673000214835192, 'psi': 0.9968246052878726}
[S10] START round=30 head_norm_before_train=1.232048 cos_to_last_merge=1.0000 (last merge round=29)
[S10] round=30 local utility u=0.000000 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9917100497152558, 'loss_val': 0.21003984162751796, 'psi': 0.9935439101116197}-{'f1_val': 0.9934496907403657, 'auprc': 0.9940637804806169, 'loss_val': 0.17141517219231683, 'psi': 0.9936953266364661}
[S11] START round=30 head_norm_before_train=1.424869 cos_to_last_merge=0.9995 (last merge round=28)
[S11] round=30 local utility u=0.005345 metrics={'f1_val': 0.9958246664506369, 'auprc': 0.9976916081106517, 'loss_val': 0.08258259008010596, 'psi': 0.9965714431146429}-{'f1_val': 0.9965470045135896, 'auprc': 0.997683455628066, 'loss_val': 0.09758159354511167, 'psi': 0.9970015849593802}
[S13] START round=30 head_norm_before_train=1.147458 cos_to_last_merge=0.9993 (last merge round=28)
[S13] round=30 local utility u=0.257874 metrics={'f1_val': 0.5804560398909249, 'auprc': 0.6552126579066316, 'loss_val': 0.7733259169105626, 'psi': 0.6103586870972075}-{'f1_val': 0.49942281762615637, 'auprc': 0.6995784034890489, 'loss_val': 0.9359715074345641, 'psi': 0.5794850519713133}
[S14] START round=30 head_norm_before_train=1.453542 cos_to_last_merge=1.0000 (last merge round=29)
[S14] round=30 local utility u=0.005496 metrics={'f1_val': 0.9976483782674455, 'auprc': 0.9980228185675686, 'loss_val': 0.14369300090135728, 'psi': 0.9977981543874948}-{'f1_val': 0.9969975081576651, 'auprc': 0.9975710586115316, 'loss_val': 0.14942408597789741, 'psi': 0.9972269283392117}
[S15] START round=30 head_norm_before_train=1.511401 cos_to_last_merge=1.0000 (last merge round=29)
[S15] round=30 local utility u=1.000000 metrics={'f1_val': 0.9847032122847001, 'auprc': 0.997761340045941, 'loss_val': 0.14769305084127277, 'psi': 0.9899264633891964}-{'f1_val': 0.6974153433997211, 'auprc': 0.9850610420197041, 'loss_val': 0.4287783993948531, 'psi': 0.8124736228477143}
[S16] START round=30 head_norm_before_train=1.598983 cos_to_last_merge=1.0000 (last merge round=29)
[S16] round=30 local utility u=0.176752 metrics={'f1_val': 0.9659320955487267, 'auprc': 0.988478112831218, 'loss_val': 0.13972983581748974, 'psi': 0.9749505024617232}-{'f1_val': 0.9325467444676505, 'auprc': 0.9917624426153646, 'loss_val': 0.30277412225521294, 'psi': 0.9562330237267362}
[S17] START round=30 head_norm_before_train=1.084337 cos_to_last_merge=1.0000 (last merge round=29)
[S17] round=30 local utility u=0.494357 metrics={'f1_val': 0.3865992819946822, 'auprc': 0.8286315546701439, 'loss_val': 0.9928489242379596, 'psi': 0.5634121910648668}-{'f1_val': 0.3074636965783697, 'auprc': 0.7578499867546882, 'loss_val': 1.2944053729728635, 'psi': 0.48761821264889715}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:42011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:42004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:42012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S3] → sending delta(kind=head bytes=1806) to S9@127.0.0.1:42010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:42015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:42014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:42017
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S8] → sending delta(kind=head bytes=1808) to S17@127.0.0.1:42017
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:42013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:42012
[S6] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1808 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1806 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1800) from S4
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.265001)
[S10] loaded HEAD from S4 (vec_in norm=1.265001)
[S10] cosine check vs S4: cos=0.9617
[S10] BUFFERED delta from S4 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1798) from S15
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.538101)
[S11] loaded HEAD from S15 (vec_in norm=1.538101)
[S11] cosine check vs S15: cos=0.4804
[S11] BUFFERED delta from S15 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1798) from S13
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.166219)
[S4] loaded HEAD from S13 (vec_in norm=1.166219)
[S4] cosine check vs S13: cos=0.9544
[S4] BUFFERED delta from S13 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1806) from S3
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.177336)
[S9] loaded HEAD from S3 (vec_in norm=1.177336)
[S9] cosine check vs S3: cos=0.8598
[S9] BUFFERED delta from S3 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1808) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.698179)
[S17] loaded HEAD from S8 (vec_in norm=1.698179)
[S17] cosine check vs S8: cos=0.5479
[S17] BUFFERED delta from S8 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1799) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.854326)
[S11] loaded HEAD from S6 (vec_in norm=1.854326)
[S11] cosine check vs S6: cos=0.9109
[S11] BUFFERED delta from S6 (total buffered=2)
[S17] RECEIVED delta(kind=head bytes=1799) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.315388)
[S17] loaded HEAD from S9 (vec_in norm=1.315388)
[S17] cosine check vs S9: cos=0.8171
[S17] BUFFERED delta from S9 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1801) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.497789)
[S15] loaded HEAD from S14 (vec_in norm=1.497789)
[S15] cosine check vs S14: cos=0.9860
[S15] BUFFERED delta from S14 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1802) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.446952)
[S14] loaded HEAD from S7 (vec_in norm=1.446952)
[S14] cosine check vs S7: cos=0.9923
[S14] BUFFERED delta from S7 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1800) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.459628)
[S13] loaded HEAD from S11 (vec_in norm=1.459628)
[S13] cosine check vs S11: cos=0.7320
[S13] BUFFERED delta from S11 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] → sending delta(kind=head bytes=1793) to S3@127.0.0.1:42003
[S16] sending update (kind=head size=1794 to 1 peers)
[S17] sending update (kind=head size=1793 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1793) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.108376)
[S3] loaded HEAD from S17 (vec_in norm=1.108376)
[S3] cosine check vs S17: cos=0.6426
[S3] BUFFERED delta from S17 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1794) from S16
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.625591)
[S17] loaded HEAD from S16 (vec_in norm=1.625591)
[S17] cosine check vs S16: cos=0.7483
[S17] BUFFERED delta from S16 (total buffered=3)
[S5] ⇄ pheromone p=0.364 → S16@127.0.0.1:42016
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=30 metric=0.9483 head_norm=1.265001
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.898537e-01
[S4] stored merged vector for next round verification (round=30)
[S4] DEBUG after merge:  round=30 metric=0.9485 head_norm=1.201708 delta_norm=0.189854
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.043 → S10@127.0.0.1:42011
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=30 metric=0.9967 head_norm=1.177336
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.841285e-01
[S3] stored merged vector for next round verification (round=30)
[S3] DEBUG after merge:  round=30 metric=0.9963 head_norm=1.035822 delta_norm=0.484129
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.132 → S9@127.0.0.1:42010
[S6] ⇄ pheromone p=0.477 → S11@127.0.0.1:42012
[S8] ⇄ pheromone p=0.095 → S17@127.0.0.1:42017
[S7] ⇄ pheromone p=0.173 → S14@127.0.0.1:42014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:42013
[S2] sending update (kind=head size=1800 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1800) from S2
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.670305)
[S13] loaded HEAD from S2 (vec_in norm=1.670305)
[S13] cosine check vs S2: cos=0.6719
[S13] BUFFERED delta from S2 (total buffered=2)
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=30 metric=0.5805 head_norm=1.166219
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.114390e-01
[S13] stored merged vector for next round verification (round=30)
[S13] DEBUG after merge:  round=30 metric=0.5769 head_norm=1.135724 delta_norm=0.111439
[S13] aggregate: ACCEPT kept=['S11', 'S2'] (k=2/2) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.109 → S4@127.0.0.1:42004
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=30 metric=0.9847 head_norm=1.538101
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.286791e-01
[S15] stored merged vector for next round verification (round=30)
[S15] DEBUG after merge:  round=30 metric=0.9849 head_norm=1.512615 delta_norm=0.128679
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.421 → S11@127.0.0.1:42012
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=30 metric=0.9958 head_norm=1.459628
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.115563e-01
[S11] stored merged vector for next round verification (round=30)
[S11] DEBUG after merge:  round=30 metric=0.9949 head_norm=1.347893 delta_norm=0.211556
[S11] aggregate: ACCEPT kept=['S15', 'S6'] (k=2/2) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.030 → S13@127.0.0.1:42013
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=30 metric=0.9956 head_norm=1.315388
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.366691e-01
[S9] stored merged vector for next round verification (round=30)
[S9] DEBUG after merge:  round=30 metric=0.9956 head_norm=1.202013 delta_norm=0.336669
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.027 → S17@127.0.0.1:42017
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=30 metric=0.9976 head_norm=1.497789
[S14] _apply_head_vector_avg (torch): Δ‖w‖=9.502207e-02
[S14] stored merged vector for next round verification (round=30)
[S14] DEBUG after merge:  round=30 metric=0.9976 head_norm=1.469521 delta_norm=0.095022
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.013 → S15@127.0.0.1:42015
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=30 metric=0.9948 head_norm=1.284576
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.766813e-01
[S10] stored merged vector for next round verification (round=30)
[S10] DEBUG after merge:  round=30 metric=0.9946 head_norm=1.262524 delta_norm=0.176681
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.040 → S3@127.0.0.1:42003
[S16] ⇄ pheromone p=0.232 → S17@127.0.0.1:42017
[S17] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=30 metric=0.3866 head_norm=1.108376
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.586138e-01
[S17] stored merged vector for next round verification (round=30)
[S17] DEBUG after merge:  round=30 metric=0.3866 head_norm=1.100738 delta_norm=0.158614
[S17] aggregate: ACCEPT kept=['S8', 'S9', 'S16'] (k=3/3) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.166 → S3@127.0.0.1:42003
[S2] ⇄ pheromone p=0.093 → S13@127.0.0.1:42013
[S2] START round=31 head_norm_before_train=1.670305 cos_to_last_merge=0.8152 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.815
[S2] round=31 local utility u=0.000000 metrics={'f1_val': 0.5955795366802963, 'auprc': 0.698101234577174, 'loss_val': 0.9980638668570939, 'psi': 0.6365882158390475}-{'f1_val': 0.6830772762267696, 'auprc': 0.7347201615386814, 'loss_val': 0.765054449446698, 'psi': 0.7037344303515343}
[S3] START round=31 head_norm_before_train=1.035822 cos_to_last_merge=1.0000 (last merge round=30)
[S3] round=31 local utility u=0.030432 metrics={'f1_val': 0.9973696976584205, 'auprc': 0.9979465456145886, 'loss_val': 0.12382232125026937, 'psi': 0.9976004368408877}-{'f1_val': 0.9966688156992842, 'auprc': 0.9995782325250457, 'loss_val': 0.18537572125216625, 'psi': 0.9978325824295888}
[S4] START round=31 head_norm_before_train=1.201708 cos_to_last_merge=1.0000 (last merge round=30)
[S4] round=31 local utility u=0.000000 metrics={'f1_val': 0.94141145161639, 'auprc': 0.9383073997101179, 'loss_val': 0.3324369350654745, 'psi': 0.9401698308538812}-{'f1_val': 0.9483096300285501, 'auprc': 0.9434031290268359, 'loss_val': 0.3052029039657327, 'psi': 0.9463470296278644}
[S5] START round=31 head_norm_before_train=1.584724 cos_to_last_merge=0.8077 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.808
[S5] round=31 local utility u=0.000000 metrics={'f1_val': 0.7004938661094564, 'auprc': 0.9547422482470573, 'loss_val': 0.3043008218689319, 'psi': 0.8021932189644968}-{'f1_val': 0.7636770745893848, 'auprc': 0.9808876374432295, 'loss_val': 0.21240970341628662, 'psi': 0.8505612997309226}
[S6] START round=31 head_norm_before_train=1.854326 (no previous merge yet)
[S6] round=31 local utility u=0.000000 metrics={'f1_val': 0.8441967392422043, 'auprc': 0.9551260576286096, 'loss_val': 0.3268039811887746, 'psi': 0.8885684665967665}-{'f1_val': 0.9347863790744351, 'auprc': 0.9649158278657786, 'loss_val': 0.18281951066716648, 'psi': 0.9468381585909724}
[S7] START round=31 head_norm_before_train=1.446952 cos_to_last_merge=0.8125 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.813
[S7] round=31 local utility u=0.327555 metrics={'f1_val': 0.6769758542183071, 'auprc': 0.8322071482454034, 'loss_val': 0.3609206494017732, 'psi': 0.7390683718291456}-{'f1_val': 0.6314155537774648, 'auprc': 0.7962889833772951, 'loss_val': 0.6349144427803348, 'psi': 0.6973649256173969}
[S8] START round=31 head_norm_before_train=1.698179 cos_to_last_merge=0.7619 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.762
[S8] round=31 local utility u=0.000000 metrics={'f1_val': 0.9941000136901317, 'auprc': 0.9903173987081673, 'loss_val': 0.03952926541668577, 'psi': 0.9925869676973459}-{'f1_val': 0.9941000136901317, 'auprc': 0.9962361508809092, 'loss_val': 0.04000456915197775, 'psi': 0.9949544685664427}
[S9] START round=31 head_norm_before_train=1.202013 cos_to_last_merge=1.0000 (last merge round=30)
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.9964388212112862, 'auprc': 0.9983564316678115, 'loss_val': 0.09163673016506343, 'psi': 0.9972058653938964}-{'f1_val': 0.9956098104564366, 'auprc': 0.9987319370207594, 'loss_val': 0.0648084076271406, 'psi': 0.9968586610821657}
[S10] START round=31 head_norm_before_train=1.262524 cos_to_last_merge=1.0000 (last merge round=30)
[S10] round=31 local utility u=0.000000 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.989891550782029, 'loss_val': 0.22262476345765722, 'psi': 0.9928165105383289}-{'f1_val': 0.9947664837091956, 'auprc': 0.9917100497152558, 'loss_val': 0.21003984162751796, 'psi': 0.9935439101116197}
[S11] START round=31 head_norm_before_train=1.347893 cos_to_last_merge=1.0000 (last merge round=30)
[S11] round=31 local utility u=0.000000 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9978989341464152, 'loss_val': 0.09645543837368094, 'psi': 0.9969426741398826}-{'f1_val': 0.9958246664506369, 'auprc': 0.9976916081106517, 'loss_val': 0.08258259008010596, 'psi': 0.9965714431146429}
[S13] START round=31 head_norm_before_train=1.135724 cos_to_last_merge=1.0000 (last merge round=30)
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.5093932803689043, 'auprc': 0.6745171234128431, 'loss_val': 0.9376333822785371, 'psi': 0.5754428175864799}-{'f1_val': 0.5804560398909249, 'auprc': 0.6552126579066316, 'loss_val': 0.7733259169105626, 'psi': 0.6103586870972075}
[S14] START round=31 head_norm_before_train=1.469521 cos_to_last_merge=1.0000 (last merge round=30)
[S14] round=31 local utility u=0.007667 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9983910093354986, 'loss_val': 0.1294797152050508, 'psi': 0.9979470745641116}-{'f1_val': 0.9976483782674455, 'auprc': 0.9980228185675686, 'loss_val': 0.14369300090135728, 'psi': 0.9977981543874948}
[S15] START round=31 head_norm_before_train=1.512615 cos_to_last_merge=1.0000 (last merge round=30)
[S15] round=31 local utility u=0.000000 metrics={'f1_val': 0.6975663991359801, 'auprc': 0.9390974492206398, 'loss_val': 0.46974974482278564, 'psi': 0.794178819169844}-{'f1_val': 0.9847032122847001, 'auprc': 0.997761340045941, 'loss_val': 0.14769305084127277, 'psi': 0.9899264633891964}
[S16] START round=31 head_norm_before_train=1.625591 cos_to_last_merge=0.9998 (last merge round=29)
[S16] round=31 local utility u=0.000000 metrics={'f1_val': 0.9442415908214363, 'auprc': 0.9891644207618683, 'loss_val': 0.17261621685805886, 'psi': 0.9622107227976091}-{'f1_val': 0.9659320955487267, 'auprc': 0.988478112831218, 'loss_val': 0.13972983581748974, 'psi': 0.9749505024617232}
[S17] START round=31 head_norm_before_train=1.100738 cos_to_last_merge=1.0000 (last merge round=30)
[S17] round=31 local utility u=0.125965 metrics={'f1_val': 0.4142500182629887, 'auprc': 0.8337477734553471, 'loss_val': 0.9221719320802113, 'psi': 0.5820491203399321}-{'f1_val': 0.3865992819946822, 'auprc': 0.8286315546701439, 'loss_val': 0.9928489242379596, 'psi': 0.5634121910648668}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:42014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:42010
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:42015
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1795) from S3
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.121821)
[S9] loaded HEAD from S3 (vec_in norm=1.121821)
[S9] cosine check vs S3: cos=0.9494
[S9] BUFFERED delta from S3 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1796) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.457497)
[S14] loaded HEAD from S7 (vec_in norm=1.457497)
[S14] cosine check vs S7: cos=0.9935
[S14] BUFFERED delta from S7 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1799) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.514512)
[S15] loaded HEAD from S14 (vec_in norm=1.514512)
[S15] cosine check vs S14: cos=0.9922
[S15] BUFFERED delta from S14 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] → sending delta(kind=head bytes=1793) to S3@127.0.0.1:42003
[S17] sending update (kind=head size=1793 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1793) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.122024)
[S3] loaded HEAD from S17 (vec_in norm=1.122024)
[S3] cosine check vs S17: cos=0.9219
[S3] BUFFERED delta from S17 (total buffered=1)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=31 metric=0.6976 head_norm=1.545524
[S15] _apply_head_vector_avg (torch): Δ‖w‖=9.684093e-02
[S15] stored merged vector for next round verification (round=31)
[S15] DEBUG after merge:  round=31 metric=0.6974 head_norm=1.527029 delta_norm=0.096841
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=31 metric=0.9964 head_norm=1.278108
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.059385e-01
[S9] stored merged vector for next round verification (round=31)
[S9] DEBUG after merge:  round=31 metric=0.9964 head_norm=1.184741 delta_norm=0.205938
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=31 metric=0.9974 head_norm=1.121821
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.217667e-01
[S3] stored merged vector for next round verification (round=31)
[S3] DEBUG after merge:  round=31 metric=0.9973 head_norm=1.099786 delta_norm=0.221767
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=31 metric=0.9977 head_norm=1.514512
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.942562e-02
[S14] stored merged vector for next round verification (round=31)
[S14] DEBUG after merge:  round=31 metric=0.9977 head_norm=1.483585 delta_norm=0.089426
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=32 head_norm_before_train=1.678683 cos_to_last_merge=0.8148 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.815
[S2] round=32 local utility u=0.257988 metrics={'f1_val': 0.6587329253067191, 'auprc': 0.7369628940441715, 'loss_val': 0.9775929108257277, 'psi': 0.6900249128017001}-{'f1_val': 0.5955795366802963, 'auprc': 0.698101234577174, 'loss_val': 0.9980638668570939, 'psi': 0.6365882158390475}
[S3] START round=32 head_norm_before_train=1.099786 cos_to_last_merge=1.0000 (last merge round=31)
[S3] round=32 local utility u=0.000000 metrics={'f1_val': 0.9759745587488514, 'auprc': 0.9976338147467816, 'loss_val': 0.12477098388193877, 'psi': 0.9846382611480236}-{'f1_val': 0.9973696976584205, 'auprc': 0.9979465456145886, 'loss_val': 0.12382232125026937, 'psi': 0.9976004368408877}
[S4] START round=32 head_norm_before_train=1.238684 cos_to_last_merge=0.9988 (last merge round=30)
[S4] round=32 local utility u=0.000000 metrics={'f1_val': 0.940521402517045, 'auprc': 0.9298974455626636, 'loss_val': 0.30966987120713757, 'psi': 0.9362718197352924}-{'f1_val': 0.94141145161639, 'auprc': 0.9383073997101179, 'loss_val': 0.3324369350654745, 'psi': 0.9401698308538812}
[S5] START round=32 head_norm_before_train=1.591093 cos_to_last_merge=0.8069 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.807
[S5] round=32 local utility u=0.000000 metrics={'f1_val': 0.6784068384489085, 'auprc': 0.8645677209912386, 'loss_val': 0.43910880456551593, 'psi': 0.7528711914658406}-{'f1_val': 0.7004938661094564, 'auprc': 0.9547422482470573, 'loss_val': 0.3043008218689319, 'psi': 0.8021932189644968}
[S6] START round=32 head_norm_before_train=1.866993 (no previous merge yet)
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.6115953185353116, 'auprc': 0.7575199131510516, 'loss_val': 0.9536211056103447, 'psi': 0.6699651563816076}-{'f1_val': 0.8441967392422043, 'auprc': 0.9551260576286096, 'loss_val': 0.3268039811887746, 'psi': 0.8885684665967665}
[S7] START round=32 head_norm_before_train=1.457497 cos_to_last_merge=0.8103 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.810
[S7] round=32 local utility u=0.000000 metrics={'f1_val': 0.6485737825073274, 'auprc': 0.8017887308502505, 'loss_val': 0.5206675226025766, 'psi': 0.7098597618444966}-{'f1_val': 0.6769758542183071, 'auprc': 0.8322071482454034, 'loss_val': 0.3609206494017732, 'psi': 0.7390683718291456}
[S8] START round=32 head_norm_before_train=1.714459 cos_to_last_merge=0.7598 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.760
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.9928249955793521, 'auprc': 0.9916733497438365, 'loss_val': 0.03900302461946571, 'psi': 0.9923643372451458}-{'f1_val': 0.9941000136901317, 'auprc': 0.9903173987081673, 'loss_val': 0.03952926541668577, 'psi': 0.9925869676973459}
[S9] START round=32 head_norm_before_train=1.184741 cos_to_last_merge=1.0000 (last merge round=31)
[S9] round=32 local utility u=0.002218 metrics={'f1_val': 0.9966891482978385, 'auprc': 0.9983435517405157, 'loss_val': 0.0886634917127544, 'psi': 0.9973509096749094}-{'f1_val': 0.9964388212112862, 'auprc': 0.9983564316678115, 'loss_val': 0.09163673016506343, 'psi': 0.9972058653938964}
[S10] START round=32 head_norm_before_train=1.311163 cos_to_last_merge=0.9963 (last merge round=30)
[S10] round=32 local utility u=0.045526 metrics={'f1_val': 0.9940903254969471, 'auprc': 0.9945095757830617, 'loss_val': 0.14137083567500017, 'psi': 0.9942580256113929}-{'f1_val': 0.9947664837091956, 'auprc': 0.989891550782029, 'loss_val': 0.22262476345765722, 'psi': 0.9928165105383289}
[S11] START round=32 head_norm_before_train=1.383388 cos_to_last_merge=0.9994 (last merge round=30)
[S11] round=32 local utility u=0.009102 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9978997301150375, 'loss_val': 0.07825435756553832, 'psi': 0.9969429925273317}-{'f1_val': 0.996305167468861, 'auprc': 0.9978989341464152, 'loss_val': 0.09645543837368094, 'psi': 0.9969426741398826}
[S13] START round=32 head_norm_before_train=1.154391 cos_to_last_merge=0.9994 (last merge round=30)
[S13] round=32 local utility u=0.260384 metrics={'f1_val': 0.5812850129782683, 'auprc': 0.6403441510813453, 'loss_val': 0.7456964962045425, 'psi': 0.6049086682194991}-{'f1_val': 0.5093932803689043, 'auprc': 0.6745171234128431, 'loss_val': 0.9376333822785371, 'psi': 0.5754428175864799}
[S14] START round=32 head_norm_before_train=1.483585 cos_to_last_merge=1.0000 (last merge round=31)
[S14] round=32 local utility u=0.000907 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9971088057402369, 'loss_val': 0.1238197866087697, 'psi': 0.9974341931260069}-{'f1_val': 0.9976511180498535, 'auprc': 0.9983910093354986, 'loss_val': 0.1294797152050508, 'psi': 0.9979470745641116}
[S15] START round=32 head_norm_before_train=1.527029 cos_to_last_merge=1.0000 (last merge round=31)
[S15] round=32 local utility u=1.000000 metrics={'f1_val': 0.9847032122847001, 'auprc': 0.9975691995082234, 'loss_val': 0.14557112268964814, 'psi': 0.9898496071741094}-{'f1_val': 0.6975663991359801, 'auprc': 0.9390974492206398, 'loss_val': 0.46974974482278564, 'psi': 0.794178819169844}
[S16] START round=32 head_norm_before_train=1.652962 cos_to_last_merge=0.9991 (last merge round=29)
[S16] round=32 local utility u=0.000000 metrics={'f1_val': 0.9392248463480798, 'auprc': 0.9896747005103483, 'loss_val': 0.22978355463810154, 'psi': 0.9594047880129872}-{'f1_val': 0.9442415908214363, 'auprc': 0.9891644207618683, 'loss_val': 0.17261621685805886, 'psi': 0.9622107227976091}
[S17] START round=32 head_norm_before_train=1.122024 cos_to_last_merge=0.9996 (last merge round=30)
[S17] round=32 local utility u=0.000000 metrics={'f1_val': 0.38869155878614786, 'auprc': 0.8121514204866931, 'loss_val': 0.9529487355698492, 'psi': 0.5580755034663659}-{'f1_val': 0.4142500182629887, 'auprc': 0.8337477734553471, 'loss_val': 0.9221719320802113, 'psi': 0.5820491203399321}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:42015
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:42013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S3@127.0.0.1:42003
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:42004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:42012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] → sending delta(kind=head bytes=1805) to S13@127.0.0.1:42013
[S2] sending update (kind=head size=1805 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1805 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1805) from S10
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.365173)
[S3] loaded HEAD from S10 (vec_in norm=1.365173)
[S3] cosine check vs S10: cos=0.5117
[S3] BUFFERED delta from S10 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1803) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.421135)
[S13] loaded HEAD from S11 (vec_in norm=1.421135)
[S13] cosine check vs S11: cos=0.7094
[S13] BUFFERED delta from S11 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1796) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.264021)
[S17] loaded HEAD from S9 (vec_in norm=1.264021)
[S17] cosine check vs S9: cos=0.8728
[S17] BUFFERED delta from S9 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1803) from S13
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.174831)
[S4] loaded HEAD from S13 (vec_in norm=1.174831)
[S4] cosine check vs S13: cos=0.9686
[S4] BUFFERED delta from S13 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1796) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.524649)
[S15] loaded HEAD from S14 (vec_in norm=1.524649)
[S15] cosine check vs S14: cos=0.9949
[S15] BUFFERED delta from S14 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1805) from S2
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.687238)
[S13] loaded HEAD from S2 (vec_in norm=1.687238)
[S13] cosine check vs S2: cos=0.7097
[S13] BUFFERED delta from S2 (total buffered=2)
[S11] RECEIVED delta(kind=head bytes=1798) from S15
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.557200)
[S11] loaded HEAD from S15 (vec_in norm=1.557200)
[S11] cosine check vs S15: cos=0.5654
[S11] BUFFERED delta from S15 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=32 metric=0.9405 head_norm=1.282140
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.629814e-01
[S4] stored merged vector for next round verification (round=32)
[S4] DEBUG after merge:  round=32 metric=0.9405 head_norm=1.218808 delta_norm=0.162981
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=32 metric=0.9760 head_norm=1.180525
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.340055e-01
[S3] stored merged vector for next round verification (round=32)
[S3] DEBUG after merge:  round=32 metric=0.9808 head_norm=1.107568 delta_norm=0.634006
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=32 metric=0.9847 head_norm=1.557200
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.975765e-02
[S15] stored merged vector for next round verification (round=32)
[S15] DEBUG after merge:  round=32 metric=0.9845 head_norm=1.538945 delta_norm=0.079758
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=32 metric=0.5813 head_norm=1.174831
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.176308e-01
[S13] stored merged vector for next round verification (round=32)
[S13] DEBUG after merge:  round=32 metric=0.5886 head_norm=1.144312 delta_norm=0.117631
[S13] aggregate: ACCEPT kept=['S11', 'S2'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=32 metric=0.9963 head_norm=1.421135
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.967563e-01
[S11] stored merged vector for next round verification (round=32)
[S11] DEBUG after merge:  round=32 metric=0.9963 head_norm=1.317869 delta_norm=0.696756
[S11] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=32 metric=0.3887 head_norm=1.139096
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.089752e-01
[S17] stored merged vector for next round verification (round=32)
[S17] DEBUG after merge:  round=32 metric=0.3914 head_norm=1.162832 delta_norm=0.308975
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=33 head_norm_before_train=1.687238 cos_to_last_merge=0.8144 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.814
[S2] round=33 local utility u=0.185636 metrics={'f1_val': 0.703800110737668, 'auprc': 0.7298366182477158, 'loss_val': 0.8553443676630668, 'psi': 0.7142147137416872}-{'f1_val': 0.6587329253067191, 'auprc': 0.7369628940441715, 'loss_val': 0.9775929108257277, 'psi': 0.6900249128017001}
[S3] START round=33 head_norm_before_train=1.107568 cos_to_last_merge=1.0000 (last merge round=32)
[S3] round=33 local utility u=0.054168 metrics={'f1_val': 0.9971149325810758, 'auprc': 0.9985541491860428, 'loss_val': 0.14603828257084484, 'psi': 0.9976906192230626}-{'f1_val': 0.9759745587488514, 'auprc': 0.9976338147467816, 'loss_val': 0.12477098388193877, 'psi': 0.9846382611480236}
[S4] START round=33 head_norm_before_train=1.218808 cos_to_last_merge=1.0000 (last merge round=32)
[S4] round=33 local utility u=0.026083 metrics={'f1_val': 0.9412806522130546, 'auprc': 0.9484190946644797, 'loss_val': 0.31762492900003864, 'psi': 0.9441360291936247}-{'f1_val': 0.940521402517045, 'auprc': 0.9298974455626636, 'loss_val': 0.30966987120713757, 'psi': 0.9362718197352924}
[S5] START round=33 head_norm_before_train=1.598516 cos_to_last_merge=0.8060 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.806
[S5] round=33 local utility u=0.000000 metrics={'f1_val': 0.4395318134105323, 'auprc': 0.8559618077970766, 'loss_val': 0.8753389384359068, 'psi': 0.60610381116515}-{'f1_val': 0.6784068384489085, 'auprc': 0.8645677209912386, 'loss_val': 0.43910880456551593, 'psi': 0.7528711914658406}
[S6] START round=33 head_norm_before_train=1.879836 (no previous merge yet)
[S6] round=33 local utility u=1.000000 metrics={'f1_val': 0.8345713517650775, 'auprc': 0.9173151590132672, 'loss_val': 0.4573645737934909, 'psi': 0.8676688746643534}-{'f1_val': 0.6115953185353116, 'auprc': 0.7575199131510516, 'loss_val': 0.9536211056103447, 'psi': 0.6699651563816076}
[S7] START round=33 head_norm_before_train=1.466718 cos_to_last_merge=0.8083 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.808
[S7] round=33 local utility u=0.184690 metrics={'f1_val': 0.6692739602054696, 'auprc': 0.8294430932523598, 'loss_val': 0.3584512652896939, 'psi': 0.7333416134242257}-{'f1_val': 0.6485737825073274, 'auprc': 0.8017887308502505, 'loss_val': 0.5206675226025766, 'psi': 0.7098597618444966}
[S8] START round=33 head_norm_before_train=1.730225 cos_to_last_merge=0.7577 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.758
[S8] round=33 local utility u=0.010843 metrics={'f1_val': 0.9928249955793521, 'auprc': 0.9987047724988073, 'loss_val': 0.03841200954798526, 'psi': 0.9951769063471342}-{'f1_val': 0.9928249955793521, 'auprc': 0.9916733497438365, 'loss_val': 0.03900302461946571, 'psi': 0.9923643372451458}
[S9] START round=33 head_norm_before_train=1.264021 cos_to_last_merge=0.9967 (last merge round=31)
[S9] round=33 local utility u=0.011438 metrics={'f1_val': 0.9966891482978385, 'auprc': 0.9973186300152754, 'loss_val': 0.06271190480894576, 'psi': 0.9969409409848133}-{'f1_val': 0.9966891482978385, 'auprc': 0.9983435517405157, 'loss_val': 0.0886634917127544, 'psi': 0.9973509096749094}
[S10] START round=33 head_norm_before_train=1.365173 cos_to_last_merge=0.9879 (last merge round=30)
[S10] round=33 local utility u=0.013940 metrics={'f1_val': 0.992750738533037, 'auprc': 0.9950372370319402, 'loss_val': 0.10703671561302305, 'psi': 0.9936653379325984}-{'f1_val': 0.9940903254969471, 'auprc': 0.9945095757830617, 'loss_val': 0.14137083567500017, 'psi': 0.9942580256113929}
[S11] START round=33 head_norm_before_train=1.317869 cos_to_last_merge=1.0000 (last merge round=32)
[S11] round=33 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9967828984434834, 'loss_val': 0.14402195071886129, 'psi': 0.9966413620855471}-{'f1_val': 0.996305167468861, 'auprc': 0.9978997301150375, 'loss_val': 0.07825435756553832, 'psi': 0.9969429925273317}
[S13] START round=33 head_norm_before_train=1.144312 cos_to_last_merge=1.0000 (last merge round=32)
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.5013691537262815, 'auprc': 0.6938949313016896, 'loss_val': 0.9796404803469045, 'psi': 0.5783794647564447}-{'f1_val': 0.5812850129782683, 'auprc': 0.6403441510813453, 'loss_val': 0.7456964962045425, 'psi': 0.6049086682194991}
[S14] START round=33 head_norm_before_train=1.524649 cos_to_last_merge=0.9989 (last merge round=31)
[S14] round=33 local utility u=0.003365 metrics={'f1_val': 0.9961605687915402, 'auprc': 0.9953674331459584, 'loss_val': 0.10292302719637879, 'psi': 0.9958433145333074}-{'f1_val': 0.9976511180498535, 'auprc': 0.9971088057402369, 'loss_val': 0.1238197866087697, 'psi': 0.9974341931260069}
[S15] START round=33 head_norm_before_train=1.538945 cos_to_last_merge=1.0000 (last merge round=32)
[S15] round=33 local utility u=0.000000 metrics={'f1_val': 0.6956685911236791, 'auprc': 0.9868539761269872, 'loss_val': 0.4461490061368199, 'psi': 0.8121427451250023}-{'f1_val': 0.9847032122847001, 'auprc': 0.9975691995082234, 'loss_val': 0.14557112268964814, 'psi': 0.9898496071741094}
[S16] START round=33 head_norm_before_train=1.678679 cos_to_last_merge=0.9981 (last merge round=29)
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.9388071599413427, 'auprc': 0.9896682715027647, 'loss_val': 0.24064356775047602, 'psi': 0.9591516045659114}-{'f1_val': 0.9392248463480798, 'auprc': 0.9896747005103483, 'loss_val': 0.22978355463810154, 'psi': 0.9594047880129872}
[S17] START round=33 head_norm_before_train=1.162832 cos_to_last_merge=1.0000 (last merge round=32)
[S17] round=33 local utility u=0.122465 metrics={'f1_val': 0.414785358267739, 'auprc': 0.8323998877171304, 'loss_val': 0.9253259689560372, 'psi': 0.5818311700474955}-{'f1_val': 0.38869155878614786, 'auprc': 0.8121514204866931, 'loss_val': 0.9529487355698492, 'psi': 0.5580755034663659}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:42004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:42013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:42008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] sending update (kind=head size=1806 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] sending update (kind=head size=1805 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:42017
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:42003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1800) from S3
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.179400)
[S17] loaded HEAD from S3 (vec_in norm=1.179400)
[S17] cosine check vs S3: cos=0.8768
[S17] BUFFERED delta from S3 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1799) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.562939)
[S7] loaded HEAD from S14 (vec_in norm=1.562939)
[S7] cosine check vs S14: cos=0.9902
[S7] BUFFERED delta from S14 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1797) from S4
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.254852)
[S13] loaded HEAD from S4 (vec_in norm=1.254852)
[S13] cosine check vs S4: cos=0.9811
[S13] BUFFERED delta from S4 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1798) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.329575)
[S3] loaded HEAD from S9 (vec_in norm=1.329575)
[S3] cosine check vs S9: cos=0.9188
[S3] BUFFERED delta from S9 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1800) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.416540)
[S4] loaded HEAD from S10 (vec_in norm=1.416540)
[S4] cosine check vs S10: cos=0.9244
[S4] BUFFERED delta from S10 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:42016
[S17] sending update (kind=head size=1800 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1800) from S17
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.178425)
[S16] loaded HEAD from S17 (vec_in norm=1.178425)
[S16] cosine check vs S17: cos=0.5217
[S16] BUFFERED delta from S17 (total buffered=1)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=33 metric=0.6693 head_norm=1.478365
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.146450e-01
[S7] stored merged vector for next round verification (round=33)
[S7] DEBUG after merge:  round=33 metric=0.6718 head_norm=1.516914 delta_norm=0.114645
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=33 metric=0.5014 head_norm=1.160945
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.265181e-01
[S13] stored merged vector for next round verification (round=33)
[S13] DEBUG after merge:  round=33 metric=0.5023 head_norm=1.202171 delta_norm=0.126518
[S13] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=33 metric=0.9971 head_norm=1.179400
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.632796e-01
[S3] stored merged vector for next round verification (round=33)
[S3] DEBUG after merge:  round=33 metric=0.9971 head_norm=1.228845 delta_norm=0.263280
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=33 metric=0.9413 head_norm=1.254852
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.715267e-01
[S4] stored merged vector for next round verification (round=33)
[S4] DEBUG after merge:  round=33 metric=0.9413 head_norm=1.310302 delta_norm=0.271527
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=33 metric=0.4148 head_norm=1.178425
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.925756e-01
[S17] stored merged vector for next round verification (round=33)
[S17] DEBUG after merge:  round=33 metric=0.4776 head_norm=1.142031 delta_norm=0.292576
[S17] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=33 metric=0.9388 head_norm=1.701979
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.403936e-01
[S16] stored merged vector for next round verification (round=33)
[S16] DEBUG after merge:  round=33 metric=0.9394 head_norm=1.262745 delta_norm=0.740394
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=34 head_norm_before_train=1.695863 cos_to_last_merge=0.8137 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.814
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.6589722684463086, 'auprc': 0.7291333417322363, 'loss_val': 1.0165525264918194, 'psi': 0.6870366977606797}-{'f1_val': 0.703800110737668, 'auprc': 0.7298366182477158, 'loss_val': 0.8553443676630668, 'psi': 0.7142147137416872}
[S3] START round=34 head_norm_before_train=1.228845 cos_to_last_merge=1.0000 (last merge round=33)
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.9202077603873847, 'auprc': 0.9988822749537745, 'loss_val': 0.22392043756326097, 'psi': 0.9516775662139406}-{'f1_val': 0.9971149325810758, 'auprc': 0.9985541491860428, 'loss_val': 0.14603828257084484, 'psi': 0.9976906192230626}
[S4] START round=34 head_norm_before_train=1.310302 cos_to_last_merge=1.0000 (last merge round=33)
[S4] round=34 local utility u=0.030707 metrics={'f1_val': 0.9413399453824091, 'auprc': 0.9588117267979873, 'loss_val': 0.28774372561360856, 'psi': 0.9483286579486403}-{'f1_val': 0.9412806522130546, 'auprc': 0.9484190946644797, 'loss_val': 0.31762492900003864, 'psi': 0.9441360291936247}
[S5] START round=34 head_norm_before_train=1.600917 cos_to_last_merge=0.8063 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.806
[S5] round=34 local utility u=0.823051 metrics={'f1_val': 0.66104341949592, 'auprc': 0.8542806971425372, 'loss_val': 0.5532632696375159, 'psi': 0.7383383305545669}-{'f1_val': 0.4395318134105323, 'auprc': 0.8559618077970766, 'loss_val': 0.8753389384359068, 'psi': 0.60610381116515}
[S6] START round=34 head_norm_before_train=1.887437 (no previous merge yet)
[S6] round=34 local utility u=0.648667 metrics={'f1_val': 0.9709733808667178, 'auprc': 0.9588029937580015, 'loss_val': 0.10290627955672992, 'psi': 0.9661052260232312}-{'f1_val': 0.8345713517650775, 'auprc': 0.9173151590132672, 'loss_val': 0.4573645737934909, 'psi': 0.8676688746643534}
[S7] START round=34 head_norm_before_train=1.516914 cos_to_last_merge=1.0000 (last merge round=33)
[S7] round=34 local utility u=0.216344 metrics={'f1_val': 0.6915421746739601, 'auprc': 0.8940697749612839, 'loss_val': 0.25325202026919214, 'psi': 0.7725532147888896}-{'f1_val': 0.6692739602054696, 'auprc': 0.8294430932523598, 'loss_val': 0.3584512652896939, 'psi': 0.7333416134242257}
[S8] START round=34 head_norm_before_train=1.742604 cos_to_last_merge=0.7565 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.757
[S8] round=34 local utility u=0.000000 metrics={'f1_val': 0.8813407824341315, 'auprc': 0.999136190778938, 'loss_val': 0.22909246159893576, 'psi': 0.9284589457720541}-{'f1_val': 0.9928249955793521, 'auprc': 0.9987047724988073, 'loss_val': 0.03841200954798526, 'psi': 0.9951769063471342}
[S9] START round=34 head_norm_before_train=1.329575 cos_to_last_merge=0.9911 (last merge round=31)
[S9] round=34 local utility u=0.004841 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9956603971507912, 'loss_val': 0.05053738572190488, 'psi': 0.9965259063676022}-{'f1_val': 0.9966891482978385, 'auprc': 0.9973186300152754, 'loss_val': 0.06271190480894576, 'psi': 0.9969409409848133}
[S10] START round=34 head_norm_before_train=1.416540 cos_to_last_merge=0.9787 (last merge round=30)
[S10] round=34 local utility u=0.014111 metrics={'f1_val': 0.9934496907403657, 'auprc': 0.994656831093824, 'loss_val': 0.08186630768161689, 'psi': 0.993932546881749}-{'f1_val': 0.992750738533037, 'auprc': 0.9950372370319402, 'loss_val': 0.10703671561302305, 'psi': 0.9936653379325984}
[S11] START round=34 head_norm_before_train=1.353061 cos_to_last_merge=0.9991 (last merge round=32)
[S11] round=34 local utility u=0.020485 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9979753584680201, 'loss_val': 0.10517872481721424, 'psi': 0.9969732438685246}-{'f1_val': 0.9965470045135896, 'auprc': 0.9967828984434834, 'loss_val': 0.14402195071886129, 'psi': 0.9966413620855471}
[S13] START round=34 head_norm_before_train=1.202171 cos_to_last_merge=1.0000 (last merge round=33)
[S13] round=34 local utility u=0.062026 metrics={'f1_val': 0.5211050323602016, 'auprc': 0.6864776403809345, 'loss_val': 0.9517509148149229, 'psi': 0.5872540755684947}-{'f1_val': 0.5013691537262815, 'auprc': 0.6938949313016896, 'loss_val': 0.9796404803469045, 'psi': 0.5783794647564447}
[S14] START round=34 head_norm_before_train=1.562939 cos_to_last_merge=0.9967 (last merge round=31)
[S14] round=34 local utility u=0.015078 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9952636313449361, 'loss_val': 0.07994210166082481, 'psi': 0.9965504142390098}-{'f1_val': 0.9961605687915402, 'auprc': 0.9953674331459584, 'loss_val': 0.10292302719637879, 'psi': 0.9958433145333074}
[S15] START round=34 head_norm_before_train=1.573425 cos_to_last_merge=0.9992 (last merge round=32)
[S15] round=34 local utility u=0.582525 metrics={'f1_val': 0.8466648411407092, 'auprc': 0.9945110869133837, 'loss_val': 0.21004760878150583, 'psi': 0.905803339449779}-{'f1_val': 0.6956685911236791, 'auprc': 0.9868539761269872, 'loss_val': 0.4461490061368199, 'psi': 0.8121427451250023}
[S16] START round=34 head_norm_before_train=1.262745 cos_to_last_merge=1.0000 (last merge round=33)
[S16] round=34 local utility u=0.000000 metrics={'f1_val': 0.8559478436513837, 'auprc': 0.9828348325778031, 'loss_val': 0.5364313620386114, 'psi': 0.9067026392219515}-{'f1_val': 0.9388071599413427, 'auprc': 0.9896682715027647, 'loss_val': 0.24064356775047602, 'psi': 0.9591516045659114}
[S17] START round=34 head_norm_before_train=1.142031 cos_to_last_merge=1.0000 (last merge round=33)
[S17] round=34 local utility u=0.000000 metrics={'f1_val': 0.39558024359953026, 'auprc': 0.7586525037205546, 'loss_val': 1.00000661900194, 'psi': 0.54080914764794}-{'f1_val': 0.414785358267739, 'auprc': 0.8323998877171304, 'loss_val': 0.9253259689560372, 'psi': 0.5818311700474955}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S13@127.0.0.1:42013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:42002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:42003
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:42007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:42014
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:42008
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:42004
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1803) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.460932)
[S4] loaded HEAD from S10 (vec_in norm=1.460932)
[S4] cosine check vs S10: cos=0.9763
[S4] BUFFERED delta from S10 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1801) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.601082)
[S7] loaded HEAD from S14 (vec_in norm=1.601082)
[S7] cosine check vs S14: cos=0.9952
[S7] BUFFERED delta from S14 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1802) from S13
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.224061)
[S2] loaded HEAD from S13 (vec_in norm=1.224061)
[S2] cosine check vs S13: cos=0.7149
[S2] BUFFERED delta from S13 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1804) from S4
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.346797)
[S13] loaded HEAD from S4 (vec_in norm=1.346797)
[S13] cosine check vs S4: cos=0.9623
[S13] BUFFERED delta from S4 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1800) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.374240)
[S3] loaded HEAD from S9 (vec_in norm=1.374240)
[S3] cosine check vs S9: cos=0.9797
[S3] BUFFERED delta from S9 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1799) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.609179)
[S14] loaded HEAD from S15 (vec_in norm=1.609179)
[S14] cosine check vs S15: cos=0.9945
[S14] BUFFERED delta from S15 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1800) from S11
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.394774)
[S6] loaded HEAD from S11 (vec_in norm=1.394774)
[S6] cosine check vs S11: cos=0.5444
[S6] BUFFERED delta from S11 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=34 metric=0.9710 head_norm=1.892842
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.145350e-01
[S6] stored merged vector for next round verification (round=34)
[S6] DEBUG after merge:  round=34 metric=0.9655 head_norm=1.449364 delta_norm=0.814535
[S6] aggregate: ROLLBACK (f1_val pre=0.971 post=0.966 tol_abs=0.005 tol_rel=0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=34 metric=0.6590 head_norm=1.703061
[S2] _apply_head_vector_avg (torch): Δ‖w‖=5.954229e-01
[S2] stored merged vector for next round verification (round=34)
[S2] DEBUG after merge:  round=34 metric=0.6567 head_norm=1.358250 delta_norm=0.595423
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=34 metric=0.6915 head_norm=1.523015
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.599929e-02
[S7] stored merged vector for next round verification (round=34)
[S7] DEBUG after merge:  round=34 metric=0.6929 head_norm=1.560168 delta_norm=0.085999
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=34 metric=0.9202 head_norm=1.292261
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.403282e-01
[S3] stored merged vector for next round verification (round=34)
[S3] DEBUG after merge:  round=34 metric=0.9191 head_norm=1.326478 delta_norm=0.140328
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=34 metric=0.5211 head_norm=1.224061
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.866470e-01
[S13] stored merged vector for next round verification (round=34)
[S13] DEBUG after merge:  round=34 metric=0.5216 head_norm=1.273286 delta_norm=0.186647
[S13] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=34 metric=0.9974 head_norm=1.601082
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.441149e-02
[S14] stored merged vector for next round verification (round=34)
[S14] DEBUG after merge:  round=34 metric=0.9974 head_norm=1.602914 delta_norm=0.084411
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=34 metric=0.9413 head_norm=1.346797
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.631173e-01
[S4] stored merged vector for next round verification (round=34)
[S4] DEBUG after merge:  round=34 metric=0.9413 head_norm=1.395523 delta_norm=0.163117
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=35 head_norm_before_train=1.358250 cos_to_last_merge=1.0000 (last merge round=34)
[S2] round=35 local utility u=0.262356 metrics={'f1_val': 0.703912615163569, 'auprc': 0.721244963242439, 'loss_val': 0.7378166873369643, 'psi': 0.710845554395117}-{'f1_val': 0.6589722684463086, 'auprc': 0.7291333417322363, 'loss_val': 1.0165525264918194, 'psi': 0.6870366977606797}
[S3] START round=35 head_norm_before_train=1.326478 cos_to_last_merge=1.0000 (last merge round=34)
[S3] round=35 local utility u=0.312454 metrics={'f1_val': 0.9973696976584205, 'auprc': 0.9967629715488526, 'loss_val': 0.05562641821071921, 'psi': 0.9971270072145934}-{'f1_val': 0.9202077603873847, 'auprc': 0.9988822749537745, 'loss_val': 0.22392043756326097, 'psi': 0.9516775662139406}
[S4] START round=35 head_norm_before_train=1.395523 cos_to_last_merge=1.0000 (last merge round=34)
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.9427073035070077, 'auprc': 0.9477303595047211, 'loss_val': 0.27981675021556945, 'psi': 0.944716525906093}-{'f1_val': 0.9413399453824091, 'auprc': 0.9588117267979873, 'loss_val': 0.28774372561360856, 'psi': 0.9483286579486403}
[S5] START round=35 head_norm_before_train=1.604981 cos_to_last_merge=0.8056 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.806
[S5] round=35 local utility u=0.000000 metrics={'f1_val': 0.5108896837797943, 'auprc': 0.8542682596993793, 'loss_val': 0.8168663183754477, 'psi': 0.6482411141476283}-{'f1_val': 0.66104341949592, 'auprc': 0.8542806971425372, 'loss_val': 0.5532632696375159, 'psi': 0.7383383305545669}
[S6] START round=35 head_norm_before_train=1.449364 cos_to_last_merge=1.0000 (last merge round=34)
[S6] round=35 local utility u=0.000000 metrics={'f1_val': 0.7336270558316259, 'auprc': 0.7851692879970844, 'loss_val': 0.5930348998760138, 'psi': 0.7542439486978094}-{'f1_val': 0.9709733808667178, 'auprc': 0.9588029937580015, 'loss_val': 0.10290627955672992, 'psi': 0.9661052260232312}
[S7] START round=35 head_norm_before_train=1.560168 cos_to_last_merge=1.0000 (last merge round=34)
[S7] round=35 local utility u=0.000000 metrics={'f1_val': 0.5776115856162645, 'auprc': 0.7846558691377196, 'loss_val': 0.7299841966336496, 'psi': 0.6604292990248466}-{'f1_val': 0.6915421746739601, 'auprc': 0.8940697749612839, 'loss_val': 0.25325202026919214, 'psi': 0.7725532147888896}
[S8] START round=35 head_norm_before_train=1.754881 cos_to_last_merge=0.7553 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.755
[S8] round=35 local utility u=0.416144 metrics={'f1_val': 0.9935326376274699, 'auprc': 0.9890835858984708, 'loss_val': 0.03979782004622566, 'psi': 0.9917530169358703}-{'f1_val': 0.8813407824341315, 'auprc': 0.999136190778938, 'loss_val': 0.22909246159893576, 'psi': 0.9284589457720541}
[S9] START round=35 head_norm_before_train=1.374240 cos_to_last_merge=0.9869 (last merge round=31)
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.9939457934366372, 'auprc': 0.995900942704148, 'loss_val': 0.0495554694297083, 'psi': 0.9947278531436416}-{'f1_val': 0.9971029125121428, 'auprc': 0.9956603971507912, 'loss_val': 0.05053738572190488, 'psi': 0.9965259063676022}
[S10] START round=35 head_norm_before_train=1.460932 cos_to_last_merge=0.9709 (last merge round=30)
[S10] round=35 local utility u=0.001841 metrics={'f1_val': 0.9931477914946747, 'auprc': 0.9951556151583447, 'loss_val': 0.0778695951218353, 'psi': 0.9939509209601427}-{'f1_val': 0.9934496907403657, 'auprc': 0.994656831093824, 'loss_val': 0.08186630768161689, 'psi': 0.993932546881749}
[S11] START round=35 head_norm_before_train=1.394774 cos_to_last_merge=0.9961 (last merge round=32)
[S11] round=35 local utility u=0.012172 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9980426799463077, 'loss_val': 0.08103686207542538, 'psi': 0.9970001724598396}-{'f1_val': 0.996305167468861, 'auprc': 0.9979753584680201, 'loss_val': 0.10517872481721424, 'psi': 0.9969732438685246}
[S13] START round=35 head_norm_before_train=1.273286 cos_to_last_merge=1.0000 (last merge round=34)
[S13] round=35 local utility u=0.155051 metrics={'f1_val': 0.5688793646328731, 'auprc': 0.6651080511902071, 'loss_val': 0.864185685931523, 'psi': 0.6073708392558068}-{'f1_val': 0.5211050323602016, 'auprc': 0.6864776403809345, 'loss_val': 0.9517509148149229, 'psi': 0.5872540755684947}
[S14] START round=35 head_norm_before_train=1.602914 cos_to_last_merge=1.0000 (last merge round=34)
[S14] round=35 local utility u=0.011966 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9982393755795836, 'loss_val': 0.06493660354096155, 'psi': 0.9977407119328688}-{'f1_val': 0.9974082695017256, 'auprc': 0.9952636313449361, 'loss_val': 0.07994210166082481, 'psi': 0.9965504142390098}
[S15] START round=35 head_norm_before_train=1.609179 cos_to_last_merge=0.9971 (last merge round=32)
[S15] round=35 local utility u=0.475405 metrics={'f1_val': 0.986065803985934, 'auprc': 0.9937217280078758, 'loss_val': 0.0932756505928868, 'psi': 0.9891281735947107}-{'f1_val': 0.8466648411407092, 'auprc': 0.9945110869133837, 'loss_val': 0.21004760878150583, 'psi': 0.905803339449779}
[S16] START round=35 head_norm_before_train=1.294700 cos_to_last_merge=0.9994 (last merge round=33)
[S16] round=35 local utility u=0.510745 metrics={'f1_val': 0.9623278103699493, 'auprc': 0.9878767105750106, 'loss_val': 0.1683463681481493, 'psi': 0.9725473704519738}-{'f1_val': 0.8559478436513837, 'auprc': 0.9828348325778031, 'loss_val': 0.5364313620386114, 'psi': 0.9067026392219515}
[S17] START round=35 head_norm_before_train=1.157522 cos_to_last_merge=0.9998 (last merge round=33)
[S17] round=35 local utility u=0.218182 metrics={'f1_val': 0.457330155674708, 'auprc': 0.7078612037246738, 'loss_val': 0.7817687985537174, 'psi': 0.5575425748946943}-{'f1_val': 0.39558024359953026, 'auprc': 0.7586525037205546, 'loss_val': 1.00000661900194, 'psi': 0.54080914764794}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S8] sending update (kind=head size=1808 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:42008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:42005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:42004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:42007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:42014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:42002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:42017
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1799) from S16
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.338398)
[S5] loaded HEAD from S16 (vec_in norm=1.338398)
[S5] cosine check vs S16: cos=0.9150
[S5] BUFFERED delta from S16 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1801) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.638908)
[S14] loaded HEAD from S15 (vec_in norm=1.638908)
[S14] cosine check vs S15: cos=0.9968
[S14] BUFFERED delta from S15 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1799) from S3
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.358034)
[S17] loaded HEAD from S3 (vec_in norm=1.358034)
[S17] cosine check vs S3: cos=0.9800
[S17] BUFFERED delta from S3 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1798) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.638270)
[S7] loaded HEAD from S14 (vec_in norm=1.638270)
[S7] cosine check vs S14: cos=0.9960
[S7] BUFFERED delta from S14 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1798) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.498200)
[S4] loaded HEAD from S10 (vec_in norm=1.498200)
[S4] cosine check vs S10: cos=0.9905
[S4] BUFFERED delta from S10 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1801) from S11
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.437346)
[S6] loaded HEAD from S11 (vec_in norm=1.437346)
[S6] cosine check vs S11: cos=0.8395
[S6] BUFFERED delta from S11 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1798) from S13
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.286707)
[S2] loaded HEAD from S13 (vec_in norm=1.286707)
[S2] cosine check vs S13: cos=0.8619
[S2] BUFFERED delta from S13 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:42016
[S17] sending update (kind=head size=1803 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1803) from S17
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.175707)
[S16] loaded HEAD from S17 (vec_in norm=1.175707)
[S16] cosine check vs S17: cos=0.7232
[S16] BUFFERED delta from S17 (total buffered=1)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=35 metric=0.7039 head_norm=1.371681
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.516516e-01
[S2] stored merged vector for next round verification (round=35)
[S2] DEBUG after merge:  round=35 metric=0.6952 head_norm=1.282538 delta_norm=0.351652
[S2] aggregate: ROLLBACK (f1_val pre=0.704 post=0.695 tol_abs=0.005 tol_rel=0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=35 metric=0.5776 head_norm=1.561334
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.108561e-02
[S7] stored merged vector for next round verification (round=35)
[S7] DEBUG after merge:  round=35 metric=0.5792 head_norm=1.598209 delta_norm=0.081086
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.011 → S3@127.0.0.1:42003
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=35 metric=0.9427 head_norm=1.425291
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.068902e-01
[S4] stored merged vector for next round verification (round=35)
[S4] DEBUG after merge:  round=35 metric=0.9431 head_norm=1.458287 delta_norm=0.106890
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.022 → S13@127.0.0.1:42013
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=35 metric=0.7336 head_norm=1.468267
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.117677e-01
[S6] stored merged vector for next round verification (round=35)
[S6] DEBUG after merge:  round=35 metric=0.7266 head_norm=1.393317 delta_norm=0.411768
[S6] aggregate: ROLLBACK (f1_val pre=0.734 post=0.727 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=35 metric=0.5109 head_norm=1.614069
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.329177e-01
[S5] stored merged vector for next round verification (round=35)
[S5] DEBUG after merge:  round=35 metric=0.5341 head_norm=1.444794 delta_norm=0.332918
[S5] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.115 → S17@127.0.0.1:42017
[S11] ⇄ pheromone p=0.017 → S6@127.0.0.1:42007
[S15] ⇄ pheromone p=0.429 → S14@127.0.0.1:42014
[S13] ⇄ pheromone p=0.103 → S2@127.0.0.1:42002
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=35 metric=0.9623 head_norm=1.338398
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.736797e-01
[S16] stored merged vector for next round verification (round=35)
[S16] DEBUG after merge:  round=35 metric=0.9738 head_norm=1.167230 delta_norm=0.473680
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.178 → S5@127.0.0.1:42005
[S10] ⇄ pheromone p=0.022 → S4@127.0.0.1:42004
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=35 metric=0.9974 head_norm=1.638270
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.529021e-02
[S14] stored merged vector for next round verification (round=35)
[S14] DEBUG after merge:  round=35 metric=0.9974 head_norm=1.637288 delta_norm=0.065290
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.010 → S7@127.0.0.1:42008
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=35 metric=0.4573 head_norm=1.175707
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.559238e-01
[S17] stored merged vector for next round verification (round=35)
[S17] DEBUG after merge:  round=35 metric=0.4583 head_norm=1.260539 delta_norm=0.155924
[S17] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.124 → S16@127.0.0.1:42016
[S2] START round=36 head_norm_before_train=1.282538 cos_to_last_merge=1.0000 (last merge round=35)
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.6818421358777244, 'auprc': 0.7139560837000136, 'loss_val': 0.7043080714245843, 'psi': 0.6946877150066401}-{'f1_val': 0.703912615163569, 'auprc': 0.721244963242439, 'loss_val': 0.7378166873369643, 'psi': 0.710845554395117}
[S3] START round=36 head_norm_before_train=1.358034 cos_to_last_merge=0.9998 (last merge round=34)
[S3] round=36 local utility u=0.000000 metrics={'f1_val': 0.9800762122012004, 'auprc': 0.9986391082469595, 'loss_val': 0.0796177488198036, 'psi': 0.987501370619504}-{'f1_val': 0.9973696976584205, 'auprc': 0.9967629715488526, 'loss_val': 0.05562641821071921, 'psi': 0.9971270072145934}
[S4] START round=36 head_norm_before_train=1.458287 cos_to_last_merge=1.0000 (last merge round=35)
[S4] round=36 local utility u=0.000000 metrics={'f1_val': 0.9456371368076301, 'auprc': 0.9326429450520565, 'loss_val': 0.28032371234698433, 'psi': 0.9404394601054006}-{'f1_val': 0.9427073035070077, 'auprc': 0.9477303595047211, 'loss_val': 0.27981675021556945, 'psi': 0.944716525906093}
[S5] START round=36 head_norm_before_train=1.444794 cos_to_last_merge=1.0000 (last merge round=35)
[S5] round=36 local utility u=0.550477 metrics={'f1_val': 0.6318694259937426, 'auprc': 0.8687946804052219, 'loss_val': 0.4853691643823517, 'psi': 0.7266395277583344}-{'f1_val': 0.5108896837797943, 'auprc': 0.8542682596993793, 'loss_val': 0.8168663183754477, 'psi': 0.6482411141476283}
[S6] START round=36 head_norm_before_train=1.393317 cos_to_last_merge=1.0000 (last merge round=35)
[S6] round=36 local utility u=1.000000 metrics={'f1_val': 0.9775831794526606, 'auprc': 0.9661358531439467, 'loss_val': 0.1929897083973974, 'psi': 0.973004248929175}-{'f1_val': 0.7336270558316259, 'auprc': 0.7851692879970844, 'loss_val': 0.5930348998760138, 'psi': 0.7542439486978094}
[S7] START round=36 head_norm_before_train=1.598209 cos_to_last_merge=1.0000 (last merge round=35)
[S7] round=36 local utility u=0.394820 metrics={'f1_val': 0.6636433060794705, 'auprc': 0.8020432333480946, 'loss_val': 0.5086966939889674, 'psi': 0.7190032769869201}-{'f1_val': 0.5776115856162645, 'auprc': 0.7846558691377196, 'loss_val': 0.7299841966336496, 'psi': 0.6604292990248466}
[S8] START round=36 head_norm_before_train=1.767890 cos_to_last_merge=0.7538 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.754
[S8] round=36 local utility u=0.000000 metrics={'f1_val': 0.9795046407817054, 'auprc': 0.9991568318373207, 'loss_val': 0.06833465595493685, 'psi': 0.9873655172039515}-{'f1_val': 0.9935326376274699, 'auprc': 0.9890835858984708, 'loss_val': 0.03979782004622566, 'psi': 0.9917530169358703}
[S9] START round=36 head_norm_before_train=1.410268 cos_to_last_merge=0.9833 (last merge round=31)
[S9] round=36 local utility u=0.014036 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9961903348703569, 'loss_val': 0.03883195875196967, 'psi': 0.996491628707}-{'f1_val': 0.9939457934366372, 'auprc': 0.995900942704148, 'loss_val': 0.0495554694297083, 'psi': 0.9947278531436416}
[S10] START round=36 head_norm_before_train=1.498200 cos_to_last_merge=0.9646 (last merge round=30)
[S10] round=36 local utility u=0.000000 metrics={'f1_val': 0.9917881952137699, 'auprc': 0.9928528724662792, 'loss_val': 0.06701769390394356, 'psi': 0.9922140661147736}-{'f1_val': 0.9931477914946747, 'auprc': 0.9951556151583447, 'loss_val': 0.0778695951218353, 'psi': 0.9939509209601427}
[S11] START round=36 head_norm_before_train=1.437346 cos_to_last_merge=0.9922 (last merge round=32)
[S11] round=36 local utility u=0.007254 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9980099374042586, 'loss_val': 0.06643002434106215, 'psi': 0.99698707544302}-{'f1_val': 0.996305167468861, 'auprc': 0.9980426799463077, 'loss_val': 0.08103686207542538, 'psi': 0.9970001724598396}
[S13] START round=36 head_norm_before_train=1.286707 cos_to_last_merge=0.9993 (last merge round=34)
[S13] round=36 local utility u=0.000000 metrics={'f1_val': 0.5210092226213847, 'auprc': 0.6776259023770271, 'loss_val': 0.9509296381096283, 'psi': 0.5836558945236416}-{'f1_val': 0.5688793646328731, 'auprc': 0.6651080511902071, 'loss_val': 0.864185685931523, 'psi': 0.6073708392558068}
[S14] START round=36 head_norm_before_train=1.637288 cos_to_last_merge=1.0000 (last merge round=35)
[S14] round=36 local utility u=0.003084 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9977353079642212, 'loss_val': 0.056249549774969335, 'psi': 0.9974383372091643}-{'f1_val': 0.9974082695017256, 'auprc': 0.9982393755795836, 'loss_val': 0.06493660354096155, 'psi': 0.9977407119328688}
[S15] START round=36 head_norm_before_train=1.638908 cos_to_last_merge=0.9946 (last merge round=32)
[S15] round=36 local utility u=0.016747 metrics={'f1_val': 0.9892712603578524, 'auprc': 0.9977747974776103, 'loss_val': 0.09117388975437217, 'psi': 0.9926726752057555}-{'f1_val': 0.986065803985934, 'auprc': 0.9937217280078758, 'loss_val': 0.0932756505928868, 'psi': 0.9891281735947107}
[S16] START round=36 head_norm_before_train=1.167230 cos_to_last_merge=1.0000 (last merge round=35)
[S16] round=36 local utility u=0.064582 metrics={'f1_val': 0.989410854019322, 'auprc': 0.9844196264866882, 'loss_val': 0.19131003963196527, 'psi': 0.9874143630062685}-{'f1_val': 0.9623278103699493, 'auprc': 0.9878767105750106, 'loss_val': 0.1683463681481493, 'psi': 0.9725473704519738}
[S17] START round=36 head_norm_before_train=1.260539 cos_to_last_merge=1.0000 (last merge round=35)
[S17] round=36 local utility u=0.000000 metrics={'f1_val': 0.38176128722179486, 'auprc': 0.5903906822673897, 'loss_val': 1.1269474161321622, 'psi': 0.4652130452400328}-{'f1_val': 0.457330155674708, 'auprc': 0.7078612037246738, 'loss_val': 0.7817687985537174, 'psi': 0.5575425748946943}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:42003
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:42016
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:42014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:42012
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1800) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.445003)
[S3] loaded HEAD from S9 (vec_in norm=1.445003)
[S3] cosine check vs S9: cos=0.9909
[S3] BUFFERED delta from S9 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1800) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.436751)
[S11] loaded HEAD from S6 (vec_in norm=1.436751)
[S11] cosine check vs S6: cos=0.9531
[S11] BUFFERED delta from S6 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1802) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.602209)
[S14] loaded HEAD from S7 (vec_in norm=1.602209)
[S14] cosine check vs S7: cos=0.9967
[S14] BUFFERED delta from S7 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1798) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.457604)
[S16] loaded HEAD from S5 (vec_in norm=1.457604)
[S16] cosine check vs S5: cos=0.8629
[S16] BUFFERED delta from S5 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:42007
[S11] sending update (kind=head size=1799 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1799) from S11
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.475847)
[S6] loaded HEAD from S11 (vec_in norm=1.475847)
[S6] cosine check vs S11: cos=0.9531
[S6] BUFFERED delta from S11 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:42015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:42005
[S14] sending update (kind=head size=1795 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] RECEIVED delta(kind=head bytes=1795) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.668736)
[S15] loaded HEAD from S14 (vec_in norm=1.668736)
[S15] cosine check vs S14: cos=0.9980
[S15] BUFFERED delta from S14 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:42014
[S16] sending update (kind=head size=1796 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1796) from S16
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.222694)
[S5] loaded HEAD from S16 (vec_in norm=1.222694)
[S5] cosine check vs S16: cos=0.8629
[S5] BUFFERED delta from S16 (total buffered=1)
[S15] sending update (kind=head size=1796 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1796) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.664759)
[S14] loaded HEAD from S15 (vec_in norm=1.664759)
[S14] cosine check vs S15: cos=0.9980
[S14] BUFFERED delta from S15 (total buffered=2)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=36 metric=0.9801 head_norm=1.381868
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.001812e-01
[S3] stored merged vector for next round verification (round=36)
[S3] DEBUG after merge:  round=36 metric=0.9757 head_norm=1.410234 delta_norm=0.100181
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=36 metric=0.9776 head_norm=1.436751
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.239335e-01
[S6] stored merged vector for next round verification (round=36)
[S6] DEBUG after merge:  round=36 metric=0.9780 head_norm=1.439112 delta_norm=0.223934
[S6] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=36 metric=0.6319 head_norm=1.457604
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.687712e-01
[S5] stored merged vector for next round verification (round=36)
[S5] DEBUG after merge:  round=36 metric=0.6409 head_norm=1.293755 delta_norm=0.368771
[S5] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=36 metric=0.9963 head_norm=1.475847
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.239335e-01
[S11] stored merged vector for next round verification (round=36)
[S11] DEBUG after merge:  round=36 metric=0.9965 head_norm=1.439112 delta_norm=0.223934
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=36 metric=0.9972 head_norm=1.668736
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.484517e-02
[S14] stored merged vector for next round verification (round=36)
[S14] DEBUG after merge:  round=36 metric=0.9972 head_norm=1.649221 delta_norm=0.034845
[S14] aggregate: ACCEPT kept=['S7', 'S15'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=36 metric=0.9894 head_norm=1.222694
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.687712e-01
[S16] stored merged vector for next round verification (round=36)
[S16] DEBUG after merge:  round=36 metric=0.9892 head_norm=1.293755 delta_norm=0.368771
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=36 metric=0.9893 head_norm=1.664759
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.227327e-02
[S15] stored merged vector for next round verification (round=36)
[S15] DEBUG after merge:  round=36 metric=0.9891 head_norm=1.665928 delta_norm=0.052273
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=37 head_norm_before_train=1.308379 cos_to_last_merge=0.9993 (last merge round=35)
[S2] round=37 local utility u=0.000000 metrics={'f1_val': 0.6742785570889032, 'auprc': 0.7061993170733742, 'loss_val': 0.7778989671911248, 'psi': 0.6870468610826916}-{'f1_val': 0.6818421358777244, 'auprc': 0.7139560837000136, 'loss_val': 0.7043080714245843, 'psi': 0.6946877150066401}
[S3] START round=37 head_norm_before_train=1.410234 cos_to_last_merge=1.0000 (last merge round=36)
[S3] round=37 local utility u=0.067851 metrics={'f1_val': 0.9973696976584205, 'auprc': 0.9973211703395054, 'loss_val': 0.04372202894655586, 'psi': 0.9973502867308545}-{'f1_val': 0.9800762122012004, 'auprc': 0.9986391082469595, 'loss_val': 0.0796177488198036, 'psi': 0.987501370619504}
[S4] START round=37 head_norm_before_train=1.483553 cos_to_last_merge=0.9998 (last merge round=35)
[S4] round=37 local utility u=0.044562 metrics={'f1_val': 0.9441484481813942, 'auprc': 0.9621470680284693, 'loss_val': 0.27077964898967183, 'psi': 0.9513478961202243}-{'f1_val': 0.9456371368076301, 'auprc': 0.9326429450520565, 'loss_val': 0.28032371234698433, 'psi': 0.9404394601054006}
[S5] START round=37 head_norm_before_train=1.293755 cos_to_last_merge=1.0000 (last merge round=36)
[S5] round=37 local utility u=0.496419 metrics={'f1_val': 0.7017729049353254, 'auprc': 0.9897168925753312, 'loss_val': 0.2747179691865026, 'psi': 0.8169504999913277}-{'f1_val': 0.6318694259937426, 'auprc': 0.8687946804052219, 'loss_val': 0.4853691643823517, 'psi': 0.7266395277583344}
[S6] START round=37 head_norm_before_train=1.439112 cos_to_last_merge=1.0000 (last merge round=36)
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.7954509039606272, 'auprc': 0.8165109844229457, 'loss_val': 0.4765898805663235, 'psi': 0.8038749361455546}-{'f1_val': 0.9775831794526606, 'auprc': 0.9661358531439467, 'loss_val': 0.1929897083973974, 'psi': 0.973004248929175}
[S7] START round=37 head_norm_before_train=1.602209 cos_to_last_merge=1.0000 (last merge round=35)
[S7] round=37 local utility u=0.294905 metrics={'f1_val': 0.696256421413034, 'auprc': 0.858704132061564, 'loss_val': 0.2845480383956943, 'psi': 0.761235505672446}-{'f1_val': 0.6636433060794705, 'auprc': 0.8020432333480946, 'loss_val': 0.5086966939889674, 'psi': 0.7190032769869201}
[S8] START round=37 head_norm_before_train=1.780932 cos_to_last_merge=0.7521 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.752
[S8] round=37 local utility u=0.050584 metrics={'f1_val': 0.9914588715117574, 'auprc': 0.9991175084428163, 'loss_val': 0.03877319334523566, 'psi': 0.9945223262841809}-{'f1_val': 0.9795046407817054, 'auprc': 0.9991568318373207, 'loss_val': 0.06833465595493685, 'psi': 0.9873655172039515}
[S9] START round=37 head_norm_before_train=1.445003 cos_to_last_merge=0.9799 (last merge round=31)
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.9947496160742828, 'auprc': 0.9968036085669401, 'loss_val': 0.03901444831573368, 'psi': 0.9955712130713458}-{'f1_val': 0.9966924912647621, 'auprc': 0.9961903348703569, 'loss_val': 0.03883195875196967, 'psi': 0.996491628707}
[S10] START round=37 head_norm_before_train=1.527228 cos_to_last_merge=0.9603 (last merge round=30)
[S10] round=37 local utility u=0.000847 metrics={'f1_val': 0.9914233014595196, 'auprc': 0.9959194369027182, 'loss_val': 0.07233372579138386, 'psi': 0.993221755636799}-{'f1_val': 0.9917881952137699, 'auprc': 0.9928528724662792, 'loss_val': 0.06701769390394356, 'psi': 0.9922140661147736}
[S11] START round=37 head_norm_before_train=1.439112 cos_to_last_merge=1.0000 (last merge round=36)
[S11] round=37 local utility u=0.002284 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9974699724031146, 'loss_val': 0.060241461507144045, 'psi': 0.9967710894425624}-{'f1_val': 0.996305167468861, 'auprc': 0.9980099374042586, 'loss_val': 0.06643002434106215, 'psi': 0.99698707544302}
[S13] START round=37 head_norm_before_train=1.297724 cos_to_last_merge=0.9975 (last merge round=34)
[S13] round=37 local utility u=0.201988 metrics={'f1_val': 0.5742915798666346, 'auprc': 0.678618400176511, 'loss_val': 0.8696244971204785, 'psi': 0.6160223079905851}-{'f1_val': 0.5210092226213847, 'auprc': 0.6776259023770271, 'loss_val': 0.9509296381096283, 'psi': 0.5836558945236416}
[S14] START round=37 head_norm_before_train=1.649221 cos_to_last_merge=1.0000 (last merge round=36)
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.9715648023988184, 'auprc': 0.9988246137929744, 'loss_val': 0.07487309031567342, 'psi': 0.9824687269564807}-{'f1_val': 0.997240356705793, 'auprc': 0.9977353079642212, 'loss_val': 0.056249549774969335, 'psi': 0.9974383372091643}
[S15] START round=37 head_norm_before_train=1.665928 cos_to_last_merge=1.0000 (last merge round=36)
[S15] round=37 local utility u=0.000000 metrics={'f1_val': 0.8607703039353065, 'auprc': 0.995674544970005, 'loss_val': 0.21176070633101254, 'psi': 0.9147320003491859}-{'f1_val': 0.9892712603578524, 'auprc': 0.9977747974776103, 'loss_val': 0.09117388975437217, 'psi': 0.9926726752057555}
[S16] START round=37 head_norm_before_train=1.293755 cos_to_last_merge=1.0000 (last merge round=36)
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.9340158332361271, 'auprc': 0.9885565027642901, 'loss_val': 0.2839724231583964, 'psi': 0.9558321010473922}-{'f1_val': 0.989410854019322, 'auprc': 0.9844196264866882, 'loss_val': 0.19131003963196527, 'psi': 0.9874143630062685}
[S17] START round=37 head_norm_before_train=1.274826 cos_to_last_merge=0.9999 (last merge round=35)
[S17] round=37 local utility u=1.000000 metrics={'f1_val': 0.664762235675959, 'auprc': 0.8281460445370227, 'loss_val': 0.7234056433738643, 'psi': 0.7301157592203845}-{'f1_val': 0.38176128722179486, 'auprc': 0.5903906822673897, 'loss_val': 1.1269474161321622, 'psi': 0.4652130452400328}
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S17]  timeout peer S2
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S11
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S16
[S11]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S16
[S14]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S16
[S15]  timeout peer S17
[S13]  timeout peer S3
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:42007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S4@127.0.0.1:42004
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:42016
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S7] → sending delta(kind=head bytes=1808) to S14@127.0.0.1:42014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] → sending delta(kind=head bytes=1805) to S2@127.0.0.1:42002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] sending update (kind=head size=1805 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S3] → sending delta(kind=head bytes=1791) to S17@127.0.0.1:42017
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S4] → sending delta(kind=head bytes=1808) to S13@127.0.0.1:42013
[S3] sending update (kind=head size=1791 to 1 peers)
[S4] sending update (kind=head size=1808 to 1 peers)
[S13] sending update (kind=head size=1805 to 1 peers)
[S7] sending update (kind=head size=1808 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1805 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1797) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.309066)
[S16] loaded HEAD from S5 (vec_in norm=1.309066)
[S16] cosine check vs S5: cos=0.9987
[S16] BUFFERED delta from S5 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1799) from S11
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.468938)
[S6] loaded HEAD from S11 (vec_in norm=1.468938)
[S6] cosine check vs S11: cos=0.9990
[S6] BUFFERED delta from S11 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1805) from S13
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.309798)
[S2] loaded HEAD from S13 (vec_in norm=1.309798)
[S2] cosine check vs S13: cos=0.9419
[S2] BUFFERED delta from S13 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1805) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.549266)
[S4] loaded HEAD from S10 (vec_in norm=1.549266)
[S4] cosine check vs S10: cos=0.9933
[S4] BUFFERED delta from S10 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1808) from S4
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.507589)
[S13] loaded HEAD from S4 (vec_in norm=1.507589)
[S13] cosine check vs S4: cos=0.9463
[S13] BUFFERED delta from S4 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1791) from S3
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.438950)
[S17] loaded HEAD from S3 (vec_in norm=1.438950)
[S17] cosine check vs S3: cos=0.9882
[S17] BUFFERED delta from S3 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1808) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.607738)
[S14] loaded HEAD from S7 (vec_in norm=1.607738)
[S14] cosine check vs S7: cos=0.9968
[S14] BUFFERED delta from S7 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:42016
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=37 metric=0.9716 head_norm=1.675767
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.393416e-02
[S14] stored merged vector for next round verification (round=37)
[S14] DEBUG after merge:  round=37 metric=0.9684 head_norm=1.640440 delta_norm=0.073934
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S17] sending update (kind=head size=1795 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1795) from S17
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.286395)
[S16] loaded HEAD from S17 (vec_in norm=1.286395)
[S16] cosine check vs S17: cos=0.7082
[S16] BUFFERED delta from S17 (total buffered=2)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=37 metric=0.9441 head_norm=1.507589
[S4] _apply_head_vector_avg (torch): Δ‖w‖=9.117505e-02
[S4] stored merged vector for next round verification (round=37)
[S4] DEBUG after merge:  round=37 metric=0.9441 head_norm=1.525848 delta_norm=0.091175
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=37 metric=0.9340 head_norm=1.360178
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.650406e-01
[S16] stored merged vector for next round verification (round=37)
[S16] DEBUG after merge:  round=37 metric=0.9351 head_norm=1.256557 delta_norm=0.265041
[S16] aggregate: ACCEPT kept=['S5', 'S17'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=37 metric=0.5743 head_norm=1.309798
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.506511e-01
[S13] stored merged vector for next round verification (round=37)
[S13] DEBUG after merge:  round=37 metric=0.5588 head_norm=1.389738 delta_norm=0.250651
[S13] aggregate: ROLLBACK (f1_val pre=0.574 post=0.559 tol_abs=0.005 tol_rel=0.0)
[S17] CommDone barrier timeout: have=2 need=3 — continuing
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=37 metric=0.6648 head_norm=1.286395
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.293983e-01
[S17] stored merged vector for next round verification (round=37)
[S17] DEBUG after merge:  round=37 metric=0.6531 head_norm=1.358658 delta_norm=0.129398
[S17] aggregate: ROLLBACK (f1_val pre=0.665 post=0.653 tol_abs=0.005 tol_rel=0.0)
[S2] START round=38 head_norm_before_train=1.344300 cos_to_last_merge=0.9965 (last merge round=35)
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.6509216596291932, 'auprc': 0.6982491417029408, 'loss_val': 0.8979687513267218, 'psi': 0.6698526524586923}-{'f1_val': 0.6742785570889032, 'auprc': 0.7061993170733742, 'loss_val': 0.7778989671911248, 'psi': 0.6870468610826916}
[S3] START round=38 head_norm_before_train=1.438950 cos_to_last_merge=0.9999 (last merge round=36)
[S3] round=38 local utility u=0.000000 metrics={'f1_val': 0.9314849014039699, 'auprc': 0.9989646469238891, 'loss_val': 0.20095092320889793, 'psi': 0.9584767996119375}-{'f1_val': 0.9973696976584205, 'auprc': 0.9973211703395054, 'loss_val': 0.04372202894655586, 'psi': 0.9973502867308545}
[S4] START round=38 head_norm_before_train=1.525848 cos_to_last_merge=1.0000 (last merge round=37)
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.9398048314868463, 'auprc': 0.9185724413655056, 'loss_val': 0.2876165237652963, 'psi': 0.9313118754383101}-{'f1_val': 0.9441484481813942, 'auprc': 0.9621470680284693, 'loss_val': 0.27077964898967183, 'psi': 0.9513478961202243}
[S5] START round=38 head_norm_before_train=1.309066 cos_to_last_merge=0.9998 (last merge round=36)
[S5] round=38 local utility u=0.743599 metrics={'f1_val': 0.9376952748738372, 'auprc': 0.9882083747394839, 'loss_val': 0.19852873743666266, 'psi': 0.9579005148200959}-{'f1_val': 0.7017729049353254, 'auprc': 0.9897168925753312, 'loss_val': 0.2747179691865026, 'psi': 0.8169504999913277}
[S6] START round=38 head_norm_before_train=1.487069 cos_to_last_merge=0.9990 (last merge round=36)
[S6] round=38 local utility u=0.000000 metrics={'f1_val': 0.6020971582760041, 'auprc': 0.7563571208275192, 'loss_val': 0.8069304700530423, 'psi': 0.6638011432966101}-{'f1_val': 0.7954509039606272, 'auprc': 0.8165109844229457, 'loss_val': 0.4765898805663235, 'psi': 0.8038749361455546}
[S7] START round=38 head_norm_before_train=1.607738 cos_to_last_merge=1.0000 (last merge round=35)
[S7] round=38 local utility u=0.000000 metrics={'f1_val': 0.6988636922012941, 'auprc': 0.8524318499313818, 'loss_val': 0.347058490537034, 'psi': 0.7602909552933292}-{'f1_val': 0.696256421413034, 'auprc': 0.858704132061564, 'loss_val': 0.2845480383956943, 'psi': 0.761235505672446}
[S8] START round=38 head_norm_before_train=1.792437 cos_to_last_merge=0.7508 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.751
[S8] round=38 local utility u=0.000000 metrics={'f1_val': 0.9941000136901317, 'auprc': 0.9901727258164215, 'loss_val': 0.03360438051408794, 'psi': 0.9925290985406476}-{'f1_val': 0.9914588715117574, 'auprc': 0.9991175084428163, 'loss_val': 0.03877319334523566, 'psi': 0.9945223262841809}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=38 head_norm_before_train=1.474733 cos_to_last_merge=0.9771 (last merge round=31)
[S9] round=38 local utility u=0.011348 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9992034178980033, 'loss_val': 0.032521167010131, 'psi': 0.9974314240267679}-{'f1_val': 0.9947496160742828, 'auprc': 0.9968036085669401, 'loss_val': 0.03901444831573368, 'psi': 0.9955712130713458}
[S10] START round=38 head_norm_before_train=1.549266 cos_to_last_merge=0.9571 (last merge round=30)
[S10] round=38 local utility u=0.017950 metrics={'f1_val': 0.9949436619942489, 'auprc': 0.9958661805022937, 'loss_val': 0.05739592684341909, 'psi': 0.9953126693974668}-{'f1_val': 0.9914233014595196, 'auprc': 0.9959194369027182, 'loss_val': 0.07233372579138386, 'psi': 0.993221755636799}
[S11] START round=38 head_norm_before_train=1.468938 cos_to_last_merge=0.9998 (last merge round=36)
[S11] round=38 local utility u=0.002655 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9975275481182134, 'loss_val': 0.055103267595382754, 'psi': 0.9967941197286019}-{'f1_val': 0.996305167468861, 'auprc': 0.9974699724031146, 'loss_val': 0.060241461507144045, 'psi': 0.9967710894425624}
[S13] START round=38 head_norm_before_train=1.389738 cos_to_last_merge=1.0000 (last merge round=37)
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.5353061107720603, 'auprc': 0.6880026657015201, 'loss_val': 1.028266599156643, 'psi': 0.5963847327438443}-{'f1_val': 0.5742915798666346, 'auprc': 0.678618400176511, 'loss_val': 0.8696244971204785, 'psi': 0.6160223079905851}
[S14] START round=38 head_norm_before_train=1.640440 cos_to_last_merge=1.0000 (last merge round=37)
[S14] round=38 local utility u=0.084791 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9983123172484172, 'loss_val': 0.056350255286397456, 'psi': 0.9975234317939659}-{'f1_val': 0.9715648023988184, 'auprc': 0.9988246137929744, 'loss_val': 0.07487309031567342, 'psi': 0.9824687269564807}
[S15] START round=38 head_norm_before_train=1.689689 cos_to_last_merge=0.9998 (last merge round=36)
[S15] round=38 local utility u=0.000000 metrics={'f1_val': 0.8114332486245708, 'auprc': 0.9953275297114543, 'loss_val': 0.2669707673149702, 'psi': 0.8849909610593243}-{'f1_val': 0.8607703039353065, 'auprc': 0.995674544970005, 'loss_val': 0.21176070633101254, 'psi': 0.9147320003491859}
[S16] START round=38 head_norm_before_train=1.256557 cos_to_last_merge=1.0000 (last merge round=37)
[S16] round=38 local utility u=0.000000 metrics={'f1_val': 0.8440170199288259, 'auprc': 0.9761466667011651, 'loss_val': 0.648171589486402, 'psi': 0.8968688786377617}-{'f1_val': 0.9340158332361271, 'auprc': 0.9885565027642901, 'loss_val': 0.2839724231583964, 'psi': 0.9558321010473922}
[S17] START round=38 head_norm_before_train=1.358658 cos_to_last_merge=1.0000 (last merge round=37)
[S17] round=38 local utility u=0.000000 metrics={'f1_val': 0.6375932900541398, 'auprc': 0.8303726803550774, 'loss_val': 1.0071951818599656, 'psi': 0.7147050461745148}-{'f1_val': 0.664762235675959, 'auprc': 0.8281460445370227, 'loss_val': 0.7234056433738643, 'psi': 0.7301157592203845}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:42004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:42016
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:42003
[S9] sending update (kind=head size=1794 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:42015
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:42007
[S5] sending update (kind=head size=1805 to 1 peers)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=38 metric=0.6509 head_norm=1.379861
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.493762e-01
[S2] stored merged vector for next round verification (round=38)
[S2] DEBUG after merge:  round=38 metric=0.6486 head_norm=1.321970 delta_norm=0.249376
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S10] sending update (kind=head size=1800 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=38 metric=0.6021 head_norm=1.532225
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.065157e-02
[S6] stored merged vector for next round verification (round=38)
[S6] DEBUG after merge:  round=38 metric=0.6045 head_norm=1.499251 delta_norm=0.070652
[S6] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S3] RECEIVED delta(kind=head bytes=1794) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.499014)
[S3] loaded HEAD from S9 (vec_in norm=1.499014)
[S3] cosine check vs S9: cos=0.9949
[S3] BUFFERED delta from S9 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1805) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.324680)
[S16] loaded HEAD from S5 (vec_in norm=1.324680)
[S16] cosine check vs S5: cos=0.9859
[S16] BUFFERED delta from S5 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1800) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.567266)
[S4] loaded HEAD from S10 (vec_in norm=1.567266)
[S4] cosine check vs S10: cos=0.9971
[S4] BUFFERED delta from S10 (total buffered=1)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1804 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] RECEIVED delta(kind=head bytes=1798) from S11
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.493064)
[S6] loaded HEAD from S11 (vec_in norm=1.493064)
[S6] cosine check vs S11: cos=0.9989
[S6] BUFFERED delta from S11 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1804) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.664179)
[S15] loaded HEAD from S14 (vec_in norm=1.664179)
[S15] cosine check vs S14: cos=0.9953
[S15] BUFFERED delta from S14 (total buffered=1)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=38 metric=0.8440 head_norm=1.312219
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.107263e-01
[S16] stored merged vector for next round verification (round=38)
[S16] DEBUG after merge:  round=38 metric=0.8438 head_norm=1.313806 delta_norm=0.110726
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=38 metric=0.9398 head_norm=1.544520
[S4] _apply_head_vector_avg (torch): Δ‖w‖=6.002244e-02
[S4] stored merged vector for next round verification (round=38)
[S4] DEBUG after merge:  round=38 metric=0.9398 head_norm=1.554776 delta_norm=0.060022
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14]  timeout peer S7
[S3]  timeout peer S10
[S3]  timeout peer S17
[S15]  timeout peer S14
[S16]  timeout peer S5
[S9]  timeout peer S3
[S4]  timeout peer S13
[S10]  timeout peer S4
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S16
[S11]  timeout peer S6
[S11]  timeout peer S15
[S13]  timeout peer S2
[S13]  timeout peer S11
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=38 metric=0.9315 head_norm=1.461966
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.723663e-02
[S3] stored merged vector for next round verification (round=38)
[S3] DEBUG after merge:  round=38 metric=0.9315 head_norm=1.478590 delta_norm=0.077237
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=39 head_norm_before_train=1.321970 cos_to_last_merge=1.0000 (last merge round=38)
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.6397097420053293, 'auprc': 0.682645258262983, 'loss_val': 0.8776195804853661, 'psi': 0.6568839485083908}-{'f1_val': 0.6509216596291932, 'auprc': 0.6982491417029408, 'loss_val': 0.8979687513267218, 'psi': 0.6698526524586923}
[S3] START round=39 head_norm_before_train=1.478590 cos_to_last_merge=1.0000 (last merge round=38)
[S3] round=39 local utility u=0.276732 metrics={'f1_val': 0.9973696976584205, 'auprc': 0.9977291039922953, 'loss_val': 0.039088797530968375, 'psi': 0.9975134601919704}-{'f1_val': 0.9314849014039699, 'auprc': 0.9989646469238891, 'loss_val': 0.20095092320889793, 'psi': 0.9584767996119375}
[S4] START round=39 head_norm_before_train=1.554776 cos_to_last_merge=1.0000 (last merge round=38)
[S4] round=39 local utility u=0.016660 metrics={'f1_val': 0.9434427919230425, 'auprc': 0.9221825744582745, 'loss_val': 0.2869555815986751, 'psi': 0.9349387049371353}-{'f1_val': 0.9398048314868463, 'auprc': 0.9185724413655056, 'loss_val': 0.2876165237652963, 'psi': 0.9313118754383101}
[S5] START round=39 head_norm_before_train=1.324680 cos_to_last_merge=0.9992 (last merge round=36)
[S5] round=39 local utility u=0.000000 metrics={'f1_val': 0.7029607488664021, 'auprc': 0.9892952680425716, 'loss_val': 0.2673463740125898, 'psi': 0.8174945565368699}-{'f1_val': 0.9376952748738372, 'auprc': 0.9882083747394839, 'loss_val': 0.19852873743666266, 'psi': 0.9579005148200959}
[S6] START round=39 head_norm_before_train=1.499251 cos_to_last_merge=1.0000 (last merge round=38)
[S6] round=39 local utility u=1.000000 metrics={'f1_val': 0.846961654208247, 'auprc': 0.9464977213101904, 'loss_val': 0.3406586679886796, 'psi': 0.8867760810490244}-{'f1_val': 0.6020971582760041, 'auprc': 0.7563571208275192, 'loss_val': 0.8069304700530423, 'psi': 0.6638011432966101}
[S7] START round=39 head_norm_before_train=1.615169 cos_to_last_merge=0.9999 (last merge round=35)
[S7] round=39 local utility u=0.000000 metrics={'f1_val': 0.6142096417718348, 'auprc': 0.786515598790981, 'loss_val': 0.6975237116853664, 'psi': 0.6831320245794933}-{'f1_val': 0.6988636922012941, 'auprc': 0.8524318499313818, 'loss_val': 0.347058490537034, 'psi': 0.7602909552933292}
[S8] START round=39 head_norm_before_train=1.805732 cos_to_last_merge=0.7491 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.749
[S8] round=39 local utility u=0.000000 metrics={'f1_val': 0.7140170479737811, 'auprc': 0.9740945059969087, 'loss_val': 0.6554170502756571, 'psi': 0.8180480311830322}-{'f1_val': 0.9941000136901317, 'auprc': 0.9901727258164215, 'loss_val': 0.03360438051408794, 'psi': 0.9925290985406476}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=40 psi=0.818 u=0.0000 p_local=0.0539 f1=0.714 auprc=0.974 bytes=30620
[S9] START round=39 head_norm_before_train=1.499014 cos_to_last_merge=0.9747 (last merge round=31)
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.9909734396342953, 'auprc': 0.9961867922302375, 'loss_val': 0.0434898733573897, 'psi': 0.9930587806726722}-{'f1_val': 0.9962500947792776, 'auprc': 0.9992034178980033, 'loss_val': 0.032521167010131, 'psi': 0.9974314240267679}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=40 psi=0.993 u=0.0000 p_local=0.0079 f1=0.991 auprc=0.996 bytes=41325
[S10] START round=39 head_norm_before_train=1.567266 cos_to_last_merge=0.9545 (last merge round=30)
[S10] round=39 local utility u=0.000000 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9906563255797962, 'loss_val': 0.06696751683702504, 'psi': 0.9931224204574358}-{'f1_val': 0.9949436619942489, 'auprc': 0.9958661805022937, 'loss_val': 0.05739592684341909, 'psi': 0.9953126693974668}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=40 psi=0.993 u=0.0000 p_local=0.0120 f1=0.995 auprc=0.991 bytes=37793
[S11] START round=39 head_norm_before_train=1.493064 cos_to_last_merge=0.9994 (last merge round=36)
[S11] round=39 local utility u=0.002814 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9976338533700291, 'loss_val': 0.04979378057471927, 'psi': 0.9968366418293282}-{'f1_val': 0.996305167468861, 'auprc': 0.9975275481182134, 'loss_val': 0.055103267595382754, 'psi': 0.9967941197286019}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S11] r=40 psi=0.997 u=0.0028 p_local=0.0088 f1=0.996 auprc=0.998 bytes=43151
[S13] START round=39 head_norm_before_train=1.399546 cos_to_last_merge=0.9996 (last merge round=37)
[S13] round=39 local utility u=0.118774 metrics={'f1_val': 0.5635977904472413, 'auprc': 0.6860185866224717, 'loss_val': 0.9545166889805577, 'psi': 0.6125661089173335}-{'f1_val': 0.5353061107720603, 'auprc': 0.6880026657015201, 'loss_val': 1.028266599156643, 'psi': 0.5963847327438443}
[S14] START round=39 head_norm_before_train=1.664179 cos_to_last_merge=0.9999 (last merge round=37)
[S14] round=39 local utility u=0.004398 metrics={'f1_val': 0.9970407855713329, 'auprc': 0.9987381031701823, 'loss_val': 0.049092135289045845, 'psi': 0.9977197126108728}-{'f1_val': 0.9969975081576651, 'auprc': 0.9983123172484172, 'loss_val': 0.056350255286397456, 'psi': 0.9975234317939659}
[S15] START round=39 head_norm_before_train=1.713754 cos_to_last_merge=0.9993 (last merge round=36)
[S15] round=39 local utility u=0.067289 metrics={'f1_val': 0.8274137445258938, 'auprc': 0.9952527088827203, 'loss_val': 0.2280517822691443, 'psi': 0.8945493302686244}-{'f1_val': 0.8114332486245708, 'auprc': 0.9953275297114543, 'loss_val': 0.2669707673149702, 'psi': 0.8849909610593243}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=39 metric=0.8274 head_norm=1.735861
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.000632e-01
[S15] stored merged vector for next round verification (round=39)
[S15] DEBUG after merge:  round=39 metric=0.8221 head_norm=1.697451 delta_norm=0.100063
[S15] aggregate: ROLLBACK (f1_val pre=0.827 post=0.822 tol_abs=0.005 tol_rel=0.0)
[S15] r=40 psi=0.895 u=0.0673 p_local=0.1908 f1=0.827 auprc=0.995 bytes=35958
[S16] START round=39 head_norm_before_train=1.313806 cos_to_last_merge=1.0000 (last merge round=38)
[S16] round=39 local utility u=0.551509 metrics={'f1_val': 0.9468770298680425, 'auprc': 0.9794643439316273, 'loss_val': 0.17226574219085444, 'psi': 0.9599119554934763}-{'f1_val': 0.8440170199288259, 'auprc': 0.9761466667011651, 'loss_val': 0.648171589486402, 'psi': 0.8968688786377617}
[S17] START round=39 head_norm_before_train=1.368169 cos_to_last_merge=0.9999 (last merge round=37)
[S17] round=39 local utility u=0.185262 metrics={'f1_val': 0.6803967081770658, 'auprc': 0.8435315292116672, 'loss_val': 0.9329679656307077, 'psi': 0.7456506365909064}-{'f1_val': 0.6375932900541398, 'auprc': 0.8303726803550774, 'loss_val': 1.0071951818599656, 'psi': 0.7147050461745148}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S3] r=40 psi=0.998 u=0.2767 p_local=0.1113 f1=0.997 auprc=0.998 bytes=39549
[S14] r=40 psi=0.998 u=0.0044 p_local=0.0190 f1=0.997 auprc=0.999 bytes=44988
[S4] r=40 psi=0.935 u=0.0167 p_local=0.0182 f1=0.943 auprc=0.922 bytes=35958
[S16] r=40 psi=0.960 u=0.5515 p_local=0.1899 f1=0.947 auprc=0.979 bytes=32387
[S13] r=40 psi=0.613 u=0.1188 p_local=0.0919 f1=0.564 auprc=0.686 bytes=35968
[S7] r=40 psi=0.683 u=0.0000 p_local=0.1363 f1=0.614 auprc=0.787 bytes=34183
[S17] r=40 psi=0.746 u=0.1853 p_local=0.2159 f1=0.680 auprc=0.844 bytes=34116
[S5] r=40 psi=0.817 u=0.0000 p_local=0.3417 f1=0.703 auprc=0.989 bytes=34154
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=39 metric=0.8470 head_norm=1.531114
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.670318e-02
[S6] stored merged vector for next round verification (round=39)
[S6] DEBUG after merge:  round=39 metric=0.8470 head_norm=1.511145 delta_norm=0.056703
[S6] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S6] r=40 psi=0.887 u=1.0000 p_local=0.4613 f1=0.847 auprc=0.946 bytes=35943
[S2] r=40 psi=0.657 u=0.0000 p_local=0.0545 f1=0.640 auprc=0.683 bytes=34194
[S2] START round=40 head_norm_before_train=1.347721 cos_to_last_merge=0.9994 (last merge round=38)
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.6340800932556696, 'auprc': 0.6812192949835348, 'loss_val': 0.9345050091641779, 'psi': 0.6529357739468157}-{'f1_val': 0.6397097420053293, 'auprc': 0.682645258262983, 'loss_val': 0.8776195804853661, 'psi': 0.6568839485083908}
[S3] START round=40 head_norm_before_train=1.496129 cos_to_last_merge=0.9999 (last merge round=38)
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.9970158049264538, 'auprc': 0.9971653128524343, 'loss_val': 0.049251364476222435, 'psi': 0.997075608096846}-{'f1_val': 0.9973696976584205, 'auprc': 0.9977291039922953, 'loss_val': 0.039088797530968375, 'psi': 0.9975134601919704}
[S4] START round=40 head_norm_before_train=1.569230 cos_to_last_merge=0.9999 (last merge round=38)
[S4] round=40 local utility u=0.078637 metrics={'f1_val': 0.9470081204712822, 'auprc': 0.9628659332642096, 'loss_val': 0.27312308830710025, 'psi': 0.9533512455884532}-{'f1_val': 0.9434427919230425, 'auprc': 0.9221825744582745, 'loss_val': 0.2869555815986751, 'psi': 0.9349387049371353}
[S5] START round=40 head_norm_before_train=1.342984 cos_to_last_merge=0.9987 (last merge round=36)
[S5] round=40 local utility u=0.000000 metrics={'f1_val': 0.6751780367991023, 'auprc': 0.9311107015588314, 'loss_val': 0.4422854450712492, 'psi': 0.777551102702994}-{'f1_val': 0.7029607488664021, 'auprc': 0.9892952680425716, 'loss_val': 0.2673463740125898, 'psi': 0.8174945565368699}
[S6] START round=40 head_norm_before_train=1.511145 cos_to_last_merge=1.0000 (last merge round=39)
[S6] round=40 local utility u=0.000000 metrics={'f1_val': 0.7642480065824551, 'auprc': 0.9039769703101753, 'loss_val': 0.5331139040333179, 'psi': 0.8201395920735431}-{'f1_val': 0.846961654208247, 'auprc': 0.9464977213101904, 'loss_val': 0.3406586679886796, 'psi': 0.8867760810490244}
[S7] START round=40 head_norm_before_train=1.617904 cos_to_last_merge=0.9999 (last merge round=35)
[S7] round=40 local utility u=0.289061 metrics={'f1_val': 0.6550113390322345, 'auprc': 0.8059628358276855, 'loss_val': 0.4225526442639023, 'psi': 0.7153919377504149}-{'f1_val': 0.6142096417718348, 'auprc': 0.786515598790981, 'loss_val': 0.6975237116853664, 'psi': 0.6831320245794933}
[S8] START round=40 head_norm_before_train=1.817159 cos_to_last_merge=0.7477 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.748
[S8] round=40 local utility u=1.000000 metrics={'f1_val': 0.9928249955793521, 'auprc': 0.9989716045673808, 'loss_val': 0.034339169727089204, 'psi': 0.9952836391745635}-{'f1_val': 0.7140170479737811, 'auprc': 0.9740945059969087, 'loss_val': 0.6554170502756571, 'psi': 0.8180480311830322}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S8] sending update (kind=head size=1807 to 1 peers)
[S9] START round=40 head_norm_before_train=1.520807 cos_to_last_merge=0.9726 (last merge round=31)
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.9854657388091037, 'auprc': 0.9983125893335296, 'loss_val': 0.062299050863014786, 'psi': 0.9906044790188742}-{'f1_val': 0.9909734396342953, 'auprc': 0.9961867922302375, 'loss_val': 0.0434898733573897, 'psi': 0.9930587806726722}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=40 head_norm_before_train=1.584575 cos_to_last_merge=0.9523 (last merge round=30)
[S10] round=40 local utility u=0.016841 metrics={'f1_val': 0.9949616548295207, 'auprc': 0.9947061403418219, 'loss_val': 0.04660593567781742, 'psi': 0.9948594490344412}-{'f1_val': 0.9947664837091956, 'auprc': 0.9906563255797962, 'loss_val': 0.06696751683702504, 'psi': 0.9931224204574358}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] sending update (kind=head size=1805 to 1 peers)
[S11] START round=40 head_norm_before_train=1.514013 cos_to_last_merge=0.9989 (last merge round=36)
[S11] round=40 local utility u=0.002153 metrics={'f1_val': 0.996305167468861, 'auprc': 0.997819642645175, 'loss_val': 0.04604489541673365, 'psi': 0.9969109575393866}-{'f1_val': 0.996305167468861, 'auprc': 0.9976338533700291, 'loss_val': 0.04979378057471927, 'psi': 0.9968366418293282}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=40 head_norm_before_train=1.412760 cos_to_last_merge=0.9987 (last merge round=37)
[S13] round=40 local utility u=0.000000 metrics={'f1_val': 0.5353742049024797, 'auprc': 0.6886948419170208, 'loss_val': 1.0421869766099423, 'psi': 0.5967024597082962}-{'f1_val': 0.5635977904472413, 'auprc': 0.6860185866224717, 'loss_val': 0.9545166889805577, 'psi': 0.6125661089173335}
[S14] START round=40 head_norm_before_train=1.685667 cos_to_last_merge=0.9995 (last merge round=37)
[S14] round=40 local utility u=0.001882 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9987514315985648, 'loss_val': 0.045108785692878406, 'psi': 0.997699077534025}-{'f1_val': 0.9970407855713329, 'auprc': 0.9987381031701823, 'loss_val': 0.049092135289045845, 'psi': 0.9977197126108728}
[S15] START round=40 head_norm_before_train=1.697451 cos_to_last_merge=1.0000 (last merge round=39)
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.8282684453805946, 'auprc': 0.9947852351781206, 'loss_val': 0.23876190472480008, 'psi': 0.894875161299605}-{'f1_val': 0.8274137445258938, 'auprc': 0.9952527088827203, 'loss_val': 0.2280517822691443, 'psi': 0.8945493302686244}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=40 head_norm_before_train=1.366088 cos_to_last_merge=0.9992 (last merge round=38)
[S16] round=40 local utility u=0.047674 metrics={'f1_val': 0.9601509314831418, 'auprc': 0.9772346051930327, 'loss_val': 0.1498717087917527, 'psi': 0.9669844009670981}-{'f1_val': 0.9468770298680425, 'auprc': 0.9794643439316273, 'loss_val': 0.17226574219085444, 'psi': 0.9599119554934763}
[S17] START round=40 head_norm_before_train=1.383825 cos_to_last_merge=0.9997 (last merge round=37)
[S17] round=40 local utility u=0.000000 metrics={'f1_val': 0.6756885027326394, 'auprc': 0.843067484342223, 'loss_val': 0.967547310857032, 'psi': 0.7426400953764729}-{'f1_val': 0.6803967081770658, 'auprc': 0.8435315292116672, 'loss_val': 0.9329679656307077, 'psi': 0.7456506365909064}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.967)
[S14] not sending this round → trigger blocked (psi=0.998)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.953)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=41 head_norm_before_train=1.371955 cos_to_last_merge=0.9981 (last merge round=38)
[S2] round=41 local utility u=0.277800 metrics={'f1_val': 0.6904086290156435, 'auprc': 0.7004836995995952, 'loss_val': 0.7746696615160824, 'psi': 0.6944386572492243}-{'f1_val': 0.6340800932556696, 'auprc': 0.6812192949835348, 'loss_val': 0.9345050091641779, 'psi': 0.6529357739468157}
[S3] START round=41 head_norm_before_train=1.514970 cos_to_last_merge=0.9998 (last merge round=38)
[S3] round=41 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9990571011880596, 'loss_val': 0.13839970121935286, 'psi': 0.9762439911384899}-{'f1_val': 0.9970158049264538, 'auprc': 0.9971653128524343, 'loss_val': 0.049251364476222435, 'psi': 0.997075608096846}
[S4] START round=41 head_norm_before_train=1.580472 cos_to_last_merge=0.9995 (last merge round=38)
[S4] round=41 local utility u=0.000000 metrics={'f1_val': 0.9454511284790517, 'auprc': 0.9548864106041292, 'loss_val': 0.2826948092529016, 'psi': 0.9492252413290827}-{'f1_val': 0.9470081204712822, 'auprc': 0.9628659332642096, 'loss_val': 0.27312308830710025, 'psi': 0.9533512455884532}
[S5] START round=41 head_norm_before_train=1.372433 cos_to_last_merge=0.9980 (last merge round=36)
[S5] round=41 local utility u=0.147757 metrics={'f1_val': 0.7079525698646196, 'auprc': 0.9252355013794895, 'loss_val': 0.3257932256871374, 'psi': 0.7948657424705676}-{'f1_val': 0.6751780367991023, 'auprc': 0.9311107015588314, 'loss_val': 0.4422854450712492, 'psi': 0.777551102702994}
[S6] START round=41 head_norm_before_train=1.545964 cos_to_last_merge=0.9995 (last merge round=39)
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.5966766241967568, 'auprc': 0.7642491705606886, 'loss_val': 0.6764779461292029, 'psi': 0.6637056427423296}-{'f1_val': 0.7642480065824551, 'auprc': 0.9039769703101753, 'loss_val': 0.5331139040333179, 'psi': 0.8201395920735431}
[S7] START round=41 head_norm_before_train=1.621872 cos_to_last_merge=0.9998 (last merge round=35)
[S7] round=41 local utility u=0.000000 metrics={'f1_val': 0.6143241796952602, 'auprc': 0.7951254538218746, 'loss_val': 0.5713638424241884, 'psi': 0.686644689345906}-{'f1_val': 0.6550113390322345, 'auprc': 0.8059628358276855, 'loss_val': 0.4225526442639023, 'psi': 0.7153919377504149}
[S8] START round=41 head_norm_before_train=1.822982 cos_to_last_merge=0.7470 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.747
[S8] round=41 local utility u=0.000000 metrics={'f1_val': 0.9745099843822217, 'auprc': 0.999322066976625, 'loss_val': 0.07694922957606733, 'psi': 0.9844348174199831}-{'f1_val': 0.9928249955793521, 'auprc': 0.9989716045673808, 'loss_val': 0.034339169727089204, 'psi': 0.9952836391745635}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=41 head_norm_before_train=1.542852 cos_to_last_merge=0.9705 (last merge round=31)
[S9] round=41 local utility u=0.052050 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9988052769905824, 'loss_val': 0.027038593469444223, 'psi': 0.9975376055550903}-{'f1_val': 0.9854657388091037, 'auprc': 0.9983125893335296, 'loss_val': 0.062299050863014786, 'psi': 0.9906044790188742}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] sending update (kind=head size=1792 to 1 peers)
[S10] START round=41 head_norm_before_train=1.600865 cos_to_last_merge=0.9503 (last merge round=30)
[S10] round=41 local utility u=0.000000 metrics={'f1_val': 0.9946326116076992, 'auprc': 0.9933534857507589, 'loss_val': 0.04488011580223805, 'psi': 0.9941209612649231}-{'f1_val': 0.9949616548295207, 'auprc': 0.9947061403418219, 'loss_val': 0.04660593567781742, 'psi': 0.9948594490344412}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=41 head_norm_before_train=1.533109 cos_to_last_merge=0.9983 (last merge round=36)
[S11] round=41 local utility u=0.000000 metrics={'f1_val': 0.9516605983708001, 'auprc': 0.9978695811565068, 'loss_val': 0.18435567953039, 'psi': 0.9701441914850828}-{'f1_val': 0.996305167468861, 'auprc': 0.997819642645175, 'loss_val': 0.04604489541673365, 'psi': 0.9969109575393866}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=41 head_norm_before_train=1.426104 cos_to_last_merge=0.9979 (last merge round=37)
[S13] round=41 local utility u=0.068935 metrics={'f1_val': 0.5506047192698982, 'auprc': 0.6851836676929572, 'loss_val': 0.9851661783917264, 'psi': 0.6044362986391218}-{'f1_val': 0.5353742049024797, 'auprc': 0.6886948419170208, 'loss_val': 1.0421869766099423, 'psi': 0.5967024597082962}
[S14] START round=41 head_norm_before_train=1.703300 cos_to_last_merge=0.9991 (last merge round=37)
[S14] round=41 local utility u=0.001126 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9985591470278679, 'loss_val': 0.04227930009562999, 'psi': 0.9976221637057462}-{'f1_val': 0.9969975081576651, 'auprc': 0.9987514315985648, 'loss_val': 0.045108785692878406, 'psi': 0.997699077534025}
[S15] START round=41 head_norm_before_train=1.719456 cos_to_last_merge=0.9999 (last merge round=39)
[S15] round=41 local utility u=0.000000 metrics={'f1_val': 0.7752308203389794, 'auprc': 0.9903057134291924, 'loss_val': 0.3528993454683259, 'psi': 0.8612607775750646}-{'f1_val': 0.8282684453805946, 'auprc': 0.9947852351781206, 'loss_val': 0.23876190472480008, 'psi': 0.894875161299605}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=41 head_norm_before_train=1.410195 cos_to_last_merge=0.9975 (last merge round=38)
[S16] round=41 local utility u=0.000000 metrics={'f1_val': 0.8404714987394448, 'auprc': 0.9831980802343696, 'loss_val': 0.8088032836554485, 'psi': 0.8975621313374147}-{'f1_val': 0.9601509314831418, 'auprc': 0.9772346051930327, 'loss_val': 0.1498717087917527, 'psi': 0.9669844009670981}
[S17] START round=41 head_norm_before_train=1.403396 cos_to_last_merge=0.9992 (last merge round=37)
[S17] round=41 local utility u=0.000000 metrics={'f1_val': 0.6733913882661577, 'auprc': 0.84061363352262, 'loss_val': 0.9946346488111295, 'psi': 0.7402802863687425}-{'f1_val': 0.6756885027326394, 'auprc': 0.843067484342223, 'loss_val': 0.967547310857032, 'psi': 0.7426400953764729}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=42 head_norm_before_train=1.392698 cos_to_last_merge=0.9965 (last merge round=38)
[S2] round=42 local utility u=0.000000 metrics={'f1_val': 0.6731955420154012, 'auprc': 0.7115799041117342, 'loss_val': 0.7695011687978675, 'psi': 0.6885492868539345}-{'f1_val': 0.6904086290156435, 'auprc': 0.7004836995995952, 'loss_val': 0.7746696615160824, 'psi': 0.6944386572492243}
[S3] START round=42 head_norm_before_train=1.534817 cos_to_last_merge=0.9994 (last merge round=38)
[S3] round=42 local utility u=0.146235 metrics={'f1_val': 0.9971302205031132, 'auprc': 0.9974816021085526, 'loss_val': 0.05777399336935804, 'psi': 0.997270773145289}-{'f1_val': 0.9610352511054436, 'auprc': 0.9990571011880596, 'loss_val': 0.13839970121935286, 'psi': 0.9762439911384899}
[S4] START round=42 head_norm_before_train=1.597081 cos_to_last_merge=0.9990 (last merge round=38)
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.9423207519822397, 'auprc': 0.9537561755162156, 'loss_val': 0.2818566409032632, 'psi': 0.94689492139583}-{'f1_val': 0.9454511284790517, 'auprc': 0.9548864106041292, 'loss_val': 0.2826948092529016, 'psi': 0.9492252413290827}
[S5] START round=42 head_norm_before_train=1.401629 cos_to_last_merge=0.9968 (last merge round=36)
[S5] round=42 local utility u=0.000000 metrics={'f1_val': 0.7008676007203419, 'auprc': 0.8649487983220628, 'loss_val': 0.4255721623720828, 'psi': 0.7665000797610303}-{'f1_val': 0.7079525698646196, 'auprc': 0.9252355013794895, 'loss_val': 0.3257932256871374, 'psi': 0.7948657424705676}
[S6] START round=42 head_norm_before_train=1.577903 cos_to_last_merge=0.9984 (last merge round=39)
[S6] round=42 local utility u=1.000000 metrics={'f1_val': 0.9700477728177473, 'auprc': 0.9613096739772304, 'loss_val': 0.14156287072832577, 'psi': 0.9665525332815406}-{'f1_val': 0.5966766241967568, 'auprc': 0.7642491705606886, 'loss_val': 0.6764779461292029, 'psi': 0.6637056427423296}
[S7] START round=42 head_norm_before_train=1.628961 cos_to_last_merge=0.9998 (last merge round=35)
[S7] round=42 local utility u=0.000000 metrics={'f1_val': 0.5600925276944888, 'auprc': 0.7832574595447029, 'loss_val': 0.8709351462579383, 'psi': 0.6493585004345744}-{'f1_val': 0.6143241796952602, 'auprc': 0.7951254538218746, 'loss_val': 0.5713638424241884, 'psi': 0.686644689345906}
[S8] START round=42 head_norm_before_train=1.831243 cos_to_last_merge=0.7459 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.746
[S8] round=42 local utility u=0.081230 metrics={'f1_val': 0.9944672019690619, 'auprc': 0.99835335175957, 'loss_val': 0.03132667652555124, 'psi': 0.9960216618852651}-{'f1_val': 0.9745099843822217, 'auprc': 0.999322066976625, 'loss_val': 0.07694922957606733, 'psi': 0.9844348174199831}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[S9] START round=42 head_norm_before_train=1.561586 cos_to_last_merge=0.9687 (last merge round=31)
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.9956098104564366, 'auprc': 0.9995507252328626, 'loss_val': 0.02695622310107301, 'psi': 0.9971861763670069}-{'f1_val': 0.9966924912647621, 'auprc': 0.9988052769905824, 'loss_val': 0.027038593469444223, 'psi': 0.9975376055550903}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=42 head_norm_before_train=1.617316 cos_to_last_merge=0.9483 (last merge round=30)
[S10] ⚠️ Model drifted since last merge! cos=0.948
[S10] round=42 local utility u=0.001951 metrics={'f1_val': 0.9946326116076992, 'auprc': 0.9940176197916969, 'loss_val': 0.04297047817042304, 'psi': 0.9943866148812983}-{'f1_val': 0.9946326116076992, 'auprc': 0.9933534857507589, 'loss_val': 0.04488011580223805, 'psi': 0.9941209612649231}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=42 head_norm_before_train=1.549790 cos_to_last_merge=0.9977 (last merge round=36)
[S11] round=42 local utility u=0.205257 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9978834844554733, 'loss_val': 0.04175171689055647, 'psi': 0.996936494263506}-{'f1_val': 0.9516605983708001, 'auprc': 0.9978695811565068, 'loss_val': 0.18435567953039, 'psi': 0.9701441914850828}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=42 head_norm_before_train=1.436672 cos_to_last_merge=0.9969 (last merge round=37)
[S13] round=42 local utility u=0.000000 metrics={'f1_val': 0.5488438124058893, 'auprc': 0.6834100578542243, 'loss_val': 0.9722071480824722, 'psi': 0.6026703105852234}-{'f1_val': 0.5506047192698982, 'auprc': 0.6851836676929572, 'loss_val': 0.9851661783917264, 'psi': 0.6044362986391218}
[S14] START round=42 head_norm_before_train=1.720097 cos_to_last_merge=0.9986 (last merge round=37)
[S14] round=42 local utility u=0.002788 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9987930002728933, 'loss_val': 0.03986873391974829, 'psi': 0.9979621618101927}-{'f1_val': 0.9969975081576651, 'auprc': 0.9985591470278679, 'loss_val': 0.04227930009562999, 'psi': 0.9976221637057462}
[S15] START round=42 head_norm_before_train=1.739483 cos_to_last_merge=0.9996 (last merge round=39)
[S15] round=42 local utility u=0.288055 metrics={'f1_val': 0.8461466165174716, 'auprc': 0.9956241933469783, 'loss_val': 0.21824008257291524, 'psi': 0.9059376472492743}-{'f1_val': 0.7752308203389794, 'auprc': 0.9903057134291924, 'loss_val': 0.3528993454683259, 'psi': 0.8612607775750646}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=42 head_norm_before_train=1.447296 cos_to_last_merge=0.9958 (last merge round=38)
[S16] round=42 local utility u=0.398859 metrics={'f1_val': 0.9068777275302342, 'auprc': 0.9873191619734365, 'loss_val': 0.4218868942995196, 'psi': 0.9390543013075152}-{'f1_val': 0.8404714987394448, 'auprc': 0.9831980802343696, 'loss_val': 0.8088032836554485, 'psi': 0.8975621313374147}
[S17] START round=42 head_norm_before_train=1.421821 cos_to_last_merge=0.9984 (last merge round=37)
[S17] round=42 local utility u=0.049680 metrics={'f1_val': 0.6746848688651798, 'auprc': 0.8443339575504071, 'loss_val': 0.9141967511631675, 'psi': 0.7425445043392707}-{'f1_val': 0.6733913882661577, 'auprc': 0.84061363352262, 'loss_val': 0.9946346488111295, 'psi': 0.7402802863687425}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S2] START round=43 head_norm_before_train=1.415421 cos_to_last_merge=0.9946 (last merge round=38)
[S2] round=43 local utility u=0.050495 metrics={'f1_val': 0.6937556272190791, 'auprc': 0.7122003288832206, 'loss_val': 0.7937330100223376, 'psi': 0.7011335078847357}-{'f1_val': 0.6731955420154012, 'auprc': 0.7115799041117342, 'loss_val': 0.7695011687978675, 'psi': 0.6885492868539345}
[S3] START round=43 head_norm_before_train=1.554071 cos_to_last_merge=0.9990 (last merge round=38)
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.9322526348159235, 'auprc': 0.997669522072019, 'loss_val': 0.20378146188479793, 'psi': 0.9584193897183617}-{'f1_val': 0.9971302205031132, 'auprc': 0.9974816021085526, 'loss_val': 0.05777399336935804, 'psi': 0.997270773145289}
[S4] START round=43 head_norm_before_train=1.613087 cos_to_last_merge=0.9985 (last merge round=38)
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.9389107959259634, 'auprc': 0.936352380204056, 'loss_val': 0.30130902373361707, 'psi': 0.9378874296372004}-{'f1_val': 0.9423207519822397, 'auprc': 0.9537561755162156, 'loss_val': 0.2818566409032632, 'psi': 0.94689492139583}
[S5] START round=43 head_norm_before_train=1.431679 cos_to_last_merge=0.9955 (last merge round=36)
[S5] round=43 local utility u=0.657601 metrics={'f1_val': 0.8276954844683317, 'auprc': 0.9816881939559345, 'loss_val': 0.22155602303056784, 'psi': 0.8892925682633729}-{'f1_val': 0.7008676007203419, 'auprc': 0.8649487983220628, 'loss_val': 0.4255721623720828, 'psi': 0.7665000797610303}
[S6] START round=43 head_norm_before_train=1.600967 cos_to_last_merge=0.9971 (last merge round=39)
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.7661113359371043, 'auprc': 0.9431948342045372, 'loss_val': 0.5523010292455326, 'psi': 0.8369447352440775}-{'f1_val': 0.9700477728177473, 'auprc': 0.9613096739772304, 'loss_val': 0.14156287072832577, 'psi': 0.9665525332815406}
[S7] START round=43 head_norm_before_train=1.635443 cos_to_last_merge=0.9997 (last merge round=35)
[S7] round=43 local utility u=0.550960 metrics={'f1_val': 0.6599652343557384, 'auprc': 0.8114319935627089, 'loss_val': 0.4527756411349158, 'psi': 0.7205519380385266}-{'f1_val': 0.5600925276944888, 'auprc': 0.7832574595447029, 'loss_val': 0.8709351462579383, 'psi': 0.6493585004345744}
[S8] START round=43 head_norm_before_train=1.839644 cos_to_last_merge=0.7452 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.745
[S8] round=43 local utility u=0.000000 metrics={'f1_val': 0.991097207355627, 'auprc': 0.9990922071261547, 'loss_val': 0.03874288650980054, 'psi': 0.994295207263838}-{'f1_val': 0.9944672019690619, 'auprc': 0.99835335175957, 'loss_val': 0.03132667652555124, 'psi': 0.9960216618852651}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=43 head_norm_before_train=1.579067 cos_to_last_merge=0.9670 (last merge round=31)
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.9954448862872828, 'auprc': 0.9993428157524205, 'loss_val': 0.0275256991929225, 'psi': 0.9970040580733379}-{'f1_val': 0.9956098104564366, 'auprc': 0.9995507252328626, 'loss_val': 0.02695622310107301, 'psi': 0.9971861763670069}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=43 head_norm_before_train=1.632656 cos_to_last_merge=0.9468 (last merge round=30)
[S10] ⚠️ Model drifted since last merge! cos=0.947
[S10] round=43 local utility u=0.000766 metrics={'f1_val': 0.9943272539091932, 'auprc': 0.9945404358331748, 'loss_val': 0.041175188417386, 'psi': 0.9944125266787858}-{'f1_val': 0.9946326116076992, 'auprc': 0.9940176197916969, 'loss_val': 0.04297047817042304, 'psi': 0.9943866148812983}
[S10] not sending this round → trigger blocked (psi=0.994)
[S11] START round=43 head_norm_before_train=1.562107 cos_to_last_merge=0.9973 (last merge round=36)
[S11] round=43 local utility u=0.002072 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9980291929786544, 'loss_val': 0.039496784465160716, 'psi': 0.9971398798996155}-{'f1_val': 0.996305167468861, 'auprc': 0.9978834844554733, 'loss_val': 0.04175171689055647, 'psi': 0.996936494263506}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=43 head_norm_before_train=1.444358 cos_to_last_merge=0.9957 (last merge round=37)
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.5196573392647696, 'auprc': 0.6945606740826517, 'loss_val': 1.1308462007121345, 'psi': 0.5896186731919224}-{'f1_val': 0.5488438124058893, 'auprc': 0.6834100578542243, 'loss_val': 0.9722071480824722, 'psi': 0.6026703105852234}
[S14] START round=43 head_norm_before_train=1.737364 cos_to_last_merge=0.9980 (last merge round=37)
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.9972116069810506, 'auprc': 0.9984221415755039, 'loss_val': 0.042618101175604314, 'psi': 0.9976958208188319}-{'f1_val': 0.9974082695017256, 'auprc': 0.9987930002728933, 'loss_val': 0.03986873391974829, 'psi': 0.9979621618101927}
[S15] START round=43 head_norm_before_train=1.758573 cos_to_last_merge=0.9992 (last merge round=39)
[S15] round=43 local utility u=0.043476 metrics={'f1_val': 0.8579212163929082, 'auprc': 0.9956483581917819, 'loss_val': 0.20200866553014227, 'psi': 0.9130120731124577}-{'f1_val': 0.8461466165174716, 'auprc': 0.9956241933469783, 'loss_val': 0.21824008257291524, 'psi': 0.9059376472492743}
[S15] not sending this round → trigger blocked (psi=0.913)
[S16] START round=43 head_norm_before_train=1.476251 cos_to_last_merge=0.9947 (last merge round=38)
[S16] round=43 local utility u=0.412477 metrics={'f1_val': 0.9899919630933373, 'auprc': 0.9771662263571357, 'loss_val': 0.0651596151199583, 'psi': 0.9848616683988566}-{'f1_val': 0.9068777275302342, 'auprc': 0.9873191619734365, 'loss_val': 0.4218868942995196, 'psi': 0.9390543013075152}
[S17] START round=43 head_norm_before_train=1.437303 cos_to_last_merge=0.9977 (last merge round=37)
[S17] round=43 local utility u=0.075515 metrics={'f1_val': 0.6861845585375733, 'auprc': 0.8539809192046243, 'loss_val': 0.86110594150105, 'psi': 0.7533031028043937}-{'f1_val': 0.6746848688651798, 'auprc': 0.8443339575504071, 'loss_val': 0.9141967511631675, 'psi': 0.7425445043392707}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] sending update (kind=head size=1804 to 1 peers)
[S17] not sending this round → trigger blocked (psi=0.753)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.985)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S2] START round=44 head_norm_before_train=1.440726 cos_to_last_merge=0.9924 (last merge round=38)
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.6587748838115091, 'auprc': 0.7131146354826603, 'loss_val': 0.908831908889559, 'psi': 0.6805107844799696}-{'f1_val': 0.6937556272190791, 'auprc': 0.7122003288832206, 'loss_val': 0.7937330100223376, 'psi': 0.7011335078847357}
[S3] START round=44 head_norm_before_train=1.573568 cos_to_last_merge=0.9986 (last merge round=38)
[S3] round=44 local utility u=0.283277 metrics={'f1_val': 0.9969583726029951, 'auprc': 0.9993935030379884, 'loss_val': 0.030634007987087063, 'psi': 0.9979324247769925}-{'f1_val': 0.9322526348159235, 'auprc': 0.997669522072019, 'loss_val': 0.20378146188479793, 'psi': 0.9584193897183617}
[S4] START round=44 head_norm_before_train=1.628988 cos_to_last_merge=0.9979 (last merge round=38)
[S4] round=44 local utility u=0.000000 metrics={'f1_val': 0.938787657853011, 'auprc': 0.9349259035655637, 'loss_val': 0.30324480734785614, 'psi': 0.9372429561380321}-{'f1_val': 0.9389107959259634, 'auprc': 0.936352380204056, 'loss_val': 0.30130902373361707, 'psi': 0.9378874296372004}
[S5] START round=44 head_norm_before_train=1.459934 cos_to_last_merge=0.9940 (last merge round=36)
[S5] round=44 local utility u=0.173818 metrics={'f1_val': 0.8727631742702155, 'auprc': 0.9893340226780266, 'loss_val': 0.1672644901614539, 'psi': 0.91939151363334}-{'f1_val': 0.8276954844683317, 'auprc': 0.9816881939559345, 'loss_val': 0.22155602303056784, 'psi': 0.8892925682633729}
[S6] START round=44 head_norm_before_train=1.625720 cos_to_last_merge=0.9957 (last merge round=39)
[S6] round=44 local utility u=0.416469 metrics={'f1_val': 0.8469574251067978, 'auprc': 0.9677479321327829, 'loss_val': 0.27809789518979716, 'psi': 0.8952736279171918}-{'f1_val': 0.7661113359371043, 'auprc': 0.9431948342045372, 'loss_val': 0.5523010292455326, 'psi': 0.8369447352440775}
[S7] START round=44 head_norm_before_train=1.640798 cos_to_last_merge=0.9995 (last merge round=35)
[S7] round=44 local utility u=0.051529 metrics={'f1_val': 0.6620569379204247, 'auprc': 0.8192499209967588, 'loss_val': 0.38572107672798095, 'psi': 0.7249341311509583}-{'f1_val': 0.6599652343557384, 'auprc': 0.8114319935627089, 'loss_val': 0.4527756411349158, 'psi': 0.7205519380385266}
[S8] START round=44 head_norm_before_train=1.847034 cos_to_last_merge=0.7448 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.745
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.991097207355627, 'auprc': 0.9991069935897565, 'loss_val': 0.040567487815922496, 'psi': 0.9943011218492788}-{'f1_val': 0.991097207355627, 'auprc': 0.9990922071261547, 'loss_val': 0.03874288650980054, 'psi': 0.994295207263838}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=44 head_norm_before_train=1.595355 cos_to_last_merge=0.9654 (last merge round=31)
[S9] round=44 local utility u=0.007444 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9995389409018797, 'loss_val': 0.023173738714721944, 'psi': 0.9980773238680376}-{'f1_val': 0.9954448862872828, 'auprc': 0.9993428157524205, 'loss_val': 0.0275256991929225, 'psi': 0.9970040580733379}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=44 head_norm_before_train=1.647918 cos_to_last_merge=0.9451 (last merge round=30)
[S10] ⚠️ Model drifted since last merge! cos=0.945
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.9934252160563725, 'auprc': 0.995777373701088, 'loss_val': 0.04494029371893484, 'psi': 0.9943660791142587}-{'f1_val': 0.9943272539091932, 'auprc': 0.9945404358331748, 'loss_val': 0.041175188417386, 'psi': 0.9944125266787858}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=44 head_norm_before_train=1.574618 cos_to_last_merge=0.9968 (last merge round=36)
[S11] round=44 local utility u=0.000248 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9981308307797179, 'loss_val': 0.03785386867386235, 'psi': 0.9970354327932037}-{'f1_val': 0.9965470045135896, 'auprc': 0.9980291929786544, 'loss_val': 0.039496784465160716, 'psi': 0.9971398798996155}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=44 head_norm_before_train=1.452265 cos_to_last_merge=0.9945 (last merge round=37)
[S13] round=44 local utility u=0.209910 metrics={'f1_val': 0.5676030977119652, 'auprc': 0.6877903199067892, 'loss_val': 0.9783898532618551, 'psi': 0.6156779865898947}-{'f1_val': 0.5196573392647696, 'auprc': 0.6945606740826517, 'loss_val': 1.1308462007121345, 'psi': 0.5896186731919224}
[S14] START round=44 head_norm_before_train=1.754961 cos_to_last_merge=0.9974 (last merge round=37)
[S14] round=44 local utility u=0.002644 metrics={'f1_val': 0.996754531653698, 'auprc': 0.9986273442671959, 'loss_val': 0.03520363867928245, 'psi': 0.9975036566990971}-{'f1_val': 0.9972116069810506, 'auprc': 0.9984221415755039, 'loss_val': 0.042618101175604314, 'psi': 0.9976958208188319}
[S15] START round=44 head_norm_before_train=1.778309 cos_to_last_merge=0.9987 (last merge round=39)
[S15] round=44 local utility u=0.000000 metrics={'f1_val': 0.7677572040693146, 'auprc': 0.9862951732578338, 'loss_val': 0.4589640890964935, 'psi': 0.8551723917447223}-{'f1_val': 0.8579212163929082, 'auprc': 0.9956483581917819, 'loss_val': 0.20200866553014227, 'psi': 0.9130120731124577}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=44 head_norm_before_train=1.502710 cos_to_last_merge=0.9934 (last merge round=38)
[S16] round=44 local utility u=0.000000 metrics={'f1_val': 0.8480912653748547, 'auprc': 0.985617859373322, 'loss_val': 0.7890240821023171, 'psi': 0.9031019029742415}-{'f1_val': 0.9899919630933373, 'auprc': 0.9771662263571357, 'loss_val': 0.0651596151199583, 'psi': 0.9848616683988566}
[S17] START round=44 head_norm_before_train=1.451520 cos_to_last_merge=0.9969 (last merge round=37)
[S17] round=44 local utility u=0.000000 metrics={'f1_val': 0.6600603227667352, 'auprc': 0.8316140496762615, 'loss_val': 1.0334424911749536, 'psi': 0.7286818135305457}-{'f1_val': 0.6861845585375733, 'auprc': 0.8539809192046243, 'loss_val': 0.86110594150105, 'psi': 0.7533031028043937}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S7] not sending this round → trigger blocked (psi=0.725)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.919)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3]  timeout peer S9
[S7]  timeout peer S14
[S13]  timeout peer S4
[S6]  timeout peer S11
[S5]  timeout peer S16
[S14]  timeout peer S15
[S2]  timeout peer S13
[S4]  timeout peer S10
[S16]  timeout peer S17
[S17]  timeout peer S3
[S2] START round=45 head_norm_before_train=1.468691 cos_to_last_merge=0.9896 (last merge round=38)
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.6296797042129503, 'auprc': 0.7015877335575682, 'loss_val': 1.0462166858176942, 'psi': 0.6584429159507974}-{'f1_val': 0.6587748838115091, 'auprc': 0.7131146354826603, 'loss_val': 0.908831908889559, 'psi': 0.6805107844799696}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=45 head_norm_before_train=1.587364 cos_to_last_merge=0.9982 (last merge round=38)
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.9973982357793907, 'auprc': 0.9985984973491117, 'loss_val': 0.04153162766638818, 'psi': 0.9978783404072791}-{'f1_val': 0.9969583726029951, 'auprc': 0.9993935030379884, 'loss_val': 0.030634007987087063, 'psi': 0.9979324247769925}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=45 head_norm_before_train=1.640083 cos_to_last_merge=0.9972 (last merge round=38)
[S4] round=45 local utility u=0.057019 metrics={'f1_val': 0.9422770203700287, 'auprc': 0.9607093337548347, 'loss_val': 0.287493717198909, 'psi': 0.9496499457239511}-{'f1_val': 0.938787657853011, 'auprc': 0.9349259035655637, 'loss_val': 0.30324480734785614, 'psi': 0.9372429561380321}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=45 head_norm_before_train=1.490471 cos_to_last_merge=0.9921 (last merge round=36)
[S5] round=45 local utility u=0.227243 metrics={'f1_val': 0.939445191832477, 'auprc': 0.9895983081049544, 'loss_val': 0.11366253499118106, 'psi': 0.959506438341468}-{'f1_val': 0.8727631742702155, 'auprc': 0.9893340226780266, 'loss_val': 0.1672644901614539, 'psi': 0.91939151363334}
[S5] not sending this round → trigger blocked (psi=0.960)
[S6] START round=45 head_norm_before_train=1.646376 cos_to_last_merge=0.9941 (last merge round=39)
[S6] round=45 local utility u=0.000000 metrics={'f1_val': 0.8473317037077148, 'auprc': 0.9614850259372987, 'loss_val': 0.3428628363659642, 'psi': 0.8929930325995483}-{'f1_val': 0.8469574251067978, 'auprc': 0.9677479321327829, 'loss_val': 0.27809789518979716, 'psi': 0.8952736279171918}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=45 head_norm_before_train=1.647267 cos_to_last_merge=0.9994 (last merge round=35)
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.5868270771753509, 'auprc': 0.786765480258844, 'loss_val': 0.8395409639856524, 'psi': 0.6668024384087481}-{'f1_val': 0.6620569379204247, 'auprc': 0.8192499209967588, 'loss_val': 0.38572107672798095, 'psi': 0.7249341311509583}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=45 head_norm_before_train=1.853718 cos_to_last_merge=0.7443 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.744
[S8] round=45 local utility u=0.009930 metrics={'f1_val': 0.9931893602624928, 'auprc': 0.9990892088459052, 'loss_val': 0.03320688706459041, 'psi': 0.9955492996958578}-{'f1_val': 0.991097207355627, 'auprc': 0.9991069935897565, 'loss_val': 0.040567487815922496, 'psi': 0.9943011218492788}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=45 head_norm_before_train=1.610242 cos_to_last_merge=0.9640 (last merge round=31)
[S9] round=45 local utility u=0.000000 metrics={'f1_val': 0.9471658328794277, 'auprc': 0.9839939873279588, 'loss_val': 0.10869711996966668, 'psi': 0.9618970946588401}-{'f1_val': 0.9971029125121428, 'auprc': 0.9995389409018797, 'loss_val': 0.023173738714721944, 'psi': 0.9980773238680376}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=45 head_norm_before_train=1.660466 cos_to_last_merge=0.9439 (last merge round=30)
[S10] ⚠️ Model drifted since last merge! cos=0.944
[S10] round=45 local utility u=0.000060 metrics={'f1_val': 0.9934496907403657, 'auprc': 0.9948768684367909, 'loss_val': 0.04226512117752209, 'psi': 0.9940205618189357}-{'f1_val': 0.9934252160563725, 'auprc': 0.995777373701088, 'loss_val': 0.04494029371893484, 'psi': 0.9943660791142587}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=45 head_norm_before_train=1.585919 cos_to_last_merge=0.9963 (last merge round=36)
[S11] round=45 local utility u=0.000000 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9977741724462279, 'loss_val': 0.037071847574987, 'psi': 0.9968927694598078}-{'f1_val': 0.996305167468861, 'auprc': 0.9981308307797179, 'loss_val': 0.03785386867386235, 'psi': 0.9970354327932037}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=45 head_norm_before_train=1.460753 cos_to_last_merge=0.9932 (last merge round=37)
[S13] round=45 local utility u=0.000000 metrics={'f1_val': 0.5276743283276457, 'auprc': 0.6933030957179023, 'loss_val': 1.096347311714213, 'psi': 0.5939258352837484}-{'f1_val': 0.5676030977119652, 'auprc': 0.6877903199067892, 'loss_val': 0.9783898532618551, 'psi': 0.6156779865898947}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=45 head_norm_before_train=1.769632 cos_to_last_merge=0.9967 (last merge round=37)
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.9963442551067831, 'auprc': 0.9944775812557387, 'loss_val': 0.03781560669786699, 'psi': 0.9955975855663654}-{'f1_val': 0.996754531653698, 'auprc': 0.9986273442671959, 'loss_val': 0.03520363867928245, 'psi': 0.9975036566990971}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=45 head_norm_before_train=1.796984 cos_to_last_merge=0.9980 (last merge round=39)
[S15] round=45 local utility u=0.272776 metrics={'f1_val': 0.8233518537855467, 'auprc': 0.9945013744825977, 'loss_val': 0.271598737804969, 'psi': 0.891811662064367}-{'f1_val': 0.7677572040693146, 'auprc': 0.9862951732578338, 'loss_val': 0.4589640890964935, 'psi': 0.8551723917447223}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=45 head_norm_before_train=1.524617 cos_to_last_merge=0.9924 (last merge round=38)
[S16] round=45 local utility u=0.000000 metrics={'f1_val': 0.8392254390151659, 'auprc': 0.9771676159157656, 'loss_val': 0.8904108335544078, 'psi': 0.8944023097754057}-{'f1_val': 0.8480912653748547, 'auprc': 0.985617859373322, 'loss_val': 0.7890240821023171, 'psi': 0.9031019029742415}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=45 head_norm_before_train=1.467787 cos_to_last_merge=0.9959 (last merge round=37)
[S17] round=45 local utility u=0.033529 metrics={'f1_val': 0.6734925251452962, 'auprc': 0.8310488960421591, 'loss_val': 1.0452822410541547, 'psi': 0.7365150735040413}-{'f1_val': 0.6600603227667352, 'auprc': 0.8316140496762615, 'loss_val': 1.0334424911749536, 'psi': 0.7286818135305457}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=46 head_norm_before_train=1.499865 cos_to_last_merge=0.9861 (last merge round=38)
[S2] round=46 local utility u=0.113084 metrics={'f1_val': 0.6527954004915902, 'auprc': 0.7012774587311857, 'loss_val': 0.9578111975042879, 'psi': 0.6721882237874285}-{'f1_val': 0.6296797042129503, 'auprc': 0.7015877335575682, 'loss_val': 1.0462166858176942, 'psi': 0.6584429159507974}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=46 head_norm_before_train=1.600126 cos_to_last_merge=0.9978 (last merge round=38)
[S3] round=46 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9964676482398261, 'loss_val': 0.14325164404808216, 'psi': 0.9752082099591965}-{'f1_val': 0.9973982357793907, 'auprc': 0.9985984973491117, 'loss_val': 0.04153162766638818, 'psi': 0.9978783404072791}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=46 head_norm_before_train=1.649336 cos_to_last_merge=0.9964 (last merge round=38)
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.9458492737965684, 'auprc': 0.9536405409080946, 'loss_val': 0.2936040475928975, 'psi': 0.9489657806411789}-{'f1_val': 0.9422770203700287, 'auprc': 0.9607093337548347, 'loss_val': 0.287493717198909, 'psi': 0.9496499457239511}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=46 head_norm_before_train=1.519639 cos_to_last_merge=0.9903 (last merge round=36)
[S5] round=46 local utility u=0.196362 metrics={'f1_val': 0.996288981767675, 'auprc': 0.9906580375857802, 'loss_val': 0.06518002126288032, 'psi': 0.9940366040949171}-{'f1_val': 0.939445191832477, 'auprc': 0.9895983081049544, 'loss_val': 0.11366253499118106, 'psi': 0.959506438341468}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=46 head_norm_before_train=1.664066 cos_to_last_merge=0.9923 (last merge round=39)
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.8468756734733317, 'auprc': 0.9530378407666518, 'loss_val': 0.3694963138116255, 'psi': 0.8893405403906597}-{'f1_val': 0.8473317037077148, 'auprc': 0.9614850259372987, 'loss_val': 0.3428628363659642, 'psi': 0.8929930325995483}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=46 head_norm_before_train=1.652610 cos_to_last_merge=0.9993 (last merge round=35)
[S7] round=46 local utility u=0.328443 metrics={'f1_val': 0.62965991068425, 'auprc': 0.8017937829477743, 'loss_val': 0.484736643472411, 'psi': 0.6985134595896597}-{'f1_val': 0.5868270771753509, 'auprc': 0.786765480258844, 'loss_val': 0.8395409639856524, 'psi': 0.6668024384087481}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=46 head_norm_before_train=1.861562 cos_to_last_merge=0.7434 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.743
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.9931893602624928, 'auprc': 0.9991158215595547, 'loss_val': 0.03401333035371478, 'psi': 0.9955599447813176}-{'f1_val': 0.9931893602624928, 'auprc': 0.9990892088459052, 'loss_val': 0.03320688706459041, 'psi': 0.9955492996958578}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=46 head_norm_before_train=1.622757 cos_to_last_merge=0.9626 (last merge round=31)
[S9] round=46 local utility u=0.208541 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.995545099389881, 'loss_val': 0.023427633452052156, 'psi': 0.9962335345148097}-{'f1_val': 0.9471658328794277, 'auprc': 0.9839939873279588, 'loss_val': 0.10869711996966668, 'psi': 0.9618970946588401}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=46 head_norm_before_train=1.672679 cos_to_last_merge=0.9425 (last merge round=30)
[S10] ⚠️ Model drifted since last merge! cos=0.943
[S10] round=46 local utility u=0.000000 metrics={'f1_val': 0.9925318880528124, 'auprc': 0.9955101336034081, 'loss_val': 0.045611546808059435, 'psi': 0.9937231862730507}-{'f1_val': 0.9934496907403657, 'auprc': 0.9948768684367909, 'loss_val': 0.04226512117752209, 'psi': 0.9940205618189357}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=46 head_norm_before_train=1.597436 cos_to_last_merge=0.9958 (last merge round=36)
[S11] round=46 local utility u=0.000722 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9978127354212354, 'loss_val': 0.03574408489448195, 'psi': 0.9969081946498107}-{'f1_val': 0.996305167468861, 'auprc': 0.9977741724462279, 'loss_val': 0.037071847574987, 'psi': 0.9968927694598078}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=46 head_norm_before_train=1.469770 cos_to_last_merge=0.9928 (last merge round=37)
[S13] round=46 local utility u=0.179827 metrics={'f1_val': 0.5608215954386929, 'auprc': 0.6863555411885132, 'loss_val': 0.9147347577570241, 'psi': 0.611035173738621}-{'f1_val': 0.5276743283276457, 'auprc': 0.6933030957179023, 'loss_val': 1.096347311714213, 'psi': 0.5939258352837484}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=46 head_norm_before_train=1.782587 cos_to_last_merge=0.9961 (last merge round=37)
[S14] round=46 local utility u=0.011176 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9984932671547637, 'loss_val': 0.031430590756561606, 'psi': 0.9975958117565045}-{'f1_val': 0.9963442551067831, 'auprc': 0.9944775812557387, 'loss_val': 0.03781560669786699, 'psi': 0.9955975855663654}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=46 head_norm_before_train=1.814402 cos_to_last_merge=0.9974 (last merge round=39)
[S15] round=46 local utility u=0.063782 metrics={'f1_val': 0.8394456186915511, 'auprc': 0.9938436481571905, 'loss_val': 0.2386236676021896, 'psi': 0.9012048304778069}-{'f1_val': 0.8233518537855467, 'auprc': 0.9945013744825977, 'loss_val': 0.271598737804969, 'psi': 0.891811662064367}
[S15] not sending this round → trigger blocked (psi=0.901)
[S16] START round=46 head_norm_before_train=1.541401 cos_to_last_merge=0.9917 (last merge round=38)
[S16] round=46 local utility u=0.825606 metrics={'f1_val': 0.9774689291658823, 'auprc': 0.9850547231908648, 'loss_val': 0.09232123890008721, 'psi': 0.9805032467758753}-{'f1_val': 0.8392254390151659, 'auprc': 0.9771676159157656, 'loss_val': 0.8904108335544078, 'psi': 0.8944023097754057}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S16] sending update (kind=head size=1806 to 1 peers)
[S17] START round=46 head_norm_before_train=1.489971 cos_to_last_merge=0.9944 (last merge round=37)
[S17] round=46 local utility u=0.014630 metrics={'f1_val': 0.6876532038324028, 'auprc': 0.8027975849067941, 'loss_val': 1.0162328812779544, 'psi': 0.7337109562621593}-{'f1_val': 0.6734925251452962, 'auprc': 0.8310488960421591, 'loss_val': 1.0452822410541547, 'psi': 0.7365150735040413}
[S17] not sending this round → trigger blocked (psi=0.734)
[S2] START round=47 head_norm_before_train=1.526694 cos_to_last_merge=0.9830 (last merge round=38)
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.6308166069260086, 'auprc': 0.7010722446227369, 'loss_val': 1.1416839633470623, 'psi': 0.6589188620047}-{'f1_val': 0.6527954004915902, 'auprc': 0.7012774587311857, 'loss_val': 0.9578111975042879, 'psi': 0.6721882237874285}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=47 head_norm_before_train=1.614248 cos_to_last_merge=0.9974 (last merge round=38)
[S3] round=47 local utility u=0.099009 metrics={'f1_val': 0.9836091889242733, 'auprc': 0.9969435266928239, 'loss_val': 0.08210442032178217, 'psi': 0.9889429240316935}-{'f1_val': 0.9610352511054436, 'auprc': 0.9964676482398261, 'loss_val': 0.14325164404808216, 'psi': 0.9752082099591965}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=47 head_norm_before_train=1.658571 cos_to_last_merge=0.9958 (last merge round=38)
[S4] round=47 local utility u=0.000142 metrics={'f1_val': 0.9478057205328723, 'auprc': 0.9496736427634636, 'loss_val': 0.2931571346222689, 'psi': 0.9485528894251087}-{'f1_val': 0.9458492737965684, 'auprc': 0.9536405409080946, 'loss_val': 0.2936040475928975, 'psi': 0.9489657806411789}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=47 head_norm_before_train=1.545611 cos_to_last_merge=0.9881 (last merge round=36)
[S5] round=47 local utility u=0.013885 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9920907635975709, 'loss_val': 0.04418710435865676, 'psi': 0.994857486526103}-{'f1_val': 0.996288981767675, 'auprc': 0.9906580375857802, 'loss_val': 0.06518002126288032, 'psi': 0.9940366040949171}
[S5] not sending this round → trigger blocked (psi=0.995)
[S6] START round=47 head_norm_before_train=1.681375 cos_to_last_merge=0.9909 (last merge round=39)
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.8447795841835253, 'auprc': 0.9430746298173422, 'loss_val': 0.3988538818730602, 'psi': 0.884097602437052}-{'f1_val': 0.8468756734733317, 'auprc': 0.9530378407666518, 'loss_val': 0.3694963138116255, 'psi': 0.8893405403906597}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=47 head_norm_before_train=1.656060 cos_to_last_merge=0.9993 (last merge round=35)
[S7] round=47 local utility u=0.001980 metrics={'f1_val': 0.6444712364174365, 'auprc': 0.8040739765966511, 'loss_val': 0.5764851563256892, 'psi': 0.7083123324891224}-{'f1_val': 0.62965991068425, 'auprc': 0.8017937829477743, 'loss_val': 0.484736643472411, 'psi': 0.6985134595896597}
[S7] not sending this round → trigger blocked (psi=0.708)
[S8] START round=47 head_norm_before_train=1.868280 cos_to_last_merge=0.7424 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.742
[S8] round=47 local utility u=0.004706 metrics={'f1_val': 0.9942857583640028, 'auprc': 0.999096347663705, 'loss_val': 0.031121319502309598, 'psi': 0.9962099940838838}-{'f1_val': 0.9931893602624928, 'auprc': 0.9991158215595547, 'loss_val': 0.03401333035371478, 'psi': 0.9955599447813176}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] START round=47 head_norm_before_train=1.633717 cos_to_last_merge=0.9616 (last merge round=31)
[S9] round=47 local utility u=0.006298 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9984137256287142, 'loss_val': 0.0218998166892413, 'psi': 0.9976272377587714}-{'f1_val': 0.9966924912647621, 'auprc': 0.995545099389881, 'loss_val': 0.023427633452052156, 'psi': 0.9962335345148097}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=47 head_norm_before_train=1.682945 cos_to_last_merge=0.9417 (last merge round=30)
[S10] ⚠️ Model drifted since last merge! cos=0.942
[S10] round=47 local utility u=0.002895 metrics={'f1_val': 0.9945468312215635, 'auprc': 0.9915134653606454, 'loss_val': 0.03992100871761846, 'psi': 0.9933334848771963}-{'f1_val': 0.9925318880528124, 'auprc': 0.9955101336034081, 'loss_val': 0.045611546808059435, 'psi': 0.9937231862730507}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=47 head_norm_before_train=1.609390 cos_to_last_merge=0.9952 (last merge round=36)
[S11] round=47 local utility u=0.000648 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9978039511477249, 'loss_val': 0.034421819839580294, 'psi': 0.9969046809404065}-{'f1_val': 0.996305167468861, 'auprc': 0.9978127354212354, 'loss_val': 0.03574408489448195, 'psi': 0.9969081946498107}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=47 head_norm_before_train=1.477642 cos_to_last_merge=0.9915 (last merge round=37)
[S13] round=47 local utility u=0.000000 metrics={'f1_val': 0.5421123484965008, 'auprc': 0.6915444876415842, 'loss_val': 1.0156211902160044, 'psi': 0.6018852041545342}-{'f1_val': 0.5608215954386929, 'auprc': 0.6863555411885132, 'loss_val': 0.9147347577570241, 'psi': 0.611035173738621}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=47 head_norm_before_train=1.795125 cos_to_last_merge=0.9955 (last merge round=37)
[S14] round=47 local utility u=0.003641 metrics={'f1_val': 0.9976291097282272, 'auprc': 0.9988130338411475, 'loss_val': 0.02889760557701623, 'psi': 0.9981026793733954}-{'f1_val': 0.9969975081576651, 'auprc': 0.9984932671547637, 'loss_val': 0.031430590756561606, 'psi': 0.9975958117565045}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=47 head_norm_before_train=1.831020 cos_to_last_merge=0.9967 (last merge round=39)
[S15] round=47 local utility u=0.355322 metrics={'f1_val': 0.935131628650313, 'auprc': 0.995192679923236, 'loss_val': 0.10614253340755588, 'psi': 0.9591560491594822}-{'f1_val': 0.8394456186915511, 'auprc': 0.9938436481571905, 'loss_val': 0.2386236676021896, 'psi': 0.9012048304778069}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] sending update (kind=head size=1803 to 1 peers)
[S16] START round=47 head_norm_before_train=1.558038 cos_to_last_merge=0.9908 (last merge round=38)
[S16] round=47 local utility u=0.060870 metrics={'f1_val': 0.9919481237413861, 'auprc': 0.9831247011142633, 'loss_val': 0.05166712432237136, 'psi': 0.988418754690537}-{'f1_val': 0.9774689291658823, 'auprc': 0.9850547231908648, 'loss_val': 0.09232123890008721, 'psi': 0.9805032467758753}
[S16] not sending this round → trigger blocked (psi=0.988)
[S17] START round=47 head_norm_before_train=1.510149 cos_to_last_merge=0.9929 (last merge round=37)
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.6041365677268609, 'auprc': 0.6422939658152534, 'loss_val': 1.3479558064388897, 'psi': 0.6193995269622179}-{'f1_val': 0.6876532038324028, 'auprc': 0.8027975849067941, 'loss_val': 1.0162328812779544, 'psi': 0.7337109562621593}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=48 head_norm_before_train=1.549974 cos_to_last_merge=0.9801 (last merge round=38)
[S2] round=48 local utility u=0.000000 metrics={'f1_val': 0.6326555193116968, 'auprc': 0.6864919477068168, 'loss_val': 1.1640192914006033, 'psi': 0.6541900906697449}-{'f1_val': 0.6308166069260086, 'auprc': 0.7010722446227369, 'loss_val': 1.1416839633470623, 'psi': 0.6589188620047}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=48 head_norm_before_train=1.628138 cos_to_last_merge=0.9970 (last merge round=38)
[S3] round=48 local utility u=0.054619 metrics={'f1_val': 0.992490592609234, 'auprc': 0.9996922212789882, 'loss_val': 0.03440043691582422, 'psi': 0.9953712440771357}-{'f1_val': 0.9836091889242733, 'auprc': 0.9969435266928239, 'loss_val': 0.08210442032178217, 'psi': 0.9889429240316935}
[S3] not sending this round → trigger blocked (psi=0.995)
[S4] START round=48 head_norm_before_train=1.663860 cos_to_last_merge=0.9953 (last merge round=38)
[S4] round=48 local utility u=0.026500 metrics={'f1_val': 0.942637544580035, 'auprc': 0.9763048618021218, 'loss_val': 0.28904132761958246, 'psi': 0.9561044714688698}-{'f1_val': 0.9478057205328723, 'auprc': 0.9496736427634636, 'loss_val': 0.2931571346222689, 'psi': 0.9485528894251087}
[S4] not sending this round → trigger blocked (psi=0.956)
[S5] START round=48 head_norm_before_train=1.573281 cos_to_last_merge=0.9854 (last merge round=36)
[S5] round=48 local utility u=0.000000 metrics={'f1_val': 0.9962633185437604, 'auprc': 0.991829771522814, 'loss_val': 0.041763317472713446, 'psi': 0.9944898997353818}-{'f1_val': 0.9967019684784577, 'auprc': 0.9920907635975709, 'loss_val': 0.04418710435865676, 'psi': 0.994857486526103}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=48 head_norm_before_train=1.697990 cos_to_last_merge=0.9899 (last merge round=39)
[S6] round=48 local utility u=0.000000 metrics={'f1_val': 0.7720088225063237, 'auprc': 0.9281391960559562, 'loss_val': 0.6086515268936723, 'psi': 0.8344609719261767}-{'f1_val': 0.8447795841835253, 'auprc': 0.9430746298173422, 'loss_val': 0.3988538818730602, 'psi': 0.884097602437052}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=48 head_norm_before_train=1.664536 cos_to_last_merge=0.9991 (last merge round=35)
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.6113508085217845, 'auprc': 0.7963672425617009, 'loss_val': 0.5974673225482239, 'psi': 0.685357382137751}-{'f1_val': 0.6444712364174365, 'auprc': 0.8040739765966511, 'loss_val': 0.5764851563256892, 'psi': 0.7083123324891224}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=48 head_norm_before_train=1.875404 cos_to_last_merge=0.7415 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.741
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.9939122747783468, 'auprc': 0.9992124814576844, 'loss_val': 0.030357560968012624, 'psi': 0.9960323574500818}-{'f1_val': 0.9942857583640028, 'auprc': 0.999096347663705, 'loss_val': 0.031121319502309598, 'psi': 0.9962099940838838}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=48 head_norm_before_train=1.643233 cos_to_last_merge=0.9606 (last merge round=31)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.9897071435092063, 'auprc': 0.9984250359679518, 'loss_val': 0.03777297978701242, 'psi': 0.9931943004927045}-{'f1_val': 0.9971029125121428, 'auprc': 0.9984137256287142, 'loss_val': 0.0218998166892413, 'psi': 0.9976272377587714}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=48 head_norm_before_train=1.693098 cos_to_last_merge=0.9408 (last merge round=30)
[S10] ⚠️ Model drifted since last merge! cos=0.941
[S10] round=48 local utility u=0.004372 metrics={'f1_val': 0.9945468312215635, 'auprc': 0.9938011057511797, 'loss_val': 0.038039363441727155, 'psi': 0.99424854103341}-{'f1_val': 0.9945468312215635, 'auprc': 0.9915134653606454, 'loss_val': 0.03992100871761846, 'psi': 0.9933334848771963}
[S10] not sending this round → trigger blocked (psi=0.994)
[S11] START round=48 head_norm_before_train=1.622073 cos_to_last_merge=0.9946 (last merge round=36)
[S11] round=48 local utility u=0.000946 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9981110679588296, 'loss_val': 0.0334513266355414, 'psi': 0.9970275276648484}-{'f1_val': 0.996305167468861, 'auprc': 0.9978039511477249, 'loss_val': 0.034421819839580294, 'psi': 0.9969046809404065}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] sending update (kind=head size=1793 to 1 peers)
[S13] START round=48 head_norm_before_train=1.485453 cos_to_last_merge=0.9908 (last merge round=37)
[S13] round=48 local utility u=0.000000 metrics={'f1_val': 0.5244124693538527, 'auprc': 0.6941610712364426, 'loss_val': 1.0758559096415619, 'psi': 0.5923119101068886}-{'f1_val': 0.5421123484965008, 'auprc': 0.6915444876415842, 'loss_val': 1.0156211902160044, 'psi': 0.6018852041545342}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=48 head_norm_before_train=1.806841 cos_to_last_merge=0.9949 (last merge round=37)
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.9709038657558404, 'auprc': 0.9989324949784102, 'loss_val': 0.05182649530836356, 'psi': 0.9821153174448682}-{'f1_val': 0.9976291097282272, 'auprc': 0.9988130338411475, 'loss_val': 0.02889760557701623, 'psi': 0.9981026793733954}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=48 head_norm_before_train=1.845955 cos_to_last_merge=0.9961 (last merge round=39)
[S15] round=48 local utility u=0.062315 metrics={'f1_val': 0.9524446625184665, 'auprc': 0.9953765658903349, 'loss_val': 0.08594306691748035, 'psi': 0.9696174238672138}-{'f1_val': 0.935131628650313, 'auprc': 0.995192679923236, 'loss_val': 0.10614253340755588, 'psi': 0.9591560491594822}
[S15] not sending this round → trigger blocked (psi=0.970)
[S16] START round=48 head_norm_before_train=1.575105 cos_to_last_merge=0.9899 (last merge round=38)
[S16] round=48 local utility u=0.000000 metrics={'f1_val': 0.939409483562186, 'auprc': 0.9864137282874298, 'loss_val': 0.24398399456357603, 'psi': 0.9582111814522836}-{'f1_val': 0.9919481237413861, 'auprc': 0.9831247011142633, 'loss_val': 0.05166712432237136, 'psi': 0.988418754690537}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=48 head_norm_before_train=1.531303 cos_to_last_merge=0.9912 (last merge round=37)
[S17] round=48 local utility u=0.954247 metrics={'f1_val': 0.7358894563952837, 'auprc': 0.8376908690548919, 'loss_val': 0.8161694761524233, 'psi': 0.7766100214591269}-{'f1_val': 0.6041365677268609, 'auprc': 0.6422939658152534, 'loss_val': 1.3479558064388897, 'psi': 0.6193995269622179}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=49 head_norm_before_train=1.568835 cos_to_last_merge=0.9776 (last merge round=38)
[S2] round=49 local utility u=0.115644 metrics={'f1_val': 0.6490621489381685, 'auprc': 0.6919367935652907, 'loss_val': 1.047505818049397, 'psi': 0.6662120067890174}-{'f1_val': 0.6326555193116968, 'auprc': 0.6864919477068168, 'loss_val': 1.1640192914006033, 'psi': 0.6541900906697449}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=49 head_norm_before_train=1.642636 cos_to_last_merge=0.9965 (last merge round=38)
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.9820710975803975, 'auprc': 0.9991259228181842, 'loss_val': 0.05307994428243891, 'psi': 0.9888930276755121}-{'f1_val': 0.992490592609234, 'auprc': 0.9996922212789882, 'loss_val': 0.03440043691582422, 'psi': 0.9953712440771357}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=49 head_norm_before_train=1.667751 cos_to_last_merge=0.9946 (last merge round=38)
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.9383568645763707, 'auprc': 0.934200585623959, 'loss_val': 0.3094121270939688, 'psi': 0.936694352995406}-{'f1_val': 0.942637544580035, 'auprc': 0.9763048618021218, 'loss_val': 0.28904132761958246, 'psi': 0.9561044714688698}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=49 head_norm_before_train=1.598262 cos_to_last_merge=0.9833 (last merge round=36)
[S5] round=49 local utility u=0.003238 metrics={'f1_val': 0.9962633185437604, 'auprc': 0.9923948513119045, 'loss_val': 0.03698252471728453, 'psi': 0.994715931651018}-{'f1_val': 0.9962633185437604, 'auprc': 0.991829771522814, 'loss_val': 0.041763317472713446, 'psi': 0.9944898997353818}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[S6] START round=49 head_norm_before_train=1.716836 cos_to_last_merge=0.9888 (last merge round=39)
[S6] round=49 local utility u=0.954894 metrics={'f1_val': 0.9859037827275415, 'auprc': 0.9670253245681695, 'loss_val': 0.09889133379543547, 'psi': 0.9783523994637927}-{'f1_val': 0.7720088225063237, 'auprc': 0.9281391960559562, 'loss_val': 0.6086515268936723, 'psi': 0.8344609719261767}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] START round=49 head_norm_before_train=1.672611 cos_to_last_merge=0.9988 (last merge round=35)
[S7] round=49 local utility u=0.000000 metrics={'f1_val': 0.589776431417373, 'auprc': 0.7871604466890931, 'loss_val': 0.9505233286885217, 'psi': 0.6687300375260611}-{'f1_val': 0.6113508085217845, 'auprc': 0.7963672425617009, 'loss_val': 0.5974673225482239, 'psi': 0.685357382137751}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=49 head_norm_before_train=1.882474 cos_to_last_merge=0.7406 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.741
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.9508647293857433, 'auprc': 0.999237997547022, 'loss_val': 0.1315480665299131, 'psi': 0.9702140366502547}-{'f1_val': 0.9939122747783468, 'auprc': 0.9992124814576844, 'loss_val': 0.030357560968012624, 'psi': 0.9960323574500818}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=49 head_norm_before_train=1.651762 cos_to_last_merge=0.9598 (last merge round=31)
[S9] round=49 local utility u=0.024258 metrics={'f1_val': 0.9954158325366191, 'auprc': 0.9984117798293717, 'loss_val': 0.023469841007025066, 'psi': 0.9966142114537202}-{'f1_val': 0.9897071435092063, 'auprc': 0.9984250359679518, 'loss_val': 0.03777297978701242, 'psi': 0.9931943004927045}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=49 head_norm_before_train=1.703937 cos_to_last_merge=0.9395 (last merge round=30)
[S10] ⚠️ Model drifted since last merge! cos=0.940
[S10] round=49 local utility u=0.003356 metrics={'f1_val': 0.9947419396681096, 'auprc': 0.9949268102876652, 'loss_val': 0.035875201921851, 'psi': 0.9948158879159318}-{'f1_val': 0.9945468312215635, 'auprc': 0.9938011057511797, 'loss_val': 0.038039363441727155, 'psi': 0.99424854103341}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[S11] START round=49 head_norm_before_train=1.634202 cos_to_last_merge=0.9940 (last merge round=36)
[S11] round=49 local utility u=0.000776 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9982266971022563, 'loss_val': 0.03224574110631339, 'psi': 0.9970737793222191}-{'f1_val': 0.996305167468861, 'auprc': 0.9981110679588296, 'loss_val': 0.0334513266355414, 'psi': 0.9970275276648484}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=49 head_norm_before_train=1.494289 cos_to_last_merge=0.9901 (last merge round=37)
[S13] round=49 local utility u=0.221943 metrics={'f1_val': 0.5693221054320315, 'auprc': 0.6812278193581085, 'loss_val': 0.8626271009065108, 'psi': 0.6140843910024623}-{'f1_val': 0.5244124693538527, 'auprc': 0.6941610712364426, 'loss_val': 1.0758559096415619, 'psi': 0.5923119101068886}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=49 head_norm_before_train=1.817214 cos_to_last_merge=0.9944 (last merge round=37)
[S14] round=49 local utility u=0.076301 metrics={'f1_val': 0.9971625532153504, 'auprc': 0.9954775010795034, 'loss_val': 0.046410720978203986, 'psi': 0.9964885323610115}-{'f1_val': 0.9709038657558404, 'auprc': 0.9989324949784102, 'loss_val': 0.05182649530836356, 'psi': 0.9821153174448682}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=49 head_norm_before_train=1.859879 cos_to_last_merge=0.9955 (last merge round=39)
[S15] round=49 local utility u=0.127202 metrics={'f1_val': 0.9887621300300798, 'auprc': 0.9957346476173952, 'loss_val': 0.050518791389417665, 'psi': 0.9915511370650059}-{'f1_val': 0.9524446625184665, 'auprc': 0.9953765658903349, 'loss_val': 0.08594306691748035, 'psi': 0.9696174238672138}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=49 head_norm_before_train=1.589810 cos_to_last_merge=0.9891 (last merge round=38)
[S16] round=49 local utility u=0.000000 metrics={'f1_val': 0.8547758680835205, 'auprc': 0.9852060332384387, 'loss_val': 0.7811872417188013, 'psi': 0.9069479341454878}-{'f1_val': 0.939409483562186, 'auprc': 0.9864137282874298, 'loss_val': 0.24398399456357603, 'psi': 0.9582111814522836}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=49 head_norm_before_train=1.549396 cos_to_last_merge=0.9897 (last merge round=37)
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.6348526282804805, 'auprc': 0.7104441539440658, 'loss_val': 1.0858057780997485, 'psi': 0.6650892385459146}-{'f1_val': 0.7358894563952837, 'auprc': 0.8376908690548919, 'loss_val': 0.8161694761524233, 'psi': 0.7766100214591269}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[runner] rounds complete.
[runner] all agents stopped.
