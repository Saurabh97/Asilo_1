[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:33903
[S3] → join 127.0.0.1:33902
[S4] → join 127.0.0.1:33902
[S5] → join 127.0.0.1:33902
[S6] → join 127.0.0.1:33902
[S7] → join 127.0.0.1:33902
[S8] → join 127.0.0.1:33902
[S9] → join 127.0.0.1:33902
[S10] → join 127.0.0.1:33902
[S11] → join 127.0.0.1:33902
[S13] → join 127.0.0.1:33902
[S14] → join 127.0.0.1:33902
[S15] → join 127.0.0.1:33902
[S16] → join 127.0.0.1:33902
[S17] → join 127.0.0.1:33902
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.245991 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.149665 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.173116 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.199244 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.166635 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.162745 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.174365 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.139120 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.114893 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.121011 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.181872 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.147131 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.136956 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.119894 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.063387 (no previous merge yet)
[S17]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S3] + discovered S13
[S3] + discovered S10
[S3] + discovered S6
[S3] + discovered S15
[S3] + discovered S17
[S3] + discovered S8
[S3] + discovered S9
[S3] + discovered S7
[S3] + discovered S14
[S3] + discovered S11
[S4] + discovered S3
[S3] + discovered S5
[S3] + discovered S16
[S4] + discovered S2
[S3] + discovered S4
[S4] + discovered S6
[S4] + discovered S14
[S4] + discovered S16
[S4] + discovered S15
[S5] + discovered S4
[S5] + discovered S2
[S4] + discovered S8
[S4] + discovered S9
[S5] + discovered S3
[S4] + discovered S7
[S4] + discovered S11
[S4] + discovered S5
[S4] + discovered S17
[S4] + discovered S10
[S4] + discovered S13
[S5] + discovered S7
[S5] + discovered S10
[S5] + discovered S9
[S6] + discovered S5
[S6] + discovered S3
[S5] + discovered S11
[S5] + discovered S8
[S5] + discovered S15
[S6] + discovered S2
[S5] + discovered S14
[S6] + discovered S4
[S5] + discovered S13
[S5] + discovered S6
[S5] + discovered S16
[S5] + discovered S17
[S7] + discovered S3
[S7] + discovered S2
[S6] + discovered S11
[S6] + discovered S7
[S6] + discovered S9
[S6] + discovered S17
[S6] + discovered S13
[S7] + discovered S5
[S6] + discovered S8
[S7] + discovered S4
[S6] + discovered S16
[S7] + discovered S6
[S6] + discovered S15
[S6] + discovered S10
[S6] + discovered S14
[S8] + discovered S3
[S7] + discovered S16
[S8] + discovered S2
[S8] + discovered S5
[S8] + discovered S7
[S7] + discovered S15
[S7] + discovered S14
[S7] + discovered S8
[S7] + discovered S13
[S8] + discovered S6
[S7] + discovered S10
[S8] + discovered S4
[S7] + discovered S11
[S7] + discovered S9
[S7] + discovered S17
[S8] + discovered S10
[S8] + discovered S14
[S8] + discovered S15
[S8] + discovered S11
[S8] + discovered S9
[S8] + discovered S17
[S8] + discovered S16
[S9] + discovered S6
[S8] + discovered S13
[S9] + discovered S4
[S9] + discovered S2
[S9] + discovered S7
[S9] + discovered S3
[S9] + discovered S5
[S9] + discovered S8
[S9] + discovered S11
[S9] + discovered S16
[S9] + discovered S10
[S10] + discovered S8
[S10] + discovered S3
[S10] + discovered S5
[S10] + discovered S9
[S10] + discovered S6
[S10] + discovered S4
[S10] + discovered S7
[S10] + discovered S2
[S9] + discovered S14
[S9] + discovered S15
[S9] + discovered S17
[S9] + discovered S13
[S11] + discovered S5
[S10] + discovered S17
[S10] + discovered S15
[S10] + discovered S16
[S11] + discovered S8
[S10] + discovered S14
[S10] + discovered S13
[S11] + discovered S6
[S11] + discovered S10
[S10] + discovered S11
[S11] + discovered S4
[S11] + discovered S3
[S11] + discovered S7
[S11] + discovered S2
[S11] + discovered S9
[S13] + discovered S2
[S11] + discovered S13
[S11] + discovered S14
[S13] + discovered S3
[S11] + discovered S16
[S13] + discovered S6
[S13] + discovered S8
[S13] + discovered S5
[S13] + discovered S10
[S13] + discovered S7
[S11] + discovered S15
[S13] + discovered S11
[S13] + discovered S4
[S11] + discovered S17
[S13] + discovered S9
[S13] + discovered S15
[S14] + discovered S5
[S14] + discovered S13
[S14] + discovered S9
[S14] + discovered S6
[S14] + discovered S2
[S13] + discovered S17
[S13] + discovered S16
[S14] + discovered S3
[S14] + discovered S11
[S14] + discovered S7
[S14] + discovered S4
[S14] + discovered S8
[S14] + discovered S10
[S13] + discovered S14
[S15] + discovered S7
[S15] + discovered S6
[S15] + discovered S4
[S15] + discovered S14
[S14] + discovered S17
[S15] + discovered S8
[S15] + discovered S9
[S15] + discovered S11
[S14] + discovered S15
[S15] + discovered S2
[S15] + discovered S10
[S15] + discovered S3
[S15] + discovered S13
[S15] + discovered S5
[S14] + discovered S16
[S16] + discovered S11
[S15] + discovered S17
[S16] + discovered S14
[S16] + discovered S5
[S16] + discovered S10
[S16] + discovered S9
[S16] + discovered S6
[S16] + discovered S2
[S16] + discovered S13
[S16] + discovered S3
[S16] + discovered S8
[S16] + discovered S15
[S16] + discovered S7
[S15] + discovered S16
[S16] + discovered S4
[S16] + discovered S17
[S17] + discovered S10
[S17] + discovered S3
[S17] + discovered S15
[S17] + discovered S7
[S17] + discovered S8
[S17] + discovered S14
[S17] + discovered S16
[S17] + discovered S13
[S17] + discovered S11
[S17] + discovered S6
[S17] + discovered S5
[S17] + discovered S4
[S17] + discovered S2
[S17] + discovered S9
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] ⇄ pheromone p=1.000 → S2@127.0.0.1:33902
[S4] ⇄ pheromone p=1.000 → S8@127.0.0.1:33909
[S11] ⇄ pheromone p=1.000 → S4@127.0.0.1:33904
[S6] ⇄ pheromone p=1.000 → S5@127.0.0.1:33905
[S13] ⇄ pheromone p=1.000 → S6@127.0.0.1:33907
[S3] ⇄ pheromone p=1.000 → S4@127.0.0.1:33904
[S16] ⇄ pheromone p=1.000 → S6@127.0.0.1:33907
[S2] ⇄ pheromone p=1.000 → S3@127.0.0.1:33903
[S5] ⇄ pheromone p=1.000 → S3@127.0.0.1:33903
[S8] ⇄ pheromone p=1.000 → S2@127.0.0.1:33902
[S15] ⇄ pheromone p=1.000 → S8@127.0.0.1:33909
[S14] ⇄ pheromone p=1.000 → S7@127.0.0.1:33908
[S10] ⇄ pheromone p=1.000 → S6@127.0.0.1:33907
[S9] ⇄ pheromone p=1.000 → S10@127.0.0.1:33911
[S17] ⇄ pheromone p=1.000 → S8@127.0.0.1:33909
[S2] START round=1 head_norm_before_train=1.245883 (no previous merge yet)
[S2] round=1 local utility u=0.000000 metrics={'f1_val': 0.3068077396066633, 'auprc': 0.7302814373234251, 'loss_val': 1.3086504824766256, 'psi': 0.476197218693368}-{'f1_val': 0.6810771084644732, 'auprc': 0.6877491460892624, 'loss_val': 1.3501082877090993, 'psi': 0.6837459235143889}
[S3] START round=1 head_norm_before_train=1.156802 (no previous merge yet)
[S3] round=1 local utility u=0.426639 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.5846888102179562, 'loss_val': 1.3423777419450953, 'psi': 0.31777956345564673}-{'f1_val': 0.13984006561410703, 'auprc': 0.3098567888566244, 'loss_val': 1.3711592827701506, 'psi': 0.20784675491111398}
[S4] START round=1 head_norm_before_train=1.164484 (no previous merge yet)
[S4] round=1 local utility u=0.574360 metrics={'f1_val': 0.13844457913596603, 'auprc': 0.6549569476720272, 'loss_val': 1.374038405644778, 'psi': 0.3450495265503905}-{'f1_val': 0.08833063209076175, 'auprc': 0.38211330301156665, 'loss_val': 1.4035438627128614, 'psi': 0.20584370045908373}
[S5] START round=1 head_norm_before_train=1.205154 (no previous merge yet)
[S5] round=1 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7754563919676376, 'loss_val': 1.3200201039952384, 'psi': 0.39553969964419794}-{'f1_val': 0.14226190476190476, 'auprc': 0.7991601946916391, 'loss_val': 1.3516003002650507, 'psi': 0.40502122073379854}
[S6] START round=1 head_norm_before_train=1.167748 (no previous merge yet)
[S6] round=1 local utility u=0.289471 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8331368876295872, 'loss_val': 1.3120796388926277, 'psi': 0.4181105242826041}-{'f1_val': 0.14142628205128205, 'auprc': 0.6484680784896594, 'loss_val': 1.337014664463292, 'psi': 0.344243000626633}
[S7] START round=1 head_norm_before_train=1.165409 (no previous merge yet)
[S7] round=1 local utility u=0.189807 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7890901240822047, 'loss_val': 1.3274969190657033, 'psi': 0.4008701432703369}-{'f1_val': 0.18152735640970513, 'auprc': 0.5925785350124896, 'loss_val': 1.3543988496095756, 'psi': 0.3459478278508189}
[S8] START round=1 head_norm_before_train=1.171930 (no previous merge yet)
[S8] round=1 local utility u=0.982282 metrics={'f1_val': 0.39925515069135475, 'auprc': 0.7573980327520573, 'loss_val': 1.3352490661605678, 'psi': 0.5425123035156358}-{'f1_val': 0.10450549450549451, 'auprc': 0.7029508587723925, 'loss_val': 1.3679742163806536, 'psi': 0.3438836402122537}
[S9] START round=1 head_norm_before_train=1.143275 (no previous merge yet)
[S9] round=1 local utility u=0.987635 metrics={'f1_val': 0.4015456148687436, 'auprc': 0.8613046737241038, 'loss_val': 1.3211171517049403, 'psi': 0.5854492384108877}-{'f1_val': 0.10457155477031801, 'auprc': 0.8129911811383025, 'loss_val': 1.3696014340251512, 'psi': 0.3879394053175118}
[S10] START round=1 head_norm_before_train=1.116808 (no previous merge yet)
[S10] round=1 local utility u=0.257174 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.5734842599221732, 'loss_val': 1.3136204665896165, 'psi': 0.3125666864939036}-{'f1_val': 0.13862163754172394, 'auprc': 0.4112986759122038, 'loss_val': 1.3414113755967536, 'psi': 0.2476924528899159}
[S11] START round=1 head_norm_before_train=1.125778 (no previous merge yet)
[S11] round=1 local utility u=1.000000 metrics={'f1_val': 0.39672335579787343, 'auprc': 0.7955156576532589, 'loss_val': 1.337467639255434, 'psi': 0.5562402765400276}-{'f1_val': 0.10359570269677702, 'auprc': 0.6249719809810178, 'loss_val': 1.3671177633700193, 'psi': 0.3121462140104733}
[S13] START round=1 head_norm_before_train=1.180564 (no previous merge yet)
[S13] round=1 local utility u=0.841221 metrics={'f1_val': 0.37183652219122787, 'auprc': 0.7484555046311797, 'loss_val': 1.3276450500027994, 'psi': 0.5224841151672086}-{'f1_val': 0.09037372593431484, 'auprc': 0.7622770083045582, 'loss_val': 1.3627741247467065, 'psi': 0.3591350388824122}
[S14] START round=1 head_norm_before_train=1.157782 (no previous merge yet)
[S14] round=1 local utility u=0.986639 metrics={'f1_val': 0.4085476861639652, 'auprc': 0.8479011445506566, 'loss_val': 1.3292735045432227, 'psi': 0.5842890695186418}-{'f1_val': 0.09155565590426733, 'auprc': 0.8317914276966683, 'loss_val': 1.3522698622481706, 'psi': 0.3876499646212277}
[S15] START round=1 head_norm_before_train=1.143939 (no previous merge yet)
[S15] round=1 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.765507812980726, 'loss_val': 1.3275429056869748, 'psi': 0.3900433160092254}-{'f1_val': 0.3157051227731047, 'auprc': 0.5180326327755871, 'loss_val': 1.3560271619909627, 'psi': 0.39663612677409765}
[S16] START round=1 head_norm_before_train=1.125380 (no previous merge yet)
[S16] round=1 local utility u=0.322497 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.985965167993413, 'loss_val': 1.306434424737706, 'psi': 0.4787685373168872}-{'f1_val': 0.14063745019920318, 'auprc': 0.7793063922496626, 'loss_val': 1.3314516337368902, 'psi': 0.396105027019387}
[S17] START round=1 head_norm_before_train=1.061525 (no previous merge yet)
[S17] round=1 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5484555648025542, 'loss_val': 1.3577621827402515, 'psi': 0.3039516039114523}-{'f1_val': 0.26468812490386096, 'auprc': 0.3786503524887814, 'loss_val': 1.3841158154447146, 'psi': 0.3102730159378292}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:33904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:33909
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S4] → sending delta(kind=head bytes=1788) to S15@127.0.0.1:33915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:33912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S13] → sending delta(kind=head bytes=1790) to S2@127.0.0.1:33902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:33915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] → sending delta(kind=head bytes=1793) to S10@127.0.0.1:33911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S3] → sending delta(kind=head bytes=1788) to S17@127.0.0.1:33917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S10] → sending delta(kind=head bytes=1787) to S3@127.0.0.1:33903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:33915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:33907
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1793 to 1 peers)
[S13] sending update (kind=head size=1790 to 1 peers)
[S7] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1793 to 1 peers)
[S10] sending update (kind=head size=1787 to 1 peers)
[S6] sending update (kind=head size=1793 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1788 to 1 peers)
[S11] sending update (kind=head size=1793 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1788 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1788) from S4
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.164526)
[S15] loaded HEAD from S4 (vec_in norm=1.164526)
[S15] cosine check vs S4: cos=-0.0212
[S15] DROPPED delta from S4 (cos=-0.0212 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1794) from S7
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.175946)
[S4] loaded HEAD from S7 (vec_in norm=1.175946)
[S4] cosine check vs S7: cos=0.0071
[S4] BUFFERED delta from S7 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1790) from S13
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.191195)
[S2] loaded HEAD from S13 (vec_in norm=1.191195)
[S2] cosine check vs S13: cos=-0.0290
[S2] DROPPED delta from S13 (cos=-0.0290 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1801) from S9
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.158540)
[S11] loaded HEAD from S9 (vec_in norm=1.158540)
[S11] cosine check vs S9: cos=0.0609
[S11] BUFFERED delta from S9 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1798) from S16
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.140719)
[S8] loaded HEAD from S16 (vec_in norm=1.140719)
[S8] cosine check vs S16: cos=0.0298
[S8] BUFFERED delta from S16 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1793) from S6
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.174750)
[S10] loaded HEAD from S6 (vec_in norm=1.174750)
[S10] cosine check vs S6: cos=0.0012
[S10] BUFFERED delta from S6 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1793) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.174695)
[S15] loaded HEAD from S14 (vec_in norm=1.174695)
[S15] cosine check vs S14: cos=-0.0451
[S15] DROPPED delta from S14 (cos=-0.0451 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1793) from S11
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.139907)
[S15] loaded HEAD from S11 (vec_in norm=1.139907)
[S15] cosine check vs S11: cos=-0.0531
[S15] DROPPED delta from S11 (cos=-0.0531 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1787) from S10
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.127869)
[S3] loaded HEAD from S10 (vec_in norm=1.127869)
[S3] cosine check vs S10: cos=-0.0303
[S3] DROPPED delta from S10 (cos=-0.0303 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1788) from S3
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.170091)
[S17] loaded HEAD from S3 (vec_in norm=1.170091)
[S17] cosine check vs S3: cos=0.0595
[S17] BUFFERED delta from S3 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1793) from S8
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.179619)
[S6] loaded HEAD from S8 (vec_in norm=1.179619)
[S6] cosine check vs S8: cos=0.1221
[S6] BUFFERED delta from S8 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=1 metric=0.1384 head_norm=1.164526
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.245318e-01
[S4] stored merged vector for next round verification (round=1)
[S4] DEBUG after merge:  round=1 metric=0.0883 head_norm=0.830441 delta_norm=0.824532
[S4] aggregate: ROLLBACK (f1_val pre=0.138 post=0.088 tol_abs=0.005 tol_rel=0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=1 metric=0.1386 head_norm=1.127869
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.137842e-01
[S10] stored merged vector for next round verification (round=1)
[S10] DEBUG after merge:  round=1 metric=0.1386 head_norm=0.814750 delta_norm=0.813784
[S10] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=1 metric=0.3993 head_norm=1.179619
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.081625e-01
[S8] stored merged vector for next round verification (round=1)
[S8] DEBUG after merge:  round=1 metric=0.1400 head_norm=0.832612 delta_norm=0.808162
[S8] aggregate: ROLLBACK (f1_val pre=0.399 post=0.140 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=1 metric=0.3967 head_norm=1.139907
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.875323e-01
[S11] stored merged vector for next round verification (round=1)
[S11] DEBUG after merge:  round=1 metric=0.1036 head_norm=0.837015 delta_norm=0.787532
[S11] aggregate: ROLLBACK (f1_val pre=0.397 post=0.104 tol_abs=0.005 tol_rel=0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=1 metric=0.1414 head_norm=1.174750
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.799072e-01
[S6] stored merged vector for next round verification (round=1)
[S6] DEBUG after merge:  round=1 metric=0.1414 head_norm=0.881767 delta_norm=0.779907
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=1 metric=0.1409 head_norm=1.070482
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.690763e-01
[S17] stored merged vector for next round verification (round=1)
[S17] DEBUG after merge:  round=1 metric=0.1005 head_norm=0.816116 delta_norm=0.769076
[S17] aggregate: ROLLBACK (f1_val pre=0.141 post=0.101 tol_abs=0.005 tol_rel=0.0)
[S2] START round=2 head_norm_before_train=1.255032 (no previous merge yet)
[S2] round=2 local utility u=0.000000 metrics={'f1_val': 0.16707406502077732, 'auprc': 0.7484554199591301, 'loss_val': 1.2602792557809857, 'psi': 0.39962660699611846}-{'f1_val': 0.3068077396066633, 'auprc': 0.7302814373234251, 'loss_val': 1.3086504824766256, 'psi': 0.476197218693368}
[S3] START round=2 head_norm_before_train=1.170091 (no previous merge yet)
[S3] round=2 local utility u=0.397128 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8385635964137099, 'loss_val': 1.3097461678869406, 'psi': 0.41932947793394826}-{'f1_val': 0.13984006561410703, 'auprc': 0.5846888102179562, 'loss_val': 1.3423777419450953, 'psi': 0.31777956345564673}
[S4] START round=2 head_norm_before_train=0.830441 cos_to_last_merge=1.0000 (last merge round=1)
[S4] round=2 local utility u=0.099467 metrics={'f1_val': 0.11506476706379687, 'auprc': 0.7623515932100998, 'loss_val': 1.3570085027916365, 'psi': 0.37397949752231807}-{'f1_val': 0.13844457913596603, 'auprc': 0.6549569476720272, 'loss_val': 1.374038405644778, 'psi': 0.3450495265503905}
[S5] START round=2 head_norm_before_train=1.217619 (no previous merge yet)
[S5] round=2 local utility u=0.010246 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7699093300572705, 'loss_val': 1.28288786522821, 'psi': 0.3933208748800511}-{'f1_val': 0.14226190476190476, 'auprc': 0.7754563919676376, 'loss_val': 1.3200201039952384, 'psi': 0.39553969964419794}
[S6] START round=2 head_norm_before_train=0.881767 cos_to_last_merge=1.0000 (last merge round=1)
[S6] round=2 local utility u=0.036035 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8594783944209845, 'loss_val': 1.3190339028116125, 'psi': 0.428647126999163}-{'f1_val': 0.14142628205128205, 'auprc': 0.8331368876295872, 'loss_val': 1.3120796388926277, 'psi': 0.4181105242826041}
[S7] START round=2 head_norm_before_train=1.175946 (no previous merge yet)
[S7] round=2 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7775069668927208, 'loss_val': 1.2958390357610199, 'psi': 0.39623688039454336}-{'f1_val': 0.14205682272909165, 'auprc': 0.7890901240822047, 'loss_val': 1.3274969190657033, 'psi': 0.4008701432703369}
[S8] START round=2 head_norm_before_train=0.832612 cos_to_last_merge=1.0000 (last merge round=1)
[S8] round=2 local utility u=0.000000 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7378501756342812, 'loss_val': 1.325905886617263, 'psi': 0.37911365968948685}-{'f1_val': 0.39925515069135475, 'auprc': 0.7573980327520573, 'loss_val': 1.3352490661605678, 'psi': 0.5425123035156358}
[S9] START round=2 head_norm_before_train=1.158540 (no previous merge yet)
[S9] round=2 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8653730274168633, 'loss_val': 1.2572052685083879, 'psi': 0.43098798525074294}-{'f1_val': 0.4015456148687436, 'auprc': 0.8613046737241038, 'loss_val': 1.3211171517049403, 'psi': 0.5854492384108877}
[S10] START round=2 head_norm_before_train=0.814750 cos_to_last_merge=1.0000 (last merge round=1)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.5468314525113653, 'loss_val': 1.304681887404477, 'psi': 0.30190556352958053}-{'f1_val': 0.13862163754172394, 'auprc': 0.5734842599221732, 'loss_val': 1.3136204665896165, 'psi': 0.3125666864939036}
[S11] START round=2 head_norm_before_train=0.837015 cos_to_last_merge=1.0000 (last merge round=1)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.10359570269677702, 'auprc': 0.962760153548046, 'loss_val': 1.3470402782866617, 'psi': 0.44726148303728464}-{'f1_val': 0.39672335579787343, 'auprc': 0.7955156576532589, 'loss_val': 1.337467639255434, 'psi': 0.5562402765400276}
[S13] START round=2 head_norm_before_train=1.191195 (no previous merge yet)
[S13] round=2 local utility u=0.000000 metrics={'f1_val': 0.15317123554130682, 'auprc': 0.7465673389272666, 'loss_val': 1.28705410390724, 'psi': 0.39052967689569074}-{'f1_val': 0.37183652219122787, 'auprc': 0.7484555046311797, 'loss_val': 1.3276450500027994, 'psi': 0.5224841151672086}
[S14] START round=2 head_norm_before_train=1.174695 (no previous merge yet)
[S14] round=2 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8342814255078017, 'loss_val': 1.304071294570691, 'psi': 0.417927281932743}-{'f1_val': 0.4085476861639652, 'auprc': 0.8479011445506566, 'loss_val': 1.3292735045432227, 'psi': 0.5842890695186418}
[S15] START round=2 head_norm_before_train=1.158591 (no previous merge yet)
[S15] round=2 local utility u=0.017949 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7665464562332144, 'loss_val': 1.2947610828245886, 'psi': 0.3904587733102208}-{'f1_val': 0.13973365136155833, 'auprc': 0.765507812980726, 'loss_val': 1.3275429056869748, 'psi': 0.3900433160092254}
[S16] START round=2 head_norm_before_train=1.140719 (no previous merge yet)
[S16] round=2 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8419576512261324, 'loss_val': 1.278036817488487, 'psi': 0.42116553060997486}-{'f1_val': 0.14063745019920318, 'auprc': 0.985965167993413, 'loss_val': 1.306434424737706, 'psi': 0.4787685373168872}
[S17] START round=2 head_norm_before_train=0.816116 cos_to_last_merge=1.0000 (last merge round=1)
[S17] round=2 local utility u=0.225826 metrics={'f1_val': 0.1612977766841431, 'auprc': 0.6554457263880193, 'loss_val': 1.3491726335482572, 'psi': 0.3589569565656936}-{'f1_val': 0.14094896331738438, 'auprc': 0.5484555648025542, 'loss_val': 1.3577621827402515, 'psi': 0.3039516039114523}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S3] → sending delta(kind=head bytes=1791) to S16@127.0.0.1:33916
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:33912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:33916
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S15] → sending delta(kind=head bytes=1788) to S17@127.0.0.1:33917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:33916
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1791 to 1 peers)
[S15] sending update (kind=head size=1788 to 1 peers)
[S6] sending update (kind=head size=1794 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1788) from S15
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.180490)
[S17] loaded HEAD from S15 (vec_in norm=1.180490)
[S17] cosine check vs S15: cos=0.0151
[S17] BUFFERED delta from S15 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1797) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.837329)
[S11] loaded HEAD from S4 (vec_in norm=0.837329)
[S11] cosine check vs S4: cos=0.0210
[S11] BUFFERED delta from S4 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1794) from S6
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.891208)
[S16] loaded HEAD from S6 (vec_in norm=0.891208)
[S16] cosine check vs S6: cos=0.0038
[S16] BUFFERED delta from S6 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1796) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.238367)
[S16] loaded HEAD from S5 (vec_in norm=1.238367)
[S16] cosine check vs S5: cos=-0.0139
[S16] DROPPED delta from S5 (cos=-0.0139 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1791) from S3
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.189109)
[S16] loaded HEAD from S3 (vec_in norm=1.189109)
[S16] cosine check vs S3: cos=-0.0468
[S16] DROPPED delta from S3 (cos=-0.0468 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:33915
[S17] sending update (kind=head size=1796 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1796) from S17
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.825975)
[S15] loaded HEAD from S17 (vec_in norm=0.825975)
[S15] cosine check vs S17: cos=0.0151
[S15] BUFFERED delta from S17 (total buffered=1)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=2 metric=0.1036 head_norm=0.852335
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.911000e-01
[S11] stored merged vector for next round verification (round=2)
[S11] DEBUG after merge:  round=2 metric=0.1036 head_norm=0.603654 delta_norm=0.591100
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=2 metric=0.1406 head_norm=1.165104
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.320840e-01
[S16] stored merged vector for next round verification (round=2)
[S16] DEBUG after merge:  round=2 metric=0.1406 head_norm=0.734788 delta_norm=0.732084
[S16] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=2 metric=0.1397 head_norm=1.180490
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.152569e-01
[S15] stored merged vector for next round verification (round=2)
[S15] DEBUG after merge:  round=2 metric=0.1397 head_norm=0.725467 delta_norm=0.715257
[S15] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=2 metric=0.1613 head_norm=0.825975
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.152569e-01
[S17] stored merged vector for next round verification (round=2)
[S17] DEBUG after merge:  round=2 metric=0.1409 head_norm=0.725467 delta_norm=0.715257
[S17] aggregate: ROLLBACK (f1_val pre=0.161 post=0.141 tol_abs=0.005 tol_rel=0.0)
[S2] START round=3 head_norm_before_train=1.273698 (no previous merge yet)
[S2] round=3 local utility u=0.000000 metrics={'f1_val': 0.14857825048838724, 'auprc': 0.7584606534876863, 'loss_val': 1.1975470791371612, 'psi': 0.3925312116881069}-{'f1_val': 0.16707406502077732, 'auprc': 0.7484554199591301, 'loss_val': 1.2602792557809857, 'psi': 0.39962660699611846}
[S3] START round=3 head_norm_before_train=1.189109 (no previous merge yet)
[S3] round=3 local utility u=0.262358 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9988963336497274, 'loss_val': 1.2660283413207347, 'psi': 0.48346257282835525}-{'f1_val': 0.13984006561410703, 'auprc': 0.8385635964137099, 'loss_val': 1.3097461678869406, 'psi': 0.41932947793394826}
[S4] START round=3 head_norm_before_train=0.837329 cos_to_last_merge=0.9966 (last merge round=1)
[S4] round=3 local utility u=0.870245 metrics={'f1_val': 0.3977525309336333, 'auprc': 0.7659732058674387, 'loss_val': 1.3235108550151513, 'psi': 0.5450408009071555}-{'f1_val': 0.11506476706379687, 'auprc': 0.7623515932100998, 'loss_val': 1.3570085027916365, 'psi': 0.37397949752231807}
[S5] START round=3 head_norm_before_train=1.238367 (no previous merge yet)
[S5] round=3 local utility u=0.020684 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.766797764328839, 'loss_val': 1.2321858812200421, 'psi': 0.39207624858867846}-{'f1_val': 0.14226190476190476, 'auprc': 0.7699093300572705, 'loss_val': 1.28288786522821, 'psi': 0.3933208748800511}
[S6] START round=3 head_norm_before_train=0.891208 cos_to_last_merge=0.9974 (last merge round=1)
[S6] round=3 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8469757547233876, 'loss_val': 1.2856772332521011, 'psi': 0.42364607112012426}-{'f1_val': 0.14142628205128205, 'auprc': 0.8594783944209845, 'loss_val': 1.3190339028116125, 'psi': 0.428647126999163}
[S7] START round=3 head_norm_before_train=1.194772 (no previous merge yet)
[S7] round=3 local utility u=0.015909 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7776765770963872, 'loss_val': 1.2645303911329748, 'psi': 0.3963047244760099}-{'f1_val': 0.14205682272909165, 'auprc': 0.7775069668927208, 'loss_val': 1.2958390357610199, 'psi': 0.39623688039454336}
[S8] START round=3 head_norm_before_train=0.843731 cos_to_last_merge=0.9968 (last merge round=1)
[S8] round=3 local utility u=0.025543 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7432512895638832, 'loss_val': 1.2910232815298248, 'psi': 0.3812741052613276}-{'f1_val': 0.13995598239295717, 'auprc': 0.7378501756342812, 'loss_val': 1.325905886617263, 'psi': 0.37911365968948685}
[S9] START round=3 head_norm_before_train=1.183114 (no previous merge yet)
[S9] round=3 local utility u=0.040147 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8655494053008873, 'loss_val': 1.1774405044711687, 'psi': 0.43105853640435254}-{'f1_val': 0.141397957139996, 'auprc': 0.8653730274168633, 'loss_val': 1.2572052685083879, 'psi': 0.43098798525074294}
[S10] START round=3 head_norm_before_train=0.830565 cos_to_last_merge=0.9974 (last merge round=1)
[S10] round=3 local utility u=0.128631 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6199062204307068, 'loss_val': 1.266644427205031, 'psi': 0.3311354706973171}-{'f1_val': 0.13862163754172394, 'auprc': 0.5468314525113653, 'loss_val': 1.304681887404477, 'psi': 0.30190556352958053}
[S11] START round=3 head_norm_before_train=0.603654 cos_to_last_merge=1.0000 (last merge round=2)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7017387020488403, 'loss_val': 1.3422967732890247, 'psi': 0.36494369084340245}-{'f1_val': 0.10359570269677702, 'auprc': 0.962760153548046, 'loss_val': 1.3470402782866617, 'psi': 0.44726148303728464}
[S13] START round=3 head_norm_before_train=1.213779 (no previous merge yet)
[S13] round=3 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7389499228047962, 'loss_val': 1.2378529034755557, 'psi': 0.3798114266681503}-{'f1_val': 0.15317123554130682, 'auprc': 0.7465673389272666, 'loss_val': 1.28705410390724, 'psi': 0.39052967689569074}
[S14] START round=3 head_norm_before_train=1.198748 (no previous merge yet)
[S14] round=3 local utility u=0.054362 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8620577161015729, 'loss_val': 1.2786764836557445, 'psi': 0.42903779817025145}-{'f1_val': 0.14035785288270378, 'auprc': 0.8342814255078017, 'loss_val': 1.304071294570691, 'psi': 0.417927281932743}
[S15] START round=3 head_norm_before_train=0.725467 cos_to_last_merge=1.0000 (last merge round=2)
[S15] round=3 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.76743251484221, 'loss_val': 1.2991463527727107, 'psi': 0.39081319675381904}-{'f1_val': 0.13973365136155833, 'auprc': 0.7665464562332144, 'loss_val': 1.2947610828245886, 'psi': 0.3904587733102208}
[S16] START round=3 head_norm_before_train=0.734788 cos_to_last_merge=1.0000 (last merge round=2)
[S16] round=3 local utility u=0.194776 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.976328889779045, 'loss_val': 1.2915976085316387, 'psi': 0.47491402603113997}-{'f1_val': 0.14063745019920318, 'auprc': 0.8419576512261324, 'loss_val': 1.278036817488487, 'psi': 0.42116553060997486}
[S17] START round=3 head_norm_before_train=0.725467 cos_to_last_merge=1.0000 (last merge round=2)
[S17] round=3 local utility u=0.048314 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.7197591026439462, 'loss_val': 1.3233919190674397, 'psi': 0.3724730190480091}-{'f1_val': 0.1612977766841431, 'auprc': 0.6554457263880193, 'loss_val': 1.3491726335482572, 'psi': 0.3589569565656936}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] → sending delta(kind=head bytes=1793) to S10@127.0.0.1:33911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:33907
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:33904
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:33903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] → sending delta(kind=head bytes=1792) to S2@127.0.0.1:33902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S14] → sending delta(kind=head bytes=1790) to S7@127.0.0.1:33908
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:33902
[S3] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1790 to 1 peers)
[S8] sending update (kind=head size=1792 to 1 peers)
[S9] sending update (kind=head size=1793 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1799) from S7
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.217094)
[S2] loaded HEAD from S7 (vec_in norm=1.217094)
[S2] cosine check vs S7: cos=0.0806
[S2] BUFFERED delta from S7 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1790) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.228370)
[S7] loaded HEAD from S14 (vec_in norm=1.228370)
[S7] cosine check vs S14: cos=0.0639
[S7] BUFFERED delta from S14 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1796) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.267326)
[S3] loaded HEAD from S5 (vec_in norm=1.267326)
[S3] cosine check vs S5: cos=-0.0147
[S3] DROPPED delta from S5 (cos=-0.0147 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1797) from S10
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=0.854683)
[S6] loaded HEAD from S10 (vec_in norm=0.854683)
[S6] cosine check vs S10: cos=0.5023
[S6] BUFFERED delta from S10 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1796) from S3
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.216565)
[S4] loaded HEAD from S3 (vec_in norm=1.216565)
[S4] cosine check vs S3: cos=0.0357
[S4] BUFFERED delta from S3 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1793) from S9
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.213812)
[S10] loaded HEAD from S9 (vec_in norm=1.213812)
[S10] cosine check vs S9: cos=-0.0718
[S10] DROPPED delta from S9 (cos=-0.0718 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1797) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.759966)
[S6] loaded HEAD from S16 (vec_in norm=0.759966)
[S6] cosine check vs S16: cos=0.5809
[S6] BUFFERED delta from S16 (total buffered=2)
[S2] RECEIVED delta(kind=head bytes=1792) from S8
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.866625)
[S2] loaded HEAD from S8 (vec_in norm=0.866625)
[S2] cosine check vs S8: cos=0.0593
[S2] BUFFERED delta from S8 (total buffered=2)
[S8] RECEIVED delta(kind=head bytes=1795) from S4
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.853956)
[S8] loaded HEAD from S4 (vec_in norm=0.853956)
[S8] cosine check vs S4: cos=-0.0117
[S8] DROPPED delta from S4 (cos=-0.0117 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:33909
[S17] sending update (kind=head size=1798 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.745142)
[S8] loaded HEAD from S17 (vec_in norm=0.745142)
[S8] cosine check vs S17: cos=0.0223
[S8] BUFFERED delta from S17 (total buffered=1)
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=3 metric=0.1414 head_norm=0.910986
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.336667e-01
[S6] stored merged vector for next round verification (round=3)
[S6] DEBUG after merge:  round=3 metric=0.1414 head_norm=0.712724 delta_norm=0.333667
[S6] aggregate: ACCEPT kept=['S10', 'S16'] (k=2/2) mode=median trim_p=0.1
[S2] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=3 metric=0.1486 head_norm=1.300589
[S2] _apply_head_vector_avg (torch): Δ‖w‖=7.149596e-01
[S2] stored merged vector for next round verification (round=3)
[S2] DEBUG after merge:  round=3 metric=0.1483 head_norm=0.779999 delta_norm=0.714960
[S2] aggregate: ACCEPT kept=['S7', 'S8'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=3 metric=0.3978 head_norm=0.853956
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.306064e-01
[S4] stored merged vector for next round verification (round=3)
[S4] DEBUG after merge:  round=3 metric=0.3754 head_norm=0.755546 delta_norm=0.730606
[S4] aggregate: ROLLBACK (f1_val pre=0.398 post=0.375 tol_abs=0.005 tol_rel=0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=3 metric=0.1421 head_norm=1.217094
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.365322e-01
[S7] stored merged vector for next round verification (round=3)
[S7] DEBUG after merge:  round=3 metric=0.1421 head_norm=0.891807 delta_norm=0.836532
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=3 metric=0.1400 head_norm=0.866625
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.651309e-01
[S8] stored merged vector for next round verification (round=3)
[S8] DEBUG after merge:  round=3 metric=0.1400 head_norm=0.577724 delta_norm=0.565131
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=0.779999 cos_to_last_merge=1.0000 (last merge round=3)
[S2] round=4 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.60908823628363, 'loss_val': 1.1958086245558657, 'psi': 0.32870157454659205}-{'f1_val': 0.14857825048838724, 'auprc': 0.7584606534876863, 'loss_val': 1.1975470791371612, 'psi': 0.3925312116881069}
[S3] START round=4 head_norm_before_train=1.216565 (no previous merge yet)
[S3] round=4 local utility u=0.023546 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9975218392565202, 'loss_val': 1.2148125294263759, 'psi': 0.48291277507107233}-{'f1_val': 0.13984006561410703, 'auprc': 0.9988963336497274, 'loss_val': 1.2660283413207347, 'psi': 0.48346257282835525}
[S4] START round=4 head_norm_before_train=0.755546 cos_to_last_merge=1.0000 (last merge round=3)
[S4] round=4 local utility u=0.000000 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.6842731848471542, 'loss_val': 1.3103583453652732, 'psi': 0.35784525127597216}-{'f1_val': 0.3977525309336333, 'auprc': 0.7659732058674387, 'loss_val': 1.3235108550151513, 'psi': 0.5450408009071555}
[S5] START round=4 head_norm_before_train=1.267326 (no previous merge yet)
[S5] round=4 local utility u=0.017854 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7623653754426918, 'loss_val': 1.1831806851523445, 'psi': 0.39030329303421957}-{'f1_val': 0.14226190476190476, 'auprc': 0.766797764328839, 'loss_val': 1.2321858812200421, 'psi': 0.39207624858867846}
[S6] START round=4 head_norm_before_train=0.712724 cos_to_last_merge=1.0000 (last merge round=3)
[S6] round=4 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8167173279665287, 'loss_val': 1.2731653147745823, 'psi': 0.4115427004173807}-{'f1_val': 0.14142628205128205, 'auprc': 0.8469757547233876, 'loss_val': 1.2856772332521011, 'psi': 0.42364607112012426}
[S7] START round=4 head_norm_before_train=0.891807 cos_to_last_merge=1.0000 (last merge round=3)
[S7] round=4 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.5759091863783408, 'loss_val': 1.3051067210834677, 'psi': 0.3155977681887913}-{'f1_val': 0.14205682272909165, 'auprc': 0.7776765770963872, 'loss_val': 1.2645303911329748, 'psi': 0.3963047244760099}
[S8] START round=4 head_norm_before_train=0.577724 cos_to_last_merge=1.0000 (last merge round=3)
[S8] round=4 local utility u=0.000000 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7476512049901134, 'loss_val': 1.3042972226455254, 'psi': 0.38303407143181967}-{'f1_val': 0.13995598239295717, 'auprc': 0.7432512895638832, 'loss_val': 1.2910232815298248, 'psi': 0.3812741052613276}
[S9] START round=4 head_norm_before_train=1.213812 (no previous merge yet)
[S9] round=4 local utility u=0.052246 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8655373860822664, 'loss_val': 1.0729116435715735, 'psi': 0.43105372871690417}-{'f1_val': 0.141397957139996, 'auprc': 0.8655494053008873, 'loss_val': 1.1774405044711687, 'psi': 0.43105853640435254}
[S10] START round=4 head_norm_before_train=0.854683 cos_to_last_merge=0.9903 (last merge round=1)
[S10] round=4 local utility u=0.009336 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6073914699168393, 'loss_val': 1.210427728008554, 'psi': 0.3261295704917701}-{'f1_val': 0.13862163754172394, 'auprc': 0.6199062204307068, 'loss_val': 1.266644427205031, 'psi': 0.3311354706973171}
[S11] START round=4 head_norm_before_train=0.622745 cos_to_last_merge=0.9926 (last merge round=2)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.608643734313222, 'loss_val': 1.2851194149140701, 'psi': 0.3277057037491552}-{'f1_val': 0.14041368337311058, 'auprc': 0.7017387020488403, 'loss_val': 1.3422967732890247, 'psi': 0.36494369084340245}
[S13] START round=4 head_norm_before_train=1.244947 (no previous merge yet)
[S13] round=4 local utility u=0.024441 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7382638723562337, 'loss_val': 1.186912225985783, 'psi': 0.37953700648872535}-{'f1_val': 0.1403857625770531, 'auprc': 0.7389499228047962, 'loss_val': 1.2378529034755557, 'psi': 0.3798114266681503}
[S14] START round=4 head_norm_before_train=1.228370 (no previous merge yet)
[S14] round=4 local utility u=0.020914 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8635924286517632, 'loss_val': 1.24145319242305, 'psi': 0.42965168319032754}-{'f1_val': 0.14035785288270378, 'auprc': 0.8620577161015729, 'loss_val': 1.2786764836557445, 'psi': 0.42903779817025145}
[S15] START round=4 head_norm_before_train=0.756826 cos_to_last_merge=0.9961 (last merge round=2)
[S15] round=4 local utility u=0.029178 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7713239357454332, 'loss_val': 1.2524645817338727, 'psi': 0.3923697651151083}-{'f1_val': 0.13973365136155833, 'auprc': 0.76743251484221, 'loss_val': 1.2991463527727107, 'psi': 0.39081319675381904}
[S16] START round=4 head_norm_before_train=0.759966 cos_to_last_merge=0.9960 (last merge round=2)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.6942514113391645, 'loss_val': 1.2371505709820814, 'psi': 0.36208303465518765}-{'f1_val': 0.14063745019920318, 'auprc': 0.976328889779045, 'loss_val': 1.2915976085316387, 'psi': 0.47491402603113997}
[S17] START round=4 head_norm_before_train=0.745142 cos_to_last_merge=0.9946 (last merge round=2)
[S17] round=4 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5634721771150298, 'loss_val': 1.2714647335278368, 'psi': 0.3099582488364426}-{'f1_val': 0.14094896331738438, 'auprc': 0.7197591026439462, 'loss_val': 1.3233919190674397, 'psi': 0.3724730190480091}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:33903
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:33911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:33908
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:33909
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:33904
[S14] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1798) from S13
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.277016)
[S6] loaded HEAD from S13 (vec_in norm=1.277016)
[S6] cosine check vs S13: cos=0.0890
[S6] BUFFERED delta from S13 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1802) from S10
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=0.886889)
[S6] loaded HEAD from S10 (vec_in norm=0.886889)
[S6] cosine check vs S10: cos=0.6757
[S6] BUFFERED delta from S10 (total buffered=2)
[S7] RECEIVED delta(kind=head bytes=1801) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.264394)
[S7] loaded HEAD from S14 (vec_in norm=1.264394)
[S7] cosine check vs S14: cos=0.7120
[S7] BUFFERED delta from S14 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1796) from S9
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.248447)
[S10] loaded HEAD from S9 (vec_in norm=1.248447)
[S10] cosine check vs S9: cos=-0.0689
[S10] DROPPED delta from S9 (cos=-0.0689 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1801) from S15
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.800340)
[S8] loaded HEAD from S15 (vec_in norm=0.800340)
[S8] cosine check vs S15: cos=0.6257
[S8] BUFFERED delta from S15 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1795) from S3
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.244759)
[S4] loaded HEAD from S3 (vec_in norm=1.244759)
[S4] cosine check vs S3: cos=0.8082
[S4] BUFFERED delta from S3 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1798) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.303091)
[S3] loaded HEAD from S5 (vec_in norm=1.303091)
[S3] cosine check vs S5: cos=-0.0157
[S3] DROPPED delta from S5 (cos=-0.0157 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=4 metric=0.1402 head_norm=0.773626
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.844891e-01
[S4] stored merged vector for next round verification (round=4)
[S4] DEBUG after merge:  round=4 metric=0.1935 head_norm=0.962356 delta_norm=0.384489
[S4] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=4 metric=0.1400 head_norm=0.601489
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.162062e-01
[S8] stored merged vector for next round verification (round=4)
[S8] DEBUG after merge:  round=4 metric=0.1400 head_norm=0.633388 delta_norm=0.316206
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=4 metric=0.1414 head_norm=0.737886
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.043655e-01
[S6] stored merged vector for next round verification (round=4)
[S6] DEBUG after merge:  round=4 metric=0.1414 head_norm=0.653121 delta_norm=0.404365
[S6] aggregate: ACCEPT kept=['S13', 'S10'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=4 metric=0.1421 head_norm=0.904412
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.439223e-01
[S7] stored merged vector for next round verification (round=4)
[S7] DEBUG after merge:  round=4 metric=0.3753 head_norm=1.005614 delta_norm=0.443922
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=0.813256 cos_to_last_merge=0.9962 (last merge round=3)
[S2] round=5 local utility u=0.117707 metrics={'f1_val': 0.1712140960062955, 'auprc': 0.6102430298804135, 'loss_val': 1.1404809711128685, 'psi': 0.3468256695559427}-{'f1_val': 0.1417771333885667, 'auprc': 0.60908823628363, 'loss_val': 1.1958086245558657, 'psi': 0.32870157454659205}
[S3] START round=5 head_norm_before_train=1.244759 (no previous merge yet)
[S3] round=5 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9517048787165938, 'loss_val': 1.1372702465455589, 'psi': 0.46458599085510177}-{'f1_val': 0.13984006561410703, 'auprc': 0.9975218392565202, 'loss_val': 1.2148125294263759, 'psi': 0.48291277507107233}
[S4] START round=5 head_norm_before_train=0.962356 cos_to_last_merge=1.0000 (last merge round=4)
[S4] round=5 local utility u=0.000000 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.5986681171130266, 'loss_val': 1.2693367959110655, 'psi': 0.3236032241823211}-{'f1_val': 0.14022662889518414, 'auprc': 0.6842731848471542, 'loss_val': 1.3103583453652732, 'psi': 0.35784525127597216}
[S5] START round=5 head_norm_before_train=1.303091 (no previous merge yet)
[S5] round=5 local utility u=0.046977 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7701257707813567, 'loss_val': 1.1125085044316978, 'psi': 0.39340745116968556}-{'f1_val': 0.14226190476190476, 'auprc': 0.7623653754426918, 'loss_val': 1.1831806851523445, 'psi': 0.39030329303421957}
[S6] START round=5 head_norm_before_train=0.653121 cos_to_last_merge=1.0000 (last merge round=4)
[S6] round=5 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.5995717829215447, 'loss_val': 1.2608347717369937, 'psi': 0.3246844823993871}-{'f1_val': 0.14142628205128205, 'auprc': 0.8167173279665287, 'loss_val': 1.2731653147745823, 'psi': 0.4115427004173807}
[S7] START round=5 head_norm_before_train=1.005614 cos_to_last_merge=1.0000 (last merge round=4)
[S7] round=5 local utility u=0.000000 metrics={'f1_val': 0.13355182302335109, 'auprc': 0.43920790823731065, 'loss_val': 1.329519734370894, 'psi': 0.2558142571089349}-{'f1_val': 0.14205682272909165, 'auprc': 0.5759091863783408, 'loss_val': 1.3051067210834677, 'psi': 0.3155977681887913}
[S8] START round=5 head_norm_before_train=0.633388 cos_to_last_merge=1.0000 (last merge round=4)
[S8] round=5 local utility u=0.017148 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7558614713275587, 'loss_val': 1.2946327608745234, 'psi': 0.3863181779667978}-{'f1_val': 0.13995598239295717, 'auprc': 0.7476512049901134, 'loss_val': 1.3042972226455254, 'psi': 0.38303407143181967}
[S9] START round=5 head_norm_before_train=1.248447 (no previous merge yet)
[S9] round=5 local utility u=0.273078 metrics={'f1_val': 0.2017349365144853, 'auprc': 0.865816825048648, 'loss_val': 0.8896156314169463, 'psi': 0.4673676919281504}-{'f1_val': 0.141397957139996, 'auprc': 0.8655373860822664, 'loss_val': 1.0729116435715735, 'psi': 0.43105372871690417}
[S10] START round=5 head_norm_before_train=0.886889 cos_to_last_merge=0.9795 (last merge round=1)
[S10] round=5 local utility u=0.036725 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6076610731350555, 'loss_val': 1.137785840697486, 'psi': 0.3262374117790565}-{'f1_val': 0.13862163754172394, 'auprc': 0.6073914699168393, 'loss_val': 1.210427728008554, 'psi': 0.3261295704917701}
[S11] START round=5 head_norm_before_train=0.653897 cos_to_last_merge=0.9736 (last merge round=2)
[S11] round=5 local utility u=0.003327 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.5949859625171017, 'loss_val': 1.2374921896859554, 'psi': 0.322242595030707}-{'f1_val': 0.14041368337311058, 'auprc': 0.608643734313222, 'loss_val': 1.2851194149140701, 'psi': 0.3277057037491552}
[S13] START round=5 head_norm_before_train=1.277016 (no previous merge yet)
[S13] round=5 local utility u=0.874389 metrics={'f1_val': 0.4158809972763461, 'auprc': 0.7454455414181311, 'loss_val': 1.1126498838628704, 'psi': 0.5477068149330602}-{'f1_val': 0.1403857625770531, 'auprc': 0.7382638723562337, 'loss_val': 1.186912225985783, 'psi': 0.37953700648872535}
[S14] START round=5 head_norm_before_train=1.264394 (no previous merge yet)
[S14] round=5 local utility u=0.026558 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8639256614524187, 'loss_val': 1.1893368002589937, 'psi': 0.42978497631058976}-{'f1_val': 0.14035785288270378, 'auprc': 0.8635924286517632, 'loss_val': 1.24145319242305, 'psi': 0.42965168319032754}
[S15] START round=5 head_norm_before_train=0.800340 cos_to_last_merge=0.9864 (last merge round=2)
[S15] round=5 local utility u=0.032015 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7765952440315855, 'loss_val': 1.2042484600821413, 'psi': 0.3944782884295692}-{'f1_val': 0.13973365136155833, 'auprc': 0.7713239357454332, 'loss_val': 1.2524645817338727, 'psi': 0.3923697651151083}
[S16] START round=5 head_norm_before_train=0.797344 cos_to_last_merge=0.9845 (last merge round=2)
[S16] round=5 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.55624857517419, 'loss_val': 1.1768573730413545, 'psi': 0.3068819001891979}-{'f1_val': 0.14063745019920318, 'auprc': 0.6942514113391645, 'loss_val': 1.2371505709820814, 'psi': 0.36208303465518765}
[S17] START round=5 head_norm_before_train=0.773642 cos_to_last_merge=0.9795 (last merge round=2)
[S17] round=5 local utility u=0.022127 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5509645298951, 'loss_val': 1.189687300948165, 'psi': 0.30495518994847065}-{'f1_val': 0.14094896331738438, 'auprc': 0.5634721771150298, 'loss_val': 1.2714647335278368, 'psi': 0.3099582488364426}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:33904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:33902
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] → sending delta(kind=head bytes=1793) to S3@127.0.0.1:33903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] → sending delta(kind=head bytes=1792) to S6@127.0.0.1:33907
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:33907
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:33911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:33908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:33903
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1793 to 1 peers)
[S10] sending update (kind=head size=1792 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1804) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.330142)
[S3] loaded HEAD from S5 (vec_in norm=1.330142)
[S3] cosine check vs S5: cos=-0.0151
[S3] DROPPED delta from S5 (cos=-0.0151 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1801) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.301930)
[S7] loaded HEAD from S14 (vec_in norm=1.301930)
[S7] cosine check vs S14: cos=0.9341
[S7] BUFFERED delta from S14 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1793) from S2
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=0.841015)
[S3] loaded HEAD from S2 (vec_in norm=0.841015)
[S3] cosine check vs S2: cos=0.0312
[S3] BUFFERED delta from S2 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1795) from S13
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.309682)
[S6] loaded HEAD from S13 (vec_in norm=1.309682)
[S6] cosine check vs S13: cos=0.5480
[S6] BUFFERED delta from S13 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1792) from S10
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=0.917393)
[S6] loaded HEAD from S10 (vec_in norm=0.917393)
[S6] cosine check vs S10: cos=0.7334
[S6] BUFFERED delta from S10 (total buffered=2)
[S10] RECEIVED delta(kind=head bytes=1795) from S9
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.288679)
[S10] loaded HEAD from S9 (vec_in norm=1.288679)
[S10] cosine check vs S9: cos=-0.0664
[S10] DROPPED delta from S9 (cos=-0.0664 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1798) from S8
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.652335)
[S2] loaded HEAD from S8 (vec_in norm=0.652335)
[S2] cosine check vs S8: cos=0.0876
[S2] BUFFERED delta from S8 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1798) from S15
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.845895)
[S8] loaded HEAD from S15 (vec_in norm=0.845895)
[S8] cosine check vs S15: cos=0.8961
[S8] BUFFERED delta from S15 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1801) from S11
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.691543)
[S4] loaded HEAD from S11 (vec_in norm=0.691543)
[S4] cosine check vs S11: cos=0.1619
[S4] BUFFERED delta from S11 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:33909
[S17] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.813085)
[S8] loaded HEAD from S17 (vec_in norm=0.813085)
[S8] cosine check vs S17: cos=0.8637
[S8] BUFFERED delta from S17 (total buffered=2)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=5 metric=0.1402 head_norm=0.978620
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.515446e-01
[S4] stored merged vector for next round verification (round=5)
[S4] DEBUG after merge:  round=5 metric=0.1402 head_norm=0.643244 delta_norm=0.551545
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.496 → S8@127.0.0.1:33909
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=5 metric=0.1336 head_norm=1.010296
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.541607e-01
[S7] stored merged vector for next round verification (round=5)
[S7] DEBUG after merge:  round=5 metric=0.1857 head_norm=1.137217 delta_norm=0.254161
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.345 → S2@127.0.0.1:33902
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=5 metric=0.1414 head_norm=0.676433
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.163730e-01
[S6] stored merged vector for next round verification (round=5)
[S6] DEBUG after merge:  round=5 metric=0.1414 head_norm=0.719100 delta_norm=0.216373
[S6] aggregate: ACCEPT kept=['S13', 'S10'] (k=2/2) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.355 → S5@127.0.0.1:33905
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=5 metric=0.1398 head_norm=1.275781
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.529922e-01
[S3] stored merged vector for next round verification (round=5)
[S3] DEBUG after merge:  round=5 metric=0.3964 head_norm=0.774896 delta_norm=0.752992
[S3] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.441 → S4@127.0.0.1:33904
[S16] ⇄ pheromone p=0.379 → S6@127.0.0.1:33907
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=5 metric=0.1712 head_norm=0.841015
[S2] _apply_head_vector_avg (torch): Δ‖w‖=5.091022e-01
[S2] stored merged vector for next round verification (round=5)
[S2] DEBUG after merge:  round=5 metric=0.1418 head_norm=0.554291 delta_norm=0.509102
[S2] aggregate: ROLLBACK (f1_val pre=0.171 post=0.142 tol_abs=0.005 tol_rel=0.0)
[S2] ⇄ pheromone p=0.351 → S3@127.0.0.1:33903
[S11] ⇄ pheromone p=0.410 → S4@127.0.0.1:33904
[S5] ⇄ pheromone p=0.344 → S3@127.0.0.1:33903
[S15] ⇄ pheromone p=0.341 → S8@127.0.0.1:33909
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=5 metric=0.1400 head_norm=0.652335
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.855238e-01
[S8] stored merged vector for next round verification (round=5)
[S8] DEBUG after merge:  round=5 metric=0.1400 head_norm=0.714634 delta_norm=0.185524
[S8] aggregate: ACCEPT kept=['S15', 'S17'] (k=2/2) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.415 → S2@127.0.0.1:33902
[S9] ⇄ pheromone p=0.477 → S10@127.0.0.1:33911
[S13] ⇄ pheromone p=0.575 → S6@127.0.0.1:33907
[S14] ⇄ pheromone p=0.424 → S7@127.0.0.1:33908
[S10] ⇄ pheromone p=0.374 → S6@127.0.0.1:33907
[S17] ⇄ pheromone p=0.361 → S8@127.0.0.1:33909
[S2] START round=6 head_norm_before_train=0.554291 cos_to_last_merge=1.0000 (last merge round=5)
[S2] round=6 local utility u=0.807825 metrics={'f1_val': 0.40701471502085607, 'auprc': 0.6791621853510009, 'loss_val': 1.1463914101196124, 'psi': 0.5158737031529139}-{'f1_val': 0.1712140960062955, 'auprc': 0.6102430298804135, 'loss_val': 1.1404809711128685, 'psi': 0.3468256695559427}
[S3] START round=6 head_norm_before_train=0.774896 cos_to_last_merge=1.0000 (last merge round=5)
[S3] round=6 local utility u=0.480789 metrics={'f1_val': 0.37679450323915004, 'auprc': 0.789742791930336, 'loss_val': 1.1115335163671785, 'psi': 0.5419738187156244}-{'f1_val': 0.13984006561410703, 'auprc': 0.9517048787165938, 'loss_val': 1.1372702465455589, 'psi': 0.46458599085510177}
[S4] START round=6 head_norm_before_train=0.643244 cos_to_last_merge=1.0000 (last merge round=5)
[S4] round=6 local utility u=0.039839 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.6076359014949929, 'loss_val': 1.2165625715326485, 'psi': 0.32719033793510766}-{'f1_val': 0.14022662889518414, 'auprc': 0.5986681171130266, 'loss_val': 1.2693367959110655, 'psi': 0.3236032241823211}
[S5] START round=6 head_norm_before_train=1.330142 (no previous merge yet)
[S5] round=6 local utility u=0.883136 metrics={'f1_val': 0.4187182848867173, 'auprc': 0.7777463985640777, 'loss_val': 1.027837075674353, 'psi': 0.5623295303576614}-{'f1_val': 0.14226190476190476, 'auprc': 0.7701257707813567, 'loss_val': 1.1125085044316978, 'psi': 0.39340745116968556}
[S6] START round=6 head_norm_before_train=0.719100 cos_to_last_merge=1.0000 (last merge round=5)
[S6] round=6 local utility u=0.029032 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6120584973207621, 'loss_val': 1.240231192691384, 'psi': 0.32967916815907405}-{'f1_val': 0.14142628205128205, 'auprc': 0.5995717829215447, 'loss_val': 1.2608347717369937, 'psi': 0.3246844823993871}
[S7] START round=6 head_norm_before_train=1.137217 cos_to_last_merge=1.0000 (last merge round=5)
[S7] round=6 local utility u=0.219261 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.5601751411649403, 'loss_val': 1.3049286167218979, 'psi': 0.3093041501034311}-{'f1_val': 0.13355182302335109, 'auprc': 0.43920790823731065, 'loss_val': 1.329519734370894, 'psi': 0.2558142571089349}
[S8] START round=6 head_norm_before_train=0.714634 cos_to_last_merge=1.0000 (last merge round=5)
[S8] round=6 local utility u=0.044705 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7707974752187033, 'loss_val': 1.2500305615369625, 'psi': 0.3922925795232557}-{'f1_val': 0.13995598239295717, 'auprc': 0.7558614713275587, 'loss_val': 1.2946327608745234, 'psi': 0.3863181779667978}
[S9] START round=6 head_norm_before_train=1.288679 (no previous merge yet)
[S9] round=6 local utility u=1.000000 metrics={'f1_val': 0.7005195233974337, 'auprc': 0.865741029574284, 'loss_val': 0.7231138819656122, 'psi': 0.7666081258681738}-{'f1_val': 0.2017349365144853, 'auprc': 0.865816825048648, 'loss_val': 0.8896156314169463, 'psi': 0.4673676919281504}
[S10] START round=6 head_norm_before_train=0.917393 cos_to_last_merge=0.9686 (last merge round=1)
[S10] round=6 local utility u=0.887761 metrics={'f1_val': 0.41597454042981274, 'auprc': 0.609446422970061, 'loss_val': 1.031738048065066, 'psi': 0.49336329344591207}-{'f1_val': 0.13862163754172394, 'auprc': 0.6076610731350555, 'loss_val': 1.137785840697486, 'psi': 0.3262374117790565}
[S11] START round=6 head_norm_before_train=0.691543 cos_to_last_merge=0.9494 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.949
[S11] round=6 local utility u=0.036522 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.5978800563134253, 'loss_val': 1.1731296070346042, 'psi': 0.3234002325492365}-{'f1_val': 0.14041368337311058, 'auprc': 0.5949859625171017, 'loss_val': 1.2374921896859554, 'psi': 0.322242595030707}
[S13] START round=6 head_norm_before_train=1.309682 (no previous merge yet)
[S13] round=6 local utility u=0.000000 metrics={'f1_val': 0.3840303119166689, 'auprc': 0.6265851543232555, 'loss_val': 1.0254011711414437, 'psi': 0.48105224887930353}-{'f1_val': 0.4158809972763461, 'auprc': 0.7454455414181311, 'loss_val': 1.1126498838628704, 'psi': 0.5477068149330602}
[S14] START round=6 head_norm_before_train=1.301930 (no previous merge yet)
[S14] round=6 local utility u=0.171800 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.9370935788718628, 'loss_val': 1.0652409999081742, 'psi': 0.4590521432783674}-{'f1_val': 0.14035785288270378, 'auprc': 0.8639256614524187, 'loss_val': 1.1893368002589937, 'psi': 0.42978497631058976}
[S15] START round=6 head_norm_before_train=0.845895 cos_to_last_merge=0.9740 (last merge round=2)
[S15] round=6 local utility u=0.836200 metrics={'f1_val': 0.40555911291754687, 'auprc': 0.7770540975704336, 'loss_val': 1.128177926752937, 'psi': 0.5541571067787017}-{'f1_val': 0.13973365136155833, 'auprc': 0.7765952440315855, 'loss_val': 1.2042484600821413, 'psi': 0.3944782884295692}
[S16] START round=6 head_norm_before_train=0.841593 cos_to_last_merge=0.9690 (last merge round=2)
[S16] round=6 local utility u=0.856254 metrics={'f1_val': 0.4175015313869336, 'auprc': 0.5413000711032063, 'loss_val': 1.0806888370453267, 'psi': 0.4670209472734427}-{'f1_val': 0.14063745019920318, 'auprc': 0.55624857517419, 'loss_val': 1.1768573730413545, 'psi': 0.3068819001891979}
[S17] START round=6 head_norm_before_train=0.813085 cos_to_last_merge=0.9570 (last merge round=2)
[S17] round=6 local utility u=0.535175 metrics={'f1_val': 0.29684243797305093, 'auprc': 0.5492636226013874, 'loss_val': 1.0495945201289834, 'psi': 0.39781091182438555}-{'f1_val': 0.14094896331738438, 'auprc': 0.5509645298951, 'loss_val': 1.189687300948165, 'psi': 0.30495518994847065}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:33903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:33908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:33903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] → sending delta(kind=head bytes=1793) to S2@127.0.0.1:33902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:33904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S10] → sending delta(kind=head bytes=1789) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:33904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:33902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:33905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:33911
[S4] sending update (kind=head size=1794 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1789 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1793 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1794) from S4
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.680220)
[S8] loaded HEAD from S4 (vec_in norm=0.680220)
[S8] cosine check vs S4: cos=0.2058
[S8] BUFFERED delta from S4 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1798) from S9
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.337350)
[S10] loaded HEAD from S9 (vec_in norm=1.337350)
[S10] cosine check vs S9: cos=-0.0613
[S10] DROPPED delta from S9 (cos=-0.0613 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1802) from S11
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.720387)
[S4] loaded HEAD from S11 (vec_in norm=0.720387)
[S4] cosine check vs S11: cos=0.6495
[S4] BUFFERED delta from S11 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1797) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.882292)
[S6] loaded HEAD from S16 (vec_in norm=0.882292)
[S6] cosine check vs S16: cos=0.3076
[S6] BUFFERED delta from S16 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1795) from S3
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=0.814750)
[S4] loaded HEAD from S3 (vec_in norm=0.814750)
[S4] cosine check vs S3: cos=0.6817
[S4] BUFFERED delta from S3 (total buffered=2)
[S3] RECEIVED delta(kind=head bytes=1800) from S2
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=0.584021)
[S3] loaded HEAD from S2 (vec_in norm=0.584021)
[S3] cosine check vs S2: cos=0.6125
[S3] BUFFERED delta from S2 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1803) from S6
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.740795)
[S5] loaded HEAD from S6 (vec_in norm=0.740795)
[S5] cosine check vs S6: cos=-0.0711
[S5] DROPPED delta from S6 (cos=-0.0711 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1793) from S7
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.140846)
[S2] loaded HEAD from S7 (vec_in norm=1.140846)
[S2] cosine check vs S7: cos=0.1295
[S2] BUFFERED delta from S7 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1789) from S10
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=0.948323)
[S6] loaded HEAD from S10 (vec_in norm=0.948323)
[S6] cosine check vs S10: cos=0.6818
[S6] BUFFERED delta from S10 (total buffered=2)
[S8] RECEIVED delta(kind=head bytes=1800) from S15
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.880933)
[S8] loaded HEAD from S15 (vec_in norm=0.880933)
[S8] cosine check vs S15: cos=0.9434
[S8] BUFFERED delta from S15 (total buffered=2)
[S7] RECEIVED delta(kind=head bytes=1799) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.343115)
[S7] loaded HEAD from S14 (vec_in norm=1.343115)
[S7] cosine check vs S14: cos=0.9772
[S7] BUFFERED delta from S14 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1799) from S8
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.733262)
[S2] loaded HEAD from S8 (vec_in norm=0.733262)
[S2] cosine check vs S8: cos=0.5584
[S2] BUFFERED delta from S8 (total buffered=2)
[S3] RECEIVED delta(kind=head bytes=1799) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.352944)
[S3] loaded HEAD from S5 (vec_in norm=1.352944)
[S3] cosine check vs S5: cos=-0.0518
[S3] DROPPED delta from S5 (cos=-0.0518 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:33909
[S17] sending update (kind=head size=1796 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1796) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.860911)
[S8] loaded HEAD from S17 (vec_in norm=0.860911)
[S8] cosine check vs S17: cos=0.9169
[S8] BUFFERED delta from S17 (total buffered=3)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=6 metric=0.1421 head_norm=1.140846
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.663764e-01
[S7] stored merged vector for next round verification (round=6)
[S7] DEBUG after merge:  round=6 metric=0.1421 head_norm=1.234934 delta_norm=0.166376
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=6 metric=0.1400 head_norm=0.733262
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.210813e-01
[S8] stored merged vector for next round verification (round=6)
[S8] DEBUG after merge:  round=6 metric=0.1400 head_norm=0.741080 delta_norm=0.121081
[S8] aggregate: ACCEPT kept=['S4', 'S15', 'S17'] (k=3/3) mode=median trim_p=0.1
[S2] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=6 metric=0.4070 head_norm=0.584021
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.446307e-01
[S2] stored merged vector for next round verification (round=6)
[S2] DEBUG after merge:  round=6 metric=0.3819 head_norm=0.530533 delta_norm=0.344631
[S2] aggregate: ROLLBACK (f1_val pre=0.407 post=0.382 tol_abs=0.005 tol_rel=0.0)
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=6 metric=0.1414 head_norm=0.740795
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.030905e-01
[S6] stored merged vector for next round verification (round=6)
[S6] DEBUG after merge:  round=6 metric=0.1414 head_norm=0.657169 delta_norm=0.303090
[S6] aggregate: ACCEPT kept=['S16', 'S10'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=6 metric=0.1402 head_norm=0.680220
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.523821e-01
[S4] stored merged vector for next round verification (round=6)
[S4] DEBUG after merge:  round=6 metric=0.1402 head_norm=0.609317 delta_norm=0.152382
[S4] aggregate: ACCEPT kept=['S11', 'S3'] (k=2/2) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=6 metric=0.3768 head_norm=0.814750
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.248269e-01
[S3] stored merged vector for next round verification (round=6)
[S3] DEBUG after merge:  round=6 metric=0.4198 head_norm=0.630029 delta_norm=0.324827
[S3] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=0.530533 cos_to_last_merge=1.0000 (last merge round=6)
[S2] round=7 local utility u=0.133997 metrics={'f1_val': 0.41630530508844577, 'auprc': 0.7396312141866921, 'loss_val': 1.1155489221366313, 'psi': 0.5456356687277444}-{'f1_val': 0.40701471502085607, 'auprc': 0.6791621853510009, 'loss_val': 1.1463914101196124, 'psi': 0.5158737031529139}
[S3] START round=7 head_norm_before_train=0.630029 cos_to_last_merge=1.0000 (last merge round=6)
[S3] round=7 local utility u=0.174933 metrics={'f1_val': 0.4227428674058971, 'auprc': 0.7957594022687526, 'loss_val': 1.0554080566774418, 'psi': 0.5719494813510393}-{'f1_val': 0.37679450323915004, 'auprc': 0.789742791930336, 'loss_val': 1.1115335163671785, 'psi': 0.5419738187156244}
[S4] START round=7 head_norm_before_train=0.609317 cos_to_last_merge=1.0000 (last merge round=6)
[S4] round=7 local utility u=0.022316 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.6039801443002996, 'loss_val': 1.1609624809153598, 'psi': 0.3257280350572303}-{'f1_val': 0.14022662889518414, 'auprc': 0.6076359014949929, 'loss_val': 1.2165625715326485, 'psi': 0.32719033793510766}
[S5] START round=7 head_norm_before_train=1.352944 (no previous merge yet)
[S5] round=7 local utility u=0.961840 metrics={'f1_val': 0.7155432860953705, 'auprc': 0.7777381547686013, 'loss_val': 0.8850828806568006, 'psi': 0.7404212335646628}-{'f1_val': 0.4187182848867173, 'auprc': 0.7777463985640777, 'loss_val': 1.027837075674353, 'psi': 0.5623295303576614}
[S6] START round=7 head_norm_before_train=0.657169 cos_to_last_merge=1.0000 (last merge round=6)
[S6] round=7 local utility u=0.024967 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6130844881067284, 'loss_val': 1.1933760087836256, 'psi': 0.3300895644734606}-{'f1_val': 0.14142628205128205, 'auprc': 0.6120584973207621, 'loss_val': 1.240231192691384, 'psi': 0.32967916815907405}
[S7] START round=7 head_norm_before_train=1.234934 cos_to_last_merge=1.0000 (last merge round=6)
[S7] round=7 local utility u=0.088968 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.6046329302673732, 'loss_val': 1.2603662529577864, 'psi': 0.3270872657444043}-{'f1_val': 0.14205682272909165, 'auprc': 0.5601751411649403, 'loss_val': 1.3049286167218979, 'psi': 0.3093041501034311}
[S8] START round=7 head_norm_before_train=0.741080 cos_to_last_merge=1.0000 (last merge round=6)
[S8] round=7 local utility u=0.026354 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7670159523239269, 'loss_val': 1.1859770513662868, 'psi': 0.3907799703653451}-{'f1_val': 0.13995598239295717, 'auprc': 0.7707974752187033, 'loss_val': 1.2500305615369625, 'psi': 0.3922925795232557}
[S9] START round=7 head_norm_before_train=1.337350 (no previous merge yet)
[S9] round=7 local utility u=0.275589 metrics={'f1_val': 0.7010169755020486, 'auprc': 0.9995840156576625, 'loss_val': 0.5764496222398079, 'psi': 0.8204437915642941}-{'f1_val': 0.7005195233974337, 'auprc': 0.865741029574284, 'loss_val': 0.7231138819656122, 'psi': 0.7666081258681738}
[S10] START round=7 head_norm_before_train=0.948323 cos_to_last_merge=0.9567 (last merge round=1)
[S10] round=7 local utility u=0.165245 metrics={'f1_val': 0.43171278642313826, 'auprc': 0.6379012056744796, 'loss_val': 0.8810417227705559, 'psi': 0.5141881541236748}-{'f1_val': 0.41597454042981274, 'auprc': 0.609446422970061, 'loss_val': 1.031738048065066, 'psi': 0.49336329344591207}
[S11] START round=7 head_norm_before_train=0.720387 cos_to_last_merge=0.9329 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.933
[S11] round=7 local utility u=0.056581 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6089154926187789, 'loss_val': 1.0930735379593097, 'psi': 0.3278144070713779}-{'f1_val': 0.14041368337311058, 'auprc': 0.5978800563134253, 'loss_val': 1.1731296070346042, 'psi': 0.3234002325492365}
[S13] START round=7 head_norm_before_train=1.336005 (no previous merge yet)
[S13] round=7 local utility u=0.317880 metrics={'f1_val': 0.38505356415210906, 'auprc': 0.7844112300935269, 'loss_val': 0.8692592464292883, 'psi': 0.5447966305286762}-{'f1_val': 0.3840303119166689, 'auprc': 0.6265851543232555, 'loss_val': 1.0254011711414437, 'psi': 0.48105224887930353}
[S14] START round=7 head_norm_before_train=1.343115 (no previous merge yet)
[S14] round=7 local utility u=1.000000 metrics={'f1_val': 0.6972305622922635, 'auprc': 0.9933011518056877, 'loss_val': 0.9052783885391387, 'psi': 0.8156587980976333}-{'f1_val': 0.14035785288270378, 'auprc': 0.9370935788718628, 'loss_val': 1.0652409999081742, 'psi': 0.4590521432783674}
[S15] START round=7 head_norm_before_train=0.880933 cos_to_last_merge=0.9643 (last merge round=2)
[S15] round=7 local utility u=0.115962 metrics={'f1_val': 0.41699057080661284, 'auprc': 0.7863356173381066, 'loss_val': 0.9926877693913825, 'psi': 0.5647285894192104}-{'f1_val': 0.40555911291754687, 'auprc': 0.7770540975704336, 'loss_val': 1.128177926752937, 'psi': 0.5541571067787017}
[S16] START round=7 head_norm_before_train=0.882292 cos_to_last_merge=0.9554 (last merge round=2)
[S16] round=7 local utility u=0.057542 metrics={'f1_val': 0.4171583814486223, 'auprc': 0.542680475283377, 'loss_val': 0.9676865177261273, 'psi': 0.4673672189825242}-{'f1_val': 0.4175015313869336, 'auprc': 0.5413000711032063, 'loss_val': 1.0806888370453267, 'psi': 0.4670209472734427}
[S17] START round=7 head_norm_before_train=0.860911 cos_to_last_merge=0.9301 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.930
[S17] round=7 local utility u=0.696280 metrics={'f1_val': 0.48422765671163986, 'auprc': 0.6243251223391959, 'loss_val': 1.0065294858805094, 'psi': 0.5402666429626622}-{'f1_val': 0.29684243797305093, 'auprc': 0.5492636226013874, 'loss_val': 1.0495945201289834, 'psi': 0.39781091182438555}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:33902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S16] → sending delta(kind=head bytes=1791) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S2] → sending delta(kind=head bytes=1807) to S3@127.0.0.1:33903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:33905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:33911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:33908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:33904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:33904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:33902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:33903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:33909
[S15] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1804 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1791 to 1 peers)
[S2] sending update (kind=head size=1807 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S4
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.655376)
[S8] loaded HEAD from S4 (vec_in norm=0.655376)
[S8] cosine check vs S4: cos=0.2463
[S8] BUFFERED delta from S4 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1799) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.388807)
[S7] loaded HEAD from S14 (vec_in norm=1.388807)
[S7] cosine check vs S14: cos=0.9870
[S7] BUFFERED delta from S14 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1791) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.932042)
[S6] loaded HEAD from S16 (vec_in norm=0.932042)
[S6] cosine check vs S16: cos=0.5592
[S6] BUFFERED delta from S16 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1802) from S8
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.762769)
[S2] loaded HEAD from S8 (vec_in norm=0.762769)
[S2] cosine check vs S8: cos=0.5848
[S2] BUFFERED delta from S8 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1800) from S13
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.369967)
[S6] loaded HEAD from S13 (vec_in norm=1.369967)
[S6] cosine check vs S13: cos=0.4272
[S6] BUFFERED delta from S13 (total buffered=2)
[S2] RECEIVED delta(kind=head bytes=1799) from S7
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.241891)
[S2] loaded HEAD from S7 (vec_in norm=1.241891)
[S2] cosine check vs S7: cos=0.5733
[S2] BUFFERED delta from S7 (total buffered=2)
[S6] RECEIVED delta(kind=head bytes=1798) from S10
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=0.988956)
[S6] loaded HEAD from S10 (vec_in norm=0.988956)
[S6] cosine check vs S10: cos=0.7967
[S6] BUFFERED delta from S10 (total buffered=3)
[S4] RECEIVED delta(kind=head bytes=1795) from S3
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=0.671658)
[S4] loaded HEAD from S3 (vec_in norm=0.671658)
[S4] cosine check vs S3: cos=0.6474
[S4] BUFFERED delta from S3 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1796) from S9
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.393239)
[S10] loaded HEAD from S9 (vec_in norm=1.393239)
[S10] cosine check vs S9: cos=-0.0558
[S10] DROPPED delta from S9 (cos=-0.0558 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1807) from S2
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=0.560068)
[S3] loaded HEAD from S2 (vec_in norm=0.560068)
[S3] cosine check vs S2: cos=0.7154
[S3] BUFFERED delta from S2 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1798) from S6
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.682299)
[S5] loaded HEAD from S6 (vec_in norm=0.682299)
[S5] cosine check vs S6: cos=-0.0195
[S5] DROPPED delta from S6 (cos=-0.0195 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1799) from S15
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.915166)
[S8] loaded HEAD from S15 (vec_in norm=0.915166)
[S8] cosine check vs S15: cos=0.9403
[S8] BUFFERED delta from S15 (total buffered=2)
[S4] RECEIVED delta(kind=head bytes=1797) from S11
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.757478)
[S4] loaded HEAD from S11 (vec_in norm=0.757478)
[S4] cosine check vs S11: cos=0.6764
[S4] BUFFERED delta from S11 (total buffered=2)
[S3] RECEIVED delta(kind=head bytes=1804) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.375441)
[S3] loaded HEAD from S5 (vec_in norm=1.375441)
[S3] cosine check vs S5: cos=-0.0433
[S3] DROPPED delta from S5 (cos=-0.0433 < 0.0)
[S17] sending update (kind=head size=1803 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1803) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.913808)
[S8] loaded HEAD from S17 (vec_in norm=0.913808)
[S8] cosine check vs S17: cos=0.9233
[S8] BUFFERED delta from S17 (total buffered=3)
[S2] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=7 metric=0.4163 head_norm=0.560068
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.186083e-01
[S2] stored merged vector for next round verification (round=7)
[S2] DEBUG after merge:  round=7 metric=0.4163 head_norm=0.609990 delta_norm=0.218608
[S2] aggregate: ACCEPT kept=['S8', 'S7'] (k=2/2) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=7 metric=0.4227 head_norm=0.671658
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.379931e-01
[S3] stored merged vector for next round verification (round=7)
[S3] DEBUG after merge:  round=7 metric=0.4225 head_norm=0.570753 delta_norm=0.237993
[S3] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=7 metric=0.1402 head_norm=0.655376
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.537748e-01
[S4] stored merged vector for next round verification (round=7)
[S4] DEBUG after merge:  round=7 metric=0.1402 head_norm=0.577939 delta_norm=0.153775
[S4] aggregate: ACCEPT kept=['S3', 'S11'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=7 metric=0.1414 head_norm=0.682299
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.075175e-01
[S6] stored merged vector for next round verification (round=7)
[S6] DEBUG after merge:  round=7 metric=0.1414 head_norm=0.666049 delta_norm=0.107517
[S6] aggregate: ACCEPT kept=['S16', 'S13', 'S10'] (k=3/3) mode=median trim_p=0.1
[S8] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=7 metric=0.1400 head_norm=0.762769
[S8] _apply_head_vector_avg (torch): Δ‖w‖=9.863091e-02
[S8] stored merged vector for next round verification (round=7)
[S8] DEBUG after merge:  round=7 metric=0.1400 head_norm=0.764302 delta_norm=0.098631
[S8] aggregate: ACCEPT kept=['S4', 'S15', 'S17'] (k=3/3) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=7 metric=0.1421 head_norm=1.241891
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.287416e-01
[S7] stored merged vector for next round verification (round=7)
[S7] DEBUG after merge:  round=7 metric=0.1421 head_norm=1.311093 delta_norm=0.128742
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=0.609990 cos_to_last_merge=1.0000 (last merge round=7)
[S2] round=8 local utility u=0.071576 metrics={'f1_val': 0.4169384018324798, 'auprc': 0.7706730327052107, 'loss_val': 1.0693216826711966, 'psi': 0.5584322541815723}-{'f1_val': 0.41630530508844577, 'auprc': 0.7396312141866921, 'loss_val': 1.1155489221366313, 'psi': 0.5456356687277444}
[S3] START round=8 head_norm_before_train=0.570753 cos_to_last_merge=1.0000 (last merge round=7)
[S3] round=8 local utility u=0.598874 metrics={'f1_val': 0.6054225126546016, 'auprc': 0.8031815362127435, 'loss_val': 0.9760034792763034, 'psi': 0.6845261220778583}-{'f1_val': 0.4227428674058971, 'auprc': 0.7957594022687526, 'loss_val': 1.0554080566774418, 'psi': 0.5719494813510393}
[S4] START round=8 head_norm_before_train=0.577939 cos_to_last_merge=1.0000 (last merge round=7)
[S4] round=8 local utility u=1.000000 metrics={'f1_val': 0.398937747442893, 'auprc': 0.7758229320463157, 'loss_val': 1.0978194402331227, 'psi': 0.5496918212842621}-{'f1_val': 0.14022662889518414, 'auprc': 0.6039801443002996, 'loss_val': 1.1609624809153598, 'psi': 0.3257280350572303}
[S5] START round=8 head_norm_before_train=1.375441 (no previous merge yet)
[S5] round=8 local utility u=0.000000 metrics={'f1_val': 0.6218858484578496, 'auprc': 0.7777339282771867, 'loss_val': 0.7573185768647808, 'psi': 0.6842250803855844}-{'f1_val': 0.7155432860953705, 'auprc': 0.7777381547686013, 'loss_val': 0.8850828806568006, 'psi': 0.7404212335646628}
[S6] START round=8 head_norm_before_train=0.666049 cos_to_last_merge=1.0000 (last merge round=7)
[S6] round=8 local utility u=0.491741 metrics={'f1_val': 0.2932217412296455, 'auprc': 0.6135782296805283, 'loss_val': 1.122148174575669, 'psi': 0.4213643366099986}-{'f1_val': 0.14142628205128205, 'auprc': 0.6130844881067284, 'loss_val': 1.1933760087836256, 'psi': 0.3300895644734606}
[S7] START round=8 head_norm_before_train=1.311093 cos_to_last_merge=1.0000 (last merge round=7)
[S7] round=8 local utility u=0.287588 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7802298453922355, 'loss_val': 1.2119819638288827, 'psi': 0.3973260317943492}-{'f1_val': 0.14205682272909165, 'auprc': 0.6046329302673732, 'loss_val': 1.2603662529577864, 'psi': 0.3270872657444043}
[S8] START round=8 head_norm_before_train=0.764302 cos_to_last_merge=1.0000 (last merge round=7)
[S8] round=8 local utility u=0.063696 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7768209703609521, 'loss_val': 1.087999330753224, 'psi': 0.3947019775801552}-{'f1_val': 0.13995598239295717, 'auprc': 0.7670159523239269, 'loss_val': 1.1859770513662868, 'psi': 0.3907799703653451}
[S9] START round=8 head_norm_before_train=1.393239 (no previous merge yet)
[S9] round=8 local utility u=0.079859 metrics={'f1_val': 0.7014391336149548, 'auprc': 0.999222122295655, 'loss_val': 0.41817941928323743, 'psi': 0.8205523290872349}-{'f1_val': 0.7010169755020486, 'auprc': 0.9995840156576625, 'loss_val': 0.5764496222398079, 'psi': 0.8204437915642941}
[S10] START round=8 head_norm_before_train=0.988956 cos_to_last_merge=0.9410 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.941
[S10] round=8 local utility u=0.176237 metrics={'f1_val': 0.38867670237126606, 'auprc': 0.809666817858831, 'loss_val': 0.7856489947150059, 'psi': 0.5570727485662921}-{'f1_val': 0.43171278642313826, 'auprc': 0.6379012056744796, 'loss_val': 0.8810417227705559, 'psi': 0.5141881541236748}
[S11] START round=8 head_norm_before_train=0.757478 cos_to_last_merge=0.9124 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.912
[S11] round=8 local utility u=1.000000 metrics={'f1_val': 0.3991311585672247, 'auprc': 0.767516083316715, 'loss_val': 0.9905792321682525, 'psi': 0.5464851284670208}-{'f1_val': 0.14041368337311058, 'auprc': 0.6089154926187789, 'loss_val': 1.0930735379593097, 'psi': 0.3278144070713779}
[S13] START round=8 head_norm_before_train=1.369967 (no previous merge yet)
[S13] round=8 local utility u=0.000000 metrics={'f1_val': 0.37148979094291945, 'auprc': 0.6616262357068601, 'loss_val': 0.8575492729277349, 'psi': 0.4875443688484957}-{'f1_val': 0.38505356415210906, 'auprc': 0.7844112300935269, 'loss_val': 0.8692592464292883, 'psi': 0.5447966305286762}
[S14] START round=8 head_norm_before_train=1.388807 (no previous merge yet)
[S14] round=8 local utility u=0.788203 metrics={'f1_val': 0.9256183163268011, 'auprc': 0.9958166331227861, 'loss_val': 0.706744531956527, 'psi': 0.9536976430451951}-{'f1_val': 0.6972305622922635, 'auprc': 0.9933011518056877, 'loss_val': 0.9052783885391387, 'psi': 0.8156587980976333}
[S15] START round=8 head_norm_before_train=0.915166 cos_to_last_merge=0.9541 (last merge round=2)
[S15] round=8 local utility u=0.068391 metrics={'f1_val': 0.4018346765097037, 'auprc': 0.7997688782280271, 'loss_val': 0.8052701803844927, 'psi': 0.561008357197033}-{'f1_val': 0.41699057080661284, 'auprc': 0.7863356173381066, 'loss_val': 0.9926877693913825, 'psi': 0.5647285894192104}
[S16] START round=8 head_norm_before_train=0.932042 cos_to_last_merge=0.9385 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.939
[S16] round=8 local utility u=0.204932 metrics={'f1_val': 0.3839335238973264, 'auprc': 0.7387858980662497, 'loss_val': 0.9467886945374829, 'psi': 0.5258744735648957}-{'f1_val': 0.4171583814486223, 'auprc': 0.542680475283377, 'loss_val': 0.9676865177261273, 'psi': 0.4673672189825242}
[S17] START round=8 head_norm_before_train=0.913808 cos_to_last_merge=0.9013 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.901
[S17] round=8 local utility u=0.000000 metrics={'f1_val': 0.378278943630856, 'auprc': 0.7562563221146488, 'loss_val': 0.8652238113752142, 'psi': 0.5294698950243731}-{'f1_val': 0.48422765671163986, 'auprc': 0.6243251223391959, 'loss_val': 1.0065294858805094, 'psi': 0.5402666429626622}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:33908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:33902
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:33904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:33903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:33911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S2@127.0.0.1:33902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:33905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:33904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:33907
[S15] sending update (kind=head size=1794 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1804 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1805 to 1 peers)
[S16] sending update (kind=head size=1793 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1804 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1800) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.434658)
[S7] loaded HEAD from S14 (vec_in norm=1.434658)
[S7] cosine check vs S14: cos=0.9904
[S7] BUFFERED delta from S14 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1798) from S7
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.321318)
[S2] loaded HEAD from S7 (vec_in norm=1.321318)
[S2] cosine check vs S7: cos=0.7417
[S2] BUFFERED delta from S7 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1804) from S6
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.697786)
[S5] loaded HEAD from S6 (vec_in norm=0.697786)
[S5] cosine check vs S6: cos=-0.0227
[S5] DROPPED delta from S6 (cos=-0.0227 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1804) from S3
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=0.618869)
[S4] loaded HEAD from S3 (vec_in norm=0.618869)
[S4] cosine check vs S3: cos=0.6204
[S4] BUFFERED delta from S3 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1804) from S2
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=0.638739)
[S3] loaded HEAD from S2 (vec_in norm=0.638739)
[S3] cosine check vs S2: cos=0.7679
[S3] BUFFERED delta from S2 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1804) from S4
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.624996)
[S8] loaded HEAD from S4 (vec_in norm=0.624996)
[S8] cosine check vs S4: cos=0.2917
[S8] BUFFERED delta from S4 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1805) from S8
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.793952)
[S2] loaded HEAD from S8 (vec_in norm=0.793952)
[S2] cosine check vs S8: cos=0.5320
[S2] BUFFERED delta from S8 (total buffered=2)
[S4] RECEIVED delta(kind=head bytes=1796) from S11
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.799367)
[S4] loaded HEAD from S11 (vec_in norm=0.799367)
[S4] cosine check vs S11: cos=0.7234
[S4] BUFFERED delta from S11 (total buffered=2)
[S10] RECEIVED delta(kind=head bytes=1798) from S9
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.447537)
[S10] loaded HEAD from S9 (vec_in norm=1.447537)
[S10] cosine check vs S9: cos=-0.0518
[S10] DROPPED delta from S9 (cos=-0.0518 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1794) from S15
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.958533)
[S8] loaded HEAD from S15 (vec_in norm=0.958533)
[S8] cosine check vs S15: cos=0.9245
[S8] BUFFERED delta from S15 (total buffered=2)
[S6] RECEIVED delta(kind=head bytes=1793) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.982776)
[S6] loaded HEAD from S16 (vec_in norm=0.982776)
[S6] cosine check vs S16: cos=0.6108
[S6] BUFFERED delta from S16 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1798) from S10
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.040130)
[S6] loaded HEAD from S10 (vec_in norm=1.040130)
[S6] cosine check vs S10: cos=0.7297
[S6] BUFFERED delta from S10 (total buffered=2)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=8 metric=0.6054 head_norm=0.618869
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.144017e-01
[S3] stored merged vector for next round verification (round=8)
[S3] DEBUG after merge:  round=8 metric=0.6926 head_norm=0.591207 delta_norm=0.214402
[S3] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=8 metric=0.1400 head_norm=0.793952
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.005873e-01
[S8] stored merged vector for next round verification (round=8)
[S8] DEBUG after merge:  round=8 metric=0.3652 head_norm=0.681457 delta_norm=0.200587
[S8] aggregate: ACCEPT kept=['S4', 'S15'] (k=2/2) mode=median trim_p=0.1
[S2] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=8 metric=0.4169 head_norm=0.638739
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.557196e-01
[S2] stored merged vector for next round verification (round=8)
[S2] DEBUG after merge:  round=8 metric=0.4169 head_norm=0.687098 delta_norm=0.155720
[S2] aggregate: ACCEPT kept=['S7', 'S8'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=8 metric=0.2932 head_norm=0.697786
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.853016e-01
[S6] stored merged vector for next round verification (round=8)
[S6] DEBUG after merge:  round=8 metric=0.3770 head_norm=0.713126 delta_norm=0.185302
[S6] aggregate: ACCEPT kept=['S16', 'S10'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=8 metric=0.1421 head_norm=1.321318
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.107822e-01
[S7] stored merged vector for next round verification (round=8)
[S7] DEBUG after merge:  round=8 metric=0.1421 head_norm=1.374696 delta_norm=0.110782
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=8 metric=0.3989 head_norm=0.624996
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.331981e-01
[S4] stored merged vector for next round verification (round=8)
[S4] DEBUG after merge:  round=8 metric=0.4500 head_norm=0.564308 delta_norm=0.133198
[S4] aggregate: ACCEPT kept=['S3', 'S11'] (k=2/2) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=0.687098 cos_to_last_merge=1.0000 (last merge round=8)
[S2] round=9 local utility u=0.383599 metrics={'f1_val': 0.5319446055621366, 'auprc': 0.7761226814486233, 'loss_val': 1.00851044399637, 'psi': 0.6296158359167312}-{'f1_val': 0.4169384018324798, 'auprc': 0.7706730327052107, 'loss_val': 1.0693216826711966, 'psi': 0.5584322541815723}
[S3] START round=9 head_norm_before_train=0.591207 cos_to_last_merge=1.0000 (last merge round=8)
[S3] round=9 local utility u=0.000000 metrics={'f1_val': 0.4009668676591264, 'auprc': 0.8591269317525223, 'loss_val': 0.9119984443413036, 'psi': 0.5842308932964848}-{'f1_val': 0.6054225126546016, 'auprc': 0.8031815362127435, 'loss_val': 0.9760034792763034, 'psi': 0.6845261220778583}
[S4] START round=9 head_norm_before_train=0.564308 cos_to_last_merge=1.0000 (last merge round=8)
[S4] round=9 local utility u=0.840322 metrics={'f1_val': 0.6655474941606676, 'auprc': 0.77666896540281, 'loss_val': 1.0193725795601185, 'psi': 0.7099960826575247}-{'f1_val': 0.398937747442893, 'auprc': 0.7758229320463157, 'loss_val': 1.0978194402331227, 'psi': 0.5496918212842621}
[S5] START round=9 head_norm_before_train=1.405778 (no previous merge yet)
[S5] round=9 local utility u=0.272534 metrics={'f1_val': 0.7009191775993218, 'auprc': 0.7947650591245653, 'loss_val': 0.7375447051621675, 'psi': 0.7384575302094192}-{'f1_val': 0.6218858484578496, 'auprc': 0.7777339282771867, 'loss_val': 0.7573185768647808, 'psi': 0.6842250803855844}
[S6] START round=9 head_norm_before_train=0.713126 cos_to_last_merge=1.0000 (last merge round=8)
[S6] round=9 local utility u=0.450144 metrics={'f1_val': 0.41705570454086727, 'auprc': 0.6291605945818692, 'loss_val': 1.011611658449427, 'psi': 0.501897660557268}-{'f1_val': 0.2932217412296455, 'auprc': 0.6135782296805283, 'loss_val': 1.122148174575669, 'psi': 0.4213643366099986}
[S7] START round=9 head_norm_before_train=1.374696 cos_to_last_merge=1.0000 (last merge round=8)
[S7] round=9 local utility u=0.021151 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7675472422699651, 'loss_val': 1.131632102755476, 'psi': 0.39225299054544105}-{'f1_val': 0.14205682272909165, 'auprc': 0.7802298453922355, 'loss_val': 1.2119819638288827, 'psi': 0.3973260317943492}
[S8] START round=9 head_norm_before_train=0.681457 cos_to_last_merge=1.0000 (last merge round=8)
[S8] round=9 local utility u=1.000000 metrics={'f1_val': 0.7147462840508991, 'auprc': 0.7771057262910762, 'loss_val': 1.0451278310138565, 'psi': 0.73969006094697}-{'f1_val': 0.13995598239295717, 'auprc': 0.7768209703609521, 'loss_val': 1.087999330753224, 'psi': 0.3947019775801552}
[S9] START round=9 head_norm_before_train=1.447537 (no previous merge yet)
[S9] round=9 local utility u=0.046235 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.9986130647130823, 'loss_val': 0.3234352594131553, 'psi': 0.8202640265167385}-{'f1_val': 0.7014391336149548, 'auprc': 0.999222122295655, 'loss_val': 0.41817941928323743, 'psi': 0.8205523290872349}
[S10] START round=9 head_norm_before_train=1.040130 cos_to_last_merge=0.9224 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.922
[S10] round=9 local utility u=0.168256 metrics={'f1_val': 0.3876098520739868, 'auprc': 0.9091301100224674, 'loss_val': 0.7411249236656049, 'psi': 0.5962179552533791}-{'f1_val': 0.38867670237126606, 'auprc': 0.809666817858831, 'loss_val': 0.7856489947150059, 'psi': 0.5570727485662921}
[S11] START round=9 head_norm_before_train=0.799367 cos_to_last_merge=0.8896 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.890
[S11] round=9 local utility u=0.250613 metrics={'f1_val': 0.39651855440916606, 'auprc': 0.9046627911514782, 'loss_val': 0.8851167496736521, 'psi': 0.599776249106091}-{'f1_val': 0.3991311585672247, 'auprc': 0.767516083316715, 'loss_val': 0.9905792321682525, 'psi': 0.5464851284670208}
[S13] START round=9 head_norm_before_train=1.404656 (no previous merge yet)
[S13] round=9 local utility u=1.000000 metrics={'f1_val': 0.7135150731518334, 'auprc': 0.7659590191210004, 'loss_val': 0.692776911979372, 'psi': 0.7344926515395002}-{'f1_val': 0.37148979094291945, 'auprc': 0.6616262357068601, 'loss_val': 0.8575492729277349, 'psi': 0.4875443688484957}
[S14] START round=9 head_norm_before_train=1.434658 (no previous merge yet)
[S14] round=9 local utility u=0.300536 metrics={'f1_val': 0.9974809331038869, 'auprc': 0.9960611656762413, 'loss_val': 0.5375814458890003, 'psi': 0.9969130261328286}-{'f1_val': 0.9256183163268011, 'auprc': 0.9958166331227861, 'loss_val': 0.706744531956527, 'psi': 0.9536976430451951}
[S15] START round=9 head_norm_before_train=0.958533 cos_to_last_merge=0.9393 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.939
[S15] round=9 local utility u=0.965356 metrics={'f1_val': 0.6966722491800865, 'auprc': 0.7993145271922033, 'loss_val': 0.6422211745423546, 'psi': 0.7377291603849332}-{'f1_val': 0.4018346765097037, 'auprc': 0.7997688782280271, 'loss_val': 0.8052701803844927, 'psi': 0.561008357197033}
[S16] START round=9 head_norm_before_train=0.982776 cos_to_last_merge=0.9198 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.920
[S16] round=9 local utility u=0.044706 metrics={'f1_val': 0.39710823939474793, 'auprc': 0.7304062356380643, 'loss_val': 0.9112864429387859, 'psi': 0.5304274378920745}-{'f1_val': 0.3839335238973264, 'auprc': 0.7387858980662497, 'loss_val': 0.9467886945374829, 'psi': 0.5258744735648957}
[S17] START round=9 head_norm_before_train=0.975500 cos_to_last_merge=0.8707 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.871
[S17] round=9 local utility u=0.000000 metrics={'f1_val': 0.35610431097694206, 'auprc': 0.7559962481497224, 'loss_val': 0.8643107141207991, 'psi': 0.5160610858460543}-{'f1_val': 0.378278943630856, 'auprc': 0.7562563221146488, 'loss_val': 0.8652238113752142, 'psi': 0.5294698950243731}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:33902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:33911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:33905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:33903
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] → sending delta(kind=head bytes=1792) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] → sending delta(kind=head bytes=1793) to S3@127.0.0.1:33903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:33904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] → sending delta(kind=head bytes=1806) to S2@127.0.0.1:33902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:33908
[S5] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1792 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1793 to 1 peers)
[S13] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1806 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1803) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.432759)
[S3] loaded HEAD from S5 (vec_in norm=1.432759)
[S3] cosine check vs S5: cos=0.0225
[S3] BUFFERED delta from S5 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1795) from S13
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.434929)
[S6] loaded HEAD from S13 (vec_in norm=1.434929)
[S6] cosine check vs S13: cos=0.2603
[S6] BUFFERED delta from S13 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1798) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.033800)
[S6] loaded HEAD from S16 (vec_in norm=1.033800)
[S6] cosine check vs S16: cos=0.6820
[S6] BUFFERED delta from S16 (total buffered=2)
[S2] RECEIVED delta(kind=head bytes=1796) from S7
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.386510)
[S2] loaded HEAD from S7 (vec_in norm=1.386510)
[S2] cosine check vs S7: cos=0.7932
[S2] BUFFERED delta from S7 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1793) from S2
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=0.718779)
[S3] loaded HEAD from S2 (vec_in norm=0.718779)
[S3] cosine check vs S2: cos=0.8600
[S3] BUFFERED delta from S2 (total buffered=2)
[S8] RECEIVED delta(kind=head bytes=1792) from S15
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.014693)
[S8] loaded HEAD from S15 (vec_in norm=1.014693)
[S8] cosine check vs S15: cos=0.8994
[S8] BUFFERED delta from S15 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1801) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.484385)
[S7] loaded HEAD from S14 (vec_in norm=1.484385)
[S7] cosine check vs S14: cos=0.9929
[S7] BUFFERED delta from S14 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1806) from S8
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.714566)
[S2] loaded HEAD from S8 (vec_in norm=0.714566)
[S2] cosine check vs S8: cos=0.5187
[S2] BUFFERED delta from S8 (total buffered=2)
[S4] RECEIVED delta(kind=head bytes=1795) from S11
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.846623)
[S4] loaded HEAD from S11 (vec_in norm=0.846623)
[S4] cosine check vs S11: cos=0.7558
[S4] BUFFERED delta from S11 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1800) from S10
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.092064)
[S6] loaded HEAD from S10 (vec_in norm=1.092064)
[S6] cosine check vs S10: cos=0.7711
[S6] BUFFERED delta from S10 (total buffered=3)
[S8] RECEIVED delta(kind=head bytes=1799) from S4
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.620528)
[S8] loaded HEAD from S4 (vec_in norm=0.620528)
[S8] cosine check vs S4: cos=0.4694
[S8] BUFFERED delta from S4 (total buffered=2)
[S10] RECEIVED delta(kind=head bytes=1801) from S9
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.498879)
[S10] loaded HEAD from S9 (vec_in norm=1.498879)
[S10] cosine check vs S9: cos=-0.0483
[S10] DROPPED delta from S9 (cos=-0.0483 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1798) from S6
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.748253)
[S5] loaded HEAD from S6 (vec_in norm=0.748253)
[S5] cosine check vs S6: cos=0.0126
[S5] BUFFERED delta from S6 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=9 metric=0.4010 head_norm=0.643200
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.065968e-01
[S3] stored merged vector for next round verification (round=9)
[S3] DEBUG after merge:  round=9 metric=0.4010 head_norm=0.611953 delta_norm=0.406597
[S3] aggregate: ACCEPT kept=['S5', 'S2'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=9 metric=0.7147 head_norm=0.714566
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.243401e-01
[S8] stored merged vector for next round verification (round=9)
[S8] DEBUG after merge:  round=9 metric=0.7145 head_norm=0.667506 delta_norm=0.124340
[S8] aggregate: ACCEPT kept=['S15', 'S4'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=9 metric=0.4171 head_norm=0.748253
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.326731e-01
[S6] stored merged vector for next round verification (round=9)
[S6] DEBUG after merge:  round=9 metric=0.4171 head_norm=0.721980 delta_norm=0.132673
[S6] aggregate: ACCEPT kept=['S13', 'S16', 'S10'] (k=3/3) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=9 metric=0.7009 head_norm=1.432759
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.040120e-01
[S5] stored merged vector for next round verification (round=9)
[S5] DEBUG after merge:  round=9 metric=0.7009 head_norm=0.812346 delta_norm=0.804012
[S5] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=9 metric=0.5319 head_norm=0.718779
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.265448e-01
[S2] stored merged vector for next round verification (round=9)
[S2] DEBUG after merge:  round=9 metric=0.6066 head_norm=0.737884 delta_norm=0.126545
[S2] aggregate: ACCEPT kept=['S7', 'S8'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=9 metric=0.1421 head_norm=1.386510
[S7] _apply_head_vector_avg (torch): Δ‖w‖=9.857672e-02
[S7] stored merged vector for next round verification (round=9)
[S7] DEBUG after merge:  round=9 metric=0.2738 head_norm=1.432895 delta_norm=0.098577
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=9 metric=0.6655 head_norm=0.620528
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.773699e-01
[S4] stored merged vector for next round verification (round=9)
[S4] DEBUG after merge:  round=9 metric=0.6659 head_norm=0.688461 delta_norm=0.277370
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=0.737884 cos_to_last_merge=1.0000 (last merge round=9)
[S2] round=10 local utility u=0.341623 metrics={'f1_val': 0.6331619094204993, 'auprc': 0.7760845253460957, 'loss_val': 0.9324547021361922, 'psi': 0.6903309557907379}-{'f1_val': 0.5319446055621366, 'auprc': 0.7761226814486233, 'loss_val': 1.00851044399637, 'psi': 0.6296158359167312}
[S3] START round=10 head_norm_before_train=0.611953 cos_to_last_merge=1.0000 (last merge round=9)
[S3] round=10 local utility u=0.024706 metrics={'f1_val': 0.401708470248874, 'auprc': 0.8668305970278174, 'loss_val': 0.8901472162505797, 'psi': 0.5877573209604514}-{'f1_val': 0.4009668676591264, 'auprc': 0.8591269317525223, 'loss_val': 0.9119984443413036, 'psi': 0.5842308932964848}
[S4] START round=10 head_norm_before_train=0.688461 cos_to_last_merge=1.0000 (last merge round=9)
[S4] round=10 local utility u=0.078438 metrics={'f1_val': 0.6725871008681068, 'auprc': 0.7771130928167794, 'loss_val': 0.9060662998435908, 'psi': 0.7143974976475759}-{'f1_val': 0.6655474941606676, 'auprc': 0.77666896540281, 'loss_val': 1.0193725795601185, 'psi': 0.7099960826575247}
[S5] START round=10 head_norm_before_train=0.812346 cos_to_last_merge=1.0000 (last merge round=9)
[S5] round=10 local utility u=0.034639 metrics={'f1_val': 0.7149864615098203, 'auprc': 0.7950347506582965, 'loss_val': 0.7534803654448015, 'psi': 0.7470057771692108}-{'f1_val': 0.7009191775993218, 'auprc': 0.7947650591245653, 'loss_val': 0.7375447051621675, 'psi': 0.7384575302094192}
[S6] START round=10 head_norm_before_train=0.721980 cos_to_last_merge=1.0000 (last merge round=9)
[S6] round=10 local utility u=0.249812 metrics={'f1_val': 0.4130684473933217, 'auprc': 0.7695844208274387, 'loss_val': 0.9093364775154721, 'psi': 0.5556748367669686}-{'f1_val': 0.41705570454086727, 'auprc': 0.6291605945818692, 'loss_val': 1.011611658449427, 'psi': 0.501897660557268}
[S7] START round=10 head_norm_before_train=1.432895 cos_to_last_merge=1.0000 (last merge round=9)
[S7] round=10 local utility u=1.000000 metrics={'f1_val': 0.6429276286124699, 'auprc': 0.7632785634176233, 'loss_val': 1.014085606910308, 'psi': 0.6910680025345313}-{'f1_val': 0.14205682272909165, 'auprc': 0.7675472422699651, 'loss_val': 1.131632102755476, 'psi': 0.39225299054544105}
[S8] START round=10 head_norm_before_train=0.667506 cos_to_last_merge=1.0000 (last merge round=9)
[S8] round=10 local utility u=0.052388 metrics={'f1_val': 0.7150337453891538, 'auprc': 0.7769369104913333, 'loss_val': 0.9415703525166748, 'psi': 0.7397950114300256}-{'f1_val': 0.7147462840508991, 'auprc': 0.7771057262910762, 'loss_val': 1.0451278310138565, 'psi': 0.73969006094697}
[S9] START round=10 head_norm_before_train=1.498879 (no previous merge yet)
[S9] round=10 local utility u=0.018228 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.998703730519525, 'loss_val': 0.287251471327535, 'psi': 0.8203002928393155}-{'f1_val': 0.7013646677191758, 'auprc': 0.9986130647130823, 'loss_val': 0.3234352594131553, 'psi': 0.8202640265167385}
[S10] START round=10 head_norm_before_train=1.092064 cos_to_last_merge=0.9035 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.903
[S10] round=10 local utility u=1.000000 metrics={'f1_val': 0.6955083081194023, 'auprc': 0.9418655642176936, 'loss_val': 0.6582498212422266, 'psi': 0.794051210558719}-{'f1_val': 0.3876098520739868, 'auprc': 0.9091301100224674, 'loss_val': 0.7411249236656049, 'psi': 0.5962179552533791}
[S11] START round=10 head_norm_before_train=0.846623 cos_to_last_merge=0.8655 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.865
[S11] round=10 local utility u=0.179063 metrics={'f1_val': 0.3960901117346015, 'auprc': 0.994754214393184, 'loss_val': 0.794694215380163, 'psi': 0.6355557527980346}-{'f1_val': 0.39651855440916606, 'auprc': 0.9046627911514782, 'loss_val': 0.8851167496736521, 'psi': 0.599776249106091}
[S13] START round=10 head_norm_before_train=1.434929 (no previous merge yet)
[S13] round=10 local utility u=0.035380 metrics={'f1_val': 0.7131602690408223, 'auprc': 0.7563949944626056, 'loss_val': 0.5911950710883822, 'psi': 0.7304541592095357}-{'f1_val': 0.7135150731518334, 'auprc': 0.7659590191210004, 'loss_val': 0.692776911979372, 'psi': 0.7344926515395002}
[S14] START round=10 head_norm_before_train=1.484385 (no previous merge yet)
[S14] round=10 local utility u=0.095536 metrics={'f1_val': 0.9979187620675374, 'auprc': 0.9985374630318222, 'loss_val': 0.356566078495021, 'psi': 0.9981662424532513}-{'f1_val': 0.9974809331038869, 'auprc': 0.9960611656762413, 'loss_val': 0.5375814458890003, 'psi': 0.9969130261328286}
[S15] START round=10 head_norm_before_train=1.014693 cos_to_last_merge=0.9205 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.921
[S15] round=10 local utility u=0.035674 metrics={'f1_val': 0.6972101099276564, 'auprc': 0.7982199380331794, 'loss_val': 0.5708165601367138, 'psi': 0.7376140411698656}-{'f1_val': 0.6966722491800865, 'auprc': 0.7993145271922033, 'loss_val': 0.6422211745423546, 'psi': 0.7377291603849332}
[S16] START round=10 head_norm_before_train=1.033800 cos_to_last_merge=0.9008 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.901
[S16] round=10 local utility u=0.435578 metrics={'f1_val': 0.5150474625320904, 'auprc': 0.763852322150828, 'loss_val': 0.8481030510244219, 'psi': 0.6145694063795855}-{'f1_val': 0.39710823939474793, 'auprc': 0.7304062356380643, 'loss_val': 0.9112864429387859, 'psi': 0.5304274378920745}
[S17] START round=10 head_norm_before_train=1.029619 cos_to_last_merge=0.8439 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.844
[S17] round=10 local utility u=0.000000 metrics={'f1_val': 0.3521468168496875, 'auprc': 0.6900971393385291, 'loss_val': 0.9038079660821274, 'psi': 0.4873269458452242}-{'f1_val': 0.35610431097694206, 'auprc': 0.7559962481497224, 'loss_val': 0.8643107141207991, 'psi': 0.5160610858460543}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:33908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:33905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:33903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S8] → sending delta(kind=head bytes=1807) to S2@127.0.0.1:33902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:33903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:33904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S9] → sending delta(kind=head bytes=1791) to S10@127.0.0.1:33911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:33904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:33902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:33907
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1793 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1807 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1791 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1797) from S13
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.468019)
[S6] loaded HEAD from S13 (vec_in norm=1.468019)
[S6] cosine check vs S13: cos=0.3884
[S6] BUFFERED delta from S13 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1800) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.537948)
[S7] loaded HEAD from S14 (vec_in norm=1.537948)
[S7] cosine check vs S14: cos=0.9947
[S7] BUFFERED delta from S14 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1802) from S7
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.446775)
[S2] loaded HEAD from S7 (vec_in norm=1.446775)
[S2] cosine check vs S7: cos=0.8248
[S2] BUFFERED delta from S7 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1796) from S6
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.766506)
[S5] loaded HEAD from S6 (vec_in norm=0.766506)
[S5] cosine check vs S6: cos=0.4355
[S5] BUFFERED delta from S6 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1807) from S8
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.711966)
[S2] loaded HEAD from S8 (vec_in norm=0.711966)
[S2] cosine check vs S8: cos=0.4910
[S2] BUFFERED delta from S8 (total buffered=2)
[S8] RECEIVED delta(kind=head bytes=1795) from S4
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.750574)
[S8] loaded HEAD from S4 (vec_in norm=0.750574)
[S8] cosine check vs S4: cos=0.3982
[S8] BUFFERED delta from S4 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1800) from S15
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.075457)
[S8] loaded HEAD from S15 (vec_in norm=1.075457)
[S8] cosine check vs S15: cos=0.8767
[S8] BUFFERED delta from S15 (total buffered=2)
[S10] RECEIVED delta(kind=head bytes=1791) from S9
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.538137)
[S10] loaded HEAD from S9 (vec_in norm=1.538137)
[S10] cosine check vs S9: cos=-0.0460
[S10] DROPPED delta from S9 (cos=-0.0460 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1800) from S11
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.900184)
[S4] loaded HEAD from S11 (vec_in norm=0.900184)
[S4] cosine check vs S11: cos=0.9209
[S4] BUFFERED delta from S11 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1793) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.078952)
[S6] loaded HEAD from S16 (vec_in norm=1.078952)
[S6] cosine check vs S16: cos=0.6726
[S6] BUFFERED delta from S16 (total buffered=2)
[S4] RECEIVED delta(kind=head bytes=1798) from S3
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=0.662153)
[S4] loaded HEAD from S3 (vec_in norm=0.662153)
[S4] cosine check vs S3: cos=0.2502
[S4] BUFFERED delta from S3 (total buffered=2)
[S6] RECEIVED delta(kind=head bytes=1802) from S10
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.144260)
[S6] loaded HEAD from S10 (vec_in norm=1.144260)
[S6] cosine check vs S10: cos=0.7170
[S6] BUFFERED delta from S10 (total buffered=3)
[S3] RECEIVED delta(kind=head bytes=1795) from S2
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=0.773261)
[S3] loaded HEAD from S2 (vec_in norm=0.773261)
[S3] cosine check vs S2: cos=0.7395
[S3] BUFFERED delta from S2 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1795) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.843160)
[S3] loaded HEAD from S5 (vec_in norm=0.843160)
[S3] cosine check vs S5: cos=0.5561
[S3] BUFFERED delta from S5 (total buffered=2)
[S13] ⇄ pheromone p=0.388 → S6@127.0.0.1:33907
[S9] ⇄ pheromone p=0.288 → S10@127.0.0.1:33911
[S15] ⇄ pheromone p=0.362 → S8@127.0.0.1:33909
[S16] ⇄ pheromone p=0.321 → S6@127.0.0.1:33907
[S6] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=10 metric=0.4131 head_norm=0.766506
[S6] _apply_head_vector_avg (torch): Δ‖w‖=9.803715e-02
[S6] stored merged vector for next round verification (round=10)
[S6] DEBUG after merge:  round=10 metric=0.4068 head_norm=0.749770 delta_norm=0.098037
[S6] aggregate: ROLLBACK (f1_val pre=0.413 post=0.407 tol_abs=0.005 tol_rel=0.0)
[S6] ⇄ pheromone p=0.306 → S5@127.0.0.1:33905
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=10 metric=0.7150 head_norm=0.711966
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.459152e-01
[S8] stored merged vector for next round verification (round=10)
[S8] DEBUG after merge:  round=10 metric=0.7153 head_norm=0.680663 delta_norm=0.145915
[S8] aggregate: ACCEPT kept=['S4', 'S15'] (k=2/2) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.321 → S2@127.0.0.1:33902
[S2] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=10 metric=0.6332 head_norm=0.773261
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.186500e-01
[S2] stored merged vector for next round verification (round=10)
[S2] DEBUG after merge:  round=10 metric=0.6767 head_norm=0.781390 delta_norm=0.118650
[S2] aggregate: ACCEPT kept=['S7', 'S8'] (k=2/2) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.334 → S3@127.0.0.1:33903
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=10 metric=0.6726 head_norm=0.750574
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.893749e-01
[S4] stored merged vector for next round verification (round=10)
[S4] DEBUG after merge:  round=10 metric=0.6695 head_norm=0.639635 delta_norm=0.189375
[S4] aggregate: ACCEPT kept=['S11', 'S3'] (k=2/2) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.446 → S8@127.0.0.1:33909
[S10] ⇄ pheromone p=0.462 → S6@127.0.0.1:33907
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=10 metric=0.6429 head_norm=1.446775
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.909833e-02
[S7] stored merged vector for next round verification (round=10)
[S7] DEBUG after merge:  round=10 metric=0.5959 head_norm=1.490397 delta_norm=0.089098
[S7] aggregate: ROLLBACK (f1_val pre=0.643 post=0.596 tol_abs=0.005 tol_rel=0.0)
[S7] ⇄ pheromone p=0.380 → S2@127.0.0.1:33902
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=10 metric=0.4017 head_norm=0.662153
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.648235e-01
[S3] stored merged vector for next round verification (round=10)
[S3] DEBUG after merge:  round=10 metric=0.4017 head_norm=0.609681 delta_norm=0.164824
[S3] aggregate: ACCEPT kept=['S2', 'S5'] (k=2/2) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.283 → S4@127.0.0.1:33904
[S14] ⇄ pheromone p=0.424 → S7@127.0.0.1:33908
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=10 metric=0.7150 head_norm=0.843160
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.288042e-01
[S5] stored merged vector for next round verification (round=10)
[S5] DEBUG after merge:  round=10 metric=0.7147 head_norm=0.682168 delta_norm=0.428804
[S5] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.334 → S3@127.0.0.1:33903
[S11] ⇄ pheromone p=0.347 → S4@127.0.0.1:33904
[S17] ⇄ pheromone p=0.234 → S8@127.0.0.1:33909
[S2] START round=11 head_norm_before_train=0.781390 cos_to_last_merge=1.0000 (last merge round=10)
[S2] round=11 local utility u=0.251354 metrics={'f1_val': 0.7015138598194108, 'auprc': 0.7774801065763337, 'loss_val': 0.8440457072331781, 'psi': 0.7319003585221799}-{'f1_val': 0.6331619094204993, 'auprc': 0.7760845253460957, 'loss_val': 0.9324547021361922, 'psi': 0.6903309557907379}
[S3] START round=11 head_norm_before_train=0.609681 cos_to_last_merge=1.0000 (last merge round=10)
[S3] round=11 local utility u=0.083421 metrics={'f1_val': 0.42194799929964727, 'auprc': 0.8638845575864045, 'loss_val': 0.8359037660329707, 'psi': 0.5987226226143502}-{'f1_val': 0.401708470248874, 'auprc': 0.8668305970278174, 'loss_val': 0.8901472162505797, 'psi': 0.5877573209604514}
[S4] START round=11 head_norm_before_train=0.639635 cos_to_last_merge=1.0000 (last merge round=10)
[S4] round=11 local utility u=0.000000 metrics={'f1_val': 0.6660988797343514, 'auprc': 0.6545305084468291, 'loss_val': 0.8728391155048081, 'psi': 0.6614715312193425}-{'f1_val': 0.6725871008681068, 'auprc': 0.7771130928167794, 'loss_val': 0.9060662998435908, 'psi': 0.7143974976475759}
[S5] START round=11 head_norm_before_train=0.682168 cos_to_last_merge=1.0000 (last merge round=10)
[S5] round=11 local utility u=0.000000 metrics={'f1_val': 0.4179917811060899, 'auprc': 0.7920053313852364, 'loss_val': 0.8785773852927737, 'psi': 0.5675972012177486}-{'f1_val': 0.7149864615098203, 'auprc': 0.7950347506582965, 'loss_val': 0.7534803654448015, 'psi': 0.7470057771692108}
[S6] START round=11 head_norm_before_train=0.749770 cos_to_last_merge=1.0000 (last merge round=10)
[S6] round=11 local utility u=0.701436 metrics={'f1_val': 0.5475630787799679, 'auprc': 0.9233438269933107, 'loss_val': 0.7747109134778817, 'psi': 0.6978753780653051}-{'f1_val': 0.4130684473933217, 'auprc': 0.7695844208274387, 'loss_val': 0.9093364775154721, 'psi': 0.5556748367669686}
[S7] START round=11 head_norm_before_train=1.490397 cos_to_last_merge=1.0000 (last merge round=10)
[S7] round=11 local utility u=0.226469 metrics={'f1_val': 0.6846618363898098, 'auprc': 0.7835185027301135, 'loss_val': 0.8722720081124642, 'psi': 0.7242045029259313}-{'f1_val': 0.6429276286124699, 'auprc': 0.7632785634176233, 'loss_val': 1.014085606910308, 'psi': 0.6910680025345313}
[S8] START round=11 head_norm_before_train=0.680663 cos_to_last_merge=1.0000 (last merge round=10)
[S8] round=11 local utility u=0.084031 metrics={'f1_val': 0.7145534310137924, 'auprc': 0.7945642209772011, 'loss_val': 0.8235083814620309, 'psi': 0.746557746999156}-{'f1_val': 0.7150337453891538, 'auprc': 0.7769369104913333, 'loss_val': 0.9415703525166748, 'psi': 0.7397950114300256}
[S9] START round=11 head_norm_before_train=1.538137 (no previous merge yet)
[S9] round=11 local utility u=0.010585 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9983208207950812, 'loss_val': 0.2644866421210106, 'psi': 0.8201026184425706}-{'f1_val': 0.7013646677191758, 'auprc': 0.998703730519525, 'loss_val': 0.287251471327535, 'psi': 0.8203002928393155}
[S10] START round=11 head_norm_before_train=1.144260 cos_to_last_merge=0.8854 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.885
[S10] round=11 local utility u=0.102006 metrics={'f1_val': 0.6944181376691385, 'auprc': 0.9882506124034971, 'loss_val': 0.5868518488427069, 'psi': 0.8119511275628819}-{'f1_val': 0.6955083081194023, 'auprc': 0.9418655642176936, 'loss_val': 0.6582498212422266, 'psi': 0.794051210558719}
[S11] START round=11 head_norm_before_train=0.900184 cos_to_last_merge=0.8396 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.840
[S11] round=11 local utility u=0.280166 metrics={'f1_val': 0.47741769552800123, 'auprc': 0.9916247107168934, 'loss_val': 0.7129389997458684, 'psi': 0.6831005016035581}-{'f1_val': 0.3960901117346015, 'auprc': 0.994754214393184, 'loss_val': 0.794694215380163, 'psi': 0.6355557527980346}
[S13] START round=11 head_norm_before_train=1.468019 (no previous merge yet)
[S13] round=11 local utility u=0.000000 metrics={'f1_val': 0.7134489089664795, 'auprc': 0.7389281080034861, 'loss_val': 0.5412767460716358, 'psi': 0.7236405885812821}-{'f1_val': 0.7131602690408223, 'auprc': 0.7563949944626056, 'loss_val': 0.5911950710883822, 'psi': 0.7304541592095357}
[S14] START round=11 head_norm_before_train=1.537948 (no previous merge yet)
[S14] round=11 local utility u=0.000000 metrics={'f1_val': 0.9373902645890004, 'auprc': 0.9986454111515084, 'loss_val': 0.20703587446176988, 'psi': 0.9618923232140035}-{'f1_val': 0.9979187620675374, 'auprc': 0.9985374630318222, 'loss_val': 0.356566078495021, 'psi': 0.9981662424532513}
[S15] START round=11 head_norm_before_train=1.075457 cos_to_last_merge=0.9011 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.901
[S15] round=11 local utility u=0.076733 metrics={'f1_val': 0.6952332330590965, 'auprc': 0.8027074670921823, 'loss_val': 0.4189511441557289, 'psi': 0.7382229266723308}-{'f1_val': 0.6972101099276564, 'auprc': 0.7982199380331794, 'loss_val': 0.5708165601367138, 'psi': 0.7376140411698656}
[S16] START round=11 head_norm_before_train=1.078952 cos_to_last_merge=0.8837 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.884
[S16] round=11 local utility u=0.000000 metrics={'f1_val': 0.41812254897836376, 'auprc': 0.756741298041317, 'loss_val': 0.7599632309827615, 'psi': 0.5535700486035451}-{'f1_val': 0.5150474625320904, 'auprc': 0.763852322150828, 'loss_val': 0.8481030510244219, 'psi': 0.6145694063795855}
[S17] START round=11 head_norm_before_train=1.074645 cos_to_last_merge=0.8227 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.823
[S17] round=11 local utility u=0.000000 metrics={'f1_val': 0.3371833135018681, 'auprc': 0.6441455645878382, 'loss_val': 0.9773652785995395, 'psi': 0.4599682139362562}-{'f1_val': 0.3521468168496875, 'auprc': 0.6900971393385291, 'loss_val': 0.9038079660821274, 'psi': 0.4873269458452242}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S11] → sending delta(kind=head bytes=1791) to S4@127.0.0.1:33904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:33911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:33904
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:33907
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S2] → sending delta(kind=head bytes=1790) to S3@127.0.0.1:33903
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:33905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:33902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:33902
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1790 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1791 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1791) from S11
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.959203)
[S4] loaded HEAD from S11 (vec_in norm=0.959203)
[S4] cosine check vs S11: cos=0.8692
[S4] BUFFERED delta from S11 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1800) from S15
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.137162)
[S8] loaded HEAD from S15 (vec_in norm=1.137162)
[S8] cosine check vs S15: cos=0.8574
[S8] BUFFERED delta from S15 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1798) from S9
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.573471)
[S10] loaded HEAD from S9 (vec_in norm=1.573471)
[S10] cosine check vs S9: cos=-0.0463
[S10] DROPPED delta from S9 (cos=-0.0463 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1790) from S2
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=0.820469)
[S3] loaded HEAD from S2 (vec_in norm=0.820469)
[S3] cosine check vs S2: cos=0.7290
[S3] BUFFERED delta from S2 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1798) from S7
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.510263)
[S2] loaded HEAD from S7 (vec_in norm=1.510263)
[S2] cosine check vs S7: cos=0.8442
[S2] BUFFERED delta from S7 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1795) from S3
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=0.662754)
[S4] loaded HEAD from S3 (vec_in norm=0.662754)
[S4] cosine check vs S3: cos=0.3973
[S4] BUFFERED delta from S3 (total buffered=2)
[S6] RECEIVED delta(kind=head bytes=1804) from S10
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.187153)
[S6] loaded HEAD from S10 (vec_in norm=1.187153)
[S6] cosine check vs S10: cos=0.6848
[S6] BUFFERED delta from S10 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1800) from S8
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.732116)
[S2] loaded HEAD from S8 (vec_in norm=0.732116)
[S2] cosine check vs S8: cos=0.4431
[S2] BUFFERED delta from S8 (total buffered=2)
[S5] RECEIVED delta(kind=head bytes=1795) from S6
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.801431)
[S5] loaded HEAD from S6 (vec_in norm=0.801431)
[S5] cosine check vs S6: cos=0.7735
[S5] BUFFERED delta from S6 (total buffered=1)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=11 metric=0.4180 head_norm=0.719363
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.588084e-01
[S5] stored merged vector for next round verification (round=11)
[S5] DEBUG after merge:  round=11 metric=0.4178 head_norm=0.716174 delta_norm=0.258808
[S5] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=11 metric=0.6661 head_norm=0.708279
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.371273e-01
[S4] stored merged vector for next round verification (round=11)
[S4] DEBUG after merge:  round=11 metric=0.6577 head_norm=0.638207 delta_norm=0.137127
[S4] aggregate: ROLLBACK (f1_val pre=0.666 post=0.658 tol_abs=0.005 tol_rel=0.0)
[S2] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=11 metric=0.7015 head_norm=0.820469
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.173728e-01
[S2] stored merged vector for next round verification (round=11)
[S2] DEBUG after merge:  round=11 metric=0.6997 head_norm=0.818459 delta_norm=0.117373
[S2] aggregate: ACCEPT kept=['S7', 'S8'] (k=2/2) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=11 metric=0.4219 head_norm=0.662754
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.826509e-01
[S3] stored merged vector for next round verification (round=11)
[S3] DEBUG after merge:  round=11 metric=0.5821 head_norm=0.690155 delta_norm=0.282651
[S3] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=11 metric=0.7146 head_norm=0.732116
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.167972e-01
[S8] stored merged vector for next round verification (round=11)
[S8] DEBUG after merge:  round=11 metric=0.7149 head_norm=0.902333 delta_norm=0.316797
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=11 metric=0.5476 head_norm=0.801431
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.325977e-01
[S6] stored merged vector for next round verification (round=11)
[S6] DEBUG after merge:  round=11 metric=0.4545 head_norm=0.915790 delta_norm=0.432598
[S6] aggregate: ROLLBACK (f1_val pre=0.548 post=0.455 tol_abs=0.005 tol_rel=0.0)
[S2] START round=12 head_norm_before_train=0.818459 cos_to_last_merge=1.0000 (last merge round=11)
[S2] round=12 local utility u=0.050949 metrics={'f1_val': 0.7052985471211193, 'auprc': 0.7786823898687826, 'loss_val': 0.7684633126884972, 'psi': 0.7346520842201847}-{'f1_val': 0.7015138598194108, 'auprc': 0.7774801065763337, 'loss_val': 0.8440457072331781, 'psi': 0.7319003585221799}
[S3] START round=12 head_norm_before_train=0.690155 cos_to_last_merge=1.0000 (last merge round=11)
[S3] round=12 local utility u=0.910973 metrics={'f1_val': 0.6998248967704441, 'auprc': 0.8636346075727546, 'loss_val': 0.6804689323319526, 'psi': 0.7653487810913684}-{'f1_val': 0.42194799929964727, 'auprc': 0.8638845575864045, 'loss_val': 0.8359037660329707, 'psi': 0.5987226226143502}
[S4] START round=12 head_norm_before_train=0.638207 cos_to_last_merge=1.0000 (last merge round=11)
[S4] round=12 local utility u=0.002408 metrics={'f1_val': 0.6656048324699719, 'auprc': 0.6523711701707845, 'loss_val': 0.8585812830833977, 'psi': 0.660311367550297}-{'f1_val': 0.6660988797343514, 'auprc': 0.6545305084468291, 'loss_val': 0.8728391155048081, 'psi': 0.6614715312193425}
[S5] START round=12 head_norm_before_train=0.716174 cos_to_last_merge=1.0000 (last merge round=11)
[S5] round=12 local utility u=0.861022 metrics={'f1_val': 0.7029957303185055, 'auprc': 0.7910382273862178, 'loss_val': 0.8636552360159695, 'psi': 0.7382127291455904}-{'f1_val': 0.4179917811060899, 'auprc': 0.7920053313852364, 'loss_val': 0.8785773852927737, 'psi': 0.5675972012177486}
[S6] START round=12 head_norm_before_train=0.915790 cos_to_last_merge=1.0000 (last merge round=11)
[S6] round=12 local utility u=0.360539 metrics={'f1_val': 0.6839045247165858, 'auprc': 0.8436430862803633, 'loss_val': 0.6325801919127544, 'psi': 0.7477999493420968}-{'f1_val': 0.5475630787799679, 'auprc': 0.9233438269933107, 'loss_val': 0.7747109134778817, 'psi': 0.6978753780653051}
[S7] START round=12 head_norm_before_train=1.510263 cos_to_last_merge=0.9991 (last merge round=10)
[S7] round=12 local utility u=0.133453 metrics={'f1_val': 0.6988737169109194, 'auprc': 0.7905598720977427, 'loss_val': 0.7117618357948535, 'psi': 0.7355481789856487}-{'f1_val': 0.6846618363898098, 'auprc': 0.7835185027301135, 'loss_val': 0.8722720081124642, 'psi': 0.7242045029259313}
[S8] START round=12 head_norm_before_train=0.902333 cos_to_last_merge=1.0000 (last merge round=11)
[S8] round=12 local utility u=0.371897 metrics={'f1_val': 0.714395945848483, 'auprc': 0.9790845253561834, 'loss_val': 0.6323308848231897, 'psi': 0.8202713776515631}-{'f1_val': 0.7145534310137924, 'auprc': 0.7945642209772011, 'loss_val': 0.8235083814620309, 'psi': 0.746557746999156}
[S9] START round=12 head_norm_before_train=1.573471 (no previous merge yet)
[S9] round=12 local utility u=0.021458 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9985319887302808, 'loss_val': 0.22220449330796604, 'psi': 0.8201870856166504}-{'f1_val': 0.7012904835408967, 'auprc': 0.9983208207950812, 'loss_val': 0.2644866421210106, 'psi': 0.8201026184425706}
[S10] START round=12 head_norm_before_train=1.187153 cos_to_last_merge=0.8719 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.872
[S10] round=12 local utility u=0.050753 metrics={'f1_val': 0.6954287229741783, 'auprc': 0.9941196759184628, 'loss_val': 0.5090174565755257, 'psi': 0.8149051041518922}-{'f1_val': 0.6944181376691385, 'auprc': 0.9882506124034971, 'loss_val': 0.5868518488427069, 'psi': 0.8119511275628819}
[S11] START round=12 head_norm_before_train=0.959203 cos_to_last_merge=0.8140 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.814
[S11] round=12 local utility u=0.696181 metrics={'f1_val': 0.7021324793760719, 'auprc': 0.983307325120017, 'loss_val': 0.6439139351512847, 'psi': 0.8146024176736499}-{'f1_val': 0.47741769552800123, 'auprc': 0.9916247107168934, 'loss_val': 0.7129389997458684, 'psi': 0.6831005016035581}
[S13] START round=12 head_norm_before_train=1.497923 (no previous merge yet)
[S13] round=12 local utility u=0.000000 metrics={'f1_val': 0.6558742926104488, 'auprc': 0.7012594282829119, 'loss_val': 0.5384198647072801, 'psi': 0.6740283468794341}-{'f1_val': 0.7134489089664795, 'auprc': 0.7389281080034861, 'loss_val': 0.5412767460716358, 'psi': 0.7236405885812821}
[S14] START round=12 head_norm_before_train=1.589328 (no previous merge yet)
[S14] round=12 local utility u=0.204866 metrics={'f1_val': 0.9971867406506559, 'auprc': 0.9969821564473009, 'loss_val': 0.15109379633892478, 'psi': 0.9971049069693139}-{'f1_val': 0.9373902645890004, 'auprc': 0.9986454111515084, 'loss_val': 0.20703587446176988, 'psi': 0.9618923232140035}
[S15] START round=12 head_norm_before_train=1.137162 cos_to_last_merge=0.8824 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.882
[S15] round=12 local utility u=0.000000 metrics={'f1_val': 0.6950433778515444, 'auprc': 0.7877529430792594, 'loss_val': 0.48565733316194826, 'psi': 0.7321272039426303}-{'f1_val': 0.6952332330590965, 'auprc': 0.8027074670921823, 'loss_val': 0.4189511441557289, 'psi': 0.7382229266723308}
[S16] START round=12 head_norm_before_train=1.114391 cos_to_last_merge=0.8697 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.870
[S16] round=12 local utility u=0.351538 metrics={'f1_val': 0.49559466153834764, 'auprc': 0.8068077842696566, 'loss_val': 0.6719186024174023, 'psi': 0.6200799106308712}-{'f1_val': 0.41812254897836376, 'auprc': 0.756741298041317, 'loss_val': 0.7599632309827615, 'psi': 0.5535700486035451}
[S17] START round=12 head_norm_before_train=1.107332 cos_to_last_merge=0.8061 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.806
[S17] round=12 local utility u=0.000000 metrics={'f1_val': 0.33547366415395424, 'auprc': 0.6578376133833267, 'loss_val': 1.0238433037947905, 'psi': 0.4644192438457032}-{'f1_val': 0.3371833135018681, 'auprc': 0.6441455645878382, 'loss_val': 0.9773652785995395, 'psi': 0.4599682139362562}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:33907
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:33905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S2] → sending delta(kind=head bytes=1791) to S3@127.0.0.1:33903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:33902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:33903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:33911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:33902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:33904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:33908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:33904
[S5] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1793 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1791 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1796) from S8
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.955807)
[S2] loaded HEAD from S8 (vec_in norm=0.955807)
[S2] cosine check vs S8: cos=0.3871
[S2] BUFFERED delta from S8 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1801) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.748146)
[S3] loaded HEAD from S5 (vec_in norm=0.748146)
[S3] cosine check vs S5: cos=0.2624
[S3] BUFFERED delta from S5 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1791) from S2
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=0.859062)
[S3] loaded HEAD from S2 (vec_in norm=0.859062)
[S3] cosine check vs S2: cos=0.9113
[S3] BUFFERED delta from S2 (total buffered=2)
[S6] RECEIVED delta(kind=head bytes=1798) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.155263)
[S6] loaded HEAD from S16 (vec_in norm=1.155263)
[S6] cosine check vs S16: cos=0.4002
[S6] BUFFERED delta from S16 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1796) from S10
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.227010)
[S6] loaded HEAD from S10 (vec_in norm=1.227010)
[S6] cosine check vs S10: cos=0.9318
[S6] BUFFERED delta from S10 (total buffered=2)
[S2] RECEIVED delta(kind=head bytes=1803) from S7
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.536191)
[S2] loaded HEAD from S7 (vec_in norm=1.536191)
[S2] cosine check vs S7: cos=0.8605
[S2] BUFFERED delta from S7 (total buffered=2)
[S5] RECEIVED delta(kind=head bytes=1802) from S6
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.968443)
[S5] loaded HEAD from S6 (vec_in norm=0.968443)
[S5] cosine check vs S6: cos=0.8339
[S5] BUFFERED delta from S6 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1793) from S3
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=0.742487)
[S4] loaded HEAD from S3 (vec_in norm=0.742487)
[S4] cosine check vs S3: cos=0.4565
[S4] BUFFERED delta from S3 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1797) from S9
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.601386)
[S10] loaded HEAD from S9 (vec_in norm=1.601386)
[S10] cosine check vs S9: cos=-0.0472
[S10] DROPPED delta from S9 (cos=-0.0472 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1801) from S4
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.711405)
[S8] loaded HEAD from S4 (vec_in norm=0.711405)
[S8] cosine check vs S4: cos=0.3112
[S8] BUFFERED delta from S4 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1798) from S11
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.018560)
[S4] loaded HEAD from S11 (vec_in norm=1.018560)
[S4] cosine check vs S11: cos=0.8355
[S4] BUFFERED delta from S11 (total buffered=2)
[S7] RECEIVED delta(kind=head bytes=1802) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.632337)
[S7] loaded HEAD from S14 (vec_in norm=1.632337)
[S7] cosine check vs S14: cos=0.9901
[S7] BUFFERED delta from S14 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=12 metric=0.6989 head_norm=1.536191
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.212652e-01
[S7] stored merged vector for next round verification (round=12)
[S7] DEBUG after merge:  round=12 metric=0.6890 head_norm=1.580348 delta_norm=0.121265
[S7] aggregate: ROLLBACK (f1_val pre=0.699 post=0.689 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=12 metric=0.7030 head_norm=0.748146
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.689001e-01
[S5] stored merged vector for next round verification (round=12)
[S5] DEBUG after merge:  round=12 metric=0.9557 head_norm=0.822493 delta_norm=0.268900
[S5] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=12 metric=0.6998 head_norm=0.742487
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.152048e-01
[S3] stored merged vector for next round verification (round=12)
[S3] DEBUG after merge:  round=12 metric=0.7001 head_norm=0.640160 delta_norm=0.215205
[S3] aggregate: ACCEPT kept=['S5', 'S2'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=12 metric=0.6656 head_norm=0.711405
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.335654e-01
[S4] stored merged vector for next round verification (round=12)
[S4] DEBUG after merge:  round=12 metric=0.6623 head_norm=0.664169 delta_norm=0.133565
[S4] aggregate: ACCEPT kept=['S3', 'S11'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=12 metric=0.7144 head_norm=0.955807
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.991036e-01
[S8] stored merged vector for next round verification (round=12)
[S8] DEBUG after merge:  round=12 metric=0.7143 head_norm=0.678769 delta_norm=0.499104
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=12 metric=0.6839 head_norm=0.968443
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.250380e-01
[S6] stored merged vector for next round verification (round=12)
[S6] DEBUG after merge:  round=12 metric=0.6394 head_norm=0.910025 delta_norm=0.225038
[S6] aggregate: ROLLBACK (f1_val pre=0.684 post=0.639 tol_abs=0.005 tol_rel=0.0)
[S2] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=12 metric=0.7053 head_norm=0.859062
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.331233e-01
[S2] stored merged vector for next round verification (round=12)
[S2] DEBUG after merge:  round=12 metric=0.6996 head_norm=0.862818 delta_norm=0.133123
[S2] aggregate: ROLLBACK (f1_val pre=0.705 post=0.700 tol_abs=0.005 tol_rel=0.0)
[S2] START round=13 head_norm_before_train=0.862818 cos_to_last_merge=1.0000 (last merge round=12)
[S2] round=13 local utility u=0.044440 metrics={'f1_val': 0.699329985880033, 'auprc': 0.7940895371695129, 'loss_val': 0.6899934824211552, 'psi': 0.737233806395825}-{'f1_val': 0.7052985471211193, 'auprc': 0.7786823898687826, 'loss_val': 0.7684633126884972, 'psi': 0.7346520842201847}
[S3] START round=13 head_norm_before_train=0.640160 cos_to_last_merge=1.0000 (last merge round=12)
[S3] round=13 local utility u=0.000000 metrics={'f1_val': 0.5762436488242939, 'auprc': 0.8728131388653227, 'loss_val': 0.747320491117134, 'psi': 0.6948714448407054}-{'f1_val': 0.6998248967704441, 'auprc': 0.8636346075727546, 'loss_val': 0.6804689323319526, 'psi': 0.7653487810913684}
[S4] START round=13 head_norm_before_train=0.664169 cos_to_last_merge=1.0000 (last merge round=12)
[S4] round=13 local utility u=0.018942 metrics={'f1_val': 0.669128054104332, 'auprc': 0.6540973799962698, 'loss_val': 0.8470142567713184, 'psi': 0.6631157844611071}-{'f1_val': 0.6656048324699719, 'auprc': 0.6523711701707845, 'loss_val': 0.8585812830833977, 'psi': 0.660311367550297}
[S5] START round=13 head_norm_before_train=0.822493 cos_to_last_merge=1.0000 (last merge round=12)
[S5] round=13 local utility u=0.187284 metrics={'f1_val': 0.7008162875368863, 'auprc': 0.9025229884882956, 'loss_val': 0.8104650180016203, 'psi': 0.78149896791745}-{'f1_val': 0.7029957303185055, 'auprc': 0.7910382273862178, 'loss_val': 0.8636552360159695, 'psi': 0.7382127291455904}
[S6] START round=13 head_norm_before_train=0.910025 cos_to_last_merge=1.0000 (last merge round=12)
[S6] round=13 local utility u=0.000000 metrics={'f1_val': 0.6201147990960059, 'auprc': 0.7843754706408431, 'loss_val': 0.6430076747942693, 'psi': 0.6858190677139409}-{'f1_val': 0.6839045247165858, 'auprc': 0.8436430862803633, 'loss_val': 0.6325801919127544, 'psi': 0.7477999493420968}
[S7] START round=13 head_norm_before_train=1.580348 cos_to_last_merge=1.0000 (last merge round=12)
[S7] round=13 local utility u=0.000000 metrics={'f1_val': 0.539299564004762, 'auprc': 0.7769221324201524, 'loss_val': 0.8102759879080176, 'psi': 0.6343485913709181}-{'f1_val': 0.6988737169109194, 'auprc': 0.7905598720977427, 'loss_val': 0.7117618357948535, 'psi': 0.7355481789856487}
[S8] START round=13 head_norm_before_train=0.678769 cos_to_last_merge=1.0000 (last merge round=12)
[S8] round=13 local utility u=0.892293 metrics={'f1_val': 0.9954088702588517, 'auprc': 0.9983784527787956, 'loss_val': 0.5917046971862495, 'psi': 0.9965967032668293}-{'f1_val': 0.714395945848483, 'auprc': 0.9790845253561834, 'loss_val': 0.6323308848231897, 'psi': 0.8202713776515631}
[S9] START round=13 head_norm_before_train=1.601386 (no previous merge yet)
[S9] round=13 local utility u=0.001954 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9973749204765069, 'loss_val': 0.2143824068462163, 'psi': 0.8196799166546139}-{'f1_val': 0.7012904835408967, 'auprc': 0.9985319887302808, 'loss_val': 0.22220449330796604, 'psi': 0.8201870856166504}
[S10] START round=13 head_norm_before_train=1.227010 cos_to_last_merge=0.8608 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.861
[S10] round=13 local utility u=0.028380 metrics={'f1_val': 0.6904173394676322, 'auprc': 0.9898755939806714, 'loss_val': 0.40945644620594185, 'psi': 0.8102006412728479}-{'f1_val': 0.6954287229741783, 'auprc': 0.9941196759184628, 'loss_val': 0.5090174565755257, 'psi': 0.8149051041518922}
[S11] START round=13 head_norm_before_train=1.018560 cos_to_last_merge=0.7907 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.791
[S11] round=13 local utility u=0.064176 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9861061019206778, 'loss_val': 0.5213234259023631, 'psi': 0.8154585285204261}-{'f1_val': 0.7021324793760719, 'auprc': 0.983307325120017, 'loss_val': 0.6439139351512847, 'psi': 0.8146024176736499}
[S13] START round=13 head_norm_before_train=1.529301 (no previous merge yet)
[S13] round=13 local utility u=0.000000 metrics={'f1_val': 0.6272169123982473, 'auprc': 0.6885362173239528, 'loss_val': 0.5411851684089801, 'psi': 0.6517446343685295}-{'f1_val': 0.6558742926104488, 'auprc': 0.7012594282829119, 'loss_val': 0.5384198647072801, 'psi': 0.6740283468794341}
[S14] START round=13 head_norm_before_train=1.632337 (no previous merge yet)
[S14] round=13 local utility u=0.024150 metrics={'f1_val': 0.9978427420196455, 'auprc': 0.9969768848152389, 'loss_val': 0.10671327003912656, 'psi': 0.9974963991378829}-{'f1_val': 0.9971867406506559, 'auprc': 0.9969821564473009, 'loss_val': 0.15109379633892478, 'psi': 0.9971049069693139}
[S15] START round=13 head_norm_before_train=1.188780 cos_to_last_merge=0.8657 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.866
[S15] round=13 local utility u=0.033053 metrics={'f1_val': 0.6959188375461292, 'auprc': 0.7872594739644782, 'loss_val': 0.42332405847883686, 'psi': 0.7324550921134687}-{'f1_val': 0.6950433778515444, 'auprc': 0.7877529430792594, 'loss_val': 0.48565733316194826, 'psi': 0.7321272039426303}
[S16] START round=13 head_norm_before_train=1.155263 cos_to_last_merge=0.8577 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.858
[S16] round=13 local utility u=0.328917 metrics={'f1_val': 0.5449317350693138, 'auprc': 0.8936238729037027, 'loss_val': 0.5705553989175763, 'psi': 0.6844085902030694}-{'f1_val': 0.49559466153834764, 'auprc': 0.8068077842696566, 'loss_val': 0.6719186024174023, 'psi': 0.6200799106308712}
[S17] START round=13 head_norm_before_train=1.132903 cos_to_last_merge=0.7926 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.793
[S17] round=13 local utility u=0.000000 metrics={'f1_val': 0.3389501280926167, 'auprc': 0.6602083284803205, 'loss_val': 1.0527261024440528, 'psi': 0.4674534082476982}-{'f1_val': 0.33547366415395424, 'auprc': 0.6578376133833267, 'loss_val': 1.0238433037947905, 'psi': 0.4644192438457032}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S2] → sending delta(kind=head bytes=1788) to S7@127.0.0.1:33908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:33912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:33909
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:33904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:33908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:33907
[S4] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1788 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1799) from S5
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.849494)
[S6] loaded HEAD from S5 (vec_in norm=0.849494)
[S6] cosine check vs S5: cos=0.9354
[S6] BUFFERED delta from S5 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1801) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.671128)
[S7] loaded HEAD from S14 (vec_in norm=1.671128)
[S7] cosine check vs S14: cos=0.9942
[S7] BUFFERED delta from S14 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1797) from S11
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.075585)
[S4] loaded HEAD from S11 (vec_in norm=1.075585)
[S4] cosine check vs S11: cos=0.8183
[S4] BUFFERED delta from S11 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1788) from S2
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=0.902844)
[S7] loaded HEAD from S2 (vec_in norm=0.902844)
[S7] cosine check vs S2: cos=0.8417
[S7] BUFFERED delta from S2 (total buffered=2)
[S11] RECEIVED delta(kind=head bytes=1800) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.734318)
[S11] loaded HEAD from S4 (vec_in norm=0.734318)
[S11] cosine check vs S4: cos=0.8183
[S11] BUFFERED delta from S4 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1795) from S15
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.234417)
[S8] loaded HEAD from S15 (vec_in norm=1.234417)
[S8] cosine check vs S15: cos=0.7448
[S8] BUFFERED delta from S15 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:33907
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S10@127.0.0.1:33911
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:33902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:33907
[S16] sending update (kind=head size=1798 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1798) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.200542)
[S6] loaded HEAD from S16 (vec_in norm=1.200542)
[S6] cosine check vs S16: cos=0.5779
[S6] BUFFERED delta from S16 (total buffered=2)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1794 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1794) from S9
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.627418)
[S10] loaded HEAD from S9 (vec_in norm=1.627418)
[S10] cosine check vs S9: cos=-0.0502
[S10] DROPPED delta from S9 (cos=-0.0502 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1800) from S10
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.275372)
[S6] loaded HEAD from S10 (vec_in norm=1.275372)
[S6] cosine check vs S10: cos=0.8675
[S6] BUFFERED delta from S10 (total buffered=3)
[S2] RECEIVED delta(kind=head bytes=1798) from S8
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.741309)
[S2] loaded HEAD from S8 (vec_in norm=0.741309)
[S2] cosine check vs S8: cos=0.4887
[S2] BUFFERED delta from S8 (total buffered=1)
[S6] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=13 metric=0.6201 head_norm=0.957811
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.672376e-01
[S6] stored merged vector for next round verification (round=13)
[S6] DEBUG after merge:  round=13 metric=0.6204 head_norm=0.889719 delta_norm=0.167238
[S6] aggregate: ACCEPT kept=['S5', 'S16', 'S10'] (k=3/3) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=13 metric=0.6993 head_norm=0.902844
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.214596e-01
[S2] stored merged vector for next round verification (round=13)
[S2] DEBUG after merge:  round=13 metric=0.6994 head_norm=0.710426 delta_norm=0.421460
[S2] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=13 metric=0.6691 head_norm=0.734318
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.175976e-01
[S4] stored merged vector for next round verification (round=13)
[S4] DEBUG after merge:  round=13 metric=0.6696 head_norm=0.864398 delta_norm=0.317598
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=13 metric=0.5393 head_norm=1.605270
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.334902e-01
[S7] stored merged vector for next round verification (round=13)
[S7] DEBUG after merge:  round=13 metric=0.5626 head_norm=1.413528 delta_norm=0.233490
[S7] aggregate: ACCEPT kept=['S14', 'S2'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=13 metric=0.7017 head_norm=1.075585
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.175976e-01
[S11] stored merged vector for next round verification (round=13)
[S11] DEBUG after merge:  round=13 metric=0.7017 head_norm=0.864398 delta_norm=0.317598
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=13 metric=0.9954 head_norm=0.741309
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.213537e-01
[S8] stored merged vector for next round verification (round=13)
[S8] DEBUG after merge:  round=13 metric=0.7055 head_norm=0.926889 delta_norm=0.421354
[S8] aggregate: ROLLBACK (f1_val pre=0.995 post=0.705 tol_abs=0.005 tol_rel=0.0)
[S2] START round=14 head_norm_before_train=0.710426 cos_to_last_merge=1.0000 (last merge round=13)
[S2] round=14 local utility u=0.000000 metrics={'f1_val': 0.6989693590414899, 'auprc': 0.7942308703647092, 'loss_val': 0.698802769508564, 'psi': 0.7370739635707777}-{'f1_val': 0.699329985880033, 'auprc': 0.7940895371695129, 'loss_val': 0.6899934824211552, 'psi': 0.737233806395825}
[S3] START round=14 head_norm_before_train=0.693755 cos_to_last_merge=0.9917 (last merge round=12)
[S3] round=14 local utility u=0.675422 metrics={'f1_val': 0.7004261945879899, 'auprc': 0.9982340645539849, 'loss_val': 0.5178354724330212, 'psi': 0.8195493425743879}-{'f1_val': 0.5762436488242939, 'auprc': 0.8728131388653227, 'loss_val': 0.747320491117134, 'psi': 0.6948714448407054}
[S4] START round=14 head_norm_before_train=0.864398 cos_to_last_merge=1.0000 (last merge round=13)
[S4] round=14 local utility u=0.036060 metrics={'f1_val': 0.6684158112291836, 'auprc': 0.6522552250250103, 'loss_val': 0.7650951097665368, 'psi': 0.6619515767475143}-{'f1_val': 0.669128054104332, 'auprc': 0.6540973799962698, 'loss_val': 0.8470142567713184, 'psi': 0.6631157844611071}
[S5] START round=14 head_norm_before_train=0.849494 cos_to_last_merge=0.9908 (last merge round=12)
[S5] round=14 local utility u=0.000000 metrics={'f1_val': 0.7144008589453258, 'auprc': 0.7918126996335735, 'loss_val': 0.6919400416360897, 'psi': 0.7453655952206248}-{'f1_val': 0.7008162875368863, 'auprc': 0.9025229884882956, 'loss_val': 0.8104650180016203, 'psi': 0.78149896791745}
[S6] START round=14 head_norm_before_train=0.889719 cos_to_last_merge=1.0000 (last merge round=13)
[S6] round=14 local utility u=0.603922 metrics={'f1_val': 0.7110361061423647, 'auprc': 0.9517690911445469, 'loss_val': 0.4828718839726926, 'psi': 0.8073293001432376}-{'f1_val': 0.6201147990960059, 'auprc': 0.7843754706408431, 'loss_val': 0.6430076747942693, 'psi': 0.6858190677139409}
[S7] START round=14 head_norm_before_train=1.413528 cos_to_last_merge=1.0000 (last merge round=13)
[S7] round=14 local utility u=0.000000 metrics={'f1_val': 0.5285124991130647, 'auprc': 0.765313310855338, 'loss_val': 0.8460533516635802, 'psi': 0.623232823809974}-{'f1_val': 0.539299564004762, 'auprc': 0.7769221324201524, 'loss_val': 0.8102759879080176, 'psi': 0.6343485913709181}
[S8] START round=14 head_norm_before_train=0.926889 cos_to_last_merge=1.0000 (last merge round=13)
[S8] round=14 local utility u=0.000000 metrics={'f1_val': 0.724085796724054, 'auprc': 0.9984183656501986, 'loss_val': 0.3783560968608056, 'psi': 0.8338188242945119}-{'f1_val': 0.9954088702588517, 'auprc': 0.9983784527787956, 'loss_val': 0.5917046971862495, 'psi': 0.9965967032668293}
[S9] START round=14 head_norm_before_train=1.627418 (no previous merge yet)
[S9] round=14 local utility u=0.028058 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9984778504747509, 'loss_val': 0.1615758195618224, 'psi': 0.8201210886539115}-{'f1_val': 0.7012165807733519, 'auprc': 0.9973749204765069, 'loss_val': 0.2143824068462163, 'psi': 0.8196799166546139}
[S10] START round=14 head_norm_before_train=1.275372 cos_to_last_merge=0.8484 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.848
[S10] round=14 local utility u=0.097801 metrics={'f1_val': 0.7007102344008544, 'auprc': 0.9971361765360349, 'loss_val': 0.29739380933349013, 'psi': 0.8192806112549267}-{'f1_val': 0.6904173394676322, 'auprc': 0.9898755939806714, 'loss_val': 0.40945644620594185, 'psi': 0.8102006412728479}
[S11] START round=14 head_norm_before_train=0.864398 cos_to_last_merge=1.0000 (last merge round=13)
[S11] round=14 local utility u=0.023677 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9943119965071886, 'loss_val': 0.5000380356135592, 'psi': 0.8188859885818676}-{'f1_val': 0.7016934795869249, 'auprc': 0.9861061019206778, 'loss_val': 0.5213234259023631, 'psi': 0.8154585285204261}
[S13] START round=14 head_norm_before_train=1.558849 (no previous merge yet)
[S13] round=14 local utility u=0.000000 metrics={'f1_val': 0.5991340416004987, 'auprc': 0.6831901679018408, 'loss_val': 0.619354193308124, 'psi': 0.6327564921210356}-{'f1_val': 0.6272169123982473, 'auprc': 0.6885362173239528, 'loss_val': 0.5411851684089801, 'psi': 0.6517446343685295}
[S14] START round=14 head_norm_before_train=1.671128 (no previous merge yet)
[S14] round=14 local utility u=0.014329 metrics={'f1_val': 0.9980623665153463, 'auprc': 0.9986605165606015, 'loss_val': 0.08442307762414089, 'psi': 0.9983016265334484}-{'f1_val': 0.9978427420196455, 'auprc': 0.9969768848152389, 'loss_val': 0.10671327003912656, 'psi': 0.9974963991378829}
[S15] START round=14 head_norm_before_train=1.234417 cos_to_last_merge=0.8520 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.852
[S15] round=14 local utility u=0.124463 metrics={'f1_val': 0.6953976042221091, 'auprc': 0.8468674853288354, 'loss_val': 0.35009452457222284, 'psi': 0.7559855566647996}-{'f1_val': 0.6959188375461292, 'auprc': 0.7872594739644782, 'loss_val': 0.42332405847883686, 'psi': 0.7324550921134687}
[S16] START round=14 head_norm_before_train=1.200542 cos_to_last_merge=0.8457 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.846
[S16] round=14 local utility u=0.128506 metrics={'f1_val': 0.5662949895453422, 'auprc': 0.9389402212302488, 'loss_val': 0.5776722696662232, 'psi': 0.7153530822193048}-{'f1_val': 0.5449317350693138, 'auprc': 0.8936238729037027, 'loss_val': 0.5705553989175763, 'psi': 0.6844085902030694}
[S17] START round=14 head_norm_before_train=1.153840 cos_to_last_merge=0.7813 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.781
[S17] round=14 local utility u=0.211425 metrics={'f1_val': 0.34137074245848864, 'auprc': 0.7921316762757563, 'loss_val': 1.0401706987887687, 'psi': 0.5216751159853957}-{'f1_val': 0.3389501280926167, 'auprc': 0.6602083284803205, 'loss_val': 1.0527261024440528, 'psi': 0.4674534082476982}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S11] sending update (kind=head size=1790 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:33905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] sending update (kind=head size=1792 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:33910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:33912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:33911
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1798) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.926927)
[S11] loaded HEAD from S4 (vec_in norm=0.926927)
[S11] cosine check vs S4: cos=0.9930
[S11] BUFFERED delta from S4 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1800) from S6
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.945646)
[S10] loaded HEAD from S6 (vec_in norm=0.945646)
[S10] cosine check vs S6: cos=0.8364
[S10] BUFFERED delta from S6 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1802) from S3
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=0.756577)
[S5] loaded HEAD from S3 (vec_in norm=0.756577)
[S5] cosine check vs S3: cos=0.3965
[S5] BUFFERED delta from S3 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1796) from S10
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.326178)
[S9] loaded HEAD from S10 (vec_in norm=1.326178)
[S9] cosine check vs S10: cos=-0.0543
[S9] DROPPED delta from S10 (cos=-0.0543 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S17] sending update (kind=head size=1792 to 1 peers)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=14 metric=0.7019 head_norm=0.923283
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.489846e-02
[S11] stored merged vector for next round verification (round=14)
[S11] DEBUG after merge:  round=14 metric=0.7019 head_norm=0.923476 delta_norm=0.054898
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=14 metric=0.7144 head_norm=0.888608
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.552245e-01
[S5] stored merged vector for next round verification (round=14)
[S5] DEBUG after merge:  round=14 metric=0.7093 head_norm=0.688322 delta_norm=0.455224
[S5] aggregate: ROLLBACK (f1_val pre=0.714 post=0.709 tol_abs=0.005 tol_rel=0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=14 metric=0.7007 head_norm=1.326178
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.725000e-01
[S10] stored merged vector for next round verification (round=14)
[S10] DEBUG after merge:  round=14 metric=0.7012 head_norm=1.089836 delta_norm=0.372500
[S10] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=0.757277 cos_to_last_merge=0.9923 (last merge round=13)
[S2] round=15 local utility u=0.054072 metrics={'f1_val': 0.699329985880033, 'auprc': 0.7937808299203825, 'loss_val': 0.5914729682575848, 'psi': 0.7371103234961728}-{'f1_val': 0.6989693590414899, 'auprc': 0.7942308703647092, 'loss_val': 0.698802769508564, 'psi': 0.7370739635707777}
[S3] START round=15 head_norm_before_train=0.756577 cos_to_last_merge=0.9748 (last merge round=12)
[S3] round=15 local utility u=0.038762 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9984512273454045, 'loss_val': 0.4429433313509153, 'psi': 0.8198342131793416}-{'f1_val': 0.7004261945879899, 'auprc': 0.9982340645539849, 'loss_val': 0.5178354724330212, 'psi': 0.8195493425743879}
[S4] START round=15 head_norm_before_train=0.926927 cos_to_last_merge=0.9959 (last merge round=13)
[S4] round=15 local utility u=0.025551 metrics={'f1_val': 0.6663679783704987, 'auprc': 0.649013824976166, 'loss_val': 0.6919816026099109, 'psi': 0.6594263170127657}-{'f1_val': 0.6684158112291836, 'auprc': 0.6522552250250103, 'loss_val': 0.7650951097665368, 'psi': 0.6619515767475143}
[S5] START round=15 head_norm_before_train=0.688322 cos_to_last_merge=1.0000 (last merge round=14)
[S5] round=15 local utility u=0.015502 metrics={'f1_val': 0.713112372778296, 'auprc': 0.7928061932319136, 'loss_val': 0.6561859555700432, 'psi': 0.7449899009597429}-{'f1_val': 0.7144008589453258, 'auprc': 0.7918126996335735, 'loss_val': 0.6919400416360897, 'psi': 0.7453655952206248}
[S6] START round=15 head_norm_before_train=0.945646 cos_to_last_merge=0.9976 (last merge round=13)
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.6125244715579229, 'auprc': 0.7849670696945743, 'loss_val': 0.622686878859306, 'psi': 0.6815015108125835}-{'f1_val': 0.7110361061423647, 'auprc': 0.9517690911445469, 'loss_val': 0.4828718839726926, 'psi': 0.8073293001432376}
[S7] START round=15 head_norm_before_train=1.443457 cos_to_last_merge=0.9991 (last merge round=13)
[S7] round=15 local utility u=0.395745 metrics={'f1_val': 0.6247347937472085, 'auprc': 0.7729194920669998, 'loss_val': 0.6547153538620244, 'psi': 0.6840086730751251}-{'f1_val': 0.5285124991130647, 'auprc': 0.765313310855338, 'loss_val': 0.8460533516635802, 'psi': 0.623232823809974}
[S8] START round=15 head_norm_before_train=0.990082 cos_to_last_merge=0.9964 (last merge round=13)
[S8] round=15 local utility u=0.005517 metrics={'f1_val': 0.7147473519913303, 'auprc': 0.9980249559110957, 'loss_val': 0.3101119337384182, 'psi': 0.8280583935592365}-{'f1_val': 0.724085796724054, 'auprc': 0.9984183656501986, 'loss_val': 0.3783560968608056, 'psi': 0.8338188242945119}
[S9] START round=15 head_norm_before_train=1.652229 (no previous merge yet)
[S9] round=15 local utility u=0.909285 metrics={'f1_val': 0.9966570119660778, 'auprc': 0.9984765036836024, 'loss_val': 0.11564493627965099, 'psi': 0.9973848086530877}-{'f1_val': 0.7012165807733519, 'auprc': 0.9984778504747509, 'loss_val': 0.1615758195618224, 'psi': 0.8201210886539115}
[S10] START round=15 head_norm_before_train=1.089836 cos_to_last_merge=1.0000 (last merge round=14)
[S10] round=15 local utility u=0.005388 metrics={'f1_val': 0.7002655852492138, 'auprc': 0.9969196372861833, 'loss_val': 0.2833012782973042, 'psi': 0.8189272060640016}-{'f1_val': 0.7007102344008544, 'auprc': 0.9971361765360349, 'loss_val': 0.29739380933349013, 'psi': 0.8192806112549267}
[S11] START round=15 head_norm_before_train=0.923476 cos_to_last_merge=1.0000 (last merge round=14)
[S11] round=15 local utility u=0.047831 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9978460738369895, 'loss_val': 0.4135282041080943, 'psi': 0.8201545172869507}-{'f1_val': 0.7019353166316534, 'auprc': 0.9943119965071886, 'loss_val': 0.5000380356135592, 'psi': 0.8188859885818676}
[S13] START round=15 head_norm_before_train=1.583936 (no previous merge yet)
[S13] round=15 local utility u=0.000000 metrics={'f1_val': 0.6094716978756486, 'auprc': 0.6028598627426042, 'loss_val': 0.6568907632342759, 'psi': 0.6068269638224308}-{'f1_val': 0.5991340416004987, 'auprc': 0.6831901679018408, 'loss_val': 0.619354193308124, 'psi': 0.6327564921210356}
[S14] START round=15 head_norm_before_train=1.704877 (no previous merge yet)
[S14] round=15 local utility u=0.000000 metrics={'f1_val': 0.9964034173396682, 'auprc': 0.9986501938550179, 'loss_val': 0.07631317283560561, 'psi': 0.9973021279458081}-{'f1_val': 0.9980623665153463, 'auprc': 0.9986605165606015, 'loss_val': 0.08442307762414089, 'psi': 0.9983016265334484}
[S15] START round=15 head_norm_before_train=1.273589 cos_to_last_merge=0.8405 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.840
[S15] round=15 local utility u=0.000000 metrics={'f1_val': 0.6964441812601452, 'auprc': 0.8006687987920905, 'loss_val': 0.37224550178048704, 'psi': 0.7381340282729234}-{'f1_val': 0.6953976042221091, 'auprc': 0.8468674853288354, 'loss_val': 0.35009452457222284, 'psi': 0.7559855566647996}
[S16] START round=15 head_norm_before_train=1.245898 cos_to_last_merge=0.8334 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.833
[S16] round=15 local utility u=0.734808 metrics={'f1_val': 0.7969386307472476, 'auprc': 0.9698333950030391, 'loss_val': 0.5845975917362397, 'psi': 0.8660965364495642}-{'f1_val': 0.5662949895453422, 'auprc': 0.9389402212302488, 'loss_val': 0.5776722696662232, 'psi': 0.7153530822193048}
[S17] START round=15 head_norm_before_train=1.172684 cos_to_last_merge=0.7718 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.772
[S17] round=15 local utility u=0.102989 metrics={'f1_val': 0.35311110186723216, 'auprc': 0.8090958568663482, 'loss_val': 0.9555276379584805, 'psi': 0.5355050038668786}-{'f1_val': 0.34137074245848864, 'auprc': 0.7921316762757563, 'loss_val': 1.0401706987887687, 'psi': 0.5216751159853957}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:33905
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:33904
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S16] sending update (kind=head size=1791 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:33914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:33910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S4] → sending delta(kind=head bytes=1789) to S11@127.0.0.1:33912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S11] sending update (kind=head size=1788 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:33908
[S2] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1789 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1789) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.986296)
[S11] loaded HEAD from S4 (vec_in norm=0.986296)
[S11] cosine check vs S4: cos=0.9890
[S11] BUFFERED delta from S4 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1801) from S5
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.742325)
[S6] loaded HEAD from S5 (vec_in norm=0.742325)
[S6] cosine check vs S5: cos=0.7642
[S6] BUFFERED delta from S5 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1799) from S2
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=0.816394)
[S7] loaded HEAD from S2 (vec_in norm=0.816394)
[S7] cosine check vs S2: cos=0.6084
[S7] BUFFERED delta from S2 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1801) from S10
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.147089)
[S9] loaded HEAD from S10 (vec_in norm=1.147089)
[S9] cosine check vs S10: cos=-0.0755
[S9] DROPPED delta from S10 (cos=-0.0755 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1803) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.468983)
[S14] loaded HEAD from S7 (vec_in norm=1.468983)
[S14] cosine check vs S7: cos=0.9841
[S14] BUFFERED delta from S7 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1799) from S8
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.048176)
[S4] loaded HEAD from S8 (vec_in norm=1.048176)
[S4] cosine check vs S8: cos=0.3074
[S4] BUFFERED delta from S8 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1794) from S3
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=0.821330)
[S5] loaded HEAD from S3 (vec_in norm=0.821330)
[S5] cosine check vs S3: cos=0.7773
[S5] BUFFERED delta from S3 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S17] sending update (kind=head size=1791 to 1 peers)
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=15 metric=0.9964 head_norm=1.732516
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.939842e-01
[S14] stored merged vector for next round verification (round=15)
[S14] DEBUG after merge:  round=15 metric=0.9947 head_norm=1.594406 delta_norm=0.193984
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=15 metric=0.7017 head_norm=0.987524
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.326175e-02
[S11] stored merged vector for next round verification (round=15)
[S11] DEBUG after merge:  round=15 metric=0.7017 head_norm=0.984187 delta_norm=0.073262
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=15 metric=0.6125 head_norm=0.997906
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.220025e-01
[S6] stored merged vector for next round verification (round=15)
[S6] DEBUG after merge:  round=15 metric=0.6043 head_norm=0.818380 delta_norm=0.322003
[S6] aggregate: ROLLBACK (f1_val pre=0.613 post=0.604 tol_abs=0.005 tol_rel=0.0)
[S6] ⇄ pheromone p=0.291 → S10@127.0.0.1:33911
[S8] ⇄ pheromone p=0.265 → S4@127.0.0.1:33904
[S10] ⇄ pheromone p=0.185 → S9@127.0.0.1:33910
[S3] ⇄ pheromone p=0.309 → S5@127.0.0.1:33905
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=15 metric=0.7131 head_norm=0.742325
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.635331e-01
[S5] stored merged vector for next round verification (round=15)
[S5] DEBUG after merge:  round=15 metric=0.7006 head_norm=0.737133 delta_norm=0.263533
[S5] aggregate: ROLLBACK (f1_val pre=0.713 post=0.701 tol_abs=0.005 tol_rel=0.0)
[S5] ⇄ pheromone p=0.225 → S6@127.0.0.1:33907
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=15 metric=0.6664 head_norm=0.986296
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.991434e-01
[S4] stored merged vector for next round verification (round=15)
[S4] DEBUG after merge:  round=15 metric=0.6671 head_norm=0.822650 delta_norm=0.599143
[S4] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.160 → S11@127.0.0.1:33912
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=15 metric=0.6247 head_norm=1.468983
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.841950e-01
[S7] stored merged vector for next round verification (round=15)
[S7] DEBUG after merge:  round=15 metric=0.6523 head_norm=1.034853 delta_norm=0.584195
[S7] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.236 → S14@127.0.0.1:33914
[S2] ⇄ pheromone p=0.152 → S7@127.0.0.1:33908
[S2] START round=16 head_norm_before_train=0.816394 cos_to_last_merge=0.9746 (last merge round=13)
[S2] round=16 local utility u=0.000000 metrics={'f1_val': 0.6983478455883432, 'auprc': 0.7578187551651665, 'loss_val': 0.5210297792222629, 'psi': 0.7221362094190725}-{'f1_val': 0.699329985880033, 'auprc': 0.7937808299203825, 'loss_val': 0.5914729682575848, 'psi': 0.7371103234961728}
[S3] START round=16 head_norm_before_train=0.821330 cos_to_last_merge=0.9572 (last merge round=12)
[S3] round=16 local utility u=0.029340 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9984541062179252, 'loss_val': 0.3838199119785031, 'psi': 0.819790218286371}-{'f1_val': 0.7007562037352997, 'auprc': 0.9984512273454045, 'loss_val': 0.4429433313509153, 'psi': 0.8198342131793416}
[S4] START round=16 head_norm_before_train=0.822650 cos_to_last_merge=1.0000 (last merge round=15)
[S4] round=16 local utility u=0.019343 metrics={'f1_val': 0.6661546348483345, 'auprc': 0.65025208432339, 'loss_val': 0.6557306676174348, 'psi': 0.6597936146383567}-{'f1_val': 0.6663679783704987, 'auprc': 0.649013824976166, 'loss_val': 0.6919816026099109, 'psi': 0.6594263170127657}
[S5] START round=16 head_norm_before_train=0.737133 cos_to_last_merge=1.0000 (last merge round=15)
[S5] round=16 local utility u=0.000000 metrics={'f1_val': 0.7005685100046517, 'auprc': 0.7925036218164129, 'loss_val': 0.5913510713708304, 'psi': 0.7373425547293562}-{'f1_val': 0.713112372778296, 'auprc': 0.7928061932319136, 'loss_val': 0.6561859555700432, 'psi': 0.7449899009597429}
[S6] START round=16 head_norm_before_train=0.818380 cos_to_last_merge=1.0000 (last merge round=15)
[S6] round=16 local utility u=0.585420 metrics={'f1_val': 0.6966637167198422, 'auprc': 0.9523671933121945, 'loss_val': 0.4588833810488799, 'psi': 0.7989451073567831}-{'f1_val': 0.6125244715579229, 'auprc': 0.7849670696945743, 'loss_val': 0.622686878859306, 'psi': 0.6815015108125835}
[S7] START round=16 head_norm_before_train=1.034853 cos_to_last_merge=1.0000 (last merge round=15)
[S7] round=16 local utility u=0.000000 metrics={'f1_val': 0.6283224377218741, 'auprc': 0.7731139070254394, 'loss_val': 0.7079535566252675, 'psi': 0.6862390254433002}-{'f1_val': 0.6247347937472085, 'auprc': 0.7729194920669998, 'loss_val': 0.6547153538620244, 'psi': 0.6840086730751251}
[S8] START round=16 head_norm_before_train=1.048176 cos_to_last_merge=0.9892 (last merge round=13)
[S8] round=16 local utility u=0.736329 metrics={'f1_val': 0.9591224580679292, 'auprc': 0.9793490283722824, 'loss_val': 0.24767755386413223, 'psi': 0.9672130861896705}-{'f1_val': 0.7147473519913303, 'auprc': 0.9980249559110957, 'loss_val': 0.3101119337384182, 'psi': 0.8280583935592365}
[S9] START round=16 head_norm_before_train=1.678416 (no previous merge yet)
[S9] round=16 local utility u=0.000000 metrics={'f1_val': 0.9941535115217267, 'auprc': 0.9984746010048711, 'loss_val': 0.10102732212443778, 'psi': 0.9958819473149845}-{'f1_val': 0.9966570119660778, 'auprc': 0.9984765036836024, 'loss_val': 0.11564493627965099, 'psi': 0.9973848086530877}
[S10] START round=16 head_norm_before_train=1.147089 cos_to_last_merge=0.9969 (last merge round=14)
[S10] round=16 local utility u=0.905595 metrics={'f1_val': 0.9936275080584183, 'auprc': 0.996826345266366, 'loss_val': 0.23200389097863197, 'psi': 0.9949070429415974}-{'f1_val': 0.7002655852492138, 'auprc': 0.9969196372861833, 'loss_val': 0.2833012782973042, 'psi': 0.8189272060640016}
[S11] START round=16 head_norm_before_train=0.984187 cos_to_last_merge=1.0000 (last merge round=15)
[S11] round=16 local utility u=0.020278 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9964268282516486, 'loss_val': 0.37016546361352326, 'psi': 0.8197319212796514}-{'f1_val': 0.7016934795869249, 'auprc': 0.9978460738369895, 'loss_val': 0.4135282041080943, 'psi': 0.8201545172869507}
[S13] START round=16 head_norm_before_train=1.612732 (no previous merge yet)
[S13] round=16 local utility u=0.434638 metrics={'f1_val': 0.6903092447868512, 'auprc': 0.6644968880117438, 'loss_val': 0.45755033657866606, 'psi': 0.6799843020768082}-{'f1_val': 0.6094716978756486, 'auprc': 0.6028598627426042, 'loss_val': 0.6568907632342759, 'psi': 0.6068269638224308}
[S14] START round=16 head_norm_before_train=1.594406 cos_to_last_merge=1.0000 (last merge round=15)
[S14] round=16 local utility u=0.000000 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9986082016592575, 'loss_val': 0.08680925220567874, 'psi': 0.9980339514936152}-{'f1_val': 0.9964034173396682, 'auprc': 0.9986501938550179, 'loss_val': 0.07631317283560561, 'psi': 0.9973021279458081}
[S15] START round=16 head_norm_before_train=1.307031 cos_to_last_merge=0.8299 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.830
[S15] round=16 local utility u=0.033813 metrics={'f1_val': 0.6980402818399263, 'auprc': 0.8228022427488453, 'loss_val': 0.38059608147874463, 'psi': 0.7479450662034939}-{'f1_val': 0.6964441812601452, 'auprc': 0.8006687987920905, 'loss_val': 0.37224550178048704, 'psi': 0.7381340282729234}
[S16] START round=16 head_norm_before_train=1.293184 cos_to_last_merge=0.8221 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.822
[S16] round=16 local utility u=0.507495 metrics={'f1_val': 0.9220875519605712, 'auprc': 0.9890094934281162, 'loss_val': 0.3780297963283939, 'psi': 0.9488563285475893}-{'f1_val': 0.7969386307472476, 'auprc': 0.9698333950030391, 'loss_val': 0.5845975917362397, 'psi': 0.8660965364495642}
[S17] START round=16 head_norm_before_train=1.187707 cos_to_last_merge=0.7642 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.764
[S17] round=16 local utility u=0.011200 metrics={'f1_val': 0.35334267881579384, 'auprc': 0.8173971153668472, 'loss_val': 0.9594218510897359, 'psi': 0.5389644534362152}-{'f1_val': 0.35311110186723216, 'auprc': 0.8090958568663482, 'loss_val': 0.9555276379584805, 'psi': 0.5355050038668786}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:33904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] → sending delta(kind=head bytes=1804) to S10@127.0.0.1:33911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:33912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S3] → sending delta(kind=head bytes=1791) to S5@127.0.0.1:33905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S11] → sending delta(kind=head bytes=1790) to S4@127.0.0.1:33904
[S3] sending update (kind=head size=1791 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1804 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1796) from S8
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.096162)
[S4] loaded HEAD from S8 (vec_in norm=1.096162)
[S4] cosine check vs S8: cos=0.7902
[S4] BUFFERED delta from S8 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1791) from S3
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=0.886237)
[S5] loaded HEAD from S3 (vec_in norm=0.886237)
[S5] cosine check vs S3: cos=0.9183
[S5] BUFFERED delta from S3 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1799) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.882875)
[S11] loaded HEAD from S4 (vec_in norm=0.882875)
[S11] cosine check vs S4: cos=0.8106
[S11] BUFFERED delta from S4 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1804) from S6
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.862273)
[S10] loaded HEAD from S6 (vec_in norm=0.862273)
[S10] cosine check vs S6: cos=0.8511
[S10] BUFFERED delta from S6 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:33907
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1790 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1790) from S11
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.040745)
[S4] loaded HEAD from S11 (vec_in norm=1.040745)
[S4] cosine check vs S11: cos=0.8106
[S4] BUFFERED delta from S11 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1800) from S10
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.202472)
[S6] loaded HEAD from S10 (vec_in norm=1.202472)
[S6] cosine check vs S10: cos=0.8511
[S6] BUFFERED delta from S10 (total buffered=1)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=16 metric=0.7006 head_norm=0.792937
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.757328e-01
[S5] stored merged vector for next round verification (round=16)
[S5] DEBUG after merge:  round=16 metric=0.7006 head_norm=0.822314 delta_norm=0.175733
[S5] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=16 metric=0.7019 head_norm=1.040745
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.053877e-01
[S11] stored merged vector for next round verification (round=16)
[S11] DEBUG after merge:  round=16 metric=0.7019 head_norm=0.915450 delta_norm=0.305388
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=16 metric=0.6967 head_norm=0.862273
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.257602e-01
[S6] stored merged vector for next round verification (round=16)
[S6] DEBUG after merge:  round=16 metric=0.6965 head_norm=0.994287 delta_norm=0.325760
[S6] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=16 metric=0.6662 head_norm=0.882875
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.886326e-02
[S4] stored merged vector for next round verification (round=16)
[S4] DEBUG after merge:  round=16 metric=0.6662 head_norm=0.870768 delta_norm=0.058863
[S4] aggregate: ACCEPT kept=['S8', 'S11'] (k=2/2) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=16 metric=0.9936 head_norm=1.202472
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.257601e-01
[S10] stored merged vector for next round verification (round=16)
[S10] DEBUG after merge:  round=16 metric=0.8153 head_norm=0.994287 delta_norm=0.325760
[S10] aggregate: ROLLBACK (f1_val pre=0.994 post=0.815 tol_abs=0.005 tol_rel=0.0)
[S2] START round=17 head_norm_before_train=0.876640 cos_to_last_merge=0.9560 (last merge round=13)
[S2] round=17 local utility u=0.000000 metrics={'f1_val': 0.6925803039851062, 'auprc': 0.7422897162372338, 'loss_val': 0.47550846372222555, 'psi': 0.7124640688859571}-{'f1_val': 0.6983478455883432, 'auprc': 0.7578187551651665, 'loss_val': 0.5210297792222629, 'psi': 0.7221362094190725}
[S3] START round=17 head_norm_before_train=0.886237 cos_to_last_merge=0.9415 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.941
[S3] round=17 local utility u=0.021252 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9988168140987013, 'loss_val': 0.34240424633779964, 'psi': 0.8199353014386814}-{'f1_val': 0.7006809596653347, 'auprc': 0.9984541062179252, 'loss_val': 0.3838199119785031, 'psi': 0.819790218286371}
[S4] START round=17 head_norm_before_train=0.870768 cos_to_last_merge=1.0000 (last merge round=16)
[S4] round=17 local utility u=0.015101 metrics={'f1_val': 0.6637420078556696, 'auprc': 0.6488786109142629, 'loss_val': 0.6069324519524315, 'psi': 0.657796649079107}-{'f1_val': 0.6661546348483345, 'auprc': 0.65025208432339, 'loss_val': 0.6557306676174348, 'psi': 0.6597936146383567}
[S5] START round=17 head_norm_before_train=0.822314 cos_to_last_merge=1.0000 (last merge round=16)
[S5] round=17 local utility u=0.030845 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.7942832602519243, 'loss_val': 0.5352401724809948, 'psi': 0.7380783396983743}-{'f1_val': 0.7005685100046517, 'auprc': 0.7925036218164129, 'loss_val': 0.5913510713708304, 'psi': 0.7373425547293562}
[S6] START round=17 head_norm_before_train=0.994287 cos_to_last_merge=1.0000 (last merge round=16)
[S6] round=17 local utility u=0.000000 metrics={'f1_val': 0.7094009710821428, 'auprc': 0.819350748360125, 'loss_val': 0.47674274013258505, 'psi': 0.7533808819933356}-{'f1_val': 0.6966637167198422, 'auprc': 0.9523671933121945, 'loss_val': 0.4588833810488799, 'psi': 0.7989451073567831}
[S7] START round=17 head_norm_before_train=1.058073 cos_to_last_merge=0.9993 (last merge round=15)
[S7] round=17 local utility u=0.062733 metrics={'f1_val': 0.636929799797439, 'auprc': 0.7815408722588848, 'loss_val': 0.6594132890329333, 'psi': 0.6947742287820173}-{'f1_val': 0.6283224377218741, 'auprc': 0.7731139070254394, 'loss_val': 0.7079535566252675, 'psi': 0.6862390254433002}
[S8] START round=17 head_norm_before_train=1.096162 cos_to_last_merge=0.9822 (last merge round=13)
[S8] round=17 local utility u=0.000000 metrics={'f1_val': 0.7142391053978291, 'auprc': 0.996100630849068, 'loss_val': 0.3162292662675724, 'psi': 0.8269837155783246}-{'f1_val': 0.9591224580679292, 'auprc': 0.9793490283722824, 'loss_val': 0.24767755386413223, 'psi': 0.9672130861896705}
[S9] START round=17 head_norm_before_train=1.700034 (no previous merge yet)
[S9] round=17 local utility u=0.014071 metrics={'f1_val': 0.9945775144926113, 'auprc': 0.998469672234715, 'loss_val': 0.07541521777345227, 'psi': 0.9961343775894529}-{'f1_val': 0.9941535115217267, 'auprc': 0.9984746010048711, 'loss_val': 0.10102732212443778, 'psi': 0.9958819473149845}
[S10] START round=17 head_norm_before_train=0.994287 cos_to_last_merge=1.0000 (last merge round=16)
[S10] round=17 local utility u=0.000000 metrics={'f1_val': 0.873366655760396, 'auprc': 0.9802405956179343, 'loss_val': 0.38748948595913696, 'psi': 0.9161162317034113}-{'f1_val': 0.9936275080584183, 'auprc': 0.996826345266366, 'loss_val': 0.23200389097863197, 'psi': 0.9949070429415974}
[S11] START round=17 head_norm_before_train=0.915450 cos_to_last_merge=1.0000 (last merge round=16)
[S11] round=17 local utility u=0.003760 metrics={'f1_val': 0.7016282822309048, 'auprc': 0.9977132334699077, 'loss_val': 0.3646633520084683, 'psi': 0.820062262726506}-{'f1_val': 0.7019353166316534, 'auprc': 0.9964268282516486, 'loss_val': 0.37016546361352326, 'psi': 0.8197319212796514}
[S13] START round=17 head_norm_before_train=1.636319 (no previous merge yet)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.5983222398585275, 'auprc': 0.6870674515110582, 'loss_val': 0.8004422534856728, 'psi': 0.6338203245195397}-{'f1_val': 0.6903092447868512, 'auprc': 0.6644968880117438, 'loss_val': 0.45755033657866606, 'psi': 0.6799843020768082}
[S14] START round=17 head_norm_before_train=1.621549 cos_to_last_merge=0.9998 (last merge round=15)
[S14] round=17 local utility u=0.000000 metrics={'f1_val': 0.9850298187982903, 'auprc': 0.9969508358386117, 'loss_val': 0.09529600996962731, 'psi': 0.9897982256144189}-{'f1_val': 0.9976511180498535, 'auprc': 0.9986082016592575, 'loss_val': 0.08680925220567874, 'psi': 0.9980339514936152}
[S15] START round=17 head_norm_before_train=1.343705 cos_to_last_merge=0.8196 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.820
[S15] round=17 local utility u=0.038178 metrics={'f1_val': 0.695324683423072, 'auprc': 0.8416507641921304, 'loss_val': 0.34449158914025174, 'psi': 0.7538551157306954}-{'f1_val': 0.6980402818399263, 'auprc': 0.8228022427488453, 'loss_val': 0.38059608147874463, 'psi': 0.7479450662034939}
[S16] START round=17 head_norm_before_train=1.339214 cos_to_last_merge=0.8122 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.812
[S16] round=17 local utility u=0.135813 metrics={'f1_val': 0.9435193973118097, 'auprc': 0.9899057174781218, 'loss_val': 0.23768427674812112, 'psi': 0.9620739253783346}-{'f1_val': 0.9220875519605712, 'auprc': 0.9890094934281162, 'loss_val': 0.3780297963283939, 'psi': 0.9488563285475893}
[S17] START round=17 head_norm_before_train=1.200750 cos_to_last_merge=0.7583 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.758
[S17] round=17 local utility u=0.000000 metrics={'f1_val': 0.3496813947537838, 'auprc': 0.8204708147152502, 'loss_val': 1.0011900428964877, 'psi': 0.5379971627383704}-{'f1_val': 0.35334267881579384, 'auprc': 0.8173971153668472, 'loss_val': 0.9594218510897359, 'psi': 0.5389644534362152}
[S4]  timeout peer S2
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S4
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S3]  timeout peer S4
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S16
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S11
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:33914
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:33912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:33903
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S15] sending update (kind=head size=1791 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:33911
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S3] → sending delta(kind=head bytes=1791) to S5@127.0.0.1:33905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:33904
[S5] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1798) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.933273)
[S11] loaded HEAD from S4 (vec_in norm=0.933273)
[S11] cosine check vs S4: cos=0.9407
[S11] BUFFERED delta from S4 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1798) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.876720)
[S3] loaded HEAD from S5 (vec_in norm=0.876720)
[S3] cosine check vs S5: cos=0.9570
[S3] BUFFERED delta from S5 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1798) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.083531)
[S14] loaded HEAD from S7 (vec_in norm=1.083531)
[S14] cosine check vs S7: cos=0.9287
[S14] BUFFERED delta from S7 (total buffered=1)
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1795) from S9
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.725756)
[S10] loaded HEAD from S9 (vec_in norm=1.725756)
[S10] cosine check vs S9: cos=-0.0851
[S10] DROPPED delta from S9 (cos=-0.0851 < 0.0)
[S11] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1791 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1798) from S11
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.970700)
[S4] loaded HEAD from S11 (vec_in norm=0.970700)
[S4] cosine check vs S11: cos=0.9407
[S4] BUFFERED delta from S11 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1791) from S3
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=0.947003)
[S5] loaded HEAD from S3 (vec_in norm=0.947003)
[S5] cosine check vs S3: cos=0.9570
[S5] BUFFERED delta from S3 (total buffered=1)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=17 metric=0.7016 head_norm=0.970700
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.649202e-01
[S11] stored merged vector for next round verification (round=17)
[S11] DEBUG after merge:  round=17 metric=0.7016 head_norm=0.937779 delta_norm=0.164920
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=17 metric=0.7006 head_norm=0.876720
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.381306e-01
[S5] stored merged vector for next round verification (round=17)
[S5] DEBUG after merge:  round=17 metric=0.7003 head_norm=0.902024 delta_norm=0.138131
[S5] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=17 metric=0.7007 head_norm=0.947003
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.381306e-01
[S3] stored merged vector for next round verification (round=17)
[S3] DEBUG after merge:  round=17 metric=0.7007 head_norm=0.902024 delta_norm=0.138131
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=17 metric=0.6637 head_norm=0.933273
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.649202e-01
[S4] stored merged vector for next round verification (round=17)
[S4] DEBUG after merge:  round=17 metric=0.6637 head_norm=0.937779 delta_norm=0.164920
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S6] CommDone barrier timeout: have=2 need=3 — continuing
[S2] START round=18 head_norm_before_train=0.935159 cos_to_last_merge=0.9389 (last merge round=13)
[S2] ⚠️ Model drifted since last merge! cos=0.939
[S2] round=18 local utility u=0.130184 metrics={'f1_val': 0.6989914618448265, 'auprc': 0.7922242674074778, 'loss_val': 0.40341016879517916, 'psi': 0.7362845840698871}-{'f1_val': 0.6925803039851062, 'auprc': 0.7422897162372338, 'loss_val': 0.47550846372222555, 'psi': 0.7124640688859571}
[S3] START round=18 head_norm_before_train=0.902024 cos_to_last_merge=1.0000 (last merge round=17)
[S3] round=18 local utility u=0.007330 metrics={'f1_val': 0.7003512381127298, 'auprc': 0.9984191080977225, 'loss_val': 0.32457346662246195, 'psi': 0.819578386106727}-{'f1_val': 0.7006809596653347, 'auprc': 0.9988168140987013, 'loss_val': 0.34240424633779964, 'psi': 0.8199353014386814}
[S4] START round=18 head_norm_before_train=0.937779 cos_to_last_merge=1.0000 (last merge round=17)
[S4] round=18 local utility u=0.027335 metrics={'f1_val': 0.6640428467466034, 'auprc': 0.6494381722829359, 'loss_val': 0.5557470945380746, 'psi': 0.6582009769611363}-{'f1_val': 0.6637420078556696, 'auprc': 0.6488786109142629, 'loss_val': 0.6069324519524315, 'psi': 0.657796649079107}
[S5] START round=18 head_norm_before_train=0.902024 cos_to_last_merge=1.0000 (last merge round=17)
[S5] round=18 local utility u=0.000000 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.6692889038699741, 'loss_val': 0.49091616758599804, 'psi': 0.6880805971455942}-{'f1_val': 0.7006083926626743, 'auprc': 0.7942832602519243, 'loss_val': 0.5352401724809948, 'psi': 0.7380783396983743}
[S6] START round=18 head_norm_before_train=1.032777 cos_to_last_merge=0.9989 (last merge round=16)
[S6] round=18 local utility u=0.046758 metrics={'f1_val': 0.7096297411763188, 'auprc': 0.837895178146728, 'loss_val': 0.44023261376097983, 'psi': 0.7609359159644825}-{'f1_val': 0.7094009710821428, 'auprc': 0.819350748360125, 'loss_val': 0.47674274013258505, 'psi': 0.7533808819933356}
[S7] START round=18 head_norm_before_train=1.083531 cos_to_last_merge=0.9972 (last merge round=15)
[S7] round=18 local utility u=0.000000 metrics={'f1_val': 0.6069979831418053, 'auprc': 0.7991066327150594, 'loss_val': 0.6936593305196416, 'psi': 0.683841442971107}-{'f1_val': 0.636929799797439, 'auprc': 0.7815408722588848, 'loss_val': 0.6594132890329333, 'psi': 0.6947742287820173}
[S8] START round=18 head_norm_before_train=1.134106 cos_to_last_merge=0.9766 (last merge round=13)
[S8] round=18 local utility u=0.921436 metrics={'f1_val': 0.995226424156427, 'auprc': 0.998480803420899, 'loss_val': 0.16642232016790787, 'psi': 0.9965281758622158}-{'f1_val': 0.7142391053978291, 'auprc': 0.996100630849068, 'loss_val': 0.3162292662675724, 'psi': 0.8269837155783246}
[S9] START round=18 head_norm_before_train=1.725756 (no previous merge yet)
[S9] round=18 local utility u=0.006298 metrics={'f1_val': 0.9937421749897083, 'auprc': 0.9984696080088612, 'loss_val': 0.057806431299057146, 'psi': 0.9956331481973695}-{'f1_val': 0.9945775144926113, 'auprc': 0.998469672234715, 'loss_val': 0.07541521777345227, 'psi': 0.9961343775894529}
[S10] START round=18 head_norm_before_train=1.038294 cos_to_last_merge=0.9982 (last merge round=16)
[S10] round=18 local utility u=0.461838 metrics={'f1_val': 0.9929423654360823, 'auprc': 0.9959614161942988, 'loss_val': 0.22843098785146146, 'psi': 0.994149985739369}-{'f1_val': 0.873366655760396, 'auprc': 0.9802405956179343, 'loss_val': 0.38748948595913696, 'psi': 0.9161162317034113}
[S11] START round=18 head_norm_before_train=0.937779 cos_to_last_merge=1.0000 (last merge round=17)
[S11] round=18 local utility u=0.680833 metrics={'f1_val': 0.9240609834559511, 'auprc': 0.9978747622745112, 'loss_val': 0.33807897660824027, 'psi': 0.9535864949833751}-{'f1_val': 0.7016282822309048, 'auprc': 0.9977132334699077, 'loss_val': 0.3646633520084683, 'psi': 0.820062262726506}
[S13] START round=18 head_norm_before_train=1.651299 (no previous merge yet)
[S13] round=18 local utility u=0.177426 metrics={'f1_val': 0.6298508911806054, 'auprc': 0.6784799010492321, 'loss_val': 0.608999897276647, 'psi': 0.6493024951280562}-{'f1_val': 0.5983222398585275, 'auprc': 0.6870674515110582, 'loss_val': 0.8004422534856728, 'psi': 0.6338203245195397}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=18 head_norm_before_train=1.655090 cos_to_last_merge=0.9993 (last merge round=15)
[S14] round=18 local utility u=0.047740 metrics={'f1_val': 0.9954582674525667, 'auprc': 0.9969162850916263, 'loss_val': 0.06228369913349924, 'psi': 0.9960414745081906}-{'f1_val': 0.9850298187982903, 'auprc': 0.9969508358386117, 'loss_val': 0.09529600996962731, 'psi': 0.9897982256144189}
[S15] START round=18 head_norm_before_train=1.381009 cos_to_last_merge=0.8087 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.809
[S15] round=18 local utility u=0.874022 metrics={'f1_val': 0.8884546232978063, 'auprc': 0.9881257594655768, 'loss_val': 0.19465199932762234, 'psi': 0.9283230777649145}-{'f1_val': 0.695324683423072, 'auprc': 0.8416507641921304, 'loss_val': 0.34449158914025174, 'psi': 0.7538551157306954}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=18 head_norm_before_train=1.384224 cos_to_last_merge=0.8043 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.804
[S16] round=18 local utility u=0.000000 metrics={'f1_val': 0.9403314094795661, 'auprc': 0.9917338518145336, 'loss_val': 0.2479628425218219, 'psi': 0.960892386413553}-{'f1_val': 0.9435193973118097, 'auprc': 0.9899057174781218, 'loss_val': 0.23768427674812112, 'psi': 0.9620739253783346}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=18 head_norm_before_train=1.210122 cos_to_last_merge=0.7537 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.754
[S17] round=18 local utility u=0.000000 metrics={'f1_val': 0.34089850776435776, 'auprc': 0.8095545511927453, 'loss_val': 1.0996217544958522, 'psi': 0.5283609251357129}-{'f1_val': 0.3496813947537838, 'auprc': 0.8204708147152502, 'loss_val': 1.0011900428964877, 'psi': 0.5379971627383704}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] → sending delta(kind=head bytes=1792) to S4@127.0.0.1:33904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:33911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:33908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S3] sending update (kind=head size=1789 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1792 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:33907
[S10] RECEIVED delta(kind=head bytes=1796) from S9
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.749815)
[S10] loaded HEAD from S9 (vec_in norm=1.749815)
[S10] cosine check vs S9: cos=-0.0877
[S10] DROPPED delta from S9 (cos=-0.0877 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1798) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.685219)
[S7] loaded HEAD from S14 (vec_in norm=1.685219)
[S7] cosine check vs S14: cos=0.9261
[S7] BUFFERED delta from S14 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1792) from S11
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.990751)
[S4] loaded HEAD from S11 (vec_in norm=0.990751)
[S4] cosine check vs S11: cos=0.9961
[S4] BUFFERED delta from S11 (total buffered=1)
[S10] sending update (kind=head size=1803 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=18 metric=0.9955 head_norm=1.685219
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.967769e-01
[S14] stored merged vector for next round verification (round=18)
[S14] DEBUG after merge:  round=18 metric=0.9955 head_norm=1.359989 delta_norm=0.396777
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:33909
[S6] RECEIVED delta(kind=head bytes=1803) from S10
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.085388)
[S6] loaded HEAD from S10 (vec_in norm=1.085388)
[S6] cosine check vs S10: cos=0.9891
[S6] BUFFERED delta from S10 (total buffered=1)
[S4] sending update (kind=head size=1795 to 1 peers)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=18 metric=0.6070 head_norm=1.105274
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.910260e-01
[S7] stored merged vector for next round verification (round=18)
[S7] DEBUG after merge:  round=18 metric=0.5912 head_norm=1.370364 delta_norm=0.391026
[S7] aggregate: ROLLBACK (f1_val pre=0.607 post=0.591 tol_abs=0.005 tol_rel=0.0)
[S8] RECEIVED delta(kind=head bytes=1795) from S4
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.000098)
[S8] loaded HEAD from S4 (vec_in norm=1.000098)
[S8] cosine check vs S4: cos=0.6465
[S8] BUFFERED delta from S4 (total buffered=1)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=18 metric=0.6640 head_norm=1.000098
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.432549e-02
[S4] stored merged vector for next round verification (round=18)
[S4] DEBUG after merge:  round=18 metric=0.6640 head_norm=0.994448 delta_norm=0.044325
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=18 metric=0.9952 head_norm=1.164096
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.609717e-01
[S8] stored merged vector for next round verification (round=18)
[S8] DEBUG after merge:  round=18 metric=0.9947 head_norm=0.982427 delta_norm=0.460972
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S7]  timeout peer S14
[S5]  timeout peer S6
[S10]  timeout peer S9
[S3]  timeout peer S2
[S3]  timeout peer S5
[S4]  timeout peer S3
[S4]  timeout peer S11
[S2]  timeout peer S7
[S2]  timeout peer S8
[S6]  timeout peer S10
[S6]  timeout peer S13
[S6]  timeout peer S16
[S8]  timeout peer S4
[S8]  timeout peer S15
[S8]  timeout peer S17
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:33905
[S6] sending update (kind=head size=1804 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1804) from S6
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.065308)
[S5] loaded HEAD from S6 (vec_in norm=1.065308)
[S5] cosine check vs S6: cos=0.4144
[S5] BUFFERED delta from S6 (total buffered=1)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=18 metric=0.7096 head_norm=1.065308
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.015341e-02
[S6] stored merged vector for next round verification (round=18)
[S6] DEBUG after merge:  round=18 metric=0.7096 head_norm=1.072403 delta_norm=0.080153
[S6] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=0.988699 cos_to_last_merge=0.9245 (last merge round=13)
[S2] ⚠️ Model drifted since last merge! cos=0.925
[S2] round=19 local utility u=0.018012 metrics={'f1_val': 0.6995324772707143, 'auprc': 0.7915066359763994, 'loss_val': 0.3684790795689262, 'psi': 0.7363221407529883}-{'f1_val': 0.6989914618448265, 'auprc': 0.7922242674074778, 'loss_val': 0.40341016879517916, 'psi': 0.7362845840698871}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] sending update (kind=head size=1794 to 1 peers)
[S2] r=20 psi=0.736 u=0.0180 p_local=0.0866 f1=0.700 auprc=0.792 bytes=21551
[S3] START round=19 head_norm_before_train=0.955744 cos_to_last_merge=0.9992 (last merge round=17)
[S3] round=19 local utility u=0.013907 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9987724452583334, 'loss_val': 0.2997985161485791, 'psi': 0.8199175539025343}-{'f1_val': 0.7003512381127298, 'auprc': 0.9984191080977225, 'loss_val': 0.32457346662246195, 'psi': 0.819578386106727}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S3] r=20 psi=0.820 u=0.0139 p_local=0.1361 f1=0.701 auprc=0.999 bytes=28718
[S4] START round=19 head_norm_before_train=0.994448 cos_to_last_merge=1.0000 (last merge round=18)
[S4] round=19 local utility u=0.310012 metrics={'f1_val': 0.6650703864433725, 'auprc': 0.8474704242103761, 'loss_val': 0.5359841646507031, 'psi': 0.738030401550174}-{'f1_val': 0.6640428467466034, 'auprc': 0.6494381722829359, 'loss_val': 0.5557470945380746, 'psi': 0.6582009769611363}
[S5] START round=19 head_norm_before_train=0.944915 cos_to_last_merge=0.9965 (last merge round=17)
[S5] round=19 local utility u=0.221132 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.7936320202656062, 'loss_val': 0.4216811154684157, 'psi': 0.7378178437038471}-{'f1_val': 0.7006083926626743, 'auprc': 0.6692889038699741, 'loss_val': 0.49091616758599804, 'psi': 0.6880805971455942}
[S6] START round=19 head_norm_before_train=1.072403 cos_to_last_merge=1.0000 (last merge round=18)
[S6] round=19 local utility u=0.000000 metrics={'f1_val': 0.6845796731709797, 'auprc': 0.8042970275169293, 'loss_val': 0.4678081518851266, 'psi': 0.7324666149093595}-{'f1_val': 0.7096297411763188, 'auprc': 0.837895178146728, 'loss_val': 0.44023261376097983, 'psi': 0.7609359159644825}
[S7] START round=19 head_norm_before_train=1.370364 cos_to_last_merge=1.0000 (last merge round=18)
[S7] round=19 local utility u=0.000000 metrics={'f1_val': 0.5491212009937494, 'auprc': 0.7827995306232338, 'loss_val': 0.8366823216977013, 'psi': 0.6425925328455431}-{'f1_val': 0.6069979831418053, 'auprc': 0.7991066327150594, 'loss_val': 0.6936593305196416, 'psi': 0.683841442971107}
[S8] START round=19 head_norm_before_train=0.982427 cos_to_last_merge=1.0000 (last merge round=18)
[S8] round=19 local utility u=0.000000 metrics={'f1_val': 0.9949900941145562, 'auprc': 0.9980844551146233, 'loss_val': 0.25539447758007766, 'psi': 0.9962278385145831}-{'f1_val': 0.995226424156427, 'auprc': 0.998480803420899, 'loss_val': 0.16642232016790787, 'psi': 0.9965281758622158}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=20 psi=0.996 u=0.0000 p_local=0.3316 f1=0.995 auprc=0.998 bytes=25189
[S9] START round=19 head_norm_before_train=1.749815 (no previous merge yet)
[S9] round=19 local utility u=0.009467 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9945625295349935, 'loss_val': 0.047316493970470476, 'psi': 0.9960867593212831}-{'f1_val': 0.9937421749897083, 'auprc': 0.9984696080088612, 'loss_val': 0.057806431299057146, 'psi': 0.9956331481973695}
[S10] START round=19 head_norm_before_train=1.085388 cos_to_last_merge=0.9933 (last merge round=16)
[S10] round=19 local utility u=0.022002 metrics={'f1_val': 0.9922455594808727, 'auprc': 0.9968892499483619, 'loss_val': 0.18302887542826968, 'psi': 0.9941030356678684}-{'f1_val': 0.9929423654360823, 'auprc': 0.9959614161942988, 'loss_val': 0.22843098785146146, 'psi': 0.994149985739369}
[S11] START round=19 head_norm_before_train=0.990751 cos_to_last_merge=0.9984 (last merge round=17)
[S11] round=19 local utility u=0.128397 metrics={'f1_val': 0.9585332523536179, 'auprc': 0.9980053360543603, 'loss_val': 0.2885112804977046, 'psi': 0.9743220858339148}-{'f1_val': 0.9240609834559511, 'auprc': 0.9978747622745112, 'loss_val': 0.33807897660824027, 'psi': 0.9535864949833751}
[S13] START round=19 head_norm_before_train=1.660096 (no previous merge yet)
[S13] round=19 local utility u=0.000000 metrics={'f1_val': 0.5747014770818782, 'auprc': 0.6866295393112146, 'loss_val': 0.7590966674058769, 'psi': 0.6194727019736128}-{'f1_val': 0.6298508911806054, 'auprc': 0.6784799010492321, 'loss_val': 0.608999897276647, 'psi': 0.6493024951280562}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=20 psi=0.619 u=0.0000 p_local=0.1250 f1=0.575 auprc=0.687 bytes=14370
[S14] START round=19 head_norm_before_train=1.359989 cos_to_last_merge=1.0000 (last merge round=18)
[S14] round=19 local utility u=0.000000 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9989524332805214, 'loss_val': 0.10688583928805873, 'psi': 0.9980275698729055}-{'f1_val': 0.9954582674525667, 'auprc': 0.9969162850916263, 'loss_val': 0.06228369913349924, 'psi': 0.9960414745081906}
[S15] START round=19 head_norm_before_train=1.417706 cos_to_last_merge=0.7968 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.797
[S15] round=19 local utility u=0.000000 metrics={'f1_val': 0.6966857460693712, 'auprc': 0.8224670698927249, 'loss_val': 0.43972042627971114, 'psi': 0.7469982755987127}-{'f1_val': 0.8884546232978063, 'auprc': 0.9881257594655768, 'loss_val': 0.19465199932762234, 'psi': 0.9283230777649145}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=20 psi=0.747 u=0.0000 p_local=0.2093 f1=0.697 auprc=0.822 bytes=25149
[S16] START round=19 head_norm_before_train=1.427824 cos_to_last_merge=0.7982 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.798
[S16] round=19 local utility u=0.016642 metrics={'f1_val': 0.9407307181392052, 'auprc': 0.9916519199605555, 'loss_val': 0.21682902883580668, 'psi': 0.9610991988677453}-{'f1_val': 0.9403314094795661, 'auprc': 0.9917338518145336, 'loss_val': 0.2479628425218219, 'psi': 0.960892386413553}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] sending update (kind=head size=1794 to 1 peers)
[S16] r=20 psi=0.961 u=0.0166 p_local=0.2163 f1=0.941 auprc=0.992 bytes=25138
[S17] START round=19 head_norm_before_train=1.223117 cos_to_last_merge=0.7482 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.748
[S17] round=19 local utility u=0.166413 metrics={'f1_val': 0.3989512340769273, 'auprc': 0.8206534607653467, 'loss_val': 1.1484078743676303, 'psi': 0.5676321247522951}-{'f1_val': 0.34089850776435776, 'auprc': 0.8095545511927453, 'loss_val': 1.0996217544958522, 'psi': 0.5283609251357129}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S17] sending update (kind=head size=1788 to 1 peers)
[S17] r=20 psi=0.568 u=0.1664 p_local=0.0881 f1=0.399 auprc=0.821 bytes=16160
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:33911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:33904
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:33903
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1801 to 1 peers)
[S7] r=20 psi=0.643 u=0.0000 p_local=0.1047 f1=0.549 auprc=0.783 bytes=19783
[S11] sending update (kind=head size=1796 to 1 peers)
[S14] r=20 psi=0.998 u=0.0000 p_local=0.0753 f1=0.997 auprc=0.999 bytes=23382
[S9] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1793 to 1 peers)
[S6] r=20 psi=0.732 u=0.0000 p_local=0.1868 f1=0.685 auprc=0.804 bytes=21591
[S10] RECEIVED delta(kind=head bytes=1798) from S9
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.773909)
[S10] loaded HEAD from S9 (vec_in norm=1.773909)
[S10] cosine check vs S9: cos=-0.0886
[S10] DROPPED delta from S9 (cos=-0.0886 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1793) from S4
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.043888)
[S8] loaded HEAD from S4 (vec_in norm=1.043888)
[S8] cosine check vs S4: cos=0.8775
[S8] BUFFERED delta from S4 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1796) from S11
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.051584)
[S4] loaded HEAD from S11 (vec_in norm=1.051584)
[S4] cosine check vs S11: cos=0.9918
[S4] BUFFERED delta from S11 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1801) from S10
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.137216)
[S6] loaded HEAD from S10 (vec_in norm=1.137216)
[S6] cosine check vs S10: cos=0.9904
[S6] BUFFERED delta from S10 (total buffered=1)
[S11] r=20 psi=0.974 u=0.1284 p_local=0.2312 f1=0.959 auprc=0.998 bytes=28724
[S10] r=20 psi=0.994 u=0.0220 p_local=0.2469 f1=0.992 auprc=0.997 bytes=30566
[S9] r=20 psi=0.996 u=0.0095 p_local=0.1210 f1=0.997 auprc=0.995 bytes=30546
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=19 metric=0.6651 head_norm=1.043888
[S4] _apply_head_vector_avg (torch): Δ‖w‖=6.739470e-02
[S4] stored merged vector for next round verification (round=19)
[S4] DEBUG after merge:  round=19 metric=0.6654 head_norm=1.045573 delta_norm=0.067395
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S4] r=20 psi=0.738 u=0.3100 p_local=0.1357 f1=0.665 auprc=0.847 bytes=28745
[S5] sending update (kind=head size=1804 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1804) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.988133)
[S3] loaded HEAD from S5 (vec_in norm=0.988133)
[S3] cosine check vs S5: cos=0.9852
[S3] BUFFERED delta from S5 (total buffered=1)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=19 metric=0.7006 head_norm=0.988133
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.523891e-01
[S5] stored merged vector for next round verification (round=19)
[S5] DEBUG after merge:  round=19 metric=0.7006 head_norm=0.866320 delta_norm=0.552389
[S5] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S5] r=20 psi=0.738 u=0.2211 p_local=0.1402 f1=0.701 auprc=0.794 bytes=23398
[S2] START round=20 head_norm_before_train=1.036344 cos_to_last_merge=0.9124 (last merge round=13)
[S2] ⚠️ Model drifted since last merge! cos=0.912
[S2] round=20 local utility u=0.000000 metrics={'f1_val': 0.6990717968887176, 'auprc': 0.6606599198868578, 'loss_val': 0.34022921492636954, 'psi': 0.6837070460879736}-{'f1_val': 0.6995324772707143, 'auprc': 0.7915066359763994, 'loss_val': 0.3684790795689262, 'psi': 0.7363221407529883}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=20 head_norm_before_train=1.003432 cos_to_last_merge=0.9975 (last merge round=17)
[S3] round=20 local utility u=0.011357 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.9984006785491357, 'loss_val': 0.2755199187195186, 'psi': 0.8197238729197777}-{'f1_val': 0.7006809596653347, 'auprc': 0.9987724452583334, 'loss_val': 0.2997985161485791, 'psi': 0.8199175539025343}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=20 metric=0.7006 head_norm=1.044677
[S3] _apply_head_vector_avg (torch): Δ‖w‖=9.905358e-02
[S3] stored merged vector for next round verification (round=20)
[S3] DEBUG after merge:  round=20 metric=0.7006 head_norm=1.011962 delta_norm=0.099054
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S4] START round=20 head_norm_before_train=1.045573 cos_to_last_merge=1.0000 (last merge round=19)
[S4] round=20 local utility u=0.006030 metrics={'f1_val': 0.6651989497964285, 'auprc': 0.8464279027093252, 'loss_val': 0.5215679904159976, 'psi': 0.7376905309615871}-{'f1_val': 0.6650703864433725, 'auprc': 0.8474704242103761, 'loss_val': 0.5359841646507031, 'psi': 0.738030401550174}
[S5] START round=20 head_norm_before_train=0.866320 cos_to_last_merge=1.0000 (last merge round=19)
[S5] round=20 local utility u=0.011117 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.8086090910553708, 'loss_val': 0.4443777196532981, 'psi': 0.743808672019753}-{'f1_val': 0.7006083926626743, 'auprc': 0.7936320202656062, 'loss_val': 0.4216811154684157, 'psi': 0.7378178437038471}
[S6] START round=20 head_norm_before_train=1.108751 cos_to_last_merge=0.9991 (last merge round=18)
[S6] round=20 local utility u=1.000000 metrics={'f1_val': 0.9629383334060586, 'auprc': 0.9640356424073641, 'loss_val': 0.28475267302185386, 'psi': 0.9633772570065808}-{'f1_val': 0.6845796731709797, 'auprc': 0.8042970275169293, 'loss_val': 0.4678081518851266, 'psi': 0.7324666149093595}
[S7] START round=20 head_norm_before_train=1.391710 cos_to_last_merge=0.9998 (last merge round=18)
[S7] round=20 local utility u=0.645742 metrics={'f1_val': 0.676167641152088, 'auprc': 0.8369113481284591, 'loss_val': 0.46981291187965285, 'psi': 0.7404651239426365}-{'f1_val': 0.5491212009937494, 'auprc': 0.7827995306232338, 'loss_val': 0.8366823216977013, 'psi': 0.6425925328455431}
[S8] START round=20 head_norm_before_train=1.012530 cos_to_last_merge=0.9996 (last merge round=18)
[S8] round=20 local utility u=0.023390 metrics={'f1_val': 0.9941297705717227, 'auprc': 0.9988383637390061, 'loss_val': 0.20571356998311854, 'psi': 0.9960132078386361}-{'f1_val': 0.9949900941145562, 'auprc': 0.9980844551146233, 'loss_val': 0.25539447758007766, 'psi': 0.9962278385145831}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=20 metric=0.9941 head_norm=1.043746
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.666388e-01
[S8] stored merged vector for next round verification (round=20)
[S8] DEBUG after merge:  round=20 metric=0.9934 head_norm=1.009186 delta_norm=0.266639
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S9] START round=20 head_norm_before_train=1.773909 (no previous merge yet)
[S9] round=20 local utility u=0.000000 metrics={'f1_val': 0.9933536184876286, 'auprc': 0.9984720064666364, 'loss_val': 0.04142710039534758, 'psi': 0.9954009736792316}-{'f1_val': 0.9971029125121428, 'auprc': 0.9945625295349935, 'loss_val': 0.047316493970470476, 'psi': 0.9960867593212831}
[S10] START round=20 head_norm_before_train=1.137216 cos_to_last_merge=0.9867 (last merge round=16)
[S10] round=20 local utility u=0.015767 metrics={'f1_val': 0.9931146301877279, 'auprc': 0.9963815994704814, 'loss_val': 0.15518588181177148, 'psi': 0.9944214179008293}-{'f1_val': 0.9922455594808727, 'auprc': 0.9968892499483619, 'loss_val': 0.18302887542826968, 'psi': 0.9941030356678684}
[S11] START round=20 head_norm_before_train=1.051584 cos_to_last_merge=0.9936 (last merge round=17)
[S11] round=20 local utility u=0.068912 metrics={'f1_val': 0.9760528968299534, 'auprc': 0.9975216511785365, 'loss_val': 0.2543533456111739, 'psi': 0.9846403985693868}-{'f1_val': 0.9585332523536179, 'auprc': 0.9980053360543603, 'loss_val': 0.2885112804977046, 'psi': 0.9743220858339148}
[S13] START round=20 head_norm_before_train=1.671032 (no previous merge yet)
[S13] round=20 local utility u=0.304389 metrics={'f1_val': 0.6450361579930113, 'auprc': 0.6801163612406657, 'loss_val': 0.5527867120331458, 'psi': 0.659068239292073}-{'f1_val': 0.5747014770818782, 'auprc': 0.6866295393112146, 'loss_val': 0.7590966674058769, 'psi': 0.6194727019736128}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=20 head_norm_before_train=1.394549 cos_to_last_merge=0.9997 (last merge round=18)
[S14] round=20 local utility u=0.007899 metrics={'f1_val': 0.9968419739193168, 'auprc': 0.9969586481392576, 'loss_val': 0.08169146352292041, 'psi': 0.9968886436072932}-{'f1_val': 0.9974109942678281, 'auprc': 0.9989524332805214, 'loss_val': 0.10688583928805873, 'psi': 0.9980275698729055}
[S15] START round=20 head_norm_before_train=1.454624 cos_to_last_merge=0.7863 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.786
[S15] round=20 local utility u=1.000000 metrics={'f1_val': 0.9886276374326257, 'auprc': 0.9901686203414732, 'loss_val': 0.1149690448353345, 'psi': 0.9892440305961647}-{'f1_val': 0.6966857460693712, 'auprc': 0.8224670698927249, 'loss_val': 0.43972042627971114, 'psi': 0.7469982755987127}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=20 head_norm_before_train=1.469864 cos_to_last_merge=0.7926 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.793
[S16] round=20 local utility u=0.030576 metrics={'f1_val': 0.9435966282934487, 'auprc': 0.992448008112434, 'loss_val': 0.1752616765173712, 'psi': 0.9631371802210429}-{'f1_val': 0.9407307181392052, 'auprc': 0.9916519199605555, 'loss_val': 0.21682902883580668, 'psi': 0.9610991988677453}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S16] sending update (kind=head size=1791 to 1 peers)
[S17] START round=20 head_norm_before_train=1.235811 cos_to_last_merge=0.7428 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.743
[S17] round=20 local utility u=0.000000 metrics={'f1_val': 0.33870967741935487, 'auprc': 0.8213997031132463, 'loss_val': 1.1338417469658069, 'psi': 0.5317856876969115}-{'f1_val': 0.3989512340769273, 'auprc': 0.8206534607653467, 'loss_val': 1.1484078743676303, 'psi': 0.5676321247522951}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:33905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:33907
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:33903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] → sending delta(kind=head bytes=1792) to S4@127.0.0.1:33904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:33908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:33902
[S14] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S9] ⇄ pheromone p=0.097 → S10@127.0.0.1:33911
[S10] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1792 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1803) from S10
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.181909)
[S6] loaded HEAD from S10 (vec_in norm=1.181909)
[S6] cosine check vs S10: cos=0.9822
[S6] BUFFERED delta from S10 (total buffered=2)
[S3] RECEIVED delta(kind=head bytes=1799) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.911496)
[S3] loaded HEAD from S5 (vec_in norm=0.911496)
[S3] cosine check vs S5: cos=0.8204
[S3] BUFFERED delta from S5 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1792) from S11
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.099422)
[S4] loaded HEAD from S11 (vec_in norm=1.099422)
[S4] cosine check vs S11: cos=0.9921
[S4] BUFFERED delta from S11 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1801) from S6
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.139364)
[S5] loaded HEAD from S6 (vec_in norm=1.139364)
[S5] cosine check vs S6: cos=0.8302
[S5] BUFFERED delta from S6 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1798) from S4
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.092443)
[S8] loaded HEAD from S4 (vec_in norm=1.092443)
[S8] cosine check vs S4: cos=0.9618
[S8] BUFFERED delta from S4 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1795) from S7
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.410670)
[S2] loaded HEAD from S7 (vec_in norm=1.410670)
[S2] cosine check vs S7: cos=0.6684
[S2] BUFFERED delta from S7 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1797) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.438384)
[S7] loaded HEAD from S14 (vec_in norm=1.438384)
[S7] cosine check vs S14: cos=0.9973
[S7] BUFFERED delta from S14 (total buffered=1)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=20 metric=0.7006 head_norm=0.911496
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.180258e-01
[S5] stored merged vector for next round verification (round=20)
[S5] DEBUG after merge:  round=20 metric=0.7004 head_norm=0.981503 delta_norm=0.318026
[S5] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.114 → S3@127.0.0.1:33903
[S11] ⇄ pheromone p=0.199 → S4@127.0.0.1:33904
[S10] ⇄ pheromone p=0.201 → S6@127.0.0.1:33907
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=20 metric=0.6762 head_norm=1.410670
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.394261e-02
[S7] stored merged vector for next round verification (round=20)
[S7] DEBUG after merge:  round=20 metric=0.6770 head_norm=1.423573 delta_norm=0.053943
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.213 → S2@127.0.0.1:33902
[S14] ⇄ pheromone p=0.062 → S7@127.0.0.1:33908
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=20 metric=0.6652 head_norm=1.092443
[S4] _apply_head_vector_avg (torch): Δ‖w‖=6.910296e-02
[S4] stored merged vector for next round verification (round=20)
[S4] DEBUG after merge:  round=20 metric=0.6655 head_norm=1.093757 delta_norm=0.069103
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.110 → S8@127.0.0.1:33909
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=20 metric=0.9629 head_norm=1.139364
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.007894e-01
[S6] stored merged vector for next round verification (round=20)
[S6] DEBUG after merge:  round=20 metric=0.9628 head_norm=1.144971 delta_norm=0.100789
[S6] aggregate: ACCEPT kept=['S10', 'S10'] (k=2/2) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.349 → S5@127.0.0.1:33905
[S2] START round=21 head_norm_before_train=1.077991 cos_to_last_merge=0.9019 (last merge round=13)
[S2] ⚠️ Model drifted since last merge! cos=0.902
[S2] round=21 local utility u=0.000000 metrics={'f1_val': 0.6423370160781032, 'auprc': 0.6525978386578575, 'loss_val': 0.5633510526436126, 'psi': 0.646441345110005}-{'f1_val': 0.6990717968887176, 'auprc': 0.6606599198868578, 'loss_val': 0.34022921492636954, 'psi': 0.6837070460879736}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=21 metric=0.6423 head_norm=1.112234
[S2] _apply_head_vector_avg (torch): Δ‖w‖=5.323651e-01
[S2] stored merged vector for next round verification (round=21)
[S2] DEBUG after merge:  round=21 metric=0.6180 head_norm=1.153306 delta_norm=0.532365
[S2] aggregate: ROLLBACK (f1_val pre=0.642 post=0.618 tol_abs=0.005 tol_rel=0.0)
[S3] START round=21 head_norm_before_train=1.011962 cos_to_last_merge=1.0000 (last merge round=20)
[S3] round=21 local utility u=0.000000 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.9994905757939376, 'loss_val': 0.29148973851434734, 'psi': 0.8202952713328615}-{'f1_val': 0.7006060025002057, 'auprc': 0.9984006785491357, 'loss_val': 0.2755199187195186, 'psi': 0.8197238729197777}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=21 metric=0.7008 head_norm=1.047970
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.051009e-01
[S3] stored merged vector for next round verification (round=21)
[S3] DEBUG after merge:  round=21 metric=0.7008 head_norm=0.933513 delta_norm=0.305101
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S4] START round=21 head_norm_before_train=1.093757 cos_to_last_merge=1.0000 (last merge round=20)
[S4] round=21 local utility u=0.000000 metrics={'f1_val': 0.6655571322983155, 'auprc': 0.8303879903951367, 'loss_val': 0.5098501785083986, 'psi': 0.731489475537044}-{'f1_val': 0.6651989497964285, 'auprc': 0.8464279027093252, 'loss_val': 0.5215679904159976, 'psi': 0.7376905309615871}
[S5] START round=21 head_norm_before_train=0.981503 cos_to_last_merge=1.0000 (last merge round=20)
[S5] round=21 local utility u=0.283662 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.994845719374618, 'loss_val': 0.4357639620401945, 'psi': 0.8183033233474517}-{'f1_val': 0.7006083926626743, 'auprc': 0.8086090910553708, 'loss_val': 0.4443777196532981, 'psi': 0.743808672019753}
[S6] START round=21 head_norm_before_train=1.144971 cos_to_last_merge=1.0000 (last merge round=20)
[S6] round=21 local utility u=0.000000 metrics={'f1_val': 0.645238100819564, 'auprc': 0.8117585549610673, 'loss_val': 0.4448589247404554, 'psi': 0.7118462824761653}-{'f1_val': 0.9629383334060586, 'auprc': 0.9640356424073641, 'loss_val': 0.28475267302185386, 'psi': 0.9633772570065808}
[S7] START round=21 head_norm_before_train=1.423573 cos_to_last_merge=1.0000 (last merge round=20)
[S7] round=21 local utility u=0.000000 metrics={'f1_val': 0.49488160446890067, 'auprc': 0.7770728106747752, 'loss_val': 0.9840550737250645, 'psi': 0.6077580869512504}-{'f1_val': 0.676167641152088, 'auprc': 0.8369113481284591, 'loss_val': 0.46981291187965285, 'psi': 0.7404651239426365}
[S8] START round=21 head_norm_before_train=1.009186 cos_to_last_merge=1.0000 (last merge round=20)
[S8] round=21 local utility u=0.000000 metrics={'f1_val': 0.9942060797282372, 'auprc': 0.9986864801725651, 'loss_val': 0.2532222682988826, 'psi': 0.9959982399059684}-{'f1_val': 0.9941297705717227, 'auprc': 0.9988383637390061, 'loss_val': 0.20571356998311854, 'psi': 0.9960132078386361}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=21 metric=0.9942 head_norm=1.045392
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.659597e-01
[S8] stored merged vector for next round verification (round=21)
[S8] DEBUG after merge:  round=21 metric=0.9931 head_norm=1.056217 delta_norm=0.165960
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S9] START round=21 head_norm_before_train=1.796720 (no previous merge yet)
[S9] round=21 local utility u=0.010825 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9958338619957499, 'loss_val': 0.034357939849212704, 'psi': 0.9965952923055856}-{'f1_val': 0.9933536184876286, 'auprc': 0.9984720064666364, 'loss_val': 0.04142710039534758, 'psi': 0.9954009736792316}
[S10] START round=21 head_norm_before_train=1.181909 cos_to_last_merge=0.9802 (last merge round=16)
[S10] round=21 local utility u=0.004530 metrics={'f1_val': 0.992199372756666, 'auprc': 0.9965182435157658, 'loss_val': 0.14104447545034052, 'psi': 0.9939269210603059}-{'f1_val': 0.9931146301877279, 'auprc': 0.9963815994704814, 'loss_val': 0.15518588181177148, 'psi': 0.9944214179008293}
[S11] START round=21 head_norm_before_train=1.099422 cos_to_last_merge=0.9885 (last merge round=17)
[S11] round=21 local utility u=0.000000 metrics={'f1_val': 0.9590667530003859, 'auprc': 0.9978108816250649, 'loss_val': 0.20575596412223432, 'psi': 0.9745644044502575}-{'f1_val': 0.9760528968299534, 'auprc': 0.9975216511785365, 'loss_val': 0.2543533456111739, 'psi': 0.9846403985693868}
[S13] START round=21 head_norm_before_train=1.680863 (no previous merge yet)
[S13] round=21 local utility u=0.000000 metrics={'f1_val': 0.5982137628493619, 'auprc': 0.6916773480857276, 'loss_val': 0.8407319934757468, 'psi': 0.6355991969439081}-{'f1_val': 0.6450361579930113, 'auprc': 0.6801163612406657, 'loss_val': 0.5527867120331458, 'psi': 0.659068239292073}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=21 head_norm_before_train=1.438384 cos_to_last_merge=0.9988 (last merge round=18)
[S14] round=21 local utility u=0.000000 metrics={'f1_val': 0.9301851186081629, 'auprc': 0.9985900119447804, 'loss_val': 0.16003702162067585, 'psi': 0.9575470759428099}-{'f1_val': 0.9968419739193168, 'auprc': 0.9969586481392576, 'loss_val': 0.08169146352292041, 'psi': 0.9968886436072932}
[S15] START round=21 head_norm_before_train=1.483493 cos_to_last_merge=0.7784 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.778
[S15] round=21 local utility u=0.000000 metrics={'f1_val': 0.7739839340958333, 'auprc': 0.9531566741157691, 'loss_val': 0.3050463518146252, 'psi': 0.8456530301038077}-{'f1_val': 0.9886276374326257, 'auprc': 0.9901686203414732, 'loss_val': 0.1149690448353345, 'psi': 0.9892440305961647}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=21 head_norm_before_train=1.509228 cos_to_last_merge=0.7886 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.789
[S16] round=21 local utility u=0.064273 metrics={'f1_val': 0.9578584921370508, 'auprc': 0.9954523154661465, 'loss_val': 0.14130004056891823, 'psi': 0.972896021468689}-{'f1_val': 0.9435966282934487, 'auprc': 0.992448008112434, 'loss_val': 0.1752616765173712, 'psi': 0.9631371802210429}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] sending update (kind=head size=1792 to 1 peers)
[S17] START round=21 head_norm_before_train=1.250042 cos_to_last_merge=0.7373 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.737
[S17] round=21 local utility u=0.525404 metrics={'f1_val': 0.5165683458579289, 'auprc': 0.7929897070925118, 'loss_val': 1.0649552230014634, 'psi': 0.627136890351762}-{'f1_val': 0.33870967741935487, 'auprc': 0.8213997031132463, 'loss_val': 1.1338417469658069, 'psi': 0.5317856876969115}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S10] → sending delta(kind=head bytes=1807) to S6@127.0.0.1:33907
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:33903
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S9] → sending delta(kind=head bytes=1790) to S10@127.0.0.1:33911
[S9] sending update (kind=head size=1790 to 1 peers)
[S10] sending update (kind=head size=1807 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1790) from S9
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.817205)
[S10] loaded HEAD from S9 (vec_in norm=1.817205)
[S10] cosine check vs S9: cos=-0.0873
[S10] DROPPED delta from S9 (cos=-0.0873 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1807) from S10
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.225953)
[S6] loaded HEAD from S10 (vec_in norm=1.225953)
[S6] cosine check vs S10: cos=0.9897
[S6] BUFFERED delta from S10 (total buffered=1)
[S5] sending update (kind=head size=1800 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1800) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.023664)
[S3] loaded HEAD from S5 (vec_in norm=1.023664)
[S3] cosine check vs S5: cos=0.8171
[S3] BUFFERED delta from S5 (total buffered=1)
[S2] START round=22 head_norm_before_train=1.153306 cos_to_last_merge=1.0000 (last merge round=21)
[S2] round=22 local utility u=0.285750 metrics={'f1_val': 0.6990717968887176, 'auprc': 0.6560369084959811, 'loss_val': 0.34257649540736773, 'psi': 0.681857841531623}-{'f1_val': 0.6423370160781032, 'auprc': 0.6525978386578575, 'loss_val': 0.5633510526436126, 'psi': 0.646441345110005}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S2] sending update (kind=head size=1792 to 1 peers)
[S3] START round=22 head_norm_before_train=0.933513 cos_to_last_merge=1.0000 (last merge round=21)
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.998561792680981, 'loss_val': 0.32838440732967655, 'psi': 0.8198784393135722}-{'f1_val': 0.7008317350254774, 'auprc': 0.9994905757939376, 'loss_val': 0.29148973851434734, 'psi': 0.8202952713328615}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=22 metric=0.7008 head_norm=0.963468
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.098970e-01
[S3] stored merged vector for next round verification (round=22)
[S3] DEBUG after merge:  round=22 metric=0.7008 head_norm=0.944481 delta_norm=0.309897
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S4] START round=22 head_norm_before_train=1.137989 cos_to_last_merge=0.9992 (last merge round=20)
[S4] round=22 local utility u=0.017858 metrics={'f1_val': 0.6652557869981495, 'auprc': 0.8429847560212826, 'loss_val': 0.5101172858413043, 'psi': 0.7363473746074027}-{'f1_val': 0.6655571322983155, 'auprc': 0.8303879903951367, 'loss_val': 0.5098501785083986, 'psi': 0.731489475537044}
[S5] START round=22 head_norm_before_train=1.023664 cos_to_last_merge=0.9975 (last merge round=20)
[S5] round=22 local utility u=0.026934 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.99308538103076, 'loss_val': 0.376614898806598, 'psi': 0.8175991880099086}-{'f1_val': 0.7006083926626743, 'auprc': 0.994845719374618, 'loss_val': 0.4357639620401945, 'psi': 0.8183033233474517}
[S6] START round=22 head_norm_before_train=1.171358 cos_to_last_merge=0.9995 (last merge round=20)
[S6] round=22 local utility u=0.593940 metrics={'f1_val': 0.8220448942621251, 'auprc': 0.8329288229817258, 'loss_val': 0.3813304783513691, 'psi': 0.8263984657499654}-{'f1_val': 0.645238100819564, 'auprc': 0.8117585549610673, 'loss_val': 0.4448589247404554, 'psi': 0.7118462824761653}
[S7] START round=22 head_norm_before_train=1.436548 cos_to_last_merge=0.9999 (last merge round=20)
[S7] round=22 local utility u=1.000000 metrics={'f1_val': 0.6923247322762687, 'auprc': 0.8645607836902985, 'loss_val': 0.4060107233209521, 'psi': 0.7612191528418806}-{'f1_val': 0.49488160446890067, 'auprc': 0.7770728106747752, 'loss_val': 0.9840550737250645, 'psi': 0.6077580869512504}
[S8] START round=22 head_norm_before_train=1.056217 cos_to_last_merge=1.0000 (last merge round=21)
[S8] round=22 local utility u=0.002283 metrics={'f1_val': 0.9950793871653353, 'auprc': 0.9969348121471596, 'loss_val': 0.24864172842319257, 'psi': 0.995821557158065}-{'f1_val': 0.9942060797282372, 'auprc': 0.9986864801725651, 'loss_val': 0.2532222682988826, 'psi': 0.9959982399059684}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] sending update (kind=head size=1795 to 1 peers)
[S9] START round=22 head_norm_before_train=1.817205 (no previous merge yet)
[S9] round=22 local utility u=0.002923 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9984612660819544, 'loss_val': 0.031402705762802255, 'psi': 0.9971471238710254}-{'f1_val': 0.9971029125121428, 'auprc': 0.9958338619957499, 'loss_val': 0.034357939849212704, 'psi': 0.9965952923055856}
[S10] START round=22 head_norm_before_train=1.225953 cos_to_last_merge=0.9741 (last merge round=16)
[S10] round=22 local utility u=0.010619 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9925938849828283, 'loss_val': 0.11624538061026488, 'psi': 0.993178347812288}-{'f1_val': 0.992199372756666, 'auprc': 0.9965182435157658, 'loss_val': 0.14104447545034052, 'psi': 0.9939269210603059}
[S11] START round=22 head_norm_before_train=1.137312 cos_to_last_merge=0.9838 (last merge round=17)
[S11] round=22 local utility u=0.058827 metrics={'f1_val': 0.9785852066161997, 'auprc': 0.9981594210723074, 'loss_val': 0.20625900508077366, 'psi': 0.9864148923986428}-{'f1_val': 0.9590667530003859, 'auprc': 0.9978108816250649, 'loss_val': 0.20575596412223432, 'psi': 0.9745644044502575}
[S13] START round=22 head_norm_before_train=1.688878 (no previous merge yet)
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.5734706580578043, 'auprc': 0.6926860975187539, 'loss_val': 0.8227375852864123, 'psi': 0.6211568338421841}-{'f1_val': 0.5982137628493619, 'auprc': 0.6916773480857276, 'loss_val': 0.8407319934757468, 'psi': 0.6355991969439081}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=22 head_norm_before_train=1.480674 cos_to_last_merge=0.9974 (last merge round=18)
[S14] round=22 local utility u=0.253047 metrics={'f1_val': 0.9980623665153463, 'auprc': 0.9989574208309191, 'loss_val': 0.062307876597536845, 'psi': 0.9984203882415754}-{'f1_val': 0.9301851186081629, 'auprc': 0.9985900119447804, 'loss_val': 0.16003702162067585, 'psi': 0.9575470759428099}
[S15] START round=22 head_norm_before_train=1.508452 cos_to_last_merge=0.7729 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.773
[S15] round=22 local utility u=0.247360 metrics={'f1_val': 0.8293062100009608, 'auprc': 0.9868085147625661, 'loss_val': 0.24321476841735307, 'psi': 0.892307131905603}-{'f1_val': 0.7739839340958333, 'auprc': 0.9531566741157691, 'loss_val': 0.3050463518146252, 'psi': 0.8456530301038077}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] sending update (kind=head size=1803 to 1 peers)
[S16] START round=22 head_norm_before_train=1.541356 cos_to_last_merge=0.7853 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.785
[S16] round=22 local utility u=0.000000 metrics={'f1_val': 0.93528694629137, 'auprc': 0.9957356186441824, 'loss_val': 0.24292364632969068, 'psi': 0.9594664152324949}-{'f1_val': 0.9578584921370508, 'auprc': 0.9954523154661465, 'loss_val': 0.14130004056891823, 'psi': 0.972896021468689}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=22 head_norm_before_train=1.265851 cos_to_last_merge=0.7320 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.732
[S17] round=22 local utility u=0.000000 metrics={'f1_val': 0.35277173603230394, 'auprc': 0.7428459081691102, 'loss_val': 1.0063628721999753, 'psi': 0.5088014048870264}-{'f1_val': 0.5165683458579289, 'auprc': 0.7929897070925118, 'loss_val': 1.0649552230014634, 'psi': 0.627136890351762}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S11] sending update (kind=head size=1790 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] sending update (kind=head size=1805 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=22 metric=0.8220 head_norm=1.194610
[S6] _apply_head_vector_avg (torch): Δ‖w‖=9.860126e-02
[S6] stored merged vector for next round verification (round=22)
[S6] DEBUG after merge:  round=22 metric=0.8172 head_norm=1.206360 delta_norm=0.098601
[S6] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S4] sending update (kind=head size=1791 to 1 peers)
[S2] START round=23 head_norm_before_train=1.181799 cos_to_last_merge=0.9995 (last merge round=21)
[S2] round=23 local utility u=0.162432 metrics={'f1_val': 0.7084164015553198, 'auprc': 0.7892247089910156, 'loss_val': 0.47334369723650604, 'psi': 0.7407397245295981}-{'f1_val': 0.6990717968887176, 'auprc': 0.6560369084959811, 'loss_val': 0.34257649540736773, 'psi': 0.681857841531623}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=23 head_norm_before_train=0.944481 cos_to_last_merge=1.0000 (last merge round=22)
[S3] round=23 local utility u=0.000000 metrics={'f1_val': 0.7003512381127298, 'auprc': 0.9950188853930346, 'loss_val': 0.34575956480858944, 'psi': 0.8182182970248517}-{'f1_val': 0.7007562037352997, 'auprc': 0.998561792680981, 'loss_val': 0.32838440732967655, 'psi': 0.8198784393135722}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=23 head_norm_before_train=1.176851 cos_to_last_merge=0.9972 (last merge round=20)
[S4] round=23 local utility u=0.000000 metrics={'f1_val': 0.611525820404891, 'auprc': 0.9390813115442216, 'loss_val': 0.5199145144272388, 'psi': 0.7425480168606232}-{'f1_val': 0.6652557869981495, 'auprc': 0.8429847560212826, 'loss_val': 0.5101172858413043, 'psi': 0.7363473746074027}
[S5] START round=23 head_norm_before_train=1.071884 cos_to_last_merge=0.9909 (last merge round=20)
[S5] round=23 local utility u=0.026737 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9968953017184542, 'loss_val': 0.3345709802228637, 'psi': 0.8191231562849863}-{'f1_val': 0.7006083926626743, 'auprc': 0.99308538103076, 'loss_val': 0.376614898806598, 'psi': 0.8175991880099086}
[S6] START round=23 head_norm_before_train=1.206360 cos_to_last_merge=1.0000 (last merge round=22)
[S6] round=23 local utility u=0.232623 metrics={'f1_val': 0.8255811619032459, 'auprc': 0.9625748560278655, 'loss_val': 0.32623925137126636, 'psi': 0.8803786395530937}-{'f1_val': 0.8220448942621251, 'auprc': 0.8329288229817258, 'loss_val': 0.3813304783513691, 'psi': 0.8263984657499654}
[S7] START round=23 head_norm_before_train=1.446453 cos_to_last_merge=0.9998 (last merge round=20)
[S7] round=23 local utility u=0.000000 metrics={'f1_val': 0.5829865792037588, 'auprc': 0.7853698797998779, 'loss_val': 0.7422304891144913, 'psi': 0.6639398994422065}-{'f1_val': 0.6923247322762687, 'auprc': 0.8645607836902985, 'loss_val': 0.4060107233209521, 'psi': 0.7612191528418806}
[S8] START round=23 head_norm_before_train=1.101995 cos_to_last_merge=0.9982 (last merge round=21)
[S8] round=23 local utility u=0.026517 metrics={'f1_val': 0.9928249955793521, 'auprc': 0.998326670287059, 'loss_val': 0.18625793388103645, 'psi': 0.9950256654624349}-{'f1_val': 0.9950793871653353, 'auprc': 0.9969348121471596, 'loss_val': 0.24864172842319257, 'psi': 0.995821557158065}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=23 head_norm_before_train=1.835944 (no previous merge yet)
[S9] round=23 local utility u=0.000000 metrics={'f1_val': 0.9960207019771873, 'auprc': 0.998452080374575, 'loss_val': 0.030104840294384688, 'psi': 0.9969932533361423}-{'f1_val': 0.9962710290637395, 'auprc': 0.9984612660819544, 'loss_val': 0.031402705762802255, 'psi': 0.9971471238710254}
[S10] START round=23 head_norm_before_train=1.266842 cos_to_last_merge=0.9689 (last merge round=16)
[S10] round=23 local utility u=0.001261 metrics={'f1_val': 0.9942722879448275, 'auprc': 0.992014475714011, 'loss_val': 0.11621050589644948, 'psi': 0.9933691630525008}-{'f1_val': 0.9935679896985945, 'auprc': 0.9925938849828283, 'loss_val': 0.11624538061026488, 'psi': 0.993178347812288}
[S11] START round=23 head_norm_before_train=1.176737 cos_to_last_merge=0.9790 (last merge round=17)
[S11] round=23 local utility u=0.033886 metrics={'f1_val': 0.9830853185394169, 'auprc': 0.9978137563725279, 'loss_val': 0.1644503963195964, 'psi': 0.9889766936726614}-{'f1_val': 0.9785852066161997, 'auprc': 0.9981594210723074, 'loss_val': 0.20625900508077366, 'psi': 0.9864148923986428}
[S13] START round=23 head_norm_before_train=1.695001 (no previous merge yet)
[S13] round=23 local utility u=0.314344 metrics={'f1_val': 0.6508633499180765, 'auprc': 0.6594310054311615, 'loss_val': 0.5586414156814974, 'psi': 0.6542904121233105}-{'f1_val': 0.5734706580578043, 'auprc': 0.6926860975187539, 'loss_val': 0.8227375852864123, 'psi': 0.6211568338421841}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=23 head_norm_before_train=1.509678 cos_to_last_merge=0.9961 (last merge round=18)
[S14] round=23 local utility u=0.000440 metrics={'f1_val': 0.9971882020035234, 'auprc': 0.9969564102752075, 'loss_val': 0.050178988701172614, 'psi': 0.997095485312197}-{'f1_val': 0.9980623665153463, 'auprc': 0.9989574208309191, 'loss_val': 0.062307876597536845, 'psi': 0.9984203882415754}
[S15] START round=23 head_norm_before_train=1.532881 cos_to_last_merge=0.7680 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.768
[S15] round=23 local utility u=0.000000 metrics={'f1_val': 0.7548160551137975, 'auprc': 0.8697063936323028, 'loss_val': 0.4110045568754205, 'psi': 0.8007721905211996}-{'f1_val': 0.8293062100009608, 'auprc': 0.9868085147625661, 'loss_val': 0.24321476841735307, 'psi': 0.892307131905603}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=23 head_norm_before_train=1.570508 cos_to_last_merge=0.7825 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.783
[S16] round=23 local utility u=0.000000 metrics={'f1_val': 0.9221206426295582, 'auprc': 0.9952361725776918, 'loss_val': 0.30764337545825243, 'psi': 0.9513668546088117}-{'f1_val': 0.93528694629137, 'auprc': 0.9957356186441824, 'loss_val': 0.24292364632969068, 'psi': 0.9594664152324949}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=23 head_norm_before_train=1.282895 cos_to_last_merge=0.7268 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.727
[S17] round=23 local utility u=0.691174 metrics={'f1_val': 0.4848904763169257, 'auprc': 0.9016523276585329, 'loss_val': 0.8931472683854672, 'psi': 0.6515952168535686}-{'f1_val': 0.35277173603230394, 'auprc': 0.7428459081691102, 'loss_val': 1.0063628721999753, 'psi': 0.5088014048870264}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S11] sending update (kind=head size=1788 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] sending update (kind=head size=1794 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S2] START round=24 head_norm_before_train=1.211371 cos_to_last_merge=0.9982 (last merge round=21)
[S2] round=24 local utility u=0.000000 metrics={'f1_val': 0.7133556786677651, 'auprc': 0.7896116627663929, 'loss_val': 0.5262977279439748, 'psi': 0.7438580723072161}-{'f1_val': 0.7084164015553198, 'auprc': 0.7892247089910156, 'loss_val': 0.47334369723650604, 'psi': 0.7407397245295981}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=24 head_norm_before_train=0.982550 cos_to_last_merge=0.9986 (last merge round=22)
[S3] round=24 local utility u=0.014251 metrics={'f1_val': 0.7003264167718803, 'auprc': 0.9973543720680766, 'loss_val': 0.32411593657576376, 'psi': 0.8191375988903589}-{'f1_val': 0.7003512381127298, 'auprc': 0.9950188853930346, 'loss_val': 0.34575956480858944, 'psi': 0.8182182970248517}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=24 head_norm_before_train=1.212320 cos_to_last_merge=0.9944 (last merge round=20)
[S4] round=24 local utility u=0.000000 metrics={'f1_val': 0.6101536130182608, 'auprc': 0.9420907947182815, 'loss_val': 0.5394503885309962, 'psi': 0.7429284856982691}-{'f1_val': 0.611525820404891, 'auprc': 0.9390813115442216, 'loss_val': 0.5199145144272388, 'psi': 0.7425480168606232}
[S5] START round=24 head_norm_before_train=1.120409 cos_to_last_merge=0.9826 (last merge round=20)
[S5] round=24 local utility u=0.000000 metrics={'f1_val': 0.7021236082361074, 'auprc': 0.8895026018083849, 'loss_val': 0.3500131126567712, 'psi': 0.7770752056650184}-{'f1_val': 0.7006083926626743, 'auprc': 0.9968953017184542, 'loss_val': 0.3345709802228637, 'psi': 0.8191231562849863}
[S6] START round=24 head_norm_before_train=1.224339 cos_to_last_merge=0.9997 (last merge round=22)
[S6] round=24 local utility u=0.000000 metrics={'f1_val': 0.6604015021892663, 'auprc': 0.8143177686543157, 'loss_val': 0.45031176781346727, 'psi': 0.721968008775286}-{'f1_val': 0.8255811619032459, 'auprc': 0.9625748560278655, 'loss_val': 0.32623925137126636, 'psi': 0.8803786395530937}
[S7] START round=24 head_norm_before_train=1.456742 cos_to_last_merge=0.9995 (last merge round=20)
[S7] round=24 local utility u=0.380799 metrics={'f1_val': 0.6607947908071183, 'auprc': 0.8060541090406713, 'loss_val': 0.5095341679902746, 'psi': 0.7188985181005396}-{'f1_val': 0.5829865792037588, 'auprc': 0.7853698797998779, 'loss_val': 0.7422304891144913, 'psi': 0.6639398994422065}
[S8] START round=24 head_norm_before_train=1.153366 cos_to_last_merge=0.9933 (last merge round=21)
[S8] round=24 local utility u=0.015560 metrics={'f1_val': 0.9910113370052481, 'auprc': 0.9986728294901639, 'loss_val': 0.14529430182077213, 'psi': 0.9940759339992145}-{'f1_val': 0.9928249955793521, 'auprc': 0.998326670287059, 'loss_val': 0.18625793388103645, 'psi': 0.9950256654624349}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] sending update (kind=head size=1794 to 1 peers)
[S9] START round=24 head_norm_before_train=1.851707 (no previous merge yet)
[S9] round=24 local utility u=0.003607 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9976932704378937, 'loss_val': 0.027107429357709167, 'psi': 0.9973390556824432}-{'f1_val': 0.9960207019771873, 'auprc': 0.998452080374575, 'loss_val': 0.030104840294384688, 'psi': 0.9969932533361423}
[S10] START round=24 head_norm_before_train=1.308761 cos_to_last_merge=0.9636 (last merge round=16)
[S10] round=24 local utility u=0.014973 metrics={'f1_val': 0.9948838907637279, 'auprc': 0.9919831867547445, 'loss_val': 0.08984002613217701, 'psi': 0.9937236091601346}-{'f1_val': 0.9942722879448275, 'auprc': 0.992014475714011, 'loss_val': 0.11621050589644948, 'psi': 0.9933691630525008}
[S11] START round=24 head_norm_before_train=1.210930 cos_to_last_merge=0.9748 (last merge round=17)
[S11] round=24 local utility u=0.000000 metrics={'f1_val': 0.9640368917779877, 'auprc': 0.9980073571243101, 'loss_val': 0.14899000012930724, 'psi': 0.9776250779165168}-{'f1_val': 0.9830853185394169, 'auprc': 0.9978137563725279, 'loss_val': 0.1644503963195964, 'psi': 0.9889766936726614}
[S13] START round=24 head_norm_before_train=1.705316 (no previous merge yet)
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.5747868440160496, 'auprc': 0.6507076664459908, 'loss_val': 0.8826038750179412, 'psi': 0.6051551729880261}-{'f1_val': 0.6508633499180765, 'auprc': 0.6594310054311615, 'loss_val': 0.5586414156814974, 'psi': 0.6542904121233105}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=24 head_norm_before_train=1.541331 cos_to_last_merge=0.9946 (last merge round=18)
[S14] round=24 local utility u=0.001903 metrics={'f1_val': 0.9970616270651818, 'auprc': 0.9985962931772808, 'loss_val': 0.05053271214198443, 'psi': 0.9976754935100214}-{'f1_val': 0.9971882020035234, 'auprc': 0.9969564102752075, 'loss_val': 0.050178988701172614, 'psi': 0.997095485312197}
[S15] START round=24 head_norm_before_train=1.555428 cos_to_last_merge=0.7638 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.764
[S15] round=24 local utility u=0.087754 metrics={'f1_val': 0.7653069330733722, 'auprc': 0.8987903107105963, 'loss_val': 0.3856931929743289, 'psi': 0.8187002841282618}-{'f1_val': 0.7548160551137975, 'auprc': 0.8697063936323028, 'loss_val': 0.4110045568754205, 'psi': 0.8007721905211996}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=24 head_norm_before_train=1.596711 cos_to_last_merge=0.7803 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.780
[S16] round=24 local utility u=0.320819 metrics={'f1_val': 0.9898155372854605, 'auprc': 0.9935497589266631, 'loss_val': 0.0671156083171861, 'psi': 0.9913092259419415}-{'f1_val': 0.9221206426295582, 'auprc': 0.9952361725776918, 'loss_val': 0.30764337545825243, 'psi': 0.9513668546088117}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=24 head_norm_before_train=1.302075 cos_to_last_merge=0.7214 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.721
[S17] round=24 local utility u=0.464436 metrics={'f1_val': 0.6436722019155955, 'auprc': 0.9005097645464889, 'loss_val': 0.9135387190656026, 'psi': 0.7464072269679529}-{'f1_val': 0.4848904763169257, 'auprc': 0.9016523276585329, 'loss_val': 0.8931472683854672, 'psi': 0.6515952168535686}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] sending update (kind=head size=1793 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S7] sending update (kind=head size=1792 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=25 head_norm_before_train=1.239201 cos_to_last_merge=0.9971 (last merge round=21)
[S2] round=25 local utility u=0.000000 metrics={'f1_val': 0.6805096894991778, 'auprc': 0.6518649426327641, 'loss_val': 0.3816747997066644, 'psi': 0.6690517907526123}-{'f1_val': 0.7133556786677651, 'auprc': 0.7896116627663929, 'loss_val': 0.5262977279439748, 'psi': 0.7438580723072161}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=25 head_norm_before_train=1.024339 cos_to_last_merge=0.9944 (last merge round=22)
[S3] round=25 local utility u=0.925311 metrics={'f1_val': 0.9978100342676263, 'auprc': 0.9985662096605608, 'loss_val': 0.2620317083883695, 'psi': 0.9981125044248}-{'f1_val': 0.7003264167718803, 'auprc': 0.9973543720680766, 'loss_val': 0.32411593657576376, 'psi': 0.8191375988903589}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=25 head_norm_before_train=1.239189 cos_to_last_merge=0.9915 (last merge round=20)
[S4] round=25 local utility u=0.014669 metrics={'f1_val': 0.6128031381288164, 'auprc': 0.9451614156307797, 'loss_val': 0.535221274043623, 'psi': 0.7457464491296018}-{'f1_val': 0.6101536130182608, 'auprc': 0.9420907947182815, 'loss_val': 0.5394503885309962, 'psi': 0.7429284856982691}
[S5] START round=25 head_norm_before_train=1.164174 cos_to_last_merge=0.9742 (last merge round=20)
[S5] round=25 local utility u=0.179461 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9942792261051483, 'loss_val': 0.29632910148027136, 'psi': 0.818076726039664}-{'f1_val': 0.7021236082361074, 'auprc': 0.8895026018083849, 'loss_val': 0.3500131126567712, 'psi': 0.7770752056650184}
[S6] START round=25 head_norm_before_train=1.241876 cos_to_last_merge=0.9991 (last merge round=22)
[S6] round=25 local utility u=0.742098 metrics={'f1_val': 0.8242058077454791, 'auprc': 0.9590674283483678, 'loss_val': 0.38319052968130113, 'psi': 0.8781504559866347}-{'f1_val': 0.6604015021892663, 'auprc': 0.8143177686543157, 'loss_val': 0.45031176781346727, 'psi': 0.721968008775286}
[S7] START round=25 head_norm_before_train=1.472534 cos_to_last_merge=0.9991 (last merge round=20)
[S7] round=25 local utility u=0.000000 metrics={'f1_val': 0.6197922595783998, 'auprc': 0.8021902269023095, 'loss_val': 0.5931463748730258, 'psi': 0.6927514465079636}-{'f1_val': 0.6607947908071183, 'auprc': 0.8060541090406713, 'loss_val': 0.5095341679902746, 'psi': 0.7188985181005396}
[S8] START round=25 head_norm_before_train=1.211113 cos_to_last_merge=0.9864 (last merge round=21)
[S8] round=25 local utility u=0.006789 metrics={'f1_val': 0.9937111453033, 'auprc': 0.9889891557196683, 'loss_val': 0.11886394379064476, 'psi': 0.9918223494698473}-{'f1_val': 0.9910113370052481, 'auprc': 0.9986728294901639, 'loss_val': 0.14529430182077213, 'psi': 0.9940759339992145}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[S9] START round=25 head_norm_before_train=1.865489 (no previous merge yet)
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.9960207019771873, 'auprc': 0.9984726285378301, 'loss_val': 0.026588579692057808, 'psi': 0.9970014726014444}-{'f1_val': 0.9971029125121428, 'auprc': 0.9976932704378937, 'loss_val': 0.027107429357709167, 'psi': 0.9973390556824432}
[S10] START round=25 head_norm_before_train=1.352275 cos_to_last_merge=0.9578 (last merge round=16)
[S10] round=25 local utility u=0.009649 metrics={'f1_val': 0.9942256070413027, 'auprc': 0.993804041298093, 'loss_val': 0.07205405493727601, 'psi': 0.9940569807440188}-{'f1_val': 0.9948838907637279, 'auprc': 0.9919831867547445, 'loss_val': 0.08984002613217701, 'psi': 0.9937236091601346}
[S11] START round=25 head_norm_before_train=1.244940 cos_to_last_merge=0.9702 (last merge round=17)
[S11] round=25 local utility u=0.107075 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9979401638997615, 'loss_val': 0.12969961501282296, 'psi': 0.9971042682680583}-{'f1_val': 0.9640368917779877, 'auprc': 0.9980073571243101, 'loss_val': 0.14899000012930724, 'psi': 0.9776250779165168}
[S13] START round=25 head_norm_before_train=1.711342 (no previous merge yet)
[S13] round=25 local utility u=0.337561 metrics={'f1_val': 0.6176632729869248, 'auprc': 0.7031856262727204, 'loss_val': 0.622174812576424, 'psi': 0.651872214301243}-{'f1_val': 0.5747868440160496, 'auprc': 0.6507076664459908, 'loss_val': 0.8826038750179412, 'psi': 0.6051551729880261}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=25 head_norm_before_train=1.573220 cos_to_last_merge=0.9930 (last merge round=18)
[S14] round=25 local utility u=0.000000 metrics={'f1_val': 0.9416364205303185, 'auprc': 0.9969444397591629, 'loss_val': 0.09741459330094689, 'psi': 0.9637596282218563}-{'f1_val': 0.9970616270651818, 'auprc': 0.9985962931772808, 'loss_val': 0.05053271214198443, 'psi': 0.9976754935100214}
[S15] START round=25 head_norm_before_train=1.573311 cos_to_last_merge=0.7602 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.760
[S15] round=25 local utility u=0.926188 metrics={'f1_val': 0.98194394121405, 'auprc': 0.9935863363287472, 'loss_val': 0.11752656269215857, 'psi': 0.9866008992599289}-{'f1_val': 0.7653069330733722, 'auprc': 0.8987903107105963, 'loss_val': 0.3856931929743289, 'psi': 0.8187002841282618}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=25 head_norm_before_train=1.620984 cos_to_last_merge=0.7781 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.778
[S16] round=25 local utility u=0.000000 metrics={'f1_val': 0.9798048488078195, 'auprc': 0.9967293371096935, 'loss_val': 0.09194594603240053, 'psi': 0.9865746441285691}-{'f1_val': 0.9898155372854605, 'auprc': 0.9935497589266631, 'loss_val': 0.0671156083171861, 'psi': 0.9913092259419415}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=25 head_norm_before_train=1.322817 cos_to_last_merge=0.7162 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.716
[S17] round=25 local utility u=0.000000 metrics={'f1_val': 0.5429093098510664, 'auprc': 0.8789358590922038, 'loss_val': 0.963148832297246, 'psi': 0.6773199295475214}-{'f1_val': 0.6436722019155955, 'auprc': 0.9005097645464889, 'loss_val': 0.9135387190656026, 'psi': 0.7464072269679529}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] sending update (kind=head size=1804 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] sending update (kind=head size=1805 to 1 peers)
[S2] START round=26 head_norm_before_train=1.262073 cos_to_last_merge=0.9957 (last merge round=21)
[S2] round=26 local utility u=0.000000 metrics={'f1_val': 0.6741931340815709, 'auprc': 0.6432340884384574, 'loss_val': 0.42088592091618937, 'psi': 0.6618095158243256}-{'f1_val': 0.6805096894991778, 'auprc': 0.6518649426327641, 'loss_val': 0.3816747997066644, 'psi': 0.6690517907526123}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=26 head_norm_before_train=1.068326 cos_to_last_merge=0.9882 (last merge round=22)
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.703143065141181, 'auprc': 0.9986032443969343, 'loss_val': 0.23554258677827025, 'psi': 0.8213271368434822}-{'f1_val': 0.9978100342676263, 'auprc': 0.9985662096605608, 'loss_val': 0.2620317083883695, 'psi': 0.9981125044248}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=26 head_norm_before_train=1.262149 cos_to_last_merge=0.9894 (last merge round=20)
[S4] round=26 local utility u=0.000000 metrics={'f1_val': 0.610111677796099, 'auprc': 0.9356521827029306, 'loss_val': 0.543843653152315, 'psi': 0.7403278797588317}-{'f1_val': 0.6128031381288164, 'auprc': 0.9451614156307797, 'loss_val': 0.535221274043623, 'psi': 0.7457464491296018}
[S5] START round=26 head_norm_before_train=1.201724 cos_to_last_merge=0.9668 (last merge round=20)
[S5] round=26 local utility u=0.000000 metrics={'f1_val': 0.7093355081977256, 'auprc': 0.801400221552785, 'loss_val': 0.45595825543667634, 'psi': 0.7461613935397493}-{'f1_val': 0.7006083926626743, 'auprc': 0.9942792261051483, 'loss_val': 0.29632910148027136, 'psi': 0.818076726039664}
[S6] START round=26 head_norm_before_train=1.256537 cos_to_last_merge=0.9984 (last merge round=22)
[S6] round=26 local utility u=0.000000 metrics={'f1_val': 0.8227692526910466, 'auprc': 0.9499044144178062, 'loss_val': 0.3869790698278674, 'psi': 0.8736233173817505}-{'f1_val': 0.8242058077454791, 'auprc': 0.9590674283483678, 'loss_val': 0.38319052968130113, 'psi': 0.8781504559866347}
[S7] START round=26 head_norm_before_train=1.490728 cos_to_last_merge=0.9984 (last merge round=20)
[S7] round=26 local utility u=0.000000 metrics={'f1_val': 0.5553677010557545, 'auprc': 0.7895301929047241, 'loss_val': 0.8563465694034373, 'psi': 0.6490326977953425}-{'f1_val': 0.6197922595783998, 'auprc': 0.8021902269023095, 'loss_val': 0.5931463748730258, 'psi': 0.6927514465079636}
[S8] START round=26 head_norm_before_train=1.263041 cos_to_last_merge=0.9793 (last merge round=21)
[S8] round=26 local utility u=0.027011 metrics={'f1_val': 0.9939122747783468, 'auprc': 0.9976684540121892, 'loss_val': 0.09208613929843197, 'psi': 0.9954147464718837}-{'f1_val': 0.9937111453033, 'auprc': 0.9889891557196683, 'loss_val': 0.11886394379064476, 'psi': 0.9918223494698473}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] START round=26 head_norm_before_train=1.878672 (no previous merge yet)
[S9] round=26 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9958467973054108, 'loss_val': 0.025355337550067015, 'psi': 0.99660046642945}-{'f1_val': 0.9960207019771873, 'auprc': 0.9984726285378301, 'loss_val': 0.026588579692057808, 'psi': 0.9970014726014444}
[S10] START round=26 head_norm_before_train=1.395216 cos_to_last_merge=0.9521 (last merge round=16)
[S10] round=26 local utility u=0.004146 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9929559414799214, 'loss_val': 0.06385082074603468, 'psi': 0.9939810095976185}-{'f1_val': 0.9942256070413027, 'auprc': 0.993804041298093, 'loss_val': 0.07205405493727601, 'psi': 0.9940569807440188}
[S11] START round=26 head_norm_before_train=1.282480 cos_to_last_merge=0.9650 (last merge round=17)
[S11] round=26 local utility u=0.004384 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9971723947184872, 'loss_val': 0.11862870573106167, 'psi': 0.9967971605955486}-{'f1_val': 0.9965470045135896, 'auprc': 0.9979401638997615, 'loss_val': 0.12969961501282296, 'psi': 0.9971042682680583}
[S13] START round=26 head_norm_before_train=1.716185 (no previous merge yet)
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.5901926648524085, 'auprc': 0.6775327547268872, 'loss_val': 0.8596562638220382, 'psi': 0.6251287008022}-{'f1_val': 0.6176632729869248, 'auprc': 0.7031856262727204, 'loss_val': 0.622174812576424, 'psi': 0.651872214301243}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=26 head_norm_before_train=1.602567 cos_to_last_merge=0.9916 (last merge round=18)
[S14] round=26 local utility u=0.196664 metrics={'f1_val': 0.9971882020035234, 'auprc': 0.9969635818339335, 'loss_val': 0.03745526700143973, 'psi': 0.9970983539356875}-{'f1_val': 0.9416364205303185, 'auprc': 0.9969444397591629, 'loss_val': 0.09741459330094689, 'psi': 0.9637596282218563}
[S15] START round=26 head_norm_before_train=1.590592 cos_to_last_merge=0.7573 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.757
[S15] round=26 local utility u=0.000000 metrics={'f1_val': 0.7806385233707347, 'auprc': 0.9559165163590219, 'loss_val': 0.34872729579669287, 'psi': 0.8507497205660496}-{'f1_val': 0.98194394121405, 'auprc': 0.9935863363287472, 'loss_val': 0.11752656269215857, 'psi': 0.9866008992599289}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=26 head_norm_before_train=1.643813 cos_to_last_merge=0.7764 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.776
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.941314080743739, 'auprc': 0.9962425321614137, 'loss_val': 0.16723944839853458, 'psi': 0.9632854613108089}-{'f1_val': 0.9798048488078195, 'auprc': 0.9967293371096935, 'loss_val': 0.09194594603240053, 'psi': 0.9865746441285691}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=26 head_norm_before_train=1.343198 cos_to_last_merge=0.7119 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.712
[S17] round=26 local utility u=0.760106 metrics={'f1_val': 0.774988532688161, 'auprc': 0.8852157015614243, 'loss_val': 0.854251512750838, 'psi': 0.8190794002374663}-{'f1_val': 0.5429093098510664, 'auprc': 0.8789358590922038, 'loss_val': 0.963148832297246, 'psi': 0.6773199295475214}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S11]  timeout peer S4
[S4]  timeout peer S8
[S14]  timeout peer S7
[S6]  timeout peer S5
[S7]  timeout peer S2
[S10]  timeout peer S6
[S9]  timeout peer S10
[S5]  timeout peer S3
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=27 head_norm_before_train=1.281977 cos_to_last_merge=0.9941 (last merge round=21)
[S2] round=27 local utility u=0.132720 metrics={'f1_val': 0.6986308350062834, 'auprc': 0.6573193581931454, 'loss_val': 0.344327080819263, 'psi': 0.6821062442810282}-{'f1_val': 0.6741931340815709, 'auprc': 0.6432340884384574, 'loss_val': 0.42088592091618937, 'psi': 0.6618095158243256}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=27 head_norm_before_train=1.111237 cos_to_last_merge=0.9819 (last merge round=22)
[S3] round=27 local utility u=0.908409 metrics={'f1_val': 0.9975311147574263, 'auprc': 0.9980375032195665, 'loss_val': 0.18335592255928584, 'psi': 0.9977336701422823}-{'f1_val': 0.703143065141181, 'auprc': 0.9986032443969343, 'loss_val': 0.23554258677827025, 'psi': 0.8213271368434822}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=27 head_norm_before_train=1.279074 cos_to_last_merge=0.9881 (last merge round=20)
[S4] round=27 local utility u=0.037360 metrics={'f1_val': 0.6138070781055656, 'auprc': 0.9498839215827928, 'loss_val': 0.533991891390905, 'psi': 0.7482378154964564}-{'f1_val': 0.610111677796099, 'auprc': 0.9356521827029306, 'loss_val': 0.543843653152315, 'psi': 0.7403278797588317}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=27 head_norm_before_train=1.233208 cos_to_last_merge=0.9611 (last merge round=20)
[S5] round=27 local utility u=0.346748 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.99219545985888, 'loss_val': 0.2824847536048437, 'psi': 0.8172432195411565}-{'f1_val': 0.7093355081977256, 'auprc': 0.801400221552785, 'loss_val': 0.45595825543667634, 'psi': 0.7461613935397493}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=27 head_norm_before_train=1.277025 cos_to_last_merge=0.9969 (last merge round=22)
[S6] round=27 local utility u=0.512810 metrics={'f1_val': 0.9582507126793067, 'auprc': 0.9632791023517029, 'loss_val': 0.21437194824145428, 'psi': 0.9602620685482651}-{'f1_val': 0.8227692526910466, 'auprc': 0.9499044144178062, 'loss_val': 0.3869790698278674, 'psi': 0.8736233173817505}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=27 head_norm_before_train=1.509105 cos_to_last_merge=0.9976 (last merge round=20)
[S7] round=27 local utility u=1.000000 metrics={'f1_val': 0.6995710316882817, 'auprc': 0.9727416750797172, 'loss_val': 0.26661484042771194, 'psi': 0.8088392890448559}-{'f1_val': 0.5553677010557545, 'auprc': 0.7895301929047241, 'loss_val': 0.8563465694034373, 'psi': 0.6490326977953425}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] sending update (kind=head size=1795 to 1 peers)
[S8] START round=27 head_norm_before_train=1.307566 cos_to_last_merge=0.9726 (last merge round=21)
[S8] round=27 local utility u=0.003891 metrics={'f1_val': 0.9928249955793521, 'auprc': 0.9983041128173266, 'loss_val': 0.0796882151896597, 'psi': 0.9950166424745419}-{'f1_val': 0.9939122747783468, 'auprc': 0.9976684540121892, 'loss_val': 0.09208613929843197, 'psi': 0.9954147464718837}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=27 head_norm_before_train=1.893282 (no previous merge yet)
[S9] round=27 local utility u=0.004769 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9984803451177322, 'loss_val': 0.023717624535156172, 'psi': 0.9976538855543786}-{'f1_val': 0.9971029125121428, 'auprc': 0.9958467973054108, 'loss_val': 0.025355337550067015, 'psi': 0.99660046642945}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=27 head_norm_before_train=1.436353 cos_to_last_merge=0.9473 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.947
[S10] round=27 local utility u=0.003676 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9930394788545266, 'loss_val': 0.05674893690661112, 'psi': 0.9940144245474605}-{'f1_val': 0.9946643883427498, 'auprc': 0.9929559414799214, 'loss_val': 0.06385082074603468, 'psi': 0.9939810095976185}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=27 head_norm_before_train=1.320742 cos_to_last_merge=0.9594 (last merge round=17)
[S11] round=27 local utility u=0.011634 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9969914152978328, 'loss_val': 0.09481852060943917, 'psi': 0.9967247688272869}-{'f1_val': 0.9965470045135896, 'auprc': 0.9971723947184872, 'loss_val': 0.11862870573106167, 'psi': 0.9967971605955486}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] sending update (kind=head size=1793 to 1 peers)
[S13] START round=27 head_norm_before_train=1.721906 (no previous merge yet)
[S13] round=27 local utility u=0.052260 metrics={'f1_val': 0.6193211156327192, 'auprc': 0.6269825458011176, 'loss_val': 0.7782566000807724, 'psi': 0.6223856877000785}-{'f1_val': 0.5901926648524085, 'auprc': 0.6775327547268872, 'loss_val': 0.8596562638220382, 'psi': 0.6251287008022}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=27 head_norm_before_train=1.628713 cos_to_last_merge=0.9902 (last merge round=18)
[S14] round=27 local utility u=0.006259 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9984849657865831, 'loss_val': 0.032279828489062065, 'psi': 0.9979846571445454}-{'f1_val': 0.9971882020035234, 'auprc': 0.9969635818339335, 'loss_val': 0.03745526700143973, 'psi': 0.9970983539356875}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=27 head_norm_before_train=1.606901 cos_to_last_merge=0.7552 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.755
[S15] round=27 local utility u=0.000000 metrics={'f1_val': 0.6989317671350559, 'auprc': 0.8184276436361753, 'loss_val': 0.5462876024991592, 'psi': 0.7467301177355037}-{'f1_val': 0.7806385233707347, 'auprc': 0.9559165163590219, 'loss_val': 0.34872729579669287, 'psi': 0.8507497205660496}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=27 head_norm_before_train=1.663636 cos_to_last_merge=0.7753 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.775
[S16] round=27 local utility u=0.180361 metrics={'f1_val': 0.985855733096233, 'auprc': 0.9972396545849819, 'loss_val': 0.07675970245303654, 'psi': 0.9904093016917326}-{'f1_val': 0.941314080743739, 'auprc': 0.9962425321614137, 'loss_val': 0.16723944839853458, 'psi': 0.9632854613108089}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] sending update (kind=head size=1804 to 1 peers)
[S17] START round=27 head_norm_before_train=1.368383 cos_to_last_merge=0.7072 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.707
[S17] round=27 local utility u=0.000000 metrics={'f1_val': 0.6450002100201063, 'auprc': 0.8473189068538987, 'loss_val': 0.9800460625779659, 'psi': 0.7259276887536232}-{'f1_val': 0.774988532688161, 'auprc': 0.8852157015614243, 'loss_val': 0.854251512750838, 'psi': 0.8190794002374663}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=28 head_norm_before_train=1.300039 cos_to_last_merge=0.9925 (last merge round=21)
[S2] round=28 local utility u=0.116669 metrics={'f1_val': 0.7135797722223256, 'auprc': 0.7897621228299398, 'loss_val': 0.5980102136732082, 'psi': 0.7440527124653713}-{'f1_val': 0.6986308350062834, 'auprc': 0.6573193581931454, 'loss_val': 0.344327080819263, 'psi': 0.6821062442810282}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=28 head_norm_before_train=1.150906 cos_to_last_merge=0.9751 (last merge round=22)
[S3] round=28 local utility u=0.000000 metrics={'f1_val': 0.8978031270698024, 'auprc': 0.9859785920500053, 'loss_val': 0.2570593122364003, 'psi': 0.9330733130618835}-{'f1_val': 0.9975311147574263, 'auprc': 0.9980375032195665, 'loss_val': 0.18335592255928584, 'psi': 0.9977336701422823}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=28 head_norm_before_train=1.294425 cos_to_last_merge=0.9867 (last merge round=20)
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.6097988969357819, 'auprc': 0.9411616508891141, 'loss_val': 0.5460225337777226, 'psi': 0.7423439985171147}-{'f1_val': 0.6138070781055656, 'auprc': 0.9498839215827928, 'loss_val': 0.533991891390905, 'psi': 0.7482378154964564}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=28 head_norm_before_train=1.258916 cos_to_last_merge=0.9565 (last merge round=20)
[S5] round=28 local utility u=0.000000 metrics={'f1_val': 0.7095658938752405, 'auprc': 0.8231389471178243, 'loss_val': 0.4580527212038514, 'psi': 0.754995115172274}-{'f1_val': 0.7006083926626743, 'auprc': 0.99219545985888, 'loss_val': 0.2824847536048437, 'psi': 0.8172432195411565}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=28 head_norm_before_train=1.295524 cos_to_last_merge=0.9951 (last merge round=22)
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.7887231058461937, 'auprc': 0.8091440347166824, 'loss_val': 0.5026201847127134, 'psi': 0.7968914773943891}-{'f1_val': 0.9582507126793067, 'auprc': 0.9632791023517029, 'loss_val': 0.21437194824145428, 'psi': 0.9602620685482651}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=28 head_norm_before_train=1.521718 cos_to_last_merge=0.9971 (last merge round=20)
[S7] round=28 local utility u=0.000000 metrics={'f1_val': 0.5386856529827664, 'auprc': 0.7823582133811274, 'loss_val': 0.9760644340978557, 'psi': 0.6361546771421107}-{'f1_val': 0.6995710316882817, 'auprc': 0.9727416750797172, 'loss_val': 0.26661484042771194, 'psi': 0.8088392890448559}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=28 head_norm_before_train=1.347051 cos_to_last_merge=0.9669 (last merge round=21)
[S8] round=28 local utility u=0.000000 metrics={'f1_val': 0.9839092979549603, 'auprc': 0.9990496108280535, 'loss_val': 0.08662432067393501, 'psi': 0.9899654231041976}-{'f1_val': 0.9928249955793521, 'auprc': 0.9983041128173266, 'loss_val': 0.0796882151896597, 'psi': 0.9950166424745419}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=28 head_norm_before_train=1.907101 (no previous merge yet)
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.9960207019771873, 'auprc': 0.998473098981689, 'loss_val': 0.023623454786443752, 'psi': 0.997001660778988}-{'f1_val': 0.9971029125121428, 'auprc': 0.9984803451177322, 'loss_val': 0.023717624535156172, 'psi': 0.9976538855543786}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=28 head_norm_before_train=1.475092 cos_to_last_merge=0.9432 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.943
[S10] round=28 local utility u=0.000000 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9933754013632514, 'loss_val': 0.053141656538364335, 'psi': 0.9934909543644572}-{'f1_val': 0.9946643883427498, 'auprc': 0.9930394788545266, 'loss_val': 0.05674893690661112, 'psi': 0.9940144245474605}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=28 head_norm_before_train=1.361090 cos_to_last_merge=0.9531 (last merge round=17)
[S11] round=28 local utility u=0.005699 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9961107812755378, 'loss_val': 0.08077921837703286, 'psi': 0.9963725152183689}-{'f1_val': 0.9965470045135896, 'auprc': 0.9969914152978328, 'loss_val': 0.09481852060943917, 'psi': 0.9967247688272869}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=28 head_norm_before_train=1.729635 (no previous merge yet)
[S13] round=28 local utility u=0.000522 metrics={'f1_val': 0.6042158273796794, 'auprc': 0.7162438453646144, 'loss_val': 0.954365233538992, 'psi': 0.6490270345736534}-{'f1_val': 0.6193211156327192, 'auprc': 0.6269825458011176, 'loss_val': 0.7782566000807724, 'psi': 0.6223856877000785}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=28 head_norm_before_train=1.653567 cos_to_last_merge=0.9888 (last merge round=18)
[S14] round=28 local utility u=0.000000 metrics={'f1_val': 0.9953521255721572, 'auprc': 0.998638468234772, 'loss_val': 0.037009871880042094, 'psi': 0.9966666626372032}-{'f1_val': 0.9976511180498535, 'auprc': 0.9984849657865831, 'loss_val': 0.032279828489062065, 'psi': 0.9979846571445454}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=28 head_norm_before_train=1.620374 cos_to_last_merge=0.7532 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.753
[S15] round=28 local utility u=1.000000 metrics={'f1_val': 0.9886812048048547, 'auprc': 0.9946755307400084, 'loss_val': 0.07603099988270386, 'psi': 0.9910789351789162}-{'f1_val': 0.6989317671350559, 'auprc': 0.8184276436361753, 'loss_val': 0.5462876024991592, 'psi': 0.7467301177355037}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=28 head_norm_before_train=1.680961 cos_to_last_merge=0.7744 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.774
[S16] round=28 local utility u=0.019425 metrics={'f1_val': 0.9900043656004349, 'auprc': 0.9968581038091637, 'loss_val': 0.06165643616584169, 'psi': 0.9927458608839264}-{'f1_val': 0.985855733096233, 'auprc': 0.9972396545849819, 'loss_val': 0.07675970245303654, 'psi': 0.9904093016917326}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=28 head_norm_before_train=1.390864 cos_to_last_merge=0.7037 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.704
[S17] round=28 local utility u=0.016928 metrics={'f1_val': 0.7199610074637117, 'auprc': 0.7192029651754029, 'loss_val': 1.0116077370306027, 'psi': 0.7196577905483882}-{'f1_val': 0.6450002100201063, 'auprc': 0.8473189068538987, 'loss_val': 0.9800460625779659, 'psi': 0.7259276887536232}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=29 head_norm_before_train=1.316692 cos_to_last_merge=0.9911 (last merge round=21)
[S2] round=29 local utility u=0.000000 metrics={'f1_val': 0.6980899663930351, 'auprc': 0.6579501459542708, 'loss_val': 0.36099776837013664, 'psi': 0.6820340382175294}-{'f1_val': 0.7135797722223256, 'auprc': 0.7897621228299398, 'loss_val': 0.5980102136732082, 'psi': 0.7440527124653713}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=29 head_norm_before_train=1.188399 cos_to_last_merge=0.9688 (last merge round=22)
[S3] round=29 local utility u=0.108861 metrics={'f1_val': 0.9230702398650977, 'auprc': 0.9959544197924044, 'loss_val': 0.2208673442446683, 'psi': 0.9522239118360204}-{'f1_val': 0.8978031270698024, 'auprc': 0.9859785920500053, 'loss_val': 0.2570593122364003, 'psi': 0.9330733130618835}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=29 head_norm_before_train=1.308699 cos_to_last_merge=0.9860 (last merge round=20)
[S4] round=29 local utility u=0.018293 metrics={'f1_val': 0.6124875911436954, 'auprc': 0.9413032803863289, 'loss_val': 0.5259929102183435, 'psi': 0.7440138668407489}-{'f1_val': 0.6097988969357819, 'auprc': 0.9411616508891141, 'loss_val': 0.5460225337777226, 'psi': 0.7423439985171147}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] sending update (kind=head size=1794 to 1 peers)
[S5] START round=29 head_norm_before_train=1.279550 cos_to_last_merge=0.9529 (last merge round=20)
[S5] round=29 local utility u=0.332468 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9973860431390037, 'loss_val': 0.26038545165675825, 'psi': 0.8191467763504169}-{'f1_val': 0.7095658938752405, 'auprc': 0.8231389471178243, 'loss_val': 0.4580527212038514, 'psi': 0.754995115172274}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] sending update (kind=head size=1806 to 1 peers)
[S6] START round=29 head_norm_before_train=1.313597 cos_to_last_merge=0.9932 (last merge round=22)
[S6] round=29 local utility u=0.921004 metrics={'f1_val': 0.9625838036603064, 'auprc': 0.9661815726431189, 'loss_val': 0.1748884315526309, 'psi': 0.9640229112534313}-{'f1_val': 0.7887231058461937, 'auprc': 0.8091440347166824, 'loss_val': 0.5026201847127134, 'psi': 0.7968914773943891}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=29 head_norm_before_train=1.529264 cos_to_last_merge=0.9967 (last merge round=20)
[S7] round=29 local utility u=1.000000 metrics={'f1_val': 0.8912825512402229, 'auprc': 0.9920805197396063, 'loss_val': 0.20313242570938214, 'psi': 0.9316017386399762}-{'f1_val': 0.5386856529827664, 'auprc': 0.7823582133811274, 'loss_val': 0.9760644340978557, 'psi': 0.6361546771421107}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=29 head_norm_before_train=1.381512 cos_to_last_merge=0.9618 (last merge round=21)
[S8] round=29 local utility u=0.035153 metrics={'f1_val': 0.9942788405856967, 'auprc': 0.9936580918178931, 'loss_val': 0.062361055346383844, 'psi': 0.9940305410785752}-{'f1_val': 0.9839092979549603, 'auprc': 0.9990496108280535, 'loss_val': 0.08662432067393501, 'psi': 0.9899654231041976}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] sending update (kind=head size=1805 to 1 peers)
[S9] START round=29 head_norm_before_train=1.920323 (no previous merge yet)
[S9] round=29 local utility u=0.004017 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9984826606049526, 'loss_val': 0.022112337777991778, 'psi': 0.9976548117492667}-{'f1_val': 0.9960207019771873, 'auprc': 0.998473098981689, 'loss_val': 0.023623454786443752, 'psi': 0.997001660778988}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=29 head_norm_before_train=1.509900 cos_to_last_merge=0.9397 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.940
[S10] round=29 local utility u=0.001786 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.993250378559441, 'loss_val': 0.04919416718649981, 'psi': 0.993440945242933}-{'f1_val': 0.9935679896985945, 'auprc': 0.9933754013632514, 'loss_val': 0.053141656538364335, 'psi': 0.9934909543644572}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=29 head_norm_before_train=1.400328 cos_to_last_merge=0.9470 (last merge round=17)
[S11] ⚠️ Model drifted since last merge! cos=0.947
[S11] round=29 local utility u=0.000000 metrics={'f1_val': 0.9940327724445256, 'auprc': 0.9974823532393995, 'loss_val': 0.07341407843164664, 'psi': 0.9954126047624752}-{'f1_val': 0.9965470045135896, 'auprc': 0.9961107812755378, 'loss_val': 0.08077921837703286, 'psi': 0.9963725152183689}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=29 head_norm_before_train=1.733934 (no previous merge yet)
[S13] round=29 local utility u=0.126370 metrics={'f1_val': 0.6243936095016916, 'auprc': 0.6984042540074902, 'loss_val': 0.769172390084178, 'psi': 0.653997867304011}-{'f1_val': 0.6042158273796794, 'auprc': 0.7162438453646144, 'loss_val': 0.954365233538992, 'psi': 0.6490270345736534}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=29 head_norm_before_train=1.679677 cos_to_last_merge=0.9873 (last merge round=18)
[S14] round=29 local utility u=0.000000 metrics={'f1_val': 0.9514171302668645, 'auprc': 0.9986259654205412, 'loss_val': 0.07369623679227388, 'psi': 0.9703006643283352}-{'f1_val': 0.9953521255721572, 'auprc': 0.998638468234772, 'loss_val': 0.037009871880042094, 'psi': 0.9966666626372032}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=29 head_norm_before_train=1.633368 cos_to_last_merge=0.7515 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.751
[S15] round=29 local utility u=0.000000 metrics={'f1_val': 0.7918454087239047, 'auprc': 0.9584263497038221, 'loss_val': 0.347936349301728, 'psi': 0.8584777851158717}-{'f1_val': 0.9886812048048547, 'auprc': 0.9946755307400084, 'loss_val': 0.07603099988270386, 'psi': 0.9910789351789162}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=29 head_norm_before_train=1.696673 cos_to_last_merge=0.7734 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.773
[S16] round=29 local utility u=0.000000 metrics={'f1_val': 0.8579232833012491, 'auprc': 0.9918766646506714, 'loss_val': 0.6218301292631288, 'psi': 0.9115046358410179}-{'f1_val': 0.9900043656004349, 'auprc': 0.9968581038091637, 'loss_val': 0.06165643616584169, 'psi': 0.9927458608839264}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=29 head_norm_before_train=1.414904 cos_to_last_merge=0.7004 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.700
[S17] round=29 local utility u=0.000000 metrics={'f1_val': 0.5990289808281967, 'auprc': 0.8159250621816216, 'loss_val': 1.0895665881138563, 'psi': 0.6857874133695667}-{'f1_val': 0.7199610074637117, 'auprc': 0.7192029651754029, 'loss_val': 1.0116077370306027, 'psi': 0.7196577905483882}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=30 head_norm_before_train=1.331791 cos_to_last_merge=0.9902 (last merge round=21)
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.6909590907441554, 'auprc': 0.658461724914595, 'loss_val': 0.3538309296162055, 'psi': 0.6779601444123313}-{'f1_val': 0.6980899663930351, 'auprc': 0.6579501459542708, 'loss_val': 0.36099776837013664, 'psi': 0.6820340382175294}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=30 head_norm_before_train=1.221459 cos_to_last_merge=0.9632 (last merge round=22)
[S3] round=30 local utility u=0.000000 metrics={'f1_val': 0.8415760183566664, 'auprc': 0.9683581643739517, 'loss_val': 0.28499513633406925, 'psi': 0.8922888767635806}-{'f1_val': 0.9230702398650977, 'auprc': 0.9959544197924044, 'loss_val': 0.2208673442446683, 'psi': 0.9522239118360204}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=30 head_norm_before_train=1.325481 cos_to_last_merge=0.9852 (last merge round=20)
[S4] round=30 local utility u=0.005710 metrics={'f1_val': 0.6113395615537162, 'auprc': 0.9418403328583861, 'loss_val': 0.5092953966043533, 'psi': 0.7435398700755842}-{'f1_val': 0.6124875911436954, 'auprc': 0.9413032803863289, 'loss_val': 0.5259929102183435, 'psi': 0.7440138668407489}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] sending update (kind=head size=1794 to 1 peers)
[S5] START round=30 head_norm_before_train=1.297993 cos_to_last_merge=0.9500 (last merge round=20)
[S5] ⚠️ Model drifted since last merge! cos=0.950
[S5] round=30 local utility u=0.000000 metrics={'f1_val': 0.7132641443756942, 'auprc': 0.7951116043439409, 'loss_val': 0.526698834888424, 'psi': 0.7460031283629929}-{'f1_val': 0.700320598491359, 'auprc': 0.9973860431390037, 'loss_val': 0.26038545165675825, 'psi': 0.8191467763504169}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=30 head_norm_before_train=1.329227 cos_to_last_merge=0.9916 (last merge round=22)
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.7690295555118427, 'auprc': 0.9563585984191236, 'loss_val': 0.5370440931583231, 'psi': 0.8439611726747551}-{'f1_val': 0.9625838036603064, 'auprc': 0.9661815726431189, 'loss_val': 0.1748884315526309, 'psi': 0.9640229112534313}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=30 head_norm_before_train=1.536419 cos_to_last_merge=0.9962 (last merge round=20)
[S7] round=30 local utility u=0.000000 metrics={'f1_val': 0.5404579883244451, 'auprc': 0.7803833981600568, 'loss_val': 0.9056241051782125, 'psi': 0.6364281522586898}-{'f1_val': 0.8912825512402229, 'auprc': 0.9920805197396063, 'loss_val': 0.20313242570938214, 'psi': 0.9316017386399762}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=30 head_norm_before_train=1.411242 cos_to_last_merge=0.9576 (last merge round=21)
[S8] round=30 local utility u=0.000000 metrics={'f1_val': 0.9933434229799246, 'auprc': 0.9857899752223906, 'loss_val': 0.06256290603633882, 'psi': 0.9903220438769111}-{'f1_val': 0.9942788405856967, 'auprc': 0.9936580918178931, 'loss_val': 0.062361055346383844, 'psi': 0.9940305410785752}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=30 head_norm_before_train=1.929824 (no previous merge yet)
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.9964354604519897, 'auprc': 0.9984822362448846, 'loss_val': 0.0221185851409057, 'psi': 0.9972541707691477}-{'f1_val': 0.9971029125121428, 'auprc': 0.9984826606049526, 'loss_val': 0.022112337777991778, 'psi': 0.9976548117492667}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=30 head_norm_before_train=1.541907 cos_to_last_merge=0.9366 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.937
[S10] round=30 local utility u=0.001737 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.991606355037672, 'loss_val': 0.047367420763188096, 'psi': 0.9934411750207186}-{'f1_val': 0.9935679896985945, 'auprc': 0.993250378559441, 'loss_val': 0.04919416718649981, 'psi': 0.993440945242933}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=30 head_norm_before_train=1.438301 cos_to_last_merge=0.9409 (last merge round=17)
[S11] ⚠️ Model drifted since last merge! cos=0.941
[S11] round=30 local utility u=0.010019 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9959608579648533, 'loss_val': 0.06389682401492494, 'psi': 0.9963125458940951}-{'f1_val': 0.9940327724445256, 'auprc': 0.9974823532393995, 'loss_val': 0.07341407843164664, 'psi': 0.9954126047624752}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=30 head_norm_before_train=1.741107 (no previous merge yet)
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.6161069053030819, 'auprc': 0.7080031757988479, 'loss_val': 0.8260961662477079, 'psi': 0.6528654135013883}-{'f1_val': 0.6243936095016916, 'auprc': 0.6984042540074902, 'loss_val': 0.769172390084178, 'psi': 0.653997867304011}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=30 head_norm_before_train=1.701236 cos_to_last_merge=0.9859 (last merge round=18)
[S14] round=30 local utility u=0.161264 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9989705404026994, 'loss_val': 0.02814814481768318, 'psi': 0.9980331778621151}-{'f1_val': 0.9514171302668645, 'auprc': 0.9986259654205412, 'loss_val': 0.07369623679227388, 'psi': 0.9703006643283352}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=30 head_norm_before_train=1.645157 cos_to_last_merge=0.7503 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.750
[S15] round=30 local utility u=0.127560 metrics={'f1_val': 0.8128262594520452, 'auprc': 0.9854591397662392, 'loss_val': 0.29980061477151965, 'psi': 0.8818794115777229}-{'f1_val': 0.7918454087239047, 'auprc': 0.9584263497038221, 'loss_val': 0.347936349301728, 'psi': 0.8584777851158717}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=30 head_norm_before_train=1.710351 cos_to_last_merge=0.7721 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.772
[S16] round=30 local utility u=0.694461 metrics={'f1_val': 0.9912903607592433, 'auprc': 0.9971932330000174, 'loss_val': 0.049059852785560805, 'psi': 0.9936515096555529}-{'f1_val': 0.8579232833012491, 'auprc': 0.9918766646506714, 'loss_val': 0.6218301292631288, 'psi': 0.9115046358410179}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=30 head_norm_before_train=1.435510 cos_to_last_merge=0.6977 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.698
[S17] round=30 local utility u=0.413396 metrics={'f1_val': 0.6995774334671863, 'auprc': 0.8382331743875655, 'loss_val': 0.932990284688421, 'psi': 0.755039729835338}-{'f1_val': 0.5990289808281967, 'auprc': 0.8159250621816216, 'loss_val': 1.0895665881138563, 'psi': 0.6857874133695667}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S2] START round=31 head_norm_before_train=1.346555 cos_to_last_merge=0.9893 (last merge round=21)
[S2] round=31 local utility u=0.132590 metrics={'f1_val': 0.7057168390333979, 'auprc': 0.7626271385014743, 'loss_val': 0.48969377539838, 'psi': 0.7284809588206285}-{'f1_val': 0.6909590907441554, 'auprc': 0.658461724914595, 'loss_val': 0.3538309296162055, 'psi': 0.6779601444123313}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=31 head_norm_before_train=1.248430 cos_to_last_merge=0.9586 (last merge round=22)
[S3] round=31 local utility u=0.596073 metrics={'f1_val': 0.9971202529699166, 'auprc': 0.9972045462407789, 'loss_val': 0.11265313315074912, 'psi': 0.9971539702782615}-{'f1_val': 0.8415760183566664, 'auprc': 0.9683581643739517, 'loss_val': 0.28499513633406925, 'psi': 0.8922888767635806}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=31 head_norm_before_train=1.340279 cos_to_last_merge=0.9848 (last merge round=20)
[S4] round=31 local utility u=0.011831 metrics={'f1_val': 0.610787026914747, 'auprc': 0.9504002973255358, 'loss_val': 0.5079988499597026, 'psi': 0.7466323350790625}-{'f1_val': 0.6113395615537162, 'auprc': 0.9418403328583861, 'loss_val': 0.5092953966043533, 'psi': 0.7435398700755842}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] sending update (kind=head size=1792 to 1 peers)
[S5] START round=31 head_norm_before_train=1.314498 cos_to_last_merge=0.9472 (last merge round=20)
[S5] ⚠️ Model drifted since last merge! cos=0.947
[S5] round=31 local utility u=0.404891 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9970336760640965, 'loss_val': 0.24502258515174194, 'psi': 0.8190058295204541}-{'f1_val': 0.7132641443756942, 'auprc': 0.7951116043439409, 'loss_val': 0.526698834888424, 'psi': 0.7460031283629929}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[S6] START round=31 head_norm_before_train=1.344915 cos_to_last_merge=0.9901 (last merge round=22)
[S6] round=31 local utility u=0.580060 metrics={'f1_val': 0.9192813466321546, 'auprc': 0.9604374118645136, 'loss_val': 0.2906707928375917, 'psi': 0.9357437727250982}-{'f1_val': 0.7690295555118427, 'auprc': 0.9563585984191236, 'loss_val': 0.5370440931583231, 'psi': 0.8439611726747551}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=31 head_norm_before_train=1.542590 cos_to_last_merge=0.9958 (last merge round=20)
[S7] round=31 local utility u=1.000000 metrics={'f1_val': 0.8653459187217678, 'auprc': 0.9650976257542223, 'loss_val': 0.268287095114203, 'psi': 0.9052466015347496}-{'f1_val': 0.5404579883244451, 'auprc': 0.7803833981600568, 'loss_val': 0.9056241051782125, 'psi': 0.6364281522586898}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=31 head_norm_before_train=1.436208 cos_to_last_merge=0.9543 (last merge round=21)
[S8] round=31 local utility u=0.002264 metrics={'f1_val': 0.9877103541603912, 'auprc': 0.9989699798413372, 'loss_val': 0.06377736241925348, 'psi': 0.9922142044327695}-{'f1_val': 0.9933434229799246, 'auprc': 0.9857899752223906, 'loss_val': 0.06256290603633882, 'psi': 0.9903220438769111}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] START round=31 head_norm_before_train=1.939919 (no previous merge yet)
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9956128353966386, 'loss_val': 0.021884732292326445, 'psi': 0.9965068816659411}-{'f1_val': 0.9964354604519897, 'auprc': 0.9984822362448846, 'loss_val': 0.0221185851409057, 'psi': 0.9972541707691477}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=31 head_norm_before_train=1.568833 cos_to_last_merge=0.9342 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.934
[S10] round=31 local utility u=0.000000 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9932116171283332, 'loss_val': 0.04667882270652717, 'psi': 0.9934254406704899}-{'f1_val': 0.9946643883427498, 'auprc': 0.991606355037672, 'loss_val': 0.047367420763188096, 'psi': 0.9934411750207186}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=31 head_norm_before_train=1.469994 cos_to_last_merge=0.9359 (last merge round=17)
[S11] ⚠️ Model drifted since last merge! cos=0.936
[S11] round=31 local utility u=0.000000 metrics={'f1_val': 0.8780704686868525, 'auprc': 0.9950793463507557, 'loss_val': 0.17177979942339958, 'psi': 0.9248740197524137}-{'f1_val': 0.9965470045135896, 'auprc': 0.9959608579648533, 'loss_val': 0.06389682401492494, 'psi': 0.9963125458940951}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=31 head_norm_before_train=1.749127 (no previous merge yet)
[S13] round=31 local utility u=0.076849 metrics={'f1_val': 0.6235603180651017, 'auprc': 0.7314187770654708, 'loss_val': 0.7873645965213744, 'psi': 0.6667037016652493}-{'f1_val': 0.6161069053030819, 'auprc': 0.7080031757988479, 'loss_val': 0.8260961662477079, 'psi': 0.6528654135013883}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=31 head_norm_before_train=1.716064 cos_to_last_merge=0.9852 (last merge round=18)
[S14] round=31 local utility u=0.001573 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9986434290129165, 'loss_val': 0.025477283492973724, 'psi': 0.9980480424350787}-{'f1_val': 0.9974082695017256, 'auprc': 0.9989705404026994, 'loss_val': 0.02814814481768318, 'psi': 0.9980331778621151}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=31 head_norm_before_train=1.661407 cos_to_last_merge=0.7483 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.748
[S15] round=31 local utility u=0.270425 metrics={'f1_val': 0.8821598641893343, 'auprc': 0.9907245523451337, 'loss_val': 0.19074814406025972, 'psi': 0.925585739451654}-{'f1_val': 0.8128262594520452, 'auprc': 0.9854591397662392, 'loss_val': 0.29980061477151965, 'psi': 0.8818794115777229}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] sending update (kind=head size=1803 to 1 peers)
[S16] START round=31 head_norm_before_train=1.723430 cos_to_last_merge=0.7715 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.772
[S16] round=31 local utility u=0.000000 metrics={'f1_val': 0.9911095318775243, 'auprc': 0.9940449630422585, 'loss_val': 0.047332973555592614, 'psi': 0.9922837043434181}-{'f1_val': 0.9912903607592433, 'auprc': 0.9971932330000174, 'loss_val': 0.049059852785560805, 'psi': 0.9936515096555529}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=31 head_norm_before_train=1.454955 cos_to_last_merge=0.6952 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.695
[S17] round=31 local utility u=0.000000 metrics={'f1_val': 0.670519857087214, 'auprc': 0.8149671078969855, 'loss_val': 0.9867729615218909, 'psi': 0.7282987574111226}-{'f1_val': 0.6995774334671863, 'auprc': 0.8382331743875655, 'loss_val': 0.932990284688421, 'psi': 0.755039729835338}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=32 head_norm_before_train=1.360340 cos_to_last_merge=0.9885 (last merge round=21)
[S2] round=32 local utility u=0.000000 metrics={'f1_val': 0.7142465743160399, 'auprc': 0.7716485798244528, 'loss_val': 0.6025469983458389, 'psi': 0.737207376519405}-{'f1_val': 0.7057168390333979, 'auprc': 0.7626271385014743, 'loss_val': 0.48969377539838, 'psi': 0.7284809588206285}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=32 head_norm_before_train=1.270449 cos_to_last_merge=0.9548 (last merge round=22)
[S3] round=32 local utility u=0.000000 metrics={'f1_val': 0.9021338844823734, 'auprc': 0.9997534775393879, 'loss_val': 0.2237411010513569, 'psi': 0.9411817217051792}-{'f1_val': 0.9971202529699166, 'auprc': 0.9972045462407789, 'loss_val': 0.11265313315074912, 'psi': 0.9971539702782615}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=32 head_norm_before_train=1.356221 cos_to_last_merge=0.9839 (last merge round=20)
[S4] round=32 local utility u=0.003262 metrics={'f1_val': 0.6119973936679804, 'auprc': 0.9498716898024493, 'loss_val': 0.5071520297492854, 'psi': 0.747147112121768}-{'f1_val': 0.610787026914747, 'auprc': 0.9504002973255358, 'loss_val': 0.5079988499597026, 'psi': 0.7466323350790625}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] sending update (kind=head size=1805 to 1 peers)
[S5] START round=32 head_norm_before_train=1.325891 cos_to_last_merge=0.9448 (last merge round=20)
[S5] ⚠️ Model drifted since last merge! cos=0.945
[S5] round=32 local utility u=0.001110 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9954431487087414, 'loss_val': 0.23803129525288574, 'psi': 0.818369618578312}-{'f1_val': 0.700320598491359, 'auprc': 0.9970336760640965, 'loss_val': 0.24502258515174194, 'psi': 0.8190058295204541}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[S6] START round=32 head_norm_before_train=1.358057 cos_to_last_merge=0.9888 (last merge round=22)
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.7218053554458158, 'auprc': 0.94268889648484, 'loss_val': 0.6031261769883521, 'psi': 0.8101587718614256}-{'f1_val': 0.9192813466321546, 'auprc': 0.9604374118645136, 'loss_val': 0.2906707928375917, 'psi': 0.9357437727250982}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=32 head_norm_before_train=1.547470 cos_to_last_merge=0.9955 (last merge round=20)
[S7] round=32 local utility u=0.000000 metrics={'f1_val': 0.5079663895443578, 'auprc': 0.78058298177356, 'loss_val': 1.0043929647391412, 'psi': 0.6170130264360387}-{'f1_val': 0.8653459187217678, 'auprc': 0.9650976257542223, 'loss_val': 0.268287095114203, 'psi': 0.9052466015347496}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=32 head_norm_before_train=1.459018 cos_to_last_merge=0.9514 (last merge round=21)
[S8] round=32 local utility u=0.019222 metrics={'f1_val': 0.9924515537855688, 'auprc': 0.9982739302150517, 'loss_val': 0.05169196303155515, 'psi': 0.994780504357362}-{'f1_val': 0.9877103541603912, 'auprc': 0.9989699798413372, 'loss_val': 0.06377736241925348, 'psi': 0.9922142044327695}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] START round=32 head_norm_before_train=1.951212 (no previous merge yet)
[S9] round=32 local utility u=0.001538 metrics={'f1_val': 0.9960207019771873, 'auprc': 0.998877803362699, 'loss_val': 0.022109567117813856, 'psi': 0.9971635425313919}-{'f1_val': 0.9971029125121428, 'auprc': 0.9956128353966386, 'loss_val': 0.021884732292326445, 'psi': 0.9965068816659411}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=32 head_norm_before_train=1.588847 cos_to_last_merge=0.9320 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.932
[S10] round=32 local utility u=0.000000 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9929188721981026, 'loss_val': 0.04742396642901654, 'psi': 0.9933083426983977}-{'f1_val': 0.9935679896985945, 'auprc': 0.9932116171283332, 'loss_val': 0.04667882270652717, 'psi': 0.9934254406704899}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=32 head_norm_before_train=1.498949 cos_to_last_merge=0.9313 (last merge round=17)
[S11] ⚠️ Model drifted since last merge! cos=0.931
[S11] round=32 local utility u=0.420033 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.996934733049123, 'loss_val': 0.048139099617581865, 'psi': 0.9967020959278029}-{'f1_val': 0.8780704686868525, 'auprc': 0.9950793463507557, 'loss_val': 0.17177979942339958, 'psi': 0.9248740197524137}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=32 head_norm_before_train=1.752770 (no previous merge yet)
[S13] round=32 local utility u=0.019758 metrics={'f1_val': 0.624802027808999, 'auprc': 0.727381126377137, 'loss_val': 0.7431858588363229, 'psi': 0.6658336672362541}-{'f1_val': 0.6235603180651017, 'auprc': 0.7314187770654708, 'loss_val': 0.7873645965213744, 'psi': 0.6667037016652493}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=32 head_norm_before_train=1.726576 cos_to_last_merge=0.9842 (last merge round=18)
[S14] round=32 local utility u=0.000000 metrics={'f1_val': 0.913322047081722, 'auprc': 0.9982383715120153, 'loss_val': 0.24241573434867747, 'psi': 0.9472885768538393}-{'f1_val': 0.9976511180498535, 'auprc': 0.9986434290129165, 'loss_val': 0.025477283492973724, 'psi': 0.9980480424350787}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=32 head_norm_before_train=1.676387 cos_to_last_merge=0.7462 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.746
[S15] round=32 local utility u=0.000000 metrics={'f1_val': 0.8300969105604019, 'auprc': 0.9896447014593769, 'loss_val': 0.25571136622872565, 'psi': 0.893916026919992}-{'f1_val': 0.8821598641893343, 'auprc': 0.9907245523451337, 'loss_val': 0.19074814406025972, 'psi': 0.925585739451654}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=32 head_norm_before_train=1.735234 cos_to_last_merge=0.7711 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.771
[S16] round=32 local utility u=0.000000 metrics={'f1_val': 0.9406871627715536, 'auprc': 0.9935135339961058, 'loss_val': 0.17733471395200398, 'psi': 0.9618177112613744}-{'f1_val': 0.9911095318775243, 'auprc': 0.9940449630422585, 'loss_val': 0.047332973555592614, 'psi': 0.9922837043434181}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=32 head_norm_before_train=1.471549 cos_to_last_merge=0.6933 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.693
[S17] round=32 local utility u=0.000000 metrics={'f1_val': 0.5933877253915181, 'auprc': 0.8158472254188428, 'loss_val': 1.1291729105303694, 'psi': 0.682371525402448}-{'f1_val': 0.670519857087214, 'auprc': 0.8149671078969855, 'loss_val': 0.9867729615218909, 'psi': 0.7282987574111226}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=33 head_norm_before_train=1.373017 cos_to_last_merge=0.9877 (last merge round=21)
[S2] round=33 local utility u=0.064465 metrics={'f1_val': 0.7109936363988045, 'auprc': 0.7911948537060924, 'loss_val': 0.5127375874776592, 'psi': 0.7430741233217197}-{'f1_val': 0.7142465743160399, 'auprc': 0.7716485798244528, 'loss_val': 0.6025469983458389, 'psi': 0.737207376519405}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=33 head_norm_before_train=1.288908 cos_to_last_merge=0.9513 (last merge round=22)
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.7667622996458165, 'auprc': 0.9715978086827106, 'loss_val': 0.3900048253451918, 'psi': 0.8486965032605742}-{'f1_val': 0.9021338844823734, 'auprc': 0.9997534775393879, 'loss_val': 0.2237411010513569, 'psi': 0.9411817217051792}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=33 head_norm_before_train=1.371269 cos_to_last_merge=0.9825 (last merge round=20)
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.6110122984687874, 'auprc': 0.9490720401380457, 'loss_val': 0.5090782348234721, 'psi': 0.7462361951364906}-{'f1_val': 0.6119973936679804, 'auprc': 0.9498716898024493, 'loss_val': 0.5071520297492854, 'psi': 0.747147112121768}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=33 head_norm_before_train=1.337621 cos_to_last_merge=0.9430 (last merge round=20)
[S5] ⚠️ Model drifted since last merge! cos=0.943
[S5] round=33 local utility u=0.004905 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9973865735653918, 'loss_val': 0.23405185163325512, 'psi': 0.8191469885209721}-{'f1_val': 0.700320598491359, 'auprc': 0.9954431487087414, 'loss_val': 0.23803129525288574, 'psi': 0.818369618578312}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=33 head_norm_before_train=1.371699 cos_to_last_merge=0.9872 (last merge round=22)
[S6] round=33 local utility u=0.656778 metrics={'f1_val': 0.8698519068195505, 'auprc': 0.9646635214765553, 'loss_val': 0.2437732453367209, 'psi': 0.9077765526823524}-{'f1_val': 0.7218053554458158, 'auprc': 0.94268889648484, 'loss_val': 0.6031261769883521, 'psi': 0.8101587718614256}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S6] sending update (kind=head size=1808 to 1 peers)
[S7] START round=33 head_norm_before_train=1.551391 cos_to_last_merge=0.9952 (last merge round=20)
[S7] round=33 local utility u=1.000000 metrics={'f1_val': 0.7422760771636792, 'auprc': 0.9160068011942607, 'loss_val': 0.2954988702439374, 'psi': 0.8117683667759117}-{'f1_val': 0.5079663895443578, 'auprc': 0.78058298177356, 'loss_val': 1.0043929647391412, 'psi': 0.6170130264360387}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=33 head_norm_before_train=1.479467 cos_to_last_merge=0.9489 (last merge round=21)
[S8] ⚠️ Model drifted since last merge! cos=0.949
[S8] round=33 local utility u=0.000465 metrics={'f1_val': 0.992384245702453, 'auprc': 0.9986514279657603, 'loss_val': 0.051490991119705426, 'psi': 0.9948911186077759}-{'f1_val': 0.9924515537855688, 'auprc': 0.9982739302150517, 'loss_val': 0.05169196303155515, 'psi': 0.994780504357362}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=33 head_norm_before_train=1.961511 (no previous merge yet)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9962234985508501, 'loss_val': 0.021262111483679156, 'psi': 0.9967511469276258}-{'f1_val': 0.9960207019771873, 'auprc': 0.998877803362699, 'loss_val': 0.022109567117813856, 'psi': 0.9971635425313919}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=33 head_norm_before_train=1.609300 cos_to_last_merge=0.9298 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.930
[S10] round=33 local utility u=0.000000 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9927917567300356, 'loss_val': 0.04716046275063905, 'psi': 0.9932574965111709}-{'f1_val': 0.9935679896985945, 'auprc': 0.9929188721981026, 'loss_val': 0.04742396642901654, 'psi': 0.9933083426983977}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=33 head_norm_before_train=1.526559 cos_to_last_merge=0.9270 (last merge round=17)
[S11] ⚠️ Model drifted since last merge! cos=0.927
[S11] round=33 local utility u=0.000000 metrics={'f1_val': 0.9948729078564705, 'auprc': 0.9960129957478485, 'loss_val': 0.04752403301877253, 'psi': 0.9953289430130218}-{'f1_val': 0.9965470045135896, 'auprc': 0.996934733049123, 'loss_val': 0.048139099617581865, 'psi': 0.9967020959278029}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=33 head_norm_before_train=1.761047 (no previous merge yet)
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.587099583645349, 'auprc': 0.6466264015807017, 'loss_val': 0.9599259233820665, 'psi': 0.6109103108194901}-{'f1_val': 0.624802027808999, 'auprc': 0.727381126377137, 'loss_val': 0.7431858588363229, 'psi': 0.6658336672362541}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=33 head_norm_before_train=1.735168 cos_to_last_merge=0.9834 (last merge round=18)
[S14] round=33 local utility u=0.361364 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9990186039229654, 'loss_val': 0.026546467959243387, 'psi': 0.9980524032702215}-{'f1_val': 0.913322047081722, 'auprc': 0.9982383715120153, 'loss_val': 0.24241573434867747, 'psi': 0.9472885768538393}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=33 head_norm_before_train=1.690311 cos_to_last_merge=0.7443 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.744
[S15] round=33 local utility u=0.000000 metrics={'f1_val': 0.7651281576711961, 'auprc': 0.9148438794528485, 'loss_val': 0.4243683164043407, 'psi': 0.8250144463838571}-{'f1_val': 0.8300969105604019, 'auprc': 0.9896447014593769, 'loss_val': 0.25571136622872565, 'psi': 0.893916026919992}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=33 head_norm_before_train=1.746538 cos_to_last_merge=0.7701 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.770
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.9387965906225975, 'auprc': 0.9910407990508223, 'loss_val': 0.25931528670653325, 'psi': 0.9596942739938874}-{'f1_val': 0.9406871627715536, 'auprc': 0.9935135339961058, 'loss_val': 0.17733471395200398, 'psi': 0.9618177112613744}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=33 head_norm_before_train=1.487501 cos_to_last_merge=0.6918 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.692
[S17] round=33 local utility u=0.371014 metrics={'f1_val': 0.6802072720236609, 'auprc': 0.8263893288564246, 'loss_val': 0.9396888545179334, 'psi': 0.7386800947567664}-{'f1_val': 0.5933877253915181, 'auprc': 0.8158472254188428, 'loss_val': 1.1291729105303694, 'psi': 0.682371525402448}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=34 head_norm_before_train=1.384982 cos_to_last_merge=0.9870 (last merge round=21)
[S2] round=34 local utility u=0.015022 metrics={'f1_val': 0.7046102173429758, 'auprc': 0.7748553399687643, 'loss_val': 0.39537530432887324, 'psi': 0.7327082663932912}-{'f1_val': 0.7109936363988045, 'auprc': 0.7911948537060924, 'loss_val': 0.5127375874776592, 'psi': 0.7430741233217197}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=34 head_norm_before_train=1.305713 cos_to_last_merge=0.9480 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.948
[S3] round=34 local utility u=0.527575 metrics={'f1_val': 0.899400183726389, 'auprc': 0.9972353253372932, 'loss_val': 0.20759488780573207, 'psi': 0.9385342403707506}-{'f1_val': 0.7667622996458165, 'auprc': 0.9715978086827106, 'loss_val': 0.3900048253451918, 'psi': 0.8486965032605742}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=34 head_norm_before_train=1.384936 cos_to_last_merge=0.9809 (last merge round=20)
[S4] round=34 local utility u=0.021451 metrics={'f1_val': 0.6134824854614618, 'auprc': 0.9529718723299145, 'loss_val': 0.49269608882606486, 'psi': 0.7492782402088429}-{'f1_val': 0.6110122984687874, 'auprc': 0.9490720401380457, 'loss_val': 0.5090782348234721, 'psi': 0.7462361951364906}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=34 head_norm_before_train=1.348313 cos_to_last_merge=0.9418 (last merge round=20)
[S5] ⚠️ Model drifted since last merge! cos=0.942
[S5] round=34 local utility u=0.000000 metrics={'f1_val': 0.6907852978656212, 'auprc': 0.7789386971627903, 'loss_val': 0.723355376729579, 'psi': 0.7260466575844888}-{'f1_val': 0.700320598491359, 'auprc': 0.9973865735653918, 'loss_val': 0.23405185163325512, 'psi': 0.8191469885209721}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=34 head_norm_before_train=1.384481 cos_to_last_merge=0.9857 (last merge round=22)
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.6292591654460497, 'auprc': 0.925041422925738, 'loss_val': 0.7086018721037275, 'psi': 0.747572068437925}-{'f1_val': 0.8698519068195505, 'auprc': 0.9646635214765553, 'loss_val': 0.2437732453367209, 'psi': 0.9077765526823524}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=34 head_norm_before_train=1.553753 cos_to_last_merge=0.9951 (last merge round=20)
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.5586739449920943, 'auprc': 0.7802910657814914, 'loss_val': 0.8733105811098859, 'psi': 0.6473207933078532}-{'f1_val': 0.7422760771636792, 'auprc': 0.9160068011942607, 'loss_val': 0.2954988702439374, 'psi': 0.8117683667759117}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=34 head_norm_before_train=1.498066 cos_to_last_merge=0.9464 (last merge round=21)
[S8] ⚠️ Model drifted since last merge! cos=0.946
[S8] round=34 local utility u=0.005308 metrics={'f1_val': 0.9935462653440466, 'auprc': 0.9981630606729119, 'loss_val': 0.04638143733536276, 'psi': 0.9953929834755927}-{'f1_val': 0.992384245702453, 'auprc': 0.9986514279657603, 'loss_val': 0.051490991119705426, 'psi': 0.9948911186077759}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] START round=34 head_norm_before_train=1.971553 (no previous merge yet)
[S9] round=34 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9937438694379955, 'loss_val': 0.021427421180866674, 'psi': 0.9957592952824839}-{'f1_val': 0.9971029125121428, 'auprc': 0.9962234985508501, 'loss_val': 0.021262111483679156, 'psi': 0.9967511469276258}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=34 head_norm_before_train=1.629403 cos_to_last_merge=0.9280 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.928
[S10] round=34 local utility u=0.001265 metrics={'f1_val': 0.9929110311196298, 'auprc': 0.9943901974501796, 'loss_val': 0.045484993212577214, 'psi': 0.9935026976518497}-{'f1_val': 0.9935679896985945, 'auprc': 0.9927917567300356, 'loss_val': 0.04716046275063905, 'psi': 0.9932574965111709}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=34 head_norm_before_train=1.550903 cos_to_last_merge=0.9234 (last merge round=17)
[S11] ⚠️ Model drifted since last merge! cos=0.923
[S11] round=34 local utility u=0.000000 metrics={'f1_val': 0.9923462287884565, 'auprc': 0.9960660208683869, 'loss_val': 0.048206919520685114, 'psi': 0.9938341456204286}-{'f1_val': 0.9948729078564705, 'auprc': 0.9960129957478485, 'loss_val': 0.04752403301877253, 'psi': 0.9953289430130218}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=34 head_norm_before_train=1.770038 (no previous merge yet)
[S13] round=34 local utility u=0.425026 metrics={'f1_val': 0.6378877662378437, 'auprc': 0.7284459030355594, 'loss_val': 0.6600622337721658, 'psi': 0.67411102095693}-{'f1_val': 0.587099583645349, 'auprc': 0.6466264015807017, 'loss_val': 0.9599259233820665, 'psi': 0.6109103108194901}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=34 head_norm_before_train=1.744516 cos_to_last_merge=0.9828 (last merge round=18)
[S14] round=34 local utility u=0.000000 metrics={'f1_val': 0.997233554860182, 'auprc': 0.9990890550799423, 'loss_val': 0.027594183169331123, 'psi': 0.9979757549480861}-{'f1_val': 0.9974082695017256, 'auprc': 0.9990186039229654, 'loss_val': 0.026546467959243387, 'psi': 0.9980524032702215}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=34 head_norm_before_train=1.705389 cos_to_last_merge=0.7420 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.742
[S15] round=34 local utility u=0.983999 metrics={'f1_val': 0.9925925803385894, 'auprc': 0.992905166380399, 'loss_val': 0.05534024061220998, 'psi': 0.9927176147553132}-{'f1_val': 0.7651281576711961, 'auprc': 0.9148438794528485, 'loss_val': 0.4243683164043407, 'psi': 0.8250144463838571}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S15] sending update (kind=head size=1790 to 1 peers)
[S16] START round=34 head_norm_before_train=1.755403 cos_to_last_merge=0.7696 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.770
[S16] round=34 local utility u=0.258518 metrics={'f1_val': 0.9886880196465921, 'auprc': 0.9967607225740159, 'loss_val': 0.05878710927827313, 'psi': 0.9919171008175617}-{'f1_val': 0.9387965906225975, 'auprc': 0.9910407990508223, 'loss_val': 0.25931528670653325, 'psi': 0.9596942739938874}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] sending update (kind=head size=1805 to 1 peers)
[S17] START round=34 head_norm_before_train=1.503901 cos_to_last_merge=0.6903 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.690
[S17] round=34 local utility u=0.000000 metrics={'f1_val': 0.6354672749594337, 'auprc': 0.7926036932764013, 'loss_val': 1.1354957464397735, 'psi': 0.6983218422862207}-{'f1_val': 0.6802072720236609, 'auprc': 0.8263893288564246, 'loss_val': 0.9396888545179334, 'psi': 0.7386800947567664}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=35 head_norm_before_train=1.396804 cos_to_last_merge=0.9862 (last merge round=21)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.5610942868560451, 'auprc': 0.6084866065022223, 'loss_val': 0.9470423964204335, 'psi': 0.580051214714516}-{'f1_val': 0.7046102173429758, 'auprc': 0.7748553399687643, 'loss_val': 0.39537530432887324, 'psi': 0.7327082663932912}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=35 head_norm_before_train=1.324870 cos_to_last_merge=0.9440 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.944
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.6085933253308415, 'auprc': 0.9498200414897716, 'loss_val': 0.8720670260032704, 'psi': 0.7450840117944135}-{'f1_val': 0.899400183726389, 'auprc': 0.9972353253372932, 'loss_val': 0.20759488780573207, 'psi': 0.9385342403707506}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=35 head_norm_before_train=1.397474 cos_to_last_merge=0.9794 (last merge round=20)
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.6136328906235844, 'auprc': 0.9350308949064187, 'loss_val': 0.4860192149729769, 'psi': 0.7421920923367181}-{'f1_val': 0.6134824854614618, 'auprc': 0.9529718723299145, 'loss_val': 0.49269608882606486, 'psi': 0.7492782402088429}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=35 head_norm_before_train=1.360348 cos_to_last_merge=0.9403 (last merge round=20)
[S5] ⚠️ Model drifted since last merge! cos=0.940
[S5] round=35 local utility u=0.605943 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9975413244074698, 'loss_val': 0.22448846274115886, 'psi': 0.8192088888578033}-{'f1_val': 0.6907852978656212, 'auprc': 0.7789386971627903, 'loss_val': 0.723355376729579, 'psi': 0.7260466575844888}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S5] sending update (kind=head size=1808 to 1 peers)
[S6] START round=35 head_norm_before_train=1.398093 cos_to_last_merge=0.9842 (last merge round=22)
[S6] round=35 local utility u=0.602140 metrics={'f1_val': 0.7867055386529984, 'auprc': 0.9518044880120526, 'loss_val': 0.5292901539023686, 'psi': 0.8527451183966201}-{'f1_val': 0.6292591654460497, 'auprc': 0.925041422925738, 'loss_val': 0.7086018721037275, 'psi': 0.747572068437925}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] START round=35 head_norm_before_train=1.556696 cos_to_last_merge=0.9949 (last merge round=20)
[S7] round=35 local utility u=1.000000 metrics={'f1_val': 0.9963286168128579, 'auprc': 0.9980176882551549, 'loss_val': 0.19005267710144008, 'psi': 0.9970042453897767}-{'f1_val': 0.5586739449920943, 'auprc': 0.7802910657814914, 'loss_val': 0.8733105811098859, 'psi': 0.6473207933078532}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] START round=35 head_norm_before_train=1.515784 cos_to_last_merge=0.9441 (last merge round=21)
[S8] ⚠️ Model drifted since last merge! cos=0.944
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.9932775562128633, 'auprc': 0.9953036508458655, 'loss_val': 0.05179391850159155, 'psi': 0.9940879940660641}-{'f1_val': 0.9935462653440466, 'auprc': 0.9981630606729119, 'loss_val': 0.04638143733536276, 'psi': 0.9953929834755927}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=35 head_norm_before_train=1.982170 (no previous merge yet)
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.9909938198082651, 'auprc': 0.9984080513300381, 'loss_val': 0.03278165531231582, 'psi': 0.9939595124169742}-{'f1_val': 0.9971029125121428, 'auprc': 0.9937438694379955, 'loss_val': 0.021427421180866674, 'psi': 0.9957592952824839}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=35 head_norm_before_train=1.646736 cos_to_last_merge=0.9266 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.927
[S10] round=35 local utility u=0.001275 metrics={'f1_val': 0.9940063275949004, 'auprc': 0.9913886709518183, 'loss_val': 0.040502201875920074, 'psi': 0.9929592649376675}-{'f1_val': 0.9929110311196298, 'auprc': 0.9943901974501796, 'loss_val': 0.045484993212577214, 'psi': 0.9935026976518497}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S10] sending update (kind=head size=1807 to 1 peers)
[S11] START round=35 head_norm_before_train=1.571332 cos_to_last_merge=0.9205 (last merge round=17)
[S11] ⚠️ Model drifted since last merge! cos=0.920
[S11] round=35 local utility u=0.000000 metrics={'f1_val': 0.9868054331490699, 'auprc': 0.9963767096772371, 'loss_val': 0.04772554552443942, 'psi': 0.9906339437603368}-{'f1_val': 0.9923462287884565, 'auprc': 0.9960660208683869, 'loss_val': 0.048206919520685114, 'psi': 0.9938341456204286}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=35 head_norm_before_train=1.773841 (no previous merge yet)
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.6189091093662275, 'auprc': 0.6995032186431046, 'loss_val': 0.9070528844474423, 'psi': 0.6511467530769783}-{'f1_val': 0.6378877662378437, 'auprc': 0.7284459030355594, 'loss_val': 0.6600622337721658, 'psi': 0.67411102095693}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=35 head_norm_before_train=1.754210 cos_to_last_merge=0.9822 (last merge round=18)
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.9965992529308234, 'auprc': 0.9986200538501818, 'loss_val': 0.029213492268867887, 'psi': 0.9974075732985668}-{'f1_val': 0.997233554860182, 'auprc': 0.9990890550799423, 'loss_val': 0.027594183169331123, 'psi': 0.9979757549480861}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=35 head_norm_before_train=1.720153 cos_to_last_merge=0.7403 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.740
[S15] round=35 local utility u=0.000000 metrics={'f1_val': 0.6981149461912491, 'auprc': 0.8258942324589884, 'loss_val': 0.5882398149280524, 'psi': 0.7492266606983449}-{'f1_val': 0.9925925803385894, 'auprc': 0.992905166380399, 'loss_val': 0.05534024061220998, 'psi': 0.9927176147553132}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=35 head_norm_before_train=1.765916 cos_to_last_merge=0.7692 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.769
[S16] round=35 local utility u=0.014590 metrics={'f1_val': 0.9908793938683479, 'auprc': 0.9978924377629178, 'loss_val': 0.04615116820686346, 'psi': 0.9936846114261758}-{'f1_val': 0.9886880196465921, 'auprc': 0.9967607225740159, 'loss_val': 0.05878710927827313, 'psi': 0.9919171008175617}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] sending update (kind=head size=1804 to 1 peers)
[S17] START round=35 head_norm_before_train=1.519287 cos_to_last_merge=0.6892 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.689
[S17] round=35 local utility u=0.000000 metrics={'f1_val': 0.42307113060506496, 'auprc': 0.759253076999143, 'loss_val': 2.074114184075129, 'psi': 0.5575439091626961}-{'f1_val': 0.6354672749594337, 'auprc': 0.7926036932764013, 'loss_val': 1.1354957464397735, 'psi': 0.6983218422862207}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=36 head_norm_before_train=1.407496 cos_to_last_merge=0.9854 (last merge round=21)
[S2] round=36 local utility u=0.909056 metrics={'f1_val': 0.7143366776514454, 'auprc': 0.791741995128235, 'loss_val': 0.5981509133466072, 'psi': 0.7452988046421613}-{'f1_val': 0.5610942868560451, 'auprc': 0.6084866065022223, 'loss_val': 0.9470423964204335, 'psi': 0.580051214714516}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=36 head_norm_before_train=1.339718 cos_to_last_merge=0.9404 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.940
[S3] round=36 local utility u=1.000000 metrics={'f1_val': 0.9864684956483967, 'auprc': 0.9996417866976622, 'loss_val': 0.09277046712278361, 'psi': 0.9917378120681029}-{'f1_val': 0.6085933253308415, 'auprc': 0.9498200414897716, 'loss_val': 0.8720670260032704, 'psi': 0.7450840117944135}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=36 head_norm_before_train=1.409712 cos_to_last_merge=0.9781 (last merge round=20)
[S4] round=36 local utility u=0.010683 metrics={'f1_val': 0.6155939955771281, 'auprc': 0.9352666042205255, 'loss_val': 0.47712624771459355, 'psi': 0.7434630390344871}-{'f1_val': 0.6136328906235844, 'auprc': 0.9350308949064187, 'loss_val': 0.4860192149729769, 'psi': 0.7421920923367181}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=36 head_norm_before_train=1.369005 cos_to_last_merge=0.9391 (last merge round=20)
[S5] ⚠️ Model drifted since last merge! cos=0.939
[S5] round=36 local utility u=0.000000 metrics={'f1_val': 0.7144667326210086, 'auprc': 0.7942141990812117, 'loss_val': 0.5792183448403238, 'psi': 0.7463657192050899}-{'f1_val': 0.700320598491359, 'auprc': 0.9975413244074698, 'loss_val': 0.22448846274115886, 'psi': 0.8192088888578033}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=36 head_norm_before_train=1.409895 cos_to_last_merge=0.9830 (last merge round=22)
[S6] round=36 local utility u=0.167769 metrics={'f1_val': 0.8224908936774931, 'auprc': 0.958622160065466, 'loss_val': 0.42891654075596003, 'psi': 0.8769434002326821}-{'f1_val': 0.7867055386529984, 'auprc': 0.9518044880120526, 'loss_val': 0.5292901539023686, 'psi': 0.8527451183966201}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=36 head_norm_before_train=1.561926 cos_to_last_merge=0.9946 (last merge round=20)
[S7] round=36 local utility u=0.000000 metrics={'f1_val': 0.9940741702860401, 'auprc': 0.9951097751400513, 'loss_val': 0.23749632031146958, 'psi': 0.9944884122276445}-{'f1_val': 0.9963286168128579, 'auprc': 0.9980176882551549, 'loss_val': 0.19005267710144008, 'psi': 0.9970042453897767}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=36 head_norm_before_train=1.530459 cos_to_last_merge=0.9423 (last merge round=21)
[S8] ⚠️ Model drifted since last merge! cos=0.942
[S8] round=36 local utility u=0.000000 metrics={'f1_val': 0.9895694841884839, 'auprc': 0.998044614746948, 'loss_val': 0.049985277434777375, 'psi': 0.9929595364118695}-{'f1_val': 0.9932775562128633, 'auprc': 0.9953036508458655, 'loss_val': 0.05179391850159155, 'psi': 0.9940879940660641}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=36 head_norm_before_train=1.991656 (no previous merge yet)
[S9] round=36 local utility u=0.015549 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.99372486640662, 'loss_val': 0.0218264360819932, 'psi': 0.9955054413215053}-{'f1_val': 0.9909938198082651, 'auprc': 0.9984080513300381, 'loss_val': 0.03278165531231582, 'psi': 0.9939595124169742}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=36 head_norm_before_train=1.657988 cos_to_last_merge=0.9256 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.926
[S10] round=36 local utility u=0.000000 metrics={'f1_val': 0.9931299445855843, 'auprc': 0.9932091019331646, 'loss_val': 0.043144520057162856, 'psi': 0.9931616075246165}-{'f1_val': 0.9940063275949004, 'auprc': 0.9913886709518183, 'loss_val': 0.040502201875920074, 'psi': 0.9929592649376675}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=36 head_norm_before_train=1.591963 cos_to_last_merge=0.9175 (last merge round=17)
[S11] ⚠️ Model drifted since last merge! cos=0.918
[S11] round=36 local utility u=0.029000 metrics={'f1_val': 0.9956530465950697, 'auprc': 0.9952266801486676, 'loss_val': 0.03936207796806086, 'psi': 0.9954825000165088}-{'f1_val': 0.9868054331490699, 'auprc': 0.9963767096772371, 'loss_val': 0.04772554552443942, 'psi': 0.9906339437603368}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=36 head_norm_before_train=1.778308 (no previous merge yet)
[S13] round=36 local utility u=0.026272 metrics={'f1_val': 0.6285476096200291, 'auprc': 0.6762494207527336, 'loss_val': 0.8425785147243327, 'psi': 0.6476283340731108}-{'f1_val': 0.6189091093662275, 'auprc': 0.6995032186431046, 'loss_val': 0.9070528844474423, 'psi': 0.6511467530769783}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=36 head_norm_before_train=1.766887 cos_to_last_merge=0.9815 (last merge round=18)
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.9438943112919945, 'auprc': 0.9985282895761425, 'loss_val': 0.09843639655882505, 'psi': 0.9657479026056537}-{'f1_val': 0.9965992529308234, 'auprc': 0.9986200538501818, 'loss_val': 0.029213492268867887, 'psi': 0.9974075732985668}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=36 head_norm_before_train=1.733947 cos_to_last_merge=0.7388 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.739
[S15] round=36 local utility u=0.581792 metrics={'f1_val': 0.7874387229642804, 'auprc': 0.9642212707288595, 'loss_val': 0.3755791570579, 'psi': 0.8581517420701121}-{'f1_val': 0.6981149461912491, 'auprc': 0.8258942324589884, 'loss_val': 0.5882398149280524, 'psi': 0.7492266606983449}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] START round=36 head_norm_before_train=1.775886 cos_to_last_merge=0.7685 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.769
[S16] round=36 local utility u=0.000000 metrics={'f1_val': 0.990660527160834, 'auprc': 0.9979678632496237, 'loss_val': 0.04820246578249202, 'psi': 0.9935834615963499}-{'f1_val': 0.9908793938683479, 'auprc': 0.9978924377629178, 'loss_val': 0.04615116820686346, 'psi': 0.9936846114261758}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=36 head_norm_before_train=1.535408 cos_to_last_merge=0.6885 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.688
[S17] round=36 local utility u=1.000000 metrics={'f1_val': 0.6042667842761842, 'auprc': 0.8164808447336068, 'loss_val': 1.0353296120178779, 'psi': 0.6891524084591533}-{'f1_val': 0.42307113060506496, 'auprc': 0.759253076999143, 'loss_val': 2.074114184075129, 'psi': 0.5575439091626961}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=37 head_norm_before_train=1.415679 cos_to_last_merge=0.9847 (last merge round=21)
[S2] round=37 local utility u=0.000000 metrics={'f1_val': 0.7179862620245359, 'auprc': 0.7841032215992995, 'loss_val': 0.7311939577551497, 'psi': 0.7444330458544413}-{'f1_val': 0.7143366776514454, 'auprc': 0.791741995128235, 'loss_val': 0.5981509133466072, 'psi': 0.7452988046421613}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=37 head_norm_before_train=1.349092 cos_to_last_merge=0.9381 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.938
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.961498813606586, 'auprc': 0.9992955169858885, 'loss_val': 0.10612370925210658, 'psi': 0.976617494958307}-{'f1_val': 0.9864684956483967, 'auprc': 0.9996417866976622, 'loss_val': 0.09277046712278361, 'psi': 0.9917378120681029}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=37 head_norm_before_train=1.424956 cos_to_last_merge=0.9764 (last merge round=20)
[S4] round=37 local utility u=1.000000 metrics={'f1_val': 0.9572110019447545, 'auprc': 0.942862512963676, 'loss_val': 0.40783748218440175, 'psi': 0.951471606352323}-{'f1_val': 0.6155939955771281, 'auprc': 0.9352666042205255, 'loss_val': 0.47712624771459355, 'psi': 0.7434630390344871}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=37 head_norm_before_train=1.375162 cos_to_last_merge=0.9383 (last merge round=20)
[S5] ⚠️ Model drifted since last merge! cos=0.938
[S5] round=37 local utility u=0.448044 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9974414723869721, 'loss_val': 0.20966227851590444, 'psi': 0.8193416245523935}-{'f1_val': 0.7144667326210086, 'auprc': 0.7942141990812117, 'loss_val': 0.5792183448403238, 'psi': 0.7463657192050899}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=37 head_norm_before_train=1.423918 cos_to_last_merge=0.9814 (last merge round=22)
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.8150332232633901, 'auprc': 0.9554042761375964, 'loss_val': 0.5105061610477876, 'psi': 0.8711816444130727}-{'f1_val': 0.8224908936774931, 'auprc': 0.958622160065466, 'loss_val': 0.42891654075596003, 'psi': 0.8769434002326821}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=37 head_norm_before_train=1.565436 cos_to_last_merge=0.9944 (last merge round=20)
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.47340973814825416, 'auprc': 0.7790741932373705, 'loss_val': 1.0432531644293424, 'psi': 0.5956755201839007}-{'f1_val': 0.9940741702860401, 'auprc': 0.9951097751400513, 'loss_val': 0.23749632031146958, 'psi': 0.9944884122276445}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=37 head_norm_before_train=1.541036 cos_to_last_merge=0.9409 (last merge round=21)
[S8] ⚠️ Model drifted since last merge! cos=0.941
[S8] round=37 local utility u=0.007680 metrics={'f1_val': 0.9939539858461368, 'auprc': 0.9925623306874899, 'loss_val': 0.04448523401166065, 'psi': 0.9933973237826781}-{'f1_val': 0.9895694841884839, 'auprc': 0.998044614746948, 'loss_val': 0.049985277434777375, 'psi': 0.9929595364118695}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S8] sending update (kind=head size=1807 to 1 peers)
[S9] START round=37 head_norm_before_train=1.999907 (no previous merge yet)
[S9] round=37 local utility u=0.003998 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9950682589295639, 'loss_val': 0.020324135720844416, 'psi': 0.9962890510791113}-{'f1_val': 0.9966924912647621, 'auprc': 0.99372486640662, 'loss_val': 0.0218264360819932, 'psi': 0.9955054413215053}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=37 head_norm_before_train=1.671918 cos_to_last_merge=0.9243 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.924
[S10] round=37 local utility u=0.000634 metrics={'f1_val': 0.9933489306849028, 'auprc': 0.9928348942554337, 'loss_val': 0.04206813810564596, 'psi': 0.9931433161131152}-{'f1_val': 0.9931299445855843, 'auprc': 0.9932091019331646, 'loss_val': 0.043144520057162856, 'psi': 0.9931616075246165}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=37 head_norm_before_train=1.611799 cos_to_last_merge=0.9147 (last merge round=17)
[S11] ⚠️ Model drifted since last merge! cos=0.915
[S11] round=37 local utility u=0.000000 metrics={'f1_val': 0.8612103816879673, 'auprc': 0.9954604486107753, 'loss_val': 0.16721841312228572, 'psi': 0.9149104084570905}-{'f1_val': 0.9956530465950697, 'auprc': 0.9952266801486676, 'loss_val': 0.03936207796806086, 'psi': 0.9954825000165088}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=37 head_norm_before_train=1.786965 (no previous merge yet)
[S13] round=37 local utility u=0.051772 metrics={'f1_val': 0.6508586855298676, 'auprc': 0.6970620105500869, 'loss_val': 0.9353383679027308, 'psi': 0.6693400155379553}-{'f1_val': 0.6285476096200291, 'auprc': 0.6762494207527336, 'loss_val': 0.8425785147243327, 'psi': 0.6476283340731108}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=37 head_norm_before_train=1.777997 cos_to_last_merge=0.9808 (last merge round=18)
[S14] round=37 local utility u=0.176190 metrics={'f1_val': 0.9928427069198337, 'auprc': 0.9969518140421059, 'loss_val': 0.03501759841123045, 'psi': 0.9944863497687426}-{'f1_val': 0.9438943112919945, 'auprc': 0.9985282895761425, 'loss_val': 0.09843639655882505, 'psi': 0.9657479026056537}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=37 head_norm_before_train=1.747250 cos_to_last_merge=0.7374 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.737
[S15] round=37 local utility u=0.000000 metrics={'f1_val': 0.7851653568397906, 'auprc': 0.9555553595801769, 'loss_val': 0.39503654064486554, 'psi': 0.8533213579359451}-{'f1_val': 0.7874387229642804, 'auprc': 0.9642212707288595, 'loss_val': 0.3755791570579, 'psi': 0.8581517420701121}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=37 head_norm_before_train=1.785065 cos_to_last_merge=0.7679 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.768
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.9893433136313634, 'auprc': 0.9978771903364165, 'loss_val': 0.05413936491446868, 'psi': 0.9927568643133846}-{'f1_val': 0.990660527160834, 'auprc': 0.9979678632496237, 'loss_val': 0.04820246578249202, 'psi': 0.9935834615963499}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=37 head_norm_before_train=1.552051 cos_to_last_merge=0.6876 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.688
[S17] round=37 local utility u=0.098670 metrics={'f1_val': 0.6113196078909863, 'auprc': 0.8495665559541052, 'loss_val': 0.9795631212560298, 'psi': 0.7066183871162339}-{'f1_val': 0.6042667842761842, 'auprc': 0.8164808447336068, 'loss_val': 1.0353296120178779, 'psi': 0.6891524084591533}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S17] sending update (kind=head size=1792 to 1 peers)
[S2] START round=38 head_norm_before_train=1.424469 cos_to_last_merge=0.9838 (last merge round=21)
[S2] round=38 local utility u=0.106260 metrics={'f1_val': 0.7065010687403019, 'auprc': 0.77777505134123, 'loss_val': 0.43077759301182467, 'psi': 0.7350106617806732}-{'f1_val': 0.7179862620245359, 'auprc': 0.7841032215992995, 'loss_val': 0.7311939577551497, 'psi': 0.7444330458544413}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=38 head_norm_before_train=1.358977 cos_to_last_merge=0.9362 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.936
[S3] round=38 local utility u=0.019112 metrics={'f1_val': 0.9642653659854442, 'auprc': 0.9992855866341328, 'loss_val': 0.08446968148863802, 'psi': 0.9782734542449196}-{'f1_val': 0.961498813606586, 'auprc': 0.9992955169858885, 'loss_val': 0.10612370925210658, 'psi': 0.976617494958307}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=38 head_norm_before_train=1.438068 cos_to_last_merge=0.9749 (last merge round=20)
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.9524502459487003, 'auprc': 0.9425767282702233, 'loss_val': 0.4064912390196386, 'psi': 0.9485008388773095}-{'f1_val': 0.9572110019447545, 'auprc': 0.942862512963676, 'loss_val': 0.40783748218440175, 'psi': 0.951471606352323}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=38 head_norm_before_train=1.381750 cos_to_last_merge=0.9374 (last merge round=20)
[S5] ⚠️ Model drifted since last merge! cos=0.937
[S5] round=38 local utility u=0.000000 metrics={'f1_val': 0.7141735531619898, 'auprc': 0.7944520509486784, 'loss_val': 0.542893279624944, 'psi': 0.7462849522766652}-{'f1_val': 0.7006083926626743, 'auprc': 0.9974414723869721, 'loss_val': 0.20966227851590444, 'psi': 0.8193416245523935}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=38 head_norm_before_train=1.439457 cos_to_last_merge=0.9798 (last merge round=22)
[S6] round=38 local utility u=0.000000 metrics={'f1_val': 0.7021721899108123, 'auprc': 0.8612163442918519, 'loss_val': 0.7017788492796526, 'psi': 0.7657898516632282}-{'f1_val': 0.8150332232633901, 'auprc': 0.9554042761375964, 'loss_val': 0.5105061610477876, 'psi': 0.8711816444130727}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=38 head_norm_before_train=1.567199 cos_to_last_merge=0.9942 (last merge round=20)
[S7] round=38 local utility u=1.000000 metrics={'f1_val': 0.7337718715628321, 'auprc': 0.9476285522597675, 'loss_val': 0.2891074375161387, 'psi': 0.8193145438416063}-{'f1_val': 0.47340973814825416, 'auprc': 0.7790741932373705, 'loss_val': 1.0432531644293424, 'psi': 0.5956755201839007}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=38 head_norm_before_train=1.549970 cos_to_last_merge=0.9395 (last merge round=21)
[S8] ⚠️ Model drifted since last merge! cos=0.939
[S8] round=38 local utility u=0.000000 metrics={'f1_val': 0.9879302107862, 'auprc': 0.9989781573870029, 'loss_val': 0.051765628810771715, 'psi': 0.9923493894265212}-{'f1_val': 0.9939539858461368, 'auprc': 0.9925623306874899, 'loss_val': 0.04448523401166065, 'psi': 0.9933973237826781}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=38 head_norm_before_train=2.009236 (no previous merge yet)
[S9] round=38 local utility u=0.002849 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9984460182126741, 'loss_val': 0.019767155118458175, 'psi': 0.9971410247233133}-{'f1_val': 0.9971029125121428, 'auprc': 0.9950682589295639, 'loss_val': 0.020324135720844416, 'psi': 0.9962890510791113}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=38 head_norm_before_train=1.687055 cos_to_last_merge=0.9231 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.923
[S10] round=38 local utility u=0.000000 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9911146560594453, 'loss_val': 0.043141021885148394, 'psi': 0.9925866562429347}-{'f1_val': 0.9933489306849028, 'auprc': 0.9928348942554337, 'loss_val': 0.04206813810564596, 'psi': 0.9931433161131152}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=38 head_norm_before_train=1.629359 cos_to_last_merge=0.9124 (last merge round=17)
[S11] ⚠️ Model drifted since last merge! cos=0.912
[S11] round=38 local utility u=0.465547 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9951441055353316, 'loss_val': 0.04471602084264669, 'psi': 0.9957378471621182}-{'f1_val': 0.8612103816879673, 'auprc': 0.9954604486107753, 'loss_val': 0.16721841312228572, 'psi': 0.9149104084570905}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] sending update (kind=head size=1793 to 1 peers)
[S13] START round=38 head_norm_before_train=1.797252 (no previous merge yet)
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.587525241146654, 'auprc': 0.5932420241469359, 'loss_val': 1.3224128118327845, 'psi': 0.5898119543467668}-{'f1_val': 0.6508586855298676, 'auprc': 0.6970620105500869, 'loss_val': 0.9353383679027308, 'psi': 0.6693400155379553}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=38 head_norm_before_train=1.788196 cos_to_last_merge=0.9801 (last merge round=18)
[S14] round=38 local utility u=0.016013 metrics={'f1_val': 0.9961839019930665, 'auprc': 0.9986559237372328, 'loss_val': 0.028151492869252115, 'psi': 0.997172710690733}-{'f1_val': 0.9928427069198337, 'auprc': 0.9969518140421059, 'loss_val': 0.03501759841123045, 'psi': 0.9944863497687426}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] sending update (kind=head size=1805 to 1 peers)
[S15] START round=38 head_norm_before_train=1.761638 cos_to_last_merge=0.7360 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.736
[S15] round=38 local utility u=0.000000 metrics={'f1_val': 0.7643127369262238, 'auprc': 0.9101405585940721, 'loss_val': 0.462651510532863, 'psi': 0.8226438655933631}-{'f1_val': 0.7851653568397906, 'auprc': 0.9555553595801769, 'loss_val': 0.39503654064486554, 'psi': 0.8533213579359451}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=38 head_norm_before_train=1.792590 cos_to_last_merge=0.7674 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.767
[S16] round=38 local utility u=0.000000 metrics={'f1_val': 0.9880333675283333, 'auprc': 0.9978013965056137, 'loss_val': 0.060831417334532574, 'psi': 0.9919405791192454}-{'f1_val': 0.9893433136313634, 'auprc': 0.9978771903364165, 'loss_val': 0.05413936491446868, 'psi': 0.9927568643133846}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=38 head_norm_before_train=1.569679 cos_to_last_merge=0.6868 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.687
[S17] round=38 local utility u=0.000000 metrics={'f1_val': 0.6120442610580021, 'auprc': 0.8448813158358282, 'loss_val': 0.9849294893120161, 'psi': 0.7051790829691325}-{'f1_val': 0.6113196078909863, 'auprc': 0.8495665559541052, 'loss_val': 0.9795631212560298, 'psi': 0.7066183871162339}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=39 head_norm_before_train=1.433392 cos_to_last_merge=0.9830 (last merge round=21)
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.6865302740599166, 'auprc': 0.8046300260157437, 'loss_val': 0.46529453078429767, 'psi': 0.7337701748422475}-{'f1_val': 0.7065010687403019, 'auprc': 0.77777505134123, 'loss_val': 0.43077759301182467, 'psi': 0.7350106617806732}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=40 psi=0.734 u=0.0000 p_local=0.1259 f1=0.687 auprc=0.805 bytes=37741
[S3] START round=39 head_norm_before_train=1.367976 cos_to_last_merge=0.9346 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.935
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.999647528262115, 'loss_val': 0.09787623765443634, 'psi': 0.9765040625445183}-{'f1_val': 0.9642653659854442, 'auprc': 0.9992855866341328, 'loss_val': 0.08446968148863802, 'psi': 0.9782734542449196}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=40 psi=0.977 u=0.0000 p_local=0.1847 f1=0.961 auprc=1.000 bytes=44912
[S4] START round=39 head_norm_before_train=1.447695 cos_to_last_merge=0.9736 (last merge round=20)
[S4] round=39 local utility u=0.024163 metrics={'f1_val': 0.9572243500618665, 'auprc': 0.9399636367758342, 'loss_val': 0.37897043235475697, 'psi': 0.9503200647474535}-{'f1_val': 0.9524502459487003, 'auprc': 0.9425767282702233, 'loss_val': 0.4064912390196386, 'psi': 0.9485008388773095}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S4] r=40 psi=0.950 u=0.0242 p_local=0.1387 f1=0.957 auprc=0.940 bytes=50314
[S5] START round=39 head_norm_before_train=1.390686 cos_to_last_merge=0.9362 (last merge round=20)
[S5] ⚠️ Model drifted since last merge! cos=0.936
[S5] round=39 local utility u=0.448201 metrics={'f1_val': 0.7015601689343438, 'auprc': 0.9972123119269922, 'loss_val': 0.1790921844586581, 'psi': 0.8198210261314032}-{'f1_val': 0.7141735531619898, 'auprc': 0.7944520509486784, 'loss_val': 0.542893279624944, 'psi': 0.7462849522766652}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S5] r=40 psi=0.820 u=0.4482 p_local=0.2269 f1=0.702 auprc=0.997 bytes=46830
[S6] START round=39 head_norm_before_train=1.450163 cos_to_last_merge=0.9782 (last merge round=22)
[S6] round=39 local utility u=1.000000 metrics={'f1_val': 0.9615266318547113, 'auprc': 0.9646524896603567, 'loss_val': 0.19015531043367517, 'psi': 0.9627769749769695}-{'f1_val': 0.7021721899108123, 'auprc': 0.8612163442918519, 'loss_val': 0.7017788492796526, 'psi': 0.7657898516632282}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S6] r=40 psi=0.963 u=1.0000 p_local=0.3628 f1=0.962 auprc=0.965 bytes=41430
[S7] START round=39 head_norm_before_train=1.568916 cos_to_last_merge=0.9941 (last merge round=20)
[S7] round=39 local utility u=0.000000 metrics={'f1_val': 0.6768087033652772, 'auprc': 0.7965180693135141, 'loss_val': 0.48639973200449854, 'psi': 0.7246924497445719}-{'f1_val': 0.7337718715628321, 'auprc': 0.9476285522597675, 'loss_val': 0.2891074375161387, 'psi': 0.8193145438416063}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] r=40 psi=0.725 u=0.0000 p_local=0.3734 f1=0.677 auprc=0.797 bytes=35955
[S8] START round=39 head_norm_before_train=1.560634 cos_to_last_merge=0.9380 (last merge round=21)
[S8] ⚠️ Model drifted since last merge! cos=0.938
[S8] round=39 local utility u=0.019245 metrics={'f1_val': 0.9931808101287989, 'auprc': 0.9975808902208056, 'loss_val': 0.040587678433799006, 'psi': 0.9949408421656016}-{'f1_val': 0.9879302107862, 'auprc': 0.9989781573870029, 'loss_val': 0.051765628810771715, 'psi': 0.9923493894265212}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] sending update (kind=head size=1805 to 1 peers)
[S8] r=40 psi=0.995 u=0.0192 p_local=0.0114 f1=0.993 auprc=0.998 bytes=50412
[S9] START round=39 head_norm_before_train=2.017965 (no previous merge yet)
[S9] round=39 local utility u=0.002107 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9979031338490884, 'loss_val': 0.018914831157199892, 'psi': 0.997423001046921}-{'f1_val': 0.9962710290637395, 'auprc': 0.9984460182126741, 'loss_val': 0.019767155118458175, 'psi': 0.9971410247233133}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S9] r=40 psi=0.997 u=0.0021 p_local=0.0047 f1=0.997 auprc=0.998 bytes=48517
[S10] START round=39 head_norm_before_train=1.702087 cos_to_last_merge=0.9221 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.922
[S10] round=39 local utility u=0.003494 metrics={'f1_val': 0.9931055226041158, 'auprc': 0.9949004714224847, 'loss_val': 0.04473624578232957, 'psi': 0.9938235021314634}-{'f1_val': 0.9935679896985945, 'auprc': 0.9911146560594453, 'loss_val': 0.043141021885148394, 'psi': 0.9925866562429347}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S10] r=40 psi=0.994 u=0.0035 p_local=0.0043 f1=0.993 auprc=0.995 bytes=55786
[S11] START round=39 head_norm_before_train=1.646001 cos_to_last_merge=0.9102 (last merge round=17)
[S11] ⚠️ Model drifted since last merge! cos=0.910
[S11] round=39 local utility u=0.011094 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9970419580728578, 'loss_val': 0.030701750007695858, 'psi': 0.9967449859372969}-{'f1_val': 0.9961336749133093, 'auprc': 0.9951441055353316, 'loss_val': 0.04471602084264669, 'psi': 0.9957378471621182}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S11] r=40 psi=0.997 u=0.0111 p_local=0.1021 f1=0.997 auprc=0.997 bytes=50262
[S13] START round=39 head_norm_before_train=1.806133 (no previous merge yet)
[S13] round=39 local utility u=0.686952 metrics={'f1_val': 0.6801352796371496, 'auprc': 0.7025400126925596, 'loss_val': 0.832063042373545, 'psi': 0.6890971728593136}-{'f1_val': 0.587525241146654, 'auprc': 0.5932420241469359, 'loss_val': 1.3224128118327845, 'psi': 0.5898119543467668}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S13] r=40 psi=0.689 u=0.6870 p_local=0.1885 f1=0.680 auprc=0.703 bytes=35981
[S14] START round=39 head_norm_before_train=1.800143 cos_to_last_merge=0.9795 (last merge round=18)
[S14] round=39 local utility u=0.000457 metrics={'f1_val': 0.9969167109240578, 'auprc': 0.9986649875521988, 'loss_val': 0.03166117559024461, 'psi': 0.9976160215753141}-{'f1_val': 0.9961839019930665, 'auprc': 0.9986559237372328, 'loss_val': 0.028151492869252115, 'psi': 0.997172710690733}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S14] r=40 psi=0.998 u=0.0005 p_local=0.0528 f1=0.997 auprc=0.999 bytes=44978
[S15] START round=39 head_norm_before_train=1.773788 cos_to_last_merge=0.7346 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.735
[S15] round=39 local utility u=0.861792 metrics={'f1_val': 0.9493464258569221, 'auprc': 0.9908307266204502, 'loss_val': 0.09134033937974374, 'psi': 0.9659401461623334}-{'f1_val': 0.7643127369262238, 'auprc': 0.9101405585940721, 'loss_val': 0.462651510532863, 'psi': 0.8226438655933631}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S15] r=40 psi=0.966 u=0.8618 p_local=0.3413 f1=0.949 auprc=0.991 bytes=43135
[S16] START round=39 head_norm_before_train=1.801801 cos_to_last_merge=0.7669 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.767
[S16] round=39 local utility u=0.000000 metrics={'f1_val': 0.8801129098157529, 'auprc': 0.9909458613079074, 'loss_val': 0.5431510159980646, 'psi': 0.9244460904126147}-{'f1_val': 0.9880333675283333, 'auprc': 0.9978013965056137, 'loss_val': 0.060831417334532574, 'psi': 0.9919405791192454}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=40 psi=0.924 u=0.0000 p_local=0.0447 f1=0.880 auprc=0.991 bytes=39529
[S17] START round=39 head_norm_before_train=1.588522 cos_to_last_merge=0.6861 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.686
[S17] round=39 local utility u=0.038773 metrics={'f1_val': 0.6371978833126588, 'auprc': 0.8219442096928555, 'loss_val': 0.9894944276295253, 'psi': 0.7110964138647375}-{'f1_val': 0.6120442610580021, 'auprc': 0.8448813158358282, 'loss_val': 0.9849294893120161, 'psi': 0.7051790829691325}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S17] r=40 psi=0.711 u=0.0388 p_local=0.1720 f1=0.637 auprc=0.822 bytes=34128
[S2] START round=40 head_norm_before_train=1.443524 cos_to_last_merge=0.9822 (last merge round=21)
[S2] round=40 local utility u=0.008474 metrics={'f1_val': 0.6886107372057653, 'auprc': 0.8068861029709526, 'loss_val': 0.4675969872795049, 'psi': 0.7359208835118403}-{'f1_val': 0.6865302740599166, 'auprc': 0.8046300260157437, 'loss_val': 0.46529453078429767, 'psi': 0.7337701748422475}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=40 head_norm_before_train=1.381172 cos_to_last_merge=0.9322 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.932
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.9599721348864418, 'auprc': 0.9961298548104074, 'loss_val': 0.1067793372478633, 'psi': 0.9744352228560281}-{'f1_val': 0.9610750853994537, 'auprc': 0.999647528262115, 'loss_val': 0.09787623765443634, 'psi': 0.9765040625445183}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=40 head_norm_before_train=1.459399 cos_to_last_merge=0.9715 (last merge round=20)
[S4] round=40 local utility u=0.012483 metrics={'f1_val': 0.9518100701232476, 'auprc': 0.9493597350301862, 'loss_val': 0.3497066030924849, 'psi': 0.9508299360860231}-{'f1_val': 0.9572243500618665, 'auprc': 0.9399636367758342, 'loss_val': 0.37897043235475697, 'psi': 0.9503200647474535}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=40 head_norm_before_train=1.400197 cos_to_last_merge=0.9352 (last merge round=20)
[S5] ⚠️ Model drifted since last merge! cos=0.935
[S5] round=40 local utility u=0.000000 metrics={'f1_val': 0.7143049231465757, 'auprc': 0.7944864944520339, 'loss_val': 0.5195122067490086, 'psi': 0.746377551668759}-{'f1_val': 0.7015601689343438, 'auprc': 0.9972123119269922, 'loss_val': 0.1790921844586581, 'psi': 0.8198210261314032}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=40 head_norm_before_train=1.464232 cos_to_last_merge=0.9770 (last merge round=22)
[S6] round=40 local utility u=0.000000 metrics={'f1_val': 0.6428231970639282, 'auprc': 0.7968053779268824, 'loss_val': 0.8133830306859755, 'psi': 0.70441606940911}-{'f1_val': 0.9615266318547113, 'auprc': 0.9646524896603567, 'loss_val': 0.19015531043367517, 'psi': 0.9627769749769695}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=40 head_norm_before_train=1.574376 cos_to_last_merge=0.9937 (last merge round=20)
[S7] round=40 local utility u=0.000000 metrics={'f1_val': 0.6118492763654614, 'auprc': 0.7850315865508347, 'loss_val': 0.6998920751459621, 'psi': 0.6811222004396107}-{'f1_val': 0.6768087033652772, 'auprc': 0.7965180693135141, 'loss_val': 0.48639973200449854, 'psi': 0.7246924497445719}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=40 head_norm_before_train=1.570728 cos_to_last_merge=0.9368 (last merge round=21)
[S8] ⚠️ Model drifted since last merge! cos=0.937
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.9927475182363883, 'auprc': 0.9983797383713438, 'loss_val': 0.042132971343078425, 'psi': 0.9950004062903705}-{'f1_val': 0.9931808101287989, 'auprc': 0.9975808902208056, 'loss_val': 0.040587678433799006, 'psi': 0.9949408421656016}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=40 head_norm_before_train=2.023337 (no previous merge yet)
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9987577281334106, 'loss_val': 0.020779956672720316, 'psi': 0.9969991222718755}-{'f1_val': 0.9971029125121428, 'auprc': 0.9979031338490884, 'loss_val': 0.018914831157199892, 'psi': 0.997423001046921}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=40 head_norm_before_train=1.716843 cos_to_last_merge=0.9211 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.921
[S10] round=40 local utility u=0.000000 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9913562702679128, 'loss_val': 0.03819506858326575, 'psi': 0.9926833019263218}-{'f1_val': 0.9931055226041158, 'auprc': 0.9949004714224847, 'loss_val': 0.04473624578232957, 'psi': 0.9938235021314634}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=40 head_norm_before_train=1.662271 cos_to_last_merge=0.9080 (last merge round=17)
[S11] ⚠️ Model drifted since last merge! cos=0.908
[S11] round=40 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9969993223347906, 'loss_val': 0.030577209685164915, 'psi': 0.99672793164207}-{'f1_val': 0.9965470045135896, 'auprc': 0.9970419580728578, 'loss_val': 0.030701750007695858, 'psi': 0.9967449859372969}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=40 head_norm_before_train=1.809560 (no previous merge yet)
[S13] round=40 local utility u=0.000000 metrics={'f1_val': 0.6729712799622773, 'auprc': 0.6824924369735056, 'loss_val': 0.9634203809244777, 'psi': 0.6767797427667687}-{'f1_val': 0.6801352796371496, 'auprc': 0.7025400126925596, 'loss_val': 0.832063042373545, 'psi': 0.6890971728593136}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=40 head_norm_before_train=1.808480 cos_to_last_merge=0.9791 (last merge round=18)
[S14] round=40 local utility u=0.003094 metrics={'f1_val': 0.9968006784347707, 'auprc': 0.9986668515729062, 'loss_val': 0.024782345097237837, 'psi': 0.997547147690025}-{'f1_val': 0.9969167109240578, 'auprc': 0.9986649875521988, 'loss_val': 0.03166117559024461, 'psi': 0.9976160215753141}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] START round=40 head_norm_before_train=1.785411 cos_to_last_merge=0.7331 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.733
[S15] round=40 local utility u=0.138661 metrics={'f1_val': 0.9895755059394896, 'auprc': 0.9913418949926408, 'loss_val': 0.05692555246007484, 'psi': 0.99028206156075}-{'f1_val': 0.9493464258569221, 'auprc': 0.9908307266204502, 'loss_val': 0.09134033937974374, 'psi': 0.9659401461623334}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=40 head_norm_before_train=1.810963 cos_to_last_merge=0.7664 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.766
[S16] round=40 local utility u=0.586720 metrics={'f1_val': 0.9909231660592226, 'auprc': 0.9946373364578645, 'loss_val': 0.04564778782809504, 'psi': 0.9924088342186793}-{'f1_val': 0.8801129098157529, 'auprc': 0.9909458613079074, 'loss_val': 0.5431510159980646, 'psi': 0.9244460904126147}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=40 head_norm_before_train=1.605301 cos_to_last_merge=0.6855 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.685
[S17] round=40 local utility u=0.047962 metrics={'f1_val': 0.6261988575715176, 'auprc': 0.8848845624697039, 'loss_val': 1.0163973945727893, 'psi': 0.7296731395307922}-{'f1_val': 0.6371978833126588, 'auprc': 0.8219442096928555, 'loss_val': 0.9894944276295253, 'psi': 0.7110964138647375}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[S2] START round=41 head_norm_before_train=1.455317 cos_to_last_merge=0.9810 (last merge round=21)
[S2] round=41 local utility u=0.000000 metrics={'f1_val': 0.6782026745034163, 'auprc': 0.7923732397316169, 'loss_val': 0.5430827379715704, 'psi': 0.7238709005946966}-{'f1_val': 0.6886107372057653, 'auprc': 0.8068861029709526, 'loss_val': 0.4675969872795049, 'psi': 0.7359208835118403}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=41 head_norm_before_train=1.394563 cos_to_last_merge=0.9297 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.930
[S3] round=41 local utility u=0.145600 metrics={'f1_val': 0.9986372654320868, 'auprc': 0.9996389081622151, 'loss_val': 0.05809711542529243, 'psi': 0.9990379225241381}-{'f1_val': 0.9599721348864418, 'auprc': 0.9961298548104074, 'loss_val': 0.1067793372478633, 'psi': 0.9744352228560281}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] sending update (kind=head size=1792 to 1 peers)
[S4] START round=41 head_norm_before_train=1.469716 cos_to_last_merge=0.9697 (last merge round=20)
[S4] round=41 local utility u=0.046132 metrics={'f1_val': 0.9561056214298711, 'auprc': 0.9592283232147703, 'loss_val': 0.31282262954692, 'psi': 0.9573547021438308}-{'f1_val': 0.9518100701232476, 'auprc': 0.9493597350301862, 'loss_val': 0.3497066030924849, 'psi': 0.9508299360860231}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=41 head_norm_before_train=1.407391 cos_to_last_merge=0.9346 (last merge round=20)
[S5] ⚠️ Model drifted since last merge! cos=0.935
[S5] round=41 local utility u=0.892973 metrics={'f1_val': 0.8505107081005132, 'auprc': 0.9973826087253342, 'loss_val': 0.15948891460509246, 'psi': 0.9092594683504416}-{'f1_val': 0.7143049231465757, 'auprc': 0.7944864944520339, 'loss_val': 0.5195122067490086, 'psi': 0.746377551668759}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=41 head_norm_before_train=1.479862 cos_to_last_merge=0.9756 (last merge round=22)
[S6] round=41 local utility u=0.987637 metrics={'f1_val': 0.8232273324089195, 'auprc': 0.9535759069757307, 'loss_val': 0.3908461578004755, 'psi': 0.875366762235644}-{'f1_val': 0.6428231970639282, 'auprc': 0.7968053779268824, 'loss_val': 0.8133830306859755, 'psi': 0.70441606940911}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] sending update (kind=head size=1805 to 1 peers)
[S7] START round=41 head_norm_before_train=1.584161 cos_to_last_merge=0.9929 (last merge round=20)
[S7] round=41 local utility u=0.260947 metrics={'f1_val': 0.6599074023605577, 'auprc': 0.7999612458665107, 'loss_val': 0.5111358528987191, 'psi': 0.7159289397629389}-{'f1_val': 0.6118492763654614, 'auprc': 0.7850315865508347, 'loss_val': 0.6998920751459621, 'psi': 0.6811222004396107}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=41 head_norm_before_train=1.580113 cos_to_last_merge=0.9357 (last merge round=21)
[S8] ⚠️ Model drifted since last merge! cos=0.936
[S8] round=41 local utility u=0.000000 metrics={'f1_val': 0.9931808101287989, 'auprc': 0.9940271005177306, 'loss_val': 0.03839806675390811, 'psi': 0.9935193262843716}-{'f1_val': 0.9927475182363883, 'auprc': 0.9983797383713438, 'loss_val': 0.042132971343078425, 'psi': 0.9950004062903705}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=41 head_norm_before_train=2.029436 (no previous merge yet)
[S9] round=41 local utility u=0.004969 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9988001871622487, 'loss_val': 0.018626048873786733, 'psi': 0.9977818223721852}-{'f1_val': 0.9958267183641853, 'auprc': 0.9987577281334106, 'loss_val': 0.020779956672720316, 'psi': 0.9969991222718755}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=41 head_norm_before_train=1.729306 cos_to_last_merge=0.9202 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.920
[S10] round=41 local utility u=0.002093 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.992918184475126, 'loss_val': 0.03869423053733946, 'psi': 0.9933080676092071}-{'f1_val': 0.9935679896985945, 'auprc': 0.9913562702679128, 'loss_val': 0.03819506858326575, 'psi': 0.9926833019263218}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=41 head_norm_before_train=1.674278 cos_to_last_merge=0.9063 (last merge round=17)
[S11] ⚠️ Model drifted since last merge! cos=0.906
[S11] round=41 local utility u=0.000000 metrics={'f1_val': 0.9942112624080708, 'auprc': 0.9974685536026121, 'loss_val': 0.034806807620293014, 'psi': 0.9955141788858872}-{'f1_val': 0.9965470045135896, 'auprc': 0.9969993223347906, 'loss_val': 0.030577209685164915, 'psi': 0.99672793164207}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=41 head_norm_before_train=1.812655 (no previous merge yet)
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.6230003825133642, 'auprc': 0.6668812279258799, 'loss_val': 1.077850797654644, 'psi': 0.6405527206783705}-{'f1_val': 0.6729712799622773, 'auprc': 0.6824924369735056, 'loss_val': 0.9634203809244777, 'psi': 0.6767797427667687}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=41 head_norm_before_train=1.816794 cos_to_last_merge=0.9787 (last merge round=18)
[S14] round=41 local utility u=0.003108 metrics={'f1_val': 0.9976711699250648, 'auprc': 0.9986728118838408, 'loss_val': 0.023806639748150008, 'psi': 0.9980718267085752}-{'f1_val': 0.9968006784347707, 'auprc': 0.9986668515729062, 'loss_val': 0.024782345097237837, 'psi': 0.997547147690025}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=41 head_norm_before_train=1.798610 cos_to_last_merge=0.7316 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.732
[S15] round=41 local utility u=0.000000 metrics={'f1_val': 0.8972745688738406, 'auprc': 0.9906407526262672, 'loss_val': 0.17599838051029545, 'psi': 0.9346210423748113}-{'f1_val': 0.9895755059394896, 'auprc': 0.9913418949926408, 'loss_val': 0.05692555246007484, 'psi': 0.99028206156075}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=41 head_norm_before_train=1.817129 cos_to_last_merge=0.7656 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.766
[S16] round=41 local utility u=0.001194 metrics={'f1_val': 0.9902695742637915, 'auprc': 0.9958745760803898, 'loss_val': 0.04304963919330391, 'psi': 0.9925115749904307}-{'f1_val': 0.9909231660592226, 'auprc': 0.9946373364578645, 'loss_val': 0.04564778782809504, 'psi': 0.9924088342186793}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=41 head_norm_before_train=1.623405 cos_to_last_merge=0.6845 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.685
[S17] round=41 local utility u=0.000000 metrics={'f1_val': 0.6202538057881503, 'auprc': 0.855908667014387, 'loss_val': 1.0400791843345416, 'psi': 0.714515750278645}-{'f1_val': 0.6261988575715176, 'auprc': 0.8848845624697039, 'loss_val': 1.0163973945727893, 'psi': 0.7296731395307922}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=42 head_norm_before_train=1.468787 cos_to_last_merge=0.9797 (last merge round=21)
[S2] round=42 local utility u=0.151963 metrics={'f1_val': 0.7113940392814452, 'auprc': 0.8353810734608035, 'loss_val': 0.5673288005792271, 'psi': 0.7609888529531885}-{'f1_val': 0.6782026745034163, 'auprc': 0.7923732397316169, 'loss_val': 0.5430827379715704, 'psi': 0.7238709005946966}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] sending update (kind=head size=1793 to 1 peers)
[S3] START round=42 head_norm_before_train=1.403453 cos_to_last_merge=0.9284 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.928
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.9555470092183185, 'auprc': 0.9969176923429455, 'loss_val': 0.12372973884115379, 'psi': 0.9720952824681692}-{'f1_val': 0.9986372654320868, 'auprc': 0.9996389081622151, 'loss_val': 0.05809711542529243, 'psi': 0.9990379225241381}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=42 head_norm_before_train=1.483939 cos_to_last_merge=0.9673 (last merge round=20)
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.9556564419655367, 'auprc': 0.9361158311356299, 'loss_val': 0.31370840987284593, 'psi': 0.947840197633574}-{'f1_val': 0.9561056214298711, 'auprc': 0.9592283232147703, 'loss_val': 0.31282262954692, 'psi': 0.9573547021438308}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=42 head_norm_before_train=1.412390 cos_to_last_merge=0.9341 (last merge round=20)
[S5] ⚠️ Model drifted since last merge! cos=0.934
[S5] round=42 local utility u=0.000000 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.997309454588294, 'loss_val': 0.1602314561590621, 'psi': 0.8192888174329223}-{'f1_val': 0.8505107081005132, 'auprc': 0.9973826087253342, 'loss_val': 0.15948891460509246, 'psi': 0.9092594683504416}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=42 head_norm_before_train=1.494251 cos_to_last_merge=0.9743 (last merge round=22)
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.6927978034333323, 'auprc': 0.9485095916748946, 'loss_val': 0.6909413141137501, 'psi': 0.7950825187299573}-{'f1_val': 0.8232273324089195, 'auprc': 0.9535759069757307, 'loss_val': 0.3908461578004755, 'psi': 0.875366762235644}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=42 head_norm_before_train=1.595023 cos_to_last_merge=0.9920 (last merge round=20)
[S7] round=42 local utility u=0.173819 metrics={'f1_val': 0.6840909620127515, 'auprc': 0.8245869697203623, 'loss_val': 0.3824757285861219, 'psi': 0.7402893650957958}-{'f1_val': 0.6599074023605577, 'auprc': 0.7999612458665107, 'loss_val': 0.5111358528987191, 'psi': 0.7159289397629389}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=42 head_norm_before_train=1.589239 cos_to_last_merge=0.9346 (last merge round=21)
[S8] ⚠️ Model drifted since last merge! cos=0.935
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.9937185965290795, 'auprc': 0.9882521426269135, 'loss_val': 0.03813905791693901, 'psi': 0.9915320149682131}-{'f1_val': 0.9931808101287989, 'auprc': 0.9940271005177306, 'loss_val': 0.03839806675390811, 'psi': 0.9935193262843716}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=42 head_norm_before_train=2.032609 (no previous merge yet)
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9911560202909577, 'loss_val': 0.021362211623411623, 'psi': 0.9944779028752404}-{'f1_val': 0.9971029125121428, 'auprc': 0.9988001871622487, 'loss_val': 0.018626048873786733, 'psi': 0.9977818223721852}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=42 head_norm_before_train=1.741852 cos_to_last_merge=0.9193 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.919
[S10] round=42 local utility u=0.000000 metrics={'f1_val': 0.9929110311196298, 'auprc': 0.994413475060087, 'loss_val': 0.04124175740378938, 'psi': 0.9935120086958127}-{'f1_val': 0.9935679896985945, 'auprc': 0.992918184475126, 'loss_val': 0.03869423053733946, 'psi': 0.9933080676092071}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=42 head_norm_before_train=1.685704 cos_to_last_merge=0.9047 (last merge round=17)
[S11] ⚠️ Model drifted since last merge! cos=0.905
[S11] round=42 local utility u=0.009098 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.996878500139984, 'loss_val': 0.02885557430178968, 'psi': 0.9966796027641474}-{'f1_val': 0.9942112624080708, 'auprc': 0.9974685536026121, 'loss_val': 0.034806807620293014, 'psi': 0.9955141788858872}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=42 head_norm_before_train=1.814119 (no previous merge yet)
[S13] round=42 local utility u=0.370382 metrics={'f1_val': 0.6754512972006235, 'auprc': 0.7064041450270884, 'loss_val': 0.7703612338811708, 'psi': 0.6878324363312094}-{'f1_val': 0.6230003825133642, 'auprc': 0.6668812279258799, 'loss_val': 1.077850797654644, 'psi': 0.6405527206783705}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=42 head_norm_before_train=1.824358 cos_to_last_merge=0.9784 (last merge round=18)
[S14] round=42 local utility u=0.000087 metrics={'f1_val': 0.9974544106971202, 'auprc': 0.999037809270722, 'loss_val': 0.02342739124125032, 'psi': 0.9980877701265609}-{'f1_val': 0.9976711699250648, 'auprc': 0.9986728118838408, 'loss_val': 0.023806639748150008, 'psi': 0.9980718267085752}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=42 head_norm_before_train=1.811742 cos_to_last_merge=0.7305 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.730
[S15] round=42 local utility u=0.000000 metrics={'f1_val': 0.713475003960441, 'auprc': 0.865454943539723, 'loss_val': 0.5616622973441341, 'psi': 0.7742669797921538}-{'f1_val': 0.8972745688738406, 'auprc': 0.9906407526262672, 'loss_val': 0.17599838051029545, 'psi': 0.9346210423748113}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=42 head_norm_before_train=1.823863 cos_to_last_merge=0.7652 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.765
[S16] round=42 local utility u=0.000000 metrics={'f1_val': 0.8345992938354483, 'auprc': 0.9690583676538429, 'loss_val': 1.0501318760216296, 'psi': 0.8883829233628062}-{'f1_val': 0.9902695742637915, 'auprc': 0.9958745760803898, 'loss_val': 0.04304963919330391, 'psi': 0.9925115749904307}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=42 head_norm_before_train=1.640806 cos_to_last_merge=0.6837 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.684
[S17] round=42 local utility u=0.000000 metrics={'f1_val': 0.6070042131732002, 'auprc': 0.853399211915096, 'loss_val': 1.1694253087049324, 'psi': 0.7055622126699586}-{'f1_val': 0.6202538057881503, 'auprc': 0.855908667014387, 'loss_val': 1.0400791843345416, 'psi': 0.714515750278645}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=43 head_norm_before_train=1.484323 cos_to_last_merge=0.9780 (last merge round=21)
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.7187012987769418, 'auprc': 0.772406706863036, 'loss_val': 0.67767030778513, 'psi': 0.7401834620113794}-{'f1_val': 0.7113940392814452, 'auprc': 0.8353810734608035, 'loss_val': 0.5673288005792271, 'psi': 0.7609888529531885}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=43 head_norm_before_train=1.411467 cos_to_last_merge=0.9275 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.927
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.9154143723123993, 'auprc': 0.9800606893018484, 'loss_val': 0.20658585461361276, 'psi': 0.9412728991081789}-{'f1_val': 0.9555470092183185, 'auprc': 0.9969176923429455, 'loss_val': 0.12372973884115379, 'psi': 0.9720952824681692}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=43 head_norm_before_train=1.497249 cos_to_last_merge=0.9649 (last merge round=20)
[S4] round=43 local utility u=0.044072 metrics={'f1_val': 0.95526994356585, 'auprc': 0.9592602001359929, 'loss_val': 0.29267868428115734, 'psi': 0.9568660461939071}-{'f1_val': 0.9556564419655367, 'auprc': 0.9361158311356299, 'loss_val': 0.31370840987284593, 'psi': 0.947840197633574}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=43 head_norm_before_train=1.416881 cos_to_last_merge=0.9336 (last merge round=20)
[S5] ⚠️ Model drifted since last merge! cos=0.934
[S5] round=43 local utility u=0.000000 metrics={'f1_val': 0.7143049231465757, 'auprc': 0.7945959834832693, 'loss_val': 0.5013394011547103, 'psi': 0.7464213472812531}-{'f1_val': 0.7006083926626743, 'auprc': 0.997309454588294, 'loss_val': 0.1602314561590621, 'psi': 0.8192888174329223}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=43 head_norm_before_train=1.503381 cos_to_last_merge=0.9729 (last merge round=22)
[S6] round=43 local utility u=0.583131 metrics={'f1_val': 0.8242156320650211, 'auprc': 0.9681619249824231, 'loss_val': 0.3721430629014338, 'psi': 0.8817941492319818}-{'f1_val': 0.6927978034333323, 'auprc': 0.9485095916748946, 'loss_val': 0.6909413141137501, 'psi': 0.7950825187299573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S6] sending update (kind=head size=1808 to 1 peers)
[S7] START round=43 head_norm_before_train=1.602835 cos_to_last_merge=0.9913 (last merge round=20)
[S7] round=43 local utility u=0.000000 metrics={'f1_val': 0.5314778008617473, 'auprc': 0.7807714906203198, 'loss_val': 1.093242163765394, 'psi': 0.6311952767651763}-{'f1_val': 0.6840909620127515, 'auprc': 0.8245869697203623, 'loss_val': 0.3824757285861219, 'psi': 0.7402893650957958}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=43 head_norm_before_train=1.599617 cos_to_last_merge=0.9333 (last merge round=21)
[S8] ⚠️ Model drifted since last merge! cos=0.933
[S8] round=43 local utility u=0.010070 metrics={'f1_val': 0.992384245702453, 'auprc': 0.9985889071040588, 'loss_val': 0.041004018583252755, 'psi': 0.9948661102630952}-{'f1_val': 0.9937185965290795, 'auprc': 0.9882521426269135, 'loss_val': 0.03813905791693901, 'psi': 0.9915320149682131}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=43 head_norm_before_train=2.038920 (no previous merge yet)
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.9820167660891372, 'auprc': 0.9825830560375994, 'loss_val': 0.0622937149005415, 'psi': 0.9822432820685221}-{'f1_val': 0.9966924912647621, 'auprc': 0.9911560202909577, 'loss_val': 0.021362211623411623, 'psi': 0.9944779028752404}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=43 head_norm_before_train=1.753614 cos_to_last_merge=0.9184 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.918
[S10] round=43 local utility u=0.000000 metrics={'f1_val': 0.8606285723548656, 'auprc': 0.988285400934777, 'loss_val': 0.3847565954553051, 'psi': 0.9116913037868302}-{'f1_val': 0.9929110311196298, 'auprc': 0.994413475060087, 'loss_val': 0.04124175740378938, 'psi': 0.9935120086958127}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=43 head_norm_before_train=1.697163 cos_to_last_merge=0.9033 (last merge round=17)
[S11] ⚠️ Model drifted since last merge! cos=0.903
[S11] round=43 local utility u=0.000000 metrics={'f1_val': 0.9700845914472345, 'auprc': 0.9956822591949088, 'loss_val': 0.11814752188648729, 'psi': 0.9803236585463042}-{'f1_val': 0.9965470045135896, 'auprc': 0.996878500139984, 'loss_val': 0.02885557430178968, 'psi': 0.9966796027641474}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=43 head_norm_before_train=1.815072 (no previous merge yet)
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.621650992803457, 'auprc': 0.6675338796197815, 'loss_val': 1.0718927372617764, 'psi': 0.6400041475299868}-{'f1_val': 0.6754512972006235, 'auprc': 0.7064041450270884, 'loss_val': 0.7703612338811708, 'psi': 0.6878324363312094}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=43 head_norm_before_train=1.836033 cos_to_last_merge=0.9779 (last merge round=18)
[S14] round=43 local utility u=0.001155 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9990426091245531, 'loss_val': 0.020855696798005245, 'psi': 0.9980620053508567}-{'f1_val': 0.9974544106971202, 'auprc': 0.999037809270722, 'loss_val': 0.02342739124125032, 'psi': 0.9980877701265609}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=43 head_norm_before_train=1.825596 cos_to_last_merge=0.7291 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.729
[S15] round=43 local utility u=0.724509 metrics={'f1_val': 0.846418235417965, 'auprc': 0.991204286509305, 'loss_val': 0.2875511180672993, 'psi': 0.9043326558545011}-{'f1_val': 0.713475003960441, 'auprc': 0.865454943539723, 'loss_val': 0.5616622973441341, 'psi': 0.7742669797921538}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=43 head_norm_before_train=1.830204 cos_to_last_merge=0.7644 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.764
[S16] round=43 local utility u=0.997432 metrics={'f1_val': 0.990466775248826, 'auprc': 0.9908397853764966, 'loss_val': 0.05581653192824334, 'psi': 0.9906159792998942}-{'f1_val': 0.8345992938354483, 'auprc': 0.9690583676538429, 'loss_val': 1.0501318760216296, 'psi': 0.8883829233628062}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=43 head_norm_before_train=1.656121 cos_to_last_merge=0.6829 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.683
[S17] round=43 local utility u=0.000000 metrics={'f1_val': 0.6081320514820447, 'auprc': 0.8332679249636771, 'loss_val': 1.1380580351281433, 'psi': 0.6981864008746976}-{'f1_val': 0.6070042131732002, 'auprc': 0.853399211915096, 'loss_val': 1.1694253087049324, 'psi': 0.7055622126699586}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=44 head_norm_before_train=1.499526 cos_to_last_merge=0.9762 (last merge round=21)
[S2] round=44 local utility u=0.068134 metrics={'f1_val': 0.714554646233609, 'auprc': 0.8184568183295466, 'loss_val': 0.6546718287685468, 'psi': 0.756115515071984}-{'f1_val': 0.7187012987769418, 'auprc': 0.772406706863036, 'loss_val': 0.67767030778513, 'psi': 0.7401834620113794}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=44 head_norm_before_train=1.418673 cos_to_last_merge=0.9262 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.926
[S3] round=44 local utility u=0.000000 metrics={'f1_val': 0.754365745456552, 'auprc': 0.9926188280007453, 'loss_val': 0.5726537067568456, 'psi': 0.8496669784742292}-{'f1_val': 0.9154143723123993, 'auprc': 0.9800606893018484, 'loss_val': 0.20658585461361276, 'psi': 0.9412728991081789}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=44 head_norm_before_train=1.509402 cos_to_last_merge=0.9627 (last merge round=20)
[S4] round=44 local utility u=0.000000 metrics={'f1_val': 0.9521502667743603, 'auprc': 0.9442514274629441, 'loss_val': 0.3046074224282776, 'psi': 0.9489907310497938}-{'f1_val': 0.95526994356585, 'auprc': 0.9592602001359929, 'loss_val': 0.29267868428115734, 'psi': 0.9568660461939071}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=44 head_norm_before_train=1.421018 cos_to_last_merge=0.9332 (last merge round=20)
[S5] ⚠️ Model drifted since last merge! cos=0.933
[S5] round=44 local utility u=1.000000 metrics={'f1_val': 0.9964799208068884, 'auprc': 0.9966981971387479, 'loss_val': 0.15508062864872862, 'psi': 0.9965672313396322}-{'f1_val': 0.7143049231465757, 'auprc': 0.7945959834832693, 'loss_val': 0.5013394011547103, 'psi': 0.7464213472812531}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=44 head_norm_before_train=1.507466 cos_to_last_merge=0.9717 (last merge round=22)
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.7504977305208892, 'auprc': 0.9546758719488582, 'loss_val': 0.5964716476073312, 'psi': 0.8321689870920768}-{'f1_val': 0.8242156320650211, 'auprc': 0.9681619249824231, 'loss_val': 0.3721430629014338, 'psi': 0.8817941492319818}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=44 head_norm_before_train=1.610642 cos_to_last_merge=0.9908 (last merge round=20)
[S7] round=44 local utility u=0.722358 metrics={'f1_val': 0.6554406950642119, 'auprc': 0.8083870351016846, 'loss_val': 0.47515045116845006, 'psi': 0.716619231079201}-{'f1_val': 0.5314778008617473, 'auprc': 0.7807714906203198, 'loss_val': 1.093242163765394, 'psi': 0.6311952767651763}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=44 head_norm_before_train=1.608505 cos_to_last_merge=0.9321 (last merge round=21)
[S8] ⚠️ Model drifted since last merge! cos=0.932
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.9920215160826699, 'auprc': 0.9984995779408306, 'loss_val': 0.04118533295155583, 'psi': 0.9946127408259342}-{'f1_val': 0.992384245702453, 'auprc': 0.9985889071040588, 'loss_val': 0.041004018583252755, 'psi': 0.9948661102630952}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=44 head_norm_before_train=2.045373 (no previous merge yet)
[S9] round=44 local utility u=0.086970 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9958960390866693, 'loss_val': 0.018808569529211873, 'psi': 0.9966201631419535}-{'f1_val': 0.9820167660891372, 'auprc': 0.9825830560375994, 'loss_val': 0.0622937149005415, 'psi': 0.9822432820685221}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=44 head_norm_before_train=1.765212 cos_to_last_merge=0.9174 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.917
[S10] round=44 local utility u=0.576598 metrics={'f1_val': 0.9931055226041158, 'auprc': 0.9938749249593889, 'loss_val': 0.043190563000674836, 'psi': 0.993413283546225}-{'f1_val': 0.8606285723548656, 'auprc': 0.988285400934777, 'loss_val': 0.3847565954553051, 'psi': 0.9116913037868302}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] sending update (kind=head size=1804 to 1 peers)
[S11] START round=44 head_norm_before_train=1.705805 cos_to_last_merge=0.9021 (last merge round=17)
[S11] ⚠️ Model drifted since last merge! cos=0.902
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.885736295797243, 'auprc': 0.9953917647063526, 'loss_val': 0.13740237990530763, 'psi': 0.9295984833608868}-{'f1_val': 0.9700845914472345, 'auprc': 0.9956822591949088, 'loss_val': 0.11814752188648729, 'psi': 0.9803236585463042}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=44 head_norm_before_train=1.817531 (no previous merge yet)
[S13] round=44 local utility u=0.369458 metrics={'f1_val': 0.7151089988087463, 'auprc': 0.6996033745104524, 'loss_val': 0.9899334033862961, 'psi': 0.7089067490894287}-{'f1_val': 0.621650992803457, 'auprc': 0.6675338796197815, 'loss_val': 1.0718927372617764, 'psi': 0.6400041475299868}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] sending update (kind=head size=1796 to 1 peers)
[S14] START round=44 head_norm_before_train=1.845847 cos_to_last_merge=0.9774 (last merge round=18)
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.9475465562304486, 'auprc': 0.9986464747119941, 'loss_val': 0.07417134127489548, 'psi': 0.9679865236230668}-{'f1_val': 0.9974082695017256, 'auprc': 0.9990426091245531, 'loss_val': 0.020855696798005245, 'psi': 0.9980620053508567}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=44 head_norm_before_train=1.837450 cos_to_last_merge=0.7277 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.728
[S15] round=44 local utility u=0.249405 metrics={'f1_val': 0.9079047343812472, 'auprc': 0.9921076110955659, 'loss_val': 0.16037083538521843, 'psi': 0.9415858850669747}-{'f1_val': 0.846418235417965, 'auprc': 0.991204286509305, 'loss_val': 0.2875511180672993, 'psi': 0.9043326558545011}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] sending update (kind=head size=1803 to 1 peers)
[S16] START round=44 head_norm_before_train=1.836201 cos_to_last_merge=0.7637 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.764
[S16] round=44 local utility u=0.014011 metrics={'f1_val': 0.9908722666733435, 'auprc': 0.9952342889122393, 'loss_val': 0.04341080204797139, 'psi': 0.9926170755689019}-{'f1_val': 0.990466775248826, 'auprc': 0.9908397853764966, 'loss_val': 0.05581653192824334, 'psi': 0.9906159792998942}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=44 head_norm_before_train=1.671464 cos_to_last_merge=0.6824 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.682
[S17] round=44 local utility u=0.000000 metrics={'f1_val': 0.599257675680761, 'auprc': 0.8304285722593541, 'loss_val': 1.288934650716822, 'psi': 0.6917260343121983}-{'f1_val': 0.6081320514820447, 'auprc': 0.8332679249636771, 'loss_val': 1.1380580351281433, 'psi': 0.6981864008746976}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=45 head_norm_before_train=1.512776 cos_to_last_merge=0.9746 (last merge round=21)
[S2] round=45 local utility u=0.090420 metrics={'f1_val': 0.7086528301407764, 'auprc': 0.8507501988443371, 'loss_val': 0.5353009126180134, 'psi': 0.7654917776222008}-{'f1_val': 0.714554646233609, 'auprc': 0.8184568183295466, 'loss_val': 0.6546718287685468, 'psi': 0.756115515071984}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=45 head_norm_before_train=1.428359 cos_to_last_merge=0.9239 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.924
[S3] round=45 local utility u=0.426128 metrics={'f1_val': 0.8581974096551008, 'auprc': 0.9978394027080524, 'loss_val': 0.35905010006033483, 'psi': 0.9140542068762814}-{'f1_val': 0.754365745456552, 'auprc': 0.9926188280007453, 'loss_val': 0.5726537067568456, 'psi': 0.8496669784742292}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=45 head_norm_before_train=1.520235 cos_to_last_merge=0.9609 (last merge round=20)
[S4] round=45 local utility u=0.012112 metrics={'f1_val': 0.9552189991699924, 'auprc': 0.9427779137222297, 'loss_val': 0.29437564666216615, 'psi': 0.9502425649908873}-{'f1_val': 0.9521502667743603, 'auprc': 0.9442514274629441, 'loss_val': 0.3046074224282776, 'psi': 0.9489907310497938}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=45 head_norm_before_train=1.426918 cos_to_last_merge=0.9327 (last merge round=20)
[S5] ⚠️ Model drifted since last merge! cos=0.933
[S5] round=45 local utility u=0.000000 metrics={'f1_val': 0.9176225339383475, 'auprc': 0.9941575495852808, 'loss_val': 0.17103630566301187, 'psi': 0.9482365401971208}-{'f1_val': 0.9964799208068884, 'auprc': 0.9966981971387479, 'loss_val': 0.15508062864872862, 'psi': 0.9965672313396322}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=45 head_norm_before_train=1.512630 cos_to_last_merge=0.9703 (last merge round=22)
[S6] round=45 local utility u=0.807535 metrics={'f1_val': 0.9538891677911532, 'auprc': 0.9652094481492994, 'loss_val': 0.23335079213480775, 'psi': 0.9584172799344117}-{'f1_val': 0.7504977305208892, 'auprc': 0.9546758719488582, 'loss_val': 0.5964716476073312, 'psi': 0.8321689870920768}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=45 head_norm_before_train=1.618566 cos_to_last_merge=0.9903 (last merge round=20)
[S7] round=45 local utility u=0.248515 metrics={'f1_val': 0.6847184030853255, 'auprc': 0.8575675102552918, 'loss_val': 0.301328926157592, 'psi': 0.753858045953312}-{'f1_val': 0.6554406950642119, 'auprc': 0.8083870351016846, 'loss_val': 0.47515045116845006, 'psi': 0.716619231079201}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=45 head_norm_before_train=1.619564 cos_to_last_merge=0.9308 (last merge round=21)
[S8] ⚠️ Model drifted since last merge! cos=0.931
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.9910107385435869, 'auprc': 0.9984930627487902, 'loss_val': 0.04318854122915757, 'psi': 0.9940036682256682}-{'f1_val': 0.9920215160826699, 'auprc': 0.9984995779408306, 'loss_val': 0.04118533295155583, 'psi': 0.9946127408259342}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=45 head_norm_before_train=2.050083 (no previous merge yet)
[S9] round=45 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9938168454326721, 'loss_val': 0.01954888119903085, 'psi': 0.9955422329319261}-{'f1_val': 0.9971029125121428, 'auprc': 0.9958960390866693, 'loss_val': 0.018808569529211873, 'psi': 0.9966201631419535}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=45 head_norm_before_train=1.771520 cos_to_last_merge=0.9168 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.917
[S10] round=45 local utility u=0.000000 metrics={'f1_val': 0.9169388514645198, 'auprc': 0.9901884814297841, 'loss_val': 0.21780211679981742, 'psi': 0.9462387034506254}-{'f1_val': 0.9931055226041158, 'auprc': 0.9938749249593889, 'loss_val': 0.043190563000674836, 'psi': 0.993413283546225}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=45 head_norm_before_train=1.713078 cos_to_last_merge=0.9012 (last merge round=17)
[S11] ⚠️ Model drifted since last merge! cos=0.901
[S11] round=45 local utility u=0.389754 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9966992844342732, 'loss_val': 0.02668021397379262, 'psi': 0.9966079164818631}-{'f1_val': 0.885736295797243, 'auprc': 0.9953917647063526, 'loss_val': 0.13740237990530763, 'psi': 0.9295984833608868}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=45 head_norm_before_train=1.819798 (no previous merge yet)
[S13] round=45 local utility u=0.000000 metrics={'f1_val': 0.6362247580565328, 'auprc': 0.6796996246009157, 'loss_val': 1.021300477176308, 'psi': 0.653614704674286}-{'f1_val': 0.7151089988087463, 'auprc': 0.6996033745104524, 'loss_val': 0.9899334033862961, 'psi': 0.7089067490894287}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=45 head_norm_before_train=1.858320 cos_to_last_merge=0.9767 (last merge round=18)
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.9383919727505223, 'auprc': 0.9986510173678168, 'loss_val': 0.11106407672534567, 'psi': 0.9624955905974402}-{'f1_val': 0.9475465562304486, 'auprc': 0.9986464747119941, 'loss_val': 0.07417134127489548, 'psi': 0.9679865236230668}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=45 head_norm_before_train=1.847164 cos_to_last_merge=0.7267 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.727
[S15] round=45 local utility u=0.314995 metrics={'f1_val': 0.9934706406865853, 'auprc': 0.9923854959001559, 'loss_val': 0.04461084793124108, 'psi': 0.9930365827720136}-{'f1_val': 0.9079047343812472, 'auprc': 0.9921076110955659, 'loss_val': 0.16037083538521843, 'psi': 0.9415858850669747}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] START round=45 head_norm_before_train=1.842782 cos_to_last_merge=0.7633 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.763
[S16] round=45 local utility u=0.000000 metrics={'f1_val': 0.8464406403015587, 'auprc': 0.9888218593972924, 'loss_val': 0.9212288081685815, 'psi': 0.9033931279398523}-{'f1_val': 0.9908722666733435, 'auprc': 0.9952342889122393, 'loss_val': 0.04341080204797139, 'psi': 0.9926170755689019}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=45 head_norm_before_train=1.686626 cos_to_last_merge=0.6819 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.682
[S17] round=45 local utility u=0.060810 metrics={'f1_val': 0.618810948786394, 'auprc': 0.8186845784018628, 'loss_val': 1.2494027094613622, 'psi': 0.6987604006325816}-{'f1_val': 0.599257675680761, 'auprc': 0.8304285722593541, 'loss_val': 1.288934650716822, 'psi': 0.6917260343121983}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=46 head_norm_before_train=1.525188 cos_to_last_merge=0.9731 (last merge round=21)
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.6317042735665288, 'auprc': 0.7667168811413216, 'loss_val': 0.7513763520986219, 'psi': 0.6857093165964459}-{'f1_val': 0.7086528301407764, 'auprc': 0.8507501988443371, 'loss_val': 0.5353009126180134, 'psi': 0.7654917776222008}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=46 head_norm_before_train=1.437903 cos_to_last_merge=0.9216 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.922
[S3] round=46 local utility u=0.279144 metrics={'f1_val': 0.9248283441371041, 'auprc': 0.9894905473532366, 'loss_val': 0.1755018736358578, 'psi': 0.9506932254235572}-{'f1_val': 0.8581974096551008, 'auprc': 0.9978394027080524, 'loss_val': 0.35905010006033483, 'psi': 0.9140542068762814}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=46 head_norm_before_train=1.528974 cos_to_last_merge=0.9597 (last merge round=20)
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.950533904244982, 'auprc': 0.9310068581174884, 'loss_val': 0.30701052504557425, 'psi': 0.9427230857939846}-{'f1_val': 0.9552189991699924, 'auprc': 0.9427779137222297, 'loss_val': 0.29437564666216615, 'psi': 0.9502425649908873}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=46 head_norm_before_train=1.437788 cos_to_last_merge=0.9320 (last merge round=20)
[S5] ⚠️ Model drifted since last merge! cos=0.932
[S5] round=46 local utility u=0.000000 metrics={'f1_val': 0.8782723366663386, 'auprc': 0.993514774555827, 'loss_val': 0.1782069816114409, 'psi': 0.924369311822134}-{'f1_val': 0.9176225339383475, 'auprc': 0.9941575495852808, 'loss_val': 0.17103630566301187, 'psi': 0.9482365401971208}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=46 head_norm_before_train=1.517407 cos_to_last_merge=0.9693 (last merge round=22)
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.6458394098025998, 'auprc': 0.9294783342044224, 'loss_val': 0.8106926101451241, 'psi': 0.7592949795633288}-{'f1_val': 0.9538891677911532, 'auprc': 0.9652094481492994, 'loss_val': 0.23335079213480775, 'psi': 0.9584172799344117}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=46 head_norm_before_train=1.627930 cos_to_last_merge=0.9898 (last merge round=20)
[S7] round=46 local utility u=0.000000 metrics={'f1_val': 0.5570630999216565, 'auprc': 0.7844858993911935, 'loss_val': 0.9771680508127588, 'psi': 0.6480322197094712}-{'f1_val': 0.6847184030853255, 'auprc': 0.8575675102552918, 'loss_val': 0.301328926157592, 'psi': 0.753858045953312}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=46 head_norm_before_train=1.630524 cos_to_last_merge=0.9293 (last merge round=21)
[S8] ⚠️ Model drifted since last merge! cos=0.929
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.9902890463068262, 'auprc': 0.9984791255503019, 'loss_val': 0.04397869109702189, 'psi': 0.9935650780042166}-{'f1_val': 0.9910107385435869, 'auprc': 0.9984930627487902, 'loss_val': 0.04318854122915757, 'psi': 0.9940036682256682}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=46 head_norm_before_train=2.053513 (no previous merge yet)
[S9] round=46 local utility u=0.004915 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9959068133762715, 'loss_val': 0.018452029256935537, 'psi': 0.9966244728577943}-{'f1_val': 0.9966924912647621, 'auprc': 0.9938168454326721, 'loss_val': 0.01954888119903085, 'psi': 0.9955422329319261}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] sending update (kind=head size=1793 to 1 peers)
[S10] START round=46 head_norm_before_train=1.777178 cos_to_last_merge=0.9162 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.916
[S10] round=46 local utility u=0.318835 metrics={'f1_val': 0.9931299445855843, 'auprc': 0.9920358435185022, 'loss_val': 0.04282076654027274, 'psi': 0.9926923041587515}-{'f1_val': 0.9169388514645198, 'auprc': 0.9901884814297841, 'loss_val': 0.21780211679981742, 'psi': 0.9462387034506254}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=46 head_norm_before_train=1.721365 cos_to_last_merge=0.9002 (last merge round=17)
[S11] ⚠️ Model drifted since last merge! cos=0.900
[S11] round=46 local utility u=0.000000 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9969605920432836, 'loss_val': 0.027990717184225647, 'psi': 0.99656733729863}-{'f1_val': 0.9965470045135896, 'auprc': 0.9966992844342732, 'loss_val': 0.02668021397379262, 'psi': 0.9966079164818631}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=46 head_norm_before_train=1.824018 (no previous merge yet)
[S13] round=46 local utility u=0.197459 metrics={'f1_val': 0.6655143352698212, 'auprc': 0.719808310915417, 'loss_val': 0.9224463016663231, 'psi': 0.6872319255280595}-{'f1_val': 0.6362247580565328, 'auprc': 0.6796996246009157, 'loss_val': 1.021300477176308, 'psi': 0.653614704674286}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=46 head_norm_before_train=1.872472 cos_to_last_merge=0.9760 (last merge round=18)
[S14] round=46 local utility u=0.048165 metrics={'f1_val': 0.9482391702634311, 'auprc': 0.9985800842004473, 'loss_val': 0.07360496937772248, 'psi': 0.9683755358382375}-{'f1_val': 0.9383919727505223, 'auprc': 0.9986510173678168, 'loss_val': 0.11106407672534567, 'psi': 0.9624955905974402}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=46 head_norm_before_train=1.856535 cos_to_last_merge=0.7259 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.726
[S15] round=46 local utility u=0.000000 metrics={'f1_val': 0.7009169771696235, 'auprc': 0.8305807987143666, 'loss_val': 0.6450066854819597, 'psi': 0.7527825057875208}-{'f1_val': 0.9934706406865853, 'auprc': 0.9923854959001559, 'loss_val': 0.04461084793124108, 'psi': 0.9930365827720136}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=46 head_norm_before_train=1.849592 cos_to_last_merge=0.7629 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.763
[S16] round=46 local utility u=0.861521 metrics={'f1_val': 0.9904675332768931, 'auprc': 0.9855955030912772, 'loss_val': 0.05266881110507538, 'psi': 0.9885187212026467}-{'f1_val': 0.8464406403015587, 'auprc': 0.9888218593972924, 'loss_val': 0.9212288081685815, 'psi': 0.9033931279398523}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] sending update (kind=head size=1805 to 1 peers)
[S17] START round=46 head_norm_before_train=1.702382 cos_to_last_merge=0.6815 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.681
[S17] round=46 local utility u=0.000000 metrics={'f1_val': 0.4115459367047444, 'auprc': 0.7822760467808306, 'loss_val': 1.9264660277127754, 'psi': 0.5598379807351789}-{'f1_val': 0.618810948786394, 'auprc': 0.8186845784018628, 'loss_val': 1.2494027094613622, 'psi': 0.6987604006325816}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=47 head_norm_before_train=1.535489 cos_to_last_merge=0.9718 (last merge round=21)
[S2] round=47 local utility u=0.407507 metrics={'f1_val': 0.7111467556593474, 'auprc': 0.8260168979834789, 'loss_val': 0.5909173738672572, 'psi': 0.757094812589}-{'f1_val': 0.6317042735665288, 'auprc': 0.7667168811413216, 'loss_val': 0.7513763520986219, 'psi': 0.6857093165964459}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=47 head_norm_before_train=1.447976 cos_to_last_merge=0.9195 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.920
[S3] round=47 local utility u=0.161909 metrics={'f1_val': 0.9607804860280988, 'auprc': 0.9990125663187536, 'loss_val': 0.09596375242743016, 'psi': 0.9760733181443608}-{'f1_val': 0.9248283441371041, 'auprc': 0.9894905473532366, 'loss_val': 0.1755018736358578, 'psi': 0.9506932254235572}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=47 head_norm_before_train=1.536901 cos_to_last_merge=0.9585 (last merge round=20)
[S4] round=47 local utility u=0.031069 metrics={'f1_val': 0.9520881977621077, 'auprc': 0.945697455458245, 'loss_val': 0.2982705558849159, 'psi': 0.9495319008405626}-{'f1_val': 0.950533904244982, 'auprc': 0.9310068581174884, 'loss_val': 0.30701052504557425, 'psi': 0.9427230857939846}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=47 head_norm_before_train=1.447852 cos_to_last_merge=0.9312 (last merge round=20)
[S5] ⚠️ Model drifted since last merge! cos=0.931
[S5] round=47 local utility u=0.398517 metrics={'f1_val': 0.996625909096903, 'auprc': 0.997342217794783, 'loss_val': 0.10277774033091458, 'psi': 0.996912432576055}-{'f1_val': 0.8782723366663386, 'auprc': 0.993514774555827, 'loss_val': 0.1782069816114409, 'psi': 0.924369311822134}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=47 head_norm_before_train=1.521353 cos_to_last_merge=0.9683 (last merge round=22)
[S6] round=47 local utility u=0.747509 metrics={'f1_val': 0.8232287621853904, 'auprc': 0.9642060109969013, 'loss_val': 0.4841934026215755, 'psi': 0.8796196617099947}-{'f1_val': 0.6458394098025998, 'auprc': 0.9294783342044224, 'loss_val': 0.8106926101451241, 'psi': 0.7592949795633288}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=47 head_norm_before_train=1.634522 cos_to_last_merge=0.9894 (last merge round=20)
[S7] round=47 local utility u=0.411960 metrics={'f1_val': 0.6218225461699053, 'auprc': 0.8006515288982411, 'loss_val': 0.5903008795773017, 'psi': 0.6933541392612397}-{'f1_val': 0.5570630999216565, 'auprc': 0.7844858993911935, 'loss_val': 0.9771680508127588, 'psi': 0.6480322197094712}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=47 head_norm_before_train=1.639798 cos_to_last_merge=0.9280 (last merge round=21)
[S8] ⚠️ Model drifted since last merge! cos=0.928
[S8] round=47 local utility u=0.001924 metrics={'f1_val': 0.9906496251316108, 'auprc': 0.9984785479773101, 'loss_val': 0.0422927391577438, 'psi': 0.9937811942698905}-{'f1_val': 0.9902890463068262, 'auprc': 0.9984791255503019, 'loss_val': 0.04397869109702189, 'psi': 0.9935650780042166}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=47 head_norm_before_train=2.059998 (no previous merge yet)
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9958798243860543, 'loss_val': 0.01846986095052435, 'psi': 0.9966136772617074}-{'f1_val': 0.9971029125121428, 'auprc': 0.9959068133762715, 'loss_val': 0.018452029256935537, 'psi': 0.9966244728577943}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=47 head_norm_before_train=1.783109 cos_to_last_merge=0.9155 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.915
[S10] round=47 local utility u=0.000000 metrics={'f1_val': 0.9931299445855843, 'auprc': 0.9908646914546984, 'loss_val': 0.04063149996329876, 'psi': 0.99222384333323}-{'f1_val': 0.9931299445855843, 'auprc': 0.9920358435185022, 'loss_val': 0.04282076654027274, 'psi': 0.9926923041587515}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=47 head_norm_before_train=1.730494 cos_to_last_merge=0.8991 (last merge round=17)
[S11] ⚠️ Model drifted since last merge! cos=0.899
[S11] round=47 local utility u=0.001022 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9973896162418899, 'loss_val': 0.028685634921727043, 'psi': 0.9968840492049097}-{'f1_val': 0.996305167468861, 'auprc': 0.9969605920432836, 'loss_val': 0.027990717184225647, 'psi': 0.99656733729863}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=47 head_norm_before_train=1.827729 (no previous merge yet)
[S13] round=47 local utility u=0.000000 metrics={'f1_val': 0.6276658810517662, 'auprc': 0.7022457845847292, 'loss_val': 1.034669985037888, 'psi': 0.6574978424649514}-{'f1_val': 0.6655143352698212, 'auprc': 0.719808310915417, 'loss_val': 0.9224463016663231, 'psi': 0.6872319255280595}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=47 head_norm_before_train=1.886747 cos_to_last_merge=0.9753 (last merge round=18)
[S14] round=47 local utility u=0.175603 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9990430616431923, 'loss_val': 0.018801801665793982, 'psi': 0.9980621863583123}-{'f1_val': 0.9482391702634311, 'auprc': 0.9985800842004473, 'loss_val': 0.07360496937772248, 'psi': 0.9683755358382375}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=47 head_norm_before_train=1.865283 cos_to_last_merge=0.7252 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.725
[S15] round=47 local utility u=1.000000 metrics={'f1_val': 0.9776152597141864, 'auprc': 0.9914403050294996, 'loss_val': 0.059376912498938464, 'psi': 0.9831452778403116}-{'f1_val': 0.7009169771696235, 'auprc': 0.8305807987143666, 'loss_val': 0.6450066854819597, 'psi': 0.7527825057875208}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=47 head_norm_before_train=1.854524 cos_to_last_merge=0.7621 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.762
[S16] round=47 local utility u=0.013577 metrics={'f1_val': 0.9917699063620662, 'auprc': 0.9894770543840605, 'loss_val': 0.044973196271108754, 'psi': 0.9908527655708639}-{'f1_val': 0.9904675332768931, 'auprc': 0.9855955030912772, 'loss_val': 0.05266881110507538, 'psi': 0.9885187212026467}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=47 head_norm_before_train=1.717908 cos_to_last_merge=0.6809 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.681
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.3270634253090239, 'auprc': 0.7839080689154978, 'loss_val': 2.439770350459626, 'psi': 0.5098012827516134}-{'f1_val': 0.4115459367047444, 'auprc': 0.7822760467808306, 'loss_val': 1.9264660277127754, 'psi': 0.5598379807351789}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=48 head_norm_before_train=1.545359 cos_to_last_merge=0.9705 (last merge round=21)
[S2] round=48 local utility u=0.000000 metrics={'f1_val': 0.7148975532756998, 'auprc': 0.8238782534570892, 'loss_val': 0.6904767966916724, 'psi': 0.7584898333482556}-{'f1_val': 0.7111467556593474, 'auprc': 0.8260168979834789, 'loss_val': 0.5909173738672572, 'psi': 0.757094812589}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=48 head_norm_before_train=1.460348 cos_to_last_merge=0.9173 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.917
[S3] round=48 local utility u=0.010154 metrics={'f1_val': 0.9607409897453603, 'auprc': 0.9985892438410282, 'loss_val': 0.07414784061412508, 'psi': 0.9758802913836274}-{'f1_val': 0.9607804860280988, 'auprc': 0.9990125663187536, 'loss_val': 0.09596375242743016, 'psi': 0.9760733181443608}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S4] START round=48 head_norm_before_train=1.545136 cos_to_last_merge=0.9570 (last merge round=20)
[S4] round=48 local utility u=0.038121 metrics={'f1_val': 0.9531201679505146, 'auprc': 0.965206713418761, 'loss_val': 0.28674738740410577, 'psi': 0.957954786137813}-{'f1_val': 0.9520881977621077, 'auprc': 0.945697455458245, 'loss_val': 0.2982705558849159, 'psi': 0.9495319008405626}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=48 head_norm_before_train=1.458008 cos_to_last_merge=0.9302 (last merge round=20)
[S5] ⚠️ Model drifted since last merge! cos=0.930
[S5] round=48 local utility u=0.000000 metrics={'f1_val': 0.9532945087434834, 'auprc': 0.9915706455419382, 'loss_val': 0.14605926217958684, 'psi': 0.9686049634628653}-{'f1_val': 0.996625909096903, 'auprc': 0.997342217794783, 'loss_val': 0.10277774033091458, 'psi': 0.996912432576055}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=48 head_norm_before_train=1.526171 cos_to_last_merge=0.9674 (last merge round=22)
[S6] round=48 local utility u=0.000000 metrics={'f1_val': 0.6407901233822321, 'auprc': 0.903465549548647, 'loss_val': 0.934965284277405, 'psi': 0.7458602938487982}-{'f1_val': 0.8232287621853904, 'auprc': 0.9642060109969013, 'loss_val': 0.4841934026215755, 'psi': 0.8796196617099947}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=48 head_norm_before_train=1.638409 cos_to_last_merge=0.9891 (last merge round=20)
[S7] round=48 local utility u=0.623664 metrics={'f1_val': 0.7449952802493955, 'auprc': 0.8680639758316211, 'loss_val': 0.28424592117657027, 'psi': 0.7942227584822857}-{'f1_val': 0.6218225461699053, 'auprc': 0.8006515288982411, 'loss_val': 0.5903008795773017, 'psi': 0.6933541392612397}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=48 head_norm_before_train=1.646500 cos_to_last_merge=0.9272 (last merge round=21)
[S8] ⚠️ Model drifted since last merge! cos=0.927
[S8] round=48 local utility u=0.008305 metrics={'f1_val': 0.9927475182363883, 'auprc': 0.9983064814368451, 'loss_val': 0.03775465477399213, 'psi': 0.9949711035165709}-{'f1_val': 0.9906496251316108, 'auprc': 0.9984785479773101, 'loss_val': 0.0422927391577438, 'psi': 0.9937811942698905}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] START round=48 head_norm_before_train=2.067028 (no previous merge yet)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9937817839917589, 'loss_val': 0.018751008340539204, 'psi': 0.9957744611039893}-{'f1_val': 0.9971029125121428, 'auprc': 0.9958798243860543, 'loss_val': 0.01846986095052435, 'psi': 0.9966136772617074}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=48 head_norm_before_train=1.787872 cos_to_last_merge=0.9148 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.915
[S10] round=48 local utility u=0.000415 metrics={'f1_val': 0.992254723717119, 'auprc': 0.994424237051883, 'loss_val': 0.045228291081780746, 'psi': 0.9931225290510246}-{'f1_val': 0.9931299445855843, 'auprc': 0.9908646914546984, 'loss_val': 0.04063149996329876, 'psi': 0.99222384333323}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=48 head_norm_before_train=1.738542 cos_to_last_merge=0.8983 (last merge round=17)
[S11] ⚠️ Model drifted since last merge! cos=0.898
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.9919966479539678, 'auprc': 0.9967331900522588, 'loss_val': 0.040728660855430865, 'psi': 0.9938912647932842}-{'f1_val': 0.9965470045135896, 'auprc': 0.9973896162418899, 'loss_val': 0.028685634921727043, 'psi': 0.9968840492049097}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=48 head_norm_before_train=1.834668 (no previous merge yet)
[S13] round=48 local utility u=0.122638 metrics={'f1_val': 0.637090731018757, 'auprc': 0.7284930736535733, 'loss_val': 0.9246854100061171, 'psi': 0.6736516680726835}-{'f1_val': 0.6276658810517662, 'auprc': 0.7022457845847292, 'loss_val': 1.034669985037888, 'psi': 0.6574978424649514}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] sending update (kind=head size=1806 to 1 peers)
[S14] START round=48 head_norm_before_train=1.895077 cos_to_last_merge=0.9749 (last merge round=18)
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.9969452255660185, 'auprc': 0.9986697271032436, 'loss_val': 0.020518506888476198, 'psi': 0.9976350261809086}-{'f1_val': 0.9974082695017256, 'auprc': 0.9990430616431923, 'loss_val': 0.018801801665793982, 'psi': 0.9980621863583123}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=48 head_norm_before_train=1.873372 cos_to_last_merge=0.7245 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.724
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.906886125889431, 'auprc': 0.9912591443999329, 'loss_val': 0.17287775512338951, 'psi': 0.9406353332936318}-{'f1_val': 0.9776152597141864, 'auprc': 0.9914403050294996, 'loss_val': 0.059376912498938464, 'psi': 0.9831452778403116}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=48 head_norm_before_train=1.860000 cos_to_last_merge=0.7616 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.762
[S16] round=48 local utility u=0.000000 metrics={'f1_val': 0.8647253047016478, 'auprc': 0.9898098286359035, 'loss_val': 0.45908550636686524, 'psi': 0.9147591142753501}-{'f1_val': 0.9917699063620662, 'auprc': 0.9894770543840605, 'loss_val': 0.044973196271108754, 'psi': 0.9908527655708639}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=48 head_norm_before_train=1.728200 cos_to_last_merge=0.6807 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.681
[S17] round=48 local utility u=1.000000 metrics={'f1_val': 0.6255996442471432, 'auprc': 0.8474663430661027, 'loss_val': 1.21057307701962, 'psi': 0.714346323774727}-{'f1_val': 0.3270634253090239, 'auprc': 0.7839080689154978, 'loss_val': 2.439770350459626, 'psi': 0.5098012827516134}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S2] START round=49 head_norm_before_train=1.558136 cos_to_last_merge=0.9687 (last merge round=21)
[S2] round=49 local utility u=0.005995 metrics={'f1_val': 0.7129625127093612, 'auprc': 0.829067581427078, 'loss_val': 0.682444138582125, 'psi': 0.759404540196448}-{'f1_val': 0.7148975532756998, 'auprc': 0.8238782534570892, 'loss_val': 0.6904767966916724, 'psi': 0.7584898333482556}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=49 head_norm_before_train=1.475140 cos_to_last_merge=0.9144 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.914
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.8300886927936899, 'auprc': 0.9716021205163026, 'loss_val': 0.3741992460760177, 'psi': 0.886694063882735}-{'f1_val': 0.9607409897453603, 'auprc': 0.9985892438410282, 'loss_val': 0.07414784061412508, 'psi': 0.9758802913836274}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=49 head_norm_before_train=1.557031 cos_to_last_merge=0.9552 (last merge round=20)
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.953192115379218, 'auprc': 0.9490775056219883, 'loss_val': 0.2986630283580204, 'psi': 0.9515462714763261}-{'f1_val': 0.9531201679505146, 'auprc': 0.965206713418761, 'loss_val': 0.28674738740410577, 'psi': 0.957954786137813}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=49 head_norm_before_train=1.464808 cos_to_last_merge=0.9296 (last merge round=20)
[S5] ⚠️ Model drifted since last merge! cos=0.930
[S5] round=49 local utility u=0.162535 metrics={'f1_val': 0.996625909096903, 'auprc': 0.9966835863414806, 'loss_val': 0.09631615590790218, 'psi': 0.996648979994734}-{'f1_val': 0.9532945087434834, 'auprc': 0.9915706455419382, 'loss_val': 0.14605926217958684, 'psi': 0.9686049634628653}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=49 head_norm_before_train=1.534980 cos_to_last_merge=0.9661 (last merge round=22)
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.6223796355555093, 'auprc': 0.9093018096441952, 'loss_val': 0.9206552090931452, 'psi': 0.7371485051909836}-{'f1_val': 0.6407901233822321, 'auprc': 0.903465549548647, 'loss_val': 0.934965284277405, 'psi': 0.7458602938487982}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=49 head_norm_before_train=1.640410 cos_to_last_merge=0.9890 (last merge round=20)
[S7] round=49 local utility u=0.000000 metrics={'f1_val': 0.41004626215143636, 'auprc': 0.7772106737843519, 'loss_val': 1.5428727003780658, 'psi': 0.5569120268046026}-{'f1_val': 0.7449952802493955, 'auprc': 0.8680639758316211, 'loss_val': 0.28424592117657027, 'psi': 0.7942227584822857}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=49 head_norm_before_train=1.653358 cos_to_last_merge=0.9264 (last merge round=21)
[S8] ⚠️ Model drifted since last merge! cos=0.926
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.9892104968014376, 'auprc': 0.9987603116838818, 'loss_val': 0.04110929104030341, 'psi': 0.9930304227544153}-{'f1_val': 0.9927475182363883, 'auprc': 0.9983064814368451, 'loss_val': 0.03775465477399213, 'psi': 0.9949711035165709}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=49 head_norm_before_train=2.071333 (no previous merge yet)
[S9] round=49 local utility u=0.005274 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9989195142437699, 'loss_val': 0.01862438688653789, 'psi': 0.9973304231357516}-{'f1_val': 0.9971029125121428, 'auprc': 0.9937817839917589, 'loss_val': 0.018751008340539204, 'psi': 0.9957744611039893}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=49 head_norm_before_train=1.795035 cos_to_last_merge=0.9140 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.914
[S10] round=49 local utility u=0.001965 metrics={'f1_val': 0.9933489306849028, 'auprc': 0.9911178133982048, 'loss_val': 0.03794366412533418, 'psi': 0.9924564837702237}-{'f1_val': 0.992254723717119, 'auprc': 0.994424237051883, 'loss_val': 0.045228291081780746, 'psi': 0.9931225290510246}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=49 head_norm_before_train=1.745372 cos_to_last_merge=0.8973 (last merge round=17)
[S11] ⚠️ Model drifted since last merge! cos=0.897
[S11] round=49 local utility u=0.015410 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9955996344428416, 'loss_val': 0.03132942402844801, 'psi': 0.9959200587251222}-{'f1_val': 0.9919966479539678, 'auprc': 0.9967331900522588, 'loss_val': 0.040728660855430865, 'psi': 0.9938912647932842}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S11] sending update (kind=head size=1806 to 1 peers)
[S13] START round=49 head_norm_before_train=1.842713 (no previous merge yet)
[S13] round=49 local utility u=0.125238 metrics={'f1_val': 0.6919538994624858, 'auprc': 0.7072312260514122, 'loss_val': 0.9396021685517141, 'psi': 0.6980648300980563}-{'f1_val': 0.637090731018757, 'auprc': 0.7284930736535733, 'loss_val': 0.9246854100061171, 'psi': 0.6736516680726835}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=49 head_norm_before_train=1.902146 cos_to_last_merge=0.9743 (last merge round=18)
[S14] round=49 local utility u=0.001130 metrics={'f1_val': 0.9971882020035234, 'auprc': 0.9986693669082641, 'loss_val': 0.019716161526133293, 'psi': 0.9977806679654196}-{'f1_val': 0.9969452255660185, 'auprc': 0.9986697271032436, 'loss_val': 0.020518506888476198, 'psi': 0.9976350261809086}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=49 head_norm_before_train=1.881878 cos_to_last_merge=0.7236 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.724
[S15] round=49 local utility u=0.000912 metrics={'f1_val': 0.9074400036794589, 'auprc': 0.9900193509668811, 'loss_val': 0.17065775319778106, 'psi': 0.9404717425944278}-{'f1_val': 0.906886125889431, 'auprc': 0.9912591443999329, 'loss_val': 0.17287775512338951, 'psi': 0.9406353332936318}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] START round=49 head_norm_before_train=1.864870 cos_to_last_merge=0.7613 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.761
[S16] round=49 local utility u=0.000000 metrics={'f1_val': 0.8839967358324556, 'auprc': 0.9837304951184305, 'loss_val': 0.583936589788627, 'psi': 0.9238902395468456}-{'f1_val': 0.8647253047016478, 'auprc': 0.9898098286359035, 'loss_val': 0.45908550636686524, 'psi': 0.9147591142753501}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=49 head_norm_before_train=1.735624 cos_to_last_merge=0.6804 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.680
[S17] round=49 local utility u=0.052128 metrics={'f1_val': 0.621150302680308, 'auprc': 0.8770535439687502, 'loss_val': 1.1683829514083062, 'psi': 0.7235115991956849}-{'f1_val': 0.6255996442471432, 'auprc': 0.8474663430661027, 'loss_val': 1.21057307701962, 'psi': 0.714346323774727}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[runner] rounds complete.
[runner] all agents stopped.
