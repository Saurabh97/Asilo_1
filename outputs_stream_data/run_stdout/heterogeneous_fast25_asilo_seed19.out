[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:61003
[S3] → join 127.0.0.1:61002
[S4] → join 127.0.0.1:61002
[S5] → join 127.0.0.1:61002
[S6] → join 127.0.0.1:61002
[S7] → join 127.0.0.1:61002
[S8] → join 127.0.0.1:61002
[S9] → join 127.0.0.1:61002
[S10] → join 127.0.0.1:61002
[S11] → join 127.0.0.1:61002
[S13] → join 127.0.0.1:61002
[S14] → join 127.0.0.1:61002
[S15] → join 127.0.0.1:61002
[S16] → join 127.0.0.1:61002
[S17] → join 127.0.0.1:61002
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.240544 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.210819 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.188519 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.160314 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.194468 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.198551 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.159812 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.209785 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.254287 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.205234 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.177094 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.176694 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.243184 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.182849 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.141371 (no previous merge yet)
[S3]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S3] + discovered S17
[S3] + discovered S10
[S4] + discovered S3
[S4] + discovered S2
[S3] + discovered S4
[S3] + discovered S7
[S3] + discovered S14
[S3] + discovered S13
[S3] + discovered S9
[S3] + discovered S11
[S3] + discovered S6
[S3] + discovered S8
[S3] + discovered S16
[S3] + discovered S15
[S3] + discovered S5
[S5] + discovered S4
[S5] + discovered S3
[S4] + discovered S9
[S5] + discovered S2
[S4] + discovered S7
[S4] + discovered S14
[S4] + discovered S13
[S4] + discovered S11
[S4] + discovered S6
[S4] + discovered S8
[S4] + discovered S16
[S4] + discovered S15
[S4] + discovered S17
[S4] + discovered S5
[S4] + discovered S10
[S5] + discovered S7
[S5] + discovered S13
[S5] + discovered S16
[S5] + discovered S17
[S5] + discovered S10
[S5] + discovered S9
[S5] + discovered S14
[S5] + discovered S11
[S5] + discovered S8
[S5] + discovered S6
[S5] + discovered S15
[S6] + discovered S4
[S6] + discovered S2
[S6] + discovered S3
[S6] + discovered S5
[S6] + discovered S13
[S6] + discovered S8
[S6] + discovered S15
[S6] + discovered S16
[S6] + discovered S7
[S7] + discovered S2
[S7] + discovered S4
[S7] + discovered S3
[S7] + discovered S5
[S7] + discovered S6
[S6] + discovered S10
[S6] + discovered S9
[S6] + discovered S17
[S6] + discovered S14
[S6] + discovered S11
[S8] + discovered S2
[S8] + discovered S5
[S8] + discovered S7
[S8] + discovered S4
[S8] + discovered S3
[S8] + discovered S6
[S7] + discovered S10
[S7] + discovered S9
[S7] + discovered S17
[S7] + discovered S14
[S7] + discovered S13
[S7] + discovered S8
[S7] + discovered S15
[S7] + discovered S11
[S7] + discovered S16
[S8] + discovered S14
[S8] + discovered S13
[S8] + discovered S15
[S8] + discovered S11
[S8] + discovered S10
[S9] + discovered S3
[S9] + discovered S5
[S9] + discovered S2
[S9] + discovered S4
[S8] + discovered S9
[S9] + discovered S7
[S9] + discovered S8
[S9] + discovered S6
[S8] + discovered S17
[S8] + discovered S16
[S9] + discovered S16
[S9] + discovered S17
[S10] + discovered S9
[S10] + discovered S8
[S9] + discovered S15
[S10] + discovered S5
[S10] + discovered S7
[S9] + discovered S14
[S10] + discovered S6
[S10] + discovered S4
[S10] + discovered S2
[S10] + discovered S3
[S9] + discovered S11
[S9] + discovered S10
[S9] + discovered S13
[S10] + discovered S13
[S11] + discovered S10
[S10] + discovered S14
[S11] + discovered S5
[S11] + discovered S4
[S11] + discovered S9
[S10] + discovered S16
[S10] + discovered S17
[S11] + discovered S8
[S11] + discovered S7
[S11] + discovered S3
[S11] + discovered S6
[S10] + discovered S11
[S10] + discovered S15
[S11] + discovered S2
[S11] + discovered S16
[S11] + discovered S17
[S11] + discovered S15
[S13] + discovered S2
[S13] + discovered S4
[S13] + discovered S3
[S13] + discovered S8
[S13] + discovered S7
[S13] + discovered S9
[S13] + discovered S6
[S13] + discovered S11
[S11] + discovered S13
[S13] + discovered S10
[S13] + discovered S5
[S11] + discovered S14
[S14] + discovered S5
[S14] + discovered S9
[S14] + discovered S13
[S14] + discovered S11
[S14] + discovered S3
[S14] + discovered S6
[S14] + discovered S7
[S14] + discovered S10
[S14] + discovered S2
[S14] + discovered S4
[S14] + discovered S8
[S13] + discovered S15
[S13] + discovered S17
[S13] + discovered S14
[S13] + discovered S16
[S14] + discovered S15
[S15] + discovered S3
[S14] + discovered S17
[S15] + discovered S8
[S15] + discovered S4
[S15] + discovered S11
[S15] + discovered S7
[S15] + discovered S13
[S15] + discovered S6
[S15] + discovered S9
[S15] + discovered S2
[S15] + discovered S14
[S15] + discovered S10
[S15] + discovered S5
[S14] + discovered S16
[S16] + discovered S3
[S16] + discovered S15
[S15] + discovered S17
[S16] + discovered S8
[S16] + discovered S4
[S15] + discovered S16
[S16] + discovered S10
[S16] + discovered S5
[S16] + discovered S9
[S16] + discovered S14
[S16] + discovered S6
[S16] + discovered S2
[S16] + discovered S11
[S16] + discovered S7
[S16] + discovered S13
[S17] + discovered S16
[S17] + discovered S9
[S17] + discovered S6
[S17] + discovered S14
[S17] + discovered S2
[S17] + discovered S7
[S17] + discovered S5
[S17] + discovered S10
[S17] + discovered S8
[S16] + discovered S17
[S17] + discovered S11
[S17] + discovered S13
[S17] + discovered S3
[S17] + discovered S15
[S17] + discovered S4
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] ⇄ pheromone p=1.000 → S9@127.0.0.1:61010
[S5] ⇄ pheromone p=1.000 → S11@127.0.0.1:61012
[S16] ⇄ pheromone p=1.000 → S7@127.0.0.1:61008
[S6] ⇄ pheromone p=1.000 → S17@127.0.0.1:61017
[S9] ⇄ pheromone p=1.000 → S17@127.0.0.1:61017
[S13] ⇄ pheromone p=1.000 → S7@127.0.0.1:61008
[S11] ⇄ pheromone p=1.000 → S8@127.0.0.1:61009
[S14] ⇄ pheromone p=1.000 → S8@127.0.0.1:61009
[S4] ⇄ pheromone p=1.000 → S8@127.0.0.1:61009
[S7] ⇄ pheromone p=1.000 → S17@127.0.0.1:61017
[S8] ⇄ pheromone p=1.000 → S15@127.0.0.1:61015
[S3] ⇄ pheromone p=1.000 → S11@127.0.0.1:61012
[S10] ⇄ pheromone p=1.000 → S14@127.0.0.1:61014
[S2] ⇄ pheromone p=1.000 → S8@127.0.0.1:61009
[S17] ⇄ pheromone p=1.000 → S13@127.0.0.1:61013
[S2] START round=1 head_norm_before_train=1.249552 (no previous merge yet)
[S2] round=1 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7223737115899385, 'loss_val': 1.2839689683445619, 'psi': 0.37401576466911546}-{'f1_val': 0.4020513583606139, 'auprc': 0.6647129749837996, 'loss_val': 1.3233862271926935, 'psi': 0.5071160050098882}
[S3] START round=1 head_norm_before_train=1.236417 (no previous merge yet)
[S3] round=1 local utility u=0.455323 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9210948546085594, 'loss_val': 1.279776447925431, 'psi': 0.45234198121188807}-{'f1_val': 0.13984006561410703, 'auprc': 0.6363146432279025, 'loss_val': 1.336082413659655, 'psi': 0.3384298966596252}
[S4] START round=1 head_norm_before_train=1.193787 (no previous merge yet)
[S4] round=1 local utility u=0.141070 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7857324053896744, 'loss_val': 1.318007958754557, 'psi': 0.39842893949298025}-{'f1_val': 0.16812227074235808, 'auprc': 0.6476526701855028, 'loss_val': 1.353282148259425, 'psi': 0.35993443051961593}
[S5] START round=1 head_norm_before_train=1.184680 (no previous merge yet)
[S5] round=1 local utility u=0.097944 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7436938492723654, 'loss_val': 1.2459044840587985, 'psi': 0.382834682566089}-{'f1_val': 0.14226190476190476, 'auprc': 0.7037178652399042, 'loss_val': 1.3218651639938568, 'psi': 0.36684428895310456}
[S6] START round=1 head_norm_before_train=1.197301 (no previous merge yet)
[S6] round=1 local utility u=0.235452 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.7530659109519411, 'loss_val': 1.325701678572667, 'psi': 0.38608213361154564}-{'f1_val': 0.14142628205128205, 'auprc': 0.6060762373407799, 'loss_val': 1.3556375313382611, 'psi': 0.3272862641670812}
[S7] START round=1 head_norm_before_train=1.202703 (no previous merge yet)
[S7] round=1 local utility u=0.065611 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7883261384437966, 'loss_val': 1.2921809824664818, 'psi': 0.4005645490149737}-{'f1_val': 0.14205682272909165, 'auprc': 0.7644913762417389, 'loss_val': 1.351899582272788, 'psi': 0.39103064413415056}
[S8] START round=1 head_norm_before_train=1.162092 (no previous merge yet)
[S8] round=1 local utility u=0.913974 metrics={'f1_val': 0.4000804257242513, 'auprc': 0.5808291843893383, 'loss_val': 1.3397782859225307, 'psi': 0.4723799291902861}-{'f1_val': 0.10450549450549451, 'auprc': 0.5747379810542124, 'loss_val': 1.3760038412920785, 'psi': 0.29259848912498165}
[S9] START round=1 head_norm_before_train=1.211887 (no previous merge yet)
[S9] round=1 local utility u=0.039648 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9892925592699312, 'loss_val': 1.249843408265584, 'psi': 0.4805557979919701}-{'f1_val': 0.141397957139996, 'auprc': 0.984419041877731, 'loss_val': 1.314518926512503, 'psi': 0.47860639103509}
[S10] START round=1 head_norm_before_train=1.260924 (no previous merge yet)
[S10] round=1 local utility u=0.008395 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7859181093716165, 'loss_val': 1.3153289406089728, 'psi': 0.397540226273681}-{'f1_val': 0.13862163754172394, 'auprc': 0.7905343966629805, 'loss_val': 1.3459681532984296, 'psi': 0.3993867411902266}
[S11] START round=1 head_norm_before_train=1.213276 (no previous merge yet)
[S11] round=1 local utility u=0.369950 metrics={'f1_val': 0.1412, 'auprc': 0.7933372284337665, 'loss_val': 1.3117066870671312, 'psi': 0.4020548913735066}-{'f1_val': 0.0921497856981728, 'auprc': 0.6590216950011677, 'loss_val': 1.354359484843083, 'psi': 0.3188985494193708}
[S13] START round=1 head_norm_before_train=1.180482 (no previous merge yet)
[S13] round=1 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6389289226810322, 'loss_val': 1.3207114430775015, 'psi': 0.33980302661864475}-{'f1_val': 0.1403857625770531, 'auprc': 0.652923445009306, 'loss_val': 1.349996785333514, 'psi': 0.34540083554995427}
[S14] START round=1 head_norm_before_train=1.190702 (no previous merge yet)
[S14] round=1 local utility u=0.295186 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7059245458975311, 'loss_val': 1.3268128552167928, 'psi': 0.3665845300886347}-{'f1_val': 0.14035785288270378, 'auprc': 0.5175320804956661, 'loss_val': 1.352006873253277, 'psi': 0.29122754392788874}
[S15] START round=1 head_norm_before_train=1.242293 (no previous merge yet)
[S15] round=1 local utility u=0.000471 metrics={'f1_val': 0.14371357591153616, 'auprc': 0.7745415720862602, 'loss_val': 1.3330705554066595, 'psi': 0.3960447743814258}-{'f1_val': 0.24886999968107423, 'auprc': 0.5729417822096216, 'loss_val': 1.3601507484749922, 'psi': 0.37849871269249313}
[S16] START round=1 head_norm_before_train=1.198214 (no previous merge yet)
[S16] round=1 local utility u=0.227484 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.6799623109462216, 'loss_val': 1.313856897802002, 'psi': 0.3563673944980106}-{'f1_val': 0.14063745019920318, 'auprc': 0.5425886325284692, 'loss_val': 1.3567045561333224, 'psi': 0.30141792313090965}
[S17] START round=1 head_norm_before_train=1.143504 (no previous merge yet)
[S17] round=1 local utility u=0.183922 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5240130844907892, 'loss_val': 1.3412940584583297, 'psi': 0.2941746117867463}-{'f1_val': 0.09718183851487364, 'auprc': 0.4997838676989865, 'loss_val': 1.373846752064934, 'psi': 0.25822265018851875}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S6] → sending delta(kind=head bytes=1791) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S10] → sending delta(kind=head bytes=1788) to S5@127.0.0.1:61005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] → sending delta(kind=head bytes=1792) to S7@127.0.0.1:61008
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S16] → sending delta(kind=head bytes=1786) to S5@127.0.0.1:61005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1781 reason=None
[S14] → sending delta(kind=head bytes=1781) to S8@127.0.0.1:61009
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S8] → sending delta(kind=head bytes=1791) to S9@127.0.0.1:61010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:61008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:61016
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1782 reason=None
[S11] → sending delta(kind=head bytes=1782) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] → sending delta(kind=head bytes=1793) to S10@127.0.0.1:61011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S9] → sending delta(kind=head bytes=1789) to S3@127.0.0.1:61003
[S11] sending update (kind=head size=1782 to 1 peers)
[S3] sending update (kind=head size=1793 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1793 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1789 to 1 peers)
[S8] sending update (kind=head size=1791 to 1 peers)
[S14] sending update (kind=head size=1781 to 1 peers)
[S16] sending update (kind=head size=1786 to 1 peers)
[S5] sending update (kind=head size=1792 to 1 peers)
[S10] sending update (kind=head size=1788 to 1 peers)
[S6] sending update (kind=head size=1791 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1795) from S15
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.252245)
[S7] loaded HEAD from S15 (vec_in norm=1.252245)
[S7] cosine check vs S15: cos=-0.0098
[S7] DROPPED delta from S15 (cos=-0.0098 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1793) from S7
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.234176)
[S10] loaded HEAD from S7 (vec_in norm=1.234176)
[S10] cosine check vs S7: cos=0.0922
[S10] BUFFERED delta from S7 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1791) from S8
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.173660)
[S9] loaded HEAD from S8 (vec_in norm=1.173660)
[S9] cosine check vs S8: cos=0.0895
[S9] BUFFERED delta from S8 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1791) from S6
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.211399)
[S8] loaded HEAD from S6 (vec_in norm=1.211399)
[S8] cosine check vs S6: cos=-0.0070
[S8] DROPPED delta from S6 (cos=-0.0070 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1786) from S16
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.220440)
[S5] loaded HEAD from S16 (vec_in norm=1.220440)
[S5] cosine check vs S16: cos=0.0505
[S5] BUFFERED delta from S16 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1792) from S5
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.229024)
[S7] loaded HEAD from S5 (vec_in norm=1.229024)
[S7] cosine check vs S5: cos=-0.0673
[S7] DROPPED delta from S5 (cos=-0.0673 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1795) from S4
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.207978)
[S8] loaded HEAD from S4 (vec_in norm=1.207978)
[S8] cosine check vs S4: cos=-0.0619
[S8] DROPPED delta from S4 (cos=-0.0619 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1788) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.276307)
[S5] loaded HEAD from S10 (vec_in norm=1.276307)
[S5] cosine check vs S10: cos=-0.0558
[S5] DROPPED delta from S10 (cos=-0.0558 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1781) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.210714)
[S8] loaded HEAD from S14 (vec_in norm=1.210714)
[S8] cosine check vs S14: cos=-0.0659
[S8] DROPPED delta from S14 (cos=-0.0659 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1789) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.244207)
[S3] loaded HEAD from S9 (vec_in norm=1.244207)
[S3] cosine check vs S9: cos=0.0396
[S3] BUFFERED delta from S9 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1793) from S3
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.280391)
[S16] loaded HEAD from S3 (vec_in norm=1.280391)
[S16] cosine check vs S3: cos=-0.0445
[S16] DROPPED delta from S3 (cos=-0.0445 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1782) from S11
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.233097)
[S17] loaded HEAD from S11 (vec_in norm=1.233097)
[S17] cosine check vs S11: cos=0.0119
[S17] BUFFERED delta from S11 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:61015
[S17] sending update (kind=head size=1797 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1797) from S17
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.154420)
[S15] loaded HEAD from S17 (vec_in norm=1.154420)
[S15] cosine check vs S17: cos=-0.0457
[S15] DROPPED delta from S17 (cos=-0.0457 < 0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=1 metric=0.1414 head_norm=1.244207
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.160894e-01
[S9] stored merged vector for next round verification (round=1)
[S9] DEBUG after merge:  round=1 metric=0.1414 head_norm=0.892615 delta_norm=0.816089
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=1 metric=0.1386 head_norm=1.276307
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.458095e-01
[S10] stored merged vector for next round verification (round=1)
[S10] DEBUG after merge:  round=1 metric=0.1386 head_norm=0.927729 delta_norm=0.845809
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=1 metric=0.1423 head_norm=1.229024
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.438760e-01
[S5] stored merged vector for next round verification (round=1)
[S5] DEBUG after merge:  round=1 metric=0.1423 head_norm=0.887614 delta_norm=0.843876
[S5] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=1 metric=0.1398 head_norm=1.280391
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.748295e-01
[S3] stored merged vector for next round verification (round=1)
[S3] DEBUG after merge:  round=1 metric=0.1398 head_norm=0.910164 delta_norm=0.874830
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=1 metric=0.1409 head_norm=1.154420
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.395230e-01
[S17] stored merged vector for next round verification (round=1)
[S17] DEBUG after merge:  round=1 metric=0.2430 head_norm=0.849593 delta_norm=0.839523
[S17] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=1.265251 (no previous merge yet)
[S2] round=2 local utility u=0.004897 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7092453698374395, 'loss_val': 1.2347899392393218, 'psi': 0.3687644279681158}-{'f1_val': 0.1417771333885667, 'auprc': 0.7223737115899385, 'loss_val': 1.2839689683445619, 'psi': 0.37401576466911546}
[S3] START round=2 head_norm_before_train=0.910164 cos_to_last_merge=1.0000 (last merge round=1)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8473095932026254, 'loss_val': 1.237512770219925, 'psi': 0.4228278766495144}-{'f1_val': 0.13984006561410703, 'auprc': 0.9210948546085594, 'loss_val': 1.279776447925431, 'psi': 0.45234198121188807}
[S4] START round=2 head_norm_before_train=1.207978 (no previous merge yet)
[S4] round=2 local utility u=0.020125 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.783682959143567, 'loss_val': 1.2716102555734305, 'psi': 0.3976091609945373}-{'f1_val': 0.14022662889518414, 'auprc': 0.7857324053896744, 'loss_val': 1.318007958754557, 'psi': 0.39842893949298025}
[S5] START round=2 head_norm_before_train=0.887614 cos_to_last_merge=1.0000 (last merge round=1)
[S5] round=2 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7301842021374573, 'loss_val': 1.209789467919532, 'psi': 0.3774308237121258}-{'f1_val': 0.14226190476190476, 'auprc': 0.7436938492723654, 'loss_val': 1.2459044840587985, 'psi': 0.382834682566089}
[S6] START round=2 head_norm_before_train=1.211399 (no previous merge yet)
[S6] round=2 local utility u=0.134203 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8315127737389245, 'loss_val': 1.2926356281892637, 'psi': 0.417460878726339}-{'f1_val': 0.14142628205128205, 'auprc': 0.7530659109519411, 'loss_val': 1.325701678572667, 'psi': 0.38608213361154564}
[S7] START round=2 head_norm_before_train=1.234176 (no previous merge yet)
[S7] round=2 local utility u=0.031075 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7945833899915387, 'loss_val': 1.2488033382650778, 'psi': 0.4030674496340705}-{'f1_val': 0.14205682272909165, 'auprc': 0.7883261384437966, 'loss_val': 1.2921809824664818, 'psi': 0.4005645490149737}
[S8] START round=2 head_norm_before_train=1.173660 (no previous merge yet)
[S8] round=2 local utility u=0.000000 metrics={'f1_val': 0.1557212822796082, 'auprc': 0.6171715276935177, 'loss_val': 1.2983353045920687, 'psi': 0.340301380445172}-{'f1_val': 0.4000804257242513, 'auprc': 0.5808291843893383, 'loss_val': 1.3397782859225307, 'psi': 0.4723799291902861}
[S9] START round=2 head_norm_before_train=0.892615 cos_to_last_merge=1.0000 (last merge round=1)
[S9] round=2 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8653496517436909, 'loss_val': 1.2147800241420081, 'psi': 0.430978634981474}-{'f1_val': 0.141397957139996, 'auprc': 0.9892925592699312, 'loss_val': 1.249843408265584, 'psi': 0.4805557979919701}
[S10] START round=2 head_norm_before_train=0.927729 cos_to_last_merge=1.0000 (last merge round=1)
[S10] round=2 local utility u=0.000721 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7870026067943189, 'loss_val': 1.3171410126344878, 'psi': 0.39797402524276193}-{'f1_val': 0.13862163754172394, 'auprc': 0.7859181093716165, 'loss_val': 1.3153289406089728, 'psi': 0.397540226273681}
[S11] START round=2 head_norm_before_train=1.233097 (no previous merge yet)
[S11] round=2 local utility u=0.038750 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8025537121968732, 'loss_val': 1.2571383669533391, 'psi': 0.40526969490261566}-{'f1_val': 0.1412, 'auprc': 0.7933372284337665, 'loss_val': 1.3117066870671312, 'psi': 0.4020548913735066}
[S13] START round=2 head_norm_before_train=1.192464 (no previous merge yet)
[S13] round=2 local utility u=0.024993 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.645116726913874, 'loss_val': 1.2892895762314516, 'psi': 0.34227814831178144}-{'f1_val': 0.1403857625770531, 'auprc': 0.6389289226810322, 'loss_val': 1.3207114430775015, 'psi': 0.33980302661864475}
[S14] START round=2 head_norm_before_train=1.210714 (no previous merge yet)
[S14] round=2 local utility u=0.044314 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7265008074821966, 'loss_val': 1.2999128101674273, 'psi': 0.3748150347225009}-{'f1_val': 0.14035785288270378, 'auprc': 0.7059245458975311, 'loss_val': 1.3268128552167928, 'psi': 0.3665845300886347}
[S15] START round=2 head_norm_before_train=1.252245 (no previous merge yet)
[S15] round=2 local utility u=0.006753 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7763425270200213, 'loss_val': 1.3010883384777974, 'psi': 0.39437720162494355}-{'f1_val': 0.14371357591153616, 'auprc': 0.7745415720862602, 'loss_val': 1.3330705554066595, 'psi': 0.3960447743814258}
[S16] START round=2 head_norm_before_train=1.220440 (no previous merge yet)
[S16] round=2 local utility u=0.166693 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7729823324978007, 'loss_val': 1.2595309520020963, 'psi': 0.39357540311864225}-{'f1_val': 0.14063745019920318, 'auprc': 0.6799623109462216, 'loss_val': 1.313856897802002, 'psi': 0.3563673944980106}
[S17] START round=2 head_norm_before_train=0.849593 cos_to_last_merge=1.0000 (last merge round=1)
[S17] round=2 local utility u=0.066375 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5634737256816983, 'loss_val': 1.326926347394553, 'psi': 0.3099588682631099}-{'f1_val': 0.14094896331738438, 'auprc': 0.5240130844907892, 'loss_val': 1.3412940584583297, 'psi': 0.2941746117867463}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S2] → sending delta(kind=head bytes=1788) to S5@127.0.0.1:61005
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.375)
[S10] not sending this round → trigger blocked (psi=0.398)
[S15] not sending this round → trigger blocked (psi=0.394)
[S16] not sending this round → trigger blocked (psi=0.394)
[S7] not sending this round → trigger blocked (psi=0.403)
[S6] not sending this round → trigger blocked (psi=0.417)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.398)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S13] → sending delta(kind=head bytes=1787) to S5@127.0.0.1:61005
[S11] not sending this round → trigger blocked (psi=0.405)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1787 to 1 peers)
[S2] sending update (kind=head size=1788 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1788) from S2
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.286282)
[S5] loaded HEAD from S2 (vec_in norm=1.286282)
[S5] cosine check vs S2: cos=-0.0371
[S5] DROPPED delta from S2 (cos=-0.0371 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1787) from S13
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.212991)
[S5] loaded HEAD from S13 (vec_in norm=1.212991)
[S5] cosine check vs S13: cos=-0.0991
[S5] DROPPED delta from S13 (cos=-0.0991 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.310)
[S2] START round=3 head_norm_before_train=1.286282 (no previous merge yet)
[S2] round=3 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6055280972753353, 'loss_val': 1.173957748654856, 'psi': 0.32727751894327417}-{'f1_val': 0.1417771333885667, 'auprc': 0.7092453698374395, 'loss_val': 1.2347899392393218, 'psi': 0.3687644279681158}
[S3] START round=3 head_norm_before_train=0.968461 cos_to_last_merge=0.9949 (last merge round=1)
[S3] round=3 local utility u=0.005361 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7959706322261788, 'loss_val': 1.0727742274279988, 'psi': 0.4022922922589358}-{'f1_val': 0.13984006561410703, 'auprc': 0.8473095932026254, 'loss_val': 1.237512770219925, 'psi': 0.4228278766495144}
[S4] START round=3 head_norm_before_train=1.233008 (no previous merge yet)
[S4] round=3 local utility u=0.032679 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7839528707190729, 'loss_val': 1.2070611310290424, 'psi': 0.39771712562473965}-{'f1_val': 0.14022662889518414, 'auprc': 0.783682959143567, 'loss_val': 1.2716102555734305, 'psi': 0.3976091609945373}
[S5] START round=3 head_norm_before_train=0.933656 cos_to_last_merge=0.9922 (last merge round=1)
[S5] round=3 local utility u=0.947440 metrics={'f1_val': 0.41694544507090897, 'auprc': 0.7709714039012143, 'loss_val': 1.0853730077555301, 'psi': 0.5585558286030312}-{'f1_val': 0.14226190476190476, 'auprc': 0.7301842021374573, 'loss_val': 1.209789467919532, 'psi': 0.3774308237121258}
[S6] START round=3 head_norm_before_train=1.233721 (no previous merge yet)
[S6] round=3 local utility u=0.027094 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8367542088554654, 'loss_val': 1.2541710868720473, 'psi': 0.41955745277295536}-{'f1_val': 0.14142628205128205, 'auprc': 0.8315127737389245, 'loss_val': 1.2926356281892637, 'psi': 0.417460878726339}
[S7] START round=3 head_norm_before_train=1.276354 (no previous merge yet)
[S7] round=3 local utility u=0.005140 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7779082457837675, 'loss_val': 1.1884979341223125, 'psi': 0.396397391950962}-{'f1_val': 0.14205682272909165, 'auprc': 0.7945833899915387, 'loss_val': 1.2488033382650778, 'psi': 0.4030674496340705}
[S8] START round=3 head_norm_before_train=1.192127 (no previous merge yet)
[S8] round=3 local utility u=0.167338 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7416895436005458, 'loss_val': 1.2426224144264375, 'psi': 0.3806494068759927}-{'f1_val': 0.1557212822796082, 'auprc': 0.6171715276935177, 'loss_val': 1.2983353045920687, 'psi': 0.340301380445172}
[S9] START round=3 head_norm_before_train=0.954318 cos_to_last_merge=0.9931 (last merge round=1)
[S9] round=3 local utility u=0.143556 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9023412440488093, 'loss_val': 1.0386437024097084, 'psi': 0.44577527190352134}-{'f1_val': 0.141397957139996, 'auprc': 0.8653496517436909, 'loss_val': 1.2147800241420081, 'psi': 0.430978634981474}
[S10] START round=3 head_norm_before_train=0.947722 cos_to_last_merge=0.9972 (last merge round=1)
[S10] round=3 local utility u=0.005750 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7740900096735367, 'loss_val': 1.266902884153445, 'psi': 0.39280898639444906}-{'f1_val': 0.13862163754172394, 'auprc': 0.7870026067943189, 'loss_val': 1.3171410126344878, 'psi': 0.39797402524276193}
[S11] START round=3 head_norm_before_train=1.262574 (no previous merge yet)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7662186788471884, 'loss_val': 1.193560969568165, 'psi': 0.39073568156274174}-{'f1_val': 0.14041368337311058, 'auprc': 0.8025537121968732, 'loss_val': 1.2571383669533391, 'psi': 0.40526969490261566}
[S13] START round=3 head_norm_before_train=1.212991 (no previous merge yet)
[S13] round=3 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6103023082319667, 'loss_val': 1.2583866435750606, 'psi': 0.3283523808390186}-{'f1_val': 0.1403857625770531, 'auprc': 0.645116726913874, 'loss_val': 1.2892895762314516, 'psi': 0.34227814831178144}
[S14] START round=3 head_norm_before_train=1.240544 (no previous merge yet)
[S14] round=3 local utility u=0.038512 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7399457627080234, 'loss_val': 1.2632239999334802, 'psi': 0.38019301681283163}-{'f1_val': 0.14035785288270378, 'auprc': 0.7265008074821966, 'loss_val': 1.2999128101674273, 'psi': 0.3748150347225009}
[S15] START round=3 head_norm_before_train=1.270845 (no previous merge yet)
[S15] round=3 local utility u=0.020565 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7766769024194982, 'loss_val': 1.2609624143664746, 'psi': 0.3945109517847343}-{'f1_val': 0.13973365136155833, 'auprc': 0.7763425270200213, 'loss_val': 1.3010883384777974, 'psi': 0.39437720162494355}
[S16] START round=3 head_norm_before_train=1.250189 (no previous merge yet)
[S16] round=3 local utility u=0.073312 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8075279045654065, 'loss_val': 1.2165430700293849, 'psi': 0.40739363194568456}-{'f1_val': 0.14063745019920318, 'auprc': 0.7729823324978007, 'loss_val': 1.2595309520020963, 'psi': 0.39357540311864225}
[S17] START round=3 head_norm_before_train=0.865615 cos_to_last_merge=0.9968 (last merge round=1)
[S17] round=3 local utility u=0.019962 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5605402985874872, 'loss_val': 1.278201351552835, 'psi': 0.3087854974254255}-{'f1_val': 0.14094896331738438, 'auprc': 0.5634737256816983, 'loss_val': 1.326926347394553, 'psi': 0.3099588682631099}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S14] → sending delta(kind=head bytes=1786) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:61012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:61014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S8] → sending delta(kind=head bytes=1790) to S15@127.0.0.1:61015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] → sending delta(kind=head bytes=1806) to S11@127.0.0.1:61012
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S9] → sending delta(kind=head bytes=1791) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:61017
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S16] → sending delta(kind=head bytes=1790) to S7@127.0.0.1:61008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] → sending delta(kind=head bytes=1792) to S9@127.0.0.1:61010
[S16] sending update (kind=head size=1790 to 1 peers)
[S6] sending update (kind=head size=1792 to 1 peers)
[S9] sending update (kind=head size=1791 to 1 peers)
[S15] sending update (kind=head size=1792 to 1 peers)
[S5] sending update (kind=head size=1806 to 1 peers)
[S8] sending update (kind=head size=1790 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1786 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1792) from S15
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.296947)
[S9] loaded HEAD from S15 (vec_in norm=1.296947)
[S9] cosine check vs S15: cos=0.0253
[S9] BUFFERED delta from S15 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1790) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.281727)
[S7] loaded HEAD from S16 (vec_in norm=1.281727)
[S7] cosine check vs S16: cos=-0.0721
[S7] DROPPED delta from S16 (cos=-0.0721 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1790) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.219643)
[S15] loaded HEAD from S8 (vec_in norm=1.219643)
[S15] cosine check vs S8: cos=0.0621
[S15] BUFFERED delta from S8 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1796) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=0.979008)
[S14] loaded HEAD from S10 (vec_in norm=0.979008)
[S14] cosine check vs S10: cos=0.0571
[S14] BUFFERED delta from S10 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1798) from S4
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.267029)
[S8] loaded HEAD from S4 (vec_in norm=1.267029)
[S8] cosine check vs S4: cos=-0.0578
[S8] DROPPED delta from S4 (cos=-0.0578 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1806) from S5
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.972203)
[S11] loaded HEAD from S5 (vec_in norm=0.972203)
[S11] cosine check vs S5: cos=0.0692
[S11] BUFFERED delta from S5 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1797) from S3
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.025669)
[S11] loaded HEAD from S3 (vec_in norm=1.025669)
[S11] cosine check vs S3: cos=0.0695
[S11] BUFFERED delta from S3 (total buffered=2)
[S17] RECEIVED delta(kind=head bytes=1797) from S7
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.296712)
[S17] loaded HEAD from S7 (vec_in norm=1.296712)
[S17] cosine check vs S7: cos=-0.1071
[S17] DROPPED delta from S7 (cos=-0.1071 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1792) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.263352)
[S17] loaded HEAD from S6 (vec_in norm=1.263352)
[S17] cosine check vs S6: cos=-0.1076
[S17] DROPPED delta from S6 (cos=-0.1076 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1791) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.007772)
[S17] loaded HEAD from S9 (vec_in norm=1.007772)
[S17] cosine check vs S9: cos=0.0350
[S17] BUFFERED delta from S9 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1786) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.276299)
[S8] loaded HEAD from S14 (vec_in norm=1.276299)
[S8] cosine check vs S14: cos=-0.0628
[S8] DROPPED delta from S14 (cos=-0.0628 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S17] → sending delta(kind=head bytes=1789) to S13@127.0.0.1:61013
[S17] sending update (kind=head size=1789 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1789) from S17
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.892343)
[S13] loaded HEAD from S17 (vec_in norm=0.892343)
[S13] cosine check vs S17: cos=-0.1185
[S13] DROPPED delta from S17 (cos=-0.1185 < 0.0)
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=3 metric=0.1404 head_norm=1.296749
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.024416e-01
[S11] stored merged vector for next round verification (round=3)
[S11] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.763712 delta_norm=0.702442
[S11] aggregate: ACCEPT kept=['S5', 'S3'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=3 metric=0.1397 head_norm=1.296947
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.621305e-01
[S15] stored merged vector for next round verification (round=3)
[S15] DEBUG after merge:  round=3 metric=0.1397 head_norm=0.917350 delta_norm=0.862130
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=3 metric=0.1414 head_norm=1.007772
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.110995e-01
[S9] stored merged vector for next round verification (round=3)
[S9] DEBUG after merge:  round=3 metric=0.1414 head_norm=0.831237 delta_norm=0.811099
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=3 metric=0.1404 head_norm=1.276299
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.817964e-01
[S14] stored merged vector for next round verification (round=3)
[S14] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.826131 delta_norm=0.781796
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=3 metric=0.1409 head_norm=0.892343
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.612256e-01
[S17] stored merged vector for next round verification (round=3)
[S17] DEBUG after merge:  round=3 metric=0.1409 head_norm=0.684632 delta_norm=0.661226
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=1.314155 (no previous merge yet)
[S2] round=4 local utility u=0.046291 metrics={'f1_val': 0.14413560749631502, 'auprc': 0.6080526290970514, 'loss_val': 1.10309949643587, 'psi': 0.32970241613660956}-{'f1_val': 0.1417771333885667, 'auprc': 0.6055280972753353, 'loss_val': 1.173957748654856, 'psi': 0.32727751894327417}
[S3] START round=4 head_norm_before_train=1.025669 cos_to_last_merge=0.9820 (last merge round=1)
[S3] round=4 local utility u=0.903888 metrics={'f1_val': 0.39629664251078706, 'auprc': 0.7958427387318601, 'loss_val': 0.8033536047108608, 'psi': 0.5561150809992162}-{'f1_val': 0.13984006561410703, 'auprc': 0.7959706322261788, 'loss_val': 1.0727742274279988, 'psi': 0.4022922922589358}
[S4] START round=4 head_norm_before_train=1.267029 (no previous merge yet)
[S4] round=4 local utility u=0.061946 metrics={'f1_val': 0.14497098646034817, 'auprc': 0.7827701738871569, 'loss_val': 1.1080877741987325, 'psi': 0.40009066143107164}-{'f1_val': 0.14022662889518414, 'auprc': 0.7839528707190729, 'loss_val': 1.2070611310290424, 'psi': 0.39771712562473965}
[S5] START round=4 head_norm_before_train=0.972203 cos_to_last_merge=0.9811 (last merge round=1)
[S5] round=4 local utility u=0.094362 metrics={'f1_val': 0.41770847824441854, 'auprc': 0.7774314487849532, 'loss_val': 0.9206075328366535, 'psi': 0.5615976664606324}-{'f1_val': 0.41694544507090897, 'auprc': 0.7709714039012143, 'loss_val': 1.0853730077555301, 'psi': 0.5585558286030312}
[S6] START round=4 head_norm_before_train=1.263352 (no previous merge yet)
[S6] round=4 local utility u=0.024181 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8390240114802044, 'loss_val': 1.2126177923329264, 'psi': 0.420465373822851}-{'f1_val': 0.14142628205128205, 'auprc': 0.8367542088554654, 'loss_val': 1.2541710868720473, 'psi': 0.41955745277295536}
[S7] START round=4 head_norm_before_train=1.296712 (no previous merge yet)
[S7] round=4 local utility u=0.889073 metrics={'f1_val': 0.4168747328879592, 'auprc': 0.7945008740839647, 'loss_val': 1.109038064717431, 'psi': 0.5679251893663615}-{'f1_val': 0.14205682272909165, 'auprc': 0.7779082457837675, 'loss_val': 1.1884979341223125, 'psi': 0.396397391950962}
[S8] START round=4 head_norm_before_train=1.219643 (no previous merge yet)
[S8] round=4 local utility u=0.060616 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7660359156113851, 'loss_val': 1.1944290805671347, 'psi': 0.39038795568032836}-{'f1_val': 0.13995598239295717, 'auprc': 0.7416895436005458, 'loss_val': 1.2426224144264375, 'psi': 0.3806494068759927}
[S9] START round=4 head_norm_before_train=0.831237 cos_to_last_merge=1.0000 (last merge round=3)
[S9] round=4 local utility u=0.240013 metrics={'f1_val': 0.1883975842010664, 'auprc': 0.9143884940584124, 'loss_val': 0.8767572350858818, 'psi': 0.4787939481440048}-{'f1_val': 0.141397957139996, 'auprc': 0.9023412440488093, 'loss_val': 1.0386437024097084, 'psi': 0.44577527190352134}
[S10] START round=4 head_norm_before_train=0.979008 cos_to_last_merge=0.9897 (last merge round=1)
[S10] round=4 local utility u=0.035763 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7761208033949464, 'loss_val': 1.2014694935030659, 'psi': 0.3936213038830129}-{'f1_val': 0.13862163754172394, 'auprc': 0.7740900096735367, 'loss_val': 1.266902884153445, 'psi': 0.39280898639444906}
[S11] START round=4 head_norm_before_train=0.763712 cos_to_last_merge=1.0000 (last merge round=3)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7090848630000087, 'loss_val': 1.175096467887168, 'psi': 0.36788215522386986}-{'f1_val': 0.14041368337311058, 'auprc': 0.7662186788471884, 'loss_val': 1.193560969568165, 'psi': 0.39073568156274174}
[S13] START round=4 head_norm_before_train=1.236662 (no previous merge yet)
[S13] round=4 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.583403071910734, 'loss_val': 1.2230870008036612, 'psi': 0.3175926863105255}-{'f1_val': 0.1403857625770531, 'auprc': 0.6103023082319667, 'loss_val': 1.2583866435750606, 'psi': 0.3283523808390186}
[S14] START round=4 head_norm_before_train=0.826131 cos_to_last_merge=1.0000 (last merge round=3)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7200121566202644, 'loss_val': 1.2577398645383933, 'psi': 0.372219574377728}-{'f1_val': 0.14035785288270378, 'auprc': 0.7399457627080234, 'loss_val': 1.2632239999334802, 'psi': 0.38019301681283163}
[S15] START round=4 head_norm_before_train=0.917350 cos_to_last_merge=1.0000 (last merge round=3)
[S15] round=4 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7768937233510158, 'loss_val': 1.2664225621124119, 'psi': 0.39459768015734137}-{'f1_val': 0.13973365136155833, 'auprc': 0.7766769024194982, 'loss_val': 1.2609624143664746, 'psi': 0.3945109517847343}
[S16] START round=4 head_norm_before_train=1.281727 (no previous merge yet)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.6003459778399748, 'loss_val': 1.1576805898485563, 'psi': 0.3245208612555118}-{'f1_val': 0.14063745019920318, 'auprc': 0.8075279045654065, 'loss_val': 1.2165430700293849, 'psi': 0.40739363194568456}
[S17] START round=4 head_norm_before_train=0.684632 cos_to_last_merge=1.0000 (last merge round=3)
[S17] round=4 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5460216658297155, 'loss_val': 1.2677080352977483, 'psi': 0.3029780443223168}-{'f1_val': 0.14094896331738438, 'auprc': 0.5605402985874872, 'loss_val': 1.278201351552835, 'psi': 0.3087854974254255}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:61009
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.568)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.562)
[S9] not sending this round → trigger blocked (psi=0.479)
[S6] not sending this round → trigger blocked (psi=0.420)
[S8] not sending this round → trigger blocked (psi=0.390)
[S3] not sending this round → trigger blocked (psi=0.556)
[S10] not sending this round → trigger blocked (psi=0.394)
[S4] not sending this round → trigger blocked (psi=0.400)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1794 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1794) from S2
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.345842)
[S8] loaded HEAD from S2 (vec_in norm=1.345842)
[S8] cosine check vs S2: cos=0.0191
[S8] BUFFERED delta from S2 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=4 metric=0.1400 head_norm=1.237497
[S8] _apply_head_vector_avg (torch): Δ‖w‖=9.054013e-01
[S8] stored merged vector for next round verification (round=4)
[S8] DEBUG after merge:  round=4 metric=0.3084 head_norm=0.922818 delta_norm=0.905401
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=1.345842 (no previous merge yet)
[S2] round=5 local utility u=1.000000 metrics={'f1_val': 0.4164687419666223, 'auprc': 0.7394823249296603, 'loss_val': 0.9827864305652748, 'psi': 0.5456741751518375}-{'f1_val': 0.14413560749631502, 'auprc': 0.6080526290970514, 'loss_val': 1.10309949643587, 'psi': 0.32970241613660956}
[S3] START round=5 head_norm_before_train=1.094857 cos_to_last_merge=0.9585 (last merge round=1)
[S3] round=5 local utility u=0.050138 metrics={'f1_val': 0.4038388831837816, 'auprc': 0.8177428530268208, 'loss_val': 0.8140321571840332, 'psi': 0.5694004711209972}-{'f1_val': 0.39629664251078706, 'auprc': 0.7958427387318601, 'loss_val': 0.8033536047108608, 'psi': 0.5561150809992162}
[S4] START round=5 head_norm_before_train=1.309446 (no previous merge yet)
[S4] round=5 local utility u=1.000000 metrics={'f1_val': 0.6556690973694574, 'auprc': 0.7834555392112277, 'loss_val': 0.9498964205887237, 'psi': 0.7067836741061655}-{'f1_val': 0.14497098646034817, 'auprc': 0.7827701738871569, 'loss_val': 1.1080877741987325, 'psi': 0.40009066143107164}
[S5] START round=5 head_norm_before_train=1.025003 cos_to_last_merge=0.9625 (last merge round=1)
[S5] round=5 local utility u=0.108595 metrics={'f1_val': 0.4175465518408786, 'auprc': 0.7947625118920382, 'loss_val': 0.7544396029163859, 'psi': 0.5684329358613425}-{'f1_val': 0.41770847824441854, 'auprc': 0.7774314487849532, 'loss_val': 0.9206075328366535, 'psi': 0.5615976664606324}
[S6] START round=5 head_norm_before_train=1.290645 (no previous merge yet)
[S6] round=5 local utility u=0.038605 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8405575984771708, 'loss_val': 1.140008998448856, 'psi': 0.42107880862163755}-{'f1_val': 0.14142628205128205, 'auprc': 0.8390240114802044, 'loss_val': 1.2126177923329264, 'psi': 0.420465373822851}
[S7] START round=5 head_norm_before_train=1.314911 (no previous merge yet)
[S7] round=5 local utility u=0.123626 metrics={'f1_val': 0.41711588266717814, 'auprc': 0.7945706350549671, 'loss_val': 0.8634414419214952, 'psi': 0.5680977836222937}-{'f1_val': 0.4168747328879592, 'auprc': 0.7945008740839647, 'loss_val': 1.109038064717431, 'psi': 0.5679251893663615}
[S8] START round=5 head_norm_before_train=0.922818 cos_to_last_merge=1.0000 (last merge round=4)
[S8] round=5 local utility u=0.754202 metrics={'f1_val': 0.39346513401074185, 'auprc': 0.7661134764851204, 'loss_val': 1.207312663716946, 'psi': 0.5425244710004933}-{'f1_val': 0.13995598239295717, 'auprc': 0.7660359156113851, 'loss_val': 1.1944290805671347, 'psi': 0.39038795568032836}
[S9] START round=5 head_norm_before_train=0.902398 cos_to_last_merge=0.9902 (last merge round=3)
[S9] round=5 local utility u=1.000000 metrics={'f1_val': 0.7014391336149548, 'auprc': 0.9994081674975712, 'loss_val': 0.5400846223608234, 'psi': 0.8206267471680013}-{'f1_val': 0.1883975842010664, 'auprc': 0.9143884940584124, 'loss_val': 0.8767572350858818, 'psi': 0.4787939481440048}
[S10] START round=5 head_norm_before_train=1.019960 cos_to_last_merge=0.9793 (last merge round=1)
[S10] round=5 local utility u=0.044256 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7761747513453688, 'loss_val': 1.1131201865567852, 'psi': 0.3936428830631819}-{'f1_val': 0.13862163754172394, 'auprc': 0.7761208033949464, 'loss_val': 1.2014694935030659, 'psi': 0.3936213038830129}
[S11] START round=5 head_norm_before_train=0.802935 cos_to_last_merge=0.9964 (last merge round=3)
[S11] round=5 local utility u=0.094877 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7377643025331984, 'loss_val': 1.071380841868564, 'psi': 0.3793539310371457}-{'f1_val': 0.14041368337311058, 'auprc': 0.7090848630000087, 'loss_val': 1.175096467887168, 'psi': 0.36788215522386986}
[S13] START round=5 head_norm_before_train=1.259979 (no previous merge yet)
[S13] round=5 local utility u=0.027340 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5843672548885077, 'loss_val': 1.1713002810615085, 'psi': 0.31797835950163494}-{'f1_val': 0.1403857625770531, 'auprc': 0.583403071910734, 'loss_val': 1.2230870008036612, 'psi': 0.3175926863105255}
[S14] START round=5 head_norm_before_train=0.864147 cos_to_last_merge=0.9972 (last merge round=3)
[S14] round=5 local utility u=0.125395 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7773625340689594, 'loss_val': 1.179000510080291, 'psi': 0.395159725357206}-{'f1_val': 0.14035785288270378, 'auprc': 0.7200121566202644, 'loss_val': 1.2577398645383933, 'psi': 0.372219574377728}
[S15] START round=5 head_norm_before_train=0.943733 cos_to_last_merge=0.9974 (last merge round=3)
[S15] round=5 local utility u=0.026917 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7770522682932687, 'loss_val': 1.213064185106338, 'psi': 0.3946610981342425}-{'f1_val': 0.13973365136155833, 'auprc': 0.7768937233510158, 'loss_val': 1.2664225621124119, 'psi': 0.39459768015734137}
[S16] START round=5 head_norm_before_train=1.301936 (no previous merge yet)
[S16] round=5 local utility u=0.810204 metrics={'f1_val': 0.4144820245979186, 'auprc': 0.5616582090394716, 'loss_val': 1.0642763296928812, 'psi': 0.47335249837453985}-{'f1_val': 0.14063745019920318, 'auprc': 0.6003459778399748, 'loss_val': 1.1576805898485563, 'psi': 0.3245208612555118}
[S17] START round=5 head_norm_before_train=0.709031 cos_to_last_merge=0.9946 (last merge round=3)
[S17] round=5 local utility u=0.039485 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5514089787667624, 'loss_val': 1.204899270994496, 'psi': 0.30513296949713564}-{'f1_val': 0.14094896331738438, 'auprc': 0.5460216658297155, 'loss_val': 1.2677080352977483, 'psi': 0.3029780443223168}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] → sending delta(kind=head bytes=1793) to S7@127.0.0.1:61008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:61010
[S2] not sending this round → trigger blocked (psi=0.546)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:61012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:61014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S11] → sending delta(kind=head bytes=1790) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] → sending delta(kind=head bytes=1805) to S11@127.0.0.1:61012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:61015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:61008
[S16] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1790 to 1 peers)
[S5] sending update (kind=head size=1805 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1793 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1790) from S11
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.849349)
[S8] loaded HEAD from S11 (vec_in norm=0.849349)
[S8] cosine check vs S11: cos=0.1031
[S8] BUFFERED delta from S11 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1801) from S4
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.354209)
[S8] loaded HEAD from S4 (vec_in norm=1.354209)
[S8] cosine check vs S4: cos=-0.0272
[S8] DROPPED delta from S4 (cos=-0.0272 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1796) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.908419)
[S8] loaded HEAD from S14 (vec_in norm=0.908419)
[S8] cosine check vs S14: cos=-0.1249
[S8] DROPPED delta from S14 (cos=-0.1249 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1805) from S5
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.088133)
[S11] loaded HEAD from S5 (vec_in norm=1.088133)
[S11] cosine check vs S5: cos=0.3362
[S11] BUFFERED delta from S5 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1795) from S3
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.183800)
[S11] loaded HEAD from S3 (vec_in norm=1.183800)
[S11] cosine check vs S3: cos=0.3531
[S11] BUFFERED delta from S3 (total buffered=2)
[S17] RECEIVED delta(kind=head bytes=1799) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.320051)
[S17] loaded HEAD from S6 (vec_in norm=1.320051)
[S17] cosine check vs S6: cos=-0.1029
[S17] DROPPED delta from S6 (cos=-0.1029 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1795) from S7
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.366742)
[S17] loaded HEAD from S7 (vec_in norm=1.366742)
[S17] cosine check vs S7: cos=-0.1236
[S17] DROPPED delta from S7 (cos=-0.1236 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1800) from S15
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.978166)
[S9] loaded HEAD from S15 (vec_in norm=0.978166)
[S9] cosine check vs S15: cos=0.7981
[S9] BUFFERED delta from S15 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1797) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.003120)
[S17] loaded HEAD from S9 (vec_in norm=1.003120)
[S17] cosine check vs S9: cos=0.5431
[S17] BUFFERED delta from S9 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1796) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.057315)
[S14] loaded HEAD from S10 (vec_in norm=1.057315)
[S14] cosine check vs S10: cos=0.5822
[S14] BUFFERED delta from S10 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1800) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.945176)
[S15] loaded HEAD from S8 (vec_in norm=0.945176)
[S15] cosine check vs S8: cos=0.4729
[S15] BUFFERED delta from S8 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1793) from S13
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.284255)
[S7] loaded HEAD from S13 (vec_in norm=1.284255)
[S7] cosine check vs S13: cos=0.0490
[S7] BUFFERED delta from S13 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1798) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.327286)
[S7] loaded HEAD from S16 (vec_in norm=1.327286)
[S7] cosine check vs S16: cos=-0.0710
[S7] DROPPED delta from S16 (cos=-0.0710 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:61013
[S17] sending update (kind=head size=1802 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1802) from S17
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.739004)
[S13] loaded HEAD from S17 (vec_in norm=0.739004)
[S13] cosine check vs S17: cos=-0.0231
[S13] DROPPED delta from S17 (cos=-0.0231 < 0.0)
[S2] ⇄ pheromone p=0.536 → S8@127.0.0.1:61009
[S4] ⇄ pheromone p=0.555 → S8@127.0.0.1:61009
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=5 metric=0.3935 head_norm=0.945176
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.019046e-01
[S8] stored merged vector for next round verification (round=5)
[S8] DEBUG after merge:  round=5 metric=0.1400 head_norm=0.667148 delta_norm=0.601905
[S8] aggregate: ROLLBACK (f1_val pre=0.393 post=0.140 tol_abs=0.005 tol_rel=0.0)
[S8] ⇄ pheromone p=0.585 → S15@127.0.0.1:61015
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=5 metric=0.1404 head_norm=0.849349
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.087967e-01
[S11] stored merged vector for next round verification (round=5)
[S11] DEBUG after merge:  round=5 metric=0.1404 head_norm=0.707097 delta_norm=0.408797
[S11] aggregate: ACCEPT kept=['S5', 'S3'] (k=2/2) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.381 → S8@127.0.0.1:61009
[S6] ⇄ pheromone p=0.376 → S17@127.0.0.1:61017
[S10] ⇄ pheromone p=0.344 → S14@127.0.0.1:61014
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=5 metric=0.1404 head_norm=0.908419
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.540598e-01
[S14] stored merged vector for next round verification (round=5)
[S14] DEBUG after merge:  round=5 metric=0.1404 head_norm=0.874871 delta_norm=0.454060
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.386 → S8@127.0.0.1:61009
[S5] ⇄ pheromone p=0.494 → S11@127.0.0.1:61012
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=5 metric=0.1397 head_norm=0.978166
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.939020e-01
[S15] stored merged vector for next round verification (round=5)
[S15] DEBUG after merge:  round=5 metric=0.1397 head_norm=0.825314 delta_norm=0.493902
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.336 → S9@127.0.0.1:61010
[S13] ⇄ pheromone p=0.336 → S7@127.0.0.1:61008
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=5 metric=0.4171 head_norm=1.366742
[S7] _apply_head_vector_avg (torch): Δ‖w‖=9.144917e-01
[S7] stored merged vector for next round verification (round=5)
[S7] DEBUG after merge:  round=5 metric=0.4172 head_norm=0.960392 delta_norm=0.914492
[S7] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.504 → S17@127.0.0.1:61017
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=5 metric=0.7014 head_norm=1.003120
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.149946e-01
[S9] stored merged vector for next round verification (round=5)
[S9] DEBUG after merge:  round=5 metric=0.7014 head_norm=0.939312 delta_norm=0.314995
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.588 → S17@127.0.0.1:61017
[S16] ⇄ pheromone p=0.535 → S7@127.0.0.1:61008
[S3] ⇄ pheromone p=0.520 → S11@127.0.0.1:61012
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=5 metric=0.1409 head_norm=0.739004
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.322067e-01
[S17] stored merged vector for next round verification (round=5)
[S17] DEBUG after merge:  round=5 metric=0.1409 head_norm=0.767715 delta_norm=0.432207
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.360 → S13@127.0.0.1:61013
[S2] START round=6 head_norm_before_train=1.377508 (no previous merge yet)
[S2] round=6 local utility u=0.874480 metrics={'f1_val': 0.6658745643332225, 'auprc': 0.7753758123063463, 'loss_val': 0.8379412397325925, 'psi': 0.709675063522472}-{'f1_val': 0.4164687419666223, 'auprc': 0.7394823249296603, 'loss_val': 0.9827864305652748, 'psi': 0.5456741751518375}
[S3] START round=6 head_norm_before_train=1.183800 cos_to_last_merge=0.9284 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.928
[S3] round=6 local utility u=1.000000 metrics={'f1_val': 0.700330919019862, 'auprc': 0.8290095999974978, 'loss_val': 0.4386374943039613, 'psi': 0.7518023914109163}-{'f1_val': 0.4038388831837816, 'auprc': 0.8177428530268208, 'loss_val': 0.8140321571840332, 'psi': 0.5694004711209972}
[S4] START round=6 head_norm_before_train=1.354209 (no previous merge yet)
[S4] round=6 local utility u=0.000000 metrics={'f1_val': 0.3761420039747142, 'auprc': 0.6659372663893202, 'loss_val': 0.7845598369623474, 'psi': 0.49206010894055663}-{'f1_val': 0.6556690973694574, 'auprc': 0.7834555392112277, 'loss_val': 0.9498964205887237, 'psi': 0.7067836741061655}
[S5] START round=6 head_norm_before_train=1.088133 cos_to_last_merge=0.9399 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.940
[S5] round=6 local utility u=0.036860 metrics={'f1_val': 0.41770670426636225, 'auprc': 0.7918675468048115, 'loss_val': 0.6729962316040599, 'psi': 0.567371041281742}-{'f1_val': 0.4175465518408786, 'auprc': 0.7947625118920382, 'loss_val': 0.7544396029163859, 'psi': 0.5684329358613425}
[S6] START round=6 head_norm_before_train=1.320051 (no previous merge yet)
[S6] round=6 local utility u=0.897591 metrics={'f1_val': 0.4166544795555117, 'auprc': 0.8406414698920793, 'loss_val': 0.9964477775524794, 'psi': 0.5862492756901387}-{'f1_val': 0.14142628205128205, 'auprc': 0.8405575984771708, 'loss_val': 1.140008998448856, 'psi': 0.42107880862163755}
[S7] START round=6 head_norm_before_train=0.960392 cos_to_last_merge=1.0000 (last merge round=5)
[S7] round=6 local utility u=0.000000 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.7854205987768519, 'loss_val': 0.8662137541569939, 'psi': 0.5641943103773548}-{'f1_val': 0.41711588266717814, 'auprc': 0.7945706350549671, 'loss_val': 0.8634414419214952, 'psi': 0.5680977836222937}
[S8] START round=6 head_norm_before_train=0.667148 cos_to_last_merge=1.0000 (last merge round=5)
[S8] round=6 local utility u=0.000000 metrics={'f1_val': 0.38042761482839393, 'auprc': 0.7708234506145437, 'loss_val': 1.1859267117147805, 'psi': 0.5365859491428538}-{'f1_val': 0.39346513401074185, 'auprc': 0.7661134764851204, 'loss_val': 1.207312663716946, 'psi': 0.5425244710004933}
[S9] START round=6 head_norm_before_train=0.939312 cos_to_last_merge=1.0000 (last merge round=5)
[S9] round=6 local utility u=0.058720 metrics={'f1_val': 0.7015406642019387, 'auprc': 0.9984430480976322, 'loss_val': 0.4203588361004651, 'psi': 0.820301617760216}-{'f1_val': 0.7014391336149548, 'auprc': 0.9994081674975712, 'loss_val': 0.5400846223608234, 'psi': 0.8206267471680013}
[S10] START round=6 head_norm_before_train=1.057315 cos_to_last_merge=0.9696 (last merge round=1)
[S10] round=6 local utility u=0.634249 metrics={'f1_val': 0.38826658836542577, 'auprc': 0.6552371329734524, 'loss_val': 0.9796783602417286, 'psi': 0.4950548062086364}-{'f1_val': 0.13862163754172394, 'auprc': 0.7761747513453688, 'loss_val': 1.1131201865567852, 'psi': 0.3936428830631819}
[S11] START round=6 head_norm_before_train=0.707097 cos_to_last_merge=1.0000 (last merge round=5)
[S11] round=6 local utility u=1.000000 metrics={'f1_val': 0.39658602128368947, 'auprc': 0.909031131539829, 'loss_val': 1.028618573950272, 'psi': 0.6015640653861453}-{'f1_val': 0.14041368337311058, 'auprc': 0.7377643025331984, 'loss_val': 1.071380841868564, 'psi': 0.3793539310371457}
[S13] START round=6 head_norm_before_train=1.284255 (no previous merge yet)
[S13] round=6 local utility u=0.857152 metrics={'f1_val': 0.4158809972763461, 'auprc': 0.5738616913059664, 'loss_val': 1.078450575976464, 'psi': 0.47907327488819423}-{'f1_val': 0.1403857625770531, 'auprc': 0.5843672548885077, 'loss_val': 1.1713002810615085, 'psi': 0.31797835950163494}
[S14] START round=6 head_norm_before_train=0.874871 cos_to_last_merge=1.0000 (last merge round=5)
[S14] round=6 local utility u=0.126034 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8361403412288625, 'loss_val': 1.1032655681538182, 'psi': 0.4186708482211673}-{'f1_val': 0.14035785288270378, 'auprc': 0.7773625340689594, 'loss_val': 1.179000510080291, 'psi': 0.395159725357206}
[S15] START round=6 head_norm_before_train=0.825314 cos_to_last_merge=1.0000 (last merge round=5)
[S15] round=6 local utility u=0.009619 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.777055136414294, 'loss_val': 1.1938342288574946, 'psi': 0.39466224538265265}-{'f1_val': 0.13973365136155833, 'auprc': 0.7770522682932687, 'loss_val': 1.213064185106338, 'psi': 0.3946610981342425}
[S16] START round=6 head_norm_before_train=1.327286 (no previous merge yet)
[S16] round=6 local utility u=0.055169 metrics={'f1_val': 0.4173869385094645, 'auprc': 0.5519924742783613, 'loss_val': 0.9423705652111278, 'psi': 0.4712291528170232}-{'f1_val': 0.4144820245979186, 'auprc': 0.5616582090394716, 'loss_val': 1.0642763296928812, 'psi': 0.47335249837453985}
[S17] START round=6 head_norm_before_train=0.767715 cos_to_last_merge=1.0000 (last merge round=5)
[S17] round=6 local utility u=0.755232 metrics={'f1_val': 0.3915129781894229, 'auprc': 0.5421728486563568, 'loss_val': 1.1701103034367477, 'psi': 0.4517769263761965}-{'f1_val': 0.14094896331738438, 'auprc': 0.5514089787667624, 'loss_val': 1.204899270994496, 'psi': 0.30513296949713564}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:61014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:61012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] → sending delta(kind=head bytes=1805) to S11@127.0.0.1:61012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:61017
[S6] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1805 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1794 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1800) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.358072)
[S17] loaded HEAD from S6 (vec_in norm=1.358072)
[S17] cosine check vs S6: cos=-0.0486
[S17] DROPPED delta from S6 (cos=-0.0486 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1795) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.041012)
[S17] loaded HEAD from S9 (vec_in norm=1.041012)
[S17] cosine check vs S9: cos=0.8558
[S17] BUFFERED delta from S9 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1794) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.095069)
[S14] loaded HEAD from S10 (vec_in norm=1.095069)
[S14] cosine check vs S10: cos=0.8767
[S14] BUFFERED delta from S10 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1805) from S3
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.271521)
[S11] loaded HEAD from S3 (vec_in norm=1.271521)
[S11] cosine check vs S3: cos=0.5837
[S11] BUFFERED delta from S3 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1796) from S2
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.413514)
[S8] loaded HEAD from S2 (vec_in norm=1.413514)
[S8] cosine check vs S2: cos=0.5467
[S8] BUFFERED delta from S2 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1797) from S5
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.148241)
[S11] loaded HEAD from S5 (vec_in norm=1.148241)
[S11] cosine check vs S5: cos=0.5344
[S11] BUFFERED delta from S5 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] → sending delta(kind=head bytes=1792) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:61010
[S14] sending update (kind=head size=1794 to 1 peers)
[S11] sending update (kind=head size=1792 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1804) from S15
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.854536)
[S9] loaded HEAD from S15 (vec_in norm=0.854536)
[S9] cosine check vs S15: cos=0.7795
[S9] BUFFERED delta from S15 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1794) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.907592)
[S8] loaded HEAD from S14 (vec_in norm=0.907592)
[S8] cosine check vs S14: cos=-0.1023
[S8] DROPPED delta from S14 (cos=-0.1023 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1792) from S11
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.747882)
[S8] loaded HEAD from S11 (vec_in norm=0.747882)
[S8] cosine check vs S11: cos=0.6377
[S8] BUFFERED delta from S11 (total buffered=2)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:61008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:61008
[S13] sending update (kind=head size=1797 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1797) from S13
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.315567)
[S7] loaded HEAD from S13 (vec_in norm=1.315567)
[S7] cosine check vs S13: cos=0.6539
[S7] BUFFERED delta from S13 (total buffered=1)
[S16] sending update (kind=head size=1795 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1795) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.363719)
[S7] loaded HEAD from S16 (vec_in norm=1.363719)
[S7] cosine check vs S16: cos=-0.0992
[S7] DROPPED delta from S16 (cos=-0.0992 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:61013
[S17] sending update (kind=head size=1799 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1799) from S17
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.790647)
[S13] loaded HEAD from S17 (vec_in norm=0.790647)
[S13] cosine check vs S17: cos=-0.0139
[S13] DROPPED delta from S17 (cos=-0.0139 < 0.0)
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=6 metric=0.3804 head_norm=0.698330
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.600413e-01
[S8] stored merged vector for next round verification (round=6)
[S8] DEBUG after merge:  round=6 metric=0.2351 head_norm=0.709920 delta_norm=0.260041
[S8] aggregate: ROLLBACK (f1_val pre=0.380 post=0.235 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=6 metric=0.7015 head_norm=1.041012
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.267403e-01
[S9] stored merged vector for next round verification (round=6)
[S9] DEBUG after merge:  round=6 metric=0.7013 head_norm=0.894545 delta_norm=0.326740
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=6 metric=0.3966 head_norm=0.747882
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.452926e-01
[S11] stored merged vector for next round verification (round=6)
[S11] DEBUG after merge:  round=6 metric=0.3966 head_norm=0.753102 delta_norm=0.245293
[S11] aggregate: ACCEPT kept=['S3', 'S5'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=6 metric=0.4167 head_norm=1.020072
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.040464e-01
[S7] stored merged vector for next round verification (round=6)
[S7] DEBUG after merge:  round=6 metric=0.4168 head_norm=1.063752 delta_norm=0.504046
[S7] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=6 metric=0.1404 head_norm=0.907592
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.646448e-01
[S14] stored merged vector for next round verification (round=6)
[S14] DEBUG after merge:  round=6 metric=0.2567 head_norm=0.970264 delta_norm=0.264645
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=6 metric=0.3915 head_norm=0.790647
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.738899e-01
[S17] stored merged vector for next round verification (round=6)
[S17] DEBUG after merge:  round=6 metric=0.3854 head_norm=0.882836 delta_norm=0.273890
[S17] aggregate: ROLLBACK (f1_val pre=0.392 post=0.385 tol_abs=0.005 tol_rel=0.0)
[S2] START round=7 head_norm_before_train=1.413514 (no previous merge yet)
[S2] round=7 local utility u=0.117977 metrics={'f1_val': 0.70143018994887, 'auprc': 0.7419533482303364, 'loss_val': 0.7150533043726738, 'psi': 0.7176394532614565}-{'f1_val': 0.6658745643332225, 'auprc': 0.7753758123063463, 'loss_val': 0.8379412397325925, 'psi': 0.709675063522472}
[S3] START round=7 head_norm_before_train=1.271521 cos_to_last_merge=0.9027 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.903
[S3] round=7 local utility u=0.000000 metrics={'f1_val': 0.6995786553134029, 'auprc': 0.7960275128564132, 'loss_val': 0.3882905516639755, 'psi': 0.7381581983306069}-{'f1_val': 0.700330919019862, 'auprc': 0.8290095999974978, 'loss_val': 0.4386374943039613, 'psi': 0.7518023914109163}
[S4] START round=7 head_norm_before_train=1.400929 (no previous merge yet)
[S4] round=7 local utility u=0.053573 metrics={'f1_val': 0.37931836892683896, 'auprc': 0.6608056211521349, 'loss_val': 0.681076378334544, 'psi': 0.4919132698169574}-{'f1_val': 0.3761420039747142, 'auprc': 0.6659372663893202, 'loss_val': 0.7845598369623474, 'psi': 0.49206010894055663}
[S5] START round=7 head_norm_before_train=1.148241 cos_to_last_merge=0.9171 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.917
[S5] round=7 local utility u=0.837417 metrics={'f1_val': 0.7010639315836553, 'auprc': 0.7507451764616244, 'loss_val': 0.5749392157510778, 'psi': 0.720936429534843}-{'f1_val': 0.41770670426636225, 'auprc': 0.7918675468048115, 'loss_val': 0.6729962316040599, 'psi': 0.567371041281742}
[S6] START round=7 head_norm_before_train=1.358072 (no previous merge yet)
[S6] round=7 local utility u=0.098214 metrics={'f1_val': 0.41625250229074906, 'auprc': 0.8425249276659845, 'loss_val': 0.8032582141385769, 'psi': 0.5867614724408433}-{'f1_val': 0.4166544795555117, 'auprc': 0.8406414698920793, 'loss_val': 0.9964477775524794, 'psi': 0.5862492756901387}
[S7] START round=7 head_norm_before_train=1.063752 cos_to_last_merge=1.0000 (last merge round=6)
[S7] round=7 local utility u=0.000000 metrics={'f1_val': 0.416587999573199, 'auprc': 0.7755035422058021, 'loss_val': 0.8689157455307133, 'psi': 0.5601542166262402}-{'f1_val': 0.41671011811102343, 'auprc': 0.7854205987768519, 'loss_val': 0.8662137541569939, 'psi': 0.5641943103773548}
[S8] START round=7 head_norm_before_train=0.709920 cos_to_last_merge=1.0000 (last merge round=6)
[S8] round=7 local utility u=0.148159 metrics={'f1_val': 0.416084496488008, 'auprc': 0.7766562700352333, 'loss_val': 1.1210479738158126, 'psi': 0.5603132059068981}-{'f1_val': 0.38042761482839393, 'auprc': 0.7708234506145437, 'loss_val': 1.1859267117147805, 'psi': 0.5365859491428538}
[S9] START round=7 head_norm_before_train=0.894545 cos_to_last_merge=1.0000 (last merge round=6)
[S9] round=7 local utility u=0.000000 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.980610840256653, 'loss_val': 0.39258082097827357, 'psi': 0.8130186262271992}-{'f1_val': 0.7015406642019387, 'auprc': 0.9984430480976322, 'loss_val': 0.4203588361004651, 'psi': 0.820301617760216}
[S10] START round=7 head_norm_before_train=1.095069 cos_to_last_merge=0.9594 (last merge round=1)
[S10] round=7 local utility u=0.100376 metrics={'f1_val': 0.3885887600002885, 'auprc': 0.6592373314443927, 'loss_val': 0.7928601518643876, 'psi': 0.49684818857793017}-{'f1_val': 0.38826658836542577, 'auprc': 0.6552371329734524, 'loss_val': 0.9796783602417286, 'psi': 0.4950548062086364}
[S11] START round=7 head_norm_before_train=0.753102 cos_to_last_merge=1.0000 (last merge round=6)
[S11] round=7 local utility u=0.011516 metrics={'f1_val': 0.39658602128368947, 'auprc': 0.8977011324581355, 'loss_val': 0.971596220291109, 'psi': 0.5970320657534679}-{'f1_val': 0.39658602128368947, 'auprc': 0.909031131539829, 'loss_val': 1.028618573950272, 'psi': 0.6015640653861453}
[S13] START round=7 head_norm_before_train=1.315567 (no previous merge yet)
[S13] round=7 local utility u=0.544477 metrics={'f1_val': 0.5920709325396826, 'auprc': 0.5560232803878316, 'loss_val': 0.993120170716619, 'psi': 0.5776518716789422}-{'f1_val': 0.4158809972763461, 'auprc': 0.5738616913059664, 'loss_val': 1.078450575976464, 'psi': 0.47907327488819423}
[S14] START round=7 head_norm_before_train=0.970264 cos_to_last_merge=1.0000 (last merge round=6)
[S14] round=7 local utility u=0.765493 metrics={'f1_val': 0.31529923769128676, 'auprc': 0.9676719792260369, 'loss_val': 1.0165228230890393, 'psi': 0.5762483343051867}-{'f1_val': 0.14035785288270378, 'auprc': 0.8361403412288625, 'loss_val': 1.1032655681538182, 'psi': 0.4186708482211673}
[S15] START round=7 head_norm_before_train=0.854536 cos_to_last_merge=0.9972 (last merge round=5)
[S15] round=7 local utility u=0.886771 metrics={'f1_val': 0.4156068426860873, 'auprc': 0.7791004406835955, 'loss_val': 1.0816672429659904, 'psi': 0.5610042818850905}-{'f1_val': 0.13973365136155833, 'auprc': 0.777055136414294, 'loss_val': 1.1938342288574946, 'psi': 0.39466224538265265}
[S16] START round=7 head_norm_before_train=1.363719 (no previous merge yet)
[S16] round=7 local utility u=0.237314 metrics={'f1_val': 0.3842267162592107, 'auprc': 0.7438755870448641, 'loss_val': 0.8444312969274256, 'psi': 0.5280862645734721}-{'f1_val': 0.4173869385094645, 'auprc': 0.5519924742783613, 'loss_val': 0.9423705652111278, 'psi': 0.4712291528170232}
[S17] START round=7 head_norm_before_train=0.882836 cos_to_last_merge=1.0000 (last merge round=6)
[S17] round=7 local utility u=0.000000 metrics={'f1_val': 0.391623575712542, 'auprc': 0.5221453099919695, 'loss_val': 1.1304782880388204, 'psi': 0.44383226942431303}-{'f1_val': 0.3915129781894229, 'auprc': 0.5421728486563568, 'loss_val': 1.1701103034367477, 'psi': 0.4517769263761965}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:61015
[S8] sending update (kind=head size=1800 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1800) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.741270)
[S15] loaded HEAD from S8 (vec_in norm=0.741270)
[S15] cosine check vs S8: cos=0.6250
[S15] BUFFERED delta from S8 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:61008
[S13] sending update (kind=head size=1801 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1801) from S13
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.349148)
[S7] loaded HEAD from S13 (vec_in norm=1.349148)
[S7] cosine check vs S13: cos=0.8841
[S7] BUFFERED delta from S13 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:61009
[S14] sending update (kind=head size=1794 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1794) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.995927)
[S8] loaded HEAD from S14 (vec_in norm=0.995927)
[S8] cosine check vs S14: cos=-0.0969
[S8] DROPPED delta from S14 (cos=-0.0969 < 0.0)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:61012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:61008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] → sending delta(kind=head bytes=1792) to S9@127.0.0.1:61010
[S5] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1794 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:61014
[S8] RECEIVED delta(kind=head bytes=1804) from S2
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.455301)
[S8] loaded HEAD from S2 (vec_in norm=1.455301)
[S8] cosine check vs S2: cos=0.7542
[S8] BUFFERED delta from S2 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1796) from S5
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.209136)
[S11] loaded HEAD from S5 (vec_in norm=1.209136)
[S11] cosine check vs S5: cos=0.5962
[S11] BUFFERED delta from S5 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1799) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.397467)
[S17] loaded HEAD from S6 (vec_in norm=1.397467)
[S17] cosine check vs S6: cos=-0.0224
[S17] DROPPED delta from S6 (cos=-0.0224 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1794) from S4
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.453247)
[S8] loaded HEAD from S4 (vec_in norm=1.453247)
[S8] cosine check vs S4: cos=-0.0416
[S8] DROPPED delta from S4 (cos=-0.0416 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1798) from S11
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.790241)
[S8] loaded HEAD from S11 (vec_in norm=0.790241)
[S8] cosine check vs S11: cos=0.5202
[S8] BUFFERED delta from S11 (total buffered=2)
[S15] sending update (kind=head size=1792 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1799) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.405450)
[S7] loaded HEAD from S16 (vec_in norm=1.405450)
[S7] cosine check vs S16: cos=-0.0917
[S7] DROPPED delta from S16 (cos=-0.0917 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1792) from S15
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.894145)
[S9] loaded HEAD from S15 (vec_in norm=0.894145)
[S9] cosine check vs S15: cos=0.8943
[S9] BUFFERED delta from S15 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.142142)
[S14] loaded HEAD from S10 (vec_in norm=1.142142)
[S14] cosine check vs S10: cos=0.9509
[S14] BUFFERED delta from S10 (total buffered=1)
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=7 metric=0.4161 head_norm=0.741270
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.723055e-01
[S8] stored merged vector for next round verification (round=7)
[S8] DEBUG after merge:  round=7 metric=0.4488 head_norm=0.767371 delta_norm=0.172305
[S8] aggregate: ACCEPT kept=['S2', 'S11'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=7 metric=0.3153 head_norm=0.995927
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.824753e-01
[S14] stored merged vector for next round verification (round=7)
[S14] DEBUG after merge:  round=7 metric=0.3153 head_norm=1.055880 delta_norm=0.182475
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=7 metric=0.7013 head_norm=1.001707
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.240910e-01
[S9] stored merged vector for next round verification (round=7)
[S9] DEBUG after merge:  round=7 metric=0.7013 head_norm=0.922626 delta_norm=0.224091
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=7 metric=0.3966 head_norm=0.790241
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.865879e-01
[S11] stored merged vector for next round verification (round=7)
[S11] DEBUG after merge:  round=7 metric=0.3966 head_norm=0.898041 delta_norm=0.486588
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=7 metric=0.4156 head_norm=0.894145
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.607022e-01
[S15] stored merged vector for next round verification (round=7)
[S15] DEBUG after merge:  round=7 metric=0.4156 head_norm=0.737823 delta_norm=0.360702
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=7 metric=0.4166 head_norm=1.110193
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.179232e-01
[S7] stored merged vector for next round verification (round=7)
[S7] DEBUG after merge:  round=7 metric=0.4166 head_norm=1.193855 delta_norm=0.317923
[S7] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=1.455301 (no previous merge yet)
[S2] round=8 local utility u=0.000000 metrics={'f1_val': 0.7011095150154492, 'auprc': 0.6457031908974412, 'loss_val': 0.6219166167719561, 'psi': 0.6789469853682459}-{'f1_val': 0.70143018994887, 'auprc': 0.7419533482303364, 'loss_val': 0.7150533043726738, 'psi': 0.7176394532614565}
[S3] START round=8 head_norm_before_train=1.350219 cos_to_last_merge=0.8850 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.885
[S3] round=8 local utility u=0.127092 metrics={'f1_val': 0.7000757262075916, 'auprc': 0.8631121644872706, 'loss_val': 0.33834254794740837, 'psi': 0.7652903015194632}-{'f1_val': 0.6995786553134029, 'auprc': 0.7960275128564132, 'loss_val': 0.3882905516639755, 'psi': 0.7381581983306069}
[S4] START round=8 head_norm_before_train=1.453247 (no previous merge yet)
[S4] round=8 local utility u=0.911880 metrics={'f1_val': 0.6626539013690789, 'auprc': 0.6633605425119343, 'loss_val': 0.5649941247344495, 'psi': 0.662936557826221}-{'f1_val': 0.37931836892683896, 'auprc': 0.6608056211521349, 'loss_val': 0.681076378334544, 'psi': 0.4919132698169574}
[S5] START round=8 head_norm_before_train=1.209136 cos_to_last_merge=0.8981 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.898
[S5] round=8 local utility u=0.133187 metrics={'f1_val': 0.7143347548915031, 'auprc': 0.7917684481092088, 'loss_val': 0.5112591198653696, 'psi': 0.7453082321785853}-{'f1_val': 0.7010639315836553, 'auprc': 0.7507451764616244, 'loss_val': 0.5749392157510778, 'psi': 0.720936429534843}
[S6] START round=8 head_norm_before_train=1.397467 (no previous merge yet)
[S6] round=8 local utility u=0.058261 metrics={'f1_val': 0.41584976944180807, 'auprc': 0.8444618506364876, 'loss_val': 0.6901311151288483, 'psi': 0.5872946019196799}-{'f1_val': 0.41625250229074906, 'auprc': 0.8425249276659845, 'loss_val': 0.8032582141385769, 'psi': 0.5867614724408433}
[S7] START round=8 head_norm_before_train=1.193855 cos_to_last_merge=1.0000 (last merge round=7)
[S7] round=8 local utility u=0.862835 metrics={'f1_val': 0.7024991845590718, 'auprc': 0.7786912824148924, 'loss_val': 0.8682766441747799, 'psi': 0.7329760237014}-{'f1_val': 0.416587999573199, 'auprc': 0.7755035422058021, 'loss_val': 0.8689157455307133, 'psi': 0.5601542166262402}
[S8] START round=8 head_norm_before_train=0.767371 cos_to_last_merge=1.0000 (last merge round=7)
[S8] round=8 local utility u=0.000000 metrics={'f1_val': 0.3726652774371328, 'auprc': 0.7767720249104715, 'loss_val': 1.0359471154723923, 'psi': 0.5343079764264682}-{'f1_val': 0.416084496488008, 'auprc': 0.7766562700352333, 'loss_val': 1.1210479738158126, 'psi': 0.5603132059068981}
[S9] START round=8 head_norm_before_train=0.922626 cos_to_last_merge=1.0000 (last merge round=7)
[S9] round=8 local utility u=0.046155 metrics={'f1_val': 0.7014667606303384, 'auprc': 0.9973011183953607, 'loss_val': 0.35139856885467974, 'psi': 0.8198005037363474}-{'f1_val': 0.7012904835408967, 'auprc': 0.980610840256653, 'loss_val': 0.39258082097827357, 'psi': 0.8130186262271992}
[S10] START round=8 head_norm_before_train=1.142142 cos_to_last_merge=0.9461 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.946
[S10] round=8 local utility u=0.466184 metrics={'f1_val': 0.3888096612241605, 'auprc': 0.9382101975721617, 'loss_val': 0.6987369754474618, 'psi': 0.6085698757633611}-{'f1_val': 0.3885887600002885, 'auprc': 0.6592373314443927, 'loss_val': 0.7928601518643876, 'psi': 0.49684818857793017}
[S11] START round=8 head_norm_before_train=0.898041 cos_to_last_merge=1.0000 (last merge round=7)
[S11] round=8 local utility u=0.000000 metrics={'f1_val': 0.396639232794319, 'auprc': 0.77775796504533, 'loss_val': 0.946292939387732, 'psi': 0.5490867256947234}-{'f1_val': 0.39658602128368947, 'auprc': 0.8977011324581355, 'loss_val': 0.971596220291109, 'psi': 0.5970320657534679}
[S13] START round=8 head_norm_before_train=1.349148 (no previous merge yet)
[S13] round=8 local utility u=0.000000 metrics={'f1_val': 0.4160038662657951, 'auprc': 0.6832189562094607, 'loss_val': 0.8014015894854462, 'psi': 0.5228899022432614}-{'f1_val': 0.5920709325396826, 'auprc': 0.5560232803878316, 'loss_val': 0.993120170716619, 'psi': 0.5776518716789422}
[S14] START round=8 head_norm_before_train=1.055880 cos_to_last_merge=1.0000 (last merge round=7)
[S14] round=8 local utility u=0.137513 metrics={'f1_val': 0.3170964199096267, 'auprc': 0.9974343638725809, 'loss_val': 0.8415670309647009, 'psi': 0.5892315974948084}-{'f1_val': 0.31529923769128676, 'auprc': 0.9676719792260369, 'loss_val': 1.0165228230890393, 'psi': 0.5762483343051867}
[S15] START round=8 head_norm_before_train=0.737823 cos_to_last_merge=1.0000 (last merge round=7)
[S15] round=8 local utility u=0.066967 metrics={'f1_val': 0.4169508412658852, 'auprc': 0.7997845811701126, 'loss_val': 1.017850260305455, 'psi': 0.5700843372275761}-{'f1_val': 0.4156068426860873, 'auprc': 0.7791004406835955, 'loss_val': 1.0816672429659904, 'psi': 0.5610042818850905}
[S16] START round=8 head_norm_before_train=1.405450 (no previous merge yet)
[S16] round=8 local utility u=0.036100 metrics={'f1_val': 0.38633886091975567, 'auprc': 0.7451401695499212, 'loss_val': 0.7886988485130069, 'psi': 0.5298593843718219}-{'f1_val': 0.3842267162592107, 'auprc': 0.7438755870448641, 'loss_val': 0.8444312969274256, 'psi': 0.5280862645734721}
[S17] START round=8 head_norm_before_train=0.906962 cos_to_last_merge=0.9948 (last merge round=6)
[S17] round=8 local utility u=0.126509 metrics={'f1_val': 0.39210535432998117, 'auprc': 0.5445982081082006, 'loss_val': 0.9477098793615274, 'psi': 0.45310249584126894}-{'f1_val': 0.391623575712542, 'auprc': 0.5221453099919695, 'loss_val': 1.1304782880388204, 'psi': 0.44383226942431303}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:61012
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:61009
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1800) from S3
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.409238)
[S11] loaded HEAD from S3 (vec_in norm=1.409238)
[S11] cosine check vs S3: cos=0.2571
[S11] BUFFERED delta from S3 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1801) from S4
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.509446)
[S8] loaded HEAD from S4 (vec_in norm=1.509446)
[S8] cosine check vs S4: cos=-0.0282
[S8] DROPPED delta from S4 (cos=-0.0282 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:61017
[S7] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1804 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1804) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.441055)
[S17] loaded HEAD from S6 (vec_in norm=1.441055)
[S17] cosine check vs S6: cos=-0.0258
[S17] DROPPED delta from S6 (cos=-0.0258 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1797) from S7
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.233413)
[S17] loaded HEAD from S7 (vec_in norm=1.233413)
[S17] cosine check vs S7: cos=-0.0297
[S17] DROPPED delta from S7 (cos=-0.0297 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:61017
[S9] sending update (kind=head size=1792 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1792) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.022963)
[S17] loaded HEAD from S9 (vec_in norm=1.022963)
[S17] cosine check vs S9: cos=0.8537
[S17] BUFFERED delta from S9 (total buffered=1)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:61012
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:61014
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:61008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:61010
[S5] sending update (kind=head size=1802 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1802) from S5
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.274200)
[S11] loaded HEAD from S5 (vec_in norm=1.274200)
[S11] cosine check vs S5: cos=0.9048
[S11] BUFFERED delta from S5 (total buffered=2)
[S16] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1801) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.188684)
[S14] loaded HEAD from S10 (vec_in norm=1.188684)
[S14] cosine check vs S10: cos=0.9700
[S14] BUFFERED delta from S10 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1801) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.445406)
[S7] loaded HEAD from S16 (vec_in norm=1.445406)
[S7] cosine check vs S16: cos=-0.0850
[S7] DROPPED delta from S16 (cos=-0.0850 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1798) from S15
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.781314)
[S9] loaded HEAD from S15 (vec_in norm=0.781314)
[S9] cosine check vs S15: cos=0.8576
[S9] BUFFERED delta from S15 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1794) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.084925)
[S8] loaded HEAD from S14 (vec_in norm=1.084925)
[S8] cosine check vs S14: cos=-0.0957
[S8] DROPPED delta from S14 (cos=-0.0957 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:61013
[S17] sending update (kind=head size=1799 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1799) from S17
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.945030)
[S13] loaded HEAD from S17 (vec_in norm=0.945030)
[S13] cosine check vs S17: cos=-0.0359
[S13] DROPPED delta from S17 (cos=-0.0359 < 0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=8 metric=0.7015 head_norm=1.022963
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.674418e-01
[S9] stored merged vector for next round verification (round=8)
[S9] DEBUG after merge:  round=8 metric=0.7015 head_norm=0.870016 delta_norm=0.267442
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=8 metric=0.3966 head_norm=0.930275
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.788599e-01
[S11] stored merged vector for next round verification (round=8)
[S11] DEBUG after merge:  round=8 metric=0.6339 head_norm=0.884624 delta_norm=0.278860
[S11] aggregate: ACCEPT kept=['S3', 'S5'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=8 metric=0.3171 head_norm=1.084925
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.483404e-01
[S14] stored merged vector for next round verification (round=8)
[S14] DEBUG after merge:  round=8 metric=0.6090 head_norm=1.128278 delta_norm=0.148340
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=8 metric=0.3921 head_norm=0.945030
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.687314e-01
[S17] stored merged vector for next round verification (round=8)
[S17] DEBUG after merge:  round=8 metric=0.3917 head_norm=0.947392 delta_norm=0.268731
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.498286 (no previous merge yet)
[S2] round=9 local utility u=0.237271 metrics={'f1_val': 0.7013774756763025, 'auprc': 0.7767492155108511, 'loss_val': 0.5421196988678153, 'psi': 0.731526171610122}-{'f1_val': 0.7011095150154492, 'auprc': 0.6457031908974412, 'loss_val': 0.6219166167719561, 'psi': 0.6789469853682459}
[S3] START round=9 head_norm_before_train=1.409238 cos_to_last_merge=0.8719 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.872
[S3] round=9 local utility u=0.000000 metrics={'f1_val': 0.6527093809010028, 'auprc': 0.960605573450412, 'loss_val': 0.39864497021223083, 'psi': 0.7758678579207665}-{'f1_val': 0.7000757262075916, 'auprc': 0.8631121644872706, 'loss_val': 0.33834254794740837, 'psi': 0.7652903015194632}
[S4] START round=9 head_norm_before_train=1.509446 (no previous merge yet)
[S4] round=9 local utility u=0.100993 metrics={'f1_val': 0.6865380358753207, 'auprc': 0.6666456271068301, 'loss_val': 0.5161687703196226, 'psi': 0.6785810723679244}-{'f1_val': 0.6626539013690789, 'auprc': 0.6633605425119343, 'loss_val': 0.5649941247344495, 'psi': 0.662936557826221}
[S5] START round=9 head_norm_before_train=1.274200 cos_to_last_merge=0.8823 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.882
[S5] round=9 local utility u=0.005622 metrics={'f1_val': 0.7005685100046517, 'auprc': 0.7909691768358946, 'loss_val': 0.41502036814994653, 'psi': 0.7367287767371489}-{'f1_val': 0.7143347548915031, 'auprc': 0.7917684481092088, 'loss_val': 0.5112591198653696, 'psi': 0.7453082321785853}
[S6] START round=9 head_norm_before_train=1.441055 (no previous merge yet)
[S6] round=9 local utility u=0.158719 metrics={'f1_val': 0.4156481186360783, 'auprc': 0.916076364468519, 'loss_val': 0.5863270579306006, 'psi': 0.6158194169690546}-{'f1_val': 0.41584976944180807, 'auprc': 0.8444618506364876, 'loss_val': 0.6901311151288483, 'psi': 0.5872946019196799}
[S7] START round=9 head_norm_before_train=1.233413 cos_to_last_merge=0.9921 (last merge round=7)
[S7] round=9 local utility u=0.018301 metrics={'f1_val': 0.6838355377501351, 'auprc': 0.7806854529213071, 'loss_val': 0.7256752880773246, 'psi': 0.7225755038186039}-{'f1_val': 0.7024991845590718, 'auprc': 0.7786912824148924, 'loss_val': 0.8682766441747799, 'psi': 0.7329760237014}
[S8] START round=9 head_norm_before_train=0.801019 cos_to_last_merge=0.9944 (last merge round=7)
[S8] round=9 local utility u=0.055016 metrics={'f1_val': 0.37306606018310795, 'auprc': 0.773816767974195, 'loss_val': 0.9194549065600557, 'psi': 0.5333663432995428}-{'f1_val': 0.3726652774371328, 'auprc': 0.7767720249104715, 'loss_val': 1.0359471154723923, 'psi': 0.5343079764264682}
[S9] START round=9 head_norm_before_train=0.870016 cos_to_last_merge=1.0000 (last merge round=8)
[S9] round=9 local utility u=0.028219 metrics={'f1_val': 0.7014667606303384, 'auprc': 0.9980165484048341, 'loss_val': 0.29710652887544037, 'psi': 0.8200866757401367}-{'f1_val': 0.7014667606303384, 'auprc': 0.9973011183953607, 'loss_val': 0.35139856885467974, 'psi': 0.8198005037363474}
[S10] START round=9 head_norm_before_train=1.188684 cos_to_last_merge=0.9325 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.932
[S10] round=9 local utility u=1.000000 metrics={'f1_val': 0.6955198660264592, 'auprc': 0.9886388097585458, 'loss_val': 0.617546646973993, 'psi': 0.8127674435192938}-{'f1_val': 0.3888096612241605, 'auprc': 0.9382101975721617, 'loss_val': 0.6987369754474618, 'psi': 0.6085698757633611}
[S11] START round=9 head_norm_before_train=0.884624 cos_to_last_merge=1.0000 (last merge round=8)
[S11] round=9 local utility u=0.685079 metrics={'f1_val': 0.5604080386113577, 'auprc': 0.872995715472816, 'loss_val': 0.8444604767214499, 'psi': 0.685443109355941}-{'f1_val': 0.396639232794319, 'auprc': 0.77775796504533, 'loss_val': 0.946292939387732, 'psi': 0.5490867256947234}
[S13] START round=9 head_norm_before_train=1.390581 (no previous merge yet)
[S13] round=9 local utility u=0.899408 metrics={'f1_val': 0.6866376985515106, 'auprc': 0.7120720822950293, 'loss_val': 0.7129476688011798, 'psi': 0.696811452048918}-{'f1_val': 0.4160038662657951, 'auprc': 0.6832189562094607, 'loss_val': 0.8014015894854462, 'psi': 0.5228899022432614}
[S14] START round=9 head_norm_before_train=1.128278 cos_to_last_merge=1.0000 (last merge round=8)
[S14] round=9 local utility u=0.985315 metrics={'f1_val': 0.620107057335142, 'auprc': 0.9956410368039098, 'loss_val': 0.6836204898059817, 'psi': 0.7703206491226491}-{'f1_val': 0.3170964199096267, 'auprc': 0.9974343638725809, 'loss_val': 0.8415670309647009, 'psi': 0.5892315974948084}
[S15] START round=9 head_norm_before_train=0.781314 cos_to_last_merge=0.9944 (last merge round=7)
[S15] round=9 local utility u=0.015532 metrics={'f1_val': 0.38381574747486924, 'auprc': 0.82249373059001, 'loss_val': 0.8561030756152215, 'psi': 0.5592869407209256}-{'f1_val': 0.4169508412658852, 'auprc': 0.7997845811701126, 'loss_val': 1.017850260305455, 'psi': 0.5700843372275761}
[S16] START round=9 head_norm_before_train=1.445406 (no previous merge yet)
[S16] round=9 local utility u=0.177893 metrics={'f1_val': 0.43642420277527305, 'auprc': 0.7451785224749787, 'loss_val': 0.7335405159638329, 'psi': 0.5599259306551554}-{'f1_val': 0.38633886091975567, 'auprc': 0.7451401695499212, 'loss_val': 0.7886988485130069, 'psi': 0.5298593843718219}
[S17] START round=9 head_norm_before_train=0.947392 cos_to_last_merge=1.0000 (last merge round=8)
[S17] round=9 local utility u=0.103348 metrics={'f1_val': 0.3894219090729444, 'auprc': 0.6097528456732897, 'loss_val': 0.9203762405021855, 'psi': 0.4775542837130825}-{'f1_val': 0.39210535432998117, 'auprc': 0.5445982081082006, 'loss_val': 0.9477098793615274, 'psi': 0.45310249584126894}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:61008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:61008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S15] → sending delta(kind=head bytes=1789) to S9@127.0.0.1:61010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:61014
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:61015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:61012
[S11] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1789 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1793 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1799) from S5
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.324714)
[S11] loaded HEAD from S5 (vec_in norm=1.324714)
[S11] cosine check vs S5: cos=0.7878
[S11] BUFFERED delta from S5 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1798) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.160658)
[S8] loaded HEAD from S14 (vec_in norm=1.160658)
[S8] cosine check vs S14: cos=-0.1066
[S8] DROPPED delta from S14 (cos=-0.1066 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1797) from S2
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.545179)
[S8] loaded HEAD from S2 (vec_in norm=1.545179)
[S8] cosine check vs S2: cos=0.8003
[S8] BUFFERED delta from S2 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1801) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.479714)
[S17] loaded HEAD from S6 (vec_in norm=1.479714)
[S17] cosine check vs S6: cos=-0.0091
[S17] DROPPED delta from S6 (cos=-0.0091 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1801) from S4
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.562593)
[S8] loaded HEAD from S4 (vec_in norm=1.562593)
[S8] cosine check vs S4: cos=-0.0266
[S8] DROPPED delta from S4 (cos=-0.0266 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1794) from S7
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.279959)
[S17] loaded HEAD from S7 (vec_in norm=1.279959)
[S17] cosine check vs S7: cos=-0.0121
[S17] DROPPED delta from S7 (cos=-0.0121 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1797) from S11
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.921984)
[S8] loaded HEAD from S11 (vec_in norm=0.921984)
[S8] cosine check vs S11: cos=0.4287
[S8] BUFFERED delta from S11 (total buffered=2)
[S17] RECEIVED delta(kind=head bytes=1795) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.975228)
[S17] loaded HEAD from S9 (vec_in norm=0.975228)
[S17] cosine check vs S9: cos=0.9140
[S17] BUFFERED delta from S9 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1793) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.845758)
[S15] loaded HEAD from S8 (vec_in norm=0.845758)
[S15] cosine check vs S8: cos=0.8059
[S15] BUFFERED delta from S8 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1797) from S13
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.429104)
[S7] loaded HEAD from S13 (vec_in norm=1.429104)
[S7] cosine check vs S13: cos=0.9128
[S7] BUFFERED delta from S13 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1789) from S15
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.835406)
[S9] loaded HEAD from S15 (vec_in norm=0.835406)
[S9] cosine check vs S15: cos=0.9246
[S9] BUFFERED delta from S15 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1803) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.234125)
[S14] loaded HEAD from S10 (vec_in norm=1.234125)
[S14] cosine check vs S10: cos=0.9783
[S14] BUFFERED delta from S10 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1799) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.485287)
[S7] loaded HEAD from S16 (vec_in norm=1.485287)
[S7] cosine check vs S16: cos=-0.0824
[S7] DROPPED delta from S16 (cos=-0.0824 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:61013
[S17] sending update (kind=head size=1795 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1795) from S17
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.983499)
[S13] loaded HEAD from S17 (vec_in norm=0.983499)
[S13] cosine check vs S17: cos=-0.0260
[S13] DROPPED delta from S17 (cos=-0.0260 < 0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=9 metric=0.7015 head_norm=0.975228
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.886806e-01
[S9] stored merged vector for next round verification (round=9)
[S9] DEBUG after merge:  round=9 metric=0.7201 head_norm=0.888192 delta_norm=0.188681
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=9 metric=0.3838 head_norm=0.835406
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.618938e-01
[S15] stored merged vector for next round verification (round=9)
[S15] DEBUG after merge:  round=9 metric=0.3838 head_norm=0.798759 delta_norm=0.261894
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=9 metric=0.3731 head_norm=0.845758
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.838483e-01
[S8] stored merged vector for next round verification (round=9)
[S8] DEBUG after merge:  round=9 metric=0.3731 head_norm=0.850812 delta_norm=0.183848
[S8] aggregate: ACCEPT kept=['S2', 'S11'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=9 metric=0.5604 head_norm=0.921984
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.125073e-01
[S11] stored merged vector for next round verification (round=9)
[S11] DEBUG after merge:  round=9 metric=0.5955 head_norm=1.064095 delta_norm=0.412507
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=9 metric=0.6838 head_norm=1.279959
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.921589e-01
[S7] stored merged vector for next round verification (round=9)
[S7] DEBUG after merge:  round=9 metric=0.7141 head_norm=1.324749 delta_norm=0.292159
[S7] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=9 metric=0.6201 head_norm=1.160658
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.298580e-01
[S14] stored merged vector for next round verification (round=9)
[S14] DEBUG after merge:  round=9 metric=0.6203 head_norm=1.190896 delta_norm=0.129858
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=9 metric=0.3894 head_norm=0.983499
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.031427e-01
[S17] stored merged vector for next round verification (round=9)
[S17] DEBUG after merge:  round=9 metric=0.3677 head_norm=0.958073 delta_norm=0.203143
[S17] aggregate: ROLLBACK (f1_val pre=0.389 post=0.368 tol_abs=0.005 tol_rel=0.0)
[S2] START round=10 head_norm_before_train=1.545179 (no previous merge yet)
[S2] round=10 local utility u=0.054694 metrics={'f1_val': 0.7007729058908991, 'auprc': 0.7711532586965637, 'loss_val': 0.4123156526842396, 'psi': 0.728925047013165}-{'f1_val': 0.7013774756763025, 'auprc': 0.7767492155108511, 'loss_val': 0.5421196988678153, 'psi': 0.731526171610122}
[S3] START round=10 head_norm_before_train=1.449577 cos_to_last_merge=0.8632 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.863
[S3] round=10 local utility u=0.198256 metrics={'f1_val': 0.6947844743292331, 'auprc': 0.9821590079810254, 'loss_val': 0.31924471260823983, 'psi': 0.80973428778995}-{'f1_val': 0.6527093809010028, 'auprc': 0.960605573450412, 'loss_val': 0.39864497021223083, 'psi': 0.7758678579207665}
[S4] START round=10 head_norm_before_train=1.562593 (no previous merge yet)
[S4] round=10 local utility u=0.003079 metrics={'f1_val': 0.678157363377663, 'auprc': 0.6593050421869713, 'loss_val': 0.43770406169217413, 'psi': 0.6706164349013863}-{'f1_val': 0.6865380358753207, 'auprc': 0.6666456271068301, 'loss_val': 0.5161687703196226, 'psi': 0.6785810723679244}
[S5] START round=10 head_norm_before_train=1.324714 cos_to_last_merge=0.8706 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.871
[S5] round=10 local utility u=0.032753 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.7936431581095902, 'loss_val': 0.357776340288868, 'psi': 0.7378222988414407}-{'f1_val': 0.7005685100046517, 'auprc': 0.7909691768358946, 'loss_val': 0.41502036814994653, 'psi': 0.7367287767371489}
[S6] START round=10 head_norm_before_train=1.479714 (no previous merge yet)
[S6] round=10 local utility u=0.044558 metrics={'f1_val': 0.41596572403532517, 'auprc': 0.9514526106830878, 'loss_val': 0.605245352883284, 'psi': 0.6301604786944303}-{'f1_val': 0.4156481186360783, 'auprc': 0.916076364468519, 'loss_val': 0.5863270579306006, 'psi': 0.6158194169690546}
[S7] START round=10 head_norm_before_train=1.324749 cos_to_last_merge=1.0000 (last merge round=9)
[S7] round=10 local utility u=0.002709 metrics={'f1_val': 0.6750460365854536, 'auprc': 0.7822245855671618, 'loss_val': 0.6721367719531925, 'psi': 0.7179174561781368}-{'f1_val': 0.6838355377501351, 'auprc': 0.7806854529213071, 'loss_val': 0.7256752880773246, 'psi': 0.7225755038186039}
[S8] START round=10 head_norm_before_train=0.850812 cos_to_last_merge=1.0000 (last merge round=9)
[S8] round=10 local utility u=0.338786 metrics={'f1_val': 0.3729322731464855, 'auprc': 0.9815954872729826, 'loss_val': 0.864416376094436, 'psi': 0.6163975587970844}-{'f1_val': 0.37306606018310795, 'auprc': 0.773816767974195, 'loss_val': 0.9194549065600557, 'psi': 0.5333663432995428}
[S9] START round=10 head_norm_before_train=0.888192 cos_to_last_merge=1.0000 (last merge round=9)
[S9] round=10 local utility u=0.839964 metrics={'f1_val': 0.9747759656199361, 'auprc': 0.998282732561203, 'loss_val': 0.2578319627438279, 'psi': 0.9841786723964429}-{'f1_val': 0.7014667606303384, 'auprc': 0.9980165484048341, 'loss_val': 0.29710652887544037, 'psi': 0.8200866757401367}
[S10] START round=10 head_norm_before_train=1.234125 cos_to_last_merge=0.9197 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.920
[S10] round=10 local utility u=0.078576 metrics={'f1_val': 0.701696512414446, 'auprc': 0.9952901558529532, 'loss_val': 0.5174081858860695, 'psi': 0.8191339697898489}-{'f1_val': 0.6955198660264592, 'auprc': 0.9886388097585458, 'loss_val': 0.617546646973993, 'psi': 0.8127674435192938}
[S11] START round=10 head_norm_before_train=1.064095 cos_to_last_merge=1.0000 (last merge round=9)
[S11] round=10 local utility u=0.480343 metrics={'f1_val': 0.7020664967782734, 'auprc': 0.8774580977802083, 'loss_val': 0.7471116549161738, 'psi': 0.7722231371790473}-{'f1_val': 0.5604080386113577, 'auprc': 0.872995715472816, 'loss_val': 0.8444604767214499, 'psi': 0.685443109355941}
[S13] START round=10 head_norm_before_train=1.429104 (no previous merge yet)
[S13] round=10 local utility u=0.000000 metrics={'f1_val': 0.5977108521309067, 'auprc': 0.7218094053370122, 'loss_val': 0.6611369123641044, 'psi': 0.6473502734133489}-{'f1_val': 0.6866376985515106, 'auprc': 0.7120720822950293, 'loss_val': 0.7129476688011798, 'psi': 0.696811452048918}
[S14] START round=10 head_norm_before_train=1.190896 cos_to_last_merge=1.0000 (last merge round=9)
[S14] round=10 local utility u=1.000000 metrics={'f1_val': 0.9850374056582714, 'auprc': 0.9970932331617788, 'loss_val': 0.542695553665237, 'psi': 0.9898597366596743}-{'f1_val': 0.620107057335142, 'auprc': 0.9956410368039098, 'loss_val': 0.6836204898059817, 'psi': 0.7703206491226491}
[S15] START round=10 head_norm_before_train=0.798759 cos_to_last_merge=1.0000 (last merge round=9)
[S15] round=10 local utility u=0.000000 metrics={'f1_val': 0.4223006629620192, 'auprc': 0.6870296713644313, 'loss_val': 0.8174237721503771, 'psi': 0.528192266322984}-{'f1_val': 0.38381574747486924, 'auprc': 0.82249373059001, 'loss_val': 0.8561030756152215, 'psi': 0.5592869407209256}
[S16] START round=10 head_norm_before_train=1.485287 (no previous merge yet)
[S16] round=10 local utility u=0.254568 metrics={'f1_val': 0.5153283459125444, 'auprc': 0.7614542948641763, 'loss_val': 0.7466573819314672, 'psi': 0.6137787254931971}-{'f1_val': 0.43642420277527305, 'auprc': 0.7451785224749787, 'loss_val': 0.7335405159638329, 'psi': 0.5599259306551554}
[S17] START round=10 head_norm_before_train=0.958073 cos_to_last_merge=1.0000 (last merge round=9)
[S17] round=10 local utility u=0.000000 metrics={'f1_val': 0.356848273436156, 'auprc': 0.4908780063799405, 'loss_val': 0.9336491391228603, 'psi': 0.4104601666136698}-{'f1_val': 0.3894219090729444, 'auprc': 0.6097528456732897, 'loss_val': 0.9203762405021855, 'psi': 0.4775542837130825}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S8] → sending delta(kind=head bytes=1788) to S15@127.0.0.1:61015
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:61012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:61014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:61012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:61017
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] → sending delta(kind=head bytes=1805) to S7@127.0.0.1:61008
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1788 to 1 peers)
[S16] sending update (kind=head size=1805 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1797) from S2
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.592897)
[S8] loaded HEAD from S2 (vec_in norm=1.592897)
[S8] cosine check vs S2: cos=0.8362
[S8] BUFFERED delta from S2 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1797) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.228125)
[S8] loaded HEAD from S14 (vec_in norm=1.228125)
[S8] cosine check vs S14: cos=-0.1113
[S8] DROPPED delta from S14 (cos=-0.1113 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1796) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.987921)
[S17] loaded HEAD from S9 (vec_in norm=0.987921)
[S17] cosine check vs S9: cos=0.9391
[S17] BUFFERED delta from S9 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1799) from S11
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.102061)
[S8] loaded HEAD from S11 (vec_in norm=1.102061)
[S8] cosine check vs S11: cos=0.4119
[S8] BUFFERED delta from S11 (total buffered=2)
[S14] RECEIVED delta(kind=head bytes=1801) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.278337)
[S14] loaded HEAD from S10 (vec_in norm=1.278337)
[S14] cosine check vs S10: cos=0.9834
[S14] BUFFERED delta from S10 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1798) from S7
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.364620)
[S17] loaded HEAD from S7 (vec_in norm=1.364620)
[S17] cosine check vs S7: cos=-0.0042
[S17] DROPPED delta from S7 (cos=-0.0042 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1802) from S5
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.366278)
[S11] loaded HEAD from S5 (vec_in norm=1.366278)
[S11] cosine check vs S5: cos=0.9430
[S11] BUFFERED delta from S5 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1801) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.516975)
[S17] loaded HEAD from S6 (vec_in norm=1.516975)
[S17] cosine check vs S6: cos=-0.0052
[S17] DROPPED delta from S6 (cos=-0.0052 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1805) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.523083)
[S7] loaded HEAD from S16 (vec_in norm=1.523083)
[S7] cosine check vs S16: cos=-0.0752
[S7] DROPPED delta from S16 (cos=-0.0752 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1801) from S4
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.611511)
[S8] loaded HEAD from S4 (vec_in norm=1.611511)
[S8] cosine check vs S4: cos=-0.0188
[S8] DROPPED delta from S4 (cos=-0.0188 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1788) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.893040)
[S15] loaded HEAD from S8 (vec_in norm=0.893040)
[S15] cosine check vs S8: cos=0.8897
[S15] BUFFERED delta from S8 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1799) from S3
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.480287)
[S11] loaded HEAD from S3 (vec_in norm=1.480287)
[S11] cosine check vs S3: cos=0.1892
[S11] BUFFERED delta from S3 (total buffered=2)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] ⇄ pheromone p=0.380 → S7@127.0.0.1:61008
[S6] ⇄ pheromone p=0.248 → S17@127.0.0.1:61017
[S10] ⇄ pheromone p=0.410 → S14@127.0.0.1:61014
[S4] ⇄ pheromone p=0.321 → S8@127.0.0.1:61009
[S2] ⇄ pheromone p=0.308 → S8@127.0.0.1:61009
[S9] ⇄ pheromone p=0.376 → S17@127.0.0.1:61017
[S16] ⇄ pheromone p=0.288 → S7@127.0.0.1:61008
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=10 metric=0.3729 head_norm=0.893040
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.828386e-01
[S8] stored merged vector for next round verification (round=10)
[S8] DEBUG after merge:  round=10 metric=0.3729 head_norm=0.911510 delta_norm=0.182839
[S8] aggregate: ACCEPT kept=['S2', 'S11'] (k=2/2) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.283 → S15@127.0.0.1:61015
[S5] ⇄ pheromone p=0.275 → S11@127.0.0.1:61012
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=10 metric=0.9850 head_norm=1.228125
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.167818e-01
[S14] stored merged vector for next round verification (round=10)
[S14] DEBUG after merge:  round=10 metric=0.6201 head_norm=1.248031 delta_norm=0.116782
[S14] aggregate: ROLLBACK (f1_val pre=0.985 post=0.620 tol_abs=0.005 tol_rel=0.0)
[S14] ⇄ pheromone p=0.591 → S8@127.0.0.1:61009
[S3] ⇄ pheromone p=0.308 → S11@127.0.0.1:61012
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=10 metric=0.7021 head_norm=1.102061
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.320063e-01
[S11] stored merged vector for next round verification (round=10)
[S11] DEBUG after merge:  round=10 metric=0.7021 head_norm=0.987157 delta_norm=0.332006
[S11] aggregate: ACCEPT kept=['S5', 'S3'] (k=2/2) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.414 → S8@127.0.0.1:61009
[S7] ⇄ pheromone p=0.279 → S17@127.0.0.1:61017
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=10 metric=0.4223 head_norm=0.849547
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.056905e-01
[S15] stored merged vector for next round verification (round=10)
[S15] DEBUG after merge:  round=10 metric=0.4235 head_norm=0.846946 delta_norm=0.205691
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.213 → S9@127.0.0.1:61010
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=10 metric=0.3568 head_norm=0.994094
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.729390e-01
[S17] stored merged vector for next round verification (round=10)
[S17] DEBUG after merge:  round=10 metric=0.3567 head_norm=0.975806 delta_norm=0.172939
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.213 → S13@127.0.0.1:61013
[S2] START round=11 head_norm_before_train=1.592897 (no previous merge yet)
[S2] round=11 local utility u=0.083206 metrics={'f1_val': 0.6923781686009592, 'auprc': 0.8301526870234447, 'loss_val': 0.372533635336993, 'psi': 0.7474879759699534}-{'f1_val': 0.7007729058908991, 'auprc': 0.7711532586965637, 'loss_val': 0.4123156526842396, 'psi': 0.728925047013165}
[S3] START round=11 head_norm_before_train=1.480287 cos_to_last_merge=0.8567 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.857
[S3] round=11 local utility u=0.037988 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9829886228101105, 'loss_val': 0.2815882539958388, 'psi': 0.813649171365224}-{'f1_val': 0.6947844743292331, 'auprc': 0.9821590079810254, 'loss_val': 0.31924471260823983, 'psi': 0.80973428778995}
[S4] START round=11 head_norm_before_train=1.611511 (no previous merge yet)
[S4] round=11 local utility u=0.000000 metrics={'f1_val': 0.6704136498261761, 'auprc': 0.6617336400652364, 'loss_val': 0.48947863351891807, 'psi': 0.6669416459218003}-{'f1_val': 0.678157363377663, 'auprc': 0.6593050421869713, 'loss_val': 0.43770406169217413, 'psi': 0.6706164349013863}
[S5] START round=11 head_norm_before_train=1.366278 cos_to_last_merge=0.8605 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.860
[S5] round=11 local utility u=0.322241 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.991927852750546, 'loss_val': 0.30815202654776236, 'psi': 0.8171365975036868}-{'f1_val': 0.7006083926626743, 'auprc': 0.7936431581095902, 'loss_val': 0.357776340288868, 'psi': 0.7378222988414407}
[S6] START round=11 head_norm_before_train=1.516975 (no previous merge yet)
[S6] round=11 local utility u=0.930757 metrics={'f1_val': 0.6948712744136629, 'auprc': 0.9549593673864085, 'loss_val': 0.4276851840014506, 'psi': 0.7989065116027612}-{'f1_val': 0.41596572403532517, 'auprc': 0.9514526106830878, 'loss_val': 0.605245352883284, 'psi': 0.6301604786944303}
[S7] START round=11 head_norm_before_train=1.364620 cos_to_last_merge=0.9972 (last merge round=9)
[S7] round=11 local utility u=0.000000 metrics={'f1_val': 0.664517784615719, 'auprc': 0.7828310164755912, 'loss_val': 0.6491744535941434, 'psi': 0.7118430773596679}-{'f1_val': 0.6750460365854536, 'auprc': 0.7822245855671618, 'loss_val': 0.6721367719531925, 'psi': 0.7179174561781368}
[S8] START round=11 head_norm_before_train=0.911510 cos_to_last_merge=1.0000 (last merge round=10)
[S8] round=11 local utility u=0.055774 metrics={'f1_val': 0.3728649953480749, 'auprc': 0.9924029868087714, 'loss_val': 0.7848873562778772, 'psi': 0.6206801919323535}-{'f1_val': 0.3729322731464855, 'auprc': 0.9815954872729826, 'loss_val': 0.864416376094436, 'psi': 0.6163975587970844}
[S9] START round=11 head_norm_before_train=0.987921 cos_to_last_merge=0.9921 (last merge round=9)
[S9] round=11 local utility u=0.089274 metrics={'f1_val': 0.988279001546821, 'auprc': 0.998392338522839, 'loss_val': 0.16063185288771314, 'psi': 0.9923243363372283}-{'f1_val': 0.9747759656199361, 'auprc': 0.998282732561203, 'loss_val': 0.2578319627438279, 'psi': 0.9841786723964429}
[S10] START round=11 head_norm_before_train=1.278337 cos_to_last_merge=0.9082 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.908
[S10] round=11 local utility u=0.058486 metrics={'f1_val': 0.7004721626846612, 'auprc': 0.9979946099137664, 'loss_val': 0.4012039757932642, 'psi': 0.8194811415763033}-{'f1_val': 0.701696512414446, 'auprc': 0.9952901558529532, 'loss_val': 0.5174081858860695, 'psi': 0.8191339697898489}
[S11] START round=11 head_norm_before_train=0.987157 cos_to_last_merge=1.0000 (last merge round=10)
[S11] round=11 local utility u=0.054260 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.8923772068833993, 'loss_val': 0.6811101978744066, 'psi': 0.7779669705055146}-{'f1_val': 0.7020664967782734, 'auprc': 0.8774580977802083, 'loss_val': 0.7471116549161738, 'psi': 0.7722231371790473}
[S13] START round=11 head_norm_before_train=1.464866 (no previous merge yet)
[S13] round=11 local utility u=0.125653 metrics={'f1_val': 0.6564288133043463, 'auprc': 0.6599684332825566, 'loss_val': 0.5766164021682689, 'psi': 0.6578446612956304}-{'f1_val': 0.5977108521309067, 'auprc': 0.7218094053370122, 'loss_val': 0.6611369123641044, 'psi': 0.6473502734133489}
[S14] START round=11 head_norm_before_train=1.248031 cos_to_last_merge=1.0000 (last merge round=10)
[S14] round=11 local utility u=0.085130 metrics={'f1_val': 0.9973089746199164, 'auprc': 0.997146862912909, 'loss_val': 0.4462266406881405, 'psi': 0.9972441299371134}-{'f1_val': 0.9850374056582714, 'auprc': 0.9970932331617788, 'loss_val': 0.542695553665237, 'psi': 0.9898597366596743}
[S15] START round=11 head_norm_before_train=0.846946 cos_to_last_merge=1.0000 (last merge round=10)
[S15] round=11 local utility u=1.000000 metrics={'f1_val': 0.6993123644688358, 'auprc': 0.9302932015401576, 'loss_val': 0.7273328377213447, 'psi': 0.7917046992973646}-{'f1_val': 0.4223006629620192, 'auprc': 0.6870296713644313, 'loss_val': 0.8174237721503771, 'psi': 0.528192266322984}
[S16] START round=11 head_norm_before_train=1.523083 (no previous merge yet)
[S16] round=11 local utility u=0.000000 metrics={'f1_val': 0.4042152573483602, 'auprc': 0.7462094659808266, 'loss_val': 0.7208374404459268, 'psi': 0.5410129408013468}-{'f1_val': 0.5153283459125444, 'auprc': 0.7614542948641763, 'loss_val': 0.7466573819314672, 'psi': 0.6137787254931971}
[S17] START round=11 head_norm_before_train=0.975806 cos_to_last_merge=1.0000 (last merge round=10)
[S17] round=11 local utility u=0.000000 metrics={'f1_val': 0.353098839916504, 'auprc': 0.4681721944726158, 'loss_val': 0.9585650053668905, 'psi': 0.3991281817389487}-{'f1_val': 0.356848273436156, 'auprc': 0.4908780063799405, 'loss_val': 0.9336491391228603, 'psi': 0.4104601666136698}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S11@127.0.0.1:61012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:61009
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:61015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:61012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:61017
[S6] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1801) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.548976)
[S17] loaded HEAD from S6 (vec_in norm=1.548976)
[S17] cosine check vs S6: cos=-0.0012
[S17] DROPPED delta from S6 (cos=-0.0012 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1802) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.086079)
[S17] loaded HEAD from S9 (vec_in norm=1.086079)
[S17] cosine check vs S9: cos=0.9654
[S17] BUFFERED delta from S9 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1803) from S3
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.513973)
[S11] loaded HEAD from S3 (vec_in norm=1.513973)
[S11] cosine check vs S3: cos=0.4539
[S11] BUFFERED delta from S3 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1802) from S2
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.636987)
[S8] loaded HEAD from S2 (vec_in norm=1.636987)
[S8] cosine check vs S2: cos=0.8368
[S8] BUFFERED delta from S2 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1795) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.959332)
[S15] loaded HEAD from S8 (vec_in norm=0.959332)
[S15] cosine check vs S8: cos=0.9172
[S15] BUFFERED delta from S8 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1800) from S5
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.405134)
[S11] loaded HEAD from S5 (vec_in norm=1.405134)
[S11] cosine check vs S5: cos=0.8329
[S11] BUFFERED delta from S5 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:61008
[S13] sending update (kind=head size=1801 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1801) from S13
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.495391)
[S7] loaded HEAD from S13 (vec_in norm=1.495391)
[S7] cosine check vs S13: cos=0.9467
[S7] BUFFERED delta from S13 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S15] → sending delta(kind=head bytes=1791) to S9@127.0.0.1:61010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:61014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:61009
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1791 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1791) from S15
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.899328)
[S9] loaded HEAD from S15 (vec_in norm=0.899328)
[S9] cosine check vs S15: cos=0.7944
[S9] BUFFERED delta from S15 (total buffered=1)
[S10] sending update (kind=head size=1805 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1805) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.329521)
[S14] loaded HEAD from S10 (vec_in norm=1.329521)
[S14] cosine check vs S10: cos=0.9876
[S14] BUFFERED delta from S10 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1798) from S11
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.029310)
[S8] loaded HEAD from S11 (vec_in norm=1.029310)
[S8] cosine check vs S11: cos=0.4812
[S8] BUFFERED delta from S11 (total buffered=2)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1798 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.285538)
[S8] loaded HEAD from S14 (vec_in norm=1.285538)
[S8] cosine check vs S14: cos=-0.1224
[S8] DROPPED delta from S14 (cos=-0.1224 < 0.0)
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=11 metric=0.7017 head_norm=1.029310
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.924659e-01
[S11] stored merged vector for next round verification (round=11)
[S11] DEBUG after merge:  round=11 metric=0.7018 head_norm=0.996511 delta_norm=0.192466
[S11] aggregate: ACCEPT kept=['S3', 'S5'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=11 metric=0.6645 head_norm=1.405137
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.409322e-01
[S7] stored merged vector for next round verification (round=11)
[S7] DEBUG after merge:  round=11 metric=0.6538 head_norm=1.430823 delta_norm=0.240932
[S7] aggregate: ROLLBACK (f1_val pre=0.665 post=0.654 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=11 metric=0.3729 head_norm=0.959332
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.127881e-01
[S8] stored merged vector for next round verification (round=11)
[S8] DEBUG after merge:  round=11 metric=0.3729 head_norm=0.952579 delta_norm=0.112788
[S8] aggregate: ACCEPT kept=['S2', 'S11'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=11 metric=0.9883 head_norm=1.086079
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.303370e-01
[S9] stored merged vector for next round verification (round=11)
[S9] DEBUG after merge:  round=11 metric=0.9891 head_norm=0.940774 delta_norm=0.330337
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=11 metric=0.6993 head_norm=0.899328
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.913126e-01
[S15] stored merged vector for next round verification (round=11)
[S15] DEBUG after merge:  round=11 metric=0.6810 head_norm=0.909920 delta_norm=0.191313
[S15] aggregate: ROLLBACK (f1_val pre=0.699 post=0.681 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=11 metric=0.3531 head_norm=1.011280
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.427350e-01
[S17] stored merged vector for next round verification (round=11)
[S17] DEBUG after merge:  round=11 metric=0.3531 head_norm=1.039593 delta_norm=0.142735
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=11 metric=0.9973 head_norm=1.285538
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.053766e-01
[S14] stored merged vector for next round verification (round=11)
[S14] DEBUG after merge:  round=11 metric=0.9785 head_norm=1.303462 delta_norm=0.105377
[S14] aggregate: ROLLBACK (f1_val pre=0.997 post=0.979 tol_abs=0.005 tol_rel=0.0)
[S2] START round=12 head_norm_before_train=1.636987 (no previous merge yet)
[S2] round=12 local utility u=0.000000 metrics={'f1_val': 0.6819518293655245, 'auprc': 0.7995148429632215, 'loss_val': 0.3645975242598316, 'psi': 0.7289770348046032}-{'f1_val': 0.6923781686009592, 'auprc': 0.8301526870234447, 'loss_val': 0.372533635336993, 'psi': 0.7474879759699534}
[S3] START round=12 head_norm_before_train=1.513973 cos_to_last_merge=0.8518 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.852
[S3] round=12 local utility u=0.016042 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9919595829104241, 'loss_val': 0.2764169479327062, 'psi': 0.8172375554053495}-{'f1_val': 0.7007562037352997, 'auprc': 0.9829886228101105, 'loss_val': 0.2815882539958388, 'psi': 0.813649171365224}
[S4] START round=12 head_norm_before_train=1.648378 (no previous merge yet)
[S4] round=12 local utility u=0.047838 metrics={'f1_val': 0.6732850862158521, 'auprc': 0.659058633384267, 'loss_val': 0.4030054149708373, 'psi': 0.667594505083218}-{'f1_val': 0.6704136498261761, 'auprc': 0.6617336400652364, 'loss_val': 0.48947863351891807, 'psi': 0.6669416459218003}
[S5] START round=12 head_norm_before_train=1.405134 cos_to_last_merge=0.8511 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.851
[S5] round=12 local utility u=0.007345 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.9922238906879848, 'loss_val': 0.2943497590866201, 'psi': 0.8172550126786624}-{'f1_val': 0.7006090940057808, 'auprc': 0.991927852750546, 'loss_val': 0.30815202654776236, 'psi': 0.8171365975036868}
[S6] START round=12 head_norm_before_train=1.548976 (no previous merge yet)
[S6] round=12 local utility u=0.018074 metrics={'f1_val': 0.706655460923784, 'auprc': 0.9509849725542703, 'loss_val': 0.4503194326139622, 'psi': 0.8043872655759785}-{'f1_val': 0.6948712744136629, 'auprc': 0.9549593673864085, 'loss_val': 0.4276851840014506, 'psi': 0.7989065116027612}
[S7] START round=12 head_norm_before_train=1.430823 cos_to_last_merge=1.0000 (last merge round=11)
[S7] round=12 local utility u=0.006159 metrics={'f1_val': 0.6611827313737583, 'auprc': 0.7970336510756015, 'loss_val': 0.6594534030286661, 'psi': 0.7155230992544956}-{'f1_val': 0.664517784615719, 'auprc': 0.7828310164755912, 'loss_val': 0.6491744535941434, 'psi': 0.7118430773596679}
[S8] START round=12 head_norm_before_train=0.952579 cos_to_last_merge=1.0000 (last merge round=11)
[S8] round=12 local utility u=0.037349 metrics={'f1_val': 0.37266438550987346, 'auprc': 0.9937555844411883, 'loss_val': 0.7130427865300033, 'psi': 0.6211008650823994}-{'f1_val': 0.3728649953480749, 'auprc': 0.9924029868087714, 'loss_val': 0.7848873562778772, 'psi': 0.6206801919323535}
[S9] START round=12 head_norm_before_train=0.940774 cos_to_last_merge=1.0000 (last merge round=11)
[S9] round=12 local utility u=0.000000 metrics={'f1_val': 0.988279001546821, 'auprc': 0.9989316779511628, 'loss_val': 0.17417900174339235, 'psi': 0.9925400721085578}-{'f1_val': 0.988279001546821, 'auprc': 0.998392338522839, 'loss_val': 0.16063185288771314, 'psi': 0.9923243363372283}
[S10] START round=12 head_norm_before_train=1.329521 cos_to_last_merge=0.8967 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.897
[S10] round=12 local utility u=0.032623 metrics={'f1_val': 0.6988987142104666, 'auprc': 0.9980866945408835, 'loss_val': 0.3267934069191026, 'psi': 0.8185739063426334}-{'f1_val': 0.7004721626846612, 'auprc': 0.9979946099137664, 'loss_val': 0.4012039757932642, 'psi': 0.8194811415763033}
[S11] START round=12 head_norm_before_train=0.996511 cos_to_last_merge=1.0000 (last merge round=11)
[S11] round=12 local utility u=0.099857 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9305488403262985, 'loss_val': 0.5973624861942325, 'psi': 0.7933807261095114}-{'f1_val': 0.7016934795869249, 'auprc': 0.8923772068833993, 'loss_val': 0.6811101978744066, 'psi': 0.7779669705055146}
[S13] START round=12 head_norm_before_train=1.495391 (no previous merge yet)
[S13] round=12 local utility u=0.000000 metrics={'f1_val': 0.6173965956654375, 'auprc': 0.6446007156001969, 'loss_val': 0.5558617238476734, 'psi': 0.6282782436393413}-{'f1_val': 0.6564288133043463, 'auprc': 0.6599684332825566, 'loss_val': 0.5766164021682689, 'psi': 0.6578446612956304}
[S14] START round=12 head_norm_before_train=1.303462 cos_to_last_merge=1.0000 (last merge round=11)
[S14] round=12 local utility u=0.049151 metrics={'f1_val': 0.9981280337016785, 'auprc': 0.997156357233009, 'loss_val': 0.35286698080587586, 'psi': 0.9977393631142106}-{'f1_val': 0.9973089746199164, 'auprc': 0.997146862912909, 'loss_val': 0.4462266406881405, 'psi': 0.9972441299371134}
[S15] START round=12 head_norm_before_train=0.909920 cos_to_last_merge=1.0000 (last merge round=11)
[S15] round=12 local utility u=0.123111 metrics={'f1_val': 0.6986079960532545, 'auprc': 0.9747093712812083, 'loss_val': 0.6101327158807991, 'psi': 0.809048546144436}-{'f1_val': 0.6993123644688358, 'auprc': 0.9302932015401576, 'loss_val': 0.7273328377213447, 'psi': 0.7917046992973646}
[S16] START round=12 head_norm_before_train=1.557625 (no previous merge yet)
[S16] round=12 local utility u=0.469256 metrics={'f1_val': 0.5481787987977682, 'auprc': 0.7709581743630093, 'loss_val': 0.7203533801323626, 'psi': 0.6372905490238647}-{'f1_val': 0.4042152573483602, 'auprc': 0.7462094659808266, 'loss_val': 0.7208374404459268, 'psi': 0.5410129408013468}
[S17] START round=12 head_norm_before_train=1.039593 cos_to_last_merge=1.0000 (last merge round=11)
[S17] round=12 local utility u=0.002258 metrics={'f1_val': 0.35472564815320357, 'auprc': 0.4931511764104723, 'loss_val': 1.0387469884861937, 'psi': 0.41009585945611104}-{'f1_val': 0.353098839916504, 'auprc': 0.4681721944726158, 'loss_val': 0.9585650053668905, 'psi': 0.3991281817389487}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:61009
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:61012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:61009
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:61012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:61015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:61014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] → sending delta(kind=head bytes=1792) to S9@127.0.0.1:61010
[S15] sending update (kind=head size=1792 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1805 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1804 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1799) from S3
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.542064)
[S11] loaded HEAD from S3 (vec_in norm=1.542064)
[S11] cosine check vs S3: cos=0.5813
[S11] BUFFERED delta from S3 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1795) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.005301)
[S15] loaded HEAD from S8 (vec_in norm=1.005301)
[S15] cosine check vs S8: cos=0.9512
[S15] BUFFERED delta from S8 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1805) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.576327)
[S17] loaded HEAD from S6 (vec_in norm=1.576327)
[S17] cosine check vs S6: cos=0.0002
[S17] BUFFERED delta from S6 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1792) from S15
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.964650)
[S9] loaded HEAD from S15 (vec_in norm=0.964650)
[S9] cosine check vs S15: cos=0.8664
[S9] BUFFERED delta from S15 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1798) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.382762)
[S14] loaded HEAD from S10 (vec_in norm=1.382762)
[S14] cosine check vs S10: cos=0.9902
[S14] BUFFERED delta from S10 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1801) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.340759)
[S8] loaded HEAD from S14 (vec_in norm=1.340759)
[S8] cosine check vs S14: cos=-0.1245
[S8] DROPPED delta from S14 (cos=-0.1245 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1804) from S11
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.042079)
[S8] loaded HEAD from S11 (vec_in norm=1.042079)
[S8] cosine check vs S11: cos=0.4730
[S8] BUFFERED delta from S11 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1802) from S4
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.672390)
[S8] loaded HEAD from S4 (vec_in norm=1.672390)
[S8] cosine check vs S4: cos=-0.0113
[S8] DROPPED delta from S4 (cos=-0.0113 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1800) from S5
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.432957)
[S11] loaded HEAD from S5 (vec_in norm=1.432957)
[S11] cosine check vs S5: cos=0.7505
[S11] BUFFERED delta from S5 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S16] → sending delta(kind=head bytes=1790) to S7@127.0.0.1:61008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:61013
[S17] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1790 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1801) from S17
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.073426)
[S13] loaded HEAD from S17 (vec_in norm=1.073426)
[S13] cosine check vs S17: cos=0.0071
[S13] BUFFERED delta from S17 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1790) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.591476)
[S7] loaded HEAD from S16 (vec_in norm=1.591476)
[S7] cosine check vs S16: cos=-0.0667
[S7] DROPPED delta from S16 (cos=-0.0667 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:61017
[S7] sending update (kind=head size=1797 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1797) from S7
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.460324)
[S17] loaded HEAD from S7 (vec_in norm=1.460324)
[S17] cosine check vs S7: cos=0.0128
[S17] BUFFERED delta from S7 (total buffered=2)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=12 metric=0.9883 head_norm=1.033574
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.603332e-01
[S9] stored merged vector for next round verification (round=12)
[S9] DEBUG after merge:  round=12 metric=0.9883 head_norm=0.965215 delta_norm=0.260333
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=12 metric=0.7019 head_norm=1.042079
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.327939e-01
[S11] stored merged vector for next round verification (round=12)
[S11] DEBUG after merge:  round=12 metric=0.7019 head_norm=1.022280 delta_norm=0.132794
[S11] aggregate: ACCEPT kept=['S3', 'S5'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=12 metric=0.6174 head_norm=1.521068
[S13] _apply_head_vector_avg (torch): Δ‖w‖=9.277238e-01
[S13] stored merged vector for next round verification (round=12)
[S13] DEBUG after merge:  round=12 metric=0.6384 head_norm=0.933956 delta_norm=0.927724
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=12 metric=0.9981 head_norm=1.340759
[S14] _apply_head_vector_avg (torch): Δ‖w‖=9.736639e-02
[S14] stored merged vector for next round verification (round=12)
[S14] DEBUG after merge:  round=12 metric=0.9973 head_norm=1.358437 delta_norm=0.097366
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=12 metric=0.6986 head_norm=0.964650
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.550908e-01
[S15] stored merged vector for next round verification (round=12)
[S15] DEBUG after merge:  round=12 metric=0.6986 head_norm=0.972901 delta_norm=0.155091
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=12 metric=0.3727 head_norm=1.005301
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.256997e-01
[S8] stored merged vector for next round verification (round=12)
[S8] DEBUG after merge:  round=12 metric=0.3727 head_norm=0.878589 delta_norm=0.525700
[S8] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=12 metric=0.3547 head_norm=1.073426
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.596911e-01
[S17] stored merged vector for next round verification (round=12)
[S17] DEBUG after merge:  round=12 metric=0.3510 head_norm=0.766344 delta_norm=0.759691
[S17] aggregate: ACCEPT kept=['S6', 'S7'] (k=2/2) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.671974 (no previous merge yet)
[S2] round=13 local utility u=0.000000 metrics={'f1_val': 0.693841441678906, 'auprc': 0.7460324406915787, 'loss_val': 0.3131658712574925, 'psi': 0.7147178412839751}-{'f1_val': 0.6819518293655245, 'auprc': 0.7995148429632215, 'loss_val': 0.3645975242598316, 'psi': 0.7289770348046032}
[S3] START round=13 head_norm_before_train=1.542064 cos_to_last_merge=0.8479 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.848
[S3] round=13 local utility u=0.000000 metrics={'f1_val': 0.6930047378052776, 'auprc': 0.9916043429116057, 'loss_val': 0.29234551894799266, 'psi': 0.8124445798478088}-{'f1_val': 0.7007562037352997, 'auprc': 0.9919595829104241, 'loss_val': 0.2764169479327062, 'psi': 0.8172375554053495}
[S4] START round=13 head_norm_before_train=1.672390 (no previous merge yet)
[S4] round=13 local utility u=0.308770 metrics={'f1_val': 0.6738285804350987, 'auprc': 0.8595453967084569, 'loss_val': 0.390187513212737, 'psi': 0.748115306944442}-{'f1_val': 0.6732850862158521, 'auprc': 0.659058633384267, 'loss_val': 0.4030054149708373, 'psi': 0.667594505083218}
[S5] START round=13 head_norm_before_train=1.432957 cos_to_last_merge=0.8450 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.845
[S5] round=13 local utility u=0.000000 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9579746308464653, 'loss_val': 0.3020756732335232, 'psi': 0.8035548879361907}-{'f1_val': 0.7006090940057808, 'auprc': 0.9922238906879848, 'loss_val': 0.2943497590866201, 'psi': 0.8172550126786624}
[S6] START round=13 head_norm_before_train=1.576327 (no previous merge yet)
[S6] round=13 local utility u=0.169229 metrics={'f1_val': 0.7504552410454258, 'auprc': 0.9553252526851668, 'loss_val': 0.3876813453535763, 'psi': 0.8324032457013222}-{'f1_val': 0.706655460923784, 'auprc': 0.9509849725542703, 'loss_val': 0.4503194326139622, 'psi': 0.8043872655759785}
[S7] START round=13 head_norm_before_train=1.460324 cos_to_last_merge=0.9989 (last merge round=11)
[S7] round=13 local utility u=0.000000 metrics={'f1_val': 0.5562319264119864, 'auprc': 0.7788324996625244, 'loss_val': 0.7881774368374791, 'psi': 0.6452721557122016}-{'f1_val': 0.6611827313737583, 'auprc': 0.7970336510756015, 'loss_val': 0.6594534030286661, 'psi': 0.7155230992544956}
[S8] START round=13 head_norm_before_train=0.878589 cos_to_last_merge=1.0000 (last merge round=12)
[S8] round=13 local utility u=0.000000 metrics={'f1_val': 0.37273099922839503, 'auprc': 0.9917595490390598, 'loss_val': 0.7098774668154572, 'psi': 0.620342419152661}-{'f1_val': 0.37266438550987346, 'auprc': 0.9937555844411883, 'loss_val': 0.7130427865300033, 'psi': 0.6211008650823994}
[S9] START round=13 head_norm_before_train=0.965215 cos_to_last_merge=1.0000 (last merge round=12)
[S9] round=13 local utility u=0.035877 metrics={'f1_val': 0.9966891482978385, 'auprc': 0.9989419405904105, 'loss_val': 0.15291720015020305, 'psi': 0.9975902652148674}-{'f1_val': 0.988279001546821, 'auprc': 0.9989316779511628, 'loss_val': 0.17417900174339235, 'psi': 0.9925400721085578}
[S10] START round=13 head_norm_before_train=1.382762 cos_to_last_merge=0.8860 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.886
[S10] round=13 local utility u=0.000000 metrics={'f1_val': 0.686938105710596, 'auprc': 0.9973411154195492, 'loss_val': 0.26882827844132184, 'psi': 0.8110993095941773}-{'f1_val': 0.6988987142104666, 'auprc': 0.9980866945408835, 'loss_val': 0.3267934069191026, 'psi': 0.8185739063426334}
[S11] START round=13 head_norm_before_train=1.022280 cos_to_last_merge=1.0000 (last merge round=12)
[S11] round=13 local utility u=0.015199 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9116805362570077, 'loss_val': 0.5103589990901178, 'psi': 0.7858334044817952}-{'f1_val': 0.7019353166316534, 'auprc': 0.9305488403262985, 'loss_val': 0.5973624861942325, 'psi': 0.7933807261095114}
[S13] START round=13 head_norm_before_train=0.933956 cos_to_last_merge=1.0000 (last merge round=12)
[S13] round=13 local utility u=0.000000 metrics={'f1_val': 0.6030911165413527, 'auprc': 0.6940120484471195, 'loss_val': 0.7139179539900918, 'psi': 0.6394594893036594}-{'f1_val': 0.6173965956654375, 'auprc': 0.6446007156001969, 'loss_val': 0.5558617238476734, 'psi': 0.6282782436393413}
[S14] START round=13 head_norm_before_train=1.358437 cos_to_last_merge=1.0000 (last merge round=12)
[S14] round=13 local utility u=0.021247 metrics={'f1_val': 0.996773217596403, 'auprc': 0.9968140621575085, 'loss_val': 0.3012175264105638, 'psi': 0.9967895554208452}-{'f1_val': 0.9981280337016785, 'auprc': 0.997156357233009, 'loss_val': 0.35286698080587586, 'psi': 0.9977393631142106}
[S15] START round=13 head_norm_before_train=0.972901 cos_to_last_merge=1.0000 (last merge round=12)
[S15] round=13 local utility u=0.007705 metrics={'f1_val': 0.6908557773222878, 'auprc': 0.9647390088399092, 'loss_val': 0.5182976928535961, 'psi': 0.8004090699293364}-{'f1_val': 0.6986079960532545, 'auprc': 0.9747093712812083, 'loss_val': 0.6101327158807991, 'psi': 0.809048546144436}
[S16] START round=13 head_norm_before_train=1.591476 (no previous merge yet)
[S16] round=13 local utility u=0.000000 metrics={'f1_val': 0.474625107661566, 'auprc': 0.7977792426185211, 'loss_val': 0.634367132159436, 'psi': 0.603886761644348}-{'f1_val': 0.5481787987977682, 'auprc': 0.7709581743630093, 'loss_val': 0.7203533801323626, 'psi': 0.6372905490238647}
[S17] START round=13 head_norm_before_train=0.766344 cos_to_last_merge=1.0000 (last merge round=12)
[S17] round=13 local utility u=0.046327 metrics={'f1_val': 0.35464400562757514, 'auprc': 0.5015835247359895, 'loss_val': 0.9708999934970082, 'psi': 0.4134198132709409}-{'f1_val': 0.35472564815320357, 'auprc': 0.4931511764104723, 'loss_val': 1.0387469884861937, 'psi': 0.41009585945611104}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:61009
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:61017
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:61017
[S6] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1801) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.602174)
[S17] loaded HEAD from S6 (vec_in norm=1.602174)
[S17] cosine check vs S6: cos=0.4923
[S17] BUFFERED delta from S6 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1800) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.062540)
[S17] loaded HEAD from S9 (vec_in norm=1.062540)
[S17] cosine check vs S9: cos=0.6407
[S17] BUFFERED delta from S9 (total buffered=2)
[S8] RECEIVED delta(kind=head bytes=1802) from S4
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.693182)
[S8] loaded HEAD from S4 (vec_in norm=1.693182)
[S8] cosine check vs S4: cos=-0.0328
[S8] DROPPED delta from S4 (cos=-0.0328 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:61010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:61013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:61009
[S15] sending update (kind=head size=1794 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1794) from S15
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.027656)
[S9] loaded HEAD from S15 (vec_in norm=1.027656)
[S9] cosine check vs S15: cos=0.9116
[S9] BUFFERED delta from S15 (total buffered=1)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1800 to 1 peers)
[S17] sending update (kind=head size=1797 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1797) from S17
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.800404)
[S13] loaded HEAD from S17 (vec_in norm=0.800404)
[S13] cosine check vs S17: cos=0.7827
[S13] BUFFERED delta from S17 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1800) from S11
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.070562)
[S8] loaded HEAD from S11 (vec_in norm=1.070562)
[S8] cosine check vs S11: cos=0.8235
[S8] BUFFERED delta from S11 (total buffered=1)
[S14] sending update (kind=head size=1803 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1803) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.395694)
[S8] loaded HEAD from S14 (vec_in norm=1.395694)
[S8] cosine check vs S14: cos=-0.1631
[S8] DROPPED delta from S14 (cos=-0.1631 < 0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=13 metric=0.3727 head_norm=0.926769
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.044797e-01
[S8] stored merged vector for next round verification (round=13)
[S8] DEBUG after merge:  round=13 metric=0.3727 head_norm=0.953831 delta_norm=0.304480
[S8] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=13 metric=0.9967 head_norm=1.062540
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.204165e-01
[S9] stored merged vector for next round verification (round=13)
[S9] DEBUG after merge:  round=13 metric=0.9967 head_norm=1.021739 delta_norm=0.220417
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=13 metric=0.6031 head_norm=0.971136
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.028938e-01
[S13] stored merged vector for next round verification (round=13)
[S13] DEBUG after merge:  round=13 metric=0.6200 head_norm=0.836738 delta_norm=0.302894
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=13 metric=0.3546 head_norm=0.800404
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.130180e-01
[S17] stored merged vector for next round verification (round=13)
[S17] DEBUG after merge:  round=13 metric=0.3545 head_norm=0.828290 delta_norm=0.313018
[S17] aggregate: ACCEPT kept=['S6', 'S9'] (k=2/2) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.704952 (no previous merge yet)
[S2] round=14 local utility u=0.000000 metrics={'f1_val': 0.6999714129314755, 'auprc': 0.6731714813969699, 'loss_val': 0.28317417310667115, 'psi': 0.6892514403176733}-{'f1_val': 0.693841441678906, 'auprc': 0.7460324406915787, 'loss_val': 0.3131658712574925, 'psi': 0.7147178412839751}
[S3] START round=14 head_norm_before_train=1.569917 cos_to_last_merge=0.8432 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.843
[S3] round=14 local utility u=0.040635 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9965658469108414, 'loss_val': 0.272468995161751, 'psi': 0.8190800610055163}-{'f1_val': 0.6930047378052776, 'auprc': 0.9916043429116057, 'loss_val': 0.29234551894799266, 'psi': 0.8124445798478088}
[S4] START round=14 head_norm_before_train=1.693182 (no previous merge yet)
[S4] round=14 local utility u=0.000000 metrics={'f1_val': 0.6689796929002254, 'auprc': 0.6613966784970434, 'loss_val': 0.46870387146487114, 'psi': 0.6659464871389527}-{'f1_val': 0.6738285804350987, 'auprc': 0.8595453967084569, 'loss_val': 0.390187513212737, 'psi': 0.748115306944442}
[S5] START round=14 head_norm_before_train=1.454543 cos_to_last_merge=0.8393 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.839
[S5] round=14 local utility u=0.068798 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.997596964395199, 'loss_val': 0.2833468365438433, 'psi': 0.8194038213556842}-{'f1_val': 0.7006083926626743, 'auprc': 0.9579746308464653, 'loss_val': 0.3020756732335232, 'psi': 0.8035548879361907}
[S6] START round=14 head_norm_before_train=1.602174 (no previous merge yet)
[S6] round=14 local utility u=0.625401 metrics={'f1_val': 0.9525998246838878, 'auprc': 0.9553651922808408, 'loss_val': 0.3498669022023875, 'psi': 0.953705971722669}-{'f1_val': 0.7504552410454258, 'auprc': 0.9553252526851668, 'loss_val': 0.3876813453535763, 'psi': 0.8324032457013222}
[S7] START round=14 head_norm_before_train=1.493869 cos_to_last_merge=0.9956 (last merge round=11)
[S7] round=14 local utility u=0.034053 metrics={'f1_val': 0.5598674123078139, 'auprc': 0.7835062213218076, 'loss_val': 0.7559061213599686, 'psi': 0.6493229359134114}-{'f1_val': 0.5562319264119864, 'auprc': 0.7788324996625244, 'loss_val': 0.7881774368374791, 'psi': 0.6452721557122016}
[S8] START round=14 head_norm_before_train=0.953831 cos_to_last_merge=1.0000 (last merge round=13)
[S8] round=14 local utility u=0.010474 metrics={'f1_val': 0.37286435010037056, 'auprc': 0.9860656528710411, 'loss_val': 0.6726484930070123, 'psi': 0.6181448712086388}-{'f1_val': 0.37273099922839503, 'auprc': 0.9917595490390598, 'loss_val': 0.7098774668154572, 'psi': 0.620342419152661}
[S9] START round=14 head_norm_before_train=1.021739 cos_to_last_merge=1.0000 (last merge round=13)
[S9] round=14 local utility u=0.005883 metrics={'f1_val': 0.9958601375429889, 'auprc': 0.9985643634554618, 'loss_val': 0.13504455503467086, 'psi': 0.996941827907978}-{'f1_val': 0.9966891482978385, 'auprc': 0.9989419405904105, 'loss_val': 0.15291720015020305, 'psi': 0.9975902652148674}
[S10] START round=14 head_norm_before_train=1.432287 cos_to_last_merge=0.8766 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.877
[S10] round=14 local utility u=0.297723 metrics={'f1_val': 0.7845934240794684, 'auprc': 0.9975619593265331, 'loss_val': 0.25997695311466645, 'psi': 0.8697808381782943}-{'f1_val': 0.686938105710596, 'auprc': 0.9973411154195492, 'loss_val': 0.26882827844132184, 'psi': 0.8110993095941773}
[S11] START round=14 head_norm_before_train=1.070562 cos_to_last_merge=0.9966 (last merge round=12)
[S11] round=14 local utility u=0.039974 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9052865395750642, 'loss_val': 0.41122849837069325, 'psi': 0.7832758058090177}-{'f1_val': 0.7019353166316534, 'auprc': 0.9116805362570077, 'loss_val': 0.5103589990901178, 'psi': 0.7858334044817952}
[S13] START round=14 head_norm_before_train=0.836738 cos_to_last_merge=1.0000 (last merge round=13)
[S13] round=14 local utility u=0.153829 metrics={'f1_val': 0.6552173542106614, 'auprc': 0.6783177889375425, 'loss_val': 0.671934151982309, 'psi': 0.6644575281014138}-{'f1_val': 0.6030911165413527, 'auprc': 0.6940120484471195, 'loss_val': 0.7139179539900918, 'psi': 0.6394594893036594}
[S14] START round=14 head_norm_before_train=1.395694 cos_to_last_merge=0.9990 (last merge round=12)
[S14] round=14 local utility u=0.048138 metrics={'f1_val': 0.9976516241010662, 'auprc': 0.9982563188878153, 'loss_val': 0.2145383662296731, 'psi': 0.9978935020157658}-{'f1_val': 0.996773217596403, 'auprc': 0.9968140621575085, 'loss_val': 0.3012175264105638, 'psi': 0.9967895554208452}
[S15] START round=14 head_norm_before_train=1.027656 cos_to_last_merge=0.9954 (last merge round=12)
[S15] round=14 local utility u=0.032482 metrics={'f1_val': 0.6983321497250758, 'auprc': 0.945979907043815, 'loss_val': 0.4419154542097777, 'psi': 0.7973912526525715}-{'f1_val': 0.6908557773222878, 'auprc': 0.9647390088399092, 'loss_val': 0.5182976928535961, 'psi': 0.8004090699293364}
[S16] START round=14 head_norm_before_train=1.623340 (no previous merge yet)
[S16] round=14 local utility u=0.280446 metrics={'f1_val': 0.5589221555737975, 'auprc': 0.8280340060648064, 'loss_val': 0.6700221411407019, 'psi': 0.6665668957702011}-{'f1_val': 0.474625107661566, 'auprc': 0.7977792426185211, 'loss_val': 0.634367132159436, 'psi': 0.603886761644348}
[S17] START round=14 head_norm_before_train=0.828290 cos_to_last_merge=1.0000 (last merge round=13)
[S17] round=14 local utility u=0.084957 metrics={'f1_val': 0.38933943659528203, 'auprc': 0.45250478106559733, 'loss_val': 0.8619232966086072, 'psi': 0.41460557438340817}-{'f1_val': 0.35464400562757514, 'auprc': 0.5015835247359895, 'loss_val': 0.9708999934970082, 'psi': 0.4134198132709409}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S8] → sending delta(kind=head bytes=1790) to S15@127.0.0.1:61015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:61012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:61008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] → sending delta(kind=head bytes=1793) to S14@127.0.0.1:61014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] → sending delta(kind=head bytes=1792) to S9@127.0.0.1:61010
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S13] → sending delta(kind=head bytes=1792) to S7@127.0.0.1:61008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:61017
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:61012
[S13] sending update (kind=head size=1792 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1792 to 1 peers)
[S10] sending update (kind=head size=1793 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1790 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1802) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.120874)
[S17] loaded HEAD from S9 (vec_in norm=1.120874)
[S17] cosine check vs S9: cos=0.6206
[S17] BUFFERED delta from S9 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1792) from S15
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.088042)
[S9] loaded HEAD from S15 (vec_in norm=1.088042)
[S9] cosine check vs S15: cos=0.9536
[S9] BUFFERED delta from S15 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1799) from S11
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.123006)
[S8] loaded HEAD from S11 (vec_in norm=1.123006)
[S8] cosine check vs S11: cos=0.9413
[S8] BUFFERED delta from S11 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1804) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.431255)
[S8] loaded HEAD from S14 (vec_in norm=1.431255)
[S8] cosine check vs S14: cos=-0.1564
[S8] DROPPED delta from S14 (cos=-0.1564 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1804) from S7
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.527278)
[S17] loaded HEAD from S7 (vec_in norm=1.527278)
[S17] cosine check vs S7: cos=0.2351
[S17] BUFFERED delta from S7 (total buffered=2)
[S17] RECEIVED delta(kind=head bytes=1801) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.631675)
[S17] loaded HEAD from S6 (vec_in norm=1.631675)
[S17] cosine check vs S6: cos=0.6808
[S17] BUFFERED delta from S6 (total buffered=3)
[S7] RECEIVED delta(kind=head bytes=1792) from S13
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=0.880630)
[S7] loaded HEAD from S13 (vec_in norm=0.880630)
[S7] cosine check vs S13: cos=0.7303
[S7] BUFFERED delta from S13 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1795) from S3
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.603595)
[S11] loaded HEAD from S3 (vec_in norm=1.603595)
[S11] cosine check vs S3: cos=0.6239
[S11] BUFFERED delta from S3 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1796) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.653071)
[S7] loaded HEAD from S16 (vec_in norm=1.653071)
[S7] cosine check vs S16: cos=-0.0607
[S7] DROPPED delta from S16 (cos=-0.0607 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1790) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.993150)
[S15] loaded HEAD from S8 (vec_in norm=0.993150)
[S15] cosine check vs S8: cos=0.6790
[S15] BUFFERED delta from S8 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1800) from S5
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.479640)
[S11] loaded HEAD from S5 (vec_in norm=1.479640)
[S11] cosine check vs S5: cos=0.7006
[S11] BUFFERED delta from S5 (total buffered=2)
[S14] RECEIVED delta(kind=head bytes=1793) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.475844)
[S14] loaded HEAD from S10 (vec_in norm=1.475844)
[S14] cosine check vs S10: cos=0.9845
[S14] BUFFERED delta from S10 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:61013
[S17] sending update (kind=head size=1796 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1796) from S17
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.863370)
[S13] loaded HEAD from S17 (vec_in norm=0.863370)
[S13] cosine check vs S17: cos=0.7414
[S13] BUFFERED delta from S17 (total buffered=1)
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=14 metric=0.7019 head_norm=1.123006
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.515949e-01
[S11] stored merged vector for next round verification (round=14)
[S11] DEBUG after merge:  round=14 metric=0.7019 head_norm=1.080226 delta_norm=0.151595
[S11] aggregate: ACCEPT kept=['S3', 'S5'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=14 metric=0.3729 head_norm=0.993150
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.922229e-01
[S8] stored merged vector for next round verification (round=14)
[S8] DEBUG after merge:  round=14 metric=0.3932 head_norm=1.042494 delta_norm=0.192223
[S8] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=14 metric=0.6983 head_norm=1.088042
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.191558e-01
[S15] stored merged vector for next round verification (round=14)
[S15] DEBUG after merge:  round=14 metric=0.6988 head_norm=0.953625 delta_norm=0.419156
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=14 metric=0.6552 head_norm=0.880630
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.136666e-01
[S13] stored merged vector for next round verification (round=14)
[S13] DEBUG after merge:  round=14 metric=0.6600 head_norm=0.813677 delta_norm=0.313667
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=14 metric=0.9977 head_norm=1.431255
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.299699e-01
[S14] stored merged vector for next round verification (round=14)
[S14] DEBUG after merge:  round=14 metric=0.9977 head_norm=1.447899 delta_norm=0.129970
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=14 metric=0.5599 head_norm=1.527278
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.347292e-01
[S7] stored merged vector for next round verification (round=14)
[S7] DEBUG after merge:  round=14 metric=0.5527 head_norm=1.126103 delta_norm=0.534729
[S7] aggregate: ROLLBACK (f1_val pre=0.560 post=0.553 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=14 metric=0.9959 head_norm=1.120874
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.690961e-01
[S9] stored merged vector for next round verification (round=14)
[S9] DEBUG after merge:  round=14 metric=0.9959 head_norm=1.091560 delta_norm=0.169096
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=14 metric=0.3893 head_norm=0.863370
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.186464e-01
[S17] stored merged vector for next round verification (round=14)
[S17] DEBUG after merge:  round=14 metric=0.3893 head_norm=0.811905 delta_norm=0.218646
[S17] aggregate: ACCEPT kept=['S9', 'S7', 'S6'] (k=3/3) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.733993 (no previous merge yet)
[S2] round=15 local utility u=0.000000 metrics={'f1_val': 0.7003323196347389, 'auprc': 0.6631746152692177, 'loss_val': 0.2814334187442499, 'psi': 0.6854692378885304}-{'f1_val': 0.6999714129314755, 'auprc': 0.6731714813969699, 'loss_val': 0.28317417310667115, 'psi': 0.6892514403176733}
[S3] START round=15 head_norm_before_train=1.603595 cos_to_last_merge=0.8392 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.839
[S3] round=15 local utility u=0.000000 metrics={'f1_val': 0.6930047378052776, 'auprc': 0.9969328845656864, 'loss_val': 0.23687260294262757, 'psi': 0.8145759965094411}-{'f1_val': 0.7007562037352997, 'auprc': 0.9965658469108414, 'loss_val': 0.272468995161751, 'psi': 0.8190800610055163}
[S4] START round=15 head_norm_before_train=1.712669 (no previous merge yet)
[S4] round=15 local utility u=0.251837 metrics={'f1_val': 0.6295240451112282, 'auprc': 0.8952975863579391, 'loss_val': 0.4299993980619215, 'psi': 0.7358334616099126}-{'f1_val': 0.6689796929002254, 'auprc': 0.6613966784970434, 'loss_val': 0.46870387146487114, 'psi': 0.6659464871389527}
[S5] START round=15 head_norm_before_train=1.479640 cos_to_last_merge=0.8354 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.835
[S5] round=15 local utility u=0.008442 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9978090897141991, 'loss_val': 0.2670985931723283, 'psi': 0.8194886714832843}-{'f1_val': 0.7006083926626743, 'auprc': 0.997596964395199, 'loss_val': 0.2833468365438433, 'psi': 0.8194038213556842}
[S6] START round=15 head_norm_before_train=1.631675 (no previous merge yet)
[S6] round=15 local utility u=0.048762 metrics={'f1_val': 0.9606117597936769, 'auprc': 0.9553245276791942, 'loss_val': 0.30029195388725255, 'psi': 0.9584968669478837}-{'f1_val': 0.9525998246838878, 'auprc': 0.9553651922808408, 'loss_val': 0.3498669022023875, 'psi': 0.953705971722669}
[S7] START round=15 head_norm_before_train=1.126103 cos_to_last_merge=1.0000 (last merge round=14)
[S7] round=15 local utility u=0.185142 metrics={'f1_val': 0.6073245753389334, 'auprc': 0.7918336555114367, 'loss_val': 0.6953478488607987, 'psi': 0.6811282074079348}-{'f1_val': 0.5598674123078139, 'auprc': 0.7835062213218076, 'loss_val': 0.7559061213599686, 'psi': 0.6493229359134114}
[S8] START round=15 head_norm_before_train=1.042494 cos_to_last_merge=1.0000 (last merge round=14)
[S8] round=15 local utility u=1.000000 metrics={'f1_val': 0.7134079965800252, 'auprc': 0.9893914205487555, 'loss_val': 0.5631518438618668, 'psi': 0.8238013661675173}-{'f1_val': 0.37286435010037056, 'auprc': 0.9860656528710411, 'loss_val': 0.6726484930070123, 'psi': 0.6181448712086388}
[S9] START round=15 head_norm_before_train=1.091560 cos_to_last_merge=1.0000 (last merge round=14)
[S9] round=15 local utility u=0.012615 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9992311922533723, 'loss_val': 0.11927182667617414, 'psi': 0.9979542244086346}-{'f1_val': 0.9958601375429889, 'auprc': 0.9985643634554618, 'loss_val': 0.13504455503467086, 'psi': 0.996941827907978}
[S10] START round=15 head_norm_before_train=1.475844 cos_to_last_merge=0.8693 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.869
[S10] round=15 local utility u=0.685056 metrics={'f1_val': 0.9952944722405084, 'auprc': 0.9976303706700623, 'loss_val': 0.15427665947610783, 'psi': 0.9962288316123299}-{'f1_val': 0.7845934240794684, 'auprc': 0.9975619593265331, 'loss_val': 0.25997695311466645, 'psi': 0.8697808381782943}
[S11] START round=15 head_norm_before_train=1.080226 cos_to_last_merge=1.0000 (last merge round=14)
[S11] round=15 local utility u=0.004097 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9051220354294199, 'loss_val': 0.4025402705347214, 'psi': 0.78321000415076}-{'f1_val': 0.7019353166316534, 'auprc': 0.9052865395750642, 'loss_val': 0.41122849837069325, 'psi': 0.7832758058090177}
[S13] START round=15 head_norm_before_train=0.813677 cos_to_last_merge=1.0000 (last merge round=14)
[S13] round=15 local utility u=0.000000 metrics={'f1_val': 0.6049336217074779, 'auprc': 0.692324775399094, 'loss_val': 0.7551915683822146, 'psi': 0.6398900831841243}-{'f1_val': 0.6552173542106614, 'auprc': 0.6783177889375425, 'loss_val': 0.671934151982309, 'psi': 0.6644575281014138}
[S14] START round=15 head_norm_before_train=1.447899 cos_to_last_merge=1.0000 (last merge round=14)
[S14] round=15 local utility u=0.005351 metrics={'f1_val': 0.9969931333709598, 'auprc': 0.9973687598116012, 'loss_val': 0.19722247910137528, 'psi': 0.9971433839472164}-{'f1_val': 0.9976516241010662, 'auprc': 0.9982563188878153, 'loss_val': 0.2145383662296731, 'psi': 0.9978935020157658}
[S15] START round=15 head_norm_before_train=0.953625 cos_to_last_merge=1.0000 (last merge round=14)
[S15] round=15 local utility u=0.984695 metrics={'f1_val': 0.9893742985064033, 'auprc': 0.9928754794672233, 'loss_val': 0.3594649481756803, 'psi': 0.9907747708907314}-{'f1_val': 0.6983321497250758, 'auprc': 0.945979907043815, 'loss_val': 0.4419154542097777, 'psi': 0.7973912526525715}
[S16] START round=15 head_norm_before_train=1.653071 (no previous merge yet)
[S16] round=15 local utility u=0.559449 metrics={'f1_val': 0.6444328740868487, 'auprc': 0.9376888515449798, 'loss_val': 0.3931537534429875, 'psi': 0.7617352650701013}-{'f1_val': 0.5589221555737975, 'auprc': 0.8280340060648064, 'loss_val': 0.6700221411407019, 'psi': 0.6665668957702011}
[S17] START round=15 head_norm_before_train=0.811905 cos_to_last_merge=1.0000 (last merge round=14)
[S17] round=15 local utility u=0.000000 metrics={'f1_val': 0.3894554204227056, 'auprc': 0.42751640829257764, 'loss_val': 0.8234552962117163, 'psi': 0.4046798155706544}-{'f1_val': 0.38933943659528203, 'auprc': 0.45250478106559733, 'loss_val': 0.8619232966086072, 'psi': 0.41460557438340817}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:61008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:61012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:61014
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:61010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:61009
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:61009
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:61015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:61017
[S9] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1804 to 1 peers)
[S7] sending update (kind=head size=1794 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1802) from S5
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.503850)
[S11] loaded HEAD from S5 (vec_in norm=1.503850)
[S11] cosine check vs S5: cos=0.6813
[S11] BUFFERED delta from S5 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1797) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.680733)
[S7] loaded HEAD from S16 (vec_in norm=1.680733)
[S7] cosine check vs S16: cos=-0.0638
[S7] DROPPED delta from S16 (cos=-0.0638 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1804) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.472461)
[S8] loaded HEAD from S14 (vec_in norm=1.472461)
[S8] cosine check vs S14: cos=-0.1628
[S8] DROPPED delta from S14 (cos=-0.1628 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1795) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.180498)
[S17] loaded HEAD from S9 (vec_in norm=1.180498)
[S17] cosine check vs S9: cos=0.6262
[S17] BUFFERED delta from S9 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1799) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.075951)
[S15] loaded HEAD from S8 (vec_in norm=1.075951)
[S15] cosine check vs S8: cos=0.8388
[S15] BUFFERED delta from S8 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1797) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.511356)
[S14] loaded HEAD from S10 (vec_in norm=1.511356)
[S14] cosine check vs S10: cos=0.9923
[S14] BUFFERED delta from S10 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1795) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.660686)
[S17] loaded HEAD from S6 (vec_in norm=1.660686)
[S17] cosine check vs S6: cos=0.6089
[S17] BUFFERED delta from S6 (total buffered=2)
[S17] RECEIVED delta(kind=head bytes=1794) from S7
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.161911)
[S17] loaded HEAD from S7 (vec_in norm=1.161911)
[S17] cosine check vs S7: cos=0.5957
[S17] BUFFERED delta from S7 (total buffered=3)
[S9] RECEIVED delta(kind=head bytes=1795) from S15
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.009558)
[S9] loaded HEAD from S15 (vec_in norm=1.009558)
[S9] cosine check vs S15: cos=0.9176
[S9] BUFFERED delta from S15 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1799) from S4
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.728326)
[S8] loaded HEAD from S4 (vec_in norm=1.728326)
[S8] cosine check vs S4: cos=-0.0338
[S8] DROPPED delta from S4 (cos=-0.0338 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1799) from S11
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.121450)
[S8] loaded HEAD from S11 (vec_in norm=1.121450)
[S8] cosine check vs S11: cos=0.9648
[S8] BUFFERED delta from S11 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] ⇄ pheromone p=0.108 → S8@127.0.0.1:61009
[S13] ⇄ pheromone p=0.159 → S7@127.0.0.1:61008
[S3] ⇄ pheromone p=0.112 → S11@127.0.0.1:61012
[S4] ⇄ pheromone p=0.200 → S8@127.0.0.1:61009
[S6] ⇄ pheromone p=0.291 → S17@127.0.0.1:61017
[S10] ⇄ pheromone p=0.327 → S14@127.0.0.1:61014
[S16] ⇄ pheromone p=0.299 → S7@127.0.0.1:61008
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=15 metric=0.7134 head_norm=1.075951
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.475499e-01
[S8] stored merged vector for next round verification (round=15)
[S8] DEBUG after merge:  round=15 metric=0.7056 head_norm=1.088985 delta_norm=0.147550
[S8] aggregate: ROLLBACK (f1_val pre=0.713 post=0.706 tol_abs=0.005 tol_rel=0.0)
[S8] ⇄ pheromone p=0.303 → S15@127.0.0.1:61015
[S7] ⇄ pheromone p=0.135 → S17@127.0.0.1:61017
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=15 metric=0.9970 head_norm=1.472461
[S14] _apply_head_vector_avg (torch): Δ‖w‖=9.434762e-02
[S14] stored merged vector for next round verification (round=15)
[S14] DEBUG after merge:  round=15 metric=0.9966 head_norm=1.489049 delta_norm=0.094348
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.217 → S8@127.0.0.1:61009
[S5] ⇄ pheromone p=0.130 → S11@127.0.0.1:61012
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=15 metric=0.9971 head_norm=1.180498
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.374975e-01
[S9] stored merged vector for next round verification (round=15)
[S9] DEBUG after merge:  round=15 metric=0.9971 head_norm=1.072374 delta_norm=0.237497
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.139 → S17@127.0.0.1:61017
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=15 metric=0.9894 head_norm=1.009558
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.977764e-01
[S15] stored merged vector for next round verification (round=15)
[S15] DEBUG after merge:  round=15 metric=0.9900 head_norm=0.999884 delta_norm=0.297776
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.367 → S9@127.0.0.1:61010
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=15 metric=0.7019 head_norm=1.121450
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.525247e-01
[S11] stored merged vector for next round verification (round=15)
[S11] DEBUG after merge:  round=15 metric=0.7019 head_norm=1.205953 delta_norm=0.552525
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.159 → S8@127.0.0.1:61009
[S17] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=15 metric=0.3895 head_norm=0.849222
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.343307e-01
[S17] stored merged vector for next round verification (round=15)
[S17] DEBUG after merge:  round=15 metric=0.3893 head_norm=0.825740 delta_norm=0.134331
[S17] aggregate: ACCEPT kept=['S9', 'S6', 'S7'] (k=3/3) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.089 → S13@127.0.0.1:61013
[S2] START round=16 head_norm_before_train=1.756840 (no previous merge yet)
[S2] round=16 local utility u=0.003473 metrics={'f1_val': 0.6996105493161282, 'auprc': 0.6662962466130713, 'loss_val': 0.2795219503705876, 'psi': 0.6862848282349054}-{'f1_val': 0.7003323196347389, 'auprc': 0.6631746152692177, 'loss_val': 0.2814334187442499, 'psi': 0.6854692378885304}
[S3] START round=16 head_norm_before_train=1.636440 cos_to_last_merge=0.8355 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.836
[S3] round=16 local utility u=0.574846 metrics={'f1_val': 0.8839301503094608, 'auprc': 0.9992437536636883, 'loss_val': 0.23966528146650462, 'psi': 0.9300555916511518}-{'f1_val': 0.6930047378052776, 'auprc': 0.9969328845656864, 'loss_val': 0.23687260294262757, 'psi': 0.8145759965094411}
[S4] START round=16 head_norm_before_train=1.728326 (no previous merge yet)
[S4] round=16 local utility u=0.033306 metrics={'f1_val': 0.6158869783379176, 'auprc': 0.9495420347422949, 'loss_val': 0.44429820937967995, 'psi': 0.7493490008996686}-{'f1_val': 0.6295240451112282, 'auprc': 0.8952975863579391, 'loss_val': 0.4299993980619215, 'psi': 0.7358334616099126}
[S5] START round=16 head_norm_before_train=1.503850 cos_to_last_merge=0.8300 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.830
[S5] round=16 local utility u=0.014257 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9976995797587586, 'loss_val': 0.23825612341759467, 'psi': 0.819444867501108}-{'f1_val': 0.7006083926626743, 'auprc': 0.9978090897141991, 'loss_val': 0.2670985931723283, 'psi': 0.8194886714832843}
[S6] START round=16 head_norm_before_train=1.660686 (no previous merge yet)
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.4255465317683715, 'auprc': 0.7564706301018855, 'loss_val': 0.8163199835318778, 'psi': 0.557916171101777}-{'f1_val': 0.9606117597936769, 'auprc': 0.9553245276791942, 'loss_val': 0.30029195388725255, 'psi': 0.9584968669478837}
[S7] START round=16 head_norm_before_train=1.161911 cos_to_last_merge=0.9986 (last merge round=14)
[S7] round=16 local utility u=0.000000 metrics={'f1_val': 0.5490151196953874, 'auprc': 0.7817761432971814, 'loss_val': 0.8125914731395152, 'psi': 0.642119529136105}-{'f1_val': 0.6073245753389334, 'auprc': 0.7918336555114367, 'loss_val': 0.6953478488607987, 'psi': 0.6811282074079348}
[S8] START round=16 head_norm_before_train=1.088985 cos_to_last_merge=1.0000 (last merge round=15)
[S8] round=16 local utility u=0.000000 metrics={'f1_val': 0.7009086045093338, 'auprc': 0.9470928353668804, 'loss_val': 0.5299913895265496, 'psi': 0.7993822968523525}-{'f1_val': 0.7134079965800252, 'auprc': 0.9893914205487555, 'loss_val': 0.5631518438618668, 'psi': 0.8238013661675173}
[S9] START round=16 head_norm_before_train=1.072374 cos_to_last_merge=1.0000 (last merge round=15)
[S9] round=16 local utility u=0.000000 metrics={'f1_val': 0.9941961205231895, 'auprc': 0.9980053948071527, 'loss_val': 0.12086100134205616, 'psi': 0.9957198302367748}-{'f1_val': 0.9971029125121428, 'auprc': 0.9992311922533723, 'loss_val': 0.11927182667617414, 'psi': 0.9979542244086346}
[S10] START round=16 head_norm_before_train=1.511356 cos_to_last_merge=0.8642 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.864
[S10] round=16 local utility u=0.018403 metrics={'f1_val': 0.9948332665356702, 'auprc': 0.9975511125995509, 'loss_val': 0.1144650330066341, 'psi': 0.9959204049612225}-{'f1_val': 0.9952944722405084, 'auprc': 0.9976303706700623, 'loss_val': 0.15427665947610783, 'psi': 0.9962288316123299}
[S11] START round=16 head_norm_before_train=1.205953 cos_to_last_merge=1.0000 (last merge round=15)
[S11] round=16 local utility u=0.003702 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9035951729167171, 'loss_val': 0.3905554873659252, 'psi': 0.782599259145679}-{'f1_val': 0.7019353166316534, 'auprc': 0.9051220354294199, 'loss_val': 0.4025402705347214, 'psi': 0.78321000415076}
[S13] START round=16 head_norm_before_train=0.858179 cos_to_last_merge=0.9919 (last merge round=14)
[S13] round=16 local utility u=0.246442 metrics={'f1_val': 0.6702275198638717, 'auprc': 0.6721689670584904, 'loss_val': 0.5936033148710163, 'psi': 0.6710040987417192}-{'f1_val': 0.6049336217074779, 'auprc': 0.692324775399094, 'loss_val': 0.7551915683822146, 'psi': 0.6398900831841243}
[S14] START round=16 head_norm_before_train=1.489049 cos_to_last_merge=1.0000 (last merge round=15)
[S14] round=16 local utility u=0.011978 metrics={'f1_val': 0.9981277793728904, 'auprc': 0.9975331493389714, 'loss_val': 0.18056850959833107, 'psi': 0.9978899273593229}-{'f1_val': 0.9969931333709598, 'auprc': 0.9973687598116012, 'loss_val': 0.19722247910137528, 'psi': 0.9971433839472164}
[S15] START round=16 head_norm_before_train=0.999884 cos_to_last_merge=1.0000 (last merge round=15)
[S15] round=16 local utility u=0.000000 metrics={'f1_val': 0.6952360156091524, 'auprc': 0.9284256353943146, 'loss_val': 0.5111258548851728, 'psi': 0.7885118635232173}-{'f1_val': 0.9893742985064033, 'auprc': 0.9928754794672233, 'loss_val': 0.3594649481756803, 'psi': 0.9907747708907314}
[S16] START round=16 head_norm_before_train=1.680733 (no previous merge yet)
[S16] round=16 local utility u=0.238660 metrics={'f1_val': 0.8265146996353108, 'auprc': 0.8537353907884777, 'loss_val': 0.7564649888887945, 'psi': 0.8374029760965775}-{'f1_val': 0.6444328740868487, 'auprc': 0.9376888515449798, 'loss_val': 0.3931537534429875, 'psi': 0.7617352650701013}
[S17] START round=16 head_norm_before_train=0.825740 cos_to_last_merge=1.0000 (last merge round=15)
[S17] round=16 local utility u=0.020759 metrics={'f1_val': 0.38922721538282895, 'auprc': 0.42659186557250994, 'loss_val': 0.7777938089480858, 'psi': 0.40417307545870135}-{'f1_val': 0.3894554204227056, 'auprc': 0.42751640829257764, 'loss_val': 0.8234552962117163, 'psi': 0.4046798155706544}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:61012
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:61012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:61014
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1798) from S3
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.677047)
[S11] loaded HEAD from S3 (vec_in norm=1.677047)
[S11] cosine check vs S3: cos=0.2765
[S11] BUFFERED delta from S3 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1801) from S5
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.529758)
[S11] loaded HEAD from S5 (vec_in norm=1.529758)
[S11] cosine check vs S5: cos=0.9339
[S11] BUFFERED delta from S5 (total buffered=2)
[S14] RECEIVED delta(kind=head bytes=1800) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.544328)
[S14] loaded HEAD from S10 (vec_in norm=1.544328)
[S14] cosine check vs S10: cos=0.9955
[S14] BUFFERED delta from S10 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1802) from S4
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.743609)
[S8] loaded HEAD from S4 (vec_in norm=1.743609)
[S8] cosine check vs S4: cos=-0.0304
[S8] DROPPED delta from S4 (cos=-0.0304 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1798) from S2
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.771870)
[S8] loaded HEAD from S2 (vec_in norm=1.771870)
[S8] cosine check vs S2: cos=0.0870
[S8] BUFFERED delta from S2 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:61008
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S11
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.235708)
[S8] loaded HEAD from S11 (vec_in norm=1.235708)
[S8] cosine check vs S11: cos=0.8888
[S8] BUFFERED delta from S11 (total buffered=2)
[S7] RECEIVED delta(kind=head bytes=1799) from S13
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=0.916463)
[S7] loaded HEAD from S13 (vec_in norm=0.916463)
[S7] cosine check vs S13: cos=0.7859
[S7] BUFFERED delta from S13 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:61009
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:61008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:61013
[S14] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.512482)
[S8] loaded HEAD from S14 (vec_in norm=1.512482)
[S8] cosine check vs S14: cos=-0.1613
[S8] DROPPED delta from S14 (cos=-0.1613 < 0.0)
[S17] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1795 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1796) from S17
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.866815)
[S13] loaded HEAD from S17 (vec_in norm=0.866815)
[S13] cosine check vs S17: cos=0.9290
[S13] BUFFERED delta from S17 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1795) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.712047)
[S7] loaded HEAD from S16 (vec_in norm=1.712047)
[S7] cosine check vs S16: cos=-0.0605
[S7] DROPPED delta from S16 (cos=-0.0605 < 0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=16 metric=0.5490 head_norm=1.202245
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.719732e-01
[S7] stored merged vector for next round verification (round=16)
[S7] DEBUG after merge:  round=16 metric=0.5440 head_norm=1.002140 delta_norm=0.371973
[S7] aggregate: ROLLBACK (f1_val pre=0.549 post=0.544 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=16 metric=0.7009 head_norm=1.119968
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.970577e-01
[S8] stored merged vector for next round verification (round=16)
[S8] DEBUG after merge:  round=16 metric=0.6764 head_norm=0.973846 delta_norm=0.497058
[S8] aggregate: ROLLBACK (f1_val pre=0.701 post=0.676 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=16 metric=0.9981 head_norm=1.512482
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.418381e-02
[S14] stored merged vector for next round verification (round=16)
[S14] DEBUG after merge:  round=16 metric=0.9977 head_norm=1.526687 delta_norm=0.074184
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=16 metric=0.7019 head_norm=1.235708
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.168560e-01
[S11] stored merged vector for next round verification (round=16)
[S11] DEBUG after merge:  round=16 metric=0.7019 head_norm=1.126773 delta_norm=0.316856
[S11] aggregate: ACCEPT kept=['S3', 'S5'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=16 metric=0.6702 head_norm=0.916463
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.697833e-01
[S13] stored merged vector for next round verification (round=16)
[S13] DEBUG after merge:  round=16 metric=0.6713 head_norm=0.875677 delta_norm=0.169783
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.771870 (no previous merge yet)
[S2] round=17 local utility u=0.039745 metrics={'f1_val': 0.6996105493161282, 'auprc': 0.6923117372708192, 'loss_val': 0.2780778715496402, 'psi': 0.6966910244980046}-{'f1_val': 0.6996105493161282, 'auprc': 0.6662962466130713, 'loss_val': 0.2795219503705876, 'psi': 0.6862848282349054}
[S3] START round=17 head_norm_before_train=1.677047 cos_to_last_merge=0.8311 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.831
[S3] round=17 local utility u=0.296506 metrics={'f1_val': 0.9608296089712303, 'auprc': 0.9995488546813183, 'loss_val': 0.10896590190158639, 'psi': 0.9763173072552654}-{'f1_val': 0.8839301503094608, 'auprc': 0.9992437536636883, 'loss_val': 0.23966528146650462, 'psi': 0.9300555916511518}
[S4] START round=17 head_norm_before_train=1.743609 (no previous merge yet)
[S4] round=17 local utility u=0.006530 metrics={'f1_val': 0.6184146242271206, 'auprc': 0.9578657264579447, 'loss_val': 0.4713760207286303, 'psi': 0.7541950651194502}-{'f1_val': 0.6158869783379176, 'auprc': 0.9495420347422949, 'loss_val': 0.44429820937967995, 'psi': 0.7493490008996686}
[S5] START round=17 head_norm_before_train=1.529758 cos_to_last_merge=0.8254 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.825
[S5] round=17 local utility u=0.000000 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.9899393140851921, 'loss_val': 0.2682272877610578, 'psi': 0.8163411820375452}-{'f1_val': 0.7006083926626743, 'auprc': 0.9976995797587586, 'loss_val': 0.23825612341759467, 'psi': 0.819444867501108}
[S6] START round=17 head_norm_before_train=1.684790 (no previous merge yet)
[S6] round=17 local utility u=1.000000 metrics={'f1_val': 0.9112843753966648, 'auprc': 0.9084762842822949, 'loss_val': 0.3708108929865839, 'psi': 0.9101611389509169}-{'f1_val': 0.4255465317683715, 'auprc': 0.7564706301018855, 'loss_val': 0.8163199835318778, 'psi': 0.557916171101777}
[S7] START round=17 head_norm_before_train=1.002140 cos_to_last_merge=1.0000 (last merge round=16)
[S7] round=17 local utility u=0.000000 metrics={'f1_val': 0.4650996455581105, 'auprc': 0.7741366947913335, 'loss_val': 0.9551908309291127, 'psi': 0.5887144652513998}-{'f1_val': 0.5490151196953874, 'auprc': 0.7817761432971814, 'loss_val': 0.8125914731395152, 'psi': 0.642119529136105}
[S8] START round=17 head_norm_before_train=0.973846 cos_to_last_merge=1.0000 (last merge round=16)
[S8] round=17 local utility u=0.000000 metrics={'f1_val': 0.7138874667974482, 'auprc': 0.7923771824937367, 'loss_val': 0.5383975397679368, 'psi': 0.7452833530759636}-{'f1_val': 0.7009086045093338, 'auprc': 0.9470928353668804, 'loss_val': 0.5299913895265496, 'psi': 0.7993822968523525}
[S9] START round=17 head_norm_before_train=1.158048 cos_to_last_merge=0.9956 (last merge round=15)
[S9] round=17 local utility u=0.024753 metrics={'f1_val': 0.9958601375429889, 'auprc': 0.9980621370488901, 'loss_val': 0.0815095932639639, 'psi': 0.9967409373453493}-{'f1_val': 0.9941961205231895, 'auprc': 0.9980053948071527, 'loss_val': 0.12086100134205616, 'psi': 0.9957198302367748}
[S10] START round=17 head_norm_before_train=1.544328 cos_to_last_merge=0.8603 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.860
[S10] round=17 local utility u=0.009192 metrics={'f1_val': 0.9954673585071979, 'auprc': 0.997522558749315, 'loss_val': 0.09979965857949065, 'psi': 0.9962894386040447}-{'f1_val': 0.9948332665356702, 'auprc': 0.9975511125995509, 'loss_val': 0.1144650330066341, 'psi': 0.9959204049612225}
[S11] START round=17 head_norm_before_train=1.126773 cos_to_last_merge=1.0000 (last merge round=16)
[S11] round=17 local utility u=0.008919 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.904407280281274, 'loss_val': 0.3737032279933572, 'psi': 0.7827789998646646}-{'f1_val': 0.7019353166316534, 'auprc': 0.9035951729167171, 'loss_val': 0.3905554873659252, 'psi': 0.782599259145679}
[S13] START round=17 head_norm_before_train=0.875677 cos_to_last_merge=1.0000 (last merge round=16)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.6286894297378857, 'auprc': 0.679773478365664, 'loss_val': 0.6579569174794332, 'psi': 0.649123049188997}-{'f1_val': 0.6702275198638717, 'auprc': 0.6721689670584904, 'loss_val': 0.5936033148710163, 'psi': 0.6710040987417192}
[S14] START round=17 head_norm_before_train=1.526687 cos_to_last_merge=1.0000 (last merge round=16)
[S14] round=17 local utility u=0.008504 metrics={'f1_val': 0.9974331919232962, 'auprc': 0.999114025560307, 'loss_val': 0.16413621845204102, 'psi': 0.9981055253781005}-{'f1_val': 0.9981277793728904, 'auprc': 0.9975331493389714, 'loss_val': 0.18056850959833107, 'psi': 0.9978899273593229}
[S15] START round=17 head_norm_before_train=1.047750 cos_to_last_merge=0.9970 (last merge round=15)
[S15] round=17 local utility u=0.571455 metrics={'f1_val': 0.8300980911850032, 'auprc': 0.987050770593201, 'loss_val': 0.3532644727254657, 'psi': 0.8928791629482824}-{'f1_val': 0.6952360156091524, 'auprc': 0.9284256353943146, 'loss_val': 0.5111258548851728, 'psi': 0.7885118635232173}
[S16] START round=17 head_norm_before_train=1.712047 (no previous merge yet)
[S16] round=17 local utility u=0.203200 metrics={'f1_val': 0.8209071584480313, 'auprc': 0.921749867108024, 'loss_val': 0.5204631587364722, 'psi': 0.8612442419120283}-{'f1_val': 0.8265146996353108, 'auprc': 0.8537353907884777, 'loss_val': 0.7564649888887945, 'psi': 0.8374029760965775}
[S17] START round=17 head_norm_before_train=0.866815 cos_to_last_merge=0.9912 (last merge round=15)
[S17] round=17 local utility u=0.408543 metrics={'f1_val': 0.38730360941578656, 'auprc': 0.7031222056905546, 'loss_val': 0.7787578848238614, 'psi': 0.5136310479256938}-{'f1_val': 0.38922721538282895, 'auprc': 0.42659186557250994, 'loss_val': 0.7777938089480858, 'psi': 0.40417307545870135}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:61009
[S2] sending update (kind=head size=1796 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1796) from S2
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.785900)
[S8] loaded HEAD from S2 (vec_in norm=1.785900)
[S8] cosine check vs S2: cos=0.5067
[S8] BUFFERED delta from S2 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:61014
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1800) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.573843)
[S14] loaded HEAD from S10 (vec_in norm=1.573843)
[S14] cosine check vs S10: cos=0.9970
[S14] BUFFERED delta from S10 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1797) from S11
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.159116)
[S8] loaded HEAD from S11 (vec_in norm=1.159116)
[S8] cosine check vs S11: cos=0.8189
[S8] BUFFERED delta from S11 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S15] → sending delta(kind=head bytes=1789) to S9@127.0.0.1:61010
[S15] sending update (kind=head size=1789 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1789) from S15
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.095006)
[S9] loaded HEAD from S15 (vec_in norm=1.095006)
[S9] cosine check vs S15: cos=0.8902
[S9] BUFFERED delta from S15 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1802) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.548402)
[S8] loaded HEAD from S14 (vec_in norm=1.548402)
[S8] cosine check vs S14: cos=-0.1672
[S8] DROPPED delta from S14 (cos=-0.1672 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:61009
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:61012
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:61008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S13@127.0.0.1:61013
[S3] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S4
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.757120)
[S8] loaded HEAD from S4 (vec_in norm=1.757120)
[S8] cosine check vs S4: cos=-0.0201
[S8] DROPPED delta from S4 (cos=-0.0201 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1800) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.235412)
[S17] loaded HEAD from S9 (vec_in norm=1.235412)
[S17] cosine check vs S9: cos=0.6222
[S17] BUFFERED delta from S9 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1801) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.699966)
[S17] loaded HEAD from S6 (vec_in norm=1.699966)
[S17] cosine check vs S6: cos=0.4959
[S17] BUFFERED delta from S6 (total buffered=2)
[S11] RECEIVED delta(kind=head bytes=1799) from S3
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.721811)
[S11] loaded HEAD from S3 (vec_in norm=1.721811)
[S11] cosine check vs S3: cos=0.5038
[S11] BUFFERED delta from S3 (total buffered=1)
[S17] sending update (kind=head size=1794 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1794) from S17
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.911865)
[S13] loaded HEAD from S17 (vec_in norm=0.911865)
[S13] cosine check vs S17: cos=0.9554
[S13] BUFFERED delta from S17 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1803) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.741836)
[S7] loaded HEAD from S16 (vec_in norm=1.741836)
[S7] cosine check vs S16: cos=-0.0674
[S7] DROPPED delta from S16 (cos=-0.0674 < 0.0)
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=17 metric=0.7139 head_norm=1.013142
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.405103e-01
[S8] stored merged vector for next round verification (round=17)
[S8] DEBUG after merge:  round=17 metric=0.7139 head_norm=0.998533 delta_norm=0.240510
[S8] aggregate: ACCEPT kept=['S2', 'S11'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=17 metric=0.7017 head_norm=1.159116
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.578169e-01
[S11] stored merged vector for next round verification (round=17)
[S11] DEBUG after merge:  round=17 metric=0.7017 head_norm=1.256903 delta_norm=0.757817
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=17 metric=0.6287 head_norm=0.917103
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.366311e-01
[S13] stored merged vector for next round verification (round=17)
[S13] DEBUG after merge:  round=17 metric=0.6297 head_norm=0.904223 delta_norm=0.136631
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=17 metric=0.9974 head_norm=1.548402
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.175246e-02
[S14] stored merged vector for next round verification (round=17)
[S14] DEBUG after merge:  round=17 metric=0.9970 head_norm=1.559952 delta_norm=0.061752
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=17 metric=0.9959 head_norm=1.235412
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.813984e-01
[S9] stored merged vector for next round verification (round=17)
[S9] DEBUG after merge:  round=17 metric=0.9959 head_norm=1.132897 delta_norm=0.281398
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=17 metric=0.3873 head_norm=0.911865
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.333040e-01
[S17] stored merged vector for next round verification (round=17)
[S17] DEBUG after merge:  round=17 metric=0.3850 head_norm=0.919733 delta_norm=0.333304
[S17] aggregate: ACCEPT kept=['S9', 'S6'] (k=2/2) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.785900 (no previous merge yet)
[S2] round=18 local utility u=0.058101 metrics={'f1_val': 0.7002298375331623, 'auprc': 0.7299767601609919, 'loss_val': 0.2785857910542068, 'psi': 0.7121286065842941}-{'f1_val': 0.6996105493161282, 'auprc': 0.6923117372708192, 'loss_val': 0.2780778715496402, 'psi': 0.6966910244980046}
[S3] START round=18 head_norm_before_train=1.721811 cos_to_last_merge=0.8253 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.825
[S3] round=18 local utility u=0.100121 metrics={'f1_val': 0.9864458943787179, 'auprc': 0.9991463236735727, 'loss_val': 0.06121426328632286, 'psi': 0.9915260660966598}-{'f1_val': 0.9608296089712303, 'auprc': 0.9995488546813183, 'loss_val': 0.10896590190158639, 'psi': 0.9763173072552654}
[S4] START round=18 head_norm_before_train=1.757120 (no previous merge yet)
[S4] round=18 local utility u=0.000000 metrics={'f1_val': 0.6157914242213955, 'auprc': 0.9474557805951417, 'loss_val': 0.4604407551666664, 'psi': 0.7484571667708939}-{'f1_val': 0.6184146242271206, 'auprc': 0.9578657264579447, 'loss_val': 0.4713760207286303, 'psi': 0.7541950651194502}
[S5] START round=18 head_norm_before_train=1.556338 cos_to_last_merge=0.8234 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.823
[S5] round=18 local utility u=0.000000 metrics={'f1_val': 0.42893341996485795, 'auprc': 0.8618844419509595, 'loss_val': 0.8370708352397714, 'psi': 0.6021138287592986}-{'f1_val': 0.7006090940057808, 'auprc': 0.9899393140851921, 'loss_val': 0.2682272877610578, 'psi': 0.8163411820375452}
[S6] START round=18 head_norm_before_train=1.699966 (no previous merge yet)
[S6] round=18 local utility u=0.000000 metrics={'f1_val': 0.4355471050867187, 'auprc': 0.8284729702810146, 'loss_val': 0.7330053926620087, 'psi': 0.5927174511644371}-{'f1_val': 0.9112843753966648, 'auprc': 0.9084762842822949, 'loss_val': 0.3708108929865839, 'psi': 0.9101611389509169}
[S7] START round=18 head_norm_before_train=1.034664 cos_to_last_merge=0.9986 (last merge round=16)
[S7] round=18 local utility u=0.683586 metrics={'f1_val': 0.6279135900048383, 'auprc': 0.7994743281539918, 'loss_val': 0.6409152602698213, 'psi': 0.6965378852644997}-{'f1_val': 0.4650996455581105, 'auprc': 0.7741366947913335, 'loss_val': 0.9551908309291127, 'psi': 0.5887144652513998}
[S8] START round=18 head_norm_before_train=0.998533 cos_to_last_merge=1.0000 (last merge round=17)
[S8] round=18 local utility u=0.354857 metrics={'f1_val': 0.7045315898550348, 'auprc': 0.9933013064829408, 'loss_val': 0.3753211556763281, 'psi': 0.8200394765061972}-{'f1_val': 0.7138874667974482, 'auprc': 0.7923771824937367, 'loss_val': 0.5383975397679368, 'psi': 0.7452833530759636}
[S9] START round=18 head_norm_before_train=1.132897 cos_to_last_merge=1.0000 (last merge round=17)
[S9] round=18 local utility u=0.000000 metrics={'f1_val': 0.9933610760940638, 'auprc': 0.9972440062765172, 'loss_val': 0.1026775170354051, 'psi': 0.9949142481670451}-{'f1_val': 0.9958601375429889, 'auprc': 0.9980621370488901, 'loss_val': 0.0815095932639639, 'psi': 0.9967409373453493}
[S10] START round=18 head_norm_before_train=1.573843 cos_to_last_merge=0.8574 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.857
[S10] round=18 local utility u=0.001998 metrics={'f1_val': 0.9939487387271932, 'auprc': 0.9975239689265033, 'loss_val': 0.08669532312787467, 'psi': 0.9953788308069172}-{'f1_val': 0.9954673585071979, 'auprc': 0.997522558749315, 'loss_val': 0.09979965857949065, 'psi': 0.9962894386040447}
[S11] START round=18 head_norm_before_train=1.256903 cos_to_last_merge=1.0000 (last merge round=17)
[S11] round=18 local utility u=0.000000 metrics={'f1_val': 0.7021770286274283, 'auprc': 0.907070876069767, 'loss_val': 0.39753007368706034, 'psi': 0.7841345676043638}-{'f1_val': 0.7016934795869249, 'auprc': 0.904407280281274, 'loss_val': 0.3737032279933572, 'psi': 0.7827789998646646}
[S13] START round=18 head_norm_before_train=0.904223 cos_to_last_merge=1.0000 (last merge round=17)
[S13] round=18 local utility u=0.173805 metrics={'f1_val': 0.6781304491465163, 'auprc': 0.6740517354088812, 'loss_val': 0.5898284720823861, 'psi': 0.6764989636514622}-{'f1_val': 0.6286894297378857, 'auprc': 0.679773478365664, 'loss_val': 0.6579569174794332, 'psi': 0.649123049188997}
[S14] START round=18 head_norm_before_train=1.559952 cos_to_last_merge=1.0000 (last merge round=17)
[S14] round=18 local utility u=0.014577 metrics={'f1_val': 0.9977165309073976, 'auprc': 0.9992305019112867, 'loss_val': 0.13703076522482785, 'psi': 0.9983221193089533}-{'f1_val': 0.9974331919232962, 'auprc': 0.999114025560307, 'loss_val': 0.16413621845204102, 'psi': 0.9981055253781005}
[S15] START round=18 head_norm_before_train=1.095006 cos_to_last_merge=0.9902 (last merge round=15)
[S15] round=18 local utility u=0.153063 metrics={'f1_val': 0.8750326193536614, 'auprc': 0.97592877920765, 'loss_val': 0.2833787621710207, 'psi': 0.9153910832952568}-{'f1_val': 0.8300980911850032, 'auprc': 0.987050770593201, 'loss_val': 0.3532644727254657, 'psi': 0.8928791629482824}
[S16] START round=18 head_norm_before_train=1.741836 (no previous merge yet)
[S16] round=18 local utility u=0.000000 metrics={'f1_val': 0.8446851892691194, 'auprc': 0.900435194336175, 'loss_val': 0.6686148069226798, 'psi': 0.8669851912959416}-{'f1_val': 0.8209071584480313, 'auprc': 0.921749867108024, 'loss_val': 0.5204631587364722, 'psi': 0.8612442419120283}
[S17] START round=18 head_norm_before_train=0.919733 cos_to_last_merge=1.0000 (last merge round=17)
[S17] round=18 local utility u=0.000000 metrics={'f1_val': 0.37099206566786835, 'auprc': 0.6782285034321313, 'loss_val': 0.8708601452243538, 'psi': 0.4938866407735735}-{'f1_val': 0.38730360941578656, 'auprc': 0.7031222056905546, 'loss_val': 0.7787578848238614, 'psi': 0.5136310479256938}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:61010
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:61009
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S7@127.0.0.1:61008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] → sending delta(kind=head bytes=1793) to S17@127.0.0.1:61017
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:61012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:61015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:61014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:61009
[S8] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1793 to 1 peers)
[S13] sending update (kind=head size=1794 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1801) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.037580)
[S15] loaded HEAD from S8 (vec_in norm=1.037580)
[S15] cosine check vs S8: cos=0.8945
[S15] BUFFERED delta from S8 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1797) from S3
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.759453)
[S11] loaded HEAD from S3 (vec_in norm=1.759453)
[S11] cosine check vs S3: cos=0.9075
[S11] BUFFERED delta from S3 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1793) from S7
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.075026)
[S17] loaded HEAD from S7 (vec_in norm=1.075026)
[S17] cosine check vs S7: cos=0.6025
[S17] BUFFERED delta from S7 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1798) from S15
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.139297)
[S9] loaded HEAD from S15 (vec_in norm=1.139297)
[S9] cosine check vs S15: cos=0.9596
[S9] BUFFERED delta from S15 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1799) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.606058)
[S14] loaded HEAD from S10 (vec_in norm=1.606058)
[S14] cosine check vs S10: cos=0.9970
[S14] BUFFERED delta from S10 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1797) from S2
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.799947)
[S8] loaded HEAD from S2 (vec_in norm=1.799947)
[S8] cosine check vs S2: cos=0.6898
[S8] BUFFERED delta from S2 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1799) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.586889)
[S8] loaded HEAD from S14 (vec_in norm=1.586889)
[S8] cosine check vs S14: cos=-0.1515
[S8] DROPPED delta from S14 (cos=-0.1515 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1794) from S13
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=0.946649)
[S7] loaded HEAD from S13 (vec_in norm=0.946649)
[S7] cosine check vs S13: cos=0.8717
[S7] BUFFERED delta from S13 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=18 metric=0.9934 head_norm=1.199466
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.688489e-01
[S9] stored merged vector for next round verification (round=18)
[S9] DEBUG after merge:  round=18 metric=0.9934 head_norm=1.157519 delta_norm=0.168849
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=18 metric=0.7022 head_norm=1.287450
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.005507e-01
[S11] stored merged vector for next round verification (round=18)
[S11] DEBUG after merge:  round=18 metric=0.7022 head_norm=1.488677 delta_norm=0.400551
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=18 metric=0.8750 head_norm=1.139297
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.548553e-01
[S15] stored merged vector for next round verification (round=18)
[S15] DEBUG after merge:  round=18 metric=0.8832 head_norm=1.059403 delta_norm=0.254855
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=18 metric=0.6279 head_norm=1.075026
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.634750e-01
[S7] stored merged vector for next round verification (round=18)
[S7] DEBUG after merge:  round=18 metric=0.6190 head_norm=0.978004 delta_norm=0.263475
[S7] aggregate: ROLLBACK (f1_val pre=0.628 post=0.619 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=18 metric=0.9977 head_norm=1.586889
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.284648e-02
[S14] stored merged vector for next round verification (round=18)
[S14] DEBUG after merge:  round=18 metric=0.9977 head_norm=1.595265 delta_norm=0.062846
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=18 metric=0.7045 head_norm=1.037580
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.595505e-01
[S8] stored merged vector for next round verification (round=18)
[S8] DEBUG after merge:  round=18 metric=0.7465 head_norm=1.312701 delta_norm=0.659550
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=18 metric=0.3710 head_norm=0.953311
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.553879e-01
[S17] stored merged vector for next round verification (round=18)
[S17] DEBUG after merge:  round=18 metric=0.3558 head_norm=0.908220 delta_norm=0.455388
[S17] aggregate: ROLLBACK (f1_val pre=0.371 post=0.356 tol_abs=0.005 tol_rel=0.0)
[S2] START round=19 head_norm_before_train=1.799947 (no previous merge yet)
[S2] round=19 local utility u=0.066315 metrics={'f1_val': 0.7009520084040268, 'auprc': 0.7738165579478529, 'loss_val': 0.28180902421092263, 'psi': 0.7300978282215572}-{'f1_val': 0.7002298375331623, 'auprc': 0.7299767601609919, 'loss_val': 0.2785857910542068, 'psi': 0.7121286065842941}
[S3] START round=19 head_norm_before_train=1.759453 cos_to_last_merge=0.8204 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.820
[S3] round=19 local utility u=0.000000 metrics={'f1_val': 0.9606109340814555, 'auprc': 0.9981410701604339, 'loss_val': 0.12225440595085356, 'psi': 0.9756229885130467}-{'f1_val': 0.9864458943787179, 'auprc': 0.9991463236735727, 'loss_val': 0.06121426328632286, 'psi': 0.9915260660966598}
[S4] START round=19 head_norm_before_train=1.767440 (no previous merge yet)
[S4] round=19 local utility u=0.001838 metrics={'f1_val': 0.6153215972899125, 'auprc': 0.9534847244039342, 'loss_val': 0.4720329188671377, 'psi': 0.7505868481355211}-{'f1_val': 0.6157914242213955, 'auprc': 0.9474557805951417, 'loss_val': 0.4604407551666664, 'psi': 0.7484571667708939}
[S5] START round=19 head_norm_before_train=1.575743 cos_to_last_merge=0.8186 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.819
[S5] round=19 local utility u=1.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9897492670400327, 'loss_val': 0.2469749541537492, 'psi': 0.8160920659108285}-{'f1_val': 0.42893341996485795, 'auprc': 0.8618844419509595, 'loss_val': 0.8370708352397714, 'psi': 0.6021138287592986}
[S6] START round=19 head_norm_before_train=1.712404 (no previous merge yet)
[S6] round=19 local utility u=1.000000 metrics={'f1_val': 0.962520185890285, 'auprc': 0.9569202558516507, 'loss_val': 0.21001259845316583, 'psi': 0.9602802138748312}-{'f1_val': 0.4355471050867187, 'auprc': 0.8284729702810146, 'loss_val': 0.7330053926620087, 'psi': 0.5927174511644371}
[S7] START round=19 head_norm_before_train=0.978004 cos_to_last_merge=1.0000 (last merge round=18)
[S7] round=19 local utility u=0.000000 metrics={'f1_val': 0.4756318318930972, 'auprc': 0.722976722146196, 'loss_val': 0.9699369702320826, 'psi': 0.5745697879943368}-{'f1_val': 0.6279135900048383, 'auprc': 0.7994743281539918, 'loss_val': 0.6409152602698213, 'psi': 0.6965378852644997}
[S8] START round=19 head_norm_before_train=1.312701 cos_to_last_merge=1.0000 (last merge round=18)
[S8] round=19 local utility u=0.004881 metrics={'f1_val': 0.7140186993020905, 'auprc': 0.990208091192853, 'loss_val': 0.41320198128987146, 'psi': 0.8244944560583956}-{'f1_val': 0.7045315898550348, 'auprc': 0.9933013064829408, 'loss_val': 0.3753211556763281, 'psi': 0.8200394765061972}
[S9] START round=19 head_norm_before_train=1.157519 cos_to_last_merge=1.0000 (last merge round=18)
[S9] round=19 local utility u=0.009973 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9970127879682773, 'loss_val': 0.09937216601370742, 'psi': 0.9965551720548775}-{'f1_val': 0.9933610760940638, 'auprc': 0.9972440062765172, 'loss_val': 0.1026775170354051, 'psi': 0.9949142481670451}
[S10] START round=19 head_norm_before_train=1.606058 cos_to_last_merge=0.8548 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.855
[S10] round=19 local utility u=0.002964 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9943581781553152, 'loss_val': 0.0812362510341383, 'psi': 0.9951090633711379}-{'f1_val': 0.9939487387271932, 'auprc': 0.9975239689265033, 'loss_val': 0.08669532312787467, 'psi': 0.9953788308069172}
[S11] START round=19 head_norm_before_train=1.488677 cos_to_last_merge=1.0000 (last merge round=18)
[S11] round=19 local utility u=0.000000 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9069791161143976, 'loss_val': 0.40038247506493324, 'psi': 0.7838077341979139}-{'f1_val': 0.7021770286274283, 'auprc': 0.907070876069767, 'loss_val': 0.39753007368706034, 'psi': 0.7841345676043638}
[S13] START round=19 head_norm_before_train=0.946649 cos_to_last_merge=0.9968 (last merge round=17)
[S13] round=19 local utility u=0.000000 metrics={'f1_val': 0.6251783665890877, 'auprc': 0.6827767347586846, 'loss_val': 0.6744929907832053, 'psi': 0.6482177138569265}-{'f1_val': 0.6781304491465163, 'auprc': 0.6740517354088812, 'loss_val': 0.5898284720823861, 'psi': 0.6764989636514622}
[S14] START round=19 head_norm_before_train=1.595265 cos_to_last_merge=1.0000 (last merge round=18)
[S14] round=19 local utility u=0.008646 metrics={'f1_val': 0.9978965638266506, 'auprc': 0.9987036247010962, 'loss_val': 0.11923785513685595, 'psi': 0.9982193881764287}-{'f1_val': 0.9977165309073976, 'auprc': 0.9992305019112867, 'loss_val': 0.13703076522482785, 'psi': 0.9983221193089533}
[S15] START round=19 head_norm_before_train=1.059403 cos_to_last_merge=1.0000 (last merge round=18)
[S15] round=19 local utility u=0.000000 metrics={'f1_val': 0.8717703669084074, 'auprc': 0.9893478471676701, 'loss_val': 0.31898779680295375, 'psi': 0.9188013590121125}-{'f1_val': 0.8750326193536614, 'auprc': 0.97592877920765, 'loss_val': 0.2833787621710207, 'psi': 0.9153910832952568}
[S16] START round=19 head_norm_before_train=1.768656 (no previous merge yet)
[S16] round=19 local utility u=0.586987 metrics={'f1_val': 0.9255061502557815, 'auprc': 0.9948676346860494, 'loss_val': 0.26286470506542603, 'psi': 0.9532507440278888}-{'f1_val': 0.8446851892691194, 'auprc': 0.900435194336175, 'loss_val': 0.6686148069226798, 'psi': 0.8669851912959416}
[S17] START round=19 head_norm_before_train=0.908220 cos_to_last_merge=1.0000 (last merge round=18)
[S17] round=19 local utility u=0.000000 metrics={'f1_val': 0.38346015387121546, 'auprc': 0.6562894220359516, 'loss_val': 0.9215004430749043, 'psi': 0.49259186113710995}-{'f1_val': 0.37099206566786835, 'auprc': 0.6782285034321313, 'loss_val': 0.8708601452243538, 'psi': 0.4938866407735735}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:61008
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.730)
[S8] not sending this round → trigger blocked (psi=0.824)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:61012
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.995)
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:61009
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1804 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1795) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.222102)
[S17] loaded HEAD from S9 (vec_in norm=1.222102)
[S17] cosine check vs S9: cos=0.4644
[S17] BUFFERED delta from S9 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1800) from S4
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.779405)
[S8] loaded HEAD from S4 (vec_in norm=1.779405)
[S8] cosine check vs S4: cos=0.0166
[S8] BUFFERED delta from S4 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1804) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.795104)
[S7] loaded HEAD from S16 (vec_in norm=1.795104)
[S7] cosine check vs S16: cos=-0.0650
[S7] DROPPED delta from S16 (cos=-0.0650 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1801) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.722735)
[S17] loaded HEAD from S6 (vec_in norm=1.722735)
[S17] cosine check vs S6: cos=0.4635
[S17] BUFFERED delta from S6 (total buffered=2)
[S11] RECEIVED delta(kind=head bytes=1796) from S5
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.593925)
[S11] loaded HEAD from S5 (vec_in norm=1.593925)
[S11] cosine check vs S5: cos=0.1410
[S11] BUFFERED delta from S5 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] r=20 psi=0.575 u=0.0000 p_local=0.1645 f1=0.476 auprc=0.723 bytes=17962
[S14] r=20 psi=0.998 u=0.0086 p_local=0.0953 f1=0.998 auprc=0.999 bytes=28750
[S2] r=20 psi=0.730 u=0.0663 p_local=0.0721 f1=0.701 auprc=0.774 bytes=17969
[S3] r=20 psi=0.976 u=0.0000 p_local=0.1588 f1=0.961 auprc=0.998 bytes=21580
[S10] r=20 psi=0.995 u=0.0030 p_local=0.1380 f1=0.996 auprc=0.994 bytes=26969
[S13] r=20 psi=0.648 u=0.0000 p_local=0.1183 f1=0.625 auprc=0.683 bytes=16161
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=19 metric=0.7140 head_norm=1.345312
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.106399e+00
[S8] stored merged vector for next round verification (round=19)
[S8] DEBUG after merge:  round=19 metric=0.7140 head_norm=1.124257 delta_norm=1.106399
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S8] r=20 psi=0.824 u=0.0049 p_local=0.1818 f1=0.714 auprc=0.990 bytes=19742
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=19 metric=0.7017 head_norm=1.510284
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.017686e+00
[S11] stored merged vector for next round verification (round=19)
[S11] DEBUG after merge:  round=19 metric=0.7016 head_norm=1.172643 delta_norm=1.017686
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S11] r=20 psi=0.784 u=0.0000 p_local=0.0668 f1=0.702 auprc=0.907 bytes=23355
[S9] r=20 psi=0.997 u=0.0100 p_local=0.0619 f1=0.996 auprc=0.997 bytes=23349
[S6] r=20 psi=0.960 u=1.0000 p_local=0.4472 f1=0.963 auprc=0.957 bytes=26992
[S5] r=20 psi=0.816 u=1.0000 p_local=0.2547 f1=0.700 auprc=0.990 bytes=25198
[S16] r=20 psi=0.953 u=0.5870 p_local=0.2904 f1=0.926 auprc=0.995 bytes=25158
[S4] r=20 psi=0.751 u=0.0018 p_local=0.0865 f1=0.615 auprc=0.953 bytes=23396
[S15] r=20 psi=0.919 u=0.0000 p_local=0.2481 f1=0.872 auprc=0.989 bytes=25121
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=19 metric=0.3835 head_norm=0.943029
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.060020e-01
[S17] stored merged vector for next round verification (round=19)
[S17] DEBUG after merge:  round=19 metric=0.3702 head_norm=0.899409 delta_norm=0.406002
[S17] aggregate: ROLLBACK (f1_val pre=0.383 post=0.370 tol_abs=0.005 tol_rel=0.0)
[S17] r=20 psi=0.493 u=0.0000 p_local=0.0910 f1=0.383 auprc=0.656 bytes=19765
[S2] START round=20 head_norm_before_train=1.815438 (no previous merge yet)
[S2] round=20 local utility u=0.000000 metrics={'f1_val': 0.7014842933119017, 'auprc': 0.6715815424255592, 'loss_val': 0.3166386906349971, 'psi': 0.6895231929573646}-{'f1_val': 0.7009520084040268, 'auprc': 0.7738165579478529, 'loss_val': 0.28180902421092263, 'psi': 0.7300978282215572}
[S3] START round=20 head_norm_before_train=1.789414 cos_to_last_merge=0.8164 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.816
[S3] round=20 local utility u=0.000000 metrics={'f1_val': 0.880006646087308, 'auprc': 0.9855820545060441, 'loss_val': 0.2771041188819973, 'psi': 0.9222368094548024}-{'f1_val': 0.9606109340814555, 'auprc': 0.9981410701604339, 'loss_val': 0.12225440595085356, 'psi': 0.9756229885130467}
[S4] START round=20 head_norm_before_train=1.779405 (no previous merge yet)
[S4] round=20 local utility u=0.020140 metrics={'f1_val': 0.6181541178640092, 'auprc': 0.9540787225169207, 'loss_val': 0.45053092537747796, 'psi': 0.7525239597251738}-{'f1_val': 0.6153215972899125, 'auprc': 0.9534847244039342, 'loss_val': 0.4720329188671377, 'psi': 0.7505868481355211}
[S5] START round=20 head_norm_before_train=1.593925 cos_to_last_merge=0.8161 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.816
[S5] round=20 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9897491391584168, 'loss_val': 0.28333621383192575, 'psi': 0.816092014758182}-{'f1_val': 0.700320598491359, 'auprc': 0.9897492670400327, 'loss_val': 0.2469749541537492, 'psi': 0.8160920659108285}
[S6] START round=20 head_norm_before_train=1.722735 (no previous merge yet)
[S6] round=20 local utility u=0.000000 metrics={'f1_val': 0.7125866395888688, 'auprc': 0.939561270360133, 'loss_val': 0.5520373597401239, 'psi': 0.8033764918973745}-{'f1_val': 0.962520185890285, 'auprc': 0.9569202558516507, 'loss_val': 0.21001259845316583, 'psi': 0.9602802138748312}
[S7] START round=20 head_norm_before_train=1.026707 cos_to_last_merge=0.9974 (last merge round=18)
[S7] round=20 local utility u=0.557572 metrics={'f1_val': 0.5849238882716407, 'auprc': 0.7886712639371662, 'loss_val': 0.7076292567620195, 'psi': 0.6664228385378509}-{'f1_val': 0.4756318318930972, 'auprc': 0.722976722146196, 'loss_val': 0.9699369702320826, 'psi': 0.5745697879943368}
[S8] START round=20 head_norm_before_train=1.124257 cos_to_last_merge=1.0000 (last merge round=19)
[S8] round=20 local utility u=0.860907 metrics={'f1_val': 0.9967901605898053, 'auprc': 0.9976547887787698, 'loss_val': 0.4103576805162167, 'psi': 0.9971360118653911}-{'f1_val': 0.7140186993020905, 'auprc': 0.990208091192853, 'loss_val': 0.41320198128987146, 'psi': 0.8244944560583956}
[S9] START round=20 head_norm_before_train=1.222102 cos_to_last_merge=0.9978 (last merge round=18)
[S9] round=20 local utility u=0.000484 metrics={'f1_val': 0.9929348022347503, 'auprc': 0.9970492301034782, 'loss_val': 0.07862091285756476, 'psi': 0.9945805733822415}-{'f1_val': 0.9962500947792776, 'auprc': 0.9970127879682773, 'loss_val': 0.09937216601370742, 'psi': 0.9965551720548775}
[S10] START round=20 head_norm_before_train=1.638006 cos_to_last_merge=0.8526 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.853
[S10] round=20 local utility u=0.006122 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9940723800313208, 'loss_val': 0.06813454031535565, 'psi': 0.9949947441215402}-{'f1_val': 0.9956096535150197, 'auprc': 0.9943581781553152, 'loss_val': 0.0812362510341383, 'psi': 0.9951090633711379}
[S11] START round=20 head_norm_before_train=1.172643 cos_to_last_merge=1.0000 (last merge round=19)
[S11] round=20 local utility u=0.043176 metrics={'f1_val': 0.7018701185892477, 'auprc': 0.9130353142514867, 'loss_val': 0.3332587329407447, 'psi': 0.7863361968541434}-{'f1_val': 0.7016934795869249, 'auprc': 0.9069791161143976, 'loss_val': 0.40038247506493324, 'psi': 0.7838077341979139}
[S13] START round=20 head_norm_before_train=0.993217 cos_to_last_merge=0.9891 (last merge round=17)
[S13] round=20 local utility u=0.118391 metrics={'f1_val': 0.6505708441745692, 'auprc': 0.6722832690684264, 'loss_val': 0.558585566663891, 'psi': 0.6592558141321121}-{'f1_val': 0.6251783665890877, 'auprc': 0.6827767347586846, 'loss_val': 0.6744929907832053, 'psi': 0.6482177138569265}
[S14] START round=20 head_norm_before_train=1.623084 cos_to_last_merge=0.9996 (last merge round=18)
[S14] round=20 local utility u=0.010546 metrics={'f1_val': 0.9974331919232962, 'auprc': 0.999113933690806, 'loss_val': 0.09659578275339785, 'psi': 0.9981054886303001}-{'f1_val': 0.9978965638266506, 'auprc': 0.9987036247010962, 'loss_val': 0.11923785513685595, 'psi': 0.9982193881764287}
[S15] START round=20 head_norm_before_train=1.104545 cos_to_last_merge=0.9986 (last merge round=18)
[S15] round=20 local utility u=0.000000 metrics={'f1_val': 0.6944804177399412, 'auprc': 0.8802378496653429, 'loss_val': 0.43796923617148004, 'psi': 0.7687833905101018}-{'f1_val': 0.8717703669084074, 'auprc': 0.9893478471676701, 'loss_val': 0.31898779680295375, 'psi': 0.9188013590121125}
[S16] START round=20 head_norm_before_train=1.795104 (no previous merge yet)
[S16] round=20 local utility u=0.088996 metrics={'f1_val': 0.9413753985333227, 'auprc': 0.9927358820242111, 'loss_val': 0.17369381218115557, 'psi': 0.9619195919296781}-{'f1_val': 0.9255061502557815, 'auprc': 0.9948676346860494, 'loss_val': 0.26286470506542603, 'psi': 0.9532507440278888}
[S17] START round=20 head_norm_before_train=0.899409 cos_to_last_merge=1.0000 (last merge round=19)
[S17] round=20 local utility u=0.211742 metrics={'f1_val': 0.3788192716007831, 'auprc': 0.7749726032444869, 'loss_val': 0.8262216107133965, 'psi': 0.5372806042582646}-{'f1_val': 0.38346015387121546, 'auprc': 0.6562894220359516, 'loss_val': 0.9215004430749043, 'psi': 0.49259186113710995}
[S9] not sending this round → trigger blocked (psi=0.995)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:61009
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:61008
[S16] not sending this round → trigger blocked (psi=0.962)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:61009
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.753)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:61015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:61014
[S8] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1804 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1796) from S13
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.042363)
[S7] loaded HEAD from S13 (vec_in norm=1.042363)
[S7] cosine check vs S13: cos=0.9498
[S7] BUFFERED delta from S13 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1795) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.152109)
[S15] loaded HEAD from S8 (vec_in norm=1.152109)
[S15] cosine check vs S8: cos=0.4717
[S15] BUFFERED delta from S8 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1802) from S7
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.066658)
[S17] loaded HEAD from S7 (vec_in norm=1.066658)
[S17] cosine check vs S7: cos=0.7809
[S17] BUFFERED delta from S7 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1796) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.666720)
[S14] loaded HEAD from S10 (vec_in norm=1.666720)
[S14] cosine check vs S10: cos=0.9948
[S14] BUFFERED delta from S10 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1804) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.652582)
[S8] loaded HEAD from S14 (vec_in norm=1.652582)
[S8] cosine check vs S14: cos=-0.0838
[S8] DROPPED delta from S14 (cos=-0.0838 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1796) from S11
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.210718)
[S8] loaded HEAD from S11 (vec_in norm=1.210718)
[S8] cosine check vs S11: cos=0.1232
[S8] BUFFERED delta from S11 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:61013
[S17] sending update (kind=head size=1801 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1801) from S17
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.931179)
[S13] loaded HEAD from S17 (vec_in norm=0.931179)
[S13] cosine check vs S17: cos=0.8705
[S13] BUFFERED delta from S17 (total buffered=1)
[S9] ⇄ pheromone p=0.050 → S17@127.0.0.1:61017
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=20 metric=0.6945 head_norm=1.145305
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.904101e-01
[S15] stored merged vector for next round verification (round=20)
[S15] DEBUG after merge:  round=20 metric=0.6948 head_norm=0.985371 delta_norm=0.590410
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.199 → S9@127.0.0.1:61010
[S2] ⇄ pheromone p=0.058 → S8@127.0.0.1:61009
[S4] ⇄ pheromone p=0.073 → S8@127.0.0.1:61009
[S3] ⇄ pheromone p=0.127 → S11@127.0.0.1:61012
[S5] ⇄ pheromone p=0.204 → S11@127.0.0.1:61012
[S6] ⇄ pheromone p=0.358 → S17@127.0.0.1:61017
[S11] ⇄ pheromone p=0.062 → S8@127.0.0.1:61009
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=20 metric=0.6506 head_norm=1.042363
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.567582e-01
[S13] stored merged vector for next round verification (round=20)
[S13] DEBUG after merge:  round=20 metric=0.6550 head_norm=0.954402 delta_norm=0.256758
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.118 → S7@127.0.0.1:61008
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=20 metric=0.5849 head_norm=1.066658
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.674605e-01
[S7] stored merged vector for next round verification (round=20)
[S7] DEBUG after merge:  round=20 metric=0.5847 head_norm=1.041200 delta_norm=0.167461
[S7] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.243 → S17@127.0.0.1:61017
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=20 metric=0.9974 head_norm=1.652582
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.508959e-02
[S14] stored merged vector for next round verification (round=20)
[S14] DEBUG after merge:  round=20 metric=0.9974 head_norm=1.657484 delta_norm=0.085090
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.078 → S8@127.0.0.1:61009
[S10] ⇄ pheromone p=0.112 → S14@127.0.0.1:61014
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=20 metric=0.9968 head_norm=1.152109
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.825643e-01
[S8] stored merged vector for next round verification (round=20)
[S8] DEBUG after merge:  round=20 metric=0.9952 head_norm=0.885545 delta_norm=0.782564
[S8] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.318 → S15@127.0.0.1:61015
[S16] ⇄ pheromone p=0.250 → S7@127.0.0.1:61008
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=20 metric=0.3788 head_norm=0.931179
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.367600e-01
[S17] stored merged vector for next round verification (round=20)
[S17] DEBUG after merge:  round=20 metric=0.4644 head_norm=0.942878 delta_norm=0.336760
[S17] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.115 → S13@127.0.0.1:61013
[S2] START round=21 head_norm_before_train=1.829940 (no previous merge yet)
[S2] round=21 local utility u=0.094531 metrics={'f1_val': 0.708893784000131, 'auprc': 0.7364406137072109, 'loss_val': 0.3666109975466574, 'psi': 0.7199125158829629}-{'f1_val': 0.7014842933119017, 'auprc': 0.6715815424255592, 'loss_val': 0.3166386906349971, 'psi': 0.6895231929573646}
[S3] START round=21 head_norm_before_train=1.816235 cos_to_last_merge=0.8125 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.813
[S3] round=21 local utility u=0.213085 metrics={'f1_val': 0.9394440256415566, 'auprc': 0.9874242928188524, 'loss_val': 0.21308580005319352, 'psi': 0.9586361325124748}-{'f1_val': 0.880006646087308, 'auprc': 0.9855820545060441, 'loss_val': 0.2771041188819973, 'psi': 0.9222368094548024}
[S4] START round=21 head_norm_before_train=1.791484 (no previous merge yet)
[S4] round=21 local utility u=0.994218 metrics={'f1_val': 0.9446931651472703, 'auprc': 0.9550792594482442, 'loss_val': 0.4243299644620976, 'psi': 0.9488476028676599}-{'f1_val': 0.6181541178640092, 'auprc': 0.9540787225169207, 'loss_val': 0.45053092537747796, 'psi': 0.7525239597251738}
[S5] START round=21 head_norm_before_train=1.610248 cos_to_last_merge=0.8151 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.815
[S5] round=21 local utility u=0.045311 metrics={'f1_val': 0.700320598491359, 'auprc': 0.993123209073351, 'loss_val': 0.20283693012989087, 'psi': 0.8174416427241558}-{'f1_val': 0.700320598491359, 'auprc': 0.9897491391584168, 'loss_val': 0.28333621383192575, 'psi': 0.816092014758182}
[S6] START round=21 head_norm_before_train=1.733680 (no previous merge yet)
[S6] round=21 local utility u=0.190307 metrics={'f1_val': 0.764425839735254, 'auprc': 0.9418441652203361, 'loss_val': 0.48930653777336414, 'psi': 0.8353931699292869}-{'f1_val': 0.7125866395888688, 'auprc': 0.939561270360133, 'loss_val': 0.5520373597401239, 'psi': 0.8033764918973745}
[S7] START round=21 head_norm_before_train=1.041200 cos_to_last_merge=1.0000 (last merge round=20)
[S7] round=21 local utility u=0.051264 metrics={'f1_val': 0.6012528983670966, 'auprc': 0.7885635089818446, 'loss_val': 0.7027524923998818, 'psi': 0.6761771426129959}-{'f1_val': 0.5849238882716407, 'auprc': 0.7886712639371662, 'loss_val': 0.7076292567620195, 'psi': 0.6664228385378509}
[S8] START round=21 head_norm_before_train=0.885545 cos_to_last_merge=1.0000 (last merge round=20)
[S8] round=21 local utility u=0.000000 metrics={'f1_val': 0.7140846175387339, 'auprc': 0.9889693228663878, 'loss_val': 0.42833044266854564, 'psi': 0.8240384996697955}-{'f1_val': 0.9967901605898053, 'auprc': 0.9976547887787698, 'loss_val': 0.4103576805162167, 'psi': 0.9971360118653911}
[S9] START round=21 head_norm_before_train=1.284760 cos_to_last_merge=0.9929 (last merge round=18)
[S9] round=21 local utility u=0.000000 metrics={'f1_val': 0.8655276422426355, 'auprc': 0.9625226553551083, 'loss_val': 0.32476136885862306, 'psi': 0.9043256474876246}-{'f1_val': 0.9929348022347503, 'auprc': 0.9970492301034782, 'loss_val': 0.07862091285756476, 'psi': 0.9945805733822415}
[S10] START round=21 head_norm_before_train=1.666720 cos_to_last_merge=0.8507 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.851
[S10] round=21 local utility u=0.007028 metrics={'f1_val': 0.9937298155689185, 'auprc': 0.9975990300244735, 'loss_val': 0.05337990336461903, 'psi': 0.9952775013511405}-{'f1_val': 0.9956096535150197, 'auprc': 0.9940723800313208, 'loss_val': 0.06813454031535565, 'psi': 0.9949947441215402}
[S11] START round=21 head_norm_before_train=1.210718 cos_to_last_merge=0.9990 (last merge round=19)
[S11] round=21 local utility u=0.057307 metrics={'f1_val': 0.7018701185892477, 'auprc': 0.9436743675993324, 'loss_val': 0.31056192852306413, 'psi': 0.7985918181932816}-{'f1_val': 0.7018701185892477, 'auprc': 0.9130353142514867, 'loss_val': 0.3332587329407447, 'psi': 0.7863361968541434}
[S13] START round=21 head_norm_before_train=0.954402 cos_to_last_merge=1.0000 (last merge round=20)
[S13] round=21 local utility u=0.000000 metrics={'f1_val': 0.6311108288497157, 'auprc': 0.6787057582940113, 'loss_val': 0.6442348803382856, 'psi': 0.650148800627434}-{'f1_val': 0.6505708441745692, 'auprc': 0.6722832690684264, 'loss_val': 0.558585566663891, 'psi': 0.6592558141321121}
[S14] START round=21 head_norm_before_train=1.657484 cos_to_last_merge=1.0000 (last merge round=20)
[S14] round=21 local utility u=0.002658 metrics={'f1_val': 0.9976420785595723, 'auprc': 0.998931288617112, 'loss_val': 0.0919848008441815, 'psi': 0.9981577625825881}-{'f1_val': 0.9974331919232962, 'auprc': 0.999113933690806, 'loss_val': 0.09659578275339785, 'psi': 0.9981054886303001}
[S15] START round=21 head_norm_before_train=0.985371 cos_to_last_merge=1.0000 (last merge round=20)
[S15] round=21 local utility u=0.803472 metrics={'f1_val': 0.8974045914970339, 'auprc': 0.9775719987367094, 'loss_val': 0.34057357266373733, 'psi': 0.9294715543929042}-{'f1_val': 0.6944804177399412, 'auprc': 0.8802378496653429, 'loss_val': 0.43796923617148004, 'psi': 0.7687833905101018}
[S16] START round=21 head_norm_before_train=1.821949 (no previous merge yet)
[S16] round=21 local utility u=0.000000 metrics={'f1_val': 0.8936035294368525, 'auprc': 0.9894791147478476, 'loss_val': 0.3897641809602671, 'psi': 0.9319537635612506}-{'f1_val': 0.9413753985333227, 'auprc': 0.9927358820242111, 'loss_val': 0.17369381218115557, 'psi': 0.9619195919296781}
[S17] START round=21 head_norm_before_train=0.942878 cos_to_last_merge=1.0000 (last merge round=20)
[S17] round=21 local utility u=0.483874 metrics={'f1_val': 0.49056490542908004, 'auprc': 0.8301195020179114, 'loss_val': 0.6943871816795391, 'psi': 0.6263867440646126}-{'f1_val': 0.3788192716007831, 'auprc': 0.7749726032444869, 'loss_val': 0.8262216107133965, 'psi': 0.5372806042582646}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:61009
[S7] not sending this round → trigger blocked (psi=0.676)
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] not sending this round → trigger blocked (psi=0.799)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S3] → sending delta(kind=head bytes=1790) to S11@127.0.0.1:61012
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:61009
[S14] not sending this round → trigger blocked (psi=0.998)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:61012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:61010
[S15] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1790 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1790) from S3
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.845779)
[S11] loaded HEAD from S3 (vec_in norm=1.845779)
[S11] cosine check vs S3: cos=0.5872
[S11] BUFFERED delta from S3 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1800) from S15
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.019773)
[S9] loaded HEAD from S15 (vec_in norm=1.019773)
[S9] cosine check vs S15: cos=0.8043
[S9] BUFFERED delta from S15 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1799) from S5
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.626607)
[S11] loaded HEAD from S5 (vec_in norm=1.626607)
[S11] cosine check vs S5: cos=0.7701
[S11] BUFFERED delta from S5 (total buffered=2)
[S8] RECEIVED delta(kind=head bytes=1800) from S2
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.841953)
[S8] loaded HEAD from S2 (vec_in norm=1.841953)
[S8] cosine check vs S2: cos=0.3638
[S8] BUFFERED delta from S2 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1802) from S4
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.805446)
[S8] loaded HEAD from S4 (vec_in norm=1.805446)
[S8] cosine check vs S4: cos=0.4706
[S8] BUFFERED delta from S4 (total buffered=2)
[S17] RECEIVED delta(kind=head bytes=1803) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.745191)
[S17] loaded HEAD from S6 (vec_in norm=1.745191)
[S17] cosine check vs S6: cos=0.4966
[S17] BUFFERED delta from S6 (total buffered=1)
[S17] not sending this round → trigger blocked (psi=0.626)
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=21 metric=0.7141 head_norm=0.930190
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.382950e-01
[S8] stored merged vector for next round verification (round=21)
[S8] DEBUG after merge:  round=21 metric=0.8492 head_norm=0.998289 delta_norm=0.538295
[S8] aggregate: ACCEPT kept=['S2', 'S4'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=21 metric=0.7019 head_norm=1.240463
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.474420e-01
[S11] stored merged vector for next round verification (round=21)
[S11] DEBUG after merge:  round=21 metric=0.7019 head_norm=1.212791 delta_norm=0.147442
[S11] aggregate: ACCEPT kept=['S3', 'S5'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=21 metric=0.8655 head_norm=1.325106
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.943770e-01
[S9] stored merged vector for next round verification (round=21)
[S9] DEBUG after merge:  round=21 metric=0.8830 head_norm=1.114625 delta_norm=0.394377
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=21 metric=0.4906 head_norm=0.980441
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.595079e-01
[S17] stored merged vector for next round verification (round=21)
[S17] DEBUG after merge:  round=21 metric=0.3796 head_norm=1.194414 delta_norm=0.759508
[S17] aggregate: ROLLBACK (f1_val pre=0.491 post=0.380 tol_abs=0.005 tol_rel=0.0)
[S2] START round=22 head_norm_before_train=1.841953 (no previous merge yet)
[S2] round=22 local utility u=0.064266 metrics={'f1_val': 0.7088264685305906, 'auprc': 0.7603722884733025, 'loss_val': 0.309469755317478, 'psi': 0.7294447965076754}-{'f1_val': 0.708893784000131, 'auprc': 0.7364406137072109, 'loss_val': 0.3666109975466574, 'psi': 0.7199125158829629}
[S3] START round=22 head_norm_before_train=1.845779 cos_to_last_merge=0.8086 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.809
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.9031517260472267, 'auprc': 0.9644496174158862, 'loss_val': 0.31879631720186263, 'psi': 0.9276708825946904}-{'f1_val': 0.9394440256415566, 'auprc': 0.9874242928188524, 'loss_val': 0.21308580005319352, 'psi': 0.9586361325124748}
[S4] START round=22 head_norm_before_train=1.805446 (no previous merge yet)
[S4] round=22 local utility u=0.030070 metrics={'f1_val': 0.9475011497897732, 'auprc': 0.959965092871641, 'loss_val': 0.3956945239273057, 'psi': 0.9524867270225204}-{'f1_val': 0.9446931651472703, 'auprc': 0.9550792594482442, 'loss_val': 0.4243299644620976, 'psi': 0.9488476028676599}
[S5] START round=22 head_norm_before_train=1.626607 cos_to_last_merge=0.8137 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.814
[S5] round=22 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9769429037678358, 'loss_val': 0.2889704423755733, 'psi': 0.8109695206019497}-{'f1_val': 0.700320598491359, 'auprc': 0.993123209073351, 'loss_val': 0.20283693012989087, 'psi': 0.8174416427241558}
[S6] START round=22 head_norm_before_train=1.745191 (no previous merge yet)
[S6] round=22 local utility u=0.191423 metrics={'f1_val': 0.8126290327828398, 'auprc': 0.9434385204220674, 'loss_val': 0.40046325015242923, 'psi': 0.8649528278385308}-{'f1_val': 0.764425839735254, 'auprc': 0.9418441652203361, 'loss_val': 0.48930653777336414, 'psi': 0.8353931699292869}
[S7] START round=22 head_norm_before_train=1.088229 cos_to_last_merge=0.9981 (last merge round=20)
[S7] round=22 local utility u=0.000000 metrics={'f1_val': 0.5079641050693299, 'auprc': 0.7787533076413392, 'loss_val': 0.9136426762733866, 'psi': 0.6162797860981336}-{'f1_val': 0.6012528983670966, 'auprc': 0.7885635089818446, 'loss_val': 0.7027524923998818, 'psi': 0.6761771426129959}
[S8] START round=22 head_norm_before_train=0.998289 cos_to_last_merge=1.0000 (last merge round=21)
[S8] round=22 local utility u=0.895147 metrics={'f1_val': 0.994385927007507, 'auprc': 0.9934419564373402, 'loss_val': 0.3332622707681003, 'psi': 0.9940083387794404}-{'f1_val': 0.7140846175387339, 'auprc': 0.9889693228663878, 'loss_val': 0.42833044266854564, 'psi': 0.8240384996697955}
[S9] START round=22 head_norm_before_train=1.114625 cos_to_last_merge=1.0000 (last merge round=21)
[S9] round=22 local utility u=0.553353 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9989586992781145, 'loss_val': 0.11681431079298013, 'psi': 0.9978452272185315}-{'f1_val': 0.8655276422426355, 'auprc': 0.9625226553551083, 'loss_val': 0.32476136885862306, 'psi': 0.9043256474876246}
[S10] START round=22 head_norm_before_train=1.696086 cos_to_last_merge=0.8488 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.849
[S10] round=22 local utility u=0.002147 metrics={'f1_val': 0.9937298155689185, 'auprc': 0.9976002563766743, 'loss_val': 0.0490885825807803, 'psi': 0.9952779918920207}-{'f1_val': 0.9937298155689185, 'auprc': 0.9975990300244735, 'loss_val': 0.05337990336461903, 'psi': 0.9952775013511405}
[S11] START round=22 head_norm_before_train=1.212791 cos_to_last_merge=1.0000 (last merge round=21)
[S11] round=22 local utility u=0.032700 metrics={'f1_val': 0.7018701185892477, 'auprc': 0.9670459949131055, 'loss_val': 0.3152772264257586, 'psi': 0.8079404691187908}-{'f1_val': 0.7018701185892477, 'auprc': 0.9436743675993324, 'loss_val': 0.31056192852306413, 'psi': 0.7985918181932816}
[S13] START round=22 head_norm_before_train=0.994104 cos_to_last_merge=0.9980 (last merge round=20)
[S13] round=22 local utility u=0.128645 metrics={'f1_val': 0.664087981362786, 'auprc': 0.6666704671217436, 'loss_val': 0.5487013085664078, 'psi': 0.6651209756663691}-{'f1_val': 0.6311108288497157, 'auprc': 0.6787057582940113, 'loss_val': 0.6442348803382856, 'psi': 0.650148800627434}
[S14] START round=22 head_norm_before_train=1.688148 cos_to_last_merge=0.9997 (last merge round=20)
[S14] round=22 local utility u=0.009231 metrics={'f1_val': 0.9975988769325926, 'auprc': 0.9992076580799318, 'loss_val': 0.07409220399899726, 'psi': 0.9982423893915283}-{'f1_val': 0.9976420785595723, 'auprc': 0.998931288617112, 'loss_val': 0.0919848008441815, 'psi': 0.9981577625825881}
[S15] START round=22 head_norm_before_train=1.019773 cos_to_last_merge=0.9988 (last merge round=20)
[S15] round=22 local utility u=0.000000 metrics={'f1_val': 0.7692125486328099, 'auprc': 0.9327229641611212, 'loss_val': 0.4068160054899495, 'psi': 0.8346167148441344}-{'f1_val': 0.8974045914970339, 'auprc': 0.9775719987367094, 'loss_val': 0.34057357266373733, 'psi': 0.9294715543929042}
[S16] START round=22 head_norm_before_train=1.849202 (no previous merge yet)
[S16] round=22 local utility u=0.461476 metrics={'f1_val': 0.991971798497276, 'auprc': 0.992898276759271, 'loss_val': 0.0672783189206889, 'psi': 0.992342389802074}-{'f1_val': 0.8936035294368525, 'auprc': 0.9894791147478476, 'loss_val': 0.3897641809602671, 'psi': 0.9319537635612506}
[S17] START round=22 head_norm_before_train=1.194414 cos_to_last_merge=1.0000 (last merge round=21)
[S17] round=22 local utility u=0.000000 metrics={'f1_val': 0.39770988542200514, 'auprc': 0.7304637579989373, 'loss_val': 0.927932028153181, 'psi': 0.530811434452778}-{'f1_val': 0.49056490542908004, 'auprc': 0.8301195020179114, 'loss_val': 0.6943871816795391, 'psi': 0.6263867440646126}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:61015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:61008
[S2] not sending this round → trigger blocked (psi=0.729)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:61017
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.865)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:61014
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.952)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:61008
[S14] sending update (kind=head size=1805 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1801) from S13
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.041064)
[S7] loaded HEAD from S13 (vec_in norm=1.041064)
[S7] cosine check vs S13: cos=0.9412
[S7] BUFFERED delta from S13 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1795) from S11
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.239637)
[S8] loaded HEAD from S11 (vec_in norm=1.239637)
[S8] cosine check vs S11: cos=0.3170
[S8] BUFFERED delta from S11 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1802) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.723577)
[S14] loaded HEAD from S10 (vec_in norm=1.723577)
[S14] cosine check vs S10: cos=0.9947
[S14] BUFFERED delta from S10 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1798) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.040104)
[S15] loaded HEAD from S8 (vec_in norm=1.040104)
[S15] cosine check vs S8: cos=0.9210
[S15] BUFFERED delta from S8 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1799) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.873053)
[S7] loaded HEAD from S16 (vec_in norm=1.873053)
[S7] cosine check vs S16: cos=-0.0637
[S7] DROPPED delta from S16 (cos=-0.0637 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1805) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.719357)
[S8] loaded HEAD from S14 (vec_in norm=1.719357)
[S8] cosine check vs S14: cos=-0.1153
[S8] DROPPED delta from S14 (cos=-0.1153 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1798) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.150641)
[S17] loaded HEAD from S9 (vec_in norm=1.150641)
[S17] cosine check vs S9: cos=0.2050
[S17] BUFFERED delta from S9 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=22 metric=0.5080 head_norm=1.143163
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.938192e-01
[S7] stored merged vector for next round verification (round=22)
[S7] DEBUG after merge:  round=22 metric=0.4783 head_norm=1.075989 delta_norm=0.193819
[S7] aggregate: ROLLBACK (f1_val pre=0.508 post=0.478 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=22 metric=0.9944 head_norm=1.040104
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.710395e-01
[S8] stored merged vector for next round verification (round=22)
[S8] DEBUG after merge:  round=22 metric=0.9354 head_norm=0.926804 delta_norm=0.671040
[S8] aggregate: ROLLBACK (f1_val pre=0.994 post=0.935 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=22 metric=0.9976 head_norm=1.719357
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.884212e-02
[S14] stored merged vector for next round verification (round=22)
[S14] DEBUG after merge:  round=22 metric=0.9972 head_norm=1.719175 delta_norm=0.088842
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=22 metric=0.7692 head_norm=1.063772
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.093726e-01
[S15] stored merged vector for next round verification (round=22)
[S15] DEBUG after merge:  round=22 metric=0.7692 head_norm=1.030959 delta_norm=0.209373
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=22 metric=0.3977 head_norm=1.212860
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.454759e-01
[S17] stored merged vector for next round verification (round=22)
[S17] DEBUG after merge:  round=22 metric=0.3727 head_norm=0.917479 delta_norm=0.745476
[S17] aggregate: ROLLBACK (f1_val pre=0.398 post=0.373 tol_abs=0.005 tol_rel=0.0)
[S2] START round=23 head_norm_before_train=1.853064 (no previous merge yet)
[S2] round=23 local utility u=0.034206 metrics={'f1_val': 0.7100326664569792, 'auprc': 0.7841898649682575, 'loss_val': 0.31974852819225724, 'psi': 0.7396955458614904}-{'f1_val': 0.7088264685305906, 'auprc': 0.7603722884733025, 'loss_val': 0.309469755317478, 'psi': 0.7294447965076754}
[S3] START round=23 head_norm_before_train=1.871115 cos_to_last_merge=0.8053 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.805
[S3] round=23 local utility u=0.316301 metrics={'f1_val': 0.9598912990643191, 'auprc': 0.9987509010592355, 'loss_val': 0.1295361490443014, 'psi': 0.9754351398622857}-{'f1_val': 0.9031517260472267, 'auprc': 0.9644496174158862, 'loss_val': 0.31879631720186263, 'psi': 0.9276708825946904}
[S4] START round=23 head_norm_before_train=1.820279 (no previous merge yet)
[S4] round=23 local utility u=0.048112 metrics={'f1_val': 0.9569383907977156, 'auprc': 0.9529865955572283, 'loss_val': 0.33515818654189516, 'psi': 0.9553576727015207}-{'f1_val': 0.9475011497897732, 'auprc': 0.959965092871641, 'loss_val': 0.3956945239273057, 'psi': 0.9524867270225204}
[S5] START round=23 head_norm_before_train=1.639518 cos_to_last_merge=0.8125 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.813
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.6660124125117697, 'auprc': 0.9495709788665148, 'loss_val': 0.4237719651775624, 'psi': 0.7794358390536678}-{'f1_val': 0.700320598491359, 'auprc': 0.9769429037678358, 'loss_val': 0.2889704423755733, 'psi': 0.8109695206019497}
[S6] START round=23 head_norm_before_train=1.754723 (no previous merge yet)
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.6113705593401639, 'auprc': 0.8922403847268386, 'loss_val': 0.6901416659142574, 'psi': 0.7237184894948339}-{'f1_val': 0.8126290327828398, 'auprc': 0.9434385204220674, 'loss_val': 0.40046325015242923, 'psi': 0.8649528278385308}
[S7] START round=23 head_norm_before_train=1.075989 cos_to_last_merge=1.0000 (last merge round=22)
[S7] round=23 local utility u=0.904077 metrics={'f1_val': 0.6949898885616046, 'auprc': 0.8503186616842504, 'loss_val': 0.44233846486033174, 'psi': 0.757121397810663}-{'f1_val': 0.5079641050693299, 'auprc': 0.7787533076413392, 'loss_val': 0.9136426762733866, 'psi': 0.6162797860981336}
[S8] START round=23 head_norm_before_train=0.926804 cos_to_last_merge=1.0000 (last merge round=22)
[S8] round=23 local utility u=0.006724 metrics={'f1_val': 0.9966394137733288, 'auprc': 0.9948109542772791, 'loss_val': 0.3374425772705158, 'psi': 0.9959080299749088}-{'f1_val': 0.994385927007507, 'auprc': 0.9934419564373402, 'loss_val': 0.3332622707681003, 'psi': 0.9940083387794404}
[S9] START round=23 head_norm_before_train=1.150641 cos_to_last_merge=0.9994 (last merge round=21)
[S9] round=23 local utility u=0.003973 metrics={'f1_val': 0.9941961205231895, 'auprc': 0.9981109237048646, 'loss_val': 0.08888391393593958, 'psi': 0.9957620417958596}-{'f1_val': 0.9971029125121428, 'auprc': 0.9989586992781145, 'loss_val': 0.11681431079298013, 'psi': 0.9978452272185315}
[S10] START round=23 head_norm_before_train=1.723577 cos_to_last_merge=0.8470 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.847
[S10] round=23 local utility u=0.002958 metrics={'f1_val': 0.9939487387271932, 'auprc': 0.9976159152484225, 'loss_val': 0.04453341542004245, 'psi': 0.995415609335685}-{'f1_val': 0.9937298155689185, 'auprc': 0.9976002563766743, 'loss_val': 0.0490885825807803, 'psi': 0.9952779918920207}
[S11] START round=23 head_norm_before_train=1.239637 cos_to_last_merge=0.9996 (last merge round=21)
[S11] round=23 local utility u=0.026541 metrics={'f1_val': 0.7018701185892477, 'auprc': 0.9712923232269806, 'loss_val': 0.2749348164308817, 'psi': 0.8096390004443409}-{'f1_val': 0.7018701185892477, 'auprc': 0.9670459949131055, 'loss_val': 0.3152772264257586, 'psi': 0.8079404691187908}
[S13] START round=23 head_norm_before_train=1.041064 cos_to_last_merge=0.9929 (last merge round=20)
[S13] round=23 local utility u=0.000000 metrics={'f1_val': 0.6270752477632692, 'auprc': 0.6794157854061, 'loss_val': 0.6823411851512287, 'psi': 0.6480114628204015}-{'f1_val': 0.664087981362786, 'auprc': 0.6666704671217436, 'loss_val': 0.5487013085664078, 'psi': 0.6651209756663691}
[S14] START round=23 head_norm_before_train=1.719175 cos_to_last_merge=1.0000 (last merge round=22)
[S14] round=23 local utility u=0.002073 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9987390415358794, 'loss_val': 0.06986442022492606, 'psi': 0.9981873273946829}-{'f1_val': 0.9975988769325926, 'auprc': 0.9992076580799318, 'loss_val': 0.07409220399899726, 'psi': 0.9982423893915283}
[S15] START round=23 head_norm_before_train=1.030959 cos_to_last_merge=1.0000 (last merge round=22)
[S15] round=23 local utility u=0.708602 metrics={'f1_val': 0.9654650364603226, 'auprc': 0.9799407050286203, 'loss_val': 0.30877939455447634, 'psi': 0.9712553038876417}-{'f1_val': 0.7692125486328099, 'auprc': 0.9327229641611212, 'loss_val': 0.4068160054899495, 'psi': 0.8346167148441344}
[S16] START round=23 head_norm_before_train=1.873053 (no previous merge yet)
[S16] round=23 local utility u=0.005434 metrics={'f1_val': 0.9924138266823379, 'auprc': 0.9935677998001213, 'loss_val': 0.06107128363136934, 'psi': 0.9928754159294513}-{'f1_val': 0.991971798497276, 'auprc': 0.992898276759271, 'loss_val': 0.0672783189206889, 'psi': 0.992342389802074}
[S17] START round=23 head_norm_before_train=0.917479 cos_to_last_merge=1.0000 (last merge round=22)
[S17] round=23 local utility u=0.562867 metrics={'f1_val': 0.4962630765834781, 'auprc': 0.8226279353748653, 'loss_val': 0.6700088145678591, 'psi': 0.626809020100033}-{'f1_val': 0.39770988542200514, 'auprc': 0.7304637579989373, 'loss_val': 0.927932028153181, 'psi': 0.530811434452778}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:61016
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S9] not sending this round → trigger blocked (psi=0.996)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.998)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.993)
[S8] not sending this round → trigger blocked (psi=0.996)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] not sending this round → trigger blocked (psi=0.810)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:61009
[S15] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1802) from S15
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.071413)
[S8] loaded HEAD from S15 (vec_in norm=1.071413)
[S8] cosine check vs S15: cos=0.8364
[S8] BUFFERED delta from S15 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1799) from S7
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.108567)
[S16] loaded HEAD from S7 (vec_in norm=1.108567)
[S16] cosine check vs S7: cos=-0.0600
[S16] DROPPED delta from S7 (cos=-0.0600 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:61007
[S17] sending update (kind=head size=1798 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1798) from S17
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.951570)
[S6] loaded HEAD from S17 (vec_in norm=0.951570)
[S6] cosine check vs S17: cos=0.5696
[S6] BUFFERED delta from S17 (total buffered=1)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=23 metric=0.6114 head_norm=1.765077
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.258621e-01
[S6] stored merged vector for next round verification (round=23)
[S6] DEBUG after merge:  round=23 metric=0.6088 head_norm=1.218037 delta_norm=0.725862
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=23 metric=0.9966 head_norm=0.974092
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.962202e-01
[S8] stored merged vector for next round verification (round=23)
[S8] DEBUG after merge:  round=23 metric=0.9966 head_norm=0.980124 delta_norm=0.296220
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.865992 (no previous merge yet)
[S2] round=24 local utility u=0.051309 metrics={'f1_val': 0.709910671916906, 'auprc': 0.8345304967913765, 'loss_val': 0.36742128968575827, 'psi': 0.7597586018666942}-{'f1_val': 0.7100326664569792, 'auprc': 0.7841898649682575, 'loss_val': 0.31974852819225724, 'psi': 0.7396955458614904}
[S3] START round=24 head_norm_before_train=1.894122 cos_to_last_merge=0.8025 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.803
[S3] round=24 local utility u=0.000000 metrics={'f1_val': 0.9124682069731168, 'auprc': 0.9887719761906603, 'loss_val': 0.23615242467358152, 'psi': 0.9429897146601343}-{'f1_val': 0.9598912990643191, 'auprc': 0.9987509010592355, 'loss_val': 0.1295361490443014, 'psi': 0.9754351398622857}
[S4] START round=24 head_norm_before_train=1.833087 (no previous merge yet)
[S4] round=24 local utility u=0.025144 metrics={'f1_val': 0.9552387229582389, 'auprc': 0.9652913210074685, 'loss_val': 0.31158683420998945, 'psi': 0.9592597621779306}-{'f1_val': 0.9569383907977156, 'auprc': 0.9529865955572283, 'loss_val': 0.33515818654189516, 'psi': 0.9553576727015207}
[S5] START round=24 head_norm_before_train=1.651483 cos_to_last_merge=0.8110 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.811
[S5] round=24 local utility u=0.675775 metrics={'f1_val': 0.8607951336400649, 'auprc': 0.965851318983316, 'loss_val': 0.289759754080534, 'psi': 0.9028176077773653}-{'f1_val': 0.6660124125117697, 'auprc': 0.9495709788665148, 'loss_val': 0.4237719651775624, 'psi': 0.7794358390536678}
[S6] START round=24 head_norm_before_train=1.218037 cos_to_last_merge=1.0000 (last merge round=23)
[S6] round=24 local utility u=1.000000 metrics={'f1_val': 0.9590510998556514, 'auprc': 0.9613020668997501, 'loss_val': 0.3156685995990275, 'psi': 0.9599514866732909}-{'f1_val': 0.6113705593401639, 'auprc': 0.8922403847268386, 'loss_val': 0.6901416659142574, 'psi': 0.7237184894948339}
[S7] START round=24 head_norm_before_train=1.108567 cos_to_last_merge=0.9992 (last merge round=22)
[S7] round=24 local utility u=0.000000 metrics={'f1_val': 0.6451568687265401, 'auprc': 0.7989461273752096, 'loss_val': 0.6103259185272806, 'psi': 0.7066725721860079}-{'f1_val': 0.6949898885616046, 'auprc': 0.8503186616842504, 'loss_val': 0.44233846486033174, 'psi': 0.757121397810663}
[S8] START round=24 head_norm_before_train=0.980124 cos_to_last_merge=1.0000 (last merge round=23)
[S8] round=24 local utility u=0.054127 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9947290036447495, 'loss_val': 0.22632569010130402, 'psi': 0.9956134634979915}-{'f1_val': 0.9966394137733288, 'auprc': 0.9948109542772791, 'loss_val': 0.3374425772705158, 'psi': 0.9959080299749088}
[S9] START round=24 head_norm_before_train=1.205509 cos_to_last_merge=0.9965 (last merge round=21)
[S9] round=24 local utility u=0.013903 metrics={'f1_val': 0.9954158325366191, 'auprc': 0.9977267679976747, 'loss_val': 0.06724312599403512, 'psi': 0.9963402067210414}-{'f1_val': 0.9941961205231895, 'auprc': 0.9981109237048646, 'loss_val': 0.08888391393593958, 'psi': 0.9957620417958596}
[S10] START round=24 head_norm_before_train=1.748755 cos_to_last_merge=0.8454 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.845
[S10] round=24 local utility u=0.003842 metrics={'f1_val': 0.9950868285240967, 'auprc': 0.9967598536520434, 'loss_val': 0.04110941578461005, 'psi': 0.9957560385752753}-{'f1_val': 0.9939487387271932, 'auprc': 0.9976159152484225, 'loss_val': 0.04453341542004245, 'psi': 0.995415609335685}
[S11] START round=24 head_norm_before_train=1.263892 cos_to_last_merge=0.9987 (last merge round=21)
[S11] round=24 local utility u=0.044189 metrics={'f1_val': 0.7023534169152725, 'auprc': 0.9973692311703326, 'loss_val': 0.26768773867306744, 'psi': 0.8203597426172966}-{'f1_val': 0.7018701185892477, 'auprc': 0.9712923232269806, 'loss_val': 0.2749348164308817, 'psi': 0.8096390004443409}
[S13] START round=24 head_norm_before_train=1.081746 cos_to_last_merge=0.9869 (last merge round=20)
[S13] round=24 local utility u=0.191297 metrics={'f1_val': 0.666885526264545, 'auprc': 0.6658509561023699, 'loss_val': 0.49791483255183944, 'psi': 0.666471698199675}-{'f1_val': 0.6270752477632692, 'auprc': 0.6794157854061, 'loss_val': 0.6823411851512287, 'psi': 0.6480114628204015}
[S14] START round=24 head_norm_before_train=1.745533 cos_to_last_merge=0.9998 (last merge round=22)
[S14] round=24 local utility u=0.002206 metrics={'f1_val': 0.9978910992781401, 'auprc': 0.9977331612234913, 'loss_val': 0.06286346427107314, 'psi': 0.9978279240562806}-{'f1_val': 0.9978195179672185, 'auprc': 0.9987390415358794, 'loss_val': 0.06986442022492606, 'psi': 0.9981873273946829}
[S15] START round=24 head_norm_before_train=1.071413 cos_to_last_merge=0.9984 (last merge round=22)
[S15] round=24 local utility u=0.000000 metrics={'f1_val': 0.771948844841488, 'auprc': 0.9904216911490697, 'loss_val': 0.3628213491862219, 'psi': 0.8593379833645207}-{'f1_val': 0.9654650364603226, 'auprc': 0.9799407050286203, 'loss_val': 0.30877939455447634, 'psi': 0.9712553038876417}
[S16] START round=24 head_norm_before_train=1.895955 (no previous merge yet)
[S16] round=24 local utility u=0.000000 metrics={'f1_val': 0.8338355844729007, 'auprc': 0.9679149216624499, 'loss_val': 0.7751014544664413, 'psi': 0.8874673193487204}-{'f1_val': 0.9924138266823379, 'auprc': 0.9935677998001213, 'loss_val': 0.06107128363136934, 'psi': 0.9928754159294513}
[S17] START round=24 head_norm_before_train=0.951570 cos_to_last_merge=0.9972 (last merge round=22)
[S17] round=24 local utility u=0.000000 metrics={'f1_val': 0.39613315154166007, 'auprc': 0.810933312074104, 'loss_val': 0.7642019986326474, 'psi': 0.5620532157546376}-{'f1_val': 0.4962630765834781, 'auprc': 0.8226279353748653, 'loss_val': 0.6700088145678591, 'psi': 0.626809020100033}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S9] → sending delta(kind=head bytes=1791) to S15@127.0.0.1:61015
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:61014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:61005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:61011
[S13] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1791 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1794 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1802) from S14
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.771851)
[S10] loaded HEAD from S14 (vec_in norm=1.771851)
[S10] cosine check vs S14: cos=0.9960
[S10] BUFFERED delta from S14 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1796) from S13
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.113976)
[S17] loaded HEAD from S13 (vec_in norm=1.113976)
[S17] cosine check vs S13: cos=0.8246
[S17] BUFFERED delta from S13 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1794) from S8
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.029248)
[S14] loaded HEAD from S8 (vec_in norm=1.029248)
[S14] cosine check vs S8: cos=-0.1561
[S14] DROPPED delta from S8 (cos=-0.1561 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1791) from S9
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.263118)
[S15] loaded HEAD from S9 (vec_in norm=1.263118)
[S15] cosine check vs S9: cos=0.8691
[S15] BUFFERED delta from S9 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1799) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.291614)
[S5] loaded HEAD from S11 (vec_in norm=1.291614)
[S5] cosine check vs S11: cos=0.7067
[S5] BUFFERED delta from S11 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=24 metric=0.9951 head_norm=1.772226
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.921467e-02
[S10] stored merged vector for next round verification (round=24)
[S10] DEBUG after merge:  round=24 metric=0.9951 head_norm=1.770267 delta_norm=0.079215
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=24 metric=0.7719 head_norm=1.120459
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.126439e-01
[S15] stored merged vector for next round verification (round=24)
[S15] DEBUG after merge:  round=24 metric=0.7680 head_norm=1.152259 delta_norm=0.312644
[S15] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=24 metric=0.8608 head_norm=1.657369
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.893606e-01
[S5] stored merged vector for next round verification (round=24)
[S5] DEBUG after merge:  round=24 metric=0.7235 head_norm=1.363900 delta_norm=0.589361
[S5] aggregate: ROLLBACK (f1_val pre=0.861 post=0.723 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=24 metric=0.3961 head_norm=0.984981
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.168214e-01
[S17] stored merged vector for next round verification (round=24)
[S17] DEBUG after merge:  round=24 metric=0.3983 head_norm=1.002591 delta_norm=0.316821
[S17] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.879776 (no previous merge yet)
[S2] round=25 local utility u=0.461600 metrics={'f1_val': 0.8310905838387606, 'auprc': 0.8608940977263018, 'loss_val': 0.25039255658428733, 'psi': 0.8430119893937771}-{'f1_val': 0.709910671916906, 'auprc': 0.8345304967913765, 'loss_val': 0.36742128968575827, 'psi': 0.7597586018666942}
[S3] START round=25 head_norm_before_train=1.914041 cos_to_last_merge=0.7999 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.800
[S3] round=25 local utility u=0.321503 metrics={'f1_val': 0.9834363840689774, 'auprc': 0.9991355831017403, 'loss_val': 0.050047287526771025, 'psi': 0.9897160636820825}-{'f1_val': 0.9124682069731168, 'auprc': 0.9887719761906603, 'loss_val': 0.23615242467358152, 'psi': 0.9429897146601343}
[S4] START round=25 head_norm_before_train=1.842752 (no previous merge yet)
[S4] round=25 local utility u=0.030632 metrics={'f1_val': 0.9544626019457747, 'auprc': 0.9799537404814809, 'loss_val': 0.28965282463897324, 'psi': 0.9646590573600572}-{'f1_val': 0.9552387229582389, 'auprc': 0.9652913210074685, 'loss_val': 0.31158683420998945, 'psi': 0.9592597621779306}
[S5] START round=25 head_norm_before_train=1.363900 cos_to_last_merge=1.0000 (last merge round=24)
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.8637162867250167, 'loss_val': 0.4085488417511677, 'psi': 0.7656788737848221}-{'f1_val': 0.8607951336400649, 'auprc': 0.965851318983316, 'loss_val': 0.289759754080534, 'psi': 0.9028176077773653}
[S6] START round=25 head_norm_before_train=1.240278 cos_to_last_merge=0.9998 (last merge round=23)
[S6] round=25 local utility u=0.000000 metrics={'f1_val': 0.7426206538314619, 'auprc': 0.9524130767660514, 'loss_val': 0.5644641623057244, 'psi': 0.8265376230052977}-{'f1_val': 0.9590510998556514, 'auprc': 0.9613020668997501, 'loss_val': 0.3156685995990275, 'psi': 0.9599514866732909}
[S7] START round=25 head_norm_before_train=1.142793 cos_to_last_merge=0.9969 (last merge round=22)
[S7] round=25 local utility u=0.079220 metrics={'f1_val': 0.6595452805790899, 'auprc': 0.802703453576981, 'loss_val': 0.5494891528103729, 'psi': 0.7168085497782464}-{'f1_val': 0.6451568687265401, 'auprc': 0.7989461273752096, 'loss_val': 0.6103259185272806, 'psi': 0.7066725721860079}
[S8] START round=25 head_norm_before_train=1.029248 cos_to_last_merge=0.9984 (last merge round=23)
[S8] round=25 local utility u=0.023023 metrics={'f1_val': 0.9953659596578323, 'auprc': 0.9971962351751695, 'loss_val': 0.18265795965189374, 'psi': 0.9960980698647671}-{'f1_val': 0.9962031034001528, 'auprc': 0.9947290036447495, 'loss_val': 0.22632569010130402, 'psi': 0.9956134634979915}
[S9] START round=25 head_norm_before_train=1.263118 cos_to_last_merge=0.9920 (last merge round=21)
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.9912237657809659, 'auprc': 0.9981192350978898, 'loss_val': 0.06265910546351874, 'psi': 0.9939819535077354}-{'f1_val': 0.9954158325366191, 'auprc': 0.9977267679976747, 'loss_val': 0.06724312599403512, 'psi': 0.9963402067210414}
[S10] START round=25 head_norm_before_train=1.770267 cos_to_last_merge=1.0000 (last merge round=24)
[S10] round=25 local utility u=0.000554 metrics={'f1_val': 0.9950868285240967, 'auprc': 0.9967208769496686, 'loss_val': 0.03988437563331608, 'psi': 0.9957404478943255}-{'f1_val': 0.9950868285240967, 'auprc': 0.9967598536520434, 'loss_val': 0.04110941578461005, 'psi': 0.9957560385752753}
[S11] START round=25 head_norm_before_train=1.291614 cos_to_last_merge=0.9970 (last merge round=21)
[S11] round=25 local utility u=0.782473 metrics={'f1_val': 0.9573852117119459, 'auprc': 0.9977442756168022, 'loss_val': 0.2340571501634698, 'psi': 0.9735288372738884}-{'f1_val': 0.7023534169152725, 'auprc': 0.9973692311703326, 'loss_val': 0.26768773867306744, 'psi': 0.8203597426172966}
[S13] START round=25 head_norm_before_train=1.113976 cos_to_last_merge=0.9815 (last merge round=20)
[S13] round=25 local utility u=0.000000 metrics={'f1_val': 0.630938771038291, 'auprc': 0.67692900173291, 'loss_val': 0.6065778054423066, 'psi': 0.6493348633161387}-{'f1_val': 0.666885526264545, 'auprc': 0.6658509561023699, 'loss_val': 0.49791483255183944, 'psi': 0.666471698199675}
[S14] START round=25 head_norm_before_train=1.771851 cos_to_last_merge=0.9993 (last merge round=22)
[S14] round=25 local utility u=0.003917 metrics={'f1_val': 0.9978910992781401, 'auprc': 0.9979962961122542, 'loss_val': 0.055818041859935726, 'psi': 0.9979331780117857}-{'f1_val': 0.9978910992781401, 'auprc': 0.9977331612234913, 'loss_val': 0.06286346427107314, 'psi': 0.9978279240562806}
[S15] START round=25 head_norm_before_train=1.152259 cos_to_last_merge=1.0000 (last merge round=24)
[S15] round=25 local utility u=0.000000 metrics={'f1_val': 0.6961372725818356, 'auprc': 0.9826324972618368, 'loss_val': 0.41260222266282764, 'psi': 0.810735362453836}-{'f1_val': 0.771948844841488, 'auprc': 0.9904216911490697, 'loss_val': 0.3628213491862219, 'psi': 0.8593379833645207}
[S16] START round=25 head_norm_before_train=1.911564 (no previous merge yet)
[S16] round=25 local utility u=0.860554 metrics={'f1_val': 0.9889178607992668, 'auprc': 0.9950293787603969, 'loss_val': 0.06583027568798364, 'psi': 0.9913624679837189}-{'f1_val': 0.8338355844729007, 'auprc': 0.9679149216624499, 'loss_val': 0.7751014544664413, 'psi': 0.8874673193487204}
[S17] START round=25 head_norm_before_train=1.002591 cos_to_last_merge=1.0000 (last merge round=24)
[S17] round=25 local utility u=0.405917 metrics={'f1_val': 0.492081243740012, 'auprc': 0.8440221951059483, 'loss_val': 0.6273223549413964, 'psi': 0.6328576242863866}-{'f1_val': 0.39613315154166007, 'auprc': 0.810933312074104, 'loss_val': 0.7642019986326474, 'psi': 0.5620532157546376}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:61011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S16] sending update (kind=head size=1806 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] sending update (kind=head size=1795 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:61014
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:61016
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S4] sending update (kind=head size=1808 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:61005
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1801) from S7
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.168589)
[S16] loaded HEAD from S7 (vec_in norm=1.168589)
[S16] cosine check vs S7: cos=-0.0600
[S16] DROPPED delta from S7 (cos=-0.0600 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1799) from S14
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.796968)
[S10] loaded HEAD from S14 (vec_in norm=1.796968)
[S10] cosine check vs S14: cos=0.9982
[S10] BUFFERED delta from S14 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1796) from S8
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.083130)
[S14] loaded HEAD from S8 (vec_in norm=1.083130)
[S14] cosine check vs S8: cos=-0.1585
[S14] DROPPED delta from S8 (cos=-0.1585 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1799) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.321740)
[S5] loaded HEAD from S11 (vec_in norm=1.321740)
[S5] cosine check vs S11: cos=0.8994
[S5] BUFFERED delta from S11 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:61007
[S17] sending update (kind=head size=1804 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1804) from S17
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.034308)
[S6] loaded HEAD from S17 (vec_in norm=1.034308)
[S6] cosine check vs S17: cos=0.7463
[S6] BUFFERED delta from S17 (total buffered=1)
[S15] ⇄ pheromone p=0.222 → S8@127.0.0.1:61009
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=25 metric=0.7003 head_norm=1.375956
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.036025e-01
[S5] stored merged vector for next round verification (round=25)
[S5] DEBUG after merge:  round=25 metric=0.7003 head_norm=1.314515 delta_norm=0.303603
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=25 metric=0.9951 head_norm=1.791937
[S10] _apply_head_vector_avg (torch): Δ‖w‖=5.452652e-02
[S10] stored merged vector for next round verification (round=25)
[S10] DEBUG after merge:  round=25 metric=0.9951 head_norm=1.793626 delta_norm=0.054527
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.083 → S17@127.0.0.1:61017
[S9] ⇄ pheromone p=0.076 → S15@127.0.0.1:61015
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=25 metric=0.7426 head_norm=1.273379
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.258682e-01
[S6] stored merged vector for next round verification (round=25)
[S6] DEBUG after merge:  round=25 metric=0.7274 head_norm=1.079018 delta_norm=0.425868
[S6] aggregate: ROLLBACK (f1_val pre=0.743 post=0.727 tol_abs=0.005 tol_rel=0.0)
[S14] ⇄ pheromone p=0.028 → S10@127.0.0.1:61011
[S7] ⇄ pheromone p=0.215 → S16@127.0.0.1:61016
[S11] ⇄ pheromone p=0.195 → S5@127.0.0.1:61005
[S8] ⇄ pheromone p=0.210 → S14@127.0.0.1:61014
[S17] ⇄ pheromone p=0.231 → S6@127.0.0.1:61007
[S2] START round=26 head_norm_before_train=1.894857 (no previous merge yet)
[S2] round=26 local utility u=0.000000 metrics={'f1_val': 0.7416411061558877, 'auprc': 0.8822772115646129, 'loss_val': 0.3185948983475858, 'psi': 0.7978955483193778}-{'f1_val': 0.8310905838387606, 'auprc': 0.8608940977263018, 'loss_val': 0.25039255658428733, 'psi': 0.8430119893937771}
[S3] START round=26 head_norm_before_train=1.932249 cos_to_last_merge=0.7979 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.798
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.9611152572344858, 'auprc': 0.9996533985827707, 'loss_val': 0.11827556704616414, 'psi': 0.9765305137737997}-{'f1_val': 0.9834363840689774, 'auprc': 0.9991355831017403, 'loss_val': 0.050047287526771025, 'psi': 0.9897160636820825}
[S4] START round=26 head_norm_before_train=1.850854 (no previous merge yet)
[S4] round=26 local utility u=0.000000 metrics={'f1_val': 0.9556285862603671, 'auprc': 0.9629199145838201, 'loss_val': 0.26849938814827906, 'psi': 0.9585451175897483}-{'f1_val': 0.9544626019457747, 'auprc': 0.9799537404814809, 'loss_val': 0.28965282463897324, 'psi': 0.9646590573600572}
[S5] START round=26 head_norm_before_train=1.314515 cos_to_last_merge=1.0000 (last merge round=25)
[S5] round=26 local utility u=0.809768 metrics={'f1_val': 0.8709508555739222, 'auprc': 0.9976747953908738, 'loss_val': 0.21466965388591044, 'psi': 0.9216404315007027}-{'f1_val': 0.700320598491359, 'auprc': 0.8637162867250167, 'loss_val': 0.4085488417511677, 'psi': 0.7656788737848221}
[S6] START round=26 head_norm_before_train=1.079018 cos_to_last_merge=1.0000 (last merge round=25)
[S6] round=26 local utility u=0.008169 metrics={'f1_val': 0.7591257395502756, 'auprc': 0.9341429484774961, 'loss_val': 0.592347172597307, 'psi': 0.8291326231211638}-{'f1_val': 0.7426206538314619, 'auprc': 0.9524130767660514, 'loss_val': 0.5644641623057244, 'psi': 0.8265376230052977}
[S7] START round=26 head_norm_before_train=1.168589 cos_to_last_merge=0.9944 (last merge round=22)
[S7] round=26 local utility u=0.000000 metrics={'f1_val': 0.5574402683526142, 'auprc': 0.784948916845667, 'loss_val': 0.7832889449732789, 'psi': 0.6484437277498354}-{'f1_val': 0.6595452805790899, 'auprc': 0.802703453576981, 'loss_val': 0.5494891528103729, 'psi': 0.7168085497782464}
[S8] START round=26 head_norm_before_train=1.083130 cos_to_last_merge=0.9940 (last merge round=23)
[S8] round=26 local utility u=0.019946 metrics={'f1_val': 0.9939988207001527, 'auprc': 0.9984564253816433, 'loss_val': 0.1383443121211977, 'psi': 0.9957818625727489}-{'f1_val': 0.9953659596578323, 'auprc': 0.9971962351751695, 'loss_val': 0.18265795965189374, 'psi': 0.9960980698647671}
[S9] START round=26 head_norm_before_train=1.312452 cos_to_last_merge=0.9873 (last merge round=21)
[S9] round=26 local utility u=0.024953 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9981447215423849, 'loss_val': 0.045449590430636934, 'psi': 0.9972541957052888}-{'f1_val': 0.9912237657809659, 'auprc': 0.9981192350978898, 'loss_val': 0.06265910546351874, 'psi': 0.9939819535077354}
[S10] START round=26 head_norm_before_train=1.793626 cos_to_last_merge=1.0000 (last merge round=25)
[S10] round=26 local utility u=0.000000 metrics={'f1_val': 0.9946059470817044, 'auprc': 0.9969063501566818, 'loss_val': 0.038891537977356186, 'psi': 0.9955261083116953}-{'f1_val': 0.9950868285240967, 'auprc': 0.9967208769496686, 'loss_val': 0.03988437563331608, 'psi': 0.9957404478943255}
[S11] START round=26 head_norm_before_train=1.321740 cos_to_last_merge=0.9945 (last merge round=21)
[S11] round=26 local utility u=0.064786 metrics={'f1_val': 0.9731689671379427, 'auprc': 0.9977408563972996, 'loss_val': 0.19917749690329686, 'psi': 0.9829977228416855}-{'f1_val': 0.9573852117119459, 'auprc': 0.9977442756168022, 'loss_val': 0.2340571501634698, 'psi': 0.9735288372738884}
[S13] START round=26 head_norm_before_train=1.133248 cos_to_last_merge=0.9779 (last merge round=20)
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.5964810750621322, 'auprc': 0.6894273247627032, 'loss_val': 0.800498460341194, 'psi': 0.6336595749423606}-{'f1_val': 0.630938771038291, 'auprc': 0.67692900173291, 'loss_val': 0.6065778054423066, 'psi': 0.6493348633161387}
[S14] START round=26 head_norm_before_train=1.796968 cos_to_last_merge=0.9986 (last merge round=22)
[S14] round=26 local utility u=0.004909 metrics={'f1_val': 0.9978965638266506, 'auprc': 0.9976707058322938, 'loss_val': 0.04505594100491109, 'psi': 0.9978062206289078}-{'f1_val': 0.9978910992781401, 'auprc': 0.9979962961122542, 'loss_val': 0.055818041859935726, 'psi': 0.9979331780117857}
[S15] START round=26 head_norm_before_train=1.203382 cos_to_last_merge=0.9992 (last merge round=24)
[S15] round=26 local utility u=0.857664 metrics={'f1_val': 0.9411157857607535, 'auprc': 0.9809779041165863, 'loss_val': 0.16218180345060706, 'psi': 0.9570606331030866}-{'f1_val': 0.6961372725818356, 'auprc': 0.9826324972618368, 'loss_val': 0.41260222266282764, 'psi': 0.810735362453836}
[S16] START round=26 head_norm_before_train=1.928495 (no previous merge yet)
[S16] round=26 local utility u=0.004770 metrics={'f1_val': 0.9923392931772027, 'auprc': 0.9910125003689291, 'loss_val': 0.06476756439474106, 'psi': 0.9918085760538933}-{'f1_val': 0.9889178607992668, 'auprc': 0.9950293787603969, 'loss_val': 0.06583027568798364, 'psi': 0.9913624679837189}
[S17] START round=26 head_norm_before_train=1.034308 cos_to_last_merge=0.9985 (last merge round=24)
[S17] round=26 local utility u=0.000000 metrics={'f1_val': 0.3872012571948888, 'auprc': 0.7551919235824525, 'loss_val': 0.8891091273731492, 'psi': 0.5343975237499143}-{'f1_val': 0.492081243740012, 'auprc': 0.8440221951059483, 'loss_val': 0.6273223549413964, 'psi': 0.6328576242863866}
[S3]  timeout peer S2
[S2]  timeout peer S3
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:61015
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:61015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:61005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:61012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:61008
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:61017
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:61009
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S14] → sending delta(kind=head bytes=1808) to S8@127.0.0.1:61009
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1808 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1796) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.354982)
[S5] loaded HEAD from S11 (vec_in norm=1.354982)
[S5] cosine check vs S11: cos=0.9690
[S5] BUFFERED delta from S11 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1800) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.116688)
[S17] loaded HEAD from S6 (vec_in norm=1.116688)
[S17] cosine check vs S6: cos=0.9031
[S17] BUFFERED delta from S6 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1800) from S9
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.352939)
[S15] loaded HEAD from S9 (vec_in norm=1.352939)
[S15] cosine check vs S9: cos=0.9619
[S15] BUFFERED delta from S9 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1808) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.820009)
[S8] loaded HEAD from S14 (vec_in norm=1.820009)
[S8] cosine check vs S14: cos=-0.1597
[S8] DROPPED delta from S14 (cos=-0.1597 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1798) from S15
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.250066)
[S8] loaded HEAD from S15 (vec_in norm=1.250066)
[S8] cosine check vs S15: cos=0.9408
[S8] BUFFERED delta from S15 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1799) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.944589)
[S7] loaded HEAD from S16 (vec_in norm=1.944589)
[S7] cosine check vs S16: cos=-0.0600
[S7] DROPPED delta from S16 (cos=-0.0600 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1800) from S5
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.327942)
[S11] loaded HEAD from S5 (vec_in norm=1.327942)
[S11] cosine check vs S5: cos=0.9690
[S11] BUFFERED delta from S5 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1796) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.134337)
[S15] loaded HEAD from S8 (vec_in norm=1.134337)
[S15] cosine check vs S8: cos=0.9408
[S15] BUFFERED delta from S8 (total buffered=2)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=26 metric=0.9411 head_norm=1.250066
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.143524e-01
[S15] stored merged vector for next round verification (round=26)
[S15] DEBUG after merge:  round=26 metric=0.9358 head_norm=1.222092 delta_norm=0.114352
[S15] aggregate: ROLLBACK (f1_val pre=0.941 post=0.936 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=26 metric=0.8710 head_norm=1.327942
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.674633e-01
[S5] stored merged vector for next round verification (round=26)
[S5] DEBUG after merge:  round=26 metric=0.7003 head_norm=1.331037 delta_norm=0.167463
[S5] aggregate: ROLLBACK (f1_val pre=0.871 post=0.700 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=26 metric=0.9732 head_norm=1.354982
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.674633e-01
[S11] stored merged vector for next round verification (round=26)
[S11] DEBUG after merge:  round=26 metric=0.9594 head_norm=1.331037 delta_norm=0.167463
[S11] aggregate: ROLLBACK (f1_val pre=0.973 post=0.959 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=26 metric=0.9940 head_norm=1.134337
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.128232e-01
[S8] stored merged vector for next round verification (round=26)
[S8] DEBUG after merge:  round=26 metric=0.9940 head_norm=1.174478 delta_norm=0.212823
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=26 metric=0.3872 head_norm=1.063141
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.413481e-01
[S17] stored merged vector for next round verification (round=26)
[S17] DEBUG after merge:  round=26 metric=0.3896 head_norm=1.063194 delta_norm=0.241348
[S17] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.906770 (no previous merge yet)
[S2] round=27 local utility u=0.000000 metrics={'f1_val': 0.7653909218450452, 'auprc': 0.8315453827886117, 'loss_val': 0.35647551188576637, 'psi': 0.7918527062224718}-{'f1_val': 0.7416411061558877, 'auprc': 0.8822772115646129, 'loss_val': 0.3185948983475858, 'psi': 0.7978955483193778}
[S3] START round=27 head_norm_before_train=1.950009 cos_to_last_merge=0.7959 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.796
[S3] round=27 local utility u=0.000000 metrics={'f1_val': 0.829855234950969, 'auprc': 0.9976511637789884, 'loss_val': 0.30178622901024, 'psi': 0.8969736064821767}-{'f1_val': 0.9611152572344858, 'auprc': 0.9996533985827707, 'loss_val': 0.11827556704616414, 'psi': 0.9765305137737997}
[S4] START round=27 head_norm_before_train=1.861182 (no previous merge yet)
[S4] round=27 local utility u=0.000000 metrics={'f1_val': 0.9528922485695079, 'auprc': 0.9593398509634992, 'loss_val': 0.27322845661039785, 'psi': 0.9554712895271045}-{'f1_val': 0.9556285862603671, 'auprc': 0.9629199145838201, 'loss_val': 0.26849938814827906, 'psi': 0.9585451175897483}
[S5] START round=27 head_norm_before_train=1.331037 cos_to_last_merge=1.0000 (last merge round=26)
[S5] round=27 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9908600686011064, 'loss_val': 0.2787714152012084, 'psi': 0.816536386535258}-{'f1_val': 0.8709508555739222, 'auprc': 0.9976747953908738, 'loss_val': 0.21466965388591044, 'psi': 0.9216404315007027}
[S6] START round=27 head_norm_before_train=1.116688 cos_to_last_merge=0.9989 (last merge round=25)
[S6] round=27 local utility u=0.081486 metrics={'f1_val': 0.7759590602894486, 'auprc': 0.9283126854053221, 'loss_val': 0.5128835489400219, 'psi': 0.836900510335798}-{'f1_val': 0.7591257395502756, 'auprc': 0.9341429484774961, 'loss_val': 0.592347172597307, 'psi': 0.8291326231211638}
[S7] START round=27 head_norm_before_train=1.202778 cos_to_last_merge=0.9907 (last merge round=22)
[S7] round=27 local utility u=0.588735 metrics={'f1_val': 0.671717168180435, 'auprc': 0.8264462411050582, 'loss_val': 0.4159728533832739, 'psi': 0.7336087973502843}-{'f1_val': 0.5574402683526142, 'auprc': 0.784948916845667, 'loss_val': 0.7832889449732789, 'psi': 0.6484437277498354}
[S8] START round=27 head_norm_before_train=1.174478 cos_to_last_merge=1.0000 (last merge round=26)
[S8] round=27 local utility u=0.008860 metrics={'f1_val': 0.9932775562128633, 'auprc': 0.9980602398044816, 'loss_val': 0.11510861686332846, 'psi': 0.9951906296495105}-{'f1_val': 0.9939988207001527, 'auprc': 0.9984564253816433, 'loss_val': 0.1383443121211977, 'psi': 0.9957818625727489}
[S9] START round=27 head_norm_before_train=1.352939 cos_to_last_merge=0.9834 (last merge round=21)
[S9] round=27 local utility u=0.000000 metrics={'f1_val': 0.9937492462693716, 'auprc': 0.9981293011358428, 'loss_val': 0.04451906280099783, 'psi': 0.99550126821596}-{'f1_val': 0.9966605118138915, 'auprc': 0.9981447215423849, 'loss_val': 0.045449590430636934, 'psi': 0.9972541957052888}
[S10] START round=27 head_norm_before_train=1.810692 cos_to_last_merge=1.0000 (last merge round=25)
[S10] round=27 local utility u=0.000675 metrics={'f1_val': 0.9946059470817044, 'auprc': 0.9968573449834608, 'loss_val': 0.03739475327825311, 'psi': 0.9955065062424069}-{'f1_val': 0.9946059470817044, 'auprc': 0.9969063501566818, 'loss_val': 0.038891537977356186, 'psi': 0.9955261083116953}
[S11] START round=27 head_norm_before_train=1.331037 cos_to_last_merge=1.0000 (last merge round=26)
[S11] round=27 local utility u=0.068767 metrics={'f1_val': 0.9942535076685362, 'auprc': 0.9978997951265611, 'loss_val': 0.18862669476005384, 'psi': 0.9957120226517461}-{'f1_val': 0.9731689671379427, 'auprc': 0.9977408563972996, 'loss_val': 0.19917749690329686, 'psi': 0.9829977228416855}
[S13] START round=27 head_norm_before_train=1.154635 cos_to_last_merge=0.9733 (last merge round=20)
[S13] round=27 local utility u=0.122323 metrics={'f1_val': 0.6266839426401716, 'auprc': 0.6694216949835883, 'loss_val': 0.6770535594308746, 'psi': 0.6437790435775383}-{'f1_val': 0.5964810750621322, 'auprc': 0.6894273247627032, 'loss_val': 0.800498460341194, 'psi': 0.6336595749423606}
[S14] START round=27 head_norm_before_train=1.820009 cos_to_last_merge=0.9978 (last merge round=22)
[S14] round=27 local utility u=0.000997 metrics={'f1_val': 0.9976538428159559, 'auprc': 0.9972624850912759, 'loss_val': 0.04038140476060419, 'psi': 0.9974972997260839}-{'f1_val': 0.9978965638266506, 'auprc': 0.9976707058322938, 'loss_val': 0.04505594100491109, 'psi': 0.9978062206289078}
[S15] START round=27 head_norm_before_train=1.222092 cos_to_last_merge=1.0000 (last merge round=26)
[S15] round=27 local utility u=0.000000 metrics={'f1_val': 0.8901997946724077, 'auprc': 0.9863418060930239, 'loss_val': 0.19565963628433045, 'psi': 0.9286565992406542}-{'f1_val': 0.9411157857607535, 'auprc': 0.9809779041165863, 'loss_val': 0.16218180345060706, 'psi': 0.9570606331030866}
[S16] START round=27 head_norm_before_train=1.944589 (no previous merge yet)
[S16] round=27 local utility u=0.000000 metrics={'f1_val': 0.9383879343743111, 'auprc': 0.9927251368090444, 'loss_val': 0.2264129747892507, 'psi': 0.9601228153482044}-{'f1_val': 0.9923392931772027, 'auprc': 0.9910125003689291, 'loss_val': 0.06476756439474106, 'psi': 0.9918085760538933}
[S17] START round=27 head_norm_before_train=1.063194 cos_to_last_merge=1.0000 (last merge round=26)
[S17] round=27 local utility u=0.174411 metrics={'f1_val': 0.39871609936159225, 'auprc': 0.8284018708413511, 'loss_val': 0.8290052353431082, 'psi': 0.5705904079534958}-{'f1_val': 0.3872012571948888, 'auprc': 0.7551919235824525, 'loss_val': 0.8891091273731492, 'psi': 0.5343975237499143}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:61015
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:61005
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:61016
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:61014
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1805 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1798) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.217673)
[S15] loaded HEAD from S8 (vec_in norm=1.217673)
[S15] cosine check vs S8: cos=0.9888
[S15] BUFFERED delta from S8 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1805) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.363000)
[S5] loaded HEAD from S11 (vec_in norm=1.363000)
[S5] cosine check vs S11: cos=0.9992
[S5] BUFFERED delta from S11 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1799) from S7
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.231836)
[S16] loaded HEAD from S7 (vec_in norm=1.231836)
[S16] cosine check vs S7: cos=-0.0603
[S16] DROPPED delta from S7 (cos=-0.0603 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1803) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.179566)
[S17] loaded HEAD from S6 (vec_in norm=1.179566)
[S17] cosine check vs S6: cos=0.9616
[S17] BUFFERED delta from S6 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1802) from S13
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.180850)
[S17] loaded HEAD from S13 (vec_in norm=1.180850)
[S17] cosine check vs S13: cos=0.8991
[S17] BUFFERED delta from S13 (total buffered=2)
[S14] RECEIVED delta(kind=head bytes=1803) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.825668)
[S14] loaded HEAD from S10 (vec_in norm=1.825668)
[S14] cosine check vs S10: cos=0.9983
[S14] BUFFERED delta from S10 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1802) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.841502)
[S8] loaded HEAD from S14 (vec_in norm=1.841502)
[S8] cosine check vs S14: cos=-0.1577
[S8] DROPPED delta from S14 (cos=-0.1577 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:61007
[S17] sending update (kind=head size=1797 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1797) from S17
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.088782)
[S6] loaded HEAD from S17 (vec_in norm=1.088782)
[S6] cosine check vs S17: cos=0.9616
[S6] BUFFERED delta from S17 (total buffered=1)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=27 metric=0.7003 head_norm=1.344945
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.796837e-02
[S5] stored merged vector for next round verification (round=27)
[S5] DEBUG after merge:  round=27 metric=0.7003 head_norm=1.353714 delta_norm=0.027968
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=27 metric=0.7760 head_norm=1.179566
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.634231e-01
[S6] stored merged vector for next round verification (round=27)
[S6] DEBUG after merge:  round=27 metric=0.7758 head_norm=1.123256 delta_norm=0.163423
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=27 metric=0.9977 head_norm=1.841502
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.326276e-02
[S14] stored merged vector for next round verification (round=27)
[S14] DEBUG after merge:  round=27 metric=0.9977 head_norm=1.832828 delta_norm=0.053263
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=27 metric=0.3987 head_norm=1.088782
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.167489e-01
[S17] stored merged vector for next round verification (round=27)
[S17] DEBUG after merge:  round=27 metric=0.4006 head_norm=1.099596 delta_norm=0.116749
[S17] aggregate: ACCEPT kept=['S6', 'S13'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=27 metric=0.8902 head_norm=1.260258
[S15] _apply_head_vector_avg (torch): Δ‖w‖=9.520002e-02
[S15] stored merged vector for next round verification (round=27)
[S15] DEBUG after merge:  round=27 metric=0.8938 head_norm=1.235486 delta_norm=0.095200
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=1.919824 (no previous merge yet)
[S2] round=28 local utility u=0.173576 metrics={'f1_val': 0.8294835433257988, 'auprc': 0.8063824388358745, 'loss_val': 0.3183910703756909, 'psi': 0.820243101529829}-{'f1_val': 0.7653909218450452, 'auprc': 0.8315453827886117, 'loss_val': 0.35647551188576637, 'psi': 0.7918527062224718}
[S3] START round=28 head_norm_before_train=1.966009 cos_to_last_merge=0.7940 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.794
[S3] round=28 local utility u=0.227080 metrics={'f1_val': 0.8915440696473462, 'auprc': 0.9968172058357678, 'loss_val': 0.21525660480658584, 'psi': 0.933653324122715}-{'f1_val': 0.829855234950969, 'auprc': 0.9976511637789884, 'loss_val': 0.30178622901024, 'psi': 0.8969736064821767}
[S4] START round=28 head_norm_before_train=1.870057 (no previous merge yet)
[S4] round=28 local utility u=0.009715 metrics={'f1_val': 0.9542598698464166, 'auprc': 0.960257121548983, 'loss_val': 0.2647560231052276, 'psi': 0.9566587705274432}-{'f1_val': 0.9528922485695079, 'auprc': 0.9593398509634992, 'loss_val': 0.27322845661039785, 'psi': 0.9554712895271045}
[S5] START round=28 head_norm_before_train=1.353714 cos_to_last_merge=1.0000 (last merge round=27)
[S5] round=28 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9886488585886689, 'loss_val': 0.2991539938948411, 'psi': 0.815651902530283}-{'f1_val': 0.700320598491359, 'auprc': 0.9908600686011064, 'loss_val': 0.2787714152012084, 'psi': 0.816536386535258}
[S6] START round=28 head_norm_before_train=1.123256 cos_to_last_merge=1.0000 (last merge round=27)
[S6] round=28 local utility u=0.099213 metrics={'f1_val': 0.8067182563280343, 'auprc': 0.9312294130183477, 'loss_val': 0.5077626370297422, 'psi': 0.8565227190041597}-{'f1_val': 0.7759590602894486, 'auprc': 0.9283126854053221, 'loss_val': 0.5128835489400219, 'psi': 0.836900510335798}
[S7] START round=28 head_norm_before_train=1.231836 cos_to_last_merge=0.9876 (last merge round=22)
[S7] round=28 local utility u=0.000000 metrics={'f1_val': 0.6023301936477891, 'auprc': 0.7965811522916841, 'loss_val': 0.6869998594151706, 'psi': 0.6800305771053471}-{'f1_val': 0.671717168180435, 'auprc': 0.8264462411050582, 'loss_val': 0.4159728533832739, 'psi': 0.7336087973502843}
[S8] START round=28 head_norm_before_train=1.217673 cos_to_last_merge=0.9994 (last merge round=26)
[S8] round=28 local utility u=0.012289 metrics={'f1_val': 0.9932673365348732, 'auprc': 0.9984774245755836, 'loss_val': 0.0917200618137437, 'psi': 0.9953513717511574}-{'f1_val': 0.9932775562128633, 'auprc': 0.9980602398044816, 'loss_val': 0.11510861686332846, 'psi': 0.9951906296495105}
[S9] START round=28 head_norm_before_train=1.386742 cos_to_last_merge=0.9800 (last merge round=21)
[S9] round=28 local utility u=0.011620 metrics={'f1_val': 0.9962461149658858, 'auprc': 0.998150795178341, 'loss_val': 0.03632387787226657, 'psi': 0.9970079870508679}-{'f1_val': 0.9937492462693716, 'auprc': 0.9981293011358428, 'loss_val': 0.04451906280099783, 'psi': 0.99550126821596}
[S10] START round=28 head_norm_before_train=1.825668 cos_to_last_merge=0.9999 (last merge round=25)
[S10] round=28 local utility u=0.000000 metrics={'f1_val': 0.9941434254657042, 'auprc': 0.9971583622259548, 'loss_val': 0.03816535813971696, 'psi': 0.9953494001698044}-{'f1_val': 0.9946059470817044, 'auprc': 0.9968573449834608, 'loss_val': 0.03739475327825311, 'psi': 0.9955065062424069}
[S11] START round=28 head_norm_before_train=1.363000 cos_to_last_merge=0.9995 (last merge round=26)
[S11] round=28 local utility u=0.015074 metrics={'f1_val': 0.9961135349310292, 'auprc': 0.9968165197550893, 'loss_val': 0.16638836618408476, 'psi': 0.9963947288606532}-{'f1_val': 0.9942535076685362, 'auprc': 0.9978997951265611, 'loss_val': 0.18862669476005384, 'psi': 0.9957120226517461}
[S13] START round=28 head_norm_before_train=1.180850 cos_to_last_merge=0.9685 (last merge round=20)
[S13] round=28 local utility u=0.030168 metrics={'f1_val': 0.6283148251212427, 'auprc': 0.6758293902537346, 'loss_val': 0.6457266268606497, 'psi': 0.6473206511742395}-{'f1_val': 0.6266839426401716, 'auprc': 0.6694216949835883, 'loss_val': 0.6770535594308746, 'psi': 0.6437790435775383}
[S14] START round=28 head_norm_before_train=1.832828 cos_to_last_merge=1.0000 (last merge round=27)
[S14] round=28 local utility u=0.000445 metrics={'f1_val': 0.9978965638266506, 'auprc': 0.9971652556043004, 'loss_val': 0.04065530865377741, 'psi': 0.9976040405377105}-{'f1_val': 0.9976538428159559, 'auprc': 0.9972624850912759, 'loss_val': 0.04038140476060419, 'psi': 0.9974972997260839}
[S15] START round=28 head_norm_before_train=1.235486 cos_to_last_merge=1.0000 (last merge round=27)
[S15] round=28 local utility u=0.034057 metrics={'f1_val': 0.8988693050173322, 'auprc': 0.9916698633172246, 'loss_val': 0.19554772537346674, 'psi': 0.9359895283372892}-{'f1_val': 0.8901997946724077, 'auprc': 0.9863418060930239, 'loss_val': 0.19565963628433045, 'psi': 0.9286565992406542}
[S16] START round=28 head_norm_before_train=1.960284 (no previous merge yet)
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.9385966176396305, 'auprc': 0.9925985947750016, 'loss_val': 0.2330431075479383, 'psi': 0.9601974084937789}-{'f1_val': 0.9383879343743111, 'auprc': 0.9927251368090444, 'loss_val': 0.2264129747892507, 'psi': 0.9601228153482044}
[S17] START round=28 head_norm_before_train=1.099596 cos_to_last_merge=1.0000 (last merge round=27)
[S17] round=28 local utility u=0.000000 metrics={'f1_val': 0.4005923819305287, 'auprc': 0.8243216415803363, 'loss_val': 0.8549342509184555, 'psi': 0.5700840857904517}-{'f1_val': 0.39871609936159225, 'auprc': 0.8284018708413511, 'loss_val': 0.8290052353431082, 'psi': 0.5705904079534958}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:61015
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:61009
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:61005
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:61015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:61017
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:61009
[S13] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S6] sending update (kind=head size=1805 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1801) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.396666)
[S5] loaded HEAD from S11 (vec_in norm=1.396666)
[S5] cosine check vs S11: cos=0.9978
[S5] BUFFERED delta from S11 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1796) from S13
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.207408)
[S17] loaded HEAD from S13 (vec_in norm=1.207408)
[S17] cosine check vs S13: cos=0.9234
[S17] BUFFERED delta from S13 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1805) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.178506)
[S17] loaded HEAD from S6 (vec_in norm=1.178506)
[S17] cosine check vs S6: cos=0.9787
[S17] BUFFERED delta from S6 (total buffered=2)
[S8] RECEIVED delta(kind=head bytes=1802) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.849311)
[S8] loaded HEAD from S14 (vec_in norm=1.849311)
[S8] cosine check vs S14: cos=-0.1612
[S8] DROPPED delta from S14 (cos=-0.1612 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1798) from S15
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.268244)
[S8] loaded HEAD from S15 (vec_in norm=1.268244)
[S8] cosine check vs S15: cos=0.9948
[S8] BUFFERED delta from S15 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1796) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.257293)
[S15] loaded HEAD from S8 (vec_in norm=1.257293)
[S15] cosine check vs S8: cos=0.9948
[S15] BUFFERED delta from S8 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1803) from S9
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.416885)
[S15] loaded HEAD from S9 (vec_in norm=1.416885)
[S15] cosine check vs S9: cos=0.9483
[S15] BUFFERED delta from S9 (total buffered=2)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=28 metric=0.7003 head_norm=1.389673
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.624961e-02
[S5] stored merged vector for next round verification (round=28)
[S5] DEBUG after merge:  round=28 metric=0.7003 head_norm=1.392406 delta_norm=0.046250
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=28 metric=0.9933 head_norm=1.257293
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.458854e-02
[S8] stored merged vector for next round verification (round=28)
[S8] DEBUG after merge:  round=28 metric=0.9933 head_norm=1.261128 delta_norm=0.064589
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=28 metric=0.8989 head_norm=1.268244
[S15] _apply_head_vector_avg (torch): Δ‖w‖=9.635568e-02
[S15] stored merged vector for next round verification (round=28)
[S15] DEBUG after merge:  round=28 metric=0.8926 head_norm=1.286270 delta_norm=0.096356
[S15] aggregate: ROLLBACK (f1_val pre=0.899 post=0.893 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=28 metric=0.4006 head_norm=1.122915
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.665323e-02
[S17] stored merged vector for next round verification (round=28)
[S17] DEBUG after merge:  round=28 metric=0.4006 head_norm=1.131126 delta_norm=0.076653
[S17] aggregate: ACCEPT kept=['S13', 'S6'] (k=2/2) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=1.931889 (no previous merge yet)
[S2] round=29 local utility u=0.000000 metrics={'f1_val': 0.7284168249880483, 'auprc': 0.9468733154713845, 'loss_val': 0.3753951101311743, 'psi': 0.8157994211813828}-{'f1_val': 0.8294835433257988, 'auprc': 0.8063824388358745, 'loss_val': 0.3183910703756909, 'psi': 0.820243101529829}
[S3] START round=29 head_norm_before_train=1.981858 cos_to_last_merge=0.7922 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.792
[S3] round=29 local utility u=0.155103 metrics={'f1_val': 0.9423013220041317, 'auprc': 0.9889821625613965, 'loss_val': 0.18608846716228092, 'psi': 0.9609736582270376}-{'f1_val': 0.8915440696473462, 'auprc': 0.9968172058357678, 'loss_val': 0.21525660480658584, 'psi': 0.933653324122715}
[S4] START round=29 head_norm_before_train=1.881226 (no previous merge yet)
[S4] round=29 local utility u=0.000000 metrics={'f1_val': 0.9522967497440745, 'auprc': 0.960858760537824, 'loss_val': 0.26239934924764585, 'psi': 0.9557215540615743}-{'f1_val': 0.9542598698464166, 'auprc': 0.960257121548983, 'loss_val': 0.2647560231052276, 'psi': 0.9566587705274432}
[S5] START round=29 head_norm_before_train=1.392406 cos_to_last_merge=1.0000 (last merge round=28)
[S5] round=29 local utility u=0.427359 metrics={'f1_val': 0.8207888015139936, 'auprc': 0.9966312562622407, 'loss_val': 0.19119330699800413, 'psi': 0.8911257834132924}-{'f1_val': 0.700320598491359, 'auprc': 0.9886488585886689, 'loss_val': 0.2991539938948411, 'psi': 0.815651902530283}
[S6] START round=29 head_norm_before_train=1.178506 cos_to_last_merge=0.9984 (last merge round=27)
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.7264506256551984, 'auprc': 0.9304258109368555, 'loss_val': 0.6031526361904721, 'psi': 0.8080406997678613}-{'f1_val': 0.8067182563280343, 'auprc': 0.9312294130183477, 'loss_val': 0.5077626370297422, 'psi': 0.8565227190041597}
[S7] START round=29 head_norm_before_train=1.253394 cos_to_last_merge=0.9853 (last merge round=22)
[S7] round=29 local utility u=0.307418 metrics={'f1_val': 0.6594048309179377, 'auprc': 0.8115885873996995, 'loss_val': 0.4596341389860223, 'psi': 0.7202783335106424}-{'f1_val': 0.6023301936477891, 'auprc': 0.7965811522916841, 'loss_val': 0.6869998594151706, 'psi': 0.6800305771053471}
[S8] START round=29 head_norm_before_train=1.261128 cos_to_last_merge=1.0000 (last merge round=28)
[S8] round=29 local utility u=0.004768 metrics={'f1_val': 0.9935542741987232, 'auprc': 0.9984475019495328, 'loss_val': 0.08381529293432126, 'psi': 0.995511565299047}-{'f1_val': 0.9932673365348732, 'auprc': 0.9984774245755836, 'loss_val': 0.0917200618137437, 'psi': 0.9953513717511574}
[S9] START round=29 head_norm_before_train=1.416885 cos_to_last_merge=0.9770 (last merge round=21)
[S9] round=29 local utility u=0.000000 metrics={'f1_val': 0.988279001546821, 'auprc': 0.994039518790867, 'loss_val': 0.05479562079085894, 'psi': 0.9905832084444395}-{'f1_val': 0.9962461149658858, 'auprc': 0.998150795178341, 'loss_val': 0.03632387787226657, 'psi': 0.9970079870508679}
[S10] START round=29 head_norm_before_train=1.838926 cos_to_last_merge=0.9997 (last merge round=25)
[S10] round=29 local utility u=0.001253 metrics={'f1_val': 0.9942256070413027, 'auprc': 0.9967436755755915, 'loss_val': 0.03490903199225902, 'psi': 0.9952328344550182}-{'f1_val': 0.9941434254657042, 'auprc': 0.9971583622259548, 'loss_val': 0.03816535813971696, 'psi': 0.9953494001698044}
[S11] START round=29 head_norm_before_train=1.396666 cos_to_last_merge=0.9980 (last merge round=26)
[S11] round=29 local utility u=0.014479 metrics={'f1_val': 0.9963552463558643, 'auprc': 0.9959472500854868, 'loss_val': 0.136272942611097, 'psi': 0.9961920478477133}-{'f1_val': 0.9961135349310292, 'auprc': 0.9968165197550893, 'loss_val': 0.16638836618408476, 'psi': 0.9963947288606532}
[S13] START round=29 head_norm_before_train=1.207408 cos_to_last_merge=0.9640 (last merge round=20)
[S13] round=29 local utility u=0.000000 metrics={'f1_val': 0.6256628072031514, 'auprc': 0.682276226303932, 'loss_val': 0.6856160073116749, 'psi': 0.6483081748434636}-{'f1_val': 0.6283148251212427, 'auprc': 0.6758293902537346, 'loss_val': 0.6457266268606497, 'psi': 0.6473206511742395}
[S14] START round=29 head_norm_before_train=1.849311 cos_to_last_merge=1.0000 (last merge round=27)
[S14] round=29 local utility u=0.000000 metrics={'f1_val': 0.9972435617623723, 'auprc': 0.9973789698120934, 'loss_val': 0.038482599827279175, 'psi': 0.9972977249822608}-{'f1_val': 0.9978965638266506, 'auprc': 0.9971652556043004, 'loss_val': 0.04065530865377741, 'psi': 0.9976040405377105}
[S15] START round=29 head_norm_before_train=1.286270 cos_to_last_merge=1.0000 (last merge round=28)
[S15] round=29 local utility u=0.014582 metrics={'f1_val': 0.9024637499459172, 'auprc': 0.9945192710477097, 'loss_val': 0.19649939069221728, 'psi': 0.9392859583866341}-{'f1_val': 0.8988693050173322, 'auprc': 0.9916698633172246, 'loss_val': 0.19554772537346674, 'psi': 0.9359895283372892}
[S16] START round=29 head_norm_before_train=1.976067 (no previous merge yet)
[S16] round=29 local utility u=0.007858 metrics={'f1_val': 0.9396057722509935, 'auprc': 0.9930676710733153, 'loss_val': 0.22478861080783163, 'psi': 0.9609905317799223}-{'f1_val': 0.9385966176396305, 'auprc': 0.9925985947750016, 'loss_val': 0.2330431075479383, 'psi': 0.9601974084937789}
[S17] START round=29 head_norm_before_train=1.131126 cos_to_last_merge=1.0000 (last merge round=28)
[S17] round=29 local utility u=0.026103 metrics={'f1_val': 0.40277999908485806, 'auprc': 0.830731965402718, 'loss_val': 0.8350859012240075, 'psi': 0.573960785612002}-{'f1_val': 0.4005923819305287, 'auprc': 0.8243216415803363, 'loss_val': 0.8549342509184555, 'psi': 0.5700840857904517}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:61005
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:61015
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:61016
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:61014
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1803) from S7
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.275560)
[S16] loaded HEAD from S7 (vec_in norm=1.275560)
[S16] cosine check vs S7: cos=-0.0602
[S16] DROPPED delta from S7 (cos=-0.0602 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1802) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.292984)
[S15] loaded HEAD from S8 (vec_in norm=1.292984)
[S15] cosine check vs S8: cos=0.9932
[S15] BUFFERED delta from S8 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1800) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.428506)
[S5] loaded HEAD from S11 (vec_in norm=1.428506)
[S5] cosine check vs S11: cos=0.9972
[S5] BUFFERED delta from S11 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1799) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.850401)
[S14] loaded HEAD from S10 (vec_in norm=1.850401)
[S14] cosine check vs S10: cos=0.9987
[S14] BUFFERED delta from S10 (total buffered=1)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:61009
[S15] sending update (kind=head size=1798 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S15
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.318635)
[S8] loaded HEAD from S15 (vec_in norm=1.318635)
[S8] cosine check vs S15: cos=0.9932
[S8] BUFFERED delta from S15 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:61008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:61012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:61007
[S16] sending update (kind=head size=1800 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1800) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.992120)
[S7] loaded HEAD from S16 (vec_in norm=1.992120)
[S7] cosine check vs S16: cos=-0.0602
[S7] DROPPED delta from S16 (cos=-0.0602 < 0.0)
[S17] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1795) from S5
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.425770)
[S11] loaded HEAD from S5 (vec_in norm=1.425770)
[S11] cosine check vs S5: cos=0.9972
[S11] BUFFERED delta from S5 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1802) from S17
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.155615)
[S6] loaded HEAD from S17 (vec_in norm=1.155615)
[S6] cosine check vs S17: cos=0.9602
[S6] BUFFERED delta from S17 (total buffered=1)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=29 metric=0.7265 head_norm=1.239174
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.738335e-01
[S6] stored merged vector for next round verification (round=29)
[S6] DEBUG after merge:  round=29 metric=0.7211 head_norm=1.185445 delta_norm=0.173834
[S6] aggregate: ROLLBACK (f1_val pre=0.726 post=0.721 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=29 metric=0.9936 head_norm=1.292984
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.694470e-02
[S8] stored merged vector for next round verification (round=29)
[S8] DEBUG after merge:  round=29 metric=0.9936 head_norm=1.303604 delta_norm=0.076945
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=29 metric=0.9964 head_norm=1.428506
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.297469e-02
[S11] stored merged vector for next round verification (round=29)
[S11] DEBUG after merge:  round=29 metric=0.9964 head_norm=1.426155 delta_norm=0.052975
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=29 metric=0.8208 head_norm=1.425770
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.297469e-02
[S5] stored merged vector for next round verification (round=29)
[S5] DEBUG after merge:  round=29 metric=0.7920 head_norm=1.426155 delta_norm=0.052975
[S5] aggregate: ROLLBACK (f1_val pre=0.821 post=0.792 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=29 metric=0.9025 head_norm=1.318635
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.694469e-02
[S15] stored merged vector for next round verification (round=29)
[S15] DEBUG after merge:  round=29 metric=0.9052 head_norm=1.303604 delta_norm=0.076945
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=29 metric=0.9972 head_norm=1.865886
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.812504e-02
[S14] stored merged vector for next round verification (round=29)
[S14] DEBUG after merge:  round=29 metric=0.9972 head_norm=1.857537 delta_norm=0.048125
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=1.943614 (no previous merge yet)
[S2] round=30 local utility u=0.175675 metrics={'f1_val': 0.789057348752319, 'auprc': 0.9404376083983889, 'loss_val': 0.3685813824789193, 'psi': 0.8496094526107469}-{'f1_val': 0.7284168249880483, 'auprc': 0.9468733154713845, 'loss_val': 0.3753951101311743, 'psi': 0.8157994211813828}
[S3] START round=30 head_norm_before_train=1.999197 cos_to_last_merge=0.7901 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.790
[S3] round=30 local utility u=0.000000 metrics={'f1_val': 0.9242560165089244, 'auprc': 0.9841967562222342, 'loss_val': 0.23372934536481216, 'psi': 0.9482323123942483}-{'f1_val': 0.9423013220041317, 'auprc': 0.9889821625613965, 'loss_val': 0.18608846716228092, 'psi': 0.9609736582270376}
[S4] START round=30 head_norm_before_train=1.894633 (no previous merge yet)
[S4] round=30 local utility u=0.000000 metrics={'f1_val': 0.9512212857688299, 'auprc': 0.957946739379371, 'loss_val': 0.26426956874318164, 'psi': 0.9539114672130464}-{'f1_val': 0.9522967497440745, 'auprc': 0.960858760537824, 'loss_val': 0.26239934924764585, 'psi': 0.9557215540615743}
[S5] START round=30 head_norm_before_train=1.426155 cos_to_last_merge=1.0000 (last merge round=29)
[S5] round=30 local utility u=0.544903 metrics={'f1_val': 0.9916109819603469, 'auprc': 0.9979875222870558, 'loss_val': 0.13038897704406327, 'psi': 0.9941615980910306}-{'f1_val': 0.8207888015139936, 'auprc': 0.9966312562622407, 'loss_val': 0.19119330699800413, 'psi': 0.8911257834132924}
[S6] START round=30 head_norm_before_train=1.185445 cos_to_last_merge=1.0000 (last merge round=29)
[S6] round=30 local utility u=0.418731 metrics={'f1_val': 0.8248896238729846, 'auprc': 0.9350121458542581, 'loss_val': 0.37008418336305143, 'psi': 0.868938632665494}-{'f1_val': 0.7264506256551984, 'auprc': 0.9304258109368555, 'loss_val': 0.6031526361904721, 'psi': 0.8080406997678613}
[S7] START round=30 head_norm_before_train=1.275560 cos_to_last_merge=0.9827 (last merge round=22)
[S7] round=30 local utility u=0.000000 metrics={'f1_val': 0.621003885476211, 'auprc': 0.8016999333251469, 'loss_val': 0.5488691908538382, 'psi': 0.6932823046157853}-{'f1_val': 0.6594048309179377, 'auprc': 0.8115885873996995, 'loss_val': 0.4596341389860223, 'psi': 0.7202783335106424}
[S8] START round=30 head_norm_before_train=1.303604 cos_to_last_merge=1.0000 (last merge round=29)
[S8] round=30 local utility u=0.000000 metrics={'f1_val': 0.9934667705418724, 'auprc': 0.9891826938916564, 'loss_val': 0.08210467982065199, 'psi': 0.991753139881786}-{'f1_val': 0.9935542741987232, 'auprc': 0.9984475019495328, 'loss_val': 0.08381529293432126, 'psi': 0.995511565299047}
[S9] START round=30 head_norm_before_train=1.441742 cos_to_last_merge=0.9744 (last merge round=21)
[S9] round=30 local utility u=0.043071 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9981618551275476, 'loss_val': 0.031308984805136955, 'psi': 0.9972610491393539}-{'f1_val': 0.988279001546821, 'auprc': 0.994039518790867, 'loss_val': 0.05479562079085894, 'psi': 0.9905832084444395}
[S10] START round=30 head_norm_before_train=1.850401 cos_to_last_merge=0.9994 (last merge round=25)
[S10] round=30 local utility u=0.001737 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9953464568504847, 'loss_val': 0.03382877055064576, 'psi': 0.9953324550784322}-{'f1_val': 0.9942256070413027, 'auprc': 0.9967436755755915, 'loss_val': 0.03490903199225902, 'psi': 0.9952328344550182}
[S11] START round=30 head_norm_before_train=1.426155 cos_to_last_merge=1.0000 (last merge round=29)
[S11] round=30 local utility u=0.006137 metrics={'f1_val': 0.9952716411789146, 'auprc': 0.9947375680952301, 'loss_val': 0.11386782165325683, 'psi': 0.9950580119454409}-{'f1_val': 0.9963552463558643, 'auprc': 0.9959472500854868, 'loss_val': 0.136272942611097, 'psi': 0.9961920478477133}
[S13] START round=30 head_norm_before_train=1.228690 cos_to_last_merge=0.9606 (last merge round=20)
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.6262681468378779, 'auprc': 0.6744517923365222, 'loss_val': 0.7117876677154303, 'psi': 0.6455416050373356}-{'f1_val': 0.6256628072031514, 'auprc': 0.682276226303932, 'loss_val': 0.6856160073116749, 'psi': 0.6483081748434636}
[S14] START round=30 head_norm_before_train=1.857537 cos_to_last_merge=1.0000 (last merge round=29)
[S14] round=30 local utility u=0.000751 metrics={'f1_val': 0.9976538428159559, 'auprc': 0.9971218663225361, 'loss_val': 0.038671782636540426, 'psi': 0.997441052218588}-{'f1_val': 0.9972435617623723, 'auprc': 0.9973789698120934, 'loss_val': 0.038482599827279175, 'psi': 0.9972977249822608}
[S15] START round=30 head_norm_before_train=1.303604 cos_to_last_merge=1.0000 (last merge round=29)
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.7011898773778112, 'auprc': 0.9664951211918845, 'loss_val': 0.4354501047142739, 'psi': 0.8073119749034405}-{'f1_val': 0.9024637499459172, 'auprc': 0.9945192710477097, 'loss_val': 0.19649939069221728, 'psi': 0.9392859583866341}
[S16] START round=30 head_norm_before_train=1.992120 (no previous merge yet)
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.9233359202437338, 'auprc': 0.9910696613121861, 'loss_val': 0.34431070215293585, 'psi': 0.9504294166711147}-{'f1_val': 0.9396057722509935, 'auprc': 0.9930676710733153, 'loss_val': 0.22478861080783163, 'psi': 0.9609905317799223}
[S17] START round=30 head_norm_before_train=1.155615 cos_to_last_merge=0.9993 (last merge round=28)
[S17] round=30 local utility u=0.000000 metrics={'f1_val': 0.40096042577411733, 'auprc': 0.8242308648621011, 'loss_val': 0.8871244777690385, 'psi': 0.5702686014093108}-{'f1_val': 0.40277999908485806, 'auprc': 0.830731965402718, 'loss_val': 0.8350859012240075, 'psi': 0.573960785612002}
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S16
[S9]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S8]  timeout peer S3
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S13
[S8]  timeout peer S16
[S8]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S9
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S8
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S4
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:61012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:61017
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:61015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:61014
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:61005
[S11] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S16] ⇄ pheromone p=0.101 → S7@127.0.0.1:61008
[S9] sending update (kind=head size=1801 to 1 peers)
[S13] ⇄ pheromone p=0.043 → S17@127.0.0.1:61017
[S5] sending update (kind=head size=1798 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1798) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.455853)
[S5] loaded HEAD from S11 (vec_in norm=1.455853)
[S5] cosine check vs S11: cos=0.9988
[S5] BUFFERED delta from S11 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1803) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.240323)
[S17] loaded HEAD from S6 (vec_in norm=1.240323)
[S17] cosine check vs S6: cos=0.9808
[S17] BUFFERED delta from S6 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1804) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.863374)
[S14] loaded HEAD from S10 (vec_in norm=1.863374)
[S14] cosine check vs S10: cos=0.9993
[S14] BUFFERED delta from S10 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1798) from S5
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.475351)
[S11] loaded HEAD from S5 (vec_in norm=1.475351)
[S11] cosine check vs S5: cos=0.9988
[S11] BUFFERED delta from S5 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1801) from S9
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.462668)
[S15] loaded HEAD from S9 (vec_in norm=1.462668)
[S15] cosine check vs S9: cos=0.9488
[S15] BUFFERED delta from S9 (total buffered=1)
[S9] ⇄ pheromone p=0.037 → S15@127.0.0.1:61015
[S6] ⇄ pheromone p=0.208 → S17@127.0.0.1:61017
[S10] ⇄ pheromone p=0.013 → S14@127.0.0.1:61014
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:61009
[S14] sending update (kind=head size=1803 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1803) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.873401)
[S8] loaded HEAD from S14 (vec_in norm=1.873401)
[S8] cosine check vs S14: cos=-0.1664
[S8] DROPPED delta from S14 (cos=-0.1664 < 0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=30 metric=0.9977 head_norm=1.873401
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.474353e-02
[S14] stored merged vector for next round verification (round=30)
[S14] DEBUG after merge:  round=30 metric=0.9977 head_norm=1.868071 delta_norm=0.034744
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.010 → S8@127.0.0.1:61009
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=30 metric=0.9916 head_norm=1.475351
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.783409e-02
[S5] stored merged vector for next round verification (round=30)
[S5] DEBUG after merge:  round=30 metric=0.9827 head_norm=1.465146 delta_norm=0.037834
[S5] aggregate: ROLLBACK (f1_val pre=0.992 post=0.983 tol_abs=0.005 tol_rel=0.0)
[S5] ⇄ pheromone p=0.302 → S11@127.0.0.1:61012
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=30 metric=0.9953 head_norm=1.455853
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.783409e-02
[S11] stored merged vector for next round verification (round=30)
[S11] DEBUG after merge:  round=30 metric=0.9953 head_norm=1.465146 delta_norm=0.037834
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.082 → S5@127.0.0.1:61005
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=30 metric=0.7012 head_norm=1.332463
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.325860e-01
[S15] stored merged vector for next round verification (round=30)
[S15] DEBUG after merge:  round=30 metric=0.7005 head_norm=1.379613 delta_norm=0.232586
[S15] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.150 → S8@127.0.0.1:61009
[S7] ⇄ pheromone p=0.180 → S13@127.0.0.1:61013
[S17] CommDone barrier timeout: have=2 need=3 — continuing
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=30 metric=0.4010 head_norm=1.177851
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.225470e-01
[S17] stored merged vector for next round verification (round=30)
[S17] DEBUG after merge:  round=30 metric=0.4013 head_norm=1.203266 delta_norm=0.122547
[S17] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.098 → S7@127.0.0.1:61008
[S8] CommDone barrier timeout: have=2 need=4 — continuing
[S8] ⇄ pheromone p=0.074 → S15@127.0.0.1:61015
[S2] START round=31 head_norm_before_train=1.954524 (no previous merge yet)
[S2] round=31 local utility u=0.000000 metrics={'f1_val': 0.8310205767296313, 'auprc': 0.8002066313935057, 'loss_val': 0.33136272213340817, 'psi': 0.818694998595181}-{'f1_val': 0.789057348752319, 'auprc': 0.9404376083983889, 'loss_val': 0.3685813824789193, 'psi': 0.8496094526107469}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=31 head_norm_before_train=2.014884 cos_to_last_merge=0.7884 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.788
[S3] round=31 local utility u=0.000000 metrics={'f1_val': 0.8966051574324009, 'auprc': 0.9892941622010116, 'loss_val': 0.23500197191963146, 'psi': 0.9336807593398451}-{'f1_val': 0.9242560165089244, 'auprc': 0.9841967562222342, 'loss_val': 0.23372934536481216, 'psi': 0.9482323123942483}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=31 head_norm_before_train=1.906444 (no previous merge yet)
[S4] round=31 local utility u=0.026123 metrics={'f1_val': 0.9556342128446054, 'auprc': 0.9638170660928005, 'loss_val': 0.25611139016442624, 'psi': 0.9589073541438834}-{'f1_val': 0.9512212857688299, 'auprc': 0.957946739379371, 'loss_val': 0.26426956874318164, 'psi': 0.9539114672130464}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] sending update (kind=head size=1795 to 1 peers)
[S5] START round=31 head_norm_before_train=1.465146 cos_to_last_merge=1.0000 (last merge round=30)
[S5] round=31 local utility u=0.035172 metrics={'f1_val': 0.996847640985552, 'auprc': 0.9983245535372501, 'loss_val': 0.0924751522579287, 'psi': 0.9974384060062313}-{'f1_val': 0.9916109819603469, 'auprc': 0.9979875222870558, 'loss_val': 0.13038897704406327, 'psi': 0.9941615980910306}
[S6] START round=31 head_norm_before_train=1.240323 cos_to_last_merge=0.9988 (last merge round=29)
[S6] round=31 local utility u=0.000000 metrics={'f1_val': 0.6950919013138114, 'auprc': 0.9169753844555375, 'loss_val': 0.651521139490164, 'psi': 0.7838452945705019}-{'f1_val': 0.8248896238729846, 'auprc': 0.9350121458542581, 'loss_val': 0.37008418336305143, 'psi': 0.868938632665494}
[S7] START round=31 head_norm_before_train=1.291794 cos_to_last_merge=0.9806 (last merge round=22)
[S7] round=31 local utility u=0.342458 metrics={'f1_val': 0.6844599574071757, 'auprc': 0.8453687670012812, 'loss_val': 0.37569583709230214, 'psi': 0.7488234812448179}-{'f1_val': 0.621003885476211, 'auprc': 0.8016999333251469, 'loss_val': 0.5488691908538382, 'psi': 0.6932823046157853}
[S8] START round=31 head_norm_before_train=1.329234 cos_to_last_merge=0.9998 (last merge round=29)
[S8] round=31 local utility u=0.019549 metrics={'f1_val': 0.9933095825478181, 'auprc': 0.9984621160935355, 'loss_val': 0.06990112741255737, 'psi': 0.9953705959661051}-{'f1_val': 0.9934667705418724, 'auprc': 0.9891826938916564, 'loss_val': 0.08210467982065199, 'psi': 0.991753139881786}
[S9] START round=31 head_norm_before_train=1.462668 cos_to_last_merge=0.9723 (last merge round=21)
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.9878532334303461, 'auprc': 0.9981072919572066, 'loss_val': 0.05632846108345161, 'psi': 0.9919548568410903}-{'f1_val': 0.9966605118138915, 'auprc': 0.9981618551275476, 'loss_val': 0.031308984805136955, 'psi': 0.9972610491393539}
[S10] START round=31 head_norm_before_train=1.863374 cos_to_last_merge=0.9992 (last merge round=25)
[S10] round=31 local utility u=0.000000 metrics={'f1_val': 0.9948838907637279, 'auprc': 0.9956910108753105, 'loss_val': 0.03293595565981929, 'psi': 0.995206738808361}-{'f1_val': 0.9953231205637304, 'auprc': 0.9953464568504847, 'loss_val': 0.03382877055064576, 'psi': 0.9953324550784322}
[S11] START round=31 head_norm_before_train=1.465146 cos_to_last_merge=1.0000 (last merge round=30)
[S11] round=31 local utility u=0.000000 metrics={'f1_val': 0.9837585219708125, 'auprc': 0.9941069139002586, 'loss_val': 0.09919397532313631, 'psi': 0.9878978787425909}-{'f1_val': 0.9952716411789146, 'auprc': 0.9947375680952301, 'loss_val': 0.11386782165325683, 'psi': 0.9950580119454409}
[S13] START round=31 head_norm_before_train=1.244486 cos_to_last_merge=0.9583 (last merge round=20)
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.6289322665481485, 'auprc': 0.655014740314285, 'loss_val': 0.6863465325925158, 'psi': 0.639365256054603}-{'f1_val': 0.6262681468378779, 'auprc': 0.6744517923365222, 'loss_val': 0.7117876677154303, 'psi': 0.6455416050373356}
[S14] START round=31 head_norm_before_train=1.868071 cos_to_last_merge=1.0000 (last merge round=30)
[S14] round=31 local utility u=0.001040 metrics={'f1_val': 0.9978217593544257, 'auprc': 0.9971449228285749, 'loss_val': 0.037669393248285665, 'psi': 0.9975510247440854}-{'f1_val': 0.9976538428159559, 'auprc': 0.9971218663225361, 'loss_val': 0.038671782636540426, 'psi': 0.997441052218588}
[S15] START round=31 head_norm_before_train=1.379613 cos_to_last_merge=1.0000 (last merge round=30)
[S15] round=31 local utility u=0.734568 metrics={'f1_val': 0.8907965637134893, 'auprc': 0.9947088386665563, 'loss_val': 0.18859502640222234, 'psi': 0.9323614736947161}-{'f1_val': 0.7011898773778112, 'auprc': 0.9664951211918845, 'loss_val': 0.4354501047142739, 'psi': 0.8073119749034405}
[S16] START round=31 head_norm_before_train=2.005538 (no previous merge yet)
[S16] round=31 local utility u=0.151221 metrics={'f1_val': 0.9411103872184207, 'auprc': 0.9942588675599379, 'loss_val': 0.15808300777178966, 'psi': 0.9623697793550275}-{'f1_val': 0.9233359202437338, 'auprc': 0.9910696613121861, 'loss_val': 0.34431070215293585, 'psi': 0.9504294166711147}
[S17] START round=31 head_norm_before_train=1.203266 cos_to_last_merge=1.0000 (last merge round=30)
[S17] round=31 local utility u=0.087939 metrics={'f1_val': 0.41129078259854546, 'auprc': 0.8277592550284179, 'loss_val': 0.7838129375699141, 'psi': 0.5778781715704945}-{'f1_val': 0.40096042577411733, 'auprc': 0.8242308648621011, 'loss_val': 0.8871244777690385, 'psi': 0.5702686014093108}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:61008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:61012
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:61013
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:61009
[S16] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:61009
[S11] RECEIVED delta(kind=head bytes=1798) from S5
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.510355)
[S11] loaded HEAD from S5 (vec_in norm=1.510355)
[S11] cosine check vs S5: cos=0.9990
[S11] BUFFERED delta from S5 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1799) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=2.016148)
[S7] loaded HEAD from S16 (vec_in norm=2.016148)
[S7] cosine check vs S16: cos=-0.0594
[S7] DROPPED delta from S16 (cos=-0.0594 < 0.0)
[S15] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1799) from S7
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.309052)
[S13] loaded HEAD from S7 (vec_in norm=1.309052)
[S13] cosine check vs S7: cos=0.9298
[S13] BUFFERED delta from S7 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1798) from S15
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.402871)
[S8] loaded HEAD from S15 (vec_in norm=1.402871)
[S8] cosine check vs S15: cos=0.9841
[S8] BUFFERED delta from S15 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1799) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.884822)
[S8] loaded HEAD from S14 (vec_in norm=1.884822)
[S8] cosine check vs S14: cos=-0.1680
[S8] DROPPED delta from S14 (cos=-0.1680 < 0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=31 metric=0.9838 head_norm=1.493298
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.482298e-02
[S11] stored merged vector for next round verification (round=31)
[S11] DEBUG after merge:  round=31 metric=0.9846 head_norm=1.501447 delta_norm=0.034823
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S13]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S4
[S8]  timeout peer S11
[S7]  timeout peer S13
[S11]  timeout peer S3
[S9]  timeout peer S15
[S17]  timeout peer S7
[S17]  timeout peer S9
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:61015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:61007
[S8] sending update (kind=head size=1804 to 1 peers)
[S17] sending update (kind=head size=1801 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1801) from S17
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.222944)
[S6] loaded HEAD from S17 (vec_in norm=1.222944)
[S6] cosine check vs S17: cos=0.9885
[S6] BUFFERED delta from S17 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1804) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.350611)
[S15] loaded HEAD from S8 (vec_in norm=1.350611)
[S15] cosine check vs S8: cos=0.9841
[S15] BUFFERED delta from S8 (total buffered=1)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=31 metric=0.9933 head_norm=1.350611
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.253431e-01
[S8] stored merged vector for next round verification (round=31)
[S8] DEBUG after merge:  round=31 metric=0.9933 head_norm=1.371272 delta_norm=0.125343
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=32 head_norm_before_train=1.965118 (no previous merge yet)
[S2] round=32 local utility u=0.000000 metrics={'f1_val': 0.7501310287484972, 'auprc': 0.945346039945431, 'loss_val': 0.40086361634646633, 'psi': 0.8282170332272707}-{'f1_val': 0.8310205767296313, 'auprc': 0.8002066313935057, 'loss_val': 0.33136272213340817, 'psi': 0.818694998595181}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=32 head_norm_before_train=2.028706 cos_to_last_merge=0.7868 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.787
[S3] round=32 local utility u=0.000000 metrics={'f1_val': 0.8197534824464702, 'auprc': 0.9900855071780017, 'loss_val': 0.319723407472033, 'psi': 0.8878862923390828}-{'f1_val': 0.8966051574324009, 'auprc': 0.9892941622010116, 'loss_val': 0.23500197191963146, 'psi': 0.9336807593398451}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=32 head_norm_before_train=1.914184 (no previous merge yet)
[S4] round=32 local utility u=0.000000 metrics={'f1_val': 0.9538093448048757, 'auprc': 0.958184429279964, 'loss_val': 0.26161919691814756, 'psi': 0.955559378594911}-{'f1_val': 0.9556342128446054, 'auprc': 0.9638170660928005, 'loss_val': 0.25611139016442624, 'psi': 0.9589073541438834}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=32 head_norm_before_train=1.510355 cos_to_last_merge=0.9992 (last merge round=30)
[S5] round=32 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9946959340352919, 'loss_val': 0.09942688003678238, 'psi': 0.9956786607922508}-{'f1_val': 0.996847640985552, 'auprc': 0.9983245535372501, 'loss_val': 0.0924751522579287, 'psi': 0.9974384060062313}
[S6] START round=32 head_norm_before_train=1.304705 cos_to_last_merge=0.9956 (last merge round=29)
[S6] round=32 local utility u=0.463253 metrics={'f1_val': 0.8113793317665166, 'auprc': 0.9364180975984343, 'loss_val': 0.481068745003092, 'psi': 0.8613948380992836}-{'f1_val': 0.6950919013138114, 'auprc': 0.9169753844555375, 'loss_val': 0.651521139490164, 'psi': 0.7838452945705019}
[S7] START round=32 head_norm_before_train=1.309052 cos_to_last_merge=0.9787 (last merge round=22)
[S7] round=32 local utility u=0.000000 metrics={'f1_val': 0.6648787383379557, 'auprc': 0.8193922588304436, 'loss_val': 0.5085444126634712, 'psi': 0.726684146534951}-{'f1_val': 0.6844599574071757, 'auprc': 0.8453687670012812, 'loss_val': 0.37569583709230214, 'psi': 0.7488234812448179}
[S8] START round=32 head_norm_before_train=1.371272 cos_to_last_merge=1.0000 (last merge round=31)
[S8] round=32 local utility u=0.000751 metrics={'f1_val': 0.9929024225986427, 'auprc': 0.9984574663205883, 'loss_val': 0.06594154876082169, 'psi': 0.995124440087421}-{'f1_val': 0.9933095825478181, 'auprc': 0.9984621160935355, 'loss_val': 0.06990112741255737, 'psi': 0.9953705959661051}
[S9] START round=32 head_norm_before_train=1.478191 cos_to_last_merge=0.9704 (last merge round=21)
[S9] round=32 local utility u=0.038668 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.998216545197151, 'loss_val': 0.029701161345397534, 'psi': 0.997036674946427}-{'f1_val': 0.9878532334303461, 'auprc': 0.9981072919572066, 'loss_val': 0.05632846108345161, 'psi': 0.9919548568410903}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] sending update (kind=head size=1793 to 1 peers)
[S10] START round=32 head_norm_before_train=1.876752 cos_to_last_merge=0.9989 (last merge round=25)
[S10] round=32 local utility u=0.002457 metrics={'f1_val': 0.9948674007110037, 'auprc': 0.9971095487059376, 'loss_val': 0.03217854084730398, 'psi': 0.9957642599089773}-{'f1_val': 0.9948838907637279, 'auprc': 0.9956910108753105, 'loss_val': 0.03293595565981929, 'psi': 0.995206738808361}
[S11] START round=32 head_norm_before_train=1.501447 cos_to_last_merge=1.0000 (last merge round=31)
[S11] round=32 local utility u=0.005254 metrics={'f1_val': 0.9915475411712865, 'auprc': 0.9936136851190434, 'loss_val': 0.13393965384629405, 'psi': 0.9923739987503892}-{'f1_val': 0.9837585219708125, 'auprc': 0.9941069139002586, 'loss_val': 0.09919397532313631, 'psi': 0.9878978787425909}
[S13] START round=32 head_norm_before_train=1.256258 cos_to_last_merge=0.9564 (last merge round=20)
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.6179376786526607, 'auprc': 0.6819539477590544, 'loss_val': 0.7643582358925959, 'psi': 0.6435441862952183}-{'f1_val': 0.6289322665481485, 'auprc': 0.655014740314285, 'loss_val': 0.6863465325925158, 'psi': 0.639365256054603}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=32 metric=0.6179 head_norm=1.267508
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.443257e-01
[S13] stored merged vector for next round verification (round=32)
[S13] DEBUG after merge:  round=32 metric=0.6183 head_norm=1.265069 delta_norm=0.244326
[S13] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] START round=32 head_norm_before_train=1.884822 cos_to_last_merge=1.0000 (last merge round=30)
[S14] round=32 local utility u=0.000000 metrics={'f1_val': 0.9972338922372435, 'auprc': 0.9979953820831329, 'loss_val': 0.04278116788906525, 'psi': 0.9975384881755993}-{'f1_val': 0.9978217593544257, 'auprc': 0.9971449228285749, 'loss_val': 0.037669393248285665, 'psi': 0.9975510247440854}
[S15] START round=32 head_norm_before_train=1.402871 cos_to_last_merge=0.9999 (last merge round=30)
[S15] round=32 local utility u=0.000000 metrics={'f1_val': 0.8504601343599056, 'auprc': 0.991661263246142, 'loss_val': 0.22500668022579834, 'psi': 0.9069405859144002}-{'f1_val': 0.8907965637134893, 'auprc': 0.9947088386665563, 'loss_val': 0.18859502640222234, 'psi': 0.9323614736947161}
[S16] START round=32 head_norm_before_train=2.016148 (no previous merge yet)
[S16] round=32 local utility u=0.210144 metrics={'f1_val': 0.9915135031698585, 'auprc': 0.9953601871351555, 'loss_val': 0.04351674615266019, 'psi': 0.9930521767559773}-{'f1_val': 0.9411103872184207, 'auprc': 0.9942588675599379, 'loss_val': 0.15808300777178966, 'psi': 0.9623697793550275}
[S17] START round=32 head_norm_before_train=1.222944 cos_to_last_merge=0.9995 (last merge round=30)
[S17] round=32 local utility u=0.323952 metrics={'f1_val': 0.559206899099209, 'auprc': 0.8099081773072179, 'loss_val': 0.9698519224430022, 'psi': 0.6594874103824125}-{'f1_val': 0.41129078259854546, 'auprc': 0.8277592550284179, 'loss_val': 0.7838129375699141, 'psi': 0.5778781715704945}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] sending update (kind=head size=1804 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:61005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] not sending this round → trigger blocked (psi=0.659)
[S11] sending update (kind=head size=1797 to 1 peers)
[S8] not sending this round → trigger blocked (psi=0.995)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=32 metric=0.8114 head_norm=1.361188
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.363096e-01
[S6] stored merged vector for next round verification (round=32)
[S6] DEBUG after merge:  round=32 metric=0.8121 head_norm=1.286714 delta_norm=0.136310
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S5] RECEIVED delta(kind=head bytes=1797) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.528932)
[S5] loaded HEAD from S11 (vec_in norm=1.528932)
[S5] cosine check vs S11: cos=0.9985
[S5] BUFFERED delta from S11 (total buffered=1)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=32 metric=0.8505 head_norm=1.425492
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.290817e-01
[S15] stored merged vector for next round verification (round=32)
[S15] DEBUG after merge:  round=32 metric=0.8613 head_norm=1.382543 delta_norm=0.129082
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=33 head_norm_before_train=1.973688 (no previous merge yet)
[S2] round=33 local utility u=0.243527 metrics={'f1_val': 0.828582474646935, 'auprc': 0.9379878571899465, 'loss_val': 0.3624432212837501, 'psi': 0.8723446276641396}-{'f1_val': 0.7501310287484972, 'auprc': 0.945346039945431, 'loss_val': 0.40086361634646633, 'psi': 0.8282170332272707}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=33 head_norm_before_train=2.042041 cos_to_last_merge=0.7852 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.785
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.6950101539625418, 'auprc': 0.9851891213626917, 'loss_val': 0.6763189693086634, 'psi': 0.8110817409226019}-{'f1_val': 0.8197534824464702, 'auprc': 0.9900855071780017, 'loss_val': 0.319723407472033, 'psi': 0.8878862923390828}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=33 head_norm_before_train=1.922182 (no previous merge yet)
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.945347568641755, 'auprc': 0.9501347503358916, 'loss_val': 0.2736309835986818, 'psi': 0.9472624413194095}-{'f1_val': 0.9538093448048757, 'auprc': 0.958184429279964, 'loss_val': 0.26161919691814756, 'psi': 0.955559378594911}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=33 head_norm_before_train=1.546899 cos_to_last_merge=0.9979 (last merge round=30)
[S5] round=33 local utility u=0.000000 metrics={'f1_val': 0.9714542355166684, 'auprc': 0.9973545147805882, 'loss_val': 0.09815674035077945, 'psi': 0.9818143472222363}-{'f1_val': 0.9963338119635569, 'auprc': 0.9946959340352919, 'loss_val': 0.09942688003678238, 'psi': 0.9956786607922508}
[S6] START round=33 head_norm_before_train=1.286714 cos_to_last_merge=1.0000 (last merge round=32)
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.7710013768819108, 'auprc': 0.9288633750652819, 'loss_val': 0.5529481603190765, 'psi': 0.8341461761552593}-{'f1_val': 0.8113793317665166, 'auprc': 0.9364180975984343, 'loss_val': 0.481068745003092, 'psi': 0.8613948380992836}
[S7] START round=33 head_norm_before_train=1.328129 cos_to_last_merge=0.9767 (last merge round=22)
[S7] round=33 local utility u=0.000000 metrics={'f1_val': 0.6568804046304678, 'auprc': 0.8104585110869766, 'loss_val': 0.5255266348534863, 'psi': 0.7183116472130713}-{'f1_val': 0.6648787383379557, 'auprc': 0.8193922588304436, 'loss_val': 0.5085444126634712, 'psi': 0.726684146534951}
[S8] START round=33 head_norm_before_train=1.392890 cos_to_last_merge=0.9999 (last merge round=31)
[S8] round=33 local utility u=0.000000 metrics={'f1_val': 0.9930990485370332, 'auprc': 0.9887875228080422, 'loss_val': 0.06367179996098794, 'psi': 0.9913744382454368}-{'f1_val': 0.9929024225986427, 'auprc': 0.9984574663205883, 'loss_val': 0.06594154876082169, 'psi': 0.995124440087421}
[S9] START round=33 head_norm_before_train=1.493385 cos_to_last_merge=0.9688 (last merge round=21)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.9895654130089716, 'auprc': 0.99405179776252, 'loss_val': 0.049576928009011985, 'psi': 0.991359966910391}-{'f1_val': 0.9962500947792776, 'auprc': 0.998216545197151, 'loss_val': 0.029701161345397534, 'psi': 0.997036674946427}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=33 head_norm_before_train=1.890285 cos_to_last_merge=0.9987 (last merge round=25)
[S10] round=33 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9949394198994221, 'loss_val': 0.03163339128464535, 'psi': 0.995169640298007}-{'f1_val': 0.9948674007110037, 'auprc': 0.9971095487059376, 'loss_val': 0.03217854084730398, 'psi': 0.9957642599089773}
[S11] START round=33 head_norm_before_train=1.528932 cos_to_last_merge=0.9997 (last merge round=31)
[S11] round=33 local utility u=0.040235 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9932925935013318, 'loss_val': 0.08002384115165673, 'psi': 0.9949972423485183}-{'f1_val': 0.9915475411712865, 'auprc': 0.9936136851190434, 'loss_val': 0.13393965384629405, 'psi': 0.9923739987503892}
[S13] START round=33 head_norm_before_train=1.265069 cos_to_last_merge=1.0000 (last merge round=32)
[S13] round=33 local utility u=0.067099 metrics={'f1_val': 0.6289203276967968, 'auprc': 0.676041072811385, 'loss_val': 0.6783178375830637, 'psi': 0.6477686257426322}-{'f1_val': 0.6179376786526607, 'auprc': 0.6819539477590544, 'loss_val': 0.7643582358925959, 'psi': 0.6435441862952183}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S13] sending update (kind=head size=1790 to 1 peers)
[S14] START round=33 head_norm_before_train=1.900623 cos_to_last_merge=0.9998 (last merge round=30)
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.9591989392924253, 'auprc': 0.9985691620142885, 'loss_val': 0.06813565531529933, 'psi': 0.9749470283811705}-{'f1_val': 0.9972338922372435, 'auprc': 0.9979953820831329, 'loss_val': 0.04278116788906525, 'psi': 0.9975384881755993}
[S15] START round=33 head_norm_before_train=1.382543 cos_to_last_merge=1.0000 (last merge round=32)
[S15] round=33 local utility u=0.000000 metrics={'f1_val': 0.7693087515334822, 'auprc': 0.9773316064654555, 'loss_val': 0.384362187497197, 'psi': 0.8525178935062715}-{'f1_val': 0.8504601343599056, 'auprc': 0.991661263246142, 'loss_val': 0.22500668022579834, 'psi': 0.9069405859144002}
[S16] START round=33 head_norm_before_train=2.026744 (no previous merge yet)
[S16] round=33 local utility u=0.002624 metrics={'f1_val': 0.9917527102534209, 'auprc': 0.9950975494290826, 'loss_val': 0.038916249772295144, 'psi': 0.9930906459236856}-{'f1_val': 0.9915135031698585, 'auprc': 0.9953601871351555, 'loss_val': 0.04351674615266019, 'psi': 0.9930521767559773}
[S17] START round=33 head_norm_before_train=1.242486 cos_to_last_merge=0.9983 (last merge round=30)
[S17] round=33 local utility u=0.426642 metrics={'f1_val': 0.6643523280494744, 'auprc': 0.8280899745683858, 'loss_val': 0.8019857213726108, 'psi': 0.729847386657039}-{'f1_val': 0.559206899099209, 'auprc': 0.8099081773072179, 'loss_val': 0.9698519224430022, 'psi': 0.6594874103824125}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.993)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.995)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=33 metric=0.9715 head_norm=1.573693
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.818220e-02
[S5] stored merged vector for next round verification (round=33)
[S5] DEBUG after merge:  round=33 metric=0.9680 head_norm=1.550383 delta_norm=0.058182
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:61007
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1802 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1802) from S17
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.263874)
[S6] loaded HEAD from S17 (vec_in norm=1.263874)
[S6] cosine check vs S17: cos=0.9882
[S6] BUFFERED delta from S17 (total buffered=1)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=34 head_norm_before_train=1.983471 (no previous merge yet)
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.828582474646935, 'auprc': 0.9351232242488171, 'loss_val': 0.363583072232016, 'psi': 0.8711987744876879}-{'f1_val': 0.828582474646935, 'auprc': 0.9379878571899465, 'loss_val': 0.3624432212837501, 'psi': 0.8723446276641396}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=34 head_norm_before_train=2.055147 cos_to_last_merge=0.7837 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.784
[S3] round=34 local utility u=0.859974 metrics={'f1_val': 0.8962096704838981, 'auprc': 0.996309127805813, 'loss_val': 0.1969282973554005, 'psi': 0.9362494534126641}-{'f1_val': 0.6950101539625418, 'auprc': 0.9851891213626917, 'loss_val': 0.6763189693086634, 'psi': 0.8110817409226019}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S4] START round=34 head_norm_before_train=1.934887 (no previous merge yet)
[S4] round=34 local utility u=0.061306 metrics={'f1_val': 0.9531453836967394, 'auprc': 0.9702698230146916, 'loss_val': 0.2582108286823242, 'psi': 0.9599951594239203}-{'f1_val': 0.945347568641755, 'auprc': 0.9501347503358916, 'loss_val': 0.2736309835986818, 'psi': 0.9472624413194095}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=34 head_norm_before_train=1.550383 cos_to_last_merge=1.0000 (last merge round=33)
[S5] round=34 local utility u=0.077589 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9942367029104233, 'loss_val': 0.08290306071036505, 'psi': 0.9954949683423033}-{'f1_val': 0.9714542355166684, 'auprc': 0.9973545147805882, 'loss_val': 0.09815674035077945, 'psi': 0.9818143472222363}
[S6] START round=34 head_norm_before_train=1.335879 cos_to_last_merge=0.9995 (last merge round=32)
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.5945964934202123, 'auprc': 0.9037117331462086, 'loss_val': 0.7439857408154363, 'psi': 0.7182425893106108}-{'f1_val': 0.7710013768819108, 'auprc': 0.9288633750652819, 'loss_val': 0.5529481603190765, 'psi': 0.8341461761552593}
[S7] START round=34 head_norm_before_train=1.340382 cos_to_last_merge=0.9752 (last merge round=22)
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.5590573861307369, 'auprc': 0.790510817633511, 'loss_val': 0.9829601650184844, 'psi': 0.6516387587318466}-{'f1_val': 0.6568804046304678, 'auprc': 0.8104585110869766, 'loss_val': 0.5255266348534863, 'psi': 0.7183116472130713}
[S8] START round=34 head_norm_before_train=1.412833 cos_to_last_merge=0.9996 (last merge round=31)
[S8] round=34 local utility u=0.004157 metrics={'f1_val': 0.9893390723723242, 'auprc': 0.9991178495805504, 'loss_val': 0.06378800382552566, 'psi': 0.9932505832556147}-{'f1_val': 0.9930990485370332, 'auprc': 0.9887875228080422, 'loss_val': 0.06367179996098794, 'psi': 0.9913744382454368}
[S9] START round=34 head_norm_before_train=1.505910 cos_to_last_merge=0.9675 (last merge round=21)
[S9] round=34 local utility u=0.036738 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9981291161301997, 'loss_val': 0.028440839518321763, 'psi': 0.9970017033196464}-{'f1_val': 0.9895654130089716, 'auprc': 0.99405179776252, 'loss_val': 0.049576928009011985, 'psi': 0.991359966910391}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=34 head_norm_before_train=1.903626 cos_to_last_merge=0.9984 (last merge round=25)
[S10] round=34 local utility u=0.000023 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9961092088918362, 'loss_val': 0.03114366308547861, 'psi': 0.9952423165623843}-{'f1_val': 0.9953231205637304, 'auprc': 0.9949394198994221, 'loss_val': 0.03163339128464535, 'psi': 0.995169640298007}
[S11] START round=34 head_norm_before_train=1.554684 cos_to_last_merge=0.9991 (last merge round=31)
[S11] round=34 local utility u=0.010472 metrics={'f1_val': 0.9963753869090841, 'auprc': 0.9937229604124281, 'loss_val': 0.061820900491223074, 'psi': 0.9953144163104217}-{'f1_val': 0.9961336749133093, 'auprc': 0.9932925935013318, 'loss_val': 0.08002384115165673, 'psi': 0.9949972423485183}
[S13] START round=34 head_norm_before_train=1.275077 cos_to_last_merge=0.9999 (last merge round=32)
[S13] round=34 local utility u=0.000000 metrics={'f1_val': 0.6273056633531712, 'auprc': 0.6779423085117225, 'loss_val': 0.6926407648648825, 'psi': 0.6475603214165917}-{'f1_val': 0.6289203276967968, 'auprc': 0.676041072811385, 'loss_val': 0.6783178375830637, 'psi': 0.6477686257426322}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=34 head_norm_before_train=1.916671 cos_to_last_merge=0.9997 (last merge round=30)
[S14] round=34 local utility u=0.000000 metrics={'f1_val': 0.9537658767585036, 'auprc': 0.9979287494714989, 'loss_val': 0.07776770967824871, 'psi': 0.9714310258437017}-{'f1_val': 0.9591989392924253, 'auprc': 0.9985691620142885, 'loss_val': 0.06813565531529933, 'psi': 0.9749470283811705}
[S15] START round=34 head_norm_before_train=1.404753 cos_to_last_merge=0.9999 (last merge round=32)
[S15] round=34 local utility u=0.877881 metrics={'f1_val': 0.9965259456095847, 'auprc': 0.9973242104642482, 'loss_val': 0.0518807855703571, 'psi': 0.9968452515514501}-{'f1_val': 0.7693087515334822, 'auprc': 0.9773316064654555, 'loss_val': 0.384362187497197, 'psi': 0.8525178935062715}
[S16] START round=34 head_norm_before_train=2.035851 (no previous merge yet)
[S16] round=34 local utility u=0.000000 metrics={'f1_val': 0.8660817612354991, 'auprc': 0.9961231459743725, 'loss_val': 0.6248072422696926, 'psi': 0.9180983151310484}-{'f1_val': 0.9917527102534209, 'auprc': 0.9950975494290826, 'loss_val': 0.038916249772295144, 'psi': 0.9930906459236856}
[S17] START round=34 head_norm_before_train=1.263874 cos_to_last_merge=0.9966 (last merge round=30)
[S17] round=34 local utility u=0.000000 metrics={'f1_val': 0.6472678674553316, 'auprc': 0.8157816592452489, 'loss_val': 0.9912803488011517, 'psi': 0.7146733841712986}-{'f1_val': 0.6643523280494744, 'auprc': 0.8280899745683858, 'loss_val': 0.8019857213726108, 'psi': 0.729847386657039}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:61012
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:61005
[S11] sending update (kind=head size=1799 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=34 metric=0.5946 head_norm=1.377313
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.284910e-01
[S6] stored merged vector for next round verification (round=34)
[S6] DEBUG after merge:  round=34 metric=0.5946 head_norm=1.315551 delta_norm=0.128491
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:61015
[S5] sending update (kind=head size=1801 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1799) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.577253)
[S5] loaded HEAD from S11 (vec_in norm=1.577253)
[S5] cosine check vs S11: cos=0.9979
[S5] BUFFERED delta from S11 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1801) from S5
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.573481)
[S11] loaded HEAD from S5 (vec_in norm=1.573481)
[S11] cosine check vs S5: cos=0.9979
[S11] BUFFERED delta from S5 (total buffered=1)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=34 metric=0.9964 head_norm=1.577253
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.123020e-02
[S11] stored merged vector for next round verification (round=34)
[S11] DEBUG after merge:  round=34 metric=0.9964 head_norm=1.574535 delta_norm=0.051230
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=34 metric=0.9963 head_norm=1.573481
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.123019e-02
[S5] stored merged vector for next round verification (round=34)
[S5] DEBUG after merge:  round=34 metric=0.9963 head_norm=1.574535 delta_norm=0.051230
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S8] sending update (kind=head size=1802 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1802) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.427355)
[S15] loaded HEAD from S8 (vec_in norm=1.427355)
[S15] cosine check vs S8: cos=0.9988
[S15] BUFFERED delta from S8 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:61009
[S15] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S15
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.424083)
[S8] loaded HEAD from S15 (vec_in norm=1.424083)
[S8] cosine check vs S15: cos=0.9988
[S8] BUFFERED delta from S15 (total buffered=1)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=34 metric=0.9893 head_norm=1.427355
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.509695e-02
[S8] stored merged vector for next round verification (round=34)
[S8] DEBUG after merge:  round=34 metric=0.9893 head_norm=1.425288 delta_norm=0.035097
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=34 metric=0.9965 head_norm=1.424083
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.509695e-02
[S15] stored merged vector for next round verification (round=34)
[S15] DEBUG after merge:  round=34 metric=0.9965 head_norm=1.425288 delta_norm=0.035097
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=35 head_norm_before_train=1.995485 (no previous merge yet)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.8262632996149086, 'auprc': 0.9436931884618234, 'loss_val': 0.3956151929829544, 'psi': 0.8732352551536745}-{'f1_val': 0.828582474646935, 'auprc': 0.9351232242488171, 'loss_val': 0.363583072232016, 'psi': 0.8711987744876879}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=35 head_norm_before_train=2.067936 cos_to_last_merge=0.7823 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.782
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.7756210243191639, 'auprc': 0.9905842593843429, 'loss_val': 0.4769996910256163, 'psi': 0.8616063183452355}-{'f1_val': 0.8962096704838981, 'auprc': 0.996309127805813, 'loss_val': 0.1969282973554005, 'psi': 0.9362494534126641}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=35 head_norm_before_train=1.947955 (no previous merge yet)
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.9508937820008411, 'auprc': 0.9522624283934389, 'loss_val': 0.26397694398315114, 'psi': 0.9514412405578802}-{'f1_val': 0.9531453836967394, 'auprc': 0.9702698230146916, 'loss_val': 0.2582108286823242, 'psi': 0.9599951594239203}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=35 head_norm_before_train=1.574535 cos_to_last_merge=1.0000 (last merge round=34)
[S5] round=35 local utility u=0.018392 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9984960206296931, 'loss_val': 0.06110667938862327, 'psi': 0.9974195893389519}-{'f1_val': 0.9963338119635569, 'auprc': 0.9942367029104233, 'loss_val': 0.08290306071036505, 'psi': 0.9954949683423033}
[S6] START round=35 head_norm_before_train=1.315551 cos_to_last_merge=1.0000 (last merge round=34)
[S6] round=35 local utility u=0.275040 metrics={'f1_val': 0.6890980970195096, 'auprc': 0.894594473396739, 'loss_val': 0.7335630432257542, 'psi': 0.7712966475704014}-{'f1_val': 0.5945964934202123, 'auprc': 0.9037117331462086, 'loss_val': 0.7439857408154363, 'psi': 0.7182425893106108}
[S7] START round=35 head_norm_before_train=1.346071 cos_to_last_merge=0.9749 (last merge round=22)
[S7] round=35 local utility u=0.220753 metrics={'f1_val': 0.595677178996159, 'auprc': 0.7960854450631722, 'loss_val': 0.777897224908216, 'psi': 0.6758404854229643}-{'f1_val': 0.5590573861307369, 'auprc': 0.790510817633511, 'loss_val': 0.9829601650184844, 'psi': 0.6516387587318466}
[S8] START round=35 head_norm_before_train=1.425288 cos_to_last_merge=1.0000 (last merge round=34)
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.713665972483988, 'auprc': 0.9800082404911956, 'loss_val': 0.4603345722945424, 'psi': 0.820202879686871}-{'f1_val': 0.9893390723723242, 'auprc': 0.9991178495805504, 'loss_val': 0.06378800382552566, 'psi': 0.9932505832556147}
[S9] START round=35 head_norm_before_train=1.520628 cos_to_last_merge=0.9661 (last merge round=21)
[S9] round=35 local utility u=0.000504 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9981388694508813, 'loss_val': 0.0274623735958212, 'psi': 0.9970056046479191}-{'f1_val': 0.9962500947792776, 'auprc': 0.9981291161301997, 'loss_val': 0.028440839518321763, 'psi': 0.9970017033196464}
[S9] not sending this round → trigger blocked (psi=0.997)
[S10] START round=35 head_norm_before_train=1.916206 cos_to_last_merge=0.9981 (last merge round=25)
[S10] round=35 local utility u=0.000000 metrics={'f1_val': 0.9942256070413027, 'auprc': 0.9967480497644493, 'loss_val': 0.03119133513711054, 'psi': 0.9952345841305613}-{'f1_val': 0.9946643883427498, 'auprc': 0.9961092088918362, 'loss_val': 0.03114366308547861, 'psi': 0.9952423165623843}
[S11] START round=35 head_norm_before_train=1.574535 cos_to_last_merge=1.0000 (last merge round=34)
[S11] round=35 local utility u=0.000000 metrics={'f1_val': 0.9963753869090841, 'auprc': 0.9952768015781466, 'loss_val': 0.08060743078645251, 'psi': 0.9959359527767091}-{'f1_val': 0.9963753869090841, 'auprc': 0.9937229604124281, 'loss_val': 0.061820900491223074, 'psi': 0.9953144163104217}
[S13] START round=35 head_norm_before_train=1.284494 cos_to_last_merge=0.9996 (last merge round=32)
[S13] round=35 local utility u=0.040993 metrics={'f1_val': 0.6329879999606788, 'auprc': 0.6734387865924941, 'loss_val': 0.6312382698272371, 'psi': 0.6491683146134049}-{'f1_val': 0.6273056633531712, 'auprc': 0.6779423085117225, 'loss_val': 0.6926407648648825, 'psi': 0.6475603214165917}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] sending update (kind=head size=1795 to 1 peers)
[S14] START round=35 head_norm_before_train=1.931117 cos_to_last_merge=0.9994 (last merge round=30)
[S14] round=35 local utility u=0.150646 metrics={'f1_val': 0.9969910436891155, 'auprc': 0.9985405648837491, 'loss_val': 0.03766211163209533, 'psi': 0.997610852166969}-{'f1_val': 0.9537658767585036, 'auprc': 0.9979287494714989, 'loss_val': 0.07776770967824871, 'psi': 0.9714310258437017}
[S15] START round=35 head_norm_before_train=1.425288 cos_to_last_merge=1.0000 (last merge round=34)
[S15] round=35 local utility u=0.000000 metrics={'f1_val': 0.7004412729488237, 'auprc': 0.9810260471704116, 'loss_val': 0.48113824694532176, 'psi': 0.812675182637459}-{'f1_val': 0.9965259456095847, 'auprc': 0.9973242104642482, 'loss_val': 0.0518807855703571, 'psi': 0.9968452515514501}
[S16] START round=35 head_norm_before_train=2.045780 (no previous merge yet)
[S16] round=35 local utility u=0.000000 metrics={'f1_val': 0.8550005744057977, 'auprc': 0.973044590538698, 'loss_val': 0.7927156684168131, 'psi': 0.9022181808589578}-{'f1_val': 0.8660817612354991, 'auprc': 0.9961231459743725, 'loss_val': 0.6248072422696926, 'psi': 0.9180983151310484}
[S17] START round=35 head_norm_before_train=1.282175 cos_to_last_merge=0.9950 (last merge round=30)
[S17] round=35 local utility u=0.226534 metrics={'f1_val': 0.6756716383354031, 'auprc': 0.8336081152616772, 'loss_val': 0.762114833070566, 'psi': 0.7388462291059128}-{'f1_val': 0.6472678674553316, 'auprc': 0.8157816592452489, 'loss_val': 0.9912803488011517, 'psi': 0.7146733841712986}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:61016
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S6] sending update (kind=head size=1807 to 1 peers)
[S5] not sending this round → trigger blocked (psi=0.997)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] ⇄ pheromone p=0.034 → S5@127.0.0.1:61005
[S5] ⇄ pheromone p=0.118 → S11@127.0.0.1:61012
[S7] sending update (kind=head size=1805 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:61007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] → sending delta(kind=head bytes=1805) to S10@127.0.0.1:61011
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] RECEIVED delta(kind=head bytes=1805) from S7
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.360005)
[S16] loaded HEAD from S7 (vec_in norm=1.360005)
[S16] cosine check vs S7: cos=-0.0594
[S16] DROPPED delta from S7 (cos=-0.0594 < 0.0)
[S14] sending update (kind=head size=1805 to 1 peers)
[S17] sending update (kind=head size=1804 to 1 peers)
[S7] ⇄ pheromone p=0.131 → S16@127.0.0.1:61016
[S10] RECEIVED delta(kind=head bytes=1805) from S14
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.943761)
[S10] loaded HEAD from S14 (vec_in norm=1.943761)
[S10] cosine check vs S14: cos=0.9980
[S10] BUFFERED delta from S14 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1804) from S17
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.300397)
[S6] loaded HEAD from S17 (vec_in norm=1.300397)
[S6] cosine check vs S17: cos=0.9914
[S6] BUFFERED delta from S17 (total buffered=1)
[S17] ⇄ pheromone p=0.172 → S6@127.0.0.1:61007
[S14] ⇄ pheromone p=0.033 → S10@127.0.0.1:61011
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] ⇄ pheromone p=0.026 → S15@127.0.0.1:61015
[S15] ⇄ pheromone p=0.250 → S9@127.0.0.1:61010
[S2] START round=36 head_norm_before_train=2.007183 (no previous merge yet)
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.828591646672683, 'auprc': 0.9251684115770983, 'loss_val': 0.3831833778917162, 'psi': 0.8672223526344491}-{'f1_val': 0.8262632996149086, 'auprc': 0.9436931884618234, 'loss_val': 0.3956151929829544, 'psi': 0.8732352551536745}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=36 head_norm_before_train=2.079350 cos_to_last_merge=0.7809 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.781
[S3] round=36 local utility u=0.013198 metrics={'f1_val': 0.7843213620644139, 'auprc': 0.9820320432102138, 'loss_val': 0.477149786579757, 'psi': 0.8634056345227339}-{'f1_val': 0.7756210243191639, 'auprc': 0.9905842593843429, 'loss_val': 0.4769996910256163, 'psi': 0.8616063183452355}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] START round=36 head_norm_before_train=1.954268 (no previous merge yet)
[S4] round=36 local utility u=0.009379 metrics={'f1_val': 0.9505246819308562, 'auprc': 0.9581562797834451, 'loss_val': 0.26068505792421365, 'psi': 0.9535773210718916}-{'f1_val': 0.9508937820008411, 'auprc': 0.9522624283934389, 'loss_val': 0.26397694398315114, 'psi': 0.9514412405578802}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=36 head_norm_before_train=1.599790 cos_to_last_merge=0.9998 (last merge round=34)
[S5] round=36 local utility u=0.005021 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9986399857567809, 'loss_val': 0.05149714343374606, 'psi': 0.997477175389787}-{'f1_val': 0.9967019684784577, 'auprc': 0.9984960206296931, 'loss_val': 0.06110667938862327, 'psi': 0.9974195893389519}
[S6] START round=36 head_norm_before_train=1.349233 cos_to_last_merge=0.9997 (last merge round=34)
[S6] round=36 local utility u=0.005576 metrics={'f1_val': 0.6776882931299074, 'auprc': 0.9253123023559768, 'loss_val': 0.7461053818563641, 'psi': 0.7767378968203351}-{'f1_val': 0.6890980970195096, 'auprc': 0.894594473396739, 'loss_val': 0.7335630432257542, 'psi': 0.7712966475704014}
[S7] START round=36 head_norm_before_train=1.360005 cos_to_last_merge=0.9736 (last merge round=22)
[S7] round=36 local utility u=0.439214 metrics={'f1_val': 0.66160544738706, 'auprc': 0.8283366135023957, 'loss_val': 0.3917914396892082, 'psi': 0.7282979138331942}-{'f1_val': 0.595677178996159, 'auprc': 0.7960854450631722, 'loss_val': 0.777897224908216, 'psi': 0.6758404854229643}
[S8] START round=36 head_norm_before_train=1.437527 cos_to_last_merge=1.0000 (last merge round=34)
[S8] round=36 local utility u=1.000000 metrics={'f1_val': 0.9896558900940475, 'auprc': 0.9991065197511789, 'loss_val': 0.060939532184758, 'psi': 0.9934361419569001}-{'f1_val': 0.713665972483988, 'auprc': 0.9800082404911956, 'loss_val': 0.4603345722945424, 'psi': 0.820202879686871}
[S9] START round=36 head_norm_before_train=1.538027 cos_to_last_merge=0.9645 (last merge round=21)
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.9954158325366191, 'auprc': 0.9981008033381418, 'loss_val': 0.028479368403733836, 'psi': 0.9964898208572281}-{'f1_val': 0.9962500947792776, 'auprc': 0.9981388694508813, 'loss_val': 0.0274623735958212, 'psi': 0.9970056046479191}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=36 head_norm_before_train=1.926965 cos_to_last_merge=0.9978 (last merge round=25)
[S10] round=36 local utility u=0.000276 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9958514587744903, 'loss_val': 0.030582635556646125, 'psi': 0.995139216515446}-{'f1_val': 0.9942256070413027, 'auprc': 0.9967480497644493, 'loss_val': 0.03119133513711054, 'psi': 0.9952345841305613}
[S11] START round=36 head_norm_before_train=1.595099 cos_to_last_merge=0.9999 (last merge round=34)
[S11] round=36 local utility u=0.000000 metrics={'f1_val': 0.8721934894670922, 'auprc': 0.9947925638218424, 'loss_val': 0.16767952984483797, 'psi': 0.9212331192089923}-{'f1_val': 0.9963753869090841, 'auprc': 0.9952768015781466, 'loss_val': 0.08060743078645251, 'psi': 0.9959359527767091}
[S13] START round=36 head_norm_before_train=1.295866 cos_to_last_merge=0.9994 (last merge round=32)
[S13] round=36 local utility u=0.000000 metrics={'f1_val': 0.6248300558959493, 'auprc': 0.6807973587124675, 'loss_val': 0.7348109348607018, 'psi': 0.6472169770225566}-{'f1_val': 0.6329879999606788, 'auprc': 0.6734387865924941, 'loss_val': 0.6312382698272371, 'psi': 0.6491683146134049}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=36 head_norm_before_train=1.943761 cos_to_last_merge=0.9992 (last merge round=30)
[S14] round=36 local utility u=0.008151 metrics={'f1_val': 0.9978217593544257, 'auprc': 0.9987388959901373, 'loss_val': 0.02693991934654132, 'psi': 0.9981886140087104}-{'f1_val': 0.9969910436891155, 'auprc': 0.9985405648837491, 'loss_val': 0.03766211163209533, 'psi': 0.997610852166969}
[S15] START round=36 head_norm_before_train=1.439509 cos_to_last_merge=1.0000 (last merge round=34)
[S15] round=36 local utility u=0.010348 metrics={'f1_val': 0.6991713263519401, 'auprc': 0.9853473826712472, 'loss_val': 0.4657861016245398, 'psi': 0.813641748879663}-{'f1_val': 0.7004412729488237, 'auprc': 0.9810260471704116, 'loss_val': 0.48113824694532176, 'psi': 0.812675182637459}
[S16] START round=36 head_norm_before_train=2.055392 (no previous merge yet)
[S16] round=36 local utility u=0.000000 metrics={'f1_val': 0.8267676805304937, 'auprc': 0.966725955606243, 'loss_val': 0.6907145214677677, 'psi': 0.8827509905607933}-{'f1_val': 0.8550005744057977, 'auprc': 0.973044590538698, 'loss_val': 0.7927156684168131, 'psi': 0.9022181808589578}
[S17] START round=36 head_norm_before_train=1.300397 cos_to_last_merge=0.9936 (last merge round=30)
[S17] round=36 local utility u=0.000000 metrics={'f1_val': 0.6502756882008481, 'auprc': 0.8193505346294294, 'loss_val': 0.9100467056227833, 'psi': 0.7179056267722806}-{'f1_val': 0.6756716383354031, 'auprc': 0.8336081152616772, 'loss_val': 0.762114833070566, 'psi': 0.7388462291059128}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:61012
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:61014
[S6] not sending this round → trigger blocked (psi=0.777)
[S7] not sending this round → trigger blocked (psi=0.728)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.998)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:61015
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=36 metric=0.6777 head_norm=1.378811
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.059981e-01
[S6] stored merged vector for next round verification (round=36)
[S6] DEBUG after merge:  round=36 metric=0.6809 head_norm=1.335979 delta_norm=0.105998
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] RECEIVED delta(kind=head bytes=1803) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.933595)
[S14] loaded HEAD from S10 (vec_in norm=1.933595)
[S14] cosine check vs S10: cos=0.9975
[S14] BUFFERED delta from S10 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1800) from S5
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.635368)
[S11] loaded HEAD from S5 (vec_in norm=1.635368)
[S11] cosine check vs S5: cos=0.9990
[S11] BUFFERED delta from S5 (total buffered=1)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=36 metric=0.9947 head_norm=1.933595
[S10] _apply_head_vector_avg (torch): Δ‖w‖=6.359158e-02
[S10] stored merged vector for next round verification (round=36)
[S10] DEBUG after merge:  round=36 metric=0.9947 head_norm=1.937641 delta_norm=0.063592
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S8] sending update (kind=head size=1798 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1798) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.448751)
[S15] loaded HEAD from S8 (vec_in norm=1.448751)
[S15] cosine check vs S8: cos=0.9998
[S15] BUFFERED delta from S8 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:61010
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=36 metric=0.9978 head_norm=1.957003
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.908667e-02
[S14] stored merged vector for next round verification (round=36)
[S14] DEBUG after merge:  round=36 metric=0.9978 head_norm=1.944107 delta_norm=0.069087
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] sending update (kind=head size=1803 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1803) from S15
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.451265)
[S9] loaded HEAD from S15 (vec_in norm=1.451265)
[S9] cosine check vs S15: cos=0.9607
[S9] BUFFERED delta from S15 (total buffered=1)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=36 metric=0.6992 head_norm=1.451265
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.485149e-02
[S15] stored merged vector for next round verification (round=36)
[S15] DEBUG after merge:  round=36 metric=0.6992 head_norm=1.449932 delta_norm=0.014851
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=37 head_norm_before_train=2.019746 (no previous merge yet)
[S2] round=37 local utility u=0.000000 metrics={'f1_val': 0.7501257318465153, 'auprc': 0.9519905916475659, 'loss_val': 0.4559916911085721, 'psi': 0.8308716757669355}-{'f1_val': 0.828591646672683, 'auprc': 0.9251684115770983, 'loss_val': 0.3831833778917162, 'psi': 0.8672223526344491}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=37 head_norm_before_train=2.091277 cos_to_last_merge=0.7796 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.780
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.6687679165245214, 'auprc': 0.9833752998133529, 'loss_val': 0.8214447575794915, 'psi': 0.794610869840054}-{'f1_val': 0.7843213620644139, 'auprc': 0.9820320432102138, 'loss_val': 0.477149786579757, 'psi': 0.8634056345227339}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=37 head_norm_before_train=1.962539 (no previous merge yet)
[S4] round=37 local utility u=0.003551 metrics={'f1_val': 0.951725002210352, 'auprc': 0.9587294504255022, 'loss_val': 0.26250490789250946, 'psi': 0.954526781496412}-{'f1_val': 0.9505246819308562, 'auprc': 0.9581562797834451, 'loss_val': 0.26068505792421365, 'psi': 0.9535773210718916}
[S4] not sending this round → trigger blocked (psi=0.955)
[S5] START round=37 head_norm_before_train=1.635368 cos_to_last_merge=0.9990 (last merge round=34)
[S5] round=37 local utility u=0.000128 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9968282314068793, 'loss_val': 0.045805517821207224, 'psi': 0.9967524736498263}-{'f1_val': 0.9967019684784577, 'auprc': 0.9986399857567809, 'loss_val': 0.05149714343374606, 'psi': 0.997477175389787}
[S6] START round=37 head_norm_before_train=1.335979 cos_to_last_merge=1.0000 (last merge round=36)
[S6] round=37 local utility u=0.189611 metrics={'f1_val': 0.7058654142428739, 'auprc': 0.9445068587883632, 'loss_val': 0.5935307605298094, 'psi': 0.8013219920610696}-{'f1_val': 0.6776882931299074, 'auprc': 0.9253123023559768, 'loss_val': 0.7461053818563641, 'psi': 0.7767378968203351}
[S7] START round=37 head_norm_before_train=1.379339 cos_to_last_merge=0.9715 (last merge round=22)
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.5671283063637055, 'auprc': 0.7898960133628871, 'loss_val': 0.9069737787442992, 'psi': 0.6562353891633781}-{'f1_val': 0.66160544738706, 'auprc': 0.8283366135023957, 'loss_val': 0.3917914396892082, 'psi': 0.7282979138331942}
[S8] START round=37 head_norm_before_train=1.448751 cos_to_last_merge=0.9999 (last merge round=34)
[S8] round=37 local utility u=0.000000 metrics={'f1_val': 0.9885804511658192, 'auprc': 0.9990884456764806, 'loss_val': 0.06116563110868741, 'psi': 0.9927836489700838}-{'f1_val': 0.9896558900940475, 'auprc': 0.9991065197511789, 'loss_val': 0.060939532184758, 'psi': 0.9934361419569001}
[S9] START round=37 head_norm_before_train=1.552639 cos_to_last_merge=0.9631 (last merge round=21)
[S9] round=37 local utility u=0.000718 metrics={'f1_val': 0.9954158325366191, 'auprc': 0.9982731097233677, 'loss_val': 0.02756115748373808, 'psi': 0.9965587434113186}-{'f1_val': 0.9954158325366191, 'auprc': 0.9981008033381418, 'loss_val': 0.028479368403733836, 'psi': 0.9964898208572281}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=37 metric=0.9954 head_norm=1.563297
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.209870e-01
[S9] stored merged vector for next round verification (round=37)
[S9] DEBUG after merge:  round=37 metric=0.9954 head_norm=1.492045 delta_norm=0.220987
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S10] START round=37 head_norm_before_train=1.937641 cos_to_last_merge=1.0000 (last merge round=36)
[S10] round=37 local utility u=0.000000 metrics={'f1_val': 0.9944449605296568, 'auprc': 0.9961403362948376, 'loss_val': 0.031062614619444928, 'psi': 0.9951231108357291}-{'f1_val': 0.9946643883427498, 'auprc': 0.9958514587744903, 'loss_val': 0.030582635556646125, 'psi': 0.995139216515446}
[S11] START round=37 head_norm_before_train=1.613477 cos_to_last_merge=0.9997 (last merge round=34)
[S11] round=37 local utility u=0.425206 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9949427437013687, 'loss_val': 0.06135851177869673, 'psi': 0.9956573024285331}-{'f1_val': 0.8721934894670922, 'auprc': 0.9947925638218424, 'loss_val': 0.16767952984483797, 'psi': 0.9212331192089923}
[S13] START round=37 head_norm_before_train=1.302629 cos_to_last_merge=0.9989 (last merge round=32)
[S13] round=37 local utility u=0.000000 metrics={'f1_val': 0.6234168768098969, 'auprc': 0.6820497464420471, 'loss_val': 0.7466319731618056, 'psi': 0.646870024662757}-{'f1_val': 0.6248300558959493, 'auprc': 0.6807973587124675, 'loss_val': 0.7348109348607018, 'psi': 0.6472169770225566}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=37 head_norm_before_train=1.944107 cos_to_last_merge=1.0000 (last merge round=36)
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.9974055297193176, 'auprc': 0.99876022065859, 'loss_val': 0.03162685434689645, 'psi': 0.9979474060950266}-{'f1_val': 0.9978217593544257, 'auprc': 0.9987388959901373, 'loss_val': 0.02693991934654132, 'psi': 0.9981886140087104}
[S15] START round=37 head_norm_before_train=1.449932 cos_to_last_merge=1.0000 (last merge round=36)
[S15] round=37 local utility u=1.000000 metrics={'f1_val': 0.9950628515132325, 'auprc': 0.9923181513887873, 'loss_val': 0.054795524429013864, 'psi': 0.9939649714634544}-{'f1_val': 0.6991713263519401, 'auprc': 0.9853473826712472, 'loss_val': 0.4657861016245398, 'psi': 0.813641748879663}
[S16] START round=37 head_norm_before_train=2.063278 (no previous merge yet)
[S16] round=37 local utility u=0.572601 metrics={'f1_val': 0.939138930936996, 'auprc': 0.9887324012912068, 'loss_val': 0.285759130445117, 'psi': 0.9589763190786803}-{'f1_val': 0.8267676805304937, 'auprc': 0.966725955606243, 'loss_val': 0.6907145214677677, 'psi': 0.8827509905607933}
[S17] START round=37 head_norm_before_train=1.318464 cos_to_last_merge=0.9922 (last merge round=30)
[S17] round=37 local utility u=0.068716 metrics={'f1_val': 0.6557261304810545, 'auprc': 0.8271736217977985, 'loss_val': 0.8287862403848134, 'psi': 0.7243051270077522}-{'f1_val': 0.6502756882008481, 'auprc': 0.8193505346294294, 'loss_val': 0.9100467056227833, 'psi': 0.7179056267722806}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:61005
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:61008
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:61017
[S16] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:61007
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1805 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1802) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.632110)
[S5] loaded HEAD from S11 (vec_in norm=1.632110)
[S5] cosine check vs S11: cos=0.9979
[S5] BUFFERED delta from S11 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1805) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.360427)
[S17] loaded HEAD from S6 (vec_in norm=1.360427)
[S17] cosine check vs S6: cos=0.9941
[S17] BUFFERED delta from S6 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1800) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=2.070482)
[S7] loaded HEAD from S16 (vec_in norm=2.070482)
[S7] cosine check vs S16: cos=-0.0591
[S7] DROPPED delta from S16 (cos=-0.0591 < 0.0)
[S17] sending update (kind=head size=1801 to 1 peers)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=37 metric=0.9961 head_norm=1.632110
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.052043e-02
[S11] stored merged vector for next round verification (round=37)
[S11] DEBUG after merge:  round=37 metric=0.9961 head_norm=1.633237 delta_norm=0.040520
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S6] RECEIVED delta(kind=head bytes=1801) from S17
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.337083)
[S6] loaded HEAD from S17 (vec_in norm=1.337083)
[S6] cosine check vs S17: cos=0.9941
[S6] BUFFERED delta from S17 (total buffered=1)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=37 metric=0.6557 head_norm=1.337083
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.409650e-02
[S17] stored merged vector for next round verification (round=37)
[S17] DEBUG after merge:  round=37 metric=0.6559 head_norm=1.346769 delta_norm=0.074097
[S17] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S15] not sending this round → trigger blocked (psi=0.994)
[S2] START round=38 head_norm_before_train=2.032670 (no previous merge yet)
[S2] round=38 local utility u=0.098043 metrics={'f1_val': 0.8322076530727458, 'auprc': 0.8175507996076162, 'loss_val': 0.34907756442160126, 'psi': 0.826344911686694}-{'f1_val': 0.7501257318465153, 'auprc': 0.9519905916475659, 'loss_val': 0.4559916911085721, 'psi': 0.8308716757669355}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=38 head_norm_before_train=2.103097 cos_to_last_merge=0.7784 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.778
[S3] round=38 local utility u=0.874593 metrics={'f1_val': 0.8765963277196007, 'auprc': 0.9782731532437272, 'loss_val': 0.3039223151254752, 'psi': 0.9172670579292513}-{'f1_val': 0.6687679165245214, 'auprc': 0.9833752998133529, 'loss_val': 0.8214447575794915, 'psi': 0.794610869840054}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=38 head_norm_before_train=1.971854 (no previous merge yet)
[S4] round=38 local utility u=0.001915 metrics={'f1_val': 0.9524528301005732, 'auprc': 0.9592353277754906, 'loss_val': 0.2645601022378953, 'psi': 0.9551658291705402}-{'f1_val': 0.951725002210352, 'auprc': 0.9587294504255022, 'loss_val': 0.26250490789250946, 'psi': 0.954526781496412}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=38 head_norm_before_train=1.666937 cos_to_last_merge=0.9979 (last merge round=34)
[S5] round=38 local utility u=0.004446 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9984651640045024, 'loss_val': 0.04182474311737277, 'psi': 0.9974072466888755}-{'f1_val': 0.9967019684784577, 'auprc': 0.9968282314068793, 'loss_val': 0.045805517821207224, 'psi': 0.9967524736498263}
[S6] START round=38 head_norm_before_train=1.360427 cos_to_last_merge=0.9998 (last merge round=36)
[S6] round=38 local utility u=0.169843 metrics={'f1_val': 0.7791202235883857, 'auprc': 0.909572459365516, 'loss_val': 0.5885714008036907, 'psi': 0.8313011178992378}-{'f1_val': 0.7058654142428739, 'auprc': 0.9445068587883632, 'loss_val': 0.5935307605298094, 'psi': 0.8013219920610696}
[S7] START round=38 head_norm_before_train=1.396293 cos_to_last_merge=0.9697 (last merge round=22)
[S7] round=38 local utility u=0.441794 metrics={'f1_val': 0.652097676435953, 'auprc': 0.8051696760704236, 'loss_val': 0.5790220743314763, 'psi': 0.7133264762897411}-{'f1_val': 0.5671283063637055, 'auprc': 0.7898960133628871, 'loss_val': 0.9069737787442992, 'psi': 0.6562353891633781}
[S8] START round=38 head_norm_before_train=1.461503 cos_to_last_merge=0.9998 (last merge round=34)
[S8] round=38 local utility u=0.000000 metrics={'f1_val': 0.713665972483988, 'auprc': 0.9816130981537954, 'loss_val': 0.47623222609709853, 'psi': 0.820844822751911}-{'f1_val': 0.9885804511658192, 'auprc': 0.9990884456764806, 'loss_val': 0.06116563110868741, 'psi': 0.9927836489700838}
[S9] START round=38 head_norm_before_train=1.492045 cos_to_last_merge=1.0000 (last merge round=37)
[S9] round=38 local utility u=0.000177 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9981567143795973, 'loss_val': 0.03186438007144002, 'psi': 0.9970127426194055}-{'f1_val': 0.9954158325366191, 'auprc': 0.9982731097233677, 'loss_val': 0.02756115748373808, 'psi': 0.9965587434113186}
[S9] not sending this round → trigger blocked (psi=0.997)
[S10] START round=38 head_norm_before_train=1.945885 cos_to_last_merge=1.0000 (last merge round=36)
[S10] round=38 local utility u=0.000000 metrics={'f1_val': 0.9942256070413027, 'auprc': 0.9962366393580605, 'loss_val': 0.03082360213341507, 'psi': 0.9950300199680058}-{'f1_val': 0.9944449605296568, 'auprc': 0.9961403362948376, 'loss_val': 0.031062614619444928, 'psi': 0.9951231108357291}
[S11] START round=38 head_norm_before_train=1.633237 cos_to_last_merge=1.0000 (last merge round=37)
[S11] round=38 local utility u=0.008640 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9963937728599451, 'loss_val': 0.0484313909426885, 'psi': 0.9962377140919636}-{'f1_val': 0.9961336749133093, 'auprc': 0.9949427437013687, 'loss_val': 0.06135851177869673, 'psi': 0.9956573024285331}
[S13] START round=38 head_norm_before_train=1.313427 cos_to_last_merge=0.9981 (last merge round=32)
[S13] round=38 local utility u=0.212025 metrics={'f1_val': 0.6573522697189228, 'auprc': 0.6738080064270329, 'loss_val': 0.5014695987494411, 'psi': 0.6639345644021668}-{'f1_val': 0.6234168768098969, 'auprc': 0.6820497464420471, 'loss_val': 0.7466319731618056, 'psi': 0.646870024662757}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=38 head_norm_before_train=1.956924 cos_to_last_merge=1.0000 (last merge round=36)
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.9332755803863818, 'auprc': 0.9987270337061916, 'loss_val': 0.14623883779489855, 'psi': 0.9594561617143058}-{'f1_val': 0.9974055297193176, 'auprc': 0.99876022065859, 'loss_val': 0.03162685434689645, 'psi': 0.9979474060950266}
[S15] START round=38 head_norm_before_train=1.460472 cos_to_last_merge=1.0000 (last merge round=36)
[S15] round=38 local utility u=0.001032 metrics={'f1_val': 0.994936462182306, 'auprc': 0.9939511097322756, 'loss_val': 0.056872808980460696, 'psi': 0.9945423212022938}-{'f1_val': 0.9950628515132325, 'auprc': 0.9923181513887873, 'loss_val': 0.054795524429013864, 'psi': 0.9939649714634544}
[S16] START round=38 head_norm_before_train=2.070482 (no previous merge yet)
[S16] round=38 local utility u=0.000000 metrics={'f1_val': 0.8373418844945996, 'auprc': 0.9322062162672239, 'loss_val': 0.9703768485901186, 'psi': 0.8752876172036493}-{'f1_val': 0.939138930936996, 'auprc': 0.9887324012912068, 'loss_val': 0.285759130445117, 'psi': 0.9589763190786803}
[S17] START round=38 head_norm_before_train=1.346769 cos_to_last_merge=1.0000 (last merge round=37)
[S17] round=38 local utility u=0.000000 metrics={'f1_val': 0.6548887204942673, 'auprc': 0.8277402904687768, 'loss_val': 0.8683817498541659, 'psi': 0.7240293484840712}-{'f1_val': 0.6557261304810545, 'auprc': 0.8271736217977985, 'loss_val': 0.8287862403848134, 'psi': 0.7243051270077522}
[S14]  timeout peer S8
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:61012
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.831)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.996)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] → sending delta(kind=head bytes=1806) to S16@127.0.0.1:61016
[S7] sending update (kind=head size=1806 to 1 peers)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=38 metric=0.7791 head_norm=1.386381
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.799373e-02
[S6] stored merged vector for next round verification (round=38)
[S6] DEBUG after merge:  round=38 metric=0.7808 head_norm=1.359109 delta_norm=0.087994
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] RECEIVED delta(kind=head bytes=1797) from S5
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.695481)
[S11] loaded HEAD from S5 (vec_in norm=1.695481)
[S11] cosine check vs S5: cos=0.9982
[S11] BUFFERED delta from S5 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1806) from S7
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.409756)
[S16] loaded HEAD from S7 (vec_in norm=1.409756)
[S16] cosine check vs S7: cos=-0.0585
[S16] DROPPED delta from S7 (cos=-0.0585 < 0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=38 metric=0.9967 head_norm=1.695481
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.358776e-02
[S5] stored merged vector for next round verification (round=38)
[S5] DEBUG after merge:  round=38 metric=0.9967 head_norm=1.662470 delta_norm=0.073588
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:61010
[S15] sending update (kind=head size=1802 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1802) from S15
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.473657)
[S9] loaded HEAD from S15 (vec_in norm=1.473657)
[S9] cosine check vs S15: cos=0.9875
[S9] BUFFERED delta from S15 (total buffered=1)
[S2] START round=39 head_norm_before_train=2.041116 (no previous merge yet)
[S2] round=39 local utility u=0.141552 metrics={'f1_val': 0.827041782101279, 'auprc': 0.9424586792001862, 'loss_val': 0.4097016326545178, 'psi': 0.8732085409408419}-{'f1_val': 0.8322076530727458, 'auprc': 0.8175507996076162, 'loss_val': 0.34907756442160126, 'psi': 0.826344911686694}
[S2] not sending this round → trigger blocked (psi=0.873)
[S2] r=40 psi=0.873 u=0.1416 p_local=0.0705 f1=0.827 auprc=0.942 bytes=32354
[S3] START round=39 head_norm_before_train=2.114334 cos_to_last_merge=0.7772 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.777
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.8682225339997525, 'auprc': 0.9799172421295199, 'loss_val': 0.3197503636846585, 'psi': 0.9129004172516594}-{'f1_val': 0.8765963277196007, 'auprc': 0.9782731532437272, 'loss_val': 0.3039223151254752, 'psi': 0.9172670579292513}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=40 psi=0.913 u=0.0000 p_local=0.2121 f1=0.868 auprc=0.980 bytes=35942
[S4] START round=39 head_norm_before_train=1.976440 (no previous merge yet)
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.9500067468341395, 'auprc': 0.9520870496896232, 'loss_val': 0.2603014623681756, 'psi': 0.950838867976333}-{'f1_val': 0.9524528301005732, 'auprc': 0.9592353277754906, 'loss_val': 0.2645601022378953, 'psi': 0.9551658291705402}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=40 psi=0.951 u=0.0000 p_local=0.0123 f1=0.950 auprc=0.952 bytes=39596
[S5] START round=39 head_norm_before_train=1.662470 cos_to_last_merge=1.0000 (last merge round=38)
[S5] round=39 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9977910258974106, 'loss_val': 0.042829800295136077, 'psi': 0.9969166975370983}-{'f1_val': 0.9967019684784577, 'auprc': 0.9984651640045024, 'loss_val': 0.04182474311737277, 'psi': 0.9974072466888755}
[S6] START round=39 head_norm_before_train=1.359109 cos_to_last_merge=1.0000 (last merge round=38)
[S6] round=39 local utility u=0.000000 metrics={'f1_val': 0.6440559295592656, 'auprc': 0.9030734466862301, 'loss_val': 0.7428519894327325, 'psi': 0.7476629364100514}-{'f1_val': 0.7791202235883857, 'auprc': 0.909572459365516, 'loss_val': 0.5885714008036907, 'psi': 0.8313011178992378}
[S7] START round=39 head_norm_before_train=1.409756 cos_to_last_merge=0.9681 (last merge round=22)
[S7] round=39 local utility u=0.000000 metrics={'f1_val': 0.6292838917721608, 'auprc': 0.8049838373139403, 'loss_val': 0.49227048926420053, 'psi': 0.6995638699888727}-{'f1_val': 0.652097676435953, 'auprc': 0.8051696760704236, 'loss_val': 0.5790220743314763, 'psi': 0.7133264762897411}
[S8] START round=39 head_norm_before_train=1.472717 cos_to_last_merge=0.9996 (last merge round=34)
[S8] round=39 local utility u=1.000000 metrics={'f1_val': 0.9822478626776323, 'auprc': 0.9990704316305816, 'loss_val': 0.0717157953492015, 'psi': 0.9889768902588121}-{'f1_val': 0.713665972483988, 'auprc': 0.9816130981537954, 'loss_val': 0.47623222609709853, 'psi': 0.820844822751911}
[S9] START round=39 head_norm_before_train=1.508477 cos_to_last_merge=1.0000 (last merge round=37)
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.9958601375429889, 'auprc': 0.9981424445584924, 'loss_val': 0.03196208673028733, 'psi': 0.9967730603491902}-{'f1_val': 0.9962500947792776, 'auprc': 0.9981567143795973, 'loss_val': 0.03186438007144002, 'psi': 0.9970127426194055}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=39 metric=0.9959 head_norm=1.524851
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.267068e-01
[S9] stored merged vector for next round verification (round=39)
[S9] DEBUG after merge:  round=39 metric=0.9959 head_norm=1.494110 delta_norm=0.126707
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S9] r=40 psi=0.997 u=0.0000 p_local=0.0091 f1=0.996 auprc=0.998 bytes=37733
[S10] START round=39 head_norm_before_train=1.955274 cos_to_last_merge=1.0000 (last merge round=36)
[S10] round=39 local utility u=0.000921 metrics={'f1_val': 0.9944449605296568, 'auprc': 0.9962541070057982, 'loss_val': 0.030349869648313352, 'psi': 0.9951686191201135}-{'f1_val': 0.9942256070413027, 'auprc': 0.9962366393580605, 'loss_val': 0.03082360213341507, 'psi': 0.9950300199680058}
[S11] START round=39 head_norm_before_train=1.651291 cos_to_last_merge=0.9999 (last merge round=37)
[S11] round=39 local utility u=0.004131 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9975051348029392, 'loss_val': 0.045983605568377675, 'psi': 0.9969302566293294}-{'f1_val': 0.9961336749133093, 'auprc': 0.9963937728599451, 'loss_val': 0.0484313909426885, 'psi': 0.9962377140919636}
[S13] START round=39 head_norm_before_train=1.323709 cos_to_last_merge=0.9969 (last merge round=32)
[S13] round=39 local utility u=0.000000 metrics={'f1_val': 0.6124388251209253, 'auprc': 0.6845430118825897, 'loss_val': 0.7737375343238445, 'psi': 0.641280499825591}-{'f1_val': 0.6573522697189228, 'auprc': 0.6738080064270329, 'loss_val': 0.5014695987494411, 'psi': 0.6639345644021668}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=40 psi=0.641 u=0.0000 p_local=0.0466 f1=0.612 auprc=0.685 bytes=30536
[S14] START round=39 head_norm_before_train=1.966028 cos_to_last_merge=0.9999 (last merge round=36)
[S14] round=39 local utility u=0.185152 metrics={'f1_val': 0.9788574448256134, 'auprc': 0.9987019349318904, 'loss_val': 0.04935121411693535, 'psi': 0.9867952408681242}-{'f1_val': 0.9332755803863818, 'auprc': 0.9987270337061916, 'loss_val': 0.14623883779489855, 'psi': 0.9594561617143058}
[S15] START round=39 head_norm_before_train=1.473657 cos_to_last_merge=0.9999 (last merge round=36)
[S15] round=39 local utility u=0.000000 metrics={'f1_val': 0.9329946029951954, 'auprc': 0.9965841157690025, 'loss_val': 0.11290219737770935, 'psi': 0.9584304081047182}-{'f1_val': 0.994936462182306, 'auprc': 0.9939511097322756, 'loss_val': 0.056872808980460696, 'psi': 0.9945423212022938}
[S16] START round=39 head_norm_before_train=2.076593 (no previous merge yet)
[S16] round=39 local utility u=1.000000 metrics={'f1_val': 0.9918518825842244, 'auprc': 0.9917573210539836, 'loss_val': 0.04238020166334483, 'psi': 0.9918140579721281}-{'f1_val': 0.8373418844945996, 'auprc': 0.9322062162672239, 'loss_val': 0.9703768485901186, 'psi': 0.8752876172036493}
[S17] START round=39 head_norm_before_train=1.365973 cos_to_last_merge=0.9998 (last merge round=37)
[S17] round=39 local utility u=0.000000 metrics={'f1_val': 0.6559049313404688, 'auprc': 0.828344534601014, 'loss_val': 0.8924356695452963, 'psi': 0.7248807726446869}-{'f1_val': 0.6548887204942673, 'auprc': 0.8277402904687768, 'loss_val': 0.8683817498541659, 'psi': 0.7240293484840712}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:61005
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S7@127.0.0.1:61008
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:61014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1805 to 1 peers)
[S14] r=40 psi=0.987 u=0.1852 p_local=0.0516 f1=0.979 auprc=0.999 bytes=48579
[S6] r=40 psi=0.748 u=0.0000 p_local=0.1219 f1=0.644 auprc=0.903 bytes=43217
[S7] r=40 psi=0.700 u=0.0000 p_local=0.1694 f1=0.629 auprc=0.805 bytes=32376
[S5] r=40 psi=0.997 u=0.0000 p_local=0.0496 f1=0.996 auprc=0.998 bytes=41382
[S10] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1794 to 1 peers)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] RECEIVED delta(kind=head bytes=1805) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.668679)
[S5] loaded HEAD from S11 (vec_in norm=1.668679)
[S5] cosine check vs S11: cos=0.9992
[S5] BUFFERED delta from S11 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1800) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.965002)
[S14] loaded HEAD from S10 (vec_in norm=1.965002)
[S14] cosine check vs S10: cos=0.9997
[S14] BUFFERED delta from S10 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1794) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=2.080749)
[S7] loaded HEAD from S16 (vec_in norm=2.080749)
[S7] cosine check vs S16: cos=-0.0593
[S7] DROPPED delta from S16 (cos=-0.0593 < 0.0)
[S10] r=40 psi=0.995 u=0.0009 p_local=0.0021 f1=0.994 auprc=0.996 bytes=46779
[S16] r=40 psi=0.992 u=1.0000 p_local=0.3008 f1=0.992 auprc=0.992 bytes=39557
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=39 metric=0.9965 head_norm=1.668679
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.369215e-02
[S11] stored merged vector for next round verification (round=39)
[S11] DEBUG after merge:  round=39 metric=0.9965 head_norm=1.681277 delta_norm=0.053692
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S11] r=40 psi=0.997 u=0.0041 p_local=0.0706 f1=0.997 auprc=0.998 bytes=46747
[S17] r=40 psi=0.725 u=0.0000 p_local=0.0794 f1=0.656 auprc=0.828 bytes=35975
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=40 psi=0.958 u=0.0000 p_local=0.2315 f1=0.933 auprc=0.997 bytes=41319
[S8] r=40 psi=0.989 u=1.0000 p_local=0.3132 f1=0.982 auprc=0.999 bytes=41322
[S2] START round=40 head_norm_before_train=2.046918 (no previous merge yet)
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.832462452830113, 'auprc': 0.9104602665142791, 'loss_val': 0.3559807700784833, 'psi': 0.8636615783037794}-{'f1_val': 0.827041782101279, 'auprc': 0.9424586792001862, 'loss_val': 0.4097016326545178, 'psi': 0.8732085409408419}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=40 head_norm_before_train=2.124508 cos_to_last_merge=0.7761 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.776
[S3] round=40 local utility u=0.410085 metrics={'f1_val': 0.959398380037106, 'auprc': 0.9985221771244286, 'loss_val': 0.10244993796784918, 'psi': 0.975047898872035}-{'f1_val': 0.8682225339997525, 'auprc': 0.9799172421295199, 'loss_val': 0.3197503636846585, 'psi': 0.9129004172516594}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=40 head_norm_before_train=1.978811 (no previous merge yet)
[S4] round=40 local utility u=0.029146 metrics={'f1_val': 0.9537649677551895, 'auprc': 0.9632598146650277, 'loss_val': 0.25807682521349895, 'psi': 0.9575629065191248}-{'f1_val': 0.9500067468341395, 'auprc': 0.9520870496896232, 'loss_val': 0.2603014623681756, 'psi': 0.950838867976333}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=40 head_norm_before_train=1.695912 cos_to_last_merge=0.9998 (last merge round=38)
[S5] round=40 local utility u=0.001154 metrics={'f1_val': 0.9964083724129549, 'auprc': 0.9973233713996308, 'loss_val': 0.03956655179561526, 'psi': 0.9967743720076252}-{'f1_val': 0.9963338119635569, 'auprc': 0.9977910258974106, 'loss_val': 0.042829800295136077, 'psi': 0.9969166975370983}
[S6] START round=40 head_norm_before_train=1.384230 cos_to_last_merge=0.9998 (last merge round=38)
[S6] round=40 local utility u=0.548006 metrics={'f1_val': 0.7863432964363968, 'auprc': 0.9232869019057162, 'loss_val': 0.5612048206619991, 'psi': 0.8411207386241245}-{'f1_val': 0.6440559295592656, 'auprc': 0.9030734466862301, 'loss_val': 0.7428519894327325, 'psi': 0.7476629364100514}
[S7] START round=40 head_norm_before_train=1.417293 cos_to_last_merge=0.9673 (last merge round=22)
[S7] round=40 local utility u=0.303194 metrics={'f1_val': 0.6861068548233529, 'auprc': 0.839531974571868, 'loss_val': 0.33046525886309197, 'psi': 0.747476902722759}-{'f1_val': 0.6292838917721608, 'auprc': 0.8049838373139403, 'loss_val': 0.49227048926420053, 'psi': 0.6995638699888727}
[S8] START round=40 head_norm_before_train=1.482180 cos_to_last_merge=0.9995 (last merge round=34)
[S8] round=40 local utility u=0.042149 metrics={'f1_val': 0.9934667705418724, 'auprc': 0.9982825397772199, 'loss_val': 0.05236716516695066, 'psi': 0.9953930782360114}-{'f1_val': 0.9822478626776323, 'auprc': 0.9990704316305816, 'loss_val': 0.0717157953492015, 'psi': 0.9889768902588121}
[S9] START round=40 head_norm_before_train=1.494110 cos_to_last_merge=1.0000 (last merge round=39)
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.9954158325366191, 'auprc': 0.9981406638223067, 'loss_val': 0.0353659327368957, 'psi': 0.9965057650508942}-{'f1_val': 0.9958601375429889, 'auprc': 0.9981424445584924, 'loss_val': 0.03196208673028733, 'psi': 0.9967730603491902}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=40 head_norm_before_train=1.965002 cos_to_last_merge=0.9999 (last merge round=36)
[S10] round=40 local utility u=0.000276 metrics={'f1_val': 0.9944449605296568, 'auprc': 0.9963426875445976, 'loss_val': 0.030062825890827916, 'psi': 0.9952040513356332}-{'f1_val': 0.9944449605296568, 'auprc': 0.9962541070057982, 'loss_val': 0.030349869648313352, 'psi': 0.9951686191201135}
[S11] START round=40 head_norm_before_train=1.681277 cos_to_last_merge=1.0000 (last merge round=39)
[S11] round=40 local utility u=0.000000 metrics={'f1_val': 0.8449007273075564, 'auprc': 0.9954862781067791, 'loss_val': 0.20832359308879125, 'psi': 0.9051349476272454}-{'f1_val': 0.9965470045135896, 'auprc': 0.9975051348029392, 'loss_val': 0.045983605568377675, 'psi': 0.9969302566293294}
[S13] START round=40 head_norm_before_train=1.329166 cos_to_last_merge=0.9963 (last merge round=32)
[S13] round=40 local utility u=0.000000 metrics={'f1_val': 0.6127213238475, 'auprc': 0.547318811343176, 'loss_val': 0.8145001879385966, 'psi': 0.5865603188457704}-{'f1_val': 0.6124388251209253, 'auprc': 0.6845430118825897, 'loss_val': 0.7737375343238445, 'psi': 0.641280499825591}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=40 head_norm_before_train=1.976904 cos_to_last_merge=0.9998 (last merge round=36)
[S14] round=40 local utility u=0.067113 metrics={'f1_val': 0.9975765414632514, 'auprc': 0.9987241934779586, 'loss_val': 0.027506126917349088, 'psi': 0.9980356022691342}-{'f1_val': 0.9788574448256134, 'auprc': 0.9987019349318904, 'loss_val': 0.04935121411693535, 'psi': 0.9867952408681242}
[S15] START round=40 head_norm_before_train=1.485970 cos_to_last_merge=0.9998 (last merge round=36)
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.7017744648238542, 'auprc': 0.9834633203557479, 'loss_val': 0.450054802739203, 'psi': 0.8144500070366116}-{'f1_val': 0.9329946029951954, 'auprc': 0.9965841157690025, 'loss_val': 0.11290219737770935, 'psi': 0.9584304081047182}
[S16] START round=40 head_norm_before_train=2.080749 (no previous merge yet)
[S16] round=40 local utility u=0.000000 metrics={'f1_val': 0.9808665953048965, 'auprc': 0.991470172816594, 'loss_val': 0.06859358789043184, 'psi': 0.9851080263095755}-{'f1_val': 0.9918518825842244, 'auprc': 0.9917573210539836, 'loss_val': 0.04238020166334483, 'psi': 0.9918140579721281}
[S17] START round=40 head_norm_before_train=1.383920 cos_to_last_merge=0.9993 (last merge round=37)
[S17] round=40 local utility u=0.000000 metrics={'f1_val': 0.6482898827984707, 'auprc': 0.8292260389947846, 'loss_val': 0.8692792112705262, 'psi': 0.7206643452769963}-{'f1_val': 0.6559049313404688, 'auprc': 0.828344534601014, 'loss_val': 0.8924356695452963, 'psi': 0.7248807726446869}
[S14] not sending this round → trigger blocked (psi=0.998)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:61017
[S10] not sending this round → trigger blocked (psi=0.995)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:61012
[S11] ⇄ pheromone p=0.057 → S5@127.0.0.1:61005
[S16] ⇄ pheromone p=0.241 → S7@127.0.0.1:61008
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S10] ⇄ pheromone p=0.002 → S14@127.0.0.1:61014
[S8] not sending this round → trigger blocked (psi=0.995)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=40 metric=0.9976 head_norm=1.989490
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.097345e-02
[S14] stored merged vector for next round verification (round=40)
[S14] DEBUG after merge:  round=40 metric=0.9976 head_norm=1.977042 delta_norm=0.030973
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S17] RECEIVED delta(kind=head bytes=1798) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.410276)
[S17] loaded HEAD from S6 (vec_in norm=1.410276)
[S17] cosine check vs S6: cos=0.9967
[S17] BUFFERED delta from S6 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1801) from S5
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.727264)
[S11] loaded HEAD from S5 (vec_in norm=1.727264)
[S11] cosine check vs S5: cos=0.9996
[S11] BUFFERED delta from S5 (total buffered=1)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=40 metric=0.9964 head_norm=1.727264
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.493445e-02
[S5] stored merged vector for next round verification (round=40)
[S5] DEBUG after merge:  round=40 metric=0.9964 head_norm=1.697336 delta_norm=0.054934
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.040 → S11@127.0.0.1:61012
[S6] ⇄ pheromone p=0.207 → S17@127.0.0.1:61017
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=40 metric=0.6483 head_norm=1.405483
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.683999e-02
[S17] stored merged vector for next round verification (round=40)
[S17] DEBUG after merge:  round=40 metric=0.6465 head_norm=1.406734 delta_norm=0.056840
[S17] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] ⇄ pheromone p=0.185 → S8@127.0.0.1:61009
[S8] ⇄ pheromone p=0.259 → S15@127.0.0.1:61015
[S2] START round=41 head_norm_before_train=2.052930 (no previous merge yet)
[S2] round=41 local utility u=0.003069 metrics={'f1_val': 0.8270324769014605, 'auprc': 0.9412779552580244, 'loss_val': 0.4097165443569213, 'psi': 0.8727306682440861}-{'f1_val': 0.832462452830113, 'auprc': 0.9104602665142791, 'loss_val': 0.3559807700784833, 'psi': 0.8636615783037794}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=41 head_norm_before_train=2.134678 cos_to_last_merge=0.7750 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.775
[S3] round=41 local utility u=0.000000 metrics={'f1_val': 0.6383254070426319, 'auprc': 0.9797546086904801, 'loss_val': 1.1385213301231416, 'psi': 0.7748970877017711}-{'f1_val': 0.959398380037106, 'auprc': 0.9985221771244286, 'loss_val': 0.10244993796784918, 'psi': 0.975047898872035}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=41 head_norm_before_train=1.978608 (no previous merge yet)
[S4] round=41 local utility u=0.000000 metrics={'f1_val': 0.9536789437413842, 'auprc': 0.9548190813082926, 'loss_val': 0.2642852692544124, 'psi': 0.9541349987681476}-{'f1_val': 0.9537649677551895, 'auprc': 0.9632598146650277, 'loss_val': 0.25807682521349895, 'psi': 0.9575629065191248}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=41 head_norm_before_train=1.697336 cos_to_last_merge=1.0000 (last merge round=40)
[S5] round=41 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9959054816370035, 'loss_val': 0.04121460569792521, 'psi': 0.996383373741876}-{'f1_val': 0.9964083724129549, 'auprc': 0.9973233713996308, 'loss_val': 0.03956655179561526, 'psi': 0.9967743720076252}
[S6] START round=41 head_norm_before_train=1.410276 cos_to_last_merge=0.9994 (last merge round=38)
[S6] round=41 local utility u=0.000868 metrics={'f1_val': 0.7888234419075074, 'auprc': 0.9202139994161321, 'loss_val': 0.5651315070953772, 'psi': 0.8413796649109573}-{'f1_val': 0.7863432964363968, 'auprc': 0.9232869019057162, 'loss_val': 0.5612048206619991, 'psi': 0.8411207386241245}
[S7] START round=41 head_norm_before_train=1.423524 cos_to_last_merge=0.9665 (last merge round=22)
[S7] round=41 local utility u=0.000000 metrics={'f1_val': 0.6217633830413323, 'auprc': 0.7960923164625032, 'loss_val': 0.5988635816222311, 'psi': 0.6914949564098007}-{'f1_val': 0.6861068548233529, 'auprc': 0.839531974571868, 'loss_val': 0.33046525886309197, 'psi': 0.747476902722759}
[S8] START round=41 head_norm_before_train=1.489554 cos_to_last_merge=0.9994 (last merge round=34)
[S8] round=41 local utility u=0.000000 metrics={'f1_val': 0.9143934460725643, 'auprc': 0.9861401883622555, 'loss_val': 0.12535015759952284, 'psi': 0.9430921429884408}-{'f1_val': 0.9934667705418724, 'auprc': 0.9982825397772199, 'loss_val': 0.05236716516695066, 'psi': 0.9953930782360114}
[S9] START round=41 head_norm_before_train=1.512099 cos_to_last_merge=0.9999 (last merge round=39)
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.9916752349893785, 'auprc': 0.9981136900363038, 'loss_val': 0.04228207811040771, 'psi': 0.9942506170081487}-{'f1_val': 0.9954158325366191, 'auprc': 0.9981406638223067, 'loss_val': 0.0353659327368957, 'psi': 0.9965057650508942}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=41 head_norm_before_train=1.969575 cos_to_last_merge=0.9998 (last merge round=36)
[S10] round=41 local utility u=0.000000 metrics={'f1_val': 0.9944449605296568, 'auprc': 0.9962151845406257, 'loss_val': 0.029781073216183812, 'psi': 0.9951530501340444}-{'f1_val': 0.9944449605296568, 'auprc': 0.9963426875445976, 'loss_val': 0.030062825890827916, 'psi': 0.9952040513356332}
[S11] START round=41 head_norm_before_train=1.696547 cos_to_last_merge=1.0000 (last merge round=39)
[S11] round=41 local utility u=0.532001 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9954888940966049, 'loss_val': 0.051726733667663026, 'psi': 0.9958757625866276}-{'f1_val': 0.8449007273075564, 'auprc': 0.9954862781067791, 'loss_val': 0.20832359308879125, 'psi': 0.9051349476272454}
[S13] START round=41 head_norm_before_train=1.335007 cos_to_last_merge=0.9970 (last merge round=32)
[S13] round=41 local utility u=0.333071 metrics={'f1_val': 0.6291355544032495, 'auprc': 0.6776312898293472, 'loss_val': 0.637780799605, 'psi': 0.6485338485736887}-{'f1_val': 0.6127213238475, 'auprc': 0.547318811343176, 'loss_val': 0.8145001879385966, 'psi': 0.5865603188457704}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=41 head_norm_before_train=1.977042 cos_to_last_merge=1.0000 (last merge round=40)
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.9961605687915402, 'auprc': 0.9986061521882305, 'loss_val': 0.034515543661471346, 'psi': 0.9971388021502163}-{'f1_val': 0.9975765414632514, 'auprc': 0.9987241934779586, 'loss_val': 0.027506126917349088, 'psi': 0.9980356022691342}
[S15] START round=41 head_norm_before_train=1.499603 cos_to_last_merge=0.9996 (last merge round=36)
[S15] round=41 local utility u=0.065347 metrics={'f1_val': 0.7113929822275495, 'auprc': 0.9898885355835134, 'loss_val': 0.3963480854412015, 'psi': 0.8227912035699352}-{'f1_val': 0.7017744648238542, 'auprc': 0.9834633203557479, 'loss_val': 0.450054802739203, 'psi': 0.8144500070366116}
[S16] START round=41 head_norm_before_train=2.086125 (no previous merge yet)
[S16] round=41 local utility u=0.000000 metrics={'f1_val': 0.9382865279133622, 'auprc': 0.986160493632566, 'loss_val': 0.31678943702602147, 'psi': 0.9574361142010437}-{'f1_val': 0.9808665953048965, 'auprc': 0.991470172816594, 'loss_val': 0.06859358789043184, 'psi': 0.9851080263095755}
[S17] START round=41 head_norm_before_train=1.406734 cos_to_last_merge=1.0000 (last merge round=40)
[S17] round=41 local utility u=0.000000 metrics={'f1_val': 0.6528793945810791, 'auprc': 0.8249501336019622, 'loss_val': 1.0157414211937423, 'psi': 0.7217076901894324}-{'f1_val': 0.6482898827984707, 'auprc': 0.8292260389947846, 'loss_val': 0.8692792112705262, 'psi': 0.7206643452769963}
[S6] not sending this round → trigger blocked (psi=0.841)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S11] → sending delta(kind=head bytes=1806) to S5@127.0.0.1:61005
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1806 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1806) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.711435)
[S5] loaded HEAD from S11 (vec_in norm=1.711435)
[S5] cosine check vs S11: cos=0.9998
[S5] BUFFERED delta from S11 (total buffered=1)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=41 metric=0.9961 head_norm=1.711435
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.803508e-02
[S11] stored merged vector for next round verification (round=41)
[S11] DEBUG after merge:  round=41 metric=0.9961 head_norm=1.719139 delta_norm=0.028035
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:61009
[S15] sending update (kind=head size=1805 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1805) from S15
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.512516)
[S8] loaded HEAD from S15 (vec_in norm=1.512516)
[S8] cosine check vs S15: cos=0.9988
[S8] BUFFERED delta from S15 (total buffered=1)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=41 metric=0.9144 head_norm=1.494775
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.827029e-02
[S8] stored merged vector for next round verification (round=41)
[S8] DEBUG after merge:  round=41 metric=0.9212 head_norm=1.503184 delta_norm=0.038270
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=42 head_norm_before_train=2.058877 (no previous merge yet)
[S2] round=42 local utility u=0.000000 metrics={'f1_val': 0.8309363832354416, 'auprc': 0.9218609287915471, 'loss_val': 0.38865410598472544, 'psi': 0.8673062014578838}-{'f1_val': 0.8270324769014605, 'auprc': 0.9412779552580244, 'loss_val': 0.4097165443569213, 'psi': 0.8727306682440861}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=42 head_norm_before_train=2.143280 cos_to_last_merge=0.7741 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.774
[S3] round=42 local utility u=0.428780 metrics={'f1_val': 0.7128563531778559, 'auprc': 0.9776242907224064, 'loss_val': 0.7217565767296159, 'psi': 0.8187635281956761}-{'f1_val': 0.6383254070426319, 'auprc': 0.9797546086904801, 'loss_val': 1.1385213301231416, 'psi': 0.7748970877017711}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=42 head_norm_before_train=1.987227 (no previous merge yet)
[S4] round=42 local utility u=0.003835 metrics={'f1_val': 0.9539587261114895, 'auprc': 0.9591285700233896, 'loss_val': 0.27122253310215516, 'psi': 0.9560266636762496}-{'f1_val': 0.9536789437413842, 'auprc': 0.9548190813082926, 'loss_val': 0.2642852692544124, 'psi': 0.9541349987681476}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=42 head_norm_before_train=1.723020 cos_to_last_merge=0.9999 (last merge round=40)
[S5] round=42 local utility u=0.005257 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9981100272625825, 'loss_val': 0.03731402714236294, 'psi': 0.9972651919921076}-{'f1_val': 0.9967019684784577, 'auprc': 0.9959054816370035, 'loss_val': 0.04121460569792521, 'psi': 0.996383373741876}
[S6] START round=42 head_norm_before_train=1.438180 cos_to_last_merge=0.9986 (last merge round=38)
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.6683938327957608, 'auprc': 0.8996405838721493, 'loss_val': 0.7582097805072786, 'psi': 0.7608925332263162}-{'f1_val': 0.7888234419075074, 'auprc': 0.9202139994161321, 'loss_val': 0.5651315070953772, 'psi': 0.8413796649109573}
[S7] START round=42 head_norm_before_train=1.429404 cos_to_last_merge=0.9659 (last merge round=22)
[S7] round=42 local utility u=0.000000 metrics={'f1_val': 0.6068034989900585, 'auprc': 0.7895053871350467, 'loss_val': 0.7588738878675928, 'psi': 0.6798842542480538}-{'f1_val': 0.6217633830413323, 'auprc': 0.7960923164625032, 'loss_val': 0.5988635816222311, 'psi': 0.6914949564098007}
[S8] START round=42 head_norm_before_train=1.503184 cos_to_last_merge=1.0000 (last merge round=41)
[S8] round=42 local utility u=0.283007 metrics={'f1_val': 0.9900154226160678, 'auprc': 0.9990062080664581, 'loss_val': 0.0516669561973289, 'psi': 0.9936117367962238}-{'f1_val': 0.9143934460725643, 'auprc': 0.9861401883622555, 'loss_val': 0.12535015759952284, 'psi': 0.9430921429884408}
[S9] START round=42 head_norm_before_train=1.531018 cos_to_last_merge=0.9997 (last merge round=39)
[S9] round=42 local utility u=0.019921 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9977552106791153, 'loss_val': 0.03127568537397611, 'psi': 0.997098391359981}-{'f1_val': 0.9916752349893785, 'auprc': 0.9981136900363038, 'loss_val': 0.04228207811040771, 'psi': 0.9942506170081487}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=42 head_norm_before_train=1.976622 cos_to_last_merge=0.9997 (last merge round=36)
[S10] round=42 local utility u=0.000636 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9961416587531042, 'loss_val': 0.02960511571119178, 'psi': 0.9952552965068915}-{'f1_val': 0.9944449605296568, 'auprc': 0.9962151845406257, 'loss_val': 0.029781073216183812, 'psi': 0.9951530501340444}
[S11] START round=42 head_norm_before_train=1.719139 cos_to_last_merge=1.0000 (last merge round=41)
[S11] round=42 local utility u=0.009058 metrics={'f1_val': 0.9963753869090841, 'auprc': 0.9960447396024762, 'loss_val': 0.03672870925733623, 'psi': 0.996243127986441}-{'f1_val': 0.9961336749133093, 'auprc': 0.9954888940966049, 'loss_val': 0.051726733667663026, 'psi': 0.9958757625866276}
[S13] START round=42 head_norm_before_train=1.340607 cos_to_last_merge=0.9969 (last merge round=32)
[S13] round=42 local utility u=0.000000 metrics={'f1_val': 0.6287476757630952, 'auprc': 0.6745323400364884, 'loss_val': 0.6647945195087346, 'psi': 0.6470615414724525}-{'f1_val': 0.6291355544032495, 'auprc': 0.6776312898293472, 'loss_val': 0.637780799605, 'psi': 0.6485338485736887}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=42 head_norm_before_train=1.988719 cos_to_last_merge=1.0000 (last merge round=40)
[S14] round=42 local utility u=0.009732 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9987856280473507, 'loss_val': 0.02554461179626267, 'psi': 0.9982059619992714}-{'f1_val': 0.9961605687915402, 'auprc': 0.9986061521882305, 'loss_val': 0.034515543661471346, 'psi': 0.9971388021502163}
[S15] START round=42 head_norm_before_train=1.512516 cos_to_last_merge=0.9994 (last merge round=36)
[S15] round=42 local utility u=0.831678 metrics={'f1_val': 0.9367363009705276, 'auprc': 0.9956712929417513, 'loss_val': 0.10240028432627958, 'psi': 0.9603102977590171}-{'f1_val': 0.7113929822275495, 'auprc': 0.9898885355835134, 'loss_val': 0.3963480854412015, 'psi': 0.8227912035699352}
[S16] START round=42 head_norm_before_train=2.092717 (no previous merge yet)
[S16] round=42 local utility u=0.313030 metrics={'f1_val': 0.9923722266073849, 'auprc': 0.9927864972616954, 'loss_val': 0.03512124811586603, 'psi': 0.992537934869109}-{'f1_val': 0.9382865279133622, 'auprc': 0.986160493632566, 'loss_val': 0.31678943702602147, 'psi': 0.9574361142010437}
[S17] START round=42 head_norm_before_train=1.425065 cos_to_last_merge=0.9998 (last merge round=40)
[S17] round=42 local utility u=0.306636 metrics={'f1_val': 0.7000650005269001, 'auprc': 0.857081078321242, 'loss_val': 0.7819761084188795, 'psi': 0.7628714316446369}-{'f1_val': 0.6528793945810791, 'auprc': 0.8249501336019622, 'loss_val': 1.0157414211937423, 'psi': 0.7217076901894324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:61008
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:61014
[S11] not sending this round → trigger blocked (psi=0.996)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:61011
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S11@127.0.0.1:61012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:61015
[S14] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:61007
[S10] RECEIVED delta(kind=head bytes=1799) from S14
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.999732)
[S10] loaded HEAD from S14 (vec_in norm=1.999732)
[S10] cosine check vs S14: cos=0.9995
[S10] BUFFERED delta from S14 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1801) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.980069)
[S14] loaded HEAD from S10 (vec_in norm=1.980069)
[S14] cosine check vs S10: cos=0.9995
[S14] BUFFERED delta from S10 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1803) from S5
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.741924)
[S11] loaded HEAD from S5 (vec_in norm=1.741924)
[S11] cosine check vs S5: cos=0.9999
[S11] BUFFERED delta from S5 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1800) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=2.098985)
[S7] loaded HEAD from S16 (vec_in norm=2.098985)
[S7] cosine check vs S16: cos=-0.0596
[S7] DROPPED delta from S16 (cos=-0.0596 < 0.0)
[S17] sending update (kind=head size=1798 to 1 peers)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=42 metric=0.9967 head_norm=1.741924
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.808663e-02
[S5] stored merged vector for next round verification (round=42)
[S5] DEBUG after merge:  round=42 metric=0.9967 head_norm=1.726518 delta_norm=0.028087
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S8] sending update (kind=head size=1801 to 1 peers)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=42 metric=0.9947 head_norm=1.980069
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.275216e-02
[S10] stored merged vector for next round verification (round=42)
[S10] DEBUG after merge:  round=42 metric=0.9947 head_norm=1.989655 delta_norm=0.032752
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=42 metric=0.9978 head_norm=1.999732
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.275216e-02
[S14] stored merged vector for next round verification (round=42)
[S14] DEBUG after merge:  round=42 metric=0.9978 head_norm=1.989655 delta_norm=0.032752
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S6] RECEIVED delta(kind=head bytes=1798) from S17
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.445189)
[S6] loaded HEAD from S17 (vec_in norm=1.445189)
[S6] cosine check vs S17: cos=0.9956
[S6] BUFFERED delta from S17 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1801) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.509928)
[S15] loaded HEAD from S8 (vec_in norm=1.509928)
[S15] cosine check vs S8: cos=0.9995
[S15] BUFFERED delta from S8 (total buffered=1)
[S15] not sending this round → trigger blocked (psi=0.960)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=42 metric=0.9367 head_norm=1.525363
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.545744e-02
[S15] stored merged vector for next round verification (round=42)
[S15] DEBUG after merge:  round=42 metric=0.9362 head_norm=1.517451 delta_norm=0.025457
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=43 head_norm_before_train=2.062638 (no previous merge yet)
[S2] round=43 local utility u=0.004011 metrics={'f1_val': 0.8270512478736745, 'auprc': 0.9419181724188124, 'loss_val': 0.4174935529241172, 'psi': 0.8729980176917296}-{'f1_val': 0.8309363832354416, 'auprc': 0.9218609287915471, 'loss_val': 0.38865410598472544, 'psi': 0.8673062014578838}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=43 head_norm_before_train=2.150526 cos_to_last_merge=0.7734 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.773
[S3] round=43 local utility u=1.000000 metrics={'f1_val': 0.9608203197691346, 'auprc': 0.9993995424991151, 'loss_val': 0.15623197965796132, 'psi': 0.9762520088611268}-{'f1_val': 0.7128563531778559, 'auprc': 0.9776242907224064, 'loss_val': 0.7217565767296159, 'psi': 0.8187635281956761}
[S3] not sending this round → trigger blocked (psi=0.976)
[S4] START round=43 head_norm_before_train=1.993397 (no previous merge yet)
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.9489330140941972, 'auprc': 0.9390919537981731, 'loss_val': 0.26031623391749986, 'psi': 0.9449965899757875}-{'f1_val': 0.9539587261114895, 'auprc': 0.9591285700233896, 'loss_val': 0.27122253310215516, 'psi': 0.9560266636762496}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=43 head_norm_before_train=1.726518 cos_to_last_merge=1.0000 (last merge round=42)
[S5] round=43 local utility u=0.001343 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.998012059733437, 'loss_val': 0.034335105925208914, 'psi': 0.9972260049804493}-{'f1_val': 0.9967019684784577, 'auprc': 0.9981100272625825, 'loss_val': 0.03731402714236294, 'psi': 0.9972651919921076}
[S6] START round=43 head_norm_before_train=1.465556 cos_to_last_merge=0.9976 (last merge round=38)
[S6] round=43 local utility u=0.344567 metrics={'f1_val': 0.7623844868028926, 'auprc': 0.9040854137432279, 'loss_val': 0.6463542161375823, 'psi': 0.8190648575790267}-{'f1_val': 0.6683938327957608, 'auprc': 0.8996405838721493, 'loss_val': 0.7582097805072786, 'psi': 0.7608925332263162}
[S7] START round=43 head_norm_before_train=1.436197 cos_to_last_merge=0.9652 (last merge round=22)
[S7] round=43 local utility u=0.173637 metrics={'f1_val': 0.6338460073885259, 'auprc': 0.7987834653203756, 'loss_val': 0.6016885970695888, 'psi': 0.6998209905612658}-{'f1_val': 0.6068034989900585, 'auprc': 0.7895053871350467, 'loss_val': 0.7588738878675928, 'psi': 0.6798842542480538}
[S8] START round=43 head_norm_before_train=1.509928 cos_to_last_merge=1.0000 (last merge round=41)
[S8] round=43 local utility u=0.006797 metrics={'f1_val': 0.9930990485370332, 'auprc': 0.9979574423881611, 'loss_val': 0.05342800386192352, 'psi': 0.9950424060774843}-{'f1_val': 0.9900154226160678, 'auprc': 0.9990062080664581, 'loss_val': 0.0516669561973289, 'psi': 0.9936117367962238}
[S9] START round=43 head_norm_before_train=1.542524 cos_to_last_merge=0.9995 (last merge round=39)
[S9] round=43 local utility u=0.001182 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9981404643034895, 'loss_val': 0.030067512696124142, 'psi': 0.9972524928097306}-{'f1_val': 0.9966605118138915, 'auprc': 0.9977552106791153, 'loss_val': 0.03127568537397611, 'psi': 0.997098391359981}
[S9] not sending this round → trigger blocked (psi=0.997)
[S10] START round=43 head_norm_before_train=1.989655 cos_to_last_merge=1.0000 (last merge round=42)
[S10] round=43 local utility u=0.000000 metrics={'f1_val': 0.9940063275949004, 'auprc': 0.9963940599517462, 'loss_val': 0.03031791049360587, 'psi': 0.9949614205376387}-{'f1_val': 0.9946643883427498, 'auprc': 0.9961416587531042, 'loss_val': 0.02960511571119178, 'psi': 0.9952552965068915}
[S11] START round=43 head_norm_before_train=1.731991 cos_to_last_merge=1.0000 (last merge round=41)
[S11] round=43 local utility u=0.002401 metrics={'f1_val': 0.9963753869090841, 'auprc': 0.9969233457303635, 'loss_val': 0.03456316935877708, 'psi': 0.9965945704375958}-{'f1_val': 0.9963753869090841, 'auprc': 0.9960447396024762, 'loss_val': 0.03672870925733623, 'psi': 0.996243127986441}
[S13] START round=43 head_norm_before_train=1.345073 cos_to_last_merge=0.9967 (last merge round=32)
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.6248835975731449, 'auprc': 0.6111034618685163, 'loss_val': 0.7727632134732697, 'psi': 0.6193715432912934}-{'f1_val': 0.6287476757630952, 'auprc': 0.6745323400364884, 'loss_val': 0.6647945195087346, 'psi': 0.6470615414724525}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=43 head_norm_before_train=1.989655 cos_to_last_merge=1.0000 (last merge round=42)
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.9975787828504585, 'auprc': 0.9987189648664551, 'loss_val': 0.026073714244755932, 'psi': 0.9980348556568571}-{'f1_val': 0.9978195179672185, 'auprc': 0.9987856280473507, 'loss_val': 0.02554461179626267, 'psi': 0.9982059619992714}
[S15] START round=43 head_norm_before_train=1.517451 cos_to_last_merge=1.0000 (last merge round=42)
[S15] round=43 local utility u=0.209516 metrics={'f1_val': 0.9949932333886315, 'auprc': 0.9985638881676929, 'loss_val': 0.04158672620162111, 'psi': 0.9964214953002561}-{'f1_val': 0.9367363009705276, 'auprc': 0.9956712929417513, 'loss_val': 0.10240028432627958, 'psi': 0.9603102977590171}
[S16] START round=43 head_norm_before_train=2.098985 (no previous merge yet)
[S16] round=43 local utility u=0.000000 metrics={'f1_val': 0.9925366191513935, 'auprc': 0.9931782195230076, 'loss_val': 0.03960828181937483, 'psi': 0.9927932593000391}-{'f1_val': 0.9923722266073849, 'auprc': 0.9927864972616954, 'loss_val': 0.03512124811586603, 'psi': 0.992537934869109}
[S17] START round=43 head_norm_before_train=1.445189 cos_to_last_merge=0.9994 (last merge round=40)
[S17] round=43 local utility u=0.000000 metrics={'f1_val': 0.6511628254426138, 'auprc': 0.8343185724712345, 'loss_val': 0.8977302905028441, 'psi': 0.7244251242540621}-{'f1_val': 0.7000650005269001, 'auprc': 0.857081078321242, 'loss_val': 0.7819761084188795, 'psi': 0.7628714316446369}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:61016
[S5] not sending this round → trigger blocked (psi=0.997)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S11] → sending delta(kind=head bytes=1807) to S5@127.0.0.1:61005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:61017
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1807 to 1 peers)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.995)
[S7] sending update (kind=head size=1798 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1800) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.496937)
[S17] loaded HEAD from S6 (vec_in norm=1.496937)
[S17] cosine check vs S6: cos=0.9933
[S17] BUFFERED delta from S6 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1798) from S7
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.448326)
[S16] loaded HEAD from S7 (vec_in norm=1.448326)
[S16] cosine check vs S7: cos=-0.0595
[S16] DROPPED delta from S7 (cos=-0.0595 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1807) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.743877)
[S5] loaded HEAD from S11 (vec_in norm=1.743877)
[S5] cosine check vs S11: cos=0.9999
[S5] BUFFERED delta from S11 (total buffered=1)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=43 metric=0.9964 head_norm=1.743877
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.527697e-02
[S11] stored merged vector for next round verification (round=43)
[S11] DEBUG after merge:  round=43 metric=0.9964 head_norm=1.742834 delta_norm=0.015277
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=43 metric=0.7624 head_norm=1.496937
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.212482e-02
[S6] stored merged vector for next round verification (round=43)
[S6] DEBUG after merge:  round=43 metric=0.7637 head_norm=1.468997 delta_norm=0.082125
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=43 metric=0.6512 head_norm=1.462231
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.727380e-02
[S17] stored merged vector for next round verification (round=43)
[S17] DEBUG after merge:  round=43 metric=0.6498 head_norm=1.477110 delta_norm=0.087274
[S17] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:61009
[S15] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S15
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.531250)
[S8] loaded HEAD from S15 (vec_in norm=1.531250)
[S8] cosine check vs S15: cos=0.9997
[S8] BUFFERED delta from S15 (total buffered=1)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=43 metric=0.9931 head_norm=1.519603
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.931115e-02
[S8] stored merged vector for next round verification (round=43)
[S8] DEBUG after merge:  round=43 metric=0.9931 head_norm=1.525315 delta_norm=0.019311
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=44 head_norm_before_train=2.068481 (no previous merge yet)
[S2] round=44 local utility u=0.011335 metrics={'f1_val': 0.8309173127050001, 'auprc': 0.936170836299806, 'loss_val': 0.40077755416189986, 'psi': 0.8730187221429225}-{'f1_val': 0.8270512478736745, 'auprc': 0.9419181724188124, 'loss_val': 0.4174935529241172, 'psi': 0.8729980176917296}
[S2] not sending this round → trigger blocked (psi=0.873)
[S3] START round=44 head_norm_before_train=2.156667 cos_to_last_merge=0.7727 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.773
[S3] round=44 local utility u=0.166652 metrics={'f1_val': 0.9940335392918865, 'auprc': 0.9990979079632194, 'loss_val': 0.021301858295752474, 'psi': 0.9960592867604197}-{'f1_val': 0.9608203197691346, 'auprc': 0.9993995424991151, 'loss_val': 0.15623197965796132, 'psi': 0.9762520088611268}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=44 head_norm_before_train=1.996823 (no previous merge yet)
[S4] round=44 local utility u=0.031472 metrics={'f1_val': 0.9526746522583499, 'auprc': 0.950154589093813, 'loss_val': 0.25300994214836203, 'psi': 0.9516666269925351}-{'f1_val': 0.9489330140941972, 'auprc': 0.9390919537981731, 'loss_val': 0.26031623391749986, 'psi': 0.9449965899757875}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=44 head_norm_before_train=1.745227 cos_to_last_merge=0.9999 (last merge round=42)
[S5] round=44 local utility u=0.000000 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9942672066681651, 'loss_val': 0.033540313665734484, 'psi': 0.9953310122060984}-{'f1_val': 0.9967019684784577, 'auprc': 0.998012059733437, 'loss_val': 0.034335105925208914, 'psi': 0.9972260049804493}
[S6] START round=44 head_norm_before_train=1.468997 cos_to_last_merge=1.0000 (last merge round=43)
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.5829012588878656, 'auprc': 0.8569487698906714, 'loss_val': 0.9703970410377939, 'psi': 0.692520263288988}-{'f1_val': 0.7623844868028926, 'auprc': 0.9040854137432279, 'loss_val': 0.6463542161375823, 'psi': 0.8190648575790267}
[S7] START round=44 head_norm_before_train=1.448326 cos_to_last_merge=0.9640 (last merge round=22)
[S7] round=44 local utility u=0.000000 metrics={'f1_val': 0.6255950966084374, 'auprc': 0.8015690716104953, 'loss_val': 0.5727697864717749, 'psi': 0.6959846866092605}-{'f1_val': 0.6338460073885259, 'auprc': 0.7987834653203756, 'loss_val': 0.6016885970695888, 'psi': 0.6998209905612658}
[S8] START round=44 head_norm_before_train=1.525315 cos_to_last_merge=1.0000 (last merge round=43)
[S8] round=44 local utility u=0.001862 metrics={'f1_val': 0.9918109678295097, 'auprc': 0.9990467150932505, 'loss_val': 0.04524413982837516, 'psi': 0.994705266735006}-{'f1_val': 0.9930990485370332, 'auprc': 0.9979574423881611, 'loss_val': 0.05342800386192352, 'psi': 0.9950424060774843}
[S9] START round=44 head_norm_before_train=1.556255 cos_to_last_merge=0.9992 (last merge round=39)
[S9] round=44 local utility u=0.003257 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9985466436035999, 'loss_val': 0.02742659323657168, 'psi': 0.9976804049487257}-{'f1_val': 0.9966605118138915, 'auprc': 0.9981404643034895, 'loss_val': 0.030067512696124142, 'psi': 0.9972524928097306}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] sending update (kind=head size=1804 to 1 peers)
[S10] START round=44 head_norm_before_train=1.994961 cos_to_last_merge=1.0000 (last merge round=42)
[S10] round=44 local utility u=0.002106 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.996122262439004, 'loss_val': 0.029238750464180355, 'psi': 0.9952475379812515}-{'f1_val': 0.9940063275949004, 'auprc': 0.9963940599517462, 'loss_val': 0.03031791049360587, 'psi': 0.9949614205376387}
[S11] START round=44 head_norm_before_train=1.742834 cos_to_last_merge=1.0000 (last merge round=43)
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9960669776958054, 'loss_val': 0.035156178228099626, 'psi': 0.9961069960263078}-{'f1_val': 0.9963753869090841, 'auprc': 0.9969233457303635, 'loss_val': 0.03456316935877708, 'psi': 0.9965945704375958}
[S13] START round=44 head_norm_before_train=1.352129 cos_to_last_merge=0.9960 (last merge round=32)
[S13] round=44 local utility u=0.115793 metrics={'f1_val': 0.6242244302263319, 'auprc': 0.6808038782756283, 'loss_val': 0.7463230325714739, 'psi': 0.6468562094460504}-{'f1_val': 0.6248835975731449, 'auprc': 0.6111034618685163, 'loss_val': 0.7727632134732697, 'psi': 0.6193715432912934}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=44 head_norm_before_train=2.001994 cos_to_last_merge=1.0000 (last merge round=42)
[S14] round=44 local utility u=0.001351 metrics={'f1_val': 0.9979900342899044, 'auprc': 0.9987164369756132, 'loss_val': 0.02583118072113543, 'psi': 0.9982805953641879}-{'f1_val': 0.9975787828504585, 'auprc': 0.9987189648664551, 'loss_val': 0.026073714244755932, 'psi': 0.9980348556568571}
[S15] START round=44 head_norm_before_train=1.531250 cos_to_last_merge=1.0000 (last merge round=42)
[S15] round=44 local utility u=0.000000 metrics={'f1_val': 0.7689879148236054, 'auprc': 0.9875078865609294, 'loss_val': 0.3758652316620166, 'psi': 0.8563959035185349}-{'f1_val': 0.9949932333886315, 'auprc': 0.9985638881676929, 'loss_val': 0.04158672620162111, 'psi': 0.9964214953002561}
[S16] START round=44 head_norm_before_train=2.107040 (no previous merge yet)
[S16] round=44 local utility u=0.001802 metrics={'f1_val': 0.9921266903511881, 'auprc': 0.9943321811486264, 'loss_val': 0.03700658551196808, 'psi': 0.9930088866701634}-{'f1_val': 0.9925366191513935, 'auprc': 0.9931782195230076, 'loss_val': 0.03960828181937483, 'psi': 0.9927932593000391}
[S17] START round=44 head_norm_before_train=1.477110 cos_to_last_merge=1.0000 (last merge round=43)
[S17] round=44 local utility u=0.000000 metrics={'f1_val': 0.6540530261595258, 'auprc': 0.8284330196326772, 'loss_val': 1.033725142384448, 'psi': 0.7238050235487863}-{'f1_val': 0.6511628254426138, 'auprc': 0.8343185724712345, 'loss_val': 0.8977302905028441, 'psi': 0.7244251242540621}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:61008
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:61014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:61011
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=44 metric=0.9960 head_norm=1.759855
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.169822e-02
[S5] stored merged vector for next round verification (round=44)
[S5] DEBUG after merge:  round=44 metric=0.9960 head_norm=1.751750 delta_norm=0.021698
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:61015
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] RECEIVED delta(kind=head bytes=1798) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=2.002067)
[S14] loaded HEAD from S10 (vec_in norm=2.002067)
[S14] cosine check vs S10: cos=0.9999
[S14] BUFFERED delta from S10 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1798) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=2.112338)
[S7] loaded HEAD from S16 (vec_in norm=2.112338)
[S7] cosine check vs S16: cos=-0.0599
[S7] DROPPED delta from S16 (cos=-0.0599 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1801) from S14
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=2.011360)
[S10] loaded HEAD from S14 (vec_in norm=2.011360)
[S10] cosine check vs S14: cos=0.9999
[S10] BUFFERED delta from S14 (total buffered=1)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=44 metric=0.9947 head_norm=2.002067
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.499094e-02
[S10] stored merged vector for next round verification (round=44)
[S10] DEBUG after merge:  round=44 metric=0.9947 head_norm=2.006663 delta_norm=0.014991
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S8] sending update (kind=head size=1804 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=44 metric=0.9980 head_norm=2.011360
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.499094e-02
[S14] stored merged vector for next round verification (round=44)
[S14] DEBUG after merge:  round=44 metric=0.9980 head_norm=2.006663 delta_norm=0.014991
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] RECEIVED delta(kind=head bytes=1804) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.535880)
[S15] loaded HEAD from S8 (vec_in norm=1.535880)
[S15] cosine check vs S8: cos=0.9998
[S15] BUFFERED delta from S8 (total buffered=1)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=44 metric=0.7690 head_norm=1.543116
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.559328e-02
[S15] stored merged vector for next round verification (round=44)
[S15] DEBUG after merge:  round=44 metric=0.7690 head_norm=1.539423 delta_norm=0.015593
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=45 head_norm_before_train=2.073515 (no previous merge yet)
[S2] round=45 local utility u=0.005927 metrics={'f1_val': 0.8291712676005863, 'auprc': 0.9516840068486585, 'loss_val': 0.4249874486331797, 'psi': 0.8781763632998152}-{'f1_val': 0.8309173127050001, 'auprc': 0.936170836299806, 'loss_val': 0.40077755416189986, 'psi': 0.8730187221429225}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=45 head_norm_before_train=2.163149 cos_to_last_merge=0.7720 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.772
[S3] round=45 local utility u=0.008324 metrics={'f1_val': 0.9965117892586061, 'auprc': 0.9986815609686158, 'loss_val': 0.018273768420628424, 'psi': 0.9973796979426099}-{'f1_val': 0.9940335392918865, 'auprc': 0.9990979079632194, 'loss_val': 0.021301858295752474, 'psi': 0.9960592867604197}
[S3] not sending this round → trigger blocked (psi=0.997)
[S4] START round=45 head_norm_before_train=1.995922 (no previous merge yet)
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.9505744698384695, 'auprc': 0.9349977670813493, 'loss_val': 0.25270075899520816, 'psi': 0.9443437887356214}-{'f1_val': 0.9526746522583499, 'auprc': 0.950154589093813, 'loss_val': 0.25300994214836203, 'psi': 0.9516666269925351}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=45 head_norm_before_train=1.751750 cos_to_last_merge=1.0000 (last merge round=44)
[S5] round=45 local utility u=0.007856 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.998409655244426, 'loss_val': 0.034226394842679544, 'psi': 0.997385043184845}-{'f1_val': 0.9960402158980539, 'auprc': 0.9942672066681651, 'loss_val': 0.033540313665734484, 'psi': 0.9953310122060984}
[S6] START round=45 head_norm_before_train=1.488506 cos_to_last_merge=0.9999 (last merge round=43)
[S6] round=45 local utility u=1.000000 metrics={'f1_val': 0.8105960657531235, 'auprc': 0.9200200284739134, 'loss_val': 0.4951700142219839, 'psi': 0.8543656508414395}-{'f1_val': 0.5829012588878656, 'auprc': 0.8569487698906714, 'loss_val': 0.9703970410377939, 'psi': 0.692520263288988}
[S7] START round=45 head_norm_before_train=1.462451 cos_to_last_merge=0.9626 (last merge round=22)
[S7] round=45 local utility u=0.407187 metrics={'f1_val': 0.684668497005603, 'auprc': 0.8583595236482322, 'loss_val': 0.28320675912797766, 'psi': 0.7541449076626546}-{'f1_val': 0.6255950966084374, 'auprc': 0.8015690716104953, 'loss_val': 0.5727697864717749, 'psi': 0.6959846866092605}
[S8] START round=45 head_norm_before_train=1.535880 cos_to_last_merge=1.0000 (last merge round=43)
[S8] round=45 local utility u=0.002247 metrics={'f1_val': 0.992174240363445, 'auprc': 0.9991571826604801, 'loss_val': 0.04326075152458358, 'psi': 0.9949674172822591}-{'f1_val': 0.9918109678295097, 'auprc': 0.9990467150932505, 'loss_val': 0.04524413982837516, 'psi': 0.994705266735006}
[S9] START round=45 head_norm_before_train=1.572170 cos_to_last_merge=0.9989 (last merge round=39)
[S9] round=45 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9981557516560424, 'loss_val': 0.02670987790144368, 'psi': 0.9972777954212743}-{'f1_val': 0.9971029125121428, 'auprc': 0.9985466436035999, 'loss_val': 0.02742659323657168, 'psi': 0.9976804049487257}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=45 head_norm_before_train=2.006663 cos_to_last_merge=1.0000 (last merge round=44)
[S10] round=45 local utility u=0.000194 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9961089545642561, 'loss_val': 0.02881164506151231, 'psi': 0.9952422148313522}-{'f1_val': 0.9946643883427498, 'auprc': 0.996122262439004, 'loss_val': 0.029238750464180355, 'psi': 0.9952475379812515}
[S11] START round=45 head_norm_before_train=1.754081 cos_to_last_merge=1.0000 (last merge round=43)
[S11] round=45 local utility u=0.000000 metrics={'f1_val': 0.9698374697316041, 'auprc': 0.995082931432379, 'loss_val': 0.08477352914364389, 'psi': 0.979935654411914}-{'f1_val': 0.9961336749133093, 'auprc': 0.9960669776958054, 'loss_val': 0.035156178228099626, 'psi': 0.9961069960263078}
[S13] START round=45 head_norm_before_train=1.361556 cos_to_last_merge=0.9954 (last merge round=32)
[S13] round=45 local utility u=0.000000 metrics={'f1_val': 0.6191615686872518, 'auprc': 0.681331870078015, 'loss_val': 0.7961764989058471, 'psi': 0.6440296892435571}-{'f1_val': 0.6242244302263319, 'auprc': 0.6808038782756283, 'loss_val': 0.7463230325714739, 'psi': 0.6468562094460504}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=45 head_norm_before_train=2.006663 cos_to_last_merge=1.0000 (last merge round=44)
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.9975765414632514, 'auprc': 0.9987414810895061, 'loss_val': 0.02673446422235756, 'psi': 0.9980425173137533}-{'f1_val': 0.9979900342899044, 'auprc': 0.9987164369756132, 'loss_val': 0.02583118072113543, 'psi': 0.9982805953641879}
[S15] START round=45 head_norm_before_train=1.539423 cos_to_last_merge=1.0000 (last merge round=44)
[S15] round=45 local utility u=0.003497 metrics={'f1_val': 0.7699337675147574, 'auprc': 0.9902379477369174, 'loss_val': 0.38273562866670197, 'psi': 0.8580554396036214}-{'f1_val': 0.7689879148236054, 'auprc': 0.9875078865609294, 'loss_val': 0.3758652316620166, 'psi': 0.8563959035185349}
[S16] START round=45 head_norm_before_train=2.112338 (no previous merge yet)
[S16] round=45 local utility u=0.000000 metrics={'f1_val': 0.8636760623543039, 'auprc': 0.9903810315621692, 'loss_val': 0.6825148578064796, 'psi': 0.91435805003745}-{'f1_val': 0.9921266903511881, 'auprc': 0.9943321811486264, 'loss_val': 0.03700658551196808, 'psi': 0.9930088866701634}
[S17] START round=45 head_norm_before_train=1.492740 cos_to_last_merge=0.9999 (last merge round=43)
[S17] round=45 local utility u=0.172452 metrics={'f1_val': 0.6672847395491487, 'auprc': 0.8405526473174324, 'loss_val': 0.804569754930041, 'psi': 0.7365919026564622}-{'f1_val': 0.6540530261595258, 'auprc': 0.8284330196326772, 'loss_val': 1.033725142384448, 'psi': 0.7238050235487863}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S11@127.0.0.1:61012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:61016
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.995)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:61017
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1799 to 1 peers)
[S16] ⇄ pheromone p=0.111 → S7@127.0.0.1:61008
[S14] ⇄ pheromone p=0.019 → S10@127.0.0.1:61011
[S10] ⇄ pheromone p=0.001 → S14@127.0.0.1:61014
[S11] ⇄ pheromone p=0.063 → S5@127.0.0.1:61005
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] not sending this round → trigger blocked (psi=0.995)
[S5] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:61007
[S16] RECEIVED delta(kind=head bytes=1800) from S7
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.473722)
[S16] loaded HEAD from S7 (vec_in norm=1.473722)
[S16] cosine check vs S7: cos=-0.0597
[S16] DROPPED delta from S7 (cos=-0.0597 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1799) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.505470)
[S17] loaded HEAD from S6 (vec_in norm=1.505470)
[S17] cosine check vs S6: cos=0.9992
[S17] BUFFERED delta from S6 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1803) from S5
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.771936)
[S11] loaded HEAD from S5 (vec_in norm=1.771936)
[S11] cosine check vs S5: cos=0.9998
[S11] BUFFERED delta from S5 (total buffered=1)
[S5] ⇄ pheromone p=0.015 → S11@127.0.0.1:61012
[S6] ⇄ pheromone p=0.312 → S17@127.0.0.1:61017
[S7] ⇄ pheromone p=0.168 → S16@127.0.0.1:61016
[S17] sending update (kind=head size=1804 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1804) from S17
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.505127)
[S6] loaded HEAD from S17 (vec_in norm=1.505127)
[S6] cosine check vs S17: cos=0.9992
[S6] BUFFERED delta from S17 (total buffered=1)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=45 metric=0.6673 head_norm=1.505127
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.971547e-02
[S17] stored merged vector for next round verification (round=45)
[S17] DEBUG after merge:  round=45 metric=0.6673 head_norm=1.505005 delta_norm=0.029715
[S17] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.087 → S6@127.0.0.1:61007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:61009
[S15] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S15
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.552069)
[S8] loaded HEAD from S15 (vec_in norm=1.552069)
[S8] cosine check vs S15: cos=0.9998
[S8] BUFFERED delta from S15 (total buffered=1)
[S15] ⇄ pheromone p=0.179 → S8@127.0.0.1:61009
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=45 metric=0.9922 head_norm=1.546549
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.406086e-02
[S8] stored merged vector for next round verification (round=45)
[S8] DEBUG after merge:  round=45 metric=0.9922 head_norm=1.549247 delta_norm=0.014061
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.115 → S15@127.0.0.1:61015
[S2] START round=46 head_norm_before_train=2.080964 (no previous merge yet)
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.8309267674122752, 'auprc': 0.9361130036937434, 'loss_val': 0.41879639841465083, 'psi': 0.8730012619248625}-{'f1_val': 0.8291712676005863, 'auprc': 0.9516840068486585, 'loss_val': 0.4249874486331797, 'psi': 0.8781763632998152}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=46 head_norm_before_train=2.170665 cos_to_last_merge=0.7713 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.771
[S3] round=46 local utility u=0.000000 metrics={'f1_val': 0.9569535538876125, 'auprc': 0.9987147654129619, 'loss_val': 0.1712990219873309, 'psi': 0.9736580384977522}-{'f1_val': 0.9965117892586061, 'auprc': 0.9986815609686158, 'loss_val': 0.018273768420628424, 'psi': 0.9973796979426099}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=46 head_norm_before_train=1.998238 (no previous merge yet)
[S4] round=46 local utility u=0.008289 metrics={'f1_val': 0.9505053594874803, 'auprc': 0.9427850197183236, 'loss_val': 0.2590705110321511, 'psi': 0.9474172235798175}-{'f1_val': 0.9505744698384695, 'auprc': 0.9349977670813493, 'loss_val': 0.25270075899520816, 'psi': 0.9443437887356214}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=46 head_norm_before_train=1.771936 cos_to_last_merge=0.9999 (last merge round=44)
[S5] round=46 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.997845759289892, 'loss_val': 0.03171368839205164, 'psi': 0.9969385908940909}-{'f1_val': 0.9967019684784577, 'auprc': 0.998409655244426, 'loss_val': 0.034226394842679544, 'psi': 0.997385043184845}
[S6] START round=46 head_norm_before_train=1.505470 cos_to_last_merge=0.9998 (last merge round=43)
[S6] round=46 local utility u=0.045241 metrics={'f1_val': 0.819365766776389, 'auprc': 0.9332210215916884, 'loss_val': 0.49691009142833514, 'psi': 0.8649078687025087}-{'f1_val': 0.8105960657531235, 'auprc': 0.9200200284739134, 'loss_val': 0.4951700142219839, 'psi': 0.8543656508414395}
[S7] START round=46 head_norm_before_train=1.473722 cos_to_last_merge=0.9614 (last merge round=22)
[S7] round=46 local utility u=0.000000 metrics={'f1_val': 0.6641316802122059, 'auprc': 0.8205784825640865, 'loss_val': 0.39582047508425017, 'psi': 0.7267104011529582}-{'f1_val': 0.684668497005603, 'auprc': 0.8583595236482322, 'loss_val': 0.28320675912797766, 'psi': 0.7541449076626546}
[S8] START round=46 head_norm_before_train=1.549247 cos_to_last_merge=1.0000 (last merge round=45)
[S8] round=46 local utility u=0.005817 metrics={'f1_val': 0.9938621753089841, 'auprc': 0.9989861948128618, 'loss_val': 0.04124121475287805, 'psi': 0.9959117831105353}-{'f1_val': 0.992174240363445, 'auprc': 0.9991571826604801, 'loss_val': 0.04326075152458358, 'psi': 0.9949674172822591}
[S9] START round=46 head_norm_before_train=1.587774 cos_to_last_merge=0.9985 (last merge round=39)
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9977343329469606, 'loss_val': 0.027308389923358576, 'psi': 0.9969398445791168}-{'f1_val': 0.9966924912647621, 'auprc': 0.9981557516560424, 'loss_val': 0.02670987790144368, 'psi': 0.9972777954212743}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=46 head_norm_before_train=2.014470 cos_to_last_merge=1.0000 (last merge round=44)
[S10] round=46 local utility u=0.000143 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9961870274102227, 'loss_val': 0.028759597918884112, 'psi': 0.9952734439697389}-{'f1_val': 0.9946643883427498, 'auprc': 0.9961089545642561, 'loss_val': 0.02881164506151231, 'psi': 0.9952422148313522}
[S11] START round=46 head_norm_before_train=1.765790 cos_to_last_merge=0.9999 (last merge round=43)
[S11] round=46 local utility u=0.000000 metrics={'f1_val': 0.9056668568516767, 'auprc': 0.9952413343108265, 'loss_val': 0.13209309668651265, 'psi': 0.9414966478353366}-{'f1_val': 0.9698374697316041, 'auprc': 0.995082931432379, 'loss_val': 0.08477352914364389, 'psi': 0.979935654411914}
[S13] START round=46 head_norm_before_train=1.371417 cos_to_last_merge=0.9948 (last merge round=32)
[S13] round=46 local utility u=0.008744 metrics={'f1_val': 0.6277382094152169, 'auprc': 0.656299988632079, 'loss_val': 0.7550523354432676, 'psi': 0.6391629211019617}-{'f1_val': 0.6191615686872518, 'auprc': 0.681331870078015, 'loss_val': 0.7961764989058471, 'psi': 0.6440296892435571}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=46 head_norm_before_train=2.015921 cos_to_last_merge=1.0000 (last merge round=44)
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.9967480671851483, 'auprc': 0.9987488046979529, 'loss_val': 0.033824293900222575, 'psi': 0.9975483621902701}-{'f1_val': 0.9975765414632514, 'auprc': 0.9987414810895061, 'loss_val': 0.02673446422235756, 'psi': 0.9980425173137533}
[S15] START round=46 head_norm_before_train=1.552069 cos_to_last_merge=1.0000 (last merge round=44)
[S15] round=46 local utility u=0.864315 metrics={'f1_val': 0.9963755136436562, 'auprc': 0.9977208130422912, 'loss_val': 0.03520485287679455, 'psi': 0.9969136334031102}-{'f1_val': 0.7699337675147574, 'auprc': 0.9902379477369174, 'loss_val': 0.38273562866670197, 'psi': 0.8580554396036214}
[S16] START round=46 head_norm_before_train=2.118057 (no previous merge yet)
[S16] round=46 local utility u=0.284182 metrics={'f1_val': 0.9127671077139453, 'auprc': 0.9915101018494485, 'loss_val': 0.41208501478683396, 'psi': 0.9442643053681465}-{'f1_val': 0.8636760623543039, 'auprc': 0.9903810315621692, 'loss_val': 0.6825148578064796, 'psi': 0.91435805003745}
[S17] START round=46 head_norm_before_train=1.505005 cos_to_last_merge=1.0000 (last merge round=45)
[S17] round=46 local utility u=0.000000 metrics={'f1_val': 0.6636081157715839, 'auprc': 0.8423902506364123, 'loss_val': 0.8546440856029623, 'psi': 0.7351209697175152}-{'f1_val': 0.6672847395491487, 'auprc': 0.8405526473174324, 'loss_val': 0.804569754930041, 'psi': 0.7365919026564622}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:61008
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:61014
[S6] not sending this round → trigger blocked (psi=0.865)
[S10] sending update (kind=head size=1795 to 1 peers)
[S16] sending update (kind=head size=1795 to 1 peers)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=46 metric=0.8194 head_norm=1.528333
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.824101e-02
[S6] stored merged vector for next round verification (round=46)
[S6] DEBUG after merge:  round=46 metric=0.8201 head_norm=1.516292 delta_norm=0.038241
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=46 metric=0.9057 head_norm=1.776827
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.794671e-02
[S11] stored merged vector for next round verification (round=46)
[S11] DEBUG after merge:  round=46 metric=0.9081 head_norm=1.774292 delta_norm=0.017947
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:61015
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] RECEIVED delta(kind=head bytes=1795) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=2.022458)
[S14] loaded HEAD from S10 (vec_in norm=2.022458)
[S14] cosine check vs S10: cos=0.9999
[S14] BUFFERED delta from S10 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1795) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=2.125734)
[S7] loaded HEAD from S16 (vec_in norm=2.125734)
[S7] cosine check vs S16: cos=-0.0597
[S7] DROPPED delta from S16 (cos=-0.0597 < 0.0)
[S8] sending update (kind=head size=1802 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1802) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.558012)
[S15] loaded HEAD from S8 (vec_in norm=1.558012)
[S15] cosine check vs S8: cos=0.9998
[S15] BUFFERED delta from S8 (total buffered=1)
[S15] not sending this round → trigger blocked (psi=0.997)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=46 metric=0.9964 head_norm=1.565802
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.429676e-02
[S15] stored merged vector for next round verification (round=46)
[S15] DEBUG after merge:  round=46 metric=0.9964 head_norm=1.561846 delta_norm=0.014297
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=47 head_norm_before_train=2.089273 (no previous merge yet)
[S2] round=47 local utility u=0.026471 metrics={'f1_val': 0.8269057548645887, 'auprc': 0.9579041549642412, 'loss_val': 0.40710170773243726, 'psi': 0.8793051149044497}-{'f1_val': 0.8309267674122752, 'auprc': 0.9361130036937434, 'loss_val': 0.41879639841465083, 'psi': 0.8730012619248625}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=47 head_norm_before_train=2.174875 cos_to_last_merge=0.7706 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.771
[S3] round=47 local utility u=0.196771 metrics={'f1_val': 0.9969583726029951, 'auprc': 0.9989831339237589, 'loss_val': 0.01859146452232734, 'psi': 0.9977682771313007}-{'f1_val': 0.9569535538876125, 'auprc': 0.9987147654129619, 'loss_val': 0.1712990219873309, 'psi': 0.9736580384977522}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=47 head_norm_before_train=2.002544 (no previous merge yet)
[S4] round=47 local utility u=0.036108 metrics={'f1_val': 0.9556903065500614, 'auprc': 0.9582775300520334, 'loss_val': 0.2644411630449926, 'psi': 0.9567251959508503}-{'f1_val': 0.9505053594874803, 'auprc': 0.9427850197183236, 'loss_val': 0.2590705110321511, 'psi': 0.9474172235798175}
[S4] not sending this round → trigger blocked (psi=0.957)
[S5] START round=47 head_norm_before_train=1.797291 cos_to_last_merge=0.9998 (last merge round=44)
[S5] round=47 local utility u=0.003813 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9987910772604159, 'loss_val': 0.02913308165152108, 'psi': 0.9975376119912409}-{'f1_val': 0.9963338119635569, 'auprc': 0.997845759289892, 'loss_val': 0.03171368839205164, 'psi': 0.9969385908940909}
[S6] START round=47 head_norm_before_train=1.516292 cos_to_last_merge=1.0000 (last merge round=46)
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.7374382982035723, 'auprc': 0.9142818379190041, 'loss_val': 0.7207595271392263, 'psi': 0.808175714089745}-{'f1_val': 0.819365766776389, 'auprc': 0.9332210215916884, 'loss_val': 0.49691009142833514, 'psi': 0.8649078687025087}
[S7] START round=47 head_norm_before_train=1.479547 cos_to_last_merge=0.9608 (last merge round=22)
[S7] round=47 local utility u=0.307682 metrics={'f1_val': 0.728995663087128, 'auprc': 0.8576777848006029, 'loss_val': 0.28093814355583274, 'psi': 0.780468511772518}-{'f1_val': 0.6641316802122059, 'auprc': 0.8205784825640865, 'loss_val': 0.39582047508425017, 'psi': 0.7267104011529582}
[S8] START round=47 head_norm_before_train=1.558012 cos_to_last_merge=1.0000 (last merge round=45)
[S8] round=47 local utility u=0.000151 metrics={'f1_val': 0.993675047592855, 'auprc': 0.9993208151790592, 'loss_val': 0.04081987583516164, 'psi': 0.9959333546273368}-{'f1_val': 0.9938621753089841, 'auprc': 0.9989861948128618, 'loss_val': 0.04124121475287805, 'psi': 0.9959117831105353}
[S9] START round=47 head_norm_before_train=1.605006 cos_to_last_merge=0.9980 (last merge round=39)
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.9943332231862974, 'auprc': 0.9981330489352045, 'loss_val': 0.030377647637764488, 'psi': 0.9958531534858601}-{'f1_val': 0.9964101856672208, 'auprc': 0.9977343329469606, 'loss_val': 0.027308389923358576, 'psi': 0.9969398445791168}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=47 head_norm_before_train=2.022458 cos_to_last_merge=1.0000 (last merge round=44)
[S10] round=47 local utility u=0.000062 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9961179561778692, 'loss_val': 0.028427558135784833, 'psi': 0.9952458154767976}-{'f1_val': 0.9946643883427498, 'auprc': 0.9961870274102227, 'loss_val': 0.028759597918884112, 'psi': 0.9952734439697389}
[S11] START round=47 head_norm_before_train=1.774292 cos_to_last_merge=1.0000 (last merge round=46)
[S11] round=47 local utility u=0.320642 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9955795740003698, 'loss_val': 0.034623999130090906, 'psi': 0.9959120345481335}-{'f1_val': 0.9056668568516767, 'auprc': 0.9952413343108265, 'loss_val': 0.13209309668651265, 'psi': 0.9414966478353366}
[S13] START round=47 head_norm_before_train=1.380913 cos_to_last_merge=0.9940 (last merge round=32)
[S13] round=47 local utility u=0.000000 metrics={'f1_val': 0.597933161326316, 'auprc': 0.6678307903617365, 'loss_val': 0.9105033007112269, 'psi': 0.6258922129404842}-{'f1_val': 0.6277382094152169, 'auprc': 0.656299988632079, 'loss_val': 0.7550523354432676, 'psi': 0.6391629211019617}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=47 head_norm_before_train=2.024082 cos_to_last_merge=1.0000 (last merge round=44)
[S14] round=47 local utility u=0.006250 metrics={'f1_val': 0.9975765414632514, 'auprc': 0.9988039738846315, 'loss_val': 0.026459955920106068, 'psi': 0.9980675144318034}-{'f1_val': 0.9967480671851483, 'auprc': 0.9987488046979529, 'loss_val': 0.033824293900222575, 'psi': 0.9975483621902701}
[S15] START round=47 head_norm_before_train=1.561846 cos_to_last_merge=1.0000 (last merge round=46)
[S15] round=47 local utility u=0.000000 metrics={'f1_val': 0.7005905094076985, 'auprc': 0.9697297296166488, 'loss_val': 0.4843501833930888, 'psi': 0.8082461974912787}-{'f1_val': 0.9963755136436562, 'auprc': 0.9977208130422912, 'loss_val': 0.03520485287679455, 'psi': 0.9969136334031102}
[S16] START round=47 head_norm_before_train=2.125734 (no previous merge yet)
[S16] round=47 local utility u=0.156444 metrics={'f1_val': 0.9402322832944046, 'auprc': 0.9900839428068607, 'loss_val': 0.2597100890268912, 'psi': 0.960172947099387}-{'f1_val': 0.9127671077139453, 'auprc': 0.9915101018494485, 'loss_val': 0.41208501478683396, 'psi': 0.9442643053681465}
[S17] START round=47 head_norm_before_train=1.519199 cos_to_last_merge=0.9999 (last merge round=45)
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.6604928658649292, 'auprc': 0.8287000002578019, 'loss_val': 1.0869276482260255, 'psi': 0.7277757196220782}-{'f1_val': 0.6636081157715839, 'auprc': 0.8423902506364123, 'loss_val': 0.8546440856029623, 'psi': 0.7351209697175152}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:61016
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:61011
[S10] not sending this round → trigger blocked (psi=0.995)
[S16] not sending this round → trigger blocked (psi=0.960)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:61012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:61005
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1799 to 1 peers)
[S8] not sending this round → trigger blocked (psi=0.996)
[S7] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1802) from S5
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.813602)
[S11] loaded HEAD from S5 (vec_in norm=1.813602)
[S11] cosine check vs S5: cos=0.9996
[S11] BUFFERED delta from S5 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1799) from S14
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=2.033363)
[S10] loaded HEAD from S14 (vec_in norm=2.033363)
[S10] cosine check vs S14: cos=0.9998
[S10] BUFFERED delta from S14 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1803) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.784723)
[S5] loaded HEAD from S11 (vec_in norm=1.784723)
[S5] cosine check vs S11: cos=0.9996
[S5] BUFFERED delta from S11 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1802) from S7
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.483633)
[S16] loaded HEAD from S7 (vec_in norm=1.483633)
[S16] cosine check vs S7: cos=-0.0598
[S16] DROPPED delta from S7 (cos=-0.0598 < 0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=47 metric=0.9967 head_norm=1.813602
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.026759e-02
[S5] stored merged vector for next round verification (round=47)
[S5] DEBUG after merge:  round=47 metric=0.9967 head_norm=1.798966 delta_norm=0.030268
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=47 metric=0.9961 head_norm=1.784723
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.026760e-02
[S11] stored merged vector for next round verification (round=47)
[S11] DEBUG after merge:  round=47 metric=0.9961 head_norm=1.798966 delta_norm=0.030268
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=47 metric=0.9976 head_norm=2.033363
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.624467e-02
[S14] stored merged vector for next round verification (round=47)
[S14] DEBUG after merge:  round=47 metric=0.9976 head_norm=2.027853 delta_norm=0.016245
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=48 head_norm_before_train=2.095108 (no previous merge yet)
[S2] round=48 local utility u=0.000000 metrics={'f1_val': 0.8278368527426874, 'auprc': 0.9369054373614893, 'loss_val': 0.409357219440802, 'psi': 0.8714642865902081}-{'f1_val': 0.8269057548645887, 'auprc': 0.9579041549642412, 'loss_val': 0.40710170773243726, 'psi': 0.8793051149044497}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=48 head_norm_before_train=2.178261 cos_to_last_merge=0.7700 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.770
[S3] round=48 local utility u=0.000000 metrics={'f1_val': 0.9883121234260523, 'auprc': 0.9989919716169513, 'loss_val': 0.03773331602976331, 'psi': 0.9925840627024118}-{'f1_val': 0.9969583726029951, 'auprc': 0.9989831339237589, 'loss_val': 0.01859146452232734, 'psi': 0.9977682771313007}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=48 head_norm_before_train=2.008365 (no previous merge yet)
[S4] round=48 local utility u=0.000000 metrics={'f1_val': 0.9514804270169597, 'auprc': 0.9395488093954958, 'loss_val': 0.25188797206302393, 'psi': 0.9467077799683741}-{'f1_val': 0.9556903065500614, 'auprc': 0.9582775300520334, 'loss_val': 0.2644411630449926, 'psi': 0.9567251959508503}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=48 head_norm_before_train=1.798966 cos_to_last_merge=1.0000 (last merge round=47)
[S5] round=48 local utility u=0.000000 metrics={'f1_val': 0.9764595466291683, 'auprc': 0.992227086960765, 'loss_val': 0.06041744998416455, 'psi': 0.982766562761807}-{'f1_val': 0.9967019684784577, 'auprc': 0.9987910772604159, 'loss_val': 0.02913308165152108, 'psi': 0.9975376119912409}
[S6] START round=48 head_norm_before_train=1.535841 cos_to_last_merge=0.9999 (last merge round=46)
[S6] round=48 local utility u=0.306254 metrics={'f1_val': 0.8064305842646593, 'auprc': 0.9157787045593931, 'loss_val': 0.5266963307900049, 'psi': 0.8501698323825528}-{'f1_val': 0.7374382982035723, 'auprc': 0.9142818379190041, 'loss_val': 0.7207595271392263, 'psi': 0.808175714089745}
[S7] START round=48 head_norm_before_train=1.483633 cos_to_last_merge=0.9604 (last merge round=22)
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.6671229978993322, 'auprc': 0.8180449435713472, 'loss_val': 0.409893958691065, 'psi': 0.7274917761681381}-{'f1_val': 0.728995663087128, 'auprc': 0.8576777848006029, 'loss_val': 0.28093814355583274, 'psi': 0.780468511772518}
[S8] START round=48 head_norm_before_train=1.566199 cos_to_last_merge=0.9999 (last merge round=45)
[S8] round=48 local utility u=0.000990 metrics={'f1_val': 0.9938621753089841, 'auprc': 0.9993136629667753, 'loss_val': 0.039941265780499856, 'psi': 0.9960427703721006}-{'f1_val': 0.993675047592855, 'auprc': 0.9993208151790592, 'loss_val': 0.04081987583516164, 'psi': 0.9959333546273368}
[S9] START round=48 head_norm_before_train=1.622771 cos_to_last_merge=0.9976 (last merge round=39)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.9937719190709611, 'auprc': 0.9981387336940779, 'loss_val': 0.030455744767070726, 'psi': 0.9955186449202078}-{'f1_val': 0.9943332231862974, 'auprc': 0.9981330489352045, 'loss_val': 0.030377647637764488, 'psi': 0.9958531534858601}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=48 head_norm_before_train=2.025911 cos_to_last_merge=0.9999 (last merge round=44)
[S10] round=48 local utility u=0.000000 metrics={'f1_val': 0.9944449605296568, 'auprc': 0.996443713600135, 'loss_val': 0.028386366189955416, 'psi': 0.9952444617578481}-{'f1_val': 0.9946643883427498, 'auprc': 0.9961179561778692, 'loss_val': 0.028427558135784833, 'psi': 0.9952458154767976}
[S11] START round=48 head_norm_before_train=1.798966 cos_to_last_merge=1.0000 (last merge round=47)
[S11] round=48 local utility u=0.000312 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9955649322839648, 'loss_val': 0.03395584744597153, 'psi': 0.9959061778615715}-{'f1_val': 0.9961336749133093, 'auprc': 0.9955795740003698, 'loss_val': 0.034623999130090906, 'psi': 0.9959120345481335}
[S13] START round=48 head_norm_before_train=1.388934 cos_to_last_merge=0.9935 (last merge round=32)
[S13] round=48 local utility u=0.135843 metrics={'f1_val': 0.6034209548233415, 'auprc': 0.6771640759463166, 'loss_val': 0.6997445872594535, 'psi': 0.6329182032725316}-{'f1_val': 0.597933161326316, 'auprc': 0.6678307903617365, 'loss_val': 0.9105033007112269, 'psi': 0.6258922129404842}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=48 head_norm_before_train=2.027853 cos_to_last_merge=1.0000 (last merge round=47)
[S14] round=48 local utility u=0.002798 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.998875460420993, 'loss_val': 0.0225358606185885, 'psi': 0.9982418949487282}-{'f1_val': 0.9975765414632514, 'auprc': 0.9988039738846315, 'loss_val': 0.026459955920106068, 'psi': 0.9980675144318034}
[S15] START round=48 head_norm_before_train=1.574666 cos_to_last_merge=1.0000 (last merge round=46)
[S15] round=48 local utility u=0.245226 metrics={'f1_val': 0.7691139355101425, 'auprc': 0.9744528863629337, 'loss_val': 0.41920845919298366, 'psi': 0.851249515851259}-{'f1_val': 0.7005905094076985, 'auprc': 0.9697297296166488, 'loss_val': 0.4843501833930888, 'psi': 0.8082461974912787}
[S16] START round=48 head_norm_before_train=2.130810 (no previous merge yet)
[S16] round=48 local utility u=0.000000 metrics={'f1_val': 0.894121144938736, 'auprc': 0.8928703428610829, 'loss_val': 0.5243714505781812, 'psi': 0.8936208241076747}-{'f1_val': 0.9402322832944046, 'auprc': 0.9900839428068607, 'loss_val': 0.2597100890268912, 'psi': 0.960172947099387}
[S17] START round=48 head_norm_before_train=1.533183 cos_to_last_merge=0.9997 (last merge round=45)
[S17] round=48 local utility u=0.234001 metrics={'f1_val': 0.6752292423444769, 'auprc': 0.8655484242121225, 'loss_val': 0.8178886159338367, 'psi': 0.7513569150915351}-{'f1_val': 0.6604928658649292, 'auprc': 0.8287000002578019, 'loss_val': 1.0869276482260255, 'psi': 0.7277757196220782}
[S14] not sending this round → trigger blocked (psi=0.998)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.996)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:61017
[S6] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:61007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S15@127.0.0.1:61015
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=48 metric=0.9944 head_norm=2.030956
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.036370e-02
[S10] stored merged vector for next round verification (round=48)
[S10] DEBUG after merge:  round=48 metric=0.9944 head_norm=2.032058 delta_norm=0.020364
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S17] RECEIVED delta(kind=head bytes=1802) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.551999)
[S17] loaded HEAD from S6 (vec_in norm=1.551999)
[S17] cosine check vs S6: cos=0.9988
[S17] BUFFERED delta from S6 (total buffered=1)
[S8] sending update (kind=head size=1805 to 1 peers)
[S17] sending update (kind=head size=1800 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1800) from S17
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.548173)
[S6] loaded HEAD from S17 (vec_in norm=1.548173)
[S6] cosine check vs S17: cos=0.9988
[S6] BUFFERED delta from S17 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1805) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.576239)
[S15] loaded HEAD from S8 (vec_in norm=1.576239)
[S15] cosine check vs S8: cos=0.9997
[S15] BUFFERED delta from S8 (total buffered=1)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=48 metric=0.6752 head_norm=1.548173
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.857381e-02
[S17] stored merged vector for next round verification (round=48)
[S17] DEBUG after merge:  round=48 metric=0.6775 head_norm=1.549607 delta_norm=0.038574
[S17] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:61009
[S15] sending update (kind=head size=1804 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1804) from S15
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.587062)
[S8] loaded HEAD from S15 (vec_in norm=1.587062)
[S8] cosine check vs S15: cos=0.9997
[S8] BUFFERED delta from S15 (total buffered=1)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=48 metric=0.7691 head_norm=1.587062
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.878785e-02
[S15] stored merged vector for next round verification (round=48)
[S15] DEBUG after merge:  round=48 metric=0.7691 head_norm=1.581548 delta_norm=0.018788
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=48 metric=0.9939 head_norm=1.576239
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.878785e-02
[S8] stored merged vector for next round verification (round=48)
[S8] DEBUG after merge:  round=48 metric=0.9939 head_norm=1.581548 delta_norm=0.018788
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=49 head_norm_before_train=2.099915 (no previous merge yet)
[S2] round=49 local utility u=0.000000 metrics={'f1_val': 0.8316910161785136, 'auprc': 0.915527951259287, 'loss_val': 0.38858741581385947, 'psi': 0.8652257902108229}-{'f1_val': 0.8278368527426874, 'auprc': 0.9369054373614893, 'loss_val': 0.409357219440802, 'psi': 0.8714642865902081}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=49 head_norm_before_train=2.175944 cos_to_last_merge=0.7704 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.770
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.9556976070724643, 'auprc': 0.999011583487182, 'loss_val': 0.18082528149923846, 'psi': 0.9730231976383514}-{'f1_val': 0.9883121234260523, 'auprc': 0.9989919716169513, 'loss_val': 0.03773331602976331, 'psi': 0.9925840627024118}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=49 head_norm_before_train=2.013302 (no previous merge yet)
[S4] round=49 local utility u=0.022863 metrics={'f1_val': 0.9520103593090115, 'auprc': 0.9514219984034668, 'loss_val': 0.2449620323566764, 'psi': 0.9517750149467936}-{'f1_val': 0.9514804270169597, 'auprc': 0.9395488093954958, 'loss_val': 0.25188797206302393, 'psi': 0.9467077799683741}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=49 head_norm_before_train=1.811994 cos_to_last_merge=0.9999 (last merge round=47)
[S5] round=49 local utility u=0.078744 metrics={'f1_val': 0.9964083724129549, 'auprc': 0.9942815612141568, 'loss_val': 0.028785110438429806, 'psi': 0.9955576479334356}-{'f1_val': 0.9764595466291683, 'auprc': 0.992227086960765, 'loss_val': 0.06041744998416455, 'psi': 0.982766562761807}
[S6] START round=49 head_norm_before_train=1.551999 cos_to_last_merge=0.9997 (last merge round=46)
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.6762423650547656, 'auprc': 0.8868016762614155, 'loss_val': 0.8948343359863545, 'psi': 0.7604660895374256}-{'f1_val': 0.8064305842646593, 'auprc': 0.9157787045593931, 'loss_val': 0.5266963307900049, 'psi': 0.8501698323825528}
[S7] START round=49 head_norm_before_train=1.492718 cos_to_last_merge=0.9595 (last merge round=22)
[S7] round=49 local utility u=0.000000 metrics={'f1_val': 0.6539407493937421, 'auprc': 0.8088870114960902, 'loss_val': 0.4980226155720631, 'psi': 0.7159192542346814}-{'f1_val': 0.6671229978993322, 'auprc': 0.8180449435713472, 'loss_val': 0.409893958691065, 'psi': 0.7274917761681381}
[S8] START round=49 head_norm_before_train=1.581548 cos_to_last_merge=1.0000 (last merge round=48)
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.9918109678295097, 'auprc': 0.9991605927958953, 'loss_val': 0.04042974624438023, 'psi': 0.994750817816064}-{'f1_val': 0.9938621753089841, 'auprc': 0.9993136629667753, 'loss_val': 0.039941265780499856, 'psi': 0.9960427703721006}
[S9] START round=49 head_norm_before_train=1.633469 cos_to_last_merge=0.9972 (last merge round=39)
[S9] round=49 local utility u=0.007833 metrics={'f1_val': 0.9954158325366191, 'auprc': 0.9982296509575914, 'loss_val': 0.024925312281099784, 'psi': 0.9965413599050081}-{'f1_val': 0.9937719190709611, 'auprc': 0.9981387336940779, 'loss_val': 0.030455744767070726, 'psi': 0.9955186449202078}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] sending update (kind=head size=1804 to 1 peers)
[S10] START round=49 head_norm_before_train=2.032058 cos_to_last_merge=1.0000 (last merge round=48)
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.9944449605296568, 'auprc': 0.9963629615101572, 'loss_val': 0.028395948101529928, 'psi': 0.9952121609218569}-{'f1_val': 0.9944449605296568, 'auprc': 0.996443713600135, 'loss_val': 0.028386366189955416, 'psi': 0.9952444617578481}
[S11] START round=49 head_norm_before_train=1.806702 cos_to_last_merge=1.0000 (last merge round=47)
[S11] round=49 local utility u=0.001036 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9955545179378883, 'loss_val': 0.031851776763787976, 'psi': 0.9959020121231409}-{'f1_val': 0.9961336749133093, 'auprc': 0.9955649322839648, 'loss_val': 0.03395584744597153, 'psi': 0.9959061778615715}
[S13] START round=49 head_norm_before_train=1.395430 cos_to_last_merge=0.9931 (last merge round=32)
[S13] round=49 local utility u=0.296293 metrics={'f1_val': 0.6691099662334891, 'auprc': 0.6703036852215498, 'loss_val': 0.48071154691477563, 'psi': 0.6695874538287133}-{'f1_val': 0.6034209548233415, 'auprc': 0.6771640759463166, 'loss_val': 0.6997445872594535, 'psi': 0.6329182032725316}
[S13] not sending this round → trigger blocked (psi=0.670)
[S14] START round=49 head_norm_before_train=2.037859 cos_to_last_merge=1.0000 (last merge round=47)
[S14] round=49 local utility u=0.000486 metrics={'f1_val': 0.9977975102598944, 'auprc': 0.9988899112451208, 'loss_val': 0.021474304286578035, 'psi': 0.998234470653985}-{'f1_val': 0.9978195179672185, 'auprc': 0.998875460420993, 'loss_val': 0.0225358606185885, 'psi': 0.9982418949487282}
[S15] START round=49 head_norm_before_train=1.581548 cos_to_last_merge=1.0000 (last merge round=48)
[S15] round=49 local utility u=0.910180 metrics={'f1_val': 0.9965259456095847, 'auprc': 0.9975431348387964, 'loss_val': 0.03259181971601506, 'psi': 0.9969328213012694}-{'f1_val': 0.7691139355101425, 'auprc': 0.9744528863629337, 'loss_val': 0.41920845919298366, 'psi': 0.851249515851259}
[S16] START round=49 head_norm_before_train=2.136745 (no previous merge yet)
[S16] round=49 local utility u=0.263251 metrics={'f1_val': 0.9232785658287949, 'auprc': 0.9768470229208375, 'loss_val': 0.42474443863019473, 'psi': 0.944705948665612}-{'f1_val': 0.894121144938736, 'auprc': 0.8928703428610829, 'loss_val': 0.5243714505781812, 'psi': 0.8936208241076747}
[S17] START round=49 head_norm_before_train=1.549607 cos_to_last_merge=1.0000 (last merge round=48)
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.6564433194189526, 'auprc': 0.8315673617105299, 'loss_val': 1.1045102938891869, 'psi': 0.7264929363355835}-{'f1_val': 0.6752292423444769, 'auprc': 0.8655484242121225, 'loss_val': 0.8178886159338367, 'psi': 0.7513569150915351}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:61011
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:61008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:61005
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:61012
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=49 metric=0.6762 head_norm=1.567916
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.594758e-02
[S6] stored merged vector for next round verification (round=49)
[S6] DEBUG after merge:  round=49 metric=0.6788 head_norm=1.557398 delta_norm=0.045948
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] sending update (kind=head size=1798 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1800 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1800) from S5
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.820825)
[S11] loaded HEAD from S5 (vec_in norm=1.820825)
[S11] cosine check vs S5: cos=0.9998
[S11] BUFFERED delta from S5 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1798) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=2.139700)
[S7] loaded HEAD from S16 (vec_in norm=2.139700)
[S7] cosine check vs S16: cos=-0.0598
[S7] DROPPED delta from S16 (cos=-0.0598 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1802) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.815127)
[S5] loaded HEAD from S11 (vec_in norm=1.815127)
[S5] cosine check vs S11: cos=0.9998
[S5] BUFFERED delta from S11 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1800) from S14
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=2.046871)
[S10] loaded HEAD from S14 (vec_in norm=2.046871)
[S10] cosine check vs S14: cos=0.9999
[S10] BUFFERED delta from S14 (total buffered=1)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=49 metric=0.9961 head_norm=1.815127
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.000810e-02
[S11] stored merged vector for next round verification (round=49)
[S11] DEBUG after merge:  round=49 metric=0.9961 head_norm=1.817868 delta_norm=0.020008
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=49 metric=0.9964 head_norm=1.820825
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.000811e-02
[S5] stored merged vector for next round verification (round=49)
[S5] DEBUG after merge:  round=49 metric=0.9964 head_norm=1.817868 delta_norm=0.020008
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:61009
[S15] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S15
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.594606)
[S8] loaded HEAD from S15 (vec_in norm=1.594606)
[S8] cosine check vs S15: cos=1.0000
[S8] BUFFERED delta from S15 (total buffered=1)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=49 metric=0.9918 head_norm=1.592529
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.587867e-03
[S8] stored merged vector for next round verification (round=49)
[S8] DEBUG after merge:  round=49 metric=0.9918 head_norm=1.593554 delta_norm=0.006588
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[runner] rounds complete.
[runner] all agents stopped.
