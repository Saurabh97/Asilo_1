[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:31603
[S3] → join 127.0.0.1:31602
[S4] → join 127.0.0.1:31602
[S5] → join 127.0.0.1:31602
[S6] → join 127.0.0.1:31602
[S7] → join 127.0.0.1:31602
[S8] → join 127.0.0.1:31602
[S9] → join 127.0.0.1:31602
[S10] → join 127.0.0.1:31602
[S11] → join 127.0.0.1:31602
[S13] → join 127.0.0.1:31602
[S14] → join 127.0.0.1:31602
[S15] → join 127.0.0.1:31602
[S16] → join 127.0.0.1:31602
[S17] → join 127.0.0.1:31602
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.112384 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.162676 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.155561 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.171795 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.118118 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.157417 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.159640 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.137981 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.214978 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.178594 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.164895 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.174417 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.203171 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.169393 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.140860 (no previous merge yet)
[S15]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S3] + discovered S4
[S3] + discovered S7
[S3] + discovered S14
[S3] + discovered S15
[S3] + discovered S13
[S3] + discovered S9
[S4] + discovered S2
[S3] + discovered S8
[S3] + discovered S10
[S3] + discovered S5
[S3] + discovered S11
[S3] + discovered S6
[S4] + discovered S3
[S3] + discovered S17
[S3] + discovered S16
[S4] + discovered S6
[S4] + discovered S15
[S4] + discovered S10
[S4] + discovered S9
[S4] + discovered S8
[S4] + discovered S17
[S4] + discovered S5
[S4] + discovered S13
[S4] + discovered S11
[S4] + discovered S7
[S5] + discovered S3
[S5] + discovered S4
[S5] + discovered S2
[S4] + discovered S14
[S4] + discovered S16
[S5] + discovered S17
[S5] + discovered S7
[S5] + discovered S9
[S5] + discovered S10
[S5] + discovered S15
[S5] + discovered S11
[S6] + discovered S2
[S5] + discovered S8
[S6] + discovered S5
[S5] + discovered S6
[S5] + discovered S16
[S6] + discovered S3
[S5] + discovered S13
[S6] + discovered S4
[S5] + discovered S14
[S6] + discovered S15
[S6] + discovered S17
[S7] + discovered S2
[S7] + discovered S4
[S7] + discovered S5
[S7] + discovered S3
[S7] + discovered S6
[S6] + discovered S9
[S6] + discovered S8
[S6] + discovered S14
[S6] + discovered S16
[S6] + discovered S10
[S6] + discovered S7
[S6] + discovered S13
[S6] + discovered S11
[S7] + discovered S16
[S7] + discovered S13
[S8] + discovered S6
[S7] + discovered S8
[S8] + discovered S5
[S7] + discovered S14
[S7] + discovered S9
[S8] + discovered S2
[S8] + discovered S3
[S8] + discovered S7
[S7] + discovered S15
[S8] + discovered S4
[S7] + discovered S17
[S7] + discovered S10
[S7] + discovered S11
[S8] + discovered S13
[S9] + discovered S3
[S9] + discovered S8
[S9] + discovered S4
[S9] + discovered S6
[S8] + discovered S9
[S9] + discovered S2
[S9] + discovered S7
[S9] + discovered S5
[S8] + discovered S15
[S8] + discovered S17
[S8] + discovered S16
[S8] + discovered S10
[S8] + discovered S14
[S8] + discovered S11
[S9] + discovered S16
[S9] + discovered S10
[S10] + discovered S7
[S10] + discovered S6
[S10] + discovered S8
[S10] + discovered S3
[S10] + discovered S4
[S10] + discovered S9
[S9] + discovered S14
[S9] + discovered S11
[S9] + discovered S15
[S10] + discovered S2
[S9] + discovered S17
[S9] + discovered S13
[S10] + discovered S5
[S11] + discovered S10
[S11] + discovered S5
[S10] + discovered S16
[S11] + discovered S8
[S11] + discovered S3
[S11] + discovered S4
[S11] + discovered S2
[S10] + discovered S17
[S10] + discovered S13
[S10] + discovered S11
[S11] + discovered S7
[S10] + discovered S14
[S10] + discovered S15
[S11] + discovered S9
[S11] + discovered S6
[S13] + discovered S11
[S11] + discovered S15
[S11] + discovered S14
[S13] + discovered S8
[S13] + discovered S2
[S13] + discovered S6
[S13] + discovered S5
[S13] + discovered S4
[S13] + discovered S7
[S13] + discovered S3
[S11] + discovered S16
[S13] + discovered S10
[S11] + discovered S13
[S13] + discovered S9
[S11] + discovered S17
[S14] + discovered S11
[S14] + discovered S5
[S13] + discovered S17
[S14] + discovered S8
[S14] + discovered S13
[S14] + discovered S3
[S13] + discovered S14
[S14] + discovered S2
[S14] + discovered S7
[S13] + discovered S16
[S14] + discovered S9
[S14] + discovered S4
[S13] + discovered S15
[S14] + discovered S6
[S14] + discovered S10
[S15] + discovered S2
[S15] + discovered S9
[S14] + discovered S16
[S15] + discovered S5
[S15] + discovered S13
[S15] + discovered S7
[S15] + discovered S3
[S15] + discovered S4
[S15] + discovered S8
[S15] + discovered S10
[S15] + discovered S14
[S15] + discovered S11
[S15] + discovered S6
[S14] + discovered S17
[S14] + discovered S15
[S16] + discovered S2
[S16] + discovered S11
[S16] + discovered S3
[S16] + discovered S9
[S16] + discovered S4
[S16] + discovered S7
[S16] + discovered S6
[S16] + discovered S10
[S16] + discovered S13
[S16] + discovered S15
[S16] + discovered S5
[S15] + discovered S16
[S16] + discovered S14
[S16] + discovered S8
[S15] + discovered S17
[S17] + discovered S7
[S17] + discovered S13
[S17] + discovered S4
[S17] + discovered S3
[S17] + discovered S16
[S17] + discovered S9
[S17] + discovered S10
[S17] + discovered S8
[S16] + discovered S17
[S17] + discovered S2
[S17] + discovered S11
[S17] + discovered S6
[S17] + discovered S15
[S17] + discovered S14
[S17] + discovered S5
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] ⇄ pheromone p=1.000 → S2@127.0.0.1:31602
[S5] ⇄ pheromone p=1.000 → S14@127.0.0.1:31614
[S9] ⇄ pheromone p=1.000 → S4@127.0.0.1:31604
[S8] ⇄ pheromone p=1.000 → S17@127.0.0.1:31617
[S2] ⇄ pheromone p=1.000 → S11@127.0.0.1:31612
[S7] ⇄ pheromone p=1.000 → S17@127.0.0.1:31617
[S11] ⇄ pheromone p=1.000 → S13@127.0.0.1:31613
[S14] ⇄ pheromone p=1.000 → S5@127.0.0.1:31605
[S4] ⇄ pheromone p=1.000 → S5@127.0.0.1:31605
[S15] ⇄ pheromone p=1.000 → S10@127.0.0.1:31611
[S13] ⇄ pheromone p=1.000 → S5@127.0.0.1:31605
[S3] ⇄ pheromone p=1.000 → S8@127.0.0.1:31609
[S10] ⇄ pheromone p=1.000 → S16@127.0.0.1:31616
[S6] ⇄ pheromone p=1.000 → S4@127.0.0.1:31604
[S17] ⇄ pheromone p=1.000 → S5@127.0.0.1:31605
[S2] START round=1 head_norm_before_train=1.117026 (no previous merge yet)
[S2] round=1 local utility u=1.000000 metrics={'f1_val': 0.4160155965042821, 'auprc': 0.7743755971028833, 'loss_val': 1.3347548992346578, 'psi': 0.5593595967437226}-{'f1_val': 0.05585516178736518, 'auprc': 0.7697218679333253, 'loss_val': 1.3723496600010507, 'psi': 0.34140184424574926}
[S3] START round=1 head_norm_before_train=1.168278 (no previous merge yet)
[S3] round=1 local utility u=0.297216 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7967703070733649, 'loss_val': 1.3257976197626717, 'psi': 0.40261216219781026}-{'f1_val': 0.13984006561410703, 'auprc': 0.6079937781484702, 'loss_val': 1.3538993043867786, 'psi': 0.3271015506278523}
[S4] START round=1 head_norm_before_train=1.158076 (no previous merge yet)
[S4] round=1 local utility u=0.000000 metrics={'f1_val': 0.14132182240888586, 'auprc': 0.7735135369684621, 'loss_val': 1.3113269351980186, 'psi': 0.3941985082327164}-{'f1_val': 0.4238185344067697, 'auprc': 0.6450779850025554, 'loss_val': 1.347248599280986, 'psi': 0.5123223146450839}
[S5] START round=1 head_norm_before_train=1.172292 (no previous merge yet)
[S5] round=1 local utility u=0.016579 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7343184749112748, 'loss_val': 1.3040856176642104, 'psi': 0.3790845328216528}-{'f1_val': 0.14226190476190476, 'auprc': 0.7333715327223479, 'loss_val': 1.3344026848569284, 'psi': 0.378705755946082}
[S6] START round=1 head_norm_before_train=1.129408 (no previous merge yet)
[S6] round=1 local utility u=0.019541 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8367022384538589, 'loss_val': 1.309099611221044, 'psi': 0.4195366646123128}-{'f1_val': 0.14142628205128205, 'auprc': 0.8338335013794683, 'loss_val': 1.3395763765578252, 'psi': 0.4183891697825566}
[S7] START round=1 head_norm_before_train=1.167985 (no previous merge yet)
[S7] round=1 local utility u=0.009797 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7784669390128299, 'loss_val': 1.3048580703798613, 'psi': 0.396620869242587}-{'f1_val': 0.14205682272909165, 'auprc': 0.782773767861586, 'loss_val': 1.3373725647852455, 'psi': 0.3983436007820894}
[S8] START round=1 head_norm_before_train=1.158508 (no previous merge yet)
[S8] round=1 local utility u=0.771139 metrics={'f1_val': 0.2158284480098735, 'auprc': 0.7406074027468772, 'loss_val': 1.3597188727286538, 'psi': 0.42574002990467497}-{'f1_val': 0.05479960415635824, 'auprc': 0.5610445768772496, 'loss_val': 1.397136161949083, 'psi': 0.2572975932447148}
[S9] START round=1 head_norm_before_train=1.140908 (no previous merge yet)
[S9] round=1 local utility u=0.333791 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8651807758968612, 'loss_val': 1.2969706066712203, 'psi': 0.4309110846427421}-{'f1_val': 0.141397957139996, 'auprc': 0.654103246731818, 'loss_val': 1.331320942000492, 'psi': 0.3464800729767248}
[S10] START round=1 head_norm_before_train=1.221854 (no previous merge yet)
[S10] round=1 local utility u=0.818254 metrics={'f1_val': 0.32541806222060377, 'auprc': 0.6442808905095098, 'loss_val': 1.3259168892916455, 'psi': 0.45296319353616615}-{'f1_val': 0.10265544041450778, 'auprc': 0.554629430755182, 'loss_val': 1.3568944532922138, 'psi': 0.28344503655077746}
[S11] START round=1 head_norm_before_train=1.172599 (no previous merge yet)
[S11] round=1 local utility u=1.000000 metrics={'f1_val': 0.39080913757342006, 'auprc': 0.8284078268603403, 'loss_val': 1.334048509429172, 'psi': 0.5658486132881881}-{'f1_val': 0.10359570269677702, 'auprc': 0.6109641468723914, 'loss_val': 1.3624626085889775, 'psi': 0.30654308036702277}
[S13] START round=1 head_norm_before_train=1.163899 (no previous merge yet)
[S13] round=1 local utility u=0.005831 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5667902538945964, 'loss_val': 1.3234659906884039, 'psi': 0.3109475591040704}-{'f1_val': 0.15003083616795482, 'auprc': 0.5536589007866074, 'loss_val': 1.3536052530690195, 'psi': 0.31148206201541584}
[S14] START round=1 head_norm_before_train=1.174607 (no previous merge yet)
[S14] round=1 local utility u=0.688708 metrics={'f1_val': 0.39415470289073307, 'auprc': 0.7417362176183001, 'loss_val': 1.348988421783474, 'psi': 0.5331873087817599}-{'f1_val': 0.1038107752956636, 'auprc': 0.872171230658334, 'loss_val': 1.3756466701320593, 'psi': 0.41115495744073177}
[S15] START round=1 head_norm_before_train=1.214478 (no previous merge yet)
[S15] round=1 local utility u=0.063536 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7521417059462768, 'loss_val': 1.3163760913047635, 'psi': 0.38469687319544577}-{'f1_val': 0.13973365136155833, 'auprc': 0.7190803085008375, 'loss_val': 1.3442640940047739, 'psi': 0.37147231421727}
[S16] START round=1 head_norm_before_train=1.170911 (no previous merge yet)
[S16] round=1 local utility u=0.431092 metrics={'f1_val': 0.14074960127591707, 'auprc': 0.8000914542761047, 'loss_val': 1.3149066785435322, 'psi': 0.40448634247599213}-{'f1_val': 0.10386473429951691, 'auprc': 0.5966570357486152, 'loss_val': 1.3454778585483507, 'psi': 0.30098165487915624}
[S17] START round=1 head_norm_before_train=1.145146 (no previous merge yet)
[S17] round=1 local utility u=0.086223 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5916741327320058, 'loss_val': 1.3298042061010233, 'psi': 0.32123903108323293}-{'f1_val': 0.14094896331738438, 'auprc': 0.5438956726976939, 'loss_val': 1.3589139068668934, 'psi': 0.30212764706950823}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] → sending delta(kind=head bytes=1792) to S4@127.0.0.1:31604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S16] → sending delta(kind=head bytes=1786) to S5@127.0.0.1:31605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S3] → sending delta(kind=head bytes=1790) to S16@127.0.0.1:31616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:31615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1781 reason=None
[S5] → sending delta(kind=head bytes=1781) to S2@127.0.0.1:31602
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S11] → sending delta(kind=head bytes=1790) to S9@127.0.0.1:31610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:31609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] → sending delta(kind=head bytes=1792) to S15@127.0.0.1:31615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S7] → sending delta(kind=head bytes=1792) to S14@127.0.0.1:31614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S15] → sending delta(kind=head bytes=1789) to S5@127.0.0.1:31605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S8] → sending delta(kind=head bytes=1791) to S9@127.0.0.1:31610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S14] → sending delta(kind=head bytes=1788) to S7@127.0.0.1:31608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] → sending delta(kind=head bytes=1793) to S11@127.0.0.1:31612
[S16] sending update (kind=head size=1786 to 1 peers)
[S8] sending update (kind=head size=1791 to 1 peers)
[S13] sending update (kind=head size=1793 to 1 peers)
[S2] sending update (kind=head size=1794 to 1 peers)
[S6] sending update (kind=head size=1792 to 1 peers)
[S14] sending update (kind=head size=1788 to 1 peers)
[S11] sending update (kind=head size=1790 to 1 peers)
[S15] sending update (kind=head size=1789 to 1 peers)
[S10] sending update (kind=head size=1793 to 1 peers)
[S3] sending update (kind=head size=1790 to 1 peers)
[S7] sending update (kind=head size=1792 to 1 peers)
[S5] sending update (kind=head size=1781 to 1 peers)
[S9] sending update (kind=head size=1792 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1788) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.185058)
[S7] loaded HEAD from S14 (vec_in norm=1.185058)
[S7] cosine check vs S14: cos=-0.1386
[S7] DROPPED delta from S14 (cos=-0.1386 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1781) from S5
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.183287)
[S2] loaded HEAD from S5 (vec_in norm=1.183287)
[S2] cosine check vs S5: cos=-0.0533
[S2] DROPPED delta from S5 (cos=-0.0533 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1789) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.233962)
[S5] loaded HEAD from S15 (vec_in norm=1.233962)
[S5] cosine check vs S15: cos=-0.0565
[S5] DROPPED delta from S15 (cos=-0.0565 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1790) from S3
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.183691)
[S16] loaded HEAD from S3 (vec_in norm=1.183691)
[S16] cosine check vs S3: cos=0.0007
[S16] BUFFERED delta from S3 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1792) from S6
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.149100)
[S15] loaded HEAD from S6 (vec_in norm=1.149100)
[S15] cosine check vs S6: cos=-0.0005
[S15] DROPPED delta from S6 (cos=-0.0005 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1792) from S9
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.155570)
[S4] loaded HEAD from S9 (vec_in norm=1.155570)
[S4] cosine check vs S9: cos=-0.1106
[S4] DROPPED delta from S9 (cos=-0.1106 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1786) from S16
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.183642)
[S5] loaded HEAD from S16 (vec_in norm=1.183642)
[S5] cosine check vs S16: cos=-0.1410
[S5] DROPPED delta from S16 (cos=-0.1410 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1793) from S13
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.175256)
[S11] loaded HEAD from S13 (vec_in norm=1.175256)
[S11] cosine check vs S13: cos=0.1078
[S11] BUFFERED delta from S13 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1790) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.175778)
[S9] loaded HEAD from S11 (vec_in norm=1.175778)
[S9] cosine check vs S11: cos=-0.0895
[S9] DROPPED delta from S11 (cos=-0.0895 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1791) from S8
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.166857)
[S9] loaded HEAD from S8 (vec_in norm=1.166857)
[S9] cosine check vs S8: cos=-0.0345
[S9] DROPPED delta from S8 (cos=-0.0345 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1792) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.186049)
[S14] loaded HEAD from S7 (vec_in norm=1.186049)
[S14] cosine check vs S7: cos=-0.1386
[S14] DROPPED delta from S7 (cos=-0.1386 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1794) from S2
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.133077)
[S8] loaded HEAD from S2 (vec_in norm=1.133077)
[S8] cosine check vs S2: cos=0.0390
[S8] BUFFERED delta from S2 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1793) from S10
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.234820)
[S15] loaded HEAD from S10 (vec_in norm=1.234820)
[S15] cosine check vs S10: cos=-0.1377
[S15] DROPPED delta from S10 (cos=-0.1377 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S17] → sending delta(kind=head bytes=1791) to S14@127.0.0.1:31614
[S17] sending update (kind=head size=1791 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1791) from S17
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.159862)
[S14] loaded HEAD from S17 (vec_in norm=1.159862)
[S14] cosine check vs S17: cos=0.0000
[S14] BUFFERED delta from S17 (total buffered=1)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=1 metric=0.3908 head_norm=1.175778
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.851402e-01
[S11] stored merged vector for next round verification (round=1)
[S11] DEBUG after merge:  round=1 metric=0.1404 head_norm=0.874869 delta_norm=0.785140
[S11] aggregate: ROLLBACK (f1_val pre=0.391 post=0.140 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=1 metric=0.2158 head_norm=1.166857
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.972407e-01
[S8] stored merged vector for next round verification (round=1)
[S8] DEBUG after merge:  round=1 metric=0.0548 head_norm=0.828925 delta_norm=0.797241
[S8] aggregate: ROLLBACK (f1_val pre=0.216 post=0.055 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=1 metric=0.1407 head_norm=1.183642
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.366903e-01
[S16] stored merged vector for next round verification (round=1)
[S16] DEBUG after merge:  round=1 metric=0.1406 head_norm=0.837267 delta_norm=0.836690
[S16] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=1 metric=0.3942 head_norm=1.185058
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.290824e-01
[S14] stored merged vector for next round verification (round=1)
[S14] DEBUG after merge:  round=1 metric=0.1404 head_norm=0.829122 delta_norm=0.829082
[S14] aggregate: ROLLBACK (f1_val pre=0.394 post=0.140 tol_abs=0.005 tol_rel=0.0)
[S2] START round=2 head_norm_before_train=1.133077 (no previous merge yet)
[S2] round=2 local utility u=0.000000 metrics={'f1_val': 0.23815603574616884, 'auprc': 0.7744282749687583, 'loss_val': 1.2831158152919595, 'psi': 0.45266493143520464}-{'f1_val': 0.4160155965042821, 'auprc': 0.7743755971028833, 'loss_val': 1.3347548992346578, 'psi': 0.5593595967437226}
[S3] START round=2 head_norm_before_train=1.183691 (no previous merge yet)
[S3] round=2 local utility u=0.137237 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8770413752858613, 'loss_val': 1.292136512257381, 'psi': 0.4347205894828088}-{'f1_val': 0.13984006561410703, 'auprc': 0.7967703070733649, 'loss_val': 1.3257976197626717, 'psi': 0.40261216219781026}
[S4] START round=2 head_norm_before_train=1.167948 (no previous merge yet)
[S4] round=2 local utility u=0.034710 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7847385074869004, 'loss_val': 1.2690104634780104, 'psi': 0.3980313803318707}-{'f1_val': 0.14132182240888586, 'auprc': 0.7735135369684621, 'loss_val': 1.3113269351980186, 'psi': 0.3941985082327164}
[S5] START round=2 head_norm_before_train=1.183287 (no previous merge yet)
[S5] round=2 local utility u=0.021488 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7362760900075087, 'loss_val': 1.2669815357206207, 'psi': 0.3798675788601463}-{'f1_val': 0.14226190476190476, 'auprc': 0.7343184749112748, 'loss_val': 1.3040856176642104, 'psi': 0.3790845328216528}
[S6] START round=2 head_norm_before_train=1.149100 (no previous merge yet)
[S6] round=2 local utility u=0.022222 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8412703783823252, 'loss_val': 1.2783597149476489, 'psi': 0.4213639205836993}-{'f1_val': 0.14142628205128205, 'auprc': 0.8367022384538589, 'loss_val': 1.309099611221044, 'psi': 0.4195366646123128}
[S7] START round=2 head_norm_before_train=1.186049 (no previous merge yet)
[S7] round=2 local utility u=0.015820 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.779185364128335, 'loss_val': 1.2753730445879212, 'psi': 0.396908239288789}-{'f1_val': 0.14205682272909165, 'auprc': 0.7784669390128299, 'loss_val': 1.3048580703798613, 'psi': 0.396620869242587}
[S8] START round=2 head_norm_before_train=0.828925 cos_to_last_merge=1.0000 (last merge round=1)
[S8] round=2 local utility u=0.016789 metrics={'f1_val': 0.2121569808599607, 'auprc': 0.7568543781604256, 'loss_val': 1.3528525799183835, 'psi': 0.43003593978014665}-{'f1_val': 0.2158284480098735, 'auprc': 0.7406074027468772, 'loss_val': 1.3597188727286538, 'psi': 0.42574002990467497}
[S9] START round=2 head_norm_before_train=1.155570 (no previous merge yet)
[S9] round=2 local utility u=0.021854 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8655071066761282, 'loss_val': 1.25424071290024, 'psi': 0.4310416169544489}-{'f1_val': 0.141397957139996, 'auprc': 0.8651807758968612, 'loss_val': 1.2969706066712203, 'psi': 0.4309110846427421}
[S10] START round=2 head_norm_before_train=1.234820 (no previous merge yet)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7772092224887972, 'loss_val': 1.2889081461422531, 'psi': 0.39405667152055324}-{'f1_val': 0.32541806222060377, 'auprc': 0.6442808905095098, 'loss_val': 1.3259168892916455, 'psi': 0.45296319353616615}
[S11] START round=2 head_norm_before_train=0.874869 cos_to_last_merge=1.0000 (last merge round=1)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.998715700607746, 'loss_val': 1.3251523742862492, 'psi': 0.48373449026696475}-{'f1_val': 0.39080913757342006, 'auprc': 0.8284078268603403, 'loss_val': 1.334048509429172, 'psi': 0.5658486132881881}
[S13] START round=2 head_norm_before_train=1.175256 (no previous merge yet)
[S13] round=2 local utility u=0.043359 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5843987533880135, 'loss_val': 1.2895734745222796, 'psi': 0.31799095890143725}-{'f1_val': 0.1403857625770531, 'auprc': 0.5667902538945964, 'loss_val': 1.3234659906884039, 'psi': 0.3109475591040704}
[S14] START round=2 head_norm_before_train=0.829122 cos_to_last_merge=1.0000 (last merge round=1)
[S14] round=2 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8064008646858393, 'loss_val': 1.3403608226484334, 'psi': 0.406775057603958}-{'f1_val': 0.39415470289073307, 'auprc': 0.7417362176183001, 'loss_val': 1.348988421783474, 'psi': 0.5331873087817599}
[S15] START round=2 head_norm_before_train=1.233962 (no previous merge yet)
[S15] round=2 local utility u=0.033081 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.763655405932812, 'loss_val': 1.284755347195775, 'psi': 0.38930235319005985}-{'f1_val': 0.13973365136155833, 'auprc': 0.7521417059462768, 'loss_val': 1.3163760913047635, 'psi': 0.38469687319544577}
[S16] START round=2 head_norm_before_train=0.837267 cos_to_last_merge=1.0000 (last merge round=1)
[S16] round=2 local utility u=0.082490 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8520802421739493, 'loss_val': 1.305220079366921, 'psi': 0.42521456698910165}-{'f1_val': 0.14074960127591707, 'auprc': 0.8000914542761047, 'loss_val': 1.3149066785435322, 'psi': 0.40448634247599213}
[S17] START round=2 head_norm_before_train=1.159862 (no previous merge yet)
[S17] round=2 local utility u=0.015904 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5895330558067284, 'loss_val': 1.2915722928675224, 'psi': 0.32038260031312205}-{'f1_val': 0.14094896331738438, 'auprc': 0.5916741327320058, 'loss_val': 1.3298042061010233, 'psi': 0.32123903108323293}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S13] → sending delta(kind=head bytes=1792) to S16@127.0.0.1:31616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:31617
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S15] → sending delta(kind=head bytes=1791) to S6@127.0.0.1:31607
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:31614
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S4] → sending delta(kind=head bytes=1788) to S13@127.0.0.1:31613
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] → sending delta(kind=head bytes=1792) to S4@127.0.0.1:31604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S5] → sending delta(kind=head bytes=1788) to S9@127.0.0.1:31610
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S7] → sending delta(kind=head bytes=1790) to S3@127.0.0.1:31603
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:31616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S3] → sending delta(kind=head bytes=1788) to S13@127.0.0.1:31613
[S16] sending update (kind=head size=1794 to 1 peers)
[S15] sending update (kind=head size=1791 to 1 peers)
[S5] sending update (kind=head size=1788 to 1 peers)
[S4] sending update (kind=head size=1788 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1792 to 1 peers)
[S7] sending update (kind=head size=1790 to 1 peers)
[S9] sending update (kind=head size=1794 to 1 peers)
[S3] sending update (kind=head size=1788 to 1 peers)
[S13] sending update (kind=head size=1792 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1796) from S8
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.840476)
[S14] loaded HEAD from S8 (vec_in norm=0.840476)
[S14] cosine check vs S8: cos=0.0052
[S14] BUFFERED delta from S8 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1788) from S3
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.206674)
[S13] loaded HEAD from S3 (vec_in norm=1.206674)
[S13] cosine check vs S3: cos=-0.0090
[S13] DROPPED delta from S3 (cos=-0.0090 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1794) from S16
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.857312)
[S17] loaded HEAD from S16 (vec_in norm=0.857312)
[S17] cosine check vs S16: cos=-0.0438
[S17] DROPPED delta from S16 (cos=-0.0438 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1790) from S7
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.209545)
[S3] loaded HEAD from S7 (vec_in norm=1.209545)
[S3] cosine check vs S7: cos=-0.0544
[S3] DROPPED delta from S7 (cos=-0.0544 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1792) from S13
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.196697)
[S16] loaded HEAD from S13 (vec_in norm=1.196697)
[S16] cosine check vs S13: cos=-0.0090
[S16] DROPPED delta from S13 (cos=-0.0090 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1794) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.181204)
[S16] loaded HEAD from S9 (vec_in norm=1.181204)
[S16] cosine check vs S9: cos=-0.0427
[S16] DROPPED delta from S9 (cos=-0.0427 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1792) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.176535)
[S4] loaded HEAD from S6 (vec_in norm=1.176535)
[S4] cosine check vs S6: cos=0.1726
[S4] BUFFERED delta from S6 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1788) from S4
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.186019)
[S13] loaded HEAD from S4 (vec_in norm=1.186019)
[S13] cosine check vs S4: cos=0.0346
[S13] BUFFERED delta from S4 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1791) from S15
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.260332)
[S6] loaded HEAD from S15 (vec_in norm=1.260332)
[S6] cosine check vs S15: cos=0.0055
[S6] BUFFERED delta from S15 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1788) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.204258)
[S9] loaded HEAD from S5 (vec_in norm=1.204258)
[S9] cosine check vs S5: cos=0.0668
[S9] BUFFERED delta from S5 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] → sending delta(kind=head bytes=1793) to S11@127.0.0.1:31612
[S17] sending update (kind=head size=1793 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1793) from S17
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.184781)
[S11] loaded HEAD from S17 (vec_in norm=1.184781)
[S11] cosine check vs S17: cos=-0.0552
[S11] DROPPED delta from S17 (cos=-0.0552 < 0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=2 metric=0.1404 head_norm=0.845222
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.944350e-01
[S14] stored merged vector for next round verification (round=2)
[S14] DEBUG after merge:  round=2 metric=0.2135 head_norm=0.597534 delta_norm=0.594435
[S14] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=2 metric=0.1414 head_norm=1.176535
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.597234e-01
[S6] stored merged vector for next round verification (round=2)
[S6] DEBUG after merge:  round=2 metric=0.1414 head_norm=0.864414 delta_norm=0.859723
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=2 metric=0.1414 head_norm=1.181204
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.147696e-01
[S9] stored merged vector for next round verification (round=2)
[S9] DEBUG after merge:  round=2 metric=0.1414 head_norm=0.871143 delta_norm=0.814770
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=2 metric=0.1402 head_norm=1.186019
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.597809e-01
[S4] stored merged vector for next round verification (round=2)
[S4] DEBUG after merge:  round=2 metric=0.1402 head_norm=0.904528 delta_norm=0.759781
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=2 metric=0.1404 head_norm=1.196697
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.277313e-01
[S13] stored merged vector for next round verification (round=2)
[S13] DEBUG after merge:  round=2 metric=0.1404 head_norm=0.856869 delta_norm=0.827731
[S13] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=1.159242 (no previous merge yet)
[S2] round=3 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7732418048850658, 'loss_val': 1.2047849723396629, 'psi': 0.3943630019871664}-{'f1_val': 0.23815603574616884, 'auprc': 0.7744282749687583, 'loss_val': 1.2831158152919595, 'psi': 0.45266493143520464}
[S3] START round=3 head_norm_before_train=1.206674 (no previous merge yet)
[S3] round=3 local utility u=0.203019 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9967962767505574, 'loss_val': 1.245363269874599, 'psi': 0.48262255006868715}-{'f1_val': 0.13984006561410703, 'auprc': 0.8770413752858613, 'loss_val': 1.292136512257381, 'psi': 0.4347205894828088}
[S4] START round=3 head_norm_before_train=0.904528 cos_to_last_merge=1.0000 (last merge round=2)
[S4] round=3 local utility u=0.010491 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7885616580754884, 'loss_val': 1.2594982394481153, 'psi': 0.39956064056730584}-{'f1_val': 0.14022662889518414, 'auprc': 0.7847385074869004, 'loss_val': 1.2690104634780104, 'psi': 0.3980313803318707}
[S5] START round=3 head_norm_before_train=1.204258 (no previous merge yet)
[S5] round=3 local utility u=0.012386 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7289653112716167, 'loss_val': 1.2202762540744776, 'psi': 0.37694326736578954}-{'f1_val': 0.14226190476190476, 'auprc': 0.7362760900075087, 'loss_val': 1.2669815357206207, 'psi': 0.3798675788601463}
[S6] START round=3 head_norm_before_train=0.864414 cos_to_last_merge=1.0000 (last merge round=2)
[S6] round=3 local utility u=0.001851 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8453175434019503, 'loss_val': 1.2867995228764055, 'psi': 0.42298278659154936}-{'f1_val': 0.14142628205128205, 'auprc': 0.8412703783823252, 'loss_val': 1.2783597149476489, 'psi': 0.4213639205836993}
[S7] START round=3 head_norm_before_train=1.209545 (no previous merge yet)
[S7] round=3 local utility u=0.021453 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7852311545871431, 'loss_val': 1.2506051677291783, 'psi': 0.3993265554723123}-{'f1_val': 0.14205682272909165, 'auprc': 0.779185364128335, 'loss_val': 1.2753730445879212, 'psi': 0.396908239288789}
[S8] START round=3 head_norm_before_train=0.840476 cos_to_last_merge=0.9967 (last merge round=1)
[S8] round=3 local utility u=0.000000 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7641167221725725, 'loss_val': 1.3116501406720482, 'psi': 0.38962027830480334}-{'f1_val': 0.2121569808599607, 'auprc': 0.7568543781604256, 'loss_val': 1.3528525799183835, 'psi': 0.43003593978014665}
[S9] START round=3 head_norm_before_train=0.871143 cos_to_last_merge=1.0000 (last merge round=2)
[S9] round=3 local utility u=0.004878 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8658194697868349, 'loss_val': 1.2454214815310165, 'psi': 0.43116656219873156}-{'f1_val': 0.141397957139996, 'auprc': 0.8655071066761282, 'loss_val': 1.25424071290024, 'psi': 0.4310416169544489}
[S10] START round=3 head_norm_before_train=1.257919 (no previous merge yet)
[S10] round=3 local utility u=0.022698 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7773279493436126, 'loss_val': 1.2438692118160335, 'psi': 0.3941041622624794}-{'f1_val': 0.13862163754172394, 'auprc': 0.7772092224887972, 'loss_val': 1.2889081461422531, 'psi': 0.39405667152055324}
[S11] START round=3 head_norm_before_train=0.887062 cos_to_last_merge=0.9967 (last merge round=1)
[S11] round=3 local utility u=0.017655 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.9991517828210497, 'loss_val': 1.2911513513059543, 'psi': 0.48390892315228623}-{'f1_val': 0.14041368337311058, 'auprc': 0.998715700607746, 'loss_val': 1.3251523742862492, 'psi': 0.48373449026696475}
[S13] START round=3 head_norm_before_train=0.856869 cos_to_last_merge=1.0000 (last merge round=2)
[S13] round=3 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.561197218141881, 'loss_val': 1.3018787209739822, 'psi': 0.30871034480298426}-{'f1_val': 0.1403857625770531, 'auprc': 0.5843987533880135, 'loss_val': 1.2895734745222796, 'psi': 0.31799095890143725}
[S14] START round=3 head_norm_before_train=0.597534 cos_to_last_merge=1.0000 (last merge round=2)
[S14] round=3 local utility u=0.070862 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8560999445755593, 'loss_val': 1.3477346055003898, 'psi': 0.426654689559846}-{'f1_val': 0.14035785288270378, 'auprc': 0.8064008646858393, 'loss_val': 1.3403608226484334, 'psi': 0.406775057603958}
[S15] START round=3 head_norm_before_train=1.260332 (no previous merge yet)
[S15] round=3 local utility u=0.030989 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7706417555222015, 'loss_val': 1.2437364248113092, 'psi': 0.39209689302581563}-{'f1_val': 0.13973365136155833, 'auprc': 0.763655405932812, 'loss_val': 1.284755347195775, 'psi': 0.38930235319005985}
[S16] START round=3 head_norm_before_train=0.857312 cos_to_last_merge=0.9971 (last merge round=1)
[S16] round=3 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8115368668257326, 'loss_val': 1.2697976192340816, 'psi': 0.40899721684981494}-{'f1_val': 0.14063745019920318, 'auprc': 0.8520802421739493, 'loss_val': 1.305220079366921, 'psi': 0.42521456698910165}
[S17] START round=3 head_norm_before_train=1.184781 (no previous merge yet)
[S17] round=3 local utility u=0.003041 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5744562396085533, 'loss_val': 1.240258912893027, 'psi': 0.314351873833852}-{'f1_val': 0.14094896331738438, 'auprc': 0.5895330558067284, 'loss_val': 1.2915722928675224, 'psi': 0.32038260031312205}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:31604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:31609
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:31617
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S10@127.0.0.1:31611
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:31616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:31604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:31615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:31613
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:31605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S5] → sending delta(kind=head bytes=1791) to S10@127.0.0.1:31611
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1791 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1793 to 1 peers)
[S15] sending update (kind=head size=1793 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S10
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.289807)
[S16] loaded HEAD from S10 (vec_in norm=1.289807)
[S16] cosine check vs S10: cos=0.0055
[S16] BUFFERED delta from S10 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1796) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.909330)
[S13] loaded HEAD from S11 (vec_in norm=0.909330)
[S13] cosine check vs S11: cos=0.5515
[S13] BUFFERED delta from S11 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1791) from S5
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.233217)
[S10] loaded HEAD from S5 (vec_in norm=1.233217)
[S10] cosine check vs S5: cos=-0.0183
[S10] DROPPED delta from S5 (cos=-0.0183 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1793) from S15
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.294224)
[S10] loaded HEAD from S15 (vec_in norm=1.294224)
[S10] cosine check vs S15: cos=-0.1408
[S10] DROPPED delta from S15 (cos=-0.1408 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1797) from S7
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.230913)
[S17] loaded HEAD from S7 (vec_in norm=1.230913)
[S17] cosine check vs S7: cos=0.0363
[S17] BUFFERED delta from S7 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1795) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.618704)
[S15] loaded HEAD from S14 (vec_in norm=0.618704)
[S15] cosine check vs S14: cos=-0.0357
[S15] DROPPED delta from S14 (cos=-0.0357 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1797) from S3
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.239463)
[S8] loaded HEAD from S3 (vec_in norm=1.239463)
[S8] cosine check vs S3: cos=-0.0122
[S8] DROPPED delta from S3 (cos=-0.0122 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1793) from S4
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.930214)
[S5] loaded HEAD from S4 (vec_in norm=0.930214)
[S5] cosine check vs S4: cos=-0.0020
[S5] DROPPED delta from S4 (cos=-0.0020 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1803) from S9
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.899317)
[S4] loaded HEAD from S9 (vec_in norm=0.899317)
[S4] cosine check vs S9: cos=-0.0891
[S4] DROPPED delta from S9 (cos=-0.0891 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1795) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.890003)
[S4] loaded HEAD from S6 (vec_in norm=0.890003)
[S4] cosine check vs S6: cos=0.5105
[S4] BUFFERED delta from S6 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:31605
[S17] sending update (kind=head size=1795 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1795) from S17
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.214520)
[S5] loaded HEAD from S17 (vec_in norm=1.214520)
[S5] cosine check vs S17: cos=-0.0425
[S5] DROPPED delta from S17 (cos=-0.0425 < 0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=3 metric=0.1404 head_norm=0.878974
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.236282e-01
[S13] stored merged vector for next round verification (round=3)
[S13] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.787577 delta_norm=0.423628
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=3 metric=0.1406 head_norm=0.885977
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.803830e-01
[S16] stored merged vector for next round verification (round=3)
[S16] DEBUG after merge:  round=3 metric=0.1406 head_norm=0.784399 delta_norm=0.780383
[S16] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=3 metric=0.1402 head_norm=0.930214
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.505962e-01
[S4] stored merged vector for next round verification (round=3)
[S4] DEBUG after merge:  round=3 metric=0.1402 head_norm=0.790990 delta_norm=0.450596
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=3 metric=0.1409 head_norm=1.214520
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.487689e-01
[S17] stored merged vector for next round verification (round=3)
[S17] DEBUG after merge:  round=3 metric=0.1409 head_norm=0.880167 delta_norm=0.848769
[S17] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=1.194797 (no previous merge yet)
[S2] round=4 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6129869500745344, 'loss_val': 1.13719641923487, 'psi': 0.3302610600629538}-{'f1_val': 0.1417771333885667, 'auprc': 0.7732418048850658, 'loss_val': 1.2047849723396629, 'psi': 0.3943630019871664}
[S3] START round=4 head_norm_before_train=1.239463 (no previous merge yet)
[S3] round=4 local utility u=0.011930 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9882155840360166, 'loss_val': 1.195761990782096, 'psi': 0.47919027298287087}-{'f1_val': 0.13984006561410703, 'auprc': 0.9967962767505574, 'loss_val': 1.245363269874599, 'psi': 0.48262255006868715}
[S4] START round=4 head_norm_before_train=0.790990 cos_to_last_merge=1.0000 (last merge round=3)
[S4] round=4 local utility u=0.010325 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.788710887172325, 'loss_val': 1.2392950703792383, 'psi': 0.3996203322060405}-{'f1_val': 0.14022662889518414, 'auprc': 0.7885616580754884, 'loss_val': 1.2594982394481153, 'psi': 0.39956064056730584}
[S5] START round=4 head_norm_before_train=1.233217 (no previous merge yet)
[S5] round=4 local utility u=0.036455 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7321008328895409, 'loss_val': 1.1567721093308558, 'psi': 0.3781974760129592}-{'f1_val': 0.14226190476190476, 'auprc': 0.7289653112716167, 'loss_val': 1.2202762540744776, 'psi': 0.37694326736578954}
[S6] START round=4 head_norm_before_train=0.890003 cos_to_last_merge=0.9972 (last merge round=2)
[S6] round=4 local utility u=0.024409 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8459090243564074, 'loss_val': 1.2397567411395194, 'psi': 0.42321937897333217}-{'f1_val': 0.14142628205128205, 'auprc': 0.8453175434019503, 'loss_val': 1.2867995228764055, 'psi': 0.42298278659154936}
[S7] START round=4 head_norm_before_train=1.230913 (no previous merge yet)
[S7] round=4 local utility u=0.000901 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7754842694541357, 'loss_val': 1.2195629896572129, 'psi': 0.3954278014191093}-{'f1_val': 0.14205682272909165, 'auprc': 0.7852311545871431, 'loss_val': 1.2506051677291783, 'psi': 0.3993265554723123}
[S8] START round=4 head_norm_before_train=0.861457 cos_to_last_merge=0.9876 (last merge round=1)
[S8] round=4 local utility u=0.033052 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7660939961914586, 'loss_val': 1.2514771352735918, 'psi': 0.3904111879123578}-{'f1_val': 0.13995598239295717, 'auprc': 0.7641167221725725, 'loss_val': 1.3116501406720482, 'psi': 0.38962027830480334}
[S9] START round=4 head_norm_before_train=0.899317 cos_to_last_merge=0.9967 (last merge round=2)
[S9] round=4 local utility u=0.031428 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8657000246659826, 'loss_val': 1.1822069138153952, 'psi': 0.4311187841503907}-{'f1_val': 0.141397957139996, 'auprc': 0.8658194697868349, 'loss_val': 1.2454214815310165, 'psi': 0.43116656219873156}
[S10] START round=4 head_norm_before_train=1.289807 (no previous merge yet)
[S10] round=4 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7094763754282674, 'loss_val': 1.1892574068330048, 'psi': 0.3669635326963413}-{'f1_val': 0.13862163754172394, 'auprc': 0.7773279493436126, 'loss_val': 1.2438692118160335, 'psi': 0.3941041622624794}
[S11] START round=4 head_norm_before_train=0.909330 cos_to_last_merge=0.9881 (last merge round=1)
[S11] round=4 local utility u=0.021903 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.9980300759752706, 'loss_val': 1.243979883551175, 'psi': 0.4834602404139746}-{'f1_val': 0.14041368337311058, 'auprc': 0.9991517828210497, 'loss_val': 1.2911513513059543, 'psi': 0.48390892315228623}
[S13] START round=4 head_norm_before_train=0.787577 cos_to_last_merge=1.0000 (last merge round=3)
[S13] round=4 local utility u=0.167143 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6579849641754323, 'loss_val': 1.257956210828259, 'psi': 0.3474254432164048}-{'f1_val': 0.1403857625770531, 'auprc': 0.561197218141881, 'loss_val': 1.3018787209739822, 'psi': 0.30871034480298426}
[S14] START round=4 head_norm_before_train=0.618704 cos_to_last_merge=0.9949 (last merge round=2)
[S14] round=4 local utility u=0.000573 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8455325736274545, 'loss_val': 1.3148872901705164, 'psi': 0.42242774118060405}-{'f1_val': 0.14035785288270378, 'auprc': 0.8560999445755593, 'loss_val': 1.3477346055003898, 'psi': 0.426654689559846}
[S15] START round=4 head_norm_before_train=1.294224 (no previous merge yet)
[S15] round=4 local utility u=0.860334 metrics={'f1_val': 0.4163758395072774, 'auprc': 0.7714919692814302, 'loss_val': 1.1854712399551686, 'psi': 0.5584222914169386}-{'f1_val': 0.13973365136155833, 'auprc': 0.7706417555222015, 'loss_val': 1.2437364248113092, 'psi': 0.39209689302581563}
[S16] START round=4 head_norm_before_train=0.784399 cos_to_last_merge=1.0000 (last merge round=3)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7840965159759697, 'loss_val': 1.2689202682867045, 'psi': 0.3980210765099098}-{'f1_val': 0.14063745019920318, 'auprc': 0.8115368668257326, 'loss_val': 1.2697976192340816, 'psi': 0.40899721684981494}
[S17] START round=4 head_norm_before_train=0.880167 cos_to_last_merge=1.0000 (last merge round=3)
[S17] round=4 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5582688668331173, 'loss_val': 1.2108532672603645, 'psi': 0.30787692472367756}-{'f1_val': 0.14094896331738438, 'auprc': 0.5744562396085533, 'loss_val': 1.240258912893027, 'psi': 0.314351873833852}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:31609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:31605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S5] → sending delta(kind=head bytes=1791) to S10@127.0.0.1:31611
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:31605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:31617
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:31613
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:31611
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] → sending delta(kind=head bytes=1792) to S4@127.0.0.1:31604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:31604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:31617
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:31615
[S4] sending update (kind=head size=1804 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1792 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1791 to 1 peers)
[S3] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1796) from S13
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=0.817967)
[S5] loaded HEAD from S13 (vec_in norm=0.817967)
[S5] cosine check vs S13: cos=-0.0290
[S5] DROPPED delta from S13 (cos=-0.0290 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1797) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.891695)
[S17] loaded HEAD from S8 (vec_in norm=0.891695)
[S17] cosine check vs S8: cos=-0.0273
[S17] DROPPED delta from S8 (cos=-0.0273 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1798) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.938718)
[S13] loaded HEAD from S11 (vec_in norm=0.938718)
[S13] cosine check vs S11: cos=0.8762
[S13] BUFFERED delta from S11 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1794) from S3
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.276132)
[S8] loaded HEAD from S3 (vec_in norm=1.276132)
[S8] cosine check vs S3: cos=-0.0124
[S8] DROPPED delta from S3 (cos=-0.0124 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1804) from S4
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.815985)
[S5] loaded HEAD from S4 (vec_in norm=0.815985)
[S5] cosine check vs S4: cos=-0.0058
[S5] DROPPED delta from S4 (cos=-0.0058 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1797) from S7
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.253924)
[S17] loaded HEAD from S7 (vec_in norm=1.253924)
[S17] cosine check vs S7: cos=0.7099
[S17] BUFFERED delta from S7 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1797) from S15
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.330891)
[S10] loaded HEAD from S15 (vec_in norm=1.330891)
[S10] cosine check vs S15: cos=-0.1396
[S10] DROPPED delta from S15 (cos=-0.1396 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1791) from S5
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.266010)
[S10] loaded HEAD from S5 (vec_in norm=1.266010)
[S10] cosine check vs S5: cos=-0.0127
[S10] DROPPED delta from S5 (cos=-0.0127 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1801) from S9
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.936617)
[S4] loaded HEAD from S9 (vec_in norm=0.936617)
[S4] cosine check vs S9: cos=-0.0723
[S4] DROPPED delta from S9 (cos=-0.0723 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1792) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.918825)
[S4] loaded HEAD from S6 (vec_in norm=0.918825)
[S4] cosine check vs S6: cos=0.8497
[S4] BUFFERED delta from S6 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1794) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.648313)
[S15] loaded HEAD from S14 (vec_in norm=0.648313)
[S15] cosine check vs S14: cos=-0.0371
[S15] DROPPED delta from S14 (cos=-0.0371 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=4 metric=0.1404 head_norm=0.817967
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.262559e-01
[S13] stored merged vector for next round verification (round=4)
[S13] DEBUG after merge:  round=4 metric=0.1404 head_norm=0.850846 delta_norm=0.226256
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=4 metric=0.1402 head_norm=0.815985
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.428505e-01
[S4] stored merged vector for next round verification (round=4)
[S4] DEBUG after merge:  round=4 metric=0.1402 head_norm=0.834301 delta_norm=0.242851
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=4 metric=0.1409 head_norm=0.910539
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.417042e-01
[S17] stored merged vector for next round verification (round=4)
[S17] DEBUG after merge:  round=4 metric=0.1409 head_norm=1.002796 delta_norm=0.441704
[S17] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=1.234106 (no previous merge yet)
[S2] round=5 local utility u=1.000000 metrics={'f1_val': 0.4156703010573377, 'auprc': 0.7738985239478364, 'loss_val': 1.0460932477141922, 'psi': 0.5589615902135372}-{'f1_val': 0.1417771333885667, 'auprc': 0.6129869500745344, 'loss_val': 1.13719641923487, 'psi': 0.3302610600629538}
[S3] START round=5 head_norm_before_train=1.276132 (no previous merge yet)
[S3] round=5 local utility u=0.072540 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9980390166321833, 'loss_val': 1.0801521741891225, 'psi': 0.4831196460213376}-{'f1_val': 0.13984006561410703, 'auprc': 0.9882155840360166, 'loss_val': 1.195761990782096, 'psi': 0.47919027298287087}
[S4] START round=5 head_norm_before_train=0.834301 cos_to_last_merge=1.0000 (last merge round=4)
[S4] round=5 local utility u=0.016831 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7905133770172973, 'loss_val': 1.2110402658562978, 'psi': 0.4003413281440294}-{'f1_val': 0.14022662889518414, 'auprc': 0.788710887172325, 'loss_val': 1.2392950703792383, 'psi': 0.3996203322060405}
[S5] START round=5 head_norm_before_train=1.266010 (no previous merge yet)
[S5] round=5 local utility u=0.926213 metrics={'f1_val': 0.41694544507090897, 'auprc': 0.7703911485953523, 'loss_val': 1.0673186455788821, 'psi': 0.5583237264806864}-{'f1_val': 0.14226190476190476, 'auprc': 0.7321008328895409, 'loss_val': 1.1567721093308558, 'psi': 0.3781974760129592}
[S6] START round=5 head_norm_before_train=0.918825 cos_to_last_merge=0.9904 (last merge round=2)
[S6] round=5 local utility u=0.862724 metrics={'f1_val': 0.4150420236907487, 'auprc': 0.8470726948282802, 'loss_val': 1.1594943467834435, 'psi': 0.5878542921457613}-{'f1_val': 0.14142628205128205, 'auprc': 0.8459090243564074, 'loss_val': 1.2397567411395194, 'psi': 0.42321937897333217}
[S7] START round=5 head_norm_before_train=1.253924 (no previous merge yet)
[S7] round=5 local utility u=0.024718 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7779133404268115, 'loss_val': 1.177413424182728, 'psi': 0.3963994298081796}-{'f1_val': 0.14205682272909165, 'auprc': 0.7754842694541357, 'loss_val': 1.2195629896572129, 'psi': 0.3954278014191093}
[S8] START round=5 head_norm_before_train=0.891695 cos_to_last_merge=0.9744 (last merge round=1)
[S8] round=5 local utility u=0.043042 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7663603535556691, 'loss_val': 1.1661919464438102, 'psi': 0.390517730858042}-{'f1_val': 0.13995598239295717, 'auprc': 0.7660939961914586, 'loss_val': 1.2514771352735918, 'psi': 0.3904111879123578}
[S9] START round=5 head_norm_before_train=0.936617 cos_to_last_merge=0.9882 (last merge round=2)
[S9] round=5 local utility u=0.039277 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8644033958234953, 'loss_val': 1.0997636134984254, 'psi': 0.43060013261339575}-{'f1_val': 0.141397957139996, 'auprc': 0.8657000246659826, 'loss_val': 1.1822069138153952, 'psi': 0.4311187841503907}
[S10] START round=5 head_norm_before_train=1.324426 (no previous merge yet)
[S10] round=5 local utility u=0.523172 metrics={'f1_val': 0.3094713410014648, 'auprc': 0.6839687825724723, 'loss_val': 1.091488497602261, 'psi': 0.4592703176298678}-{'f1_val': 0.13862163754172394, 'auprc': 0.7094763754282674, 'loss_val': 1.1892574068330048, 'psi': 0.3669635326963413}
[S11] START round=5 head_norm_before_train=0.938718 cos_to_last_merge=0.9769 (last merge round=1)
[S11] round=5 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7688896393135458, 'loss_val': 1.184761926889544, 'psi': 0.39180406574928467}-{'f1_val': 0.14041368337311058, 'auprc': 0.9980300759752706, 'loss_val': 1.243979883551175, 'psi': 0.4834602404139746}
[S13] START round=5 head_norm_before_train=0.850846 cos_to_last_merge=1.0000 (last merge round=4)
[S13] round=5 local utility u=0.095245 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7042616532885361, 'loss_val': 1.20629544117008, 'psi': 0.3659361188616463}-{'f1_val': 0.1403857625770531, 'auprc': 0.6579849641754323, 'loss_val': 1.257956210828259, 'psi': 0.3474254432164048}
[S14] START round=5 head_norm_before_train=0.648313 cos_to_last_merge=0.9818 (last merge round=2)
[S14] round=5 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7914732330610307, 'loss_val': 1.2723561097950182, 'psi': 0.40080400495403457}-{'f1_val': 0.14035785288270378, 'auprc': 0.8455325736274545, 'loss_val': 1.3148872901705164, 'psi': 0.42242774118060405}
[S15] START round=5 head_norm_before_train=1.330891 (no previous merge yet)
[S15] round=5 local utility u=0.053721 metrics={'f1_val': 0.416839147538149, 'auprc': 0.7738341707853206, 'loss_val': 1.0878365846434546, 'psi': 0.5596371568370176}-{'f1_val': 0.4163758395072774, 'auprc': 0.7714919692814302, 'loss_val': 1.1854712399551686, 'psi': 0.5584222914169386}
[S16] START round=5 head_norm_before_train=0.810649 cos_to_last_merge=0.9965 (last merge round=3)
[S16] round=5 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.6220951886782174, 'loss_val': 1.199929984637772, 'psi': 0.33322054559080894}-{'f1_val': 0.14063745019920318, 'auprc': 0.7840965159759697, 'loss_val': 1.2689202682867045, 'psi': 0.3980210765099098}
[S17] START round=5 head_norm_before_train=1.002796 cos_to_last_merge=1.0000 (last merge round=4)
[S17] round=5 local utility u=0.549232 metrics={'f1_val': 0.3141922660485551, 'auprc': 0.5538381100389067, 'loss_val': 1.1385569419335768, 'psi': 0.4100506036446957}-{'f1_val': 0.14094896331738438, 'auprc': 0.5582688668331173, 'loss_val': 1.2108532672603645, 'psi': 0.30787692472367756}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:31612
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:31617
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:31616
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S8] → sending delta(kind=head bytes=1791) to S17@127.0.0.1:31617
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:31605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:31609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:31611
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S5] → sending delta(kind=head bytes=1791) to S10@127.0.0.1:31611
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:31604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] → sending delta(kind=head bytes=1792) to S4@127.0.0.1:31604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:31605
[S3] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1792 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1791 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1791) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.926699)
[S17] loaded HEAD from S8 (vec_in norm=0.926699)
[S17] cosine check vs S8: cos=-0.0366
[S17] DROPPED delta from S8 (cos=-0.0366 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1795) from S7
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.276126)
[S17] loaded HEAD from S7 (vec_in norm=1.276126)
[S17] cosine check vs S7: cos=0.9324
[S17] BUFFERED delta from S7 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1800) from S2
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.261508)
[S11] loaded HEAD from S2 (vec_in norm=1.261508)
[S11] cosine check vs S2: cos=-0.0134
[S11] DROPPED delta from S2 (cos=-0.0134 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1800) from S3
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.308249)
[S8] loaded HEAD from S3 (vec_in norm=1.308249)
[S8] cosine check vs S3: cos=-0.0151
[S8] DROPPED delta from S3 (cos=-0.0151 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1798) from S4
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.858531)
[S5] loaded HEAD from S4 (vec_in norm=0.858531)
[S5] cosine check vs S4: cos=-0.0088
[S5] DROPPED delta from S4 (cos=-0.0088 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1795) from S13
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=0.888150)
[S5] loaded HEAD from S13 (vec_in norm=0.888150)
[S5] cosine check vs S13: cos=-0.0202
[S5] DROPPED delta from S13 (cos=-0.0202 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1796) from S15
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.367633)
[S10] loaded HEAD from S15 (vec_in norm=1.367633)
[S10] cosine check vs S15: cos=-0.1393
[S10] DROPPED delta from S15 (cos=-0.1393 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1792) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.953350)
[S4] loaded HEAD from S6 (vec_in norm=0.953350)
[S4] cosine check vs S6: cos=0.9501
[S4] BUFFERED delta from S6 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1795) from S10
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.354085)
[S16] loaded HEAD from S10 (vec_in norm=1.354085)
[S16] cosine check vs S10: cos=0.7730
[S16] BUFFERED delta from S10 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1799) from S9
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.974485)
[S4] loaded HEAD from S9 (vec_in norm=0.974485)
[S4] cosine check vs S9: cos=-0.0568
[S4] DROPPED delta from S9 (cos=-0.0568 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:31605
[S17] sending update (kind=head size=1794 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1794) from S17
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.027267)
[S5] loaded HEAD from S17 (vec_in norm=1.027267)
[S5] cosine check vs S17: cos=0.0191
[S5] BUFFERED delta from S17 (total buffered=1)
[S5] sending update (kind=head size=1791 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1791) from S5
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.294764)
[S10] loaded HEAD from S5 (vec_in norm=1.294764)
[S10] cosine check vs S5: cos=-0.0127
[S10] DROPPED delta from S5 (cos=-0.0127 < 0.0)
[S11] ⇄ pheromone p=0.415 → S13@127.0.0.1:31613
[S10] ⇄ pheromone p=0.502 → S16@127.0.0.1:31616
[S3] ⇄ pheromone p=0.408 → S8@127.0.0.1:31609
[S2] ⇄ pheromone p=0.610 → S11@127.0.0.1:31612
[S8] ⇄ pheromone p=0.406 → S17@127.0.0.1:31617
[S13] ⇄ pheromone p=0.378 → S5@127.0.0.1:31605
[S9] ⇄ pheromone p=0.371 → S4@127.0.0.1:31604
[S7] ⇄ pheromone p=0.338 → S17@127.0.0.1:31617
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=5 metric=0.1402 head_norm=0.858531
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.505462e-01
[S4] stored merged vector for next round verification (round=5)
[S4] DEBUG after merge:  round=5 metric=0.1402 head_norm=0.894601 delta_norm=0.150546
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.338 → S5@127.0.0.1:31605
[S6] ⇄ pheromone p=0.508 → S4@127.0.0.1:31604
[S14] ⇄ pheromone p=0.393 → S15@127.0.0.1:31615
[S15] ⇄ pheromone p=0.489 → S10@127.0.0.1:31611
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=5 metric=0.3142 head_norm=1.027267
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.444705e-01
[S17] stored merged vector for next round verification (round=5)
[S17] DEBUG after merge:  round=5 metric=0.3873 head_norm=1.132308 delta_norm=0.244470
[S17] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.447 → S5@127.0.0.1:31605
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=5 metric=0.1406 head_norm=0.847226
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.409217e-01
[S16] stored merged vector for next round verification (round=5)
[S16] DEBUG after merge:  round=5 metric=0.1449 head_norm=1.039835 delta_norm=0.440922
[S16] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.371 → S2@127.0.0.1:31602
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=5 metric=0.4169 head_norm=1.294764
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.186519e-01
[S5] stored merged vector for next round verification (round=5)
[S5] DEBUG after merge:  round=5 metric=0.4171 head_norm=0.834059 delta_norm=0.818652
[S5] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.524 → S10@127.0.0.1:31611
[S2] START round=6 head_norm_before_train=1.261508 (no previous merge yet)
[S2] round=6 local utility u=0.055245 metrics={'f1_val': 0.41656007580384097, 'auprc': 0.7756028027310182, 'loss_val': 0.9460542102550208, 'psi': 0.560177166574712}-{'f1_val': 0.4156703010573377, 'auprc': 0.7738985239478364, 'loss_val': 1.0460932477141922, 'psi': 0.5589615902135372}
[S3] START round=6 head_norm_before_train=1.308249 (no previous merge yet)
[S3] round=6 local utility u=0.856139 metrics={'f1_val': 0.396483704974271, 'auprc': 0.9987301225286692, 'loss_val': 0.909808669534263, 'psi': 0.6373822719960303}-{'f1_val': 0.13984006561410703, 'auprc': 0.9980390166321833, 'loss_val': 1.0801521741891225, 'psi': 0.4831196460213376}
[S4] START round=6 head_norm_before_train=0.894601 cos_to_last_merge=1.0000 (last merge round=5)
[S4] round=6 local utility u=0.015215 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7857745570967816, 'loss_val': 1.1663946675177626, 'psi': 0.39844580017582315}-{'f1_val': 0.14022662889518414, 'auprc': 0.7905133770172973, 'loss_val': 1.2110402658562978, 'psi': 0.4003413281440294}
[S5] START round=6 head_norm_before_train=0.834059 cos_to_last_merge=1.0000 (last merge round=5)
[S5] round=6 local utility u=0.000000 metrics={'f1_val': 0.41795135763108626, 'auprc': 0.5800001987000752, 'loss_val': 1.0606589180433095, 'psi': 0.48277089405868184}-{'f1_val': 0.41694544507090897, 'auprc': 0.7703911485953523, 'loss_val': 1.0673186455788821, 'psi': 0.5583237264806864}
[S6] START round=6 head_norm_before_train=0.953350 cos_to_last_merge=0.9819 (last merge round=2)
[S6] round=6 local utility u=0.088256 metrics={'f1_val': 0.4150420236907487, 'auprc': 0.8517354403643194, 'loss_val': 0.9969706041356321, 'psi': 0.589719390360177}-{'f1_val': 0.4150420236907487, 'auprc': 0.8470726948282802, 'loss_val': 1.1594943467834435, 'psi': 0.5878542921457613}
[S7] START round=6 head_norm_before_train=1.276126 (no previous merge yet)
[S7] round=6 local utility u=0.748290 metrics={'f1_val': 0.37740666100904885, 'auprc': 0.7778264158548194, 'loss_val': 1.092672346728635, 'psi': 0.5375745629473571}-{'f1_val': 0.14205682272909165, 'auprc': 0.7779133404268115, 'loss_val': 1.177413424182728, 'psi': 0.3963994298081796}
[S8] START round=6 head_norm_before_train=0.926699 cos_to_last_merge=0.9599 (last merge round=1)
[S8] round=6 local utility u=1.000000 metrics={'f1_val': 0.7143011549708294, 'auprc': 0.776558591016533, 'loss_val': 1.0574460607207532, 'psi': 0.7392041293891108}-{'f1_val': 0.13995598239295717, 'auprc': 0.7663603535556691, 'loss_val': 1.1661919464438102, 'psi': 0.390517730858042}
[S9] START round=6 head_norm_before_train=0.974485 cos_to_last_merge=0.9784 (last merge round=2)
[S9] round=6 local utility u=0.913337 metrics={'f1_val': 0.41576403377768284, 'auprc': 0.865513197186422, 'loss_val': 0.9226148142038225, 'psi': 0.5956636991411786}-{'f1_val': 0.141397957139996, 'auprc': 0.8644033958234953, 'loss_val': 1.0997636134984254, 'psi': 0.43060013261339575}
[S10] START round=6 head_norm_before_train=1.354085 (no previous merge yet)
[S10] round=6 local utility u=0.706541 metrics={'f1_val': 0.43792934943384726, 'auprc': 0.8447342575420733, 'loss_val': 0.9314514248071367, 'psi': 0.6006513126771378}-{'f1_val': 0.3094713410014648, 'auprc': 0.6839687825724723, 'loss_val': 1.091488497602261, 'psi': 0.4592703176298678}
[S11] START round=6 head_norm_before_train=0.979285 cos_to_last_merge=0.9633 (last merge round=1)
[S11] round=6 local utility u=0.057392 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.774027984598558, 'loss_val': 1.0853936542463043, 'psi': 0.3938594038632896}-{'f1_val': 0.14041368337311058, 'auprc': 0.7688896393135458, 'loss_val': 1.184761926889544, 'psi': 0.39180406574928467}
[S13] START round=6 head_norm_before_train=0.888150 cos_to_last_merge=0.9977 (last merge round=4)
[S13] round=6 local utility u=0.880956 metrics={'f1_val': 0.4127061774851051, 'auprc': 0.7218557140976827, 'loss_val': 1.1310879642932163, 'psi': 0.536365992130136}-{'f1_val': 0.1403857625770531, 'auprc': 0.7042616532885361, 'loss_val': 1.20629544117008, 'psi': 0.3659361188616463}
[S14] START round=6 head_norm_before_train=0.683529 cos_to_last_merge=0.9647 (last merge round=2)
[S14] round=6 local utility u=0.007246 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7780096590862632, 'loss_val': 1.2174727575710285, 'psi': 0.39541857536412756}-{'f1_val': 0.14035785288270378, 'auprc': 0.7914732330610307, 'loss_val': 1.2723561097950182, 'psi': 0.40080400495403457}
[S15] START round=6 head_norm_before_train=1.367633 (no previous merge yet)
[S15] round=6 local utility u=0.121769 metrics={'f1_val': 0.4167593395843331, 'auprc': 0.7927421840199842, 'loss_val': 0.9005447152825446, 'psi': 0.5671524773585935}-{'f1_val': 0.416839147538149, 'auprc': 0.7738341707853206, 'loss_val': 1.0878365846434546, 'psi': 0.5596371568370176}
[S16] START round=6 head_norm_before_train=1.039835 cos_to_last_merge=1.0000 (last merge round=5)
[S16] round=6 local utility u=0.763341 metrics={'f1_val': 0.41428462841297564, 'auprc': 0.5593573236186592, 'loss_val': 1.1269167516051077, 'psi': 0.47231370649524906}-{'f1_val': 0.14063745019920318, 'auprc': 0.6220951886782174, 'loss_val': 1.199929984637772, 'psi': 0.33322054559080894}
[S17] START round=6 head_norm_before_train=1.132308 cos_to_last_merge=1.0000 (last merge round=5)
[S17] round=6 local utility u=0.296324 metrics={'f1_val': 0.39190299739728274, 'auprc': 0.5591970054710617, 'loss_val': 1.0282495761918182, 'psi': 0.4588206006267943}-{'f1_val': 0.3141922660485551, 'auprc': 0.5538381100389067, 'loss_val': 1.1385569419335768, 'psi': 0.4100506036446957}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:31602
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:31609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:31615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] → sending delta(kind=head bytes=1792) to S13@127.0.0.1:31613
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S9] → sending delta(kind=head bytes=1790) to S4@127.0.0.1:31604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:31616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:31605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S2] → sending delta(kind=head bytes=1808) to S11@127.0.0.1:31612
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:31605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:31617
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S6] → sending delta(kind=head bytes=1789) to S4@127.0.0.1:31604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S8] → sending delta(kind=head bytes=1791) to S17@127.0.0.1:31617
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:31611
[S4] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1790 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1792 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1791 to 1 peers)
[S14] sending update (kind=head size=1793 to 1 peers)
[S16] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1789 to 1 peers)
[S2] sending update (kind=head size=1808 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1791) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.959119)
[S17] loaded HEAD from S8 (vec_in norm=0.959119)
[S17] cosine check vs S8: cos=-0.0379
[S17] DROPPED delta from S8 (cos=-0.0379 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1798) from S13
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=0.912490)
[S5] loaded HEAD from S13 (vec_in norm=0.912490)
[S5] cosine check vs S13: cos=-0.0040
[S5] DROPPED delta from S13 (cos=-0.0040 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1799) from S10
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.394803)
[S16] loaded HEAD from S10 (vec_in norm=1.394803)
[S16] cosine check vs S10: cos=0.9506
[S16] BUFFERED delta from S10 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1800) from S7
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.307202)
[S17] loaded HEAD from S7 (vec_in norm=1.307202)
[S17] cosine check vs S7: cos=0.9739
[S17] BUFFERED delta from S7 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1789) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.997496)
[S4] loaded HEAD from S6 (vec_in norm=0.997496)
[S4] cosine check vs S6: cos=0.9762
[S4] BUFFERED delta from S6 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1808) from S2
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.294044)
[S11] loaded HEAD from S2 (vec_in norm=1.294044)
[S11] cosine check vs S2: cos=-0.0160
[S11] DROPPED delta from S2 (cos=-0.0160 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1790) from S9
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.015128)
[S4] loaded HEAD from S9 (vec_in norm=1.015128)
[S4] cosine check vs S9: cos=-0.0494
[S4] DROPPED delta from S9 (cos=-0.0494 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1792) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.017131)
[S13] loaded HEAD from S11 (vec_in norm=1.017131)
[S13] cosine check vs S11: cos=0.9457
[S13] BUFFERED delta from S11 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1795) from S16
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.063356)
[S2] loaded HEAD from S16 (vec_in norm=1.063356)
[S2] cosine check vs S16: cos=0.0258
[S2] BUFFERED delta from S16 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1793) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.720621)
[S15] loaded HEAD from S14 (vec_in norm=0.720621)
[S15] cosine check vs S14: cos=-0.0408
[S15] DROPPED delta from S14 (cos=-0.0408 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1799) from S15
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.408308)
[S10] loaded HEAD from S15 (vec_in norm=1.408308)
[S10] cosine check vs S15: cos=-0.1388
[S10] DROPPED delta from S15 (cos=-0.1388 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1796) from S3
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.343216)
[S8] loaded HEAD from S3 (vec_in norm=1.343216)
[S8] cosine check vs S3: cos=-0.0218
[S8] DROPPED delta from S3 (cos=-0.0218 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1800) from S4
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.913689)
[S5] loaded HEAD from S4 (vec_in norm=0.913689)
[S5] cosine check vs S4: cos=0.0500
[S5] BUFFERED delta from S4 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:31605
[S17] sending update (kind=head size=1793 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1793) from S17
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.158818)
[S5] loaded HEAD from S17 (vec_in norm=1.158818)
[S5] cosine check vs S17: cos=0.6135
[S5] BUFFERED delta from S17 (total buffered=2)
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=6 metric=0.4180 head_norm=0.871471
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.154952e-01
[S5] stored merged vector for next round verification (round=6)
[S5] DEBUG after merge:  round=6 metric=0.3431 head_norm=0.708727 delta_norm=0.415495
[S5] aggregate: ROLLBACK (f1_val pre=0.418 post=0.343 tol_abs=0.005 tol_rel=0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=6 metric=0.4166 head_norm=1.294044
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.267941e-01
[S2] stored merged vector for next round verification (round=6)
[S2] DEBUG after merge:  round=6 metric=0.6087 head_norm=0.847968 delta_norm=0.826794
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=6 metric=0.4143 head_norm=1.063356
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.531183e-01
[S16] stored merged vector for next round verification (round=6)
[S16] DEBUG after merge:  round=6 metric=0.4144 head_norm=1.214097 delta_norm=0.253118
[S16] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=6 metric=0.4127 head_norm=0.912490
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.671691e-01
[S13] stored merged vector for next round verification (round=6)
[S13] DEBUG after merge:  round=6 metric=0.4117 head_norm=0.951657 delta_norm=0.167169
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=6 metric=0.1402 head_norm=0.913689
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.122443e-01
[S4] stored merged vector for next round verification (round=6)
[S4] DEBUG after merge:  round=6 metric=0.1402 head_norm=0.949903 delta_norm=0.112244
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=6 metric=0.3919 head_norm=1.158818
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.589804e-01
[S17] stored merged vector for next round verification (round=6)
[S17] DEBUG after merge:  round=6 metric=0.3920 head_norm=1.224967 delta_norm=0.158980
[S17] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=0.847968 cos_to_last_merge=1.0000 (last merge round=6)
[S2] round=7 local utility u=0.000000 metrics={'f1_val': 0.41706166803148853, 'auprc': 0.7750773478490043, 'loss_val': 0.9678351835071881, 'psi': 0.5602679399584949}-{'f1_val': 0.41656007580384097, 'auprc': 0.7756028027310182, 'loss_val': 0.9460542102550208, 'psi': 0.560177166574712}
[S3] START round=7 head_norm_before_train=1.343216 (no previous merge yet)
[S3] round=7 local utility u=0.064447 metrics={'f1_val': 0.3918308821556906, 'auprc': 0.9982653581436316, 'loss_val': 0.7516032841692868, 'psi': 0.634404672550867}-{'f1_val': 0.396483704974271, 'auprc': 0.9987301225286692, 'loss_val': 0.909808669534263, 'psi': 0.6373822719960303}
[S4] START round=7 head_norm_before_train=0.949903 cos_to_last_merge=1.0000 (last merge round=6)
[S4] round=7 local utility u=0.093426 metrics={'f1_val': 0.15551333640601148, 'auprc': 0.786361615054266, 'loss_val': 1.0730239627906544, 'psi': 0.40785264786531333}-{'f1_val': 0.14022662889518414, 'auprc': 0.7857745570967816, 'loss_val': 1.1663946675177626, 'psi': 0.39844580017582315}
[S5] START round=7 head_norm_before_train=0.708727 cos_to_last_merge=1.0000 (last merge round=6)
[S5] round=7 local utility u=0.004690 metrics={'f1_val': 0.41762898496828804, 'auprc': 0.5768860196681138, 'loss_val': 1.040002353272085, 'psi': 0.48133179884821836}-{'f1_val': 0.41795135763108626, 'auprc': 0.5800001987000752, 'loss_val': 1.0606589180433095, 'psi': 0.48277089405868184}
[S6] START round=7 head_norm_before_train=0.997496 cos_to_last_merge=0.9712 (last merge round=2)
[S6] round=7 local utility u=0.101302 metrics={'f1_val': 0.4168551858772006, 'auprc': 0.8552325040829072, 'loss_val': 0.8157372533351904, 'psi': 0.5922061131594833}-{'f1_val': 0.4150420236907487, 'auprc': 0.8517354403643194, 'loss_val': 0.9969706041356321, 'psi': 0.589719390360177}
[S7] START round=7 head_norm_before_train=1.307202 (no previous merge yet)
[S7] round=7 local utility u=0.213378 metrics={'f1_val': 0.41736073619820624, 'auprc': 0.7934606756684455, 'loss_val': 0.9525427055106064, 'psi': 0.567800711986302}-{'f1_val': 0.37740666100904885, 'auprc': 0.7778264158548194, 'loss_val': 1.092672346728635, 'psi': 0.5375745629473571}
[S8] START round=7 head_norm_before_train=0.959119 cos_to_last_merge=0.9478 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.948
[S8] round=7 local utility u=0.071140 metrics={'f1_val': 0.7146825535339066, 'auprc': 0.7769401662346415, 'loss_val': 0.9185994519007089, 'psi': 0.7395855986142006}-{'f1_val': 0.7143011549708294, 'auprc': 0.776558591016533, 'loss_val': 1.0574460607207532, 'psi': 0.7392041293891108}
[S9] START round=7 head_norm_before_train=1.015128 cos_to_last_merge=0.9682 (last merge round=2)
[S9] round=7 local utility u=0.151019 metrics={'f1_val': 0.4378582197325261, 'auprc': 0.8657326384278174, 'loss_val': 0.7538010028255882, 'psi': 0.6090079872106426}-{'f1_val': 0.41576403377768284, 'auprc': 0.865513197186422, 'loss_val': 0.9226148142038225, 'psi': 0.5956636991411786}
[S10] START round=7 head_norm_before_train=1.394803 (no previous merge yet)
[S10] round=7 local utility u=0.927450 metrics={'f1_val': 0.7015282636690967, 'auprc': 0.8653742983450804, 'loss_val': 0.7200646490826222, 'psi': 0.7670666775394902}-{'f1_val': 0.43792934943384726, 'auprc': 0.8447342575420733, 'loss_val': 0.9314514248071367, 'psi': 0.6006513126771378}
[S11] START round=7 head_norm_before_train=1.017131 cos_to_last_merge=0.9513 (last merge round=1)
[S11] round=7 local utility u=1.000000 metrics={'f1_val': 0.396484976660716, 'auprc': 0.9811226363341004, 'loss_val': 0.9714905328709962, 'psi': 0.6303400405300698}-{'f1_val': 0.14041368337311058, 'auprc': 0.774027984598558, 'loss_val': 1.0853936542463043, 'psi': 0.3938594038632896}
[S13] START round=7 head_norm_before_train=0.951657 cos_to_last_merge=1.0000 (last merge round=6)
[S13] round=7 local utility u=0.002406 metrics={'f1_val': 0.416999224839651, 'auprc': 0.6890113915514828, 'loss_val': 1.0535010021872862, 'psi': 0.5258040915243838}-{'f1_val': 0.4127061774851051, 'auprc': 0.7218557140976827, 'loss_val': 1.1310879642932163, 'psi': 0.536365992130136}
[S14] START round=7 head_norm_before_train=0.720621 cos_to_last_merge=0.9469 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.947
[S14] round=7 local utility u=0.191963 metrics={'f1_val': 0.15072587532023912, 'auprc': 0.8528555186578402, 'loss_val': 1.1202931717701037, 'psi': 0.43157773265527954}-{'f1_val': 0.14035785288270378, 'auprc': 0.7780096590862632, 'loss_val': 1.2174727575710285, 'psi': 0.39541857536412756}
[S15] START round=7 head_norm_before_train=1.408308 (no previous merge yet)
[S15] round=7 local utility u=0.972551 metrics={'f1_val': 0.7060182424701738, 'auprc': 0.7945275036985007, 'loss_val': 0.6963523562608931, 'psi': 0.7414219469615045}-{'f1_val': 0.4167593395843331, 'auprc': 0.7927421840199842, 'loss_val': 0.9005447152825446, 'psi': 0.5671524773585935}
[S16] START round=7 head_norm_before_train=1.214097 cos_to_last_merge=1.0000 (last merge round=6)
[S16] round=7 local utility u=0.317066 metrics={'f1_val': 0.42948399384475666, 'auprc': 0.7042763841286114, 'loss_val': 1.0187384456862105, 'psi': 0.5394009499582986}-{'f1_val': 0.41428462841297564, 'auprc': 0.5593573236186592, 'loss_val': 1.1269167516051077, 'psi': 0.47231370649524906}
[S17] START round=7 head_norm_before_train=1.224967 cos_to_last_merge=1.0000 (last merge round=6)
[S17] round=7 local utility u=0.047737 metrics={'f1_val': 0.3897353669607727, 'auprc': 0.5603215044882728, 'loss_val': 0.9231426124316796, 'psi': 0.4579698219717727}-{'f1_val': 0.39190299739728274, 'auprc': 0.5591970054710617, 'loss_val': 1.0282495761918182, 'psi': 0.4588206006267943}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:31611
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:31604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:31617
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:31611
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:31609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:31613
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:31605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:31605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:31602
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:31616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:31617
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:31615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S6] → sending delta(kind=head bytes=1790) to S4@127.0.0.1:31604
[S7] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1790 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1799) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.058723)
[S13] loaded HEAD from S11 (vec_in norm=1.058723)
[S13] cosine check vs S11: cos=0.9736
[S13] BUFFERED delta from S11 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1798) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.760951)
[S15] loaded HEAD from S14 (vec_in norm=0.760951)
[S15] cosine check vs S14: cos=-0.0440
[S15] DROPPED delta from S14 (cos=-0.0440 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1795) from S16
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.239551)
[S2] loaded HEAD from S16 (vec_in norm=1.239551)
[S2] cosine check vs S16: cos=0.6027
[S2] BUFFERED delta from S16 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1794) from S4
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.973460)
[S5] loaded HEAD from S4 (vec_in norm=0.973460)
[S5] cosine check vs S4: cos=0.3646
[S5] BUFFERED delta from S4 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1800) from S13
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=0.974838)
[S5] loaded HEAD from S13 (vec_in norm=0.974838)
[S5] cosine check vs S13: cos=0.0044
[S5] BUFFERED delta from S13 (total buffered=2)
[S16] RECEIVED delta(kind=head bytes=1801) from S10
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.447129)
[S16] loaded HEAD from S10 (vec_in norm=1.447129)
[S16] cosine check vs S10: cos=0.9805
[S16] BUFFERED delta from S10 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1802) from S15
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.457204)
[S10] loaded HEAD from S15 (vec_in norm=1.457204)
[S10] cosine check vs S15: cos=-0.1380
[S10] DROPPED delta from S15 (cos=-0.1380 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1802) from S7
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.338540)
[S17] loaded HEAD from S7 (vec_in norm=1.338540)
[S17] cosine check vs S7: cos=0.9826
[S17] BUFFERED delta from S7 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1795) from S5
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.738481)
[S10] loaded HEAD from S5 (vec_in norm=0.738481)
[S10] cosine check vs S5: cos=-0.0982
[S10] DROPPED delta from S5 (cos=-0.0982 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1798) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.002975)
[S17] loaded HEAD from S8 (vec_in norm=1.002975)
[S17] cosine check vs S8: cos=-0.0368
[S17] DROPPED delta from S8 (cos=-0.0368 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1790) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.044017)
[S4] loaded HEAD from S6 (vec_in norm=1.044017)
[S4] cosine check vs S6: cos=0.9820
[S4] BUFFERED delta from S6 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1798) from S3
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.386380)
[S8] loaded HEAD from S3 (vec_in norm=1.386380)
[S8] cosine check vs S3: cos=-0.0282
[S8] DROPPED delta from S3 (cos=-0.0282 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1800) from S9
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.071139)
[S4] loaded HEAD from S9 (vec_in norm=1.071139)
[S4] cosine check vs S9: cos=-0.0463
[S4] DROPPED delta from S9 (cos=-0.0463 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] → sending delta(kind=head bytes=1806) to S5@127.0.0.1:31605
[S17] sending update (kind=head size=1806 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1806) from S17
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.256312)
[S5] loaded HEAD from S17 (vec_in norm=1.256312)
[S5] cosine check vs S17: cos=0.7868
[S5] BUFFERED delta from S17 (total buffered=3)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=7 metric=0.4171 head_norm=0.886362
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.994208e-01
[S2] stored merged vector for next round verification (round=7)
[S2] DEBUG after merge:  round=7 metric=0.2981 head_norm=0.954799 delta_norm=0.499421
[S2] aggregate: ROLLBACK (f1_val pre=0.417 post=0.298 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=7 metric=0.4295 head_norm=1.239551
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.682248e-01
[S16] stored merged vector for next round verification (round=7)
[S16] DEBUG after merge:  round=7 metric=0.4361 head_norm=1.336801 delta_norm=0.168225
[S16] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=7 metric=0.1555 head_norm=0.973460
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.019942e-01
[S4] stored merged vector for next round verification (round=7)
[S4] DEBUG after merge:  round=7 metric=0.4148 head_norm=1.004189 delta_norm=0.101994
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=7 metric=0.4170 head_norm=0.974838
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.239491e-01
[S13] stored merged vector for next round verification (round=7)
[S13] DEBUG after merge:  round=7 metric=0.4164 head_norm=1.010068 delta_norm=0.123949
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=7 metric=0.4176 head_norm=0.738481
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.902144e-01
[S5] stored merged vector for next round verification (round=7)
[S5] DEBUG after merge:  round=7 metric=0.3745 head_norm=0.624380 delta_norm=0.290214
[S5] aggregate: ROLLBACK (f1_val pre=0.418 post=0.374 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=7 metric=0.3897 head_norm=1.256312
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.277548e-01
[S17] stored merged vector for next round verification (round=7)
[S17] DEBUG after merge:  round=7 metric=0.3824 head_norm=1.291775 delta_norm=0.127755
[S17] aggregate: ROLLBACK (f1_val pre=0.390 post=0.382 tol_abs=0.005 tol_rel=0.0)
[S2] START round=8 head_norm_before_train=0.954799 cos_to_last_merge=1.0000 (last merge round=7)
[S2] round=8 local utility u=0.366905 metrics={'f1_val': 0.5439697730119162, 'auprc': 0.7751610344569677, 'loss_val': 0.9957255397063282, 'psi': 0.6364462775899368}-{'f1_val': 0.41706166803148853, 'auprc': 0.7750773478490043, 'loss_val': 0.9678351835071881, 'psi': 0.5602679399584949}
[S3] START round=8 head_norm_before_train=1.386380 (no previous merge yet)
[S3] round=8 local utility u=0.000000 metrics={'f1_val': 0.401708470248874, 'auprc': 0.7706872227019049, 'loss_val': 0.7813128715550264, 'psi': 0.5492999712300863}-{'f1_val': 0.3918308821556906, 'auprc': 0.9982653581436316, 'loss_val': 0.7516032841692868, 'psi': 0.634404672550867}
[S4] START round=8 head_norm_before_train=1.004189 cos_to_last_merge=1.0000 (last merge round=7)
[S4] round=8 local utility u=1.000000 metrics={'f1_val': 0.6854292031867004, 'auprc': 0.7859936802555869, 'loss_val': 0.9245610217667245, 'psi': 0.725654994014255}-{'f1_val': 0.15551333640601148, 'auprc': 0.786361615054266, 'loss_val': 1.0730239627906544, 'psi': 0.40785264786531333}
[S5] START round=8 head_norm_before_train=0.624380 cos_to_last_merge=1.0000 (last merge round=7)
[S5] round=8 local utility u=0.144277 metrics={'f1_val': 0.41750764008433106, 'auprc': 0.6715596427408905, 'loss_val': 1.0347414003089643, 'psi': 0.5191284411469548}-{'f1_val': 0.41762898496828804, 'auprc': 0.5768860196681138, 'loss_val': 1.040002353272085, 'psi': 0.48133179884821836}
[S6] START round=8 head_norm_before_train=1.044017 cos_to_last_merge=0.9588 (last merge round=2)
[S6] round=8 local utility u=0.215045 metrics={'f1_val': 0.416130594159999, 'auprc': 0.9684233274694061, 'loss_val': 0.7208731665677083, 'psi': 0.6370476874837618}-{'f1_val': 0.4168551858772006, 'auprc': 0.8552325040829072, 'loss_val': 0.8157372533351904, 'psi': 0.5922061131594833}
[S7] START round=8 head_norm_before_train=1.338540 (no previous merge yet)
[S7] round=8 local utility u=0.944654 metrics={'f1_val': 0.7117348912141701, 'auprc': 0.794612984178739, 'loss_val': 0.8329374954931202, 'psi': 0.7448861283999977}-{'f1_val': 0.41736073619820624, 'auprc': 0.7934606756684455, 'loss_val': 0.9525427055106064, 'psi': 0.567800711986302}
[S8] START round=8 head_norm_before_train=1.002975 cos_to_last_merge=0.9322 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.932
[S8] round=8 local utility u=0.000000 metrics={'f1_val': 0.3731322377369826, 'auprc': 0.6457717688186778, 'loss_val': 0.7940891349667822, 'psi': 0.4821880501696607}-{'f1_val': 0.7146825535339066, 'auprc': 0.7769401662346415, 'loss_val': 0.9185994519007089, 'psi': 0.7395855986142006}
[S9] START round=8 head_norm_before_train=1.071139 cos_to_last_merge=0.9545 (last merge round=2)
[S9] round=8 local utility u=1.000000 metrics={'f1_val': 0.7016893154854569, 'auprc': 0.999582772816428, 'loss_val': 0.5903916639248208, 'psi': 0.8208466984178453}-{'f1_val': 0.4378582197325261, 'auprc': 0.8657326384278174, 'loss_val': 0.7538010028255882, 'psi': 0.6090079872106426}
[S10] START round=8 head_norm_before_train=1.447129 (no previous merge yet)
[S10] round=8 local utility u=0.215192 metrics={'f1_val': 0.6912271661463085, 'auprc': 0.9884468655792802, 'loss_val': 0.5970924249996931, 'psi': 0.8101150459194972}-{'f1_val': 0.7015282636690967, 'auprc': 0.8653742983450804, 'loss_val': 0.7200646490826222, 'psi': 0.7670666775394902}
[S11] START round=8 head_norm_before_train=1.058723 cos_to_last_merge=0.9387 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.939
[S11] round=8 local utility u=0.113143 metrics={'f1_val': 0.39651855440916606, 'auprc': 0.9970993354205065, 'loss_val': 0.7933359319527259, 'psi': 0.6367508668137023}-{'f1_val': 0.396484976660716, 'auprc': 0.9811226363341004, 'loss_val': 0.9714905328709962, 'psi': 0.6303400405300698}
[S13] START round=8 head_norm_before_train=1.010068 cos_to_last_merge=1.0000 (last merge round=7)
[S13] round=8 local utility u=1.000000 metrics={'f1_val': 0.7108279090934471, 'auprc': 0.7301359015412502, 'loss_val': 0.9345594078519883, 'psi': 0.7185511060725683}-{'f1_val': 0.416999224839651, 'auprc': 0.6890113915514828, 'loss_val': 1.0535010021872862, 'psi': 0.5258040915243838}
[S14] START round=8 head_norm_before_train=0.760951 cos_to_last_merge=0.9291 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.929
[S14] round=8 local utility u=0.864442 metrics={'f1_val': 0.39652757107859105, 'auprc': 0.8869318084986343, 'loss_val': 0.9684488944880195, 'psi': 0.5926892660466083}-{'f1_val': 0.15072587532023912, 'auprc': 0.8528555186578402, 'loss_val': 1.1202931717701037, 'psi': 0.43157773265527954}
[S15] START round=8 head_norm_before_train=1.457204 (no previous merge yet)
[S15] round=8 local utility u=0.087728 metrics={'f1_val': 0.7058042115664355, 'auprc': 0.7980348153250442, 'loss_val': 0.5301346181378729, 'psi': 0.742696453069879}-{'f1_val': 0.7060182424701738, 'auprc': 0.7945275036985007, 'loss_val': 0.6963523562608931, 'psi': 0.7414219469615045}
[S16] START round=8 head_norm_before_train=1.336801 cos_to_last_merge=1.0000 (last merge round=7)
[S16] round=8 local utility u=0.000000 metrics={'f1_val': 0.3644418328596322, 'auprc': 0.7153085411575856, 'loss_val': 0.9485124292909277, 'psi': 0.5047885161788136}-{'f1_val': 0.42948399384475666, 'auprc': 0.7042763841286114, 'loss_val': 1.0187384456862105, 'psi': 0.5394009499582986}
[S17] START round=8 head_norm_before_train=1.291775 cos_to_last_merge=1.0000 (last merge round=7)
[S17] round=8 local utility u=0.289803 metrics={'f1_val': 0.3552057631585315, 'auprc': 0.8071642107686513, 'loss_val': 0.8768868250236841, 'psi': 0.5359891422025794}-{'f1_val': 0.3897353669607727, 'auprc': 0.5603215044882728, 'loss_val': 0.9231426124316796, 'psi': 0.4579698219717727}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S4] → sending delta(kind=head bytes=1787) to S5@127.0.0.1:31605
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S14] → sending delta(kind=head bytes=1791) to S15@127.0.0.1:31615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S13] → sending delta(kind=head bytes=1789) to S5@127.0.0.1:31605
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:31604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] → sending delta(kind=head bytes=1793) to S11@127.0.0.1:31612
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:31604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:31617
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:31616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:31611
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S11] → sending delta(kind=head bytes=1791) to S13@127.0.0.1:31613
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:31611
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1789 to 1 peers)
[S14] sending update (kind=head size=1791 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1793 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1791 to 1 peers)
[S4] sending update (kind=head size=1787 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1795) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.089893)
[S4] loaded HEAD from S6 (vec_in norm=1.089893)
[S4] cosine check vs S6: cos=0.9828
[S4] BUFFERED delta from S6 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1791) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.814158)
[S15] loaded HEAD from S14 (vec_in norm=0.814158)
[S15] cosine check vs S14: cos=-0.0472
[S15] DROPPED delta from S14 (cos=-0.0472 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1795) from S9
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.132973)
[S4] loaded HEAD from S9 (vec_in norm=1.132973)
[S4] cosine check vs S9: cos=-0.0461
[S4] DROPPED delta from S9 (cos=-0.0461 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1797) from S7
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.366034)
[S17] loaded HEAD from S7 (vec_in norm=1.366034)
[S17] cosine check vs S7: cos=0.9835
[S17] BUFFERED delta from S7 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1793) from S2
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=0.980614)
[S11] loaded HEAD from S2 (vec_in norm=0.980614)
[S11] cosine check vs S2: cos=-0.0348
[S11] DROPPED delta from S2 (cos=-0.0348 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1791) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.109937)
[S13] loaded HEAD from S11 (vec_in norm=1.109937)
[S13] cosine check vs S11: cos=0.9780
[S13] BUFFERED delta from S11 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1801) from S10
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.495836)
[S16] loaded HEAD from S10 (vec_in norm=1.495836)
[S16] cosine check vs S10: cos=0.9876
[S16] BUFFERED delta from S10 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1787) from S4
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.035325)
[S5] loaded HEAD from S4 (vec_in norm=1.035325)
[S5] cosine check vs S4: cos=0.4970
[S5] BUFFERED delta from S4 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1800) from S5
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.650072)
[S10] loaded HEAD from S5 (vec_in norm=0.650072)
[S10] cosine check vs S5: cos=-0.1097
[S10] DROPPED delta from S5 (cos=-0.1097 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1789) from S13
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.038960)
[S5] loaded HEAD from S13 (vec_in norm=1.038960)
[S5] cosine check vs S13: cos=0.2615
[S5] BUFFERED delta from S13 (total buffered=2)
[S10] RECEIVED delta(kind=head bytes=1800) from S15
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.502567)
[S10] loaded HEAD from S15 (vec_in norm=1.502567)
[S10] cosine check vs S15: cos=-0.1381
[S10] DROPPED delta from S15 (cos=-0.1381 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] → sending delta(kind=head bytes=1806) to S5@127.0.0.1:31605
[S17] sending update (kind=head size=1806 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1806) from S17
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.326925)
[S5] loaded HEAD from S17 (vec_in norm=1.326925)
[S5] cosine check vs S17: cos=0.7669
[S5] BUFFERED delta from S17 (total buffered=3)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=8 metric=0.7108 head_norm=1.038960
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.179710e-01
[S13] stored merged vector for next round verification (round=8)
[S13] DEBUG after merge:  round=8 metric=0.6695 head_norm=1.068542 delta_norm=0.117971
[S13] aggregate: ROLLBACK (f1_val pre=0.711 post=0.669 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=8 metric=0.6854 head_norm=1.035325
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.021679e-01
[S4] stored merged vector for next round verification (round=8)
[S4] DEBUG after merge:  round=8 metric=0.6849 head_norm=1.058038 delta_norm=0.102168
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=8 metric=0.4175 head_norm=0.650072
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.797834e-01
[S5] stored merged vector for next round verification (round=8)
[S5] DEBUG after merge:  round=8 metric=0.2906 head_norm=0.637275 delta_norm=0.179783
[S5] aggregate: ROLLBACK (f1_val pre=0.418 post=0.291 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=8 metric=0.3552 head_norm=1.326925
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.236698e-01
[S17] stored merged vector for next round verification (round=8)
[S17] DEBUG after merge:  round=8 metric=0.3546 head_norm=1.340931 delta_norm=0.123670
[S17] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=8 metric=0.3644 head_norm=1.367560
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.297703e-01
[S16] stored merged vector for next round verification (round=8)
[S16] DEBUG after merge:  round=8 metric=0.3429 head_norm=1.427246 delta_norm=0.129770
[S16] aggregate: ROLLBACK (f1_val pre=0.364 post=0.343 tol_abs=0.005 tol_rel=0.0)
[S2] START round=9 head_norm_before_train=0.980614 cos_to_last_merge=0.9948 (last merge round=7)
[S2] round=9 local utility u=0.362915 metrics={'f1_val': 0.7001897747437624, 'auprc': 0.6531165476841323, 'loss_val': 0.8410813757896037, 'psi': 0.6813604839199103}-{'f1_val': 0.5439697730119162, 'auprc': 0.7751610344569677, 'loss_val': 0.9957255397063282, 'psi': 0.6364462775899368}
[S3] START round=9 head_norm_before_train=1.434651 (no previous merge yet)
[S3] round=9 local utility u=0.886514 metrics={'f1_val': 0.554638126009132, 'auprc': 0.9909517948547573, 'loss_val': 0.5866561517458897, 'psi': 0.7291635935473821}-{'f1_val': 0.401708470248874, 'auprc': 0.7706872227019049, 'loss_val': 0.7813128715550264, 'psi': 0.5492999712300863}
[S4] START round=9 head_norm_before_train=1.058038 cos_to_last_merge=1.0000 (last merge round=8)
[S4] round=9 local utility u=0.014924 metrics={'f1_val': 0.6710192593098152, 'auprc': 0.7712038799143309, 'loss_val': 0.7638846935934469, 'psi': 0.7110931075516216}-{'f1_val': 0.6854292031867004, 'auprc': 0.7859936802555869, 'loss_val': 0.9245610217667245, 'psi': 0.725654994014255}
[S5] START round=9 head_norm_before_train=0.637275 cos_to_last_merge=1.0000 (last merge round=8)
[S5] round=9 local utility u=0.155047 metrics={'f1_val': 0.4173865207428088, 'auprc': 0.7694800579116814, 'loss_val': 1.0176809767716253, 'psi': 0.5582239356103578}-{'f1_val': 0.41750764008433106, 'auprc': 0.6715596427408905, 'loss_val': 1.0347414003089643, 'psi': 0.5191284411469548}
[S6] START round=9 head_norm_before_train=1.089893 cos_to_last_merge=0.9462 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.946
[S6] round=9 local utility u=0.000000 metrics={'f1_val': 0.4173360362516195, 'auprc': 0.8494233313883383, 'loss_val': 0.6401460955365794, 'psi': 0.590170954306307}-{'f1_val': 0.416130594159999, 'auprc': 0.9684233274694061, 'loss_val': 0.7208731665677083, 'psi': 0.6370476874837618}
[S7] START round=9 head_norm_before_train=1.366034 (no previous merge yet)
[S7] round=9 local utility u=0.000000 metrics={'f1_val': 0.6749339787076335, 'auprc': 0.7945576398303786, 'loss_val': 0.7688439386088834, 'psi': 0.7227834431567316}-{'f1_val': 0.7117348912141701, 'auprc': 0.794612984178739, 'loss_val': 0.8329374954931202, 'psi': 0.7448861283999977}
[S8] START round=9 head_norm_before_train=1.053062 cos_to_last_merge=0.9148 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.915
[S8] round=9 local utility u=0.580256 metrics={'f1_val': 0.3728649953480749, 'auprc': 0.9918330812357816, 'loss_val': 0.670158160513424, 'psi': 0.6204522297031576}-{'f1_val': 0.3731322377369826, 'auprc': 0.6457717688186778, 'loss_val': 0.7940891349667822, 'psi': 0.4821880501696607}
[S9] START round=9 head_norm_before_train=1.132973 cos_to_last_merge=0.9392 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.939
[S9] round=9 local utility u=0.083225 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.9989389266356066, 'loss_val': 0.4200628689243706, 'psi': 0.8203943712857482}-{'f1_val': 0.7016893154854569, 'auprc': 0.999582772816428, 'loss_val': 0.5903916639248208, 'psi': 0.8208466984178453}
[S10] START round=9 head_norm_before_train=1.495836 (no previous merge yet)
[S10] round=9 local utility u=0.090678 metrics={'f1_val': 0.6981485403350558, 'auprc': 0.9979276005412387, 'loss_val': 0.4857066014971116, 'psi': 0.8180601644175289}-{'f1_val': 0.6912271661463085, 'auprc': 0.9884468655792802, 'loss_val': 0.5970924249996931, 'psi': 0.8101150459194972}
[S11] START round=9 head_norm_before_train=1.109937 cos_to_last_merge=0.9231 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.923
[S11] round=9 local utility u=0.062954 metrics={'f1_val': 0.3996834959227125, 'auprc': 0.9939143766617823, 'loss_val': 0.6768633613359287, 'psi': 0.6373758482183405}-{'f1_val': 0.39651855440916606, 'auprc': 0.9970993354205065, 'loss_val': 0.7933359319527259, 'psi': 0.6367508668137023}
[S13] START round=9 head_norm_before_train=1.068542 cos_to_last_merge=1.0000 (last merge round=8)
[S13] round=9 local utility u=0.029250 metrics={'f1_val': 0.7109359514561793, 'auprc': 0.7204912216645446, 'loss_val': 0.847773945022002, 'psi': 0.7147580595395254}-{'f1_val': 0.7108279090934471, 'auprc': 0.7301359015412502, 'loss_val': 0.9345594078519883, 'psi': 0.7185511060725683}
[S14] START round=9 head_norm_before_train=0.814158 cos_to_last_merge=0.9072 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.907
[S14] round=9 local utility u=0.163135 metrics={'f1_val': 0.39649470961585787, 'auprc': 0.9499747096317889, 'loss_val': 0.8311106220323639, 'psi': 0.6178867096222302}-{'f1_val': 0.39652757107859105, 'auprc': 0.8869318084986343, 'loss_val': 0.9684488944880195, 'psi': 0.5926892660466083}
[S15] START round=9 head_norm_before_train=1.502567 (no previous merge yet)
[S15] round=9 local utility u=0.299673 metrics={'f1_val': 0.7005365419383979, 'auprc': 0.9842254061571877, 'loss_val': 0.45775481918120253, 'psi': 0.8140120876259138}-{'f1_val': 0.7058042115664355, 'auprc': 0.7980348153250442, 'loss_val': 0.5301346181378729, 'psi': 0.742696453069879}
[S16] START round=9 head_norm_before_train=1.427246 cos_to_last_merge=1.0000 (last merge round=8)
[S16] round=9 local utility u=0.238985 metrics={'f1_val': 0.43334710946899907, 'auprc': 0.7229413988858877, 'loss_val': 0.9068734396280128, 'psi': 0.5491848252357545}-{'f1_val': 0.3644418328596322, 'auprc': 0.7153085411575856, 'loss_val': 0.9485124292909277, 'psi': 0.5047885161788136}
[S17] START round=9 head_norm_before_train=1.340931 cos_to_last_merge=1.0000 (last merge round=8)
[S17] round=9 local utility u=0.000000 metrics={'f1_val': 0.3558460063236105, 'auprc': 0.541565786998643, 'loss_val': 0.8606266421682995, 'psi': 0.4301339185936235}-{'f1_val': 0.3552057631585315, 'auprc': 0.8071642107686513, 'loss_val': 0.8768868250236841, 'psi': 0.5359891422025794}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:31612
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:31611
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:31604
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S13@127.0.0.1:31613
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:31617
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:31615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:31616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:31605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:31611
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:31609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S16] → sending delta(kind=head bytes=1807) to S2@127.0.0.1:31602
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S13] → sending delta(kind=head bytes=1790) to S5@127.0.0.1:31605
[S2] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1790 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1807 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S3] sending update (kind=head size=1805 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1799) from S9
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.197495)
[S4] loaded HEAD from S9 (vec_in norm=1.197495)
[S4] cosine check vs S9: cos=-0.0488
[S4] DROPPED delta from S9 (cos=-0.0488 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1795) from S4
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.097188)
[S5] loaded HEAD from S4 (vec_in norm=1.097188)
[S5] cosine check vs S4: cos=0.5477
[S5] BUFFERED delta from S4 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1797) from S10
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.547206)
[S16] loaded HEAD from S10 (vec_in norm=1.547206)
[S16] cosine check vs S10: cos=0.9910
[S16] BUFFERED delta from S10 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1799) from S5
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.662520)
[S10] loaded HEAD from S5 (vec_in norm=0.662520)
[S10] cosine check vs S5: cos=-0.1079
[S10] DROPPED delta from S5 (cos=-0.1079 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1794) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.163998)
[S13] loaded HEAD from S11 (vec_in norm=1.163998)
[S13] cosine check vs S11: cos=0.9794
[S13] BUFFERED delta from S11 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1800) from S15
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.544235)
[S10] loaded HEAD from S15 (vec_in norm=1.544235)
[S10] cosine check vs S15: cos=-0.1375
[S10] DROPPED delta from S15 (cos=-0.1375 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1797) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.105935)
[S17] loaded HEAD from S8 (vec_in norm=1.105935)
[S17] cosine check vs S8: cos=-0.0278
[S17] DROPPED delta from S8 (cos=-0.0278 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1796) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.874376)
[S15] loaded HEAD from S14 (vec_in norm=0.874376)
[S15] cosine check vs S14: cos=-0.0497
[S15] DROPPED delta from S14 (cos=-0.0497 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1807) from S16
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.458029)
[S2] loaded HEAD from S16 (vec_in norm=1.458029)
[S2] cosine check vs S16: cos=0.8532
[S2] BUFFERED delta from S16 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1805) from S3
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.476543)
[S8] loaded HEAD from S3 (vec_in norm=1.476543)
[S8] cosine check vs S3: cos=-0.0484
[S8] DROPPED delta from S3 (cos=-0.0484 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1790) from S13
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.104745)
[S5] loaded HEAD from S13 (vec_in norm=1.104745)
[S5] cosine check vs S13: cos=0.3978
[S5] BUFFERED delta from S13 (total buffered=2)
[S11] RECEIVED delta(kind=head bytes=1798) from S2
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.019385)
[S11] loaded HEAD from S2 (vec_in norm=1.019385)
[S11] cosine check vs S2: cos=-0.0186
[S11] DROPPED delta from S2 (cos=-0.0186 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=9 metric=0.7002 head_norm=1.019385
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.964819e-01
[S2] stored merged vector for next round verification (round=9)
[S2] DEBUG after merge:  round=9 metric=0.6991 head_norm=1.193859 delta_norm=0.396482
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=9 metric=0.4174 head_norm=0.662520
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.003747e-01
[S5] stored merged vector for next round verification (round=9)
[S5] DEBUG after merge:  round=9 metric=0.4174 head_norm=0.659453 delta_norm=0.300375
[S5] aggregate: ACCEPT kept=['S4', 'S13'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=9 metric=0.4333 head_norm=1.458029
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.100076e-01
[S16] stored merged vector for next round verification (round=9)
[S16] DEBUG after merge:  round=9 metric=0.4313 head_norm=1.499248 delta_norm=0.110008
[S16] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=9 metric=0.7109 head_norm=1.104745
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.187775e-01
[S13] stored merged vector for next round verification (round=9)
[S13] DEBUG after merge:  round=9 metric=0.6879 head_norm=1.128525 delta_norm=0.118777
[S13] aggregate: ROLLBACK (f1_val pre=0.711 post=0.688 tol_abs=0.005 tol_rel=0.0)
[S2] START round=10 head_norm_before_train=1.193859 cos_to_last_merge=1.0000 (last merge round=9)
[S2] round=10 local utility u=0.179252 metrics={'f1_val': 0.7053915477898174, 'auprc': 0.7606595706084951, 'loss_val': 0.8364164269198835, 'psi': 0.7274987569172884}-{'f1_val': 0.7001897747437624, 'auprc': 0.6531165476841323, 'loss_val': 0.8410813757896037, 'psi': 0.6813604839199103}
[S3] START round=10 head_norm_before_train=1.476543 (no previous merge yet)
[S3] round=10 local utility u=0.000000 metrics={'f1_val': 0.5489540391093929, 'auprc': 0.989105479577627, 'loss_val': 0.5590737644208026, 'psi': 0.7250146152966865}-{'f1_val': 0.554638126009132, 'auprc': 0.9909517948547573, 'loss_val': 0.5866561517458897, 'psi': 0.7291635935473821}
[S4] START round=10 head_norm_before_train=1.097188 cos_to_last_merge=0.9965 (last merge round=8)
[S4] round=10 local utility u=0.000000 metrics={'f1_val': 0.6692857764842889, 'auprc': 0.6616487325946052, 'loss_val': 0.6212329134048272, 'psi': 0.6662309589284154}-{'f1_val': 0.6710192593098152, 'auprc': 0.7712038799143309, 'loss_val': 0.7638846935934469, 'psi': 0.7110931075516216}
[S5] START round=10 head_norm_before_train=0.659453 cos_to_last_merge=1.0000 (last merge round=9)
[S5] round=10 local utility u=0.037793 metrics={'f1_val': 0.4173865207428088, 'auprc': 0.7982153434819914, 'loss_val': 1.0283011795234274, 'psi': 0.5697180498384818}-{'f1_val': 0.4173865207428088, 'auprc': 0.7694800579116814, 'loss_val': 1.0176809767716253, 'psi': 0.5582239356103578}
[S6] START round=10 head_norm_before_train=1.132646 cos_to_last_merge=0.9353 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.935
[S6] round=10 local utility u=1.000000 metrics={'f1_val': 0.6940971663114985, 'auprc': 0.9549213951319017, 'loss_val': 0.5519789447697678, 'psi': 0.7984268578396598}-{'f1_val': 0.4173360362516195, 'auprc': 0.8494233313883383, 'loss_val': 0.6401460955365794, 'psi': 0.590170954306307}
[S7] START round=10 head_norm_before_train=1.395492 (no previous merge yet)
[S7] round=10 local utility u=0.022135 metrics={'f1_val': 0.6829741709362386, 'auprc': 0.789205187954956, 'loss_val': 0.7567570707871163, 'psi': 0.7254665777437256}-{'f1_val': 0.6749339787076335, 'auprc': 0.7945576398303786, 'loss_val': 0.7688439386088834, 'psi': 0.7227834431567316}
[S8] START round=10 head_norm_before_train=1.105935 cos_to_last_merge=0.8961 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.896
[S8] round=10 local utility u=0.871907 metrics={'f1_val': 0.6511086065677163, 'auprc': 0.9918586181057591, 'loss_val': 0.5958832521196485, 'psi': 0.7874086111829335}-{'f1_val': 0.3728649953480749, 'auprc': 0.9918330812357816, 'loss_val': 0.670158160513424, 'psi': 0.6204522297031576}
[S9] START round=10 head_norm_before_train=1.197495 cos_to_last_merge=0.9239 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.924
[S9] round=10 local utility u=0.048910 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.998614255701066, 'loss_val': 0.3212680356842931, 'psi': 0.820264502911932}-{'f1_val': 0.7013646677191758, 'auprc': 0.9989389266356066, 'loss_val': 0.4200628689243706, 'psi': 0.8203943712857482}
[S10] START round=10 head_norm_before_train=1.547206 (no previous merge yet)
[S10] round=10 local utility u=0.074138 metrics={'f1_val': 0.6997590954597954, 'auprc': 0.998279793021378, 'loss_val': 0.348151093176346, 'psi': 0.8191673744844286}-{'f1_val': 0.6981485403350558, 'auprc': 0.9979276005412387, 'loss_val': 0.4857066014971116, 'psi': 0.8180601644175289}
[S11] START round=10 head_norm_before_train=1.163998 cos_to_last_merge=0.9061 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.906
[S11] round=10 local utility u=0.836998 metrics={'f1_val': 0.6527883096563121, 'auprc': 0.9953619544303707, 'loss_val': 0.5258391796808841, 'psi': 0.7898177675659355}-{'f1_val': 0.3996834959227125, 'auprc': 0.9939143766617823, 'loss_val': 0.6768633613359287, 'psi': 0.6373758482183405}
[S13] START round=10 head_norm_before_train=1.128525 cos_to_last_merge=1.0000 (last merge round=9)
[S13] round=10 local utility u=0.000000 metrics={'f1_val': 0.6164498135982872, 'auprc': 0.733664445566802, 'loss_val': 0.7997263687343609, 'psi': 0.6633356663856931}-{'f1_val': 0.7109359514561793, 'auprc': 0.7204912216645446, 'loss_val': 0.847773945022002, 'psi': 0.7147580595395254}
[S14] START round=10 head_norm_before_train=0.874376 cos_to_last_merge=0.8835 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.883
[S14] round=10 local utility u=0.126197 metrics={'f1_val': 0.39656053564365834, 'auprc': 0.9956833569662613, 'loss_val': 0.7162367000258095, 'psi': 0.6362096641726995}-{'f1_val': 0.39649470961585787, 'auprc': 0.9499747096317889, 'loss_val': 0.8311106220323639, 'psi': 0.6178867096222302}
[S15] START round=10 head_norm_before_train=1.544235 (no previous merge yet)
[S15] round=10 local utility u=0.051798 metrics={'f1_val': 0.6994814781592046, 'auprc': 0.9922668678257676, 'loss_val': 0.3719521449466479, 'psi': 0.8165956340258298}-{'f1_val': 0.7005365419383979, 'auprc': 0.9842254061571877, 'loss_val': 0.45775481918120253, 'psi': 0.8140120876259138}
[S16] START round=10 head_norm_before_train=1.499248 cos_to_last_merge=1.0000 (last merge round=9)
[S16] round=10 local utility u=0.268548 metrics={'f1_val': 0.5098733022332826, 'auprc': 0.7500589089882981, 'loss_val': 0.910286643467435, 'psi': 0.6059475449352888}-{'f1_val': 0.43334710946899907, 'auprc': 0.7229413988858877, 'loss_val': 0.9068734396280128, 'psi': 0.5491848252357545}
[S17] START round=10 head_norm_before_train=1.376599 cos_to_last_merge=0.9978 (last merge round=8)
[S17] round=10 local utility u=0.071513 metrics={'f1_val': 0.36877026241646055, 'auprc': 0.557847394120458, 'loss_val': 0.8439902901706915, 'psi': 0.4444011150980596}-{'f1_val': 0.3558460063236105, 'auprc': 0.541565786998643, 'loss_val': 0.8606266421682995, 'psi': 0.4301339185936235}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] → sending delta(kind=head bytes=1805) to S4@127.0.0.1:31604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:31602
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:31612
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:31617
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:31611
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:31604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:31617
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:31611
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:31615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:31616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S13@127.0.0.1:31613
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1805 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1801) from S10
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.594142)
[S16] loaded HEAD from S10 (vec_in norm=1.594142)
[S16] cosine check vs S10: cos=0.9936
[S16] BUFFERED delta from S10 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1799) from S2
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.219283)
[S11] loaded HEAD from S2 (vec_in norm=1.219283)
[S11] cosine check vs S2: cos=-0.0249
[S11] DROPPED delta from S2 (cos=-0.0249 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1801) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.152634)
[S17] loaded HEAD from S8 (vec_in norm=1.152634)
[S17] cosine check vs S8: cos=-0.0208
[S17] DROPPED delta from S8 (cos=-0.0208 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1799) from S7
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.426419)
[S17] loaded HEAD from S7 (vec_in norm=1.426419)
[S17] cosine check vs S7: cos=0.9722
[S17] BUFFERED delta from S7 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1800) from S5
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.681022)
[S10] loaded HEAD from S5 (vec_in norm=0.681022)
[S10] cosine check vs S5: cos=-0.0992
[S10] DROPPED delta from S5 (cos=-0.0992 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1802) from S15
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.585673)
[S10] loaded HEAD from S15 (vec_in norm=1.585673)
[S10] cosine check vs S15: cos=-0.1363
[S10] DROPPED delta from S15 (cos=-0.1363 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1800) from S9
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.256742)
[S4] loaded HEAD from S9 (vec_in norm=1.256742)
[S4] cosine check vs S9: cos=-0.0447
[S4] DROPPED delta from S9 (cos=-0.0447 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1805) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.164813)
[S4] loaded HEAD from S6 (vec_in norm=1.164813)
[S4] cosine check vs S6: cos=0.9678
[S4] BUFFERED delta from S6 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1794) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.223402)
[S13] loaded HEAD from S11 (vec_in norm=1.223402)
[S13] cosine check vs S11: cos=0.9813
[S13] BUFFERED delta from S11 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1796) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.929172)
[S15] loaded HEAD from S14 (vec_in norm=0.929172)
[S15] cosine check vs S14: cos=-0.0502
[S15] DROPPED delta from S14 (cos=-0.0502 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1798) from S16
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.527480)
[S2] loaded HEAD from S16 (vec_in norm=1.527480)
[S2] cosine check vs S16: cos=0.9521
[S2] BUFFERED delta from S16 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:31605
[S17] sending update (kind=head size=1803 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1803) from S17
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.412550)
[S5] loaded HEAD from S17 (vec_in norm=1.412550)
[S5] cosine check vs S17: cos=0.4215
[S5] BUFFERED delta from S17 (total buffered=1)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=10 metric=0.6164 head_norm=1.160565
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.194517e-01
[S13] stored merged vector for next round verification (round=10)
[S13] DEBUG after merge:  round=10 metric=0.6643 head_norm=1.186399 delta_norm=0.119452
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.329 → S5@127.0.0.1:31605
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=10 metric=0.6693 head_norm=1.148285
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.469861e-01
[S4] stored merged vector for next round verification (round=10)
[S4] DEBUG after merge:  round=10 metric=0.6688 head_norm=1.147201 delta_norm=0.146986
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.252 → S5@127.0.0.1:31605
[S3] ⇄ pheromone p=0.352 → S8@127.0.0.1:31609
[S14] ⇄ pheromone p=0.311 → S15@127.0.0.1:31615
[S8] ⇄ pheromone p=0.490 → S17@127.0.0.1:31617
[S6] ⇄ pheromone p=0.412 → S4@127.0.0.1:31604
[S9] ⇄ pheromone p=0.363 → S4@127.0.0.1:31604
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=10 metric=0.4174 head_norm=0.681022
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.419075e-01
[S5] stored merged vector for next round verification (round=10)
[S5] DEBUG after merge:  round=10 metric=0.4174 head_norm=0.904157 delta_norm=0.641907
[S5] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.223 → S10@127.0.0.1:31611
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=10 metric=0.7054 head_norm=1.219283
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.613719e-01
[S2] stored merged vector for next round verification (round=10)
[S2] DEBUG after merge:  round=10 metric=0.7000 head_norm=1.357059 delta_norm=0.261372
[S2] aggregate: ROLLBACK (f1_val pre=0.705 post=0.700 tol_abs=0.005 tol_rel=0.0)
[S2] ⇄ pheromone p=0.345 → S11@127.0.0.1:31612
[S15] ⇄ pheromone p=0.339 → S10@127.0.0.1:31611
[S10] ⇄ pheromone p=0.374 → S16@127.0.0.1:31616
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=10 metric=0.5099 head_norm=1.527480
[S16] _apply_head_vector_avg (torch): Δ‖w‖=9.420566e-02
[S16] stored merged vector for next round verification (round=10)
[S16] DEBUG after merge:  round=10 metric=0.5029 head_norm=1.558322 delta_norm=0.094206
[S16] aggregate: ROLLBACK (f1_val pre=0.510 post=0.503 tol_abs=0.005 tol_rel=0.0)
[S16] ⇄ pheromone p=0.309 → S2@127.0.0.1:31602
[S11] ⇄ pheromone p=0.435 → S13@127.0.0.1:31613
[S7] ⇄ pheromone p=0.319 → S17@127.0.0.1:31617
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=10 metric=0.3688 head_norm=1.412550
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.673629e-01
[S17] stored merged vector for next round verification (round=10)
[S17] DEBUG after merge:  round=10 metric=0.3686 head_norm=1.409600 delta_norm=0.167363
[S17] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.227 → S5@127.0.0.1:31605
[S2] START round=11 head_norm_before_train=1.357059 cos_to_last_merge=1.0000 (last merge round=10)
[S2] round=11 local utility u=0.066595 metrics={'f1_val': 0.7136775046337285, 'auprc': 0.7776275478432149, 'loss_val': 0.8038468440459348, 'psi': 0.739257521917523}-{'f1_val': 0.7053915477898174, 'auprc': 0.7606595706084951, 'loss_val': 0.8364164269198835, 'psi': 0.7274987569172884}
[S3] START round=11 head_norm_before_train=1.520082 (no previous merge yet)
[S3] round=11 local utility u=0.206799 metrics={'f1_val': 0.601716204537875, 'auprc': 0.9922737915049167, 'loss_val': 0.47155384952862633, 'psi': 0.7579392393246918}-{'f1_val': 0.5489540391093929, 'auprc': 0.989105479577627, 'loss_val': 0.5590737644208026, 'psi': 0.7250146152966865}
[S4] START round=11 head_norm_before_train=1.147201 cos_to_last_merge=1.0000 (last merge round=10)
[S4] round=11 local utility u=0.180226 metrics={'f1_val': 0.6668268102086911, 'auprc': 0.7693828386746785, 'loss_val': 0.5692288080561485, 'psi': 0.707849221595086}-{'f1_val': 0.6692857764842889, 'auprc': 0.6616487325946052, 'loss_val': 0.6212329134048272, 'psi': 0.6662309589284154}
[S5] START round=11 head_norm_before_train=0.904157 cos_to_last_merge=1.0000 (last merge round=10)
[S5] round=11 local utility u=0.165836 metrics={'f1_val': 0.4174665005497404, 'auprc': 0.8641982274953507, 'loss_val': 0.8950578845649333, 'psi': 0.5961591913279846}-{'f1_val': 0.4173865207428088, 'auprc': 0.7982153434819914, 'loss_val': 1.0283011795234274, 'psi': 0.5697180498384818}
[S6] START round=11 head_norm_before_train=1.164813 cos_to_last_merge=0.9280 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.928
[S6] round=11 local utility u=0.011567 metrics={'f1_val': 0.6936801061539295, 'auprc': 0.9550269031110248, 'loss_val': 0.526659942331654, 'psi': 0.7982188249367677}-{'f1_val': 0.6940971663114985, 'auprc': 0.9549213951319017, 'loss_val': 0.5519789447697678, 'psi': 0.7984268578396598}
[S7] START round=11 head_norm_before_train=1.426419 (no previous merge yet)
[S7] round=11 local utility u=0.093370 metrics={'f1_val': 0.7142026337939525, 'auprc': 0.7886320806536479, 'loss_val': 0.7556676687695749, 'psi': 0.7439744125378307}-{'f1_val': 0.6829741709362386, 'auprc': 0.789205187954956, 'loss_val': 0.7567570707871163, 'psi': 0.7254665777437256}
[S8] START round=11 head_norm_before_train=1.152634 cos_to_last_merge=0.8791 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.879
[S8] round=11 local utility u=0.281340 metrics={'f1_val': 0.7134720232714203, 'auprc': 0.9948599486529034, 'loss_val': 0.41638798384814263, 'psi': 0.8260271934240135}-{'f1_val': 0.6511086065677163, 'auprc': 0.9918586181057591, 'loss_val': 0.5958832521196485, 'psi': 0.7874086111829335}
[S9] START round=11 head_norm_before_train=1.256742 cos_to_last_merge=0.9092 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.909
[S9] round=11 local utility u=0.028843 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9982371016482525, 'loss_val': 0.2620045202886736, 'psi': 0.820069130783839}-{'f1_val': 0.7013646677191758, 'auprc': 0.998614255701066, 'loss_val': 0.3212680356842931, 'psi': 0.820264502911932}
[S10] START round=11 head_norm_before_train=1.594142 (no previous merge yet)
[S10] round=11 local utility u=0.000000 metrics={'f1_val': 0.6892437201687182, 'auprc': 0.988332775056016, 'loss_val': 0.286980212715598, 'psi': 0.8088793421236373}-{'f1_val': 0.6997590954597954, 'auprc': 0.998279793021378, 'loss_val': 0.348151093176346, 'psi': 0.8191673744844286}
[S11] START round=11 head_norm_before_train=1.223402 cos_to_last_merge=0.8896 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.890
[S11] round=11 local utility u=0.212468 metrics={'f1_val': 0.7020007759458987, 'auprc': 0.9982816444653726, 'loss_val': 0.4049369352743996, 'psi': 0.8205131233536882}-{'f1_val': 0.6527883096563121, 'auprc': 0.9953619544303707, 'loss_val': 0.5258391796808841, 'psi': 0.7898177675659355}
[S13] START round=11 head_norm_before_train=1.186399 cos_to_last_merge=1.0000 (last merge round=10)
[S13] round=11 local utility u=0.000000 metrics={'f1_val': 0.6215386398782231, 'auprc': 0.5959356571516023, 'loss_val': 0.7966602642043848, 'psi': 0.6112974467875748}-{'f1_val': 0.6164498135982872, 'auprc': 0.733664445566802, 'loss_val': 0.7997263687343609, 'psi': 0.6633356663856931}
[S14] START round=11 head_norm_before_train=0.929172 cos_to_last_merge=0.8628 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.863
[S14] round=11 local utility u=0.043819 metrics={'f1_val': 0.39659360338126215, 'auprc': 0.9971603893155143, 'loss_val': 0.6332280814074553, 'psi': 0.6368203177549631}-{'f1_val': 0.39656053564365834, 'auprc': 0.9956833569662613, 'loss_val': 0.7162367000258095, 'psi': 0.6362096641726995}
[S15] START round=11 head_norm_before_train=1.585673 (no previous merge yet)
[S15] round=11 local utility u=0.080147 metrics={'f1_val': 0.7049030959673371, 'auprc': 0.9982935187728682, 'loss_val': 0.2622668513722931, 'psi': 0.8222592650895495}-{'f1_val': 0.6994814781592046, 'auprc': 0.9922668678257676, 'loss_val': 0.3719521449466479, 'psi': 0.8165956340258298}
[S16] START round=11 head_norm_before_train=1.558322 cos_to_last_merge=1.0000 (last merge round=10)
[S16] round=11 local utility u=0.000000 metrics={'f1_val': 0.37392220147079364, 'auprc': 0.7297282232005284, 'loss_val': 0.8663643931231152, 'psi': 0.5162446101626876}-{'f1_val': 0.5098733022332826, 'auprc': 0.7500589089882981, 'loss_val': 0.910286643467435, 'psi': 0.6059475449352888}
[S17] START round=11 head_norm_before_train=1.409600 cos_to_last_merge=1.0000 (last merge round=10)
[S17] round=11 local utility u=0.282685 metrics={'f1_val': 0.37614587802988747, 'auprc': 0.7073420624242807, 'loss_val': 0.7713574737595028, 'psi': 0.5086243517876448}-{'f1_val': 0.36877026241646055, 'auprc': 0.557847394120458, 'loss_val': 0.8439902901706915, 'psi': 0.4444011150980596}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S10@127.0.0.1:31611
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:31613
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:31605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:31617
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:31609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:31604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:31604
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:31612
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:31617
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:31611
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:31615
[S8] sending update (kind=head size=1804 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1799) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.982554)
[S15] loaded HEAD from S14 (vec_in norm=0.982554)
[S15] cosine check vs S14: cos=-0.0508
[S15] DROPPED delta from S14 (cos=-0.0508 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1798) from S9
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.310128)
[S4] loaded HEAD from S9 (vec_in norm=1.310128)
[S4] cosine check vs S9: cos=-0.0534
[S4] DROPPED delta from S9 (cos=-0.0534 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1803) from S3
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.561571)
[S8] loaded HEAD from S3 (vec_in norm=1.561571)
[S8] cosine check vs S3: cos=-0.0676
[S8] DROPPED delta from S3 (cos=-0.0676 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1804) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.194705)
[S17] loaded HEAD from S8 (vec_in norm=1.194705)
[S17] cosine check vs S8: cos=-0.0196
[S17] DROPPED delta from S8 (cos=-0.0196 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1804) from S7
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.453211)
[S17] loaded HEAD from S7 (vec_in norm=1.453211)
[S17] cosine check vs S7: cos=0.9857
[S17] BUFFERED delta from S7 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1801) from S2
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.379188)
[S11] loaded HEAD from S2 (vec_in norm=1.379188)
[S11] cosine check vs S2: cos=-0.0214
[S11] DROPPED delta from S2 (cos=-0.0214 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1801) from S4
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.196142)
[S5] loaded HEAD from S4 (vec_in norm=1.196142)
[S5] cosine check vs S4: cos=0.3020
[S5] BUFFERED delta from S4 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1798) from S15
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.620658)
[S10] loaded HEAD from S15 (vec_in norm=1.620658)
[S10] cosine check vs S15: cos=-0.1338
[S10] DROPPED delta from S15 (cos=-0.1338 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1794) from S5
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.935283)
[S10] loaded HEAD from S5 (vec_in norm=0.935283)
[S10] cosine check vs S5: cos=-0.0915
[S10] DROPPED delta from S5 (cos=-0.0915 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1799) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.197956)
[S4] loaded HEAD from S6 (vec_in norm=1.197956)
[S4] cosine check vs S6: cos=0.9805
[S4] BUFFERED delta from S6 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1800) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.283568)
[S13] loaded HEAD from S11 (vec_in norm=1.283568)
[S13] cosine check vs S11: cos=0.9826
[S13] BUFFERED delta from S11 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:31605
[S17] sending update (kind=head size=1801 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1801) from S17
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.436134)
[S5] loaded HEAD from S17 (vec_in norm=1.436134)
[S5] cosine check vs S17: cos=0.9299
[S5] BUFFERED delta from S17 (total buffered=2)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=11 metric=0.6215 head_norm=1.217610
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.213363e-01
[S13] stored merged vector for next round verification (round=11)
[S13] DEBUG after merge:  round=11 metric=0.6117 head_norm=1.245126 delta_norm=0.121336
[S13] aggregate: ROLLBACK (f1_val pre=0.622 post=0.612 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=11 metric=0.6668 head_norm=1.196142
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.181962e-01
[S4] stored merged vector for next round verification (round=11)
[S4] DEBUG after merge:  round=11 metric=0.6668 head_norm=1.191200 delta_norm=0.118196
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=11 metric=0.4175 head_norm=0.935283
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.389877e-01
[S5] stored merged vector for next round verification (round=11)
[S5] DEBUG after merge:  round=11 metric=0.4177 head_norm=0.922263 delta_norm=0.238988
[S5] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=11 metric=0.3761 head_norm=1.436134
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.224644e-01
[S17] stored merged vector for next round verification (round=11)
[S17] DEBUG after merge:  round=11 metric=0.4431 head_norm=1.439498 delta_norm=0.122464
[S17] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.379188 cos_to_last_merge=0.9966 (last merge round=10)
[S2] round=12 local utility u=0.000000 metrics={'f1_val': 0.6784808161912476, 'auprc': 0.6400186537425161, 'loss_val': 0.7074096073455403, 'psi': 0.6630959512117549}-{'f1_val': 0.7136775046337285, 'auprc': 0.7776275478432149, 'loss_val': 0.8038468440459348, 'psi': 0.739257521917523}
[S3] START round=12 head_norm_before_train=1.561571 (no previous merge yet)
[S3] round=12 local utility u=0.156017 metrics={'f1_val': 0.6396318240986607, 'auprc': 0.9912243433527499, 'loss_val': 0.383865646157522, 'psi': 0.7802688318002964}-{'f1_val': 0.601716204537875, 'auprc': 0.9922737915049167, 'loss_val': 0.47155384952862633, 'psi': 0.7579392393246918}
[S4] START round=12 head_norm_before_train=1.191200 cos_to_last_merge=1.0000 (last merge round=11)
[S4] round=12 local utility u=0.000000 metrics={'f1_val': 0.666610058359576, 'auprc': 0.6593411696094751, 'loss_val': 0.5363357237256974, 'psi': 0.6637025028595356}-{'f1_val': 0.6668268102086911, 'auprc': 0.7693828386746785, 'loss_val': 0.5692288080561485, 'psi': 0.707849221595086}
[S5] START round=12 head_norm_before_train=0.922263 cos_to_last_merge=1.0000 (last merge round=11)
[S5] round=12 local utility u=0.002847 metrics={'f1_val': 0.4174665005497404, 'auprc': 0.8586430677872593, 'loss_val': 0.872698767182299, 'psi': 0.593937127444748}-{'f1_val': 0.4174665005497404, 'auprc': 0.8641982274953507, 'loss_val': 0.8950578845649333, 'psi': 0.5961591913279846}
[S6] START round=12 head_norm_before_train=1.197956 cos_to_last_merge=0.9210 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.921
[S6] round=12 local utility u=0.042092 metrics={'f1_val': 0.69473569377108, 'auprc': 0.9568494443707759, 'loss_val': 0.45427801131436796, 'psi': 0.7995811940109583}-{'f1_val': 0.6936801061539295, 'auprc': 0.9550269031110248, 'loss_val': 0.526659942331654, 'psi': 0.7982188249367677}
[S7] START round=12 head_norm_before_train=1.453211 (no previous merge yet)
[S7] round=12 local utility u=0.000000 metrics={'f1_val': 0.6807935519193107, 'auprc': 0.7824585831417216, 'loss_val': 0.708770541769815, 'psi': 0.7214595644082751}-{'f1_val': 0.7142026337939525, 'auprc': 0.7886320806536479, 'loss_val': 0.7556676687695749, 'psi': 0.7439744125378307}
[S8] START round=12 head_norm_before_train=1.194705 cos_to_last_merge=0.8642 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.864
[S8] round=12 local utility u=0.000000 metrics={'f1_val': 0.6633851435031501, 'auprc': 0.9946565728537033, 'loss_val': 0.42015113207127425, 'psi': 0.7958937152433714}-{'f1_val': 0.7134720232714203, 'auprc': 0.9948599486529034, 'loss_val': 0.41638798384814263, 'psi': 0.8260271934240135}
[S9] START round=12 head_norm_before_train=1.310128 cos_to_last_merge=0.8963 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.896
[S9] round=12 local utility u=0.000000 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9681545270090217, 'loss_val': 0.28327199008589643, 'psi': 0.8079917592676198}-{'f1_val': 0.7012904835408967, 'auprc': 0.9982371016482525, 'loss_val': 0.2620045202886736, 'psi': 0.820069130783839}
[S10] START round=12 head_norm_before_train=1.632863 (no previous merge yet)
[S10] round=12 local utility u=0.076830 metrics={'f1_val': 0.6996640466857562, 'auprc': 0.997956846124748, 'loss_val': 0.22471423742231436, 'psi': 0.8189811664613529}-{'f1_val': 0.6892437201687182, 'auprc': 0.988332775056016, 'loss_val': 0.286980212715598, 'psi': 0.8088793421236373}
[S11] START round=12 head_norm_before_train=1.283568 cos_to_last_merge=0.8745 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.874
[S11] round=12 local utility u=0.819978 metrics={'f1_val': 0.9578276111022713, 'auprc': 0.9971073628987633, 'loss_val': 0.2964187906615602, 'psi': 0.9735395118208682}-{'f1_val': 0.7020007759458987, 'auprc': 0.9982816444653726, 'loss_val': 0.4049369352743996, 'psi': 0.8205131233536882}
[S13] START round=12 head_norm_before_train=1.245126 cos_to_last_merge=1.0000 (last merge round=11)
[S13] round=12 local utility u=0.130544 metrics={'f1_val': 0.626212936524196, 'auprc': 0.6509170677191831, 'loss_val': 0.7285632406760651, 'psi': 0.6360945890021908}-{'f1_val': 0.6215386398782231, 'auprc': 0.5959356571516023, 'loss_val': 0.7966602642043848, 'psi': 0.6112974467875748}
[S14] START round=12 head_norm_before_train=0.982554 cos_to_last_merge=0.8443 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.844
[S14] round=12 local utility u=0.030836 metrics={'f1_val': 0.39659360338126215, 'auprc': 0.997159862679694, 'loss_val': 0.5715541876584523, 'psi': 0.6368201071006349}-{'f1_val': 0.39659360338126215, 'auprc': 0.9971603893155143, 'loss_val': 0.6332280814074553, 'psi': 0.6368203177549631}
[S15] START round=12 head_norm_before_train=1.620658 (no previous merge yet)
[S15] round=12 local utility u=0.000000 metrics={'f1_val': 0.6978723129683013, 'auprc': 0.9300709173127464, 'loss_val': 0.3376322965144986, 'psi': 0.7907517547060794}-{'f1_val': 0.7049030959673371, 'auprc': 0.9982935187728682, 'loss_val': 0.2622668513722931, 'psi': 0.8222592650895495}
[S16] START round=12 head_norm_before_train=1.582693 cos_to_last_merge=0.9994 (last merge round=10)
[S16] round=12 local utility u=0.730597 metrics={'f1_val': 0.5886189409758894, 'auprc': 0.7543158079971699, 'loss_val': 0.7671133394130839, 'psi': 0.6548976877844016}-{'f1_val': 0.37392220147079364, 'auprc': 0.7297282232005284, 'loss_val': 0.8663643931231152, 'psi': 0.5162446101626876}
[S17] START round=12 head_norm_before_train=1.439498 cos_to_last_merge=1.0000 (last merge round=11)
[S17] round=12 local utility u=0.359076 metrics={'f1_val': 0.502470836673779, 'auprc': 0.6557146620903125, 'loss_val': 0.6562734025779166, 'psi': 0.5637683668403923}-{'f1_val': 0.37614587802988747, 'auprc': 0.7073420624242807, 'loss_val': 0.7713574737595028, 'psi': 0.5086243517876448}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:31616
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] → sending delta(kind=head bytes=1792) to S10@127.0.0.1:31611
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:31604
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:31609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:31615
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:31605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:31602
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:31613
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:31605
[S10] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1792 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1798) from S13
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.274749)
[S5] loaded HEAD from S13 (vec_in norm=1.274749)
[S5] cosine check vs S13: cos=0.1313
[S5] BUFFERED delta from S13 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1803) from S3
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.598862)
[S8] loaded HEAD from S3 (vec_in norm=1.598862)
[S8] cosine check vs S3: cos=-0.0760
[S8] DROPPED delta from S3 (cos=-0.0760 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1803) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.341800)
[S13] loaded HEAD from S11 (vec_in norm=1.341800)
[S13] cosine check vs S11: cos=0.9856
[S13] BUFFERED delta from S11 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1797) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.231935)
[S4] loaded HEAD from S6 (vec_in norm=1.231935)
[S4] cosine check vs S6: cos=0.9858
[S4] BUFFERED delta from S6 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1803) from S16
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.607246)
[S2] loaded HEAD from S16 (vec_in norm=1.607246)
[S2] cosine check vs S16: cos=0.9598
[S2] BUFFERED delta from S16 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1801) from S10
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.666623)
[S16] loaded HEAD from S10 (vec_in norm=1.666623)
[S16] cosine check vs S10: cos=0.9907
[S16] BUFFERED delta from S10 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1792) from S5
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.951201)
[S10] loaded HEAD from S5 (vec_in norm=0.951201)
[S10] cosine check vs S5: cos=-0.0943
[S10] DROPPED delta from S5 (cos=-0.0943 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1799) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.027009)
[S15] loaded HEAD from S14 (vec_in norm=1.027009)
[S15] cosine check vs S14: cos=-0.0524
[S15] DROPPED delta from S14 (cos=-0.0524 < 0.0)
[S17] sending update (kind=head size=1794 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1794) from S17
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.462019)
[S5] loaded HEAD from S17 (vec_in norm=1.462019)
[S5] cosine check vs S17: cos=0.8798
[S5] BUFFERED delta from S17 (total buffered=2)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=12 metric=0.6785 head_norm=1.411157
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.349997e-01
[S2] stored merged vector for next round verification (round=12)
[S2] DEBUG after merge:  round=12 metric=0.6676 head_norm=1.494014 delta_norm=0.235000
[S2] aggregate: ROLLBACK (f1_val pre=0.678 post=0.668 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=12 metric=0.6666 head_norm=1.238261
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.040728e-01
[S4] stored merged vector for next round verification (round=12)
[S4] DEBUG after merge:  round=12 metric=0.6666 head_norm=1.230709 delta_norm=0.104073
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=12 metric=0.5886 head_norm=1.607246
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.153273e-01
[S16] stored merged vector for next round verification (round=12)
[S16] DEBUG after merge:  round=12 metric=0.4415 head_norm=1.633137 delta_norm=0.115327
[S16] aggregate: ROLLBACK (f1_val pre=0.589 post=0.442 tol_abs=0.005 tol_rel=0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=12 metric=0.6262 head_norm=1.274749
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.158247e-01
[S13] stored merged vector for next round verification (round=12)
[S13] DEBUG after merge:  round=12 metric=0.6082 head_norm=1.303569 delta_norm=0.115825
[S13] aggregate: ROLLBACK (f1_val pre=0.626 post=0.608 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=12 metric=0.4175 head_norm=0.951201
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.513453e-01
[S5] stored merged vector for next round verification (round=12)
[S5] DEBUG after merge:  round=12 metric=0.4176 head_norm=0.902678 delta_norm=0.351345
[S5] aggregate: ACCEPT kept=['S13', 'S17'] (k=2/2) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.494014 cos_to_last_merge=1.0000 (last merge round=12)
[S2] round=13 local utility u=0.205328 metrics={'f1_val': 0.7000291766083584, 'auprc': 0.6940968843760844, 'loss_val': 0.5882789254182702, 'psi': 0.6976562597154488}-{'f1_val': 0.6784808161912476, 'auprc': 0.6400186537425161, 'loss_val': 0.7074096073455403, 'psi': 0.6630959512117549}
[S3] START round=13 head_norm_before_train=1.598862 (no previous merge yet)
[S3] round=13 local utility u=0.000000 metrics={'f1_val': 0.5590211801976508, 'auprc': 0.9458568161465815, 'loss_val': 0.47720934824817185, 'psi': 0.713755434577223}-{'f1_val': 0.6396318240986607, 'auprc': 0.9912243433527499, 'loss_val': 0.383865646157522, 'psi': 0.7802688318002964}
[S4] START round=13 head_norm_before_train=1.230709 cos_to_last_merge=1.0000 (last merge round=12)
[S4] round=13 local utility u=0.006094 metrics={'f1_val': 0.6675862917279285, 'auprc': 0.6597738573962518, 'loss_val': 0.5313028316377933, 'psi': 0.6644613179952579}-{'f1_val': 0.666610058359576, 'auprc': 0.6593411696094751, 'loss_val': 0.5363357237256974, 'psi': 0.6637025028595356}
[S5] START round=13 head_norm_before_train=0.902678 cos_to_last_merge=1.0000 (last merge round=12)
[S5] round=13 local utility u=0.009654 metrics={'f1_val': 0.41758505646266003, 'auprc': 0.8571477419320107, 'loss_val': 0.8496162916323722, 'psi': 0.5934101306504003}-{'f1_val': 0.4174665005497404, 'auprc': 0.8586430677872593, 'loss_val': 0.872698767182299, 'psi': 0.593937127444748}
[S6] START round=13 head_norm_before_train=1.231935 cos_to_last_merge=0.9145 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.914
[S6] round=13 local utility u=0.000000 metrics={'f1_val': 0.6747855910861965, 'auprc': 0.955266856802667, 'loss_val': 0.4680408292643582, 'psi': 0.7869780973727847}-{'f1_val': 0.69473569377108, 'auprc': 0.9568494443707759, 'loss_val': 0.45427801131436796, 'psi': 0.7995811940109583}
[S7] START round=13 head_norm_before_train=1.476382 (no previous merge yet)
[S7] round=13 local utility u=0.249610 metrics={'f1_val': 0.7140699654073116, 'auprc': 0.8706851090963013, 'loss_val': 0.6738893635665979, 'psi': 0.7767160228829075}-{'f1_val': 0.6807935519193107, 'auprc': 0.7824585831417216, 'loss_val': 0.708770541769815, 'psi': 0.7214595644082751}
[S8] START round=13 head_norm_before_train=1.233005 cos_to_last_merge=0.8505 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.851
[S8] round=13 local utility u=0.208771 metrics={'f1_val': 0.7138874667974482, 'auprc': 0.9943108639798588, 'loss_val': 0.3045866405934676, 'psi': 0.8260568256704124}-{'f1_val': 0.6633851435031501, 'auprc': 0.9946565728537033, 'loss_val': 0.42015113207127425, 'psi': 0.7958937152433714}
[S9] START round=13 head_norm_before_train=1.355912 cos_to_last_merge=0.8849 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.885
[S9] round=13 local utility u=0.102405 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9982321080400711, 'loss_val': 0.1686939591673342, 'psi': 0.8200227916800396}-{'f1_val': 0.7012165807733519, 'auprc': 0.9681545270090217, 'loss_val': 0.28327199008589643, 'psi': 0.8079917592676198}
[S10] START round=13 head_norm_before_train=1.666623 (no previous merge yet)
[S10] round=13 local utility u=0.008203 metrics={'f1_val': 0.6977017444183163, 'auprc': 0.9898446715641795, 'loss_val': 0.17219845158283234, 'psi': 0.8145589152766617}-{'f1_val': 0.6996640466857562, 'auprc': 0.997956846124748, 'loss_val': 0.22471423742231436, 'psi': 0.8189811664613529}
[S11] START round=13 head_norm_before_train=1.341800 cos_to_last_merge=0.8622 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.862
[S11] round=13 local utility u=0.082518 metrics={'f1_val': 0.9742630612091, 'auprc': 0.9986211877898384, 'loss_val': 0.2345368753487991, 'psi': 0.9840063118413954}-{'f1_val': 0.9578276111022713, 'auprc': 0.9971073628987633, 'loss_val': 0.2964187906615602, 'psi': 0.9735395118208682}
[S13] START round=13 head_norm_before_train=1.303569 cos_to_last_merge=1.0000 (last merge round=12)
[S13] round=13 local utility u=0.000000 metrics={'f1_val': 0.5770532582424254, 'auprc': 0.6655105742960812, 'loss_val': 0.7992052907596653, 'psi': 0.6124361846638877}-{'f1_val': 0.626212936524196, 'auprc': 0.6509170677191831, 'loss_val': 0.7285632406760651, 'psi': 0.6360945890021908}
[S14] START round=13 head_norm_before_train=1.027009 cos_to_last_merge=0.8295 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.829
[S14] round=13 local utility u=1.000000 metrics={'f1_val': 0.8136357695353275, 'auprc': 0.9971580889974732, 'loss_val': 0.5095913156191402, 'psi': 0.8870446973201858}-{'f1_val': 0.39659360338126215, 'auprc': 0.997159862679694, 'loss_val': 0.5715541876584523, 'psi': 0.6368201071006349}
[S15] START round=13 head_norm_before_train=1.650772 (no previous merge yet)
[S15] round=13 local utility u=0.802470 metrics={'f1_val': 0.903700859086528, 'auprc': 0.998313613920766, 'loss_val': 0.1723907595787915, 'psi': 0.9415459610202231}-{'f1_val': 0.6978723129683013, 'auprc': 0.9300709173127464, 'loss_val': 0.3376322965144986, 'psi': 0.7907517547060794}
[S16] START round=13 head_norm_before_train=1.633137 cos_to_last_merge=1.0000 (last merge round=12)
[S16] round=13 local utility u=0.000000 metrics={'f1_val': 0.42106875179508146, 'auprc': 0.7469195275067068, 'loss_val': 0.7777943042534737, 'psi': 0.5514090620797316}-{'f1_val': 0.5886189409758894, 'auprc': 0.7543158079971699, 'loss_val': 0.7671133394130839, 'psi': 0.6548976877844016}
[S17] START round=13 head_norm_before_train=1.462019 cos_to_last_merge=0.9994 (last merge round=11)
[S17] round=13 local utility u=0.033720 metrics={'f1_val': 0.4196538306253992, 'auprc': 0.836584017540846, 'loss_val': 0.6345387415951387, 'psi': 0.5864259053915779}-{'f1_val': 0.502470836673779, 'auprc': 0.6557146620903125, 'loss_val': 0.6562734025779166, 'psi': 0.5637683668403923}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:31612
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:31604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:31613
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S5] → sending delta(kind=head bytes=1791) to S10@127.0.0.1:31611
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:31615
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:31611
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:31617
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:31616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:31605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:31617
[S8] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1791 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1798) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.066370)
[S15] loaded HEAD from S14 (vec_in norm=1.066370)
[S15] cosine check vs S14: cos=-0.0539
[S15] DROPPED delta from S14 (cos=-0.0539 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1804) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.271854)
[S17] loaded HEAD from S8 (vec_in norm=1.271854)
[S17] cosine check vs S8: cos=-0.0131
[S17] DROPPED delta from S8 (cos=-0.0131 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1797) from S9
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.393978)
[S4] loaded HEAD from S9 (vec_in norm=1.393978)
[S4] cosine check vs S9: cos=-0.0621
[S4] DROPPED delta from S9 (cos=-0.0621 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1800) from S10
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.694874)
[S16] loaded HEAD from S10 (vec_in norm=1.694874)
[S16] cosine check vs S10: cos=0.9950
[S16] BUFFERED delta from S10 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1803) from S7
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.498299)
[S17] loaded HEAD from S7 (vec_in norm=1.498299)
[S17] cosine check vs S7: cos=0.9870
[S17] BUFFERED delta from S7 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1801) from S2
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.522081)
[S11] loaded HEAD from S2 (vec_in norm=1.522081)
[S11] cosine check vs S2: cos=-0.0128
[S11] DROPPED delta from S2 (cos=-0.0128 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1803) from S15
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.679762)
[S10] loaded HEAD from S15 (vec_in norm=1.679762)
[S10] cosine check vs S15: cos=-0.1272
[S10] DROPPED delta from S15 (cos=-0.1272 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1800) from S4
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.276044)
[S5] loaded HEAD from S4 (vec_in norm=1.276044)
[S5] cosine check vs S4: cos=0.2980
[S5] BUFFERED delta from S4 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1791) from S5
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.930243)
[S10] loaded HEAD from S5 (vec_in norm=0.930243)
[S10] cosine check vs S5: cos=-0.0823
[S10] DROPPED delta from S5 (cos=-0.0823 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1795) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.395656)
[S13] loaded HEAD from S11 (vec_in norm=1.395656)
[S13] cosine check vs S11: cos=0.9892
[S13] BUFFERED delta from S11 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:31605
[S17] sending update (kind=head size=1801 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1801) from S17
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.488159)
[S5] loaded HEAD from S17 (vec_in norm=1.488159)
[S5] cosine check vs S17: cos=0.8779
[S5] BUFFERED delta from S17 (total buffered=2)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=13 metric=0.5771 head_norm=1.331958
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.050717e-01
[S13] stored merged vector for next round verification (round=13)
[S13] DEBUG after merge:  round=13 metric=0.5783 head_norm=1.360126 delta_norm=0.105072
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=13 metric=0.4176 head_norm=0.930243
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.915015e-01
[S5] stored merged vector for next round verification (round=13)
[S5] DEBUG after merge:  round=13 metric=0.4175 head_norm=0.932466 delta_norm=0.291501
[S5] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=13 metric=0.4211 head_norm=1.656936
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.618420e-02
[S16] stored merged vector for next round verification (round=13)
[S16] DEBUG after merge:  round=13 metric=0.4306 head_norm=1.673795 delta_norm=0.086184
[S16] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=13 metric=0.4197 head_norm=1.488159
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.204193e-01
[S17] stored merged vector for next round verification (round=13)
[S17] DEBUG after merge:  round=13 metric=0.4016 head_norm=1.488374 delta_norm=0.120419
[S17] aggregate: ROLLBACK (f1_val pre=0.420 post=0.402 tol_abs=0.005 tol_rel=0.0)
[S2] START round=14 head_norm_before_train=1.522081 cos_to_last_merge=0.9982 (last merge round=12)
[S2] round=14 local utility u=0.126665 metrics={'f1_val': 0.7005679037941495, 'auprc': 0.7424457625534328, 'loss_val': 0.483227730051729, 'psi': 0.7173190472978628}-{'f1_val': 0.7000291766083584, 'auprc': 0.6940968843760844, 'loss_val': 0.5882789254182702, 'psi': 0.6976562597154488}
[S3] START round=14 head_norm_before_train=1.630937 (no previous merge yet)
[S3] round=14 local utility u=0.627699 metrics={'f1_val': 0.7005813959920884, 'auprc': 0.997522237617892, 'loss_val': 0.22616918526208682, 'psi': 0.8193577326424099}-{'f1_val': 0.5590211801976508, 'auprc': 0.9458568161465815, 'loss_val': 0.47720934824817185, 'psi': 0.713755434577223}
[S4] START round=14 head_norm_before_train=1.276044 cos_to_last_merge=0.9979 (last merge round=12)
[S4] round=14 local utility u=0.218545 metrics={'f1_val': 0.6656684083277031, 'auprc': 0.7914657711321397, 'loss_val': 0.4777808405406546, 'psi': 0.7159873534494778}-{'f1_val': 0.6675862917279285, 'auprc': 0.6597738573962518, 'loss_val': 0.5313028316377933, 'psi': 0.6644613179952579}
[S5] START round=14 head_norm_before_train=0.932466 cos_to_last_merge=1.0000 (last merge round=13)
[S5] round=14 local utility u=0.035705 metrics={'f1_val': 0.437138474375561, 'auprc': 0.827926316208049, 'loss_val': 0.8078618166214401, 'psi': 0.5934536111085562}-{'f1_val': 0.41758505646266003, 'auprc': 0.8571477419320107, 'loss_val': 0.8496162916323722, 'psi': 0.5934101306504003}
[S6] START round=14 head_norm_before_train=1.266078 cos_to_last_merge=0.9078 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.908
[S6] round=14 local utility u=0.100642 metrics={'f1_val': 0.6945601124030243, 'auprc': 0.9574877034152272, 'loss_val': 0.392065552504834, 'psi': 0.7997311488079055}-{'f1_val': 0.6747855910861965, 'auprc': 0.955266856802667, 'loss_val': 0.4680408292643582, 'psi': 0.7869780973727847}
[S7] START round=14 head_norm_before_train=1.498299 (no previous merge yet)
[S7] round=14 local utility u=0.000000 metrics={'f1_val': 0.6786598241923656, 'auprc': 0.8756369636281576, 'loss_val': 0.5779838728155987, 'psi': 0.7574506799666824}-{'f1_val': 0.7140699654073116, 'auprc': 0.8706851090963013, 'loss_val': 0.6738893635665979, 'psi': 0.7767160228829075}
[S8] START round=14 head_norm_before_train=1.271854 cos_to_last_merge=0.8395 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.839
[S8] round=14 local utility u=0.042214 metrics={'f1_val': 0.7162034045644803, 'auprc': 0.9974937747850243, 'loss_val': 0.24360308642131887, 'psi': 0.8287195526526978}-{'f1_val': 0.7138874667974482, 'auprc': 0.9943108639798588, 'loss_val': 0.3045866405934676, 'psi': 0.8260568256704124}
[S9] START round=14 head_norm_before_train=1.393978 cos_to_last_merge=0.8756 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.876
[S9] round=14 local utility u=0.899874 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9978517169794403, 'loss_val': 0.13546633150270596, 'psi': 0.9966367178102874}-{'f1_val': 0.7012165807733519, 'auprc': 0.9982321080400711, 'loss_val': 0.1686939591673342, 'psi': 0.8200227916800396}
[S10] START round=14 head_norm_before_train=1.694874 (no previous merge yet)
[S10] round=14 local utility u=0.000000 metrics={'f1_val': 0.5148226143970482, 'auprc': 0.8830939077085165, 'loss_val': 0.41068996144773995, 'psi': 0.6621311317216355}-{'f1_val': 0.6977017444183163, 'auprc': 0.9898446715641795, 'loss_val': 0.17219845158283234, 'psi': 0.8145589152766617}
[S11] START round=14 head_norm_before_train=1.395656 cos_to_last_merge=0.8525 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.853
[S11] round=14 local utility u=0.104710 metrics={'f1_val': 0.996960829744628, 'auprc': 0.9981051888471342, 'loss_val': 0.15975541136702748, 'psi': 0.9974185733856304}-{'f1_val': 0.9742630612091, 'auprc': 0.9986211877898384, 'loss_val': 0.2345368753487991, 'psi': 0.9840063118413954}
[S13] START round=14 head_norm_before_train=1.360126 cos_to_last_merge=1.0000 (last merge round=13)
[S13] round=14 local utility u=0.073594 metrics={'f1_val': 0.6048320257735413, 'auprc': 0.6277845705109075, 'loss_val': 0.7055125233447427, 'psi': 0.6140130436684879}-{'f1_val': 0.5770532582424254, 'auprc': 0.6655105742960812, 'loss_val': 0.7992052907596653, 'psi': 0.6124361846638877}
[S14] START round=14 head_norm_before_train=1.066370 cos_to_last_merge=0.8175 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.818
[S14] round=14 local utility u=0.595272 metrics={'f1_val': 0.997328296182015, 'auprc': 0.9971587278429181, 'loss_val': 0.4212051875665973, 'psi': 0.9972604688463762}-{'f1_val': 0.8136357695353275, 'auprc': 0.9971580889974732, 'loss_val': 0.5095913156191402, 'psi': 0.8870446973201858}
[S15] START round=14 head_norm_before_train=1.679762 (no previous merge yet)
[S15] round=14 local utility u=0.000000 metrics={'f1_val': 0.7039320644119836, 'auprc': 0.9412698662614043, 'loss_val': 0.2909592025219951, 'psi': 0.7988671851517519}-{'f1_val': 0.903700859086528, 'auprc': 0.998313613920766, 'loss_val': 0.1723907595787915, 'psi': 0.9415459610202231}
[S16] START round=14 head_norm_before_train=1.673795 cos_to_last_merge=1.0000 (last merge round=13)
[S16] round=14 local utility u=0.830854 metrics={'f1_val': 0.6836406442592925, 'auprc': 0.7605531875632093, 'loss_val': 0.7324184557262263, 'psi': 0.7144056615808592}-{'f1_val': 0.42106875179508146, 'auprc': 0.7469195275067068, 'loss_val': 0.7777943042534737, 'psi': 0.5514090620797316}
[S17] START round=14 head_norm_before_train=1.488374 cos_to_last_merge=1.0000 (last merge round=13)
[S17] round=14 local utility u=0.215061 metrics={'f1_val': 0.5346525034352456, 'auprc': 0.743366742909785, 'loss_val': 0.6147573904478172, 'psi': 0.6181381992250614}-{'f1_val': 0.4196538306253992, 'auprc': 0.836584017540846, 'loss_val': 0.6345387415951387, 'psi': 0.5864259053915779}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] sending update (kind=head size=1805 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S3@127.0.0.1:31603
[S8] sending update (kind=head size=1793 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1793) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.310892)
[S3] loaded HEAD from S8 (vec_in norm=1.310892)
[S3] cosine check vs S8: cos=-0.0833
[S3] DROPPED delta from S8 (cos=-0.0833 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:31616
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1803 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] RECEIVED delta(kind=head bytes=1803) from S2
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.556651)
[S16] loaded HEAD from S2 (vec_in norm=1.556651)
[S16] cosine check vs S2: cos=0.9662
[S16] BUFFERED delta from S2 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] → sending delta(kind=head bytes=1793) to S11@127.0.0.1:31612
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:31607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:31602
[S13] sending update (kind=head size=1793 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1793) from S13
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.383466)
[S11] loaded HEAD from S13 (vec_in norm=1.383466)
[S11] cosine check vs S13: cos=0.9921
[S11] BUFFERED delta from S13 (total buffered=1)
[S4] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1803) from S4
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.319829)
[S6] loaded HEAD from S4 (vec_in norm=1.319829)
[S6] cosine check vs S4: cos=0.9803
[S6] BUFFERED delta from S4 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1799) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.446716)
[S2] loaded HEAD from S11 (vec_in norm=1.446716)
[S2] cosine check vs S11: cos=-0.0020
[S2] DROPPED delta from S11 (cos=-0.0020 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S2@127.0.0.1:31602
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:31614
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1794 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1794) from S16
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.703777)
[S2] loaded HEAD from S16 (vec_in norm=1.703777)
[S2] cosine check vs S16: cos=0.9662
[S2] BUFFERED delta from S16 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:31605
[S5] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S5
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.960092)
[S14] loaded HEAD from S5 (vec_in norm=0.960092)
[S14] cosine check vs S5: cos=-0.0487
[S14] DROPPED delta from S5 (cos=-0.0487 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:31605
[S17] sending update (kind=head size=1803 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1803) from S17
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.514627)
[S5] loaded HEAD from S17 (vec_in norm=1.514627)
[S5] cosine check vs S17: cos=0.8623
[S5] BUFFERED delta from S17 (total buffered=1)
[S14] sending update (kind=head size=1804 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1804) from S14
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.112176)
[S5] loaded HEAD from S14 (vec_in norm=1.112176)
[S5] cosine check vs S14: cos=-0.0487
[S5] DROPPED delta from S14 (cos=-0.0487 < 0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=14 metric=0.6946 head_norm=1.294801
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.303500e-01
[S6] stored merged vector for next round verification (round=14)
[S6] DEBUG after merge:  round=14 metric=0.6946 head_norm=1.300861 delta_norm=0.130350
[S6] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=14 metric=0.7006 head_norm=1.556651
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.240405e-01
[S2] stored merged vector for next round verification (round=14)
[S2] DEBUG after merge:  round=14 metric=0.6998 head_norm=1.616421 delta_norm=0.224040
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=14 metric=0.9970 head_norm=1.446716
[S11] _apply_head_vector_avg (torch): Δ‖w‖=9.421344e-02
[S11] stored merged vector for next round verification (round=14)
[S11] DEBUG after merge:  round=14 metric=0.9940 head_norm=1.412305 delta_norm=0.094213
[S11] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=14 metric=0.4371 head_norm=0.960092
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.207311e-01
[S5] stored merged vector for next round verification (round=14)
[S5] DEBUG after merge:  round=14 metric=0.4372 head_norm=1.196211 delta_norm=0.420731
[S5] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=14 metric=0.6836 head_norm=1.703777
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.240405e-01
[S16] stored merged vector for next round verification (round=14)
[S16] DEBUG after merge:  round=14 metric=0.4953 head_norm=1.616421 delta_norm=0.224040
[S16] aggregate: ROLLBACK (f1_val pre=0.684 post=0.495 tol_abs=0.005 tol_rel=0.0)
[S2] START round=15 head_norm_before_train=1.616421 cos_to_last_merge=1.0000 (last merge round=14)
[S2] round=15 local utility u=0.000000 metrics={'f1_val': 0.7005679037941495, 'auprc': 0.6724996547829156, 'loss_val': 0.4385315301747203, 'psi': 0.6893406041896559}-{'f1_val': 0.7005679037941495, 'auprc': 0.7424457625534328, 'loss_val': 0.483227730051729, 'psi': 0.7173190472978628}
[S3] START round=15 head_norm_before_train=1.661915 (no previous merge yet)
[S3] round=15 local utility u=0.732873 metrics={'f1_val': 0.9333688439197494, 'auprc': 0.9988709355473087, 'loss_val': 0.16119454477965126, 'psi': 0.9595696805707732}-{'f1_val': 0.7005813959920884, 'auprc': 0.997522237617892, 'loss_val': 0.22616918526208682, 'psi': 0.8193577326424099}
[S4] START round=15 head_norm_before_train=1.319829 cos_to_last_merge=0.9934 (last merge round=12)
[S4] round=15 local utility u=0.000000 metrics={'f1_val': 0.6656776599977086, 'auprc': 0.6892612262197949, 'loss_val': 0.4903681178272338, 'psi': 0.675111086486543}-{'f1_val': 0.6656684083277031, 'auprc': 0.7914657711321397, 'loss_val': 0.4777808405406546, 'psi': 0.7159873534494778}
[S5] START round=15 head_norm_before_train=1.196211 cos_to_last_merge=1.0000 (last merge round=14)
[S5] round=15 local utility u=0.067028 metrics={'f1_val': 0.437089223240106, 'auprc': 0.8499119797619578, 'loss_val': 0.7394665436219182, 'psi': 0.6022183258488467}-{'f1_val': 0.437138474375561, 'auprc': 0.827926316208049, 'loss_val': 0.8078618166214401, 'psi': 0.5934536111085562}
[S6] START round=15 head_norm_before_train=1.300861 cos_to_last_merge=1.0000 (last merge round=14)
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.6944343414439392, 'auprc': 0.9567069095858881, 'loss_val': 0.39231316723261167, 'psi': 0.7993433687007188}-{'f1_val': 0.6945601124030243, 'auprc': 0.9574877034152272, 'loss_val': 0.392065552504834, 'psi': 0.7997311488079055}
[S7] START round=15 head_norm_before_train=1.520760 (no previous merge yet)
[S7] round=15 local utility u=0.000000 metrics={'f1_val': 0.4741102815937259, 'auprc': 0.7849105053203652, 'loss_val': 0.7455077241134913, 'psi': 0.5984303710843817}-{'f1_val': 0.6786598241923656, 'auprc': 0.8756369636281576, 'loss_val': 0.5779838728155987, 'psi': 0.7574506799666824}
[S8] START round=15 head_norm_before_train=1.310892 cos_to_last_merge=0.8303 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.830
[S8] round=15 local utility u=0.006468 metrics={'f1_val': 0.7151442486458968, 'auprc': 0.9941318652364021, 'loss_val': 0.2142261120020352, 'psi': 0.8267392952820989}-{'f1_val': 0.7162034045644803, 'auprc': 0.9974937747850243, 'loss_val': 0.24360308642131887, 'psi': 0.8287195526526978}
[S9] START round=15 head_norm_before_train=1.428637 cos_to_last_merge=0.8675 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.867
[S9] round=15 local utility u=0.000000 metrics={'f1_val': 0.9873949972964658, 'auprc': 0.9982274868925856, 'loss_val': 0.1255408842789491, 'psi': 0.9917279931349137}-{'f1_val': 0.9958267183641853, 'auprc': 0.9978517169794403, 'loss_val': 0.13546633150270596, 'psi': 0.9966367178102874}
[S10] START round=15 head_norm_before_train=1.716547 (no previous merge yet)
[S10] round=15 local utility u=1.000000 metrics={'f1_val': 0.9932560044355739, 'auprc': 0.997786500020453, 'loss_val': 0.11799935660723555, 'psi': 0.9950682026695256}-{'f1_val': 0.5148226143970482, 'auprc': 0.8830939077085165, 'loss_val': 0.41068996144773995, 'psi': 0.6621311317216355}
[S11] START round=15 head_norm_before_train=1.412305 cos_to_last_merge=1.0000 (last merge round=14)
[S11] round=15 local utility u=0.008282 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9983877577544106, 'loss_val': 0.1416785394678341, 'psi': 0.9972955854854925}-{'f1_val': 0.996960829744628, 'auprc': 0.9981051888471342, 'loss_val': 0.15975541136702748, 'psi': 0.9974185733856304}
[S13] START round=15 head_norm_before_train=1.383466 cos_to_last_merge=0.9989 (last merge round=13)
[S13] round=15 local utility u=0.077984 metrics={'f1_val': 0.6118351887851101, 'auprc': 0.6494399150762364, 'loss_val': 0.6565304458644187, 'psi': 0.6268770793015606}-{'f1_val': 0.6048320257735413, 'auprc': 0.6277845705109075, 'loss_val': 0.7055125233447427, 'psi': 0.6140130436684879}
[S14] START round=15 head_norm_before_train=1.112176 cos_to_last_merge=0.8057 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.806
[S14] round=15 local utility u=0.060524 metrics={'f1_val': 0.9968858583261915, 'auprc': 0.9971591116370437, 'loss_val': 0.29750332449367844, 'psi': 0.9969951596505323}-{'f1_val': 0.997328296182015, 'auprc': 0.9971587278429181, 'loss_val': 0.4212051875665973, 'psi': 0.9972604688463762}
[S15] START round=15 head_norm_before_train=1.708760 (no previous merge yet)
[S15] round=15 local utility u=0.764512 metrics={'f1_val': 0.9029636678625284, 'auprc': 0.9984484344668014, 'loss_val': 0.12766053270050998, 'psi': 0.9411575745042376}-{'f1_val': 0.7039320644119836, 'auprc': 0.9412698662614043, 'loss_val': 0.2909592025219951, 'psi': 0.7988671851517519}
[S16] START round=15 head_norm_before_train=1.616421 cos_to_last_merge=1.0000 (last merge round=14)
[S16] round=15 local utility u=0.456865 metrics={'f1_val': 0.8131262079829216, 'auprc': 0.8029040141665438, 'loss_val': 0.7226535703272475, 'psi': 0.8090373304563705}-{'f1_val': 0.6836406442592925, 'auprc': 0.7605531875632093, 'loss_val': 0.7324184557262263, 'psi': 0.7144056615808592}
[S17] START round=15 head_norm_before_train=1.514627 cos_to_last_merge=0.9994 (last merge round=13)
[S17] round=15 local utility u=0.573086 metrics={'f1_val': 0.7093742862734975, 'auprc': 0.7572375157940915, 'loss_val': 0.5585278320780162, 'psi': 0.7285195780817351}-{'f1_val': 0.5346525034352456, 'auprc': 0.743366742909785, 'loss_val': 0.6147573904478172, 'psi': 0.6181381992250614}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:31613
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:31614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:31603
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:31602
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:31612
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:31615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1802) from S13
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.408376)
[S11] loaded HEAD from S13 (vec_in norm=1.408376)
[S11] cosine check vs S13: cos=0.9941
[S11] BUFFERED delta from S13 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1800) from S5
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.222472)
[S13] loaded HEAD from S5 (vec_in norm=1.222472)
[S13] cosine check vs S5: cos=0.1104
[S13] BUFFERED delta from S5 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1802) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.460769)
[S2] loaded HEAD from S11 (vec_in norm=1.460769)
[S2] cosine check vs S11: cos=-0.0051
[S2] DROPPED delta from S11 (cos=-0.0051 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1802) from S10
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.732149)
[S15] loaded HEAD from S10 (vec_in norm=1.732149)
[S15] cosine check vs S10: cos=-0.1215
[S15] DROPPED delta from S10 (cos=-0.1215 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1796) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.347702)
[S3] loaded HEAD from S8 (vec_in norm=1.347702)
[S3] cosine check vs S8: cos=-0.0862
[S3] DROPPED delta from S8 (cos=-0.0862 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1803) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.737085)
[S14] loaded HEAD from S15 (vec_in norm=1.737085)
[S14] cosine check vs S15: cos=-0.0571
[S14] DROPPED delta from S15 (cos=-0.0571 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:31609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:31611
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] sending update (kind=head size=1803 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1803) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.540417)
[S8] loaded HEAD from S17 (vec_in norm=1.540417)
[S8] cosine check vs S17: cos=-0.0029
[S8] DROPPED delta from S17 (cos=-0.0029 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1797) from S16
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.646063)
[S10] loaded HEAD from S16 (vec_in norm=1.646063)
[S10] cosine check vs S16: cos=0.9829
[S10] BUFFERED delta from S16 (total buffered=1)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] ⇄ pheromone p=0.107 → S13@127.0.0.1:31613
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=15 metric=0.9933 head_norm=1.732149
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.621059e-01
[S10] stored merged vector for next round verification (round=15)
[S10] DEBUG after merge:  round=15 metric=0.9564 head_norm=1.681860 delta_norm=0.162106
[S10] aggregate: ROLLBACK (f1_val pre=0.993 post=0.956 tol_abs=0.005 tol_rel=0.0)
[S10] ⇄ pheromone p=0.332 → S15@127.0.0.1:31615
[S8] ⇄ pheromone p=0.218 → S3@127.0.0.1:31603
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=15 metric=0.9966 head_norm=1.460769
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.198129e-02
[S11] stored merged vector for next round verification (round=15)
[S11] DEBUG after merge:  round=15 metric=0.9966 head_norm=1.432468 delta_norm=0.081981
[S11] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.273 → S2@127.0.0.1:31602
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=15 metric=0.6118 head_norm=1.408376
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.800306e-01
[S13] stored merged vector for next round verification (round=15)
[S13] DEBUG after merge:  round=15 metric=0.6120 head_norm=0.982103 delta_norm=0.880031
[S13] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.149 → S11@127.0.0.1:31612
[S15] ⇄ pheromone p=0.373 → S14@127.0.0.1:31614
[S2] ⇄ pheromone p=0.165 → S16@127.0.0.1:31616
[S4] ⇄ pheromone p=0.133 → S6@127.0.0.1:31607
[S17] ⇄ pheromone p=0.288 → S8@127.0.0.1:31609
[S16] ⇄ pheromone p=0.400 → S10@127.0.0.1:31611
[S2] START round=16 head_norm_before_train=1.647508 cos_to_last_merge=0.9988 (last merge round=14)
[S2] round=16 local utility u=0.123302 metrics={'f1_val': 0.7012900746650139, 'auprc': 0.7307314992915014, 'loss_val': 0.3709558638313308, 'psi': 0.7130666445156089}-{'f1_val': 0.7005679037941495, 'auprc': 0.6724996547829156, 'loss_val': 0.4385315301747203, 'psi': 0.6893406041896559}
[S3] START round=16 head_norm_before_train=1.692546 (no previous merge yet)
[S3] round=16 local utility u=0.091606 metrics={'f1_val': 0.9605709740356257, 'auprc': 0.9988648068613672, 'loss_val': 0.14117618969293297, 'psi': 0.9758885071659223}-{'f1_val': 0.9333688439197494, 'auprc': 0.9988709355473087, 'loss_val': 0.16119454477965126, 'psi': 0.9595696805707732}
[S4] START round=16 head_norm_before_train=1.357919 cos_to_last_merge=0.9885 (last merge round=12)
[S4] round=16 local utility u=0.198569 metrics={'f1_val': 0.6658878659456939, 'auprc': 0.8187945223879382, 'loss_val': 0.4830908657420014, 'psi': 0.7270505285225917}-{'f1_val': 0.6656776599977086, 'auprc': 0.6892612262197949, 'loss_val': 0.4903681178272338, 'psi': 0.675111086486543}
[S5] START round=16 head_norm_before_train=1.222472 cos_to_last_merge=0.9990 (last merge round=14)
[S5] round=16 local utility u=0.038211 metrics={'f1_val': 0.437138474375561, 'auprc': 0.8618385520897953, 'loss_val': 0.6991200471046414, 'psi': 0.6070185054612547}-{'f1_val': 0.437089223240106, 'auprc': 0.8499119797619578, 'loss_val': 0.7394665436219182, 'psi': 0.6022183258488467}
[S6] START round=16 head_norm_before_train=1.323316 cos_to_last_merge=0.9996 (last merge round=14)
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.6936966634173661, 'auprc': 0.9543915786485657, 'loss_val': 0.384221748589308, 'psi': 0.797974629509846}-{'f1_val': 0.6944343414439392, 'auprc': 0.9567069095858881, 'loss_val': 0.39231316723261167, 'psi': 0.7993433687007188}
[S7] START round=16 head_norm_before_train=1.543700 (no previous merge yet)
[S7] round=16 local utility u=0.000000 metrics={'f1_val': 0.4764318029957795, 'auprc': 0.7831857395453062, 'loss_val': 0.7889680926743651, 'psi': 0.5991333776155902}-{'f1_val': 0.4741102815937259, 'auprc': 0.7849105053203652, 'loss_val': 0.7455077241134913, 'psi': 0.5984303710843817}
[S8] START round=16 head_norm_before_train=1.347702 cos_to_last_merge=0.8213 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.821
[S8] round=16 local utility u=0.876859 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9989207417253477, 'loss_val': 0.1621269024191757, 'psi': 0.9973801416515138}-{'f1_val': 0.7151442486458968, 'auprc': 0.9941318652364021, 'loss_val': 0.2142261120020352, 'psi': 0.8267392952820989}
[S9] START round=16 head_norm_before_train=1.459127 cos_to_last_merge=0.8605 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.861
[S9] round=16 local utility u=0.043280 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9965085555058774, 'loss_val': 0.08941640802161428, 'psi': 0.9965997292906859}-{'f1_val': 0.9873949972964658, 'auprc': 0.9982274868925856, 'loss_val': 0.1255408842789491, 'psi': 0.9917279931349137}
[S10] START round=16 head_norm_before_train=1.681860 cos_to_last_merge=1.0000 (last merge round=15)
[S10] round=16 local utility u=0.000000 metrics={'f1_val': 0.9931615739506624, 'auprc': 0.9978190504356482, 'loss_val': 0.11824225878357246, 'psi': 0.9950245645446567}-{'f1_val': 0.9932560044355739, 'auprc': 0.997786500020453, 'loss_val': 0.11799935660723555, 'psi': 0.9950682026695256}
[S11] START round=16 head_norm_before_train=1.432468 cos_to_last_merge=1.0000 (last merge round=15)
[S11] round=16 local utility u=0.012596 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9983056663276866, 'loss_val': 0.11611829711668195, 'psi': 0.9972504692392283}-{'f1_val': 0.996567470639547, 'auprc': 0.9983877577544106, 'loss_val': 0.1416785394678341, 'psi': 0.9972955854854925}
[S13] START round=16 head_norm_before_train=0.982103 cos_to_last_merge=1.0000 (last merge round=15)
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.6033967414841308, 'auprc': 0.6520806205456372, 'loss_val': 0.7929749999663936, 'psi': 0.6228702931087333}-{'f1_val': 0.6118351887851101, 'auprc': 0.6494399150762364, 'loss_val': 0.6565304458644187, 'psi': 0.6268770793015606}
[S14] START round=16 head_norm_before_train=1.157991 cos_to_last_merge=0.7959 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.796
[S14] round=16 local utility u=0.037817 metrics={'f1_val': 0.9977821961439645, 'auprc': 0.9972304367688596, 'loss_val': 0.22746071102647364, 'psi': 0.9975614923939224}-{'f1_val': 0.9968858583261915, 'auprc': 0.9971591116370437, 'loss_val': 0.29750332449367844, 'psi': 0.9969951596505323}
[S15] START round=16 head_norm_before_train=1.737085 (no previous merge yet)
[S15] round=16 local utility u=0.000000 metrics={'f1_val': 0.7665749635182149, 'auprc': 0.9815693379967485, 'loss_val': 0.23940748260257394, 'psi': 0.8525727133096284}-{'f1_val': 0.9029636678625284, 'auprc': 0.9984484344668014, 'loss_val': 0.12766053270050998, 'psi': 0.9411575745042376}
[S16] START round=16 head_norm_before_train=1.646063 cos_to_last_merge=0.9996 (last merge round=14)
[S16] round=16 local utility u=0.000000 metrics={'f1_val': 0.7299417322411575, 'auprc': 0.7888957117616272, 'loss_val': 0.6620706874946142, 'psi': 0.7535233240493454}-{'f1_val': 0.8131262079829216, 'auprc': 0.8029040141665438, 'loss_val': 0.7226535703272475, 'psi': 0.8090373304563705}
[S17] START round=16 head_norm_before_train=1.540417 cos_to_last_merge=0.9976 (last merge round=13)
[S17] round=16 local utility u=0.000000 metrics={'f1_val': 0.5935229164946365, 'auprc': 0.7339139259288049, 'loss_val': 0.5528626564354091, 'psi': 0.6496793202683039}-{'f1_val': 0.7093742862734975, 'auprc': 0.7572375157940915, 'loss_val': 0.5585278320780162, 'psi': 0.7285195780817351}
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S15
[S5]  timeout peer S16
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S8]  timeout peer S2
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:31603
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:31607
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] → sending delta(kind=head bytes=1805) to S15@127.0.0.1:31615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:31616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:31602
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:31609
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:31613
[S8] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1805 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1804) from S3
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.718881)
[S8] loaded HEAD from S3 (vec_in norm=1.718881)
[S8] cosine check vs S3: cos=-0.0891
[S8] DROPPED delta from S3 (cos=-0.0891 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1805) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.200611)
[S15] loaded HEAD from S14 (vec_in norm=1.200611)
[S15] cosine check vs S14: cos=-0.0590
[S15] DROPPED delta from S14 (cos=-0.0590 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1800) from S2
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.682431)
[S16] loaded HEAD from S2 (vec_in norm=1.682431)
[S16] cosine check vs S2: cos=0.9947
[S16] BUFFERED delta from S2 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1796) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.387622)
[S3] loaded HEAD from S8 (vec_in norm=1.387622)
[S3] cosine check vs S8: cos=-0.0891
[S3] DROPPED delta from S8 (cos=-0.0891 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1802) from S4
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.389850)
[S6] loaded HEAD from S4 (vec_in norm=1.389850)
[S6] cosine check vs S4: cos=0.9847
[S6] BUFFERED delta from S4 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1801) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.477530)
[S2] loaded HEAD from S11 (vec_in norm=1.477530)
[S2] cosine check vs S11: cos=0.0034
[S2] BUFFERED delta from S11 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=16 metric=0.7013 head_norm=1.682431
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.117673e+00
[S2] stored merged vector for next round verification (round=16)
[S2] DEBUG after merge:  round=16 metric=0.9933 head_norm=1.121447 delta_norm=1.117673
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] sending update (kind=head size=1800 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1800) from S5
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.248441)
[S13] loaded HEAD from S5 (vec_in norm=1.248441)
[S13] cosine check vs S5: cos=0.6876
[S13] BUFFERED delta from S5 (total buffered=1)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=16 metric=0.6034 head_norm=1.010192
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.595723e-01
[S13] stored merged vector for next round verification (round=16)
[S13] DEBUG after merge:  round=16 metric=0.6044 head_norm=1.038432 delta_norm=0.459572
[S13] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S5]  timeout peer S14
[S14]  timeout peer S5
[S14]  timeout peer S16
[S14]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S16
[S15]  timeout peer S17
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=16 metric=0.7299 head_norm=1.670382
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.638834e-02
[S16] stored merged vector for next round verification (round=16)
[S16] DEBUG after merge:  round=16 metric=0.7238 head_norm=1.674190 delta_norm=0.086388
[S16] aggregate: ROLLBACK (f1_val pre=0.730 post=0.724 tol_abs=0.005 tol_rel=0.0)
[S2] START round=17 head_norm_before_train=1.121447 cos_to_last_merge=1.0000 (last merge round=16)
[S2] round=17 local utility u=0.359594 metrics={'f1_val': 0.701470645897668, 'auprc': 0.9949435190833509, 'loss_val': 0.44548780648653447, 'psi': 0.8188597951719412}-{'f1_val': 0.7012900746650139, 'auprc': 0.7307314992915014, 'loss_val': 0.3709558638313308, 'psi': 0.7130666445156089}
[S3] START round=17 head_norm_before_train=1.718881 (no previous merge yet)
[S3] round=17 local utility u=0.009331 metrics={'f1_val': 0.960995754132836, 'auprc': 0.9984648922826452, 'loss_val': 0.12386386836254899, 'psi': 0.9759834093927597}-{'f1_val': 0.9605709740356257, 'auprc': 0.9988648068613672, 'loss_val': 0.14117618969293297, 'psi': 0.9758885071659223}
[S4] START round=17 head_norm_before_train=1.389850 cos_to_last_merge=0.9840 (last merge round=12)
[S4] round=17 local utility u=0.173732 metrics={'f1_val': 0.6645193514353066, 'auprc': 0.9338617039126935, 'loss_val': 0.4726176074946456, 'psi': 0.7722562924262614}-{'f1_val': 0.6658878659456939, 'auprc': 0.8187945223879382, 'loss_val': 0.4830908657420014, 'psi': 0.7270505285225917}
[S5] START round=17 head_norm_before_train=1.248441 cos_to_last_merge=0.9963 (last merge round=14)
[S5] round=17 local utility u=0.024284 metrics={'f1_val': 0.4369770819312104, 'auprc': 0.8593536847195047, 'loss_val': 0.6421293234201146, 'psi': 0.6059277230465281}-{'f1_val': 0.437138474375561, 'auprc': 0.8618385520897953, 'loss_val': 0.6991200471046414, 'psi': 0.6070185054612547}
[S6] START round=17 head_norm_before_train=1.345543 cos_to_last_merge=0.9989 (last merge round=14)
[S6] round=17 local utility u=0.027899 metrics={'f1_val': 0.6948103638882229, 'auprc': 0.9568662391815156, 'loss_val': 0.342529265938854, 'psi': 0.79963271400554}-{'f1_val': 0.6936966634173661, 'auprc': 0.9543915786485657, 'loss_val': 0.384221748589308, 'psi': 0.797974629509846}
[S7] START round=17 head_norm_before_train=1.562738 (no previous merge yet)
[S7] round=17 local utility u=1.000000 metrics={'f1_val': 0.6874169376486549, 'auprc': 0.9072508048234897, 'loss_val': 0.3465347175169986, 'psi': 0.7753504845185888}-{'f1_val': 0.4764318029957795, 'auprc': 0.7831857395453062, 'loss_val': 0.7889680926743651, 'psi': 0.5991333776155902}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=17 head_norm_before_train=1.387622 cos_to_last_merge=0.8120 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.812
[S8] round=17 local utility u=0.000000 metrics={'f1_val': 0.9935720125531489, 'auprc': 0.9950140755173501, 'loss_val': 0.1541948253940796, 'psi': 0.9941488377388294}-{'f1_val': 0.9963530749356245, 'auprc': 0.9989207417253477, 'loss_val': 0.1621269024191757, 'psi': 0.9973801416515138}
[S9] START round=17 head_norm_before_train=1.483993 cos_to_last_merge=0.8551 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.855
[S9] round=17 local utility u=0.000892 metrics={'f1_val': 0.9941535115217267, 'auprc': 0.9982234758478505, 'loss_val': 0.07773570697326196, 'psi': 0.9957814972521762}-{'f1_val': 0.9966605118138915, 'auprc': 0.9965085555058774, 'loss_val': 0.08941640802161428, 'psi': 0.9965997292906859}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S10] START round=17 head_norm_before_train=1.696316 cos_to_last_merge=0.9998 (last merge round=15)
[S10] round=17 local utility u=0.014457 metrics={'f1_val': 0.9944887801351068, 'auprc': 0.9976373449061344, 'loss_val': 0.09674696306320425, 'psi': 0.9957482060435179}-{'f1_val': 0.9931615739506624, 'auprc': 0.9978190504356482, 'loss_val': 0.11824225878357246, 'psi': 0.9950245645446567}
[S11] START round=17 head_norm_before_train=1.477530 cos_to_last_merge=0.9996 (last merge round=15)
[S11] round=17 local utility u=0.000000 metrics={'f1_val': 0.9458706164160606, 'auprc': 0.9982307581145546, 'loss_val': 0.19873887999442896, 'psi': 0.9668146730954582}-{'f1_val': 0.9965470045135896, 'auprc': 0.9983056663276866, 'loss_val': 0.11611829711668195, 'psi': 0.9972504692392283}
[S13] START round=17 head_norm_before_train=1.038432 cos_to_last_merge=1.0000 (last merge round=16)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.6049326340950845, 'auprc': 0.5813657602539205, 'loss_val': 0.8377093079513357, 'psi': 0.5955058845586189}-{'f1_val': 0.6033967414841308, 'auprc': 0.6520806205456372, 'loss_val': 0.7929749999663936, 'psi': 0.6228702931087333}
[S14] START round=17 head_norm_before_train=1.200611 cos_to_last_merge=0.7880 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.788
[S14] round=17 local utility u=0.006556 metrics={'f1_val': 0.9960107669058352, 'auprc': 0.9992272142909224, 'loss_val': 0.20971059193847663, 'psi': 0.9972973458598702}-{'f1_val': 0.9977821961439645, 'auprc': 0.9972304367688596, 'loss_val': 0.22746071102647364, 'psi': 0.9975614923939224}
[S15] START round=17 head_norm_before_train=1.765728 (no previous merge yet)
[S15] round=17 local utility u=0.709455 metrics={'f1_val': 0.9680577904843757, 'auprc': 0.9981190384993633, 'loss_val': 0.07904449149628502, 'psi': 0.9800822896903707}-{'f1_val': 0.7665749635182149, 'auprc': 0.9815693379967485, 'loss_val': 0.23940748260257394, 'psi': 0.8525727133096284}
[S16] START round=17 head_norm_before_train=1.674190 cos_to_last_merge=1.0000 (last merge round=16)
[S16] round=17 local utility u=0.546521 metrics={'f1_val': 0.8520900618817402, 'auprc': 0.8668958030993293, 'loss_val': 0.5359187622229171, 'psi': 0.8580123583687758}-{'f1_val': 0.7299417322411575, 'auprc': 0.7888957117616272, 'loss_val': 0.6620706874946142, 'psi': 0.7535233240493454}
[S17] START round=17 head_norm_before_train=1.571509 cos_to_last_merge=0.9950 (last merge round=13)
[S17] round=17 local utility u=0.000000 metrics={'f1_val': 0.5400689767615445, 'auprc': 0.6489601966346192, 'loss_val': 0.6292178339587444, 'psi': 0.5836254647107744}-{'f1_val': 0.5935229164946365, 'auprc': 0.7339139259288049, 'loss_val': 0.5528626564354091, 'psi': 0.6496793202683039}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:31609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S14] → sending delta(kind=head bytes=1807) to S15@127.0.0.1:31615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:31604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:31616
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S15] → sending delta(kind=head bytes=1806) to S10@127.0.0.1:31611
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:31607
[S3] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1807 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1802) from S3
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.741289)
[S8] loaded HEAD from S3 (vec_in norm=1.741289)
[S8] cosine check vs S3: cos=-0.0920
[S8] DROPPED delta from S3 (cos=-0.0920 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1804) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.367581)
[S4] loaded HEAD from S6 (vec_in norm=1.367581)
[S4] cosine check vs S6: cos=0.9796
[S4] BUFFERED delta from S6 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1807) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.232319)
[S15] loaded HEAD from S14 (vec_in norm=1.232319)
[S15] cosine check vs S14: cos=-0.0603
[S15] DROPPED delta from S14 (cos=-0.0603 < 0.0)
[S15] sending update (kind=head size=1806 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:31616
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=17 metric=0.6948 head_norm=1.367581
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.269272e-01
[S6] stored merged vector for next round verification (round=17)
[S6] DEBUG after merge:  round=17 metric=0.6948 head_norm=1.372906 delta_norm=0.126927
[S6] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S13@127.0.0.1:31613
[S6] RECEIVED delta(kind=head bytes=1802) from S4
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.418309)
[S6] loaded HEAD from S4 (vec_in norm=1.418309)
[S6] cosine check vs S4: cos=0.9939
[S6] BUFFERED delta from S4 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1806) from S15
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.792119)
[S10] loaded HEAD from S15 (vec_in norm=1.792119)
[S10] cosine check vs S15: cos=-0.1226
[S10] DROPPED delta from S15 (cos=-0.1226 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1799) from S2
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.160494)
[S16] loaded HEAD from S2 (vec_in norm=1.160494)
[S16] cosine check vs S2: cos=0.7522
[S16] BUFFERED delta from S2 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:31611
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1805 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1805) from S10
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.716090)
[S16] loaded HEAD from S10 (vec_in norm=1.716090)
[S16] cosine check vs S10: cos=0.9888
[S16] BUFFERED delta from S10 (total buffered=2)
[S13] RECEIVED delta(kind=head bytes=1794) from S5
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.267043)
[S13] loaded HEAD from S5 (vec_in norm=1.267043)
[S13] cosine check vs S5: cos=0.9195
[S13] BUFFERED delta from S5 (total buffered=1)
[S16] sending update (kind=head size=1801 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1801) from S16
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.696735)
[S10] loaded HEAD from S16 (vec_in norm=1.696735)
[S10] cosine check vs S16: cos=0.9888
[S10] BUFFERED delta from S16 (total buffered=1)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=17 metric=0.6645 head_norm=1.418309
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.430138e-01
[S4] stored merged vector for next round verification (round=17)
[S4] DEBUG after merge:  round=17 metric=0.6644 head_norm=1.385816 delta_norm=0.143014
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=17 metric=0.6049 head_norm=1.064421
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.540794e-01
[S13] stored merged vector for next round verification (round=17)
[S13] DEBUG after merge:  round=17 metric=0.6057 head_norm=1.142208 delta_norm=0.254079
[S13] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=17 metric=0.8521 head_norm=1.696735
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.856676e-01
[S16] stored merged vector for next round verification (round=17)
[S16] DEBUG after merge:  round=17 metric=0.8521 head_norm=1.503903 delta_norm=0.285668
[S16] aggregate: ACCEPT kept=['S2', 'S10'] (k=2/2) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=17 metric=0.9945 head_norm=1.716090
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.279417e-01
[S10] stored merged vector for next round verification (round=17)
[S10] DEBUG after merge:  round=17 metric=0.9942 head_norm=1.701637 delta_norm=0.127942
[S10] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.160494 cos_to_last_merge=0.9980 (last merge round=16)
[S2] round=18 local utility u=0.000000 metrics={'f1_val': 0.701470645897668, 'auprc': 0.9537596735051344, 'loss_val': 0.3767646647053628, 'psi': 0.8023862569406546}-{'f1_val': 0.701470645897668, 'auprc': 0.9949435190833509, 'loss_val': 0.44548780648653447, 'psi': 0.8188597951719412}
[S3] START round=18 head_norm_before_train=1.741289 (no previous merge yet)
[S3] round=18 local utility u=0.123979 metrics={'f1_val': 0.996507985077103, 'auprc': 0.9986202284474532, 'loss_val': 0.08944487686203001, 'psi': 0.9973528824252431}-{'f1_val': 0.960995754132836, 'auprc': 0.9984648922826452, 'loss_val': 0.12386386836254899, 'psi': 0.9759834093927597}
[S4] START round=18 head_norm_before_train=1.385816 cos_to_last_merge=1.0000 (last merge round=17)
[S4] round=18 local utility u=0.011219 metrics={'f1_val': 0.6645108357845797, 'auprc': 0.9372805917368497, 'loss_val': 0.46038448138303073, 'psi': 0.7736187381654878}-{'f1_val': 0.6645193514353066, 'auprc': 0.9338617039126935, 'loss_val': 0.4726176074946456, 'psi': 0.7722562924262614}
[S5] START round=18 head_norm_before_train=1.267043 cos_to_last_merge=0.9938 (last merge round=14)
[S5] round=18 local utility u=0.000000 metrics={'f1_val': 0.4369770819312104, 'auprc': 0.8589361814079091, 'loss_val': 0.6530841541606178, 'psi': 0.6057607217218899}-{'f1_val': 0.4369770819312104, 'auprc': 0.8593536847195047, 'loss_val': 0.6421293234201146, 'psi': 0.6059277230465281}
[S6] START round=18 head_norm_before_train=1.372906 cos_to_last_merge=1.0000 (last merge round=17)
[S6] round=18 local utility u=0.000000 metrics={'f1_val': 0.69473569377108, 'auprc': 0.9570600667885791, 'loss_val': 0.3539908040110044, 'psi': 0.7996654429780796}-{'f1_val': 0.6948103638882229, 'auprc': 0.9568662391815156, 'loss_val': 0.342529265938854, 'psi': 0.79963271400554}
[S7] START round=18 head_norm_before_train=1.577521 (no previous merge yet)
[S7] round=18 local utility u=0.000000 metrics={'f1_val': 0.4087290166390023, 'auprc': 0.7810203453426228, 'loss_val': 1.0244956102803642, 'psi': 0.5576455481204505}-{'f1_val': 0.6874169376486549, 'auprc': 0.9072508048234897, 'loss_val': 0.3465347175169986, 'psi': 0.7753504845185888}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=18 head_norm_before_train=1.424749 cos_to_last_merge=0.8020 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.802
[S8] round=18 local utility u=0.037549 metrics={'f1_val': 0.9966398743144329, 'auprc': 0.9990584825689894, 'loss_val': 0.10963814985563425, 'psi': 0.9976073176162554}-{'f1_val': 0.9935720125531489, 'auprc': 0.9950140755173501, 'loss_val': 0.1541948253940796, 'psi': 0.9941488377388294}
[S9] START round=18 head_norm_before_train=1.508886 cos_to_last_merge=0.8490 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.849
[S9] round=18 local utility u=0.016903 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9983106631311816, 'loss_val': 0.05923242885334457, 'psi': 0.9973205723408075}-{'f1_val': 0.9941535115217267, 'auprc': 0.9982234758478505, 'loss_val': 0.07773570697326196, 'psi': 0.9957814972521762}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S9] sending update (kind=head size=1790 to 1 peers)
[S10] START round=18 head_norm_before_train=1.701637 cos_to_last_merge=1.0000 (last merge round=17)
[S10] round=18 local utility u=0.000000 metrics={'f1_val': 0.9956047769386365, 'auprc': 0.9953111063227804, 'loss_val': 0.09852940906316554, 'psi': 0.9954873086922941}-{'f1_val': 0.9944887801351068, 'auprc': 0.9976373449061344, 'loss_val': 0.09674696306320425, 'psi': 0.9957482060435179}
[S11] START round=18 head_norm_before_train=1.517401 cos_to_last_merge=0.9986 (last merge round=15)
[S11] round=18 local utility u=0.214329 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9985946411822237, 'loss_val': 0.07523062887560894, 'psi': 0.9973660591810433}-{'f1_val': 0.9458706164160606, 'auprc': 0.9982307581145546, 'loss_val': 0.19873887999442896, 'psi': 0.9668146730954582}
[S13] START round=18 head_norm_before_train=1.142208 cos_to_last_merge=1.0000 (last merge round=17)
[S13] round=18 local utility u=0.159800 metrics={'f1_val': 0.6127504238653552, 'auprc': 0.6656835103487411, 'loss_val': 0.8179686099657815, 'psi': 0.6339236584587096}-{'f1_val': 0.6049326340950845, 'auprc': 0.5813657602539205, 'loss_val': 0.8377093079513357, 'psi': 0.5955058845586189}
[S14] START round=18 head_norm_before_train=1.232319 cos_to_last_merge=0.7825 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.782
[S14] round=18 local utility u=0.000000 metrics={'f1_val': 0.9363722521358386, 'auprc': 0.9971212279000217, 'loss_val': 0.21716756491013103, 'psi': 0.9606718424415119}-{'f1_val': 0.9960107669058352, 'auprc': 0.9992272142909224, 'loss_val': 0.20971059193847663, 'psi': 0.9972973458598702}
[S15] START round=18 head_norm_before_train=1.792119 (no previous merge yet)
[S15] round=18 local utility u=0.095840 metrics={'f1_val': 0.9970299290849798, 'auprc': 0.9983908496971478, 'loss_val': 0.06201323114023537, 'psi': 0.9975742973298469}-{'f1_val': 0.9680577904843757, 'auprc': 0.9981190384993633, 'loss_val': 0.07904449149628502, 'psi': 0.9800822896903707}
[S16] START round=18 head_norm_before_train=1.503903 cos_to_last_merge=1.0000 (last merge round=17)
[S16] round=18 local utility u=0.079301 metrics={'f1_val': 0.8585789504086179, 'auprc': 0.8929404717254522, 'loss_val': 0.4943836934177086, 'psi': 0.8723235589353515}-{'f1_val': 0.8520900618817402, 'auprc': 0.8668958030993293, 'loss_val': 0.5359187622229171, 'psi': 0.8580123583687758}
[S17] START round=18 head_norm_before_train=1.604736 cos_to_last_merge=0.9920 (last merge round=13)
[S17] round=18 local utility u=0.312442 metrics={'f1_val': 0.5557996051817167, 'auprc': 0.811509722574613, 'loss_val': 0.5863668185182569, 'psi': 0.6580836521388752}-{'f1_val': 0.5400689767615445, 'auprc': 0.6489601966346192, 'loss_val': 0.6292178339587444, 'psi': 0.5836254647107744}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:31609
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:31603
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:31602
[S3] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:31611
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:31607
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=18 metric=0.6947 head_norm=1.388293
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.511833e-02
[S6] stored merged vector for next round verification (round=18)
[S6] DEBUG after merge:  round=18 metric=0.6947 head_norm=1.400798 delta_norm=0.085118
[S6] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S8] RECEIVED delta(kind=head bytes=1803) from S3
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.765821)
[S8] loaded HEAD from S3 (vec_in norm=1.765821)
[S8] cosine check vs S3: cos=-0.0943
[S8] DROPPED delta from S3 (cos=-0.0943 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:31611
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:31609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:31612
[S8] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] RECEIVED delta(kind=head bytes=1800) from S15
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.817323)
[S10] loaded HEAD from S15 (vec_in norm=1.817323)
[S10] cosine check vs S15: cos=-0.1264
[S10] DROPPED delta from S15 (cos=-0.1264 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1802) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.463381)
[S3] loaded HEAD from S8 (vec_in norm=1.463381)
[S3] cosine check vs S8: cos=-0.0943
[S3] DROPPED delta from S8 (cos=-0.0943 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1801) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.550514)
[S2] loaded HEAD from S11 (vec_in norm=1.550514)
[S2] cosine check vs S11: cos=0.6259
[S2] BUFFERED delta from S11 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1798) from S4
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.407312)
[S6] loaded HEAD from S4 (vec_in norm=1.407312)
[S6] cosine check vs S4: cos=0.9996
[S6] BUFFERED delta from S4 (total buffered=1)
[S17] sending update (kind=head size=1805 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1800) from S13
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.168947)
[S11] loaded HEAD from S13 (vec_in norm=1.168947)
[S11] cosine check vs S13: cos=0.3248
[S11] BUFFERED delta from S13 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1800) from S16
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.529353)
[S10] loaded HEAD from S16 (vec_in norm=1.529353)
[S10] cosine check vs S16: cos=0.9909
[S10] BUFFERED delta from S16 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1805) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.634885)
[S8] loaded HEAD from S17 (vec_in norm=1.634885)
[S8] cosine check vs S17: cos=0.0068
[S8] BUFFERED delta from S17 (total buffered=1)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=18 metric=0.9965 head_norm=1.550514
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.051565e-01
[S11] stored merged vector for next round verification (round=18)
[S11] DEBUG after merge:  round=18 metric=0.9965 head_norm=1.112200 delta_norm=0.805157
[S11] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=18 metric=0.9966 head_norm=1.463381
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.093342e+00
[S8] stored merged vector for next round verification (round=18)
[S8] DEBUG after merge:  round=18 metric=0.9964 head_norm=1.100804 delta_norm=1.093342
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=18 metric=0.7015 head_norm=1.208416
[S2] _apply_head_vector_avg (torch): Δ‖w‖=6.162298e-01
[S2] stored merged vector for next round verification (round=18)
[S2] DEBUG after merge:  round=18 metric=0.7015 head_norm=1.245971 delta_norm=0.616230
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=18 metric=0.9956 head_norm=1.719046
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.447366e-01
[S10] stored merged vector for next round verification (round=18)
[S10] DEBUG after merge:  round=18 metric=0.9952 head_norm=1.620516 delta_norm=0.144737
[S10] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.245971 cos_to_last_merge=1.0000 (last merge round=18)
[S2] round=19 local utility u=0.034621 metrics={'f1_val': 0.7012120585667497, 'auprc': 0.9935054296549493, 'loss_val': 0.42520879687874635, 'psi': 0.8181294070020295}-{'f1_val': 0.701470645897668, 'auprc': 0.9537596735051344, 'loss_val': 0.3767646647053628, 'psi': 0.8023862569406546}
[S3] START round=19 head_norm_before_train=1.765821 (no previous merge yet)
[S3] round=19 local utility u=0.000000 metrics={'f1_val': 0.960995754132836, 'auprc': 0.9984896228771198, 'loss_val': 0.10662267225471421, 'psi': 0.9759933016305495}-{'f1_val': 0.996507985077103, 'auprc': 0.9986202284474532, 'loss_val': 0.08944487686203001, 'psi': 0.9973528824252431}
[S4] START round=19 head_norm_before_train=1.407312 cos_to_last_merge=0.9998 (last merge round=17)
[S4] round=19 local utility u=0.866869 metrics={'f1_val': 0.9453568715263513, 'auprc': 0.9493050625234362, 'loss_val': 0.4477964871654821, 'psi': 0.9469361479251852}-{'f1_val': 0.6645108357845797, 'auprc': 0.9372805917368497, 'loss_val': 0.46038448138303073, 'psi': 0.7736187381654878}
[S5] START round=19 head_norm_before_train=1.283308 cos_to_last_merge=0.9916 (last merge round=14)
[S5] round=19 local utility u=0.534694 metrics={'f1_val': 0.5904469327938047, 'auprc': 0.8585075121454196, 'loss_val': 0.5032288824279008, 'psi': 0.6976711645344507}-{'f1_val': 0.4369770819312104, 'auprc': 0.8589361814079091, 'loss_val': 0.6530841541606178, 'psi': 0.6057607217218899}
[S6] START round=19 head_norm_before_train=1.400798 cos_to_last_merge=1.0000 (last merge round=18)
[S6] round=19 local utility u=0.000000 metrics={'f1_val': 0.673954981314943, 'auprc': 0.9101227017102553, 'loss_val': 0.4644753823724286, 'psi': 0.7684220694730679}-{'f1_val': 0.69473569377108, 'auprc': 0.9570600667885791, 'loss_val': 0.3539908040110044, 'psi': 0.7996654429780796}
[S7] START round=19 head_norm_before_train=1.588953 (no previous merge yet)
[S7] round=19 local utility u=0.900964 metrics={'f1_val': 0.6307153422232527, 'auprc': 0.7932760744749162, 'loss_val': 0.5912535571293603, 'psi': 0.695739635123918}-{'f1_val': 0.4087290166390023, 'auprc': 0.7810203453426228, 'loss_val': 1.0244956102803642, 'psi': 0.5576455481204505}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] sending update (kind=head size=1794 to 1 peers)
[S7] r=20 psi=0.696 u=0.9010 p_local=0.3673 f1=0.631 auprc=0.793 bytes=23373
[S8] START round=19 head_norm_before_train=1.100804 cos_to_last_merge=1.0000 (last merge round=18)
[S8] round=19 local utility u=0.000000 metrics={'f1_val': 0.9952289782211529, 'auprc': 0.9978110897096353, 'loss_val': 0.27760213408252155, 'psi': 0.9962618228165459}-{'f1_val': 0.9966398743144329, 'auprc': 0.9990584825689894, 'loss_val': 0.10963814985563425, 'psi': 0.9976073176162554}
[S9] START round=19 head_norm_before_train=1.537204 cos_to_last_merge=0.8427 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.843
[S9] round=19 local utility u=0.004684 metrics={'f1_val': 0.9966570119660778, 'auprc': 0.9983096536257438, 'loss_val': 0.04983998265898157, 'psi': 0.9973180686299442}-{'f1_val': 0.9966605118138915, 'auprc': 0.9983106631311816, 'loss_val': 0.05923242885334457, 'psi': 0.9973205723408075}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S9] r=20 psi=0.997 u=0.0047 p_local=0.1222 f1=0.997 auprc=0.998 bytes=30549
[S10] START round=19 head_norm_before_train=1.620516 cos_to_last_merge=1.0000 (last merge round=18)
[S10] round=19 local utility u=0.011332 metrics={'f1_val': 0.9962235114388667, 'auprc': 0.9977519623661235, 'loss_val': 0.08690124559998953, 'psi': 0.9968348918097694}-{'f1_val': 0.9956047769386365, 'auprc': 0.9953111063227804, 'loss_val': 0.09852940906316554, 'psi': 0.9954873086922941}
[S11] START round=19 head_norm_before_train=1.112200 cos_to_last_merge=1.0000 (last merge round=18)
[S11] round=19 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9985358239154323, 'loss_val': 0.15610988361402103, 'psi': 0.9970945345141585}-{'f1_val': 0.9965470045135896, 'auprc': 0.9985946411822237, 'loss_val': 0.07523062887560894, 'psi': 0.9973660591810433}
[S13] START round=19 head_norm_before_train=1.168947 cos_to_last_merge=0.9972 (last merge round=17)
[S13] round=19 local utility u=0.225095 metrics={'f1_val': 0.62303767777794, 'auprc': 0.7594838633930009, 'loss_val': 0.7109040471637517, 'psi': 0.6776161520239643}-{'f1_val': 0.6127504238653552, 'auprc': 0.6656835103487411, 'loss_val': 0.8179686099657815, 'psi': 0.6339236584587096}
[S14] START round=19 head_norm_before_train=1.265740 cos_to_last_merge=0.7769 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.777
[S14] round=19 local utility u=0.057739 metrics={'f1_val': 0.9501761790737713, 'auprc': 0.9972915364651016, 'loss_val': 0.18502418495246054, 'psi': 0.9690223220303034}-{'f1_val': 0.9363722521358386, 'auprc': 0.9971212279000217, 'loss_val': 0.21716756491013103, 'psi': 0.9606718424415119}
[S15] START round=19 head_norm_before_train=1.817323 (no previous merge yet)
[S15] round=19 local utility u=0.000000 metrics={'f1_val': 0.874028340172061, 'auprc': 0.9966649394350193, 'loss_val': 0.2077355856082182, 'psi': 0.9230829798772443}-{'f1_val': 0.9970299290849798, 'auprc': 0.9983908496971478, 'loss_val': 0.06201323114023537, 'psi': 0.9975742973298469}
[S16] START round=19 head_norm_before_train=1.529353 cos_to_last_merge=0.9997 (last merge round=17)
[S16] round=19 local utility u=0.262113 metrics={'f1_val': 0.9059049847317442, 'auprc': 0.9235454290369186, 'loss_val': 0.34592853814823293, 'psi': 0.9129611624538139}-{'f1_val': 0.8585789504086179, 'auprc': 0.8929404717254522, 'loss_val': 0.4943836934177086, 'psi': 0.8723235589353515}
[S17] START round=19 head_norm_before_train=1.634885 cos_to_last_merge=0.9892 (last merge round=13)
[S17] round=19 local utility u=0.000000 metrics={'f1_val': 0.47150403572437605, 'auprc': 0.5206709655877401, 'loss_val': 0.9089904829673864, 'psi': 0.49117080766972165}-{'f1_val': 0.5557996051817167, 'auprc': 0.811509722574613, 'loss_val': 0.5863668185182569, 'psi': 0.6580836521388752}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:31615
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1800 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:31616
[S3] r=20 psi=0.976 u=0.0000 p_local=0.1924 f1=0.961 auprc=0.998 bytes=26988
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=19 metric=0.6740 head_norm=1.415097
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.888280e-02
[S6] stored merged vector for next round verification (round=19)
[S6] DEBUG after merge:  round=19 metric=0.6740 head_norm=1.411084 delta_norm=0.018883
[S6] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S6] r=20 psi=0.768 u=0.0000 p_local=0.0676 f1=0.674 auprc=0.910 bytes=23347
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:31607
[S15] RECEIVED delta(kind=head bytes=1800) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.301522)
[S15] loaded HEAD from S14 (vec_in norm=1.301522)
[S15] cosine check vs S14: cos=-0.0619
[S15] DROPPED delta from S14 (cos=-0.0619 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:31612
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:31611
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:31616
[S4] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S14] r=20 psi=0.969 u=0.0577 p_local=0.1572 f1=0.950 auprc=0.997 bytes=28766
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:31613
[S6] RECEIVED delta(kind=head bytes=1800) from S4
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.428922)
[S6] loaded HEAD from S4 (vec_in norm=1.428922)
[S6] cosine check vs S4: cos=0.9997
[S6] BUFFERED delta from S4 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1799) from S2
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.282816)
[S16] loaded HEAD from S2 (vec_in norm=1.282816)
[S16] cosine check vs S2: cos=0.4975
[S16] BUFFERED delta from S2 (total buffered=1)
[S16] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1801) from S13
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.206143)
[S11] loaded HEAD from S13 (vec_in norm=1.206143)
[S11] cosine check vs S13: cos=0.7598
[S11] BUFFERED delta from S13 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1797) from S16
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.563667)
[S10] loaded HEAD from S16 (vec_in norm=1.563667)
[S10] cosine check vs S16: cos=0.9963
[S10] BUFFERED delta from S16 (total buffered=1)
[S5] sending update (kind=head size=1801 to 1 peers)
[S8] r=20 psi=0.996 u=0.0000 p_local=0.1852 f1=0.995 auprc=0.998 bytes=25157
[S15] r=20 psi=0.923 u=0.0000 p_local=0.2591 f1=0.874 auprc=0.997 bytes=26979
[S10] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S10
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.639697)
[S16] loaded HEAD from S10 (vec_in norm=1.639697)
[S16] cosine check vs S10: cos=0.9963
[S16] BUFFERED delta from S10 (total buffered=2)
[S13] RECEIVED delta(kind=head bytes=1801) from S5
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.302866)
[S13] loaded HEAD from S5 (vec_in norm=1.302866)
[S13] cosine check vs S5: cos=0.9516
[S13] BUFFERED delta from S5 (total buffered=1)
[S17] r=20 psi=0.491 u=0.0000 p_local=0.1678 f1=0.472 auprc=0.521 bytes=25188
[S4] r=20 psi=0.947 u=0.8669 p_local=0.2722 f1=0.945 auprc=0.949 bytes=26965
[S2] r=20 psi=0.818 u=0.0346 p_local=0.1332 f1=0.701 auprc=0.994 bytes=21595
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=19 metric=0.6230 head_norm=1.206143
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.009834e-01
[S13] stored merged vector for next round verification (round=19)
[S13] DEBUG after merge:  round=19 metric=0.6228 head_norm=1.239244 delta_norm=0.200983
[S13] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S13] r=20 psi=0.678 u=0.2251 p_local=0.1314 f1=0.623 auprc=0.759 bytes=23347
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=19 metric=0.9059 head_norm=1.563667
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.337864e-01
[S16] stored merged vector for next round verification (round=19)
[S16] DEBUG after merge:  round=19 metric=0.8935 head_norm=1.373886 delta_norm=0.333786
[S16] aggregate: ROLLBACK (f1_val pre=0.906 post=0.894 tol_abs=0.005 tol_rel=0.0)
[S16] r=20 psi=0.913 u=0.2621 p_local=0.2990 f1=0.906 auprc=0.924 bytes=21567
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=19 metric=0.9961 head_norm=1.160778
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.106846e-01
[S11] stored merged vector for next round verification (round=19)
[S11] DEBUG after merge:  round=19 metric=0.9965 head_norm=1.110149 delta_norm=0.410685
[S11] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S11] r=20 psi=0.997 u=0.0000 p_local=0.1474 f1=0.996 auprc=0.999 bytes=26955
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=19 metric=0.9962 head_norm=1.639697
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.869179e-02
[S10] stored merged vector for next round verification (round=19)
[S10] DEBUG after merge:  round=19 metric=0.9962 head_norm=1.600200 delta_norm=0.078692
[S10] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S10] r=20 psi=0.997 u=0.0113 p_local=0.1399 f1=0.996 auprc=0.998 bytes=23393
[S5] r=20 psi=0.698 u=0.5347 p_local=0.1579 f1=0.590 auprc=0.859 bytes=30506
[S2] START round=20 head_norm_before_train=1.282816 cos_to_last_merge=0.9974 (last merge round=18)
[S2] round=20 local utility u=0.033524 metrics={'f1_val': 0.7013925629565125, 'auprc': 0.9925311455759926, 'loss_val': 0.3563214898484942, 'psi': 0.8178479960043046}-{'f1_val': 0.7012120585667497, 'auprc': 0.9935054296549493, 'loss_val': 0.42520879687874635, 'psi': 0.8181294070020295}
[S3] START round=20 head_norm_before_train=1.792147 (no previous merge yet)
[S3] round=20 local utility u=0.035561 metrics={'f1_val': 0.9695278002819185, 'auprc': 0.9988042091094254, 'loss_val': 0.08763625578245507, 'psi': 0.9812383638129213}-{'f1_val': 0.960995754132836, 'auprc': 0.9984896228771198, 'loss_val': 0.10662267225471421, 'psi': 0.9759933016305495}
[S4] START round=20 head_norm_before_train=1.428922 cos_to_last_merge=0.9991 (last merge round=17)
[S4] round=20 local utility u=0.014104 metrics={'f1_val': 0.9426973132798802, 'auprc': 0.9517470589420857, 'loss_val': 0.4109563531795107, 'psi': 0.9463172115447623}-{'f1_val': 0.9453568715263513, 'auprc': 0.9493050625234362, 'loss_val': 0.4477964871654821, 'psi': 0.9469361479251852}
[S5] START round=20 head_norm_before_train=1.302866 cos_to_last_merge=0.9890 (last merge round=14)
[S5] round=20 local utility u=0.552467 metrics={'f1_val': 0.7008175646132602, 'auprc': 0.9615036554219006, 'loss_val': 0.36950746657713135, 'psi': 0.8050920009367164}-{'f1_val': 0.5904469327938047, 'auprc': 0.8585075121454196, 'loss_val': 0.5032288824279008, 'psi': 0.6976711645344507}
[S6] START round=20 head_norm_before_train=1.411084 cos_to_last_merge=1.0000 (last merge round=19)
[S6] round=20 local utility u=0.174835 metrics={'f1_val': 0.6937365324655709, 'auprc': 0.9542884810032628, 'loss_val': 0.36599254454525026, 'psi': 0.7979573118806477}-{'f1_val': 0.673954981314943, 'auprc': 0.9101227017102553, 'loss_val': 0.4644753823724286, 'psi': 0.7684220694730679}
[S7] START round=20 head_norm_before_train=1.595636 (no previous merge yet)
[S7] round=20 local utility u=0.000000 metrics={'f1_val': 0.44653877674206954, 'auprc': 0.7810237399776578, 'loss_val': 0.9238274476132512, 'psi': 0.5803327620363048}-{'f1_val': 0.6307153422232527, 'auprc': 0.7932760744749162, 'loss_val': 0.5912535571293603, 'psi': 0.695739635123918}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=20 head_norm_before_train=1.141602 cos_to_last_merge=0.9986 (last merge round=18)
[S8] round=20 local utility u=0.047562 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9989511242475787, 'loss_val': 0.19264374898146236, 'psi': 0.9973922946604062}-{'f1_val': 0.9952289782211529, 'auprc': 0.9978110897096353, 'loss_val': 0.27760213408252155, 'psi': 0.9962618228165459}
[S9] START round=20 head_norm_before_train=1.565014 cos_to_last_merge=0.8371 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.837
[S9] round=20 local utility u=0.001805 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9983079915769845, 'loss_val': 0.04390938347516652, 'psi': 0.9970858140690375}-{'f1_val': 0.9966570119660778, 'auprc': 0.9983096536257438, 'loss_val': 0.04983998265898157, 'psi': 0.9973180686299442}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S10] START round=20 head_norm_before_train=1.600200 cos_to_last_merge=1.0000 (last merge round=19)
[S10] round=20 local utility u=0.000000 metrics={'f1_val': 0.9949085473053089, 'auprc': 0.9967973291364742, 'loss_val': 0.08233759853805855, 'psi': 0.995664060037775}-{'f1_val': 0.9962235114388667, 'auprc': 0.9977519623661235, 'loss_val': 0.08690124559998953, 'psi': 0.9968348918097694}
[S11] START round=20 head_norm_before_train=1.110149 cos_to_last_merge=1.0000 (last merge round=19)
[S11] round=20 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9981451145181244, 'loss_val': 0.19235655488606318, 'psi': 0.9971862485154035}-{'f1_val': 0.9961336749133093, 'auprc': 0.9985358239154323, 'loss_val': 0.15610988361402103, 'psi': 0.9970945345141585}
[S13] START round=20 head_norm_before_train=1.239244 cos_to_last_merge=1.0000 (last merge round=19)
[S13] round=20 local utility u=0.000000 metrics={'f1_val': 0.6006445619633352, 'auprc': 0.7561277629728216, 'loss_val': 0.7528160127030382, 'psi': 0.6628378423671297}-{'f1_val': 0.62303767777794, 'auprc': 0.7594838633930009, 'loss_val': 0.7109040471637517, 'psi': 0.6776161520239643}
[S14] START round=20 head_norm_before_train=1.301522 cos_to_last_merge=0.7710 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.771
[S14] round=20 local utility u=0.176893 metrics={'f1_val': 0.9974992264159193, 'auprc': 0.9979116141716737, 'loss_val': 0.11703737568814272, 'psi': 0.997664181518221}-{'f1_val': 0.9501761790737713, 'auprc': 0.9972915364651016, 'loss_val': 0.18502418495246054, 'psi': 0.9690223220303034}
[S15] START round=20 head_norm_before_train=1.842303 (no previous merge yet)
[S15] round=20 local utility u=0.459564 metrics={'f1_val': 0.9975479273409924, 'auprc': 0.9997657163084495, 'loss_val': 0.039027670433400684, 'psi': 0.9984350429279752}-{'f1_val': 0.874028340172061, 'auprc': 0.9966649394350193, 'loss_val': 0.2077355856082182, 'psi': 0.9230829798772443}
[S16] START round=20 head_norm_before_train=1.373886 cos_to_last_merge=1.0000 (last merge round=19)
[S16] round=20 local utility u=0.000000 metrics={'f1_val': 0.8836196617415066, 'auprc': 0.9458809110730215, 'loss_val': 0.3493327814231031, 'psi': 0.9085241614741125}-{'f1_val': 0.9059049847317442, 'auprc': 0.9235454290369186, 'loss_val': 0.34592853814823293, 'psi': 0.9129611624538139}
[S17] START round=20 head_norm_before_train=1.661539 cos_to_last_merge=0.9867 (last merge round=13)
[S17] round=20 local utility u=0.760193 metrics={'f1_val': 0.5663427551945283, 'auprc': 0.751012407959124, 'loss_val': 0.6486601417223351, 'psi': 0.6402106163003666}-{'f1_val': 0.47150403572437605, 'auprc': 0.5206709655877401, 'loss_val': 0.9089904829673864, 'psi': 0.49117080766972165}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:31609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:31604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:31615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:31603
[S14] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] → sending delta(kind=head bytes=1805) to S10@127.0.0.1:31611
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S4] → sending delta(kind=head bytes=1808) to S6@127.0.0.1:31607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:31616
[S3] sending update (kind=head size=1797 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1802) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.329522)
[S15] loaded HEAD from S14 (vec_in norm=1.329522)
[S15] cosine check vs S14: cos=-0.0621
[S15] DROPPED delta from S14 (cos=-0.0621 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1803) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.425664)
[S4] loaded HEAD from S6 (vec_in norm=1.425664)
[S4] cosine check vs S6: cos=0.9984
[S4] BUFFERED delta from S6 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1797) from S3
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.812988)
[S8] loaded HEAD from S3 (vec_in norm=1.812988)
[S8] cosine check vs S3: cos=-0.0887
[S8] DROPPED delta from S3 (cos=-0.0887 < 0.0)
[S4] sending update (kind=head size=1808 to 1 peers)
[S14] ⇄ pheromone p=0.161 → S15@127.0.0.1:31615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:31613
[S8] sending update (kind=head size=1798 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=20 metric=0.6937 head_norm=1.425664
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.499285e-02
[S6] stored merged vector for next round verification (round=20)
[S6] DEBUG after merge:  round=20 metric=0.6937 head_norm=1.427075 delta_norm=0.024993
[S6] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.089 → S4@127.0.0.1:31604
[S3] ⇄ pheromone p=0.161 → S8@127.0.0.1:31609
[S2] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1805 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S2
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.325915)
[S16] loaded HEAD from S2 (vec_in norm=1.325915)
[S16] cosine check vs S2: cos=0.6596
[S16] BUFFERED delta from S2 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1798) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.202925)
[S3] loaded HEAD from S8 (vec_in norm=1.202925)
[S3] cosine check vs S8: cos=-0.0887
[S3] DROPPED delta from S8 (cos=-0.0887 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1808) from S4
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.456039)
[S6] loaded HEAD from S4 (vec_in norm=1.456039)
[S6] cosine check vs S4: cos=0.9992
[S6] BUFFERED delta from S4 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1805) from S15
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.865976)
[S10] loaded HEAD from S15 (vec_in norm=1.865976)
[S10] cosine check vs S15: cos=-0.1247
[S10] DROPPED delta from S15 (cos=-0.1247 < 0.0)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] → sending delta(kind=head bytes=1806) to S8@127.0.0.1:31609
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1803 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1803) from S5
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.324565)
[S13] loaded HEAD from S5 (vec_in norm=1.324565)
[S13] cosine check vs S5: cos=0.9757
[S13] BUFFERED delta from S5 (total buffered=1)
[S17] sending update (kind=head size=1806 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1806) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.687127)
[S8] loaded HEAD from S17 (vec_in norm=1.687127)
[S8] cosine check vs S17: cos=0.6886
[S8] BUFFERED delta from S17 (total buffered=1)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=20 metric=0.9427 head_norm=1.456039
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.329827e-02
[S4] stored merged vector for next round verification (round=20)
[S4] DEBUG after merge:  round=20 metric=0.9435 head_norm=1.440281 delta_norm=0.043298
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.221 → S9@127.0.0.1:31610
[S2] ⇄ pheromone p=0.113 → S16@127.0.0.1:31616
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=20 metric=0.9964 head_norm=1.202925
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.120677e-01
[S8] stored merged vector for next round verification (round=20)
[S8] DEBUG after merge:  round=20 metric=0.9964 head_norm=1.331198 delta_norm=0.612068
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.158 → S17@127.0.0.1:31617
[S15] ⇄ pheromone p=0.299 → S10@127.0.0.1:31611
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=20 metric=0.8836 head_norm=1.415182
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.669065e-01
[S16] stored merged vector for next round verification (round=20)
[S16] DEBUG after merge:  round=20 metric=0.8539 head_norm=1.248604 delta_norm=0.566906
[S16] aggregate: ROLLBACK (f1_val pre=0.884 post=0.854 tol_abs=0.005 tol_rel=0.0)
[S16] ⇄ pheromone p=0.239 → S10@127.0.0.1:31611
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=20 metric=0.6006 head_norm=1.274680
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.454872e-01
[S13] stored merged vector for next round verification (round=20)
[S13] DEBUG after merge:  round=20 metric=0.6015 head_norm=1.291694 delta_norm=0.145487
[S13] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.105 → S11@127.0.0.1:31612
[S11] ⇄ pheromone p=0.118 → S2@127.0.0.1:31602
[S10] ⇄ pheromone p=0.112 → S16@127.0.0.1:31616
[S17] ⇄ pheromone p=0.286 → S7@127.0.0.1:31608
[S5] ⇄ pheromone p=0.237 → S13@127.0.0.1:31613
[S2] START round=21 head_norm_before_train=1.325915 cos_to_last_merge=0.9912 (last merge round=18)
[S2] round=21 local utility u=0.000000 metrics={'f1_val': 0.7009533202285976, 'auprc': 0.9293630628407851, 'loss_val': 0.3294642421691515, 'psi': 0.7923172172734725}-{'f1_val': 0.7013925629565125, 'auprc': 0.9925311455759926, 'loss_val': 0.3563214898484942, 'psi': 0.8178479960043046}
[S3] START round=21 head_norm_before_train=1.812988 (no previous merge yet)
[S3] round=21 local utility u=0.096639 metrics={'f1_val': 0.9973670153333725, 'auprc': 0.998853124736961, 'loss_val': 0.06154004641420129, 'psi': 0.9979614590948078}-{'f1_val': 0.9695278002819185, 'auprc': 0.9988042091094254, 'loss_val': 0.08763625578245507, 'psi': 0.9812383638129213}
[S4] START round=21 head_norm_before_train=1.440281 cos_to_last_merge=1.0000 (last merge round=20)
[S4] round=21 local utility u=0.064135 metrics={'f1_val': 0.9475815417577066, 'auprc': 0.9537223881217085, 'loss_val': 0.3179172191507309, 'psi': 0.9500378803033074}-{'f1_val': 0.9426973132798802, 'auprc': 0.9517470589420857, 'loss_val': 0.4109563531795107, 'psi': 0.9463172115447623}
[S5] START round=21 head_norm_before_train=1.324565 cos_to_last_merge=0.9858 (last merge round=14)
[S5] round=21 local utility u=0.000000 metrics={'f1_val': 0.6097785270573368, 'auprc': 0.8539257332410152, 'loss_val': 0.5002969283583101, 'psi': 0.7074374095308082}-{'f1_val': 0.7008175646132602, 'auprc': 0.9615036554219006, 'loss_val': 0.36950746657713135, 'psi': 0.8050920009367164}
[S6] START round=21 head_norm_before_train=1.427075 cos_to_last_merge=1.0000 (last merge round=20)
[S6] round=21 local utility u=0.031760 metrics={'f1_val': 0.6945688534257362, 'auprc': 0.9572113555130133, 'loss_val': 0.31623459360496664, 'psi': 0.799625854260647}-{'f1_val': 0.6937365324655709, 'auprc': 0.9542884810032628, 'loss_val': 0.36599254454525026, 'psi': 0.7979573118806477}
[S7] START round=21 head_norm_before_train=1.601421 (no previous merge yet)
[S7] round=21 local utility u=1.000000 metrics={'f1_val': 0.6835861318998897, 'auprc': 0.8605244168662535, 'loss_val': 0.3880900366102326, 'psi': 0.7543614458864352}-{'f1_val': 0.44653877674206954, 'auprc': 0.7810237399776578, 'loss_val': 0.9238274476132512, 'psi': 0.5803327620363048}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=21 head_norm_before_train=1.331198 cos_to_last_merge=1.0000 (last merge round=20)
[S8] round=21 local utility u=0.000000 metrics={'f1_val': 0.9950790219939822, 'auprc': 0.997233934184947, 'loss_val': 0.31753877782970324, 'psi': 0.9959409868703681}-{'f1_val': 0.9963530749356245, 'auprc': 0.9989511242475787, 'loss_val': 0.19264374898146236, 'psi': 0.9973922946604062}
[S9] START round=21 head_norm_before_train=1.591978 cos_to_last_merge=0.8323 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.832
[S9] round=21 local utility u=0.000000 metrics={'f1_val': 0.9950237510807955, 'auprc': 0.9983733295222261, 'loss_val': 0.04036973499420883, 'psi': 0.9963635824573678}-{'f1_val': 0.9962710290637395, 'auprc': 0.9983079915769845, 'loss_val': 0.04390938347516652, 'psi': 0.9970858140690375}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=21 head_norm_before_train=1.623080 cos_to_last_merge=0.9995 (last merge round=19)
[S10] round=21 local utility u=0.000000 metrics={'f1_val': 0.9938128314971357, 'auprc': 0.9958442341451695, 'loss_val': 0.07298725858057312, 'psi': 0.9946253925563492}-{'f1_val': 0.9949085473053089, 'auprc': 0.9967973291364742, 'loss_val': 0.08233759853805855, 'psi': 0.995664060037775}
[S11] START round=21 head_norm_before_train=1.169416 cos_to_last_merge=0.9974 (last merge round=19)
[S11] round=21 local utility u=0.028074 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9982360921366142, 'loss_val': 0.136480705258203, 'psi': 0.9972226395627994}-{'f1_val': 0.9965470045135896, 'auprc': 0.9981451145181244, 'loss_val': 0.19235655488606318, 'psi': 0.9971862485154035}
[S13] START round=21 head_norm_before_train=1.291694 cos_to_last_merge=1.0000 (last merge round=20)
[S13] round=21 local utility u=0.146656 metrics={'f1_val': 0.6192646638409582, 'auprc': 0.7886550418196233, 'loss_val': 0.6688058249111162, 'psi': 0.6870208150324243}-{'f1_val': 0.6006445619633352, 'auprc': 0.7561277629728216, 'loss_val': 0.7528160127030382, 'psi': 0.6628378423671297}
[S14] START round=21 head_norm_before_train=1.329522 cos_to_last_merge=0.7666 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.767
[S14] round=21 local utility u=0.000000 metrics={'f1_val': 0.9302244113595544, 'auprc': 0.9934271516848523, 'loss_val': 0.22064796578710555, 'psi': 0.9555055074896734}-{'f1_val': 0.9974992264159193, 'auprc': 0.9979116141716737, 'loss_val': 0.11703737568814272, 'psi': 0.997664181518221}
[S15] START round=21 head_norm_before_train=1.865976 (no previous merge yet)
[S15] round=21 local utility u=0.000000 metrics={'f1_val': 0.7693611654384097, 'auprc': 0.9576204981768651, 'loss_val': 0.29297039733447816, 'psi': 0.8446648985337919}-{'f1_val': 0.9975479273409924, 'auprc': 0.9997657163084495, 'loss_val': 0.039027670433400684, 'psi': 0.9984350429279752}
[S16] START round=21 head_norm_before_train=1.248604 cos_to_last_merge=1.0000 (last merge round=20)
[S16] round=21 local utility u=0.000000 metrics={'f1_val': 0.8244415973477159, 'auprc': 0.8877297582174666, 'loss_val': 0.6669765758794557, 'psi': 0.8497568616956162}-{'f1_val': 0.8836196617415066, 'auprc': 0.9458809110730215, 'loss_val': 0.3493327814231031, 'psi': 0.9085241614741125}
[S17] START round=21 head_norm_before_train=1.687127 cos_to_last_merge=0.9845 (last merge round=13)
[S17] round=21 local utility u=0.053250 metrics={'f1_val': 0.571343989727955, 'auprc': 0.7831078917334535, 'loss_val': 0.6684530507668512, 'psi': 0.6560495505301545}-{'f1_val': 0.5663427551945283, 'auprc': 0.751012407959124, 'loss_val': 0.6486601417223351, 'psi': 0.6402106163003666}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:31609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:31604
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S2@127.0.0.1:31602
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] → sending delta(kind=head bytes=1805) to S9@127.0.0.1:31610
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1796) from S3
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.829331)
[S8] loaded HEAD from S3 (vec_in norm=1.829331)
[S8] cosine check vs S3: cos=-0.0653
[S8] DROPPED delta from S3 (cos=-0.0653 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1803) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.440537)
[S4] loaded HEAD from S6 (vec_in norm=1.440537)
[S4] cosine check vs S6: cos=0.9987
[S4] BUFFERED delta from S6 (total buffered=1)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1794 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=21 metric=0.6946 head_norm=1.440537
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.967493e-02
[S6] stored merged vector for next round verification (round=21)
[S6] DEBUG after merge:  round=21 metric=0.6946 head_norm=1.447765 delta_norm=0.039675
[S6] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] sending update (kind=head size=1805 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1805) from S4
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.468789)
[S9] loaded HEAD from S4 (vec_in norm=1.468789)
[S9] cosine check vs S4: cos=-0.0430
[S9] DROPPED delta from S4 (cos=-0.0430 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1794) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.239503)
[S2] loaded HEAD from S11 (vec_in norm=1.239503)
[S2] cosine check vs S11: cos=0.5956
[S2] BUFFERED delta from S11 (total buffered=1)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:31608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:31612
[S17] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1799) from S17
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.711655)
[S7] loaded HEAD from S17 (vec_in norm=1.711655)
[S7] cosine check vs S17: cos=0.9615
[S7] BUFFERED delta from S17 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1798) from S13
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.322021)
[S11] loaded HEAD from S13 (vec_in norm=1.322021)
[S11] cosine check vs S13: cos=0.8260
[S11] BUFFERED delta from S13 (total buffered=1)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=21 metric=0.9965 head_norm=1.239503
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.798227e-01
[S11] stored merged vector for next round verification (round=21)
[S11] DEBUG after merge:  round=21 metric=0.9965 head_norm=1.223842 delta_norm=0.379823
[S11] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=21 metric=0.9476 head_norm=1.468789
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.955051e-02
[S4] stored merged vector for next round verification (round=21)
[S4] DEBUG after merge:  round=21 metric=0.9488 head_norm=1.454194 delta_norm=0.039551
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=21 metric=0.7010 head_norm=1.365501
[S2] _apply_head_vector_avg (torch): Δ‖w‖=5.883815e-01
[S2] stored merged vector for next round verification (round=21)
[S2] DEBUG after merge:  round=21 metric=0.7012 head_norm=1.163739 delta_norm=0.588381
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.163739 cos_to_last_merge=1.0000 (last merge round=21)
[S2] round=22 local utility u=0.012508 metrics={'f1_val': 0.69634226766058, 'auprc': 0.9866538870498808, 'loss_val': 0.4486536060526492, 'psi': 0.8124669154163005}-{'f1_val': 0.7009533202285976, 'auprc': 0.9293630628407851, 'loss_val': 0.3294642421691515, 'psi': 0.7923172172734725}
[S3] START round=22 head_norm_before_train=1.829331 (no previous merge yet)
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.7009355793019081, 'auprc': 0.9986915410429649, 'loss_val': 0.3462301821133372, 'psi': 0.8200379639983308}-{'f1_val': 0.9973670153333725, 'auprc': 0.998853124736961, 'loss_val': 0.06154004641420129, 'psi': 0.9979614590948078}
[S4] START round=22 head_norm_before_train=1.454194 cos_to_last_merge=1.0000 (last merge round=21)
[S4] round=22 local utility u=0.000000 metrics={'f1_val': 0.9383626795443388, 'auprc': 0.9430806928347941, 'loss_val': 0.3363272113152836, 'psi': 0.940249884860521}-{'f1_val': 0.9475815417577066, 'auprc': 0.9537223881217085, 'loss_val': 0.3179172191507309, 'psi': 0.9500378803033074}
[S5] START round=22 head_norm_before_train=1.342270 cos_to_last_merge=0.9825 (last merge round=14)
[S5] round=22 local utility u=0.565560 metrics={'f1_val': 0.7005699347162762, 'auprc': 0.9931107720773593, 'loss_val': 0.3314808575838243, 'psi': 0.8175862696607095}-{'f1_val': 0.6097785270573368, 'auprc': 0.8539257332410152, 'loss_val': 0.5002969283583101, 'psi': 0.7074374095308082}
[S6] START round=22 head_norm_before_train=1.447765 cos_to_last_merge=1.0000 (last merge round=21)
[S6] round=22 local utility u=0.000000 metrics={'f1_val': 0.6370106602288158, 'auprc': 0.905905116542975, 'loss_val': 0.47829155195953343, 'psi': 0.7445684427544794}-{'f1_val': 0.6945688534257362, 'auprc': 0.9572113555130133, 'loss_val': 0.31623459360496664, 'psi': 0.799625854260647}
[S7] START round=22 head_norm_before_train=1.607689 (no previous merge yet)
[S7] round=22 local utility u=0.000000 metrics={'f1_val': 0.6133606392002421, 'auprc': 0.7876290313139631, 'loss_val': 0.6402308731948112, 'psi': 0.6830679960457305}-{'f1_val': 0.6835861318998897, 'auprc': 0.8605244168662535, 'loss_val': 0.3880900366102326, 'psi': 0.7543614458864352}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=22 metric=0.6134 head_norm=1.615317
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.374041e-01
[S7] stored merged vector for next round verification (round=22)
[S7] DEBUG after merge:  round=22 metric=0.6325 head_norm=1.647163 delta_norm=0.237404
[S7] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] START round=22 head_norm_before_train=1.372175 cos_to_last_merge=0.9971 (last merge round=20)
[S8] round=22 local utility u=0.064338 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9992062761646312, 'loss_val': 0.2024233496173998, 'psi': 0.9974943554272273}-{'f1_val': 0.9950790219939822, 'auprc': 0.997233934184947, 'loss_val': 0.31753877782970324, 'psi': 0.9959409868703681}
[S9] START round=22 head_norm_before_train=1.613882 cos_to_last_merge=0.8281 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.828
[S9] round=22 local utility u=0.000000 metrics={'f1_val': 0.9858544878796963, 'auprc': 0.9986906546839374, 'loss_val': 0.06067505298143037, 'psi': 0.9909889546013928}-{'f1_val': 0.9950237510807955, 'auprc': 0.9983733295222261, 'loss_val': 0.04036973499420883, 'psi': 0.9963635824573678}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=22 head_norm_before_train=1.652076 cos_to_last_merge=0.9979 (last merge round=19)
[S10] round=22 local utility u=0.002470 metrics={'f1_val': 0.9933750578586366, 'auprc': 0.995743735707032, 'loss_val': 0.06511922889932864, 'psi': 0.9943225289979947}-{'f1_val': 0.9938128314971357, 'auprc': 0.9958442341451695, 'loss_val': 0.07298725858057312, 'psi': 0.9946253925563492}
[S11] START round=22 head_norm_before_train=1.223842 cos_to_last_merge=1.0000 (last merge round=21)
[S11] round=22 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9978062943128132, 'loss_val': 0.1776151497027728, 'psi': 0.997050720433279}-{'f1_val': 0.9965470045135896, 'auprc': 0.9982360921366142, 'loss_val': 0.136480705258203, 'psi': 0.9972226395627994}
[S13] START round=22 head_norm_before_train=1.322021 cos_to_last_merge=0.9980 (last merge round=20)
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.5896153326323839, 'auprc': 0.6840655429122864, 'loss_val': 0.7684540938063096, 'psi': 0.627395416744345}-{'f1_val': 0.6192646638409582, 'auprc': 0.7886550418196233, 'loss_val': 0.6688058249111162, 'psi': 0.6870208150324243}
[S14] START round=22 head_norm_before_train=1.362807 cos_to_last_merge=0.7618 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.762
[S14] round=22 local utility u=0.276693 metrics={'f1_val': 0.997673454559638, 'auprc': 0.9978833348621864, 'loss_val': 0.08532533160348645, 'psi': 0.9977574066806574}-{'f1_val': 0.9302244113595544, 'auprc': 0.9934271516848523, 'loss_val': 0.22064796578710555, 'psi': 0.9555055074896734}
[S15] START round=22 head_norm_before_train=1.885915 (no previous merge yet)
[S15] round=22 local utility u=0.584540 metrics={'f1_val': 0.9109270321583658, 'auprc': 0.9988455423386288, 'loss_val': 0.0969612699543816, 'psi': 0.946094436230471}-{'f1_val': 0.7693611654384097, 'auprc': 0.9576204981768651, 'loss_val': 0.29297039733447816, 'psi': 0.8446648985337919}
[S16] START round=22 head_norm_before_train=1.294271 cos_to_last_merge=0.9981 (last merge round=20)
[S16] round=22 local utility u=0.506972 metrics={'f1_val': 0.9119346743196955, 'auprc': 0.9625842060807107, 'loss_val': 0.4025545149919692, 'psi': 0.9321944870241016}-{'f1_val': 0.8244415973477159, 'auprc': 0.8877297582174666, 'loss_val': 0.6669765758794557, 'psi': 0.8497568616956162}
[S17] START round=22 head_norm_before_train=1.711655 cos_to_last_merge=0.9825 (last merge round=13)
[S17] round=22 local utility u=0.097722 metrics={'f1_val': 0.5792259062218863, 'auprc': 0.8440657282988638, 'loss_val': 0.7031748373249894, 'psi': 0.6851618350526774}-{'f1_val': 0.571343989727955, 'auprc': 0.7831078917334535, 'loss_val': 0.6684530507668512, 'psi': 0.6560495505301545}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:31615
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S10@127.0.0.1:31611
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:31616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:31617
[S15] RECEIVED delta(kind=head bytes=1795) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.392492)
[S15] loaded HEAD from S14 (vec_in norm=1.392492)
[S15] cosine check vs S14: cos=-0.0625
[S15] DROPPED delta from S14 (cos=-0.0625 < 0.0)
[S2] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1805 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S13@127.0.0.1:31613
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:31615
[S17] RECEIVED delta(kind=head bytes=1805) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.428159)
[S17] loaded HEAD from S8 (vec_in norm=1.428159)
[S17] cosine check vs S8: cos=0.8908
[S17] BUFFERED delta from S8 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1799) from S2
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.196239)
[S16] loaded HEAD from S2 (vec_in norm=1.196239)
[S16] cosine check vs S2: cos=0.7362
[S16] BUFFERED delta from S2 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1804) from S15
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.903478)
[S10] loaded HEAD from S15 (vec_in norm=1.903478)
[S10] cosine check vs S15: cos=-0.1174
[S10] DROPPED delta from S15 (cos=-0.1174 < 0.0)
[S10] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1804 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1804) from S5
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.355954)
[S13] loaded HEAD from S5 (vec_in norm=1.355954)
[S13] cosine check vs S5: cos=0.9762
[S13] BUFFERED delta from S5 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1801) from S10
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.682930)
[S15] loaded HEAD from S10 (vec_in norm=1.682930)
[S15] cosine check vs S10: cos=-0.1174
[S15] DROPPED delta from S10 (cos=-0.1174 < 0.0)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:31608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] → sending delta(kind=head bytes=1793) to S2@127.0.0.1:31602
[S16] sending update (kind=head size=1793 to 1 peers)
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1793) from S16
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.346372)
[S2] loaded HEAD from S16 (vec_in norm=1.346372)
[S2] cosine check vs S16: cos=0.7362
[S2] BUFFERED delta from S16 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1802) from S17
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.736239)
[S7] loaded HEAD from S17 (vec_in norm=1.736239)
[S7] cosine check vs S17: cos=0.9896
[S7] BUFFERED delta from S17 (total buffered=1)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=22 metric=0.5896 head_norm=1.352269
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.477873e-01
[S13] stored merged vector for next round verification (round=22)
[S13] DEBUG after merge:  round=22 metric=0.5900 head_norm=1.346024 delta_norm=0.147787
[S13] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=22 metric=0.5792 head_norm=1.736239
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.989521e-01
[S17] stored merged vector for next round verification (round=22)
[S17] DEBUG after merge:  round=22 metric=0.6162 head_norm=1.538805 delta_norm=0.398952
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=22 metric=0.9119 head_norm=1.346372
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.669699e-01
[S16] stored merged vector for next round verification (round=22)
[S16] DEBUG after merge:  round=22 metric=0.9199 head_norm=1.184818 delta_norm=0.466970
[S16] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.196239 cos_to_last_merge=0.9980 (last merge round=21)
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.7011337461190337, 'auprc': 0.8589162002287785, 'loss_val': 0.36154945764647367, 'psi': 0.7642467277629317}-{'f1_val': 0.69634226766058, 'auprc': 0.9866538870498808, 'loss_val': 0.4486536060526492, 'psi': 0.8124669154163005}
[S3] START round=23 head_norm_before_train=1.842261 (no previous merge yet)
[S3] round=23 local utility u=1.000000 metrics={'f1_val': 0.9978100342676263, 'auprc': 0.9988640642623781, 'loss_val': 0.0530515394754758, 'psi': 0.998231646265527}-{'f1_val': 0.7009355793019081, 'auprc': 0.9986915410429649, 'loss_val': 0.3462301821133372, 'psi': 0.8200379639983308}
[S4] START round=23 head_norm_before_train=1.484079 cos_to_last_merge=0.9996 (last merge round=21)
[S4] round=23 local utility u=0.070293 metrics={'f1_val': 0.9420214402436983, 'auprc': 0.9635747306665233, 'loss_val': 0.27917499805523116, 'psi': 0.9506427564128284}-{'f1_val': 0.9383626795443388, 'auprc': 0.9430806928347941, 'loss_val': 0.3363272113152836, 'psi': 0.940249884860521}
[S5] START round=23 head_norm_before_train=1.355954 cos_to_last_merge=0.9800 (last merge round=14)
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.43728475310475723, 'auprc': 0.8539325506886057, 'loss_val': 0.6804685881688184, 'psi': 0.6039438721382966}-{'f1_val': 0.7005699347162762, 'auprc': 0.9931107720773593, 'loss_val': 0.3314808575838243, 'psi': 0.8175862696607095}
[S6] START round=23 head_norm_before_train=1.456109 cos_to_last_merge=0.9997 (last merge round=21)
[S6] round=23 local utility u=1.000000 metrics={'f1_val': 0.9462582267373691, 'auprc': 0.9537357371560824, 'loss_val': 0.32720583996195224, 'psi': 0.9492492309048544}-{'f1_val': 0.6370106602288158, 'auprc': 0.905905116542975, 'loss_val': 0.47829155195953343, 'psi': 0.7445684427544794}
[S7] START round=23 head_norm_before_train=1.647163 cos_to_last_merge=1.0000 (last merge round=22)
[S7] round=23 local utility u=0.000000 metrics={'f1_val': 0.5470514508195463, 'auprc': 0.7823995994673334, 'loss_val': 0.7554643536432727, 'psi': 0.6411907102786611}-{'f1_val': 0.6133606392002421, 'auprc': 0.7876290313139631, 'loss_val': 0.6402308731948112, 'psi': 0.6830679960457305}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=23 metric=0.5471 head_norm=1.656054
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.330790e-01
[S7] stored merged vector for next round verification (round=23)
[S7] DEBUG after merge:  round=23 metric=0.5634 head_norm=1.691393 delta_norm=0.133079
[S7] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] START round=23 head_norm_before_train=1.428159 cos_to_last_merge=0.9883 (last merge round=20)
[S8] round=23 local utility u=0.026698 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9980341921245965, 'loss_val': 0.1446105554680941, 'psi': 0.9969355388899304}-{'f1_val': 0.9963530749356245, 'auprc': 0.9992062761646312, 'loss_val': 0.2024233496173998, 'psi': 0.9974943554272273}
[S9] START round=23 head_norm_before_train=1.632516 cos_to_last_merge=0.8251 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.825
[S9] round=23 local utility u=0.037390 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9936915050066985, 'loss_val': 0.03592463961346883, 'psi': 0.9954920967615367}-{'f1_val': 0.9858544878796963, 'auprc': 0.9986906546839374, 'loss_val': 0.06067505298143037, 'psi': 0.9909889546013928}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=23 head_norm_before_train=1.682930 cos_to_last_merge=0.9958 (last merge round=19)
[S10] round=23 local utility u=0.011039 metrics={'f1_val': 0.9949509212940392, 'auprc': 0.9957659099565417, 'loss_val': 0.05256246397648563, 'psi': 0.9952769167590403}-{'f1_val': 0.9933750578586366, 'auprc': 0.995743735707032, 'loss_val': 0.06511922889932864, 'psi': 0.9943225289979947}
[S11] START round=23 head_norm_before_train=1.283454 cos_to_last_merge=0.9967 (last merge round=21)
[S11] round=23 local utility u=0.025915 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9972884487797583, 'loss_val': 0.12175205485531661, 'psi': 0.9965955844598889}-{'f1_val': 0.9965470045135896, 'auprc': 0.9978062943128132, 'loss_val': 0.1776151497027728, 'psi': 0.997050720433279}
[S13] START round=23 head_norm_before_train=1.346024 cos_to_last_merge=1.0000 (last merge round=22)
[S13] round=23 local utility u=0.079615 metrics={'f1_val': 0.6157730672570624, 'auprc': 0.6682752428688149, 'loss_val': 0.7187995646680483, 'psi': 0.6367739375017634}-{'f1_val': 0.5896153326323839, 'auprc': 0.6840655429122864, 'loss_val': 0.7684540938063096, 'psi': 0.627395416744345}
[S14] START round=23 head_norm_before_train=1.392492 cos_to_last_merge=0.7570 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.757
[S14] round=23 local utility u=0.005125 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9974710145158854, 'loss_val': 0.07370424715558219, 'psi': 0.9975790766362663}-{'f1_val': 0.997673454559638, 'auprc': 0.9978833348621864, 'loss_val': 0.08532533160348645, 'psi': 0.9977574066806574}
[S15] START round=23 head_norm_before_train=1.903478 (no previous merge yet)
[S15] round=23 local utility u=0.295502 metrics={'f1_val': 0.9971773386779533, 'auprc': 0.9992347421247147, 'loss_val': 0.024626977623334455, 'psi': 0.998000300056658}-{'f1_val': 0.9109270321583658, 'auprc': 0.9988455423386288, 'loss_val': 0.0969612699543816, 'psi': 0.946094436230471}
[S16] START round=23 head_norm_before_train=1.184818 cos_to_last_merge=1.0000 (last merge round=22)
[S16] round=23 local utility u=0.196128 metrics={'f1_val': 0.9695488119525096, 'auprc': 0.977974595428942, 'loss_val': 0.4021552581748063, 'psi': 0.9729191253430826}-{'f1_val': 0.9119346743196955, 'auprc': 0.9625842060807107, 'loss_val': 0.4025545149919692, 'psi': 0.9321944870241016}
[S17] START round=23 head_norm_before_train=1.538805 cos_to_last_merge=1.0000 (last merge round=22)
[S17] round=23 local utility u=0.000000 metrics={'f1_val': 0.6127045379428051, 'auprc': 0.7291709836518457, 'loss_val': 0.6951027972459087, 'psi': 0.6592911162264213}-{'f1_val': 0.5792259062218863, 'auprc': 0.8440657282988638, 'loss_val': 0.7031748373249894, 'psi': 0.6851618350526774}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:31609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:31615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:31604
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:31602
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S10@127.0.0.1:31611
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:31610
[S6] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:31617
[S4] RECEIVED delta(kind=head bytes=1799) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.464805)
[S4] loaded HEAD from S6 (vec_in norm=1.464805)
[S4] cosine check vs S6: cos=0.9971
[S4] BUFFERED delta from S6 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1795) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.426721)
[S15] loaded HEAD from S14 (vec_in norm=1.426721)
[S15] cosine check vs S14: cos=-0.0629
[S15] DROPPED delta from S14 (cos=-0.0629 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1796) from S3
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.851833)
[S8] loaded HEAD from S3 (vec_in norm=1.851833)
[S8] cosine check vs S3: cos=-0.0712
[S8] DROPPED delta from S3 (cos=-0.0712 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:31615
[S8] sending update (kind=head size=1802 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1804 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1802) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.349959)
[S2] loaded HEAD from S11 (vec_in norm=1.349959)
[S2] cosine check vs S11: cos=0.7497
[S2] BUFFERED delta from S11 (total buffered=2)
[S9] RECEIVED delta(kind=head bytes=1801) from S4
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.515071)
[S9] loaded HEAD from S4 (vec_in norm=1.515071)
[S9] cosine check vs S4: cos=-0.0387
[S9] DROPPED delta from S4 (cos=-0.0387 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1804) from S15
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.921639)
[S10] loaded HEAD from S15 (vec_in norm=1.921639)
[S10] cosine check vs S15: cos=-0.1149
[S10] DROPPED delta from S15 (cos=-0.1149 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1802) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.481477)
[S17] loaded HEAD from S8 (vec_in norm=1.481477)
[S17] cosine check vs S8: cos=0.9502
[S17] BUFFERED delta from S8 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] → sending delta(kind=head bytes=1793) to S2@127.0.0.1:31602
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:31612
[S10] sending update (kind=head size=1802 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1802) from S10
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.711926)
[S15] loaded HEAD from S10 (vec_in norm=1.711926)
[S15] cosine check vs S10: cos=-0.1149
[S15] DROPPED delta from S10 (cos=-0.1149 < 0.0)
[S16] sending update (kind=head size=1793 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1799) from S13
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.377815)
[S11] loaded HEAD from S13 (vec_in norm=1.377815)
[S11] cosine check vs S13: cos=0.9021
[S11] BUFFERED delta from S13 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1793) from S16
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.231314)
[S2] loaded HEAD from S16 (vec_in norm=1.231314)
[S2] cosine check vs S16: cos=0.9130
[S2] BUFFERED delta from S16 (total buffered=3)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=23 metric=0.9961 head_norm=1.349959
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.021106e-01
[S11] stored merged vector for next round verification (round=23)
[S11] DEBUG after merge:  round=23 metric=0.9965 head_norm=1.330080 delta_norm=0.302111
[S11] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=23 metric=0.9420 head_norm=1.515071
[S4] _apply_head_vector_avg (torch): Δ‖w‖=6.212728e-02
[S4] stored merged vector for next round verification (round=23)
[S4] DEBUG after merge:  round=23 metric=0.9427 head_norm=1.488854 delta_norm=0.062127
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=23 metric=0.6127 head_norm=1.565583
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.438538e-01
[S17] stored merged vector for next round verification (round=23)
[S17] DEBUG after merge:  round=23 metric=0.6060 head_norm=1.504476 delta_norm=0.243854
[S17] aggregate: ROLLBACK (f1_val pre=0.613 post=0.606 tol_abs=0.005 tol_rel=0.0)
[S2] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=23 metric=0.7011 head_norm=1.238049
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.574834e-01
[S2] stored merged vector for next round verification (round=23)
[S2] DEBUG after merge:  round=23 metric=0.7010 head_norm=1.207539 delta_norm=0.257483
[S2] aggregate: ACCEPT kept=['S16', 'S11', 'S16'] (k=3/3) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.207539 cos_to_last_merge=1.0000 (last merge round=23)
[S2] round=24 local utility u=0.000000 metrics={'f1_val': 0.6851011555044645, 'auprc': 0.7270343879877456, 'loss_val': 0.36857094732654383, 'psi': 0.7018744484977769}-{'f1_val': 0.7011337461190337, 'auprc': 0.8589162002287785, 'loss_val': 0.36154945764647367, 'psi': 0.7642467277629317}
[S3] START round=24 head_norm_before_train=1.851833 (no previous merge yet)
[S3] round=24 local utility u=0.000000 metrics={'f1_val': 0.9378796232148675, 'auprc': 0.9987257906093598, 'loss_val': 0.134554283885147, 'psi': 0.9622180901726645}-{'f1_val': 0.9978100342676263, 'auprc': 0.9988640642623781, 'loss_val': 0.0530515394754758, 'psi': 0.998231646265527}
[S4] START round=24 head_norm_before_train=1.488854 cos_to_last_merge=1.0000 (last merge round=23)
[S4] round=24 local utility u=0.000000 metrics={'f1_val': 0.939380562411925, 'auprc': 0.9336077031843253, 'loss_val': 0.29696688539354005, 'psi': 0.9370714187208852}-{'f1_val': 0.9420214402436983, 'auprc': 0.9635747306665233, 'loss_val': 0.27917499805523116, 'psi': 0.9506427564128284}
[S5] START round=24 head_norm_before_train=1.368656 cos_to_last_merge=0.9774 (last merge round=14)
[S5] round=24 local utility u=0.690527 metrics={'f1_val': 0.620321406258533, 'auprc': 0.8562607387373156, 'loss_val': 0.4046189253682507, 'psi': 0.7146971392500461}-{'f1_val': 0.43728475310475723, 'auprc': 0.8539325506886057, 'loss_val': 0.6804685881688184, 'psi': 0.6039438721382966}
[S6] START round=24 head_norm_before_train=1.464805 cos_to_last_merge=0.9991 (last merge round=21)
[S6] round=24 local utility u=0.000000 metrics={'f1_val': 0.9202255064638816, 'auprc': 0.9529478651793858, 'loss_val': 0.3809866151986553, 'psi': 0.9333144499500832}-{'f1_val': 0.9462582267373691, 'auprc': 0.9537357371560824, 'loss_val': 0.32720583996195224, 'psi': 0.9492492309048544}
[S7] START round=24 head_norm_before_train=1.691393 cos_to_last_merge=1.0000 (last merge round=23)
[S7] round=24 local utility u=0.307805 metrics={'f1_val': 0.6211794074385741, 'auprc': 0.78950948124646, 'loss_val': 0.6059509241766007, 'psi': 0.6885114369617285}-{'f1_val': 0.5470514508195463, 'auprc': 0.7823995994673334, 'loss_val': 0.7554643536432727, 'psi': 0.6411907102786611}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=24 head_norm_before_train=1.481477 cos_to_last_merge=0.9785 (last merge round=20)
[S8] round=24 local utility u=0.014147 metrics={'f1_val': 0.9957412378129044, 'auprc': 0.9989747402816719, 'loss_val': 0.11636606011543574, 'psi': 0.9970346388004114}-{'f1_val': 0.9962031034001528, 'auprc': 0.9980341921245965, 'loss_val': 0.1446105554680941, 'psi': 0.9969355388899304}
[S9] START round=24 head_norm_before_train=1.647973 cos_to_last_merge=0.8228 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.823
[S9] round=24 local utility u=0.000000 metrics={'f1_val': 0.9903686845626269, 'auprc': 0.9979549596969364, 'loss_val': 0.04595770427924743, 'psi': 0.9934031946163507}-{'f1_val': 0.9966924912647621, 'auprc': 0.9936915050066985, 'loss_val': 0.03592463961346883, 'psi': 0.9954920967615367}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=24 head_norm_before_train=1.711926 cos_to_last_merge=0.9936 (last merge round=19)
[S10] round=24 local utility u=0.008639 metrics={'f1_val': 0.9960202599216732, 'auprc': 0.9966146997802421, 'loss_val': 0.04424768970943666, 'psi': 0.9962580358651008}-{'f1_val': 0.9949509212940392, 'auprc': 0.9957659099565417, 'loss_val': 0.05256246397648563, 'psi': 0.9952769167590403}
[S11] START round=24 head_norm_before_train=1.330080 cos_to_last_merge=1.0000 (last merge round=23)
[S11] round=24 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9950290039721366, 'loss_val': 0.15440129492931728, 'psi': 0.9959398042970083}-{'f1_val': 0.9961336749133093, 'auprc': 0.9972884487797583, 'loss_val': 0.12175205485531661, 'psi': 0.9965955844598889}
[S13] START round=24 head_norm_before_train=1.377815 cos_to_last_merge=0.9989 (last merge round=22)
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.594233649283421, 'auprc': 0.6844091865032083, 'loss_val': 0.769830792919227, 'psi': 0.6303038641713359}-{'f1_val': 0.6157730672570624, 'auprc': 0.6682752428688149, 'loss_val': 0.7187995646680483, 'psi': 0.6367739375017634}
[S14] START round=24 head_norm_before_train=1.426721 cos_to_last_merge=0.7517 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.752
[S14] round=24 local utility u=0.000000 metrics={'f1_val': 0.9554335419903153, 'auprc': 0.997472745980329, 'loss_val': 0.09669534904116775, 'psi': 0.9722492235863207}-{'f1_val': 0.9976511180498535, 'auprc': 0.9974710145158854, 'loss_val': 0.07370424715558219, 'psi': 0.9975790766362663}
[S15] START round=24 head_norm_before_train=1.921639 (no previous merge yet)
[S15] round=24 local utility u=0.000000 metrics={'f1_val': 0.8838508557632736, 'auprc': 0.9920623129195414, 'loss_val': 0.1259182828933981, 'psi': 0.9271354386257806}-{'f1_val': 0.9971773386779533, 'auprc': 0.9992347421247147, 'loss_val': 0.024626977623334455, 'psi': 0.998000300056658}
[S16] START round=24 head_norm_before_train=1.231314 cos_to_last_merge=0.9973 (last merge round=22)
[S16] round=24 local utility u=0.000000 metrics={'f1_val': 0.9033421474503054, 'auprc': 0.9763331955404368, 'loss_val': 0.4566078187544877, 'psi': 0.932538566686358}-{'f1_val': 0.9695488119525096, 'auprc': 0.977974595428942, 'loss_val': 0.4021552581748063, 'psi': 0.9729191253430826}
[S17] START round=24 head_norm_before_train=1.504476 cos_to_last_merge=1.0000 (last merge round=23)
[S17] round=24 local utility u=0.378049 metrics={'f1_val': 0.6291982724687929, 'auprc': 0.9257414667922969, 'loss_val': 0.6276783160888751, 'psi': 0.7478155501981945}-{'f1_val': 0.6127045379428051, 'auprc': 0.7291709836518457, 'loss_val': 0.6951027972459087, 'psi': 0.6592911162264213}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S8] → sending delta(kind=head bytes=1807) to S17@127.0.0.1:31617
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:31613
[S8] sending update (kind=head size=1807 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:31615
[S17] RECEIVED delta(kind=head bytes=1807) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.532580)
[S17] loaded HEAD from S8 (vec_in norm=1.532580)
[S17] cosine check vs S8: cos=0.9771
[S17] BUFFERED delta from S8 (total buffered=1)
[S5] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1803) from S10
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.740898)
[S15] loaded HEAD from S10 (vec_in norm=1.740898)
[S15] cosine check vs S10: cos=-0.1129
[S15] DROPPED delta from S10 (cos=-0.1129 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1801) from S5
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.380292)
[S13] loaded HEAD from S5 (vec_in norm=1.380292)
[S13] cosine check vs S5: cos=0.9806
[S13] BUFFERED delta from S5 (total buffered=1)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:31608
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1803 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1803) from S17
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.535596)
[S7] loaded HEAD from S17 (vec_in norm=1.535596)
[S7] cosine check vs S17: cos=0.9365
[S7] BUFFERED delta from S17 (total buffered=1)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=24 metric=0.5942 head_norm=1.408528
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.382251e-01
[S13] stored merged vector for next round verification (round=24)
[S13] DEBUG after merge:  round=24 metric=0.5959 head_norm=1.387614 delta_norm=0.138225
[S13] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=24 metric=0.6292 head_norm=1.535596
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.642021e-01
[S17] stored merged vector for next round verification (round=24)
[S17] DEBUG after merge:  round=24 metric=0.6485 head_norm=1.525276 delta_norm=0.164202
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.249222 cos_to_last_merge=0.9989 (last merge round=23)
[S2] round=25 local utility u=0.060075 metrics={'f1_val': 0.6860015182451107, 'auprc': 0.7604033711141915, 'loss_val': 0.35393031343611825, 'psi': 0.7157622593927431}-{'f1_val': 0.6851011555044645, 'auprc': 0.7270343879877456, 'loss_val': 0.36857094732654383, 'psi': 0.7018744484977769}
[S3] START round=25 head_norm_before_train=1.862306 (no previous merge yet)
[S3] round=25 local utility u=0.220834 metrics={'f1_val': 0.9978100342676263, 'auprc': 0.9988436138846083, 'loss_val': 0.052821255700812836, 'psi': 0.9982234661144191}-{'f1_val': 0.9378796232148675, 'auprc': 0.9987257906093598, 'loss_val': 0.134554283885147, 'psi': 0.9622180901726645}
[S4] START round=25 head_norm_before_train=1.515953 cos_to_last_merge=0.9997 (last merge round=23)
[S4] round=25 local utility u=0.011510 metrics={'f1_val': 0.9406216746272174, 'auprc': 0.9446723152206602, 'loss_val': 0.31458802497913824, 'psi': 0.9422419308645944}-{'f1_val': 0.939380562411925, 'auprc': 0.9336077031843253, 'loss_val': 0.29696688539354005, 'psi': 0.9370714187208852}
[S5] START round=25 head_norm_before_train=1.380292 cos_to_last_merge=0.9751 (last merge round=14)
[S5] round=25 local utility u=0.221796 metrics={'f1_val': 0.6529719730558539, 'auprc': 0.9230728093062878, 'loss_val': 0.3573660758563648, 'psi': 0.7610123075560274}-{'f1_val': 0.620321406258533, 'auprc': 0.8562607387373156, 'loss_val': 0.4046189253682507, 'psi': 0.7146971392500461}
[S6] START round=25 head_norm_before_train=1.477262 cos_to_last_merge=0.9983 (last merge round=21)
[S6] round=25 local utility u=0.000000 metrics={'f1_val': 0.9067359889300779, 'auprc': 0.9534948051315316, 'loss_val': 0.37340558817271075, 'psi': 0.9254395154106594}-{'f1_val': 0.9202255064638816, 'auprc': 0.9529478651793858, 'loss_val': 0.3809866151986553, 'psi': 0.9333144499500832}
[S7] START round=25 head_norm_before_train=1.698892 cos_to_last_merge=0.9999 (last merge round=23)
[S7] round=25 local utility u=0.240891 metrics={'f1_val': 0.6628137850176751, 'auprc': 0.8196470816054364, 'loss_val': 0.464388325962855, 'psi': 0.7255471036527796}-{'f1_val': 0.6211794074385741, 'auprc': 0.78950948124646, 'loss_val': 0.6059509241766007, 'psi': 0.6885114369617285}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=25 metric=0.6628 head_norm=1.707929
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.023179e-01
[S7] stored merged vector for next round verification (round=25)
[S7] DEBUG after merge:  round=25 metric=0.6668 head_norm=1.595664 delta_norm=0.302318
[S7] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] START round=25 head_norm_before_train=1.532580 cos_to_last_merge=0.9692 (last merge round=20)
[S8] round=25 local utility u=0.015887 metrics={'f1_val': 0.9964900410640029, 'auprc': 0.9986520827865453, 'loss_val': 0.08811741464738512, 'psi': 0.9973548577530198}-{'f1_val': 0.9957412378129044, 'auprc': 0.9989747402816719, 'loss_val': 0.11636606011543574, 'psi': 0.9970346388004114}
[S9] START round=25 head_norm_before_train=1.663892 cos_to_last_merge=0.8208 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.821
[S9] round=25 local utility u=0.019568 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9943127900485431, 'loss_val': 0.031182735555258155, 'psi': 0.9954751728869838}-{'f1_val': 0.9903686845626269, 'auprc': 0.9979549596969364, 'loss_val': 0.04595770427924743, 'psi': 0.9934031946163507}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] sending update (kind=head size=1792 to 1 peers)
[S10] START round=25 head_norm_before_train=1.740898 cos_to_last_merge=0.9913 (last merge round=19)
[S10] round=25 local utility u=0.000000 metrics={'f1_val': 0.9953900010273877, 'auprc': 0.9964098745627219, 'loss_val': 0.04073225068855455, 'psi': 0.9957979504415214}-{'f1_val': 0.9960202599216732, 'auprc': 0.9966146997802421, 'loss_val': 0.04424768970943666, 'psi': 0.9962580358651008}
[S11] START round=25 head_norm_before_train=1.388810 cos_to_last_merge=0.9973 (last merge round=23)
[S11] round=25 local utility u=0.023399 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.993946518276382, 'loss_val': 0.10435673467612921, 'psi': 0.9955068100187066}-{'f1_val': 0.9965470045135896, 'auprc': 0.9950290039721366, 'loss_val': 0.15440129492931728, 'psi': 0.9959398042970083}
[S13] START round=25 head_norm_before_train=1.387614 cos_to_last_merge=1.0000 (last merge round=24)
[S13] round=25 local utility u=0.189214 metrics={'f1_val': 0.6109384214280192, 'auprc': 0.7576589591465706, 'loss_val': 0.7113804146967834, 'psi': 0.6696266365154397}-{'f1_val': 0.594233649283421, 'auprc': 0.6844091865032083, 'loss_val': 0.769830792919227, 'psi': 0.6303038641713359}
[S14] START round=25 head_norm_before_train=1.460167 cos_to_last_merge=0.7465 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.747
[S14] round=25 local utility u=0.111521 metrics={'f1_val': 0.9873733090327917, 'auprc': 0.9992068491311896, 'loss_val': 0.07049453849946632, 'psi': 0.9921067250721509}-{'f1_val': 0.9554335419903153, 'auprc': 0.997472745980329, 'loss_val': 0.09669534904116775, 'psi': 0.9722492235863207}
[S15] START round=25 head_norm_before_train=1.940229 (no previous merge yet)
[S15] round=25 local utility u=0.206492 metrics={'f1_val': 0.9395270346695047, 'auprc': 0.9985912827909313, 'loss_val': 0.06657834678612225, 'psi': 0.9631527339180754}-{'f1_val': 0.8838508557632736, 'auprc': 0.9920623129195414, 'loss_val': 0.1259182828933981, 'psi': 0.9271354386257806}
[S16] START round=25 head_norm_before_train=1.285608 cos_to_last_merge=0.9901 (last merge round=22)
[S16] round=25 local utility u=0.319478 metrics={'f1_val': 0.975301278496613, 'auprc': 0.9767701494565582, 'loss_val': 0.2507173917107395, 'psi': 0.975888826880591}-{'f1_val': 0.9033421474503054, 'auprc': 0.9763331955404368, 'loss_val': 0.4566078187544877, 'psi': 0.932538566686358}
[S17] START round=25 head_norm_before_train=1.525276 cos_to_last_merge=1.0000 (last merge round=24)
[S17] round=25 local utility u=0.164358 metrics={'f1_val': 0.6644056746388421, 'auprc': 0.9456638277971671, 'loss_val': 0.5699740718433226, 'psi': 0.7769089359021721}-{'f1_val': 0.6291982724687929, 'auprc': 0.9257414667922969, 'loss_val': 0.6276783160888751, 'psi': 0.7478155501981945}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:31609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:31615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:31611
[S3] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:31610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:31616
[S6] ⇄ pheromone p=0.160 → S4@127.0.0.1:31604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:31617
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:31602
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1802) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.487295)
[S15] loaded HEAD from S14 (vec_in norm=1.487295)
[S15] cosine check vs S14: cos=-0.0636
[S15] DROPPED delta from S14 (cos=-0.0636 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1799) from S3
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.874099)
[S8] loaded HEAD from S3 (vec_in norm=1.874099)
[S8] cosine check vs S3: cos=-0.0744
[S8] DROPPED delta from S3 (cos=-0.0744 < 0.0)
[S2] sending update (kind=head size=1799 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1800 to 1 peers)
[S14] ⇄ pheromone p=0.104 → S15@127.0.0.1:31615
[S4] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S3] ⇄ pheromone p=0.233 → S8@127.0.0.1:31609
[S8] sending update (kind=head size=1805 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S13@127.0.0.1:31613
[S9] RECEIVED delta(kind=head bytes=1802) from S4
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.538766)
[S9] loaded HEAD from S4 (vec_in norm=1.538766)
[S9] cosine check vs S4: cos=-0.0348
[S9] DROPPED delta from S4 (cos=-0.0348 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1799) from S2
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.285708)
[S16] loaded HEAD from S2 (vec_in norm=1.285708)
[S16] cosine check vs S2: cos=0.9549
[S16] BUFFERED delta from S2 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1805) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.577872)
[S17] loaded HEAD from S8 (vec_in norm=1.577872)
[S17] cosine check vs S8: cos=0.9885
[S17] BUFFERED delta from S8 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1801) from S15
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.956445)
[S10] loaded HEAD from S15 (vec_in norm=1.956445)
[S10] cosine check vs S15: cos=-0.1109
[S10] DROPPED delta from S15 (cos=-0.1109 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1800) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.450751)
[S2] loaded HEAD from S11 (vec_in norm=1.450751)
[S2] cosine check vs S11: cos=0.5583
[S2] BUFFERED delta from S11 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:31602
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:31608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:31612
[S5] sending update (kind=head size=1804 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1804) from S5
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.392726)
[S13] loaded HEAD from S5 (vec_in norm=1.392726)
[S13] cosine check vs S5: cos=0.9907
[S13] BUFFERED delta from S5 (total buffered=1)
[S16] sending update (kind=head size=1801 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1801) from S16
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.340278)
[S2] loaded HEAD from S16 (vec_in norm=1.340278)
[S2] cosine check vs S16: cos=0.9549
[S2] BUFFERED delta from S16 (total buffered=2)
[S17] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1802) from S17
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.556011)
[S7] loaded HEAD from S17 (vec_in norm=1.556011)
[S7] cosine check vs S17: cos=0.9607
[S7] BUFFERED delta from S17 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1798) from S13
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.412917)
[S11] loaded HEAD from S13 (vec_in norm=1.412917)
[S11] cosine check vs S13: cos=0.9309
[S11] BUFFERED delta from S13 (total buffered=1)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=25 metric=0.9965 head_norm=1.450751
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.667812e-01
[S11] stored merged vector for next round verification (round=25)
[S11] DEBUG after merge:  round=25 metric=0.9965 head_norm=1.406888 delta_norm=0.266781
[S11] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.049 → S2@127.0.0.1:31602
[S8] ⇄ pheromone p=0.067 → S17@127.0.0.1:31617
[S15] ⇄ pheromone p=0.237 → S10@127.0.0.1:31611
[S2] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=25 metric=0.6860 head_norm=1.285708
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.938739e-01
[S2] stored merged vector for next round verification (round=25)
[S2] DEBUG after merge:  round=25 metric=0.6853 head_norm=1.195739 delta_norm=0.293874
[S2] aggregate: ACCEPT kept=['S11', 'S16'] (k=2/2) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.050 → S16@127.0.0.1:31616
[S4] ⇄ pheromone p=0.089 → S9@127.0.0.1:31610
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=25 metric=0.9753 head_norm=1.340278
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.989578e-01
[S16] stored merged vector for next round verification (round=25)
[S16] DEBUG after merge:  round=25 metric=0.9811 head_norm=1.298118 delta_norm=0.198958
[S16] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.219 → S10@127.0.0.1:31611
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=25 metric=0.6109 head_norm=1.412917
[S13] _apply_head_vector_avg (torch): Δ‖w‖=9.641869e-02
[S13] stored merged vector for next round verification (round=25)
[S13] DEBUG after merge:  round=25 metric=0.6113 head_norm=1.399540 delta_norm=0.096419
[S13] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.095 → S11@127.0.0.1:31612
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=25 metric=0.6644 head_norm=1.556011
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.194358e-01
[S17] stored merged vector for next round verification (round=25)
[S17] DEBUG after merge:  round=25 metric=0.6665 head_norm=1.562421 delta_norm=0.119436
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.202 → S7@127.0.0.1:31608
[S10] ⇄ pheromone p=0.040 → S16@127.0.0.1:31616
[S5] ⇄ pheromone p=0.290 → S13@127.0.0.1:31613
[S2] START round=26 head_norm_before_train=1.195739 cos_to_last_merge=1.0000 (last merge round=25)
[S2] round=26 local utility u=0.101568 metrics={'f1_val': 0.7011337461190337, 'auprc': 0.7889421128151632, 'loss_val': 0.3272034117458549, 'psi': 0.7362570927974855}-{'f1_val': 0.6860015182451107, 'auprc': 0.7604033711141915, 'loss_val': 0.35393031343611825, 'psi': 0.7157622593927431}
[S3] START round=26 head_norm_before_train=1.874099 (no previous merge yet)
[S3] round=26 local utility u=0.004358 metrics={'f1_val': 0.9977814963782642, 'auprc': 0.998858040996288, 'loss_val': 0.043976512190287594, 'psi': 0.9982121142254738}-{'f1_val': 0.9978100342676263, 'auprc': 0.9988436138846083, 'loss_val': 0.052821255700812836, 'psi': 0.9982234661144191}
[S4] START round=26 head_norm_before_train=1.538766 cos_to_last_merge=0.9990 (last merge round=23)
[S4] round=26 local utility u=0.000000 metrics={'f1_val': 0.9390643176576805, 'auprc': 0.9328477701051527, 'loss_val': 0.2846856385680216, 'psi': 0.9365776986366694}-{'f1_val': 0.9406216746272174, 'auprc': 0.9446723152206602, 'loss_val': 0.31458802497913824, 'psi': 0.9422419308645944}
[S5] START round=26 head_norm_before_train=1.392726 cos_to_last_merge=0.9732 (last merge round=14)
[S5] round=26 local utility u=0.276195 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.989558925116263, 'loss_val': 0.288531460569829, 'psi': 0.8160163605068534}-{'f1_val': 0.6529719730558539, 'auprc': 0.9230728093062878, 'loss_val': 0.3573660758563648, 'psi': 0.7610123075560274}
[S6] START round=26 head_norm_before_train=1.489690 cos_to_last_merge=0.9973 (last merge round=21)
[S6] round=26 local utility u=0.165208 metrics={'f1_val': 0.9494427118451243, 'auprc': 0.9540031737177804, 'loss_val': 0.30075551832202696, 'psi': 0.9512668965941868}-{'f1_val': 0.9067359889300779, 'auprc': 0.9534948051315316, 'loss_val': 0.37340558817271075, 'psi': 0.9254395154106594}
[S7] START round=26 head_norm_before_train=1.595664 cos_to_last_merge=1.0000 (last merge round=25)
[S7] round=26 local utility u=0.000000 metrics={'f1_val': 0.5555725730929042, 'auprc': 0.7824387056560774, 'loss_val': 0.7431443651589068, 'psi': 0.6463190261181735}-{'f1_val': 0.6628137850176751, 'auprc': 0.8196470816054364, 'loss_val': 0.464388325962855, 'psi': 0.7255471036527796}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=26 metric=0.5556 head_norm=1.607354
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.247619e-01
[S7] stored merged vector for next round verification (round=26)
[S7] DEBUG after merge:  round=26 metric=0.5594 head_norm=1.565842 delta_norm=0.224762
[S7] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] START round=26 head_norm_before_train=1.577872 cos_to_last_merge=0.9613 (last merge round=20)
[S8] round=26 local utility u=0.004046 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9980718352669312, 'loss_val': 0.07656261428399885, 'psi': 0.9969505961468642}-{'f1_val': 0.9964900410640029, 'auprc': 0.9986520827865453, 'loss_val': 0.08811741464738512, 'psi': 0.9973548577530198}
[S9] START round=26 head_norm_before_train=1.677794 cos_to_last_merge=0.8190 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.819
[S9] round=26 local utility u=0.006871 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9963283644138168, 'loss_val': 0.028604511268627023, 'psi': 0.9967930932728124}-{'f1_val': 0.9962500947792776, 'auprc': 0.9943127900485431, 'loss_val': 0.031182735555258155, 'psi': 0.9954751728869838}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=26 head_norm_before_train=1.768414 cos_to_last_merge=0.9892 (last merge round=19)
[S10] round=26 local utility u=0.001416 metrics={'f1_val': 0.9953900010273877, 'auprc': 0.9964213556652602, 'loss_val': 0.03793537748638863, 'psi': 0.9958025428825368}-{'f1_val': 0.9953900010273877, 'auprc': 0.9964098745627219, 'loss_val': 0.04073225068855455, 'psi': 0.9957979504415214}
[S11] START round=26 head_norm_before_train=1.406888 cos_to_last_merge=1.0000 (last merge round=25)
[S11] round=26 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9918378683927338, 'loss_val': 0.13618571245004002, 'psi': 0.9944153523050792}-{'f1_val': 0.9965470045135896, 'auprc': 0.993946518276382, 'loss_val': 0.10435673467612921, 'psi': 0.9955068100187066}
[S13] START round=26 head_norm_before_train=1.399540 cos_to_last_merge=1.0000 (last merge round=25)
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.5895942152181624, 'auprc': 0.691752591704111, 'loss_val': 0.7624279237496379, 'psi': 0.6304575658125418}-{'f1_val': 0.6109384214280192, 'auprc': 0.7576589591465706, 'loss_val': 0.7113804146967834, 'psi': 0.6696266365154397}
[S14] START round=26 head_norm_before_train=1.487295 cos_to_last_merge=0.7425 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.742
[S14] round=26 local utility u=0.040590 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9992062848435664, 'loss_val': 0.05097945892225907, 'psi': 0.9982731847673387}-{'f1_val': 0.9873733090327917, 'auprc': 0.9992068491311896, 'loss_val': 0.07049453849946632, 'psi': 0.9921067250721509}
[S15] START round=26 head_norm_before_train=1.956445 (no previous merge yet)
[S15] round=26 local utility u=0.000000 metrics={'f1_val': 0.9293823956849993, 'auprc': 0.9983873795302743, 'loss_val': 0.07007663803612349, 'psi': 0.9569843892231094}-{'f1_val': 0.9395270346695047, 'auprc': 0.9985912827909313, 'loss_val': 0.06657834678612225, 'psi': 0.9631527339180754}
[S16] START round=26 head_norm_before_train=1.298118 cos_to_last_merge=1.0000 (last merge round=25)
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.8392910611822094, 'auprc': 0.9718869051609402, 'loss_val': 0.644388046750252, 'psi': 0.8923293987737018}-{'f1_val': 0.975301278496613, 'auprc': 0.9767701494565582, 'loss_val': 0.2507173917107395, 'psi': 0.975888826880591}
[S17] START round=26 head_norm_before_train=1.562421 cos_to_last_merge=1.0000 (last merge round=25)
[S17] round=26 local utility u=0.000000 metrics={'f1_val': 0.5551683948108792, 'auprc': 0.8027331983358152, 'loss_val': 0.7874010425936164, 'psi': 0.6541943162208537}-{'f1_val': 0.6644056746388421, 'auprc': 0.9456638277971671, 'loss_val': 0.5699740718433226, 'psi': 0.7769089359021721}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:31609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:31604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:31615
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:31617
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:31612
[S8] RECEIVED delta(kind=head bytes=1801) from S3
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.887911)
[S8] loaded HEAD from S3 (vec_in norm=1.887911)
[S8] cosine check vs S3: cos=-0.0755
[S8] DROPPED delta from S3 (cos=-0.0755 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1798) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.511268)
[S15] loaded HEAD from S14 (vec_in norm=1.511268)
[S15] cosine check vs S14: cos=-0.0636
[S15] DROPPED delta from S14 (cos=-0.0636 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1803) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.501461)
[S4] loaded HEAD from S6 (vec_in norm=1.501461)
[S4] cosine check vs S6: cos=0.9932
[S4] BUFFERED delta from S6 (total buffered=1)
[S2] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:31615
[S17] RECEIVED delta(kind=head bytes=1802) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.613048)
[S17] loaded HEAD from S8 (vec_in norm=1.613048)
[S17] cosine check vs S8: cos=0.9935
[S17] BUFFERED delta from S8 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1796) from S2
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.227371)
[S11] loaded HEAD from S2 (vec_in norm=1.227371)
[S11] cosine check vs S2: cos=0.6434
[S11] BUFFERED delta from S2 (total buffered=1)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=26 metric=0.9391 head_norm=1.552880
[S4] _apply_head_vector_avg (torch): Δ‖w‖=9.283436e-02
[S4] stored merged vector for next round verification (round=26)
[S4] DEBUG after merge:  round=26 metric=0.9393 head_norm=1.524563 delta_norm=0.092834
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S10] sending update (kind=head size=1802 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1802) from S10
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.787900)
[S15] loaded HEAD from S10 (vec_in norm=1.787900)
[S15] cosine check vs S10: cos=-0.1096
[S15] DROPPED delta from S10 (cos=-0.1096 < 0.0)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=26 metric=0.9961 head_norm=1.458510
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.766267e-01
[S11] stored merged vector for next round verification (round=26)
[S11] DEBUG after merge:  round=26 metric=0.9961 head_norm=1.218338 delta_norm=0.576627
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=26 metric=0.5552 head_norm=1.591832
[S17] _apply_head_vector_avg (torch): Δ‖w‖=9.200601e-02
[S17] stored merged vector for next round verification (round=26)
[S17] DEBUG after merge:  round=26 metric=0.5484 head_norm=1.599832 delta_norm=0.092006
[S17] aggregate: ROLLBACK (f1_val pre=0.555 post=0.548 tol_abs=0.005 tol_rel=0.0)
[S2] START round=27 head_norm_before_train=1.227371 cos_to_last_merge=0.9993 (last merge round=25)
[S2] round=27 local utility u=0.000000 metrics={'f1_val': 0.7013141837391442, 'auprc': 0.7704281086856626, 'loss_val': 0.30735581628964675, 'psi': 0.7289597537177516}-{'f1_val': 0.7011337461190337, 'auprc': 0.7889421128151632, 'loss_val': 0.3272034117458549, 'psi': 0.7362570927974855}
[S3] START round=27 head_norm_before_train=1.887911 (no previous merge yet)
[S3] round=27 local utility u=0.000000 metrics={'f1_val': 0.9312725926001848, 'auprc': 0.998622207127224, 'loss_val': 0.16076887462204065, 'psi': 0.9582124384110005}-{'f1_val': 0.9977814963782642, 'auprc': 0.998858040996288, 'loss_val': 0.043976512190287594, 'psi': 0.9982121142254738}
[S4] START round=27 head_norm_before_train=1.524563 cos_to_last_merge=1.0000 (last merge round=26)
[S4] round=27 local utility u=0.034592 metrics={'f1_val': 0.9391453107277897, 'auprc': 0.9521075077882054, 'loss_val': 0.27376772716911923, 'psi': 0.944330189551956}-{'f1_val': 0.9390643176576805, 'auprc': 0.9328477701051527, 'loss_val': 0.2846856385680216, 'psi': 0.9365776986366694}
[S5] START round=27 head_norm_before_train=1.403514 cos_to_last_merge=0.9716 (last merge round=14)
[S5] round=27 local utility u=0.000000 metrics={'f1_val': 0.625614233111238, 'auprc': 0.815856038580415, 'loss_val': 0.5295484107861728, 'psi': 0.7017109552989088}-{'f1_val': 0.7003213174339138, 'auprc': 0.989558925116263, 'loss_val': 0.288531460569829, 'psi': 0.8160163605068534}
[S6] START round=27 head_norm_before_train=1.501461 cos_to_last_merge=0.9959 (last merge round=21)
[S6] round=27 local utility u=0.000000 metrics={'f1_val': 0.7816115373130689, 'auprc': 0.9541022224897769, 'loss_val': 0.4720515506442594, 'psi': 0.8506078113837521}-{'f1_val': 0.9494427118451243, 'auprc': 0.9540031737177804, 'loss_val': 0.30075551832202696, 'psi': 0.9512668965941868}
[S7] START round=27 head_norm_before_train=1.565842 cos_to_last_merge=1.0000 (last merge round=26)
[S7] round=27 local utility u=0.364521 metrics={'f1_val': 0.6356806926307995, 'auprc': 0.8001343783044641, 'loss_val': 0.5478385594350351, 'psi': 0.7014621669002654}-{'f1_val': 0.5555725730929042, 'auprc': 0.7824387056560774, 'loss_val': 0.7431443651589068, 'psi': 0.6463190261181735}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S7] sending update (kind=head size=1808 to 1 peers)
[S8] START round=27 head_norm_before_train=1.613048 cos_to_last_merge=0.9555 (last merge round=20)
[S8] round=27 local utility u=0.003796 metrics={'f1_val': 0.9950949602617258, 'auprc': 0.9990082762547284, 'loss_val': 0.0651319563741186, 'psi': 0.9966602866589269}-{'f1_val': 0.9962031034001528, 'auprc': 0.9980718352669312, 'loss_val': 0.07656261428399885, 'psi': 0.9969505961468642}
[S9] START round=27 head_norm_before_train=1.691767 cos_to_last_merge=0.8175 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.818
[S9] round=27 local utility u=0.003036 metrics={'f1_val': 0.9966857875385419, 'auprc': 0.9988399627471523, 'loss_val': 0.027564432791882504, 'psi': 0.997547457621986}-{'f1_val': 0.9971029125121428, 'auprc': 0.9963283644138168, 'loss_val': 0.028604511268627023, 'psi': 0.9967930932728124}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=27 head_norm_before_train=1.787900 cos_to_last_merge=0.9878 (last merge round=19)
[S10] round=27 local utility u=0.000000 metrics={'f1_val': 0.9953900010273877, 'auprc': 0.9958964584515433, 'loss_val': 0.036757528895626265, 'psi': 0.99559258399705}-{'f1_val': 0.9953900010273877, 'auprc': 0.9964213556652602, 'loss_val': 0.03793537748638863, 'psi': 0.9958025428825368}
[S11] START round=27 head_norm_before_train=1.218338 cos_to_last_merge=1.0000 (last merge round=26)
[S11] round=27 local utility u=0.028045 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9964183886985745, 'loss_val': 0.09395986875324311, 'psi': 0.996259840325877}-{'f1_val': 0.9961336749133093, 'auprc': 0.9918378683927338, 'loss_val': 0.13618571245004002, 'psi': 0.9944153523050792}
[S13] START round=27 head_norm_before_train=1.424658 cos_to_last_merge=0.9992 (last merge round=25)
[S13] round=27 local utility u=0.089426 metrics={'f1_val': 0.6043742555874406, 'auprc': 0.6972689499270356, 'loss_val': 0.6888042450997699, 'psi': 0.6415321333232786}-{'f1_val': 0.5895942152181624, 'auprc': 0.691752591704111, 'loss_val': 0.7624279237496379, 'psi': 0.6304575658125418}
[S14] START round=27 head_norm_before_train=1.511268 cos_to_last_merge=0.7395 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.740
[S14] round=27 local utility u=0.000000 metrics={'f1_val': 0.9971876286864827, 'auprc': 0.9978676232804332, 'loss_val': 0.04934929745630962, 'psi': 0.997459626524063}-{'f1_val': 0.9976511180498535, 'auprc': 0.9992062848435664, 'loss_val': 0.05097945892225907, 'psi': 0.9982731847673387}
[S15] START round=27 head_norm_before_train=1.970365 (no previous merge yet)
[S15] round=27 local utility u=0.225773 metrics={'f1_val': 0.9971773386779533, 'auprc': 0.9992244119104898, 'loss_val': 0.02781112222189111, 'psi': 0.9979961679709679}-{'f1_val': 0.9293823956849993, 'auprc': 0.9983873795302743, 'loss_val': 0.07007663803612349, 'psi': 0.9569843892231094}
[S16] START round=27 head_norm_before_train=1.346746 cos_to_last_merge=0.9986 (last merge round=25)
[S16] round=27 local utility u=0.494817 metrics={'f1_val': 0.9359279850589806, 'auprc': 0.9802739026348626, 'loss_val': 0.25973632928429996, 'psi': 0.9536663520893334}-{'f1_val': 0.8392910611822094, 'auprc': 0.9718869051609402, 'loss_val': 0.644388046750252, 'psi': 0.8923293987737018}
[S17] START round=27 head_norm_before_train=1.599832 cos_to_last_merge=1.0000 (last merge round=26)
[S17] round=27 local utility u=0.363255 metrics={'f1_val': 0.6246725319825313, 'auprc': 0.8763883196538247, 'loss_val': 0.6988805149483074, 'psi': 0.7253588470510486}-{'f1_val': 0.5551683948108792, 'auprc': 0.8027331983358152, 'loss_val': 0.7874010425936164, 'psi': 0.6541943162208537}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:31607
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:31617
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:31613
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:31611
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:31609
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1795) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.286251)
[S13] loaded HEAD from S11 (vec_in norm=1.286251)
[S13] cosine check vs S11: cos=0.8060
[S13] BUFFERED delta from S11 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1803) from S15
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.984842)
[S10] loaded HEAD from S15 (vec_in norm=1.984842)
[S10] cosine check vs S15: cos=-0.1084
[S10] DROPPED delta from S15 (cos=-0.1084 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1802) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.642202)
[S17] loaded HEAD from S8 (vec_in norm=1.642202)
[S17] cosine check vs S8: cos=0.9958
[S17] BUFFERED delta from S8 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1800) from S4
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.541338)
[S6] loaded HEAD from S4 (vec_in norm=1.541338)
[S6] cosine check vs S4: cos=0.9963
[S6] BUFFERED delta from S4 (total buffered=1)
[S17] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.630193)
[S8] loaded HEAD from S17 (vec_in norm=1.630193)
[S8] cosine check vs S17: cos=0.9958
[S8] BUFFERED delta from S17 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:31602
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:31605
[S13] sending update (kind=head size=1804 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1801) from S16
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.395926)
[S2] loaded HEAD from S16 (vec_in norm=1.395926)
[S2] cosine check vs S16: cos=0.9484
[S2] BUFFERED delta from S16 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1804) from S13
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.452708)
[S5] loaded HEAD from S13 (vec_in norm=1.452708)
[S5] cosine check vs S13: cos=0.9903
[S5] BUFFERED delta from S13 (total buffered=1)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=27 metric=0.9951 head_norm=1.642202
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.548077e-02
[S8] stored merged vector for next round verification (round=27)
[S8] DEBUG after merge:  round=27 metric=0.9951 head_norm=1.634467 delta_norm=0.075481
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=27 metric=0.6247 head_norm=1.630193
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.548077e-02
[S17] stored merged vector for next round verification (round=27)
[S17] DEBUG after merge:  round=27 metric=0.6361 head_norm=1.634467 delta_norm=0.075481
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=27 metric=0.7013 head_norm=1.259255
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.236479e-01
[S2] stored merged vector for next round verification (round=27)
[S2] DEBUG after merge:  round=27 metric=0.7013 head_norm=1.310400 delta_norm=0.223648
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=27 metric=0.6256 head_norm=1.415733
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.014033e-01
[S5] stored merged vector for next round verification (round=27)
[S5] DEBUG after merge:  round=27 metric=0.6292 head_norm=1.430751 delta_norm=0.101403
[S5] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=27 metric=0.6044 head_norm=1.452708
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.337558e-01
[S13] stored merged vector for next round verification (round=27)
[S13] DEBUG after merge:  round=27 metric=0.6105 head_norm=1.301637 delta_norm=0.433756
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=1.310400 cos_to_last_merge=1.0000 (last merge round=27)
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.7013141837391442, 'auprc': 0.6982782404017013, 'loss_val': 0.286122293679235, 'psi': 0.700099806404167}-{'f1_val': 0.7013141837391442, 'auprc': 0.7704281086856626, 'loss_val': 0.30735581628964675, 'psi': 0.7289597537177516}
[S3] START round=28 head_norm_before_train=1.901895 (no previous merge yet)
[S3] round=28 local utility u=0.258755 metrics={'f1_val': 0.9978100342676263, 'auprc': 0.9988454216713649, 'loss_val': 0.04315325389646837, 'psi': 0.9982241892291217}-{'f1_val': 0.9312725926001848, 'auprc': 0.998622207127224, 'loss_val': 0.16076887462204065, 'psi': 0.9582124384110005}
[S4] START round=28 head_norm_before_train=1.541338 cos_to_last_merge=0.9999 (last merge round=26)
[S4] round=28 local utility u=0.022681 metrics={'f1_val': 0.9399059391107898, 'auprc': 0.9644064642111019, 'loss_val': 0.26986563749236325, 'psi': 0.9497061491509147}-{'f1_val': 0.9391453107277897, 'auprc': 0.9521075077882054, 'loss_val': 0.27376772716911923, 'psi': 0.944330189551956}
[S5] START round=28 head_norm_before_train=1.430751 cos_to_last_merge=1.0000 (last merge round=27)
[S5] round=28 local utility u=0.608575 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9894402662654612, 'loss_val': 0.2813926919634451, 'psi': 0.8159688969665327}-{'f1_val': 0.625614233111238, 'auprc': 0.815856038580415, 'loss_val': 0.5295484107861728, 'psi': 0.7017109552989088}
[S6] START round=28 head_norm_before_train=1.518236 cos_to_last_merge=0.9936 (last merge round=21)
[S6] round=28 local utility u=0.631618 metrics={'f1_val': 0.9555448495937937, 'auprc': 0.9595032885604096, 'loss_val': 0.2686187839633717, 'psi': 0.95712822518044}-{'f1_val': 0.7816115373130689, 'auprc': 0.9541022224897769, 'loss_val': 0.4720515506442594, 'psi': 0.8506078113837521}
[S7] START round=28 head_norm_before_train=1.579787 cos_to_last_merge=0.9998 (last merge round=26)
[S7] round=28 local utility u=0.000000 metrics={'f1_val': 0.6340586103921066, 'auprc': 0.8006962354887397, 'loss_val': 0.5584924839300619, 'psi': 0.7007136604307599}-{'f1_val': 0.6356806926307995, 'auprc': 0.8001343783044641, 'loss_val': 0.5478385594350351, 'psi': 0.7014621669002654}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=28 head_norm_before_train=1.634467 cos_to_last_merge=1.0000 (last merge round=27)
[S8] round=28 local utility u=0.000748 metrics={'f1_val': 0.9950136499820015, 'auprc': 0.9992806339050035, 'loss_val': 0.06396463401385555, 'psi': 0.9967204435512024}-{'f1_val': 0.9950949602617258, 'auprc': 0.9990082762547284, 'loss_val': 0.0651319563741186, 'psi': 0.9966602866589269}
[S9] START round=28 head_norm_before_train=1.706424 cos_to_last_merge=0.8160 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.816
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9937036690127297, 'loss_val': 0.02764644437461075, 'psi': 0.9957432151123775}-{'f1_val': 0.9966857875385419, 'auprc': 0.9988399627471523, 'loss_val': 0.027564432791882504, 'psi': 0.997547457621986}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=28 head_norm_before_train=1.807898 cos_to_last_merge=0.9865 (last merge round=19)
[S10] round=28 local utility u=0.001537 metrics={'f1_val': 0.9956047769386365, 'auprc': 0.9958250975505344, 'loss_val': 0.03475794569509098, 'psi': 0.9956929051833957}-{'f1_val': 0.9953900010273877, 'auprc': 0.9958964584515433, 'loss_val': 0.036757528895626265, 'psi': 0.99559258399705}
[S11] START round=28 head_norm_before_train=1.286251 cos_to_last_merge=0.9985 (last merge round=26)
[S11] round=28 local utility u=0.011130 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9956708251456263, 'loss_val': 0.06945732279295888, 'psi': 0.9959608149046978}-{'f1_val': 0.9961541414107454, 'auprc': 0.9964183886985745, 'loss_val': 0.09395986875324311, 'psi': 0.996259840325877}
[S13] START round=28 head_norm_before_train=1.301637 cos_to_last_merge=1.0000 (last merge round=27)
[S13] round=28 local utility u=0.000000 metrics={'f1_val': 0.5791518933891486, 'auprc': 0.6858206686536277, 'loss_val': 0.8626279390698857, 'psi': 0.6218194034949402}-{'f1_val': 0.6043742555874406, 'auprc': 0.6972689499270356, 'loss_val': 0.6888042450997699, 'psi': 0.6415321333232786}
[S14] START round=28 head_norm_before_train=1.537067 cos_to_last_merge=0.7364 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.736
[S14] round=28 local utility u=0.000000 metrics={'f1_val': 0.991134627690468, 'auprc': 0.9974800543713654, 'loss_val': 0.057775677768033384, 'psi': 0.993672798362827}-{'f1_val': 0.9971876286864827, 'auprc': 0.9978676232804332, 'loss_val': 0.04934929745630962, 'psi': 0.997459626524063}
[S15] START round=28 head_norm_before_train=1.984842 (no previous merge yet)
[S15] round=28 local utility u=0.000000 metrics={'f1_val': 0.9712113579537214, 'auprc': 0.9982434780456362, 'loss_val': 0.047264686382956916, 'psi': 0.9820242059904872}-{'f1_val': 0.9971773386779533, 'auprc': 0.9992244119104898, 'loss_val': 0.02781112222189111, 'psi': 0.9979961679709679}
[S16] START round=28 head_norm_before_train=1.395926 cos_to_last_merge=0.9952 (last merge round=25)
[S16] round=28 local utility u=0.204916 metrics={'f1_val': 0.9862910826004394, 'auprc': 0.9854496549483693, 'loss_val': 0.1676097009369717, 'psi': 0.9859545115396113}-{'f1_val': 0.9359279850589806, 'auprc': 0.9802739026348626, 'loss_val': 0.25973632928429996, 'psi': 0.9536663520893334}
[S17] START round=28 head_norm_before_train=1.634467 cos_to_last_merge=1.0000 (last merge round=27)
[S17] round=28 local utility u=0.000000 metrics={'f1_val': 0.578528167495082, 'auprc': 0.9111402795415452, 'loss_val': 0.8274786677387883, 'psi': 0.7115730123136672}-{'f1_val': 0.6246725319825313, 'auprc': 0.8763883196538247, 'loss_val': 0.6988805149483074, 'psi': 0.7253588470510486}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:31609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:31604
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:31617
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:31607
[S6] sending update (kind=head size=1798 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1805 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:31613
[S4] RECEIVED delta(kind=head bytes=1798) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.532122)
[S4] loaded HEAD from S6 (vec_in norm=1.532122)
[S4] cosine check vs S6: cos=0.9942
[S4] BUFFERED delta from S6 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1805) from S3
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.915275)
[S8] loaded HEAD from S3 (vec_in norm=1.915275)
[S8] cosine check vs S3: cos=-0.0748
[S8] DROPPED delta from S3 (cos=-0.0748 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=28 metric=0.9555 head_norm=1.532122
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.608604e-02
[S6] stored merged vector for next round verification (round=28)
[S6] DEBUG after merge:  round=28 metric=0.9578 head_norm=1.534853 delta_norm=0.076086
[S6] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:31615
[S8] sending update (kind=head size=1805 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1805) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.657940)
[S17] loaded HEAD from S8 (vec_in norm=1.657940)
[S17] cosine check vs S8: cos=0.9994
[S17] BUFFERED delta from S8 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1799) from S4
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.559145)
[S6] loaded HEAD from S4 (vec_in norm=1.559145)
[S6] cosine check vs S4: cos=0.9983
[S6] BUFFERED delta from S4 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1799) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.344630)
[S13] loaded HEAD from S11 (vec_in norm=1.344630)
[S13] cosine check vs S11: cos=0.9364
[S13] BUFFERED delta from S11 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S16] → sending delta(kind=head bytes=1806) to S2@127.0.0.1:31602
[S10] sending update (kind=head size=1799 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1799) from S10
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.822667)
[S15] loaded HEAD from S10 (vec_in norm=1.822667)
[S15] cosine check vs S10: cos=-0.1073
[S15] DROPPED delta from S10 (cos=-0.1073 < 0.0)
[S16] sending update (kind=head size=1806 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1806) from S16
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.442518)
[S2] loaded HEAD from S16 (vec_in norm=1.442518)
[S2] cosine check vs S16: cos=0.9839
[S2] BUFFERED delta from S16 (total buffered=1)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=28 metric=0.9399 head_norm=1.559145
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.397637e-02
[S4] stored merged vector for next round verification (round=28)
[S4] DEBUG after merge:  round=28 metric=0.9399 head_norm=1.543410 delta_norm=0.083976
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=28 metric=0.5785 head_norm=1.662577
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.842659e-02
[S17] stored merged vector for next round verification (round=28)
[S17] DEBUG after merge:  round=28 metric=0.5783 head_norm=1.660016 delta_norm=0.028427
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=28 metric=0.5792 head_norm=1.328243
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.384669e-01
[S13] stored merged vector for next round verification (round=28)
[S13] DEBUG after merge:  round=28 metric=0.5810 head_norm=1.315015 delta_norm=0.238467
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=28 metric=0.7013 head_norm=1.337113
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.353328e-01
[S2] stored merged vector for next round verification (round=28)
[S2] DEBUG after merge:  round=28 metric=0.7013 head_norm=1.384215 delta_norm=0.135333
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=1.384215 cos_to_last_merge=1.0000 (last merge round=28)
[S2] round=29 local utility u=0.023764 metrics={'f1_val': 0.7013141837391442, 'auprc': 0.7109646014344625, 'loss_val': 0.2766541632527742, 'psi': 0.7051743508172715}-{'f1_val': 0.7013141837391442, 'auprc': 0.6982782404017013, 'loss_val': 0.286122293679235, 'psi': 0.700099806404167}
[S3] START round=29 head_norm_before_train=1.915275 (no previous merge yet)
[S3] round=29 local utility u=0.000000 metrics={'f1_val': 0.9974247332315468, 'auprc': 0.9987673818753905, 'loss_val': 0.05334753376665358, 'psi': 0.9979617926890842}-{'f1_val': 0.9978100342676263, 'auprc': 0.9988454216713649, 'loss_val': 0.04315325389646837, 'psi': 0.9982241892291217}
[S4] START round=29 head_norm_before_train=1.543410 cos_to_last_merge=1.0000 (last merge round=28)
[S4] round=29 local utility u=0.000000 metrics={'f1_val': 0.938792822574858, 'auprc': 0.9588011689471362, 'loss_val': 0.3205556087023948, 'psi': 0.9467961611237693}-{'f1_val': 0.9399059391107898, 'auprc': 0.9644064642111019, 'loss_val': 0.26986563749236325, 'psi': 0.9497061491509147}
[S5] START round=29 head_norm_before_train=1.441420 cos_to_last_merge=1.0000 (last merge round=27)
[S5] round=29 local utility u=0.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9322417207533868, 'loss_val': 0.3303007393811532, 'psi': 0.793089478761703}-{'f1_val': 0.7003213174339138, 'auprc': 0.9894402662654612, 'loss_val': 0.2813926919634451, 'psi': 0.8159688969665327}
[S6] START round=29 head_norm_before_train=1.534853 cos_to_last_merge=1.0000 (last merge round=28)
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.7902556257302138, 'auprc': 0.9543506710975536, 'loss_val': 0.43757458182859893, 'psi': 0.8558936438771496}-{'f1_val': 0.9555448495937937, 'auprc': 0.9595032885604096, 'loss_val': 0.2686187839633717, 'psi': 0.95712822518044}
[S7] START round=29 head_norm_before_train=1.593024 cos_to_last_merge=0.9994 (last merge round=26)
[S7] round=29 local utility u=0.000000 metrics={'f1_val': 0.628464914903517, 'auprc': 0.798881427748531, 'loss_val': 0.5794043510868603, 'psi': 0.6966315200415226}-{'f1_val': 0.6340586103921066, 'auprc': 0.8006962354887397, 'loss_val': 0.5584924839300619, 'psi': 0.7007136604307599}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=29 head_norm_before_train=1.657940 cos_to_last_merge=0.9999 (last merge round=27)
[S8] round=29 local utility u=0.000000 metrics={'f1_val': 0.992174240363445, 'auprc': 0.9989976373822386, 'loss_val': 0.06364925626911475, 'psi': 0.9949035991709625}-{'f1_val': 0.9950136499820015, 'auprc': 0.9992806339050035, 'loss_val': 0.06396463401385555, 'psi': 0.9967204435512024}
[S9] START round=29 head_norm_before_train=1.720447 cos_to_last_merge=0.8143 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.814
[S9] round=29 local utility u=0.000000 metrics={'f1_val': 0.9938968689134425, 'auprc': 0.9988585831492599, 'loss_val': 0.029672997758094396, 'psi': 0.9958815546077695}-{'f1_val': 0.9971029125121428, 'auprc': 0.9937036690127297, 'loss_val': 0.02764644437461075, 'psi': 0.9957432151123775}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=29 head_norm_before_train=1.822667 cos_to_last_merge=0.9855 (last merge round=19)
[S10] round=29 local utility u=0.003103 metrics={'f1_val': 0.9960202599216732, 'auprc': 0.9965252744012425, 'loss_val': 0.03314495170764047, 'psi': 0.9962222657135009}-{'f1_val': 0.9956047769386365, 'auprc': 0.9958250975505344, 'loss_val': 0.03475794569509098, 'psi': 0.9956929051833957}
[S11] START round=29 head_norm_before_train=1.344630 cos_to_last_merge=0.9955 (last merge round=26)
[S11] round=29 local utility u=0.006226 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9948145937208637, 'loss_val': 0.05431398644304113, 'psi': 0.9956060424363311}-{'f1_val': 0.9961541414107454, 'auprc': 0.9956708251456263, 'loss_val': 0.06945732279295888, 'psi': 0.9959608149046978}
[S13] START round=29 head_norm_before_train=1.315015 cos_to_last_merge=1.0000 (last merge round=28)
[S13] round=29 local utility u=0.176734 metrics={'f1_val': 0.6222855043313513, 'auprc': 0.6662882961402989, 'loss_val': 0.7093637548862545, 'psi': 0.6398866210549303}-{'f1_val': 0.5791518933891486, 'auprc': 0.6858206686536277, 'loss_val': 0.8626279390698857, 'psi': 0.6218194034949402}
[S14] START round=29 head_norm_before_train=1.561933 cos_to_last_merge=0.7332 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.733
[S14] round=29 local utility u=0.000000 metrics={'f1_val': 0.9836928812816171, 'auprc': 0.9991787171987855, 'loss_val': 0.056251660747429516, 'psi': 0.9898872156484844}-{'f1_val': 0.991134627690468, 'auprc': 0.9974800543713654, 'loss_val': 0.057775677768033384, 'psi': 0.993672798362827}
[S15] START round=29 head_norm_before_train=1.998604 (no previous merge yet)
[S15] round=29 local utility u=0.000000 metrics={'f1_val': 0.908667680675268, 'auprc': 0.9981767437986391, 'loss_val': 0.10058166896308271, 'psi': 0.9444713059246165}-{'f1_val': 0.9712113579537214, 'auprc': 0.9982434780456362, 'loss_val': 0.047264686382956916, 'psi': 0.9820242059904872}
[S16] START round=29 head_norm_before_train=1.442518 cos_to_last_merge=0.9909 (last merge round=25)
[S16] round=29 local utility u=0.000000 metrics={'f1_val': 0.9070166907189449, 'auprc': 0.9813635024999685, 'loss_val': 0.4080032986083256, 'psi': 0.9367554154313542}-{'f1_val': 0.9862910826004394, 'auprc': 0.9854496549483693, 'loss_val': 0.1676097009369717, 'psi': 0.9859545115396113}
[S17] START round=29 head_norm_before_train=1.660016 cos_to_last_merge=1.0000 (last merge round=28)
[S17] round=29 local utility u=0.513881 metrics={'f1_val': 0.6849828804363357, 'auprc': 0.97866330740048, 'loss_val': 0.6410130481303277, 'psi': 0.8024550512219935}-{'f1_val': 0.578528167495082, 'auprc': 0.9111402795415452, 'loss_val': 0.8274786677387883, 'psi': 0.7115730123136672}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:31612
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=29 metric=0.7903 head_norm=1.547003
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.574692e-02
[S6] stored merged vector for next round verification (round=29)
[S6] DEBUG after merge:  round=29 metric=0.8079 head_norm=1.552085 delta_norm=0.055747
[S6] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:31613
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S10] → sending delta(kind=head bytes=1806) to S15@127.0.0.1:31615
[S11] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1800) from S2
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.403998)
[S11] loaded HEAD from S2 (vec_in norm=1.403998)
[S11] cosine check vs S2: cos=0.7556
[S11] BUFFERED delta from S2 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1801) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.392206)
[S13] loaded HEAD from S11 (vec_in norm=1.392206)
[S13] cosine check vs S11: cos=0.9801
[S13] BUFFERED delta from S11 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:31605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:31609
[S10] sending update (kind=head size=1806 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1806) from S10
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.839404)
[S15] loaded HEAD from S10 (vec_in norm=1.839404)
[S15] cosine check vs S10: cos=-0.1064
[S15] DROPPED delta from S10 (cos=-0.1064 < 0.0)
[S13] sending update (kind=head size=1802 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1802) from S13
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.333256)
[S5] loaded HEAD from S13 (vec_in norm=1.333256)
[S5] cosine check vs S13: cos=0.8669
[S5] BUFFERED delta from S13 (total buffered=1)
[S17] sending update (kind=head size=1797 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1797) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.682853)
[S8] loaded HEAD from S17 (vec_in norm=1.682853)
[S8] cosine check vs S17: cos=0.9992
[S8] BUFFERED delta from S17 (total buffered=1)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=29 metric=0.9961 head_norm=1.392206
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.887564e-01
[S11] stored merged vector for next round verification (round=29)
[S11] DEBUG after merge:  round=29 metric=0.9961 head_norm=1.309902 delta_norm=0.488756
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=29 metric=0.7003 head_norm=1.453089
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.640882e-01
[S5] stored merged vector for next round verification (round=29)
[S5] DEBUG after merge:  round=29 metric=0.7003 head_norm=1.346091 delta_norm=0.364088
[S5] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=29 metric=0.6223 head_norm=1.333256
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.390354e-01
[S13] stored merged vector for next round verification (round=29)
[S13] DEBUG after merge:  round=29 metric=0.6229 head_norm=1.355940 delta_norm=0.139035
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=1.403998 cos_to_last_merge=0.9998 (last merge round=28)
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.6969865609021697, 'auprc': 0.7140850517901055, 'loss_val': 0.2920708446587122, 'psi': 0.703825957257344}-{'f1_val': 0.7013141837391442, 'auprc': 0.7109646014344625, 'loss_val': 0.2766541632527742, 'psi': 0.7051743508172715}
[S3] START round=30 head_norm_before_train=1.931605 (no previous merge yet)
[S3] round=30 local utility u=0.000000 metrics={'f1_val': 0.9940413550152986, 'auprc': 0.9988301189197155, 'loss_val': 0.07958365379012332, 'psi': 0.9959568605770655}-{'f1_val': 0.9974247332315468, 'auprc': 0.9987673818753905, 'loss_val': 0.05334753376665358, 'psi': 0.9979617926890842}
[S4] START round=30 head_norm_before_train=1.560532 cos_to_last_merge=0.9999 (last merge round=28)
[S4] round=30 local utility u=0.000000 metrics={'f1_val': 0.6388345714110297, 'auprc': 0.9352848273998114, 'loss_val': 0.5444909897981874, 'psi': 0.7574146738065424}-{'f1_val': 0.938792822574858, 'auprc': 0.9588011689471362, 'loss_val': 0.3205556087023948, 'psi': 0.9467961611237693}
[S5] START round=30 head_norm_before_train=1.346091 cos_to_last_merge=1.0000 (last merge round=29)
[S5] round=30 local utility u=0.000000 metrics={'f1_val': 0.43676623050537206, 'auprc': 0.8536902615600825, 'loss_val': 0.7704525147616262, 'psi': 0.6035358429272563}-{'f1_val': 0.7003213174339138, 'auprc': 0.9322417207533868, 'loss_val': 0.3303007393811532, 'psi': 0.793089478761703}
[S6] START round=30 head_norm_before_train=1.552085 cos_to_last_merge=1.0000 (last merge round=29)
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.7708295830826903, 'auprc': 0.9547635236121449, 'loss_val': 0.5005176897793484, 'psi': 0.8444031592944721}-{'f1_val': 0.7902556257302138, 'auprc': 0.9543506710975536, 'loss_val': 0.43757458182859893, 'psi': 0.8558936438771496}
[S7] START round=30 head_norm_before_train=1.605130 cos_to_last_merge=0.9987 (last merge round=26)
[S7] round=30 local utility u=0.051004 metrics={'f1_val': 0.6377371810713719, 'auprc': 0.8020020929727796, 'loss_val': 0.5423927727436725, 'psi': 0.703443145831935}-{'f1_val': 0.628464914903517, 'auprc': 0.798881427748531, 'loss_val': 0.5794043510868603, 'psi': 0.6966315200415226}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=30 head_norm_before_train=1.679446 cos_to_last_merge=0.9996 (last merge round=27)
[S8] round=30 local utility u=0.011352 metrics={'f1_val': 0.9942788405856967, 'auprc': 0.9992256768793536, 'loss_val': 0.05425667064419003, 'psi': 0.9962575751031595}-{'f1_val': 0.992174240363445, 'auprc': 0.9989976373822386, 'loss_val': 0.06364925626911475, 'psi': 0.9949035991709625}
[S9] START round=30 head_norm_before_train=1.730859 cos_to_last_merge=0.8127 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.813
[S9] round=30 local utility u=0.013448 metrics={'f1_val': 0.9975138174234109, 'auprc': 0.9988535874221457, 'loss_val': 0.02446372692747942, 'psi': 0.9980497254229048}-{'f1_val': 0.9938968689134425, 'auprc': 0.9988585831492599, 'loss_val': 0.029672997758094396, 'psi': 0.9958815546077695}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] sending update (kind=head size=1793 to 1 peers)
[S10] START round=30 head_norm_before_train=1.839404 cos_to_last_merge=0.9844 (last merge round=19)
[S10] round=30 local utility u=0.000000 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9957728142930964, 'loss_val': 0.03217664980295909, 'psi': 0.9956749178262505}-{'f1_val': 0.9960202599216732, 'auprc': 0.9965252744012425, 'loss_val': 0.03314495170764047, 'psi': 0.9962222657135009}
[S11] START round=30 head_norm_before_train=1.309902 cos_to_last_merge=1.0000 (last merge round=29)
[S11] round=30 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9951311983752323, 'loss_val': 0.0606789187825735, 'psi': 0.9959806820582466}-{'f1_val': 0.9961336749133093, 'auprc': 0.9948145937208637, 'loss_val': 0.05431398644304113, 'psi': 0.9956060424363311}
[S13] START round=30 head_norm_before_train=1.355940 cos_to_last_merge=1.0000 (last merge round=29)
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.6035327859717463, 'auprc': 0.6801732866424643, 'loss_val': 0.7965728048706728, 'psi': 0.6341889862400335}-{'f1_val': 0.6222855043313513, 'auprc': 0.6662882961402989, 'loss_val': 0.7093637548862545, 'psi': 0.6398866210549303}
[S14] START round=30 head_norm_before_train=1.582056 cos_to_last_merge=0.7310 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.731
[S14] round=30 local utility u=0.051305 metrics={'f1_val': 0.9974310505072961, 'auprc': 0.9992077190167004, 'loss_val': 0.03615814951452077, 'psi': 0.9981417179110578}-{'f1_val': 0.9836928812816171, 'auprc': 0.9991787171987855, 'loss_val': 0.056251660747429516, 'psi': 0.9898872156484844}
[S15] START round=30 head_norm_before_train=2.011904 (no previous merge yet)
[S15] round=30 local utility u=0.305778 metrics={'f1_val': 0.9971773386779533, 'auprc': 0.998764250137641, 'loss_val': 0.021846378688665947, 'psi': 0.9978121032618283}-{'f1_val': 0.908667680675268, 'auprc': 0.9981767437986391, 'loss_val': 0.10058166896308271, 'psi': 0.9444713059246165}
[S16] START round=30 head_norm_before_train=1.485420 cos_to_last_merge=0.9865 (last merge round=25)
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.865713734984415, 'auprc': 0.9893538012896346, 'loss_val': 0.5553946072739544, 'psi': 0.9151697615065029}-{'f1_val': 0.9070166907189449, 'auprc': 0.9813635024999685, 'loss_val': 0.4080032986083256, 'psi': 0.9367554154313542}
[S17] START round=30 head_norm_before_train=1.682853 cos_to_last_merge=0.9998 (last merge round=28)
[S17] round=30 local utility u=0.000000 metrics={'f1_val': 0.5138399600998133, 'auprc': 0.7134821480202546, 'loss_val': 1.0117672263727207, 'psi': 0.5936968352679898}-{'f1_val': 0.6849828804363357, 'auprc': 0.97866330740048, 'loss_val': 0.6410130481303277, 'psi': 0.8024550512219935}
[S4]  timeout peer S9
[S17]  timeout peer S7
[S10]  timeout peer S5
[S13]  timeout peer S11
[S2]  timeout peer S16
[S5]  timeout peer S4
[S5]  timeout peer S13
[S5]  timeout peer S17
[S11]  timeout peer S2
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:31615
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] ⇄ pheromone p=0.110 → S8@127.0.0.1:31609
[S6] ⇄ pheromone p=0.147 → S4@127.0.0.1:31604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:31611
[S14] sending update (kind=head size=1801 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:31617
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] RECEIVED delta(kind=head bytes=1801) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.598507)
[S15] loaded HEAD from S14 (vec_in norm=1.598507)
[S15] cosine check vs S14: cos=-0.0637
[S15] DROPPED delta from S14 (cos=-0.0637 < 0.0)
[S14] ⇄ pheromone p=0.048 → S15@127.0.0.1:31615
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] ⇄ pheromone p=0.021 → S13@127.0.0.1:31613
[S15] sending update (kind=head size=1802 to 1 peers)
[S17] ⇄ pheromone p=0.185 → S8@127.0.0.1:31609
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1805 to 1 peers)
[S2] ⇄ pheromone p=0.029 → S11@127.0.0.1:31612
[S13] ⇄ pheromone p=0.068 → S5@127.0.0.1:31605
[S4] ⇄ pheromone p=0.036 → S6@127.0.0.1:31607
[S17] RECEIVED delta(kind=head bytes=1805) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.697382)
[S17] loaded HEAD from S8 (vec_in norm=1.697382)
[S17] cosine check vs S8: cos=0.9981
[S17] BUFFERED delta from S8 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1802) from S15
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=2.024679)
[S10] loaded HEAD from S15 (vec_in norm=2.024679)
[S10] cosine check vs S15: cos=-0.1056
[S10] DROPPED delta from S15 (cos=-0.1056 < 0.0)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=30 metric=0.9943 head_norm=1.697382
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.158939e-02
[S8] stored merged vector for next round verification (round=30)
[S8] DEBUG after merge:  round=30 metric=0.9943 head_norm=1.689621 delta_norm=0.041589
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.025 → S17@127.0.0.1:31617
[S15] ⇄ pheromone p=0.162 → S10@127.0.0.1:31611
[S10] ⇄ pheromone p=0.014 → S15@127.0.0.1:31615
[S16] ⇄ pheromone p=0.149 → S2@127.0.0.1:31602
[S2] START round=31 head_norm_before_train=1.420017 cos_to_last_merge=0.9994 (last merge round=28)
[S2] round=31 local utility u=0.000000 metrics={'f1_val': 0.6818589106875468, 'auprc': 0.6751509884900635, 'loss_val': 0.36921277997933627, 'psi': 0.6791757418085534}-{'f1_val': 0.6969865609021697, 'auprc': 0.7140850517901055, 'loss_val': 0.2920708446587122, 'psi': 0.703825957257344}
[S3] START round=31 head_norm_before_train=1.947694 (no previous merge yet)
[S3] round=31 local utility u=0.000000 metrics={'f1_val': 0.9608296089712303, 'auprc': 0.9986241320629113, 'loss_val': 0.1354983292991231, 'psi': 0.9759474182079027}-{'f1_val': 0.9940413550152986, 'auprc': 0.9988301189197155, 'loss_val': 0.07958365379012332, 'psi': 0.9959568605770655}
[S4] START round=31 head_norm_before_train=1.573963 cos_to_last_merge=0.9996 (last merge round=28)
[S4] round=31 local utility u=1.000000 metrics={'f1_val': 0.9389370308485148, 'auprc': 0.9641759308614803, 'loss_val': 0.2667928687526145, 'psi': 0.949032590853701}-{'f1_val': 0.6388345714110297, 'auprc': 0.9352848273998114, 'loss_val': 0.5444909897981874, 'psi': 0.7574146738065424}
[S5] START round=31 head_norm_before_train=1.354081 cos_to_last_merge=1.0000 (last merge round=29)
[S5] round=31 local utility u=1.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9833531623904236, 'loss_val': 0.2930115762733356, 'psi': 0.8135340554165177}-{'f1_val': 0.43676623050537206, 'auprc': 0.8536902615600825, 'loss_val': 0.7704525147616262, 'psi': 0.6035358429272563}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=31 head_norm_before_train=1.565784 cos_to_last_merge=0.9999 (last merge round=29)
[S6] round=31 local utility u=0.734993 metrics={'f1_val': 0.961495162475342, 'auprc': 0.9658643142471389, 'loss_val': 0.20782701196416944, 'psi': 0.9632428231840607}-{'f1_val': 0.7708295830826903, 'auprc': 0.9547635236121449, 'loss_val': 0.5005176897793484, 'psi': 0.8444031592944721}
[S7] START round=31 head_norm_before_train=1.616110 cos_to_last_merge=0.9982 (last merge round=26)
[S7] round=31 local utility u=0.077747 metrics={'f1_val': 0.6506888071161481, 'auprc': 0.8101764160551248, 'loss_val': 0.4891308948762547, 'psi': 0.7144838506917388}-{'f1_val': 0.6377371810713719, 'auprc': 0.8020020929727796, 'loss_val': 0.5423927727436725, 'psi': 0.703443145831935}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=31 head_norm_before_train=1.689621 cos_to_last_merge=1.0000 (last merge round=30)
[S8] round=31 local utility u=0.000000 metrics={'f1_val': 0.9935219944084961, 'auprc': 0.999135419338612, 'loss_val': 0.06030354660661415, 'psi': 0.9957673643805425}-{'f1_val': 0.9942788405856967, 'auprc': 0.9992256768793536, 'loss_val': 0.05425667064419003, 'psi': 0.9962575751031595}
[S9] START round=31 head_norm_before_train=1.742643 cos_to_last_merge=0.8111 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.811
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9966104356076492, 'loss_val': 0.023988356178539717, 'psi': 0.9969059217503453}-{'f1_val': 0.9975138174234109, 'auprc': 0.9988535874221457, 'loss_val': 0.02446372692747942, 'psi': 0.9980497254229048}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=31 head_norm_before_train=1.856512 cos_to_last_merge=0.9834 (last merge round=19)
[S10] round=31 local utility u=0.000209 metrics={'f1_val': 0.9960202599216732, 'auprc': 0.9950485091529281, 'loss_val': 0.032049950335951205, 'psi': 0.9956315596141752}-{'f1_val': 0.9956096535150197, 'auprc': 0.9957728142930964, 'loss_val': 0.03217664980295909, 'psi': 0.9956749178262505}
[S11] START round=31 head_norm_before_train=1.351071 cos_to_last_merge=0.9995 (last merge round=29)
[S11] round=31 local utility u=0.003657 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9941502109217463, 'loss_val': 0.05042156792831928, 'psi': 0.9955882870768522}-{'f1_val': 0.9965470045135896, 'auprc': 0.9951311983752323, 'loss_val': 0.0606789187825735, 'psi': 0.9959806820582466}
[S13] START round=31 head_norm_before_train=1.368208 cos_to_last_merge=0.9998 (last merge round=29)
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.5989992851142754, 'auprc': 0.6790773539348443, 'loss_val': 0.8262132024446105, 'psi': 0.6310305126425029}-{'f1_val': 0.6035327859717463, 'auprc': 0.6801732866424643, 'loss_val': 0.7965728048706728, 'psi': 0.6341889862400335}
[S14] START round=31 head_norm_before_train=1.598507 cos_to_last_merge=0.7292 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.729
[S14] round=31 local utility u=0.000454 metrics={'f1_val': 0.9971907882668205, 'auprc': 0.99958458475222, 'loss_val': 0.03493931750490281, 'psi': 0.9981483068609803}-{'f1_val': 0.9974310505072961, 'auprc': 0.9992077190167004, 'loss_val': 0.03615814951452077, 'psi': 0.9981417179110578}
[S15] START round=31 head_norm_before_train=2.024679 (no previous merge yet)
[S15] round=31 local utility u=0.000000 metrics={'f1_val': 0.9971773386779533, 'auprc': 0.9986560987358136, 'loss_val': 0.027853240597496932, 'psi': 0.9977688427010974}-{'f1_val': 0.9971773386779533, 'auprc': 0.998764250137641, 'loss_val': 0.021846378688665947, 'psi': 0.9978121032618283}
[S16] START round=31 head_norm_before_train=1.519136 cos_to_last_merge=0.9828 (last merge round=25)
[S16] round=31 local utility u=0.399532 metrics={'f1_val': 0.9430503690304697, 'auprc': 0.9774604577515044, 'loss_val': 0.18466998027414636, 'psi': 0.9568144045188836}-{'f1_val': 0.865713734984415, 'auprc': 0.9893538012896346, 'loss_val': 0.5553946072739544, 'psi': 0.9151697615065029}
[S17] START round=31 head_norm_before_train=1.702510 cos_to_last_merge=0.9995 (last merge round=28)
[S17] round=31 local utility u=0.223940 metrics={'f1_val': 0.5492639852066065, 'auprc': 0.7916706787059846, 'loss_val': 1.010996300758135, 'psi': 0.6462266626063577}-{'f1_val': 0.5138399600998133, 'auprc': 0.7134821480202546, 'loss_val': 1.0117672263727207, 'psi': 0.5936968352679898}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:31613
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:31607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:31604
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:31615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:31609
[S17] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:31616
[S11] sending update (kind=head size=1799 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1796 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1799) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.389672)
[S13] loaded HEAD from S11 (vec_in norm=1.389672)
[S13] cosine check vs S11: cos=0.9099
[S13] BUFFERED delta from S11 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1804) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.723711)
[S8] loaded HEAD from S17 (vec_in norm=1.723711)
[S8] cosine check vs S17: cos=0.9983
[S8] BUFFERED delta from S17 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1799) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.578605)
[S4] loaded HEAD from S6 (vec_in norm=1.578605)
[S4] cosine check vs S6: cos=0.9995
[S4] BUFFERED delta from S6 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1803) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.613885)
[S15] loaded HEAD from S14 (vec_in norm=1.613885)
[S15] cosine check vs S14: cos=-0.0637
[S15] DROPPED delta from S14 (cos=-0.0637 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1796) from S4
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.585828)
[S6] loaded HEAD from S4 (vec_in norm=1.585828)
[S6] cosine check vs S4: cos=0.9995
[S6] BUFFERED delta from S4 (total buffered=1)
[S10] sending update (kind=head size=1798 to 1 peers)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=31 metric=0.9615 head_norm=1.578605
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.598556e-02
[S6] stored merged vector for next round verification (round=31)
[S6] DEBUG after merge:  round=31 metric=0.9615 head_norm=1.582007 delta_norm=0.025986
[S6] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=31 metric=0.9389 head_norm=1.585828
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.598557e-02
[S4] stored merged vector for next round verification (round=31)
[S4] DEBUG after merge:  round=31 metric=0.9389 head_norm=1.582007 delta_norm=0.025986
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=31 metric=0.5493 head_norm=1.723711
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.638940e-02
[S17] stored merged vector for next round verification (round=31)
[S17] DEBUG after merge:  round=31 metric=0.5482 head_norm=1.709308 delta_norm=0.066389
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] RECEIVED delta(kind=head bytes=1798) from S10
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.873130)
[S16] loaded HEAD from S10 (vec_in norm=1.873130)
[S16] cosine check vs S10: cos=0.7200
[S16] BUFFERED delta from S10 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] → sending delta(kind=head bytes=1805) to S2@127.0.0.1:31602
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=31 metric=0.9935 head_norm=1.704144
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.040329e-02
[S8] stored merged vector for next round verification (round=31)
[S8] DEBUG after merge:  round=31 metric=0.9935 head_norm=1.713214 delta_norm=0.050403
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] sending update (kind=head size=1805 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1805) from S16
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.547644)
[S2] loaded HEAD from S16 (vec_in norm=1.547644)
[S2] cosine check vs S16: cos=0.9872
[S2] BUFFERED delta from S16 (total buffered=1)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=31 metric=0.9431 head_norm=1.547644
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.575161e-01
[S16] stored merged vector for next round verification (round=31)
[S16] DEBUG after merge:  round=31 metric=0.9520 head_norm=1.587319 delta_norm=0.657516
[S16] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=32 head_norm_before_train=1.434129 cos_to_last_merge=0.9990 (last merge round=28)
[S2] round=32 local utility u=0.092438 metrics={'f1_val': 0.6953649731200401, 'auprc': 0.6846948799149416, 'loss_val': 0.2940053274370429, 'psi': 0.6910969358380007}-{'f1_val': 0.6818589106875468, 'auprc': 0.6751509884900635, 'loss_val': 0.36921277997933627, 'psi': 0.6791757418085534}
[S3] START round=32 head_norm_before_train=1.966010 (no previous merge yet)
[S3] round=32 local utility u=0.000000 metrics={'f1_val': 0.8884481035664363, 'auprc': 0.9987387300016839, 'loss_val': 0.16686993719360826, 'psi': 0.9325643541405354}-{'f1_val': 0.9608296089712303, 'auprc': 0.9986241320629113, 'loss_val': 0.1354983292991231, 'psi': 0.9759474182079027}
[S4] START round=32 head_norm_before_train=1.582007 cos_to_last_merge=1.0000 (last merge round=31)
[S4] round=32 local utility u=0.035100 metrics={'f1_val': 0.9498433993346704, 'auprc': 0.958244803555989, 'loss_val': 0.24423849634917874, 'psi': 0.9532039610231978}-{'f1_val': 0.9389370308485148, 'auprc': 0.9641759308614803, 'loss_val': 0.2667928687526145, 'psi': 0.949032590853701}
[S5] START round=32 head_norm_before_train=1.362908 cos_to_last_merge=0.9998 (last merge round=29)
[S5] round=32 local utility u=0.000000 metrics={'f1_val': 0.43676623050537206, 'auprc': 0.855694863053139, 'loss_val': 0.7125603272277764, 'psi': 0.6043376835244789}-{'f1_val': 0.7003213174339138, 'auprc': 0.9833531623904236, 'loss_val': 0.2930115762733356, 'psi': 0.8135340554165177}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=32 head_norm_before_train=1.582007 cos_to_last_merge=1.0000 (last merge round=31)
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.5961936176633867, 'auprc': 0.9313887792860505, 'loss_val': 0.6780942306320089, 'psi': 0.7302716823124522}-{'f1_val': 0.961495162475342, 'auprc': 0.9658643142471389, 'loss_val': 0.20782701196416944, 'psi': 0.9632428231840607}
[S7] START round=32 head_norm_before_train=1.629383 cos_to_last_merge=0.9979 (last merge round=26)
[S7] round=32 local utility u=0.000000 metrics={'f1_val': 0.5824974758152632, 'auprc': 0.7881187913067345, 'loss_val': 0.709423698536505, 'psi': 0.6647460020118516}-{'f1_val': 0.6506888071161481, 'auprc': 0.8101764160551248, 'loss_val': 0.4891308948762547, 'psi': 0.7144838506917388}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=32 head_norm_before_train=1.713214 cos_to_last_merge=1.0000 (last merge round=31)
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.9896426608072839, 'auprc': 0.9989560495272672, 'loss_val': 0.06132016055786392, 'psi': 0.9933680162952773}-{'f1_val': 0.9935219944084961, 'auprc': 0.999135419338612, 'loss_val': 0.06030354660661415, 'psi': 0.9957673643805425}
[S9] START round=32 head_norm_before_train=1.755456 cos_to_last_merge=0.8097 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.810
[S9] round=32 local utility u=0.000774 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9988527828796727, 'loss_val': 0.024175852960545988, 'psi': 0.9973037305901128}-{'f1_val': 0.9971029125121428, 'auprc': 0.9966104356076492, 'loss_val': 0.023988356178539717, 'psi': 0.9969059217503453}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=32 head_norm_before_train=1.873130 cos_to_last_merge=0.9825 (last merge round=19)
[S10] round=32 local utility u=0.000847 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9958529342321187, 'loss_val': 0.0303065259719418, 'psi': 0.9957069658018594}-{'f1_val': 0.9960202599216732, 'auprc': 0.9950485091529281, 'loss_val': 0.032049950335951205, 'psi': 0.9956315596141752}
[S11] START round=32 head_norm_before_train=1.389672 cos_to_last_merge=0.9983 (last merge round=29)
[S11] round=32 local utility u=0.004678 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9955339502983325, 'loss_val': 0.042737468877362184, 'psi': 0.9958937850673186}-{'f1_val': 0.9965470045135896, 'auprc': 0.9941502109217463, 'loss_val': 0.05042156792831928, 'psi': 0.9955882870768522}
[S13] START round=32 head_norm_before_train=1.384309 cos_to_last_merge=0.9988 (last merge round=29)
[S13] round=32 local utility u=0.099625 metrics={'f1_val': 0.6150118482584339, 'auprc': 0.6832035890084143, 'loss_val': 0.7354178416683407, 'psi': 0.6422885445584261}-{'f1_val': 0.5989992851142754, 'auprc': 0.6790773539348443, 'loss_val': 0.8262132024446105, 'psi': 0.6310305126425029}
[S14] START round=32 head_norm_before_train=1.613885 cos_to_last_merge=0.7275 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.727
[S14] round=32 local utility u=0.000000 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.99748050089419, 'loss_val': 0.03621046336467664, 'psi': 0.9974371620587114}-{'f1_val': 0.9971907882668205, 'auprc': 0.99958458475222, 'loss_val': 0.03493931750490281, 'psi': 0.9981483068609803}
[S15] START round=32 head_norm_before_train=2.037038 (no previous merge yet)
[S15] round=32 local utility u=0.000000 metrics={'f1_val': 0.901734611659146, 'auprc': 0.9979452946454322, 'loss_val': 0.15140788988661788, 'psi': 0.9402188848536606}-{'f1_val': 0.9971773386779533, 'auprc': 0.9986560987358136, 'loss_val': 0.027853240597496932, 'psi': 0.9977688427010974}
[S16] START round=32 head_norm_before_train=1.587319 cos_to_last_merge=1.0000 (last merge round=31)
[S16] round=32 local utility u=0.000000 metrics={'f1_val': 0.9085204883737099, 'auprc': 0.9850383312742274, 'loss_val': 0.40940529966037315, 'psi': 0.9391276255339169}-{'f1_val': 0.9430503690304697, 'auprc': 0.9774604577515044, 'loss_val': 0.18466998027414636, 'psi': 0.9568144045188836}
[S17] START round=32 head_norm_before_train=1.709308 cos_to_last_merge=1.0000 (last merge round=31)
[S17] round=32 local utility u=0.281677 metrics={'f1_val': 0.5862397079803028, 'auprc': 0.8556562442623783, 'loss_val': 0.861453135036577, 'psi': 0.694006322493133}-{'f1_val': 0.5492639852066065, 'auprc': 0.7916706787059846, 'loss_val': 1.010996300758135, 'psi': 0.6462266626063577}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:31609
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:31607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:31612
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S13] → sending delta(kind=head bytes=1807) to S5@127.0.0.1:31605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:31613
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1807 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:31616
[S4] sending update (kind=head size=1799 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] RECEIVED delta(kind=head bytes=1797) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.423009)
[S13] loaded HEAD from S11 (vec_in norm=1.423009)
[S13] cosine check vs S11: cos=0.9086
[S13] BUFFERED delta from S11 (total buffered=2)
[S6] RECEIVED delta(kind=head bytes=1799) from S4
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.594141)
[S6] loaded HEAD from S4 (vec_in norm=1.594141)
[S6] cosine check vs S4: cos=0.9998
[S6] BUFFERED delta from S4 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1798) from S2
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.447275)
[S11] loaded HEAD from S2 (vec_in norm=1.447275)
[S11] cosine check vs S2: cos=0.9207
[S11] BUFFERED delta from S2 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1797) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.727010)
[S8] loaded HEAD from S17 (vec_in norm=1.727010)
[S8] cosine check vs S17: cos=0.9999
[S8] BUFFERED delta from S17 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1807) from S13
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.399409)
[S5] loaded HEAD from S13 (vec_in norm=1.399409)
[S5] cosine check vs S13: cos=0.9271
[S5] BUFFERED delta from S13 (total buffered=1)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=32 metric=0.6954 head_norm=1.447275
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.303972e-01
[S2] stored merged vector for next round verification (round=32)
[S2] DEBUG after merge:  round=32 metric=0.6936 head_norm=1.492615 delta_norm=0.130397
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=32 metric=0.9961 head_norm=1.423009
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.860138e-01
[S11] stored merged vector for next round verification (round=32)
[S11] DEBUG after merge:  round=32 metric=0.9961 head_norm=1.406405 delta_norm=0.286014
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=32 metric=0.6150 head_norm=1.399409
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.007941e-01
[S13] stored merged vector for next round verification (round=32)
[S13] DEBUG after merge:  round=32 metric=0.6183 head_norm=1.370209 delta_norm=0.300794
[S13] aggregate: ACCEPT kept=['S11', 'S11'] (k=2/2) mode=median trim_p=0.1
[S10] sending update (kind=head size=1800 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1800) from S10
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.889479)
[S16] loaded HEAD from S10 (vec_in norm=1.889479)
[S16] cosine check vs S10: cos=0.9399
[S16] BUFFERED delta from S10 (total buffered=1)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=32 metric=0.9896 head_norm=1.726864
[S8] _apply_head_vector_avg (torch): Δ‖w‖=9.505770e-03
[S8] stored merged vector for next round verification (round=32)
[S8] DEBUG after merge:  round=32 metric=0.9896 head_norm=1.726911 delta_norm=0.009506
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=32 metric=0.9085 head_norm=1.612353
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.328115e-01
[S16] stored merged vector for next round verification (round=32)
[S16] DEBUG after merge:  round=32 metric=0.9087 head_norm=1.724571 delta_norm=0.332811
[S16] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=33 head_norm_before_train=1.492615 cos_to_last_merge=1.0000 (last merge round=32)
[S2] round=33 local utility u=0.020070 metrics={'f1_val': 0.7013141837391442, 'auprc': 0.6813943086181762, 'loss_val': 0.2796589120854389, 'psi': 0.693346233690757}-{'f1_val': 0.6953649731200401, 'auprc': 0.6846948799149416, 'loss_val': 0.2940053274370429, 'psi': 0.6910969358380007}
[S3] START round=33 head_norm_before_train=1.982406 (no previous merge yet)
[S3] round=33 local utility u=0.086974 metrics={'f1_val': 0.9144567318899594, 'auprc': 0.9987039586259875, 'loss_val': 0.14886912529659305, 'psi': 0.9481556225843706}-{'f1_val': 0.8884481035664363, 'auprc': 0.9987387300016839, 'loss_val': 0.16686993719360826, 'psi': 0.9325643541405354}
[S4] START round=33 head_norm_before_train=1.594141 cos_to_last_merge=1.0000 (last merge round=31)
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.9400087075833456, 'auprc': 0.9297020220254952, 'loss_val': 0.2734288085735151, 'psi': 0.9358860333602055}-{'f1_val': 0.9498433993346704, 'auprc': 0.958244803555989, 'loss_val': 0.24423849634917874, 'psi': 0.9532039610231978}
[S5] START round=33 head_norm_before_train=1.371615 cos_to_last_merge=0.9997 (last merge round=29)
[S5] round=33 local utility u=0.395051 metrics={'f1_val': 0.5475548318681089, 'auprc': 0.8556871027861734, 'loss_val': 0.5871669142396753, 'psi': 0.6708077402353347}-{'f1_val': 0.43676623050537206, 'auprc': 0.855694863053139, 'loss_val': 0.7125603272277764, 'psi': 0.6043376835244789}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=33 metric=0.5476 head_norm=1.378402
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.672648e-01
[S5] stored merged vector for next round verification (round=33)
[S5] DEBUG after merge:  round=33 metric=0.5652 head_norm=1.362989 delta_norm=0.267265
[S5] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S6] START round=33 head_norm_before_train=1.593957 cos_to_last_merge=0.9999 (last merge round=31)
[S6] round=33 local utility u=0.920772 metrics={'f1_val': 0.8413445826189166, 'auprc': 0.9513941344588248, 'loss_val': 0.36747241467366276, 'psi': 0.88536440335488}-{'f1_val': 0.5961936176633867, 'auprc': 0.9313887792860505, 'loss_val': 0.6780942306320089, 'psi': 0.7302716823124522}
[S7] START round=33 head_norm_before_train=1.639292 cos_to_last_merge=0.9977 (last merge round=26)
[S7] round=33 local utility u=0.000000 metrics={'f1_val': 0.4886959760204211, 'auprc': 0.7824709520520212, 'loss_val': 0.9294084042642209, 'psi': 0.6062059664330611}-{'f1_val': 0.5824974758152632, 'auprc': 0.7881187913067345, 'loss_val': 0.709423698536505, 'psi': 0.6647460020118516}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=33 head_norm_before_train=1.726911 cos_to_last_merge=1.0000 (last merge round=32)
[S8] round=33 local utility u=0.000000 metrics={'f1_val': 0.7186865991026945, 'auprc': 0.9883227172457073, 'loss_val': 0.1949150823516146, 'psi': 0.8265410463598997}-{'f1_val': 0.9896426608072839, 'auprc': 0.9989560495272672, 'loss_val': 0.06132016055786392, 'psi': 0.9933680162952773}
[S9] START round=33 head_norm_before_train=1.768720 cos_to_last_merge=0.8082 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.808
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.9905718417662249, 'auprc': 0.9988633883855401, 'loss_val': 0.03529016142345815, 'psi': 0.9938884604139511}-{'f1_val': 0.9962710290637395, 'auprc': 0.9988527828796727, 'loss_val': 0.024175852960545988, 'psi': 0.9973037305901128}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=33 head_norm_before_train=1.889479 cos_to_last_merge=0.9817 (last merge round=19)
[S10] round=33 local utility u=0.000608 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9959766989660471, 'loss_val': 0.02946201610858153, 'psi': 0.9957564716954308}-{'f1_val': 0.9956096535150197, 'auprc': 0.9958529342321187, 'loss_val': 0.0303065259719418, 'psi': 0.9957069658018594}
[S11] START round=33 head_norm_before_train=1.406405 cos_to_last_merge=1.0000 (last merge round=32)
[S11] round=33 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.995885776780193, 'loss_val': 0.05156255624618926, 'psi': 0.9960345156600627}-{'f1_val': 0.9961336749133093, 'auprc': 0.9955339502983325, 'loss_val': 0.042737468877362184, 'psi': 0.9958937850673186}
[S13] START round=33 head_norm_before_train=1.370209 cos_to_last_merge=1.0000 (last merge round=32)
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.5697312052190104, 'auprc': 0.7185301409214775, 'loss_val': 0.9537470014727051, 'psi': 0.6292507794999973}-{'f1_val': 0.6150118482584339, 'auprc': 0.6832035890084143, 'loss_val': 0.7354178416683407, 'psi': 0.6422885445584261}
[S14] START round=33 head_norm_before_train=1.629137 cos_to_last_merge=0.7261 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.726
[S14] round=33 local utility u=0.004587 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9991775122812507, 'loss_val': 0.032126716400572616, 'psi': 0.9981159666135356}-{'f1_val': 0.9974082695017256, 'auprc': 0.99748050089419, 'loss_val': 0.03621046336467664, 'psi': 0.9974371620587114}
[S15] START round=33 head_norm_before_train=2.049401 (no previous merge yet)
[S15] round=33 local utility u=0.000000 metrics={'f1_val': 0.9008099377434587, 'auprc': 0.9427704990515173, 'loss_val': 0.2825130790990957, 'psi': 0.9175941622666821}-{'f1_val': 0.901734611659146, 'auprc': 0.9979452946454322, 'loss_val': 0.15140788988661788, 'psi': 0.9402188848536606}
[S16] START round=33 head_norm_before_train=1.724571 cos_to_last_merge=1.0000 (last merge round=32)
[S16] round=33 local utility u=0.198592 metrics={'f1_val': 0.9389919632553922, 'auprc': 0.9817845423117558, 'loss_val': 0.1852878252451167, 'psi': 0.9561089948779378}-{'f1_val': 0.9085204883737099, 'auprc': 0.9850383312742274, 'loss_val': 0.40940529966037315, 'psi': 0.9391276255339169}
[S17] START round=33 head_norm_before_train=1.727010 cos_to_last_merge=0.9999 (last merge round=31)
[S17] round=33 local utility u=0.027030 metrics={'f1_val': 0.5940381138936355, 'auprc': 0.8622410512956777, 'loss_val': 0.8739370835835764, 'psi': 0.7013192888544524}-{'f1_val': 0.5862397079803028, 'auprc': 0.8556562442623783, 'loss_val': 0.861453135036577, 'psi': 0.694006322493133}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:31604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:31609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:31612
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:31609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:31615
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:31616
[S17] sending update (kind=head size=1800 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] RECEIVED delta(kind=head bytes=1800) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.743140)
[S8] loaded HEAD from S17 (vec_in norm=1.743140)
[S8] cosine check vs S17: cos=0.9998
[S8] BUFFERED delta from S17 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1802) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.646166)
[S15] loaded HEAD from S14 (vec_in norm=1.646166)
[S15] cosine check vs S14: cos=-0.0638
[S15] DROPPED delta from S14 (cos=-0.0638 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1802) from S2
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.504113)
[S11] loaded HEAD from S2 (vec_in norm=1.504113)
[S11] cosine check vs S2: cos=0.9644
[S11] BUFFERED delta from S2 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1800) from S3
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.995309)
[S8] loaded HEAD from S3 (vec_in norm=1.995309)
[S8] cosine check vs S3: cos=-0.0752
[S8] DROPPED delta from S3 (cos=-0.0752 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1796) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.605231)
[S4] loaded HEAD from S6 (vec_in norm=1.605231)
[S4] cosine check vs S6: cos=0.9995
[S4] BUFFERED delta from S6 (total buffered=1)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=33 metric=0.8413 head_norm=1.605231
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.354204e-02
[S6] stored merged vector for next round verification (round=33)
[S6] DEBUG after merge:  round=33 metric=0.8460 head_norm=1.599522 delta_norm=0.023542
[S6] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S10] sending update (kind=head size=1801 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1801) from S10
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.905343)
[S16] loaded HEAD from S10 (vec_in norm=1.905343)
[S16] cosine check vs S10: cos=0.9861
[S16] BUFFERED delta from S10 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:31602
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=33 metric=0.7187 head_norm=1.739630
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.815127e-02
[S8] stored merged vector for next round verification (round=33)
[S8] DEBUG after merge:  round=33 metric=0.7187 head_norm=1.741291 delta_norm=0.018151
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] sending update (kind=head size=1798 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1798) from S16
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.744128)
[S2] loaded HEAD from S16 (vec_in norm=1.744128)
[S2] cosine check vs S16: cos=0.8000
[S2] BUFFERED delta from S16 (total buffered=1)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=33 metric=0.9390 head_norm=1.744128
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.720197e-01
[S16] stored merged vector for next round verification (round=33)
[S16] DEBUG after merge:  round=33 metric=0.9394 head_norm=1.818396 delta_norm=0.172020
[S16] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=34 head_norm_before_train=1.504113 cos_to_last_merge=1.0000 (last merge round=32)
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.7011337461190337, 'auprc': 0.6681000091980003, 'loss_val': 0.2765642844910051, 'psi': 0.6879202513506204}-{'f1_val': 0.7013141837391442, 'auprc': 0.6813943086181762, 'loss_val': 0.2796589120854389, 'psi': 0.693346233690757}
[S3] START round=34 head_norm_before_train=1.995309 (no previous merge yet)
[S3] round=34 local utility u=0.279592 metrics={'f1_val': 0.9894285375218383, 'auprc': 0.9986587100424843, 'loss_val': 0.03938097690993303, 'psi': 0.9931206065300967}-{'f1_val': 0.9144567318899594, 'auprc': 0.9987039586259875, 'loss_val': 0.14886912529659305, 'psi': 0.9481556225843706}
[S4] START round=34 head_norm_before_train=1.607094 cos_to_last_merge=0.9998 (last merge round=31)
[S4] round=34 local utility u=0.000000 metrics={'f1_val': 0.6361525104814875, 'auprc': 0.8959193536558917, 'loss_val': 0.5710934240726864, 'psi': 0.7400592477512492}-{'f1_val': 0.9400087075833456, 'auprc': 0.9297020220254952, 'loss_val': 0.2734288085735151, 'psi': 0.9358860333602055}
[S5] START round=34 head_norm_before_train=1.362989 cos_to_last_merge=1.0000 (last merge round=33)
[S5] round=34 local utility u=0.815111 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9944581814597587, 'loss_val': 0.2898576156598966, 'psi': 0.8179760630442517}-{'f1_val': 0.5475548318681089, 'auprc': 0.8556871027861734, 'loss_val': 0.5871669142396753, 'psi': 0.6708077402353347}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=34 head_norm_before_train=1.599522 cos_to_last_merge=1.0000 (last merge round=33)
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.7956689160505126, 'auprc': 0.9465854870198681, 'loss_val': 0.5314827461976811, 'psi': 0.8560355444382548}-{'f1_val': 0.8413445826189166, 'auprc': 0.9513941344588248, 'loss_val': 0.36747241467366276, 'psi': 0.88536440335488}
[S7] START round=34 head_norm_before_train=1.649256 cos_to_last_merge=0.9974 (last merge round=26)
[S7] round=34 local utility u=0.933504 metrics={'f1_val': 0.6787080009163381, 'auprc': 0.8385729380335523, 'loss_val': 0.3707784058128815, 'psi': 0.7426539757632238}-{'f1_val': 0.4886959760204211, 'auprc': 0.7824709520520212, 'loss_val': 0.9294084042642209, 'psi': 0.6062059664330611}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=34 head_norm_before_train=1.741291 cos_to_last_merge=1.0000 (last merge round=33)
[S8] round=34 local utility u=0.910758 metrics={'f1_val': 0.9928249955793521, 'auprc': 0.9991913156229079, 'loss_val': 0.05083585942891976, 'psi': 0.9953715235967744}-{'f1_val': 0.7186865991026945, 'auprc': 0.9883227172457073, 'loss_val': 0.1949150823516146, 'psi': 0.8265410463598997}
[S9] START round=34 head_norm_before_train=1.780011 cos_to_last_merge=0.8066 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.807
[S9] round=34 local utility u=0.018968 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.994350397096647, 'loss_val': 0.02300169141849802, 'psi': 0.9960019063459444}-{'f1_val': 0.9905718417662249, 'auprc': 0.9988633883855401, 'loss_val': 0.03529016142345815, 'psi': 0.9938884604139511}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=34 head_norm_before_train=1.905343 cos_to_last_merge=0.9808 (last merge round=19)
[S10] round=34 local utility u=0.000432 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9959960259595472, 'loss_val': 0.028656174722216217, 'psi': 0.9957642024928308}-{'f1_val': 0.9956096535150197, 'auprc': 0.9959766989660471, 'loss_val': 0.02946201610858153, 'psi': 0.9957564716954308}
[S11] START round=34 head_norm_before_train=1.433372 cos_to_last_merge=0.9997 (last merge round=32)
[S11] round=34 local utility u=0.003540 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.996265970604934, 'loss_val': 0.04574629007336771, 'psi': 0.9961988730884208}-{'f1_val': 0.9961336749133093, 'auprc': 0.995885776780193, 'loss_val': 0.05156255624618926, 'psi': 0.9960345156600627}
[S13] START round=34 head_norm_before_train=1.381790 cos_to_last_merge=0.9998 (last merge round=32)
[S13] round=34 local utility u=0.000000 metrics={'f1_val': 0.60600692956511, 'auprc': 0.537654615430151, 'loss_val': 0.8222184852529201, 'psi': 0.5786660039111264}-{'f1_val': 0.5697312052190104, 'auprc': 0.7185301409214775, 'loss_val': 0.9537470014727051, 'psi': 0.6292507794999973}
[S14] START round=34 head_norm_before_train=1.646166 cos_to_last_merge=0.7244 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.724
[S14] round=34 local utility u=0.001037 metrics={'f1_val': 0.997240356705793, 'auprc': 0.999177574250663, 'loss_val': 0.029045126367467467, 'psi': 0.9980152437237411}-{'f1_val': 0.9974082695017256, 'auprc': 0.9991775122812507, 'loss_val': 0.032126716400572616, 'psi': 0.9981159666135356}
[S15] START round=34 head_norm_before_train=2.061011 (no previous merge yet)
[S15] round=34 local utility u=0.419182 metrics={'f1_val': 0.9726990136742166, 'auprc': 0.9988224307004242, 'loss_val': 0.04363999130098532, 'psi': 0.9831483804846997}-{'f1_val': 0.9008099377434587, 'auprc': 0.9427704990515173, 'loss_val': 0.2825130790990957, 'psi': 0.9175941622666821}
[S16] START round=34 head_norm_before_train=1.818396 cos_to_last_merge=1.0000 (last merge round=33)
[S16] round=34 local utility u=0.000000 metrics={'f1_val': 0.9091600579285103, 'auprc': 0.981642057785144, 'loss_val': 0.41514020526346845, 'psi': 0.9381528578711638}-{'f1_val': 0.9389919632553922, 'auprc': 0.9817845423117558, 'loss_val': 0.1852878252451167, 'psi': 0.9561089948779378}
[S17] START round=34 head_norm_before_train=1.743140 cos_to_last_merge=0.9996 (last merge round=31)
[S17] round=34 local utility u=0.000000 metrics={'f1_val': 0.5649297165563334, 'auprc': 0.7421665607218123, 'loss_val': 1.0271216777445236, 'psi': 0.635824454222525}-{'f1_val': 0.5940381138936355, 'auprc': 0.8622410512956777, 'loss_val': 0.8739370835835764, 'psi': 0.7013192888544524}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:31613
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=34 metric=0.6362 head_norm=1.621309
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.345338e-02
[S4] stored merged vector for next round verification (round=34)
[S4] DEBUG after merge:  round=34 metric=0.6345 head_norm=1.612943 delta_norm=0.033453
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:31614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:31617
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=34 metric=0.7011 head_norm=1.512681
[S2] _apply_head_vector_avg (torch): Δ‖w‖=5.265998e-01
[S2] stored merged vector for next round verification (round=34)
[S2] DEBUG after merge:  round=34 metric=0.7010 head_norm=1.545246 delta_norm=0.526600
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S11] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:31616
[S13] RECEIVED delta(kind=head bytes=1803) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.458813)
[S13] loaded HEAD from S11 (vec_in norm=1.458813)
[S13] cosine check vs S11: cos=0.9234
[S13] BUFFERED delta from S11 (total buffered=1)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1805 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=34 metric=0.9962 head_norm=1.458813
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.080728e-01
[S11] stored merged vector for next round verification (round=34)
[S11] DEBUG after merge:  round=34 metric=0.9962 head_norm=1.466953 delta_norm=0.208073
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S10] sending update (kind=head size=1800 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1805) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=2.070599)
[S14] loaded HEAD from S15 (vec_in norm=2.070599)
[S14] cosine check vs S15: cos=-0.0640
[S14] DROPPED delta from S15 (cos=-0.0640 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1800) from S10
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.920410)
[S16] loaded HEAD from S10 (vec_in norm=1.920410)
[S16] cosine check vs S10: cos=0.9962
[S16] BUFFERED delta from S10 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1803) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.750848)
[S17] loaded HEAD from S8 (vec_in norm=1.750848)
[S17] cosine check vs S8: cos=0.9997
[S17] BUFFERED delta from S8 (total buffered=1)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=34 metric=0.9092 head_norm=1.833215
[S16] _apply_head_vector_avg (torch): Δ‖w‖=9.279101e-02
[S16] stored merged vector for next round verification (round=34)
[S16] DEBUG after merge:  round=34 metric=0.9096 head_norm=1.875024 delta_norm=0.092791
[S16] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=35 head_norm_before_train=1.545246 cos_to_last_merge=1.0000 (last merge round=34)
[S2] round=35 local utility u=0.001712 metrics={'f1_val': 0.7009533202285976, 'auprc': 0.6711821419117102, 'loss_val': 0.2813034477028157, 'psi': 0.6890448489018426}-{'f1_val': 0.7011337461190337, 'auprc': 0.6681000091980003, 'loss_val': 0.2765642844910051, 'psi': 0.6879202513506204}
[S3] START round=35 head_norm_before_train=2.008636 (no previous merge yet)
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.9914906903999053, 'auprc': 0.9985601227924146, 'loss_val': 0.07123564419586347, 'psi': 0.994318463356909}-{'f1_val': 0.9894285375218383, 'auprc': 0.9986587100424843, 'loss_val': 0.03938097690993303, 'psi': 0.9931206065300967}
[S4] START round=35 head_norm_before_train=1.612943 cos_to_last_merge=1.0000 (last merge round=34)
[S4] round=35 local utility u=1.000000 metrics={'f1_val': 0.9405250633904692, 'auprc': 0.9315316477664197, 'loss_val': 0.27449490580797264, 'psi': 0.9369276971408494}-{'f1_val': 0.6361525104814875, 'auprc': 0.8959193536558917, 'loss_val': 0.5710934240726864, 'psi': 0.7400592477512492}
[S5] START round=35 head_norm_before_train=1.371674 cos_to_last_merge=0.9998 (last merge round=33)
[S5] round=35 local utility u=0.000000 metrics={'f1_val': 0.6625449259156126, 'auprc': 0.9310585166020455, 'loss_val': 0.3714975719529626, 'psi': 0.7699503621901858}-{'f1_val': 0.7003213174339138, 'auprc': 0.9944581814597587, 'loss_val': 0.2898576156598966, 'psi': 0.8179760630442517}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=35 head_norm_before_train=1.609542 cos_to_last_merge=0.9999 (last merge round=33)
[S6] round=35 local utility u=0.204576 metrics={'f1_val': 0.8241166592697228, 'auprc': 0.9613814078639128, 'loss_val': 0.33740507532506864, 'psi': 0.8790225587073988}-{'f1_val': 0.7956689160505126, 'auprc': 0.9465854870198681, 'loss_val': 0.5314827461976811, 'psi': 0.8560355444382548}
[S7] START round=35 head_norm_before_train=1.656728 cos_to_last_merge=0.9970 (last merge round=26)
[S7] round=35 local utility u=0.000000 metrics={'f1_val': 0.43050085515387587, 'auprc': 0.7812839897377092, 'loss_val': 1.065682392511596, 'psi': 0.5708141089874093}-{'f1_val': 0.6787080009163381, 'auprc': 0.8385729380335523, 'loss_val': 0.3707784058128815, 'psi': 0.7426539757632238}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=35 head_norm_before_train=1.750848 cos_to_last_merge=1.0000 (last merge round=33)
[S8] round=35 local utility u=0.001529 metrics={'f1_val': 0.9928938724649488, 'auprc': 0.999160201812104, 'loss_val': 0.04809760506891688, 'psi': 0.9954004042038108}-{'f1_val': 0.9928249955793521, 'auprc': 0.9991913156229079, 'loss_val': 0.05083585942891976, 'psi': 0.9953715235967744}
[S9] START round=35 head_norm_before_train=1.788159 cos_to_last_merge=0.8051 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.805
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9937924236148838, 'loss_val': 0.022471208579454244, 'psi': 0.9957787169532393}-{'f1_val': 0.9971029125121428, 'auprc': 0.994350397096647, 'loss_val': 0.02300169141849802, 'psi': 0.9960019063459444}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=35 head_norm_before_train=1.920410 cos_to_last_merge=0.9801 (last merge round=19)
[S10] round=35 local utility u=0.001620 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9968989760566265, 'loss_val': 0.0281253646660181, 'psi': 0.9961253825316625}-{'f1_val': 0.9956096535150197, 'auprc': 0.9959960259595472, 'loss_val': 0.028656174722216217, 'psi': 0.9957642024928308}
[S11] START round=35 head_norm_before_train=1.466953 cos_to_last_merge=1.0000 (last merge round=34)
[S11] round=35 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9947457510428896, 'loss_val': 0.05438129382664961, 'psi': 0.9955907852636031}-{'f1_val': 0.9961541414107454, 'auprc': 0.996265970604934, 'loss_val': 0.04574629007336771, 'psi': 0.9961988730884208}
[S13] START round=35 head_norm_before_train=1.392372 cos_to_last_merge=0.9996 (last merge round=32)
[S13] round=35 local utility u=0.345793 metrics={'f1_val': 0.6108309420714797, 'auprc': 0.7355877561992186, 'loss_val': 0.7533750230057511, 'psi': 0.6607336677225752}-{'f1_val': 0.60600692956511, 'auprc': 0.537654615430151, 'loss_val': 0.8222184852529201, 'psi': 0.5786660039111264}
[S14] START round=35 head_norm_before_train=1.661540 cos_to_last_merge=0.7227 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.723
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9991750704608796, 'loss_val': 0.032615191347923435, 'psi': 0.9983617389646828}-{'f1_val': 0.997240356705793, 'auprc': 0.999177574250663, 'loss_val': 0.029045126367467467, 'psi': 0.9980152437237411}
[S15] START round=35 head_norm_before_train=2.070599 (no previous merge yet)
[S15] round=35 local utility u=0.082529 metrics={'f1_val': 0.9971773386779533, 'auprc': 0.9985289979830666, 'loss_val': 0.02457162069062057, 'psi': 0.9977180023999986}-{'f1_val': 0.9726990136742166, 'auprc': 0.9988224307004242, 'loss_val': 0.04363999130098532, 'psi': 0.9831483804846997}
[S16] START round=35 head_norm_before_train=1.875024 cos_to_last_merge=1.0000 (last merge round=34)
[S16] round=35 local utility u=0.000000 metrics={'f1_val': 0.8449674684899662, 'auprc': 0.8874785869993526, 'loss_val': 0.7935329311095645, 'psi': 0.8619719158937207}-{'f1_val': 0.9091600579285103, 'auprc': 0.981642057785144, 'loss_val': 0.41514020526346845, 'psi': 0.9381528578711638}
[S17] START round=35 head_norm_before_train=1.758373 cos_to_last_merge=0.9993 (last merge round=31)
[S17] round=35 local utility u=0.013196 metrics={'f1_val': 0.5666401156060099, 'auprc': 0.7641928366450514, 'loss_val': 1.0770716150291988, 'psi': 0.6456612040216265}-{'f1_val': 0.5649297165563334, 'auprc': 0.7421665607218123, 'loss_val': 1.0271216777445236, 'psi': 0.635824454222525}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:31605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:31612
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:31604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:31607
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:31609
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:31614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:31616
[S11] ⇄ pheromone p=0.008 → S13@127.0.0.1:31613
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S8] → sending delta(kind=head bytes=1808) to S17@127.0.0.1:31617
[S2] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S17] sending update (kind=head size=1804 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1802) from S4
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.626943)
[S6] loaded HEAD from S4 (vec_in norm=1.626943)
[S6] cosine check vs S4: cos=0.9995
[S6] BUFFERED delta from S4 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1795) from S2
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.554271)
[S11] loaded HEAD from S2 (vec_in norm=1.554271)
[S11] cosine check vs S2: cos=0.8975
[S11] BUFFERED delta from S2 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1804) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.776206)
[S8] loaded HEAD from S17 (vec_in norm=1.776206)
[S8] cosine check vs S17: cos=0.9994
[S8] BUFFERED delta from S17 (total buffered=1)
[S8] sending update (kind=head size=1808 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S2] ⇄ pheromone p=0.022 → S11@127.0.0.1:31612
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=35 metric=0.5666 head_norm=1.776206
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.171895e-02
[S17] stored merged vector for next round verification (round=35)
[S17] DEBUG after merge:  round=35 metric=0.5677 head_norm=1.763287 delta_norm=0.031719
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.114 → S8@127.0.0.1:31609
[S4] ⇄ pheromone p=0.297 → S6@127.0.0.1:31607
[S15] sending update (kind=head size=1800 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1800) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=2.080000)
[S14] loaded HEAD from S15 (vec_in norm=2.080000)
[S14] cosine check vs S15: cos=-0.0639
[S14] DROPPED delta from S15 (cos=-0.0639 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1808) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.757589)
[S17] loaded HEAD from S8 (vec_in norm=1.757589)
[S17] cosine check vs S8: cos=0.9998
[S17] BUFFERED delta from S8 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1799) from S10
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.930630)
[S16] loaded HEAD from S10 (vec_in norm=1.930630)
[S16] cosine check vs S10: cos=0.9987
[S16] BUFFERED delta from S10 (total buffered=1)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1803) from S13
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.402575)
[S5] loaded HEAD from S13 (vec_in norm=1.402575)
[S5] cosine check vs S13: cos=0.9224
[S5] BUFFERED delta from S13 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1802) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.616690)
[S4] loaded HEAD from S6 (vec_in norm=1.616690)
[S4] cosine check vs S6: cos=0.9995
[S4] BUFFERED delta from S6 (total buffered=1)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=35 metric=0.9929 head_norm=1.757589
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.249815e-02
[S8] stored merged vector for next round verification (round=35)
[S8] DEBUG after merge:  round=35 metric=0.9929 head_norm=1.766623 delta_norm=0.032498
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.154 → S17@127.0.0.1:31617
[S10] ⇄ pheromone p=0.005 → S16@127.0.0.1:31616
[S15] ⇄ pheromone p=0.137 → S14@127.0.0.1:31614
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=35 metric=0.6108 head_norm=1.402575
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.837192e-01
[S13] stored merged vector for next round verification (round=35)
[S13] DEBUG after merge:  round=35 metric=0.6112 head_norm=1.402562 delta_norm=0.283719
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.102 → S5@127.0.0.1:31605
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=35 metric=0.8450 head_norm=1.887683
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.334721e-02
[S16] stored merged vector for next round verification (round=35)
[S16] DEBUG after merge:  round=35 metric=0.8450 head_norm=1.908532 delta_norm=0.053347
[S16] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.107 → S2@127.0.0.1:31602
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=35 metric=0.8241 head_norm=1.616690
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.535347e-02
[S6] stored merged vector for next round verification (round=35)
[S6] DEBUG after merge:  round=35 metric=0.8241 head_norm=1.621626 delta_norm=0.025353
[S6] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.267 → S4@127.0.0.1:31604
[S2] START round=36 head_norm_before_train=1.554271 cos_to_last_merge=1.0000 (last merge round=34)
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.7013141837391442, 'auprc': 0.6696158459716646, 'loss_val': 0.2907126302398614, 'psi': 0.6886348486321523}-{'f1_val': 0.7009533202285976, 'auprc': 0.6711821419117102, 'loss_val': 0.2813034477028157, 'psi': 0.6890448489018426}
[S3] START round=36 head_norm_before_train=2.020971 (no previous merge yet)
[S3] round=36 local utility u=0.027844 metrics={'f1_val': 0.9968311306697817, 'auprc': 0.9986710415830665, 'loss_val': 0.04792240471162878, 'psi': 0.9975670950350957}-{'f1_val': 0.9914906903999053, 'auprc': 0.9985601227924146, 'loss_val': 0.07123564419586347, 'psi': 0.994318463356909}
[S4] START round=36 head_norm_before_train=1.626943 cos_to_last_merge=0.9999 (last merge round=34)
[S4] round=36 local utility u=0.060102 metrics={'f1_val': 0.9466845728702216, 'auprc': 0.9559731845861413, 'loss_val': 0.26457291160063545, 'psi': 0.9504000175565894}-{'f1_val': 0.9405250633904692, 'auprc': 0.9315316477664197, 'loss_val': 0.27449490580797264, 'psi': 0.9369276971408494}
[S5] START round=36 head_norm_before_train=1.382703 cos_to_last_merge=0.9992 (last merge round=33)
[S5] round=36 local utility u=0.000000 metrics={'f1_val': 0.52561232722349, 'auprc': 0.8553456488990713, 'loss_val': 0.595276836923647, 'psi': 0.6575056558937225}-{'f1_val': 0.6625449259156126, 'auprc': 0.9310585166020455, 'loss_val': 0.3714975719529626, 'psi': 0.7699503621901858}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=36 metric=0.5256 head_norm=1.396246
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.812115e-01
[S5] stored merged vector for next round verification (round=36)
[S5] DEBUG after merge:  round=36 metric=0.5609 head_norm=1.370868 delta_norm=0.281212
[S5] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S6] START round=36 head_norm_before_train=1.621626 cos_to_last_merge=1.0000 (last merge round=35)
[S6] round=36 local utility u=0.133412 metrics={'f1_val': 0.8711557504880765, 'auprc': 0.9581216991572344, 'loss_val': 0.3430357146750901, 'psi': 0.9059421299557396}-{'f1_val': 0.8241166592697228, 'auprc': 0.9613814078639128, 'loss_val': 0.33740507532506864, 'psi': 0.8790225587073988}
[S7] START round=36 head_norm_before_train=1.661596 cos_to_last_merge=0.9968 (last merge round=26)
[S7] round=36 local utility u=1.000000 metrics={'f1_val': 0.6659001460312487, 'auprc': 0.8265639453766156, 'loss_val': 0.3862852838499403, 'psi': 0.7301656657693955}-{'f1_val': 0.43050085515387587, 'auprc': 0.7812839897377092, 'loss_val': 1.065682392511596, 'psi': 0.5708141089874093}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=36 head_norm_before_train=1.766623 cos_to_last_merge=1.0000 (last merge round=35)
[S8] round=36 local utility u=0.001063 metrics={'f1_val': 0.9936102940920961, 'auprc': 0.9991480405792332, 'loss_val': 0.050233000210404485, 'psi': 0.9958253926869509}-{'f1_val': 0.9928938724649488, 'auprc': 0.999160201812104, 'loss_val': 0.04809760506891688, 'psi': 0.9954004042038108}
[S9] START round=36 head_norm_before_train=1.798728 cos_to_last_merge=0.8038 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.804
[S9] round=36 local utility u=0.005426 metrics={'f1_val': 0.9968062435266511, 'auprc': 0.9976879252885935, 'loss_val': 0.021526521476613485, 'psi': 0.997158916231428}-{'f1_val': 0.9971029125121428, 'auprc': 0.9937924236148838, 'loss_val': 0.022471208579454244, 'psi': 0.9957787169532393}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] sending update (kind=head size=1805 to 1 peers)
[S10] START round=36 head_norm_before_train=1.930630 cos_to_last_merge=0.9795 (last merge round=19)
[S10] round=36 local utility u=0.000000 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9959543293448893, 'loss_val': 0.027564568127408394, 'psi': 0.9957475238469675}-{'f1_val': 0.9956096535150197, 'auprc': 0.9968989760566265, 'loss_val': 0.0281253646660181, 'psi': 0.9961253825316625}
[S11] START round=36 head_norm_before_train=1.492652 cos_to_last_merge=0.9997 (last merge round=34)
[S11] round=36 local utility u=0.004229 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9945056057506415, 'loss_val': 0.04508027790256351, 'psi': 0.9954824472482422}-{'f1_val': 0.9961541414107454, 'auprc': 0.9947457510428896, 'loss_val': 0.05438129382664961, 'psi': 0.9955907852636031}
[S13] START round=36 head_norm_before_train=1.402562 cos_to_last_merge=1.0000 (last merge round=35)
[S13] round=36 local utility u=0.014605 metrics={'f1_val': 0.6133837334484108, 'auprc': 0.7269240325441446, 'loss_val': 0.7134914746620374, 'psi': 0.6587998530867043}-{'f1_val': 0.6108309420714797, 'auprc': 0.7355877561992186, 'loss_val': 0.7533750230057511, 'psi': 0.6607336677225752}
[S14] START round=36 head_norm_before_train=1.674420 cos_to_last_merge=0.7212 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.721
[S14] round=36 local utility u=0.000363 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.999177687794041, 'loss_val': 0.029429065712874194, 'psi': 0.9981160368186518}-{'f1_val': 0.9978195179672185, 'auprc': 0.9991750704608796, 'loss_val': 0.032615191347923435, 'psi': 0.9983617389646828}
[S15] START round=36 head_norm_before_train=2.080000 (no previous merge yet)
[S15] round=36 local utility u=0.000000 metrics={'f1_val': 0.9023666277137505, 'auprc': 0.9601758413128372, 'loss_val': 0.25100042035476433, 'psi': 0.9254903131533851}-{'f1_val': 0.9971773386779533, 'auprc': 0.9985289979830666, 'loss_val': 0.02457162069062057, 'psi': 0.9977180023999986}
[S16] START round=36 head_norm_before_train=1.908532 cos_to_last_merge=1.0000 (last merge round=35)
[S16] round=36 local utility u=0.586400 metrics={'f1_val': 0.9196027195822456, 'auprc': 0.983541462930618, 'loss_val': 0.35673296435825047, 'psi': 0.9451782169215945}-{'f1_val': 0.8449674684899662, 'auprc': 0.8874785869993526, 'loss_val': 0.7935329311095645, 'psi': 0.8619719158937207}
[S17] START round=36 head_norm_before_train=1.763287 cos_to_last_merge=1.0000 (last merge round=35)
[S17] round=36 local utility u=0.399657 metrics={'f1_val': 0.5857136926475726, 'auprc': 0.9760248171058212, 'loss_val': 1.027695366907157, 'psi': 0.741838142430872}-{'f1_val': 0.5666401156060099, 'auprc': 0.7641928366450514, 'loss_val': 1.0770716150291988, 'psi': 0.6456612040216265}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:31613
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:31605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:31615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:31607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:31609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:31604
[S6] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S17] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:31617
[S4] sending update (kind=head size=1799 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] RECEIVED delta(kind=head bytes=1800) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.779759)
[S8] loaded HEAD from S17 (vec_in norm=1.779759)
[S8] cosine check vs S17: cos=0.9999
[S8] BUFFERED delta from S17 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1797) from S13
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.410670)
[S5] loaded HEAD from S13 (vec_in norm=1.410670)
[S5] cosine check vs S13: cos=0.9254
[S5] BUFFERED delta from S13 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1799) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.685257)
[S15] loaded HEAD from S14 (vec_in norm=1.685257)
[S15] cosine check vs S14: cos=-0.0637
[S15] DROPPED delta from S14 (cos=-0.0637 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1799) from S4
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.640386)
[S6] loaded HEAD from S4 (vec_in norm=1.640386)
[S6] cosine check vs S4: cos=0.9996
[S6] BUFFERED delta from S4 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1800) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.631270)
[S4] loaded HEAD from S6 (vec_in norm=1.631270)
[S4] cosine check vs S6: cos=0.9996
[S4] BUFFERED delta from S6 (total buffered=2)
[S13] RECEIVED delta(kind=head bytes=1799) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.520398)
[S13] loaded HEAD from S11 (vec_in norm=1.520398)
[S13] cosine check vs S11: cos=0.9527
[S13] BUFFERED delta from S11 (total buffered=1)
[S8] sending update (kind=head size=1802 to 1 peers)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=36 metric=0.9961 head_norm=1.520398
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.586930e-01
[S11] stored merged vector for next round verification (round=36)
[S11] DEBUG after merge:  round=36 metric=0.9961 head_norm=1.494999 delta_norm=0.358693
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=36 metric=0.6134 head_norm=1.410670
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.318590e-01
[S13] stored merged vector for next round verification (round=36)
[S13] DEBUG after merge:  round=36 metric=0.6138 head_norm=1.448116 delta_norm=0.231859
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=36 metric=0.9467 head_norm=1.640386
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.897119e-02
[S4] stored merged vector for next round verification (round=36)
[S4] DEBUG after merge:  round=36 metric=0.9467 head_norm=1.631934 delta_norm=0.028971
[S4] aggregate: ACCEPT kept=['S6', 'S6'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=36 metric=0.8712 head_norm=1.631270
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.476743e-02
[S6] stored merged vector for next round verification (round=36)
[S6] DEBUG after merge:  round=36 metric=0.8725 head_norm=1.635647 delta_norm=0.024767
[S6] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=36 metric=0.5857 head_norm=1.779759
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.740743e-02
[S17] stored merged vector for next round verification (round=36)
[S17] DEBUG after merge:  round=36 metric=0.5857 head_norm=1.768496 delta_norm=0.027407
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] RECEIVED delta(kind=head bytes=1802) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.773520)
[S17] loaded HEAD from S8 (vec_in norm=1.773520)
[S17] cosine check vs S8: cos=1.0000
[S17] BUFFERED delta from S8 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:31602
[S16] sending update (kind=head size=1803 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1803) from S16
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.920623)
[S2] loaded HEAD from S16 (vec_in norm=1.920623)
[S2] cosine check vs S16: cos=0.9039
[S2] BUFFERED delta from S16 (total buffered=1)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=36 metric=0.9936 head_norm=1.773520
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.234859e-02
[S8] stored merged vector for next round verification (round=36)
[S8] DEBUG after merge:  round=36 metric=0.9936 head_norm=1.776600 delta_norm=0.012349
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=37 head_norm_before_train=1.563802 cos_to_last_merge=0.9999 (last merge round=34)
[S2] round=37 local utility u=0.000000 metrics={'f1_val': 0.7013141837391442, 'auprc': 0.6693570406892586, 'loss_val': 0.29283143415202895, 'psi': 0.6885313265191899}-{'f1_val': 0.7013141837391442, 'auprc': 0.6696158459716646, 'loss_val': 0.2907126302398614, 'psi': 0.6886348486321523}
[S3] START round=37 head_norm_before_train=2.033693 (no previous merge yet)
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.9478751704944357, 'auprc': 0.9986197237672534, 'loss_val': 0.17728316471003633, 'psi': 0.9681729918035628}-{'f1_val': 0.9968311306697817, 'auprc': 0.9986710415830665, 'loss_val': 0.04792240471162878, 'psi': 0.9975670950350957}
[S4] START round=37 head_norm_before_train=1.631934 cos_to_last_merge=1.0000 (last merge round=36)
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.9377148529556408, 'auprc': 0.9183098925606836, 'loss_val': 0.28791980272162854, 'psi': 0.9299528687976579}-{'f1_val': 0.9466845728702216, 'auprc': 0.9559731845861413, 'loss_val': 0.26457291160063545, 'psi': 0.9504000175565894}
[S5] START round=37 head_norm_before_train=1.370868 cos_to_last_merge=1.0000 (last merge round=36)
[S5] round=37 local utility u=0.859309 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9840052994899552, 'loss_val': 0.310892263787688, 'psi': 0.8137949102563303}-{'f1_val': 0.52561232722349, 'auprc': 0.8553456488990713, 'loss_val': 0.595276836923647, 'psi': 0.6575056558937225}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=37 metric=0.7003 head_norm=1.382616
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.758142e-01
[S5] stored merged vector for next round verification (round=37)
[S5] DEBUG after merge:  round=37 metric=0.7003 head_norm=1.369210 delta_norm=0.275814
[S5] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S6] START round=37 head_norm_before_train=1.635647 cos_to_last_merge=1.0000 (last merge round=36)
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.7628541338204103, 'auprc': 0.9495659326597381, 'loss_val': 0.5431830509369161, 'psi': 0.8375388533561414}-{'f1_val': 0.8711557504880765, 'auprc': 0.9581216991572344, 'loss_val': 0.3430357146750901, 'psi': 0.9059421299557396}
[S7] START round=37 head_norm_before_train=1.665574 cos_to_last_merge=0.9964 (last merge round=26)
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.6226258894902514, 'auprc': 0.7987514110321705, 'loss_val': 0.5485405406828648, 'psi': 0.6930760981070191}-{'f1_val': 0.6659001460312487, 'auprc': 0.8265639453766156, 'loss_val': 0.3862852838499403, 'psi': 0.7301656657693955}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=37 head_norm_before_train=1.776600 cos_to_last_merge=1.0000 (last merge round=36)
[S8] round=37 local utility u=0.000000 metrics={'f1_val': 0.9836229587527714, 'auprc': 0.99888157310887, 'loss_val': 0.07146158436574507, 'psi': 0.9897264044952109}-{'f1_val': 0.9936102940920961, 'auprc': 0.9991480405792332, 'loss_val': 0.050233000210404485, 'psi': 0.9958253926869509}
[S9] START round=37 head_norm_before_train=1.808256 cos_to_last_merge=0.8030 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.803
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.9905718417662249, 'auprc': 0.9988631759575067, 'loss_val': 0.03426585213193959, 'psi': 0.9938883754427377}-{'f1_val': 0.9968062435266511, 'auprc': 0.9976879252885935, 'loss_val': 0.021526521476613485, 'psi': 0.997158916231428}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=37 head_norm_before_train=1.937612 cos_to_last_merge=0.9788 (last merge round=19)
[S10] round=37 local utility u=0.001577 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9968693748525632, 'loss_val': 0.027155199194934903, 'psi': 0.9961135420500371}-{'f1_val': 0.9956096535150197, 'auprc': 0.9959543293448893, 'loss_val': 0.027564568127408394, 'psi': 0.9957475238469675}
[S11] START round=37 head_norm_before_train=1.494999 cos_to_last_merge=1.0000 (last merge round=36)
[S11] round=37 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9929613519877843, 'loss_val': 0.07277049962305975, 'psi': 0.9951127435032675}-{'f1_val': 0.9961336749133093, 'auprc': 0.9945056057506415, 'loss_val': 0.04508027790256351, 'psi': 0.9954824472482422}
[S13] START round=37 head_norm_before_train=1.448116 cos_to_last_merge=1.0000 (last merge round=36)
[S13] round=37 local utility u=0.000000 metrics={'f1_val': 0.5984516399883171, 'auprc': 0.7014737374086366, 'loss_val': 0.8026969441588782, 'psi': 0.6396604789564448}-{'f1_val': 0.6133837334484108, 'auprc': 0.7269240325441446, 'loss_val': 0.7134914746620374, 'psi': 0.6587998530867043}
[S14] START round=37 head_norm_before_train=1.685257 cos_to_last_merge=0.7201 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.720
[S14] round=37 local utility u=0.000164 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.999178473401644, 'loss_val': 0.029102541578795733, 'psi': 0.9981163510616929}-{'f1_val': 0.9974082695017256, 'auprc': 0.999177687794041, 'loss_val': 0.029429065712874194, 'psi': 0.9981160368186518}
[S15] START round=37 head_norm_before_train=2.089200 (no previous merge yet)
[S15] round=37 local utility u=0.098075 metrics={'f1_val': 0.9037206720624893, 'auprc': 0.9958151374897397, 'loss_val': 0.16989305936241347, 'psi': 0.9405584582333895}-{'f1_val': 0.9023666277137505, 'auprc': 0.9601758413128372, 'loss_val': 0.25100042035476433, 'psi': 0.9254903131533851}
[S16] START round=37 head_norm_before_train=1.920623 cos_to_last_merge=0.9999 (last merge round=35)
[S16] round=37 local utility u=0.337163 metrics={'f1_val': 0.9874996141224607, 'auprc': 0.9854906074977093, 'loss_val': 0.09563619229532133, 'psi': 0.9866960114725601}-{'f1_val': 0.9196027195822456, 'auprc': 0.983541462930618, 'loss_val': 0.35673296435825047, 'psi': 0.9451782169215945}
[S17] START round=37 head_norm_before_train=1.768496 cos_to_last_merge=1.0000 (last merge round=36)
[S17] round=37 local utility u=0.339863 metrics={'f1_val': 0.6429078779302755, 'auprc': 0.9885198006172478, 'loss_val': 0.7286196526817849, 'psi': 0.7811526470050645}-{'f1_val': 0.5857136926475726, 'auprc': 0.9760248171058212, 'loss_val': 1.027695366907157, 'psi': 0.741838142430872}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:31609
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:31615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:31614
[S14] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:31616
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=37 metric=0.7013 head_norm=1.572761
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.205549e-01
[S2] stored merged vector for next round verification (round=37)
[S2] DEBUG after merge:  round=37 metric=0.7013 head_norm=1.704206 delta_norm=0.420555
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1803 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1803) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.778914)
[S8] loaded HEAD from S17 (vec_in norm=1.778914)
[S8] cosine check vs S17: cos=1.0000
[S8] BUFFERED delta from S17 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1799) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.696597)
[S15] loaded HEAD from S14 (vec_in norm=1.696597)
[S15] cosine check vs S14: cos=-0.0633
[S15] DROPPED delta from S14 (cos=-0.0633 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:31602
[S15] sending update (kind=head size=1802 to 1 peers)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=37 metric=0.6429 head_norm=1.778914
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.144578e-03
[S17] stored merged vector for next round verification (round=37)
[S17] DEBUG after merge:  round=37 metric=0.6397 head_norm=1.776209 delta_norm=0.006145
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S10] sending update (kind=head size=1797 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1802) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=2.098651)
[S14] loaded HEAD from S15 (vec_in norm=2.098651)
[S14] cosine check vs S15: cos=-0.0633
[S14] DROPPED delta from S15 (cos=-0.0633 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1797) from S10
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.945187)
[S16] loaded HEAD from S10 (vec_in norm=1.945187)
[S16] cosine check vs S10: cos=0.9988
[S16] BUFFERED delta from S10 (total buffered=1)
[S16] sending update (kind=head size=1799 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1799) from S16
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.930869)
[S2] loaded HEAD from S16 (vec_in norm=1.930869)
[S2] cosine check vs S16: cos=0.9807
[S2] BUFFERED delta from S16 (total buffered=1)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=37 metric=0.9836 head_norm=1.785511
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.199610e-03
[S8] stored merged vector for next round verification (round=37)
[S8] DEBUG after merge:  round=37 metric=0.9836 head_norm=1.782205 delta_norm=0.006200
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=37 metric=0.9875 head_norm=1.930869
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.752884e-02
[S16] stored merged vector for next round verification (round=37)
[S16] DEBUG after merge:  round=37 metric=0.9875 head_norm=1.937459 delta_norm=0.047529
[S16] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=38 head_norm_before_train=1.704206 cos_to_last_merge=1.0000 (last merge round=37)
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.7025501480691084, 'auprc': 0.6637792154872395, 'loss_val': 0.31343894670582195, 'psi': 0.6870417750363609}-{'f1_val': 0.7013141837391442, 'auprc': 0.6693570406892586, 'loss_val': 0.29283143415202895, 'psi': 0.6885313265191899}
[S3] START round=38 head_norm_before_train=2.045872 (no previous merge yet)
[S3] round=38 local utility u=0.014377 metrics={'f1_val': 0.9510612893582964, 'auprc': 0.9986969318655776, 'loss_val': 0.16787668491245197, 'psi': 0.9701155463612088}-{'f1_val': 0.9478751704944357, 'auprc': 0.9986197237672534, 'loss_val': 0.17728316471003633, 'psi': 0.9681729918035628}
[S4] START round=38 head_norm_before_train=1.644274 cos_to_last_merge=1.0000 (last merge round=36)
[S4] round=38 local utility u=0.034836 metrics={'f1_val': 0.9398501844797091, 'auprc': 0.9355777384880384, 'loss_val': 0.2828631737286539, 'psi': 0.9381412060830409}-{'f1_val': 0.9377148529556408, 'auprc': 0.9183098925606836, 'loss_val': 0.28791980272162854, 'psi': 0.9299528687976579}
[S5] START round=38 head_norm_before_train=1.369210 cos_to_last_merge=1.0000 (last merge round=37)
[S5] round=38 local utility u=0.000000 metrics={'f1_val': 0.43159486128259206, 'auprc': 0.8553501090121418, 'loss_val': 0.8224227918197374, 'psi': 0.601096960374412}-{'f1_val': 0.7003213174339138, 'auprc': 0.9840052994899552, 'loss_val': 0.310892263787688, 'psi': 0.8137949102563303}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=38 head_norm_before_train=1.648890 cos_to_last_merge=0.9999 (last merge round=36)
[S6] round=38 local utility u=0.240077 metrics={'f1_val': 0.8218138022842267, 'auprc': 0.944447918817575, 'loss_val': 0.4014321152465574, 'psi': 0.8708674488975661}-{'f1_val': 0.7628541338204103, 'auprc': 0.9495659326597381, 'loss_val': 0.5431830509369161, 'psi': 0.8375388533561414}
[S7] START round=38 head_norm_before_train=1.668975 cos_to_last_merge=0.9962 (last merge round=26)
[S7] round=38 local utility u=0.000000 metrics={'f1_val': 0.48465503565320034, 'auprc': 0.7821626270177379, 'loss_val': 0.8691863293946289, 'psi': 0.6036580721990153}-{'f1_val': 0.6226258894902514, 'auprc': 0.7987514110321705, 'loss_val': 0.5485405406828648, 'psi': 0.6930760981070191}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=38 head_norm_before_train=1.782205 cos_to_last_merge=1.0000 (last merge round=37)
[S8] round=38 local utility u=0.000000 metrics={'f1_val': 0.9847257979814172, 'auprc': 0.9888834638432835, 'loss_val': 0.0889447511504443, 'psi': 0.9863888643261638}-{'f1_val': 0.9836229587527714, 'auprc': 0.99888157310887, 'loss_val': 0.07146158436574507, 'psi': 0.9897264044952109}
[S9] START round=38 head_norm_before_train=1.818149 cos_to_last_merge=0.8021 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.802
[S9] round=38 local utility u=0.018347 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9936879084702305, 'loss_val': 0.021232772756192043, 'psi': 0.9957369108953779}-{'f1_val': 0.9905718417662249, 'auprc': 0.9988631759575067, 'loss_val': 0.03426585213193959, 'psi': 0.9938883754427377}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=38 head_norm_before_train=1.945187 cos_to_last_merge=0.9781 (last merge round=19)
[S10] round=38 local utility u=0.000000 metrics={'f1_val': 0.9953900010273877, 'auprc': 0.9959576587864891, 'loss_val': 0.02674022537277995, 'psi': 0.9956170641310282}-{'f1_val': 0.9956096535150197, 'auprc': 0.9968693748525632, 'loss_val': 0.027155199194934903, 'psi': 0.9961135420500371}
[S11] START round=38 head_norm_before_train=1.519969 cos_to_last_merge=0.9996 (last merge round=36)
[S11] round=38 local utility u=0.004082 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9912959038722278, 'loss_val': 0.05712993544246411, 'psi': 0.9941985664968767}-{'f1_val': 0.9965470045135896, 'auprc': 0.9929613519877843, 'loss_val': 0.07277049962305975, 'psi': 0.9951127435032675}
[S13] START round=38 head_norm_before_train=1.457333 cos_to_last_merge=0.9999 (last merge round=36)
[S13] round=38 local utility u=0.003453 metrics={'f1_val': 0.6080766523518211, 'auprc': 0.6795011888733818, 'loss_val': 0.7876243096312657, 'psi': 0.6366464669604455}-{'f1_val': 0.5984516399883171, 'auprc': 0.7014737374086366, 'loss_val': 0.8026969441588782, 'psi': 0.6396604789564448}
[S14] START round=38 head_norm_before_train=1.696597 cos_to_last_merge=0.7190 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.719
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.9953280742010686, 'auprc': 0.9991792119364215, 'loss_val': 0.038436797392819126, 'psi': 0.9968685292952097}-{'f1_val': 0.9974082695017256, 'auprc': 0.999178473401644, 'loss_val': 0.029102541578795733, 'psi': 0.9981163510616929}
[S15] START round=38 head_norm_before_train=2.098651 (no previous merge yet)
[S15] round=38 local utility u=0.358927 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9982144377364872, 'loss_val': 0.01739337511546566, 'psi': 0.9973337761271073}-{'f1_val': 0.9037206720624893, 'auprc': 0.9958151374897397, 'loss_val': 0.16989305936241347, 'psi': 0.9405584582333895}
[S16] START round=38 head_norm_before_train=1.937459 cos_to_last_merge=1.0000 (last merge round=37)
[S16] round=38 local utility u=0.000000 metrics={'f1_val': 0.8189886547895963, 'auprc': 0.834714119180361, 'loss_val': 1.0588866955891334, 'psi': 0.8252788405459022}-{'f1_val': 0.9874996141224607, 'auprc': 0.9854906074977093, 'loss_val': 0.09563619229532133, 'psi': 0.9866960114725601}
[S17] START round=38 head_norm_before_train=1.776209 cos_to_last_merge=1.0000 (last merge round=37)
[S17] round=38 local utility u=0.000000 metrics={'f1_val': 0.5236429786490191, 'auprc': 0.6701763174728315, 'loss_val': 1.1898114622174938, 'psi': 0.582256314178544}-{'f1_val': 0.6429078779302755, 'auprc': 0.9885198006172478, 'loss_val': 0.7286196526817849, 'psi': 0.7811526470050645}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:31604
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:31605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:31613
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:31607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=38 metric=0.7026 head_norm=1.712412
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.122063e-01
[S2] stored merged vector for next round verification (round=38)
[S2] DEBUG after merge:  round=38 metric=0.7036 head_norm=1.812533 delta_norm=0.212206
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:31614
[S5] RECEIVED delta(kind=head bytes=1795) from S13
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.470826)
[S5] loaded HEAD from S13 (vec_in norm=1.470826)
[S5] cosine check vs S13: cos=0.9391
[S5] BUFFERED delta from S13 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1802) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.550714)
[S13] loaded HEAD from S11 (vec_in norm=1.550714)
[S13] cosine check vs S11: cos=0.9445
[S13] BUFFERED delta from S11 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1802) from S4
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.652232)
[S6] loaded HEAD from S4 (vec_in norm=1.652232)
[S6] cosine check vs S4: cos=0.9995
[S6] BUFFERED delta from S4 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1801) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.662382)
[S4] loaded HEAD from S6 (vec_in norm=1.662382)
[S4] cosine check vs S6: cos=0.9995
[S4] BUFFERED delta from S6 (total buffered=1)
[S15] sending update (kind=head size=1795 to 1 peers)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=38 metric=0.8218 head_norm=1.662382
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.705040e-02
[S6] stored merged vector for next round verification (round=38)
[S6] DEBUG after merge:  round=38 metric=0.8218 head_norm=1.657094 delta_norm=0.027050
[S6] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=38 metric=0.6081 head_norm=1.470826
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.546441e-01
[S13] stored merged vector for next round verification (round=38)
[S13] DEBUG after merge:  round=38 metric=0.6085 head_norm=1.489690 delta_norm=0.254644
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=38 metric=0.9399 head_norm=1.652232
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.705040e-02
[S4] stored merged vector for next round verification (round=38)
[S4] DEBUG after merge:  round=38 metric=0.9396 head_norm=1.657094 delta_norm=0.027050
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S14] RECEIVED delta(kind=head bytes=1795) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=2.108185)
[S14] loaded HEAD from S15 (vec_in norm=2.108185)
[S14] cosine check vs S15: cos=-0.0632
[S14] DROPPED delta from S15 (cos=-0.0632 < 0.0)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=39 head_norm_before_train=1.812533 cos_to_last_merge=1.0000 (last merge round=38)
[S2] round=39 local utility u=0.051703 metrics={'f1_val': 0.7013245544597507, 'auprc': 0.7342444559025881, 'loss_val': 0.41407441293363384, 'psi': 0.7144925150368857}-{'f1_val': 0.7025501480691084, 'auprc': 0.6637792154872395, 'loss_val': 0.31343894670582195, 'psi': 0.6870417750363609}
[S3] START round=39 head_norm_before_train=2.055188 (no previous merge yet)
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.8174130050068166, 'auprc': 0.9986998358907162, 'loss_val': 0.23317931150602556, 'psi': 0.8899277373603764}-{'f1_val': 0.9510612893582964, 'auprc': 0.9986969318655776, 'loss_val': 0.16787668491245197, 'psi': 0.9701155463612088}
[S4] START round=39 head_norm_before_train=1.657094 cos_to_last_merge=1.0000 (last merge round=38)
[S4] round=39 local utility u=0.018571 metrics={'f1_val': 0.9409157068832164, 'auprc': 0.94494521313167, 'loss_val': 0.2802163978659279, 'psi': 0.9425275093825978}-{'f1_val': 0.9398501844797091, 'auprc': 0.9355777384880384, 'loss_val': 0.2828631737286539, 'psi': 0.9381412060830409}
[S5] START round=39 head_norm_before_train=1.382975 cos_to_last_merge=0.9998 (last merge round=37)
[S5] round=39 local utility u=1.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9926898435436932, 'loss_val': 0.3291030227910528, 'psi': 0.8172687278778255}-{'f1_val': 0.43159486128259206, 'auprc': 0.8553501090121418, 'loss_val': 0.8224227918197374, 'psi': 0.601096960374412}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=39 metric=0.7003 head_norm=1.398780
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.623831e-01
[S5] stored merged vector for next round verification (round=39)
[S5] DEBUG after merge:  round=39 metric=0.7003 head_norm=1.411068 delta_norm=0.262383
[S5] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S5] r=40 psi=0.817 u=1.0000 p_local=0.4439 f1=0.700 auprc=0.993 bytes=50320
[S6] START round=39 head_norm_before_train=1.657094 cos_to_last_merge=1.0000 (last merge round=38)
[S6] round=39 local utility u=0.000000 metrics={'f1_val': 0.6165766947851309, 'auprc': 0.9472060150909605, 'loss_val': 0.6864722570064462, 'psi': 0.7488284229074628}-{'f1_val': 0.8218138022842267, 'auprc': 0.944447918817575, 'loss_val': 0.4014321152465574, 'psi': 0.8708674488975661}
[S7] START round=39 head_norm_before_train=1.673765 cos_to_last_merge=0.9960 (last merge round=26)
[S7] round=39 local utility u=0.250310 metrics={'f1_val': 0.5498442342424237, 'auprc': 0.7837298312796698, 'loss_val': 0.7644033780565083, 'psi': 0.6433984730573221}-{'f1_val': 0.48465503565320034, 'auprc': 0.7821626270177379, 'loss_val': 0.8691863293946289, 'psi': 0.6036580721990153}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S7] r=40 psi=0.643 u=0.2503 p_local=0.2347 f1=0.550 auprc=0.784 bytes=39599
[S8] START round=39 head_norm_before_train=1.794002 cos_to_last_merge=1.0000 (last merge round=37)
[S8] round=39 local utility u=0.060897 metrics={'f1_val': 0.9924611780272952, 'auprc': 0.9991845703994865, 'loss_val': 0.04446729593419685, 'psi': 0.9951505349761718}-{'f1_val': 0.9847257979814172, 'auprc': 0.9888834638432835, 'loss_val': 0.0889447511504443, 'psi': 0.9863888643261638}
[S9] START round=39 head_norm_before_train=1.827864 cos_to_last_merge=0.8012 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.801
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9936894490252374, 'loss_val': 0.021606889555970232, 'psi': 0.9954912743689522}-{'f1_val': 0.9971029125121428, 'auprc': 0.9936879084702305, 'loss_val': 0.021232772756192043, 'psi': 0.9957369108953779}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=40 psi=0.995 u=0.0000 p_local=0.0070 f1=0.997 auprc=0.994 bytes=48521
[S10] START round=39 head_norm_before_train=1.955048 cos_to_last_merge=0.9775 (last merge round=19)
[S10] round=39 local utility u=0.002374 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9969333164979579, 'loss_val': 0.026236628444687774, 'psi': 0.996139118708195}-{'f1_val': 0.9953900010273877, 'auprc': 0.9959576587864891, 'loss_val': 0.02674022537277995, 'psi': 0.9956170641310282}
[S11] START round=39 head_norm_before_train=1.550714 cos_to_last_merge=0.9981 (last merge round=36)
[S11] round=39 local utility u=0.011476 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9952493298248174, 'loss_val': 0.04603917074751011, 'psi': 0.9957799368779126}-{'f1_val': 0.9961336749133093, 'auprc': 0.9912959038722278, 'loss_val': 0.05712993544246411, 'psi': 0.9941985664968767}
[S13] START round=39 head_norm_before_train=1.489690 cos_to_last_merge=1.0000 (last merge round=38)
[S13] round=39 local utility u=0.000000 metrics={'f1_val': 0.5974326853500507, 'auprc': 0.6887778686913422, 'loss_val': 0.7960468484891718, 'psi': 0.6339707586865673}-{'f1_val': 0.6080766523518211, 'auprc': 0.6795011888733818, 'loss_val': 0.7876243096312657, 'psi': 0.6366464669604455}
[S14] START round=39 head_norm_before_train=1.707576 cos_to_last_merge=0.7178 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.718
[S14] round=39 local utility u=0.012838 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9992067789789972, 'loss_val': 0.027792544330429846, 'psi': 0.99837442237193}-{'f1_val': 0.9953280742010686, 'auprc': 0.9991792119364215, 'loss_val': 0.038436797392819126, 'psi': 0.9968685292952097}
[S15] START round=39 head_norm_before_train=2.108185 (no previous merge yet)
[S15] round=39 local utility u=0.000000 metrics={'f1_val': 0.902434066905136, 'auprc': 0.9978307000411457, 'loss_val': 0.19796175193490928, 'psi': 0.9405927201595399}-{'f1_val': 0.9967466683875206, 'auprc': 0.9982144377364872, 'loss_val': 0.01739337511546566, 'psi': 0.9973337761271073}
[S16] START round=39 head_norm_before_train=1.945963 cos_to_last_merge=1.0000 (last merge round=37)
[S16] round=39 local utility u=0.619791 metrics={'f1_val': 0.8702881400845273, 'auprc': 0.9825098824980083, 'loss_val': 0.5704893943660759, 'psi': 0.9151768370499197}-{'f1_val': 0.8189886547895963, 'auprc': 0.834714119180361, 'loss_val': 1.0588866955891334, 'psi': 0.8252788405459022}
[S17] START round=39 head_norm_before_train=1.787466 cos_to_last_merge=1.0000 (last merge round=37)
[S17] round=39 local utility u=0.504940 metrics={'f1_val': 0.6051078530182079, 'auprc': 0.7567641873877058, 'loss_val': 0.9284836220793783, 'psi': 0.6657703867660071}-{'f1_val': 0.5236429786490191, 'auprc': 0.6701763174728315, 'loss_val': 1.1898114622174938, 'psi': 0.582256314178544}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S11@127.0.0.1:31612
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:31607
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:31613
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:31609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:31615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:31617
[S2] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S3] r=40 psi=0.890 u=0.0000 p_local=0.0428 f1=0.817 auprc=0.999 bytes=44977
[S17] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:31616
[S13] r=40 psi=0.634 u=0.0000 p_local=0.0437 f1=0.597 auprc=0.689 bytes=39550
[S6] r=40 psi=0.749 u=0.0000 p_local=0.1615 f1=0.617 auprc=0.947 bytes=41351
[S4] sending update (kind=head size=1797 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1800) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.582409)
[S13] loaded HEAD from S11 (vec_in norm=1.582409)
[S13] cosine check vs S11: cos=0.9875
[S13] BUFFERED delta from S11 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1800) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.718892)
[S15] loaded HEAD from S14 (vec_in norm=1.718892)
[S15] cosine check vs S14: cos=-0.0633
[S15] DROPPED delta from S14 (cos=-0.0633 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1803) from S2
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.820709)
[S11] loaded HEAD from S2 (vec_in norm=1.820709)
[S11] cosine check vs S2: cos=0.8137
[S11] BUFFERED delta from S2 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1801) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.799740)
[S8] loaded HEAD from S17 (vec_in norm=1.799740)
[S8] cosine check vs S17: cos=0.9998
[S8] BUFFERED delta from S17 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1797) from S4
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.663406)
[S6] loaded HEAD from S4 (vec_in norm=1.663406)
[S6] cosine check vs S4: cos=0.9999
[S6] BUFFERED delta from S4 (total buffered=1)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=39 metric=0.9961 head_norm=1.582409
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.315813e-01
[S11] stored merged vector for next round verification (round=39)
[S11] DEBUG after merge:  round=39 metric=0.9961 head_norm=1.620778 delta_norm=0.531581
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S11] r=40 psi=0.996 u=0.0115 p_local=0.0068 f1=0.996 auprc=0.995 bytes=48546
[S2] r=40 psi=0.714 u=0.0517 p_local=0.0193 f1=0.701 auprc=0.734 bytes=37786
[S10] sending update (kind=head size=1797 to 1 peers)
[S4] r=40 psi=0.943 u=0.0186 p_local=0.1372 f1=0.941 auprc=0.945 bytes=48575
[S14] r=40 psi=0.998 u=0.0128 p_local=0.0094 f1=0.998 auprc=0.999 bytes=50360
[S17] r=40 psi=0.666 u=0.5049 p_local=0.2321 f1=0.605 auprc=0.757 bytes=50407
[S8] sending update (kind=head size=1802 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1802) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.806685)
[S17] loaded HEAD from S8 (vec_in norm=1.806685)
[S17] cosine check vs S8: cos=0.9998
[S17] BUFFERED delta from S8 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1797) from S10
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.965853)
[S16] loaded HEAD from S10 (vec_in norm=1.965853)
[S16] cosine check vs S10: cos=0.9991
[S16] BUFFERED delta from S10 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:31602
[S15] r=40 psi=0.941 u=0.0000 p_local=0.1259 f1=0.902 auprc=0.998 bytes=45000
[S16] sending update (kind=head size=1800 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1800) from S16
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.953968)
[S2] loaded HEAD from S16 (vec_in norm=1.953968)
[S2] cosine check vs S16: cos=0.9941
[S2] BUFFERED delta from S16 (total buffered=1)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=39 metric=0.9925 head_norm=1.806685
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.827731e-02
[S8] stored merged vector for next round verification (round=39)
[S8] DEBUG after merge:  round=39 metric=0.9925 head_norm=1.803124 delta_norm=0.018277
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] r=40 psi=0.995 u=0.0609 p_local=0.0755 f1=0.992 auprc=0.999 bytes=48603
[S10] r=40 psi=0.996 u=0.0024 p_local=0.0028 f1=0.996 auprc=0.997 bytes=46798
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=39 metric=0.8703 head_norm=1.953968
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.160464e-02
[S16] stored merged vector for next round verification (round=39)
[S16] DEBUG after merge:  round=39 metric=0.8703 head_norm=1.959478 delta_norm=0.041605
[S16] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S16] r=40 psi=0.915 u=0.6198 p_local=0.2709 f1=0.870 auprc=0.983 bytes=39566
[S2] START round=40 head_norm_before_train=1.820709 cos_to_last_merge=1.0000 (last merge round=38)
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.6604329686756375, 'auprc': 0.6672109631962551, 'loss_val': 0.3491309976269488, 'psi': 0.6631441664838845}-{'f1_val': 0.7013245544597507, 'auprc': 0.7342444559025881, 'loss_val': 0.41407441293363384, 'psi': 0.7144925150368857}
[S3] START round=40 head_norm_before_train=2.064274 (no previous merge yet)
[S3] round=40 local utility u=0.289566 metrics={'f1_val': 0.9134829834147618, 'auprc': 0.9984385205382791, 'loss_val': 0.22968390907563505, 'psi': 0.9474651982641686}-{'f1_val': 0.8174130050068166, 'auprc': 0.9986998358907162, 'loss_val': 0.23317931150602556, 'psi': 0.8899277373603764}
[S4] START round=40 head_norm_before_train=1.663406 cos_to_last_merge=0.9999 (last merge round=38)
[S4] round=40 local utility u=0.000000 metrics={'f1_val': 0.9379006641419628, 'auprc': 0.9244229604223335, 'loss_val': 0.2877875175777691, 'psi': 0.9325095826541111}-{'f1_val': 0.9409157068832164, 'auprc': 0.94494521313167, 'loss_val': 0.2802163978659279, 'psi': 0.9425275093825978}
[S5] START round=40 head_norm_before_train=1.411068 cos_to_last_merge=1.0000 (last merge round=39)
[S5] round=40 local utility u=0.000000 metrics={'f1_val': 0.6690611431983255, 'auprc': 0.8670695860815331, 'loss_val': 0.4445710500495019, 'psi': 0.7482645203516085}-{'f1_val': 0.7003213174339138, 'auprc': 0.9926898435436932, 'loss_val': 0.3291030227910528, 'psi': 0.8172687278778255}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=40 head_norm_before_train=1.668774 cos_to_last_merge=0.9999 (last merge round=38)
[S6] round=40 local utility u=0.605271 metrics={'f1_val': 0.7876372858318005, 'auprc': 0.9476439768042063, 'loss_val': 0.5036068007384956, 'psi': 0.8516399622207629}-{'f1_val': 0.6165766947851309, 'auprc': 0.9472060150909605, 'loss_val': 0.6864722570064462, 'psi': 0.7488284229074628}
[S7] START round=40 head_norm_before_train=1.680956 cos_to_last_merge=0.9957 (last merge round=26)
[S7] round=40 local utility u=0.000000 metrics={'f1_val': 0.5386701075246217, 'auprc': 0.7830621448488388, 'loss_val': 0.8258230780105398, 'psi': 0.6364269224543087}-{'f1_val': 0.5498442342424237, 'auprc': 0.7837298312796698, 'loss_val': 0.7644033780565083, 'psi': 0.6433984730573221}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=40 head_norm_before_train=1.803124 cos_to_last_merge=1.0000 (last merge round=39)
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.9918109678295097, 'auprc': 0.9990014639046726, 'loss_val': 0.04523339004944075, 'psi': 0.9946871662595749}-{'f1_val': 0.9924611780272952, 'auprc': 0.9991845703994865, 'loss_val': 0.04446729593419685, 'psi': 0.9951505349761718}
[S9] START round=40 head_norm_before_train=1.837536 cos_to_last_merge=0.8003 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.800
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.992684475148198, 'auprc': 0.9988529632368613, 'loss_val': 0.02767286197020633, 'psi': 0.9951518703836634}-{'f1_val': 0.9966924912647621, 'auprc': 0.9936894490252374, 'loss_val': 0.021606889555970232, 'psi': 0.9954912743689522}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=40 head_norm_before_train=1.965853 cos_to_last_merge=0.9770 (last merge round=19)
[S10] round=40 local utility u=0.000168 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9969346506461478, 'loss_val': 0.025905256870439687, 'psi': 0.996139652367471}-{'f1_val': 0.9956096535150197, 'auprc': 0.9969333164979579, 'loss_val': 0.026236628444687774, 'psi': 0.996139118708195}
[S11] START round=40 head_norm_before_train=1.620778 cos_to_last_merge=1.0000 (last merge round=39)
[S11] round=40 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9937811794492921, 'loss_val': 0.10363566355867226, 'psi': 0.9951926767277024}-{'f1_val': 0.9961336749133093, 'auprc': 0.9952493298248174, 'loss_val': 0.04603917074751011, 'psi': 0.9957799368779126}
[S13] START round=40 head_norm_before_train=1.501705 cos_to_last_merge=0.9999 (last merge round=38)
[S13] round=40 local utility u=0.145914 metrics={'f1_val': 0.6326068666047951, 'auprc': 0.6705411468000644, 'loss_val': 0.6605528130849458, 'psi': 0.6477805786829028}-{'f1_val': 0.5974326853500507, 'auprc': 0.6887778686913422, 'loss_val': 0.7960468484891718, 'psi': 0.6339707586865673}
[S14] START round=40 head_norm_before_train=1.718892 cos_to_last_merge=0.7164 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.716
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9984513403097928, 'loss_val': 0.02561422858932003, 'psi': 0.997827132684614}-{'f1_val': 0.9978195179672185, 'auprc': 0.9992067789789972, 'loss_val': 0.027792544330429846, 'psi': 0.99837442237193}
[S15] START round=40 head_norm_before_train=2.116623 (no previous merge yet)
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.9030068987748456, 'auprc': 0.9978210716843291, 'loss_val': 0.21193689693876935, 'psi': 0.940932567938639}-{'f1_val': 0.902434066905136, 'auprc': 0.9978307000411457, 'loss_val': 0.19796175193490928, 'psi': 0.9405927201595399}
[S16] START round=40 head_norm_before_train=1.959478 cos_to_last_merge=1.0000 (last merge round=39)
[S16] round=40 local utility u=0.562257 metrics={'f1_val': 0.9744256699542654, 'auprc': 0.9902864092938155, 'loss_val': 0.09413086687484087, 'psi': 0.9807699656900855}-{'f1_val': 0.8702881400845273, 'auprc': 0.9825098824980083, 'loss_val': 0.5704893943660759, 'psi': 0.9151768370499197}
[S17] START round=40 head_norm_before_train=1.799740 cos_to_last_merge=0.9999 (last merge round=37)
[S17] round=40 local utility u=0.000000 metrics={'f1_val': 0.5851276631096407, 'auprc': 0.8092232238894062, 'loss_val': 1.0560291274513185, 'psi': 0.674765887421547}-{'f1_val': 0.6051078530182079, 'auprc': 0.7567641873877058, 'loss_val': 0.9284836220793783, 'psi': 0.6657703867660071}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:31604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:31605
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=40 metric=0.5851 head_norm=1.810226
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.281352e-02
[S17] stored merged vector for next round verification (round=40)
[S17] DEBUG after merge:  round=40 metric=0.5856 head_norm=1.808313 delta_norm=0.022814
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.186 → S8@127.0.0.1:31609
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=40 metric=0.6604 head_norm=1.829320
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.241328e-01
[S2] stored merged vector for next round verification (round=40)
[S2] DEBUG after merge:  round=40 metric=0.6578 head_norm=1.888595 delta_norm=0.124133
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.015 → S11@127.0.0.1:31612
[S6] sending update (kind=head size=1799 to 1 peers)
[S11] ⇄ pheromone p=0.005 → S13@127.0.0.1:31613
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:31616
[S14] ⇄ pheromone p=0.007 → S15@127.0.0.1:31615
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] ⇄ pheromone p=0.110 → S6@127.0.0.1:31607
[S13] sending update (kind=head size=1797 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1797) from S13
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.514743)
[S5] loaded HEAD from S13 (vec_in norm=1.514743)
[S5] cosine check vs S13: cos=0.9445
[S5] BUFFERED delta from S13 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1799) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.678854)
[S4] loaded HEAD from S6 (vec_in norm=1.678854)
[S4] cosine check vs S6: cos=0.9997
[S4] BUFFERED delta from S6 (total buffered=1)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=40 metric=0.7876 head_norm=1.678854
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.017080e-02
[S6] stored merged vector for next round verification (round=40)
[S6] DEBUG after merge:  round=40 metric=0.7894 head_norm=1.671026 delta_norm=0.020171
[S6] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.250 → S4@127.0.0.1:31604
[S10] sending update (kind=head size=1799 to 1 peers)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=40 metric=0.6326 head_norm=1.514743
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.349593e-01
[S13] stored merged vector for next round verification (round=40)
[S13] DEBUG after merge:  round=40 metric=0.6326 head_norm=1.543055 delta_norm=0.134959
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.064 → S5@127.0.0.1:31605
[S16] RECEIVED delta(kind=head bytes=1799) from S10
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.977022)
[S16] loaded HEAD from S10 (vec_in norm=1.977022)
[S16] cosine check vs S10: cos=0.9996
[S16] BUFFERED delta from S10 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:31602
[S8] ⇄ pheromone p=0.060 → S17@127.0.0.1:31617
[S15] ⇄ pheromone p=0.101 → S10@127.0.0.1:31611
[S16] sending update (kind=head size=1797 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1797) from S16
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.968186)
[S2] loaded HEAD from S16 (vec_in norm=1.968186)
[S2] cosine check vs S16: cos=0.9980
[S2] BUFFERED delta from S16 (total buffered=1)
[S10] ⇄ pheromone p=0.002 → S16@127.0.0.1:31616
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=40 metric=0.9744 head_norm=1.968186
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.878228e-02
[S16] stored merged vector for next round verification (round=40)
[S16] DEBUG after merge:  round=40 metric=0.9744 head_norm=1.972399 delta_norm=0.028782
[S16] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.329 → S2@127.0.0.1:31602
[S3]  timeout peer S8
[S2] START round=41 head_norm_before_train=1.888595 cos_to_last_merge=1.0000 (last merge round=40)
[S2] round=41 local utility u=0.224527 metrics={'f1_val': 0.7013025448522918, 'auprc': 0.7555138581174868, 'loss_val': 0.41020349822898766, 'psi': 0.7229870701583698}-{'f1_val': 0.6604329686756375, 'auprc': 0.6672109631962551, 'loss_val': 0.3491309976269488, 'psi': 0.6631441664838845}
[S3] START round=41 head_norm_before_train=2.072996 (no previous merge yet)
[S3] round=41 local utility u=0.136285 metrics={'f1_val': 0.9405289962858367, 'auprc': 0.998824083766725, 'loss_val': 0.12054610807978335, 'psi': 0.963847031278192}-{'f1_val': 0.9134829834147618, 'auprc': 0.9984385205382791, 'loss_val': 0.22968390907563505, 'psi': 0.9474651982641686}
[S3] not sending this round → trigger blocked (psi=0.964)
[S4] START round=41 head_norm_before_train=1.674248 cos_to_last_merge=0.9999 (last merge round=38)
[S4] round=41 local utility u=0.076480 metrics={'f1_val': 0.9412038191728547, 'auprc': 0.9660037907856627, 'loss_val': 0.2793894657550181, 'psi': 0.9511238078179779}-{'f1_val': 0.9379006641419628, 'auprc': 0.9244229604223335, 'loss_val': 0.2877875175777691, 'psi': 0.9325095826541111}
[S5] START round=41 head_norm_before_train=1.427770 cos_to_last_merge=0.9995 (last merge round=39)
[S5] round=41 local utility u=0.000000 metrics={'f1_val': 0.43505855513231695, 'auprc': 0.8553288224144426, 'loss_val': 0.7494577107683931, 'psi': 0.6031666620451672}-{'f1_val': 0.6690611431983255, 'auprc': 0.8670695860815331, 'loss_val': 0.4445710500495019, 'psi': 0.7482645203516085}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=41 metric=0.4351 head_norm=1.449630
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.662178e-01
[S5] stored merged vector for next round verification (round=41)
[S5] DEBUG after merge:  round=41 metric=0.4391 head_norm=1.458446 delta_norm=0.266218
[S5] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S6] START round=41 head_norm_before_train=1.671026 cos_to_last_merge=1.0000 (last merge round=40)
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.7818461727631553, 'auprc': 0.9458720007880694, 'loss_val': 0.5006042774211613, 'psi': 0.8474565039731209}-{'f1_val': 0.7876372858318005, 'auprc': 0.9476439768042063, 'loss_val': 0.5036068007384956, 'psi': 0.8516399622207629}
[S7] START round=41 head_norm_before_train=1.691495 cos_to_last_merge=0.9954 (last merge round=26)
[S7] round=41 local utility u=0.492089 metrics={'f1_val': 0.6449539479899764, 'auprc': 0.8003362404314301, 'loss_val': 0.5311696849635219, 'psi': 0.707106864966558}-{'f1_val': 0.5386701075246217, 'auprc': 0.7830621448488388, 'loss_val': 0.8258230780105398, 'psi': 0.6364269224543087}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=41 head_norm_before_train=1.816255 cos_to_last_merge=1.0000 (last merge round=39)
[S8] round=41 local utility u=0.004612 metrics={'f1_val': 0.9925380579155019, 'auprc': 0.9991810721946337, 'loss_val': 0.0409107830842156, 'psi': 0.9951952636271546}-{'f1_val': 0.9918109678295097, 'auprc': 0.9990014639046726, 'loss_val': 0.04523339004944075, 'psi': 0.9946871662595749}
[S9] START round=41 head_norm_before_train=1.845696 cos_to_last_merge=0.7996 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.800
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.992684475148198, 'auprc': 0.9988518002851694, 'loss_val': 0.028267228380568568, 'psi': 0.9951514052029866}-{'f1_val': 0.992684475148198, 'auprc': 0.9988529632368613, 'loss_val': 0.02767286197020633, 'psi': 0.9951518703836634}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=41 head_norm_before_train=1.977022 cos_to_last_merge=0.9766 (last merge round=19)
[S10] round=41 local utility u=0.000000 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9959641873862595, 'loss_val': 0.02561341698361595, 'psi': 0.9957514670635157}-{'f1_val': 0.9956096535150197, 'auprc': 0.9969346506461478, 'loss_val': 0.025905256870439687, 'psi': 0.996139652367471}
[S11] START round=41 head_norm_before_train=1.649497 cos_to_last_merge=0.9992 (last merge round=39)
[S11] round=41 local utility u=0.016219 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9941399824656514, 'loss_val': 0.0723972844499399, 'psi': 0.9953484778327077}-{'f1_val': 0.9961336749133093, 'auprc': 0.9937811794492921, 'loss_val': 0.10363566355867226, 'psi': 0.9951926767277024}
[S13] START round=41 head_norm_before_train=1.543055 cos_to_last_merge=1.0000 (last merge round=40)
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.5764412099000978, 'auprc': 0.690380685059609, 'loss_val': 0.9102194695252698, 'psi': 0.6220169999639023}-{'f1_val': 0.6326068666047951, 'auprc': 0.6705411468000644, 'loss_val': 0.6605528130849458, 'psi': 0.6477805786829028}
[S14] START round=41 head_norm_before_train=1.730551 cos_to_last_merge=0.7150 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.715
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9991324670947361, 'loss_val': 0.03120912044777236, 'psi': 0.9983446976182255}-{'f1_val': 0.9974109942678281, 'auprc': 0.9984513403097928, 'loss_val': 0.02561422858932003, 'psi': 0.997827132684614}
[S15] START round=41 head_norm_before_train=2.125221 (no previous merge yet)
[S15] round=41 local utility u=0.105578 metrics={'f1_val': 0.917873605529602, 'auprc': 0.9982940638973824, 'loss_val': 0.09139953529489485, 'psi': 0.9500417888767142}-{'f1_val': 0.9030068987748456, 'auprc': 0.9978210716843291, 'loss_val': 0.21193689693876935, 'psi': 0.940932567938639}
[S16] START round=41 head_norm_before_train=1.972399 cos_to_last_merge=1.0000 (last merge round=40)
[S16] round=41 local utility u=0.062384 metrics={'f1_val': 0.9910986389154803, 'auprc': 0.9893137600120213, 'loss_val': 0.06648325648543699, 'psi': 0.9903846873540967}-{'f1_val': 0.9744256699542654, 'auprc': 0.9902864092938155, 'loss_val': 0.09413086687484087, 'psi': 0.9807699656900855}
[S17] START round=41 head_norm_before_train=1.808313 cos_to_last_merge=1.0000 (last merge round=40)
[S17] round=41 local utility u=0.000000 metrics={'f1_val': 0.43230217359396805, 'auprc': 0.6348571965389262, 'loss_val': 1.5451030528513172, 'psi': 0.5133241827719514}-{'f1_val': 0.5851276631096407, 'auprc': 0.8092232238894062, 'loss_val': 1.0560291274513185, 'psi': 0.674765887421547}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:31607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:31612
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:31613
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:31617
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:31611
[S4] sending update (kind=head size=1798 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1798) from S4
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.680924)
[S6] loaded HEAD from S4 (vec_in norm=1.680924)
[S6] cosine check vs S4: cos=0.9996
[S6] BUFFERED delta from S4 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1800) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.684232)
[S13] loaded HEAD from S11 (vec_in norm=1.684232)
[S13] cosine check vs S11: cos=0.9390
[S13] BUFFERED delta from S11 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1802) from S2
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.896105)
[S11] loaded HEAD from S2 (vec_in norm=1.896105)
[S11] cosine check vs S2: cos=0.9196
[S11] BUFFERED delta from S2 (total buffered=1)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=41 metric=0.9962 head_norm=1.684232
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.737178e-01
[S11] stored merged vector for next round verification (round=41)
[S11] DEBUG after merge:  round=41 metric=0.9961 head_norm=1.753927 delta_norm=0.373718
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S8] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=41 metric=0.9412 head_norm=1.680924
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.598932e-02
[S4] stored merged vector for next round verification (round=41)
[S4] DEBUG after merge:  round=41 metric=0.9412 head_norm=1.679689 delta_norm=0.025989
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=41 metric=0.7013 head_norm=1.896105
[S2] _apply_head_vector_avg (torch): Δ‖w‖=7.501180e-02
[S2] stored merged vector for next round verification (round=41)
[S2] DEBUG after merge:  round=41 metric=0.7013 head_norm=1.931025 delta_norm=0.075012
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S10] RECEIVED delta(kind=head bytes=1801) from S15
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=2.133641)
[S10] loaded HEAD from S15 (vec_in norm=2.133641)
[S10] cosine check vs S15: cos=-0.1014
[S10] DROPPED delta from S15 (cos=-0.1014 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1804) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.828585)
[S17] loaded HEAD from S8 (vec_in norm=1.828585)
[S17] cosine check vs S8: cos=0.9999
[S17] BUFFERED delta from S8 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:31602
[S16] sending update (kind=head size=1802 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1802) from S16
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.981800)
[S2] loaded HEAD from S16 (vec_in norm=1.981800)
[S2] cosine check vs S16: cos=0.9993
[S2] BUFFERED delta from S16 (total buffered=1)
[S2] START round=42 head_norm_before_train=1.931025 cos_to_last_merge=1.0000 (last merge round=41)
[S2] round=42 local utility u=0.000000 metrics={'f1_val': 0.7062169820514106, 'auprc': 0.73162036386063, 'loss_val': 0.4091769795468478, 'psi': 0.7163783347750983}-{'f1_val': 0.7013025448522918, 'auprc': 0.7555138581174868, 'loss_val': 0.41020349822898766, 'psi': 0.7229870701583698}
[S3] START round=42 head_norm_before_train=2.081752 (no previous merge yet)
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.8332271984208172, 'auprc': 0.9987681504813645, 'loss_val': 0.21518071060551447, 'psi': 0.899443579245036}-{'f1_val': 0.9405289962858367, 'auprc': 0.998824083766725, 'loss_val': 0.12054610807978335, 'psi': 0.963847031278192}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=42 head_norm_before_train=1.679689 cos_to_last_merge=1.0000 (last merge round=41)
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.9386909970413532, 'auprc': 0.9412142312062117, 'loss_val': 0.2849227566269885, 'psi': 0.9397002907072967}-{'f1_val': 0.9412038191728547, 'auprc': 0.9660037907856627, 'loss_val': 0.2793894657550181, 'psi': 0.9511238078179779}
[S5] START round=42 head_norm_before_train=1.458446 cos_to_last_merge=1.0000 (last merge round=41)
[S5] round=42 local utility u=0.560468 metrics={'f1_val': 0.5931131859193244, 'auprc': 0.8563884599796777, 'loss_val': 0.5800292289185851, 'psi': 0.6984232955434657}-{'f1_val': 0.43505855513231695, 'auprc': 0.8553288224144426, 'loss_val': 0.7494577107683931, 'psi': 0.6031666620451672}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=42 head_norm_before_train=1.680235 cos_to_last_merge=1.0000 (last merge round=40)
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.6040859106816456, 'auprc': 0.9404164603316252, 'loss_val': 0.724012653314379, 'psi': 0.7386181305416375}-{'f1_val': 0.7818461727631553, 'auprc': 0.9458720007880694, 'loss_val': 0.5006042774211613, 'psi': 0.8474565039731209}
[S7] START round=42 head_norm_before_train=1.701386 cos_to_last_merge=0.9950 (last merge round=26)
[S7] round=42 local utility u=0.047854 metrics={'f1_val': 0.6523510000051422, 'auprc': 0.8014344244761463, 'loss_val': 0.48313880464164977, 'psi': 0.7119843697935438}-{'f1_val': 0.6449539479899764, 'auprc': 0.8003362404314301, 'loss_val': 0.5311696849635219, 'psi': 0.707106864966558}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] sending update (kind=head size=1795 to 1 peers)
[S8] START round=42 head_norm_before_train=1.828585 cos_to_last_merge=0.9999 (last merge round=39)
[S8] round=42 local utility u=0.000766 metrics={'f1_val': 0.9925289693239863, 'auprc': 0.9991745841641407, 'loss_val': 0.03930444374561915, 'psi': 0.995187215260048}-{'f1_val': 0.9925380579155019, 'auprc': 0.9991810721946337, 'loss_val': 0.0409107830842156, 'psi': 0.9951952636271546}
[S9] START round=42 head_norm_before_train=1.853967 cos_to_last_merge=0.7989 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.799
[S9] round=42 local utility u=0.009456 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9936527157976299, 'loss_val': 0.02026905372207581, 'psi': 0.9957228338263376}-{'f1_val': 0.992684475148198, 'auprc': 0.9988518002851694, 'loss_val': 0.028267228380568568, 'psi': 0.9951514052029866}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=42 head_norm_before_train=1.988099 cos_to_last_merge=0.9761 (last merge round=19)
[S10] round=42 local utility u=0.001480 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9968992420388286, 'loss_val': 0.025459076937844917, 'psi': 0.9961254889245433}-{'f1_val': 0.9956096535150197, 'auprc': 0.9959641873862595, 'loss_val': 0.02561341698361595, 'psi': 0.9957514670635157}
[S11] START round=42 head_norm_before_train=1.753927 cos_to_last_merge=1.0000 (last merge round=41)
[S11] round=42 local utility u=0.000000 metrics={'f1_val': 0.8721057290264322, 'auprc': 0.9974418091485473, 'loss_val': 0.2623796982343475, 'psi': 0.9222401610752783}-{'f1_val': 0.9961541414107454, 'auprc': 0.9941399824656514, 'loss_val': 0.0723972844499399, 'psi': 0.9953484778327077}
[S13] START round=42 head_norm_before_train=1.554030 cos_to_last_merge=0.9999 (last merge round=40)
[S13] round=42 local utility u=0.193906 metrics={'f1_val': 0.6161993247165679, 'auprc': 0.6806824809685538, 'loss_val': 0.7318616742570417, 'psi': 0.6419925872173622}-{'f1_val': 0.5764412099000978, 'auprc': 0.690380685059609, 'loss_val': 0.9102194695252698, 'psi': 0.6220169999639023}
[S14] START round=42 head_norm_before_train=1.737894 cos_to_last_merge=0.7137 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.714
[S14] round=42 local utility u=0.000723 metrics={'f1_val': 0.9969478118293155, 'auprc': 0.9995229409250951, 'loss_val': 0.025703552548836456, 'psi': 0.9979778634676273}-{'f1_val': 0.9978195179672185, 'auprc': 0.9991324670947361, 'loss_val': 0.03120912044777236, 'psi': 0.9983446976182255}
[S15] START round=42 head_norm_before_train=2.133641 (no previous merge yet)
[S15] round=42 local utility u=0.000000 metrics={'f1_val': 0.904161441929954, 'auprc': 0.9978837242942367, 'loss_val': 0.11334945744575797, 'psi': 0.9416503548756671}-{'f1_val': 0.917873605529602, 'auprc': 0.9982940638973824, 'loss_val': 0.09139953529489485, 'psi': 0.9500417888767142}
[S16] START round=42 head_norm_before_train=1.981800 cos_to_last_merge=1.0000 (last merge round=40)
[S16] round=42 local utility u=0.000000 metrics={'f1_val': 0.8530897890376824, 'auprc': 0.9747865122550156, 'loss_val': 0.7401861662261602, 'psi': 0.9017684783246157}-{'f1_val': 0.9910986389154803, 'auprc': 0.9893137600120213, 'loss_val': 0.06648325648543699, 'psi': 0.9903846873540967}
[S17] START round=42 head_norm_before_train=1.817225 cos_to_last_merge=1.0000 (last merge round=40)
[S17] round=42 local utility u=1.000000 metrics={'f1_val': 0.6180192199215304, 'auprc': 0.8805921300711275, 'loss_val': 0.8840108492629423, 'psi': 0.7230483839813693}-{'f1_val': 0.43230217359396805, 'auprc': 0.6348571965389262, 'loss_val': 1.5451030528513172, 'psi': 0.5133241827719514}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:31605
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:31615
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:31609
[S17] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:31616
[S13] sending update (kind=head size=1799 to 1 peers)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=42 metric=0.7062 head_norm=1.938755
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.744317e-02
[S2] stored merged vector for next round verification (round=42)
[S2] DEBUG after merge:  round=42 metric=0.7062 head_norm=1.959821 delta_norm=0.047443
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:31617
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] RECEIVED delta(kind=head bytes=1799) from S13
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.565115)
[S5] loaded HEAD from S13 (vec_in norm=1.565115)
[S5] cosine check vs S13: cos=0.9667
[S5] BUFFERED delta from S13 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1800) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.745643)
[S15] loaded HEAD from S14 (vec_in norm=1.745643)
[S15] cosine check vs S14: cos=-0.0635
[S15] DROPPED delta from S14 (cos=-0.0635 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1800) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.824728)
[S8] loaded HEAD from S17 (vec_in norm=1.824728)
[S8] cosine check vs S17: cos=0.9997
[S8] BUFFERED delta from S17 (total buffered=1)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=42 metric=0.6162 head_norm=1.565115
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.954540e-01
[S13] stored merged vector for next round verification (round=42)
[S13] DEBUG after merge:  round=42 metric=0.6162 head_norm=1.598693 delta_norm=0.295454
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=42 metric=0.6180 head_norm=1.824728
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.776410e-02
[S17] stored merged vector for next round verification (round=42)
[S17] DEBUG after merge:  round=42 metric=0.6180 head_norm=1.826571 delta_norm=0.017764
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] RECEIVED delta(kind=head bytes=1797) from S10
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.998989)
[S16] loaded HEAD from S10 (vec_in norm=1.998989)
[S16] cosine check vs S10: cos=0.9995
[S16] BUFFERED delta from S10 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1804) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.841914)
[S17] loaded HEAD from S8 (vec_in norm=1.841914)
[S17] cosine check vs S8: cos=0.9999
[S17] BUFFERED delta from S8 (total buffered=1)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=42 metric=0.6041 head_norm=1.689037
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.903360e-02
[S6] stored merged vector for next round verification (round=42)
[S6] DEBUG after merge:  round=42 metric=0.6087 head_norm=1.684735 delta_norm=0.029034
[S6] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=42 metric=0.9925 head_norm=1.841914
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.416730e-02
[S8] stored merged vector for next round verification (round=42)
[S8] DEBUG after merge:  round=42 metric=0.9925 head_norm=1.833182 delta_norm=0.024167
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=42 metric=0.8531 head_norm=1.990094
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.244631e-02
[S16] stored merged vector for next round verification (round=42)
[S16] DEBUG after merge:  round=42 metric=0.8531 head_norm=1.994283 delta_norm=0.032446
[S16] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=43 head_norm_before_train=1.959821 cos_to_last_merge=1.0000 (last merge round=42)
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.7084626812196042, 'auprc': 0.733467057062301, 'loss_val': 0.4366683678271132, 'psi': 0.7184644315566829}-{'f1_val': 0.7062169820514106, 'auprc': 0.73162036386063, 'loss_val': 0.4091769795468478, 'psi': 0.7163783347750983}
[S3] START round=43 head_norm_before_train=2.091729 (no previous merge yet)
[S3] round=43 local utility u=0.589529 metrics={'f1_val': 0.9974271292865575, 'auprc': 0.9988434689481627, 'loss_val': 0.02154912589240712, 'psi': 0.9979936651511996}-{'f1_val': 0.8332271984208172, 'auprc': 0.9987681504813645, 'loss_val': 0.21518071060551447, 'psi': 0.899443579245036}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=43 head_norm_before_train=1.687299 cos_to_last_merge=1.0000 (last merge round=41)
[S4] round=43 local utility u=0.030620 metrics={'f1_val': 0.9373401132596513, 'auprc': 0.966164144299048, 'loss_val': 0.29042738742159174, 'psi': 0.94886972567541}-{'f1_val': 0.9386909970413532, 'auprc': 0.9412142312062117, 'loss_val': 0.2849227566269885, 'psi': 0.9397002907072967}
[S5] START round=43 head_norm_before_train=1.473203 cos_to_last_merge=0.9996 (last merge round=41)
[S5] round=43 local utility u=0.664704 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9970925913709277, 'loss_val': 0.31598160548831794, 'psi': 0.8190298270087193}-{'f1_val': 0.5931131859193244, 'auprc': 0.8563884599796777, 'loss_val': 0.5800292289185851, 'psi': 0.6984232955434657}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=43 metric=0.7003 head_norm=1.491396
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.167607e-01
[S5] stored merged vector for next round verification (round=43)
[S5] DEBUG after merge:  round=43 metric=0.7003 head_norm=1.513254 delta_norm=0.216761
[S5] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S6] START round=43 head_norm_before_train=1.684735 cos_to_last_merge=1.0000 (last merge round=42)
[S6] round=43 local utility u=1.000000 metrics={'f1_val': 0.9616921418945878, 'auprc': 0.9561946015397748, 'loss_val': 0.18442756812362204, 'psi': 0.9594931257526627}-{'f1_val': 0.6040859106816456, 'auprc': 0.9404164603316252, 'loss_val': 0.724012653314379, 'psi': 0.7386181305416375}
[S7] START round=43 head_norm_before_train=1.708892 cos_to_last_merge=0.9946 (last merge round=26)
[S7] round=43 local utility u=0.161171 metrics={'f1_val': 0.6717593707552918, 'auprc': 0.8288292626043563, 'loss_val': 0.3594312674026493, 'psi': 0.7345873274949176}-{'f1_val': 0.6523510000051422, 'auprc': 0.8014344244761463, 'loss_val': 0.48313880464164977, 'psi': 0.7119843697935438}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=43 head_norm_before_train=1.833182 cos_to_last_merge=1.0000 (last merge round=42)
[S8] round=43 local utility u=0.000000 metrics={'f1_val': 0.9920979054933599, 'auprc': 0.999168108659648, 'loss_val': 0.04248791473607917, 'psi': 0.9949259867598752}-{'f1_val': 0.9925289693239863, 'auprc': 0.9991745841641407, 'loss_val': 0.03930444374561915, 'psi': 0.995187215260048}
[S9] START round=43 head_norm_before_train=1.862014 cos_to_last_merge=0.7982 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.798
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9939257170613092, 'loss_val': 0.02036860690925732, 'psi': 0.9955665939128585}-{'f1_val': 0.9971029125121428, 'auprc': 0.9936527157976299, 'loss_val': 0.02026905372207581, 'psi': 0.9957228338263376}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=43 head_norm_before_train=1.998989 cos_to_last_merge=0.9758 (last merge round=19)
[S10] round=43 local utility u=0.000000 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9959710198933128, 'loss_val': 0.025171897551918402, 'psi': 0.9957542000663371}-{'f1_val': 0.9956096535150197, 'auprc': 0.9968992420388286, 'loss_val': 0.025459076937844917, 'psi': 0.9961254889245433}
[S11] START round=43 head_norm_before_train=1.778859 cos_to_last_merge=0.9991 (last merge round=41)
[S11] round=43 local utility u=0.448794 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.993265588965404, 'loss_val': 0.09643036665154302, 'psi': 0.9949864405341472}-{'f1_val': 0.8721057290264322, 'auprc': 0.9974418091485473, 'loss_val': 0.2623796982343475, 'psi': 0.9222401610752783}
[S13] START round=43 head_norm_before_train=1.598693 cos_to_last_merge=1.0000 (last merge round=42)
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.5915083880272872, 'auprc': 0.6996884346548315, 'loss_val': 0.7808776068543571, 'psi': 0.6347804066783049}-{'f1_val': 0.6161993247165679, 'auprc': 0.6806824809685538, 'loss_val': 0.7318616742570417, 'psi': 0.6419925872173622}
[S14] START round=43 head_norm_before_train=1.745643 cos_to_last_merge=0.7127 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.713
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.9938325267947873, 'auprc': 0.9973843061106955, 'loss_val': 0.038047921253656476, 'psi': 0.9952532385211506}-{'f1_val': 0.9969478118293155, 'auprc': 0.9995229409250951, 'loss_val': 0.025703552548836456, 'psi': 0.9979778634676273}
[S15] START round=43 head_norm_before_train=2.141876 (no previous merge yet)
[S15] round=43 local utility u=0.000000 metrics={'f1_val': 0.9030228911638922, 'auprc': 0.997948702640604, 'loss_val': 0.1318958686726518, 'psi': 0.9409932157545768}-{'f1_val': 0.904161441929954, 'auprc': 0.9978837242942367, 'loss_val': 0.11334945744575797, 'psi': 0.9416503548756671}
[S16] START round=43 head_norm_before_train=1.994283 cos_to_last_merge=1.0000 (last merge round=42)
[S16] round=43 local utility u=0.545433 metrics={'f1_val': 0.9396342129014391, 'auprc': 0.990255278414185, 'loss_val': 0.2149937322255552, 'psi': 0.9598826391065374}-{'f1_val': 0.8530897890376824, 'auprc': 0.9747865122550156, 'loss_val': 0.7401861662261602, 'psi': 0.9017684783246157}
[S17] START round=43 head_norm_before_train=1.826571 cos_to_last_merge=1.0000 (last merge round=42)
[S17] round=43 local utility u=0.000000 metrics={'f1_val': 0.6023992813387331, 'auprc': 0.9330245630817695, 'loss_val': 1.008148551934596, 'psi': 0.7346493940359478}-{'f1_val': 0.6180192199215304, 'auprc': 0.8805921300711275, 'loss_val': 0.8840108492629423, 'psi': 0.7230483839813693}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:31607
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:31604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:31613
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=43 metric=0.6024 head_norm=1.833758
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.706190e-02
[S17] stored merged vector for next round verification (round=43)
[S17] DEBUG after merge:  round=43 metric=0.6024 head_norm=1.837761 delta_norm=0.017062
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S6] RECEIVED delta(kind=head bytes=1800) from S4
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.699450)
[S6] loaded HEAD from S4 (vec_in norm=1.699450)
[S6] cosine check vs S4: cos=0.9998
[S6] BUFFERED delta from S4 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1795) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.804257)
[S13] loaded HEAD from S11 (vec_in norm=1.804257)
[S13] cosine check vs S11: cos=0.9451
[S13] BUFFERED delta from S11 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1797) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.689735)
[S4] loaded HEAD from S6 (vec_in norm=1.689735)
[S4] cosine check vs S6: cos=0.9998
[S4] BUFFERED delta from S6 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:31602
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=43 metric=0.9617 head_norm=1.689735
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.691166e-02
[S6] stored merged vector for next round verification (round=43)
[S6] DEBUG after merge:  round=43 metric=0.9617 head_norm=1.694515 delta_norm=0.016912
[S6] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=43 metric=0.9373 head_norm=1.699450
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.691167e-02
[S4] stored merged vector for next round verification (round=43)
[S4] DEBUG after merge:  round=43 metric=0.9373 head_norm=1.694515 delta_norm=0.016912
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S16] sending update (kind=head size=1797 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1797) from S16
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=2.001511)
[S2] loaded HEAD from S16 (vec_in norm=2.001511)
[S2] cosine check vs S16: cos=0.9996
[S2] BUFFERED delta from S16 (total buffered=1)
[S2] START round=44 head_norm_before_train=1.968853 cos_to_last_merge=1.0000 (last merge round=42)
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.6652108714150834, 'auprc': 0.7430712683071607, 'loss_val': 0.5512306738426075, 'psi': 0.6963550301719144}-{'f1_val': 0.7084626812196042, 'auprc': 0.733467057062301, 'loss_val': 0.4366683678271132, 'psi': 0.7184644315566829}
[S3] START round=44 head_norm_before_train=2.101671 (no previous merge yet)
[S3] round=44 local utility u=0.000000 metrics={'f1_val': 0.979088688423443, 'auprc': 0.9986747388215373, 'loss_val': 0.04674470885733299, 'psi': 0.9869231085826806}-{'f1_val': 0.9974271292865575, 'auprc': 0.9988434689481627, 'loss_val': 0.02154912589240712, 'psi': 0.9979936651511996}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=44 head_norm_before_train=1.694515 cos_to_last_merge=1.0000 (last merge round=43)
[S4] round=44 local utility u=0.003545 metrics={'f1_val': 0.9422118716874469, 'auprc': 0.9546879691757142, 'loss_val': 0.27814005919621415, 'psi': 0.9472023106827538}-{'f1_val': 0.9373401132596513, 'auprc': 0.966164144299048, 'loss_val': 0.29042738742159174, 'psi': 0.94886972567541}
[S5] START round=44 head_norm_before_train=1.513254 cos_to_last_merge=1.0000 (last merge round=43)
[S5] round=44 local utility u=0.000000 metrics={'f1_val': 0.6387731365511363, 'auprc': 0.8278336786478068, 'loss_val': 0.5520072215642133, 'psi': 0.7143973533898045}-{'f1_val': 0.7003213174339138, 'auprc': 0.9970925913709277, 'loss_val': 0.31598160548831794, 'psi': 0.8190298270087193}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=44 head_norm_before_train=1.694515 cos_to_last_merge=1.0000 (last merge round=43)
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.6289470814891815, 'auprc': 0.9362255042469227, 'loss_val': 0.6881111540853229, 'psi': 0.7518584505922781}-{'f1_val': 0.9616921418945878, 'auprc': 0.9561946015397748, 'loss_val': 0.18442756812362204, 'psi': 0.9594931257526627}
[S7] START round=44 head_norm_before_train=1.717070 cos_to_last_merge=0.9940 (last merge round=26)
[S7] round=44 local utility u=0.000000 metrics={'f1_val': 0.5177561164799448, 'auprc': 0.7828096662887523, 'loss_val': 0.8481603744435013, 'psi': 0.6237775364034679}-{'f1_val': 0.6717593707552918, 'auprc': 0.8288292626043563, 'loss_val': 0.3594312674026493, 'psi': 0.7345873274949176}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=44 head_norm_before_train=1.845878 cos_to_last_merge=1.0000 (last merge round=42)
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.9895700826501451, 'auprc': 0.9991665726804924, 'loss_val': 0.04425315453974751, 'psi': 0.993408678662284}-{'f1_val': 0.9920979054933599, 'auprc': 0.999168108659648, 'loss_val': 0.04248791473607917, 'psi': 0.9949259867598752}
[S9] START round=44 head_norm_before_train=1.870198 cos_to_last_merge=0.7974 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.797
[S9] round=44 local utility u=0.006467 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9980215521597858, 'loss_val': 0.01972240658866539, 'psi': 0.9972049279522492}-{'f1_val': 0.9966605118138915, 'auprc': 0.9939257170613092, 'loss_val': 0.02036860690925732, 'psi': 0.9955665939128585}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=44 head_norm_before_train=2.009717 cos_to_last_merge=0.9753 (last merge round=19)
[S10] round=44 local utility u=0.000916 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9964931548657683, 'loss_val': 0.024905676403477923, 'psi': 0.9959630540553193}-{'f1_val': 0.9956096535150197, 'auprc': 0.9959710198933128, 'loss_val': 0.025171897551918402, 'psi': 0.9957542000663371}
[S11] START round=44 head_norm_before_train=1.804257 cos_to_last_merge=0.9969 (last merge round=41)
[S11] round=44 local utility u=0.014305 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.99402200988815, 'loss_val': 0.0700889220526273, 'psi': 0.9952890089032456}-{'f1_val': 0.9961336749133093, 'auprc': 0.993265588965404, 'loss_val': 0.09643036665154302, 'psi': 0.9949864405341472}
[S13] START round=44 head_norm_before_train=1.610370 cos_to_last_merge=0.9998 (last merge round=42)
[S13] round=44 local utility u=0.186905 metrics={'f1_val': 0.601268934423518, 'auprc': 0.7978705400436188, 'loss_val': 0.7601766727916829, 'psi': 0.6799095766715584}-{'f1_val': 0.5915083880272872, 'auprc': 0.6996884346548315, 'loss_val': 0.7808776068543571, 'psi': 0.6347804066783049}
[S14] START round=44 head_norm_before_train=1.755736 cos_to_last_merge=0.7117 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.712
[S14] round=44 local utility u=0.012769 metrics={'f1_val': 0.9961605687915402, 'auprc': 0.9992020227684539, 'loss_val': 0.03193105922503669, 'psi': 0.9973771503823057}-{'f1_val': 0.9938325267947873, 'auprc': 0.9973843061106955, 'loss_val': 0.038047921253656476, 'psi': 0.9952532385211506}
[S15] START round=44 head_norm_before_train=2.149701 (no previous merge yet)
[S15] round=44 local utility u=0.062318 metrics={'f1_val': 0.9163758049289272, 'auprc': 0.9982899210023375, 'loss_val': 0.08840123683370485, 'psi': 0.9491414513582914}-{'f1_val': 0.9030228911638922, 'auprc': 0.997948702640604, 'loss_val': 0.1318958686726518, 'psi': 0.9409932157545768}
[S16] START round=44 head_norm_before_train=2.001511 cos_to_last_merge=1.0000 (last merge round=42)
[S16] round=44 local utility u=0.218620 metrics={'f1_val': 0.9883881386740028, 'auprc': 0.9881983315790781, 'loss_val': 0.064106302852142, 'psi': 0.9883122158360329}-{'f1_val': 0.9396342129014391, 'auprc': 0.990255278414185, 'loss_val': 0.2149937322255552, 'psi': 0.9598826391065374}
[S17] START round=44 head_norm_before_train=1.837761 cos_to_last_merge=1.0000 (last merge round=43)
[S17] round=44 local utility u=0.033116 metrics={'f1_val': 0.6024217680165783, 'auprc': 0.9650367597330828, 'loss_val': 1.0380875683936783, 'psi': 0.7474677647031801}-{'f1_val': 0.6023992813387331, 'auprc': 0.9330245630817695, 'loss_val': 1.008148551934596, 'psi': 0.7346493940359478}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:31607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:31609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:31615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:31613
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:31605
[S13] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:31611
[S14] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:31616
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=44 metric=0.6652 head_norm=1.978000
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.697274e-02
[S2] stored merged vector for next round verification (round=44)
[S2] DEBUG after merge:  round=44 metric=0.6608 head_norm=1.989447 delta_norm=0.036973
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] RECEIVED delta(kind=head bytes=1796) from S13
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.628356)
[S5] loaded HEAD from S13 (vec_in norm=1.628356)
[S5] cosine check vs S13: cos=0.9556
[S5] BUFFERED delta from S13 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1798) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.835616)
[S13] loaded HEAD from S11 (vec_in norm=1.835616)
[S13] cosine check vs S11: cos=0.9488
[S13] BUFFERED delta from S11 (total buffered=2)
[S8] RECEIVED delta(kind=head bytes=1800) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.847510)
[S8] loaded HEAD from S17 (vec_in norm=1.847510)
[S8] cosine check vs S17: cos=0.9999
[S8] BUFFERED delta from S17 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1797) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.767301)
[S15] loaded HEAD from S14 (vec_in norm=1.767301)
[S15] cosine check vs S14: cos=-0.0637
[S15] DROPPED delta from S14 (cos=-0.0637 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1797) from S4
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.703761)
[S6] loaded HEAD from S4 (vec_in norm=1.703761)
[S6] cosine check vs S4: cos=0.9999
[S6] BUFFERED delta from S4 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:31602
[S15] sending update (kind=head size=1802 to 1 peers)
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=44 metric=0.6013 head_norm=1.628356
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.014979e-01
[S13] stored merged vector for next round verification (round=44)
[S13] DEBUG after merge:  round=44 metric=0.6010 head_norm=1.700110 delta_norm=0.301498
[S13] aggregate: ACCEPT kept=['S11', 'S11'] (k=2/2) mode=median trim_p=0.1
[S10] sending update (kind=head size=1800 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1800) from S10
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=2.019033)
[S16] loaded HEAD from S10 (vec_in norm=2.019033)
[S16] cosine check vs S10: cos=0.9995
[S16] BUFFERED delta from S10 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1802) from S15
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=2.157557)
[S10] loaded HEAD from S15 (vec_in norm=2.157557)
[S10] cosine check vs S15: cos=-0.1008
[S10] DROPPED delta from S15 (cos=-0.1008 < 0.0)
[S16] sending update (kind=head size=1797 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1797) from S16
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=2.009142)
[S2] loaded HEAD from S16 (vec_in norm=2.009142)
[S2] cosine check vs S16: cos=0.9999
[S2] BUFFERED delta from S16 (total buffered=1)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=44 metric=0.9896 head_norm=1.855868
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.227166e-02
[S8] stored merged vector for next round verification (round=44)
[S8] DEBUG after merge:  round=44 metric=0.9896 head_norm=1.851653 delta_norm=0.012272
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=44 metric=0.9884 head_norm=2.009142
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.130770e-02
[S16] stored merged vector for next round verification (round=44)
[S16] DEBUG after merge:  round=44 metric=0.9884 head_norm=2.013850 delta_norm=0.031308
[S16] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=45 head_norm_before_train=1.989447 cos_to_last_merge=1.0000 (last merge round=44)
[S2] round=45 local utility u=0.396173 metrics={'f1_val': 0.7099481022061906, 'auprc': 0.8832181042592306, 'loss_val': 0.44774788819599703, 'psi': 0.7792561030274067}-{'f1_val': 0.6652108714150834, 'auprc': 0.7430712683071607, 'loss_val': 0.5512306738426075, 'psi': 0.6963550301719144}
[S3] START round=45 head_norm_before_train=2.110101 (no previous merge yet)
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.8879780837110944, 'auprc': 0.9986707844168166, 'loss_val': 0.19220185135740195, 'psi': 0.9322551639933833}-{'f1_val': 0.979088688423443, 'auprc': 0.9986747388215373, 'loss_val': 0.04674470885733299, 'psi': 0.9869231085826806}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=45 head_norm_before_train=1.703761 cos_to_last_merge=1.0000 (last merge round=43)
[S4] round=45 local utility u=0.000548 metrics={'f1_val': 0.9398103292037613, 'auprc': 0.9624085767249791, 'loss_val': 0.28579748206117167, 'psi': 0.9488496282122485}-{'f1_val': 0.9422118716874469, 'auprc': 0.9546879691757142, 'loss_val': 0.27814005919621415, 'psi': 0.9472023106827538}
[S5] START round=45 head_norm_before_train=1.527516 cos_to_last_merge=0.9996 (last merge round=43)
[S5] round=45 local utility u=0.496873 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9697626937097119, 'loss_val': 0.35333378461500975, 'psi': 0.8080974365787001}-{'f1_val': 0.6387731365511363, 'auprc': 0.8278336786478068, 'loss_val': 0.5520072215642133, 'psi': 0.7143973533898045}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] sending update (kind=head size=1795 to 1 peers)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=45 metric=0.7003 head_norm=1.544097
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.536527e-01
[S5] stored merged vector for next round verification (round=45)
[S5] DEBUG after merge:  round=45 metric=0.7003 head_norm=1.566381 delta_norm=0.253653
[S5] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S6] START round=45 head_norm_before_train=1.697303 cos_to_last_merge=0.9999 (last merge round=43)
[S6] round=45 local utility u=0.141439 metrics={'f1_val': 0.6837809137838494, 'auprc': 0.911002611464514, 'loss_val': 0.6585673253807627, 'psi': 0.7746695928561153}-{'f1_val': 0.6289470814891815, 'auprc': 0.9362255042469227, 'loss_val': 0.6881111540853229, 'psi': 0.7518584505922781}
[S7] START round=45 head_norm_before_train=1.725726 cos_to_last_merge=0.9935 (last merge round=26)
[S7] round=45 local utility u=0.686131 metrics={'f1_val': 0.6589052573296252, 'auprc': 0.8133440937542095, 'loss_val': 0.4143958185076944, 'psi': 0.7206807918994589}-{'f1_val': 0.5177561164799448, 'auprc': 0.7828096662887523, 'loss_val': 0.8481603744435013, 'psi': 0.6237775364034679}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=45 head_norm_before_train=1.851653 cos_to_last_merge=1.0000 (last merge round=44)
[S8] round=45 local utility u=0.011001 metrics={'f1_val': 0.9928159069878363, 'auprc': 0.9980887460644021, 'loss_val': 0.038491717910159665, 'psi': 0.9949250426184626}-{'f1_val': 0.9895700826501451, 'auprc': 0.9991665726804924, 'loss_val': 0.04425315453974751, 'psi': 0.993408678662284}
[S9] START round=45 head_norm_before_train=1.879043 cos_to_last_merge=0.7965 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.796
[S9] round=45 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.996680625344408, 'loss_val': 0.019948339693002765, 'psi': 0.996668557226098}-{'f1_val': 0.9966605118138915, 'auprc': 0.9980215521597858, 'loss_val': 0.01972240658866539, 'psi': 0.9972049279522492}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=45 head_norm_before_train=2.019033 cos_to_last_merge=0.9748 (last merge round=19)
[S10] round=45 local utility u=0.000000 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9959841600618872, 'loss_val': 0.02476096347321526, 'psi': 0.9957594561337668}-{'f1_val': 0.9956096535150197, 'auprc': 0.9964931548657683, 'loss_val': 0.024905676403477923, 'psi': 0.9959630540553193}
[S11] START round=45 head_norm_before_train=1.835616 cos_to_last_merge=0.9933 (last merge round=41)
[S11] round=45 local utility u=0.008187 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9940012741087567, 'loss_val': 0.05365329731415899, 'psi': 0.9952807145914883}-{'f1_val': 0.9961336749133093, 'auprc': 0.99402200988815, 'loss_val': 0.0700889220526273, 'psi': 0.9952890089032456}
[S13] START round=45 head_norm_before_train=1.700110 cos_to_last_merge=1.0000 (last merge round=44)
[S13] round=45 local utility u=0.000000 metrics={'f1_val': 0.6056352624131283, 'auprc': 0.7431969692492227, 'loss_val': 0.7280809922676864, 'psi': 0.6606599451475661}-{'f1_val': 0.601268934423518, 'auprc': 0.7978705400436188, 'loss_val': 0.7601766727916829, 'psi': 0.6799095766715584}
[S14] START round=45 head_norm_before_train=1.767301 cos_to_last_merge=0.7107 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.711
[S14] round=45 local utility u=0.009258 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9992291877445888, 'loss_val': 0.023451120115574313, 'psi': 0.9983833858781666}-{'f1_val': 0.9961605687915402, 'auprc': 0.9992020227684539, 'loss_val': 0.03193105922503669, 'psi': 0.9973771503823057}
[S15] START round=45 head_norm_before_train=2.157557 (no previous merge yet)
[S15] round=45 local utility u=0.275826 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9982639869445006, 'loss_val': 0.018896138324130327, 'psi': 0.9973535958103126}-{'f1_val': 0.9163758049289272, 'auprc': 0.9982899210023375, 'loss_val': 0.08840123683370485, 'psi': 0.9491414513582914}
[S16] START round=45 head_norm_before_train=2.013850 cos_to_last_merge=1.0000 (last merge round=44)
[S16] round=45 local utility u=0.000000 metrics={'f1_val': 0.9241885523255511, 'auprc': 0.9898332952698636, 'loss_val': 0.3451658543404915, 'psi': 0.9504464495032761}-{'f1_val': 0.9883881386740028, 'auprc': 0.9881983315790781, 'loss_val': 0.064106302852142, 'psi': 0.9883122158360329}
[S17] START round=45 head_norm_before_train=1.847510 cos_to_last_merge=1.0000 (last merge round=43)
[S17] round=45 local utility u=0.890536 metrics={'f1_val': 0.8049678348065662, 'auprc': 0.968384900548314, 'loss_val': 0.48233693894954927, 'psi': 0.8703346611032654}-{'f1_val': 0.6024217680165783, 'auprc': 0.9650367597330828, 'loss_val': 1.0380875683936783, 'psi': 0.7474677647031801}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:31607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:31612
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:31609
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S6] → sending delta(kind=head bytes=1806) to S4@127.0.0.1:31604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:31615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:31613
[S4] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:31617
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1806 to 1 peers)
[S13] ⇄ pheromone p=0.071 → S5@127.0.0.1:31605
[S11] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:31611
[S4] RECEIVED delta(kind=head bytes=1806) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.697260)
[S4] loaded HEAD from S6 (vec_in norm=1.697260)
[S4] cosine check vs S6: cos=0.9994
[S4] BUFFERED delta from S6 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1796) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.866506)
[S13] loaded HEAD from S11 (vec_in norm=1.866506)
[S13] cosine check vs S11: cos=0.9897
[S13] BUFFERED delta from S11 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1798) from S2
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.997073)
[S11] loaded HEAD from S2 (vec_in norm=1.997073)
[S11] cosine check vs S2: cos=0.9320
[S11] BUFFERED delta from S2 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1801) from S4
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.713246)
[S6] loaded HEAD from S4 (vec_in norm=1.713246)
[S6] cosine check vs S4: cos=0.9994
[S6] BUFFERED delta from S4 (total buffered=2)
[S8] RECEIVED delta(kind=head bytes=1803) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.857877)
[S8] loaded HEAD from S17 (vec_in norm=1.857877)
[S8] cosine check vs S17: cos=0.9999
[S8] BUFFERED delta from S17 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1796) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.778992)
[S15] loaded HEAD from S14 (vec_in norm=1.778992)
[S15] cosine check vs S14: cos=-0.0638
[S15] DROPPED delta from S14 (cos=-0.0638 < 0.0)
[S15] sending update (kind=head size=1801 to 1 peers)
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=45 metric=0.6838 head_norm=1.697260
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.747846e-02
[S6] stored merged vector for next round verification (round=45)
[S6] DEBUG after merge:  round=45 metric=0.6925 head_norm=1.702663 delta_norm=0.027478
[S6] aggregate: ACCEPT kept=['S4', 'S4'] (k=2/2) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.238 → S4@127.0.0.1:31604
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=45 metric=0.9961 head_norm=1.866506
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.620444e-01
[S11] stored merged vector for next round verification (round=45)
[S11] DEBUG after merge:  round=45 metric=0.9961 head_norm=1.898683 delta_norm=0.362044
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.064 → S13@127.0.0.1:31613
[S17] ⇄ pheromone p=0.347 → S8@127.0.0.1:31609
[S14] ⇄ pheromone p=0.006 → S15@127.0.0.1:31615
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=45 metric=0.7099 head_norm=1.997073
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.329040e-02
[S2] stored merged vector for next round verification (round=45)
[S2] DEBUG after merge:  round=45 metric=0.7099 head_norm=2.002981 delta_norm=0.023290
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.103 → S11@127.0.0.1:31612
[S8] sending update (kind=head size=1804 to 1 peers)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=45 metric=0.9398 head_norm=1.713246
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.971875e-02
[S4] stored merged vector for next round verification (round=45)
[S4] DEBUG after merge:  round=45 metric=0.9398 head_norm=1.705013 delta_norm=0.029719
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.047 → S6@127.0.0.1:31607
[S17] RECEIVED delta(kind=head bytes=1804) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.860721)
[S17] loaded HEAD from S8 (vec_in norm=1.860721)
[S17] cosine check vs S8: cos=0.9999
[S17] BUFFERED delta from S8 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1801) from S15
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=2.164870)
[S10] loaded HEAD from S15 (vec_in norm=2.164870)
[S10] cosine check vs S15: cos=-0.1006
[S10] DROPPED delta from S15 (cos=-0.1006 < 0.0)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] ⇄ pheromone p=0.107 → S10@127.0.0.1:31611
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=45 metric=0.9928 head_norm=1.860721
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.337041e-02
[S8] stored merged vector for next round verification (round=45)
[S8] DEBUG after merge:  round=45 metric=0.9928 head_norm=1.859251 delta_norm=0.013370
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.022 → S17@127.0.0.1:31617
[S16] ⇄ pheromone p=0.218 → S2@127.0.0.1:31602
[S10] ⇄ pheromone p=0.001 → S16@127.0.0.1:31616
[S2] START round=46 head_norm_before_train=2.002981 cos_to_last_merge=1.0000 (last merge round=45)
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.7067264160074922, 'auprc': 0.8401760680648527, 'loss_val': 0.4593868345696634, 'psi': 0.7601062768304364}-{'f1_val': 0.7099481022061906, 'auprc': 0.8832181042592306, 'loss_val': 0.44774788819599703, 'psi': 0.7792561030274067}
[S3] START round=46 head_norm_before_train=2.115356 (no previous merge yet)
[S3] round=46 local utility u=0.328902 metrics={'f1_val': 0.9771861274656652, 'auprc': 0.9988072279600186, 'loss_val': 0.07005511274045892, 'psi': 0.9858345676634066}-{'f1_val': 0.8879780837110944, 'auprc': 0.9986707844168166, 'loss_val': 0.19220185135740195, 'psi': 0.9322551639933833}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] sending update (kind=head size=1793 to 1 peers)
[S4] START round=46 head_norm_before_train=1.705013 cos_to_last_merge=1.0000 (last merge round=45)
[S4] round=46 local utility u=0.012273 metrics={'f1_val': 0.941410947046525, 'auprc': 0.9670490606904372, 'loss_val': 0.2847760434474944, 'psi': 0.9516661925040898}-{'f1_val': 0.9398103292037613, 'auprc': 0.9624085767249791, 'loss_val': 0.28579748206117167, 'psi': 0.9488496282122485}
[S5] START round=46 head_norm_before_train=1.566381 cos_to_last_merge=1.0000 (last merge round=45)
[S5] round=46 local utility u=0.000000 metrics={'f1_val': 0.626335710044275, 'auprc': 0.8403893699196451, 'loss_val': 0.5584893465584375, 'psi': 0.711957173994423}-{'f1_val': 0.700320598491359, 'auprc': 0.9697626937097119, 'loss_val': 0.35333378461500975, 'psi': 0.8080974365787001}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=46 head_norm_before_train=1.702663 cos_to_last_merge=1.0000 (last merge round=45)
[S6] round=46 local utility u=1.000000 metrics={'f1_val': 0.9423358099811778, 'auprc': 0.964967309062277, 'loss_val': 0.20240978276198637, 'psi': 0.9513884096136175}-{'f1_val': 0.6837809137838494, 'auprc': 0.911002611464514, 'loss_val': 0.6585673253807627, 'psi': 0.7746695928561153}
[S7] START round=46 head_norm_before_train=1.734109 cos_to_last_merge=0.9929 (last merge round=26)
[S7] round=46 local utility u=0.000000 metrics={'f1_val': 0.5373406050837278, 'auprc': 0.782933422124283, 'loss_val': 0.8578269931743729, 'psi': 0.6355777318999498}-{'f1_val': 0.6589052573296252, 'auprc': 0.8133440937542095, 'loss_val': 0.4143958185076944, 'psi': 0.7206807918994589}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=46 head_norm_before_train=1.859251 cos_to_last_merge=1.0000 (last merge round=45)
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.9927883635805178, 'auprc': 0.9892139690140478, 'loss_val': 0.03993989740921911, 'psi': 0.9913586057539298}-{'f1_val': 0.9928159069878363, 'auprc': 0.9980887460644021, 'loss_val': 0.038491717910159665, 'psi': 0.9949250426184626}
[S9] START round=46 head_norm_before_train=1.886500 cos_to_last_merge=0.7954 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.795
[S9] round=46 local utility u=0.002324 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9981211040881327, 'loss_val': 0.0196226839815842, 'psi': 0.9972447487235879}-{'f1_val': 0.9966605118138915, 'auprc': 0.996680625344408, 'loss_val': 0.019948339693002765, 'psi': 0.996668557226098}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=46 head_norm_before_train=2.023212 cos_to_last_merge=0.9743 (last merge round=19)
[S10] round=46 local utility u=0.000153 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9959925110416152, 'loss_val': 0.024480939704129467, 'psi': 0.9957627965256579}-{'f1_val': 0.9956096535150197, 'auprc': 0.9959841600618872, 'loss_val': 0.02476096347321526, 'psi': 0.9957594561337668}
[S11] START round=46 head_norm_before_train=1.898683 cos_to_last_merge=1.0000 (last merge round=45)
[S11] round=46 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.994500930144957, 'loss_val': 0.09515039471574592, 'psi': 0.9954805770059684}-{'f1_val': 0.9961336749133093, 'auprc': 0.9940012741087567, 'loss_val': 0.05365329731415899, 'psi': 0.9952807145914883}
[S13] START round=46 head_norm_before_train=1.714831 cos_to_last_merge=0.9997 (last merge round=44)
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.5722881647144772, 'auprc': 0.6955717684357174, 'loss_val': 0.8771968598492293, 'psi': 0.6216016062029733}-{'f1_val': 0.6056352624131283, 'auprc': 0.7431969692492227, 'loss_val': 0.7280809922676864, 'psi': 0.6606599451475661}
[S14] START round=46 head_norm_before_train=1.778992 cos_to_last_merge=0.7097 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.710
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.9791004213295806, 'auprc': 0.9991739368986193, 'loss_val': 0.04174167797765349, 'psi': 0.9871298275571961}-{'f1_val': 0.9978195179672185, 'auprc': 0.9992291877445888, 'loss_val': 0.023451120115574313, 'psi': 0.9983833858781666}
[S15] START round=46 head_norm_before_train=2.164870 (no previous merge yet)
[S15] round=46 local utility u=0.000521 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9982639320012223, 'loss_val': 0.01785481120433404, 'psi': 0.9973535738330013}-{'f1_val': 0.9967466683875206, 'auprc': 0.9982639869445006, 'loss_val': 0.018896138324130327, 'psi': 0.9973535958103126}
[S16] START round=46 head_norm_before_train=2.019628 cos_to_last_merge=1.0000 (last merge round=44)
[S16] round=46 local utility u=0.000000 metrics={'f1_val': 0.8629072071269143, 'auprc': 0.9843297327876298, 'loss_val': 0.5893160858004638, 'psi': 0.9114762173912005}-{'f1_val': 0.9241885523255511, 'auprc': 0.9898332952698636, 'loss_val': 0.3451658543404915, 'psi': 0.9504464495032761}
[S17] START round=46 head_norm_before_train=1.857877 cos_to_last_merge=0.9999 (last merge round=43)
[S17] round=46 local utility u=0.000000 metrics={'f1_val': 0.6144148821203641, 'auprc': 0.9504119840248153, 'loss_val': 1.0462798797872506, 'psi': 0.7488137228821445}-{'f1_val': 0.8049678348065662, 'auprc': 0.968384900548314, 'loss_val': 0.48233693894954927, 'psi': 0.8703346611032654}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:31607
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:31604
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:31611
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=46 metric=0.6144 head_norm=1.866669
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.714432e-02
[S17] stored merged vector for next round verification (round=46)
[S17] DEBUG after merge:  round=46 metric=0.6144 head_norm=1.863618 delta_norm=0.017144
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:31616
[S6] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=46 metric=0.5723 head_norm=1.736415
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.611909e-01
[S13] stored merged vector for next round verification (round=46)
[S13] DEBUG after merge:  round=46 metric=0.5719 head_norm=1.795413 delta_norm=0.161191
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S4] RECEIVED delta(kind=head bytes=1798) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.701404)
[S4] loaded HEAD from S6 (vec_in norm=1.701404)
[S4] cosine check vs S6: cos=0.9999
[S4] BUFFERED delta from S6 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1800) from S4
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.718478)
[S6] loaded HEAD from S4 (vec_in norm=1.718478)
[S6] cosine check vs S4: cos=0.9999
[S6] BUFFERED delta from S4 (total buffered=1)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=46 metric=0.9423 head_norm=1.701404
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.634631e-02
[S6] stored merged vector for next round verification (round=46)
[S6] DEBUG after merge:  round=46 metric=0.9425 head_norm=1.709884 delta_norm=0.016346
[S6] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=46 metric=0.9414 head_norm=1.718478
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.634630e-02
[S4] stored merged vector for next round verification (round=46)
[S4] DEBUG after merge:  round=46 metric=0.9414 head_norm=1.709884 delta_norm=0.016346
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S15] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1801) from S15
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=2.172012)
[S10] loaded HEAD from S15 (vec_in norm=2.172012)
[S10] cosine check vs S15: cos=-0.1004
[S10] DROPPED delta from S15 (cos=-0.1004 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1795) from S10
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=2.028815)
[S16] loaded HEAD from S10 (vec_in norm=2.028815)
[S16] cosine check vs S10: cos=0.9996
[S16] BUFFERED delta from S10 (total buffered=1)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=46 metric=0.8629 head_norm=2.026392
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.748828e-02
[S16] stored merged vector for next round verification (round=46)
[S16] DEBUG after merge:  round=46 metric=0.8625 head_norm=2.027418 delta_norm=0.027488
[S16] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=47 head_norm_before_train=2.009131 cos_to_last_merge=1.0000 (last merge round=45)
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.7149549728548432, 'auprc': 0.8482467866339543, 'loss_val': 0.5730986593653856, 'psi': 0.7682716983664877}-{'f1_val': 0.7067264160074922, 'auprc': 0.8401760680648527, 'loss_val': 0.4593868345696634, 'psi': 0.7601062768304364}
[S3] START round=47 head_norm_before_train=2.119966 (no previous merge yet)
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.8184720726311053, 'auprc': 0.9988165292811654, 'loss_val': 0.24623238163905767, 'psi': 0.8906098552911293}-{'f1_val': 0.9771861274656652, 'auprc': 0.9988072279600186, 'loss_val': 0.07005511274045892, 'psi': 0.9858345676634066}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=47 head_norm_before_train=1.709884 cos_to_last_merge=1.0000 (last merge round=46)
[S4] round=47 local utility u=0.022506 metrics={'f1_val': 0.9457900013617474, 'auprc': 0.9710955615322507, 'loss_val': 0.27817884025979106, 'psi': 0.9559122254299488}-{'f1_val': 0.941410947046525, 'auprc': 0.9670490606904372, 'loss_val': 0.2847760434474944, 'psi': 0.9516661925040898}
[S5] START round=47 head_norm_before_train=1.587011 cos_to_last_merge=0.9991 (last merge round=45)
[S5] round=47 local utility u=0.000000 metrics={'f1_val': 0.46190406047378285, 'auprc': 0.8554114943963087, 'loss_val': 0.6950886078487893, 'psi': 0.6193070340427932}-{'f1_val': 0.626335710044275, 'auprc': 0.8403893699196451, 'loss_val': 0.5584893465584375, 'psi': 0.711957173994423}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=47 head_norm_before_train=1.709884 cos_to_last_merge=1.0000 (last merge round=46)
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.8400749670176995, 'auprc': 0.9534797731784893, 'loss_val': 0.46413009189288573, 'psi': 0.8854368894820154}-{'f1_val': 0.9423358099811778, 'auprc': 0.964967309062277, 'loss_val': 0.20240978276198637, 'psi': 0.9513884096136175}
[S7] START round=47 head_norm_before_train=1.744229 cos_to_last_merge=0.9922 (last merge round=26)
[S7] round=47 local utility u=0.252319 metrics={'f1_val': 0.5954279920541489, 'auprc': 0.7878857868269072, 'loss_val': 0.7165698720743883, 'psi': 0.6724111099632523}-{'f1_val': 0.5373406050837278, 'auprc': 0.782933422124283, 'loss_val': 0.8578269931743729, 'psi': 0.6355777318999498}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=47 head_norm_before_train=1.868260 cos_to_last_merge=1.0000 (last merge round=45)
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.9729833356986195, 'auprc': 0.9991009910934695, 'loss_val': 0.07344309542388971, 'psi': 0.9834303978565595}-{'f1_val': 0.9927883635805178, 'auprc': 0.9892139690140478, 'loss_val': 0.03993989740921911, 'psi': 0.9913586057539298}
[S9] START round=47 head_norm_before_train=1.891975 cos_to_last_merge=0.7942 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.794
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.9933237369199828, 'auprc': 0.9984664490929072, 'loss_val': 0.026484740804373273, 'psi': 0.9953808217891524}-{'f1_val': 0.9966605118138915, 'auprc': 0.9981211040881327, 'loss_val': 0.0196226839815842, 'psi': 0.9972447487235879}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=47 head_norm_before_train=2.028815 cos_to_last_merge=0.9738 (last merge round=19)
[S10] round=47 local utility u=0.000825 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9965075023801038, 'loss_val': 0.02437642209878025, 'psi': 0.9959687930610535}-{'f1_val': 0.9956096535150197, 'auprc': 0.9959925110416152, 'loss_val': 0.024480939704129467, 'psi': 0.9957627965256579}
[S11] START round=47 head_norm_before_train=1.927820 cos_to_last_merge=0.9992 (last merge round=45)
[S11] round=47 local utility u=0.020710 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.997250391933943, 'loss_val': 0.06210110498668083, 'psi': 0.9965926416200245}-{'f1_val': 0.9961336749133093, 'auprc': 0.994500930144957, 'loss_val': 0.09515039471574592, 'psi': 0.9954805770059684}
[S13] START round=47 head_norm_before_train=1.795413 cos_to_last_merge=1.0000 (last merge round=46)
[S13] round=47 local utility u=0.000000 metrics={'f1_val': 0.5713065732359346, 'auprc': 0.6946583617376294, 'loss_val': 0.8964296082588038, 'psi': 0.6206472886366126}-{'f1_val': 0.5722881647144772, 'auprc': 0.6955717684357174, 'loss_val': 0.8771968598492293, 'psi': 0.6216016062029733}
[S14] START round=47 head_norm_before_train=1.787563 cos_to_last_merge=0.7091 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.709
[S14] round=47 local utility u=0.064779 metrics={'f1_val': 0.9971907882668205, 'auprc': 0.9994893567613764, 'loss_val': 0.02167269011851886, 'psi': 0.9981102156646429}-{'f1_val': 0.9791004213295806, 'auprc': 0.9991739368986193, 'loss_val': 0.04174167797765349, 'psi': 0.9871298275571961}
[S15] START round=47 head_norm_before_train=2.172012 (no previous merge yet)
[S15] round=47 local utility u=0.000000 metrics={'f1_val': 0.8829378921613034, 'auprc': 0.996862088315505, 'loss_val': 0.34093682271343967, 'psi': 0.928507570622984}-{'f1_val': 0.9967466683875206, 'auprc': 0.9982639320012223, 'loss_val': 0.01785481120433404, 'psi': 0.9973535738330013}
[S16] START round=47 head_norm_before_train=2.027418 cos_to_last_merge=1.0000 (last merge round=46)
[S16] round=47 local utility u=0.000000 metrics={'f1_val': 0.8571924337244811, 'auprc': 0.9840157353269615, 'loss_val': 0.6493910899554866, 'psi': 0.9079217543654733}-{'f1_val': 0.8629072071269143, 'auprc': 0.9843297327876298, 'loss_val': 0.5893160858004638, 'psi': 0.9114762173912005}
[S17] START round=47 head_norm_before_train=1.863618 cos_to_last_merge=1.0000 (last merge round=46)
[S17] round=47 local utility u=0.699158 metrics={'f1_val': 0.778285185393185, 'auprc': 0.932619781166627, 'loss_val': 0.5778089961810758, 'psi': 0.8400190237025618}-{'f1_val': 0.6144148821203641, 'auprc': 0.9504119840248153, 'loss_val': 1.0462798797872506, 'psi': 0.7488137228821445}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:31615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:31607
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:31609
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:31613
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1802 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:31616
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1796) from S4
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.720386)
[S6] loaded HEAD from S4 (vec_in norm=1.720386)
[S6] cosine check vs S4: cos=0.9998
[S6] BUFFERED delta from S4 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1797) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.796208)
[S15] loaded HEAD from S14 (vec_in norm=1.796208)
[S15] cosine check vs S14: cos=-0.0636
[S15] DROPPED delta from S14 (cos=-0.0636 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1802) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.870968)
[S8] loaded HEAD from S17 (vec_in norm=1.870968)
[S8] cosine check vs S17: cos=0.9999
[S8] BUFFERED delta from S17 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1797) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.963872)
[S13] loaded HEAD from S11 (vec_in norm=1.963872)
[S13] cosine check vs S11: cos=0.9781
[S13] BUFFERED delta from S11 (total buffered=1)
[S10] sending update (kind=head size=1800 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1800) from S10
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=2.031919)
[S16] loaded HEAD from S10 (vec_in norm=2.031919)
[S16] cosine check vs S10: cos=0.9998
[S16] BUFFERED delta from S10 (total buffered=1)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=47 metric=0.9730 head_norm=1.878565
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.257308e-02
[S8] stored merged vector for next round verification (round=47)
[S8] DEBUG after merge:  round=47 metric=0.9730 head_norm=1.874728 delta_norm=0.012573
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=47 metric=0.8572 head_norm=2.035170
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.275757e-02
[S16] stored merged vector for next round verification (round=47)
[S16] DEBUG after merge:  round=47 metric=0.8572 head_norm=2.033418 delta_norm=0.022758
[S16] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=48 head_norm_before_train=2.016050 cos_to_last_merge=0.9999 (last merge round=45)
[S2] round=48 local utility u=0.003350 metrics={'f1_val': 0.714686626256712, 'auprc': 0.8372017809833581, 'loss_val': 0.5316535060015456, 'psi': 0.7636926881473705}-{'f1_val': 0.7149549728548432, 'auprc': 0.8482467866339543, 'loss_val': 0.5730986593653856, 'psi': 0.7682716983664877}
[S3] START round=48 head_norm_before_train=2.124650 (no previous merge yet)
[S3] round=48 local utility u=0.097499 metrics={'f1_val': 0.856524351355501, 'auprc': 0.9983533609297639, 'loss_val': 0.2781589177258828, 'psi': 0.9132559551852062}-{'f1_val': 0.8184720726311053, 'auprc': 0.9988165292811654, 'loss_val': 0.24623238163905767, 'psi': 0.8906098552911293}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] sending update (kind=head size=1793 to 1 peers)
[S4] START round=48 head_norm_before_train=1.720386 cos_to_last_merge=1.0000 (last merge round=46)
[S4] round=48 local utility u=0.009842 metrics={'f1_val': 0.9475647212056972, 'auprc': 0.9731016794899063, 'loss_val': 0.2751607188853512, 'psi': 0.9577795045193809}-{'f1_val': 0.9457900013617474, 'auprc': 0.9710955615322507, 'loss_val': 0.27817884025979106, 'psi': 0.9559122254299488}
[S5] START round=48 head_norm_before_train=1.606610 cos_to_last_merge=0.9971 (last merge round=45)
[S5] round=48 local utility u=0.000000 metrics={'f1_val': 0.43676623050537206, 'auprc': 0.8552420707827825, 'loss_val': 0.8094508451774218, 'psi': 0.6041565666163362}-{'f1_val': 0.46190406047378285, 'auprc': 0.8554114943963087, 'loss_val': 0.6950886078487893, 'psi': 0.6193070340427932}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=48 head_norm_before_train=1.709271 cos_to_last_merge=0.9999 (last merge round=46)
[S6] round=48 local utility u=0.000000 metrics={'f1_val': 0.5958515729795333, 'auprc': 0.9279668458642881, 'loss_val': 0.8945887990972653, 'psi': 0.7286976821334352}-{'f1_val': 0.8400749670176995, 'auprc': 0.9534797731784893, 'loss_val': 0.46413009189288573, 'psi': 0.8854368894820154}
[S7] START round=48 head_norm_before_train=1.751764 cos_to_last_merge=0.9917 (last merge round=26)
[S7] round=48 local utility u=0.631430 metrics={'f1_val': 0.6876852140890628, 'auprc': 0.8679271315316057, 'loss_val': 0.2473770588796532, 'psi': 0.75978198106608}-{'f1_val': 0.5954279920541489, 'auprc': 0.7878857868269072, 'loss_val': 0.7165698720743883, 'psi': 0.6724111099632523}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S7] sending update (kind=head size=1809 to 1 peers)
[S8] START round=48 head_norm_before_train=1.874728 cos_to_last_merge=1.0000 (last merge round=47)
[S8] round=48 local utility u=0.012425 metrics={'f1_val': 0.9843491124278163, 'auprc': 0.9863734143947642, 'loss_val': 0.07860587048581136, 'psi': 0.9851588332145955}-{'f1_val': 0.9729833356986195, 'auprc': 0.9991009910934695, 'loss_val': 0.07344309542388971, 'psi': 0.9834303978565595}
[S9] START round=48 head_norm_before_train=1.898992 cos_to_last_merge=0.7931 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.793
[S9] round=48 local utility u=0.011049 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9956072459847416, 'loss_val': 0.018484821384141526, 'psi': 0.9965046459011824}-{'f1_val': 0.9933237369199828, 'auprc': 0.9984664490929072, 'loss_val': 0.026484740804373273, 'psi': 0.9953808217891524}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=48 head_norm_before_train=2.031919 cos_to_last_merge=0.9731 (last merge round=19)
[S10] round=48 local utility u=0.000000 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9961789980504825, 'loss_val': 0.02421772418763606, 'psi': 0.9958373913292049}-{'f1_val': 0.9956096535150197, 'auprc': 0.9965075023801038, 'loss_val': 0.02437642209878025, 'psi': 0.9959687930610535}
[S11] START round=48 head_norm_before_train=1.963872 cos_to_last_merge=0.9966 (last merge round=45)
[S11] round=48 local utility u=0.007399 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.996882273830424, 'loss_val': 0.04619967136185261, 'psi': 0.9964453943786169}-{'f1_val': 0.9961541414107454, 'auprc': 0.997250391933943, 'loss_val': 0.06210110498668083, 'psi': 0.9965926416200245}
[S13] START round=48 head_norm_before_train=1.814365 cos_to_last_merge=0.9997 (last merge round=46)
[S13] round=48 local utility u=0.170226 metrics={'f1_val': 0.610761912552508, 'auprc': 0.6756015485659956, 'loss_val': 0.735539344211949, 'psi': 0.636697766957903}-{'f1_val': 0.5713065732359346, 'auprc': 0.6946583617376294, 'loss_val': 0.8964296082588038, 'psi': 0.6206472886366126}
[S14] START round=48 head_norm_before_train=1.796208 cos_to_last_merge=0.7084 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.708
[S14] round=48 local utility u=0.001337 metrics={'f1_val': 0.9979900342899044, 'auprc': 0.9994249096437544, 'loss_val': 0.023600969762262884, 'psi': 0.9985639844314445}-{'f1_val': 0.9971907882668205, 'auprc': 0.9994893567613764, 'loss_val': 0.02167269011851886, 'psi': 0.9981102156646429}
[S15] START round=48 head_norm_before_train=2.179224 (no previous merge yet)
[S15] round=48 local utility u=0.183301 metrics={'f1_val': 0.9096156150906487, 'auprc': 0.9984739862361578, 'loss_val': 0.13923666661641232, 'psi': 0.9451589635488524}-{'f1_val': 0.8829378921613034, 'auprc': 0.996862088315505, 'loss_val': 0.34093682271343967, 'psi': 0.928507570622984}
[S16] START round=48 head_norm_before_train=2.033418 cos_to_last_merge=1.0000 (last merge round=47)
[S16] round=48 local utility u=0.000000 metrics={'f1_val': 0.8389610285365825, 'auprc': 0.9776748318320774, 'loss_val': 0.9070900119368844, 'psi': 0.8944465498547804}-{'f1_val': 0.8571924337244811, 'auprc': 0.9840157353269615, 'loss_val': 0.6493910899554866, 'psi': 0.9079217543654733}
[S17] START round=48 head_norm_before_train=1.870968 cos_to_last_merge=1.0000 (last merge round=46)
[S17] round=48 local utility u=0.000000 metrics={'f1_val': 0.5969347857924867, 'auprc': 0.8482758798896488, 'loss_val': 1.1129903765069122, 'psi': 0.6974712234313516}-{'f1_val': 0.778285185393185, 'auprc': 0.932619781166627, 'loss_val': 0.5778089961810758, 'psi': 0.8400190237025618}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:31615
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:31607
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1799 to 1 peers)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=48 metric=0.5959 head_norm=1.710599
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.250412e-02
[S6] stored merged vector for next round verification (round=48)
[S6] DEBUG after merge:  round=48 metric=0.5958 head_norm=1.715352 delta_norm=0.022504
[S6] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:31617
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=48 metric=0.6108 head_norm=1.831921
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.236632e-01
[S13] stored merged vector for next round verification (round=48)
[S13] DEBUG after merge:  round=48 metric=0.6108 head_norm=1.885826 delta_norm=0.223663
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S4] sending update (kind=head size=1796 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:31611
[S6] RECEIVED delta(kind=head bytes=1796) from S4
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.731944)
[S6] loaded HEAD from S4 (vec_in norm=1.731944)
[S6] cosine check vs S4: cos=0.9998
[S6] BUFFERED delta from S4 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1799) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.802686)
[S15] loaded HEAD from S14 (vec_in norm=1.802686)
[S15] cosine check vs S14: cos=-0.0637
[S15] DROPPED delta from S14 (cos=-0.0637 < 0.0)
[S8] sending update (kind=head size=1805 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1805) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.882006)
[S17] loaded HEAD from S8 (vec_in norm=1.882006)
[S17] cosine check vs S8: cos=0.9999
[S17] BUFFERED delta from S8 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1799) from S15
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=2.185827)
[S10] loaded HEAD from S15 (vec_in norm=2.185827)
[S10] cosine check vs S15: cos=-0.1002
[S10] DROPPED delta from S15 (cos=-0.1002 < 0.0)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=49 head_norm_before_train=2.022771 cos_to_last_merge=0.9999 (last merge round=45)
[S2] round=49 local utility u=0.033552 metrics={'f1_val': 0.7105990683030684, 'auprc': 0.8500348157399414, 'loss_val': 0.47852245155784356, 'psi': 0.7663733672778177}-{'f1_val': 0.714686626256712, 'auprc': 0.8372017809833581, 'loss_val': 0.5316535060015456, 'psi': 0.7636926881473705}
[S3] START round=49 head_norm_before_train=2.131744 (no previous merge yet)
[S3] round=49 local utility u=0.523603 metrics={'f1_val': 0.9917732559041705, 'auprc': 0.9987873616658008, 'loss_val': 0.04374794735373044, 'psi': 0.9945788982088226}-{'f1_val': 0.856524351355501, 'auprc': 0.9983533609297639, 'loss_val': 0.2781589177258828, 'psi': 0.9132559551852062}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S4] START round=49 head_norm_before_train=1.731944 cos_to_last_merge=0.9999 (last merge round=46)
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.947075363965194, 'auprc': 0.9712017272672263, 'loss_val': 0.280967175182832, 'psi': 0.9567259092860069}-{'f1_val': 0.9475647212056972, 'auprc': 0.9731016794899063, 'loss_val': 0.2751607188853512, 'psi': 0.9577795045193809}
[S5] START round=49 head_norm_before_train=1.622466 cos_to_last_merge=0.9952 (last merge round=45)
[S5] round=49 local utility u=1.000000 metrics={'f1_val': 0.6750678059155606, 'auprc': 0.9561516887192997, 'loss_val': 0.32649358498529724, 'psi': 0.7875013590370563}-{'f1_val': 0.43676623050537206, 'auprc': 0.8552420707827825, 'loss_val': 0.8094508451774218, 'psi': 0.6041565666163362}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=49 head_norm_before_train=1.715352 cos_to_last_merge=1.0000 (last merge round=48)
[S6] round=49 local utility u=1.000000 metrics={'f1_val': 0.8473488897813091, 'auprc': 0.9437502679841733, 'loss_val': 0.3833843552969475, 'psi': 0.8859094410624547}-{'f1_val': 0.5958515729795333, 'auprc': 0.9279668458642881, 'loss_val': 0.8945887990972653, 'psi': 0.7286976821334352}
[S7] START round=49 head_norm_before_train=1.759358 cos_to_last_merge=0.9911 (last merge round=26)
[S7] round=49 local utility u=0.000000 metrics={'f1_val': 0.6193440036848246, 'auprc': 0.797870842697637, 'loss_val': 0.5545536296169296, 'psi': 0.6907547392899496}-{'f1_val': 0.6876852140890628, 'auprc': 0.8679271315316057, 'loss_val': 0.2473770588796532, 'psi': 0.75978198106608}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=49 head_norm_before_train=1.882006 cos_to_last_merge=1.0000 (last merge round=47)
[S8] round=49 local utility u=0.060717 metrics={'f1_val': 0.9920979054933599, 'auprc': 0.9981802466919286, 'loss_val': 0.039085576243839376, 'psi': 0.9945308419727874}-{'f1_val': 0.9843491124278163, 'auprc': 0.9863734143947642, 'loss_val': 0.07860587048581136, 'psi': 0.9851588332145955}
[S9] START round=49 head_norm_before_train=1.905552 cos_to_last_merge=0.7924 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.792
[S9] round=49 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9939706902382142, 'loss_val': 0.019326912587601865, 'psi': 0.995603770854143}-{'f1_val': 0.9971029125121428, 'auprc': 0.9956072459847416, 'loss_val': 0.018484821384141526, 'psi': 0.9965046459011824}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=49 head_norm_before_train=2.037929 cos_to_last_merge=0.9727 (last merge round=19)
[S10] round=49 local utility u=0.000488 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9964315003976716, 'loss_val': 0.024000046146885418, 'psi': 0.9959383922680805}-{'f1_val': 0.9956096535150197, 'auprc': 0.9961789980504825, 'loss_val': 0.02421772418763606, 'psi': 0.9958373913292049}
[S11] START round=49 head_norm_before_train=1.998464 cos_to_last_merge=0.9934 (last merge round=45)
[S11] round=49 local utility u=0.003994 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9968838743632689, 'loss_val': 0.03821664039613398, 'psi': 0.9964460345917547}-{'f1_val': 0.9961541414107454, 'auprc': 0.996882273830424, 'loss_val': 0.04619967136185261, 'psi': 0.9964453943786169}
[S13] START round=49 head_norm_before_train=1.885826 cos_to_last_merge=1.0000 (last merge round=48)
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.5824576104641994, 'auprc': 0.6921300069603791, 'loss_val': 0.7913576437681996, 'psi': 0.6263265690626713}-{'f1_val': 0.610761912552508, 'auprc': 0.6756015485659956, 'loss_val': 0.735539344211949, 'psi': 0.636697766957903}
[S14] START round=49 head_norm_before_train=1.802686 cos_to_last_merge=0.7075 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.708
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.9748908146954419, 'auprc': 0.9990616343239451, 'loss_val': 0.04578132289646989, 'psi': 0.9845591425468432}-{'f1_val': 0.9979900342899044, 'auprc': 0.9994249096437544, 'loss_val': 0.023600969762262884, 'psi': 0.9985639844314445}
[S15] START round=49 head_norm_before_train=2.185827 (no previous merge yet)
[S15] round=49 local utility u=0.324644 metrics={'f1_val': 0.9975479273409924, 'auprc': 0.9993423067296445, 'loss_val': 0.020147148703036508, 'psi': 0.9982656790964533}-{'f1_val': 0.9096156150906487, 'auprc': 0.9984739862361578, 'loss_val': 0.13923666661641232, 'psi': 0.9451589635488524}
[S16] START round=49 head_norm_before_train=2.040845 cos_to_last_merge=1.0000 (last merge round=47)
[S16] round=49 local utility u=0.082708 metrics={'f1_val': 0.8489276254991938, 'auprc': 0.9762648886542409, 'loss_val': 0.7972433713063499, 'psi': 0.8998625307612127}-{'f1_val': 0.8389610285365825, 'auprc': 0.9776748318320774, 'loss_val': 0.9070900119368844, 'psi': 0.8944465498547804}
[S17] START round=49 head_norm_before_train=1.877550 cos_to_last_merge=1.0000 (last merge round=46)
[S17] round=49 local utility u=0.022600 metrics={'f1_val': 0.6004423231510791, 'auprc': 0.8273808860533186, 'loss_val': 1.026151539031697, 'psi': 0.691217748311975}-{'f1_val': 0.5969347857924867, 'auprc': 0.8482758798896488, 'loss_val': 1.1129903765069122, 'psi': 0.6974712234313516}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:31604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:31609
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:31611
[S17] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:31615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:31617
[S4] RECEIVED delta(kind=head bytes=1802) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.719805)
[S4] loaded HEAD from S6 (vec_in norm=1.719805)
[S4] cosine check vs S6: cos=0.9996
[S4] BUFFERED delta from S6 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1799) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.886041)
[S8] loaded HEAD from S17 (vec_in norm=1.886041)
[S8] cosine check vs S17: cos=0.9998
[S8] BUFFERED delta from S17 (total buffered=1)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=49 metric=0.8473 head_norm=1.719805
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.058450e-02
[S6] stored merged vector for next round verification (round=49)
[S6] DEBUG after merge:  round=49 metric=0.8473 head_norm=1.725763 delta_norm=0.020584
[S6] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S8] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=49 metric=0.6004 head_norm=1.886041
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.641978e-02
[S17] stored merged vector for next round verification (round=49)
[S17] DEBUG after merge:  round=49 metric=0.6004 head_norm=1.883953 delta_norm=0.016420
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] sending update (kind=head size=1803 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1799) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.889156)
[S17] loaded HEAD from S8 (vec_in norm=1.889156)
[S17] cosine check vs S8: cos=0.9999
[S17] BUFFERED delta from S8 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1797) from S10
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=2.045830)
[S15] loaded HEAD from S10 (vec_in norm=2.045830)
[S15] cosine check vs S10: cos=-0.1001
[S15] DROPPED delta from S10 (cos=-0.1001 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1803) from S15
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=2.192268)
[S10] loaded HEAD from S15 (vec_in norm=2.192268)
[S10] cosine check vs S15: cos=-0.1001
[S10] DROPPED delta from S15 (cos=-0.1001 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S10@127.0.0.1:31611
[S16] sending update (kind=head size=1794 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1794) from S16
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=2.046792)
[S10] loaded HEAD from S16 (vec_in norm=2.046792)
[S10] cosine check vs S16: cos=0.9998
[S10] BUFFERED delta from S16 (total buffered=1)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=49 metric=0.9956 head_norm=2.045830
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.169186e-02
[S10] stored merged vector for next round verification (round=49)
[S10] DEBUG after merge:  round=49 metric=0.9956 head_norm=2.046196 delta_norm=0.021692
[S10] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=49 metric=0.9921 head_norm=1.889156
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.041506e-02
[S8] stored merged vector for next round verification (round=49)
[S8] DEBUG after merge:  round=49 metric=0.9921 head_norm=1.887489 delta_norm=0.020415
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[runner] rounds complete.
[runner] all agents stopped.
