[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:57003
[S3] → join 127.0.0.1:57002
[S4] → join 127.0.0.1:57002
[S5] → join 127.0.0.1:57002
[S6] → join 127.0.0.1:57002
[S7] → join 127.0.0.1:57002
[S8] → join 127.0.0.1:57002
[S9] → join 127.0.0.1:57002
[S10] → join 127.0.0.1:57002
[S11] → join 127.0.0.1:57002
[S13] → join 127.0.0.1:57002
[S14] → join 127.0.0.1:57002
[S15] → join 127.0.0.1:57002
[S16] → join 127.0.0.1:57002
[S17] → join 127.0.0.1:57002
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.172369 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.208584 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.180222 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.168243 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.181133 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.154143 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.128024 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.184547 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.201168 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.146273 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.101298 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.202543 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.170636 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.172864 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.148490 (no previous merge yet)
[S15]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S3] + discovered S15
[S3] + discovered S14
[S3] + discovered S8
[S3] + discovered S4
[S3] + discovered S9
[S3] + discovered S13
[S3] + discovered S7
[S3] + discovered S5
[S3] + discovered S6
[S4] + discovered S3
[S4] + discovered S2
[S3] + discovered S11
[S3] + discovered S10
[S3] + discovered S16
[S3] + discovered S17
[S5] + discovered S3
[S5] + discovered S2
[S4] + discovered S11
[S5] + discovered S4
[S4] + discovered S17
[S4] + discovered S10
[S4] + discovered S16
[S4] + discovered S15
[S4] + discovered S14
[S4] + discovered S8
[S4] + discovered S7
[S4] + discovered S9
[S4] + discovered S13
[S4] + discovered S6
[S4] + discovered S5
[S5] + discovered S9
[S5] + discovered S15
[S5] + discovered S13
[S5] + discovered S8
[S5] + discovered S16
[S5] + discovered S10
[S5] + discovered S17
[S5] + discovered S6
[S5] + discovered S7
[S5] + discovered S14
[S5] + discovered S11
[S6] + discovered S5
[S6] + discovered S4
[S6] + discovered S2
[S6] + discovered S3
[S7] + discovered S3
[S7] + discovered S2
[S7] + discovered S4
[S7] + discovered S6
[S7] + discovered S5
[S6] + discovered S17
[S6] + discovered S8
[S6] + discovered S15
[S6] + discovered S11
[S6] + discovered S16
[S6] + discovered S14
[S6] + discovered S7
[S6] + discovered S10
[S6] + discovered S13
[S6] + discovered S9
[S8] + discovered S7
[S8] + discovered S2
[S8] + discovered S3
[S8] + discovered S4
[S8] + discovered S5
[S8] + discovered S6
[S7] + discovered S13
[S7] + discovered S10
[S7] + discovered S14
[S7] + discovered S11
[S7] + discovered S17
[S7] + discovered S9
[S7] + discovered S16
[S7] + discovered S15
[S7] + discovered S8
[S9] + discovered S8
[S9] + discovered S5
[S9] + discovered S6
[S9] + discovered S2
[S9] + discovered S4
[S9] + discovered S3
[S9] + discovered S7
[S8] + discovered S15
[S8] + discovered S9
[S8] + discovered S17
[S8] + discovered S14
[S8] + discovered S10
[S8] + discovered S16
[S8] + discovered S11
[S8] + discovered S13
[S9] + discovered S10
[S9] + discovered S16
[S9] + discovered S13
[S9] + discovered S14
[S9] + discovered S11
[S9] + discovered S17
[S9] + discovered S15
[S10] + discovered S4
[S10] + discovered S2
[S10] + discovered S8
[S10] + discovered S7
[S10] + discovered S3
[S10] + discovered S9
[S10] + discovered S6
[S10] + discovered S5
[S10] + discovered S17
[S10] + discovered S11
[S10] + discovered S16
[S10] + discovered S15
[S10] + discovered S14
[S10] + discovered S13
[S11] + discovered S9
[S11] + discovered S7
[S11] + discovered S10
[S11] + discovered S2
[S11] + discovered S5
[S11] + discovered S8
[S11] + discovered S6
[S11] + discovered S3
[S11] + discovered S4
[S13] + discovered S4
[S13] + discovered S8
[S13] + discovered S3
[S13] + discovered S5
[S13] + discovered S2
[S13] + discovered S6
[S13] + discovered S7
[S13] + discovered S10
[S13] + discovered S11
[S13] + discovered S9
[S11] + discovered S16
[S11] + discovered S17
[S11] + discovered S13
[S11] + discovered S14
[S11] + discovered S15
[S13] + discovered S14
[S13] + discovered S15
[S13] + discovered S17
[S13] + discovered S16
[S14] + discovered S11
[S14] + discovered S10
[S14] + discovered S13
[S14] + discovered S6
[S14] + discovered S2
[S14] + discovered S8
[S14] + discovered S4
[S14] + discovered S9
[S14] + discovered S3
[S14] + discovered S7
[S14] + discovered S5
[S15] + discovered S5
[S15] + discovered S7
[S15] + discovered S3
[S15] + discovered S8
[S15] + discovered S6
[S15] + discovered S14
[S15] + discovered S11
[S15] + discovered S9
[S15] + discovered S4
[S15] + discovered S2
[S15] + discovered S13
[S15] + discovered S10
[S14] + discovered S16
[S14] + discovered S17
[S14] + discovered S15
[S16] + discovered S5
[S16] + discovered S2
[S16] + discovered S15
[S16] + discovered S9
[S16] + discovered S6
[S16] + discovered S13
[S16] + discovered S7
[S16] + discovered S10
[S16] + discovered S11
[S16] + discovered S4
[S16] + discovered S14
[S16] + discovered S8
[S16] + discovered S3
[S15] + discovered S17
[S15] + discovered S16
[S16] + discovered S17
[S17] + discovered S3
[S17] + discovered S8
[S17] + discovered S11
[S17] + discovered S7
[S17] + discovered S6
[S17] + discovered S5
[S17] + discovered S2
[S17] + discovered S16
[S17] + discovered S10
[S17] + discovered S14
[S17] + discovered S4
[S17] + discovered S13
[S17] + discovered S9
[S17] + discovered S15
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] ⇄ pheromone p=1.000 → S9@127.0.0.1:57010
[S7] ⇄ pheromone p=1.000 → S15@127.0.0.1:57015
[S14] ⇄ pheromone p=1.000 → S6@127.0.0.1:57007
[S3] ⇄ pheromone p=1.000 → S15@127.0.0.1:57015
[S8] ⇄ pheromone p=1.000 → S3@127.0.0.1:57003
[S2] ⇄ pheromone p=1.000 → S10@127.0.0.1:57011
[S13] ⇄ pheromone p=1.000 → S15@127.0.0.1:57015
[S11] ⇄ pheromone p=1.000 → S7@127.0.0.1:57008
[S15] ⇄ pheromone p=1.000 → S10@127.0.0.1:57011
[S10] ⇄ pheromone p=1.000 → S7@127.0.0.1:57008
[S9] ⇄ pheromone p=1.000 → S3@127.0.0.1:57003
[S16] ⇄ pheromone p=1.000 → S6@127.0.0.1:57007
[S4] ⇄ pheromone p=1.000 → S2@127.0.0.1:57002
[S6] ⇄ pheromone p=1.000 → S8@127.0.0.1:57009
[S17] ⇄ pheromone p=1.000 → S8@127.0.0.1:57009
[S2] START round=1 head_norm_before_train=1.172861 (no previous merge yet)
[S2] round=1 local utility u=0.199746 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.5233254543312101, 'loss_val': 1.3135207569770062, 'psi': 0.2943964617656241}-{'f1_val': 0.1417771333885667, 'auprc': 0.39994584944273814, 'loss_val': 1.3428748992127246, 'psi': 0.2450446198102353}
[S3] START round=1 head_norm_before_train=1.220126 (no previous merge yet)
[S3] round=1 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.803336879088276, 'loss_val': 1.2582586078948936, 'psi': 0.4052387910037747}-{'f1_val': 0.13984006561410703, 'auprc': 0.9945962976592873, 'loss_val': 1.3173600570400572, 'psi': 0.48174255843217917}
[S4] START round=1 head_norm_before_train=1.186980 (no previous merge yet)
[S4] round=1 local utility u=0.017015 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7792442963586352, 'loss_val': 1.2976296971190646, 'psi': 0.3958336958805646}-{'f1_val': 0.14022662889518414, 'auprc': 0.7790963772748031, 'loss_val': 1.3312158019455462, 'psi': 0.39577452824703174}
[S5] START round=1 head_norm_before_train=1.184273 (no previous merge yet)
[S5] round=1 local utility u=0.036473 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7307482180489486, 'loss_val': 1.249468430565943, 'psi': 0.37765643007672234}-{'f1_val': 0.14226190476190476, 'auprc': 0.7289120394568355, 'loss_val': 1.3169062505712683, 'psi': 0.37692195863987704}
[S6] START round=1 head_norm_before_train=1.183242 (no previous merge yet)
[S6] round=1 local utility u=0.100674 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.7380178344654047, 'loss_val': 1.3243972565970301, 'psi': 0.3800629030169311}-{'f1_val': 0.14142628205128205, 'auprc': 0.6832516980290643, 'loss_val': 1.3614470107525067, 'psi': 0.3581564484423949}
[S7] START round=1 head_norm_before_train=1.173235 (no previous merge yet)
[S7] round=1 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.776565946409005, 'loss_val': 1.248600972951119, 'psi': 0.395860472201057}-{'f1_val': 0.39365462501836423, 'auprc': 0.789864024576669, 'loss_val': 1.3154208866264292, 'psi': 0.5521383848416862}
[S8] START round=1 head_norm_before_train=1.136525 (no previous merge yet)
[S8] round=1 local utility u=1.000000 metrics={'f1_val': 0.42257860386146096, 'auprc': 0.7701969662558719, 'loss_val': 1.3297527794004402, 'psi': 0.5616259488192253}-{'f1_val': 0.10450549450549451, 'auprc': 0.5390411597144068, 'loss_val': 1.3684688736152575, 'psi': 0.27831976058905944}
[S9] START round=1 head_norm_before_train=1.195205 (no previous merge yet)
[S9] round=1 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.6684257918189971, 'loss_val': 1.1874506804504161, 'psi': 0.3522090910115965}-{'f1_val': 0.6925134971301379, 'auprc': 0.6958529773761615, 'loss_val': 1.3148048162199095, 'psi': 0.6938492892285473}
[S10] START round=1 head_norm_before_train=1.201974 (no previous merge yet)
[S10] round=1 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.5674696792907674, 'loss_val': 1.3416472252512772, 'psi': 0.3101608542413413}-{'f1_val': 0.37770158398233067, 'auprc': 0.4456701615381569, 'loss_val': 1.364784090093354, 'psi': 0.4048890150046612}
[S11] START round=1 head_norm_before_train=1.154918 (no previous merge yet)
[S11] round=1 local utility u=0.316922 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7829768247412967, 'loss_val': 1.329629658627964, 'psi': 0.39743893992038504}-{'f1_val': 0.10281904155013957, 'auprc': 0.6598046634111575, 'loss_val': 1.3683899824868855, 'psi': 0.3256132902945467}
[S13] START round=1 head_norm_before_train=1.113191 (no previous merge yet)
[S13] round=1 local utility u=0.065280 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5813818995772304, 'loss_val': 1.3063154925544618, 'psi': 0.31678421737712403}-{'f1_val': 0.1403857625770531, 'auprc': 0.550855637628323, 'loss_val': 1.3452976888205432, 'psi': 0.30457371259756105}
[S14] START round=1 head_norm_before_train=1.196132 (no previous merge yet)
[S14] round=1 local utility u=1.000000 metrics={'f1_val': 0.4186757736667809, 'auprc': 0.6117696532588655, 'loss_val': 1.361070267002099, 'psi': 0.49591332550361467}-{'f1_val': 0.05498154981549815, 'auprc': 0.5814937096207088, 'loss_val': 1.387912939363888, 'psi': 0.2655864137375824}
[S15] START round=1 head_norm_before_train=1.168390 (no previous merge yet)
[S15] round=1 local utility u=0.400663 metrics={'f1_val': 0.42146491725524565, 'auprc': 0.7667313137439542, 'loss_val': 1.3425138545137878, 'psi': 0.5595714758507291}-{'f1_val': 0.39088139056817217, 'auprc': 0.5696861622734447, 'loss_val': 1.3692030397070665, 'psi': 0.46240329925028123}
[S16] START round=1 head_norm_before_train=1.183853 (no previous merge yet)
[S16] round=1 local utility u=0.221649 metrics={'f1_val': 0.16674567433041004, 'auprc': 0.7894611541377228, 'loss_val': 1.319097610609189, 'psi': 0.4158318662533351}-{'f1_val': 0.10355329160942534, 'auprc': 0.7809873828323376, 'loss_val': 1.3578201955067764, 'psi': 0.3745269280985903}
[S17] START round=1 head_norm_before_train=1.149236 (no previous merge yet)
[S17] round=1 local utility u=0.511813 metrics={'f1_val': 0.15198744232409492, 'auprc': 0.5597980324531642, 'loss_val': 1.3524900656003667, 'psi': 0.3151116783757226}-{'f1_val': 0.09718183851487364, 'auprc': 0.33532933364253004, 'loss_val': 1.3738754397249902, 'psi': 0.1924408365659362}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S17@127.0.0.1:57017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S8] → sending delta(kind=head bytes=1787) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S2] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:57017
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S14] → sending delta(kind=head bytes=1786) to S4@127.0.0.1:57004
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:57017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S13] → sending delta(kind=head bytes=1790) to S16@127.0.0.1:57016
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S15] → sending delta(kind=head bytes=1791) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:57015
[S15] sending update (kind=head size=1791 to 1 peers)
[S13] sending update (kind=head size=1790 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1793 to 1 peers)
[S14] sending update (kind=head size=1786 to 1 peers)
[S2] sending update (kind=head size=1792 to 1 peers)
[S8] sending update (kind=head size=1787 to 1 peers)
[S4] sending update (kind=head size=1793 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1799) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.205414)
[S7] loaded HEAD from S16 (vec_in norm=1.205414)
[S7] cosine check vs S16: cos=0.0796
[S7] BUFFERED delta from S16 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1790) from S13
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.139064)
[S16] loaded HEAD from S13 (vec_in norm=1.139064)
[S16] cosine check vs S13: cos=0.0362
[S16] BUFFERED delta from S13 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1791) from S15
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.176455)
[S6] loaded HEAD from S15 (vec_in norm=1.176455)
[S6] cosine check vs S15: cos=-0.0870
[S6] DROPPED delta from S15 (cos=-0.0870 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1797) from S5
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.219631)
[S6] loaded HEAD from S5 (vec_in norm=1.219631)
[S6] cosine check vs S5: cos=0.0270
[S6] BUFFERED delta from S5 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1786) from S14
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.204420)
[S4] loaded HEAD from S14 (vec_in norm=1.204420)
[S4] cosine check vs S14: cos=-0.0120
[S4] DROPPED delta from S14 (cos=-0.0120 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1793) from S6
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.195216)
[S15] loaded HEAD from S6 (vec_in norm=1.195216)
[S15] cosine check vs S6: cos=-0.0870
[S15] DROPPED delta from S6 (cos=-0.0870 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1796) from S11
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.168833)
[S17] loaded HEAD from S11 (vec_in norm=1.168833)
[S17] cosine check vs S11: cos=-0.0648
[S17] DROPPED delta from S11 (cos=-0.0648 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1787) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.154261)
[S15] loaded HEAD from S8 (vec_in norm=1.154261)
[S15] cosine check vs S8: cos=-0.0192
[S15] DROPPED delta from S8 (cos=-0.0192 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1792) from S2
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.183501)
[S17] loaded HEAD from S2 (vec_in norm=1.183501)
[S17] cosine check vs S2: cos=-0.0005
[S17] DROPPED delta from S2 (cos=-0.0005 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1793) from S4
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.203446)
[S17] loaded HEAD from S4 (vec_in norm=1.203446)
[S17] cosine check vs S4: cos=0.0270
[S17] BUFFERED delta from S4 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S17] → sending delta(kind=head bytes=1791) to S11@127.0.0.1:57012
[S17] sending update (kind=head size=1791 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1791) from S17
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.158942)
[S11] loaded HEAD from S17 (vec_in norm=1.158942)
[S11] cosine check vs S17: cos=-0.0648
[S11] DROPPED delta from S17 (cos=-0.0648 < 0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=1 metric=0.1421 head_norm=1.215038
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.210016e-01
[S7] stored merged vector for next round verification (round=1)
[S7] DEBUG after merge:  round=1 metric=0.2825 head_norm=0.889172 delta_norm=0.821002
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=1 metric=0.1414 head_norm=1.195216
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.422260e-01
[S6] stored merged vector for next round verification (round=1)
[S6] DEBUG after merge:  round=1 metric=0.1414 head_norm=0.865261 delta_norm=0.842226
[S6] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=1 metric=0.1667 head_norm=1.205414
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.141193e-01
[S16] stored merged vector for next round verification (round=1)
[S16] DEBUG after merge:  round=1 metric=0.1765 head_norm=0.844070 delta_norm=0.814119
[S16] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=1 metric=0.1520 head_norm=1.158942
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.240429e-01
[S17] stored merged vector for next round verification (round=1)
[S17] DEBUG after merge:  round=1 metric=0.1409 head_norm=0.846562 delta_norm=0.824043
[S17] aggregate: ROLLBACK (f1_val pre=0.152 post=0.141 tol_abs=0.005 tol_rel=0.0)
[S2] START round=2 head_norm_before_train=1.183501 (no previous merge yet)
[S2] round=2 local utility u=0.326746 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7293066482699213, 'loss_val': 1.2779729832299975, 'psi': 0.3767889393411086}-{'f1_val': 0.1417771333885667, 'auprc': 0.5233254543312101, 'loss_val': 1.3135207569770062, 'psi': 0.2943964617656241}
[S3] START round=2 head_norm_before_train=1.256051 (no previous merge yet)
[S3] round=2 local utility u=0.047379 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7913080790498997, 'loss_val': 1.127415090711583, 'psi': 0.4004272709884241}-{'f1_val': 0.13984006561410703, 'auprc': 0.803336879088276, 'loss_val': 1.2582586078948936, 'psi': 0.4052387910037747}
[S4] START round=2 head_norm_before_train=1.203446 (no previous merge yet)
[S4] round=2 local utility u=0.022340 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7794586800692426, 'loss_val': 1.2535938461778948, 'psi': 0.39591944936480755}-{'f1_val': 0.14022662889518414, 'auprc': 0.7792442963586352, 'loss_val': 1.2976296971190646, 'psi': 0.3958336958805646}
[S5] START round=2 head_norm_before_train=1.219631 (no previous merge yet)
[S5] round=2 local utility u=0.084743 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7648005924151233, 'loss_val': 1.1821402007348505, 'psi': 0.3912773798231922}-{'f1_val': 0.14226190476190476, 'auprc': 0.7307482180489486, 'loss_val': 1.249468430565943, 'psi': 0.37765643007672234}
[S6] START round=2 head_norm_before_train=0.865261 cos_to_last_merge=1.0000 (last merge round=1)
[S6] round=2 local utility u=0.103894 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8005351533715847, 'loss_val': 1.304160977975843, 'psi': 0.4050698305794031}-{'f1_val': 0.14142628205128205, 'auprc': 0.7380178344654047, 'loss_val': 1.3243972565970301, 'psi': 0.3800629030169311}
[S7] START round=2 head_norm_before_train=0.889172 cos_to_last_merge=1.0000 (last merge round=1)
[S7] round=2 local utility u=0.015351 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7775348964452229, 'loss_val': 1.2208053966857677, 'psi': 0.39624805221554416}-{'f1_val': 0.14205682272909165, 'auprc': 0.776565946409005, 'loss_val': 1.248600972951119, 'psi': 0.395860472201057}
[S8] START round=2 head_norm_before_train=1.154261 (no previous merge yet)
[S8] round=2 local utility u=0.000000 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7699664810107789, 'loss_val': 1.2875955958731775, 'psi': 0.3919601818400859}-{'f1_val': 0.42257860386146096, 'auprc': 0.7701969662558719, 'loss_val': 1.3297527794004402, 'psi': 0.5616259488192253}
[S9] START round=2 head_norm_before_train=1.244936 (no previous merge yet)
[S9] round=2 local utility u=0.663376 metrics={'f1_val': 0.3346445628247854, 'auprc': 0.6683278027399412, 'loss_val': 1.019883434026665, 'psi': 0.4681178587908478}-{'f1_val': 0.141397957139996, 'auprc': 0.6684257918189971, 'loss_val': 1.1874506804504161, 'psi': 0.3522090910115965}
[S10] START round=2 head_norm_before_train=1.214379 (no previous merge yet)
[S10] round=2 local utility u=0.026223 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.5749675271238541, 'loss_val': 1.3116957599875914, 'psi': 0.313159993374576}-{'f1_val': 0.13862163754172394, 'auprc': 0.5674696792907674, 'loss_val': 1.3416472252512772, 'psi': 0.3101608542413413}
[S11] START round=2 head_norm_before_train=1.168833 (no previous merge yet)
[S11] round=2 local utility u=0.011309 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7748787937374355, 'loss_val': 1.2827179369640906, 'psi': 0.3941997275188406}-{'f1_val': 0.14041368337311058, 'auprc': 0.7829768247412967, 'loss_val': 1.329629658627964, 'psi': 0.39743893992038504}
[S13] START round=2 head_norm_before_train=1.139064 (no previous merge yet)
[S13] round=2 local utility u=0.150582 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6681634567373582, 'loss_val': 1.2654954861962662, 'psi': 0.35149684024117517}-{'f1_val': 0.1403857625770531, 'auprc': 0.5813818995772304, 'loss_val': 1.3063154925544618, 'psi': 0.31678421737712403}
[S14] START round=2 head_norm_before_train=1.204420 (no previous merge yet)
[S14] round=2 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.6637144517017672, 'loss_val': 1.3322629088903428, 'psi': 0.34970049241032913}-{'f1_val': 0.4186757736667809, 'auprc': 0.6117696532588655, 'loss_val': 1.361070267002099, 'psi': 0.49591332550361467}
[S15] START round=2 head_norm_before_train=1.176455 (no previous merge yet)
[S15] round=2 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7836889976663306, 'loss_val': 1.3138200271389409, 'psi': 0.3973157898834673}-{'f1_val': 0.42146491725524565, 'auprc': 0.7667313137439542, 'loss_val': 1.3425138545137878, 'psi': 0.5595714758507291}
[S16] START round=2 head_norm_before_train=0.844070 cos_to_last_merge=1.0000 (last merge round=1)
[S16] round=2 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7925343974509431, 'loss_val': 1.3233075825063636, 'psi': 0.40139622909989914}-{'f1_val': 0.16674567433041004, 'auprc': 0.7894611541377228, 'loss_val': 1.319097610609189, 'psi': 0.4158318662533351}
[S17] START round=2 head_norm_before_train=0.846562 cos_to_last_merge=1.0000 (last merge round=1)
[S17] round=2 local utility u=0.005505 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5841582197732341, 'loss_val': 1.3483289352834982, 'psi': 0.3182326658997243}-{'f1_val': 0.15198744232409492, 'auprc': 0.5597980324531642, 'loss_val': 1.3524900656003667, 'psi': 0.3151116783757226}
[S4] not sending this round → trigger blocked (psi=0.396)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S13@127.0.0.1:57013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S3] → sending delta(kind=head bytes=1790) to S16@127.0.0.1:57016
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.351)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S10] → sending delta(kind=head bytes=1791) to S2@127.0.0.1:57002
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.394)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.405)
[S5] not sending this round → trigger blocked (psi=0.391)
[S2] not sending this round → trigger blocked (psi=0.377)
[S10] sending update (kind=head size=1791 to 1 peers)
[S7] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1790 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1791) from S10
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.235402)
[S2] loaded HEAD from S10 (vec_in norm=1.235402)
[S2] cosine check vs S10: cos=0.0185
[S2] BUFFERED delta from S10 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1794) from S7
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.933144)
[S13] loaded HEAD from S7 (vec_in norm=0.933144)
[S13] cosine check vs S7: cos=0.0815
[S13] BUFFERED delta from S7 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1790) from S3
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.313520)
[S16] loaded HEAD from S3 (vec_in norm=1.313520)
[S16] cosine check vs S3: cos=0.1338
[S16] BUFFERED delta from S3 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1796) from S9
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.299608)
[S15] loaded HEAD from S9 (vec_in norm=1.299608)
[S15] cosine check vs S9: cos=-0.0116
[S15] DROPPED delta from S9 (cos=-0.0116 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.318)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=2 metric=0.1418 head_norm=1.202078
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.538548e-01
[S2] stored merged vector for next round verification (round=2)
[S2] DEBUG after merge:  round=2 metric=0.1418 head_norm=0.869791 delta_norm=0.853855
[S2] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=2 metric=0.1404 head_norm=1.170658
[S13] _apply_head_vector_avg (torch): Δ‖w‖=7.181844e-01
[S13] stored merged vector for next round verification (round=2)
[S13] DEBUG after merge:  round=2 metric=0.1404 head_norm=0.777695 delta_norm=0.718184
[S13] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=2 metric=0.1406 head_norm=0.862249
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.358150e-01
[S16] stored merged vector for next round verification (round=2)
[S16] DEBUG after merge:  round=2 metric=0.1406 head_norm=0.832454 delta_norm=0.735815
[S16] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=0.869791 cos_to_last_merge=1.0000 (last merge round=2)
[S2] round=3 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6835153269604064, 'loss_val': 1.2835235737467412, 'psi': 0.35847241081730263}-{'f1_val': 0.1417771333885667, 'auprc': 0.7293066482699213, 'loss_val': 1.2779729832299975, 'psi': 0.3767889393411086}
[S3] START round=3 head_norm_before_train=1.313520 (no previous merge yet)
[S3] round=3 local utility u=0.916388 metrics={'f1_val': 0.3953089351857549, 'auprc': 0.7957680751292142, 'loss_val': 0.8408330780132882, 'psi': 0.5554925911631386}-{'f1_val': 0.13984006561410703, 'auprc': 0.7913080790498997, 'loss_val': 1.127415090711583, 'psi': 0.4004272709884241}
[S4] START round=3 head_norm_before_train=1.230463 (no previous merge yet)
[S4] round=3 local utility u=0.031620 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7792611093810324, 'loss_val': 1.1897611862066177, 'psi': 0.3958404210895235}-{'f1_val': 0.14022662889518414, 'auprc': 0.7794586800692426, 'loss_val': 1.2535938461778948, 'psi': 0.39591944936480755}
[S5] START round=3 head_norm_before_train=1.260228 (no previous merge yet)
[S5] round=3 local utility u=0.894899 metrics={'f1_val': 0.41734838192522206, 'auprc': 0.7770186833244168, 'loss_val': 1.079516201852328, 'psi': 0.5612165024849001}-{'f1_val': 0.14226190476190476, 'auprc': 0.7648005924151233, 'loss_val': 1.1821402007348505, 'psi': 0.3912773798231922}
[S6] START round=3 head_norm_before_train=0.886888 cos_to_last_merge=0.9973 (last merge round=1)
[S6] round=3 local utility u=0.028252 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8052205631206245, 'loss_val': 1.2617131125527588, 'psi': 0.406943994479019}-{'f1_val': 0.14142628205128205, 'auprc': 0.8005351533715847, 'loss_val': 1.304160977975843, 'psi': 0.4050698305794031}
[S7] START round=3 head_norm_before_train=0.933144 cos_to_last_merge=0.9954 (last merge round=1)
[S7] round=3 local utility u=0.040522 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7778218643028565, 'loss_val': 1.140622009240334, 'psi': 0.3963628393585976}-{'f1_val': 0.14205682272909165, 'auprc': 0.7775348964452229, 'loss_val': 1.2208053966857677, 'psi': 0.39624805221554416}
[S8] START round=3 head_norm_before_train=1.178351 (no previous merge yet)
[S8] round=3 local utility u=0.024973 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.768227687442126, 'loss_val': 1.2324336611554996, 'psi': 0.39126466441262475}-{'f1_val': 0.13995598239295717, 'auprc': 0.7699664810107789, 'loss_val': 1.2875955958731775, 'psi': 0.3919601818400859}
[S9] START round=3 head_norm_before_train=1.299608 (no previous merge yet)
[S9] round=3 local utility u=0.421968 metrics={'f1_val': 0.43559910606022967, 'auprc': 0.6684695734792491, 'loss_val': 0.7821005932412793, 'psi': 0.5287472930278374}-{'f1_val': 0.3346445628247854, 'auprc': 0.6683278027399412, 'loss_val': 1.019883434026665, 'psi': 0.4681178587908478}
[S10] START round=3 head_norm_before_train=1.235402 (no previous merge yet)
[S10] round=3 local utility u=0.052853 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.5958763159563624, 'loss_val': 1.26871538253933, 'psi': 0.3215235089075793}-{'f1_val': 0.13862163754172394, 'auprc': 0.5749675271238541, 'loss_val': 1.3116957599875914, 'psi': 0.313159993374576}
[S11] START round=3 head_norm_before_train=1.193172 (no previous merge yet)
[S11] round=3 local utility u=0.009531 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7668908034007169, 'loss_val': 1.2396927926202541, 'psi': 0.39100453138415314}-{'f1_val': 0.14041368337311058, 'auprc': 0.7748787937374355, 'loss_val': 1.2827179369640906, 'psi': 0.3941997275188406}
[S13] START round=3 head_norm_before_train=0.777695 cos_to_last_merge=1.0000 (last merge round=2)
[S13] round=3 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5649423315362243, 'loss_val': 1.2755270397715388, 'psi': 0.3102083901607216}-{'f1_val': 0.1403857625770531, 'auprc': 0.6681634567373582, 'loss_val': 1.2654954861962662, 'psi': 0.35149684024117517}
[S14] START round=3 head_norm_before_train=1.221773 (no previous merge yet)
[S14] round=3 local utility u=0.114001 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7291283917591578, 'loss_val': 1.3005021974631021, 'psi': 0.37586606843328535}-{'f1_val': 0.14035785288270378, 'auprc': 0.6637144517017672, 'loss_val': 1.3322629088903428, 'psi': 0.34970049241032913}
[S15] START round=3 head_norm_before_train=1.193754 (no previous merge yet)
[S15] round=3 local utility u=0.021167 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7857039587047183, 'loss_val': 1.277531246040211, 'psi': 0.39812177429882234}-{'f1_val': 0.13973365136155833, 'auprc': 0.7836889976663306, 'loss_val': 1.3138200271389409, 'psi': 0.3973157898834673}
[S16] START round=3 head_norm_before_train=0.832454 cos_to_last_merge=1.0000 (last merge round=2)
[S16] round=3 local utility u=0.004742 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7895318129894243, 'loss_val': 1.3048168258348356, 'psi': 0.4001951953152917}-{'f1_val': 0.14063745019920318, 'auprc': 0.7925343974509431, 'loss_val': 1.3233075825063636, 'psi': 0.40139622909989914}
[S17] START round=3 head_norm_before_train=0.859495 cos_to_last_merge=0.9972 (last merge round=1)
[S17] round=3 local utility u=0.132448 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.665051147207806, 'loss_val': 1.326111227416499, 'psi': 0.35058983687355305}-{'f1_val': 0.14094896331738438, 'auprc': 0.5841582197732341, 'loss_val': 1.3483289352834982, 'psi': 0.3182326658997243}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.396)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] → sending delta(kind=head bytes=1792) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S4] → sending delta(kind=head bytes=1791) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:57008
[S10] not sending this round → trigger blocked (psi=0.322)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:57011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:57007
[S9] not sending this round → trigger blocked (psi=0.529)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S6] → sending delta(kind=head bytes=1791) to S8@127.0.0.1:57009
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.555)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:57010
[S14] sending update (kind=head size=1793 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1791 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1793 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1791 to 1 peers)
[S8] sending update (kind=head size=1792 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1798) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.280813)
[S9] loaded HEAD from S5 (vec_in norm=1.280813)
[S9] cosine check vs S5: cos=0.0974
[S9] BUFFERED delta from S5 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1791) from S6
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.916458)
[S8] loaded HEAD from S6 (vec_in norm=0.916458)
[S8] cosine check vs S6: cos=-0.1148
[S8] DROPPED delta from S6 (cos=-0.1148 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1797) from S11
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.222642)
[S7] loaded HEAD from S11 (vec_in norm=1.222642)
[S7] cosine check vs S11: cos=-0.1543
[S7] DROPPED delta from S11 (cos=-0.1543 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1795) from S15
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.221743)
[S10] loaded HEAD from S15 (vec_in norm=1.221743)
[S10] cosine check vs S15: cos=0.0175
[S10] BUFFERED delta from S15 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1793) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.847493)
[S6] loaded HEAD from S16 (vec_in norm=0.847493)
[S6] cosine check vs S16: cos=0.0390
[S6] BUFFERED delta from S16 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1793) from S14
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.247448)
[S6] loaded HEAD from S14 (vec_in norm=1.247448)
[S6] cosine check vs S14: cos=-0.0941
[S6] DROPPED delta from S14 (cos=-0.0941 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1792) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.209976)
[S3] loaded HEAD from S8 (vec_in norm=1.209976)
[S3] cosine check vs S8: cos=0.0842
[S3] BUFFERED delta from S8 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1791) from S4
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.266453)
[S2] loaded HEAD from S4 (vec_in norm=1.266453)
[S2] cosine check vs S4: cos=0.0312
[S2] BUFFERED delta from S4 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:57009
[S17] sending update (kind=head size=1793 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1793) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.881158)
[S8] loaded HEAD from S17 (vec_in norm=0.881158)
[S8] cosine check vs S17: cos=-0.0515
[S8] DROPPED delta from S17 (cos=-0.0515 < 0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=3 metric=0.3953 head_norm=1.390856
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.824846e-01
[S3] stored merged vector for next round verification (round=3)
[S3] DEBUG after merge:  round=3 metric=0.3935 head_norm=0.959418 delta_norm=0.882485
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=3 metric=0.1418 head_norm=0.888804
[S2] _apply_head_vector_avg (torch): Δ‖w‖=7.621813e-01
[S2] stored merged vector for next round verification (round=3)
[S2] DEBUG after merge:  round=3 metric=0.1418 head_norm=0.784868 delta_norm=0.762181
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=3 metric=0.1386 head_norm=1.264477
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.714078e-01
[S10] stored merged vector for next round verification (round=3)
[S10] DEBUG after merge:  round=3 metric=0.1386 head_norm=0.886808 delta_norm=0.871408
[S10] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=3 metric=0.4356 head_norm=1.364930
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.892167e-01
[S9] stored merged vector for next round verification (round=3)
[S9] DEBUG after merge:  round=3 metric=0.4168 head_norm=0.980332 delta_norm=0.889217
[S9] aggregate: ROLLBACK (f1_val pre=0.436 post=0.417 tol_abs=0.005 tol_rel=0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=3 metric=0.1414 head_norm=0.916458
[S6] _apply_head_vector_avg (torch): Δ‖w‖=6.118662e-01
[S6] stored merged vector for next round verification (round=3)
[S6] DEBUG after merge:  round=3 metric=0.1414 head_norm=0.636152 delta_norm=0.611866
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=0.784868 cos_to_last_merge=1.0000 (last merge round=3)
[S2] round=4 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6056540394074624, 'loss_val': 1.2670005743906432, 'psi': 0.32732789579612503}-{'f1_val': 0.1417771333885667, 'auprc': 0.6835153269604064, 'loss_val': 1.2835235737467412, 'psi': 0.35847241081730263}
[S3] START round=4 head_norm_before_train=0.959418 cos_to_last_merge=1.0000 (last merge round=3)
[S3] round=4 local utility u=0.370822 metrics={'f1_val': 0.5043423253792216, 'auprc': 0.7957247958619073, 'loss_val': 0.7532605479843656, 'psi': 0.6208953135722959}-{'f1_val': 0.3953089351857549, 'auprc': 0.7957680751292142, 'loss_val': 0.8408330780132882, 'psi': 0.5554925911631386}
[S4] START round=4 head_norm_before_train=1.266453 (no previous merge yet)
[S4] round=4 local utility u=0.112628 metrics={'f1_val': 0.1650335632661457, 'auprc': 0.76950896362951, 'loss_val': 1.0840899499373426, 'psi': 0.4068237234114914}-{'f1_val': 0.14022662889518414, 'auprc': 0.7792611093810324, 'loss_val': 1.1897611862066177, 'psi': 0.3958404210895235}
[S5] START round=4 head_norm_before_train=1.280813 (no previous merge yet)
[S5] round=4 local utility u=0.123362 metrics={'f1_val': 0.4184754791387745, 'auprc': 0.7778777051467143, 'loss_val': 0.842131043996781, 'psi': 0.5622363695419504}-{'f1_val': 0.41734838192522206, 'auprc': 0.7770186833244168, 'loss_val': 1.079516201852328, 'psi': 0.5612165024849001}
[S6] START round=4 head_norm_before_train=0.636152 cos_to_last_merge=1.0000 (last merge round=3)
[S6] round=4 local utility u=0.003947 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8081159709807672, 'loss_val': 1.26250626400267, 'psi': 0.4081021576230761}-{'f1_val': 0.14142628205128205, 'auprc': 0.8052205631206245, 'loss_val': 1.2617131125527588, 'psi': 0.406943994479019}
[S7] START round=4 head_norm_before_train=0.974391 cos_to_last_merge=0.9875 (last merge round=1)
[S7] round=4 local utility u=1.000000 metrics={'f1_val': 0.5016051172559767, 'auprc': 0.7777024799754622, 'loss_val': 1.022294218717962, 'psi': 0.6120440623437708}-{'f1_val': 0.14205682272909165, 'auprc': 0.7778218643028565, 'loss_val': 1.140622009240334, 'psi': 0.3963628393585976}
[S8] START round=4 head_norm_before_train=1.209976 (no previous merge yet)
[S8] round=4 local utility u=0.126714 metrics={'f1_val': 0.17057585808294107, 'auprc': 0.7675531791489062, 'loss_val': 1.1607009813833857, 'psi': 0.4093667865093271}-{'f1_val': 0.13995598239295717, 'auprc': 0.768227687442126, 'loss_val': 1.2324336611554996, 'psi': 0.39126466441262475}
[S9] START round=4 head_norm_before_train=0.980332 cos_to_last_merge=1.0000 (last merge round=3)
[S9] round=4 local utility u=0.107322 metrics={'f1_val': 0.3866384713543919, 'auprc': 0.8206795431857724, 'loss_val': 0.7303236695864374, 'psi': 0.5602549000869441}-{'f1_val': 0.43559910606022967, 'auprc': 0.6684695734792491, 'loss_val': 0.7821005932412793, 'psi': 0.5287472930278374}
[S10] START round=4 head_norm_before_train=0.886808 cos_to_last_merge=1.0000 (last merge round=3)
[S10] round=4 local utility u=0.033139 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6165257509801568, 'loss_val': 1.2643851376989368, 'psi': 0.32978328291709713}-{'f1_val': 0.13862163754172394, 'auprc': 0.5958763159563624, 'loss_val': 1.26871538253933, 'psi': 0.3215235089075793}
[S11] START round=4 head_norm_before_train=1.222642 (no previous merge yet)
[S11] round=4 local utility u=0.019402 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7648469005017193, 'loss_val': 1.1947566748108998, 'psi': 0.3901869702245541}-{'f1_val': 0.14041368337311058, 'auprc': 0.7668908034007169, 'loss_val': 1.2396927926202541, 'psi': 0.39100453138415314}
[S13] START round=4 head_norm_before_train=0.803787 cos_to_last_merge=0.9971 (last merge round=2)
[S13] round=4 local utility u=0.057644 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5893929238931365, 'loss_val': 1.2335905607635662, 'psi': 0.31998862710348647}-{'f1_val': 0.1403857625770531, 'auprc': 0.5649423315362243, 'loss_val': 1.2755270397715388, 'psi': 0.3102083901607216}
[S14] START round=4 head_norm_before_train=1.247448 (no previous merge yet)
[S14] round=4 local utility u=0.176732 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8343426956881319, 'loss_val': 1.2626802998372808, 'psi': 0.41795179000487503}-{'f1_val': 0.14035785288270378, 'auprc': 0.7291283917591578, 'loss_val': 1.3005021974631021, 'psi': 0.37586606843328535}
[S15] START round=4 head_norm_before_train=1.221743 (no previous merge yet)
[S15] round=4 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7728123906292301, 'loss_val': 1.240418888797138, 'psi': 0.39296514706862706}-{'f1_val': 0.13973365136155833, 'auprc': 0.7857039587047183, 'loss_val': 1.277531246040211, 'psi': 0.39812177429882234}
[S16] START round=4 head_norm_before_train=0.847493 cos_to_last_merge=0.9966 (last merge round=2)
[S16] round=4 local utility u=0.023479 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7881857817758453, 'loss_val': 1.2538210079177254, 'psi': 0.39965678282986006}-{'f1_val': 0.14063745019920318, 'auprc': 0.7895318129894243, 'loss_val': 1.3048168258348356, 'psi': 0.4001951953152917}
[S17] START round=4 head_norm_before_train=0.881158 cos_to_last_merge=0.9884 (last merge round=1)
[S17] round=4 local utility u=0.038178 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6806497450041114, 'loss_val': 1.2965519532988674, 'psi': 0.3568292759920752}-{'f1_val': 0.14094896331738438, 'auprc': 0.665051147207806, 'loss_val': 1.326111227416499, 'psi': 0.35058983687355305}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S9] → sending delta(kind=head bytes=1791) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:57015
[S8] not sending this round → trigger blocked (psi=0.409)
[S16] not sending this round → trigger blocked (psi=0.400)
[S14] not sending this round → trigger blocked (psi=0.418)
[S4] not sending this round → trigger blocked (psi=0.407)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:57015
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S10] → sending delta(kind=head bytes=1791) to S7@127.0.0.1:57008
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.408)
[S5] not sending this round → trigger blocked (psi=0.562)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:57015
[S11] not sending this round → trigger blocked (psi=0.390)
[S3] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1791 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1791 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1799) from S3
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.051097)
[S15] loaded HEAD from S3 (vec_in norm=1.051097)
[S15] cosine check vs S3: cos=-0.0829
[S15] DROPPED delta from S3 (cos=-0.0829 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1791) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.052551)
[S3] loaded HEAD from S9 (vec_in norm=1.052551)
[S3] cosine check vs S9: cos=0.0088
[S3] BUFFERED delta from S9 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1797) from S7
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.015939)
[S15] loaded HEAD from S7 (vec_in norm=1.015939)
[S15] cosine check vs S7: cos=0.0947
[S15] BUFFERED delta from S7 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1801) from S13
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=0.831407)
[S15] loaded HEAD from S13 (vec_in norm=0.831407)
[S15] cosine check vs S13: cos=0.0574
[S15] BUFFERED delta from S13 (total buffered=2)
[S7] RECEIVED delta(kind=head bytes=1791) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=0.913597)
[S7] loaded HEAD from S10 (vec_in norm=0.913597)
[S7] cosine check vs S10: cos=0.1196
[S7] BUFFERED delta from S10 (total buffered=1)
[S17] not sending this round → trigger blocked (psi=0.357)
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=4 metric=0.1397 head_norm=1.255478
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.218752e-01
[S15] stored merged vector for next round verification (round=4)
[S15] DEBUG after merge:  round=4 metric=0.1397 head_norm=0.781948 delta_norm=0.721875
[S15] aggregate: ACCEPT kept=['S7', 'S13'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=4 metric=0.5016 head_norm=1.015939
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.412287e-01
[S7] stored merged vector for next round verification (round=4)
[S7] DEBUG after merge:  round=4 metric=0.5920 head_norm=0.722649 delta_norm=0.641229
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=4 metric=0.5043 head_norm=1.051097
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.404554e-01
[S3] stored merged vector for next round verification (round=4)
[S3] DEBUG after merge:  round=4 metric=0.5363 head_norm=0.747034 delta_norm=0.740455
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=0.806687 cos_to_last_merge=0.9955 (last merge round=3)
[S2] round=5 local utility u=0.035769 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6093373734505575, 'loss_val': 1.2065119297331757, 'psi': 0.32880122941336304}-{'f1_val': 0.1417771333885667, 'auprc': 0.6056540394074624, 'loss_val': 1.2670005743906432, 'psi': 0.32732789579612503}
[S3] START round=5 head_norm_before_train=0.747034 cos_to_last_merge=1.0000 (last merge round=4)
[S3] round=5 local utility u=0.442849 metrics={'f1_val': 0.6995739279432054, 'auprc': 0.6726554401385623, 'loss_val': 0.6697442816314364, 'psi': 0.6888065328213482}-{'f1_val': 0.5043423253792216, 'auprc': 0.7957247958619073, 'loss_val': 0.7532605479843656, 'psi': 0.6208953135722959}
[S4] START round=5 head_norm_before_train=1.308989 (no previous merge yet)
[S4] round=5 local utility u=1.000000 metrics={'f1_val': 0.6868424844264226, 'auprc': 0.768527061479414, 'loss_val': 0.9140290156844417, 'psi': 0.7195163152476192}-{'f1_val': 0.1650335632661457, 'auprc': 0.76950896362951, 'loss_val': 1.0840899499373426, 'psi': 0.4068237234114914}
[S5] START round=5 head_norm_before_train=1.330673 (no previous merge yet)
[S5] round=5 local utility u=1.000000 metrics={'f1_val': 0.714986591715879, 'auprc': 0.7947953187898626, 'loss_val': 0.6504717666425986, 'psi': 0.7469100825454724}-{'f1_val': 0.4184754791387745, 'auprc': 0.7778777051467143, 'loss_val': 0.842131043996781, 'psi': 0.5622363695419504}
[S6] START round=5 head_norm_before_train=0.662557 cos_to_last_merge=0.9959 (last merge round=3)
[S6] round=5 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6628773975544716, 'loss_val': 1.2400473773663112, 'psi': 0.35000672825255785}-{'f1_val': 0.14142628205128205, 'auprc': 0.8081159709807672, 'loss_val': 1.26250626400267, 'psi': 0.4081021576230761}
[S7] START round=5 head_norm_before_train=0.722649 cos_to_last_merge=1.0000 (last merge round=4)
[S7] round=5 local utility u=0.000000 metrics={'f1_val': 0.418173026840897, 'auprc': 0.7772945251357897, 'loss_val': 0.9228750027075717, 'psi': 0.5618216261588541}-{'f1_val': 0.5016051172559767, 'auprc': 0.7777024799754622, 'loss_val': 1.022294218717962, 'psi': 0.6120440623437708}
[S8] START round=5 head_norm_before_train=1.244587 (no previous merge yet)
[S8] round=5 local utility u=0.792910 metrics={'f1_val': 0.4125463127353598, 'auprc': 0.7746008778456754, 'loss_val': 1.0478468208102112, 'psi': 0.557368138779486}-{'f1_val': 0.17057585808294107, 'auprc': 0.7675531791489062, 'loss_val': 1.1607009813833857, 'psi': 0.4093667865093271}
[S9] START round=5 head_norm_before_train=1.052551 cos_to_last_merge=0.9917 (last merge round=3)
[S9] round=5 local utility u=0.231423 metrics={'f1_val': 0.4371667528122887, 'auprc': 0.8653621223644071, 'loss_val': 0.7046952049607729, 'psi': 0.608444900633136}-{'f1_val': 0.3866384713543919, 'auprc': 0.8206795431857724, 'loss_val': 0.7303236695864374, 'psi': 0.5602549000869441}
[S10] START round=5 head_norm_before_train=0.913597 cos_to_last_merge=0.9973 (last merge round=3)
[S10] round=5 local utility u=0.048982 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6265659937209177, 'loss_val': 1.1965411603118128, 'psi': 0.3337993800134014}-{'f1_val': 0.13862163754172394, 'auprc': 0.6165257509801568, 'loss_val': 1.2643851376989368, 'psi': 0.32978328291709713}
[S11] START round=5 head_norm_before_train=1.247823 (no previous merge yet)
[S11] round=5 local utility u=0.038840 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7652722101041034, 'loss_val': 1.1183530864602635, 'psi': 0.3903570940655077}-{'f1_val': 0.14041368337311058, 'auprc': 0.7648469005017193, 'loss_val': 1.1947566748108998, 'psi': 0.3901869702245541}
[S13] START round=5 head_norm_before_train=0.831407 cos_to_last_merge=0.9906 (last merge round=2)
[S13] round=5 local utility u=0.025429 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5855265672296668, 'loss_val': 1.1711330265270896, 'psi': 0.31844208443809857}-{'f1_val': 0.1403857625770531, 'auprc': 0.5893929238931365, 'loss_val': 1.2335905607635662, 'psi': 0.31998862710348647}
[S14] START round=5 head_norm_before_train=1.280187 (no previous merge yet)
[S14] round=5 local utility u=0.079423 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8726018616228236, 'loss_val': 1.2186117005847248, 'psi': 0.43325545637875174}-{'f1_val': 0.14035785288270378, 'auprc': 0.8343426956881319, 'loss_val': 1.2626802998372808, 'psi': 0.41795179000487503}
[S15] START round=5 head_norm_before_train=0.781948 cos_to_last_merge=1.0000 (last merge round=4)
[S15] round=5 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7741832337990094, 'loss_val': 1.2472617844590212, 'psi': 0.3935134843365388}-{'f1_val': 0.13973365136155833, 'auprc': 0.7728123906292301, 'loss_val': 1.240418888797138, 'psi': 0.39296514706862706}
[S16] START round=5 head_norm_before_train=0.871943 cos_to_last_merge=0.9870 (last merge round=2)
[S16] round=5 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.5938527285904254, 'loss_val': 1.205435789556031, 'psi': 0.3219235615556921}-{'f1_val': 0.14063745019920318, 'auprc': 0.7881857817758453, 'loss_val': 1.2538210079177254, 'psi': 0.39965678282986006}
[S17] START round=5 head_norm_before_train=0.911139 cos_to_last_merge=0.9750 (last merge round=1)
[S17] round=5 local utility u=0.109287 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.7408167836171982, 'loss_val': 1.2584795401046838, 'psi': 0.3808960914373099}-{'f1_val': 0.14094896331738438, 'auprc': 0.6806497450041114, 'loss_val': 1.2965519532988674, 'psi': 0.3568292759920752}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S10@127.0.0.1:57011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:57002
[S3] not sending this round → trigger blocked (psi=0.689)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:57003
[S9] not sending this round → trigger blocked (psi=0.608)
[S10] not sending this round → trigger blocked (psi=0.334)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:57008
[S13] not sending this round → trigger blocked (psi=0.318)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:57007
[S14] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1794 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1797) from S14
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.313391)
[S6] loaded HEAD from S14 (vec_in norm=1.313391)
[S6] cosine check vs S14: cos=-0.0916
[S6] DROPPED delta from S14 (cos=-0.0916 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1798) from S4
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.356915)
[S2] loaded HEAD from S4 (vec_in norm=1.356915)
[S2] cosine check vs S4: cos=0.7807
[S2] BUFFERED delta from S4 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1795) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.278101)
[S3] loaded HEAD from S8 (vec_in norm=1.278101)
[S3] cosine check vs S8: cos=0.4040
[S3] BUFFERED delta from S8 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1796) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.395157)
[S9] loaded HEAD from S5 (vec_in norm=1.395157)
[S9] cosine check vs S5: cos=0.6258
[S9] BUFFERED delta from S5 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1798) from S11
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.273320)
[S7] loaded HEAD from S11 (vec_in norm=1.273320)
[S7] cosine check vs S11: cos=-0.0898
[S7] DROPPED delta from S11 (cos=-0.0898 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1794) from S2
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=0.835636)
[S10] loaded HEAD from S2 (vec_in norm=0.835636)
[S10] cosine check vs S2: cos=0.2676
[S10] BUFFERED delta from S2 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:57009
[S17] sending update (kind=head size=1795 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1795) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.944369)
[S8] loaded HEAD from S17 (vec_in norm=0.944369)
[S8] cosine check vs S17: cos=-0.0453
[S8] DROPPED delta from S17 (cos=-0.0453 < 0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=5 metric=0.4372 head_norm=1.145123
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.608510e-01
[S9] stored merged vector for next round verification (round=5)
[S9] DEBUG after merge:  round=5 metric=0.6221 head_norm=1.146443 delta_norm=0.560851
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.513 → S3@127.0.0.1:57003
[S6] ⇄ pheromone p=0.351 → S8@127.0.0.1:57009
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=5 metric=0.6996 head_norm=0.843855
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.070923e-01
[S3] stored merged vector for next round verification (round=5)
[S3] DEBUG after merge:  round=5 metric=0.6930 head_norm=0.896803 delta_norm=0.607092
[S3] aggregate: ROLLBACK (f1_val pre=0.700 post=0.693 tol_abs=0.005 tol_rel=0.0)
[S3] ⇄ pheromone p=0.598 → S15@127.0.0.1:57015
[S7] ⇄ pheromone p=0.494 → S15@127.0.0.1:57015
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=5 metric=0.1386 head_norm=0.947553
[S10] _apply_head_vector_avg (torch): Δ‖w‖=5.413636e-01
[S10] stored merged vector for next round verification (round=5)
[S10] DEBUG after merge:  round=5 metric=0.1386 head_norm=0.710632 delta_norm=0.541364
[S10] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.352 → S7@127.0.0.1:57008
[S13] ⇄ pheromone p=0.363 → S15@127.0.0.1:57015
[S15] ⇄ pheromone p=0.363 → S10@127.0.0.1:57011
[S4] ⇄ pheromone p=0.553 → S2@127.0.0.1:57002
[S8] ⇄ pheromone p=0.592 → S3@127.0.0.1:57003
[S5] ⇄ pheromone p=0.674 → S9@127.0.0.1:57010
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=5 metric=0.1418 head_norm=0.835636
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.384889e-01
[S2] stored merged vector for next round verification (round=5)
[S2] DEBUG after merge:  round=5 metric=0.1418 head_norm=1.038018 delta_norm=0.438489
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.385 → S10@127.0.0.1:57011
[S14] ⇄ pheromone p=0.468 → S6@127.0.0.1:57007
[S11] ⇄ pheromone p=0.367 → S7@127.0.0.1:57008
[S17] ⇄ pheromone p=0.415 → S8@127.0.0.1:57009
[S16] ⇄ pheromone p=0.350 → S6@127.0.0.1:57007
[S2] START round=6 head_norm_before_train=1.038018 cos_to_last_merge=1.0000 (last merge round=5)
[S2] round=6 local utility u=0.830831 metrics={'f1_val': 0.4103026327134986, 'auprc': 0.6133335216769089, 'loss_val': 1.1679914842797308, 'psi': 0.49151498829886275}-{'f1_val': 0.1417771333885667, 'auprc': 0.6093373734505575, 'loss_val': 1.2065119297331757, 'psi': 0.32880122941336304}
[S3] START round=6 head_norm_before_train=0.896803 cos_to_last_merge=1.0000 (last merge round=5)
[S3] round=6 local utility u=0.000000 metrics={'f1_val': 0.6845098684384399, 'auprc': 0.6610544923379703, 'loss_val': 0.6199027056477852, 'psi': 0.675127717998252}-{'f1_val': 0.6995739279432054, 'auprc': 0.6726554401385623, 'loss_val': 0.6697442816314364, 'psi': 0.6888065328213482}
[S4] START round=6 head_norm_before_train=1.356915 (no previous merge yet)
[S4] round=6 local utility u=0.076594 metrics={'f1_val': 0.6728972922996533, 'auprc': 0.7861330584715638, 'loss_val': 0.7299882187541631, 'psi': 0.7181915987684175}-{'f1_val': 0.6868424844264226, 'auprc': 0.768527061479414, 'loss_val': 0.9140290156844417, 'psi': 0.7195163152476192}
[S5] START round=6 head_norm_before_train=1.395157 (no previous merge yet)
[S5] round=6 local utility u=0.020792 metrics={'f1_val': 0.7011041183246911, 'auprc': 0.7953647050056843, 'loss_val': 0.527302065734077, 'psi': 0.7388083529970884}-{'f1_val': 0.714986591715879, 'auprc': 0.7947953187898626, 'loss_val': 0.6504717666425986, 'psi': 0.7469100825454724}
[S6] START round=6 head_norm_before_train=0.695069 cos_to_last_merge=0.9857 (last merge round=3)
[S6] round=6 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6173268340938135, 'loss_val': 1.1412875115917118, 'psi': 0.33178650286829464}-{'f1_val': 0.14142628205128205, 'auprc': 0.6628773975544716, 'loss_val': 1.2400473773663112, 'psi': 0.35000672825255785}
[S7] START round=6 head_norm_before_train=0.774156 cos_to_last_merge=0.9891 (last merge round=4)
[S7] round=6 local utility u=0.330876 metrics={'f1_val': 0.468237434434773, 'auprc': 0.8571374496695283, 'loss_val': 0.8010377098899922, 'psi': 0.6237974405286751}-{'f1_val': 0.418173026840897, 'auprc': 0.7772945251357897, 'loss_val': 0.9228750027075717, 'psi': 0.5618216261588541}
[S8] START round=6 head_norm_before_train=1.278101 (no previous merge yet)
[S8] round=6 local utility u=0.000000 metrics={'f1_val': 0.37306606018310795, 'auprc': 0.7944767390756151, 'loss_val': 0.8906723408423034, 'psi': 0.5416303317401109}-{'f1_val': 0.4125463127353598, 'auprc': 0.7746008778456754, 'loss_val': 1.0478468208102112, 'psi': 0.557368138779486}
[S9] START round=6 head_norm_before_train=1.146443 cos_to_last_merge=1.0000 (last merge round=5)
[S9] round=6 local utility u=1.000000 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9993556865555949, 'loss_val': 0.4840672888278205, 'psi': 0.8204722230862491}-{'f1_val': 0.4371667528122887, 'auprc': 0.8653621223644071, 'loss_val': 0.7046952049607729, 'psi': 0.608444900633136}
[S10] START round=6 head_norm_before_train=0.710632 cos_to_last_merge=1.0000 (last merge round=5)
[S10] round=6 local utility u=0.064582 metrics={'f1_val': 0.1416084887731905, 'auprc': 0.6466886393772734, 'loss_val': 1.1456669145952008, 'psi': 0.34364054901482366}-{'f1_val': 0.13862163754172394, 'auprc': 0.6265659937209177, 'loss_val': 1.1965411603118128, 'psi': 0.3337993800134014}
[S11] START round=6 head_norm_before_train=1.273320 (no previous merge yet)
[S11] round=6 local utility u=0.908475 metrics={'f1_val': 0.42273254389314063, 'auprc': 0.769364398299279, 'loss_val': 1.0075936813843553, 'psi': 0.5613852856555961}-{'f1_val': 0.14041368337311058, 'auprc': 0.7652722101041034, 'loss_val': 1.1183530864602635, 'psi': 0.3903570940655077}
[S13] START round=6 head_norm_before_train=0.858713 cos_to_last_merge=0.9834 (last merge round=2)
[S13] round=6 local utility u=0.819506 metrics={'f1_val': 0.41643344272875704, 'auprc': 0.5537947440600316, 'loss_val': 1.0932116994848873, 'psi': 0.47137796326126685}-{'f1_val': 0.1403857625770531, 'auprc': 0.5855265672296668, 'loss_val': 1.1711330265270896, 'psi': 0.31844208443809857}
[S14] START round=6 head_norm_before_train=1.313391 (no previous merge yet)
[S14] round=6 local utility u=0.817209 metrics={'f1_val': 0.39652757107859105, 'auprc': 0.8801337059242017, 'loss_val': 1.1438083452697125, 'psi': 0.5899700250168354}-{'f1_val': 0.14035785288270378, 'auprc': 0.8726018616228236, 'loss_val': 1.2186117005847248, 'psi': 0.43325545637875174}
[S15] START round=6 head_norm_before_train=0.818814 cos_to_last_merge=0.9970 (last merge round=4)
[S15] round=6 local utility u=0.005963 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7613980578372932, 'loss_val': 1.1969795830675671, 'psi': 0.3883994139518523}-{'f1_val': 0.13973365136155833, 'auprc': 0.7741832337990094, 'loss_val': 1.2472617844590212, 'psi': 0.3935134843365388}
[S16] START round=6 head_norm_before_train=0.898898 cos_to_last_merge=0.9756 (last merge round=2)
[S16] round=6 local utility u=0.760283 metrics={'f1_val': 0.413691364517153, 'auprc': 0.5294193961682666, 'loss_val': 1.1298939015335083, 'psi': 0.45998257717759844}-{'f1_val': 0.14063745019920318, 'auprc': 0.5938527285904254, 'loss_val': 1.205435789556031, 'psi': 0.3219235615556921}
[S17] START round=6 head_norm_before_train=0.944369 cos_to_last_merge=0.9601 (last merge round=1)
[S17] round=6 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5672588381726255, 'loss_val': 1.1913999760592442, 'psi': 0.3114729132594808}-{'f1_val': 0.14094896331738438, 'auprc': 0.7408167836171982, 'loss_val': 1.2584795401046838, 'psi': 0.3808960914373099}
[S2] not sending this round → trigger blocked (psi=0.492)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S13] → sending delta(kind=head bytes=1788) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:57007
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.739)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:57003
[S14] not sending this round → trigger blocked (psi=0.590)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:57011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:57008
[S11] not sending this round → trigger blocked (psi=0.561)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:57015
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.718)
[S16] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1788 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1788) from S13
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=0.891279)
[S15] loaded HEAD from S13 (vec_in norm=0.891279)
[S15] cosine check vs S13: cos=0.4537
[S15] BUFFERED delta from S13 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1800) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.219339)
[S3] loaded HEAD from S9 (vec_in norm=1.219339)
[S3] cosine check vs S9: cos=0.2057
[S3] BUFFERED delta from S9 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1796) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.928497)
[S6] loaded HEAD from S16 (vec_in norm=0.928497)
[S6] cosine check vs S16: cos=0.6063
[S6] BUFFERED delta from S16 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1803) from S7
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.838449)
[S15] loaded HEAD from S7 (vec_in norm=0.838449)
[S15] cosine check vs S7: cos=0.7067
[S15] BUFFERED delta from S7 (total buffered=2)
[S7] RECEIVED delta(kind=head bytes=1798) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=0.744441)
[S7] loaded HEAD from S10 (vec_in norm=0.744441)
[S7] cosine check vs S10: cos=0.4896
[S7] BUFFERED delta from S10 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1798) from S15
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.857830)
[S10] loaded HEAD from S15 (vec_in norm=0.857830)
[S10] cosine check vs S15: cos=0.3752
[S10] BUFFERED delta from S15 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=6 metric=0.1414 head_norm=0.719061
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.773637e-01
[S6] stored merged vector for next round verification (round=6)
[S6] DEBUG after merge:  round=6 metric=0.1414 head_norm=0.739712 delta_norm=0.377364
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=6 metric=0.6845 head_norm=0.984834
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.004781e-01
[S3] stored merged vector for next round verification (round=6)
[S3] DEBUG after merge:  round=6 metric=0.6925 head_norm=0.858879 delta_norm=0.700478
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=6 metric=0.1416 head_norm=0.744441
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.502247e-01
[S10] stored merged vector for next round verification (round=6)
[S10] DEBUG after merge:  round=6 metric=0.1386 head_norm=0.665079 delta_norm=0.450225
[S10] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=6 metric=0.1397 head_norm=0.857830
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.290653e-01
[S15] stored merged vector for next round verification (round=6)
[S15] DEBUG after merge:  round=6 metric=0.1397 head_norm=0.732041 delta_norm=0.329065
[S15] aggregate: ACCEPT kept=['S13', 'S7'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=6 metric=0.4682 head_norm=0.838449
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.018785e-01
[S7] stored merged vector for next round verification (round=6)
[S7] DEBUG after merge:  round=6 metric=0.4167 head_norm=0.683439 delta_norm=0.401879
[S7] aggregate: ROLLBACK (f1_val pre=0.468 post=0.417 tol_abs=0.005 tol_rel=0.0)
[S2] START round=7 head_norm_before_train=1.054027 cos_to_last_merge=0.9968 (last merge round=5)
[S2] round=7 local utility u=0.310254 metrics={'f1_val': 0.4169384018324798, 'auprc': 0.7755242734461741, 'loss_val': 1.0738699166766104, 'psi': 0.5603727504779576}-{'f1_val': 0.4103026327134986, 'auprc': 0.6133335216769089, 'loss_val': 1.1679914842797308, 'psi': 0.49151498829886275}
[S3] START round=7 head_norm_before_train=0.858879 cos_to_last_merge=1.0000 (last merge round=6)
[S3] round=7 local utility u=0.093121 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.6608593122007709, 'loss_val': 0.5310057932264336, 'psi': 0.6848427658955948}-{'f1_val': 0.6845098684384399, 'auprc': 0.6610544923379703, 'loss_val': 0.6199027056477852, 'psi': 0.675127717998252}
[S4] START round=7 head_norm_before_train=1.412256 (no previous merge yet)
[S4] round=7 local utility u=0.000000 metrics={'f1_val': 0.6654541500316433, 'auprc': 0.6628263095720451, 'loss_val': 0.6045909830152555, 'psi': 0.6644030138478041}-{'f1_val': 0.6728972922996533, 'auprc': 0.7861330584715638, 'loss_val': 0.7299882187541631, 'psi': 0.7181915987684175}
[S5] START round=7 head_norm_before_train=1.442864 (no previous merge yet)
[S5] round=7 local utility u=0.050265 metrics={'f1_val': 0.7008569501491988, 'auprc': 0.7963509891690675, 'loss_val': 0.42824758847853167, 'psi': 0.7390545657571463}-{'f1_val': 0.7011041183246911, 'auprc': 0.7953647050056843, 'loss_val': 0.527302065734077, 'psi': 0.7388083529970884}
[S6] START round=7 head_norm_before_train=0.739712 cos_to_last_merge=1.0000 (last merge round=6)
[S6] round=7 local utility u=0.017377 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6135846873141644, 'loss_val': 1.0953066023857383, 'psi': 0.33028964415643497}-{'f1_val': 0.14142628205128205, 'auprc': 0.6173268340938135, 'loss_val': 1.1412875115917118, 'psi': 0.33178650286829464}
[S7] START round=7 head_norm_before_train=0.683439 cos_to_last_merge=1.0000 (last merge round=6)
[S7] round=7 local utility u=0.739562 metrics={'f1_val': 0.7139737313795297, 'auprc': 0.8604549556832763, 'loss_val': 0.8062844197420399, 'psi': 0.7725662211010283}-{'f1_val': 0.468237434434773, 'auprc': 0.8571374496695283, 'loss_val': 0.8010377098899922, 'psi': 0.6237974405286751}
[S8] START round=7 head_norm_before_train=1.315666 (no previous merge yet)
[S8] round=7 local utility u=0.855146 metrics={'f1_val': 0.5376440565306186, 'auprc': 0.9879057886367029, 'loss_val': 0.7481345767676947, 'psi': 0.7177487493730523}-{'f1_val': 0.37306606018310795, 'auprc': 0.7944767390756151, 'loss_val': 0.8906723408423034, 'psi': 0.5416303317401109}
[S9] START round=7 head_norm_before_train=1.219339 cos_to_last_merge=0.9922 (last merge round=5)
[S9] round=7 local utility u=0.085284 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9986458781824439, 'loss_val': 0.3113704327133412, 'psi': 0.8201882997369887}-{'f1_val': 0.7012165807733519, 'auprc': 0.9993556865555949, 'loss_val': 0.4840672888278205, 'psi': 0.8204722230862491}
[S10] START round=7 head_norm_before_train=0.665079 cos_to_last_merge=1.0000 (last merge round=6)
[S10] round=7 local utility u=0.838341 metrics={'f1_val': 0.41666239191319776, 'auprc': 0.6312184644371278, 'loss_val': 1.072898463258718, 'psi': 0.5024848209227698}-{'f1_val': 0.1416084887731905, 'auprc': 0.6466886393772734, 'loss_val': 1.1456669145952008, 'psi': 0.34364054901482366}
[S11] START round=7 head_norm_before_train=1.303971 (no previous merge yet)
[S11] round=7 local utility u=0.085991 metrics={'f1_val': 0.42536078646606834, 'auprc': 0.7692692131178611, 'loss_val': 0.8510954811223316, 'psi': 0.5629241571267855}-{'f1_val': 0.42273254389314063, 'auprc': 0.769364398299279, 'loss_val': 1.0075936813843553, 'psi': 0.5613852856555961}
[S13] START round=7 head_norm_before_train=0.891279 cos_to_last_merge=0.9739 (last merge round=2)
[S13] round=7 local utility u=0.016400 metrics={'f1_val': 0.416200286011302, 'auprc': 0.5287485607890953, 'loss_val': 0.983873600689338, 'psi': 0.4612195959224193}-{'f1_val': 0.41643344272875704, 'auprc': 0.5537947440600316, 'loss_val': 1.0932116994848873, 'psi': 0.47137796326126685}
[S14] START round=7 head_norm_before_train=1.349176 (no previous merge yet)
[S14] round=7 local utility u=0.122453 metrics={'f1_val': 0.39649470961585787, 'auprc': 0.906323439633644, 'loss_val': 0.9772734635667465, 'psi': 0.6004262016229723}-{'f1_val': 0.39652757107859105, 'auprc': 0.8801337059242017, 'loss_val': 1.1438083452697125, 'psi': 0.5899700250168354}
[S15] START round=7 head_norm_before_train=0.732041 cos_to_last_merge=1.0000 (last merge round=6)
[S15] round=7 local utility u=0.901679 metrics={'f1_val': 0.416110637094998, 'auprc': 0.8000612041603969, 'loss_val': 1.1678724168235655, 'psi': 0.5696908639211576}-{'f1_val': 0.13973365136155833, 'auprc': 0.7613980578372932, 'loss_val': 1.1969795830675671, 'psi': 0.3883994139518523}
[S16] START round=7 head_norm_before_train=0.928497 cos_to_last_merge=0.9641 (last merge round=2)
[S16] round=7 local utility u=0.051374 metrics={'f1_val': 0.4173069283424069, 'auprc': 0.5238118525086229, 'loss_val': 1.0320162082218964, 'psi': 0.45990889800889334}-{'f1_val': 0.413691364517153, 'auprc': 0.5294193961682666, 'loss_val': 1.1298939015335083, 'psi': 0.45998257717759844}
[S17] START round=7 head_norm_before_train=0.981525 cos_to_last_merge=0.9441 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.944
[S17] round=7 local utility u=0.858692 metrics={'f1_val': 0.3844942044408102, 'auprc': 0.614315306087959, 'loss_val': 1.0764576255149454, 'psi': 0.47642264509966975}-{'f1_val': 0.14094896331738438, 'auprc': 0.5672588381726255, 'loss_val': 1.1913999760592442, 'psi': 0.3114729132594808}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:57015
[S16] not sending this round → trigger blocked (psi=0.460)
[S13] not sending this round → trigger blocked (psi=0.461)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:57009
[S9] not sending this round → trigger blocked (psi=0.820)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:57007
[S10] not sending this round → trigger blocked (psi=0.502)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S2] → sending delta(kind=head bytes=1791) to S10@127.0.0.1:57011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:57008
[S15] not sending this round → trigger blocked (psi=0.570)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:57003
[S7] not sending this round → trigger blocked (psi=0.773)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1794 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1791 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1796) from S6
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.765726)
[S8] loaded HEAD from S6 (vec_in norm=0.765726)
[S8] cosine check vs S6: cos=0.0704
[S8] BUFFERED delta from S6 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1796) from S14
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.394654)
[S6] loaded HEAD from S14 (vec_in norm=1.394654)
[S6] cosine check vs S14: cos=-0.0711
[S6] DROPPED delta from S14 (cos=-0.0711 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1802) from S11
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.346144)
[S7] loaded HEAD from S11 (vec_in norm=1.346144)
[S7] cosine check vs S11: cos=-0.0385
[S7] DROPPED delta from S11 (cos=-0.0385 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1798) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.499668)
[S9] loaded HEAD from S5 (vec_in norm=1.499668)
[S9] cosine check vs S5: cos=0.8267
[S9] BUFFERED delta from S5 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1791) from S2
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.075779)
[S10] loaded HEAD from S2 (vec_in norm=1.075779)
[S10] cosine check vs S2: cos=0.2733
[S10] BUFFERED delta from S2 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1794) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.358860)
[S3] loaded HEAD from S8 (vec_in norm=1.358860)
[S3] cosine check vs S8: cos=0.4277
[S3] BUFFERED delta from S8 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1801) from S3
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=0.938762)
[S15] loaded HEAD from S3 (vec_in norm=0.938762)
[S15] cosine check vs S3: cos=0.0119
[S15] BUFFERED delta from S3 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:57009
[S17] sending update (kind=head size=1796 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1796) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.015916)
[S8] loaded HEAD from S17 (vec_in norm=1.015916)
[S8] cosine check vs S17: cos=-0.0359
[S8] DROPPED delta from S17 (cos=-0.0359 < 0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=7 metric=0.4167 head_norm=0.698922
[S10] _apply_head_vector_avg (torch): Δ‖w‖=5.555940e-01
[S10] stored merged vector for next round verification (round=7)
[S10] DEBUG after merge:  round=7 metric=0.4168 head_norm=0.717086 delta_norm=0.555594
[S10] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=7 metric=0.4161 head_norm=0.760493
[S15] _apply_head_vector_avg (torch): Δ‖w‖=6.005439e-01
[S15] stored merged vector for next round verification (round=7)
[S15] DEBUG after merge:  round=7 metric=0.3922 head_norm=0.607584 delta_norm=0.600544
[S15] aggregate: ROLLBACK (f1_val pre=0.416 post=0.392 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=7 metric=0.7012 head_norm=1.312131
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.234782e-01
[S9] stored merged vector for next round verification (round=7)
[S9] DEBUG after merge:  round=7 metric=0.7012 head_norm=1.343879 delta_norm=0.423478
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=7 metric=0.5376 head_norm=1.358860
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.560364e-01
[S8] stored merged vector for next round verification (round=7)
[S8] DEBUG after merge:  round=7 metric=0.3729 head_norm=0.803012 delta_norm=0.756036
[S8] aggregate: ROLLBACK (f1_val pre=0.538 post=0.373 tol_abs=0.005 tol_rel=0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=7 metric=0.7008 head_norm=0.938762
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.396494e-01
[S3] stored merged vector for next round verification (round=7)
[S3] DEBUG after merge:  round=7 metric=0.7008 head_norm=0.977106 delta_norm=0.639649
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=1.075779 cos_to_last_merge=0.9888 (last merge round=5)
[S2] round=8 local utility u=0.040418 metrics={'f1_val': 0.41723108036439727, 'auprc': 0.7712578571142501, 'loss_val': 0.9819916083965751, 'psi': 0.5588417910643384}-{'f1_val': 0.4169384018324798, 'auprc': 0.7755242734461741, 'loss_val': 1.0738699166766104, 'psi': 0.5603727504779576}
[S3] START round=8 head_norm_before_train=0.977106 cos_to_last_merge=1.0000 (last merge round=7)
[S3] round=8 local utility u=0.034719 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.660802647417113, 'loss_val': 0.4604929415422292, 'psi': 0.6847296347660461}-{'f1_val': 0.7008317350254774, 'auprc': 0.6608593122007709, 'loss_val': 0.5310057932264336, 'psi': 0.6848427658955948}
[S4] START round=8 head_norm_before_train=1.472155 (no previous merge yet)
[S4] round=8 local utility u=0.055274 metrics={'f1_val': 0.6685393394427216, 'auprc': 0.6599440950703823, 'loss_val': 0.5039084350792749, 'psi': 0.6651012416937858}-{'f1_val': 0.6654541500316433, 'auprc': 0.6628263095720451, 'loss_val': 0.6045909830152555, 'psi': 0.6644030138478041}
[S5] START round=8 head_norm_before_train=1.499668 (no previous merge yet)
[S5] round=8 local utility u=0.301031 metrics={'f1_val': 0.7008569501491988, 'auprc': 0.9798526442669804, 'loss_val': 0.3766899100477516, 'psi': 0.8124552277963114}-{'f1_val': 0.7008569501491988, 'auprc': 0.7963509891690675, 'loss_val': 0.42824758847853167, 'psi': 0.7390545657571463}
[S6] START round=8 head_norm_before_train=0.765726 cos_to_last_merge=0.9960 (last merge round=6)
[S6] round=8 local utility u=0.868812 metrics={'f1_val': 0.41625250229074906, 'auprc': 0.6148716792707511, 'loss_val': 1.0105002678175967, 'psi': 0.49570017308274994}-{'f1_val': 0.14142628205128205, 'auprc': 0.6135846873141644, 'loss_val': 1.0953066023857383, 'psi': 0.33028964415643497}
[S7] START round=8 head_norm_before_train=0.754080 cos_to_last_merge=0.9844 (last merge round=6)
[S7] round=8 local utility u=0.121548 metrics={'f1_val': 0.7140699654073116, 'auprc': 0.8991918547297081, 'loss_val': 0.6799764735311268, 'psi': 0.7881187211362701}-{'f1_val': 0.7139737313795297, 'auprc': 0.8604549556832763, 'loss_val': 0.8062844197420399, 'psi': 0.7725662211010283}
[S8] START round=8 head_norm_before_train=0.803012 cos_to_last_merge=1.0000 (last merge round=7)
[S8] round=8 local utility u=0.000000 metrics={'f1_val': 0.3728657005221765, 'auprc': 0.8563977799279694, 'loss_val': 0.8645054620565564, 'psi': 0.5662785322844937}-{'f1_val': 0.5376440565306186, 'auprc': 0.9879057886367029, 'loss_val': 0.7481345767676947, 'psi': 0.7177487493730523}
[S9] START round=8 head_norm_before_train=1.343879 cos_to_last_merge=1.0000 (last merge round=7)
[S9] round=8 local utility u=0.781035 metrics={'f1_val': 0.9603486939255602, 'auprc': 0.9979601383009311, 'loss_val': 0.3020367458303689, 'psi': 0.9753932716757086}-{'f1_val': 0.7012165807733519, 'auprc': 0.9986458781824439, 'loss_val': 0.3113704327133412, 'psi': 0.8201882997369887}
[S10] START round=8 head_norm_before_train=0.717086 cos_to_last_merge=1.0000 (last merge round=7)
[S10] round=8 local utility u=0.000000 metrics={'f1_val': 0.37768925423885746, 'auprc': 0.635593335235669, 'loss_val': 1.0289446032938414, 'psi': 0.480850886637582}-{'f1_val': 0.41666239191319776, 'auprc': 0.6312184644371278, 'loss_val': 1.072898463258718, 'psi': 0.5024848209227698}
[S11] START round=8 head_norm_before_train=1.346144 (no previous merge yet)
[S11] round=8 local utility u=0.995408 metrics={'f1_val': 0.632627085653364, 'auprc': 0.969072294690082, 'loss_val': 0.7032873084815158, 'psi': 0.7672051692680513}-{'f1_val': 0.42536078646606834, 'auprc': 0.7692692131178611, 'loss_val': 0.8510954811223316, 'psi': 0.5629241571267855}
[S13] START round=8 head_norm_before_train=0.927323 cos_to_last_merge=0.9619 (last merge round=2)
[S13] round=8 local utility u=0.156826 metrics={'f1_val': 0.41580726865236384, 'auprc': 0.5954013915579813, 'loss_val': 0.8678216101560128, 'psi': 0.48764491781461083}-{'f1_val': 0.416200286011302, 'auprc': 0.5287485607890953, 'loss_val': 0.983873600689338, 'psi': 0.4612195959224193}
[S14] START round=8 head_norm_before_train=1.394654 (no previous merge yet)
[S14] round=8 local utility u=0.615556 metrics={'f1_val': 0.5270535937180048, 'auprc': 0.9773501666658434, 'loss_val': 0.7425951251478202, 'psi': 0.7071722228971402}-{'f1_val': 0.39649470961585787, 'auprc': 0.906323439633644, 'loss_val': 0.9772734635667465, 'psi': 0.6004262016229723}
[S15] START round=8 head_norm_before_train=0.607584 cos_to_last_merge=1.0000 (last merge round=7)
[S15] round=8 local utility u=0.000000 metrics={'f1_val': 0.38998180482756317, 'auprc': 0.8000858842293886, 'loss_val': 1.1440623395688099, 'psi': 0.5540234365882933}-{'f1_val': 0.416110637094998, 'auprc': 0.8000612041603969, 'loss_val': 1.1678724168235655, 'psi': 0.5696908639211576}
[S16] START round=8 head_norm_before_train=0.970832 cos_to_last_merge=0.9481 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.948
[S16] round=8 local utility u=0.000000 metrics={'f1_val': 0.3129179389856407, 'auprc': 0.5581897748298773, 'loss_val': 0.9865051727690285, 'psi': 0.4110266733233353}-{'f1_val': 0.4173069283424069, 'auprc': 0.5238118525086229, 'loss_val': 1.0320162082218964, 'psi': 0.45990889800889334}
[S17] START round=8 head_norm_before_train=1.015916 cos_to_last_merge=0.9292 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.929
[S17] round=8 local utility u=0.426136 metrics={'f1_val': 0.3923925412536985, 'auprc': 0.8393313358297912, 'loss_val': 0.9466227496399316, 'psi': 0.5711680590841356}-{'f1_val': 0.3844942044408102, 'auprc': 0.614315306087959, 'loss_val': 1.0764576255149454, 'psi': 0.47642264509966975}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S13] → sending delta(kind=head bytes=1792) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:57009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] → sending delta(kind=head bytes=1793) to S10@127.0.0.1:57011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:57008
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:57015
[S7] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1794 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1793 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1792 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1795) from S14
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.446774)
[S6] loaded HEAD from S14 (vec_in norm=1.446774)
[S6] cosine check vs S14: cos=-0.0764
[S6] DROPPED delta from S14 (cos=-0.0764 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1796) from S7
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.824369)
[S15] loaded HEAD from S7 (vec_in norm=0.824369)
[S15] cosine check vs S7: cos=0.4473
[S15] BUFFERED delta from S7 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1799) from S3
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.052535)
[S15] loaded HEAD from S3 (vec_in norm=1.052535)
[S15] cosine check vs S3: cos=0.6244
[S15] BUFFERED delta from S3 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1792) from S13
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=0.971684)
[S15] loaded HEAD from S13 (vec_in norm=0.971684)
[S15] cosine check vs S13: cos=0.4749
[S15] BUFFERED delta from S13 (total buffered=3)
[S9] RECEIVED delta(kind=head bytes=1800) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.548389)
[S9] loaded HEAD from S5 (vec_in norm=1.548389)
[S9] cosine check vs S5: cos=0.9304
[S9] BUFFERED delta from S5 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1794) from S6
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.803444)
[S8] loaded HEAD from S6 (vec_in norm=0.803444)
[S8] cosine check vs S6: cos=0.5098
[S8] BUFFERED delta from S6 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1802) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.407785)
[S3] loaded HEAD from S9 (vec_in norm=1.407785)
[S3] cosine check vs S9: cos=0.3064
[S3] BUFFERED delta from S9 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1801) from S11
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.386623)
[S7] loaded HEAD from S11 (vec_in norm=1.386623)
[S7] cosine check vs S11: cos=-0.0431
[S7] DROPPED delta from S11 (cos=-0.0431 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1802) from S4
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.532294)
[S2] loaded HEAD from S4 (vec_in norm=1.532294)
[S2] cosine check vs S4: cos=0.9068
[S2] BUFFERED delta from S4 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1793) from S2
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.114552)
[S10] loaded HEAD from S2 (vec_in norm=1.114552)
[S10] cosine check vs S2: cos=0.8467
[S10] BUFFERED delta from S2 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:57009
[S17] sending update (kind=head size=1796 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1796) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.059824)
[S8] loaded HEAD from S17 (vec_in norm=1.059824)
[S8] cosine check vs S17: cos=-0.0355
[S8] DROPPED delta from S17 (cos=-0.0355 < 0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=8 metric=0.3777 head_norm=0.744619
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.127573e-01
[S10] stored merged vector for next round verification (round=8)
[S10] DEBUG after merge:  round=8 metric=0.3777 head_norm=0.894720 delta_norm=0.312757
[S10] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=8 metric=0.3729 head_norm=0.857323
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.117497e-01
[S8] stored merged vector for next round verification (round=8)
[S8] DEBUG after merge:  round=8 metric=0.3729 head_norm=0.721613 delta_norm=0.411750
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=8 metric=0.3900 head_norm=0.635741
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.369538e-01
[S15] stored merged vector for next round verification (round=8)
[S15] DEBUG after merge:  round=8 metric=0.3900 head_norm=0.597824 delta_norm=0.236954
[S15] aggregate: ACCEPT kept=['S7', 'S3', 'S13'] (k=3/3) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=8 metric=0.4172 head_norm=1.114552
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.510639e-01
[S2] stored merged vector for next round verification (round=8)
[S2] DEBUG after merge:  round=8 metric=0.4170 head_norm=1.292992 delta_norm=0.351064
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=8 metric=0.9603 head_norm=1.407785
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.842807e-01
[S9] stored merged vector for next round verification (round=8)
[S9] DEBUG after merge:  round=8 metric=0.9119 head_norm=1.452194 delta_norm=0.284281
[S9] aggregate: ROLLBACK (f1_val pre=0.960 post=0.912 tol_abs=0.005 tol_rel=0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=8 metric=0.7007 head_norm=1.052535
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.385380e-01
[S3] stored merged vector for next round verification (round=8)
[S3] DEBUG after merge:  round=8 metric=0.7007 head_norm=0.999703 delta_norm=0.738538
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.292992 cos_to_last_merge=1.0000 (last merge round=8)
[S2] round=9 local utility u=0.543528 metrics={'f1_val': 0.6032003476072679, 'auprc': 0.7094938546610114, 'loss_val': 0.8254582448031538, 'psi': 0.6457177504287653}-{'f1_val': 0.41723108036439727, 'auprc': 0.7712578571142501, 'loss_val': 0.9819916083965751, 'psi': 0.5588417910643384}
[S3] START round=9 head_norm_before_train=0.999703 cos_to_last_merge=1.0000 (last merge round=8)
[S3] round=9 local utility u=0.046077 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.6894854696333392, 'loss_val': 0.4543880312215445, 'psi': 0.6962027636525365}-{'f1_val': 0.7006809596653347, 'auprc': 0.660802647417113, 'loss_val': 0.4604929415422292, 'psi': 0.6847296347660461}
[S4] START round=9 head_norm_before_train=1.532294 (no previous merge yet)
[S4] round=9 local utility u=0.032990 metrics={'f1_val': 0.6708547531849489, 'auprc': 0.6588039736265288, 'loss_val': 0.44840022175400457, 'psi': 0.6660344413615809}-{'f1_val': 0.6685393394427216, 'auprc': 0.6599440950703823, 'loss_val': 0.5039084350792749, 'psi': 0.6651012416937858}
[S5] START round=9 head_norm_before_train=1.548389 (no previous merge yet)
[S5] round=9 local utility u=0.049798 metrics={'f1_val': 0.7008569501491988, 'auprc': 0.9957500421421621, 'loss_val': 0.3247854806033205, 'psi': 0.8188141869463841}-{'f1_val': 0.7008569501491988, 'auprc': 0.9798526442669804, 'loss_val': 0.3766899100477516, 'psi': 0.8124552277963114}
[S6] START round=9 head_norm_before_train=0.803444 cos_to_last_merge=0.9847 (last merge round=6)
[S6] round=9 local utility u=1.000000 metrics={'f1_val': 0.69803868080462, 'auprc': 0.7858441514653348, 'loss_val': 0.7964099641009663, 'psi': 0.7331608690689059}-{'f1_val': 0.41625250229074906, 'auprc': 0.6148716792707511, 'loss_val': 1.0105002678175967, 'psi': 0.49570017308274994}
[S7] START round=9 head_norm_before_train=0.824369 cos_to_last_merge=0.9608 (last merge round=6)
[S7] round=9 local utility u=0.000000 metrics={'f1_val': 0.6838127623831034, 'auprc': 0.8686506806105948, 'loss_val': 0.6296603637005375, 'psi': 0.7577479296740999}-{'f1_val': 0.7140699654073116, 'auprc': 0.8991918547297081, 'loss_val': 0.6799764735311268, 'psi': 0.7881187211362701}
[S8] START round=9 head_norm_before_train=0.721613 cos_to_last_merge=1.0000 (last merge round=8)
[S8] round=9 local utility u=0.133057 metrics={'f1_val': 0.3726652774371328, 'auprc': 0.9522213242612291, 'loss_val': 0.8846593908392117, 'psi': 0.6044876961667713}-{'f1_val': 0.3728657005221765, 'auprc': 0.8563977799279694, 'loss_val': 0.8645054620565564, 'psi': 0.5662785322844937}
[S9] START round=9 head_norm_before_train=1.452194 cos_to_last_merge=1.0000 (last merge round=8)
[S9] round=9 local utility u=0.100311 metrics={'f1_val': 0.9892304409695105, 'auprc': 0.9978756436796968, 'loss_val': 0.27445155064454013, 'psi': 0.992688522053585}-{'f1_val': 0.9603486939255602, 'auprc': 0.9979601383009311, 'loss_val': 0.3020367458303689, 'psi': 0.9753932716757086}
[S10] START round=9 head_norm_before_train=0.894720 cos_to_last_merge=1.0000 (last merge round=8)
[S10] round=9 local utility u=0.443563 metrics={'f1_val': 0.41145576934582695, 'auprc': 0.8298283725665635, 'loss_val': 0.9271230297494494, 'psi': 0.5788048106341216}-{'f1_val': 0.37768925423885746, 'auprc': 0.635593335235669, 'loss_val': 1.0289446032938414, 'psi': 0.480850886637582}
[S11] START round=9 head_norm_before_train=1.386623 (no previous merge yet)
[S11] round=9 local utility u=0.272264 metrics={'f1_val': 0.6953556265277978, 'auprc': 0.9922450289872748, 'loss_val': 0.6046478860396286, 'psi': 0.8141113875115886}-{'f1_val': 0.632627085653364, 'auprc': 0.969072294690082, 'loss_val': 0.7032873084815158, 'psi': 0.7672051692680513}
[S13] START round=9 head_norm_before_train=0.971684 cos_to_last_merge=0.9469 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.947
[S13] round=9 local utility u=0.000000 metrics={'f1_val': 0.41580726865236384, 'auprc': 0.5486792835151628, 'loss_val': 0.8478962697704474, 'psi': 0.46895607459748345}-{'f1_val': 0.41580726865236384, 'auprc': 0.5954013915579813, 'loss_val': 0.8678216101560128, 'psi': 0.48764491781461083}
[S14] START round=9 head_norm_before_train=1.446774 (no previous merge yet)
[S14] round=9 local utility u=0.660713 metrics={'f1_val': 0.7014034605172974, 'auprc': 0.9990679960231602, 'loss_val': 0.532421402057989, 'psi': 0.8204692747196425}-{'f1_val': 0.5270535937180048, 'auprc': 0.9773501666658434, 'loss_val': 0.7425951251478202, 'psi': 0.7071722228971402}
[S15] START round=9 head_norm_before_train=0.597824 cos_to_last_merge=1.0000 (last merge round=8)
[S15] round=9 local utility u=0.343457 metrics={'f1_val': 0.48152621557656666, 'auprc': 0.7989088749719148, 'loss_val': 1.0028832661633476, 'psi': 0.6084792793347059}-{'f1_val': 0.38998180482756317, 'auprc': 0.8000858842293886, 'loss_val': 1.1440623395688099, 'psi': 0.5540234365882933}
[S16] START round=9 head_norm_before_train=1.018218 cos_to_last_merge=0.9309 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.931
[S16] round=9 local utility u=0.474196 metrics={'f1_val': 0.38597974762923215, 'auprc': 0.7086065032843103, 'loss_val': 0.9277351175480707, 'psi': 0.5150304498912635}-{'f1_val': 0.3129179389856407, 'auprc': 0.5581897748298773, 'loss_val': 0.9865051727690285, 'psi': 0.4110266733233353}
[S17] START round=9 head_norm_before_train=1.059824 cos_to_last_merge=0.9099 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.910
[S17] round=9 local utility u=0.000000 metrics={'f1_val': 0.3580280062609892, 'auprc': 0.799051761358736, 'loss_val': 0.8664338156399031, 'psi': 0.534437508300088}-{'f1_val': 0.3923925412536985, 'auprc': 0.8393313358297912, 'loss_val': 0.9466227496399316, 'psi': 0.5711680590841356}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:57011
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S10@127.0.0.1:57011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:57009
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:57008
[S11] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1794 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1794 to 1 peers)
[S2] sending update (kind=head size=1794 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1801) from S14
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.505597)
[S6] loaded HEAD from S14 (vec_in norm=1.505597)
[S6] cosine check vs S14: cos=-0.0818
[S6] DROPPED delta from S14 (cos=-0.0818 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1794) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.063257)
[S6] loaded HEAD from S16 (vec_in norm=1.063257)
[S6] cosine check vs S16: cos=0.8058
[S6] BUFFERED delta from S16 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1796) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.772850)
[S3] loaded HEAD from S8 (vec_in norm=0.772850)
[S3] cosine check vs S8: cos=0.5041
[S3] BUFFERED delta from S8 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1800) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.505151)
[S3] loaded HEAD from S9 (vec_in norm=1.505151)
[S3] cosine check vs S9: cos=0.8071
[S3] BUFFERED delta from S9 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1801) from S3
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.068155)
[S15] loaded HEAD from S3 (vec_in norm=1.068155)
[S15] cosine check vs S3: cos=0.5254
[S15] BUFFERED delta from S3 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1802) from S4
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.587535)
[S2] loaded HEAD from S4 (vec_in norm=1.587535)
[S2] cosine check vs S4: cos=0.9714
[S2] BUFFERED delta from S4 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1803) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.577250)
[S9] loaded HEAD from S5 (vec_in norm=1.577250)
[S9] cosine check vs S5: cos=0.9596
[S9] BUFFERED delta from S5 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1799) from S6
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.848671)
[S8] loaded HEAD from S6 (vec_in norm=0.848671)
[S8] cosine check vs S6: cos=0.8108
[S8] BUFFERED delta from S6 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1801) from S11
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.427356)
[S7] loaded HEAD from S11 (vec_in norm=1.427356)
[S7] cosine check vs S11: cos=-0.0471
[S7] DROPPED delta from S11 (cos=-0.0471 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1794) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=0.920194)
[S7] loaded HEAD from S10 (vec_in norm=0.920194)
[S7] cosine check vs S10: cos=0.3979
[S7] BUFFERED delta from S10 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1794) from S2
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.325379)
[S10] loaded HEAD from S2 (vec_in norm=1.325379)
[S10] cosine check vs S2: cos=0.9193
[S10] BUFFERED delta from S2 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1803) from S15
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.636259)
[S10] loaded HEAD from S15 (vec_in norm=0.636259)
[S10] cosine check vs S15: cos=0.1228
[S10] BUFFERED delta from S15 (total buffered=2)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=9 metric=0.6838 head_norm=0.890087
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.967776e-01
[S7] stored merged vector for next round verification (round=9)
[S7] DEBUG after merge:  round=9 metric=0.7000 head_norm=0.756781 delta_norm=0.496778
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=9 metric=0.4115 head_norm=0.920194
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.999229e-01
[S10] stored merged vector for next round verification (round=9)
[S10] DEBUG after merge:  round=9 metric=0.4115 head_norm=0.797799 delta_norm=0.199923
[S10] aggregate: ACCEPT kept=['S2', 'S15'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=9 metric=0.3727 head_norm=0.772850
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.519722e-01
[S8] stored merged vector for next round verification (round=9)
[S8] DEBUG after merge:  round=9 metric=0.3727 head_norm=0.771544 delta_norm=0.251972
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=9 metric=0.9892 head_norm=1.505151
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.218094e-01
[S9] stored merged vector for next round verification (round=9)
[S9] DEBUG after merge:  round=9 metric=0.9901 head_norm=1.525581 delta_norm=0.221809
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=9 metric=0.4815 head_norm=0.636259
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.559760e-01
[S15] stored merged vector for next round verification (round=9)
[S15] DEBUG after merge:  round=9 metric=0.3900 head_norm=0.751649 delta_norm=0.455976
[S15] aggregate: ROLLBACK (f1_val pre=0.482 post=0.390 tol_abs=0.005 tol_rel=0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=9 metric=0.6980 head_norm=0.848671
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.148168e-01
[S6] stored merged vector for next round verification (round=9)
[S6] DEBUG after merge:  round=9 metric=0.7016 head_norm=0.908994 delta_norm=0.314817
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=9 metric=0.6032 head_norm=1.325379
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.175145e-01
[S2] stored merged vector for next round verification (round=9)
[S2] DEBUG after merge:  round=9 metric=0.5286 head_norm=1.446076 delta_norm=0.217515
[S2] aggregate: ROLLBACK (f1_val pre=0.603 post=0.529 tol_abs=0.005 tol_rel=0.0)
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=9 metric=0.7007 head_norm=1.068155
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.424742e-01
[S3] stored merged vector for next round verification (round=9)
[S3] DEBUG after merge:  round=9 metric=0.7007 head_norm=0.956890 delta_norm=0.242474
[S3] aggregate: ACCEPT kept=['S8', 'S9'] (k=2/2) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.446076 cos_to_last_merge=1.0000 (last merge round=9)
[S2] round=10 local utility u=0.487907 metrics={'f1_val': 0.7142346795039252, 'auprc': 0.7753200295399081, 'loss_val': 0.7133293982121309, 'psi': 0.7386688195183184}-{'f1_val': 0.6032003476072679, 'auprc': 0.7094938546610114, 'loss_val': 0.8254582448031538, 'psi': 0.6457177504287653}
[S3] START round=10 head_norm_before_train=0.956890 cos_to_last_merge=1.0000 (last merge round=9)
[S3] round=10 local utility u=0.294620 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.8765244071793246, 'loss_val': 0.42626437497381847, 'psi': 0.7710183386709306}-{'f1_val': 0.7006809596653347, 'auprc': 0.6894854696333392, 'loss_val': 0.4543880312215445, 'psi': 0.6962027636525365}
[S4] START round=10 head_norm_before_train=1.587535 (no previous merge yet)
[S4] round=10 local utility u=0.093995 metrics={'f1_val': 0.6658125709632774, 'auprc': 0.7508398457644708, 'loss_val': 0.5062652763642075, 'psi': 0.6998234808837548}-{'f1_val': 0.6708547531849489, 'auprc': 0.6588039736265288, 'loss_val': 0.44840022175400457, 'psi': 0.6660344413615809}
[S5] START round=10 head_norm_before_train=1.577250 (no previous merge yet)
[S5] round=10 local utility u=0.008733 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.992188386701284, 'loss_val': 0.2951422087544721, 'psi': 0.8172403902781182}-{'f1_val': 0.7008569501491988, 'auprc': 0.9957500421421621, 'loss_val': 0.3247854806033205, 'psi': 0.8188141869463841}
[S6] START round=10 head_norm_before_train=0.908994 cos_to_last_merge=1.0000 (last merge round=9)
[S6] round=10 local utility u=0.000000 metrics={'f1_val': 0.6198187576752905, 'auprc': 0.785457768317114, 'loss_val': 0.7669642677742945, 'psi': 0.68607436193202}-{'f1_val': 0.69803868080462, 'auprc': 0.7858441514653348, 'loss_val': 0.7964099641009663, 'psi': 0.7331608690689059}
[S7] START round=10 head_norm_before_train=0.756781 cos_to_last_merge=1.0000 (last merge round=9)
[S7] round=10 local utility u=0.121123 metrics={'f1_val': 0.7137073324812948, 'auprc': 0.8838554987313432, 'loss_val': 0.6123955354357996, 'psi': 0.7817665989813142}-{'f1_val': 0.6838127623831034, 'auprc': 0.8686506806105948, 'loss_val': 0.6296603637005375, 'psi': 0.7577479296740999}
[S8] START round=10 head_norm_before_train=0.771544 cos_to_last_merge=1.0000 (last merge round=9)
[S8] round=10 local utility u=0.109600 metrics={'f1_val': 0.3726652774371328, 'auprc': 0.9957802592443317, 'loss_val': 0.7961371896916163, 'psi': 0.6219112701600124}-{'f1_val': 0.3726652774371328, 'auprc': 0.9522213242612291, 'loss_val': 0.8846593908392117, 'psi': 0.6044876961667713}
[S9] START round=10 head_norm_before_train=1.525581 cos_to_last_merge=1.0000 (last merge round=9)
[S9] round=10 local utility u=0.007290 metrics={'f1_val': 0.9879970276931102, 'auprc': 0.997894171718529, 'loss_val': 0.2525266820951415, 'psi': 0.9919558853032777}-{'f1_val': 0.9892304409695105, 'auprc': 0.9978756436796968, 'loss_val': 0.27445155064454013, 'psi': 0.992688522053585}
[S10] START round=10 head_norm_before_train=0.797799 cos_to_last_merge=1.0000 (last merge round=9)
[S10] round=10 local utility u=0.979927 metrics={'f1_val': 0.6998387566314846, 'auprc': 0.8626255048906457, 'loss_val': 0.7959579473849862, 'psi': 0.7649534559351491}-{'f1_val': 0.41145576934582695, 'auprc': 0.8298283725665635, 'loss_val': 0.9271230297494494, 'psi': 0.5788048106341216}
[S11] START round=10 head_norm_before_train=1.427356 (no previous merge yet)
[S11] round=10 local utility u=0.079578 metrics={'f1_val': 0.7018246587012323, 'auprc': 0.9964793750716383, 'loss_val': 0.4970089329411888, 'psi': 0.8196865452493947}-{'f1_val': 0.6953556265277978, 'auprc': 0.9922450289872748, 'loss_val': 0.6046478860396286, 'psi': 0.8141113875115886}
[S13] START round=10 head_norm_before_train=1.016594 cos_to_last_merge=0.9325 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.932
[S13] round=10 local utility u=0.219730 metrics={'f1_val': 0.41580726865236384, 'auprc': 0.6761150645942913, 'loss_val': 0.7907432570929078, 'psi': 0.5199303870291349}-{'f1_val': 0.41580726865236384, 'auprc': 0.5486792835151628, 'loss_val': 0.8478962697704474, 'psi': 0.46895607459748345}
[S14] START round=10 head_norm_before_train=1.505597 (no previous merge yet)
[S14] round=10 local utility u=0.075541 metrics={'f1_val': 0.7020620161542324, 'auprc': 0.9962954922547742, 'loss_val': 0.3769733384288217, 'psi': 0.8197554065944491}-{'f1_val': 0.7014034605172974, 'auprc': 0.9990679960231602, 'loss_val': 0.532421402057989, 'psi': 0.8204692747196425}
[S15] START round=10 head_norm_before_train=0.751649 cos_to_last_merge=1.0000 (last merge round=9)
[S15] round=10 local utility u=0.674163 metrics={'f1_val': 0.6983630157419677, 'auprc': 0.7996887625712027, 'loss_val': 0.9579184315603897, 'psi': 0.7388933144736617}-{'f1_val': 0.48152621557656666, 'auprc': 0.7989088749719148, 'loss_val': 1.0028832661633476, 'psi': 0.6084792793347059}
[S16] START round=10 head_norm_before_train=1.063257 cos_to_last_merge=0.9159 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.916
[S16] round=10 local utility u=0.206712 metrics={'f1_val': 0.4181478986425249, 'auprc': 0.7567642294427692, 'loss_val': 0.851793293227731, 'psi': 0.5535944309626226}-{'f1_val': 0.38597974762923215, 'auprc': 0.7086065032843103, 'loss_val': 0.9277351175480707, 'psi': 0.5150304498912635}
[S17] START round=10 head_norm_before_train=1.104029 cos_to_last_merge=0.8887 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.889
[S17] round=10 local utility u=0.000000 metrics={'f1_val': 0.35469327811000995, 'auprc': 0.6432877882773338, 'loss_val': 0.8538214436833079, 'psi': 0.4701310821769395}-{'f1_val': 0.3580280062609892, 'auprc': 0.799051761358736, 'loss_val': 0.8664338156399031, 'psi': 0.534437508300088}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S10@127.0.0.1:57011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] → sending delta(kind=head bytes=1805) to S10@127.0.0.1:57011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:57010
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:57015
[S9] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1805 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1797) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=0.835943)
[S7] loaded HEAD from S10 (vec_in norm=0.835943)
[S7] cosine check vs S10: cos=0.8158
[S7] BUFFERED delta from S10 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1803) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.608530)
[S9] loaded HEAD from S5 (vec_in norm=1.608530)
[S9] cosine check vs S5: cos=0.9681
[S9] BUFFERED delta from S5 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1802) from S11
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.463543)
[S7] loaded HEAD from S11 (vec_in norm=1.463543)
[S7] cosine check vs S11: cos=0.0017
[S7] BUFFERED delta from S11 (total buffered=2)
[S2] RECEIVED delta(kind=head bytes=1799) from S4
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.625535)
[S2] loaded HEAD from S4 (vec_in norm=1.625535)
[S2] cosine check vs S4: cos=0.9870
[S2] BUFFERED delta from S4 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1805) from S2
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.481128)
[S10] loaded HEAD from S2 (vec_in norm=1.481128)
[S10] cosine check vs S2: cos=0.8781
[S10] BUFFERED delta from S2 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1804) from S15
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.779422)
[S10] loaded HEAD from S15 (vec_in norm=0.779422)
[S10] cosine check vs S15: cos=0.1370
[S10] BUFFERED delta from S15 (total buffered=2)
[S6] RECEIVED delta(kind=head bytes=1799) from S14
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.559976)
[S6] loaded HEAD from S14 (vec_in norm=1.559976)
[S6] cosine check vs S14: cos=-0.0727
[S6] DROPPED delta from S14 (cos=-0.0727 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1802) from S3
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.026937)
[S15] loaded HEAD from S3 (vec_in norm=1.026937)
[S15] cosine check vs S3: cos=0.8927
[S15] BUFFERED delta from S3 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1801) from S13
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.048594)
[S15] loaded HEAD from S13 (vec_in norm=1.048594)
[S15] cosine check vs S13: cos=0.3341
[S15] BUFFERED delta from S13 (total buffered=2)
[S6] RECEIVED delta(kind=head bytes=1803) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.107040)
[S6] loaded HEAD from S16 (vec_in norm=1.107040)
[S6] cosine check vs S16: cos=0.9356
[S6] BUFFERED delta from S16 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1798) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.818891)
[S3] loaded HEAD from S8 (vec_in norm=0.818891)
[S3] cosine check vs S8: cos=0.5575
[S3] BUFFERED delta from S8 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1800) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.575812)
[S3] loaded HEAD from S9 (vec_in norm=1.575812)
[S3] cosine check vs S9: cos=0.8210
[S3] BUFFERED delta from S9 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1800) from S7
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.816666)
[S15] loaded HEAD from S7 (vec_in norm=0.816666)
[S15] cosine check vs S7: cos=0.1822
[S15] BUFFERED delta from S7 (total buffered=3)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=10 metric=0.6198 head_norm=0.943411
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.007736e-01
[S6] stored merged vector for next round verification (round=10)
[S6] DEBUG after merge:  round=10 metric=0.4643 head_norm=1.008698 delta_norm=0.200774
[S6] aggregate: ROLLBACK (f1_val pre=0.620 post=0.464 tol_abs=0.005 tol_rel=0.0)
[S6] ⇄ pheromone p=0.388 → S8@127.0.0.1:57009
[S11] ⇄ pheromone p=0.390 → S7@127.0.0.1:57008
[S16] ⇄ pheromone p=0.300 → S6@127.0.0.1:57007
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=10 metric=0.9880 head_norm=1.575812
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.017935e-01
[S9] stored merged vector for next round verification (round=10)
[S9] DEBUG after merge:  round=10 metric=0.9888 head_norm=1.579416 delta_norm=0.201793
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.376 → S3@127.0.0.1:57003
[S8] ⇄ pheromone p=0.325 → S3@127.0.0.1:57003
[S14] ⇄ pheromone p=0.433 → S6@127.0.0.1:57007
[S5] ⇄ pheromone p=0.276 → S9@127.0.0.1:57010
[S15] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=10 metric=0.6984 head_norm=0.779422
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.917048e-01
[S15] stored merged vector for next round verification (round=10)
[S15] DEBUG after merge:  round=10 metric=0.6979 head_norm=0.645136 delta_norm=0.291705
[S15] aggregate: ACCEPT kept=['S3', 'S13', 'S7'] (k=3/3) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.402 → S10@127.0.0.1:57011
[S13] ⇄ pheromone p=0.252 → S15@127.0.0.1:57015
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=10 metric=0.7142 head_norm=1.481128
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.443343e-01
[S2] stored merged vector for next round verification (round=10)
[S2] DEBUG after merge:  round=10 metric=0.7142 head_norm=1.548295 delta_norm=0.144334
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.416 → S10@127.0.0.1:57011
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=10 metric=0.7137 head_norm=0.816666
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.603256e-01
[S7] stored merged vector for next round verification (round=10)
[S7] DEBUG after merge:  round=10 metric=0.7136 head_norm=0.700971 delta_norm=0.460326
[S7] aggregate: ACCEPT kept=['S10', 'S11'] (k=2/2) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.305 → S15@127.0.0.1:57015
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=10 metric=0.7007 head_norm=1.026937
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.104370e-01
[S3] stored merged vector for next round verification (round=10)
[S3] DEBUG after merge:  round=10 metric=0.7007 head_norm=0.971088 delta_norm=0.210437
[S3] aggregate: ACCEPT kept=['S8', 'S9'] (k=2/2) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.276 → S15@127.0.0.1:57015
[S4] ⇄ pheromone p=0.219 → S2@127.0.0.1:57002
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=10 metric=0.6998 head_norm=0.835943
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.014672e-01
[S10] stored merged vector for next round verification (round=10)
[S10] DEBUG after merge:  round=10 metric=0.7001 head_norm=0.792971 delta_norm=0.201467
[S10] aggregate: ACCEPT kept=['S2', 'S15'] (k=2/2) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.474 → S7@127.0.0.1:57008
[S17] ⇄ pheromone p=0.278 → S8@127.0.0.1:57009
[S2] START round=11 head_norm_before_train=1.548295 cos_to_last_merge=1.0000 (last merge round=10)
[S2] round=11 local utility u=0.000000 metrics={'f1_val': 0.7012900746650139, 'auprc': 0.7050248600999562, 'loss_val': 0.5392161665558948, 'psi': 0.7027839888389908}-{'f1_val': 0.7142346795039252, 'auprc': 0.7753200295399081, 'loss_val': 0.7133293982121309, 'psi': 0.7386688195183184}
[S3] START round=11 head_norm_before_train=0.971088 cos_to_last_merge=1.0000 (last merge round=10)
[S3] round=11 local utility u=0.046137 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.8968382663366499, 'loss_val': 0.39493194287095623, 'psi': 0.7791438823338608}-{'f1_val': 0.7006809596653347, 'auprc': 0.8765244071793246, 'loss_val': 0.42626437497381847, 'psi': 0.7710183386709306}
[S4] START round=11 head_norm_before_train=1.625535 (no previous merge yet)
[S4] round=11 local utility u=0.311581 metrics={'f1_val': 0.6676542160172332, 'auprc': 0.9508659248703456, 'loss_val': 0.49423232731233574, 'psi': 0.7809388995584782}-{'f1_val': 0.6658125709632774, 'auprc': 0.7508398457644708, 'loss_val': 0.5062652763642075, 'psi': 0.6998234808837548}
[S5] START round=11 head_norm_before_train=1.608530 (no previous merge yet)
[S5] round=11 local utility u=0.011644 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.9931554497699163, 'loss_val': 0.274760553231174, 'psi': 0.817627636311435}-{'f1_val': 0.7006083926626743, 'auprc': 0.992188386701284, 'loss_val': 0.2951422087544721, 'psi': 0.8172403902781182}
[S6] START round=11 head_norm_before_train=1.008698 cos_to_last_merge=1.0000 (last merge round=10)
[S6] round=11 local utility u=1.000000 metrics={'f1_val': 0.8783527963918043, 'auprc': 0.9636847876612036, 'loss_val': 0.641688961701234, 'psi': 0.912485592899564}-{'f1_val': 0.6198187576752905, 'auprc': 0.785457768317114, 'loss_val': 0.7669642677742945, 'psi': 0.68607436193202}
[S7] START round=11 head_norm_before_train=0.700971 cos_to_last_merge=1.0000 (last merge round=10)
[S7] round=11 local utility u=0.000000 metrics={'f1_val': 0.44639531420593787, 'auprc': 0.795603070031659, 'loss_val': 0.9652144690392203, 'psi': 0.5860784165362263}-{'f1_val': 0.7137073324812948, 'auprc': 0.8838554987313432, 'loss_val': 0.6123955354357996, 'psi': 0.7817665989813142}
[S8] START round=11 head_norm_before_train=0.818891 cos_to_last_merge=0.9918 (last merge round=9)
[S8] round=11 local utility u=1.000000 metrics={'f1_val': 0.7142391053978291, 'auprc': 0.9715800105801508, 'loss_val': 0.609741293529512, 'psi': 0.8171754674707579}-{'f1_val': 0.3726652774371328, 'auprc': 0.9957802592443317, 'loss_val': 0.7961371896916163, 'psi': 0.6219112701600124}
[S9] START round=11 head_norm_before_train=1.579416 cos_to_last_merge=1.0000 (last merge round=10)
[S9] round=11 local utility u=0.013748 metrics={'f1_val': 0.9892714523047061, 'auprc': 0.9977655378361512, 'loss_val': 0.2322909303882386, 'psi': 0.9926690865172842}-{'f1_val': 0.9879970276931102, 'auprc': 0.997894171718529, 'loss_val': 0.2525266820951415, 'psi': 0.9919558853032777}
[S10] START round=11 head_norm_before_train=0.792971 cos_to_last_merge=1.0000 (last merge round=10)
[S10] round=11 local utility u=0.158884 metrics={'f1_val': 0.6988313251854003, 'auprc': 0.9371011646190773, 'loss_val': 0.6955729174763691, 'psi': 0.7941392609588711}-{'f1_val': 0.6998387566314846, 'auprc': 0.8626255048906457, 'loss_val': 0.7959579473849862, 'psi': 0.7649534559351491}
[S11] START round=11 head_norm_before_train=1.463543 (no previous merge yet)
[S11] round=11 local utility u=0.036413 metrics={'f1_val': 0.7020007759458987, 'auprc': 0.9976792773132692, 'loss_val': 0.4288402068938904, 'psi': 0.8202721764928469}-{'f1_val': 0.7018246587012323, 'auprc': 0.9964793750716383, 'loss_val': 0.4970089329411888, 'psi': 0.8196865452493947}
[S13] START round=11 head_norm_before_train=1.048594 cos_to_last_merge=0.9199 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.920
[S13] round=11 local utility u=0.422283 metrics={'f1_val': 0.539024316455252, 'auprc': 0.6994650386889854, 'loss_val': 0.7555287691119277, 'psi': 0.6032006053487453}-{'f1_val': 0.41580726865236384, 'auprc': 0.6761150645942913, 'loss_val': 0.7907432570929078, 'psi': 0.5199303870291349}
[S14] START round=11 head_norm_before_train=1.559976 (no previous merge yet)
[S14] round=11 local utility u=0.709881 metrics={'f1_val': 0.9283870312629432, 'auprc': 0.9957282212502824, 'loss_val': 0.31345939257596017, 'psi': 0.9553235072578788}-{'f1_val': 0.7020620161542324, 'auprc': 0.9962954922547742, 'loss_val': 0.3769733384288217, 'psi': 0.8197554065944491}
[S15] START round=11 head_norm_before_train=0.645136 cos_to_last_merge=1.0000 (last merge round=10)
[S15] round=11 local utility u=0.082148 metrics={'f1_val': 0.7014844356238942, 'auprc': 0.7995374159975432, 'loss_val': 0.8118965123751604, 'psi': 0.7407056277733538}-{'f1_val': 0.6983630157419677, 'auprc': 0.7996887625712027, 'loss_val': 0.9579184315603897, 'psi': 0.7388933144736617}
[S16] START round=11 head_norm_before_train=1.107040 cos_to_last_merge=0.9029 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.903
[S16] round=11 local utility u=0.000000 metrics={'f1_val': 0.3786715346163621, 'auprc': 0.7346087745867624, 'loss_val': 0.8659951559499498, 'psi': 0.5210464306045222}-{'f1_val': 0.4181478986425249, 'auprc': 0.7567642294427692, 'loss_val': 0.851793293227731, 'psi': 0.5535944309626226}
[S17] START round=11 head_norm_before_train=1.150168 cos_to_last_merge=0.8672 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.867
[S17] round=11 local utility u=0.092789 metrics={'f1_val': 0.35647696827417896, 'auprc': 0.6927709967096437, 'loss_val': 0.8273945128671959, 'psi': 0.4909945796483649}-{'f1_val': 0.35469327811000995, 'auprc': 0.6432877882773338, 'loss_val': 0.8538214436833079, 'psi': 0.4701310821769395}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:57009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:57002
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:57010
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:57011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:57015
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:57015
[S11] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1793 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1798) from S11
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.497677)
[S7] loaded HEAD from S11 (vec_in norm=1.497677)
[S7] cosine check vs S11: cos=0.4942
[S7] BUFFERED delta from S11 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1799) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=0.838584)
[S7] loaded HEAD from S10 (vec_in norm=0.838584)
[S7] cosine check vs S10: cos=0.7330
[S7] BUFFERED delta from S10 (total buffered=2)
[S10] RECEIVED delta(kind=head bytes=1798) from S15
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.688983)
[S10] loaded HEAD from S15 (vec_in norm=0.688983)
[S10] cosine check vs S15: cos=0.4186
[S10] BUFFERED delta from S15 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1801) from S6
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.042140)
[S8] loaded HEAD from S6 (vec_in norm=1.042140)
[S8] cosine check vs S6: cos=0.8288
[S8] BUFFERED delta from S6 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1802) from S14
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.605525)
[S6] loaded HEAD from S14 (vec_in norm=1.605525)
[S6] cosine check vs S14: cos=-0.0689
[S6] DROPPED delta from S14 (cos=-0.0689 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1803) from S4
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.655281)
[S2] loaded HEAD from S4 (vec_in norm=1.655281)
[S2] cosine check vs S4: cos=0.9919
[S2] BUFFERED delta from S4 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1800) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.879792)
[S3] loaded HEAD from S8 (vec_in norm=0.879792)
[S3] cosine check vs S8: cos=0.6037
[S3] BUFFERED delta from S8 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1802) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.637479)
[S9] loaded HEAD from S5 (vec_in norm=1.637479)
[S9] cosine check vs S5: cos=0.9757
[S9] BUFFERED delta from S5 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1804) from S3
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.046107)
[S15] loaded HEAD from S3 (vec_in norm=1.046107)
[S15] cosine check vs S3: cos=0.7241
[S15] BUFFERED delta from S3 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1793) from S13
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.080392)
[S15] loaded HEAD from S13 (vec_in norm=1.080392)
[S15] cosine check vs S13: cos=0.5674
[S15] BUFFERED delta from S13 (total buffered=2)
[S3] RECEIVED delta(kind=head bytes=1798) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.623288)
[S3] loaded HEAD from S9 (vec_in norm=1.623288)
[S3] cosine check vs S9: cos=0.8311
[S3] BUFFERED delta from S9 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:57009
[S17] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.191452)
[S8] loaded HEAD from S17 (vec_in norm=1.191452)
[S8] cosine check vs S17: cos=-0.0102
[S8] DROPPED delta from S17 (cos=-0.0102 < 0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=11 metric=0.7013 head_norm=1.589537
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.083317e-01
[S2] stored merged vector for next round verification (round=11)
[S2] DEBUG after merge:  round=11 metric=0.7013 head_norm=1.619122 delta_norm=0.108332
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=11 metric=0.4464 head_norm=0.745662
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.812831e-01
[S7] stored merged vector for next round verification (round=11)
[S7] DEBUG after merge:  round=11 metric=0.4332 head_norm=0.764354 delta_norm=0.281283
[S7] aggregate: ROLLBACK (f1_val pre=0.446 post=0.433 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=11 metric=0.9893 head_norm=1.623288
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.800252e-01
[S9] stored merged vector for next round verification (round=11)
[S9] DEBUG after merge:  round=11 metric=0.9892 head_norm=1.620430 delta_norm=0.180025
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=11 metric=0.7142 head_norm=0.879792
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.916800e-01
[S8] stored merged vector for next round verification (round=11)
[S8] DEBUG after merge:  round=11 metric=0.6598 head_norm=0.919221 delta_norm=0.291680
[S8] aggregate: ROLLBACK (f1_val pre=0.714 post=0.660 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=11 metric=0.7015 head_norm=0.688983
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.141863e-01
[S15] stored merged vector for next round verification (round=11)
[S15] DEBUG after merge:  round=11 metric=0.7017 head_norm=0.719738 delta_norm=0.214186
[S15] aggregate: ACCEPT kept=['S3', 'S13'] (k=2/2) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=11 metric=0.7007 head_norm=1.046107
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.720788e-01
[S3] stored merged vector for next round verification (round=11)
[S3] DEBUG after merge:  round=11 metric=0.7007 head_norm=1.006529 delta_norm=0.172079
[S3] aggregate: ACCEPT kept=['S8', 'S9'] (k=2/2) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=11 metric=0.6988 head_norm=0.838584
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.165961e-01
[S10] stored merged vector for next round verification (round=11)
[S10] DEBUG after merge:  round=11 metric=0.6983 head_norm=0.644522 delta_norm=0.416596
[S10] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.619122 cos_to_last_merge=1.0000 (last merge round=11)
[S2] round=12 local utility u=0.092544 metrics={'f1_val': 0.7005925029290768, 'auprc': 0.724826216118692, 'loss_val': 0.40934758755229134, 'psi': 0.7102859882049228}-{'f1_val': 0.7012900746650139, 'auprc': 0.7050248600999562, 'loss_val': 0.5392161665558948, 'psi': 0.7027839888389908}
[S3] START round=12 head_norm_before_train=1.006529 cos_to_last_merge=1.0000 (last merge round=11)
[S3] round=12 local utility u=0.163604 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.998591473138269, 'loss_val': 0.372983917034604, 'psi': 0.8198451650545084}-{'f1_val': 0.7006809596653347, 'auprc': 0.8968382663366499, 'loss_val': 0.39493194287095623, 'psi': 0.7791438823338608}
[S4] START round=12 head_norm_before_train=1.655281 (no previous merge yet)
[S4] round=12 local utility u=0.011965 metrics={'f1_val': 0.6678071874666144, 'auprc': 0.9454287988705832, 'loss_val': 0.4549083812143756, 'psi': 0.778855832028202}-{'f1_val': 0.6676542160172332, 'auprc': 0.9508659248703456, 'loss_val': 0.49423232731233574, 'psi': 0.7809388995584782}
[S5] START round=12 head_norm_before_train=1.637479 (no previous merge yet)
[S5] round=12 local utility u=0.000000 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9872303678116661, 'loss_val': 0.2830653781930929, 'psi': 0.815257182722271}-{'f1_val': 0.7006090940057808, 'auprc': 0.9931554497699163, 'loss_val': 0.274760553231174, 'psi': 0.817627636311435}
[S6] START round=12 head_norm_before_train=1.042140 cos_to_last_merge=0.9965 (last merge round=10)
[S6] round=12 local utility u=0.000000 metrics={'f1_val': 0.6178649579276769, 'auprc': 0.7748235592192245, 'loss_val': 0.6970402616474631, 'psi': 0.6806483984442959}-{'f1_val': 0.8783527963918043, 'auprc': 0.9636847876612036, 'loss_val': 0.641688961701234, 'psi': 0.912485592899564}
[S7] START round=12 head_norm_before_train=0.764354 cos_to_last_merge=1.0000 (last merge round=11)
[S7] round=12 local utility u=0.597063 metrics={'f1_val': 0.5705623085540474, 'auprc': 0.9282174054749612, 'loss_val': 0.9139327263179928, 'psi': 0.713624347322413}-{'f1_val': 0.44639531420593787, 'auprc': 0.795603070031659, 'loss_val': 0.9652144690392203, 'psi': 0.5860784165362263}
[S8] START round=12 head_norm_before_train=0.919221 cos_to_last_merge=1.0000 (last merge round=11)
[S8] round=12 local utility u=0.000000 metrics={'f1_val': 0.7008953601033816, 'auprc': 0.7920920180829363, 'loss_val': 0.5641701368103027, 'psi': 0.7373740232952035}-{'f1_val': 0.7142391053978291, 'auprc': 0.9715800105801508, 'loss_val': 0.609741293529512, 'psi': 0.8171754674707579}
[S9] START round=12 head_norm_before_train=1.620430 cos_to_last_merge=1.0000 (last merge round=11)
[S9] round=12 local utility u=0.034544 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9979752681282855, 'loss_val': 0.2066654873554487, 'psi': 0.9970362186516467}-{'f1_val': 0.9892714523047061, 'auprc': 0.9977655378361512, 'loss_val': 0.2322909303882386, 'psi': 0.9926690865172842}
[S10] START round=12 head_norm_before_train=0.644522 cos_to_last_merge=1.0000 (last merge round=11)
[S10] round=12 local utility u=0.105478 metrics={'f1_val': 0.7010624932301728, 'auprc': 0.9916712544544926, 'loss_val': 0.6617132277703371, 'psi': 0.8173059977199006}-{'f1_val': 0.6988313251854003, 'auprc': 0.9371011646190773, 'loss_val': 0.6955729174763691, 'psi': 0.7941392609588711}
[S11] START round=12 head_norm_before_train=1.497677 (no previous merge yet)
[S11] round=12 local utility u=0.045064 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9961220450000206, 'loss_val': 0.332197207587625, 'psi': 0.8194649057521631}-{'f1_val': 0.7020007759458987, 'auprc': 0.9976792773132692, 'loss_val': 0.4288402068938904, 'psi': 0.8202721764928469}
[S13] START round=12 head_norm_before_train=1.080392 cos_to_last_merge=0.9094 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.909
[S13] round=12 local utility u=0.166822 metrics={'f1_val': 0.5871297933653209, 'auprc': 0.7076483709640908, 'loss_val': 0.7350677387992159, 'psi': 0.6353372244048289}-{'f1_val': 0.539024316455252, 'auprc': 0.6994650386889854, 'loss_val': 0.7555287691119277, 'psi': 0.6032006053487453}
[S14] START round=12 head_norm_before_train=1.605525 (no previous merge yet)
[S14] round=12 local utility u=0.236182 metrics={'f1_val': 0.9976760408229349, 'auprc': 0.9971594889201764, 'loss_val': 0.2611232058095843, 'psi': 0.9974694200618315}-{'f1_val': 0.9283870312629432, 'auprc': 0.9957282212502824, 'loss_val': 0.31345939257596017, 'psi': 0.9553235072578788}
[S15] START round=12 head_norm_before_train=0.719738 cos_to_last_merge=1.0000 (last merge round=11)
[S15] round=12 local utility u=0.000000 metrics={'f1_val': 0.7013506818496502, 'auprc': 0.766242268150511, 'loss_val': 0.7389611710585642, 'psi': 0.7273073163699946}-{'f1_val': 0.7014844356238942, 'auprc': 0.7995374159975432, 'loss_val': 0.8118965123751604, 'psi': 0.7407056277733538}
[S16] START round=12 head_norm_before_train=1.151433 cos_to_last_merge=0.8923 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.892
[S16] round=12 local utility u=0.470637 metrics={'f1_val': 0.5152151629552573, 'auprc': 0.7634230292899827, 'loss_val': 0.8304250714536827, 'psi': 0.6144983094891474}-{'f1_val': 0.3786715346163621, 'auprc': 0.7346087745867624, 'loss_val': 0.8659951559499498, 'psi': 0.5210464306045222}
[S17] START round=12 head_norm_before_train=1.191452 cos_to_last_merge=0.8478 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.848
[S17] round=12 local utility u=0.910882 metrics={'f1_val': 0.552328460289448, 'auprc': 0.8542971934204797, 'loss_val': 0.6653178637722117, 'psi': 0.6731159535418607}-{'f1_val': 0.35647696827417896, 'auprc': 0.6927709967096437, 'loss_val': 0.8273945128671959, 'psi': 0.4909945796483649}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:57011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:57007
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:57015
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:57003
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:57008
[S11] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1804 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1805 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1796) from S7
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.808194)
[S15] loaded HEAD from S7 (vec_in norm=0.808194)
[S15] cosine check vs S7: cos=0.2150
[S15] BUFFERED delta from S7 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1804) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.658611)
[S3] loaded HEAD from S9 (vec_in norm=1.658611)
[S3] cosine check vs S9: cos=0.8321
[S3] BUFFERED delta from S9 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1800) from S4
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.677457)
[S2] loaded HEAD from S4 (vec_in norm=1.677457)
[S2] cosine check vs S4: cos=0.9940
[S2] BUFFERED delta from S4 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1797) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=0.703588)
[S7] loaded HEAD from S10 (vec_in norm=0.703588)
[S7] cosine check vs S10: cos=0.6106
[S7] BUFFERED delta from S10 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1800) from S11
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.535461)
[S7] loaded HEAD from S11 (vec_in norm=1.535461)
[S7] cosine check vs S11: cos=0.6930
[S7] BUFFERED delta from S11 (total buffered=2)
[S10] RECEIVED delta(kind=head bytes=1800) from S2
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.662918)
[S10] loaded HEAD from S2 (vec_in norm=1.662918)
[S10] cosine check vs S2: cos=0.5546
[S10] BUFFERED delta from S2 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1800) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.193934)
[S6] loaded HEAD from S16 (vec_in norm=1.193934)
[S6] cosine check vs S16: cos=0.9481
[S6] BUFFERED delta from S16 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1805) from S14
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.650881)
[S6] loaded HEAD from S14 (vec_in norm=1.650881)
[S6] cosine check vs S14: cos=-0.0752
[S6] DROPPED delta from S14 (cos=-0.0752 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1804) from S3
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.080261)
[S15] loaded HEAD from S3 (vec_in norm=1.080261)
[S15] cosine check vs S3: cos=0.7384
[S15] BUFFERED delta from S3 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1798) from S13
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.110771)
[S15] loaded HEAD from S13 (vec_in norm=1.110771)
[S15] cosine check vs S13: cos=0.6769
[S15] BUFFERED delta from S13 (total buffered=3)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1783 reason=None
[S17] → sending delta(kind=head bytes=1783) to S8@127.0.0.1:57009
[S17] sending update (kind=head size=1783 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1783) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.226623)
[S8] loaded HEAD from S17 (vec_in norm=1.226623)
[S8] cosine check vs S17: cos=-0.0046
[S8] DROPPED delta from S17 (cos=-0.0046 < 0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=12 metric=0.6179 head_norm=1.081609
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.915242e-01
[S6] stored merged vector for next round verification (round=12)
[S6] DEBUG after merge:  round=12 metric=0.6181 head_norm=1.122941 delta_norm=0.191524
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=12 metric=0.7011 head_norm=0.703588
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.004695e-01
[S10] stored merged vector for next round verification (round=12)
[S10] DEBUG after merge:  round=12 metric=0.7002 head_norm=1.067478 delta_norm=0.700469
[S10] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=12 metric=0.7007 head_norm=1.080261
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.837617e-01
[S3] stored merged vector for next round verification (round=12)
[S3] DEBUG after merge:  round=12 metric=0.7007 head_norm=1.313374 delta_norm=0.483762
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=12 metric=0.5706 head_norm=0.808194
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.031273e-01
[S7] stored merged vector for next round verification (round=12)
[S7] DEBUG after merge:  round=12 metric=0.5678 head_norm=0.803013 delta_norm=0.203127
[S7] aggregate: ACCEPT kept=['S10', 'S11'] (k=2/2) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=12 metric=0.7006 head_norm=1.662918
[S2] _apply_head_vector_avg (torch): Δ‖w‖=9.164108e-02
[S2] stored merged vector for next round verification (round=12)
[S2] DEBUG after merge:  round=12 metric=0.7006 head_norm=1.667687 delta_norm=0.091641
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=12 metric=0.7014 head_norm=0.765788
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.872227e-01
[S15] stored merged vector for next round verification (round=12)
[S15] DEBUG after merge:  round=12 metric=0.7015 head_norm=0.675867 delta_norm=0.187223
[S15] aggregate: ACCEPT kept=['S7', 'S3', 'S13'] (k=3/3) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.667687 cos_to_last_merge=1.0000 (last merge round=12)
[S2] round=13 local utility u=0.072075 metrics={'f1_val': 0.7011337461190337, 'auprc': 0.7487841227555497, 'loss_val': 0.34031951930800436, 'psi': 0.7201938967736401}-{'f1_val': 0.7005925029290768, 'auprc': 0.724826216118692, 'loss_val': 0.40934758755229134, 'psi': 0.7102859882049228}
[S3] START round=13 head_norm_before_train=1.313374 cos_to_last_merge=1.0000 (last merge round=12)
[S3] round=13 local utility u=0.003291 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.9988042824706154, 'loss_val': 0.36659091472431254, 'psi': 0.8198853144883695}-{'f1_val': 0.7006809596653347, 'auprc': 0.998591473138269, 'loss_val': 0.372983917034604, 'psi': 0.8198451650545084}
[S4] START round=13 head_norm_before_train=1.677457 (no previous merge yet)
[S4] round=13 local utility u=0.006247 metrics={'f1_val': 0.6715044934567267, 'auprc': 0.9361821022143019, 'loss_val': 0.4368586943040256, 'psi': 0.7773755369597568}-{'f1_val': 0.6678071874666144, 'auprc': 0.9454287988705832, 'loss_val': 0.4549083812143756, 'psi': 0.778855832028202}
[S5] START round=13 head_norm_before_train=1.664787 (no previous merge yet)
[S5] round=13 local utility u=0.000000 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.973901348832861, 'loss_val': 0.2790662190999323, 'psi': 0.809925575130749}-{'f1_val': 0.7006083926626743, 'auprc': 0.9872303678116661, 'loss_val': 0.2830653781930929, 'psi': 0.815257182722271}
[S6] START round=13 head_norm_before_train=1.122941 cos_to_last_merge=1.0000 (last merge round=12)
[S6] round=13 local utility u=0.609620 metrics={'f1_val': 0.6948314920482376, 'auprc': 0.9644891946586105, 'loss_val': 0.5085960458572155, 'psi': 0.8026945730923867}-{'f1_val': 0.6178649579276769, 'auprc': 0.7748235592192245, 'loss_val': 0.6970402616474631, 'psi': 0.6806483984442959}
[S7] START round=13 head_norm_before_train=0.803013 cos_to_last_merge=1.0000 (last merge round=12)
[S7] round=13 local utility u=0.000000 metrics={'f1_val': 0.5501620072331277, 'auprc': 0.8023993724883887, 'loss_val': 0.9136902732945847, 'psi': 0.6510569533352322}-{'f1_val': 0.5705623085540474, 'auprc': 0.9282174054749612, 'loss_val': 0.9139327263179928, 'psi': 0.713624347322413}
[S8] START round=13 head_norm_before_train=0.969917 cos_to_last_merge=0.9950 (last merge round=11)
[S8] round=13 local utility u=0.357345 metrics={'f1_val': 0.7011396728580639, 'auprc': 0.9944652840024951, 'loss_val': 0.4580655953751615, 'psi': 0.8184699173158364}-{'f1_val': 0.7008953601033816, 'auprc': 0.7920920180829363, 'loss_val': 0.5641701368103027, 'psi': 0.7373740232952035}
[S9] START round=13 head_norm_before_train=1.658611 cos_to_last_merge=0.9964 (last merge round=11)
[S9] round=13 local utility u=0.041143 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.997715958028964, 'loss_val': 0.12264145089328651, 'psi': 0.9968364400791522}-{'f1_val': 0.9964101856672208, 'auprc': 0.9979752681282855, 'loss_val': 0.2066654873554487, 'psi': 0.9970362186516467}
[S10] START round=13 head_norm_before_train=1.067478 cos_to_last_merge=1.0000 (last merge round=12)
[S10] round=13 local utility u=0.076783 metrics={'f1_val': 0.701316552565354, 'auprc': 0.9834004258095996, 'loss_val': 0.48485856602047606, 'psi': 0.8141501018630521}-{'f1_val': 0.7010624932301728, 'auprc': 0.9916712544544926, 'loss_val': 0.6617132277703371, 'psi': 0.8173059977199006}
[S11] START round=13 head_norm_before_train=1.535461 (no previous merge yet)
[S11] round=13 local utility u=0.030004 metrics={'f1_val': 0.7017589383281313, 'auprc': 0.9962660899089952, 'loss_val': 0.2730134091695952, 'psi': 0.8195617989604769}-{'f1_val': 0.7016934795869249, 'auprc': 0.9961220450000206, 'loss_val': 0.332197207587625, 'psi': 0.8194649057521631}
[S13] START round=13 head_norm_before_train=1.110771 cos_to_last_merge=0.8996 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.900
[S13] round=13 local utility u=0.000000 metrics={'f1_val': 0.6049367384544871, 'auprc': 0.6500877032313231, 'loss_val': 0.6995477382614675, 'psi': 0.6229971243652215}-{'f1_val': 0.5871297933653209, 'auprc': 0.7076483709640908, 'loss_val': 0.7350677387992159, 'psi': 0.6353372244048289}
[S14] START round=13 head_norm_before_train=1.650881 (no previous merge yet)
[S14] round=13 local utility u=0.057185 metrics={'f1_val': 0.997476613247938, 'auprc': 0.997158012008024, 'loss_val': 0.14555130477008335, 'psi': 0.9973491727519723}-{'f1_val': 0.9976760408229349, 'auprc': 0.9971594889201764, 'loss_val': 0.2611232058095843, 'psi': 0.9974694200618315}
[S15] START round=13 head_norm_before_train=0.675867 cos_to_last_merge=1.0000 (last merge round=12)
[S15] round=13 local utility u=0.001856 metrics={'f1_val': 0.6982368371410139, 'auprc': 0.7640013829990391, 'loss_val': 0.7098442328179579, 'psi': 0.724542655484224}-{'f1_val': 0.7013506818496502, 'auprc': 0.766242268150511, 'loss_val': 0.7389611710585642, 'psi': 0.7273073163699946}
[S16] START round=13 head_norm_before_train=1.193934 cos_to_last_merge=0.8839 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.884
[S16] round=13 local utility u=0.000000 metrics={'f1_val': 0.4367262897563128, 'auprc': 0.7329796294728312, 'loss_val': 0.9457784484988331, 'psi': 0.5552276256429202}-{'f1_val': 0.5152151629552573, 'auprc': 0.7634230292899827, 'loss_val': 0.8304250714536827, 'psi': 0.6144983094891474}
[S17] START round=13 head_norm_before_train=1.226623 cos_to_last_merge=0.8342 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.834
[S17] round=13 local utility u=0.298066 metrics={'f1_val': 0.6106047492404932, 'auprc': 0.9196533748306757, 'loss_val': 0.6149114820176941, 'psi': 0.7342241994765661}-{'f1_val': 0.552328460289448, 'auprc': 0.8542971934204797, 'loss_val': 0.6653178637722117, 'psi': 0.6731159535418607}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:57003
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:57011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:57011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S11] → sending delta(kind=head bytes=1807) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:57009
[S11] sending update (kind=head size=1807 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1794 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1802) from S4
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.701651)
[S2] loaded HEAD from S4 (vec_in norm=1.701651)
[S2] cosine check vs S4: cos=0.9947
[S2] BUFFERED delta from S4 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1802) from S6
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.153337)
[S8] loaded HEAD from S6 (vec_in norm=1.153337)
[S8] cosine check vs S6: cos=0.9043
[S8] BUFFERED delta from S6 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1807) from S11
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.580093)
[S7] loaded HEAD from S11 (vec_in norm=1.580093)
[S7] cosine check vs S11: cos=0.7701
[S7] BUFFERED delta from S11 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1795) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.117978)
[S7] loaded HEAD from S10 (vec_in norm=1.117978)
[S7] cosine check vs S10: cos=0.4925
[S7] BUFFERED delta from S10 (total buffered=2)
[S10] RECEIVED delta(kind=head bytes=1797) from S15
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.730908)
[S10] loaded HEAD from S15 (vec_in norm=0.730908)
[S10] cosine check vs S15: cos=0.2783
[S10] BUFFERED delta from S15 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1801) from S2
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.710606)
[S10] loaded HEAD from S2 (vec_in norm=1.710606)
[S10] cosine check vs S2: cos=0.9445
[S10] BUFFERED delta from S2 (total buffered=2)
[S6] RECEIVED delta(kind=head bytes=1803) from S14
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.690012)
[S6] loaded HEAD from S14 (vec_in norm=1.690012)
[S6] cosine check vs S14: cos=-0.0678
[S6] DROPPED delta from S14 (cos=-0.0678 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1794) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.021112)
[S3] loaded HEAD from S8 (vec_in norm=1.021112)
[S3] cosine check vs S8: cos=0.3428
[S3] BUFFERED delta from S8 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1802) from S3
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.369492)
[S15] loaded HEAD from S3 (vec_in norm=1.369492)
[S15] cosine check vs S3: cos=0.6208
[S15] BUFFERED delta from S3 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1801) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.714009)
[S3] loaded HEAD from S9 (vec_in norm=1.714009)
[S3] cosine check vs S9: cos=0.9480
[S3] BUFFERED delta from S9 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:57009
[S17] sending update (kind=head size=1794 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1794) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.264642)
[S8] loaded HEAD from S17 (vec_in norm=1.264642)
[S8] cosine check vs S17: cos=0.0005
[S8] BUFFERED delta from S17 (total buffered=2)
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=13 metric=0.5502 head_norm=0.854576
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.236599e-01
[S7] stored merged vector for next round verification (round=13)
[S7] DEBUG after merge:  round=13 metric=0.5343 head_norm=0.897331 delta_norm=0.223660
[S7] aggregate: ROLLBACK (f1_val pre=0.550 post=0.534 tol_abs=0.005 tol_rel=0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=13 metric=0.7011 head_norm=1.710606
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.771992e-02
[S2] stored merged vector for next round verification (round=13)
[S2] DEBUG after merge:  round=13 metric=0.7011 head_norm=1.703878 delta_norm=0.087720
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=13 metric=0.7006 head_norm=1.369492
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.608273e-01
[S3] stored merged vector for next round verification (round=13)
[S3] DEBUG after merge:  round=13 metric=0.7006 head_norm=1.191781 delta_norm=0.260827
[S3] aggregate: ACCEPT kept=['S8', 'S9'] (k=2/2) mode=median trim_p=0.1
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=13 metric=0.7013 head_norm=1.117978
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.558710e-01
[S10] stored merged vector for next round verification (round=13)
[S10] DEBUG after merge:  round=13 metric=0.7013 head_norm=1.020378 delta_norm=0.155871
[S10] aggregate: ACCEPT kept=['S15', 'S2'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=13 metric=0.6982 head_norm=0.730908
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.401093e-01
[S15] stored merged vector for next round verification (round=13)
[S15] DEBUG after merge:  round=13 metric=0.6981 head_norm=0.955589 delta_norm=0.540109
[S15] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=13 metric=0.7011 head_norm=1.021112
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.216019e-01
[S8] stored merged vector for next round verification (round=13)
[S8] DEBUG after merge:  round=13 metric=0.7011 head_norm=0.842951 delta_norm=0.421602
[S8] aggregate: ACCEPT kept=['S6', 'S17'] (k=2/2) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.703878 cos_to_last_merge=1.0000 (last merge round=13)
[S2] round=14 local utility u=0.000000 metrics={'f1_val': 0.701132579636681, 'auprc': 0.6935518877664959, 'loss_val': 0.31585461897549744, 'psi': 0.6981003028886069}-{'f1_val': 0.7011337461190337, 'auprc': 0.7487841227555497, 'loss_val': 0.34031951930800436, 'psi': 0.7201938967736401}
[S3] START round=14 head_norm_before_train=1.191781 cos_to_last_merge=1.0000 (last merge round=13)
[S3] round=14 local utility u=0.002661 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9926953410379806, 'loss_val': 0.3433923620970494, 'psi': 0.8174867122143932}-{'f1_val': 0.7006060025002057, 'auprc': 0.9988042824706154, 'loss_val': 0.36659091472431254, 'psi': 0.8198853144883695}
[S4] START round=14 head_norm_before_train=1.701651 (no previous merge yet)
[S4] round=14 local utility u=0.806841 metrics={'f1_val': 0.9450545160233771, 'auprc': 0.9350402295864182, 'loss_val': 0.4610518532890347, 'psi': 0.9410488014485935}-{'f1_val': 0.6715044934567267, 'auprc': 0.9361821022143019, 'loss_val': 0.4368586943040256, 'psi': 0.7773755369597568}
[S5] START round=14 head_norm_before_train=1.693541 (no previous merge yet)
[S5] round=14 local utility u=0.038038 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9887251266666516, 'loss_val': 0.24746220061374324, 'psi': 0.8158550862642653}-{'f1_val': 0.7006083926626743, 'auprc': 0.973901348832861, 'loss_val': 0.2790662190999323, 'psi': 0.809925575130749}
[S6] START round=14 head_norm_before_train=1.153337 cos_to_last_merge=0.9984 (last merge round=12)
[S6] round=14 local utility u=0.000000 metrics={'f1_val': 0.5894111221433873, 'auprc': 0.7771351858334088, 'loss_val': 0.7766136438264591, 'psi': 0.6645007476193959}-{'f1_val': 0.6948314920482376, 'auprc': 0.9644891946586105, 'loss_val': 0.5085960458572155, 'psi': 0.8026945730923867}
[S7] START round=14 head_norm_before_train=0.897331 cos_to_last_merge=1.0000 (last merge round=13)
[S7] round=14 local utility u=0.033493 metrics={'f1_val': 0.5622004784822564, 'auprc': 0.7984918184988131, 'loss_val': 0.907211640071552, 'psi': 0.6567170144888792}-{'f1_val': 0.5501620072331277, 'auprc': 0.8023993724883887, 'loss_val': 0.9136902732945847, 'psi': 0.6510569533352322}
[S8] START round=14 head_norm_before_train=0.842951 cos_to_last_merge=1.0000 (last merge round=13)
[S8] round=14 local utility u=0.000000 metrics={'f1_val': 0.7141742661762565, 'auprc': 0.7939158596455214, 'loss_val': 0.5495361035404432, 'psi': 0.7460709035639624}-{'f1_val': 0.7011396728580639, 'auprc': 0.9944652840024951, 'loss_val': 0.4580655953751615, 'psi': 0.8184699173158364}
[S9] START round=14 head_norm_before_train=1.714009 cos_to_last_merge=0.9879 (last merge round=11)
[S9] round=14 local utility u=0.019388 metrics={'f1_val': 0.9955808965143278, 'auprc': 0.9983447723030947, 'loss_val': 0.0817373597357123, 'psi': 0.9966864468298345}-{'f1_val': 0.9962500947792776, 'auprc': 0.997715958028964, 'loss_val': 0.12264145089328651, 'psi': 0.9968364400791522}
[S10] START round=14 head_norm_before_train=1.020378 cos_to_last_merge=1.0000 (last merge round=13)
[S10] round=14 local utility u=0.028011 metrics={'f1_val': 0.6980379408669193, 'auprc': 0.9931770538702168, 'loss_val': 0.43849474421894985, 'psi': 0.8160935860682383}-{'f1_val': 0.701316552565354, 'auprc': 0.9834004258095996, 'loss_val': 0.48485856602047606, 'psi': 0.8141501018630521}
[S11] START round=14 head_norm_before_train=1.580093 (no previous merge yet)
[S11] round=14 local utility u=0.333203 metrics={'f1_val': 0.8094533050412167, 'auprc': 0.9964569760973891, 'loss_val': 0.25334550923034416, 'psi': 0.8842547734636856}-{'f1_val': 0.7017589383281313, 'auprc': 0.9962660899089952, 'loss_val': 0.2730134091695952, 'psi': 0.8195617989604769}
[S13] START round=14 head_norm_before_train=1.145348 cos_to_last_merge=0.8922 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.892
[S13] round=14 local utility u=0.000000 metrics={'f1_val': 0.5749719882860693, 'auprc': 0.6769680087425729, 'loss_val': 0.7113463513928765, 'psi': 0.6157703964686707}-{'f1_val': 0.6049367384544871, 'auprc': 0.6500877032313231, 'loss_val': 0.6995477382614675, 'psi': 0.6229971243652215}
[S14] START round=14 head_norm_before_train=1.690012 (no previous merge yet)
[S14] round=14 local utility u=0.021613 metrics={'f1_val': 0.997841853906109, 'auprc': 0.9971566852757932, 'loss_val': 0.10451223192094788, 'psi': 0.9975677864539827}-{'f1_val': 0.997476613247938, 'auprc': 0.997158012008024, 'loss_val': 0.14555130477008335, 'psi': 0.9973491727519723}
[S15] START round=14 head_norm_before_train=0.955589 cos_to_last_merge=1.0000 (last merge round=13)
[S15] round=14 local utility u=0.117654 metrics={'f1_val': 0.699206246109737, 'auprc': 0.7993813428484037, 'loss_val': 0.5864920984112884, 'psi': 0.7392762848052037}-{'f1_val': 0.6982368371410139, 'auprc': 0.7640013829990391, 'loss_val': 0.7098442328179579, 'psi': 0.724542655484224}
[S16] START round=14 head_norm_before_train=1.232172 cos_to_last_merge=0.8770 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.877
[S16] round=14 local utility u=0.304312 metrics={'f1_val': 0.5127590272280049, 'auprc': 0.7705665153215019, 'loss_val': 0.9061107677615383, 'psi': 0.6158820224654037}-{'f1_val': 0.4367262897563128, 'auprc': 0.7329796294728312, 'loss_val': 0.9457784484988331, 'psi': 0.5552276256429202}
[S17] START round=14 head_norm_before_train=1.264642 cos_to_last_merge=0.8231 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.823
[S17] round=14 local utility u=0.000000 metrics={'f1_val': 0.568576565723118, 'auprc': 0.7762160578031481, 'loss_val': 0.6416784499113459, 'psi': 0.65163236255513}-{'f1_val': 0.6106047492404932, 'auprc': 0.9196533748306757, 'loss_val': 0.6149114820176941, 'psi': 0.7342241994765661}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] → sending delta(kind=head bytes=1805) to S3@127.0.0.1:57003
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S10@127.0.0.1:57011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:57002
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:57015
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1805 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1794 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1802) from S3
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.251448)
[S15] loaded HEAD from S3 (vec_in norm=1.251448)
[S15] cosine check vs S3: cos=0.9476
[S15] BUFFERED delta from S3 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1805) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.771621)
[S3] loaded HEAD from S9 (vec_in norm=1.771621)
[S3] cosine check vs S9: cos=0.9005
[S3] BUFFERED delta from S9 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1803) from S4
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.726773)
[S2] loaded HEAD from S4 (vec_in norm=1.726773)
[S2] cosine check vs S4: cos=0.9956
[S2] BUFFERED delta from S4 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1800) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.261486)
[S6] loaded HEAD from S16 (vec_in norm=1.261486)
[S6] cosine check vs S16: cos=0.9659
[S6] BUFFERED delta from S16 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1802) from S11
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.623052)
[S7] loaded HEAD from S11 (vec_in norm=1.623052)
[S7] cosine check vs S11: cos=0.7833
[S7] BUFFERED delta from S11 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1802) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.716384)
[S9] loaded HEAD from S5 (vec_in norm=1.716384)
[S9] cosine check vs S5: cos=0.9512
[S9] BUFFERED delta from S5 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1794) from S15
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.000434)
[S10] loaded HEAD from S15 (vec_in norm=1.000434)
[S10] cosine check vs S15: cos=0.2461
[S10] BUFFERED delta from S15 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1799) from S14
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.726211)
[S6] loaded HEAD from S14 (vec_in norm=1.726211)
[S6] cosine check vs S14: cos=-0.0718
[S6] DROPPED delta from S14 (cos=-0.0718 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1797) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.069045)
[S7] loaded HEAD from S10 (vec_in norm=1.069045)
[S7] cosine check vs S10: cos=0.5792
[S7] BUFFERED delta from S10 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1799) from S7
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.936110)
[S15] loaded HEAD from S7 (vec_in norm=0.936110)
[S15] cosine check vs S7: cos=0.2132
[S15] BUFFERED delta from S7 (total buffered=2)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=14 metric=0.7011 head_norm=1.741540
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.127306e-02
[S2] stored merged vector for next round verification (round=14)
[S2] DEBUG after merge:  round=14 metric=0.7011 head_norm=1.732267 delta_norm=0.081273
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=14 metric=0.5894 head_norm=1.182307
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.643186e-01
[S6] stored merged vector for next round verification (round=14)
[S6] DEBUG after merge:  round=14 metric=0.6060 head_norm=1.211444 delta_norm=0.164319
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=14 metric=0.7007 head_norm=1.251448
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.217839e-01
[S3] stored merged vector for next round verification (round=14)
[S3] DEBUG after merge:  round=14 metric=0.7007 head_norm=1.474612 delta_norm=0.421784
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=14 metric=0.9956 head_norm=1.771621
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.737225e-01
[S9] stored merged vector for next round verification (round=14)
[S9] DEBUG after merge:  round=14 metric=0.9955 head_norm=1.722610 delta_norm=0.273723
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=14 metric=0.5622 head_norm=0.936110
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.586487e-01
[S7] stored merged vector for next round verification (round=14)
[S7] DEBUG after merge:  round=14 metric=0.5592 head_norm=0.953971 delta_norm=0.158649
[S7] aggregate: ACCEPT kept=['S11', 'S10'] (k=2/2) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=14 metric=0.6980 head_norm=1.069045
[S10] _apply_head_vector_avg (torch): Δ‖w‖=6.358836e-01
[S10] stored merged vector for next round verification (round=14)
[S10] DEBUG after merge:  round=14 metric=0.6980 head_norm=0.817016 delta_norm=0.635884
[S10] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=14 metric=0.6992 head_norm=1.000434
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.688030e-01
[S15] stored merged vector for next round verification (round=14)
[S15] DEBUG after merge:  round=14 metric=0.6993 head_norm=0.874816 delta_norm=0.268803
[S15] aggregate: ACCEPT kept=['S3', 'S7'] (k=2/2) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.732267 cos_to_last_merge=1.0000 (last merge round=14)
[S2] round=15 local utility u=0.000000 metrics={'f1_val': 0.7013925629565125, 'auprc': 0.6873124625357243, 'loss_val': 0.30133735250477606, 'psi': 0.6957605227881973}-{'f1_val': 0.701132579636681, 'auprc': 0.6935518877664959, 'loss_val': 0.31585461897549744, 'psi': 0.6981003028886069}
[S3] START round=15 head_norm_before_train=1.474612 cos_to_last_merge=1.0000 (last merge round=14)
[S3] round=15 local utility u=0.012759 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.9987443017885759, 'loss_val': 0.3355714376371231, 'psi': 0.8198613222155537}-{'f1_val': 0.7006809596653347, 'auprc': 0.9926953410379806, 'loss_val': 0.3433923620970494, 'psi': 0.8174867122143932}
[S4] START round=15 head_norm_before_train=1.726773 (no previous merge yet)
[S4] round=15 local utility u=0.073821 metrics={'f1_val': 0.9501750583319015, 'auprc': 0.9540894751276922, 'loss_val': 0.40127989067636954, 'psi': 0.9517408250502177}-{'f1_val': 0.9450545160233771, 'auprc': 0.9350402295864182, 'loss_val': 0.4610518532890347, 'psi': 0.9410488014485935}
[S5] START round=15 head_norm_before_train=1.716384 (no previous merge yet)
[S5] round=15 local utility u=0.015561 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.988572352240069, 'loss_val': 0.21588119994318186, 'psi': 0.8157939764936322}-{'f1_val': 0.7006083926626743, 'auprc': 0.9887251266666516, 'loss_val': 0.24746220061374324, 'psi': 0.8158550862642653}
[S6] START round=15 head_norm_before_train=1.211444 cos_to_last_merge=1.0000 (last merge round=14)
[S6] round=15 local utility u=0.727473 metrics={'f1_val': 0.6976199141673504, 'auprc': 0.9356129811728761, 'loss_val': 0.4463536453989613, 'psi': 0.7928171409695606}-{'f1_val': 0.5894111221433873, 'auprc': 0.7771351858334088, 'loss_val': 0.7766136438264591, 'psi': 0.6645007476193959}
[S7] START round=15 head_norm_before_train=0.953971 cos_to_last_merge=1.0000 (last merge round=14)
[S7] round=15 local utility u=0.293014 metrics={'f1_val': 0.6259444484003321, 'auprc': 0.8233847931229366, 'loss_val': 0.7783255534830271, 'psi': 0.7049205862893739}-{'f1_val': 0.5622004784822564, 'auprc': 0.7984918184988131, 'loss_val': 0.907211640071552, 'psi': 0.6567170144888792}
[S8] START round=15 head_norm_before_train=0.887173 cos_to_last_merge=0.9963 (last merge round=13)
[S8] round=15 local utility u=0.332807 metrics={'f1_val': 0.7011506828958344, 'auprc': 0.997509439820754, 'loss_val': 0.41656034939943526, 'psi': 0.8196941856658022}-{'f1_val': 0.7141742661762565, 'auprc': 0.7939158596455214, 'loss_val': 0.5495361035404432, 'psi': 0.7460709035639624}
[S9] START round=15 head_norm_before_train=1.722610 cos_to_last_merge=1.0000 (last merge round=14)
[S9] round=15 local utility u=0.000000 metrics={'f1_val': 0.9934918488430377, 'auprc': 0.9979934920365034, 'loss_val': 0.11468931185488562, 'psi': 0.995292506120424}-{'f1_val': 0.9955808965143278, 'auprc': 0.9983447723030947, 'loss_val': 0.0817373597357123, 'psi': 0.9966864468298345}
[S10] START round=15 head_norm_before_train=0.817016 cos_to_last_merge=1.0000 (last merge round=14)
[S10] round=15 local utility u=0.000000 metrics={'f1_val': 0.7007124550195878, 'auprc': 0.9972896855962063, 'loss_val': 0.5628126914276076, 'psi': 0.8193433472502352}-{'f1_val': 0.6980379408669193, 'auprc': 0.9931770538702168, 'loss_val': 0.43849474421894985, 'psi': 0.8160935860682383}
[S11] START round=15 head_norm_before_train=1.623052 (no previous merge yet)
[S11] round=15 local utility u=0.493898 metrics={'f1_val': 0.9580598988783908, 'auprc': 0.9977045879806272, 'loss_val': 0.16093272568986455, 'psi': 0.9739177745192854}-{'f1_val': 0.8094533050412167, 'auprc': 0.9964569760973891, 'loss_val': 0.25334550923034416, 'psi': 0.8842547734636856}
[S13] START round=15 head_norm_before_train=1.175811 cos_to_last_merge=0.8862 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.886
[S13] round=15 local utility u=0.000000 metrics={'f1_val': 0.5870700193736681, 'auprc': 0.6476780238199251, 'loss_val': 0.7136906407128717, 'psi': 0.6113132211521709}-{'f1_val': 0.5749719882860693, 'auprc': 0.6769680087425729, 'loss_val': 0.7113463513928765, 'psi': 0.6157703964686707}
[S14] START round=15 head_norm_before_train=1.726211 (no previous merge yet)
[S14] round=15 local utility u=0.000000 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9970307809895523, 'loss_val': 0.15520490691620892, 'psi': 0.9970127403243676}-{'f1_val': 0.997841853906109, 'auprc': 0.9971566852757932, 'loss_val': 0.10451223192094788, 'psi': 0.9975677864539827}
[S15] START round=15 head_norm_before_train=0.874816 cos_to_last_merge=1.0000 (last merge round=14)
[S15] round=15 local utility u=0.000000 metrics={'f1_val': 0.6963456616397163, 'auprc': 0.7994939092051728, 'loss_val': 0.5880114911312756, 'psi': 0.737604960665899}-{'f1_val': 0.699206246109737, 'auprc': 0.7993813428484037, 'loss_val': 0.5864920984112884, 'psi': 0.7392762848052037}
[S16] START round=15 head_norm_before_train=1.261486 cos_to_last_merge=0.8718 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.872
[S16] round=15 local utility u=0.000000 metrics={'f1_val': 0.45285279087058045, 'auprc': 0.7563853607105488, 'loss_val': 0.7938868922053419, 'psi': 0.5742658188065678}-{'f1_val': 0.5127590272280049, 'auprc': 0.7705665153215019, 'loss_val': 0.9061107677615383, 'psi': 0.6158820224654037}
[S17] START round=15 head_norm_before_train=1.306431 cos_to_last_merge=0.8127 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.813
[S17] round=15 local utility u=0.415784 metrics={'f1_val': 0.5951645310433009, 'auprc': 0.9536959623361114, 'loss_val': 0.5020777765718342, 'psi': 0.7385771035604252}-{'f1_val': 0.568576565723118, 'auprc': 0.7762160578031481, 'loss_val': 0.6416784499113459, 'psi': 0.65163236255513}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:57008
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:57010
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S3] → sending delta(kind=head bytes=1809) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:57015
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:57009
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:57003
[S8] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1809 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1797) from S7
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.999940)
[S15] loaded HEAD from S7 (vec_in norm=0.999940)
[S15] cosine check vs S7: cos=0.4123
[S15] BUFFERED delta from S7 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1800) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.735842)
[S9] loaded HEAD from S5 (vec_in norm=1.735842)
[S9] cosine check vs S5: cos=0.9777
[S9] BUFFERED delta from S5 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1809) from S3
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.519183)
[S15] loaded HEAD from S3 (vec_in norm=1.519183)
[S15] cosine check vs S3: cos=0.8940
[S15] BUFFERED delta from S3 (total buffered=2)
[S3] RECEIVED delta(kind=head bytes=1798) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.937396)
[S3] loaded HEAD from S8 (vec_in norm=0.937396)
[S3] cosine check vs S8: cos=0.2439
[S3] BUFFERED delta from S8 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1801) from S6
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.232135)
[S8] loaded HEAD from S6 (vec_in norm=1.232135)
[S8] cosine check vs S6: cos=0.8456
[S8] BUFFERED delta from S6 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1801) from S11
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.663872)
[S7] loaded HEAD from S11 (vec_in norm=1.663872)
[S7] cosine check vs S11: cos=0.7882
[S7] BUFFERED delta from S11 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1801) from S4
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.749740)
[S2] loaded HEAD from S4 (vec_in norm=1.749740)
[S2] cosine check vs S4: cos=0.9965
[S2] BUFFERED delta from S4 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:57009
[S17] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.349352)
[S8] loaded HEAD from S17 (vec_in norm=1.349352)
[S8] cosine check vs S17: cos=0.3435
[S8] BUFFERED delta from S17 (total buffered=2)
[S13] ⇄ pheromone p=0.134 → S15@127.0.0.1:57015
[S10] ⇄ pheromone p=0.193 → S7@127.0.0.1:57008
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=15 metric=0.9935 head_norm=1.762642
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.850133e-01
[S9] stored merged vector for next round verification (round=15)
[S9] DEBUG after merge:  round=15 metric=0.9934 head_norm=1.739482 delta_norm=0.185013
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.136 → S3@127.0.0.1:57003
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=15 metric=0.7014 head_norm=1.764709
[S2] _apply_head_vector_avg (torch): Δ‖w‖=7.408129e-02
[S2] stored merged vector for next round verification (round=15)
[S2] DEBUG after merge:  round=15 metric=0.7014 head_norm=1.755678 delta_norm=0.074081
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.155 → S10@127.0.0.1:57011
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=15 metric=0.6963 head_norm=0.921423
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.779366e-01
[S15] stored merged vector for next round verification (round=15)
[S15] DEBUG after merge:  round=15 metric=0.6969 head_norm=0.920499 delta_norm=0.177937
[S15] aggregate: ACCEPT kept=['S7', 'S3'] (k=2/2) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.157 → S10@127.0.0.1:57011
[S14] ⇄ pheromone p=0.235 → S6@127.0.0.1:57007
[S16] ⇄ pheromone p=0.195 → S6@127.0.0.1:57007
[S4] ⇄ pheromone p=0.243 → S2@127.0.0.1:57002
[S5] ⇄ pheromone p=0.101 → S9@127.0.0.1:57010
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=15 metric=0.7012 head_norm=0.937396
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.771319e-01
[S8] stored merged vector for next round verification (round=15)
[S8] DEBUG after merge:  round=15 metric=0.7012 head_norm=0.884537 delta_norm=0.277132
[S8] aggregate: ACCEPT kept=['S6', 'S17'] (k=2/2) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.301 → S3@127.0.0.1:57003
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=15 metric=0.6259 head_norm=0.999940
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.351827e-01
[S7] stored merged vector for next round verification (round=15)
[S7] DEBUG after merge:  round=15 metric=0.2795 head_norm=1.264023 delta_norm=0.535183
[S7] aggregate: ROLLBACK (f1_val pre=0.626 post=0.279 tol_abs=0.005 tol_rel=0.0)
[S7] ⇄ pheromone p=0.225 → S15@127.0.0.1:57015
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=15 metric=0.7006 head_norm=1.519183
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.892960e-01
[S3] stored merged vector for next round verification (round=15)
[S3] DEBUG after merge:  round=15 metric=0.7006 head_norm=0.985051 delta_norm=0.789296
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.114 → S15@127.0.0.1:57015
[S6] ⇄ pheromone p=0.433 → S8@127.0.0.1:57009
[S11] ⇄ pheromone p=0.291 → S7@127.0.0.1:57008
[S17] ⇄ pheromone p=0.313 → S8@127.0.0.1:57009
[S2] START round=16 head_norm_before_train=1.755678 cos_to_last_merge=1.0000 (last merge round=15)
[S2] round=16 local utility u=0.000000 metrics={'f1_val': 0.7013141837391442, 'auprc': 0.6725119904980531, 'loss_val': 0.3062535590294881, 'psi': 0.6897933064427078}-{'f1_val': 0.7013925629565125, 'auprc': 0.6873124625357243, 'loss_val': 0.30133735250477606, 'psi': 0.6957605227881973}
[S3] START round=16 head_norm_before_train=0.985051 cos_to_last_merge=1.0000 (last merge round=15)
[S3] round=16 local utility u=0.000000 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9951539249834902, 'loss_val': 0.3399930207752311, 'psi': 0.8184701457925969}-{'f1_val': 0.7006060025002057, 'auprc': 0.9987443017885759, 'loss_val': 0.3355714376371231, 'psi': 0.8198613222155537}
[S4] START round=16 head_norm_before_train=1.749740 (no previous merge yet)
[S4] round=16 local utility u=0.061633 metrics={'f1_val': 0.9542666952053231, 'auprc': 0.9631156530511629, 'loss_val': 0.32964272092685915, 'psi': 0.957806278343659}-{'f1_val': 0.9501750583319015, 'auprc': 0.9540894751276922, 'loss_val': 0.40127989067636954, 'psi': 0.9517408250502177}
[S5] START round=16 head_norm_before_train=1.735842 (no previous merge yet)
[S5] round=16 local utility u=0.000000 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.9877718984612089, 'loss_val': 0.25606246514489045, 'psi': 0.815474215787952}-{'f1_val': 0.7006083926626743, 'auprc': 0.988572352240069, 'loss_val': 0.21588119994318186, 'psi': 0.8157939764936322}
[S6] START round=16 head_norm_before_train=1.232135 cos_to_last_merge=0.9994 (last merge round=14)
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.6576031141752281, 'auprc': 0.7819349790530115, 'loss_val': 0.5240082115393379, 'psi': 0.7073358601263415}-{'f1_val': 0.6976199141673504, 'auprc': 0.9356129811728761, 'loss_val': 0.4463536453989613, 'psi': 0.7928171409695606}
[S7] START round=16 head_norm_before_train=1.264023 cos_to_last_merge=1.0000 (last merge round=15)
[S7] round=16 local utility u=0.000000 metrics={'f1_val': 0.6291912063080579, 'auprc': 0.8017993529565102, 'loss_val': 0.7930126204298806, 'psi': 0.6982344649674388}-{'f1_val': 0.6259444484003321, 'auprc': 0.8233847931229366, 'loss_val': 0.7783255534830271, 'psi': 0.7049205862893739}
[S8] START round=16 head_norm_before_train=0.884537 cos_to_last_merge=1.0000 (last merge round=15)
[S8] round=16 local utility u=0.000000 metrics={'f1_val': 0.7142391053978291, 'auprc': 0.7920162431057742, 'loss_val': 0.5458923579632947, 'psi': 0.7453499604810072}-{'f1_val': 0.7011506828958344, 'auprc': 0.997509439820754, 'loss_val': 0.41656034939943526, 'psi': 0.8196941856658022}
[S9] START round=16 head_norm_before_train=1.739482 cos_to_last_merge=1.0000 (last merge round=15)
[S9] round=16 local utility u=0.000239 metrics={'f1_val': 0.9934918488430377, 'auprc': 0.9979265481082286, 'loss_val': 0.11401023243226355, 'psi': 0.995265728549114}-{'f1_val': 0.9934918488430377, 'auprc': 0.9979934920365034, 'loss_val': 0.11468931185488562, 'psi': 0.995292506120424}
[S10] START round=16 head_norm_before_train=0.862436 cos_to_last_merge=0.9958 (last merge round=14)
[S10] round=16 local utility u=0.000000 metrics={'f1_val': 0.5970960373845693, 'auprc': 0.8644195511448518, 'loss_val': 0.5358604770534676, 'psi': 0.7040254428886823}-{'f1_val': 0.7007124550195878, 'auprc': 0.9972896855962063, 'loss_val': 0.5628126914276076, 'psi': 0.8193433472502352}
[S11] START round=16 head_norm_before_train=1.663872 (no previous merge yet)
[S11] round=16 local utility u=0.124191 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.996921453933684, 'loss_val': 0.1411247636034701, 'psi': 0.9966967842816273}-{'f1_val': 0.9580598988783908, 'auprc': 0.9977045879806272, 'loss_val': 0.16093272568986455, 'psi': 0.9739177745192854}
[S13] START round=16 head_norm_before_train=1.201281 cos_to_last_merge=0.8797 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.880
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.5740176484913257, 'auprc': 0.6415181299218002, 'loss_val': 0.741046495297366, 'psi': 0.6010178410635155}-{'f1_val': 0.5870700193736681, 'auprc': 0.6476780238199251, 'loss_val': 0.7136906407128717, 'psi': 0.6113132211521709}
[S14] START round=16 head_norm_before_train=1.758981 (no previous merge yet)
[S14] round=16 local utility u=0.051228 metrics={'f1_val': 0.9974830777164877, 'auprc': 0.9991944350672615, 'loss_val': 0.06213472129033542, 'psi': 0.9981676206567972}-{'f1_val': 0.9970007132142444, 'auprc': 0.9970307809895523, 'loss_val': 0.15520490691620892, 'psi': 0.9970127403243676}
[S15] START round=16 head_norm_before_train=0.920499 cos_to_last_merge=1.0000 (last merge round=15)
[S15] round=16 local utility u=0.000000 metrics={'f1_val': 0.6979623859944505, 'auprc': 0.7994796487203927, 'loss_val': 0.6046941213295077, 'psi': 0.7385692910848274}-{'f1_val': 0.6963456616397163, 'auprc': 0.7994939092051728, 'loss_val': 0.5880114911312756, 'psi': 0.737604960665899}
[S16] START round=16 head_norm_before_train=1.290174 cos_to_last_merge=0.8669 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.867
[S16] round=16 local utility u=0.460353 metrics={'f1_val': 0.5777924079371599, 'auprc': 0.7986219824763975, 'loss_val': 0.7495281020289254, 'psi': 0.6661242377528549}-{'f1_val': 0.45285279087058045, 'auprc': 0.7563853607105488, 'loss_val': 0.7938868922053419, 'psi': 0.5742658188065678}
[S17] START round=16 head_norm_before_train=1.349352 cos_to_last_merge=0.8021 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.802
[S17] round=16 local utility u=0.000000 metrics={'f1_val': 0.5688194837558167, 'auprc': 0.7987943916525169, 'loss_val': 0.6905737459345967, 'psi': 0.6608094469144967}-{'f1_val': 0.5951645310433009, 'auprc': 0.9536959623361114, 'loss_val': 0.5020777765718342, 'psi': 0.7385771035604252}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:57007
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:57003
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:57007
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:57002
[S16] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1804) from S14
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.784713)
[S6] loaded HEAD from S14 (vec_in norm=1.784713)
[S6] cosine check vs S14: cos=-0.0680
[S6] DROPPED delta from S14 (cos=-0.0680 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1802) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.780617)
[S3] loaded HEAD from S9 (vec_in norm=1.780617)
[S3] cosine check vs S9: cos=0.7511
[S3] BUFFERED delta from S9 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1802) from S4
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.763236)
[S2] loaded HEAD from S4 (vec_in norm=1.763236)
[S2] cosine check vs S4: cos=0.9976
[S2] BUFFERED delta from S4 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1800) from S11
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.700296)
[S7] loaded HEAD from S11 (vec_in norm=1.700296)
[S7] cosine check vs S11: cos=0.9511
[S7] BUFFERED delta from S11 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1798) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.318555)
[S6] loaded HEAD from S16 (vec_in norm=1.318555)
[S6] cosine check vs S16: cos=0.9784
[S6] BUFFERED delta from S16 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=16 metric=0.7007 head_norm=1.051852
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.048655e-01
[S3] stored merged vector for next round verification (round=16)
[S3] DEBUG after merge:  round=16 metric=0.7007 head_norm=1.331403 delta_norm=0.604865
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=16 metric=0.6576 head_norm=1.256015
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.373120e-01
[S6] stored merged vector for next round verification (round=16)
[S6] DEBUG after merge:  round=16 metric=0.6337 head_norm=1.280323 delta_norm=0.137312
[S6] aggregate: ROLLBACK (f1_val pre=0.658 post=0.634 tol_abs=0.005 tol_rel=0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=16 metric=0.7013 head_norm=1.783370
[S2] _apply_head_vector_avg (torch): Δ‖w‖=6.266491e-02
[S2] stored merged vector for next round verification (round=16)
[S2] DEBUG after merge:  round=16 metric=0.7013 head_norm=1.772224 delta_norm=0.062665
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=16 metric=0.6292 head_norm=1.291722
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.089256e-01
[S7] stored merged vector for next round verification (round=16)
[S7] DEBUG after merge:  round=16 metric=0.2990 head_norm=1.477951 delta_norm=0.308926
[S7] aggregate: ROLLBACK (f1_val pre=0.629 post=0.299 tol_abs=0.005 tol_rel=0.0)
[S2] START round=17 head_norm_before_train=1.772224 cos_to_last_merge=1.0000 (last merge round=16)
[S2] round=17 local utility u=0.000000 metrics={'f1_val': 0.7011337461190337, 'auprc': 0.6678223221661942, 'loss_val': 0.3183678271550414, 'psi': 0.687809176537898}-{'f1_val': 0.7013141837391442, 'auprc': 0.6725119904980531, 'loss_val': 0.3062535590294881, 'psi': 0.6897933064427078}
[S3] START round=17 head_norm_before_train=1.331403 cos_to_last_merge=1.0000 (last merge round=16)
[S3] round=17 local utility u=0.008335 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9986785411623113, 'loss_val': 0.33389639404791244, 'psi': 0.8198799922641253}-{'f1_val': 0.7006809596653347, 'auprc': 0.9951539249834902, 'loss_val': 0.3399930207752311, 'psi': 0.8184701457925969}
[S4] START round=17 head_norm_before_train=1.763236 (no previous merge yet)
[S4] round=17 local utility u=0.000000 metrics={'f1_val': 0.951135228984695, 'auprc': 0.9393882323618905, 'loss_val': 0.3325208358035697, 'psi': 0.9464364303355732}-{'f1_val': 0.9542666952053231, 'auprc': 0.9631156530511629, 'loss_val': 0.32964272092685915, 'psi': 0.957806278343659}
[S5] START round=17 head_norm_before_train=1.742112 (no previous merge yet)
[S5] round=17 local utility u=0.000000 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.863167689918427, 'loss_val': 0.3749972019119883, 'psi': 0.7656321115649753}-{'f1_val': 0.7006090940057808, 'auprc': 0.9877718984612089, 'loss_val': 0.25606246514489045, 'psi': 0.815474215787952}
[S6] START round=17 head_norm_before_train=1.280323 cos_to_last_merge=1.0000 (last merge round=16)
[S6] round=17 local utility u=1.000000 metrics={'f1_val': 0.8983704026447166, 'auprc': 0.9608643545007697, 'loss_val': 0.40732064054248884, 'psi': 0.9233679833871378}-{'f1_val': 0.6576031141752281, 'auprc': 0.7819349790530115, 'loss_val': 0.5240082115393379, 'psi': 0.7073358601263415}
[S7] START round=17 head_norm_before_train=1.477951 cos_to_last_merge=1.0000 (last merge round=16)
[S7] round=17 local utility u=0.088583 metrics={'f1_val': 0.6422397655116292, 'auprc': 0.8082570994563869, 'loss_val': 0.7135105266377461, 'psi': 0.7086466990895324}-{'f1_val': 0.6291912063080579, 'auprc': 0.8017993529565102, 'loss_val': 0.7930126204298806, 'psi': 0.6982344649674388}
[S8] START round=17 head_norm_before_train=0.929758 cos_to_last_merge=0.9960 (last merge round=15)
[S8] round=17 local utility u=0.311887 metrics={'f1_val': 0.6995055990847787, 'auprc': 0.9788900591375181, 'loss_val': 0.39433959321772905, 'psi': 0.8112593831058745}-{'f1_val': 0.7142391053978291, 'auprc': 0.7920162431057742, 'loss_val': 0.5458923579632947, 'psi': 0.7453499604810072}
[S9] START round=17 head_norm_before_train=1.780617 cos_to_last_merge=0.9976 (last merge round=15)
[S9] round=17 local utility u=0.025340 metrics={'f1_val': 0.9951655063899485, 'auprc': 0.9979762734466727, 'loss_val': 0.07352191218741778, 'psi': 0.9962898132126381}-{'f1_val': 0.9934918488430377, 'auprc': 0.9979265481082286, 'loss_val': 0.11401023243226355, 'psi': 0.995265728549114}
[S10] START round=17 head_norm_before_train=0.914523 cos_to_last_merge=0.9856 (last merge round=14)
[S10] round=17 local utility u=0.583423 metrics={'f1_val': 0.699260083987036, 'auprc': 0.9978622068737069, 'loss_val': 0.38232616392547664, 'psi': 0.8187009331417043}-{'f1_val': 0.5970960373845693, 'auprc': 0.8644195511448518, 'loss_val': 0.5358604770534676, 'psi': 0.7040254428886823}
[S11] START round=17 head_norm_before_train=1.700296 (no previous merge yet)
[S11] round=17 local utility u=0.009425 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9977108794617598, 'loss_val': 0.1231916571225003, 'psi': 0.9968674522660206}-{'f1_val': 0.9965470045135896, 'auprc': 0.996921453933684, 'loss_val': 0.1411247636034701, 'psi': 0.9966967842816273}
[S13] START round=17 head_norm_before_train=1.223987 cos_to_last_merge=0.8714 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.871
[S13] round=17 local utility u=0.052720 metrics={'f1_val': 0.5835822407725271, 'auprc': 0.6498033773410348, 'loss_val': 0.7178488870396214, 'psi': 0.6100706953999302}-{'f1_val': 0.5740176484913257, 'auprc': 0.6415181299218002, 'loss_val': 0.741046495297366, 'psi': 0.6010178410635155}
[S14] START round=17 head_norm_before_train=1.784713 (no previous merge yet)
[S14] round=17 local utility u=0.000000 metrics={'f1_val': 0.9965760575063591, 'auprc': 0.9990988786704675, 'loss_val': 0.05887561109474501, 'psi': 0.9975851859720024}-{'f1_val': 0.9974830777164877, 'auprc': 0.9991944350672615, 'loss_val': 0.06213472129033542, 'psi': 0.9981676206567972}
[S15] START round=17 head_norm_before_train=0.969775 cos_to_last_merge=0.9954 (last merge round=15)
[S15] round=17 local utility u=0.339178 metrics={'f1_val': 0.68246387060328, 'auprc': 0.9976896600106829, 'loss_val': 0.42797617810998034, 'psi': 0.8085541863662411}-{'f1_val': 0.6979623859944505, 'auprc': 0.7994796487203927, 'loss_val': 0.6046941213295077, 'psi': 0.7385692910848274}
[S16] START round=17 head_norm_before_train=1.318555 cos_to_last_merge=0.8626 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.863
[S16] round=17 local utility u=0.722660 metrics={'f1_val': 0.777850292347607, 'auprc': 0.8271917971622613, 'loss_val': 0.5902656912506489, 'psi': 0.7975868942734687}-{'f1_val': 0.5777924079371599, 'auprc': 0.7986219824763975, 'loss_val': 0.7495281020289254, 'psi': 0.6661242377528549}
[S17] START round=17 head_norm_before_train=1.392362 cos_to_last_merge=0.7939 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.794
[S17] round=17 local utility u=1.000000 metrics={'f1_val': 0.7761257716782796, 'auprc': 0.9931666454720858, 'loss_val': 0.4617468985852616, 'psi': 0.862942121195802}-{'f1_val': 0.5688194837558167, 'auprc': 0.7987943916525169, 'loss_val': 0.6905737459345967, 'psi': 0.6608094469144967}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:57015
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:57008
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:57011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S3] → sending delta(kind=head bytes=1807) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:57009
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:57003
[S16] sending update (kind=head size=1804 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1807 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1799) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.975607)
[S3] loaded HEAD from S8 (vec_in norm=0.975607)
[S3] cosine check vs S8: cos=0.2863
[S3] BUFFERED delta from S8 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1798) from S6
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.304718)
[S8] loaded HEAD from S6 (vec_in norm=1.304718)
[S8] cosine check vs S6: cos=0.7765
[S8] BUFFERED delta from S6 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1803) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=0.964526)
[S7] loaded HEAD from S10 (vec_in norm=0.964526)
[S7] cosine check vs S10: cos=0.1816
[S7] BUFFERED delta from S10 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1801) from S11
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.731790)
[S7] loaded HEAD from S11 (vec_in norm=1.731790)
[S7] cosine check vs S11: cos=0.9773
[S7] BUFFERED delta from S11 (total buffered=2)
[S10] RECEIVED delta(kind=head bytes=1800) from S15
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.021892)
[S10] loaded HEAD from S15 (vec_in norm=1.021892)
[S10] cosine check vs S15: cos=0.7656
[S10] BUFFERED delta from S15 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1804) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.350422)
[S6] loaded HEAD from S16 (vec_in norm=1.350422)
[S6] cosine check vs S16: cos=0.9893
[S6] BUFFERED delta from S16 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1795) from S7
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.504284)
[S15] loaded HEAD from S7 (vec_in norm=1.504284)
[S15] cosine check vs S7: cos=0.3618
[S15] BUFFERED delta from S7 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1807) from S3
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.381461)
[S15] loaded HEAD from S3 (vec_in norm=1.381461)
[S15] cosine check vs S3: cos=0.8749
[S15] BUFFERED delta from S3 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1801) from S13
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.243419)
[S15] loaded HEAD from S13 (vec_in norm=1.243419)
[S15] cosine check vs S13: cos=0.1874
[S15] BUFFERED delta from S13 (total buffered=3)
[S3] RECEIVED delta(kind=head bytes=1801) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.826918)
[S3] loaded HEAD from S9 (vec_in norm=1.826918)
[S3] cosine check vs S9: cos=0.9491
[S3] BUFFERED delta from S9 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:57009
[S17] sending update (kind=head size=1796 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1796) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.432575)
[S8] loaded HEAD from S17 (vec_in norm=1.432575)
[S8] cosine check vs S17: cos=0.5160
[S8] BUFFERED delta from S17 (total buffered=2)
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=17 metric=0.6995 head_norm=0.975607
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.162473e-01
[S8] stored merged vector for next round verification (round=17)
[S8] DEBUG after merge:  round=17 metric=0.6995 head_norm=0.949506 delta_norm=0.216247
[S8] aggregate: ACCEPT kept=['S6', 'S17'] (k=2/2) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=17 metric=0.6993 head_norm=0.964526
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.411217e-01
[S10] stored merged vector for next round verification (round=17)
[S10] DEBUG after merge:  round=17 metric=0.6993 head_norm=0.933232 delta_norm=0.341122
[S10] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=17 metric=0.7007 head_norm=1.381461
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.456358e-01
[S3] stored merged vector for next round verification (round=17)
[S3] DEBUG after merge:  round=17 metric=0.7006 head_norm=1.204553 delta_norm=0.245636
[S3] aggregate: ACCEPT kept=['S8', 'S9'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=17 metric=0.6825 head_norm=1.021892
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.815282e-01
[S15] stored merged vector for next round verification (round=17)
[S15] DEBUG after merge:  round=17 metric=0.6816 head_norm=0.877426 delta_norm=0.281528
[S15] aggregate: ACCEPT kept=['S7', 'S3', 'S13'] (k=3/3) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=17 metric=0.6422 head_norm=1.504284
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.474720e-01
[S7] stored merged vector for next round verification (round=17)
[S7] DEBUG after merge:  round=17 metric=0.6569 head_norm=1.235088 delta_norm=0.347472
[S7] aggregate: ACCEPT kept=['S10', 'S11'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=17 metric=0.8984 head_norm=1.304718
[S6] _apply_head_vector_avg (torch): Δ‖w‖=9.982547e-02
[S6] stored merged vector for next round verification (round=17)
[S6] DEBUG after merge:  round=17 metric=0.9581 head_norm=1.324009 delta_norm=0.099825
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.797852 cos_to_last_merge=0.9998 (last merge round=16)
[S2] round=18 local utility u=0.000000 metrics={'f1_val': 0.6944643127638035, 'auprc': 0.6612642937459992, 'loss_val': 0.34675796263585235, 'psi': 0.6811843051566817}-{'f1_val': 0.7011337461190337, 'auprc': 0.6678223221661942, 'loss_val': 0.3183678271550414, 'psi': 0.687809176537898}
[S3] START round=18 head_norm_before_train=1.204553 cos_to_last_merge=1.0000 (last merge round=17)
[S3] round=18 local utility u=0.000919 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.9986603980498469, 'loss_val': 0.33155358376707134, 'psi': 0.8198277607200621}-{'f1_val': 0.7006809596653347, 'auprc': 0.9986785411623113, 'loss_val': 0.33389639404791244, 'psi': 0.8198799922641253}
[S4] START round=18 head_norm_before_train=1.779609 (no previous merge yet)
[S4] round=18 local utility u=0.074138 metrics={'f1_val': 0.9536621303463492, 'auprc': 0.9680640054758258, 'loss_val': 0.2854337039926825, 'psi': 0.9594228803981399}-{'f1_val': 0.951135228984695, 'auprc': 0.9393882323618905, 'loss_val': 0.3325208358035697, 'psi': 0.9464364303355732}
[S5] START round=18 head_norm_before_train=1.742916 (no previous merge yet)
[S5] round=18 local utility u=0.000000 metrics={'f1_val': 0.41786968009904246, 'auprc': 0.804919437464419, 'loss_val': 0.9928908664736609, 'psi': 0.572689583045193}-{'f1_val': 0.7006083926626743, 'auprc': 0.863167689918427, 'loss_val': 0.3749972019119883, 'psi': 0.7656321115649753}
[S6] START round=18 head_norm_before_train=1.324009 cos_to_last_merge=1.0000 (last merge round=17)
[S6] round=18 local utility u=0.000000 metrics={'f1_val': 0.7075365143577863, 'auprc': 0.7799773290828554, 'loss_val': 0.473176061777034, 'psi': 0.7365128402478139}-{'f1_val': 0.8983704026447166, 'auprc': 0.9608643545007697, 'loss_val': 0.40732064054248884, 'psi': 0.9233679833871378}
[S7] START round=18 head_norm_before_train=1.235088 cos_to_last_merge=1.0000 (last merge round=17)
[S7] round=18 local utility u=0.072607 metrics={'f1_val': 0.6453051801621749, 'auprc': 0.8280428271332, 'loss_val': 0.646047020249656, 'psi': 0.7184002389505849}-{'f1_val': 0.6422397655116292, 'auprc': 0.8082570994563869, 'loss_val': 0.7135105266377461, 'psi': 0.7086466990895324}
[S8] START round=18 head_norm_before_train=0.949506 cos_to_last_merge=1.0000 (last merge round=17)
[S8] round=18 local utility u=0.016280 metrics={'f1_val': 0.7008892834979159, 'auprc': 0.9939835963151317, 'loss_val': 0.41536274439345877, 'psi': 0.8181270086248023}-{'f1_val': 0.6995055990847787, 'auprc': 0.9788900591375181, 'loss_val': 0.39433959321772905, 'psi': 0.8112593831058745}
[S9] START round=18 head_norm_before_train=1.826918 cos_to_last_merge=0.9919 (last merge round=15)
[S9] round=18 local utility u=0.013725 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9982496685587112, 'loss_val': 0.05435931352119856, 'psi': 0.9971459788238171}-{'f1_val': 0.9951655063899485, 'auprc': 0.9979762734466727, 'loss_val': 0.07352191218741778, 'psi': 0.9962898132126381}
[S10] START round=18 head_norm_before_train=0.933232 cos_to_last_merge=1.0000 (last merge round=17)
[S10] round=18 local utility u=0.000000 metrics={'f1_val': 0.7010068055154964, 'auprc': 0.9977915443872352, 'loss_val': 0.4382934302929363, 'psi': 0.8197207010641919}-{'f1_val': 0.699260083987036, 'auprc': 0.9978622068737069, 'loss_val': 0.38232616392547664, 'psi': 0.8187009331417043}
[S11] START round=18 head_norm_before_train=1.731790 (no previous merge yet)
[S11] round=18 local utility u=0.000000 metrics={'f1_val': 0.9937321643160818, 'auprc': 0.9974879430418327, 'loss_val': 0.13050578981601785, 'psi': 0.9952344758063822}-{'f1_val': 0.996305167468861, 'auprc': 0.9977108794617598, 'loss_val': 0.1231916571225003, 'psi': 0.9968674522660206}
[S13] START round=18 head_norm_before_train=1.243419 cos_to_last_merge=0.8631 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.863
[S13] round=18 local utility u=0.126879 metrics={'f1_val': 0.6034449765232092, 'auprc': 0.6825058333571079, 'loss_val': 0.6813741352349267, 'psi': 0.6350693192567687}-{'f1_val': 0.5835822407725271, 'auprc': 0.6498033773410348, 'loss_val': 0.7178488870396214, 'psi': 0.6100706953999302}
[S14] START round=18 head_norm_before_train=1.810958 (no previous merge yet)
[S14] round=18 local utility u=0.006565 metrics={'f1_val': 0.9965760575063591, 'auprc': 0.9992755609082861, 'loss_val': 0.04627609525342171, 'psi': 0.9976558588671298}-{'f1_val': 0.9965760575063591, 'auprc': 0.9990988786704675, 'loss_val': 0.05887561109474501, 'psi': 0.9975851859720024}
[S15] START round=18 head_norm_before_train=0.877426 cos_to_last_merge=1.0000 (last merge round=17)
[S15] round=18 local utility u=0.000000 metrics={'f1_val': 0.7009999797572797, 'auprc': 0.7995722331054069, 'loss_val': 0.5407645634958658, 'psi': 0.7404288810965306}-{'f1_val': 0.68246387060328, 'auprc': 0.9976896600106829, 'loss_val': 0.42797617810998034, 'psi': 0.8085541863662411}
[S16] START round=18 head_norm_before_train=1.350422 cos_to_last_merge=0.8580 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.858
[S16] round=18 local utility u=0.079841 metrics={'f1_val': 0.8186592280014375, 'auprc': 0.8543161432286448, 'loss_val': 0.7568103573269578, 'psi': 0.8329219940923205}-{'f1_val': 0.777850292347607, 'auprc': 0.8271917971622613, 'loss_val': 0.5902656912506489, 'psi': 0.7975868942734687}
[S17] START round=18 head_norm_before_train=1.432575 cos_to_last_merge=0.7864 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.786
[S17] round=18 local utility u=0.000000 metrics={'f1_val': 0.5712144304356461, 'auprc': 0.8402326406154208, 'loss_val': 0.7754247001422766, 'psi': 0.678821714507556}-{'f1_val': 0.7761257716782796, 'auprc': 0.9931666454720858, 'loss_val': 0.4617468985852616, 'psi': 0.862942121195802}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:57015
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:57003
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:57002
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:57007
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1803) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.865589)
[S3] loaded HEAD from S9 (vec_in norm=1.865589)
[S3] cosine check vs S9: cos=0.9131
[S3] BUFFERED delta from S9 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1801) from S4
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.800229)
[S2] loaded HEAD from S4 (vec_in norm=1.800229)
[S2] cosine check vs S4: cos=0.9962
[S2] BUFFERED delta from S4 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1802) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.388072)
[S6] loaded HEAD from S16 (vec_in norm=1.388072)
[S6] cosine check vs S16: cos=0.9927
[S6] BUFFERED delta from S16 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1800) from S14
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.836932)
[S6] loaded HEAD from S14 (vec_in norm=1.836932)
[S6] cosine check vs S14: cos=-0.0607
[S6] DROPPED delta from S14 (cos=-0.0607 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1797) from S7
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.273329)
[S15] loaded HEAD from S7 (vec_in norm=1.273329)
[S15] cosine check vs S7: cos=0.5510
[S15] BUFFERED delta from S7 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1800) from S3
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.258045)
[S15] loaded HEAD from S3 (vec_in norm=1.258045)
[S15] cosine check vs S3: cos=0.8260
[S15] BUFFERED delta from S3 (total buffered=2)
[S3] RECEIVED delta(kind=head bytes=1796) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.984547)
[S3] loaded HEAD from S8 (vec_in norm=0.984547)
[S3] cosine check vs S8: cos=0.3526
[S3] BUFFERED delta from S8 (total buffered=2)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1801 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1801) from S13
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.266357)
[S15] loaded HEAD from S13 (vec_in norm=1.266357)
[S15] cosine check vs S13: cos=0.3628
[S15] BUFFERED delta from S13 (total buffered=3)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=18 metric=0.6945 head_norm=1.817204
[S2] _apply_head_vector_avg (torch): Δ‖w‖=7.882226e-02
[S2] stored merged vector for next round verification (round=18)
[S2] DEBUG after merge:  round=18 metric=0.6937 head_norm=1.807018 delta_norm=0.078822
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=18 metric=0.7075 head_norm=1.344400
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.548330e-02
[S6] stored merged vector for next round verification (round=18)
[S6] DEBUG after merge:  round=18 metric=0.7075 head_norm=1.363734 delta_norm=0.085483
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=18 metric=0.7006 head_norm=1.258045
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.826957e-01
[S3] stored merged vector for next round verification (round=18)
[S3] DEBUG after merge:  round=18 metric=0.7006 head_norm=1.150325 delta_norm=0.182696
[S3] aggregate: ACCEPT kept=['S9', 'S8'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=18 metric=0.7010 head_norm=0.922357
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.532431e-01
[S15] stored merged vector for next round verification (round=18)
[S15] DEBUG after merge:  round=18 metric=0.7010 head_norm=0.847973 delta_norm=0.153243
[S15] aggregate: ACCEPT kept=['S7', 'S3', 'S13'] (k=3/3) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.807018 cos_to_last_merge=1.0000 (last merge round=18)
[S2] round=19 local utility u=0.151559 metrics={'f1_val': 0.7071386470427298, 'auprc': 0.7793378011825584, 'loss_val': 0.4739067738262275, 'psi': 0.7360183086986612}-{'f1_val': 0.6944643127638035, 'auprc': 0.6612642937459992, 'loss_val': 0.34675796263585235, 'psi': 0.6811843051566817}
[S3] START round=19 head_norm_before_train=1.150325 cos_to_last_merge=1.0000 (last merge round=18)
[S3] round=19 local utility u=0.000000 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.9986244907153465, 'loss_val': 0.3333867310132891, 'psi': 0.819813397786262}-{'f1_val': 0.7006060025002057, 'auprc': 0.9986603980498469, 'loss_val': 0.33155358376707134, 'psi': 0.8198277607200621}
[S4] START round=19 head_norm_before_train=1.800229 (no previous merge yet)
[S4] round=19 local utility u=0.023752 metrics={'f1_val': 0.956240344809222, 'auprc': 0.9744280060918702, 'loss_val': 0.27249038099373885, 'psi': 0.9635154093222813}-{'f1_val': 0.9536621303463492, 'auprc': 0.9680640054758258, 'loss_val': 0.2854337039926825, 'psi': 0.9594228803981399}
[S5] START round=19 head_norm_before_train=1.753092 (no previous merge yet)
[S5] round=19 local utility u=1.000000 metrics={'f1_val': 0.6773949100436967, 'auprc': 0.8745922294445323, 'loss_val': 0.5452800899913024, 'psi': 0.756273837804031}-{'f1_val': 0.41786968009904246, 'auprc': 0.804919437464419, 'loss_val': 0.9928908664736609, 'psi': 0.572689583045193}
[S6] START round=19 head_norm_before_train=1.363734 cos_to_last_merge=1.0000 (last merge round=18)
[S6] round=19 local utility u=1.000000 metrics={'f1_val': 0.9535814293488545, 'auprc': 0.930998083862417, 'loss_val': 0.4014536387370284, 'psi': 0.9445480911542795}-{'f1_val': 0.7075365143577863, 'auprc': 0.7799773290828554, 'loss_val': 0.473176061777034, 'psi': 0.7365128402478139}
[S7] START round=19 head_norm_before_train=1.273329 cos_to_last_merge=0.9959 (last merge round=17)
[S7] round=19 local utility u=0.000000 metrics={'f1_val': 0.5397015756535672, 'auprc': 0.7923790380262739, 'loss_val': 0.8345500352741356, 'psi': 0.64077256060265}-{'f1_val': 0.6453051801621749, 'auprc': 0.8280428271332, 'loss_val': 0.646047020249656, 'psi': 0.7184002389505849}
[S8] START round=19 head_norm_before_train=0.984547 cos_to_last_merge=0.9979 (last merge round=17)
[S8] round=19 local utility u=0.066440 metrics={'f1_val': 0.7107148103224196, 'auprc': 0.9962008986500253, 'loss_val': 0.3480871223244194, 'psi': 0.8249092456534619}-{'f1_val': 0.7008892834979159, 'auprc': 0.9939835963151317, 'loss_val': 0.41536274439345877, 'psi': 0.8181270086248023}
[S9] START round=19 head_norm_before_train=1.865589 cos_to_last_merge=0.9875 (last merge round=15)
[S9] round=19 local utility u=0.005605 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9982303935408403, 'loss_val': 0.04459307667975421, 'psi': 0.997288464504671}-{'f1_val': 0.9964101856672208, 'auprc': 0.9982496685587112, 'loss_val': 0.05435931352119856, 'psi': 0.9971459788238171}
[S10] START round=19 head_norm_before_train=0.976652 cos_to_last_merge=0.9971 (last merge round=17)
[S10] round=19 local utility u=0.921542 metrics={'f1_val': 0.9951887897730489, 'auprc': 0.9976483967683115, 'loss_val': 0.3598723012604928, 'psi': 0.996172632571154}-{'f1_val': 0.7010068055154964, 'auprc': 0.9977915443872352, 'loss_val': 0.4382934302929363, 'psi': 0.8197207010641919}
[S11] START round=19 head_norm_before_train=1.760614 (no previous merge yet)
[S11] round=19 local utility u=0.021882 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9976908380140357, 'loss_val': 0.10030838521999307, 'psi': 0.9966114379267628}-{'f1_val': 0.9937321643160818, 'auprc': 0.9974879430418327, 'loss_val': 0.13050578981601785, 'psi': 0.9952344758063822}
[S13] START round=19 head_norm_before_train=1.266357 cos_to_last_merge=0.8574 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.857
[S13] round=19 local utility u=0.083389 metrics={'f1_val': 0.6228909280876884, 'auprc': 0.6745776192446371, 'loss_val': 0.6074866235976354, 'psi': 0.6435656045504679}-{'f1_val': 0.6034449765232092, 'auprc': 0.6825058333571079, 'loss_val': 0.6813741352349267, 'psi': 0.6350693192567687}
[S14] START round=19 head_norm_before_train=1.836932 (no previous merge yet)
[S14] round=19 local utility u=0.007495 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9990918703467343, 'loss_val': 0.037184643534372765, 'psi': 0.9982274189686059}-{'f1_val': 0.9965760575063591, 'auprc': 0.9992755609082861, 'loss_val': 0.04627609525342171, 'psi': 0.9976558588671298}
[S15] START round=19 head_norm_before_train=0.847973 cos_to_last_merge=1.0000 (last merge round=18)
[S15] round=19 local utility u=0.000000 metrics={'f1_val': 0.6999510323111611, 'auprc': 0.7995576360877061, 'loss_val': 0.540679463967783, 'psi': 0.7397936738217791}-{'f1_val': 0.7009999797572797, 'auprc': 0.7995722331054069, 'loss_val': 0.5407645634958658, 'psi': 0.7404288810965306}
[S16] START round=19 head_norm_before_train=1.388072 cos_to_last_merge=0.8524 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.852
[S16] round=19 local utility u=0.150775 metrics={'f1_val': 0.8134660110831253, 'auprc': 0.8829385163170496, 'loss_val': 0.5099681102254334, 'psi': 0.8412550131766949}-{'f1_val': 0.8186592280014375, 'auprc': 0.8543161432286448, 'loss_val': 0.7568103573269578, 'psi': 0.8329219940923205}
[S17] START round=19 head_norm_before_train=1.463738 cos_to_last_merge=0.7817 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.782
[S17] round=19 local utility u=0.000000 metrics={'f1_val': 0.5523316603083481, 'auprc': 0.8046536372547214, 'loss_val': 0.7821325998103114, 'psi': 0.6532604510868973}-{'f1_val': 0.5712144304356461, 'auprc': 0.8402326406154208, 'loss_val': 0.7754247001422766, 'psi': 0.678821714507556}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:57009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] → sending delta(kind=head bytes=1806) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:57002
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] → sending delta(kind=head bytes=1805) to S10@127.0.0.1:57011
[S5] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1805 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1806 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1799) from S4
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.816599)
[S2] loaded HEAD from S4 (vec_in norm=1.816599)
[S2] cosine check vs S4: cos=0.9979
[S2] BUFFERED delta from S4 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1799) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.765387)
[S9] loaded HEAD from S5 (vec_in norm=1.765387)
[S9] cosine check vs S5: cos=0.9602
[S9] BUFFERED delta from S5 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1796) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.021520)
[S3] loaded HEAD from S8 (vec_in norm=1.021520)
[S3] cosine check vs S8: cos=0.4285
[S3] BUFFERED delta from S8 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1802) from S6
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.385506)
[S8] loaded HEAD from S6 (vec_in norm=1.385506)
[S8] cosine check vs S6: cos=0.7313
[S8] BUFFERED delta from S6 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1799) from S11
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.782341)
[S7] loaded HEAD from S11 (vec_in norm=1.782341)
[S7] cosine check vs S11: cos=0.9205
[S7] BUFFERED delta from S11 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1798) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.028116)
[S7] loaded HEAD from S10 (vec_in norm=1.028116)
[S7] cosine check vs S10: cos=0.4510
[S7] BUFFERED delta from S10 (total buffered=2)
[S10] RECEIVED delta(kind=head bytes=1805) from S2
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.824786)
[S10] loaded HEAD from S2 (vec_in norm=1.824786)
[S10] cosine check vs S2: cos=0.4106
[S10] BUFFERED delta from S2 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1797) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.428019)
[S6] loaded HEAD from S16 (vec_in norm=1.428019)
[S6] cosine check vs S16: cos=0.9941
[S6] BUFFERED delta from S16 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1799) from S14
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.860143)
[S6] loaded HEAD from S14 (vec_in norm=1.860143)
[S6] cosine check vs S14: cos=-0.0597
[S6] DROPPED delta from S14 (cos=-0.0597 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1806) from S13
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.287964)
[S15] loaded HEAD from S13 (vec_in norm=1.287964)
[S15] cosine check vs S13: cos=0.4468
[S15] BUFFERED delta from S13 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1804) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.896779)
[S3] loaded HEAD from S9 (vec_in norm=1.896779)
[S3] cosine check vs S9: cos=0.8909
[S3] BUFFERED delta from S9 (total buffered=2)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=19 metric=0.5397 head_norm=1.307596
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.074289e-01
[S7] stored merged vector for next round verification (round=19)
[S7] DEBUG after merge:  round=19 metric=0.5379 head_norm=1.191125 delta_norm=0.207429
[S7] aggregate: ACCEPT kept=['S11', 'S10'] (k=2/2) mode=median trim_p=0.1
[S7] r=20 psi=0.641 u=0.0000 p_local=0.1151 f1=0.540 auprc=0.792 bytes=17974
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=19 metric=0.7006 head_norm=1.205462
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.370206e-01
[S3] stored merged vector for next round verification (round=19)
[S3] DEBUG after merge:  round=19 metric=0.7006 head_norm=1.140668 delta_norm=0.137021
[S3] aggregate: ACCEPT kept=['S8', 'S9'] (k=2/2) mode=median trim_p=0.1
[S3] r=20 psi=0.820 u=0.0000 p_local=0.0481 f1=0.701 auprc=0.999 bytes=23420
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=19 metric=0.9536 head_norm=1.385506
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.909101e-02
[S6] stored merged vector for next round verification (round=19)
[S6] DEBUG after merge:  round=19 metric=0.9608 head_norm=1.404698 delta_norm=0.079091
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S6] r=20 psi=0.945 u=1.0000 p_local=0.5052 f1=0.954 auprc=0.931 bytes=17977
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=19 metric=0.7071 head_norm=1.824786
[S2] _apply_head_vector_avg (torch): Δ‖w‖=5.888261e-02
[S2] stored merged vector for next round verification (round=19)
[S2] DEBUG after merge:  round=19 metric=0.7069 head_norm=1.819745 delta_norm=0.058883
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] r=20 psi=0.736 u=0.1516 p_local=0.0938 f1=0.707 auprc=0.779 bytes=16175
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=19 metric=0.7107 head_norm=1.021520
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.725454e-01
[S8] stored merged vector for next round verification (round=19)
[S8] DEBUG after merge:  round=19 metric=0.7029 head_norm=1.121725 delta_norm=0.472545
[S8] aggregate: ROLLBACK (f1_val pre=0.711 post=0.703 tol_abs=0.005 tol_rel=0.0)
[S8] r=20 psi=0.825 u=0.0664 p_local=0.1789 f1=0.711 auprc=0.996 bytes=21545
[S4] r=20 psi=0.964 u=0.0238 p_local=0.1225 f1=0.956 auprc=0.974 bytes=25196
[S5] r=20 psi=0.756 u=1.0000 p_local=0.2412 f1=0.677 auprc=0.875 bytes=19798
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=19 metric=0.9967 head_norm=1.896779
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.663339e-01
[S9] stored merged vector for next round verification (round=19)
[S9] DEBUG after merge:  round=19 metric=0.9967 head_norm=1.812801 delta_norm=0.266334
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] r=20 psi=0.997 u=0.0056 p_local=0.0624 f1=0.997 auprc=0.998 bytes=25207
[S16] r=20 psi=0.841 u=0.1508 p_local=0.2625 f1=0.813 auprc=0.883 bytes=19786
[S17] r=20 psi=0.653 u=0.0000 p_local=0.2564 f1=0.552 auprc=0.805 bytes=17942
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=19 metric=0.9952 head_norm=1.028116
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.435105e-01
[S10] stored merged vector for next round verification (round=19)
[S10] DEBUG after merge:  round=19 metric=0.9574 head_norm=1.217343 delta_norm=0.843511
[S10] aggregate: ROLLBACK (f1_val pre=0.995 post=0.957 tol_abs=0.005 tol_rel=0.0)
[S10] r=20 psi=0.996 u=0.9215 p_local=0.3382 f1=0.995 auprc=0.998 bytes=19760
[S14] r=20 psi=0.998 u=0.0075 p_local=0.1040 f1=0.998 auprc=0.999 bytes=25179
[S13] r=20 psi=0.644 u=0.0834 p_local=0.0987 f1=0.623 auprc=0.675 bytes=17971
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=19 metric=0.7000 head_norm=0.891767
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.974292e-01
[S15] stored merged vector for next round verification (round=19)
[S15] DEBUG after merge:  round=19 metric=0.6998 head_norm=0.932807 delta_norm=0.597429
[S15] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S15] r=20 psi=0.740 u=0.0000 p_local=0.1079 f1=0.700 auprc=0.800 bytes=16180
[S11] r=20 psi=0.997 u=0.0219 p_local=0.1377 f1=0.996 auprc=0.998 bytes=27005
[S2] START round=20 head_norm_before_train=1.819745 cos_to_last_merge=1.0000 (last merge round=19)
[S2] round=20 local utility u=0.000000 metrics={'f1_val': 0.7012347841865968, 'auprc': 0.6684305896231199, 'loss_val': 0.3278868743099262, 'psi': 0.688113106361206}-{'f1_val': 0.7071386470427298, 'auprc': 0.7793378011825584, 'loss_val': 0.4739067738262275, 'psi': 0.7360183086986612}
[S3] START round=20 head_norm_before_train=1.140668 cos_to_last_merge=1.0000 (last merge round=19)
[S3] round=20 local utility u=0.001971 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.998880584698005, 'loss_val': 0.33066314220533494, 'psi': 0.8199608096784028}-{'f1_val': 0.7006060025002057, 'auprc': 0.9986244907153465, 'loss_val': 0.3333867310132891, 'psi': 0.819813397786262}
[S4] START round=20 head_norm_before_train=1.816599 (no previous merge yet)
[S4] round=20 local utility u=0.000000 metrics={'f1_val': 0.9451590578890365, 'auprc': 0.9377288962907726, 'loss_val': 0.2984923815632683, 'psi': 0.942186993249731}-{'f1_val': 0.956240344809222, 'auprc': 0.9744280060918702, 'loss_val': 0.27249038099373885, 'psi': 0.9635154093222813}
[S5] START round=20 head_norm_before_train=1.765387 (no previous merge yet)
[S5] round=20 local utility u=0.328545 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9719214515406572, 'loss_val': 0.3194591166872325, 'psi': 0.8091336162138675}-{'f1_val': 0.6773949100436967, 'auprc': 0.8745922294445323, 'loss_val': 0.5452800899913024, 'psi': 0.756273837804031}
[S6] START round=20 head_norm_before_train=1.404698 cos_to_last_merge=1.0000 (last merge round=19)
[S6] round=20 local utility u=0.065406 metrics={'f1_val': 0.9608093865550973, 'auprc': 0.9544739265701888, 'loss_val': 0.3844371300100429, 'psi': 0.9582752025611339}-{'f1_val': 0.9535814293488545, 'auprc': 0.930998083862417, 'loss_val': 0.4014536387370284, 'psi': 0.9445480911542795}
[S7] START round=20 head_norm_before_train=1.191125 cos_to_last_merge=1.0000 (last merge round=19)
[S7] round=20 local utility u=1.000000 metrics={'f1_val': 0.699923887872006, 'auprc': 0.9981714193598961, 'loss_val': 0.4035105346984665, 'psi': 0.8192229004671621}-{'f1_val': 0.5397015756535672, 'auprc': 0.7923790380262739, 'loss_val': 0.8345500352741356, 'psi': 0.64077256060265}
[S8] START round=20 head_norm_before_train=1.121725 cos_to_last_merge=1.0000 (last merge round=19)
[S8] round=20 local utility u=0.000000 metrics={'f1_val': 0.7000296083205206, 'auprc': 0.9835392503941915, 'loss_val': 0.3387817349645352, 'psi': 0.813433465149989}-{'f1_val': 0.7107148103224196, 'auprc': 0.9962008986500253, 'loss_val': 0.3480871223244194, 'psi': 0.8249092456534619}
[S9] START round=20 head_norm_before_train=1.812801 cos_to_last_merge=1.0000 (last merge round=19)
[S9] round=20 local utility u=0.000000 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9980690430997461, 'loss_val': 0.07072655000840687, 'psi': 0.9970737286402309}-{'f1_val': 0.9966605118138915, 'auprc': 0.9982303935408403, 'loss_val': 0.04459307667975421, 'psi': 0.997288464504671}
[S10] START round=20 head_norm_before_train=1.217343 cos_to_last_merge=1.0000 (last merge round=19)
[S10] round=20 local utility u=0.058228 metrics={'f1_val': 0.9947356868317377, 'auprc': 0.9974223048505764, 'loss_val': 0.24001992900375643, 'psi': 0.9958103340392732}-{'f1_val': 0.9951887897730489, 'auprc': 0.9976483967683115, 'loss_val': 0.3598723012604928, 'psi': 0.996172632571154}
[S11] START round=20 head_norm_before_train=1.782341 (no previous merge yet)
[S11] round=20 local utility u=0.000000 metrics={'f1_val': 0.9963753869090841, 'auprc': 0.9965144114091783, 'loss_val': 0.12771782265464393, 'psi': 0.9964309967091218}-{'f1_val': 0.9958918378685807, 'auprc': 0.9976908380140357, 'loss_val': 0.10030838521999307, 'psi': 0.9966114379267628}
[S13] START round=20 head_norm_before_train=1.287964 cos_to_last_merge=0.8519 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.852
[S13] round=20 local utility u=0.000000 metrics={'f1_val': 0.5896576921125352, 'auprc': 0.6861181818762571, 'loss_val': 0.7384860144444083, 'psi': 0.6282418880180239}-{'f1_val': 0.6228909280876884, 'auprc': 0.6745776192446371, 'loss_val': 0.6074866235976354, 'psi': 0.6435656045504679}
[S14] START round=20 head_norm_before_train=1.860143 (no previous merge yet)
[S14] round=20 local utility u=0.001102 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9991395758574062, 'loss_val': 0.03265994684999498, 'psi': 0.9980000443664383}-{'f1_val': 0.9976511180498535, 'auprc': 0.9990918703467343, 'loss_val': 0.037184643534372765, 'psi': 0.9982274189686059}
[S15] START round=20 head_norm_before_train=0.932807 cos_to_last_merge=1.0000 (last merge round=19)
[S15] round=20 local utility u=0.328883 metrics={'f1_val': 0.6974575403955958, 'auprc': 0.990216203354173, 'loss_val': 0.43992734931425975, 'psi': 0.8145610055790267}-{'f1_val': 0.6999510323111611, 'auprc': 0.7995576360877061, 'loss_val': 0.540679463967783, 'psi': 0.7397936738217791}
[S16] START round=20 head_norm_before_train=1.428019 cos_to_last_merge=0.8471 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.847
[S16] round=20 local utility u=0.031041 metrics={'f1_val': 0.8329155418822651, 'auprc': 0.9240579338039987, 'loss_val': 0.6879414579084315, 'psi': 0.8693724986509586}-{'f1_val': 0.8134660110831253, 'auprc': 0.8829385163170496, 'loss_val': 0.5099681102254334, 'psi': 0.8412550131766949}
[S17] START round=20 head_norm_before_train=1.493529 cos_to_last_merge=0.7780 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.778
[S17] round=20 local utility u=0.471787 metrics={'f1_val': 0.6196638417160405, 'auprc': 0.9298842571382415, 'loss_val': 0.6182430251512956, 'psi': 0.7437520078849209}-{'f1_val': 0.5523316603083481, 'auprc': 0.8046536372547214, 'loss_val': 0.7821325998103114, 'psi': 0.6532604510868973}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:57011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:57015
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:57009
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:57008
[S6] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1802) from S7
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.213022)
[S15] loaded HEAD from S7 (vec_in norm=1.213022)
[S15] cosine check vs S7: cos=0.3220
[S15] BUFFERED delta from S7 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1803) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.775188)
[S9] loaded HEAD from S5 (vec_in norm=1.775188)
[S9] cosine check vs S5: cos=0.9853
[S9] BUFFERED delta from S5 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1800) from S6
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.429766)
[S8] loaded HEAD from S6 (vec_in norm=1.429766)
[S8] cosine check vs S6: cos=0.9420
[S8] BUFFERED delta from S6 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1797) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.265743)
[S7] loaded HEAD from S10 (vec_in norm=1.265743)
[S7] cosine check vs S10: cos=0.3755
[S7] BUFFERED delta from S10 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1799) from S15
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.973352)
[S10] loaded HEAD from S15 (vec_in norm=0.973352)
[S10] cosine check vs S15: cos=0.2119
[S10] BUFFERED delta from S15 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1798) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.465514)
[S6] loaded HEAD from S16 (vec_in norm=1.465514)
[S6] cosine check vs S16: cos=0.9946
[S6] BUFFERED delta from S16 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1800) from S14
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.880318)
[S6] loaded HEAD from S14 (vec_in norm=1.880318)
[S6] cosine check vs S14: cos=-0.0600
[S6] DROPPED delta from S14 (cos=-0.0600 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1804) from S3
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.194342)
[S15] loaded HEAD from S3 (vec_in norm=1.194342)
[S15] cosine check vs S3: cos=0.4818
[S15] BUFFERED delta from S3 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:57009
[S17] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.523173)
[S8] loaded HEAD from S17 (vec_in norm=1.523173)
[S8] cosine check vs S17: cos=0.2729
[S8] BUFFERED delta from S17 (total buffered=2)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=20 metric=0.9964 head_norm=1.841663
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.585680e-01
[S9] stored merged vector for next round verification (round=20)
[S9] DEBUG after merge:  round=20 metric=0.9964 head_norm=1.801767 delta_norm=0.158568
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.050 → S3@127.0.0.1:57003
[S11] ⇄ pheromone p=0.110 → S7@127.0.0.1:57008
[S2] ⇄ pheromone p=0.075 → S10@127.0.0.1:57011
[S4] ⇄ pheromone p=0.098 → S2@127.0.0.1:57002
[S13] ⇄ pheromone p=0.079 → S15@127.0.0.1:57015
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=20 metric=0.7000 head_norm=1.151740
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.111117e-01
[S8] stored merged vector for next round verification (round=20)
[S8] DEBUG after merge:  round=20 metric=0.7000 head_norm=1.054431 delta_norm=0.311112
[S8] aggregate: ACCEPT kept=['S6', 'S17'] (k=2/2) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.143 → S3@127.0.0.1:57003
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=20 metric=0.9608 head_norm=1.429766
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.698770e-02
[S6] stored merged vector for next round verification (round=20)
[S6] DEBUG after merge:  round=20 metric=0.9608 head_norm=1.445702 delta_norm=0.076988
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.417 → S8@127.0.0.1:57009
[S3] ⇄ pheromone p=0.039 → S15@127.0.0.1:57015
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=20 metric=0.9947 head_norm=1.265743
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.119416e-01
[S10] stored merged vector for next round verification (round=20)
[S10] DEBUG after merge:  round=20 metric=0.9952 head_norm=0.876299 delta_norm=0.711942
[S10] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.282 → S7@127.0.0.1:57008
[S16] ⇄ pheromone p=0.216 → S6@127.0.0.1:57007
[S14] ⇄ pheromone p=0.083 → S6@127.0.0.1:57007
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=20 metric=0.6999 head_norm=1.213022
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.929218e-01
[S7] stored merged vector for next round verification (round=20)
[S7] DEBUG after merge:  round=20 metric=0.7001 head_norm=1.027922 delta_norm=0.692922
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.292 → S15@127.0.0.1:57015
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=20 metric=0.6975 head_norm=0.973352
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.799299e-01
[S15] stored merged vector for next round verification (round=20)
[S15] DEBUG after merge:  round=20 metric=0.6976 head_norm=0.836951 delta_norm=0.479930
[S15] aggregate: ACCEPT kept=['S7', 'S3'] (k=2/2) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.152 → S10@127.0.0.1:57011
[S5] ⇄ pheromone p=0.259 → S9@127.0.0.1:57010
[S17] ⇄ pheromone p=0.299 → S8@127.0.0.1:57009
[S2] START round=21 head_norm_before_train=1.833790 cos_to_last_merge=0.9999 (last merge round=19)
[S2] round=21 local utility u=0.000000 metrics={'f1_val': 0.45222868557919227, 'auprc': 0.6896948974236716, 'loss_val': 1.1893056286660995, 'psi': 0.5472151703169841}-{'f1_val': 0.7012347841865968, 'auprc': 0.6684305896231199, 'loss_val': 0.3278868743099262, 'psi': 0.688113106361206}
[S3] START round=21 head_norm_before_train=1.194342 cos_to_last_merge=0.9963 (last merge round=19)
[S3] round=21 local utility u=0.015134 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.9983297944913165, 'loss_val': 0.29829389535063733, 'psi': 0.81969551929665}-{'f1_val': 0.7006809596653347, 'auprc': 0.998880584698005, 'loss_val': 0.33066314220533494, 'psi': 0.8199608096784028}
[S4] START round=21 head_norm_before_train=1.831357 (no previous merge yet)
[S4] round=21 local utility u=0.071505 metrics={'f1_val': 0.9505692561603687, 'auprc': 0.9657721440554881, 'loss_val': 0.2720727886668075, 'psi': 0.9566504113184164}-{'f1_val': 0.9451590578890365, 'auprc': 0.9377288962907726, 'loss_val': 0.2984923815632683, 'psi': 0.942186993249731}
[S5] START round=21 head_norm_before_train=1.775188 (no previous merge yet)
[S5] round=21 local utility u=0.000000 metrics={'f1_val': 0.6758287956272354, 'auprc': 0.9451065179894735, 'loss_val': 0.40636309856832636, 'psi': 0.7835398845721306}-{'f1_val': 0.7006083926626743, 'auprc': 0.9719214515406572, 'loss_val': 0.3194591166872325, 'psi': 0.8091336162138675}
[S6] START round=21 head_norm_before_train=1.445702 cos_to_last_merge=1.0000 (last merge round=20)
[S6] round=21 local utility u=0.000000 metrics={'f1_val': 0.8222520878938894, 'auprc': 0.9520255231152963, 'loss_val': 0.4087688171571552, 'psi': 0.8741614619824521}-{'f1_val': 0.9608093865550973, 'auprc': 0.9544739265701888, 'loss_val': 0.3844371300100429, 'psi': 0.9582752025611339}
[S7] START round=21 head_norm_before_train=1.027922 cos_to_last_merge=1.0000 (last merge round=20)
[S7] round=21 local utility u=0.000000 metrics={'f1_val': 0.4572898240588861, 'auprc': 0.7817602438517643, 'loss_val': 1.0437614374922382, 'psi': 0.5870779919760374}-{'f1_val': 0.699923887872006, 'auprc': 0.9981714193598961, 'loss_val': 0.4035105346984665, 'psi': 0.8192229004671621}
[S8] START round=21 head_norm_before_train=1.054431 cos_to_last_merge=1.0000 (last merge round=20)
[S8] round=21 local utility u=0.833618 metrics={'f1_val': 0.9787573863721231, 'auprc': 0.9912827799122073, 'loss_val': 0.36714335862856134, 'psi': 0.9837675437881568}-{'f1_val': 0.7000296083205206, 'auprc': 0.9835392503941915, 'loss_val': 0.3387817349645352, 'psi': 0.813433465149989}
[S9] START round=21 head_norm_before_train=1.801767 cos_to_last_merge=1.0000 (last merge round=20)
[S9] round=21 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9973838619334173, 'loss_val': 0.07864050567676284, 'psi': 0.9969498518617018}-{'f1_val': 0.9964101856672208, 'auprc': 0.9980690430997461, 'loss_val': 0.07072655000840687, 'psi': 0.9970737286402309}
[S10] START round=21 head_norm_before_train=0.876299 cos_to_last_merge=1.0000 (last merge round=20)
[S10] round=21 local utility u=0.000000 metrics={'f1_val': 0.994250896972037, 'auprc': 0.9966827401157192, 'loss_val': 0.37591527312448514, 'psi': 0.9952236342295098}-{'f1_val': 0.9947356868317377, 'auprc': 0.9974223048505764, 'loss_val': 0.24001992900375643, 'psi': 0.9958103340392732}
[S11] START round=21 head_norm_before_train=1.803299 (no previous merge yet)
[S11] round=21 local utility u=0.032661 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9980883085604486, 'loss_val': 0.06814779974397907, 'psi': 0.9971635261323332}-{'f1_val': 0.9963753869090841, 'auprc': 0.9965144114091783, 'loss_val': 0.12771782265464393, 'psi': 0.9964309967091218}
[S13] START round=21 head_norm_before_train=1.305093 cos_to_last_merge=0.8480 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.848
[S13] round=21 local utility u=0.072415 metrics={'f1_val': 0.6070037228456356, 'auprc': 0.6847522854075508, 'loss_val': 0.6936353576969414, 'psi': 0.6381031478704018}-{'f1_val': 0.5896576921125352, 'auprc': 0.6861181818762571, 'loss_val': 0.7384860144444083, 'psi': 0.6282418880180239}
[S14] START round=21 head_norm_before_train=1.880318 (no previous merge yet)
[S14] round=21 local utility u=0.000553 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9990708591490273, 'loss_val': 0.0323555302851027, 'psi': 0.9980733053606463}-{'f1_val': 0.997240356705793, 'auprc': 0.9991395758574062, 'loss_val': 0.03265994684999498, 'psi': 0.9980000443664383}
[S15] START round=21 head_norm_before_train=0.836951 cos_to_last_merge=1.0000 (last merge round=20)
[S15] round=21 local utility u=0.000000 metrics={'f1_val': 0.6980723653894976, 'auprc': 0.799629825228756, 'loss_val': 0.49026716979582086, 'psi': 0.738695349325201}-{'f1_val': 0.6974575403955958, 'auprc': 0.990216203354173, 'loss_val': 0.43992734931425975, 'psi': 0.8145610055790267}
[S16] START round=21 head_norm_before_train=1.465514 cos_to_last_merge=0.8434 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.843
[S16] round=21 local utility u=0.366829 metrics={'f1_val': 0.8824043740257683, 'auprc': 0.9381757503573789, 'loss_val': 0.29356911861100815, 'psi': 0.9047129245584126}-{'f1_val': 0.8329155418822651, 'auprc': 0.9240579338039987, 'loss_val': 0.6879414579084315, 'psi': 0.8693724986509586}
[S17] START round=21 head_norm_before_train=1.523173 cos_to_last_merge=0.7756 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.776
[S17] round=21 local utility u=0.000000 metrics={'f1_val': 0.5637024178974668, 'auprc': 0.8541226612739357, 'loss_val': 0.8207045298739737, 'psi': 0.6798705152480543}-{'f1_val': 0.6196638417160405, 'auprc': 0.9298842571382415, 'loss_val': 0.6182430251512956, 'psi': 0.7437520078849209}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S13] → sending delta(kind=head bytes=1807) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S2@127.0.0.1:57002
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:57007
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S13] sending update (kind=head size=1807 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1804) from S4
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.842222)
[S2] loaded HEAD from S4 (vec_in norm=1.842222)
[S2] cosine check vs S4: cos=0.9977
[S2] BUFFERED delta from S4 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1804) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.501678)
[S6] loaded HEAD from S16 (vec_in norm=1.501678)
[S6] cosine check vs S16: cos=0.9956
[S6] BUFFERED delta from S16 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1799) from S14
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.898787)
[S6] loaded HEAD from S14 (vec_in norm=1.898787)
[S6] cosine check vs S14: cos=-0.0609
[S6] DROPPED delta from S14 (cos=-0.0609 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1803) from S3
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.243441)
[S15] loaded HEAD from S3 (vec_in norm=1.243441)
[S15] cosine check vs S3: cos=0.7269
[S15] BUFFERED delta from S3 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1807) from S13
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.320524)
[S15] loaded HEAD from S13 (vec_in norm=1.320524)
[S15] cosine check vs S13: cos=0.5521
[S15] BUFFERED delta from S13 (total buffered=2)
[S3] RECEIVED delta(kind=head bytes=1795) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.084725)
[S3] loaded HEAD from S8 (vec_in norm=1.084725)
[S3] cosine check vs S8: cos=0.4212
[S3] BUFFERED delta from S8 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1798) from S11
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.824398)
[S7] loaded HEAD from S11 (vec_in norm=1.824398)
[S7] cosine check vs S11: cos=0.5896
[S7] BUFFERED delta from S11 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=21 metric=0.8223 head_norm=1.473933
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.148476e-02
[S6] stored merged vector for next round verification (round=21)
[S6] DEBUG after merge:  round=21 metric=0.8223 head_norm=1.486152 delta_norm=0.071485
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=21 metric=0.4573 head_norm=1.047249
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.369429e-01
[S7] stored merged vector for next round verification (round=21)
[S7] DEBUG after merge:  round=21 metric=0.3918 head_norm=1.292089 delta_norm=0.736943
[S7] aggregate: ROLLBACK (f1_val pre=0.457 post=0.392 tol_abs=0.005 tol_rel=0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=21 metric=0.4522 head_norm=1.847777
[S2] _apply_head_vector_avg (torch): Δ‖w‖=6.306134e-02
[S2] stored merged vector for next round verification (round=21)
[S2] DEBUG after merge:  round=21 metric=0.4482 head_norm=1.843924 delta_norm=0.063061
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=21 metric=0.7006 head_norm=1.243441
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.298093e-01
[S3] stored merged vector for next round verification (round=21)
[S3] DEBUG after merge:  round=21 metric=0.7006 head_norm=0.982205 delta_norm=0.629809
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=21 metric=0.6981 head_norm=0.891682
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.538184e-01
[S15] stored merged vector for next round verification (round=21)
[S15] DEBUG after merge:  round=21 metric=0.6982 head_norm=0.890185 delta_norm=0.253818
[S15] aggregate: ACCEPT kept=['S3', 'S13'] (k=2/2) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.843924 cos_to_last_merge=1.0000 (last merge round=21)
[S2] round=22 local utility u=1.000000 metrics={'f1_val': 0.7013131626296514, 'auprc': 0.690319120630241, 'loss_val': 0.3140797058082548, 'psi': 0.6969155458298872}-{'f1_val': 0.45222868557919227, 'auprc': 0.6896948974236716, 'loss_val': 1.1893056286660995, 'psi': 0.5472151703169841}
[S3] START round=22 head_norm_before_train=0.982205 cos_to_last_merge=1.0000 (last merge round=21)
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.9982233794905927, 'loss_val': 0.3241429434841567, 'psi': 0.8196529532963605}-{'f1_val': 0.7006060025002057, 'auprc': 0.9983297944913165, 'loss_val': 0.29829389535063733, 'psi': 0.81969551929665}
[S4] START round=22 head_norm_before_train=1.842222 (no previous merge yet)
[S4] round=22 local utility u=0.000000 metrics={'f1_val': 0.9453069693917922, 'auprc': 0.9486151169416372, 'loss_val': 0.28294307743547975, 'psi': 0.9466302284117302}-{'f1_val': 0.9505692561603687, 'auprc': 0.9657721440554881, 'loss_val': 0.2720727886668075, 'psi': 0.9566504113184164}
[S5] START round=22 head_norm_before_train=1.787923 (no previous merge yet)
[S5] round=22 local utility u=0.255970 metrics={'f1_val': 0.700868080518019, 'auprc': 0.9900884750290255, 'loss_val': 0.17960465974465867, 'psi': 0.8165562383224216}-{'f1_val': 0.6758287956272354, 'auprc': 0.9451065179894735, 'loss_val': 0.40636309856832636, 'psi': 0.7835398845721306}
[S6] START round=22 head_norm_before_train=1.486152 cos_to_last_merge=1.0000 (last merge round=21)
[S6] round=22 local utility u=0.000000 metrics={'f1_val': 0.8168968324750665, 'auprc': 0.9369912242841837, 'loss_val': 0.4089475575645356, 'psi': 0.8649345891987135}-{'f1_val': 0.8222520878938894, 'auprc': 0.9520255231152963, 'loss_val': 0.4087688171571552, 'psi': 0.8741614619824521}
[S7] START round=22 head_norm_before_train=1.292089 cos_to_last_merge=1.0000 (last merge round=21)
[S7] round=22 local utility u=1.000000 metrics={'f1_val': 0.6902085228926877, 'auprc': 0.9811912280415072, 'loss_val': 0.5915557949899505, 'psi': 0.8066016049522156}-{'f1_val': 0.4572898240588861, 'auprc': 0.7817602438517643, 'loss_val': 1.0437614374922382, 'psi': 0.5870779919760374}
[S8] START round=22 head_norm_before_train=1.084725 cos_to_last_merge=0.9987 (last merge round=20)
[S8] round=22 local utility u=0.095693 metrics={'f1_val': 0.9952482736021975, 'auprc': 0.9973717718041967, 'loss_val': 0.29296927449572385, 'psi': 0.9960976728829971}-{'f1_val': 0.9787573863721231, 'auprc': 0.9912827799122073, 'loss_val': 0.36714335862856134, 'psi': 0.9837675437881568}
[S9] START round=22 head_norm_before_train=1.835600 cos_to_last_merge=0.9989 (last merge round=20)
[S9] round=22 local utility u=0.002095 metrics={'f1_val': 0.993909773892786, 'auprc': 0.9978845695253292, 'loss_val': 0.05944720220001586, 'psi': 0.9954996921458032}-{'f1_val': 0.9966605118138915, 'auprc': 0.9973838619334173, 'loss_val': 0.07864050567676284, 'psi': 0.9969498518617018}
[S10] START round=22 head_norm_before_train=0.918799 cos_to_last_merge=0.9983 (last merge round=20)
[S10] round=22 local utility u=0.024147 metrics={'f1_val': 0.9951887897730489, 'auprc': 0.9971447649564051, 'loss_val': 0.3346351231397568, 'psi': 0.9959711798463914}-{'f1_val': 0.994250896972037, 'auprc': 0.9966827401157192, 'loss_val': 0.37591527312448514, 'psi': 0.9952236342295098}
[S11] START round=22 head_norm_before_train=1.824398 (no previous merge yet)
[S11] round=22 local utility u=0.000000 metrics={'f1_val': 0.9963753869090841, 'auprc': 0.9961613311978206, 'loss_val': 0.06688929578395124, 'psi': 0.9962897646245787}-{'f1_val': 0.9965470045135896, 'auprc': 0.9980883085604486, 'loss_val': 0.06814779974397907, 'psi': 0.9971635261323332}
[S13] START round=22 head_norm_before_train=1.320524 cos_to_last_merge=0.8435 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.844
[S13] round=22 local utility u=0.021112 metrics={'f1_val': 0.6141775201715889, 'auprc': 0.6807368007655027, 'loss_val': 0.6824079427431584, 'psi': 0.6408012324091544}-{'f1_val': 0.6070037228456356, 'auprc': 0.6847522854075508, 'loss_val': 0.6936353576969414, 'psi': 0.6381031478704018}
[S14] START round=22 head_norm_before_train=1.898787 (no previous merge yet)
[S14] round=22 local utility u=0.002171 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9991390391615909, 'loss_val': 0.028218772399863097, 'psi': 0.9981005773656717}-{'f1_val': 0.9974082695017256, 'auprc': 0.9990708591490273, 'loss_val': 0.0323555302851027, 'psi': 0.9980733053606463}
[S15] START round=22 head_norm_before_train=0.890185 cos_to_last_merge=1.0000 (last merge round=21)
[S15] round=22 local utility u=0.293452 metrics={'f1_val': 0.6911030366675646, 'auprc': 0.9817849790660195, 'loss_val': 0.40801339930461034, 'psi': 0.8073758136269465}-{'f1_val': 0.6980723653894976, 'auprc': 0.799629825228756, 'loss_val': 0.49026716979582086, 'psi': 0.738695349325201}
[S16] START round=22 head_norm_before_train=1.501678 cos_to_last_merge=0.8401 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.840
[S16] round=22 local utility u=0.000000 metrics={'f1_val': 0.8428443299924508, 'auprc': 0.9456668465426246, 'loss_val': 0.6612450846840916, 'psi': 0.8839733366125203}-{'f1_val': 0.8824043740257683, 'auprc': 0.9381757503573789, 'loss_val': 0.29356911861100815, 'psi': 0.9047129245584126}
[S17] START round=22 head_norm_before_train=1.548105 cos_to_last_merge=0.7739 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.774
[S17] round=22 local utility u=0.000000 metrics={'f1_val': 0.5527371571720658, 'auprc': 0.8226889340171591, 'loss_val': 0.9902526290821887, 'psi': 0.6607178679101031}-{'f1_val': 0.5637024178974668, 'auprc': 0.8541226612739357, 'loss_val': 0.8207045298739737, 'psi': 0.6798705152480543}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:57011
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] → sending delta(kind=head bytes=1805) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] → sending delta(kind=head bytes=1805) to S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S13] → sending delta(kind=head bytes=1808) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:57003
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:57007
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1805 to 1 peers)
[S13] sending update (kind=head size=1808 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1805 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1797) from S15
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.949187)
[S10] loaded HEAD from S15 (vec_in norm=0.949187)
[S10] cosine check vs S15: cos=0.7220
[S10] BUFFERED delta from S15 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1799) from S14
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.917316)
[S6] loaded HEAD from S14 (vec_in norm=1.917316)
[S6] cosine check vs S14: cos=-0.0622
[S6] DROPPED delta from S14 (cos=-0.0622 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1805) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.797312)
[S9] loaded HEAD from S5 (vec_in norm=1.797312)
[S9] cosine check vs S5: cos=0.9847
[S9] BUFFERED delta from S5 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1805) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.870956)
[S3] loaded HEAD from S9 (vec_in norm=1.870956)
[S3] cosine check vs S9: cos=0.5342
[S3] BUFFERED delta from S9 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1808) from S13
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.334165)
[S15] loaded HEAD from S13 (vec_in norm=1.334165)
[S15] cosine check vs S13: cos=0.6719
[S15] BUFFERED delta from S13 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1797) from S7
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.307121)
[S15] loaded HEAD from S7 (vec_in norm=1.307121)
[S15] cosine check vs S7: cos=0.2810
[S15] BUFFERED delta from S7 (total buffered=2)
[S3] RECEIVED delta(kind=head bytes=1798) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.122251)
[S3] loaded HEAD from S8 (vec_in norm=1.122251)
[S3] cosine check vs S8: cos=0.8095
[S3] BUFFERED delta from S8 (total buffered=2)
[S7] RECEIVED delta(kind=head bytes=1799) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=0.956197)
[S7] loaded HEAD from S10 (vec_in norm=0.956197)
[S7] cosine check vs S10: cos=0.4027
[S7] BUFFERED delta from S10 (total buffered=1)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:57011
[S2] sending update (kind=head size=1799 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1799) from S2
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.857331)
[S10] loaded HEAD from S2 (vec_in norm=1.857331)
[S10] cosine check vs S2: cos=0.6357
[S10] BUFFERED delta from S2 (total buffered=2)
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=22 metric=0.7006 head_norm=1.033891
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.630614e-01
[S3] stored merged vector for next round verification (round=22)
[S3] DEBUG after merge:  round=22 metric=0.7018 head_norm=1.027381 delta_norm=0.263061
[S3] aggregate: ACCEPT kept=['S9', 'S8'] (k=2/2) mode=median trim_p=0.1
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=22 metric=0.9952 head_norm=0.956197
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.305132e-01
[S10] stored merged vector for next round verification (round=22)
[S10] DEBUG after merge:  round=22 metric=0.9952 head_norm=0.972259 delta_norm=0.230513
[S10] aggregate: ACCEPT kept=['S15', 'S2'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=22 metric=0.6902 head_norm=1.307121
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.356663e-01
[S7] stored merged vector for next round verification (round=22)
[S7] DEBUG after merge:  round=22 metric=0.6996 head_norm=0.952558 delta_norm=0.635666
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=22 metric=0.9939 head_norm=1.870956
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.646432e-01
[S9] stored merged vector for next round verification (round=22)
[S9] DEBUG after merge:  round=22 metric=0.9939 head_norm=1.827100 delta_norm=0.164643
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=22 metric=0.6911 head_norm=0.949187
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.583795e-01
[S15] stored merged vector for next round verification (round=22)
[S15] DEBUG after merge:  round=22 metric=0.6911 head_norm=0.853351 delta_norm=0.358380
[S15] aggregate: ACCEPT kept=['S13', 'S7'] (k=2/2) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.857331 cos_to_last_merge=0.9999 (last merge round=21)
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.7014900204402302, 'auprc': 0.673780150582914, 'loss_val': 0.3698966838744736, 'psi': 0.6904060724973038}-{'f1_val': 0.7013131626296514, 'auprc': 0.690319120630241, 'loss_val': 0.3140797058082548, 'psi': 0.6969155458298872}
[S3] START round=23 head_norm_before_train=1.027381 cos_to_last_merge=1.0000 (last merge round=22)
[S3] round=23 local utility u=0.005585 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9988353308192022, 'loss_val': 0.3157104331556192, 'psi': 0.8199878545688606}-{'f1_val': 0.7006060025002057, 'auprc': 0.9982233794905927, 'loss_val': 0.3241429434841567, 'psi': 0.8196529532963605}
[S4] START round=23 head_norm_before_train=1.857402 (no previous merge yet)
[S4] round=23 local utility u=0.073867 metrics={'f1_val': 0.9532639966216361, 'auprc': 0.9742233367775602, 'loss_val': 0.25977579690349517, 'psi': 0.9616477326840058}-{'f1_val': 0.9453069693917922, 'auprc': 0.9486151169416372, 'loss_val': 0.28294307743547975, 'psi': 0.9466302284117302}
[S5] START round=23 head_norm_before_train=1.797312 (no previous merge yet)
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.7008203390104386, 'auprc': 0.9531256889265978, 'loss_val': 0.43010859174172994, 'psi': 0.8017424789769023}-{'f1_val': 0.700868080518019, 'auprc': 0.9900884750290255, 'loss_val': 0.17960465974465867, 'psi': 0.8165562383224216}
[S6] START round=23 head_norm_before_train=1.515835 cos_to_last_merge=0.9993 (last merge round=21)
[S6] round=23 local utility u=0.165873 metrics={'f1_val': 0.8421276105887667, 'auprc': 0.9609407777745528, 'loss_val': 0.3004339778938266, 'psi': 0.8896528774630812}-{'f1_val': 0.8168968324750665, 'auprc': 0.9369912242841837, 'loss_val': 0.4089475575645356, 'psi': 0.8649345891987135}
[S7] START round=23 head_norm_before_train=0.952558 cos_to_last_merge=1.0000 (last merge round=22)
[S7] round=23 local utility u=0.086072 metrics={'f1_val': 0.6997507634732917, 'auprc': 0.9923321656139765, 'loss_val': 0.5100882694433948, 'psi': 0.8167833243295657}-{'f1_val': 0.6902085228926877, 'auprc': 0.9811912280415072, 'loss_val': 0.5915557949899505, 'psi': 0.8066016049522156}
[S8] START round=23 head_norm_before_train=1.122251 cos_to_last_merge=0.9947 (last merge round=20)
[S8] round=23 local utility u=0.026146 metrics={'f1_val': 0.9958992753750342, 'auprc': 0.9974711267265324, 'loss_val': 0.2448806308117342, 'psi': 0.9965280159156334}-{'f1_val': 0.9952482736021975, 'auprc': 0.9973717718041967, 'loss_val': 0.29296927449572385, 'psi': 0.9960976728829971}
[S9] START round=23 head_norm_before_train=1.827100 cos_to_last_merge=1.0000 (last merge round=22)
[S9] round=23 local utility u=0.000479 metrics={'f1_val': 0.9956098104564366, 'auprc': 0.9979294233343274, 'loss_val': 0.06882418991200406, 'psi': 0.9965376556075929}-{'f1_val': 0.993909773892786, 'auprc': 0.9978845695253292, 'loss_val': 0.05944720220001586, 'psi': 0.9954996921458032}
[S10] START round=23 head_norm_before_train=0.972259 cos_to_last_merge=1.0000 (last merge round=22)
[S10] round=23 local utility u=0.000000 metrics={'f1_val': 0.9404147213583427, 'auprc': 0.9857738770750307, 'loss_val': 0.3857218386366774, 'psi': 0.9585583836450179}-{'f1_val': 0.9951887897730489, 'auprc': 0.9971447649564051, 'loss_val': 0.3346351231397568, 'psi': 0.9959711798463914}
[S11] START round=23 head_norm_before_train=1.850309 (no previous merge yet)
[S11] round=23 local utility u=0.003687 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9958882672228215, 'loss_val': 0.05724500368182759, 'psi': 0.9960355118371143}-{'f1_val': 0.9963753869090841, 'auprc': 0.9961613311978206, 'loss_val': 0.06688929578395124, 'psi': 0.9962897646245787}
[S13] START round=23 head_norm_before_train=1.334165 cos_to_last_merge=0.8403 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.840
[S13] round=23 local utility u=0.000000 metrics={'f1_val': 0.6045745680511744, 'auprc': 0.6831765905910749, 'loss_val': 0.7620030318885826, 'psi': 0.6360153770671346}-{'f1_val': 0.6141775201715889, 'auprc': 0.6807368007655027, 'loss_val': 0.6824079427431584, 'psi': 0.6408012324091544}
[S14] START round=23 head_norm_before_train=1.917316 (no previous merge yet)
[S14] round=23 local utility u=0.000000 metrics={'f1_val': 0.9936569488964806, 'auprc': 0.9991409933535373, 'loss_val': 0.03588032457907348, 'psi': 0.9958505666793034}-{'f1_val': 0.9974082695017256, 'auprc': 0.9991390391615909, 'loss_val': 0.028218772399863097, 'psi': 0.9981005773656717}
[S15] START round=23 head_norm_before_train=0.853351 cos_to_last_merge=1.0000 (last merge round=22)
[S15] round=23 local utility u=0.000000 metrics={'f1_val': 0.6931776390926093, 'auprc': 0.8840642999112972, 'loss_val': 0.4451847028870791, 'psi': 0.7695323034200845}-{'f1_val': 0.6911030366675646, 'auprc': 0.9817849790660195, 'loss_val': 0.40801339930461034, 'psi': 0.8073758136269465}
[S16] START round=23 head_norm_before_train=1.536179 cos_to_last_merge=0.8372 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.837
[S16] round=23 local utility u=0.409359 metrics={'f1_val': 0.9104006420794943, 'auprc': 0.9768145319432908, 'loss_val': 0.34130829924739653, 'psi': 0.9369661980250129}-{'f1_val': 0.8428443299924508, 'auprc': 0.9456668465426246, 'loss_val': 0.6612450846840916, 'psi': 0.8839733366125203}
[S17] START round=23 head_norm_before_train=1.575845 cos_to_last_merge=0.7726 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.773
[S17] round=23 local utility u=0.601486 metrics={'f1_val': 0.6467994601582662, 'auprc': 0.9176943320427863, 'loss_val': 0.6366701706686726, 'psi': 0.7551574089120743}-{'f1_val': 0.5527371571720658, 'auprc': 0.8226889340171591, 'loss_val': 0.9902526290821887, 'psi': 0.6607178679101031}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] → sending delta(kind=head bytes=1805) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:57009
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:57002
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:57015
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:57003
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1804 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1805 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1797) from S7
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.980184)
[S15] loaded HEAD from S7 (vec_in norm=0.980184)
[S15] cosine check vs S7: cos=0.7201
[S15] BUFFERED delta from S7 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1805) from S3
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.082765)
[S15] loaded HEAD from S3 (vec_in norm=1.082765)
[S15] cosine check vs S3: cos=0.5800
[S15] BUFFERED delta from S3 (total buffered=2)
[S3] RECEIVED delta(kind=head bytes=1797) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.156885)
[S3] loaded HEAD from S8 (vec_in norm=1.156885)
[S3] cosine check vs S8: cos=0.6738
[S3] BUFFERED delta from S8 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1801) from S4
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.868441)
[S2] loaded HEAD from S4 (vec_in norm=1.868441)
[S2] cosine check vs S4: cos=0.9980
[S2] BUFFERED delta from S4 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1798) from S6
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.545899)
[S8] loaded HEAD from S6 (vec_in norm=1.545899)
[S8] cosine check vs S6: cos=0.8357
[S8] BUFFERED delta from S6 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1803) from S11
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.879534)
[S7] loaded HEAD from S11 (vec_in norm=1.879534)
[S7] cosine check vs S11: cos=0.6967
[S7] BUFFERED delta from S11 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1801) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.567001)
[S6] loaded HEAD from S16 (vec_in norm=1.567001)
[S6] cosine check vs S16: cos=0.9925
[S6] BUFFERED delta from S16 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1804) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.859594)
[S3] loaded HEAD from S9 (vec_in norm=1.859594)
[S3] cosine check vs S9: cos=0.7103
[S3] BUFFERED delta from S9 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:57009
[S17] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.597503)
[S8] loaded HEAD from S17 (vec_in norm=1.597503)
[S8] cosine check vs S17: cos=0.4805
[S8] BUFFERED delta from S17 (total buffered=2)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=23 metric=0.7015 head_norm=1.872410
[S2] _apply_head_vector_avg (torch): Δ‖w‖=5.991029e-02
[S2] stored merged vector for next round verification (round=23)
[S2] DEBUG after merge:  round=23 metric=0.7015 head_norm=1.869467 delta_norm=0.059910
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=23 metric=0.6998 head_norm=0.980184
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.939529e-01
[S7] stored merged vector for next round verification (round=23)
[S7] DEBUG after merge:  round=23 metric=0.6987 head_norm=1.328583 delta_norm=0.693953
[S7] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=23 metric=0.8421 head_norm=1.545899
[S6] _apply_head_vector_avg (torch): Δ‖w‖=9.583099e-02
[S6] stored merged vector for next round verification (round=23)
[S6] DEBUG after merge:  round=23 metric=0.8395 head_norm=1.553533 delta_norm=0.095831
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=23 metric=0.9959 head_norm=1.156885
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.110627e-01
[S8] stored merged vector for next round verification (round=23)
[S8] DEBUG after merge:  round=23 metric=0.9959 head_norm=1.111696 delta_norm=0.211063
[S8] aggregate: ACCEPT kept=['S6', 'S17'] (k=2/2) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=23 metric=0.7008 head_norm=1.082765
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.521858e-01
[S3] stored merged vector for next round verification (round=23)
[S3] DEBUG after merge:  round=23 metric=0.7008 head_norm=1.077161 delta_norm=0.152186
[S3] aggregate: ACCEPT kept=['S8', 'S9'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=23 metric=0.6932 head_norm=0.910788
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.920359e-01
[S15] stored merged vector for next round verification (round=23)
[S15] DEBUG after merge:  round=23 metric=0.6932 head_norm=0.832305 delta_norm=0.292036
[S15] aggregate: ACCEPT kept=['S7', 'S3'] (k=2/2) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.869467 cos_to_last_merge=1.0000 (last merge round=23)
[S2] round=24 local utility u=0.202154 metrics={'f1_val': 0.7076143800163359, 'auprc': 0.7929488401428236, 'loss_val': 0.35984042184770126, 'psi': 0.741748164066931}-{'f1_val': 0.7014900204402302, 'auprc': 0.673780150582914, 'loss_val': 0.3698966838744736, 'psi': 0.6904060724973038}
[S3] START round=24 head_norm_before_train=1.077161 cos_to_last_merge=1.0000 (last merge round=23)
[S3] round=24 local utility u=0.014207 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9980460854863918, 'loss_val': 0.2844770835041889, 'psi': 0.8196270099937576}-{'f1_val': 0.7007562037352997, 'auprc': 0.9988353308192022, 'loss_val': 0.3157104331556192, 'psi': 0.8199878545688606}
[S4] START round=24 head_norm_before_train=1.868441 (no previous merge yet)
[S4] round=24 local utility u=0.000000 metrics={'f1_val': 0.950894390528516, 'auprc': 0.9712940769806061, 'loss_val': 0.26566675806752543, 'psi': 0.959054265109352}-{'f1_val': 0.9532639966216361, 'auprc': 0.9742233367775602, 'loss_val': 0.25977579690349517, 'psi': 0.9616477326840058}
[S5] START round=24 head_norm_before_train=1.804959 (no previous merge yet)
[S5] round=24 local utility u=0.464955 metrics={'f1_val': 0.7956099342327103, 'auprc': 0.9913042948084441, 'loss_val': 0.18347099841672385, 'psi': 0.8738876784630039}-{'f1_val': 0.7008203390104386, 'auprc': 0.9531256889265978, 'loss_val': 0.43010859174172994, 'psi': 0.8017424789769023}
[S6] START round=24 head_norm_before_train=1.553533 cos_to_last_merge=1.0000 (last merge round=23)
[S6] round=24 local utility u=0.000000 metrics={'f1_val': 0.5966778792593571, 'auprc': 0.7800929687924867, 'loss_val': 0.6911755114832056, 'psi': 0.670043915072609}-{'f1_val': 0.8421276105887667, 'auprc': 0.9609407777745528, 'loss_val': 0.3004339778938266, 'psi': 0.8896528774630812}
[S7] START round=24 head_norm_before_train=1.328583 cos_to_last_merge=1.0000 (last merge round=23)
[S7] round=24 local utility u=0.000000 metrics={'f1_val': 0.6759524048562545, 'auprc': 0.8485642003250664, 'loss_val': 0.5792097840784576, 'psi': 0.7449971230437793}-{'f1_val': 0.6997507634732917, 'auprc': 0.9923321656139765, 'loss_val': 0.5100882694433948, 'psi': 0.8167833243295657}
[S8] START round=24 head_norm_before_train=1.111696 cos_to_last_merge=1.0000 (last merge round=23)
[S8] round=24 local utility u=0.000000 metrics={'f1_val': 0.9949900941145562, 'auprc': 0.9973957959098156, 'loss_val': 0.28619655021300827, 'psi': 0.99595237483266}-{'f1_val': 0.9958992753750342, 'auprc': 0.9974711267265324, 'loss_val': 0.2448806308117342, 'psi': 0.9965280159156334}
[S9] START round=24 head_norm_before_train=1.859594 cos_to_last_merge=0.9993 (last merge round=22)
[S9] round=24 local utility u=0.010059 metrics={'f1_val': 0.9959957888192151, 'auprc': 0.9979357020495109, 'loss_val': 0.051041548254442744, 'psi': 0.9967717541113335}-{'f1_val': 0.9956098104564366, 'auprc': 0.9979294233343274, 'loss_val': 0.06882418991200406, 'psi': 0.9965376556075929}
[S10] START round=24 head_norm_before_train=1.002938 cos_to_last_merge=0.9993 (last merge round=22)
[S10] round=24 local utility u=0.153681 metrics={'f1_val': 0.9830285922303625, 'auprc': 0.9826966815359854, 'loss_val': 0.32481145365355496, 'psi': 0.9828958279526118}-{'f1_val': 0.9404147213583427, 'auprc': 0.9857738770750307, 'loss_val': 0.3857218386366774, 'psi': 0.9585583836450179}
[S11] START round=24 head_norm_before_train=1.879534 (no previous merge yet)
[S11] round=24 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9954316881737476, 'loss_val': 0.07347146412398453, 'psi': 0.9958528802174846}-{'f1_val': 0.9961336749133093, 'auprc': 0.9958882672228215, 'loss_val': 0.05724500368182759, 'psi': 0.9960355118371143}
[S13] START round=24 head_norm_before_train=1.346706 cos_to_last_merge=0.8392 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.839
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.5717843367449023, 'auprc': 0.6944863348421979, 'loss_val': 0.9041285372632228, 'psi': 0.6208651359838205}-{'f1_val': 0.6045745680511744, 'auprc': 0.6831765905910749, 'loss_val': 0.7620030318885826, 'psi': 0.6360153770671346}
[S14] START round=24 head_norm_before_train=1.935028 (no previous merge yet)
[S14] round=24 local utility u=0.004374 metrics={'f1_val': 0.9944935406943898, 'auprc': 0.9991406132564304, 'loss_val': 0.03215080168358169, 'psi': 0.996352369719206}-{'f1_val': 0.9936569488964806, 'auprc': 0.9991409933535373, 'loss_val': 0.03588032457907348, 'psi': 0.9958505666793034}
[S15] START round=24 head_norm_before_train=0.832305 cos_to_last_merge=1.0000 (last merge round=23)
[S15] round=24 local utility u=0.069662 metrics={'f1_val': 0.6991463226201102, 'auprc': 0.9045217700418928, 'loss_val': 0.40304548568117804, 'psi': 0.7812965015888232}-{'f1_val': 0.6931776390926093, 'auprc': 0.8840642999112972, 'loss_val': 0.4451847028870791, 'psi': 0.7695323034200845}
[S16] START round=24 head_norm_before_train=1.567001 cos_to_last_merge=0.8347 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.835
[S16] round=24 local utility u=0.180242 metrics={'f1_val': 0.9394337085768787, 'auprc': 0.9890178240013644, 'loss_val': 0.19163338728873391, 'psi': 0.959267354746673}-{'f1_val': 0.9104006420794943, 'auprc': 0.9768145319432908, 'loss_val': 0.34130829924739653, 'psi': 0.9369661980250129}
[S17] START round=24 head_norm_before_train=1.597503 cos_to_last_merge=0.7714 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.771
[S17] round=24 local utility u=0.000000 metrics={'f1_val': 0.5748898116109824, 'auprc': 0.8236058444699483, 'loss_val': 1.084222943208027, 'psi': 0.6743762247545688}-{'f1_val': 0.6467994601582662, 'auprc': 0.9176943320427863, 'loss_val': 0.6366701706686726, 'psi': 0.7551574089120743}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:57007
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:57011
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] → sending delta(kind=head bytes=1805) to S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:57011
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:57015
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1805 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1805 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1799) from S3
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.135419)
[S15] loaded HEAD from S3 (vec_in norm=1.135419)
[S15] cosine check vs S3: cos=0.7458
[S15] BUFFERED delta from S3 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1798) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.032717)
[S7] loaded HEAD from S10 (vec_in norm=1.032717)
[S7] cosine check vs S10: cos=0.3542
[S7] BUFFERED delta from S10 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1805) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.814077)
[S9] loaded HEAD from S5 (vec_in norm=1.814077)
[S9] cosine check vs S5: cos=0.9871
[S9] BUFFERED delta from S5 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1800) from S2
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.883696)
[S10] loaded HEAD from S2 (vec_in norm=1.883696)
[S10] cosine check vs S2: cos=0.7817
[S10] BUFFERED delta from S2 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1796) from S14
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.948357)
[S6] loaded HEAD from S14 (vec_in norm=1.948357)
[S6] cosine check vs S14: cos=-0.0646
[S6] DROPPED delta from S14 (cos=-0.0646 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1798) from S15
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.895281)
[S10] loaded HEAD from S15 (vec_in norm=0.895281)
[S10] cosine check vs S15: cos=0.7029
[S10] BUFFERED delta from S15 (total buffered=2)
[S3] RECEIVED delta(kind=head bytes=1802) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.892811)
[S3] loaded HEAD from S9 (vec_in norm=1.892811)
[S3] cosine check vs S9: cos=0.7780
[S3] BUFFERED delta from S9 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1805) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.594215)
[S6] loaded HEAD from S16 (vec_in norm=1.594215)
[S6] cosine check vs S16: cos=0.9959
[S6] BUFFERED delta from S16 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=24 metric=0.6760 head_norm=1.353543
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.907371e-01
[S7] stored merged vector for next round verification (round=24)
[S7] DEBUG after merge:  round=24 metric=0.6979 head_norm=0.985989 delta_norm=0.690737
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=24 metric=0.5967 head_norm=1.579718
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.195767e-02
[S6] stored merged vector for next round verification (round=24)
[S6] DEBUG after merge:  round=24 metric=0.5967 head_norm=1.585351 delta_norm=0.071958
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=24 metric=0.7007 head_norm=1.135419
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.180085e-01
[S3] stored merged vector for next round verification (round=24)
[S3] DEBUG after merge:  round=24 metric=0.7019 head_norm=1.433185 delta_norm=0.618008
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=24 metric=0.9830 head_norm=1.032717
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.813793e-01
[S10] stored merged vector for next round verification (round=24)
[S10] DEBUG after merge:  round=24 metric=0.9815 head_norm=1.057442 delta_norm=0.181379
[S10] aggregate: ACCEPT kept=['S2', 'S15'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=24 metric=0.6991 head_norm=0.895281
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.789992e-01
[S15] stored merged vector for next round verification (round=24)
[S15] DEBUG after merge:  round=24 metric=0.7016 head_norm=0.949585 delta_norm=0.378999
[S15] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=24 metric=0.9960 head_norm=1.892811
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.541223e-01
[S9] stored merged vector for next round verification (round=24)
[S9] DEBUG after merge:  round=24 metric=0.9964 head_norm=1.847444 delta_norm=0.154122
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.883696 cos_to_last_merge=0.9999 (last merge round=23)
[S2] round=25 local utility u=0.000000 metrics={'f1_val': 0.5453722849920872, 'auprc': 0.6842594847794288, 'loss_val': 0.43521178824241546, 'psi': 0.6009271649070238}-{'f1_val': 0.7076143800163359, 'auprc': 0.7929488401428236, 'loss_val': 0.35984042184770126, 'psi': 0.741748164066931}
[S3] START round=25 head_norm_before_train=1.433185 cos_to_last_merge=1.0000 (last merge round=24)
[S3] round=25 local utility u=0.911668 metrics={'f1_val': 0.9967098587652717, 'auprc': 0.9988545927904259, 'loss_val': 0.2397400048402744, 'psi': 0.9975677523753335}-{'f1_val': 0.7006809596653347, 'auprc': 0.9980460854863918, 'loss_val': 0.2844770835041889, 'psi': 0.8196270099937576}
[S4] START round=25 head_norm_before_train=1.877338 (no previous merge yet)
[S4] round=25 local utility u=0.000000 metrics={'f1_val': 0.949879182149348, 'auprc': 0.9560585025070929, 'loss_val': 0.2721194145130283, 'psi': 0.9523509102924459}-{'f1_val': 0.950894390528516, 'auprc': 0.9712940769806061, 'loss_val': 0.26566675806752543, 'psi': 0.959054265109352}
[S5] START round=25 head_norm_before_train=1.814077 (no previous merge yet)
[S5] round=25 local utility u=0.114974 metrics={'f1_val': 0.8257620611152277, 'auprc': 0.9921689993595935, 'loss_val': 0.1370296556783679, 'psi': 0.8923248364129739}-{'f1_val': 0.7956099342327103, 'auprc': 0.9913042948084441, 'loss_val': 0.18347099841672385, 'psi': 0.8738876784630039}
[S6] START round=25 head_norm_before_train=1.585351 cos_to_last_merge=1.0000 (last merge round=24)
[S6] round=25 local utility u=1.000000 metrics={'f1_val': 0.961083459752383, 'auprc': 0.976716541269363, 'loss_val': 0.2110948568472784, 'psi': 0.9673366923591751}-{'f1_val': 0.5966778792593571, 'auprc': 0.7800929687924867, 'loss_val': 0.6911755114832056, 'psi': 0.670043915072609}
[S7] START round=25 head_norm_before_train=0.985989 cos_to_last_merge=1.0000 (last merge round=24)
[S7] round=25 local utility u=0.001328 metrics={'f1_val': 0.6699944147234935, 'auprc': 0.8642606489722113, 'loss_val': 0.5878960547763358, 'psi': 0.7477009084229806}-{'f1_val': 0.6759524048562545, 'auprc': 0.8485642003250664, 'loss_val': 0.5792097840784576, 'psi': 0.7449971230437793}
[S8] START round=25 head_norm_before_train=1.141025 cos_to_last_merge=0.9991 (last merge round=23)
[S8] round=25 local utility u=0.021503 metrics={'f1_val': 0.9951399054533239, 'auprc': 0.9974442816546187, 'loss_val': 0.24423567947745015, 'psi': 0.9960616559338418}-{'f1_val': 0.9949900941145562, 'auprc': 0.9973957959098156, 'loss_val': 0.28619655021300827, 'psi': 0.99595237483266}
[S9] START round=25 head_norm_before_train=1.847444 cos_to_last_merge=1.0000 (last merge round=24)
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.9956098104564366, 'auprc': 0.998029164742364, 'loss_val': 0.06273837952490711, 'psi': 0.9965775521708076}-{'f1_val': 0.9959957888192151, 'auprc': 0.9979357020495109, 'loss_val': 0.051041548254442744, 'psi': 0.9967717541113335}
[S10] START round=25 head_norm_before_train=1.057442 cos_to_last_merge=1.0000 (last merge round=24)
[S10] round=25 local utility u=0.000000 metrics={'f1_val': 0.9582272562414996, 'auprc': 0.9893482186480589, 'loss_val': 0.3301864477462846, 'psi': 0.9706756412041233}-{'f1_val': 0.9830285922303625, 'auprc': 0.9826966815359854, 'loss_val': 0.32481145365355496, 'psi': 0.9828958279526118}
[S11] START round=25 head_norm_before_train=1.907717 (no previous merge yet)
[S11] round=25 local utility u=0.000000 metrics={'f1_val': 0.8524942763668237, 'auprc': 0.9899395213802733, 'loss_val': 0.37623878941690714, 'psi': 0.9074723743722035}-{'f1_val': 0.9961336749133093, 'auprc': 0.9954316881737476, 'loss_val': 0.07347146412398453, 'psi': 0.9958528802174846}
[S13] START round=25 head_norm_before_train=1.357690 cos_to_last_merge=0.8387 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.839
[S13] round=25 local utility u=0.200579 metrics={'f1_val': 0.6145668608229327, 'auprc': 0.6827803209274922, 'loss_val': 0.7245481204579273, 'psi': 0.6418522448647566}-{'f1_val': 0.5717843367449023, 'auprc': 0.6944863348421979, 'loss_val': 0.9041285372632228, 'psi': 0.6208651359838205}
[S14] START round=25 head_norm_before_train=1.948357 (no previous merge yet)
[S14] round=25 local utility u=0.013435 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9991397290434529, 'loss_val': 0.022766524691358477, 'psi': 0.9981008533184166}-{'f1_val': 0.9944935406943898, 'auprc': 0.9991406132564304, 'loss_val': 0.03215080168358169, 'psi': 0.996352369719206}
[S15] START round=25 head_norm_before_train=0.949585 cos_to_last_merge=1.0000 (last merge round=24)
[S15] round=25 local utility u=0.394282 metrics={'f1_val': 0.7735467868271857, 'auprc': 0.9885255075606669, 'loss_val': 0.3128963571895988, 'psi': 0.8595382751205782}-{'f1_val': 0.6991463226201102, 'auprc': 0.9045217700418928, 'loss_val': 0.40304548568117804, 'psi': 0.7812965015888232}
[S16] START round=25 head_norm_before_train=1.594215 cos_to_last_merge=0.8331 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.833
[S16] round=25 local utility u=0.000000 metrics={'f1_val': 0.8347765316130068, 'auprc': 0.9573164002064711, 'loss_val': 0.7956962173810469, 'psi': 0.8837924790503926}-{'f1_val': 0.9394337085768787, 'auprc': 0.9890178240013644, 'loss_val': 0.19163338728873391, 'psi': 0.959267354746673}
[S17] START round=25 head_norm_before_train=1.611677 cos_to_last_merge=0.7708 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.771
[S17] round=25 local utility u=0.482407 metrics={'f1_val': 0.6371701875602975, 'auprc': 0.8988531155036732, 'loss_val': 0.7188326533504971, 'psi': 0.7418433587376478}-{'f1_val': 0.5748898116109824, 'auprc': 0.8236058444699483, 'loss_val': 1.084222943208027, 'psi': 0.6743762247545688}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1812 reason=None
[S13] → sending delta(kind=head bytes=1812) to S15@127.0.0.1:57015
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:57015
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:57009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:57007
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] → sending delta(kind=head bytes=1806) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:57011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:57003
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1806 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S13] sending update (kind=head size=1812 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1796) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.169072)
[S3] loaded HEAD from S8 (vec_in norm=1.169072)
[S3] cosine check vs S8: cos=0.2339
[S3] BUFFERED delta from S8 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1799) from S6
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.605145)
[S8] loaded HEAD from S6 (vec_in norm=1.605145)
[S8] cosine check vs S6: cos=0.7724
[S8] BUFFERED delta from S6 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1804) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.824196)
[S9] loaded HEAD from S5 (vec_in norm=1.824196)
[S9] cosine check vs S5: cos=0.9933
[S9] BUFFERED delta from S5 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1799) from S15
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.012057)
[S10] loaded HEAD from S15 (vec_in norm=1.012057)
[S10] cosine check vs S15: cos=0.5410
[S10] BUFFERED delta from S15 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1798) from S14
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.961850)
[S6] loaded HEAD from S14 (vec_in norm=1.961850)
[S6] cosine check vs S14: cos=-0.0641
[S6] DROPPED delta from S14 (cos=-0.0641 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1806) from S7
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.021322)
[S15] loaded HEAD from S7 (vec_in norm=1.021322)
[S15] cosine check vs S7: cos=0.5628
[S15] BUFFERED delta from S7 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1804) from S3
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.474001)
[S15] loaded HEAD from S3 (vec_in norm=1.474001)
[S15] cosine check vs S3: cos=0.8545
[S15] BUFFERED delta from S3 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1812) from S13
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.364866)
[S15] loaded HEAD from S13 (vec_in norm=1.364866)
[S15] cosine check vs S13: cos=0.3629
[S15] BUFFERED delta from S13 (total buffered=3)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:57009
[S17] sending update (kind=head size=1802 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1802) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.621822)
[S8] loaded HEAD from S17 (vec_in norm=1.621822)
[S8] cosine check vs S17: cos=0.5880
[S8] BUFFERED delta from S17 (total buffered=2)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=25 metric=0.9956 head_norm=1.876784
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.106566e-01
[S9] stored merged vector for next round verification (round=25)
[S9] DEBUG after merge:  round=25 metric=0.9956 head_norm=1.847366 delta_norm=0.110657
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.018 → S3@127.0.0.1:57003
[S2] ⇄ pheromone p=0.159 → S10@127.0.0.1:57011
[S4] ⇄ pheromone p=0.047 → S2@127.0.0.1:57002
[S11] ⇄ pheromone p=0.039 → S7@127.0.0.1:57008
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=25 metric=0.9582 head_norm=1.082007
[S10] _apply_head_vector_avg (torch): Δ‖w‖=5.025216e-01
[S10] stored merged vector for next round verification (round=25)
[S10] DEBUG after merge:  round=25 metric=0.9582 head_norm=0.919223 delta_norm=0.502522
[S10] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.120 → S7@127.0.0.1:57008
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=25 metric=0.9967 head_norm=1.474001
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.266516e-01
[S3] stored merged vector for next round verification (round=25)
[S3] DEBUG after merge:  round=25 metric=0.9967 head_norm=1.042282 delta_norm=0.826652
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.199 → S15@127.0.0.1:57015
[S5] ⇄ pheromone p=0.208 → S9@127.0.0.1:57010
[S6] ⇄ pheromone p=0.358 → S8@127.0.0.1:57009
[S14] ⇄ pheromone p=0.031 → S6@127.0.0.1:57007
[S15] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=25 metric=0.7735 head_norm=1.012057
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.464818e-01
[S15] stored merged vector for next round verification (round=25)
[S15] DEBUG after merge:  round=25 metric=0.7525 head_norm=0.897720 delta_norm=0.246482
[S15] aggregate: ROLLBACK (f1_val pre=0.774 post=0.753 tol_abs=0.005 tol_rel=0.0)
[S15] ⇄ pheromone p=0.170 → S10@127.0.0.1:57011
[S13] ⇄ pheromone p=0.074 → S15@127.0.0.1:57015
[S7] ⇄ pheromone p=0.209 → S15@127.0.0.1:57015
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=25 metric=0.9951 head_norm=1.169072
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.497589e-01
[S8] stored merged vector for next round verification (round=25)
[S8] DEBUG after merge:  round=25 metric=0.9954 head_norm=1.142206 delta_norm=0.149759
[S8] aggregate: ACCEPT kept=['S6', 'S17'] (k=2/2) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.133 → S3@127.0.0.1:57003
[S16] ⇄ pheromone p=0.182 → S6@127.0.0.1:57007
[S17] ⇄ pheromone p=0.272 → S8@127.0.0.1:57009
[S2] START round=26 head_norm_before_train=1.896099 cos_to_last_merge=0.9995 (last merge round=23)
[S2] round=26 local utility u=0.789478 metrics={'f1_val': 0.7098309927940626, 'auprc': 0.8637118027340365, 'loss_val': 0.3813650989925439, 'psi': 0.7713833167700521}-{'f1_val': 0.5453722849920872, 'auprc': 0.6842594847794288, 'loss_val': 0.43521178824241546, 'psi': 0.6009271649070238}
[S3] START round=26 head_norm_before_train=1.042282 cos_to_last_merge=1.0000 (last merge round=25)
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.9971202529699166, 'auprc': 0.9977809583569953, 'loss_val': 0.24010384136753699, 'psi': 0.9973845351247481}-{'f1_val': 0.9967098587652717, 'auprc': 0.9988545927904259, 'loss_val': 0.2397400048402744, 'psi': 0.9975677523753335}
[S4] START round=26 head_norm_before_train=1.887228 (no previous merge yet)
[S4] round=26 local utility u=0.060362 metrics={'f1_val': 0.9538069165372643, 'auprc': 0.9844628354159278, 'loss_val': 0.26017476116893795, 'psi': 0.9660692840887297}-{'f1_val': 0.949879182149348, 'auprc': 0.9560585025070929, 'loss_val': 0.2721194145130283, 'psi': 0.9523509102924459}
[S5] START round=26 head_norm_before_train=1.824196 (no previous merge yet)
[S5] round=26 local utility u=0.385874 metrics={'f1_val': 0.9507963986955538, 'auprc': 0.992234842302203, 'loss_val': 0.11568537890871552, 'psi': 0.9673717761382135}-{'f1_val': 0.8257620611152277, 'auprc': 0.9921689993595935, 'loss_val': 0.1370296556783679, 'psi': 0.8923248364129739}
[S6] START round=26 head_norm_before_train=1.605145 cos_to_last_merge=0.9998 (last merge round=24)
[S6] round=26 local utility u=0.000000 metrics={'f1_val': 0.4549390412377434, 'auprc': 0.7804403890084242, 'loss_val': 0.8014951887978867, 'psi': 0.5851395803460158}-{'f1_val': 0.961083459752383, 'auprc': 0.976716541269363, 'loss_val': 0.2110948568472784, 'psi': 0.9673366923591751}
[S7] START round=26 head_norm_before_train=1.021322 cos_to_last_merge=0.9978 (last merge round=24)
[S7] round=26 local utility u=0.231420 metrics={'f1_val': 0.694863669343434, 'auprc': 0.925980941443281, 'loss_val': 0.45943169212072715, 'psi': 0.7873105781833729}-{'f1_val': 0.6699944147234935, 'auprc': 0.8642606489722113, 'loss_val': 0.5878960547763358, 'psi': 0.7477009084229806}
[S8] START round=26 head_norm_before_train=1.142206 cos_to_last_merge=1.0000 (last merge round=25)
[S8] round=26 local utility u=0.000000 metrics={'f1_val': 0.9947267123181514, 'auprc': 0.991852163483313, 'loss_val': 0.2769187923945699, 'psi': 0.993576892784216}-{'f1_val': 0.9951399054533239, 'auprc': 0.9974442816546187, 'loss_val': 0.24423567947745015, 'psi': 0.9960616559338418}
[S9] START round=26 head_norm_before_train=1.847366 cos_to_last_merge=1.0000 (last merge round=25)
[S9] round=26 local utility u=0.000384 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9968582468843311, 'loss_val': 0.062299597821138926, 'psi': 0.996493355621299}-{'f1_val': 0.9956098104564366, 'auprc': 0.998029164742364, 'loss_val': 0.06273837952490711, 'psi': 0.9965775521708076}
[S10] START round=26 head_norm_before_train=0.919223 cos_to_last_merge=1.0000 (last merge round=25)
[S10] round=26 local utility u=0.008847 metrics={'f1_val': 0.9809622852779506, 'auprc': 0.9804491444599497, 'loss_val': 0.42220477972234727, 'psi': 0.9807570289507502}-{'f1_val': 0.9582272562414996, 'auprc': 0.9893482186480589, 'loss_val': 0.3301864477462846, 'psi': 0.9706756412041233}
[S11] START round=26 head_norm_before_train=1.926735 (no previous merge yet)
[S11] round=26 local utility u=0.040855 metrics={'f1_val': 0.8380427801535909, 'auprc': 0.9947729066010008, 'loss_val': 0.22231961208584977, 'psi': 0.9007348307325549}-{'f1_val': 0.8524942763668237, 'auprc': 0.9899395213802733, 'loss_val': 0.37623878941690714, 'psi': 0.9074723743722035}
[S13] START round=26 head_norm_before_train=1.364866 cos_to_last_merge=0.8382 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.838
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.6058912364030289, 'auprc': 0.6840624806895433, 'loss_val': 0.7741046390591557, 'psi': 0.6371597341176347}-{'f1_val': 0.6145668608229327, 'auprc': 0.6827803209274922, 'loss_val': 0.7245481204579273, 'psi': 0.6418522448647566}
[S14] START round=26 head_norm_before_train=1.961850 (no previous merge yet)
[S14] round=26 local utility u=0.000000 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9990903577321204, 'loss_val': 0.02585537722143176, 'psi': 0.9978346479874471}-{'f1_val': 0.9974082695017256, 'auprc': 0.9991397290434529, 'loss_val': 0.022766524691358477, 'psi': 0.9981008533184166}
[S15] START round=26 head_norm_before_train=0.897720 cos_to_last_merge=1.0000 (last merge round=25)
[S15] round=26 local utility u=0.000000 metrics={'f1_val': 0.6991693309699457, 'auprc': 0.8338324372475849, 'loss_val': 0.4223515320574104, 'psi': 0.7530345734810013}-{'f1_val': 0.7735467868271857, 'auprc': 0.9885255075606669, 'loss_val': 0.3128963571895988, 'psi': 0.8595382751205782}
[S16] START round=26 head_norm_before_train=1.616231 cos_to_last_merge=0.8317 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.832
[S16] round=26 local utility u=0.468299 metrics={'f1_val': 0.8824659818364825, 'auprc': 0.9855289883525414, 'loss_val': 0.22987279502624164, 'psi': 0.9236911844429061}-{'f1_val': 0.8347765316130068, 'auprc': 0.9573164002064711, 'loss_val': 0.7956962173810469, 'psi': 0.8837924790503926}
[S17] START round=26 head_norm_before_train=1.621822 cos_to_last_merge=0.7698 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.770
[S17] round=26 local utility u=0.000000 metrics={'f1_val': 0.5172920562286367, 'auprc': 0.6211901534732295, 'loss_val': 1.2427580165452536, 'psi': 0.5588512951264738}-{'f1_val': 0.6371701875602975, 'auprc': 0.8988531155036732, 'loss_val': 0.7188326533504971, 'psi': 0.7418433587376478}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:57008
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:57003
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:57011
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] → sending delta(kind=head bytes=1805) to S9@127.0.0.1:57010
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:57008
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1805 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1795) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=0.944876)
[S7] loaded HEAD from S10 (vec_in norm=0.944876)
[S7] cosine check vs S10: cos=0.7558
[S7] BUFFERED delta from S10 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1802) from S11
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.939934)
[S7] loaded HEAD from S11 (vec_in norm=1.939934)
[S7] cosine check vs S11: cos=0.6989
[S7] BUFFERED delta from S11 (total buffered=2)
[S2] RECEIVED delta(kind=head bytes=1798) from S4
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.902131)
[S2] loaded HEAD from S4 (vec_in norm=1.902131)
[S2] cosine check vs S4: cos=0.9976
[S2] BUFFERED delta from S4 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1803) from S7
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.066076)
[S15] loaded HEAD from S7 (vec_in norm=1.066076)
[S15] cosine check vs S7: cos=0.6758
[S15] BUFFERED delta from S7 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1797) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.880369)
[S3] loaded HEAD from S9 (vec_in norm=1.880369)
[S3] cosine check vs S9: cos=0.6598
[S3] BUFFERED delta from S9 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1803) from S2
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.906411)
[S10] loaded HEAD from S2 (vec_in norm=1.906411)
[S10] cosine check vs S2: cos=0.5732
[S10] BUFFERED delta from S2 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1803) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.636125)
[S6] loaded HEAD from S16 (vec_in norm=1.636125)
[S6] cosine check vs S16: cos=0.9962
[S6] BUFFERED delta from S16 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1805) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.833021)
[S9] loaded HEAD from S5 (vec_in norm=1.833021)
[S9] cosine check vs S5: cos=0.9950
[S9] BUFFERED delta from S5 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=26 metric=0.4549 head_norm=1.621793
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.174587e-02
[S6] stored merged vector for next round verification (round=26)
[S6] DEBUG after merge:  round=26 metric=0.4574 head_norm=1.627394 delta_norm=0.071746
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=26 metric=0.9971 head_norm=1.095060
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.102365e-01
[S3] stored merged vector for next round verification (round=26)
[S3] DEBUG after merge:  round=26 metric=0.9971 head_norm=1.364931 delta_norm=0.710236
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=26 metric=0.7098 head_norm=1.906411
[S2] _apply_head_vector_avg (torch): Δ‖w‖=6.624928e-02
[S2] stored merged vector for next round verification (round=26)
[S2] DEBUG after merge:  round=26 metric=0.7092 head_norm=1.903119 delta_norm=0.066249
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=26 metric=0.9810 head_norm=0.944876
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.845819e-01
[S10] stored merged vector for next round verification (round=26)
[S10] DEBUG after merge:  round=26 metric=0.9810 head_norm=1.283755 delta_norm=0.784582
[S10] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=26 metric=0.9963 head_norm=1.880369
[S9] _apply_head_vector_avg (torch): Δ‖w‖=9.551074e-02
[S9] stored merged vector for next round verification (round=26)
[S9] DEBUG after merge:  round=26 metric=0.9963 head_norm=1.854388 delta_norm=0.095511
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=26 metric=0.6949 head_norm=1.066076
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.530279e-01
[S7] stored merged vector for next round verification (round=26)
[S7] DEBUG after merge:  round=26 metric=0.6886 head_norm=1.080454 delta_norm=0.253028
[S7] aggregate: ROLLBACK (f1_val pre=0.695 post=0.689 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=26 metric=0.6992 head_norm=0.962083
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.110536e-01
[S15] stored merged vector for next round verification (round=26)
[S15] DEBUG after merge:  round=26 metric=0.7000 head_norm=0.928491 delta_norm=0.411054
[S15] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.903119 cos_to_last_merge=1.0000 (last merge round=26)
[S2] round=27 local utility u=0.000000 metrics={'f1_val': 0.715406073966188, 'auprc': 0.6957611818267544, 'loss_val': 0.39849752768016916, 'psi': 0.7075481171104145}-{'f1_val': 0.7098309927940626, 'auprc': 0.8637118027340365, 'loss_val': 0.3813650989925439, 'psi': 0.7713833167700521}
[S3] START round=27 head_norm_before_train=1.364931 cos_to_last_merge=1.0000 (last merge round=26)
[S3] round=27 local utility u=0.000000 metrics={'f1_val': 0.9614594427737211, 'auprc': 0.9986718548641302, 'loss_val': 0.19411536076900945, 'psi': 0.9763444076098848}-{'f1_val': 0.9971202529699166, 'auprc': 0.9977809583569953, 'loss_val': 0.24010384136753699, 'psi': 0.9973845351247481}
[S4] START round=27 head_norm_before_train=1.902131 (no previous merge yet)
[S4] round=27 local utility u=0.000000 metrics={'f1_val': 0.9438851698685959, 'auprc': 0.9436118069878804, 'loss_val': 0.2866098043587593, 'psi': 0.9437758247163097}-{'f1_val': 0.9538069165372643, 'auprc': 0.9844628354159278, 'loss_val': 0.26017476116893795, 'psi': 0.9660692840887297}
[S5] START round=27 head_norm_before_train=1.833021 (no previous merge yet)
[S5] round=27 local utility u=0.000000 metrics={'f1_val': 0.700868080518019, 'auprc': 0.9590982599130211, 'loss_val': 0.35375523948202753, 'psi': 0.8041601522760198}-{'f1_val': 0.9507963986955538, 'auprc': 0.992234842302203, 'loss_val': 0.11568537890871552, 'psi': 0.9673717761382135}
[S6] START round=27 head_norm_before_train=1.627394 cos_to_last_merge=1.0000 (last merge round=26)
[S6] round=27 local utility u=1.000000 metrics={'f1_val': 0.9590869847135763, 'auprc': 0.9795504214613313, 'loss_val': 0.20897010543355143, 'psi': 0.9672723594126784}-{'f1_val': 0.4549390412377434, 'auprc': 0.7804403890084242, 'loss_val': 0.8014951887978867, 'psi': 0.5851395803460158}
[S7] START round=27 head_norm_before_train=1.080454 cos_to_last_merge=1.0000 (last merge round=26)
[S7] round=27 local utility u=0.000000 metrics={'f1_val': 0.6539111068451817, 'auprc': 0.8306350991349382, 'loss_val': 0.6196801836007026, 'psi': 0.7246007037610842}-{'f1_val': 0.694863669343434, 'auprc': 0.925980941443281, 'loss_val': 0.45943169212072715, 'psi': 0.7873105781833729}
[S8] START round=27 head_norm_before_train=1.168338 cos_to_last_merge=0.9992 (last merge round=25)
[S8] round=27 local utility u=0.000000 metrics={'f1_val': 0.7636045671234384, 'auprc': 0.9971980879751231, 'loss_val': 0.26811056241511594, 'psi': 0.8570419754641123}-{'f1_val': 0.9947267123181514, 'auprc': 0.991852163483313, 'loss_val': 0.2769187923945699, 'psi': 0.993576892784216}
[S9] START round=27 head_norm_before_train=1.854388 cos_to_last_merge=1.0000 (last merge round=26)
[S9] round=27 local utility u=0.000000 metrics={'f1_val': 0.9884538934865174, 'auprc': 0.996169023647246, 'loss_val': 0.08071901552790385, 'psi': 0.9915399455508087}-{'f1_val': 0.9962500947792776, 'auprc': 0.9968582468843311, 'loss_val': 0.062299597821138926, 'psi': 0.996493355621299}
[S10] START round=27 head_norm_before_train=1.283755 cos_to_last_merge=1.0000 (last merge round=26)
[S10] round=27 local utility u=0.169157 metrics={'f1_val': 0.9949270377889228, 'auprc': 0.9971133440493131, 'loss_val': 0.21767210658930358, 'psi': 0.995801560293079}-{'f1_val': 0.9809622852779506, 'auprc': 0.9804491444599497, 'loss_val': 0.42220477972234727, 'psi': 0.9807570289507502}
[S11] START round=27 head_norm_before_train=1.939934 (no previous merge yet)
[S11] round=27 local utility u=0.506367 metrics={'f1_val': 0.9842149975515054, 'auprc': 0.9951510035359946, 'loss_val': 0.08775385508787621, 'psi': 0.988589399945301}-{'f1_val': 0.8380427801535909, 'auprc': 0.9947729066010008, 'loss_val': 0.22231961208584977, 'psi': 0.9007348307325549}
[S13] START round=27 head_norm_before_train=1.373602 cos_to_last_merge=0.8350 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.835
[S13] round=27 local utility u=0.110929 metrics={'f1_val': 0.6315183226383958, 'auprc': 0.666788318424876, 'loss_val': 0.6541875353288843, 'psi': 0.6456263209529879}-{'f1_val': 0.6058912364030289, 'auprc': 0.6840624806895433, 'loss_val': 0.7741046390591557, 'psi': 0.6371597341176347}
[S14] START round=27 head_norm_before_train=1.974023 (no previous merge yet)
[S14] round=27 local utility u=0.002854 metrics={'f1_val': 0.9972183481640888, 'auprc': 0.9990514835134671, 'loss_val': 0.02135657497473634, 'psi': 0.9979516023038402}-{'f1_val': 0.9969975081576651, 'auprc': 0.9990903577321204, 'loss_val': 0.02585537722143176, 'psi': 0.9978346479874471}
[S15] START round=27 head_norm_before_train=0.928491 cos_to_last_merge=1.0000 (last merge round=26)
[S15] round=27 local utility u=1.000000 metrics={'f1_val': 0.9481011588418826, 'auprc': 0.9916179588604928, 'loss_val': 0.3880230003999782, 'psi': 0.9655078788493267}-{'f1_val': 0.6991693309699457, 'auprc': 0.8338324372475849, 'loss_val': 0.4223515320574104, 'psi': 0.7530345734810013}
[S16] START round=27 head_norm_before_train=1.636125 cos_to_last_merge=0.8311 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.831
[S16] round=27 local utility u=0.212357 metrics={'f1_val': 0.9404955398604574, 'auprc': 0.9927111848575348, 'loss_val': 0.1748836002313437, 'psi': 0.9613817978592883}-{'f1_val': 0.8824659818364825, 'auprc': 0.9855289883525414, 'loss_val': 0.22987279502624164, 'psi': 0.9236911844429061}
[S17] START round=27 head_norm_before_train=1.631465 cos_to_last_merge=0.7692 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.769
[S17] round=27 local utility u=0.282502 metrics={'f1_val': 0.5458150181671904, 'auprc': 0.7054473060419549, 'loss_val': 1.1016632460218732, 'psi': 0.6096679333170962}-{'f1_val': 0.5172920562286367, 'auprc': 0.6211901534732295, 'loss_val': 1.2427580165452536, 'psi': 0.5588512951264738}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:57009
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:57011
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:57008
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S13] → sending delta(kind=head bytes=1809) to S15@127.0.0.1:57015
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1809 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1798) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.654251)
[S6] loaded HEAD from S16 (vec_in norm=1.654251)
[S6] cosine check vs S16: cos=0.9981
[S6] BUFFERED delta from S16 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1798) from S6
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.640996)
[S8] loaded HEAD from S6 (vec_in norm=1.640996)
[S8] cosine check vs S6: cos=0.7419
[S8] BUFFERED delta from S6 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1803) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.305182)
[S7] loaded HEAD from S10 (vec_in norm=1.305182)
[S7] cosine check vs S10: cos=0.5263
[S7] BUFFERED delta from S10 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1803) from S11
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.952201)
[S7] loaded HEAD from S11 (vec_in norm=1.952201)
[S7] cosine check vs S11: cos=0.8256
[S7] BUFFERED delta from S11 (total buffered=2)
[S6] RECEIVED delta(kind=head bytes=1794) from S14
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.987617)
[S6] loaded HEAD from S14 (vec_in norm=1.987617)
[S6] cosine check vs S14: cos=-0.0656
[S6] DROPPED delta from S14 (cos=-0.0656 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1796) from S15
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.981392)
[S10] loaded HEAD from S15 (vec_in norm=0.981392)
[S10] cosine check vs S15: cos=0.5953
[S10] BUFFERED delta from S15 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1809) from S13
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.382952)
[S15] loaded HEAD from S13 (vec_in norm=1.382952)
[S15] cosine check vs S13: cos=0.3632
[S15] BUFFERED delta from S13 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:57009
[S17] sending update (kind=head size=1802 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1802) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.643725)
[S8] loaded HEAD from S17 (vec_in norm=1.643725)
[S8] cosine check vs S17: cos=0.6336
[S8] BUFFERED delta from S17 (total buffered=2)
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=27 metric=0.7636 head_norm=1.200572
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.238581e-01
[S8] stored merged vector for next round verification (round=27)
[S8] DEBUG after merge:  round=27 metric=0.8748 head_norm=1.171034 delta_norm=0.123858
[S8] aggregate: ACCEPT kept=['S6', 'S17'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=27 metric=0.6539 head_norm=1.114432
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.003343e-01
[S7] stored merged vector for next round verification (round=27)
[S7] DEBUG after merge:  round=27 metric=0.6540 head_norm=1.149336 delta_norm=0.200334
[S7] aggregate: ACCEPT kept=['S10', 'S11'] (k=2/2) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=27 metric=0.9949 head_norm=1.305182
[S10] _apply_head_vector_avg (torch): Δ‖w‖=5.342108e-01
[S10] stored merged vector for next round verification (round=27)
[S10] DEBUG after merge:  round=27 metric=0.9943 head_norm=1.023687 delta_norm=0.534211
[S10] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=27 metric=0.9481 head_norm=0.981392
[S15] _apply_head_vector_avg (torch): Δ‖w‖=6.873443e-01
[S15] stored merged vector for next round verification (round=27)
[S15] DEBUG after merge:  round=27 metric=0.9342 head_norm=0.982548 delta_norm=0.687344
[S15] aggregate: ROLLBACK (f1_val pre=0.948 post=0.934 tol_abs=0.005 tol_rel=0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=27 metric=0.9591 head_norm=1.640996
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.144386e-02
[S6] stored merged vector for next round verification (round=27)
[S6] DEBUG after merge:  round=27 metric=0.9591 head_norm=1.646833 delta_norm=0.051444
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=1.912719 cos_to_last_merge=0.9999 (last merge round=26)
[S2] round=28 local utility u=0.233931 metrics={'f1_val': 0.7136219199511691, 'auprc': 0.8380943401332077, 'loss_val': 0.3469300292668266, 'psi': 0.7634108880239845}-{'f1_val': 0.715406073966188, 'auprc': 0.6957611818267544, 'loss_val': 0.39849752768016916, 'psi': 0.7075481171104145}
[S3] START round=28 head_norm_before_train=1.411757 cos_to_last_merge=0.9976 (last merge round=26)
[S3] round=28 local utility u=0.000000 metrics={'f1_val': 0.9333688439197494, 'auprc': 0.9983462470846248, 'loss_val': 0.19381289355588643, 'psi': 0.9593598051856996}-{'f1_val': 0.9614594427737211, 'auprc': 0.9986718548641302, 'loss_val': 0.19411536076900945, 'psi': 0.9763444076098848}
[S4] START round=28 head_norm_before_train=1.913538 (no previous merge yet)
[S4] round=28 local utility u=0.039816 metrics={'f1_val': 0.9480458763313857, 'auprc': 0.9612681584247666, 'loss_val': 0.2849111129939172, 'psi': 0.9533347891687382}-{'f1_val': 0.9438851698685959, 'auprc': 0.9436118069878804, 'loss_val': 0.2866098043587593, 'psi': 0.9437758247163097}
[S5] START round=28 head_norm_before_train=1.835742 (no previous merge yet)
[S5] round=28 local utility u=0.000000 metrics={'f1_val': 0.7001378716009663, 'auprc': 0.873216174933195, 'loss_val': 0.45393772434328356, 'psi': 0.7693691929338577}-{'f1_val': 0.700868080518019, 'auprc': 0.9590982599130211, 'loss_val': 0.35375523948202753, 'psi': 0.8041601522760198}
[S6] START round=28 head_norm_before_train=1.646833 cos_to_last_merge=1.0000 (last merge round=27)
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.8208971205705027, 'auprc': 0.8763287944126943, 'loss_val': 0.44684985162212953, 'psi': 0.8430697901073794}-{'f1_val': 0.9590869847135763, 'auprc': 0.9795504214613313, 'loss_val': 0.20897010543355143, 'psi': 0.9672723594126784}
[S7] START round=28 head_norm_before_train=1.149336 cos_to_last_merge=1.0000 (last merge round=27)
[S7] round=28 local utility u=0.000000 metrics={'f1_val': 0.6210159057578107, 'auprc': 0.8027449415952896, 'loss_val': 0.7328031655119241, 'psi': 0.6937075200928023}-{'f1_val': 0.6539111068451817, 'auprc': 0.8306350991349382, 'loss_val': 0.6196801836007026, 'psi': 0.7246007037610842}
[S8] START round=28 head_norm_before_train=1.171034 cos_to_last_merge=1.0000 (last merge round=27)
[S8] round=28 local utility u=0.717409 metrics={'f1_val': 0.995160954146866, 'auprc': 0.9983544726406022, 'loss_val': 0.22609992878692248, 'psi': 0.9964383615443604}-{'f1_val': 0.7636045671234384, 'auprc': 0.9971980879751231, 'loss_val': 0.26811056241511594, 'psi': 0.8570419754641123}
[S9] START round=28 head_norm_before_train=1.885288 cos_to_last_merge=0.9992 (last merge round=26)
[S9] round=28 local utility u=0.044485 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9984333280261156, 'loss_val': 0.04778079530673098, 'psi': 0.9973696382987811}-{'f1_val': 0.9884538934865174, 'auprc': 0.996169023647246, 'loss_val': 0.08071901552790385, 'psi': 0.9915399455508087}
[S10] START round=28 head_norm_before_train=1.023687 cos_to_last_merge=1.0000 (last merge round=27)
[S10] round=28 local utility u=0.000000 metrics={'f1_val': 0.9951279124444816, 'auprc': 0.99637146602973, 'loss_val': 0.27480803489893624, 'psi': 0.995625333878581}-{'f1_val': 0.9949270377889228, 'auprc': 0.9971133440493131, 'loss_val': 0.21767210658930358, 'psi': 0.995801560293079}
[S11] START round=28 head_norm_before_train=1.952201 (no previous merge yet)
[S11] round=28 local utility u=0.065563 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9969109782967, 'loss_val': 0.03589996829702167, 'psi': 0.9966925940268337}-{'f1_val': 0.9842149975515054, 'auprc': 0.9951510035359946, 'loss_val': 0.08775385508787621, 'psi': 0.988589399945301}
[S13] START round=28 head_norm_before_train=1.382952 cos_to_last_merge=0.8330 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.833
[S13] round=28 local utility u=0.000000 metrics={'f1_val': 0.6075411864257382, 'auprc': 0.6835848279572228, 'loss_val': 0.7661650873899026, 'psi': 0.6379586430383319}-{'f1_val': 0.6315183226383958, 'auprc': 0.666788318424876, 'loss_val': 0.6541875353288843, 'psi': 0.6456263209529879}
[S14] START round=28 head_norm_before_train=1.987617 (no previous merge yet)
[S14] round=28 local utility u=0.001129 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9990497589791065, 'loss_val': 0.021689550514872393, 'psi': 0.9982105744215548}-{'f1_val': 0.9972183481640888, 'auprc': 0.9990514835134671, 'loss_val': 0.02135657497473634, 'psi': 0.9979516023038402}
[S15] START round=28 head_norm_before_train=0.982548 cos_to_last_merge=1.0000 (last merge round=27)
[S15] round=28 local utility u=0.000000 metrics={'f1_val': 0.700962528621222, 'auprc': 0.8042830877431403, 'loss_val': 0.4742671535584022, 'psi': 0.7422907522699893}-{'f1_val': 0.9481011588418826, 'auprc': 0.9916179588604928, 'loss_val': 0.3880230003999782, 'psi': 0.9655078788493267}
[S16] START round=28 head_norm_before_train=1.654251 cos_to_last_merge=0.8303 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.830
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.8273042015210316, 'auprc': 0.8839293899585091, 'loss_val': 0.9615826303490868, 'psi': 0.8499542768960227}-{'f1_val': 0.9404955398604574, 'auprc': 0.9927111848575348, 'loss_val': 0.1748836002313437, 'psi': 0.9613817978592883}
[S17] START round=28 head_norm_before_train=1.643725 cos_to_last_merge=0.7681 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.768
[S17] round=28 local utility u=0.576205 metrics={'f1_val': 0.6259825451221255, 'auprc': 0.8081724985283056, 'loss_val': 0.7384342767607196, 'psi': 0.6988585264845975}-{'f1_val': 0.5458150181671904, 'auprc': 0.7054473060419549, 'loss_val': 1.1016632460218732, 'psi': 0.6096679333170962}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:57005
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:57007
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:57004
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1802) from S9
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.915658)
[S5] loaded HEAD from S9 (vec_in norm=1.915658)
[S5] cosine check vs S9: cos=0.9923
[S5] BUFFERED delta from S9 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1800) from S2
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.925992)
[S4] loaded HEAD from S2 (vec_in norm=1.925992)
[S4] cosine check vs S2: cos=0.9986
[S4] BUFFERED delta from S2 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1797) from S8
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.205176)
[S6] loaded HEAD from S8 (vec_in norm=1.205176)
[S6] cosine check vs S8: cos=0.7266
[S6] BUFFERED delta from S8 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=28 metric=0.8209 head_norm=1.660722
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.705299e-01
[S6] stored merged vector for next round verification (round=28)
[S6] DEBUG after merge:  round=28 metric=0.8171 head_norm=1.334061 delta_norm=0.570530
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=28 metric=0.7001 head_norm=1.835873
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.229030e-01
[S5] stored merged vector for next round verification (round=28)
[S5] DEBUG after merge:  round=28 metric=0.6828 head_norm=1.872160 delta_norm=0.122903
[S5] aggregate: ROLLBACK (f1_val pre=0.700 post=0.683 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=28 metric=0.9480 head_norm=1.924786
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.139203e-02
[S4] stored merged vector for next round verification (round=28)
[S4] DEBUG after merge:  round=28 metric=0.9480 head_norm=1.924703 delta_norm=0.051392
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=1.925992 cos_to_last_merge=0.9997 (last merge round=26)
[S2] round=29 local utility u=0.035177 metrics={'f1_val': 0.7088270572739698, 'auprc': 0.8771377874502495, 'loss_val': 0.3649374345459501, 'psi': 0.7761513493444816}-{'f1_val': 0.7136219199511691, 'auprc': 0.8380943401332077, 'loss_val': 0.3469300292668266, 'psi': 0.7634108880239845}
[S3] START round=29 head_norm_before_train=1.451638 cos_to_last_merge=0.9927 (last merge round=26)
[S3] round=29 local utility u=0.234626 metrics={'f1_val': 0.9982568970804622, 'auprc': 0.9994770112944232, 'loss_val': 0.11728172303769982, 'psi': 0.9987449427660466}-{'f1_val': 0.9333688439197494, 'auprc': 0.9983462470846248, 'loss_val': 0.19381289355588643, 'psi': 0.9593598051856996}
[S4] START round=29 head_norm_before_train=1.924703 cos_to_last_merge=1.0000 (last merge round=28)
[S4] round=29 local utility u=0.049118 metrics={'f1_val': 0.9563211515397563, 'auprc': 0.9714344820818659, 'loss_val': 0.26682634424958823, 'psi': 0.9623664837566002}-{'f1_val': 0.9480458763313857, 'auprc': 0.9612681584247666, 'loss_val': 0.2849111129939172, 'psi': 0.9533347891687382}
[S5] START round=29 head_norm_before_train=1.872160 cos_to_last_merge=1.0000 (last merge round=28)
[S5] round=29 local utility u=1.000000 metrics={'f1_val': 0.9974639133371228, 'auprc': 0.993676825359049, 'loss_val': 0.0762779596352994, 'psi': 0.9959490781458933}-{'f1_val': 0.7001378716009663, 'auprc': 0.873216174933195, 'loss_val': 0.45393772434328356, 'psi': 0.7693691929338577}
[S6] START round=29 head_norm_before_train=1.334061 cos_to_last_merge=1.0000 (last merge round=28)
[S6] round=29 local utility u=0.162919 metrics={'f1_val': 0.8232042275008931, 'auprc': 0.9648138414088017, 'loss_val': 0.4003092060648814, 'psi': 0.8798480730640565}-{'f1_val': 0.8208971205705027, 'auprc': 0.8763287944126943, 'loss_val': 0.44684985162212953, 'psi': 0.8430697901073794}
[S7] START round=29 head_norm_before_train=1.179948 cos_to_last_merge=0.9985 (last merge round=27)
[S7] round=29 local utility u=0.000000 metrics={'f1_val': 0.594699838880823, 'auprc': 0.7973209011086566, 'loss_val': 0.7867444909580908, 'psi': 0.6757482637719565}-{'f1_val': 0.6210159057578107, 'auprc': 0.8027449415952896, 'loss_val': 0.7328031655119241, 'psi': 0.6937075200928023}
[S8] START round=29 head_norm_before_train=1.205176 cos_to_last_merge=0.9988 (last merge round=27)
[S8] round=29 local utility u=0.022775 metrics={'f1_val': 0.9953659596578323, 'auprc': 0.9974410264784139, 'loss_val': 0.1790402794087344, 'psi': 0.9961959863860649}-{'f1_val': 0.995160954146866, 'auprc': 0.9983544726406022, 'loss_val': 0.22609992878692248, 'psi': 0.9964383615443604}
[S9] START round=29 head_norm_before_train=1.915658 cos_to_last_merge=0.9973 (last merge round=26)
[S9] round=29 local utility u=0.000000 metrics={'f1_val': 0.9895654130089716, 'auprc': 0.9984228970363843, 'loss_val': 0.05618957652318369, 'psi': 0.9931084066199367}-{'f1_val': 0.9966605118138915, 'auprc': 0.9984333280261156, 'loss_val': 0.04778079530673098, 'psi': 0.9973696382987811}
[S10] START round=29 head_norm_before_train=1.045808 cos_to_last_merge=0.9995 (last merge round=27)
[S10] round=29 local utility u=0.011025 metrics={'f1_val': 0.9944457042786687, 'auprc': 0.9967047325952834, 'loss_val': 0.2496650073456075, 'psi': 0.9953493156053146}-{'f1_val': 0.9951279124444816, 'auprc': 0.99637146602973, 'loss_val': 0.27480803489893624, 'psi': 0.995625333878581}
[S11] START round=29 head_norm_before_train=1.969202 (no previous merge yet)
[S11] round=29 local utility u=0.000000 metrics={'f1_val': 0.9622337664781428, 'auprc': 0.997464252262026, 'loss_val': 0.07122623582042768, 'psi': 0.9763259607916961}-{'f1_val': 0.9965470045135896, 'auprc': 0.9969109782967, 'loss_val': 0.03589996829702167, 'psi': 0.9966925940268337}
[S13] START round=29 head_norm_before_train=1.389090 cos_to_last_merge=0.8325 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.832
[S13] round=29 local utility u=0.000000 metrics={'f1_val': 0.5838184292477462, 'auprc': 0.6884467747603756, 'loss_val': 0.8754311399850229, 'psi': 0.625669767452798}-{'f1_val': 0.6075411864257382, 'auprc': 0.6835848279572228, 'loss_val': 0.7661650873899026, 'psi': 0.6379586430383319}
[S14] START round=29 head_norm_before_train=2.000065 (no previous merge yet)
[S14] round=29 local utility u=0.000000 metrics={'f1_val': 0.9972086331282386, 'auprc': 0.9988840627677088, 'loss_val': 0.023023889393247402, 'psi': 0.9978788049840266}-{'f1_val': 0.9976511180498535, 'auprc': 0.9990497589791065, 'loss_val': 0.021689550514872393, 'psi': 0.9982105744215548}
[S15] START round=29 head_norm_before_train=1.027291 cos_to_last_merge=0.9980 (last merge round=27)
[S15] round=29 local utility u=1.000000 metrics={'f1_val': 0.9962895101731264, 'auprc': 0.9918190322864106, 'loss_val': 0.22463186940935007, 'psi': 0.9945013190184401}-{'f1_val': 0.700962528621222, 'auprc': 0.8042830877431403, 'loss_val': 0.4742671535584022, 'psi': 0.7422907522699893}
[S16] START round=29 head_norm_before_train=1.671840 cos_to_last_merge=0.8296 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.830
[S16] round=29 local utility u=0.866465 metrics={'f1_val': 0.9388246884810958, 'auprc': 0.9927115478391193, 'loss_val': 0.22412166359841254, 'psi': 0.9603794322243052}-{'f1_val': 0.8273042015210316, 'auprc': 0.8839293899585091, 'loss_val': 0.9615826303490868, 'psi': 0.8499542768960227}
[S17] START round=29 head_norm_before_train=1.652512 cos_to_last_merge=0.7661 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.766
[S17] round=29 local utility u=0.000000 metrics={'f1_val': 0.5875005066441592, 'auprc': 0.7877328698202234, 'loss_val': 0.8431741867569565, 'psi': 0.667593451914585}-{'f1_val': 0.6259825451221255, 'auprc': 0.8081724985283056, 'loss_val': 0.7384342767607196, 'psi': 0.6988585264845975}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:57004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:57009
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:57016
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:57015
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1802) from S8
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.247298)
[S6] loaded HEAD from S8 (vec_in norm=1.247298)
[S6] cosine check vs S8: cos=0.9009
[S6] BUFFERED delta from S8 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1801) from S6
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.352933)
[S16] loaded HEAD from S6 (vec_in norm=1.352933)
[S16] cosine check vs S6: cos=0.9492
[S16] BUFFERED delta from S6 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1801) from S3
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.485076)
[S8] loaded HEAD from S3 (vec_in norm=1.485076)
[S8] cosine check vs S3: cos=0.2836
[S8] BUFFERED delta from S3 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1796) from S15
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.070896)
[S7] loaded HEAD from S15 (vec_in norm=1.070896)
[S7] cosine check vs S15: cos=0.4518
[S7] BUFFERED delta from S15 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1799) from S2
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.941013)
[S4] loaded HEAD from S2 (vec_in norm=1.941013)
[S4] cosine check vs S2: cos=0.9992
[S4] BUFFERED delta from S2 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1795) from S10
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.071082)
[S15] loaded HEAD from S10 (vec_in norm=1.071082)
[S15] cosine check vs S10: cos=0.5791
[S15] BUFFERED delta from S10 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=29 metric=0.5947 head_norm=1.208154
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.994384e-01
[S7] stored merged vector for next round verification (round=29)
[S7] DEBUG after merge:  round=29 metric=0.6271 head_norm=0.971546 delta_norm=0.599438
[S7] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=29 metric=0.9563 head_norm=1.929688
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.840182e-02
[S4] stored merged vector for next round verification (round=29)
[S4] DEBUG after merge:  round=29 metric=0.9561 head_norm=1.934977 delta_norm=0.038402
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=29 metric=0.9954 head_norm=1.247298
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.232158e-01
[S8] stored merged vector for next round verification (round=29)
[S8] DEBUG after merge:  round=29 metric=0.9951 head_norm=1.096776 delta_norm=0.823216
[S8] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=29 metric=0.9963 head_norm=1.070896
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.913237e-01
[S15] stored merged vector for next round verification (round=29)
[S15] DEBUG after merge:  round=29 metric=0.9958 head_norm=0.951640 delta_norm=0.491324
[S15] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=29 metric=0.8232 head_norm=1.352933
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.939270e-01
[S6] stored merged vector for next round verification (round=29)
[S6] DEBUG after merge:  round=29 metric=0.8229 head_norm=1.267555 delta_norm=0.293927
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=29 metric=0.9388 head_norm=1.690038
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.940867e-01
[S16] stored merged vector for next round verification (round=29)
[S16] DEBUG after merge:  round=29 metric=0.9388 head_norm=1.502278 delta_norm=0.294087
[S16] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=1.941013 cos_to_last_merge=0.9994 (last merge round=26)
[S2] round=30 local utility u=0.033853 metrics={'f1_val': 0.7405734463626085, 'auprc': 0.8349368245860819, 'loss_val': 0.36110751215258724, 'psi': 0.7783187976519979}-{'f1_val': 0.7088270572739698, 'auprc': 0.8771377874502495, 'loss_val': 0.3649374345459501, 'psi': 0.7761513493444816}
[S3] START round=30 head_norm_before_train=1.485076 cos_to_last_merge=0.9877 (last merge round=26)
[S3] round=30 local utility u=0.002180 metrics={'f1_val': 0.998823859603541, 'auprc': 0.9981403504904595, 'loss_val': 0.11231348176296964, 'psi': 0.9985504559583084}-{'f1_val': 0.9982568970804622, 'auprc': 0.9994770112944232, 'loss_val': 0.11728172303769982, 'psi': 0.9987449427660466}
[S4] START round=30 head_norm_before_train=1.934977 cos_to_last_merge=1.0000 (last merge round=29)
[S4] round=30 local utility u=0.000000 metrics={'f1_val': 0.9409758082162458, 'auprc': 0.9382854520374395, 'loss_val': 0.29372007989859006, 'psi': 0.9398996657447233}-{'f1_val': 0.9563211515397563, 'auprc': 0.9714344820818659, 'loss_val': 0.26682634424958823, 'psi': 0.9623664837566002}
[S5] START round=30 head_norm_before_train=1.873974 cos_to_last_merge=1.0000 (last merge round=28)
[S5] round=30 local utility u=0.000000 metrics={'f1_val': 0.8714697107379535, 'auprc': 0.9919103245226988, 'loss_val': 0.15720528543899764, 'psi': 0.9196459562518517}-{'f1_val': 0.9974639133371228, 'auprc': 0.993676825359049, 'loss_val': 0.0762779596352994, 'psi': 0.9959490781458933}
[S6] START round=30 head_norm_before_train=1.267555 cos_to_last_merge=1.0000 (last merge round=29)
[S6] round=30 local utility u=0.474940 metrics={'f1_val': 0.9595357835925988, 'auprc': 0.9758683862236479, 'loss_val': 0.3015813015933352, 'psi': 0.9660688246450184}-{'f1_val': 0.8232042275008931, 'auprc': 0.9648138414088017, 'loss_val': 0.4003092060648814, 'psi': 0.8798480730640565}
[S7] START round=30 head_norm_before_train=0.971546 cos_to_last_merge=1.0000 (last merge round=29)
[S7] round=30 local utility u=0.594074 metrics={'f1_val': 0.6987899886439936, 'auprc': 0.8813138099594127, 'loss_val': 0.47511661291495655, 'psi': 0.7717995171701613}-{'f1_val': 0.594699838880823, 'auprc': 0.7973209011086566, 'loss_val': 0.7867444909580908, 'psi': 0.6757482637719565}
[S8] START round=30 head_norm_before_train=1.096776 cos_to_last_merge=1.0000 (last merge round=29)
[S8] round=30 local utility u=0.000000 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9981243889126427, 'loss_val': 0.22248282532141564, 'psi': 0.9970616005264319}-{'f1_val': 0.9953659596578323, 'auprc': 0.9974410264784139, 'loss_val': 0.1790402794087344, 'psi': 0.9961959863860649}
[S9] START round=30 head_norm_before_train=1.940351 cos_to_last_merge=0.9955 (last merge round=26)
[S9] round=30 local utility u=0.024095 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9951033026048047, 'loss_val': 0.03814829108230888, 'psi': 0.9957913779094885}-{'f1_val': 0.9895654130089716, 'auprc': 0.9984228970363843, 'loss_val': 0.05618957652318369, 'psi': 0.9931084066199367}
[S10] START round=30 head_norm_before_train=1.071082 cos_to_last_merge=0.9981 (last merge round=27)
[S10] round=30 local utility u=0.015656 metrics={'f1_val': 0.9955668669630084, 'auprc': 0.9967034467187392, 'loss_val': 0.2250769762698115, 'psi': 0.9960214988653007}-{'f1_val': 0.9944457042786687, 'auprc': 0.9967047325952834, 'loss_val': 0.2496650073456075, 'psi': 0.9953493156053146}
[S11] START round=30 head_norm_before_train=1.988304 (no previous merge yet)
[S11] round=30 local utility u=0.120868 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9963068487502119, 'loss_val': 0.03201983999666016, 'psi': 0.996463221883813}-{'f1_val': 0.9622337664781428, 'auprc': 0.997464252262026, 'loss_val': 0.07122623582042768, 'psi': 0.9763259607916961}
[S13] START round=30 head_norm_before_train=1.397787 cos_to_last_merge=0.8320 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.832
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.5788947930586745, 'auprc': 0.6878086846688666, 'loss_val': 0.8615949263497205, 'psi': 0.6224603497027514}-{'f1_val': 0.5838184292477462, 'auprc': 0.6884467747603756, 'loss_val': 0.8754311399850229, 'psi': 0.625669767452798}
[S14] START round=30 head_norm_before_train=2.009473 (no previous merge yet)
[S14] round=30 local utility u=0.000000 metrics={'f1_val': 0.992398159142334, 'auprc': 0.9990274126039582, 'loss_val': 0.03426713247208285, 'psi': 0.9950498605269837}-{'f1_val': 0.9972086331282386, 'auprc': 0.9988840627677088, 'loss_val': 0.023023889393247402, 'psi': 0.9978788049840266}
[S15] START round=30 head_norm_before_train=0.951640 cos_to_last_merge=1.0000 (last merge round=29)
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.8391380666148338, 'auprc': 0.9822333805757417, 'loss_val': 0.31697758840038287, 'psi': 0.8963761921991971}-{'f1_val': 0.9962895101731264, 'auprc': 0.9918190322864106, 'loss_val': 0.22463186940935007, 'psi': 0.9945013190184401}
[S16] START round=30 head_norm_before_train=1.502278 cos_to_last_merge=1.0000 (last merge round=29)
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.858479680280017, 'auprc': 0.9846890926119254, 'loss_val': 0.3648954067457801, 'psi': 0.9089634452127804}-{'f1_val': 0.9388246884810958, 'auprc': 0.9927115478391193, 'loss_val': 0.22412166359841254, 'psi': 0.9603794322243052}
[S17] START round=30 head_norm_before_train=1.663324 cos_to_last_merge=0.7648 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.765
[S17] round=30 local utility u=0.000000 metrics={'f1_val': 0.5981646576862781, 'auprc': 0.7856022600602203, 'loss_val': 0.987794841856203, 'psi': 0.673139698635855}-{'f1_val': 0.5875005066441592, 'auprc': 0.7877328698202234, 'loss_val': 0.8431741867569565, 'psi': 0.667593451914585}
[S10] not sending this round → trigger blocked (psi=0.996)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:57011
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.778)
[S3] not sending this round → trigger blocked (psi=0.999)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.966)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:57005
[S9] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1803) from S9
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.962526)
[S5] loaded HEAD from S9 (vec_in norm=1.962526)
[S5] cosine check vs S9: cos=0.9951
[S5] BUFFERED delta from S9 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1795) from S7
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.007204)
[S10] loaded HEAD from S7 (vec_in norm=1.007204)
[S10] cosine check vs S7: cos=0.7763
[S10] BUFFERED delta from S7 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=30 metric=0.9956 head_norm=1.099143
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.548446e-01
[S10] stored merged vector for next round verification (round=30)
[S10] DEBUG after merge:  round=30 metric=0.9956 head_norm=0.992660 delta_norm=0.354845
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.062 → S15@127.0.0.1:57015
[S8] ⇄ pheromone p=0.139 → S6@127.0.0.1:57007
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=30 metric=0.8715 head_norm=1.876458
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.040280e-01
[S5] stored merged vector for next round verification (round=30)
[S5] DEBUG after merge:  round=30 metric=0.8560 head_norm=1.917154 delta_norm=0.104028
[S5] aggregate: ROLLBACK (f1_val pre=0.871 post=0.856 tol_abs=0.005 tol_rel=0.0)
[S15] ⇄ pheromone p=0.318 → S7@127.0.0.1:57008
[S2] ⇄ pheromone p=0.159 → S4@127.0.0.1:57004
[S3] ⇄ pheromone p=0.103 → S8@127.0.0.1:57009
[S6] ⇄ pheromone p=0.341 → S16@127.0.0.1:57016
[S9] ⇄ pheromone p=0.017 → S5@127.0.0.1:57005
[S7] ⇄ pheromone p=0.206 → S10@127.0.0.1:57011
[S16] ⇄ pheromone p=0.258 → S6@127.0.0.1:57007
[S2] START round=31 head_norm_before_train=1.956567 cos_to_last_merge=0.9990 (last merge round=26)
[S2] round=31 local utility u=0.157169 metrics={'f1_val': 0.8302722223811492, 'auprc': 0.7581685271229053, 'loss_val': 0.3546573327715315, 'psi': 0.8014307442778517}-{'f1_val': 0.7405734463626085, 'auprc': 0.8349368245860819, 'loss_val': 0.36110751215258724, 'psi': 0.7783187976519979}
[S3] START round=31 head_norm_before_train=1.511320 cos_to_last_merge=0.9832 (last merge round=26)
[S3] round=31 local utility u=0.000000 metrics={'f1_val': 0.6470255074815184, 'auprc': 0.9831967196497321, 'loss_val': 0.7529754133039841, 'psi': 0.7814939923488039}-{'f1_val': 0.998823859603541, 'auprc': 0.9981403504904595, 'loss_val': 0.11231348176296964, 'psi': 0.9985504559583084}
[S4] START round=31 head_norm_before_train=1.934559 cos_to_last_merge=1.0000 (last merge round=29)
[S4] round=31 local utility u=0.000000 metrics={'f1_val': 0.9402493144538449, 'auprc': 0.9316465758107397, 'loss_val': 0.32689081754059846, 'psi': 0.9368082189966028}-{'f1_val': 0.9409758082162458, 'auprc': 0.9382854520374395, 'loss_val': 0.29372007989859006, 'psi': 0.9398996657447233}
[S5] START round=31 head_norm_before_train=1.917154 cos_to_last_merge=1.0000 (last merge round=30)
[S5] round=31 local utility u=0.000000 metrics={'f1_val': 0.8164460934035042, 'auprc': 0.9869308944293933, 'loss_val': 0.19182311657627063, 'psi': 0.8846400138138598}-{'f1_val': 0.8714697107379535, 'auprc': 0.9919103245226988, 'loss_val': 0.15720528543899764, 'psi': 0.9196459562518517}
[S6] START round=31 head_norm_before_train=1.298628 cos_to_last_merge=0.9992 (last merge round=29)
[S6] round=31 local utility u=0.000000 metrics={'f1_val': 0.7800567841779901, 'auprc': 0.8028051246078781, 'loss_val': 0.5309421982496577, 'psi': 0.7891561203499453}-{'f1_val': 0.9595357835925988, 'auprc': 0.9758683862236479, 'loss_val': 0.3015813015933352, 'psi': 0.9660688246450184}
[S7] START round=31 head_norm_before_train=1.007204 cos_to_last_merge=0.9988 (last merge round=29)
[S7] round=31 local utility u=0.000000 metrics={'f1_val': 0.6704858165341216, 'auprc': 0.8267457989838303, 'loss_val': 0.5071526560625611, 'psi': 0.732989809514005}-{'f1_val': 0.6987899886439936, 'auprc': 0.8813138099594127, 'loss_val': 0.47511661291495655, 'psi': 0.7717995171701613}
[S8] START round=31 head_norm_before_train=1.135246 cos_to_last_merge=0.9988 (last merge round=29)
[S8] round=31 local utility u=0.000000 metrics={'f1_val': 0.9947031564507061, 'auprc': 0.9926398939627376, 'loss_val': 0.21345780578270773, 'psi': 0.9938778514555187}-{'f1_val': 0.9963530749356245, 'auprc': 0.9981243889126427, 'loss_val': 0.22248282532141564, 'psi': 0.9970616005264319}
[S9] START round=31 head_norm_before_train=1.962526 cos_to_last_merge=0.9939 (last merge round=26)
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.9884538934865174, 'auprc': 0.9958717738102797, 'loss_val': 0.05654242001461068, 'psi': 0.9914210456160222}-{'f1_val': 0.9962500947792776, 'auprc': 0.9951033026048047, 'loss_val': 0.03814829108230888, 'psi': 0.9957913779094885}
[S10] START round=31 head_norm_before_train=0.992660 cos_to_last_merge=1.0000 (last merge round=30)
[S10] round=31 local utility u=0.000000 metrics={'f1_val': 0.9951941773951698, 'auprc': 0.9962342106913519, 'loss_val': 0.2780023187357234, 'psi': 0.9956101907136427}-{'f1_val': 0.9955668669630084, 'auprc': 0.9967034467187392, 'loss_val': 0.2250769762698115, 'psi': 0.9960214988653007}
[S11] START round=31 head_norm_before_train=2.004504 (no previous merge yet)
[S11] round=31 local utility u=0.000000 metrics={'f1_val': 0.9963958538641108, 'auprc': 0.9958216495155068, 'loss_val': 0.02957549422801468, 'psi': 0.9961661721246693}-{'f1_val': 0.996567470639547, 'auprc': 0.9963068487502119, 'loss_val': 0.03201983999666016, 'psi': 0.996463221883813}
[S13] START round=31 head_norm_before_train=1.408845 cos_to_last_merge=0.8284 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.828
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.5612495704148841, 'auprc': 0.6808828904638282, 'loss_val': 0.7952347240103723, 'psi': 0.6091028984344617}-{'f1_val': 0.5788947930586745, 'auprc': 0.6878086846688666, 'loss_val': 0.8615949263497205, 'psi': 0.6224603497027514}
[S14] START round=31 head_norm_before_train=2.020778 (no previous merge yet)
[S14] round=31 local utility u=0.000000 metrics={'f1_val': 0.9679536653748086, 'auprc': 0.998954053203331, 'loss_val': 0.047735931404431615, 'psi': 0.9803538205062177}-{'f1_val': 0.992398159142334, 'auprc': 0.9990274126039582, 'loss_val': 0.03426713247208285, 'psi': 0.9950498605269837}
[S15] START round=31 head_norm_before_train=0.997964 cos_to_last_merge=0.9984 (last merge round=29)
[S15] round=31 local utility u=0.000000 metrics={'f1_val': 0.6972429520078905, 'auprc': 0.7990028660005679, 'loss_val': 0.4658527891663247, 'psi': 0.7379469176049616}-{'f1_val': 0.8391380666148338, 'auprc': 0.9822333805757417, 'loss_val': 0.31697758840038287, 'psi': 0.8963761921991971}
[S16] START round=31 head_norm_before_train=1.522627 cos_to_last_merge=0.9999 (last merge round=29)
[S16] round=31 local utility u=0.548267 metrics={'f1_val': 0.9910872106354804, 'auprc': 0.9889782138704704, 'loss_val': 0.07687371389045872, 'psi': 0.9902436119294764}-{'f1_val': 0.858479680280017, 'auprc': 0.9846890926119254, 'loss_val': 0.3648954067457801, 'psi': 0.9089634452127804}
[S17] START round=31 head_norm_before_train=1.674297 cos_to_last_merge=0.7640 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.764
[S17] round=31 local utility u=0.215903 metrics={'f1_val': 0.6168022112326494, 'auprc': 0.9042663146442504, 'loss_val': 1.023807056078905, 'psi': 0.7317878525972898}-{'f1_val': 0.5981646576862781, 'auprc': 0.7856022600602203, 'loss_val': 0.987794841856203, 'psi': 0.673139698635855}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:57004
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:57007
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1797) from S2
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.971160)
[S4] loaded HEAD from S2 (vec_in norm=1.971160)
[S4] cosine check vs S2: cos=0.9991
[S4] BUFFERED delta from S2 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1798) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.544627)
[S6] loaded HEAD from S16 (vec_in norm=1.544627)
[S6] cosine check vs S16: cos=0.9284
[S6] BUFFERED delta from S16 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=31 metric=0.9402 head_norm=1.933948
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.639442e-02
[S4] stored merged vector for next round verification (round=31)
[S4] DEBUG after merge:  round=31 metric=0.9402 head_norm=1.952091 delta_norm=0.046394
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=31 metric=0.7801 head_norm=1.333660
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.913725e-01
[S6] stored merged vector for next round verification (round=31)
[S6] DEBUG after merge:  round=31 metric=0.7836 head_norm=1.413281 delta_norm=0.291372
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=32 head_norm_before_train=1.971160 cos_to_last_merge=0.9985 (last merge round=26)
[S2] round=32 local utility u=0.178681 metrics={'f1_val': 0.8036372709455355, 'auprc': 0.9346824627756328, 'loss_val': 0.367027020720291, 'psi': 0.8560553476775744}-{'f1_val': 0.8302722223811492, 'auprc': 0.7581685271229053, 'loss_val': 0.3546573327715315, 'psi': 0.8014307442778517}
[S3] START round=32 head_norm_before_train=1.532635 cos_to_last_merge=0.9791 (last merge round=26)
[S3] round=32 local utility u=1.000000 metrics={'f1_val': 0.9358173788455322, 'auprc': 0.999049028090821, 'loss_val': 0.14472931321065488, 'psi': 0.9611100385436476}-{'f1_val': 0.6470255074815184, 'auprc': 0.9831967196497321, 'loss_val': 0.7529754133039841, 'psi': 0.7814939923488039}
[S4] START round=32 head_norm_before_train=1.952091 cos_to_last_merge=1.0000 (last merge round=31)
[S4] round=32 local utility u=0.036152 metrics={'f1_val': 0.9415612385993243, 'auprc': 0.9409302409871979, 'loss_val': 0.29030912741176085, 'psi': 0.9413088395544738}-{'f1_val': 0.9402493144538449, 'auprc': 0.9316465758107397, 'loss_val': 0.32689081754059846, 'psi': 0.9368082189966028}
[S5] START round=32 head_norm_before_train=1.920434 cos_to_last_merge=1.0000 (last merge round=30)
[S5] round=32 local utility u=0.339767 metrics={'f1_val': 0.9160023315528629, 'auprc': 0.9922566507123989, 'loss_val': 0.12560464743489236, 'psi': 0.9465040592166774}-{'f1_val': 0.8164460934035042, 'auprc': 0.9869308944293933, 'loss_val': 0.19182311657627063, 'psi': 0.8846400138138598}
[S6] START round=32 head_norm_before_train=1.413281 cos_to_last_merge=1.0000 (last merge round=31)
[S6] round=32 local utility u=0.298686 metrics={'f1_val': 0.7863624430932656, 'auprc': 0.9641766094534536, 'loss_val': 0.4555190355433017, 'psi': 0.8574881096373408}-{'f1_val': 0.7800567841779901, 'auprc': 0.8028051246078781, 'loss_val': 0.5309421982496577, 'psi': 0.7891561203499453}
[S7] START round=32 head_norm_before_train=1.048164 cos_to_last_merge=0.9953 (last merge round=29)
[S7] round=32 local utility u=0.000000 metrics={'f1_val': 0.6344406367130204, 'auprc': 0.8128750226533972, 'loss_val': 0.5809619133529775, 'psi': 0.7058143910891711}-{'f1_val': 0.6704858165341216, 'auprc': 0.8267457989838303, 'loss_val': 0.5071526560625611, 'psi': 0.732989809514005}
[S8] START round=32 head_norm_before_train=1.167195 cos_to_last_merge=0.9965 (last merge round=29)
[S8] round=32 local utility u=0.036760 metrics={'f1_val': 0.9948741547680577, 'auprc': 0.9983813019151302, 'loss_val': 0.15818804533132552, 'psi': 0.9962770136268867}-{'f1_val': 0.9947031564507061, 'auprc': 0.9926398939627376, 'loss_val': 0.21345780578270773, 'psi': 0.9938778514555187}
[S9] START round=32 head_norm_before_train=1.980283 cos_to_last_merge=0.9926 (last merge round=26)
[S9] round=32 local utility u=0.036867 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9968702934229184, 'loss_val': 0.03258117091640952, 'psi': 0.9964981742367339}-{'f1_val': 0.9884538934865174, 'auprc': 0.9958717738102797, 'loss_val': 0.05654242001461068, 'psi': 0.9914210456160222}
[S10] START round=32 head_norm_before_train=1.026333 cos_to_last_merge=0.9991 (last merge round=30)
[S10] round=32 local utility u=0.023894 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9967375431202229, 'loss_val': 0.23421708568272798, 'psi': 0.9960608093571011}-{'f1_val': 0.9951941773951698, 'auprc': 0.9962342106913519, 'loss_val': 0.2780023187357234, 'psi': 0.9956101907136427}
[S11] START round=32 head_norm_before_train=2.015460 (no previous merge yet)
[S11] round=32 local utility u=0.000000 metrics={'f1_val': 0.9959123037929781, 'auprc': 0.9954111314882271, 'loss_val': 0.03027380050972924, 'psi': 0.9957118348710777}-{'f1_val': 0.9963958538641108, 'auprc': 0.9958216495155068, 'loss_val': 0.02957549422801468, 'psi': 0.9961661721246693}
[S13] START round=32 head_norm_before_train=1.420687 cos_to_last_merge=0.8245 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.824
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.5445614566885375, 'auprc': 0.6893307843346003, 'loss_val': 0.8964798116500362, 'psi': 0.6024691877469626}-{'f1_val': 0.5612495704148841, 'auprc': 0.6808828904638282, 'loss_val': 0.7952347240103723, 'psi': 0.6091028984344617}
[S14] START round=32 head_norm_before_train=2.031097 (no previous merge yet)
[S14] round=32 local utility u=0.102108 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9990008179822965, 'loss_val': 0.020387820136663314, 'psi': 0.9980452888939539}-{'f1_val': 0.9679536653748086, 'auprc': 0.998954053203331, 'loss_val': 0.047735931404431615, 'psi': 0.9803538205062177}
[S15] START round=32 head_norm_before_train=1.050912 cos_to_last_merge=0.9940 (last merge round=29)
[S15] round=32 local utility u=0.619857 metrics={'f1_val': 0.806015663269036, 'auprc': 0.9412979559110275, 'loss_val': 0.30566043574390556, 'psi': 0.8601285803258325}-{'f1_val': 0.6972429520078905, 'auprc': 0.7990028660005679, 'loss_val': 0.4658527891663247, 'psi': 0.7379469176049616}
[S16] START round=32 head_norm_before_train=1.544627 cos_to_last_merge=0.9997 (last merge round=29)
[S16] round=32 local utility u=0.000000 metrics={'f1_val': 0.9325429433036025, 'auprc': 0.9914684476530636, 'loss_val': 0.2850669648604425, 'psi': 0.9561131450433871}-{'f1_val': 0.9910872106354804, 'auprc': 0.9889782138704704, 'loss_val': 0.07687371389045872, 'psi': 0.9902436119294764}
[S17] START round=32 head_norm_before_train=1.685874 cos_to_last_merge=0.7638 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.764
[S17] round=32 local utility u=0.146999 metrics={'f1_val': 0.639684989797322, 'auprc': 0.9415731611468241, 'loss_val': 0.9790261590782643, 'psi': 0.7604402583371228}-{'f1_val': 0.6168022112326494, 'auprc': 0.9042663146442504, 'loss_val': 1.023807056078905, 'psi': 0.7317878525972898}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:57002
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:57009
[S2] not sending this round → trigger blocked (psi=0.856)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:57016
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:57008
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:57005
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1800) from S6
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.445404)
[S16] loaded HEAD from S6 (vec_in norm=1.445404)
[S16] cosine check vs S6: cos=0.9830
[S16] BUFFERED delta from S6 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1798) from S8
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.197563)
[S6] loaded HEAD from S8 (vec_in norm=1.197563)
[S6] cosine check vs S8: cos=0.6975
[S6] BUFFERED delta from S8 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1797) from S9
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.998547)
[S5] loaded HEAD from S9 (vec_in norm=1.998547)
[S5] cosine check vs S9: cos=0.9971
[S5] BUFFERED delta from S9 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1798) from S3
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.549071)
[S8] loaded HEAD from S3 (vec_in norm=1.549071)
[S8] cosine check vs S3: cos=0.8131
[S8] BUFFERED delta from S3 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1801) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.933503)
[S9] loaded HEAD from S5 (vec_in norm=1.933503)
[S9] cosine check vs S5: cos=0.9971
[S9] BUFFERED delta from S5 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1800) from S4
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.956488)
[S2] loaded HEAD from S4 (vec_in norm=1.956488)
[S2] cosine check vs S4: cos=0.9995
[S2] BUFFERED delta from S4 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1798) from S15
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.101834)
[S7] loaded HEAD from S15 (vec_in norm=1.101834)
[S7] cosine check vs S15: cos=0.8783
[S7] BUFFERED delta from S15 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1797) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.067621)
[S7] loaded HEAD from S10 (vec_in norm=1.067621)
[S7] cosine check vs S10: cos=0.9099
[S7] BUFFERED delta from S10 (total buffered=2)
[S17] not sending this round → trigger blocked (psi=0.760)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=32 metric=0.8036 head_norm=1.983570
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.348120e-02
[S2] stored merged vector for next round verification (round=32)
[S2] DEBUG after merge:  round=32 metric=0.7967 head_norm=1.969791 delta_norm=0.033481
[S2] aggregate: ROLLBACK (f1_val pre=0.804 post=0.797 tol_abs=0.005 tol_rel=0.0)
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=32 metric=0.6344 head_norm=1.082057
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.246497e-01
[S7] stored merged vector for next round verification (round=32)
[S7] DEBUG after merge:  round=32 metric=0.6483 head_norm=1.048609 delta_norm=0.224650
[S7] aggregate: ACCEPT kept=['S15', 'S10'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=32 metric=0.9949 head_norm=1.197563
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.519344e-01
[S8] stored merged vector for next round verification (round=32)
[S8] DEBUG after merge:  round=32 metric=0.9964 head_norm=1.308680 delta_norm=0.451934
[S8] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=32 metric=0.9963 head_norm=1.998547
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.193508e-02
[S9] stored merged vector for next round verification (round=32)
[S9] DEBUG after merge:  round=32 metric=0.9963 head_norm=1.964586 delta_norm=0.081935
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=32 metric=0.7864 head_norm=1.445404
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.264824e-01
[S6] stored merged vector for next round verification (round=32)
[S6] DEBUG after merge:  round=32 metric=0.7922 head_norm=1.218397 delta_norm=0.526482
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=32 metric=0.9160 head_norm=1.933503
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.193507e-02
[S5] stored merged vector for next round verification (round=32)
[S5] DEBUG after merge:  round=32 metric=0.8904 head_norm=1.964586 delta_norm=0.081935
[S5] aggregate: ROLLBACK (f1_val pre=0.916 post=0.890 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=32 metric=0.9325 head_norm=1.566279
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.512309e-01
[S16] stored merged vector for next round verification (round=32)
[S16] DEBUG after merge:  round=32 metric=0.9325 head_norm=1.499447 delta_norm=0.151231
[S16] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=33 head_norm_before_train=1.969791 cos_to_last_merge=1.0000 (last merge round=32)
[S2] round=33 local utility u=0.000000 metrics={'f1_val': 0.8240306612605763, 'auprc': 0.8890309758269066, 'loss_val': 0.3632346030866066, 'psi': 0.8500307870871084}-{'f1_val': 0.8036372709455355, 'auprc': 0.9346824627756328, 'loss_val': 0.367027020720291, 'psi': 0.8560553476775744}
[S3] START round=33 head_norm_before_train=1.549071 cos_to_last_merge=0.9758 (last merge round=26)
[S3] round=33 local utility u=0.088699 metrics={'f1_val': 0.960995754132836, 'auprc': 0.9987653969892187, 'loss_val': 0.11755026411050215, 'psi': 0.9761036112753891}-{'f1_val': 0.9358173788455322, 'auprc': 0.999049028090821, 'loss_val': 0.14472931321065488, 'psi': 0.9611100385436476}
[S4] START round=33 head_norm_before_train=1.956488 cos_to_last_merge=1.0000 (last merge round=31)
[S4] round=33 local utility u=0.005781 metrics={'f1_val': 0.9422674620422324, 'auprc': 0.943536691765286, 'loss_val': 0.2908029455277199, 'psi': 0.9427751539314538}-{'f1_val': 0.9415612385993243, 'auprc': 0.9409302409871979, 'loss_val': 0.29030912741176085, 'psi': 0.9413088395544738}
[S5] START round=33 head_norm_before_train=1.964586 cos_to_last_merge=1.0000 (last merge round=32)
[S5] round=33 local utility u=0.284491 metrics={'f1_val': 0.9975086222760589, 'auprc': 0.9952883842076787, 'loss_val': 0.054755903330147127, 'psi': 0.9966205270487067}-{'f1_val': 0.9160023315528629, 'auprc': 0.9922566507123989, 'loss_val': 0.12560464743489236, 'psi': 0.9465040592166774}
[S6] START round=33 head_norm_before_train=1.218397 cos_to_last_merge=1.0000 (last merge round=32)
[S6] round=33 local utility u=0.355146 metrics={'f1_val': 0.8703502240382145, 'auprc': 0.9811259449254006, 'loss_val': 0.3000007714055609, 'psi': 0.9146605123930889}-{'f1_val': 0.7863624430932656, 'auprc': 0.9641766094534536, 'loss_val': 0.4555190355433017, 'psi': 0.8574881096373408}
[S7] START round=33 head_norm_before_train=1.048609 cos_to_last_merge=1.0000 (last merge round=32)
[S7] round=33 local utility u=0.309000 metrics={'f1_val': 0.6769364865524361, 'auprc': 0.8838906313505082, 'loss_val': 0.43098413479043257, 'psi': 0.759718144471665}-{'f1_val': 0.6344406367130204, 'auprc': 0.8128750226533972, 'loss_val': 0.5809619133529775, 'psi': 0.7058143910891711}
[S8] START round=33 head_norm_before_train=1.308680 cos_to_last_merge=1.0000 (last merge round=32)
[S8] round=33 local utility u=0.000000 metrics={'f1_val': 0.9954637732876968, 'auprc': 0.9963758361734222, 'loss_val': 0.1977469159098466, 'psi': 0.995828598441987}-{'f1_val': 0.9948741547680577, 'auprc': 0.9983813019151302, 'loss_val': 0.15818804533132552, 'psi': 0.9962770136268867}
[S9] START round=33 head_norm_before_train=1.964586 cos_to_last_merge=1.0000 (last merge round=32)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.9958312226609984, 'auprc': 0.9984505822014929, 'loss_val': 0.03574789198812044, 'psi': 0.9968789664771962}-{'f1_val': 0.9962500947792776, 'auprc': 0.9968702934229184, 'loss_val': 0.03258117091640952, 'psi': 0.9964981742367339}
[S10] START round=33 head_norm_before_train=1.067621 cos_to_last_merge=0.9962 (last merge round=30)
[S10] round=33 local utility u=0.010176 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.994862892671847, 'loss_val': 0.2082411889413792, 'psi': 0.9953109491777508}-{'f1_val': 0.9956096535150197, 'auprc': 0.9967375431202229, 'loss_val': 0.23421708568272798, 'psi': 0.9960608093571011}
[S11] START round=33 head_norm_before_train=2.027150 (no previous merge yet)
[S11] round=33 local utility u=0.000812 metrics={'f1_val': 0.9963958538641108, 'auprc': 0.9944077267810838, 'loss_val': 0.028541008695617532, 'psi': 0.9956006030309}-{'f1_val': 0.9959123037929781, 'auprc': 0.9954111314882271, 'loss_val': 0.03027380050972924, 'psi': 0.9957118348710777}
[S13] START round=33 head_norm_before_train=1.432175 cos_to_last_merge=0.8227 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.823
[S13] round=33 local utility u=0.031048 metrics={'f1_val': 0.5575112069610063, 'auprc': 0.69066591325313, 'loss_val': 0.916087005415173, 'psi': 0.6107730894778558}-{'f1_val': 0.5445614566885375, 'auprc': 0.6893307843346003, 'loss_val': 0.8964798116500362, 'psi': 0.6024691877469626}
[S14] START round=33 head_norm_before_train=2.038586 (no previous merge yet)
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9990435402997191, 'loss_val': 0.02042724337451264, 'psi': 0.9979616301433635}-{'f1_val': 0.9974082695017256, 'auprc': 0.9990008179822965, 'loss_val': 0.020387820136663314, 'psi': 0.9980452888939539}
[S15] START round=33 head_norm_before_train=1.101834 cos_to_last_merge=0.9882 (last merge round=29)
[S15] round=33 local utility u=0.724680 metrics={'f1_val': 0.9957757960160583, 'auprc': 0.9909936888782163, 'loss_val': 0.14394938811379576, 'psi': 0.9938629531609215}-{'f1_val': 0.806015663269036, 'auprc': 0.9412979559110275, 'loss_val': 0.30566043574390556, 'psi': 0.8601285803258325}
[S16] START round=33 head_norm_before_train=1.499447 cos_to_last_merge=1.0000 (last merge round=32)
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.8552824129199832, 'auprc': 0.9850806781953358, 'loss_val': 0.6145184784349161, 'psi': 0.9072017190301243}-{'f1_val': 0.9325429433036025, 'auprc': 0.9914684476530636, 'loss_val': 0.2850669648604425, 'psi': 0.9561131450433871}
[S17] START round=33 head_norm_before_train=1.694955 cos_to_last_merge=0.7636 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.764
[S17] round=33 local utility u=0.000000 metrics={'f1_val': 0.6139359302101302, 'auprc': 0.9352717389468709, 'loss_val': 1.1024259598897355, 'psi': 0.7424702537048264}-{'f1_val': 0.639684989797322, 'auprc': 0.9415731611468241, 'loss_val': 0.9790261590782643, 'psi': 0.7604402583371228}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] → sending delta(kind=head bytes=1805) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.995)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S3] not sending this round → trigger blocked (psi=0.976)
[S15] not sending this round → trigger blocked (psi=0.994)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.943)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.915)
[S5] not sending this round → trigger blocked (psi=0.997)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1805 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1805) from S7
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.078654)
[S15] loaded HEAD from S7 (vec_in norm=1.078654)
[S15] cosine check vs S7: cos=0.9388
[S15] BUFFERED delta from S7 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=33 metric=0.9958 head_norm=1.146337
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.974262e-01
[S15] stored merged vector for next round verification (round=33)
[S15] DEBUG after merge:  round=33 metric=0.9945 head_norm=1.095360 delta_norm=0.197426
[S15] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=34 head_norm_before_train=1.983263 cos_to_last_merge=1.0000 (last merge round=32)
[S2] round=34 local utility u=0.068614 metrics={'f1_val': 0.8267096084033485, 'auprc': 0.9244973359824215, 'loss_val': 0.34847897900962094, 'psi': 0.8658246994349776}-{'f1_val': 0.8240306612605763, 'auprc': 0.8890309758269066, 'loss_val': 0.3632346030866066, 'psi': 0.8500307870871084}
[S3] START round=34 head_norm_before_train=1.564114 cos_to_last_merge=0.9732 (last merge round=26)
[S3] round=34 local utility u=0.130950 metrics={'f1_val': 0.9962367436152, 'auprc': 0.9979056486840413, 'loss_val': 0.0645170906864479, 'psi': 0.9969043056427365}-{'f1_val': 0.960995754132836, 'auprc': 0.9987653969892187, 'loss_val': 0.11755026411050215, 'psi': 0.9761036112753891}
[S4] START round=34 head_norm_before_train=1.963104 cos_to_last_merge=0.9999 (last merge round=31)
[S4] round=34 local utility u=0.000000 metrics={'f1_val': 0.9388131372568042, 'auprc': 0.9285566337012141, 'loss_val': 0.3084369551284279, 'psi': 0.9347105358345681}-{'f1_val': 0.9422674620422324, 'auprc': 0.943536691765286, 'loss_val': 0.2908029455277199, 'psi': 0.9427751539314538}
[S5] START round=34 head_norm_before_train=1.981428 cos_to_last_merge=0.9999 (last merge round=32)
[S5] round=34 local utility u=0.003515 metrics={'f1_val': 0.9975086222760589, 'auprc': 0.994364581893973, 'loss_val': 0.04495378185282905, 'psi': 0.9962510061232245}-{'f1_val': 0.9975086222760589, 'auprc': 0.9952883842076787, 'loss_val': 0.054755903330147127, 'psi': 0.9966205270487067}
[S6] START round=34 head_norm_before_train=1.250118 cos_to_last_merge=0.9992 (last merge round=32)
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.7202659178876344, 'auprc': 0.852638980899019, 'loss_val': 0.5594384767278289, 'psi': 0.7732151430921883}-{'f1_val': 0.8703502240382145, 'auprc': 0.9811259449254006, 'loss_val': 0.3000007714055609, 'psi': 0.9146605123930889}
[S7] START round=34 head_norm_before_train=1.078654 cos_to_last_merge=0.9992 (last merge round=32)
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.5264045597083689, 'auprc': 0.7935814504726274, 'loss_val': 0.8525136737822566, 'psi': 0.6332753160140723}-{'f1_val': 0.6769364865524361, 'auprc': 0.8838906313505082, 'loss_val': 0.43098413479043257, 'psi': 0.759718144471665}
[S8] START round=34 head_norm_before_train=1.333022 cos_to_last_merge=0.9994 (last merge round=32)
[S8] round=34 local utility u=0.019920 metrics={'f1_val': 0.9946459649293765, 'auprc': 0.99624958683637, 'loss_val': 0.15262066154437068, 'psi': 0.9952874136921739}-{'f1_val': 0.9954637732876968, 'auprc': 0.9963758361734222, 'loss_val': 0.1977469159098466, 'psi': 0.995828598441987}
[S9] START round=34 head_norm_before_train=1.982533 cos_to_last_merge=0.9999 (last merge round=32)
[S9] round=34 local utility u=0.002670 metrics={'f1_val': 0.9962748907591257, 'auprc': 0.9984573463122738, 'loss_val': 0.0330908552183128, 'psi': 0.9971478729803849}-{'f1_val': 0.9958312226609984, 'auprc': 0.9984505822014929, 'loss_val': 0.03574789198812044, 'psi': 0.9968789664771962}
[S10] START round=34 head_norm_before_train=1.113647 cos_to_last_merge=0.9917 (last merge round=30)
[S10] round=34 local utility u=0.028341 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9966432546737973, 'loss_val': 0.15436982309127342, 'psi': 0.9957700052811438}-{'f1_val': 0.9956096535150197, 'auprc': 0.994862892671847, 'loss_val': 0.2082411889413792, 'psi': 0.9953109491777508}
[S11] START round=34 head_norm_before_train=2.034764 (no previous merge yet)
[S11] round=34 local utility u=0.000469 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9954450734429676, 'loss_val': 0.02926522774885874, 'psi': 0.9958705142236343}-{'f1_val': 0.9963958538641108, 'auprc': 0.9944077267810838, 'loss_val': 0.028541008695617532, 'psi': 0.9956006030309}
[S13] START round=34 head_norm_before_train=1.442746 cos_to_last_merge=0.8220 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.822
[S13] round=34 local utility u=0.295982 metrics={'f1_val': 0.6162932268678826, 'auprc': 0.6904897868065623, 'loss_val': 0.676287695956562, 'psi': 0.6459718508433544}-{'f1_val': 0.5575112069610063, 'auprc': 0.69066591325313, 'loss_val': 0.916087005415173, 'psi': 0.6107730894778558}
[S14] START round=34 head_norm_before_train=2.047946 (no previous merge yet)
[S14] round=34 local utility u=0.001403 metrics={'f1_val': 0.9980403583402068, 'auprc': 0.999049385003046, 'loss_val': 0.0224397567514705, 'psi': 0.9984439690053425}-{'f1_val': 0.997240356705793, 'auprc': 0.9990435402997191, 'loss_val': 0.02042724337451264, 'psi': 0.9979616301433635}
[S15] START round=34 head_norm_before_train=1.095360 cos_to_last_merge=1.0000 (last merge round=33)
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.9858060960196455, 'auprc': 0.9915142272062774, 'loss_val': 0.16291217064780011, 'psi': 0.9880893484942983}-{'f1_val': 0.9957757960160583, 'auprc': 0.9909936888782163, 'loss_val': 0.14394938811379576, 'psi': 0.9938629531609215}
[S16] START round=34 head_norm_before_train=1.521590 cos_to_last_merge=0.9999 (last merge round=32)
[S16] round=34 local utility u=0.348239 metrics={'f1_val': 0.9221131405734573, 'auprc': 0.9906050683440737, 'loss_val': 0.33559805536040543, 'psi': 0.9495099116817038}-{'f1_val': 0.8552824129199832, 'auprc': 0.9850806781953358, 'loss_val': 0.6145184784349161, 'psi': 0.9072017190301243}
[S17] START round=34 head_norm_before_train=1.703217 cos_to_last_merge=0.7635 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.764
[S17] round=34 local utility u=0.000000 metrics={'f1_val': 0.6178271466723961, 'auprc': 0.8506639037660144, 'loss_val': 0.9936233413130396, 'psi': 0.7109618495098435}-{'f1_val': 0.6139359302101302, 'auprc': 0.9352717389468709, 'loss_val': 1.1024259598897355, 'psi': 0.7424702537048264}
[S8]  timeout peer S2
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S2]  timeout peer S3
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S11
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S16
[S10]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S15
[S6]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S16
[S7]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:57009
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:57010
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S2] → sending delta(kind=head bytes=1792) to S4@127.0.0.1:57004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:57007
[S13] not sending this round → trigger blocked (psi=0.646)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:57005
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:57007
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.996)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:57008
[S10] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1792 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1805 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1803) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.160250)
[S7] loaded HEAD from S10 (vec_in norm=1.160250)
[S7] cosine check vs S10: cos=0.9429
[S7] BUFFERED delta from S10 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1805) from S3
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.576973)
[S8] loaded HEAD from S3 (vec_in norm=1.576973)
[S8] cosine check vs S3: cos=0.9481
[S8] BUFFERED delta from S3 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1803) from S9
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.997842)
[S5] loaded HEAD from S9 (vec_in norm=1.997842)
[S5] cosine check vs S9: cos=0.9993
[S5] BUFFERED delta from S9 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1797) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.545539)
[S6] loaded HEAD from S16 (vec_in norm=1.545539)
[S6] cosine check vs S16: cos=0.9182
[S6] BUFFERED delta from S16 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1798) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.992411)
[S9] loaded HEAD from S5 (vec_in norm=1.992411)
[S9] cosine check vs S5: cos=0.9993
[S9] BUFFERED delta from S5 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1801) from S8
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.363197)
[S6] loaded HEAD from S8 (vec_in norm=1.363197)
[S6] cosine check vs S8: cos=0.7514
[S6] BUFFERED delta from S8 (total buffered=2)
[S4] RECEIVED delta(kind=head bytes=1792) from S2
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.997140)
[S4] loaded HEAD from S2 (vec_in norm=1.997140)
[S4] cosine check vs S2: cos=0.9993
[S4] BUFFERED delta from S2 (total buffered=1)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=34 metric=0.9963 head_norm=1.997842
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.641332e-02
[S9] stored merged vector for next round verification (round=34)
[S9] DEBUG after merge:  round=34 metric=0.9963 head_norm=1.994796 delta_norm=0.036413
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=34 metric=0.9975 head_norm=1.992411
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.641332e-02
[S5] stored merged vector for next round verification (round=34)
[S5] DEBUG after merge:  round=34 metric=0.9975 head_norm=1.994796 delta_norm=0.036413
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=34 metric=0.9946 head_norm=1.363197
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.592707e-01
[S8] stored merged vector for next round verification (round=34)
[S8] DEBUG after merge:  round=34 metric=0.9950 head_norm=1.450984 delta_norm=0.259271
[S8] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=34 metric=0.5264 head_norm=1.107444
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.933109e-01
[S7] stored merged vector for next round verification (round=34)
[S7] DEBUG after merge:  round=34 metric=0.5370 head_norm=1.117559 delta_norm=0.193311
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=34 metric=0.7203 head_norm=1.282871
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.286261e-01
[S6] stored merged vector for next round verification (round=34)
[S6] DEBUG after merge:  round=34 metric=0.7227 head_norm=1.258518 delta_norm=0.128626
[S6] aggregate: ACCEPT kept=['S16', 'S8'] (k=2/2) mode=median trim_p=0.1
[S15] CommDone barrier timeout: have=2 need=3 — continuing
[S2] START round=35 head_norm_before_train=1.997140 cos_to_last_merge=0.9999 (last merge round=32)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.7100393005050238, 'auprc': 0.9958658725758016, 'loss_val': 0.39328483651327734, 'psi': 0.824369929333335}-{'f1_val': 0.8267096084033485, 'auprc': 0.9244973359824215, 'loss_val': 0.34847897900962094, 'psi': 0.8658246994349776}
[S3] START round=35 head_norm_before_train=1.576973 cos_to_last_merge=0.9707 (last merge round=26)
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.927272488189634, 'auprc': 0.9783918084876981, 'loss_val': 0.1931330723900315, 'psi': 0.9477202163088596}-{'f1_val': 0.9962367436152, 'auprc': 0.9979056486840413, 'loss_val': 0.0645170906864479, 'psi': 0.9969043056427365}
[S4] START round=35 head_norm_before_train=1.966722 cos_to_last_merge=0.9997 (last merge round=31)
[S4] round=35 local utility u=0.092117 metrics={'f1_val': 0.9486046521497139, 'auprc': 0.9629334694789258, 'loss_val': 0.2860820997826264, 'psi': 0.9543361790813987}-{'f1_val': 0.9388131372568042, 'auprc': 0.9285566337012141, 'loss_val': 0.3084369551284279, 'psi': 0.9347105358345681}
[S5] START round=35 head_norm_before_train=1.994796 cos_to_last_merge=1.0000 (last merge round=34)
[S5] round=35 local utility u=0.000000 metrics={'f1_val': 0.7008676007203419, 'auprc': 0.9895843774532564, 'loss_val': 0.3475141958636185, 'psi': 0.8163543114135077}-{'f1_val': 0.9975086222760589, 'auprc': 0.994364581893973, 'loss_val': 0.04495378185282905, 'psi': 0.9962510061232245}
[S6] START round=35 head_norm_before_train=1.258518 cos_to_last_merge=1.0000 (last merge round=34)
[S6] round=35 local utility u=0.556635 metrics={'f1_val': 0.8315747504529473, 'auprc': 0.9536568590727698, 'loss_val': 0.41707561776692004, 'psi': 0.8804075939008762}-{'f1_val': 0.7202659178876344, 'auprc': 0.852638980899019, 'loss_val': 0.5594384767278289, 'psi': 0.7732151430921883}
[S7] START round=35 head_norm_before_train=1.117559 cos_to_last_merge=1.0000 (last merge round=34)
[S7] round=35 local utility u=0.261490 metrics={'f1_val': 0.589617144848851, 'auprc': 0.8005614430572244, 'loss_val': 0.7297486799068189, 'psi': 0.6739948641322003}-{'f1_val': 0.5264045597083689, 'auprc': 0.7935814504726274, 'loss_val': 0.8525136737822566, 'psi': 0.6332753160140723}
[S8] START round=35 head_norm_before_train=1.450984 cos_to_last_merge=1.0000 (last merge round=34)
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.9947868618408977, 'auprc': 0.9947976008297287, 'loss_val': 0.16671791382181872, 'psi': 0.9947911574364301}-{'f1_val': 0.9946459649293765, 'auprc': 0.99624958683637, 'loss_val': 0.15262066154437068, 'psi': 0.9952874136921739}
[S9] START round=35 head_norm_before_train=1.994796 cos_to_last_merge=1.0000 (last merge round=34)
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9945093777545679, 'loss_val': 0.03370376605053151, 'psi': 0.9955538079693937}-{'f1_val': 0.9962748907591257, 'auprc': 0.9984573463122738, 'loss_val': 0.0330908552183128, 'psi': 0.9971478729803849}
[S10] START round=35 head_norm_before_train=1.160250 cos_to_last_merge=0.9864 (last merge round=30)
[S10] round=35 local utility u=0.012376 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9962622218938622, 'loss_val': 0.12847372633871076, 'psi': 0.9956175921691697}-{'f1_val': 0.9951878390193748, 'auprc': 0.9966432546737973, 'loss_val': 0.15436982309127342, 'psi': 0.9957700052811438}
[S11] START round=35 head_norm_before_train=2.046481 (no previous merge yet)
[S11] round=35 local utility u=0.000000 metrics={'f1_val': 0.9015520392561764, 'auprc': 0.9935307641671048, 'loss_val': 0.12805788459983183, 'psi': 0.9383435292205478}-{'f1_val': 0.9961541414107454, 'auprc': 0.9954450734429676, 'loss_val': 0.02926522774885874, 'psi': 0.9958705142236343}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=35 head_norm_before_train=1.449316 cos_to_last_merge=0.8219 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.822
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.5542753155036815, 'auprc': 0.6974475826502905, 'loss_val': 0.864564725467867, 'psi': 0.6115442223623251}-{'f1_val': 0.6162932268678826, 'auprc': 0.6904897868065623, 'loss_val': 0.676287695956562, 'psi': 0.6459718508433544}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=35 head_norm_before_train=2.055158 (no previous merge yet)
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.9944498401657405, 'auprc': 0.9986499592722775, 'loss_val': 0.045977918974963006, 'psi': 0.9961298878083552}-{'f1_val': 0.9980403583402068, 'auprc': 0.999049385003046, 'loss_val': 0.0224397567514705, 'psi': 0.9984439690053425}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=35 head_norm_before_train=1.132268 cos_to_last_merge=0.9995 (last merge round=33)
[S15] round=35 local utility u=0.000000 metrics={'f1_val': 0.7689825981453721, 'auprc': 0.888367026293587, 'loss_val': 0.3726172594484371, 'psi': 0.8167363694046581}-{'f1_val': 0.9858060960196455, 'auprc': 0.9915142272062774, 'loss_val': 0.16291217064780011, 'psi': 0.9880893484942983}
[S16] START round=35 head_norm_before_train=1.545539 cos_to_last_merge=0.9997 (last merge round=32)
[S16] round=35 local utility u=0.213060 metrics={'f1_val': 0.9564290833722764, 'auprc': 0.9947944421885812, 'loss_val': 0.12794153011617437, 'psi': 0.9717752268987984}-{'f1_val': 0.9221131405734573, 'auprc': 0.9906050683440737, 'loss_val': 0.33559805536040543, 'psi': 0.9495099116817038}
[S17] START round=35 head_norm_before_train=1.711221 cos_to_last_merge=0.7631 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.763
[S17] round=35 local utility u=0.000000 metrics={'f1_val': 0.5286505886874653, 'auprc': 0.7026953556644807, 'loss_val': 1.347710305228229, 'psi': 0.5982684954782715}-{'f1_val': 0.6178271466723961, 'auprc': 0.8506639037660144, 'loss_val': 0.9936233413130396, 'psi': 0.7109618495098435}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:57002
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S2] ⇄ pheromone p=0.094 → S4@127.0.0.1:57004
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] ⇄ pheromone p=0.157 → S9@127.0.0.1:57010
[S9] ⇄ pheromone p=0.010 → S5@127.0.0.1:57005
[S2] RECEIVED delta(kind=head bytes=1798) from S4
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.969517)
[S2] loaded HEAD from S4 (vec_in norm=1.969517)
[S2] cosine check vs S4: cos=0.9989
[S2] BUFFERED delta from S4 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1800) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.568107)
[S6] loaded HEAD from S16 (vec_in norm=1.568107)
[S6] cosine check vs S16: cos=0.9039
[S6] BUFFERED delta from S16 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:57016
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=35 metric=0.9486 head_norm=1.969517
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.364932e-02
[S4] stored merged vector for next round verification (round=35)
[S4] DEBUG after merge:  round=35 metric=0.9486 head_norm=1.982896 delta_norm=0.043649
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.034 → S2@127.0.0.1:57002
[S16] ⇄ pheromone p=0.228 → S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] → sending delta(kind=head bytes=1805) to S15@127.0.0.1:57015
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1805 to 1 peers)
[S6] sending update (kind=head size=1805 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1805) from S7
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.135165)
[S15] loaded HEAD from S7 (vec_in norm=1.135165)
[S15] cosine check vs S7: cos=0.9603
[S15] BUFFERED delta from S7 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1805) from S6
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.293138)
[S16] loaded HEAD from S6 (vec_in norm=1.293138)
[S16] cosine check vs S6: cos=0.9039
[S16] BUFFERED delta from S6 (total buffered=1)
[S8] ⇄ pheromone p=0.052 → S6@127.0.0.1:57007
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=35 metric=0.8316 head_norm=1.293138
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.411506e-01
[S6] stored merged vector for next round verification (round=35)
[S6] DEBUG after merge:  round=35 metric=0.8336 head_norm=1.396137 delta_norm=0.341151
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.299 → S16@127.0.0.1:57016
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S10] → sending delta(kind=head bytes=1808) to S7@127.0.0.1:57008
[S10] sending update (kind=head size=1808 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1808) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.206053)
[S7] loaded HEAD from S10 (vec_in norm=1.206053)
[S7] cosine check vs S10: cos=0.9801
[S7] BUFFERED delta from S10 (total buffered=1)
[S3] ⇄ pheromone p=0.169 → S8@127.0.0.1:57009
[S3]  timeout peer S8
[S3]  timeout peer S9
[S8]  timeout peer S6
[S8]  timeout peer S17
[S7]  timeout peer S10
[S7]  timeout peer S11
[S6]  timeout peer S14
[S10]  timeout peer S2
[S10]  timeout peer S15
[S15]  timeout peer S3
[S15]  timeout peer S7
[S15]  timeout peer S13
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=35 metric=0.5896 head_norm=1.135165
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.220339e-01
[S7] stored merged vector for next round verification (round=35)
[S7] DEBUG after merge:  round=35 metric=0.5980 head_norm=1.164770 delta_norm=0.122034
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=35 metric=0.7690 head_norm=1.167037
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.629727e-01
[S15] stored merged vector for next round verification (round=35)
[S15] DEBUG after merge:  round=35 metric=0.7671 head_norm=1.139617 delta_norm=0.162973
[S15] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=36 head_norm_before_train=2.010500 cos_to_last_merge=0.9997 (last merge round=32)
[S2] round=36 local utility u=0.132371 metrics={'f1_val': 0.8237401907377486, 'auprc': 0.8530844028276933, 'loss_val': 0.3824047141600979, 'psi': 0.8354778755737264}-{'f1_val': 0.7100393005050238, 'auprc': 0.9958658725758016, 'loss_val': 0.39328483651327734, 'psi': 0.824369929333335}
[S3] START round=36 head_norm_before_train=1.592770 cos_to_last_merge=0.9680 (last merge round=26)
[S3] round=36 local utility u=0.187161 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.999393020773956, 'loss_val': 0.0843910187138191, 'psi': 0.9763783589728485}-{'f1_val': 0.927272488189634, 'auprc': 0.9783918084876981, 'loss_val': 0.1931330723900315, 'psi': 0.9477202163088596}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=36 head_norm_before_train=1.982896 cos_to_last_merge=1.0000 (last merge round=35)
[S4] round=36 local utility u=0.000000 metrics={'f1_val': 0.9462855258296111, 'auprc': 0.944937005948883, 'loss_val': 0.29108375727835434, 'psi': 0.9457461178773199}-{'f1_val': 0.9486046521497139, 'auprc': 0.9629334694789258, 'loss_val': 0.2860820997826264, 'psi': 0.9543361790813987}
[S5] START round=36 head_norm_before_train=1.999747 cos_to_last_merge=1.0000 (last merge round=34)
[S5] round=36 local utility u=1.000000 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9906118210575385, 'loss_val': 0.04326063703223392, 'psi': 0.994486463589654}-{'f1_val': 0.7008676007203419, 'auprc': 0.9895843774532564, 'loss_val': 0.3475141958636185, 'psi': 0.8163543114135077}
[S6] START round=36 head_norm_before_train=1.396137 cos_to_last_merge=1.0000 (last merge round=35)
[S6] round=36 local utility u=0.049553 metrics={'f1_val': 0.8376452707329001, 'auprc': 0.9570353687683157, 'loss_val': 0.3645284024557842, 'psi': 0.8854013099470663}-{'f1_val': 0.8315747504529473, 'auprc': 0.9536568590727698, 'loss_val': 0.41707561776692004, 'psi': 0.8804075939008762}
[S7] START round=36 head_norm_before_train=1.164770 cos_to_last_merge=1.0000 (last merge round=35)
[S7] round=36 local utility u=1.000000 metrics={'f1_val': 0.7709418464085364, 'auprc': 0.9978384441782322, 'loss_val': 0.3016140207699122, 'psi': 0.8617004855164148}-{'f1_val': 0.589617144848851, 'auprc': 0.8005614430572244, 'loss_val': 0.7297486799068189, 'psi': 0.6739948641322003}
[S8] START round=36 head_norm_before_train=1.476342 cos_to_last_merge=0.9992 (last merge round=34)
[S8] round=36 local utility u=0.017552 metrics={'f1_val': 0.994639564840761, 'auprc': 0.9950979186756432, 'loss_val': 0.13163031619813378, 'psi': 0.9948229063747138}-{'f1_val': 0.9947868618408977, 'auprc': 0.9947976008297287, 'loss_val': 0.16671791382181872, 'psi': 0.9947911574364301}
[S9] START round=36 head_norm_before_train=2.008897 cos_to_last_merge=0.9999 (last merge round=34)
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.9893026945281196, 'auprc': 0.9984564873347738, 'loss_val': 0.05065156203732444, 'psi': 0.9929642116507813}-{'f1_val': 0.9962500947792776, 'auprc': 0.9945093777545679, 'loss_val': 0.03370376605053151, 'psi': 0.9955538079693937}
[S10] START round=36 head_norm_before_train=1.206053 cos_to_last_merge=0.9807 (last merge round=30)
[S10] round=36 local utility u=0.005837 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9945691133948924, 'loss_val': 0.11171962806434962, 'psi': 0.9949403487695818}-{'f1_val': 0.9951878390193748, 'auprc': 0.9962622218938622, 'loss_val': 0.12847372633871076, 'psi': 0.9956175921691697}
[S11] START round=36 head_norm_before_train=2.056415 (no previous merge yet)
[S11] round=36 local utility u=0.329531 metrics={'f1_val': 0.9964166473406741, 'auprc': 0.9938010899153626, 'loss_val': 0.038995207564904225, 'psi': 0.9953704243705496}-{'f1_val': 0.9015520392561764, 'auprc': 0.9935307641671048, 'loss_val': 0.12805788459983183, 'psi': 0.9383435292205478}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=36 head_norm_before_train=1.456635 cos_to_last_merge=0.8209 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.821
[S13] round=36 local utility u=0.223292 metrics={'f1_val': 0.6008163684165553, 'auprc': 0.6954539329250243, 'loss_val': 0.6912459880323895, 'psi': 0.6386713942199429}-{'f1_val': 0.5542753155036815, 'auprc': 0.6974475826502905, 'loss_val': 0.864564725467867, 'psi': 0.6115442223623251}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=36 head_norm_before_train=2.063840 (no previous merge yet)
[S14] round=36 local utility u=0.008684 metrics={'f1_val': 0.9947363892425176, 'auprc': 0.9990118531795729, 'loss_val': 0.03141442692379495, 'psi': 0.9964465748173397}-{'f1_val': 0.9944498401657405, 'auprc': 0.9986499592722775, 'loss_val': 0.045977918974963006, 'psi': 0.9961298878083552}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=36 head_norm_before_train=1.139617 cos_to_last_merge=1.0000 (last merge round=35)
[S15] round=36 local utility u=0.662986 metrics={'f1_val': 0.9098219391438533, 'auprc': 0.9932336364993782, 'loss_val': 0.20628022402606208, 'psi': 0.9431866180860633}-{'f1_val': 0.7689825981453721, 'auprc': 0.888367026293587, 'loss_val': 0.3726172594484371, 'psi': 0.8167363694046581}
[S16] START round=36 head_norm_before_train=1.568107 cos_to_last_merge=0.9993 (last merge round=32)
[S16] round=36 local utility u=0.127221 metrics={'f1_val': 0.9889050808317095, 'auprc': 0.9943406486908366, 'loss_val': 0.06699344113991246, 'psi': 0.9910793079753604}-{'f1_val': 0.9564290833722764, 'auprc': 0.9947944421885812, 'loss_val': 0.12794153011617437, 'psi': 0.9717752268987984}
[S17] START round=36 head_norm_before_train=1.719596 cos_to_last_merge=0.7628 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.763
[S17] round=36 local utility u=0.685614 metrics={'f1_val': 0.6274248112743034, 'auprc': 0.8652234305954084, 'loss_val': 1.056711613608502, 'psi': 0.7225442590027453}-{'f1_val': 0.5286505886874653, 'auprc': 0.7026953556644807, 'loss_val': 1.347710305228229, 'psi': 0.5982684954782715}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:57003
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S7] sending update (kind=head size=1807 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:57004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:57010
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:57016
[S3] RECEIVED delta(kind=head bytes=1803) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.505043)
[S3] loaded HEAD from S8 (vec_in norm=1.505043)
[S3] cosine check vs S8: cos=0.9767
[S3] BUFFERED delta from S8 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1797) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.590476)
[S6] loaded HEAD from S16 (vec_in norm=1.590476)
[S6] cosine check vs S16: cos=0.9792
[S6] BUFFERED delta from S16 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1798) from S2
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=2.021845)
[S4] loaded HEAD from S2 (vec_in norm=2.021845)
[S4] cosine check vs S2: cos=0.9994
[S4] BUFFERED delta from S2 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1803) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=2.001127)
[S9] loaded HEAD from S5 (vec_in norm=2.001127)
[S9] cosine check vs S5: cos=0.9997
[S9] BUFFERED delta from S5 (total buffered=1)
[S6] sending update (kind=head size=1805 to 1 peers)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=36 metric=0.8237 head_norm=2.021845
[S2] _apply_head_vector_avg (torch): Δ‖w‖=5.711087e-02
[S2] stored merged vector for next round verification (round=36)
[S2] DEBUG after merge:  round=36 metric=0.8238 head_norm=1.995036 delta_norm=0.057111
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=36 metric=0.9889 head_norm=1.590476
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.492486e-01
[S16] stored merged vector for next round verification (round=36)
[S16] DEBUG after merge:  round=36 metric=0.9896 head_norm=1.406747 delta_norm=0.349249
[S16] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S16] RECEIVED delta(kind=head bytes=1805) from S6
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.425020)
[S16] loaded HEAD from S6 (vec_in norm=1.425020)
[S16] cosine check vs S6: cos=0.9997
[S16] BUFFERED delta from S6 (total buffered=1)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=36 metric=0.8376 head_norm=1.425020
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.745606e-01
[S6] stored merged vector for next round verification (round=36)
[S6] DEBUG after merge:  round=36 metric=0.8386 head_norm=1.499892 delta_norm=0.174561
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=37 head_norm_before_train=1.995036 cos_to_last_merge=1.0000 (last merge round=36)
[S2] round=37 local utility u=0.000000 metrics={'f1_val': 0.815949424397223, 'auprc': 0.8125721894915632, 'loss_val': 0.4068503601798316, 'psi': 0.814598530434959}-{'f1_val': 0.8237401907377486, 'auprc': 0.8530844028276933, 'loss_val': 0.3824047141600979, 'psi': 0.8354778755737264}
[S3] START round=37 head_norm_before_train=1.609697 cos_to_last_merge=0.9657 (last merge round=26)
[S3] round=37 local utility u=0.074372 metrics={'f1_val': 0.9820710975803975, 'auprc': 0.9990175479979879, 'loss_val': 0.060735021105346544, 'psi': 0.9888496777474336}-{'f1_val': 0.9610352511054436, 'auprc': 0.999393020773956, 'loss_val': 0.0843910187138191, 'psi': 0.9763783589728485}
[S3] not sending this round → trigger blocked (psi=0.989)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=37 metric=0.9821 head_norm=1.631737
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.814681e-01
[S3] stored merged vector for next round verification (round=37)
[S3] DEBUG after merge:  round=37 metric=0.9821 head_norm=1.559144 delta_norm=0.181468
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S4] START round=37 head_norm_before_train=1.986166 cos_to_last_merge=1.0000 (last merge round=35)
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.9425501663658545, 'auprc': 0.9418757536126223, 'loss_val': 0.292658749760671, 'psi': 0.9422804012645617}-{'f1_val': 0.9462855258296111, 'auprc': 0.944937005948883, 'loss_val': 0.29108375727835434, 'psi': 0.9457461178773199}
[S5] START round=37 head_norm_before_train=2.001127 cos_to_last_merge=1.0000 (last merge round=34)
[S5] round=37 local utility u=0.006141 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9933828059378121, 'loss_val': 0.03708539163581196, 'psi': 0.9953743034621995}-{'f1_val': 0.9970695586110643, 'auprc': 0.9906118210575385, 'loss_val': 0.04326063703223392, 'psi': 0.994486463589654}
[S6] START round=37 head_norm_before_train=1.499892 cos_to_last_merge=1.0000 (last merge round=36)
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.7614076778842968, 'auprc': 0.8199211483220943, 'loss_val': 0.5228731518866614, 'psi': 0.7848130660594157}-{'f1_val': 0.8376452707329001, 'auprc': 0.9570353687683157, 'loss_val': 0.3645284024557842, 'psi': 0.8854013099470663}
[S7] START round=37 head_norm_before_train=1.178211 cos_to_last_merge=0.9998 (last merge round=35)
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.5839251312311822, 'auprc': 0.8030177957064698, 'loss_val': 0.7040956661376869, 'psi': 0.6715621970212973}-{'f1_val': 0.7709418464085364, 'auprc': 0.9978384441782322, 'loss_val': 0.3016140207699122, 'psi': 0.8617004855164148}
[S8] START round=37 head_norm_before_train=1.505043 cos_to_last_merge=0.9970 (last merge round=34)
[S8] round=37 local utility u=0.013644 metrics={'f1_val': 0.9936910743895857, 'auprc': 0.9961018542657452, 'loss_val': 0.10166322945582178, 'psi': 0.9946553863400495}-{'f1_val': 0.994639564840761, 'auprc': 0.9950979186756432, 'loss_val': 0.13163031619813378, 'psi': 0.9948229063747138}
[S9] START round=37 head_norm_before_train=2.018392 cos_to_last_merge=0.9998 (last merge round=34)
[S9] round=37 local utility u=0.029283 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9975096302986022, 'loss_val': 0.03092845485041071, 'psi': 0.9967539089870074}-{'f1_val': 0.9893026945281196, 'auprc': 0.9984564873347738, 'loss_val': 0.05065156203732444, 'psi': 0.9929642116507813}
[S10] START round=37 head_norm_before_train=1.249255 cos_to_last_merge=0.9751 (last merge round=30)
[S10] round=37 local utility u=0.009921 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9957392309974132, 'loss_val': 0.0953875078419104, 'psi': 0.9954083958105902}-{'f1_val': 0.9951878390193748, 'auprc': 0.9945691133948924, 'loss_val': 0.11171962806434962, 'psi': 0.9949403487695818}
[S11] START round=37 head_norm_before_train=2.068926 (no previous merge yet)
[S11] round=37 local utility u=0.008750 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9956456425159703, 'loss_val': 0.025453090998824604, 'psi': 0.9959507418528354}-{'f1_val': 0.9964166473406741, 'auprc': 0.9938010899153626, 'loss_val': 0.038995207564904225, 'psi': 0.9953704243705496}
[S11] not sending this round → trigger blocked (psi=0.996)
[S13] START round=37 head_norm_before_train=1.464241 cos_to_last_merge=0.8193 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.819
[S13] round=37 local utility u=0.000000 metrics={'f1_val': 0.569800562272531, 'auprc': 0.7099171587393349, 'loss_val': 0.9094647213910823, 'psi': 0.6258472008592526}-{'f1_val': 0.6008163684165553, 'auprc': 0.6954539329250243, 'loss_val': 0.6912459880323895, 'psi': 0.6386713942199429}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=37 head_norm_before_train=2.073733 (no previous merge yet)
[S14] round=37 local utility u=0.014049 metrics={'f1_val': 0.9978217593544257, 'auprc': 0.9988486126400392, 'loss_val': 0.02133892918555431, 'psi': 0.9982325006686711}-{'f1_val': 0.9947363892425176, 'auprc': 0.9990118531795729, 'loss_val': 0.03141442692379495, 'psi': 0.9964465748173397}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=37 head_norm_before_train=1.169734 cos_to_last_merge=0.9996 (last merge round=35)
[S15] round=37 local utility u=0.000000 metrics={'f1_val': 0.704497420441336, 'auprc': 0.8587337103610747, 'loss_val': 0.40418651307737347, 'psi': 0.7661919364092316}-{'f1_val': 0.9098219391438533, 'auprc': 0.9932336364993782, 'loss_val': 0.20628022402606208, 'psi': 0.9431866180860633}
[S16] START round=37 head_norm_before_train=1.406747 cos_to_last_merge=1.0000 (last merge round=36)
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.949704043892208, 'auprc': 0.9951189744600353, 'loss_val': 0.14682985281819627, 'psi': 0.9678700161193389}-{'f1_val': 0.9889050808317095, 'auprc': 0.9943406486908366, 'loss_val': 0.06699344113991246, 'psi': 0.9910793079753604}
[S17] START round=37 head_norm_before_train=1.730443 cos_to_last_merge=0.7623 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.762
[S17] round=37 local utility u=0.049962 metrics={'f1_val': 0.6275355205877825, 'auprc': 0.921716695270352, 'loss_val': 1.1269312312062554, 'psi': 0.7452079904608103}-{'f1_val': 0.6274248112743034, 'auprc': 0.8652234305954084, 'loss_val': 1.056711613608502, 'psi': 0.7225442590027453}
[S17] not sending this round → trigger blocked (psi=0.745)
[S10] not sending this round → trigger blocked (psi=0.995)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:57005
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.995)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.995)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=37 metric=0.9426 head_norm=1.987356
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.336677e-02
[S4] stored merged vector for next round verification (round=37)
[S4] DEBUG after merge:  round=37 metric=0.9426 head_norm=2.004206 delta_norm=0.043367
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S9] sending update (kind=head size=1803 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=37 metric=0.9497 head_norm=1.431617
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.206019e-02
[S16] stored merged vector for next round verification (round=37)
[S16] DEBUG after merge:  round=37 metric=0.9499 head_norm=1.428152 delta_norm=0.022060
[S16] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S5] RECEIVED delta(kind=head bytes=1803) from S9
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=2.030771)
[S5] loaded HEAD from S9 (vec_in norm=2.030771)
[S5] cosine check vs S9: cos=0.9994
[S5] BUFFERED delta from S9 (total buffered=1)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=37 metric=0.9963 head_norm=2.030771
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.417595e-02
[S9] stored merged vector for next round verification (round=37)
[S9] DEBUG after merge:  round=37 metric=0.9963 head_norm=2.015714 delta_norm=0.034176
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=38 head_norm_before_train=2.007018 cos_to_last_merge=1.0000 (last merge round=36)
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.7159938022078014, 'auprc': 0.9911781436361689, 'loss_val': 0.3991581168072702, 'psi': 0.8260675387791483}-{'f1_val': 0.815949424397223, 'auprc': 0.8125721894915632, 'loss_val': 0.4068503601798316, 'psi': 0.814598530434959}
[S3] START round=38 head_norm_before_train=1.559144 cos_to_last_merge=1.0000 (last merge round=37)
[S3] round=38 local utility u=0.047716 metrics={'f1_val': 0.9973386888198309, 'auprc': 0.9986196015820727, 'loss_val': 0.05571504402076039, 'psi': 0.9978510539247276}-{'f1_val': 0.9820710975803975, 'auprc': 0.9990175479979879, 'loss_val': 0.060735021105346544, 'psi': 0.9888496777474336}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=38 head_norm_before_train=2.004206 cos_to_last_merge=1.0000 (last merge round=37)
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.9403780163290791, 'auprc': 0.9323225830217357, 'loss_val': 0.3097167079051948, 'psi': 0.9371558430061417}-{'f1_val': 0.9425501663658545, 'auprc': 0.9418757536126223, 'loss_val': 0.292658749760671, 'psi': 0.9422804012645617}
[S5] START round=38 head_norm_before_train=2.004659 cos_to_last_merge=0.9999 (last merge round=34)
[S5] round=38 local utility u=0.010657 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9984059879965463, 'loss_val': 0.033046170812243744, 'psi': 0.9976041303652572}-{'f1_val': 0.9967019684784577, 'auprc': 0.9933828059378121, 'loss_val': 0.03708539163581196, 'psi': 0.9953743034621995}
[S6] START round=38 head_norm_before_train=1.525325 cos_to_last_merge=0.9998 (last merge round=36)
[S6] round=38 local utility u=0.439641 metrics={'f1_val': 0.8345321389931701, 'auprc': 0.9300220109038372, 'loss_val': 0.41264093975795335, 'psi': 0.872728087757437}-{'f1_val': 0.7614076778842968, 'auprc': 0.8199211483220943, 'loss_val': 0.5228731518866614, 'psi': 0.7848130660594157}
[S7] START round=38 head_norm_before_train=1.191995 cos_to_last_merge=0.9991 (last merge round=35)
[S7] round=38 local utility u=0.041176 metrics={'f1_val': 0.5914998052745962, 'auprc': 0.8026231653057466, 'loss_val': 0.6660077642355156, 'psi': 0.6759491492870564}-{'f1_val': 0.5839251312311822, 'auprc': 0.8030177957064698, 'loss_val': 0.7040956661376869, 'psi': 0.6715621970212973}
[S8] START round=38 head_norm_before_train=1.534154 cos_to_last_merge=0.9939 (last merge round=34)
[S8] round=38 local utility u=0.009737 metrics={'f1_val': 0.9942788405856967, 'auprc': 0.9957981371812371, 'loss_val': 0.08480508639345528, 'psi': 0.9948865592239129}-{'f1_val': 0.9936910743895857, 'auprc': 0.9961018542657452, 'loss_val': 0.10166322945582178, 'psi': 0.9946553863400495}
[S9] START round=38 head_norm_before_train=2.015714 cos_to_last_merge=1.0000 (last merge round=37)
[S9] round=38 local utility u=0.000000 metrics={'f1_val': 0.9918149940667227, 'auprc': 0.9982974912834288, 'loss_val': 0.043176610682427265, 'psi': 0.9944079929534051}-{'f1_val': 0.9962500947792776, 'auprc': 0.9975096302986022, 'loss_val': 0.03092845485041071, 'psi': 0.9967539089870074}
[S10] START round=38 head_norm_before_train=1.286736 cos_to_last_merge=0.9701 (last merge round=30)
[S10] round=38 local utility u=0.006684 metrics={'f1_val': 0.9950955042232223, 'auprc': 0.9958089946275435, 'loss_val': 0.0816738424634227, 'psi': 0.9953809003849508}-{'f1_val': 0.9951878390193748, 'auprc': 0.9957392309974132, 'loss_val': 0.0953875078419104, 'psi': 0.9954083958105902}
[S11] START round=38 head_norm_before_train=2.082826 (no previous merge yet)
[S11] round=38 local utility u=0.000789 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.995797879424551, 'loss_val': 0.024331406833282866, 'psi': 0.9960116366162677}-{'f1_val': 0.9961541414107454, 'auprc': 0.9956456425159703, 'loss_val': 0.025453090998824604, 'psi': 0.9959507418528354}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=38 head_norm_before_train=1.470915 cos_to_last_merge=0.8171 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.817
[S13] round=38 local utility u=0.229172 metrics={'f1_val': 0.6022144713451867, 'auprc': 0.698241856973304, 'loss_val': 0.6105779840170804, 'psi': 0.6406254255964337}-{'f1_val': 0.569800562272531, 'auprc': 0.7099171587393349, 'loss_val': 0.9094647213910823, 'psi': 0.6258472008592526}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S13] sending update (kind=head size=1809 to 1 peers)
[S14] START round=38 head_norm_before_train=2.083345 (no previous merge yet)
[S14] round=38 local utility u=0.000450 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9988959092211956, 'loss_val': 0.018117216285759366, 'psi': 0.9980049602491752}-{'f1_val': 0.9978217593544257, 'auprc': 0.9988486126400392, 'loss_val': 0.02133892918555431, 'psi': 0.9982325006686711}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] START round=38 head_norm_before_train=1.198928 cos_to_last_merge=0.9986 (last merge round=35)
[S15] round=38 local utility u=1.000000 metrics={'f1_val': 0.9913903387854143, 'auprc': 0.9987026426042537, 'loss_val': 0.11962511269251316, 'psi': 0.9943152603129501}-{'f1_val': 0.704497420441336, 'auprc': 0.8587337103610747, 'loss_val': 0.40418651307737347, 'psi': 0.7661919364092316}
[S16] START round=38 head_norm_before_train=1.428152 cos_to_last_merge=1.0000 (last merge round=37)
[S16] round=38 local utility u=0.000000 metrics={'f1_val': 0.8431083577197875, 'auprc': 0.9865115523169101, 'loss_val': 0.7482299504889811, 'psi': 0.9004696355586366}-{'f1_val': 0.949704043892208, 'auprc': 0.9951189744600353, 'loss_val': 0.14682985281819627, 'psi': 0.9678700161193389}
[S17] START round=38 head_norm_before_train=1.741774 cos_to_last_merge=0.7617 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.762
[S17] round=38 local utility u=0.054640 metrics={'f1_val': 0.6413132449582437, 'auprc': 0.8843014625859995, 'loss_val': 0.9880725846298912, 'psi': 0.7385085320093461}-{'f1_val': 0.6275355205877825, 'auprc': 0.921716695270352, 'loss_val': 1.1269312312062554, 'psi': 0.7452079904608103}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S8] → sending delta(kind=head bytes=1807) to S3@127.0.0.1:57003
[S8] sending update (kind=head size=1807 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:57016
[S9] RECEIVED delta(kind=head bytes=1803) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=2.012331)
[S9] loaded HEAD from S5 (vec_in norm=2.012331)
[S9] cosine check vs S5: cos=0.9993
[S9] BUFFERED delta from S5 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1807) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.564559)
[S3] loaded HEAD from S8 (vec_in norm=1.564559)
[S3] cosine check vs S8: cos=0.9856
[S3] BUFFERED delta from S8 (total buffered=1)
[S6] sending update (kind=head size=1801 to 1 peers)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=38 metric=0.9971 head_norm=2.012331
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.330123e-02
[S5] stored merged vector for next round verification (round=38)
[S5] DEBUG after merge:  round=38 metric=0.9971 head_norm=2.021108 delta_norm=0.043301
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S16] RECEIVED delta(kind=head bytes=1801) from S6
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.545881)
[S16] loaded HEAD from S6 (vec_in norm=1.545881)
[S16] cosine check vs S6: cos=0.9953
[S16] BUFFERED delta from S6 (total buffered=1)
[S2] START round=39 head_norm_before_train=2.018565 cos_to_last_merge=0.9999 (last merge round=36)
[S2] round=39 local utility u=0.118073 metrics={'f1_val': 0.8273844589029373, 'auprc': 0.8360489200189908, 'loss_val': 0.36596917955510955, 'psi': 0.8308502433493588}-{'f1_val': 0.7159938022078014, 'auprc': 0.9911781436361689, 'loss_val': 0.3991581168072702, 'psi': 0.8260675387791483}
[S3] START round=39 head_norm_before_train=1.577595 cos_to_last_merge=0.9999 (last merge round=37)
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9989843060885355, 'loss_val': 0.0738402048854201, 'psi': 0.9762148730986804}-{'f1_val': 0.9973386888198309, 'auprc': 0.9986196015820727, 'loss_val': 0.05571504402076039, 'psi': 0.9978510539247276}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=39 metric=0.9610 head_norm=1.600919
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.391482e-01
[S3] stored merged vector for next round verification (round=39)
[S3] DEBUG after merge:  round=39 metric=0.9610 head_norm=1.576715 delta_norm=0.139148
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S3] r=40 psi=0.976 u=0.0000 p_local=0.1054 f1=0.961 auprc=0.999 bytes=41436
[S4] START round=39 head_norm_before_train=2.001415 cos_to_last_merge=1.0000 (last merge round=37)
[S4] round=39 local utility u=0.039681 metrics={'f1_val': 0.9458891061457857, 'auprc': 0.941788016118429, 'loss_val': 0.2918178183074234, 'psi': 0.9442486701348429}-{'f1_val': 0.9403780163290791, 'auprc': 0.9323225830217357, 'loss_val': 0.3097167079051948, 'psi': 0.9371558430061417}
[S5] START round=39 head_norm_before_train=2.021108 cos_to_last_merge=1.0000 (last merge round=38)
[S5] round=39 local utility u=0.000000 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9936701045876882, 'loss_val': 0.0330835066257769, 'psi': 0.9957097770017139}-{'f1_val': 0.9970695586110643, 'auprc': 0.9984059879965463, 'loss_val': 0.033046170812243744, 'psi': 0.9976041303652572}
[S6] START round=39 head_norm_before_train=1.545881 cos_to_last_merge=0.9993 (last merge round=36)
[S6] round=39 local utility u=0.082455 metrics={'f1_val': 0.8382448387053234, 'auprc': 0.9577962078334363, 'loss_val': 0.3533303145048353, 'psi': 0.8860653863565686}-{'f1_val': 0.8345321389931701, 'auprc': 0.9300220109038372, 'loss_val': 0.41264093975795335, 'psi': 0.872728087757437}
[S7] START round=39 head_norm_before_train=1.212122 cos_to_last_merge=0.9977 (last merge round=35)
[S7] round=39 local utility u=0.455195 metrics={'f1_val': 0.6797338460977359, 'auprc': 0.8471374036656575, 'loss_val': 0.41856409380345627, 'psi': 0.7466952691249046}-{'f1_val': 0.5914998052745962, 'auprc': 0.8026231653057466, 'loss_val': 0.6660077642355156, 'psi': 0.6759491492870564}
[S8] START round=39 head_norm_before_train=1.564559 cos_to_last_merge=0.9906 (last merge round=34)
[S8] round=39 local utility u=0.000000 metrics={'f1_val': 0.992174240363445, 'auprc': 0.9950710767498987, 'loss_val': 0.07596101216428468, 'psi': 0.9933329749180265}-{'f1_val': 0.9942788405856967, 'auprc': 0.9957981371812371, 'loss_val': 0.08480508639345528, 'psi': 0.9948865592239129}
[S9] START round=39 head_norm_before_train=2.024055 cos_to_last_merge=0.9999 (last merge round=37)
[S9] round=39 local utility u=0.023922 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9985638420330762, 'loss_val': 0.02785994147900833, 'psi': 0.9976872843205162}-{'f1_val': 0.9918149940667227, 'auprc': 0.9982974912834288, 'loss_val': 0.043176610682427265, 'psi': 0.9944079929534051}
[S10] START round=39 head_norm_before_train=1.319057 cos_to_last_merge=0.9658 (last merge round=30)
[S10] round=39 local utility u=0.005434 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9967035425417925, 'loss_val': 0.07404278255662457, 'psi': 0.9957941204283418}-{'f1_val': 0.9950955042232223, 'auprc': 0.9958089946275435, 'loss_val': 0.0816738424634227, 'psi': 0.9953809003849508}
[S11] START round=39 head_norm_before_train=2.095386 (no previous merge yet)
[S11] round=39 local utility u=0.000992 metrics={'f1_val': 0.9963958538641108, 'auprc': 0.9958107262387149, 'loss_val': 0.023836476917145223, 'psi': 0.9961618028139525}-{'f1_val': 0.9961541414107454, 'auprc': 0.995797879424551, 'loss_val': 0.024331406833282866, 'psi': 0.9960116366162677}
[S11] not sending this round → trigger blocked (psi=0.996)
[S11] r=40 psi=0.996 u=0.0010 p_local=0.0488 f1=0.996 auprc=0.996 bytes=43203
[S13] START round=39 head_norm_before_train=1.477964 cos_to_last_merge=0.8153 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.815
[S13] round=39 local utility u=0.000000 metrics={'f1_val': 0.610244147716847, 'auprc': 0.6457450780254721, 'loss_val': 0.8835899958809629, 'psi': 0.624444519840297}-{'f1_val': 0.6022144713451867, 'auprc': 0.698241856973304, 'loss_val': 0.6105779840170804, 'psi': 0.6406254255964337}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=40 psi=0.624 u=0.0000 p_local=0.0853 f1=0.610 auprc=0.646 bytes=30624
[S14] START round=39 head_norm_before_train=2.093778 (no previous merge yet)
[S14] round=39 local utility u=0.000000 metrics={'f1_val': 0.9954553826772798, 'auprc': 0.9990348909703441, 'loss_val': 0.04622000969187185, 'psi': 0.9968871859945055}-{'f1_val': 0.9974109942678281, 'auprc': 0.9988959092211956, 'loss_val': 0.018117216285759366, 'psi': 0.9980049602491752}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=40 psi=0.997 u=0.0000 p_local=0.0086 f1=0.995 auprc=0.999 bytes=44961
[S15] START round=39 head_norm_before_train=1.228758 cos_to_last_merge=0.9972 (last merge round=35)
[S15] round=39 local utility u=0.000000 metrics={'f1_val': 0.7745940888945418, 'auprc': 0.9008673539044504, 'loss_val': 0.3697200963884397, 'psi': 0.8251033948985053}-{'f1_val': 0.9913903387854143, 'auprc': 0.9987026426042537, 'loss_val': 0.11962511269251316, 'psi': 0.9943152603129501}
[S16] START round=39 head_norm_before_train=1.455391 cos_to_last_merge=0.9999 (last merge round=37)
[S16] round=39 local utility u=0.789393 metrics={'f1_val': 0.9897805366089755, 'auprc': 0.9921626393137047, 'loss_val': 0.06643077644395916, 'psi': 0.9907333776908672}-{'f1_val': 0.8431083577197875, 'auprc': 0.9865115523169101, 'loss_val': 0.7482299504889811, 'psi': 0.9004696355586366}
[S17] START round=39 head_norm_before_train=1.753307 cos_to_last_merge=0.7608 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.761
[S17] round=39 local utility u=0.000000 metrics={'f1_val': 0.556270256521991, 'auprc': 0.7169466921677446, 'loss_val': 1.3408524397951425, 'psi': 0.6205408307802924}-{'f1_val': 0.6413132449582437, 'auprc': 0.8843014625859995, 'loss_val': 0.9880725846298912, 'psi': 0.7385085320093461}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=40 psi=0.621 u=0.0000 p_local=0.1245 f1=0.556 auprc=0.717 bytes=32336
[S10] not sending this round → trigger blocked (psi=0.996)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:57007
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.747)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:57005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:57004
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.886)
[S2] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] r=40 psi=0.996 u=0.0000 p_local=0.1692 f1=0.997 auprc=0.994 bytes=37825
[S15] r=40 psi=0.825 u=0.0000 p_local=0.3346 f1=0.775 auprc=0.901 bytes=32361
[S9] sending update (kind=head size=1805 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S8] r=40 psi=0.993 u=0.0000 p_local=0.0266 f1=0.992 auprc=0.995 bytes=39539
[S7] r=40 psi=0.747 u=0.4552 p_local=0.2653 f1=0.680 auprc=0.847 bytes=35988
[S10] r=40 psi=0.996 u=0.0054 p_local=0.0168 f1=0.995 auprc=0.997 bytes=39557
[S2] RECEIVED delta(kind=head bytes=1797) from S4
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=2.001880)
[S2] loaded HEAD from S4 (vec_in norm=2.001880)
[S2] cosine check vs S4: cos=0.9997
[S2] BUFFERED delta from S4 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1805) from S9
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=2.039616)
[S5] loaded HEAD from S9 (vec_in norm=2.039616)
[S5] cosine check vs S9: cos=0.9995
[S5] BUFFERED delta from S9 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1799) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.484793)
[S6] loaded HEAD from S16 (vec_in norm=1.484793)
[S6] cosine check vs S16: cos=0.9954
[S6] BUFFERED delta from S16 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1802) from S2
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=2.028236)
[S4] loaded HEAD from S2 (vec_in norm=2.028236)
[S4] cosine check vs S2: cos=0.9997
[S4] BUFFERED delta from S2 (total buffered=1)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=39 metric=0.9898 head_norm=1.484793
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.737211e-02
[S16] stored merged vector for next round verification (round=39)
[S16] DEBUG after merge:  round=39 metric=0.9898 head_norm=1.513668 delta_norm=0.077372
[S16] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S16] r=40 psi=0.991 u=0.7894 p_local=0.2643 f1=0.990 auprc=0.992 bytes=41386
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=39 metric=0.9971 head_norm=2.039616
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.514166e-02
[S9] stored merged vector for next round verification (round=39)
[S9] DEBUG after merge:  round=39 metric=0.9971 head_norm=2.025517 delta_norm=0.045142
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] r=40 psi=0.998 u=0.0239 p_local=0.0125 f1=0.997 auprc=0.999 bytes=43228
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=39 metric=0.9459 head_norm=2.001880
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.695048e-02
[S4] stored merged vector for next round verification (round=39)
[S4] DEBUG after merge:  round=39 metric=0.9455 head_norm=2.014921 delta_norm=0.026950
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S4] r=40 psi=0.944 u=0.0397 p_local=0.0218 f1=0.946 auprc=0.942 bytes=39589
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=39 metric=0.8274 head_norm=2.028236
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.695049e-02
[S2] stored merged vector for next round verification (round=39)
[S2] DEBUG after merge:  round=39 metric=0.8274 head_norm=2.014921 delta_norm=0.026950
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] r=40 psi=0.831 u=0.1181 p_local=0.0758 f1=0.827 auprc=0.836 bytes=32365
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=39 metric=0.8382 head_norm=1.560157
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.231166e-02
[S6] stored merged vector for next round verification (round=39)
[S6] DEBUG after merge:  round=39 metric=0.8379 head_norm=1.520715 delta_norm=0.082312
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S6] r=40 psi=0.886 u=0.0825 p_local=0.2144 f1=0.838 auprc=0.958 bytes=34184
[S2] START round=40 head_norm_before_train=2.014921 cos_to_last_merge=1.0000 (last merge round=39)
[S2] round=40 local utility u=0.078240 metrics={'f1_val': 0.7763008884906277, 'auprc': 0.9907598892604799, 'loss_val': 0.36711981576758984, 'psi': 0.8620844887985686}-{'f1_val': 0.8273844589029373, 'auprc': 0.8360489200189908, 'loss_val': 0.36596917955510955, 'psi': 0.8308502433493588}
[S3] START round=40 head_norm_before_train=1.576715 cos_to_last_merge=1.0000 (last merge round=39)
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.9575055386550808, 'auprc': 0.9927420865039184, 'loss_val': 0.12429197862671951, 'psi': 0.9716001577946158}-{'f1_val': 0.9610352511054436, 'auprc': 0.9989843060885355, 'loss_val': 0.0738402048854201, 'psi': 0.9762148730986804}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=40 head_norm_before_train=2.014921 cos_to_last_merge=1.0000 (last merge round=39)
[S4] round=40 local utility u=0.000000 metrics={'f1_val': 0.9393233909498273, 'auprc': 0.9297107387878907, 'loss_val': 0.3042279364692308, 'psi': 0.9354783300850527}-{'f1_val': 0.9458891061457857, 'auprc': 0.941788016118429, 'loss_val': 0.2918178183074234, 'psi': 0.9442486701348429}
[S5] START round=40 head_norm_before_train=2.029601 cos_to_last_merge=0.9999 (last merge round=38)
[S5] round=40 local utility u=0.001810 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9939257285235545, 'loss_val': 0.03023058637734777, 'psi': 0.9958120265760604}-{'f1_val': 0.9970695586110643, 'auprc': 0.9936701045876882, 'loss_val': 0.0330835066257769, 'psi': 0.9957097770017139}
[S6] START round=40 head_norm_before_train=1.520715 cos_to_last_merge=1.0000 (last merge round=39)
[S6] round=40 local utility u=0.000000 metrics={'f1_val': 0.6350115904401414, 'auprc': 0.8415080458366204, 'loss_val': 0.656248910132982, 'psi': 0.717610172598733}-{'f1_val': 0.8382448387053234, 'auprc': 0.9577962078334363, 'loss_val': 0.3533303145048353, 'psi': 0.8860653863565686}
[S7] START round=40 head_norm_before_train=1.245551 cos_to_last_merge=0.9949 (last merge round=35)
[S7] round=40 local utility u=0.000000 metrics={'f1_val': 0.669396657762984, 'auprc': 0.8482263027105136, 'loss_val': 0.4186421594639749, 'psi': 0.7409285157419958}-{'f1_val': 0.6797338460977359, 'auprc': 0.8471374036656575, 'loss_val': 0.41856409380345627, 'psi': 0.7466952691249046}
[S8] START round=40 head_norm_before_train=1.592871 cos_to_last_merge=0.9875 (last merge round=34)
[S8] round=40 local utility u=0.012475 metrics={'f1_val': 0.9935462653440466, 'auprc': 0.9957331444183188, 'loss_val': 0.06122891407116743, 'psi': 0.9944210169737555}-{'f1_val': 0.992174240363445, 'auprc': 0.9950710767498987, 'loss_val': 0.07596101216428468, 'psi': 0.9933329749180265}
[S9] START round=40 head_norm_before_train=2.025517 cos_to_last_merge=1.0000 (last merge round=39)
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.9958601375429889, 'auprc': 0.9989389911631068, 'loss_val': 0.028450979315747468, 'psi': 0.997091678991036}-{'f1_val': 0.9971029125121428, 'auprc': 0.9985638420330762, 'loss_val': 0.02785994147900833, 'psi': 0.9976872843205162}
[S10] START round=40 head_norm_before_train=1.347422 cos_to_last_merge=0.9620 (last merge round=30)
[S10] round=40 local utility u=0.003307 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9962846084860912, 'loss_val': 0.06617147373257326, 'psi': 0.9956265468060613}-{'f1_val': 0.9951878390193748, 'auprc': 0.9967035425417925, 'loss_val': 0.07404278255662457, 'psi': 0.9957941204283418}
[S11] START round=40 head_norm_before_train=2.103921 (no previous merge yet)
[S11] round=40 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9958311766821505, 'loss_val': 0.024377900757275903, 'psi': 0.9960249555193075}-{'f1_val': 0.9963958538641108, 'auprc': 0.9958107262387149, 'loss_val': 0.023836476917145223, 'psi': 0.9961618028139525}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=40 head_norm_before_train=1.484347 cos_to_last_merge=0.8147 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.815
[S13] round=40 local utility u=0.110760 metrics={'f1_val': 0.6001096039139652, 'auprc': 0.7111156500771828, 'loss_val': 0.7973749205336571, 'psi': 0.6445120223792522}-{'f1_val': 0.610244147716847, 'auprc': 0.6457450780254721, 'loss_val': 0.8835899958809629, 'psi': 0.624444519840297}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1811 reason=None
[S13] sending update (kind=head size=1811 to 1 peers)
[S14] START round=40 head_norm_before_train=2.097044 (no previous merge yet)
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.9479418872268864, 'auprc': 0.9986281523472589, 'loss_val': 0.1256083970746903, 'psi': 0.9682163932750354}-{'f1_val': 0.9954553826772798, 'auprc': 0.9990348909703441, 'loss_val': 0.04622000969187185, 'psi': 0.9968871859945055}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=40 head_norm_before_train=1.256383 cos_to_last_merge=0.9955 (last merge round=35)
[S15] round=40 local utility u=0.830588 metrics={'f1_val': 0.9635458751549884, 'auprc': 0.9931987721468216, 'loss_val': 0.11924949264083562, 'psi': 0.9754070339517217}-{'f1_val': 0.7745940888945418, 'auprc': 0.9008673539044504, 'loss_val': 0.3697200963884397, 'psi': 0.8251033948985053}
[S16] START round=40 head_norm_before_train=1.513668 cos_to_last_merge=1.0000 (last merge round=39)
[S16] round=40 local utility u=0.003870 metrics={'f1_val': 0.9908722666733435, 'auprc': 0.9895941261564004, 'loss_val': 0.05753528840637843, 'psi': 0.9903610104665663}-{'f1_val': 0.9897805366089755, 'auprc': 0.9921626393137047, 'loss_val': 0.06643077644395916, 'psi': 0.9907333776908672}
[S17] START round=40 head_norm_before_train=1.767317 cos_to_last_merge=0.7600 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.760
[S17] round=40 local utility u=0.305655 metrics={'f1_val': 0.6007948306662247, 'auprc': 0.7787483381048099, 'loss_val': 1.1820938544814257, 'psi': 0.6719762336416588}-{'f1_val': 0.556270256521991, 'auprc': 0.7169466921677446, 'loss_val': 1.3408524397951425, 'psi': 0.6205408307802924}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] not sending this round → trigger blocked (psi=0.990)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] → sending delta(kind=head bytes=1806) to S3@127.0.0.1:57003
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:57010
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.862)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] ⇄ pheromone p=0.017 → S2@127.0.0.1:57002
[S5] sending update (kind=head size=1803 to 1 peers)
[S2] ⇄ pheromone p=0.076 → S4@127.0.0.1:57004
[S9] ⇄ pheromone p=0.010 → S5@127.0.0.1:57005
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1806 to 1 peers)
[S16] ⇄ pheromone p=0.212 → S6@127.0.0.1:57007
[S3] RECEIVED delta(kind=head bytes=1806) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.619020)
[S3] loaded HEAD from S8 (vec_in norm=1.619020)
[S3] cosine check vs S8: cos=0.9913
[S3] BUFFERED delta from S8 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1803) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=2.042828)
[S9] loaded HEAD from S5 (vec_in norm=2.042828)
[S9] cosine check vs S5: cos=0.9996
[S9] BUFFERED delta from S5 (total buffered=1)
[S8] ⇄ pheromone p=0.024 → S3@127.0.0.1:57003
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=40 metric=0.9971 head_norm=2.042828
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.276610e-02
[S5] stored merged vector for next round verification (round=40)
[S5] DEBUG after merge:  round=40 metric=0.9971 head_norm=2.040775 delta_norm=0.042766
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.136 → S9@127.0.0.1:57010
[S6] ⇄ pheromone p=0.172 → S16@127.0.0.1:57016
[S2] START round=41 head_norm_before_train=2.026169 cos_to_last_merge=1.0000 (last merge round=39)
[S2] round=41 local utility u=0.000000 metrics={'f1_val': 0.808826225519374, 'auprc': 0.8585684838537007, 'loss_val': 0.4267338926005547, 'psi': 0.8287231288531047}-{'f1_val': 0.7763008884906277, 'auprc': 0.9907598892604799, 'loss_val': 0.36711981576758984, 'psi': 0.8620844887985686}
[S3] START round=41 head_norm_before_train=1.604449 cos_to_last_merge=0.9997 (last merge round=39)
[S3] round=41 local utility u=0.171987 metrics={'f1_val': 0.9977814963782642, 'auprc': 0.9993249916921967, 'loss_val': 0.041723405070029376, 'psi': 0.9983988945038372}-{'f1_val': 0.9575055386550808, 'auprc': 0.9927420865039184, 'loss_val': 0.12429197862671951, 'psi': 0.9716001577946158}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=41 metric=0.9978 head_norm=1.625110
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.127315e-01
[S3] stored merged vector for next round verification (round=41)
[S3] DEBUG after merge:  round=41 metric=0.9978 head_norm=1.618146 delta_norm=0.112732
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S4] START round=41 head_norm_before_train=2.015882 cos_to_last_merge=0.9999 (last merge round=39)
[S4] round=41 local utility u=0.066840 metrics={'f1_val': 0.9493124807584493, 'auprc': 0.9491025130742345, 'loss_val': 0.28865866946792545, 'psi': 0.9492284936847635}-{'f1_val': 0.9393233909498273, 'auprc': 0.9297107387878907, 'loss_val': 0.3042279364692308, 'psi': 0.9354783300850527}
[S5] START round=41 head_norm_before_train=2.040775 cos_to_last_merge=1.0000 (last merge round=40)
[S5] round=41 local utility u=0.000000 metrics={'f1_val': 0.9965856912065586, 'auprc': 0.9929552715124936, 'loss_val': 0.030207770635181555, 'psi': 0.9951335233289326}-{'f1_val': 0.9970695586110643, 'auprc': 0.9939257285235545, 'loss_val': 0.03023058637734777, 'psi': 0.9958120265760604}
[S6] START round=41 head_norm_before_train=1.535083 cos_to_last_merge=0.9999 (last merge round=39)
[S6] round=41 local utility u=1.000000 metrics={'f1_val': 0.9799048172064888, 'auprc': 0.959050759099387, 'loss_val': 0.16870516224076257, 'psi': 0.971563193963648}-{'f1_val': 0.6350115904401414, 'auprc': 0.8415080458366204, 'loss_val': 0.656248910132982, 'psi': 0.717610172598733}
[S7] START round=41 head_norm_before_train=1.269596 cos_to_last_merge=0.9924 (last merge round=35)
[S7] round=41 local utility u=0.000000 metrics={'f1_val': 0.5763767004321246, 'auprc': 0.7995176710801446, 'loss_val': 0.6955166624642949, 'psi': 0.6656330886913326}-{'f1_val': 0.669396657762984, 'auprc': 0.8482263027105136, 'loss_val': 0.4186421594639749, 'psi': 0.7409285157419958}
[S8] START round=41 head_norm_before_train=1.619020 cos_to_last_merge=0.9846 (last merge round=34)
[S8] round=41 local utility u=0.003923 metrics={'f1_val': 0.9939122747783468, 'auprc': 0.9953439885236551, 'loss_val': 0.05441125726426151, 'psi': 0.99448496027647}-{'f1_val': 0.9935462653440466, 'auprc': 0.9957331444183188, 'loss_val': 0.06122891407116743, 'psi': 0.9944210169737555}
[S9] START round=41 head_norm_before_train=2.041821 cos_to_last_merge=0.9999 (last merge round=39)
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.994356655862817, 'auprc': 0.9990316576299322, 'loss_val': 0.03035885864158221, 'psi': 0.9962266565696631}-{'f1_val': 0.9958601375429889, 'auprc': 0.9989389911631068, 'loss_val': 0.028450979315747468, 'psi': 0.997091678991036}
[S10] START round=41 head_norm_before_train=1.376023 cos_to_last_merge=0.9582 (last merge round=30)
[S10] round=41 local utility u=0.002297 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9961047551265626, 'loss_val': 0.06103759645322829, 'psi': 0.9955546054622499}-{'f1_val': 0.9951878390193748, 'auprc': 0.9962846084860912, 'loss_val': 0.06617147373257326, 'psi': 0.9956265468060613}
[S11] START round=41 head_norm_before_train=2.114009 (no previous merge yet)
[S11] round=41 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9957252954765088, 'loss_val': 0.02448471740871981, 'psi': 0.9959826030370508}-{'f1_val': 0.9961541414107454, 'auprc': 0.9958311766821505, 'loss_val': 0.024377900757275903, 'psi': 0.9960249555193075}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=41 head_norm_before_train=1.488431 cos_to_last_merge=0.8136 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.814
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.6011275414496453, 'auprc': 0.6932328967628856, 'loss_val': 0.8014866259199357, 'psi': 0.6379696835749414}-{'f1_val': 0.6001096039139652, 'auprc': 0.7111156500771828, 'loss_val': 0.7973749205336571, 'psi': 0.6445120223792522}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=41 head_norm_before_train=2.102672 (no previous merge yet)
[S14] round=41 local utility u=0.193828 metrics={'f1_val': 0.9957445751558393, 'auprc': 0.9988707603401842, 'loss_val': 0.025496898891833975, 'psi': 0.9969950492295772}-{'f1_val': 0.9479418872268864, 'auprc': 0.9986281523472589, 'loss_val': 0.1256083970746903, 'psi': 0.9682163932750354}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=41 head_norm_before_train=1.279549 cos_to_last_merge=0.9939 (last merge round=35)
[S15] round=41 local utility u=0.121877 metrics={'f1_val': 0.9956118734748063, 'auprc': 0.9969958047304752, 'loss_val': 0.07928278293190202, 'psi': 0.9961654459770739}-{'f1_val': 0.9635458751549884, 'auprc': 0.9931987721468216, 'loss_val': 0.11924949264083562, 'psi': 0.9754070339517217}
[S16] START round=41 head_norm_before_train=1.537493 cos_to_last_merge=0.9999 (last merge round=39)
[S16] round=41 local utility u=0.000000 metrics={'f1_val': 0.9578615840829028, 'auprc': 0.9910077046241561, 'loss_val': 0.12717876937044942, 'psi': 0.9711200322994041}-{'f1_val': 0.9908722666733435, 'auprc': 0.9895941261564004, 'loss_val': 0.05753528840637843, 'psi': 0.9903610104665663}
[S17] START round=41 head_norm_before_train=1.778020 cos_to_last_merge=0.7595 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.759
[S17] round=41 local utility u=0.746447 metrics={'f1_val': 0.7032314132943296, 'auprc': 0.9834920812943195, 'loss_val': 0.9180504152354849, 'psi': 0.8153356804943256}-{'f1_val': 0.6007948306662247, 'auprc': 0.7787483381048099, 'loss_val': 1.1820938544814257, 'psi': 0.6719762336416588}
[S17] not sending this round → trigger blocked (psi=0.815)
[S15] not sending this round → trigger blocked (psi=0.996)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.994)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:57002
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.996)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=41 metric=0.9944 head_norm=2.056931
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.167611e-02
[S9] stored merged vector for next round verification (round=41)
[S9] DEBUG after merge:  round=41 metric=0.9944 head_norm=2.049647 delta_norm=0.031676
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S4] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:57016
[S2] RECEIVED delta(kind=head bytes=1802) from S4
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=2.019016)
[S2] loaded HEAD from S4 (vec_in norm=2.019016)
[S2] cosine check vs S4: cos=0.9997
[S2] BUFFERED delta from S4 (total buffered=1)
[S6] sending update (kind=head size=1801 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1801) from S6
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.549411)
[S16] loaded HEAD from S6 (vec_in norm=1.549411)
[S16] cosine check vs S6: cos=0.9991
[S16] BUFFERED delta from S6 (total buffered=1)
[S2] START round=42 head_norm_before_train=2.038457 cos_to_last_merge=0.9999 (last merge round=39)
[S2] round=42 local utility u=0.065970 metrics={'f1_val': 0.8201539893433984, 'auprc': 0.8736919731988313, 'loss_val': 0.40813164355732306, 'psi': 0.8415691828855716}-{'f1_val': 0.808826225519374, 'auprc': 0.8585684838537007, 'loss_val': 0.4267338926005547, 'psi': 0.8287231288531047}
[S3] START round=42 head_norm_before_train=1.618146 cos_to_last_merge=1.0000 (last merge round=41)
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9988692487478169, 'loss_val': 0.09691692905365484, 'psi': 0.9761688501623929}-{'f1_val': 0.9977814963782642, 'auprc': 0.9993249916921967, 'loss_val': 0.041723405070029376, 'psi': 0.9983988945038372}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=42 head_norm_before_train=2.019016 cos_to_last_merge=0.9998 (last merge round=39)
[S4] round=42 local utility u=0.064316 metrics={'f1_val': 0.9567648173968899, 'auprc': 0.9717040502739932, 'loss_val': 0.2725458147729075, 'psi': 0.9627405105477312}-{'f1_val': 0.9493124807584493, 'auprc': 0.9491025130742345, 'loss_val': 0.28865866946792545, 'psi': 0.9492284936847635}
[S5] START round=42 head_norm_before_train=2.052409 cos_to_last_merge=0.9999 (last merge round=40)
[S5] round=42 local utility u=0.007393 metrics={'f1_val': 0.9969532771825056, 'auprc': 0.9956574159924574, 'loss_val': 0.02573364272079288, 'psi': 0.9964349327064863}-{'f1_val': 0.9965856912065586, 'auprc': 0.9929552715124936, 'loss_val': 0.030207770635181555, 'psi': 0.9951335233289326}
[S6] START round=42 head_norm_before_train=1.549411 cos_to_last_merge=0.9998 (last merge round=39)
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.7426303362774248, 'auprc': 0.9574347102840385, 'loss_val': 0.5547027439224822, 'psi': 0.8285520858800703}-{'f1_val': 0.9799048172064888, 'auprc': 0.959050759099387, 'loss_val': 0.16870516224076257, 'psi': 0.971563193963648}
[S7] START round=42 head_norm_before_train=1.286683 cos_to_last_merge=0.9905 (last merge round=35)
[S7] round=42 local utility u=0.000000 metrics={'f1_val': 0.5762246269025932, 'auprc': 0.7988890432736221, 'loss_val': 0.729300542721475, 'psi': 0.6652903934510048}-{'f1_val': 0.5763767004321246, 'auprc': 0.7995176710801446, 'loss_val': 0.6955166624642949, 'psi': 0.6656330886913326}
[S8] START round=42 head_norm_before_train=1.643026 cos_to_last_merge=0.9818 (last merge round=34)
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.9914482382097267, 'auprc': 0.9960774875654516, 'loss_val': 0.053825893347268616, 'psi': 0.9932999379520167}-{'f1_val': 0.9939122747783468, 'auprc': 0.9953439885236551, 'loss_val': 0.05441125726426151, 'psi': 0.99448496027647}
[S9] START round=42 head_norm_before_train=2.049647 cos_to_last_merge=1.0000 (last merge round=41)
[S9] round=42 local utility u=0.008025 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9986969378047916, 'loss_val': 0.027319977686515305, 'psi': 0.9974942698807739}-{'f1_val': 0.994356655862817, 'auprc': 0.9990316576299322, 'loss_val': 0.03035885864158221, 'psi': 0.9962266565696631}
[S10] START round=42 head_norm_before_train=1.404575 cos_to_last_merge=0.9544 (last merge round=30)
[S10] round=42 local utility u=0.001916 metrics={'f1_val': 0.9951450524673635, 'auprc': 0.995704820524526, 'loss_val': 0.05574956746486145, 'psi': 0.9953689596902285}-{'f1_val': 0.9951878390193748, 'auprc': 0.9961047551265626, 'loss_val': 0.06103759645322829, 'psi': 0.9955546054622499}
[S11] START round=42 head_norm_before_train=2.125057 (no previous merge yet)
[S11] round=42 local utility u=0.000155 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9957579985439805, 'loss_val': 0.024273323801231438, 'psi': 0.9959956842640394}-{'f1_val': 0.9961541414107454, 'auprc': 0.9957252954765088, 'loss_val': 0.02448471740871981, 'psi': 0.9959826030370508}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=42 head_norm_before_train=1.493234 cos_to_last_merge=0.8131 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.813
[S13] round=42 local utility u=0.000000 metrics={'f1_val': 0.5852024858920254, 'auprc': 0.7045058078787447, 'loss_val': 0.8841708358180935, 'psi': 0.6329238146867131}-{'f1_val': 0.6011275414496453, 'auprc': 0.6932328967628856, 'loss_val': 0.8014866259199357, 'psi': 0.6379696835749414}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=42 head_norm_before_train=2.111012 (no previous merge yet)
[S14] round=42 local utility u=0.008050 metrics={'f1_val': 0.9974055297193176, 'auprc': 0.9988812522930748, 'loss_val': 0.019393395742319477, 'psi': 0.9979958187488205}-{'f1_val': 0.9957445751558393, 'auprc': 0.9988707603401842, 'loss_val': 0.025496898891833975, 'psi': 0.9969950492295772}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=42 head_norm_before_train=1.300813 cos_to_last_merge=0.9922 (last merge round=35)
[S15] round=42 local utility u=0.000000 metrics={'f1_val': 0.9957757960160583, 'auprc': 0.9922410448993717, 'loss_val': 0.08427253544913621, 'psi': 0.9943618955693837}-{'f1_val': 0.9956118734748063, 'auprc': 0.9969958047304752, 'loss_val': 0.07928278293190202, 'psi': 0.9961654459770739}
[S16] START round=42 head_norm_before_train=1.560174 cos_to_last_merge=0.9996 (last merge round=39)
[S16] round=42 local utility u=0.000000 metrics={'f1_val': 0.9358818542400873, 'auprc': 0.9883021598668337, 'loss_val': 0.2886973965988262, 'psi': 0.9568499764907858}-{'f1_val': 0.9578615840829028, 'auprc': 0.9910077046241561, 'loss_val': 0.12717876937044942, 'psi': 0.9711200322994041}
[S17] START round=42 head_norm_before_train=1.785297 cos_to_last_merge=0.7590 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.759
[S17] round=42 local utility u=0.000000 metrics={'f1_val': 0.656861606259469, 'auprc': 0.9667385690862679, 'loss_val': 0.9038702393665988, 'psi': 0.7808123913901885}-{'f1_val': 0.7032314132943296, 'auprc': 0.9834920812943195, 'loss_val': 0.9180504152354849, 'psi': 0.8153356804943256}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:57005
[S4] not sending this round → trigger blocked (psi=0.963)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:57004
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:57010
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=42 metric=0.9359 head_norm=1.580945
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.252223e-02
[S16] stored merged vector for next round verification (round=42)
[S16] DEBUG after merge:  round=42 metric=0.9355 head_norm=1.564680 delta_norm=0.042522
[S16] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S9] RECEIVED delta(kind=head bytes=1800) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=2.066721)
[S9] loaded HEAD from S5 (vec_in norm=2.066721)
[S9] cosine check vs S5: cos=0.9998
[S9] BUFFERED delta from S5 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1795) from S9
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=2.064340)
[S5] loaded HEAD from S9 (vec_in norm=2.064340)
[S5] cosine check vs S9: cos=0.9998
[S5] BUFFERED delta from S9 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1798) from S2
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=2.050510)
[S4] loaded HEAD from S2 (vec_in norm=2.050510)
[S4] cosine check vs S2: cos=0.9994
[S4] BUFFERED delta from S2 (total buffered=1)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=42 metric=0.9967 head_norm=2.064340
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.996833e-02
[S9] stored merged vector for next round verification (round=42)
[S9] DEBUG after merge:  round=42 metric=0.9967 head_norm=2.065434 delta_norm=0.019968
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=42 metric=0.9970 head_norm=2.066721
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.996833e-02
[S5] stored merged vector for next round verification (round=42)
[S5] DEBUG after merge:  round=42 metric=0.9970 head_norm=2.065434 delta_norm=0.019968
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=42 metric=0.8202 head_norm=2.050510
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.306595e-02
[S2] stored merged vector for next round verification (round=42)
[S2] DEBUG after merge:  round=42 metric=0.8202 head_norm=2.034555 delta_norm=0.033066
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=43 head_norm_before_train=2.034555 cos_to_last_merge=1.0000 (last merge round=42)
[S2] round=43 local utility u=0.170428 metrics={'f1_val': 0.8269011540520794, 'auprc': 0.9651385535175413, 'loss_val': 0.382098147928701, 'psi': 0.8821961138382641}-{'f1_val': 0.8201539893433984, 'auprc': 0.8736919731988313, 'loss_val': 0.40813164355732306, 'psi': 0.8415691828855716}
[S3] START round=43 head_norm_before_train=1.636825 cos_to_last_merge=0.9999 (last merge round=41)
[S3] round=43 local utility u=0.044016 metrics={'f1_val': 0.9710742626949586, 'auprc': 0.9988329241776581, 'loss_val': 0.06901048084366941, 'psi': 0.9821777272880383}-{'f1_val': 0.9610352511054436, 'auprc': 0.9988692487478169, 'loss_val': 0.09691692905365484, 'psi': 0.9761688501623929}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] sending update (kind=head size=1805 to 1 peers)
[S4] START round=43 head_norm_before_train=2.019820 cos_to_last_merge=0.9996 (last merge round=39)
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.9485654070853852, 'auprc': 0.9586197818369384, 'loss_val': 0.28936632714965416, 'psi': 0.9525871569860065}-{'f1_val': 0.9567648173968899, 'auprc': 0.9717040502739932, 'loss_val': 0.2725458147729075, 'psi': 0.9627405105477312}
[S5] START round=43 head_norm_before_train=2.065434 cos_to_last_merge=1.0000 (last merge round=42)
[S5] round=43 local utility u=0.000000 metrics={'f1_val': 0.9969532771825056, 'auprc': 0.9934816528817152, 'loss_val': 0.025355644285163792, 'psi': 0.9955646274621894}-{'f1_val': 0.9969532771825056, 'auprc': 0.9956574159924574, 'loss_val': 0.02573364272079288, 'psi': 0.9964349327064863}
[S6] START round=43 head_norm_before_train=1.561157 cos_to_last_merge=0.9995 (last merge round=39)
[S6] round=43 local utility u=0.418949 metrics={'f1_val': 0.8357785753672351, 'auprc': 0.9597202331333536, 'loss_val': 0.28255011607769265, 'psi': 0.8853552384736826}-{'f1_val': 0.7426303362774248, 'auprc': 0.9574347102840385, 'loss_val': 0.5547027439224822, 'psi': 0.8285520858800703}
[S7] START round=43 head_norm_before_train=1.303187 cos_to_last_merge=0.9888 (last merge round=35)
[S7] round=43 local utility u=0.772789 metrics={'f1_val': 0.6920326256623961, 'auprc': 0.9452907652467506, 'loss_val': 0.3177758611789041, 'psi': 0.793335881496138}-{'f1_val': 0.5762246269025932, 'auprc': 0.7988890432736221, 'loss_val': 0.729300542721475, 'psi': 0.6652903934510048}
[S8] START round=43 head_norm_before_train=1.662044 cos_to_last_merge=0.9795 (last merge round=34)
[S8] round=43 local utility u=0.010780 metrics={'f1_val': 0.9940931887774087, 'auprc': 0.996162057089846, 'loss_val': 0.048389455422500435, 'psi': 0.9949207361023836}-{'f1_val': 0.9914482382097267, 'auprc': 0.9960774875654516, 'loss_val': 0.053825893347268616, 'psi': 0.9932999379520167}
[S9] START round=43 head_norm_before_train=2.065434 cos_to_last_merge=1.0000 (last merge round=42)
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.9964388212112862, 'auprc': 0.9985664622712431, 'loss_val': 0.027581126661216936, 'psi': 0.997289877635269}-{'f1_val': 0.9966924912647621, 'auprc': 0.9986969378047916, 'loss_val': 0.027319977686515305, 'psi': 0.9974942698807739}
[S10] START round=43 head_norm_before_train=1.429436 cos_to_last_merge=0.9511 (last merge round=30)
[S10] round=43 local utility u=0.001334 metrics={'f1_val': 0.9949255377402499, 'auprc': 0.9957317422145727, 'loss_val': 0.051844760831912404, 'psi': 0.9952480195299791}-{'f1_val': 0.9951450524673635, 'auprc': 0.995704820524526, 'loss_val': 0.05574956746486145, 'psi': 0.9953689596902285}
[S11] START round=43 head_norm_before_train=2.136735 (no previous merge yet)
[S11] round=43 local utility u=0.002110 metrics={'f1_val': 0.9963958538641108, 'auprc': 0.9959524422397267, 'loss_val': 0.022086693153834613, 'psi': 0.9962184892143572}-{'f1_val': 0.9961541414107454, 'auprc': 0.9957579985439805, 'loss_val': 0.024273323801231438, 'psi': 0.9959956842640394}
[S11] not sending this round → trigger blocked (psi=0.996)
[S13] START round=43 head_norm_before_train=1.496691 cos_to_last_merge=0.8125 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.813
[S13] round=43 local utility u=0.139377 metrics={'f1_val': 0.6044384800895066, 'auprc': 0.7122080020851531, 'loss_val': 0.7439397226907123, 'psi': 0.6475462888877652}-{'f1_val': 0.5852024858920254, 'auprc': 0.7045058078787447, 'loss_val': 0.8841708358180935, 'psi': 0.6329238146867131}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S13] sending update (kind=head size=1807 to 1 peers)
[S14] START round=43 head_norm_before_train=2.114568 (no previous merge yet)
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.9973891252095638, 'auprc': 0.9988487248197541, 'loss_val': 0.020095834194242174, 'psi': 0.99797296505364}-{'f1_val': 0.9974055297193176, 'auprc': 0.9988812522930748, 'loss_val': 0.019393395742319477, 'psi': 0.9979958187488205}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=43 head_norm_before_train=1.321754 cos_to_last_merge=0.9905 (last merge round=35)
[S15] round=43 local utility u=0.021163 metrics={'f1_val': 0.9967036286230888, 'auprc': 0.9979151164627941, 'loss_val': 0.06453635140336776, 'psi': 0.997188223758971}-{'f1_val': 0.9957757960160583, 'auprc': 0.9922410448993717, 'loss_val': 0.08427253544913621, 'psi': 0.9943618955693837}
[S16] START round=43 head_norm_before_train=1.564680 cos_to_last_merge=1.0000 (last merge round=42)
[S16] round=43 local utility u=0.000000 metrics={'f1_val': 0.9281624827699524, 'auprc': 0.9890383631652487, 'loss_val': 0.3367612601743208, 'psi': 0.9525128349280709}-{'f1_val': 0.9358818542400873, 'auprc': 0.9883021598668337, 'loss_val': 0.2886973965988262, 'psi': 0.9568499764907858}
[S17] START round=43 head_norm_before_train=1.792611 cos_to_last_merge=0.7586 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.759
[S17] round=43 local utility u=0.000000 metrics={'f1_val': 0.5546359070892246, 'auprc': 0.7023741752492118, 'loss_val': 1.4016129865851565, 'psi': 0.6137312143532194}-{'f1_val': 0.656861606259469, 'auprc': 0.9667385690862679, 'loss_val': 0.9038702393665988, 'psi': 0.7808123913901885}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7]  timeout peer S15
[S15]  timeout peer S10
[S10]  timeout peer S7
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S10] not sending this round → trigger blocked (psi=0.995)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:57003
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S2] not sending this round → trigger blocked (psi=0.882)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=43 metric=0.9486 head_norm=2.022357
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.998723e-02
[S4] stored merged vector for next round verification (round=43)
[S4] DEBUG after merge:  round=43 metric=0.9486 head_norm=2.036090 delta_norm=0.039987
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S8] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:57016
[S3] RECEIVED delta(kind=head bytes=1801) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.677319)
[S3] loaded HEAD from S8 (vec_in norm=1.677319)
[S3] cosine check vs S8: cos=0.9935
[S3] BUFFERED delta from S8 (total buffered=1)
[S6] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S6
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.573399)
[S16] loaded HEAD from S6 (vec_in norm=1.573399)
[S16] cosine check vs S6: cos=0.9990
[S16] BUFFERED delta from S6 (total buffered=1)
[S2] START round=44 head_norm_before_train=2.046341 cos_to_last_merge=1.0000 (last merge round=42)
[S2] round=44 local utility u=0.001183 metrics={'f1_val': 0.8268228423786769, 'auprc': 0.9666639678676835, 'loss_val': 0.3838389692949238, 'psi': 0.8827592925742795}-{'f1_val': 0.8269011540520794, 'auprc': 0.9651385535175413, 'loss_val': 0.382098147928701, 'psi': 0.8821961138382641}
[S3] START round=44 head_norm_before_train=1.657260 cos_to_last_merge=0.9996 (last merge round=41)
[S3] round=44 local utility u=0.046830 metrics={'f1_val': 0.9834030929706927, 'auprc': 0.9985780846002146, 'loss_val': 0.04855882173414541, 'psi': 0.9894730896225015}-{'f1_val': 0.9710742626949586, 'auprc': 0.9988329241776581, 'loss_val': 0.06901048084366941, 'psi': 0.9821777272880383}
[S3] not sending this round → trigger blocked (psi=0.989)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=44 metric=0.9834 head_norm=1.680973
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.033979e-01
[S3] stored merged vector for next round verification (round=44)
[S3] DEBUG after merge:  round=44 metric=0.9834 head_norm=1.675961 delta_norm=0.103398
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S4] START round=44 head_norm_before_train=2.036090 cos_to_last_merge=1.0000 (last merge round=43)
[S4] round=44 local utility u=0.047723 metrics={'f1_val': 0.9525218107502862, 'auprc': 0.9798297648024797, 'loss_val': 0.2812879930713714, 'psi': 0.9634449923711637}-{'f1_val': 0.9485654070853852, 'auprc': 0.9586197818369384, 'loss_val': 0.28936632714965416, 'psi': 0.9525871569860065}
[S5] START round=44 head_norm_before_train=2.077958 cos_to_last_merge=1.0000 (last merge round=42)
[S5] round=44 local utility u=0.000000 metrics={'f1_val': 0.997513339444841, 'auprc': 0.9992750362326963, 'loss_val': 0.10178962847471196, 'psi': 0.9982180181599831}-{'f1_val': 0.9969532771825056, 'auprc': 0.9934816528817152, 'loss_val': 0.025355644285163792, 'psi': 0.9955646274621894}
[S6] START round=44 head_norm_before_train=1.573399 cos_to_last_merge=0.9993 (last merge round=39)
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.6042665155367251, 'auprc': 0.7731111400893985, 'loss_val': 0.859832601731866, 'psi': 0.6718043653577945}-{'f1_val': 0.8357785753672351, 'auprc': 0.9597202331333536, 'loss_val': 0.28255011607769265, 'psi': 0.8853552384736826}
[S7] START round=44 head_norm_before_train=1.317682 cos_to_last_merge=0.9872 (last merge round=35)
[S7] round=44 local utility u=0.171049 metrics={'f1_val': 0.7130741657151985, 'auprc': 0.9916163046007248, 'loss_val': 0.24090422057549563, 'psi': 0.824491021269409}-{'f1_val': 0.6920326256623961, 'auprc': 0.9452907652467506, 'loss_val': 0.3177758611789041, 'psi': 0.793335881496138}
[S7] not sending this round → trigger blocked (psi=0.824)
[S8] START round=44 head_norm_before_train=1.677319 cos_to_last_merge=0.9780 (last merge round=34)
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.9921646161217188, 'auprc': 0.9969485417344195, 'loss_val': 0.04612579254737378, 'psi': 0.9940781863667991}-{'f1_val': 0.9940931887774087, 'auprc': 0.996162057089846, 'loss_val': 0.048389455422500435, 'psi': 0.9949207361023836}
[S9] START round=44 head_norm_before_train=2.072131 cos_to_last_merge=0.9999 (last merge round=42)
[S9] round=44 local utility u=0.002201 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9985673496450351, 'loss_val': 0.02566429219927104, 'psi': 0.9975384911133685}-{'f1_val': 0.9964388212112862, 'auprc': 0.9985664622712431, 'loss_val': 0.027581126661216936, 'psi': 0.997289877635269}
[S10] START round=44 head_norm_before_train=1.452397 cos_to_last_merge=0.9481 (last merge round=30)
[S10] ⚠️ Model drifted since last merge! cos=0.948
[S10] round=44 local utility u=0.001483 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9956479691658779, 'loss_val': 0.05020217933534568, 'psi': 0.9953718910779761}-{'f1_val': 0.9949255377402499, 'auprc': 0.9957317422145727, 'loss_val': 0.051844760831912404, 'psi': 0.9952480195299791}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=44 head_norm_before_train=2.147998 (no previous merge yet)
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.9963958538641108, 'auprc': 0.9945378925720167, 'loss_val': 0.022454705031670623, 'psi': 0.9956526693472731}-{'f1_val': 0.9963958538641108, 'auprc': 0.9959524422397267, 'loss_val': 0.022086693153834613, 'psi': 0.9962184892143572}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=44 head_norm_before_train=1.499729 cos_to_last_merge=0.8124 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.812
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.6042978721230647, 'auprc': 0.607156708012752, 'loss_val': 0.9350297553258201, 'psi': 0.6054414064789396}-{'f1_val': 0.6044384800895066, 'auprc': 0.7122080020851531, 'loss_val': 0.7439397226907123, 'psi': 0.6475462888877652}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=44 head_norm_before_train=2.120061 (no previous merge yet)
[S14] round=44 local utility u=0.000987 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9988880782208803, 'loss_val': 0.018370865109723446, 'psi': 0.998001827849049}-{'f1_val': 0.9973891252095638, 'auprc': 0.9988487248197541, 'loss_val': 0.020095834194242174, 'psi': 0.99797296505364}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=44 head_norm_before_train=1.341535 cos_to_last_merge=0.9888 (last merge round=35)
[S15] round=44 local utility u=0.000000 metrics={'f1_val': 0.894065678633402, 'auprc': 0.9841496459883001, 'loss_val': 0.21767394749454289, 'psi': 0.9300992655753613}-{'f1_val': 0.9967036286230888, 'auprc': 0.9979151164627941, 'loss_val': 0.06453635140336776, 'psi': 0.997188223758971}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=44 head_norm_before_train=1.585558 cos_to_last_merge=1.0000 (last merge round=42)
[S16] round=44 local utility u=0.000000 metrics={'f1_val': 0.8488628046033313, 'auprc': 0.9846679629463118, 'loss_val': 0.7859088541095212, 'psi': 0.9031848679405234}-{'f1_val': 0.9281624827699524, 'auprc': 0.9890383631652487, 'loss_val': 0.3367612601743208, 'psi': 0.9525128349280709}
[S17] START round=44 head_norm_before_train=1.801685 cos_to_last_merge=0.7581 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.758
[S17] round=44 local utility u=0.384270 metrics={'f1_val': 0.6166531868941775, 'auprc': 0.8069244383048331, 'loss_val': 1.3188283295592955, 'psi': 0.6927616874584397}-{'f1_val': 0.5546359070892246, 'auprc': 0.7023741752492118, 'loss_val': 1.4016129865851565, 'psi': 0.6137312143532194}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:57002
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:57004
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:57005
[S2] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=44 metric=0.8489 head_norm=1.602222
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.223458e-02
[S16] stored merged vector for next round verification (round=44)
[S16] DEBUG after merge:  round=44 metric=0.8489 head_norm=1.587314 delta_norm=0.042235
[S16] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] RECEIVED delta(kind=head bytes=1801) from S2
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=2.057468)
[S4] loaded HEAD from S2 (vec_in norm=2.057468)
[S4] cosine check vs S2: cos=0.9998
[S4] BUFFERED delta from S2 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1801) from S4
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=2.039341)
[S2] loaded HEAD from S4 (vec_in norm=2.039341)
[S2] cosine check vs S4: cos=0.9998
[S2] BUFFERED delta from S4 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1801) from S9
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=2.082682)
[S5] loaded HEAD from S9 (vec_in norm=2.082682)
[S5] cosine check vs S9: cos=0.9995
[S5] BUFFERED delta from S9 (total buffered=1)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=44 metric=0.9525 head_norm=2.039341
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.042378e-02
[S4] stored merged vector for next round verification (round=44)
[S4] DEBUG after merge:  round=44 metric=0.9529 head_norm=2.048323 delta_norm=0.020424
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=44 metric=0.8268 head_norm=2.057468
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.042378e-02
[S2] stored merged vector for next round verification (round=44)
[S2] DEBUG after merge:  round=44 metric=0.8266 head_norm=2.048323 delta_norm=0.020424
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=45 head_norm_before_train=2.048323 cos_to_last_merge=1.0000 (last merge round=44)
[S2] round=45 local utility u=0.056795 metrics={'f1_val': 0.8254920313912745, 'auprc': 0.9964655517885261, 'loss_val': 0.3516694197358773, 'psi': 0.8938814395501752}-{'f1_val': 0.8268228423786769, 'auprc': 0.9666639678676835, 'loss_val': 0.3838389692949238, 'psi': 0.8827592925742795}
[S3] START round=45 head_norm_before_train=1.675961 cos_to_last_merge=1.0000 (last merge round=44)
[S3] round=45 local utility u=0.025087 metrics={'f1_val': 0.9906678593791969, 'auprc': 0.9984210448311811, 'loss_val': 0.04150251942987908, 'psi': 0.9937691335599905}-{'f1_val': 0.9834030929706927, 'auprc': 0.9985780846002146, 'loss_val': 0.04855882173414541, 'psi': 0.9894730896225015}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] sending update (kind=head size=1805 to 1 peers)
[S4] START round=45 head_norm_before_train=2.048323 cos_to_last_merge=1.0000 (last merge round=44)
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.954622882635449, 'auprc': 0.9745427757742824, 'loss_val': 0.28242416101754597, 'psi': 0.9625908398909824}-{'f1_val': 0.9525218107502862, 'auprc': 0.9798297648024797, 'loss_val': 0.2812879930713714, 'psi': 0.9634449923711637}
[S5] START round=45 head_norm_before_train=2.088284 cos_to_last_merge=0.9999 (last merge round=42)
[S5] round=45 local utility u=0.000000 metrics={'f1_val': 0.7018144785999965, 'auprc': 0.9853617274427627, 'loss_val': 0.4535375399894612, 'psi': 0.8152333781371031}-{'f1_val': 0.997513339444841, 'auprc': 0.9992750362326963, 'loss_val': 0.10178962847471196, 'psi': 0.9982180181599831}
[S6] START round=45 head_norm_before_train=1.584543 cos_to_last_merge=0.9989 (last merge round=39)
[S6] round=45 local utility u=1.000000 metrics={'f1_val': 0.9510256322787318, 'auprc': 0.9666895937941933, 'loss_val': 0.19893757018827754, 'psi': 0.9572912168849164}-{'f1_val': 0.6042665155367251, 'auprc': 0.7731111400893985, 'loss_val': 0.859832601731866, 'psi': 0.6718043653577945}
[S7] START round=45 head_norm_before_train=1.330635 cos_to_last_merge=0.9855 (last merge round=35)
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.5905165529052839, 'auprc': 0.8044073151218153, 'loss_val': 0.5830178480865378, 'psi': 0.6760728577918964}-{'f1_val': 0.7130741657151985, 'auprc': 0.9916163046007248, 'loss_val': 0.24090422057549563, 'psi': 0.824491021269409}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=45 head_norm_before_train=1.690344 cos_to_last_merge=0.9767 (last merge round=34)
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.9925289693239863, 'auprc': 0.9956595332201705, 'loss_val': 0.05756961974040036, 'psi': 0.99378119488246}-{'f1_val': 0.9921646161217188, 'auprc': 0.9969485417344195, 'loss_val': 0.04612579254737378, 'psi': 0.9940781863667991}
[S9] START round=45 head_norm_before_train=2.082682 cos_to_last_merge=0.9997 (last merge round=42)
[S9] round=45 local utility u=0.000000 metrics={'f1_val': 0.9893150859224193, 'auprc': 0.9969331908226772, 'loss_val': 0.04617213349534623, 'psi': 0.9923623278825224}-{'f1_val': 0.9968525854255906, 'auprc': 0.9985673496450351, 'loss_val': 0.02566429219927104, 'psi': 0.9975384911133685}
[S10] START round=45 head_norm_before_train=1.474104 cos_to_last_merge=0.9452 (last merge round=30)
[S10] ⚠️ Model drifted since last merge! cos=0.945
[S10] round=45 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9936697810383297, 'loss_val': 0.05326752784633241, 'psi': 0.9945806158269568}-{'f1_val': 0.9951878390193748, 'auprc': 0.9956479691658779, 'loss_val': 0.05020217933534568, 'psi': 0.9953718910779761}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=45 head_norm_before_train=2.156945 (no previous merge yet)
[S11] round=45 local utility u=0.000000 metrics={'f1_val': 0.7949816811963019, 'auprc': 0.9937458860160102, 'loss_val': 0.4432071788355759, 'psi': 0.8744873631241852}-{'f1_val': 0.9963958538641108, 'auprc': 0.9945378925720167, 'loss_val': 0.022454705031670623, 'psi': 0.9956526693472731}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=45 head_norm_before_train=1.506131 cos_to_last_merge=0.8120 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.812
[S13] round=45 local utility u=0.104284 metrics={'f1_val': 0.6138087533697208, 'auprc': 0.6637021481592077, 'loss_val': 0.953162965267879, 'psi': 0.6337661112855155}-{'f1_val': 0.6042978721230647, 'auprc': 0.607156708012752, 'loss_val': 0.9350297553258201, 'psi': 0.6054414064789396}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S13] sending update (kind=head size=1808 to 1 peers)
[S14] START round=45 head_norm_before_train=2.125005 (no previous merge yet)
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.9971882020035234, 'auprc': 0.9989420370703227, 'loss_val': 0.01842599664819776, 'psi': 0.9978897360302431}-{'f1_val': 0.9974109942678281, 'auprc': 0.9988880782208803, 'loss_val': 0.018370865109723446, 'psi': 0.998001827849049}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=45 head_norm_before_train=1.361307 cos_to_last_merge=0.9872 (last merge round=35)
[S15] round=45 local utility u=0.000000 metrics={'f1_val': 0.8227162814508242, 'auprc': 0.9286759775747503, 'loss_val': 0.3057066995047757, 'psi': 0.8651001599003947}-{'f1_val': 0.894065678633402, 'auprc': 0.9841496459883001, 'loss_val': 0.21767394749454289, 'psi': 0.9300992655753613}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=45 head_norm_before_train=1.587314 cos_to_last_merge=1.0000 (last merge round=44)
[S16] round=45 local utility u=0.434997 metrics={'f1_val': 0.9220775488270396, 'auprc': 0.9893591300016729, 'loss_val': 0.36927606091652276, 'psi': 0.9489901812968929}-{'f1_val': 0.8488628046033313, 'auprc': 0.9846679629463118, 'loss_val': 0.7859088541095212, 'psi': 0.9031848679405234}
[S17] START round=45 head_norm_before_train=1.813551 cos_to_last_merge=0.7574 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.757
[S17] round=45 local utility u=0.301838 metrics={'f1_val': 0.6364725533644752, 'auprc': 0.9247178679677783, 'loss_val': 1.1874485305120563, 'psi': 0.7517706792057964}-{'f1_val': 0.6166531868941775, 'auprc': 0.8069244383048331, 'loss_val': 1.3188283295592955, 'psi': 0.6927616874584397}
[S17] not sending this round → trigger blocked (psi=0.752)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.894)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:57007
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] ⇄ pheromone p=0.004 → S5@127.0.0.1:57005
[S8] ⇄ pheromone p=0.009 → S3@127.0.0.1:57003
[S16] sending update (kind=head size=1804 to 1 peers)
[S2] ⇄ pheromone p=0.065 → S4@127.0.0.1:57004
[S4] ⇄ pheromone p=0.025 → S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:57016
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=45 metric=0.7018 head_norm=2.090391
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.340795e-02
[S5] stored merged vector for next round verification (round=45)
[S5] DEBUG after merge:  round=45 metric=0.7019 head_norm=2.086273 delta_norm=0.033408
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.045 → S9@127.0.0.1:57010
[S6] RECEIVED delta(kind=head bytes=1804) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.602440)
[S6] loaded HEAD from S16 (vec_in norm=1.602440)
[S6] cosine check vs S16: cos=0.9992
[S6] BUFFERED delta from S16 (total buffered=1)
[S6] sending update (kind=head size=1800 to 1 peers)
[S16] ⇄ pheromone p=0.157 → S6@127.0.0.1:57007
[S16] RECEIVED delta(kind=head bytes=1800) from S6
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.595147)
[S16] loaded HEAD from S6 (vec_in norm=1.595147)
[S16] cosine check vs S6: cos=0.9992
[S16] BUFFERED delta from S6 (total buffered=1)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=45 metric=0.9510 head_norm=1.595147
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.312051e-02
[S6] stored merged vector for next round verification (round=45)
[S6] DEBUG after merge:  round=45 metric=0.9549 head_norm=1.598454 delta_norm=0.033121
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.392 → S16@127.0.0.1:57016
[S2] START round=46 head_norm_before_train=2.058270 cos_to_last_merge=1.0000 (last merge round=44)
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.8316052945279282, 'auprc': 0.8574586507940645, 'loss_val': 0.35522482763539376, 'psi': 0.8419466370343827}-{'f1_val': 0.8254920313912745, 'auprc': 0.9964655517885261, 'loss_val': 0.3516694197358773, 'psi': 0.8938814395501752}
[S3] START round=46 head_norm_before_train=1.699585 cos_to_last_merge=0.9999 (last merge round=44)
[S3] round=46 local utility u=0.000000 metrics={'f1_val': 0.9580368960519132, 'auprc': 0.9910289421968781, 'loss_val': 0.1185742272420445, 'psi': 0.9712337145098991}-{'f1_val': 0.9906678593791969, 'auprc': 0.9984210448311811, 'loss_val': 0.04150251942987908, 'psi': 0.9937691335599905}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=46 head_norm_before_train=2.053192 cos_to_last_merge=1.0000 (last merge round=44)
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.944001196391728, 'auprc': 0.942069738077569, 'loss_val': 0.29943222547212556, 'psi': 0.9432286130660643}-{'f1_val': 0.954622882635449, 'auprc': 0.9745427757742824, 'loss_val': 0.28242416101754597, 'psi': 0.9625908398909824}
[S5] START round=46 head_norm_before_train=2.086273 cos_to_last_merge=1.0000 (last merge round=45)
[S5] round=46 local utility u=1.000000 metrics={'f1_val': 0.9974365845193254, 'auprc': 0.9983164974823686, 'loss_val': 0.033800745931792206, 'psi': 0.9977885497045427}-{'f1_val': 0.7018144785999965, 'auprc': 0.9853617274427627, 'loss_val': 0.4535375399894612, 'psi': 0.8152333781371031}
[S6] START round=46 head_norm_before_train=1.598454 cos_to_last_merge=1.0000 (last merge round=45)
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.6214870004070301, 'auprc': 0.8245799886576173, 'loss_val': 0.7592149453376003, 'psi': 0.702724195707265}-{'f1_val': 0.9510256322787318, 'auprc': 0.9666895937941933, 'loss_val': 0.19893757018827754, 'psi': 0.9572912168849164}
[S7] START round=46 head_norm_before_train=1.340961 cos_to_last_merge=0.9842 (last merge round=35)
[S7] round=46 local utility u=0.189038 metrics={'f1_val': 0.6394131045594932, 'auprc': 0.8145809172546628, 'loss_val': 0.5288410959075696, 'psi': 0.7094802296375611}-{'f1_val': 0.5905165529052839, 'auprc': 0.8044073151218153, 'loss_val': 0.5830178480865378, 'psi': 0.6760728577918964}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=46 head_norm_before_train=1.702997 cos_to_last_merge=0.9755 (last merge round=34)
[S8] round=46 local utility u=0.001886 metrics={'f1_val': 0.9905027553548844, 'auprc': 0.9964342238325554, 'loss_val': 0.04396457271451472, 'psi': 0.9928753427459528}-{'f1_val': 0.9925289693239863, 'auprc': 0.9956595332201705, 'loss_val': 0.05756961974040036, 'psi': 0.99378119488246}
[S9] START round=46 head_norm_before_train=2.095681 cos_to_last_merge=0.9996 (last merge round=42)
[S9] round=46 local utility u=0.035945 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9985771614408285, 'loss_val': 0.02443941081961547, 'psi': 0.9975424158316857}-{'f1_val': 0.9893150859224193, 'auprc': 0.9969331908226772, 'loss_val': 0.04617213349534623, 'psi': 0.9923623278825224}
[S10] START round=46 head_norm_before_train=1.495106 cos_to_last_merge=0.9426 (last merge round=30)
[S10] ⚠️ Model drifted since last merge! cos=0.943
[S10] round=46 local utility u=0.007974 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9956465617558546, 'loss_val': 0.0432497782857564, 'psi': 0.9953713281139667}-{'f1_val': 0.9951878390193748, 'auprc': 0.9936697810383297, 'loss_val': 0.05326752784633241, 'psi': 0.9945806158269568}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=46 head_norm_before_train=2.163363 (no previous merge yet)
[S11] round=46 local utility u=0.814528 metrics={'f1_val': 0.9963958538641108, 'auprc': 0.99408119071975, 'loss_val': 0.02364131917051049, 'psi': 0.9954699886063665}-{'f1_val': 0.7949816811963019, 'auprc': 0.9937458860160102, 'loss_val': 0.4432071788355759, 'psi': 0.8744873631241852}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=46 head_norm_before_train=1.516280 cos_to_last_merge=0.8107 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.811
[S13] round=46 local utility u=0.051607 metrics={'f1_val': 0.6354282057170486, 'auprc': 0.6224675463442795, 'loss_val': 0.855962211830949, 'psi': 0.630243941967941}-{'f1_val': 0.6138087533697208, 'auprc': 0.6637021481592077, 'loss_val': 0.953162965267879, 'psi': 0.6337661112855155}
[S13] not sending this round → trigger blocked (psi=0.630)
[S14] START round=46 head_norm_before_train=2.131209 (no previous merge yet)
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.9973833833620065, 'auprc': 0.9988348992081714, 'loss_val': 0.020237270561873744, 'psi': 0.9979639897004724}-{'f1_val': 0.9971882020035234, 'auprc': 0.9989420370703227, 'loss_val': 0.01842599664819776, 'psi': 0.9978897360302431}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=46 head_norm_before_train=1.382409 cos_to_last_merge=0.9853 (last merge round=35)
[S15] round=46 local utility u=0.418677 metrics={'f1_val': 0.9078267000062054, 'auprc': 0.9937457063967908, 'loss_val': 0.17422536082288798, 'psi': 0.9421943025624395}-{'f1_val': 0.8227162814508242, 'auprc': 0.9286759775747503, 'loss_val': 0.3057066995047757, 'psi': 0.8651001599003947}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=46 head_norm_before_train=1.602440 cos_to_last_merge=1.0000 (last merge round=44)
[S16] round=46 local utility u=0.168461 metrics={'f1_val': 0.9429698862143401, 'auprc': 0.9920542321848462, 'loss_val': 0.16579370670725949, 'psi': 0.9626036246025426}-{'f1_val': 0.9220775488270396, 'auprc': 0.9893591300016729, 'loss_val': 0.36927606091652276, 'psi': 0.9489901812968929}
[S17] START round=46 head_norm_before_train=1.824690 cos_to_last_merge=0.7569 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.757
[S17] round=46 local utility u=0.000000 metrics={'f1_val': 0.635191852386539, 'auprc': 0.9090745764973336, 'loss_val': 1.2136430908841145, 'psi': 0.7447449420308568}-{'f1_val': 0.6364725533644752, 'auprc': 0.9247178679677783, 'loss_val': 1.1874485305120563, 'psi': 0.7517706792057964}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:57005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S8] → sending delta(kind=head bytes=1807) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:57010
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.963)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=46 metric=0.9430 head_norm=1.618232
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.934340e-02
[S16] stored merged vector for next round verification (round=46)
[S16] DEBUG after merge:  round=46 metric=0.9430 head_norm=1.606249 delta_norm=0.039343
[S16] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S5] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1807 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] RECEIVED delta(kind=head bytes=1796) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=2.085011)
[S9] loaded HEAD from S5 (vec_in norm=2.085011)
[S9] cosine check vs S5: cos=0.9996
[S9] BUFFERED delta from S5 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1807) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.716341)
[S3] loaded HEAD from S8 (vec_in norm=1.716341)
[S3] cosine check vs S8: cos=0.9953
[S3] BUFFERED delta from S8 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1800) from S9
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=2.110088)
[S5] loaded HEAD from S9 (vec_in norm=2.110088)
[S5] cosine check vs S9: cos=0.9996
[S5] BUFFERED delta from S9 (total buffered=1)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=46 metric=0.9969 head_norm=2.110088
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.108148e-02
[S9] stored merged vector for next round verification (round=46)
[S9] DEBUG after merge:  round=46 metric=0.9969 head_norm=2.097357 delta_norm=0.031081
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=46 metric=0.9974 head_norm=2.085011
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.108149e-02
[S5] stored merged vector for next round verification (round=46)
[S5] DEBUG after merge:  round=46 metric=0.9974 head_norm=2.097357 delta_norm=0.031081
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=47 head_norm_before_train=2.068731 cos_to_last_merge=1.0000 (last merge round=44)
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.7100592351046165, 'auprc': 0.9833408140152793, 'loss_val': 0.464486669861336, 'psi': 0.8193718666688816}-{'f1_val': 0.8316052945279282, 'auprc': 0.8574586507940645, 'loss_val': 0.35522482763539376, 'psi': 0.8419466370343827}
[S3] START round=47 head_norm_before_train=1.719975 cos_to_last_merge=0.9995 (last merge round=44)
[S3] round=47 local utility u=0.159262 metrics={'f1_val': 0.9944956746276894, 'auprc': 0.9984344568340564, 'loss_val': 0.04101959923129623, 'psi': 0.9960711875102362}-{'f1_val': 0.9580368960519132, 'auprc': 0.9910289421968781, 'loss_val': 0.1185742272420445, 'psi': 0.9712337145098991}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=47 metric=0.9945 head_norm=1.735243
[S3] _apply_head_vector_avg (torch): Δ‖w‖=9.189924e-02
[S3] stored merged vector for next round verification (round=47)
[S3] DEBUG after merge:  round=47 metric=0.9945 head_norm=1.723369 delta_norm=0.091899
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S4] START round=47 head_norm_before_train=2.055876 cos_to_last_merge=1.0000 (last merge round=44)
[S4] round=47 local utility u=0.061440 metrics={'f1_val': 0.9516544707846046, 'auprc': 0.962902912483777, 'loss_val': 0.28497139425764495, 'psi': 0.9561538474642736}-{'f1_val': 0.944001196391728, 'auprc': 0.942069738077569, 'loss_val': 0.29943222547212556, 'psi': 0.9432286130660643}
[S5] START round=47 head_norm_before_train=2.097357 cos_to_last_merge=1.0000 (last merge round=46)
[S5] round=47 local utility u=0.004011 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9995351834904225, 'loss_val': 0.02723230156070106, 'psi': 0.9980558085628076}-{'f1_val': 0.9974365845193254, 'auprc': 0.9983164974823686, 'loss_val': 0.033800745931792206, 'psi': 0.9977885497045427}
[S6] START round=47 head_norm_before_train=1.605451 cos_to_last_merge=0.9999 (last merge round=45)
[S6] round=47 local utility u=1.000000 metrics={'f1_val': 0.8459290870796643, 'auprc': 0.9438620349567821, 'loss_val': 0.3921153525089169, 'psi': 0.8851022662305115}-{'f1_val': 0.6214870004070301, 'auprc': 0.8245799886576173, 'loss_val': 0.7592149453376003, 'psi': 0.702724195707265}
[S7] START round=47 head_norm_before_train=1.352021 cos_to_last_merge=0.9828 (last merge round=35)
[S7] round=47 local utility u=0.000000 metrics={'f1_val': 0.6285903743581465, 'auprc': 0.7976556763448959, 'loss_val': 0.5765513082314714, 'psi': 0.6962164951528462}-{'f1_val': 0.6394131045594932, 'auprc': 0.8145809172546628, 'loss_val': 0.5288410959075696, 'psi': 0.7094802296375611}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=47 head_norm_before_train=1.716341 cos_to_last_merge=0.9741 (last merge round=34)
[S8] round=47 local utility u=0.011909 metrics={'f1_val': 0.9939122747783468, 'auprc': 0.9961958771833573, 'loss_val': 0.03988790778897795, 'psi': 0.994825715740351}-{'f1_val': 0.9905027553548844, 'auprc': 0.9964342238325554, 'loss_val': 0.04396457271451472, 'psi': 0.9928753427459528}
[S9] START round=47 head_norm_before_train=2.097357 cos_to_last_merge=1.0000 (last merge round=46)
[S9] round=47 local utility u=0.001901 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.998949807279286, 'loss_val': 0.023256842316705002, 'psi': 0.9978416704190001}-{'f1_val': 0.9968525854255906, 'auprc': 0.9985771614408285, 'loss_val': 0.02443941081961547, 'psi': 0.9975424158316857}
[S10] START round=47 head_norm_before_train=1.514977 cos_to_last_merge=0.9401 (last merge round=30)
[S10] ⚠️ Model drifted since last merge! cos=0.940
[S10] round=47 local utility u=0.000702 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9956498387132511, 'loss_val': 0.04185606693777207, 'psi': 0.9953726388969253}-{'f1_val': 0.9951878390193748, 'auprc': 0.9956465617558546, 'loss_val': 0.0432497782857564, 'psi': 0.9953713281139667}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=47 head_norm_before_train=2.171367 (no previous merge yet)
[S11] round=47 local utility u=0.004329 metrics={'f1_val': 0.9963958538641108, 'auprc': 0.9960332666069003, 'loss_val': 0.020839003641442068, 'psi': 0.9962508189612267}-{'f1_val': 0.9963958538641108, 'auprc': 0.99408119071975, 'loss_val': 0.02364131917051049, 'psi': 0.9954699886063665}
[S11] not sending this round → trigger blocked (psi=0.996)
[S13] START round=47 head_norm_before_train=1.524127 cos_to_last_merge=0.8102 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.810
[S13] round=47 local utility u=0.000000 metrics={'f1_val': 0.5995738108112689, 'auprc': 0.6183427658763782, 'loss_val': 1.0605061862521559, 'psi': 0.6070813928373127}-{'f1_val': 0.6354282057170486, 'auprc': 0.6224675463442795, 'loss_val': 0.855962211830949, 'psi': 0.630243941967941}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=47 head_norm_before_train=2.135148 (no previous merge yet)
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.9953052378684425, 'auprc': 0.9988421883056481, 'loss_val': 0.02771515543223508, 'psi': 0.9967200180433247}-{'f1_val': 0.9973833833620065, 'auprc': 0.9988348992081714, 'loss_val': 0.020237270561873744, 'psi': 0.9979639897004724}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=47 head_norm_before_train=1.403072 cos_to_last_merge=0.9834 (last merge round=35)
[S15] round=47 local utility u=0.320205 metrics={'f1_val': 0.9931832020571294, 'auprc': 0.9975850719030652, 'loss_val': 0.057471690869137886, 'psi': 0.9949439499955037}-{'f1_val': 0.9078267000062054, 'auprc': 0.9937457063967908, 'loss_val': 0.17422536082288798, 'psi': 0.9421943025624395}
[S15] not sending this round → trigger blocked (psi=0.995)
[S16] START round=47 head_norm_before_train=1.606249 cos_to_last_merge=1.0000 (last merge round=46)
[S16] round=47 local utility u=0.183561 metrics={'f1_val': 0.9873600478769364, 'auprc': 0.9939462418411723, 'loss_val': 0.07068811095444952, 'psi': 0.9899945254626308}-{'f1_val': 0.9429698862143401, 'auprc': 0.9920542321848462, 'loss_val': 0.16579370670725949, 'psi': 0.9626036246025426}
[S17] START round=47 head_norm_before_train=1.836768 cos_to_last_merge=0.7563 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.756
[S17] round=47 local utility u=0.007419 metrics={'f1_val': 0.6345606852399963, 'auprc': 0.9055833820780945, 'loss_val': 1.1845446353457918, 'psi': 0.7429697639752355}-{'f1_val': 0.635191852386539, 'auprc': 0.9090745764973336, 'loss_val': 1.2136430908841145, 'psi': 0.7447449420308568}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.998)
[S9] not sending this round → trigger blocked (psi=0.998)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:57002
[S8] not sending this round → trigger blocked (psi=0.995)
[S4] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:57016
[S2] RECEIVED delta(kind=head bytes=1798) from S4
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=2.054703)
[S2] loaded HEAD from S4 (vec_in norm=2.054703)
[S2] cosine check vs S4: cos=0.9998
[S2] BUFFERED delta from S4 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1803) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.623521)
[S6] loaded HEAD from S16 (vec_in norm=1.623521)
[S6] cosine check vs S16: cos=0.9997
[S6] BUFFERED delta from S16 (total buffered=1)
[S6] sending update (kind=head size=1802 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1802) from S6
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.613294)
[S16] loaded HEAD from S6 (vec_in norm=1.613294)
[S16] cosine check vs S6: cos=0.9997
[S16] BUFFERED delta from S6 (total buffered=1)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=47 metric=0.8459 head_norm=1.613294
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.000457e-02
[S6] stored merged vector for next round verification (round=47)
[S6] DEBUG after merge:  round=47 metric=0.8463 head_norm=1.618292 delta_norm=0.020005
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=48 head_norm_before_train=2.076032 cos_to_last_merge=0.9999 (last merge round=44)
[S2] round=48 local utility u=0.152949 metrics={'f1_val': 0.8310088499953413, 'auprc': 0.8222843688333763, 'loss_val': 0.4011162291757666, 'psi': 0.8275190575305553}-{'f1_val': 0.7100592351046165, 'auprc': 0.9833408140152793, 'loss_val': 0.464486669861336, 'psi': 0.8193718666688816}
[S3] START round=48 head_norm_before_train=1.723369 cos_to_last_merge=1.0000 (last merge round=47)
[S3] round=48 local utility u=0.000000 metrics={'f1_val': 0.9716666365020169, 'auprc': 0.9977952402716359, 'loss_val': 0.07303188748778247, 'psi': 0.9821180780098646}-{'f1_val': 0.9944956746276894, 'auprc': 0.9984344568340564, 'loss_val': 0.04101959923129623, 'psi': 0.9960711875102362}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=48 head_norm_before_train=2.054703 cos_to_last_merge=0.9999 (last merge round=44)
[S4] round=48 local utility u=0.000000 metrics={'f1_val': 0.9456440709813543, 'auprc': 0.9469868099035779, 'loss_val': 0.29751576646695876, 'psi': 0.9461811665502438}-{'f1_val': 0.9516544707846046, 'auprc': 0.962902912483777, 'loss_val': 0.28497139425764495, 'psi': 0.9561538474642736}
[S5] START round=48 head_norm_before_train=2.098645 cos_to_last_merge=1.0000 (last merge round=46)
[S5] round=48 local utility u=0.000853 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9991829493923866, 'loss_val': 0.024468719758179516, 'psi': 0.9979149149235933}-{'f1_val': 0.9970695586110643, 'auprc': 0.9995351834904225, 'loss_val': 0.02723230156070106, 'psi': 0.9980558085628076}
[S6] START round=48 head_norm_before_train=1.618292 cos_to_last_merge=1.0000 (last merge round=47)
[S6] round=48 local utility u=0.000000 metrics={'f1_val': 0.7105248518101562, 'auprc': 0.933408570331504, 'loss_val': 0.6805850163521455, 'psi': 0.7996783392186954}-{'f1_val': 0.8459290870796643, 'auprc': 0.9438620349567821, 'loss_val': 0.3921153525089169, 'psi': 0.8851022662305115}
[S7] START round=48 head_norm_before_train=1.362348 cos_to_last_merge=0.9815 (last merge round=35)
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.6217778804885298, 'auprc': 0.8071256926186484, 'loss_val': 0.669943846462954, 'psi': 0.6959170053405772}-{'f1_val': 0.6285903743581465, 'auprc': 0.7976556763448959, 'loss_val': 0.5765513082314714, 'psi': 0.6962164951528462}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=48 head_norm_before_train=1.727681 cos_to_last_merge=0.9729 (last merge round=34)
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.990363285929422, 'auprc': 0.9961707635132667, 'loss_val': 0.0426293785051604, 'psi': 0.9926862769629599}-{'f1_val': 0.9939122747783468, 'auprc': 0.9961958771833573, 'loss_val': 0.03988790778897795, 'psi': 0.994825715740351}
[S9] START round=48 head_norm_before_train=2.110457 cos_to_last_merge=1.0000 (last merge round=46)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.9880286744602689, 'auprc': 0.9989670023487444, 'loss_val': 0.0484596692652809, 'psi': 0.9924040056156591}-{'f1_val': 0.9971029125121428, 'auprc': 0.998949807279286, 'loss_val': 0.023256842316705002, 'psi': 0.9978416704190001}
[S10] START round=48 head_norm_before_train=1.531358 cos_to_last_merge=0.9380 (last merge round=30)
[S10] ⚠️ Model drifted since last merge! cos=0.938
[S10] round=48 local utility u=0.000632 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9956929418929538, 'loss_val': 0.040720849099237066, 'psi': 0.9953898801688064}-{'f1_val': 0.9951878390193748, 'auprc': 0.9956498387132511, 'loss_val': 0.04185606693777207, 'psi': 0.9953726388969253}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=48 head_norm_before_train=2.179845 (no previous merge yet)
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9956941159715058, 'loss_val': 0.022429217336740092, 'psi': 0.9959701312350495}-{'f1_val': 0.9963958538641108, 'auprc': 0.9960332666069003, 'loss_val': 0.020839003641442068, 'psi': 0.9962508189612267}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=48 head_norm_before_train=1.532110 cos_to_last_merge=0.8094 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.809
[S13] round=48 local utility u=0.077708 metrics={'f1_val': 0.6213830663401353, 'auprc': 0.5944016020184334, 'loss_val': 0.9641213067614156, 'psi': 0.6105904806114546}-{'f1_val': 0.5995738108112689, 'auprc': 0.6183427658763782, 'loss_val': 1.0605061862521559, 'psi': 0.6070813928373127}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] sending update (kind=head size=1806 to 1 peers)
[S14] START round=48 head_norm_before_train=2.137790 (no previous merge yet)
[S14] round=48 local utility u=0.013055 metrics={'f1_val': 0.9977998904431125, 'auprc': 0.9988818371908607, 'loss_val': 0.016691211029695296, 'psi': 0.9982326691422116}-{'f1_val': 0.9953052378684425, 'auprc': 0.9988421883056481, 'loss_val': 0.02771515543223508, 'psi': 0.9967200180433247}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=48 head_norm_before_train=1.423539 cos_to_last_merge=0.9815 (last merge round=35)
[S15] round=48 local utility u=0.009863 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.994030436810819, 'loss_val': 0.048462977884607836, 'psi': 0.99566017575684}-{'f1_val': 0.9931832020571294, 'auprc': 0.9975850719030652, 'loss_val': 0.057471690869137886, 'psi': 0.9949439499955037}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=48 head_norm_before_train=1.623521 cos_to_last_merge=1.0000 (last merge round=46)
[S16] round=48 local utility u=0.016885 metrics={'f1_val': 0.9906321843106889, 'auprc': 0.9940349880657828, 'loss_val': 0.0568164311683187, 'psi': 0.9919933058127265}-{'f1_val': 0.9873600478769364, 'auprc': 0.9939462418411723, 'loss_val': 0.07068811095444952, 'psi': 0.9899945254626308}
[S17] START round=48 head_norm_before_train=1.846927 cos_to_last_merge=0.7556 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.756
[S17] round=48 local utility u=0.000000 metrics={'f1_val': 0.6227403300746726, 'auprc': 0.8642839333027796, 'loss_val': 1.3250048097194478, 'psi': 0.7193577713659154}-{'f1_val': 0.6345606852399963, 'auprc': 0.9055833820780945, 'loss_val': 1.1845446353457918, 'psi': 0.7429697639752355}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.992)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:57004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:57010
[S5] sending update (kind=head size=1800 to 1 peers)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=48 metric=0.9906 head_norm=1.638795
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.737482e-02
[S16] stored merged vector for next round verification (round=48)
[S16] DEBUG after merge:  round=48 metric=0.9906 head_norm=1.625864 delta_norm=0.027375
[S16] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] sending update (kind=head size=1802 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] RECEIVED delta(kind=head bytes=1802) from S2
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=2.082856)
[S4] loaded HEAD from S2 (vec_in norm=2.082856)
[S4] cosine check vs S2: cos=0.9997
[S4] BUFFERED delta from S2 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1800) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=2.101257)
[S9] loaded HEAD from S5 (vec_in norm=2.101257)
[S9] cosine check vs S5: cos=0.9999
[S9] BUFFERED delta from S5 (total buffered=1)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=48 metric=0.8310 head_norm=2.082856
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.668554e-02
[S2] stored merged vector for next round verification (round=48)
[S2] DEBUG after merge:  round=48 metric=0.8310 head_norm=2.068655 delta_norm=0.026686
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=49 head_norm_before_train=2.068655 cos_to_last_merge=1.0000 (last merge round=48)
[S2] round=49 local utility u=0.130525 metrics={'f1_val': 0.8011417891191915, 'auprc': 0.980434417829543, 'loss_val': 0.4353139207188925, 'psi': 0.8728588406033322}-{'f1_val': 0.8310088499953413, 'auprc': 0.8222843688333763, 'loss_val': 0.4011162291757666, 'psi': 0.8275190575305553}
[S3] START round=49 head_norm_before_train=1.739026 cos_to_last_merge=0.9999 (last merge round=47)
[S3] round=49 local utility u=0.035617 metrics={'f1_val': 0.9843617842650957, 'auprc': 0.9978666574384847, 'loss_val': 0.07818264879949226, 'psi': 0.9897637335344514}-{'f1_val': 0.9716666365020169, 'auprc': 0.9977952402716359, 'loss_val': 0.07303188748778247, 'psi': 0.9821180780098646}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] sending update (kind=head size=1804 to 1 peers)
[S4] START round=49 head_norm_before_train=2.056846 cos_to_last_merge=0.9999 (last merge round=44)
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.9428828027475125, 'auprc': 0.9392762386016114, 'loss_val': 0.3005494976274707, 'psi': 0.9414401770891521}-{'f1_val': 0.9456440709813543, 'auprc': 0.9469868099035779, 'loss_val': 0.29751576646695876, 'psi': 0.9461811665502438}
[S5] START round=49 head_norm_before_train=2.101257 cos_to_last_merge=1.0000 (last merge round=46)
[S5] round=49 local utility u=0.000000 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9984787972774618, 'loss_val': 0.023118412711055494, 'psi': 0.9976332540776234}-{'f1_val': 0.9970695586110643, 'auprc': 0.9991829493923866, 'loss_val': 0.024468719758179516, 'psi': 0.9979149149235933}
[S6] START round=49 head_norm_before_train=1.627390 cos_to_last_merge=1.0000 (last merge round=47)
[S6] round=49 local utility u=0.479717 metrics={'f1_val': 0.8313289543364645, 'auprc': 0.9464073706479073, 'loss_val': 0.48497246576084196, 'psi': 0.8773603208610417}-{'f1_val': 0.7105248518101562, 'auprc': 0.933408570331504, 'loss_val': 0.6805850163521455, 'psi': 0.7996783392186954}
[S7] START round=49 head_norm_before_train=1.377447 cos_to_last_merge=0.9797 (last merge round=35)
[S7] round=49 local utility u=0.010224 metrics={'f1_val': 0.611364015148714, 'auprc': 0.8091599701496356, 'loss_val': 0.5931154780566814, 'psi': 0.6904823971490825}-{'f1_val': 0.6217778804885298, 'auprc': 0.8071256926186484, 'loss_val': 0.669943846462954, 'psi': 0.6959170053405772}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] sending update (kind=head size=1806 to 1 peers)
[S8] START round=49 head_norm_before_train=1.737263 cos_to_last_merge=0.9720 (last merge round=34)
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.9892831449862951, 'auprc': 0.996347352406131, 'loss_val': 0.04315543800043645, 'psi': 0.9921088279542295}-{'f1_val': 0.990363285929422, 'auprc': 0.9961707635132667, 'loss_val': 0.0426293785051604, 'psi': 0.9926862769629599}
[S9] START round=49 head_norm_before_train=2.117061 cos_to_last_merge=0.9999 (last merge round=46)
[S9] round=49 local utility u=0.038148 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9985976952525272, 'loss_val': 0.023998611212916212, 'psi': 0.9975506293563652}-{'f1_val': 0.9880286744602689, 'auprc': 0.9989670023487444, 'loss_val': 0.0484596692652809, 'psi': 0.9924040056156591}
[S10] START round=49 head_norm_before_train=1.547297 cos_to_last_merge=0.9359 (last merge round=30)
[S10] ⚠️ Model drifted since last merge! cos=0.936
[S10] round=49 local utility u=0.000490 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9956704513460463, 'loss_val': 0.03967359338506152, 'psi': 0.9953808839500433}-{'f1_val': 0.9951878390193748, 'auprc': 0.9956929418929538, 'loss_val': 0.040720849099237066, 'psi': 0.9953898801688064}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=49 head_norm_before_train=2.188887 (no previous merge yet)
[S11] round=49 local utility u=0.000696 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9952039888214816, 'loss_val': 0.022046163175252785, 'psi': 0.9960220779123209}-{'f1_val': 0.9961541414107454, 'auprc': 0.9956941159715058, 'loss_val': 0.022429217336740092, 'psi': 0.9959701312350495}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=49 head_norm_before_train=1.539148 cos_to_last_merge=0.8086 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.809
[S13] round=49 local utility u=0.258771 metrics={'f1_val': 0.6332847159950061, 'auprc': 0.7024178623335124, 'loss_val': 0.8420378219309039, 'psi': 0.6609379745304087}-{'f1_val': 0.6213830663401353, 'auprc': 0.5944016020184334, 'loss_val': 0.9641213067614156, 'psi': 0.6105904806114546}
[S13] not sending this round → trigger blocked (psi=0.661)
[S14] START round=49 head_norm_before_train=2.143485 (no previous merge yet)
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.9980427385234248, 'auprc': 0.999034587883078, 'loss_val': 0.028417188143888446, 'psi': 0.9984394782672861}-{'f1_val': 0.9977998904431125, 'auprc': 0.9988818371908607, 'loss_val': 0.016691211029695296, 'psi': 0.9982326691422116}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=49 head_norm_before_train=1.441632 cos_to_last_merge=0.9799 (last merge round=35)
[S15] round=49 local utility u=0.000000 metrics={'f1_val': 0.7800810492645117, 'auprc': 0.9306170555785634, 'loss_val': 0.3413523594584453, 'psi': 0.8402954517901324}-{'f1_val': 0.9967466683875206, 'auprc': 0.994030436810819, 'loss_val': 0.048462977884607836, 'psi': 0.99566017575684}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=49 head_norm_before_train=1.625864 cos_to_last_merge=1.0000 (last merge round=48)
[S16] round=49 local utility u=0.000242 metrics={'f1_val': 0.9906321843106889, 'auprc': 0.9941516999238073, 'loss_val': 0.056681740245777205, 'psi': 0.9920399905559363}-{'f1_val': 0.9906321843106889, 'auprc': 0.9940349880657828, 'loss_val': 0.0568164311683187, 'psi': 0.9919933058127265}
[S17] START round=49 head_norm_before_train=1.854238 cos_to_last_merge=0.7550 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.755
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.6176928845740729, 'auprc': 0.8597847499464184, 'loss_val': 1.3389199239633545, 'psi': 0.7145296307230111}-{'f1_val': 0.6227403300746726, 'auprc': 0.8642839333027796, 'loss_val': 1.3250048097194478, 'psi': 0.7193577713659154}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:57007
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:57005
[S2] not sending this round → trigger blocked (psi=0.873)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:57016
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=49 metric=0.9429 head_norm=2.054501
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.283503e-02
[S4] stored merged vector for next round verification (round=49)
[S4] DEBUG after merge:  round=49 metric=0.9429 head_norm=2.068466 delta_norm=0.032835
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S5] RECEIVED delta(kind=head bytes=1796) from S9
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=2.128199)
[S5] loaded HEAD from S9 (vec_in norm=2.128199)
[S5] cosine check vs S9: cos=0.9998
[S5] BUFFERED delta from S9 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1803) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.641113)
[S6] loaded HEAD from S16 (vec_in norm=1.641113)
[S6] cosine check vs S16: cos=0.9998
[S6] BUFFERED delta from S16 (total buffered=1)
[S6] sending update (kind=head size=1800 to 1 peers)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=49 metric=0.9969 head_norm=2.128199
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.321428e-02
[S9] stored merged vector for next round verification (round=49)
[S9] DEBUG after merge:  round=49 metric=0.9969 head_norm=2.114643 delta_norm=0.023214
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] RECEIVED delta(kind=head bytes=1800) from S6
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.634409)
[S16] loaded HEAD from S6 (vec_in norm=1.634409)
[S16] cosine check vs S6: cos=0.9998
[S16] BUFFERED delta from S6 (total buffered=1)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=49 metric=0.8313 head_norm=1.634409
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.779473e-02
[S6] stored merged vector for next round verification (round=49)
[S6] DEBUG after merge:  round=49 metric=0.8365 head_norm=1.637668 delta_norm=0.017795
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[runner] rounds complete.
[runner] all agents stopped.
