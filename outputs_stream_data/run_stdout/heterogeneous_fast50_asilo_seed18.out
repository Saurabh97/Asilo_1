[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:45903
[S3] → join 127.0.0.1:45902
[S4] → join 127.0.0.1:45902
[S5] → join 127.0.0.1:45902
[S6] → join 127.0.0.1:45902
[S7] → join 127.0.0.1:45902
[S8] → join 127.0.0.1:45902
[S9] → join 127.0.0.1:45902
[S10] → join 127.0.0.1:45902
[S11] → join 127.0.0.1:45902
[S13] → join 127.0.0.1:45902
[S14] → join 127.0.0.1:45902
[S15] → join 127.0.0.1:45902
[S16] → join 127.0.0.1:45902
[S17] → join 127.0.0.1:45902
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.143826 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.169447 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.202392 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.127006 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.135510 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.178016 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.162680 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.195922 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.168774 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.138299 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.190330 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.147960 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.201590 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.148792 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.109060 (no previous merge yet)
[S9]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S3] + discovered S16
[S3] + discovered S9
[S3] + discovered S14
[S4] + discovered S2
[S4] + discovered S3
[S3] + discovered S8
[S3] + discovered S15
[S3] + discovered S17
[S3] + discovered S10
[S3] + discovered S4
[S3] + discovered S6
[S3] + discovered S13
[S3] + discovered S7
[S3] + discovered S11
[S3] + discovered S5
[S4] + discovered S15
[S4] + discovered S17
[S4] + discovered S10
[S4] + discovered S6
[S4] + discovered S13
[S4] + discovered S7
[S4] + discovered S5
[S4] + discovered S11
[S4] + discovered S16
[S4] + discovered S8
[S5] + discovered S4
[S4] + discovered S9
[S5] + discovered S3
[S4] + discovered S14
[S5] + discovered S2
[S5] + discovered S11
[S5] + discovered S15
[S5] + discovered S16
[S5] + discovered S8
[S5] + discovered S7
[S5] + discovered S6
[S5] + discovered S10
[S5] + discovered S14
[S5] + discovered S13
[S5] + discovered S9
[S5] + discovered S17
[S6] + discovered S2
[S6] + discovered S5
[S6] + discovered S3
[S6] + discovered S4
[S6] + discovered S7
[S6] + discovered S17
[S6] + discovered S13
[S6] + discovered S14
[S6] + discovered S8
[S7] + discovered S3
[S7] + discovered S4
[S6] + discovered S11
[S7] + discovered S5
[S6] + discovered S15
[S7] + discovered S6
[S6] + discovered S9
[S7] + discovered S2
[S6] + discovered S10
[S6] + discovered S16
[S7] + discovered S9
[S7] + discovered S17
[S7] + discovered S14
[S8] + discovered S2
[S8] + discovered S4
[S8] + discovered S5
[S8] + discovered S7
[S8] + discovered S6
[S8] + discovered S3
[S7] + discovered S8
[S7] + discovered S13
[S7] + discovered S10
[S7] + discovered S11
[S7] + discovered S16
[S7] + discovered S15
[S8] + discovered S16
[S8] + discovered S9
[S8] + discovered S17
[S8] + discovered S13
[S8] + discovered S15
[S9] + discovered S2
[S9] + discovered S4
[S9] + discovered S7
[S9] + discovered S8
[S9] + discovered S3
[S8] + discovered S14
[S9] + discovered S6
[S9] + discovered S5
[S8] + discovered S10
[S8] + discovered S11
[S9] + discovered S11
[S9] + discovered S10
[S10] + discovered S4
[S10] + discovered S2
[S9] + discovered S16
[S10] + discovered S9
[S10] + discovered S8
[S9] + discovered S15
[S10] + discovered S5
[S10] + discovered S7
[S10] + discovered S6
[S10] + discovered S3
[S9] + discovered S17
[S9] + discovered S14
[S9] + discovered S13
[S10] + discovered S13
[S11] + discovered S3
[S11] + discovered S6
[S11] + discovered S5
[S11] + discovered S2
[S11] + discovered S7
[S11] + discovered S10
[S11] + discovered S8
[S11] + discovered S9
[S10] + discovered S14
[S11] + discovered S4
[S10] + discovered S17
[S10] + discovered S11
[S10] + discovered S15
[S10] + discovered S16
[S11] + discovered S14
[S11] + discovered S17
[S11] + discovered S15
[S11] + discovered S13
[S13] + discovered S4
[S13] + discovered S10
[S11] + discovered S16
[S13] + discovered S11
[S13] + discovered S5
[S13] + discovered S7
[S13] + discovered S6
[S13] + discovered S8
[S13] + discovered S3
[S13] + discovered S2
[S13] + discovered S9
[S14] + discovered S8
[S14] + discovered S9
[S14] + discovered S6
[S14] + discovered S2
[S14] + discovered S7
[S13] + discovered S16
[S14] + discovered S13
[S14] + discovered S11
[S13] + discovered S15
[S14] + discovered S4
[S14] + discovered S10
[S14] + discovered S5
[S13] + discovered S14
[S14] + discovered S3
[S13] + discovered S17
[S15] + discovered S10
[S15] + discovered S2
[S15] + discovered S11
[S15] + discovered S14
[S15] + discovered S3
[S15] + discovered S8
[S15] + discovered S9
[S15] + discovered S13
[S14] + discovered S16
[S15] + discovered S5
[S15] + discovered S6
[S15] + discovered S4
[S15] + discovered S7
[S14] + discovered S15
[S14] + discovered S17
[S16] + discovered S8
[S16] + discovered S14
[S16] + discovered S6
[S16] + discovered S9
[S16] + discovered S4
[S16] + discovered S11
[S16] + discovered S13
[S16] + discovered S10
[S16] + discovered S7
[S16] + discovered S15
[S16] + discovered S2
[S16] + discovered S5
[S15] + discovered S17
[S15] + discovered S16
[S16] + discovered S3
[S17] + discovered S10
[S17] + discovered S15
[S17] + discovered S3
[S17] + discovered S14
[S17] + discovered S5
[S17] + discovered S2
[S17] + discovered S16
[S17] + discovered S13
[S17] + discovered S7
[S17] + discovered S4
[S17] + discovered S9
[S16] + discovered S17
[S17] + discovered S8
[S17] + discovered S6
[S17] + discovered S11
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] ⇄ pheromone p=1.000 → S17@127.0.0.1:45917
[S8] ⇄ pheromone p=1.000 → S3@127.0.0.1:45903
[S14] ⇄ pheromone p=1.000 → S11@127.0.0.1:45912
[S5] ⇄ pheromone p=1.000 → S16@127.0.0.1:45916
[S6] ⇄ pheromone p=1.000 → S17@127.0.0.1:45917
[S7] ⇄ pheromone p=1.000 → S4@127.0.0.1:45904
[S16] ⇄ pheromone p=1.000 → S15@127.0.0.1:45915
[S3] ⇄ pheromone p=1.000 → S17@127.0.0.1:45917
[S9] ⇄ pheromone p=1.000 → S16@127.0.0.1:45916
[S11] ⇄ pheromone p=1.000 → S16@127.0.0.1:45916
[S15] ⇄ pheromone p=1.000 → S13@127.0.0.1:45913
[S10] ⇄ pheromone p=1.000 → S8@127.0.0.1:45909
[S13] ⇄ pheromone p=1.000 → S2@127.0.0.1:45902
[S4] ⇄ pheromone p=1.000 → S14@127.0.0.1:45914
[S17] ⇄ pheromone p=1.000 → S14@127.0.0.1:45914
[S2] START round=1 head_norm_before_train=1.173751 (no previous merge yet)
[S2] round=1 local utility u=0.055947 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7835125809957268, 'loss_val': 1.232379572588857, 'psi': 0.3984713124314308}-{'f1_val': 0.1417771333885667, 'auprc': 0.7668041537464152, 'loss_val': 1.2941483223188788, 'psi': 0.39178794153170615}
[S3] START round=1 head_norm_before_train=1.176442 (no previous merge yet)
[S3] round=1 local utility u=0.247216 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9556776810799728, 'loss_val': 1.333190942615078, 'psi': 0.46617511180045335}-{'f1_val': 0.19667036625971143, 'auprc': 0.6880604989629298, 'loss_val': 1.3657532797024767, 'psi': 0.3932264193409988}
[S4] START round=1 head_norm_before_train=1.220016 (no previous merge yet)
[S4] round=1 local utility u=0.000000 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7908220185319516, 'loss_val': 1.237471952190378, 'psi': 0.4004647847498911}-{'f1_val': 0.4086856295396338, 'auprc': 0.7804049942783948, 'loss_val': 1.3137458264159518, 'psi': 0.5573733754351382}
[S5] START round=1 head_norm_before_train=1.127038 (no previous merge yet)
[S5] round=1 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7685224056665446, 'loss_val': 1.329659347991463, 'psi': 0.3927661051237607}-{'f1_val': 0.39348770555826085, 'auprc': 0.7123017903636265, 'loss_val': 1.365858780513713, 'psi': 0.5210133394804071}
[S6] START round=1 head_norm_before_train=1.152238 (no previous merge yet)
[S6] round=1 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.7914406799506325, 'loss_val': 1.2669313573913161, 'psi': 0.4014320412110222}-{'f1_val': 0.14142628205128205, 'auprc': 0.8215423671914035, 'loss_val': 1.3439412833496984, 'psi': 0.4134727161073306}
[S7] START round=1 head_norm_before_train=1.175325 (no previous merge yet)
[S7] round=1 local utility u=0.347586 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.4087992199081911, 'loss_val': 1.3617241424486866, 'psi': 0.24875378160073144}-{'f1_val': 0.14205682272909165, 'auprc': 0.1854786270658615, 'loss_val': 1.3869336651241277, 'psi': 0.15942554446379958}
[S8] START round=1 head_norm_before_train=1.175894 (no previous merge yet)
[S8] round=1 local utility u=0.000000 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7770605065307595, 'loss_val': 1.2529199736991559, 'psi': 0.39479779204807813}-{'f1_val': 0.36682469283151214, 'auprc': 0.7770626878492464, 'loss_val': 1.3251646806656696, 'psi': 0.5309198908386059}
[S9] START round=1 head_norm_before_train=1.199389 (no previous merge yet)
[S9] round=1 local utility u=0.235551 metrics={'f1_val': 0.141397957139996, 'auprc': 0.7552102423973228, 'loss_val': 1.31646282124367, 'psi': 0.38692287124292674}-{'f1_val': 0.141397957139996, 'auprc': 0.6122674249180398, 'loss_val': 1.3587364455879543, 'psi': 0.3297457442512135}
[S10] START round=1 head_norm_before_train=1.176132 (no previous merge yet)
[S10] round=1 local utility u=0.031323 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7762978701229589, 'loss_val': 1.2720972086085152, 'psi': 0.3936921305742179}-{'f1_val': 0.13862163754172394, 'auprc': 0.7756805875324966, 'loss_val': 1.3328908578134153, 'psi': 0.393445217538033}
[S11] START round=1 head_norm_before_train=1.147375 (no previous merge yet)
[S11] round=1 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.9015131614170604, 'loss_val': 1.320586490811648, 'psi': 0.4448534745906905}-{'f1_val': 0.37264621530598396, 'auprc': 0.901061297797183, 'loss_val': 1.3581847541024759, 'psi': 0.5840122483024637}
[S13] START round=1 head_norm_before_train=1.200503 (no previous merge yet)
[S13] round=1 local utility u=0.041866 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5386081567835229, 'loss_val': 1.266715721695396, 'psi': 0.29967472025964104}-{'f1_val': 0.1403857625770531, 'auprc': 0.5321124106764501, 'loss_val': 1.330960924457892, 'psi': 0.29707642181681193}
[S14] START round=1 head_norm_before_train=1.154014 (no previous merge yet)
[S14] round=1 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.35883206946115753, 'loss_val': 1.3354888409741552, 'psi': 0.22774753951408527}-{'f1_val': 0.14035785288270378, 'auprc': 0.41275124265751384, 'loss_val': 1.3545822386051143, 'psi': 0.2493152087926278}
[S15] START round=1 head_norm_before_train=1.207290 (no previous merge yet)
[S15] round=1 local utility u=0.045211 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7713308343915077, 'loss_val': 1.2729614311187616, 'psi': 0.3923725245735381}-{'f1_val': 0.13973365136155833, 'auprc': 0.7561576849190675, 'loss_val': 1.317864512753689, 'psi': 0.38630326478456206}
[S16] START round=1 head_norm_before_train=1.143599 (no previous merge yet)
[S16] round=1 local utility u=1.000000 metrics={'f1_val': 0.4001315931107202, 'auprc': 0.689245382387403, 'loss_val': 1.3379410213853846, 'psi': 0.5157771088213934}-{'f1_val': 0.10386473429951691, 'auprc': 0.5946517437126533, 'loss_val': 1.3659472332996965, 'psi': 0.3001795380647715}
[S17] START round=1 head_norm_before_train=1.116215 (no previous merge yet)
[S17] round=1 local utility u=0.143238 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6452519331722586, 'loss_val': 1.2903504043211205, 'psi': 0.3426701512593341}-{'f1_val': 0.14094896331738438, 'auprc': 0.5647342107144082, 'loss_val': 1.3352723878546913, 'psi': 0.3104630622761939}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S7] → sending delta(kind=head bytes=1789) to S8@127.0.0.1:45909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S2] → sending delta(kind=head bytes=1792) to S4@127.0.0.1:45904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:45902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:45907
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S15] → sending delta(kind=head bytes=1791) to S6@127.0.0.1:45907
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S16] → sending delta(kind=head bytes=1788) to S10@127.0.0.1:45911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S9] → sending delta(kind=head bytes=1787) to S11@127.0.0.1:45912
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1787 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1788 to 1 peers)
[S15] sending update (kind=head size=1791 to 1 peers)
[S10] sending update (kind=head size=1794 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1792 to 1 peers)
[S7] sending update (kind=head size=1789 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1789) from S7
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.179295)
[S8] loaded HEAD from S7 (vec_in norm=1.179295)
[S8] cosine check vs S7: cos=0.0532
[S8] BUFFERED delta from S7 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1797) from S13
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.229852)
[S16] loaded HEAD from S13 (vec_in norm=1.229852)
[S16] cosine check vs S13: cos=0.0794
[S16] BUFFERED delta from S13 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1792) from S2
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.222951)
[S4] loaded HEAD from S2 (vec_in norm=1.222951)
[S4] cosine check vs S2: cos=0.0203
[S4] BUFFERED delta from S2 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1791) from S15
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.238515)
[S6] loaded HEAD from S15 (vec_in norm=1.238515)
[S6] cosine check vs S15: cos=-0.0358
[S6] DROPPED delta from S15 (cos=-0.0358 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1794) from S10
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.210793)
[S6] loaded HEAD from S10 (vec_in norm=1.210793)
[S6] cosine check vs S10: cos=0.0585
[S6] BUFFERED delta from S10 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1787) from S9
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.211481)
[S11] loaded HEAD from S9 (vec_in norm=1.211481)
[S11] cosine check vs S9: cos=-0.0679
[S11] DROPPED delta from S9 (cos=-0.0679 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1802) from S3
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.192119)
[S2] loaded HEAD from S3 (vec_in norm=1.192119)
[S2] cosine check vs S3: cos=0.0991
[S2] BUFFERED delta from S3 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1788) from S16
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.147518)
[S10] loaded HEAD from S16 (vec_in norm=1.147518)
[S10] cosine check vs S16: cos=0.0907
[S10] BUFFERED delta from S16 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:45902
[S17] sending update (kind=head size=1795 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1795) from S17
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.150285)
[S2] loaded HEAD from S17 (vec_in norm=1.150285)
[S2] cosine check vs S17: cos=-0.0129
[S2] DROPPED delta from S17 (cos=-0.0129 < 0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=1 metric=0.1400 head_norm=1.213815
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.233793e-01
[S8] stored merged vector for next round verification (round=1)
[S8] DEBUG after merge:  round=1 metric=0.1400 head_norm=0.868382 delta_norm=0.823379
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=1 metric=0.1414 head_norm=1.194660
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.252369e-01
[S6] stored merged vector for next round verification (round=1)
[S6] DEBUG after merge:  round=1 metric=0.1414 head_norm=0.874986 delta_norm=0.825237
[S6] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=1 metric=0.1402 head_norm=1.261144
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.693925e-01
[S4] stored merged vector for next round verification (round=1)
[S4] DEBUG after merge:  round=1 metric=0.1402 head_norm=0.887245 delta_norm=0.869392
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=1 metric=0.4001 head_norm=1.147518
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.070569e-01
[S16] stored merged vector for next round verification (round=1)
[S16] DEBUG after merge:  round=1 metric=0.1039 head_norm=0.873685 delta_norm=0.807057
[S16] aggregate: ROLLBACK (f1_val pre=0.400 post=0.104 tol_abs=0.005 tol_rel=0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=1 metric=0.1386 head_norm=1.210793
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.954416e-01
[S10] stored merged vector for next round verification (round=1)
[S10] DEBUG after merge:  round=1 metric=0.1386 head_norm=0.871023 delta_norm=0.795442
[S10] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=1 metric=0.1418 head_norm=1.222951
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.105270e-01
[S2] stored merged vector for next round verification (round=1)
[S2] DEBUG after merge:  round=1 metric=0.1418 head_norm=0.895223 delta_norm=0.810527
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=0.895223 cos_to_last_merge=1.0000 (last merge round=1)
[S2] round=2 local utility u=0.018916 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7846773927762305, 'loss_val': 1.1980410461001803, 'psi': 0.3989372371436323}-{'f1_val': 0.1417771333885667, 'auprc': 0.7835125809957268, 'loss_val': 1.232379572588857, 'psi': 0.3984713124314308}
[S3] START round=2 head_norm_before_train=1.192119 (no previous merge yet)
[S3] round=2 local utility u=0.029949 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.962884955462763, 'loss_val': 1.2949153166614302, 'psi': 0.46905802155356946}-{'f1_val': 0.13984006561410703, 'auprc': 0.9556776810799728, 'loss_val': 1.333190942615078, 'psi': 0.46617511180045335}
[S4] START round=2 head_norm_before_train=0.887245 cos_to_last_merge=1.0000 (last merge round=1)
[S4] round=2 local utility u=0.000000 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7255789535351268, 'loss_val': 1.1986147150320685, 'psi': 0.37436755875116123}-{'f1_val': 0.14022662889518414, 'auprc': 0.7908220185319516, 'loss_val': 1.237471952190378, 'psi': 0.4004647847498911}
[S5] START round=2 head_norm_before_train=1.138977 (no previous merge yet)
[S5] round=2 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7458267708715088, 'loss_val': 1.2883363363118292, 'psi': 0.3836878512057464}-{'f1_val': 0.14226190476190476, 'auprc': 0.7685224056665446, 'loss_val': 1.329659347991463, 'psi': 0.3927661051237607}
[S6] START round=2 head_norm_before_train=0.874986 cos_to_last_merge=1.0000 (last merge round=1)
[S6] round=2 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6109151463342675, 'loss_val': 1.2398373510016885, 'psi': 0.3292218277644762}-{'f1_val': 0.14142628205128205, 'auprc': 0.7914406799506325, 'loss_val': 1.2669313573913161, 'psi': 0.4014320412110222}
[S7] START round=2 head_norm_before_train=1.179295 (no previous merge yet)
[S7] round=2 local utility u=0.160365 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.5062028332024108, 'loss_val': 1.3332059011768158, 'psi': 0.28771522691841933}-{'f1_val': 0.14205682272909165, 'auprc': 0.4087992199081911, 'loss_val': 1.3617241424486866, 'psi': 0.24875378160073144}
[S8] START round=2 head_norm_before_train=0.868382 cos_to_last_merge=1.0000 (last merge round=1)
[S8] round=2 local utility u=0.023542 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7768420717434792, 'loss_val': 1.2051810444408981, 'psi': 0.39471041813316604}-{'f1_val': 0.13995598239295717, 'auprc': 0.7770605065307595, 'loss_val': 1.2529199736991559, 'psi': 0.39479779204807813}
[S9] START round=2 head_norm_before_train=1.211481 (no previous merge yet)
[S9] round=2 local utility u=0.160257 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8472853972327118, 'loss_val': 1.2721741066978982, 'psi': 0.42375293317708235}-{'f1_val': 0.141397957139996, 'auprc': 0.7552102423973228, 'loss_val': 1.31646282124367, 'psi': 0.38692287124292674}
[S10] START round=2 head_norm_before_train=0.871023 cos_to_last_merge=1.0000 (last merge round=1)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6330374174405327, 'loss_val': 1.2212746802556502, 'psi': 0.33638794950124745}-{'f1_val': 0.13862163754172394, 'auprc': 0.7762978701229589, 'loss_val': 1.2720972086085152, 'psi': 0.3936921305742179}
[S11] START round=2 head_norm_before_train=1.167161 (no previous merge yet)
[S11] round=2 local utility u=0.022033 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.9017674495668329, 'loss_val': 1.2772832300104917, 'psi': 0.4449551898505995}-{'f1_val': 0.14041368337311058, 'auprc': 0.9015131614170604, 'loss_val': 1.320586490811648, 'psi': 0.4448534745906905}
[S13] START round=2 head_norm_before_train=1.229852 (no previous merge yet)
[S13] round=2 local utility u=0.317340 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7259807774871851, 'loss_val': 1.1941533084324476, 'psi': 0.3746237685411059}-{'f1_val': 0.1403857625770531, 'auprc': 0.5386081567835229, 'loss_val': 1.266715721695396, 'psi': 0.29967472025964104}
[S14] START round=2 head_norm_before_train=1.168237 (no previous merge yet)
[S14] round=2 local utility u=0.243516 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.5141066397517483, 'loss_val': 1.3142815455825887, 'psi': 0.2898573676303216}-{'f1_val': 0.14035785288270378, 'auprc': 0.35883206946115753, 'loss_val': 1.3354888409741552, 'psi': 0.22774753951408527}
[S15] START round=2 head_norm_before_train=1.238515 (no previous merge yet)
[S15] round=2 local utility u=0.035481 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7766464338482737, 'loss_val': 1.2179465421006417, 'psi': 0.3944987643562445}-{'f1_val': 0.13973365136155833, 'auprc': 0.7713308343915077, 'loss_val': 1.2729614311187616, 'psi': 0.3923725245735381}
[S16] START round=2 head_norm_before_train=0.873685 cos_to_last_merge=1.0000 (last merge round=1)
[S16] round=2 local utility u=0.000000 metrics={'f1_val': 0.18757253282794914, 'auprc': 0.7655964420080168, 'loss_val': 1.3385968061552875, 'psi': 0.4187820964999762}-{'f1_val': 0.4001315931107202, 'auprc': 0.689245382387403, 'loss_val': 1.3379410213853846, 'psi': 0.5157771088213934}
[S17] START round=2 head_norm_before_train=1.150285 (no previous merge yet)
[S17] round=2 local utility u=0.065824 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6561479558227499, 'loss_val': 1.1913895918414794, 'psi': 0.3470285603195306}-{'f1_val': 0.14094896331738438, 'auprc': 0.6452519331722586, 'loss_val': 1.2903504043211205, 'psi': 0.3426701512593341}
[S2] not sending this round → trigger blocked (psi=0.399)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.424)
[S3] not sending this round → trigger blocked (psi=0.469)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:45916
[S7] not sending this round → trigger blocked (psi=0.288)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.375)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S14] → sending delta(kind=head bytes=1791) to S2@127.0.0.1:45902
[S15] not sending this round → trigger blocked (psi=0.394)
[S8] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1791 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1795) from S8
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.915356)
[S16] loaded HEAD from S8 (vec_in norm=0.915356)
[S16] cosine check vs S8: cos=-0.0693
[S16] DROPPED delta from S8 (cos=-0.0693 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1796) from S11
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.192620)
[S16] loaded HEAD from S11 (vec_in norm=1.192620)
[S16] cosine check vs S11: cos=0.0475
[S16] BUFFERED delta from S11 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1791) from S14
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.191392)
[S2] loaded HEAD from S14 (vec_in norm=1.191392)
[S2] cosine check vs S14: cos=0.0448
[S2] BUFFERED delta from S14 (total buffered=1)
[S17] not sending this round → trigger blocked (psi=0.347)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=2 metric=0.1418 head_norm=0.953150
[S2] _apply_head_vector_avg (torch): Δ‖w‖=7.460057e-01
[S2] stored merged vector for next round verification (round=2)
[S2] DEBUG after merge:  round=2 metric=0.1418 head_norm=0.779378 delta_norm=0.746006
[S2] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=2 metric=0.1876 head_norm=0.881709
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.245347e-01
[S16] stored merged vector for next round verification (round=2)
[S16] DEBUG after merge:  round=2 metric=0.1406 head_norm=0.758238 delta_norm=0.724535
[S16] aggregate: ROLLBACK (f1_val pre=0.188 post=0.141 tol_abs=0.005 tol_rel=0.0)
[S2] START round=3 head_norm_before_train=0.779378 cos_to_last_merge=1.0000 (last merge round=2)
[S2] round=3 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7559486242660121, 'loss_val': 1.1201619218747343, 'psi': 0.3874457297395449}-{'f1_val': 0.1417771333885667, 'auprc': 0.7846773927762305, 'loss_val': 1.1980410461001803, 'psi': 0.3989372371436323}
[S3] START round=3 head_norm_before_train=1.213504 (no previous merge yet)
[S3] round=3 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9168170000588587, 'loss_val': 1.2509684406234802, 'psi': 0.45063083939200776}-{'f1_val': 0.13984006561410703, 'auprc': 0.962884955462763, 'loss_val': 1.2949153166614302, 'psi': 0.46905802155356946}
[S4] START round=3 head_norm_before_train=0.940913 cos_to_last_merge=0.9926 (last merge round=1)
[S4] round=3 local utility u=1.000000 metrics={'f1_val': 0.4146396721785156, 'auprc': 0.7656961290983741, 'loss_val': 0.9559261630856511, 'psi': 0.555062254946459}-{'f1_val': 0.14022662889518414, 'auprc': 0.7255789535351268, 'loss_val': 1.1986147150320685, 'psi': 0.37436755875116123}
[S5] START round=3 head_norm_before_train=1.161829 (no previous merge yet)
[S5] round=3 local utility u=0.018131 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7411213168334556, 'loss_val': 1.2379573147192955, 'psi': 0.3818056695905251}-{'f1_val': 0.14226190476190476, 'auprc': 0.7458267708715088, 'loss_val': 1.2883363363118292, 'psi': 0.3836878512057464}
[S6] START round=3 head_norm_before_train=0.922800 cos_to_last_merge=0.9938 (last merge round=1)
[S6] round=3 local utility u=0.069716 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6275038331669306, 'loss_val': 1.150171707067104, 'psi': 0.3358573024975415}-{'f1_val': 0.14142628205128205, 'auprc': 0.6109151463342675, 'loss_val': 1.2398373510016885, 'psi': 0.3292218277644762}
[S7] START round=3 head_norm_before_train=1.193773 (no previous merge yet)
[S7] round=3 local utility u=0.249138 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.6618302795112756, 'loss_val': 1.301812097326547, 'psi': 0.3499662054419652}-{'f1_val': 0.14205682272909165, 'auprc': 0.5062028332024108, 'loss_val': 1.3332059011768158, 'psi': 0.28771522691841933}
[S8] START round=3 head_norm_before_train=0.915356 cos_to_last_merge=0.9924 (last merge round=1)
[S8] round=3 local utility u=0.906693 metrics={'f1_val': 0.41549694000722615, 'auprc': 0.7769413660496535, 'loss_val': 1.045339668804892, 'psi': 0.5600747104241971}-{'f1_val': 0.13995598239295717, 'auprc': 0.7768420717434792, 'loss_val': 1.2051810444408981, 'psi': 0.39471041813316604}
[S9] START round=3 head_norm_before_train=1.230463 (no previous merge yet)
[S9] round=3 local utility u=0.215479 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9741321905335423, 'loss_val': 1.221756285099008, 'psi': 0.47449165049741454}-{'f1_val': 0.141397957139996, 'auprc': 0.8472853972327118, 'loss_val': 1.2721741066978982, 'psi': 0.42375293317708235}
[S10] START round=3 head_norm_before_train=0.912794 cos_to_last_merge=0.9913 (last merge round=1)
[S10] round=3 local utility u=1.000000 metrics={'f1_val': 0.4170758964666951, 'auprc': 0.7755784991755382, 'loss_val': 1.0503779227564503, 'psi': 0.5604769375502323}-{'f1_val': 0.13862163754172394, 'auprc': 0.6330374174405327, 'loss_val': 1.2212746802556502, 'psi': 0.33638794950124745}
[S11] START round=3 head_norm_before_train=1.192620 (no previous merge yet)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.868476114810736, 'loss_val': 1.2146794165380455, 'psi': 0.4316386559481608}-{'f1_val': 0.14041368337311058, 'auprc': 0.9017674495668329, 'loss_val': 1.2772832300104917, 'psi': 0.4449551898505995}
[S13] START round=3 head_norm_before_train=1.278409 (no previous merge yet)
[S13] round=3 local utility u=0.681157 metrics={'f1_val': 0.41607788054795825, 'auprc': 0.6019222957930928, 'loss_val': 1.1138166903855904, 'psi': 0.49041564664601206}-{'f1_val': 0.1403857625770531, 'auprc': 0.7259807774871851, 'loss_val': 1.1941533084324476, 'psi': 0.3746237685411059}
[S14] START round=3 head_norm_before_train=1.191392 (no previous merge yet)
[S14] round=3 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.5022042719622488, 'loss_val': 1.2887827704521335, 'psi': 0.2850964205145218}-{'f1_val': 0.14035785288270378, 'auprc': 0.5141066397517483, 'loss_val': 1.3142815455825887, 'psi': 0.2898573676303216}
[S15] START round=3 head_norm_before_train=1.278152 (no previous merge yet)
[S15] round=3 local utility u=0.913473 metrics={'f1_val': 0.4167593395843331, 'auprc': 0.7770541671745568, 'loss_val': 1.054377193830928, 'psi': 0.5608772706204226}-{'f1_val': 0.13973365136155833, 'auprc': 0.7766464338482737, 'loss_val': 1.2179465421006417, 'psi': 0.3944987643562445}
[S16] START round=3 head_norm_before_train=0.758238 cos_to_last_merge=1.0000 (last merge round=2)
[S16] round=3 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7839917794288829, 'loss_val': 1.3429826076589062, 'psi': 0.39797918189107506}-{'f1_val': 0.18757253282794914, 'auprc': 0.7655964420080168, 'loss_val': 1.3385968061552875, 'psi': 0.4187820964999762}
[S17] START round=3 head_norm_before_train=1.203614 (no previous merge yet)
[S17] round=3 local utility u=0.922209 metrics={'f1_val': 0.3887871511897124, 'auprc': 0.6990730772899398, 'loss_val': 0.9627760236291489, 'psi': 0.5129015216298034}-{'f1_val': 0.14094896331738438, 'auprc': 0.6561479558227499, 'loss_val': 1.1913895918414794, 'psi': 0.3470285603195306}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1784 reason=None
[S7] → sending delta(kind=head bytes=1784) to S4@127.0.0.1:45904
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:45902
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S5] → sending delta(kind=head bytes=1791) to S16@127.0.0.1:45916
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S13@127.0.0.1:45913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S4] → sending delta(kind=head bytes=1788) to S14@127.0.0.1:45914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] → sending delta(kind=head bytes=1792) to S8@127.0.0.1:45909
[S8] not sending this round → trigger blocked (psi=0.560)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] → sending delta(kind=head bytes=1792) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:45917
[S5] sending update (kind=head size=1791 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1792 to 1 peers)
[S10] sending update (kind=head size=1792 to 1 peers)
[S4] sending update (kind=head size=1788 to 1 peers)
[S15] sending update (kind=head size=1793 to 1 peers)
[S13] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1784 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1792) from S10
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=0.961078)
[S8] loaded HEAD from S10 (vec_in norm=0.961078)
[S8] cosine check vs S10: cos=-0.0620
[S8] DROPPED delta from S10 (cos=-0.0620 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1802) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.955180)
[S17] loaded HEAD from S6 (vec_in norm=0.955180)
[S17] cosine check vs S6: cos=-0.0914
[S17] DROPPED delta from S6 (cos=-0.0914 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1792) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.257857)
[S16] loaded HEAD from S9 (vec_in norm=1.257857)
[S16] cosine check vs S9: cos=-0.0561
[S16] DROPPED delta from S9 (cos=-0.0561 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1788) from S4
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.015917)
[S14] loaded HEAD from S4 (vec_in norm=1.015917)
[S14] cosine check vs S4: cos=0.1228
[S14] BUFFERED delta from S4 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1791) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.191102)
[S16] loaded HEAD from S5 (vec_in norm=1.191102)
[S16] cosine check vs S5: cos=0.0227
[S16] BUFFERED delta from S5 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1784) from S7
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.215143)
[S4] loaded HEAD from S7 (vec_in norm=1.215143)
[S4] cosine check vs S7: cos=0.0219
[S4] BUFFERED delta from S7 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1793) from S15
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.338118)
[S13] loaded HEAD from S15 (vec_in norm=1.338118)
[S13] cosine check vs S15: cos=0.0781
[S13] BUFFERED delta from S15 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1795) from S13
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.306049)
[S2] loaded HEAD from S13 (vec_in norm=1.306049)
[S2] cosine check vs S13: cos=0.0140
[S2] BUFFERED delta from S13 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:45914
[S17] sending update (kind=head size=1799 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1799) from S17
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.271292)
[S14] loaded HEAD from S17 (vec_in norm=1.271292)
[S14] cosine check vs S17: cos=-0.0070
[S14] DROPPED delta from S17 (cos=-0.0070 < 0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=3 metric=0.1404 head_norm=1.224371
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.459471e-01
[S14] stored merged vector for next round verification (round=3)
[S14] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.842110 delta_norm=0.745947
[S14] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=3 metric=0.1418 head_norm=0.826529
[S2] _apply_head_vector_avg (torch): Δ‖w‖=7.679158e-01
[S2] stored merged vector for next round verification (round=3)
[S2] DEBUG after merge:  round=3 metric=0.3807 head_norm=0.777665 delta_norm=0.767916
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=3 metric=0.4161 head_norm=1.306049
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.977042e-01
[S13] stored merged vector for next round verification (round=3)
[S13] DEBUG after merge:  round=3 metric=0.4083 head_norm=0.970716 delta_norm=0.897704
[S13] aggregate: ROLLBACK (f1_val pre=0.416 post=0.408 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=3 metric=0.4146 head_norm=1.015917
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.833719e-01
[S4] stored merged vector for next round verification (round=3)
[S4] DEBUG after merge:  round=3 metric=0.4121 head_norm=0.800412 delta_norm=0.783372
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=3 metric=0.1406 head_norm=0.767200
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.010395e-01
[S16] stored merged vector for next round verification (round=3)
[S16] DEBUG after merge:  round=3 metric=0.1406 head_norm=0.715684 delta_norm=0.701039
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=0.777665 cos_to_last_merge=1.0000 (last merge round=3)
[S2] round=4 local utility u=0.872468 metrics={'f1_val': 0.4165165486077186, 'auprc': 0.7648408691748898, 'loss_val': 1.0503394758196918, 'psi': 0.5558462768345871}-{'f1_val': 0.1417771333885667, 'auprc': 0.7559486242660121, 'loss_val': 1.1201619218747343, 'psi': 0.3874457297395449}
[S3] START round=4 head_norm_before_train=1.238817 (no previous merge yet)
[S3] round=4 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8754306712273022, 'loss_val': 1.205115100427745, 'psi': 0.4340763078593851}-{'f1_val': 0.13984006561410703, 'auprc': 0.9168170000588587, 'loss_val': 1.2509684406234802, 'psi': 0.45063083939200776}
[S4] START round=4 head_norm_before_train=0.800412 cos_to_last_merge=1.0000 (last merge round=3)
[S4] round=4 local utility u=0.115034 metrics={'f1_val': 0.48355005293166786, 'auprc': 0.6622192083692127, 'loss_val': 0.8288890188727775, 'psi': 0.5550177151066857}-{'f1_val': 0.4146396721785156, 'auprc': 0.7656961290983741, 'loss_val': 0.9559261630856511, 'psi': 0.555062254946459}
[S5] START round=4 head_norm_before_train=1.191102 (no previous merge yet)
[S5] round=4 local utility u=0.020970 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7389544657189829, 'loss_val': 1.189516069552578, 'psi': 0.38093892914473604}-{'f1_val': 0.14226190476190476, 'auprc': 0.7411213168334556, 'loss_val': 1.2379573147192955, 'psi': 0.3818056695905251}
[S6] START round=4 head_norm_before_train=0.955180 cos_to_last_merge=0.9846 (last merge round=1)
[S6] round=4 local utility u=1.000000 metrics={'f1_val': 0.41605123052148413, 'auprc': 0.7540932820590656, 'loss_val': 0.9741406327337893, 'psi': 0.5512680511365167}-{'f1_val': 0.14142628205128205, 'auprc': 0.6275038331669306, 'loss_val': 1.150171707067104, 'psi': 0.3358573024975415}
[S7] START round=4 head_norm_before_train=1.215143 (no previous merge yet)
[S7] round=4 local utility u=0.151957 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7540584809078862, 'loss_val': 1.2745835648328872, 'psi': 0.3868574860006095}-{'f1_val': 0.14205682272909165, 'auprc': 0.6618302795112756, 'loss_val': 1.301812097326547, 'psi': 0.3499662054419652}
[S8] START round=4 head_norm_before_train=0.970820 cos_to_last_merge=0.9761 (last merge round=1)
[S8] round=4 local utility u=0.000000 metrics={'f1_val': 0.3728657005221765, 'auprc': 0.7856382860496616, 'loss_val': 0.8241011182429578, 'psi': 0.5379747347331705}-{'f1_val': 0.41549694000722615, 'auprc': 0.7769413660496535, 'loss_val': 1.045339668804892, 'psi': 0.5600747104241971}
[S9] START round=4 head_norm_before_train=1.257857 (no previous merge yet)
[S9] round=4 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8142988938788982, 'loss_val': 1.164999150032078, 'psi': 0.4105583318355569}-{'f1_val': 0.141397957139996, 'auprc': 0.9741321905335423, 'loss_val': 1.221756285099008, 'psi': 0.47449165049741454}
[S10] START round=4 head_norm_before_train=0.961078 cos_to_last_merge=0.9740 (last merge round=1)
[S10] round=4 local utility u=0.220674 metrics={'f1_val': 0.3913428507993099, 'auprc': 0.88605853088642, 'loss_val': 0.7860725936037342, 'psi': 0.589229122834154}-{'f1_val': 0.4170758964666951, 'auprc': 0.7755784991755382, 'loss_val': 1.0503779227564503, 'psi': 0.5604769375502323}
[S11] START round=4 head_norm_before_train=1.226507 (no previous merge yet)
[S11] round=4 local utility u=0.057654 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8784098564910845, 'loss_val': 1.1291716674117398, 'psi': 0.4356121526203002}-{'f1_val': 0.14041368337311058, 'auprc': 0.868476114810736, 'loss_val': 1.2146794165380455, 'psi': 0.4316386559481608}
[S13] START round=4 head_norm_before_train=0.970716 cos_to_last_merge=1.0000 (last merge round=3)
[S13] round=4 local utility u=0.266938 metrics={'f1_val': 0.4162370592043806, 'auprc': 0.7381919565044694, 'loss_val': 0.9897046787259928, 'psi': 0.5450190181244161}-{'f1_val': 0.41607788054795825, 'auprc': 0.6019222957930928, 'loss_val': 1.1138166903855904, 'psi': 0.49041564664601206}
[S14] START round=4 head_norm_before_train=0.842110 cos_to_last_merge=1.0000 (last merge round=3)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.4866950186103629, 'loss_val': 1.288406493120378, 'psi': 0.27889271917376746}-{'f1_val': 0.14035785288270378, 'auprc': 0.5022042719622488, 'loss_val': 1.2887827704521335, 'psi': 0.2850964205145218}
[S15] START round=4 head_norm_before_train=1.338118 (no previous merge yet)
[S15] round=4 local utility u=0.476051 metrics={'f1_val': 0.4153794692101184, 'auprc': 0.9910902434564579, 'loss_val': 0.736103706792361, 'psi': 0.6456637789086542}-{'f1_val': 0.4167593395843331, 'auprc': 0.7770541671745568, 'loss_val': 1.054377193830928, 'psi': 0.5608772706204226}
[S16] START round=4 head_norm_before_train=0.715684 cos_to_last_merge=1.0000 (last merge round=3)
[S16] round=4 local utility u=0.312999 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.9878464931800601, 'loss_val': 1.3285488814684572, 'psi': 0.479521067391546}-{'f1_val': 0.14063745019920318, 'auprc': 0.7839917794288829, 'loss_val': 1.3429826076589062, 'psi': 0.39797918189107506}
[S17] START round=4 head_norm_before_train=1.271292 (no previous merge yet)
[S17] round=4 local utility u=0.232202 metrics={'f1_val': 0.3512886345760875, 'auprc': 0.899738186391883, 'loss_val': 0.8753755986424642, 'psi': 0.5706684553024057}-{'f1_val': 0.3887871511897124, 'auprc': 0.6990730772899398, 'loss_val': 0.9627760236291489, 'psi': 0.5129015216298034}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:45917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:45909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:45915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] → sending delta(kind=head bytes=1792) to S14@127.0.0.1:45914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:45916
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S5] → sending delta(kind=head bytes=1791) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:45913
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:45902
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:45917
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:45904
[S2] sending update (kind=head size=1794 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1791 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1792 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1795 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1794) from S2
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=0.819161)
[S17] loaded HEAD from S2 (vec_in norm=0.819161)
[S17] cosine check vs S2: cos=-0.0178
[S17] DROPPED delta from S2 (cos=-0.0178 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1800) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.002480)
[S17] loaded HEAD from S6 (vec_in norm=1.002480)
[S17] cosine check vs S6: cos=-0.1039
[S17] DROPPED delta from S6 (cos=-0.1039 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1791) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.223755)
[S16] loaded HEAD from S5 (vec_in norm=1.223755)
[S16] cosine check vs S5: cos=0.8324
[S16] BUFFERED delta from S5 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1799) from S11
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.264906)
[S16] loaded HEAD from S11 (vec_in norm=1.264906)
[S16] cosine check vs S11: cos=0.4781
[S16] BUFFERED delta from S11 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1795) from S16
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.730473)
[S15] loaded HEAD from S16 (vec_in norm=0.730473)
[S15] cosine check vs S16: cos=-0.0014
[S15] DROPPED delta from S16 (cos=-0.0014 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1795) from S7
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.243171)
[S4] loaded HEAD from S7 (vec_in norm=1.243171)
[S4] cosine check vs S7: cos=0.7111
[S4] BUFFERED delta from S7 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1792) from S4
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.893863)
[S14] loaded HEAD from S4 (vec_in norm=0.893863)
[S14] cosine check vs S4: cos=0.4901
[S14] BUFFERED delta from S4 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1801) from S15
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.420976)
[S13] loaded HEAD from S15 (vec_in norm=1.420976)
[S13] cosine check vs S15: cos=0.7025
[S13] BUFFERED delta from S15 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1797) from S13
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.027701)
[S2] loaded HEAD from S13 (vec_in norm=1.027701)
[S2] cosine check vs S13: cos=0.6210
[S2] BUFFERED delta from S13 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1800) from S10
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.019700)
[S8] loaded HEAD from S10 (vec_in norm=1.019700)
[S8] cosine check vs S10: cos=-0.0692
[S8] DROPPED delta from S10 (cos=-0.0692 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:45914
[S17] sending update (kind=head size=1804 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1804) from S17
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.350010)
[S14] loaded HEAD from S17 (vec_in norm=1.350010)
[S14] cosine check vs S17: cos=-0.0138
[S14] DROPPED delta from S17 (cos=-0.0138 < 0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=4 metric=0.1404 head_norm=0.874759
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.465829e-01
[S14] stored merged vector for next round verification (round=4)
[S14] DEBUG after merge:  round=4 metric=0.1404 head_norm=0.763322 delta_norm=0.446583
[S14] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=4 metric=0.1406 head_norm=0.730473
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.162261e-01
[S16] stored merged vector for next round verification (round=4)
[S16] DEBUG after merge:  round=4 metric=0.1406 head_norm=0.799797 delta_norm=0.216226
[S16] aggregate: ACCEPT kept=['S5', 'S11'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=4 metric=0.4836 head_norm=0.893863
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.370691e-01
[S4] stored merged vector for next round verification (round=4)
[S4] DEBUG after merge:  round=4 metric=0.3750 head_norm=0.990557 delta_norm=0.437069
[S4] aggregate: ROLLBACK (f1_val pre=0.484 post=0.375 tol_abs=0.005 tol_rel=0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=4 metric=0.4165 head_norm=0.819161
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.127945e-01
[S2] stored merged vector for next round verification (round=4)
[S2] DEBUG after merge:  round=4 metric=0.3913 head_norm=0.832585 delta_norm=0.412795
[S2] aggregate: ROLLBACK (f1_val pre=0.417 post=0.391 tol_abs=0.005 tol_rel=0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=4 metric=0.4162 head_norm=1.027701
[S13] _apply_head_vector_avg (torch): Δ‖w‖=5.058594e-01
[S13] stored merged vector for next round verification (round=4)
[S13] DEBUG after merge:  round=4 metric=0.4172 head_norm=1.132156 delta_norm=0.505859
[S13] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=0.832585 cos_to_last_merge=1.0000 (last merge round=4)
[S2] round=5 local utility u=0.075066 metrics={'f1_val': 0.4159809982275058, 'auprc': 0.7819244703604329, 'loss_val': 0.9482449277344657, 'psi': 0.5623583870806766}-{'f1_val': 0.4165165486077186, 'auprc': 0.7648408691748898, 'loss_val': 1.0503394758196918, 'psi': 0.5558462768345871}
[S3] START round=5 head_norm_before_train=1.266417 (no previous merge yet)
[S3] round=5 local utility u=0.092830 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9119540272832882, 'loss_val': 1.12902486218546, 'psi': 0.44868565028177954}-{'f1_val': 0.13984006561410703, 'auprc': 0.8754306712273022, 'loss_val': 1.205115100427745, 'psi': 0.4340763078593851}
[S4] START round=5 head_norm_before_train=0.990557 cos_to_last_merge=1.0000 (last merge round=4)
[S4] round=5 local utility u=0.888959 metrics={'f1_val': 0.6613741131760095, 'auprc': 0.8567223812123269, 'loss_val': 0.7014258746319223, 'psi': 0.7395134203905365}-{'f1_val': 0.48355005293166786, 'auprc': 0.6622192083692127, 'loss_val': 0.8288890188727775, 'psi': 0.5550177151066857}
[S5] START round=5 head_norm_before_train=1.223755 (no previous merge yet)
[S5] round=5 local utility u=0.908346 metrics={'f1_val': 0.4167436894719335, 'auprc': 0.7701110411590707, 'loss_val': 1.11318543307473, 'psi': 0.5580906301467884}-{'f1_val': 0.14226190476190476, 'auprc': 0.7389544657189829, 'loss_val': 1.189516069552578, 'psi': 0.38093892914473604}
[S6] START round=5 head_norm_before_train=1.002480 cos_to_last_merge=0.9715 (last merge round=1)
[S6] round=5 local utility u=0.490538 metrics={'f1_val': 0.5600724419372706, 'auprc': 0.7252501834017618, 'loss_val': 0.7706627467591686, 'psi': 0.6261435385230671}-{'f1_val': 0.41605123052148413, 'auprc': 0.7540932820590656, 'loss_val': 0.9741406327337893, 'psi': 0.5512680511365167}
[S7] START round=5 head_norm_before_train=1.243171 (no previous merge yet)
[S7] round=5 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7316005905734098, 'loss_val': 1.2593283986958554, 'psi': 0.3778743298668189}-{'f1_val': 0.14205682272909165, 'auprc': 0.7540584809078862, 'loss_val': 1.2745835648328872, 'psi': 0.3868574860006095}
[S8] START round=5 head_norm_before_train=1.042262 cos_to_last_merge=0.9525 (last merge round=1)
[S8] round=5 local utility u=0.230492 metrics={'f1_val': 0.37339943428936406, 'auprc': 0.8636117517887745, 'loss_val': 0.6002396444532757, 'psi': 0.5694843612891283}-{'f1_val': 0.3728657005221765, 'auprc': 0.7856382860496616, 'loss_val': 0.8241011182429578, 'psi': 0.5379747347331705}
[S9] START round=5 head_norm_before_train=1.287332 (no previous merge yet)
[S9] round=5 local utility u=0.006197 metrics={'f1_val': 0.141397957139996, 'auprc': 0.7829438882786013, 'loss_val': 1.0585397191788517, 'psi': 0.39801632959543815}-{'f1_val': 0.141397957139996, 'auprc': 0.8142988938788982, 'loss_val': 1.164999150032078, 'psi': 0.4105583318355569}
[S10] START round=5 head_norm_before_train=1.019700 cos_to_last_merge=0.9488 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.949
[S10] round=5 local utility u=0.668225 metrics={'f1_val': 0.6265589884666747, 'auprc': 0.8102895558548218, 'loss_val': 0.6336129550797088, 'psi': 0.7000512154219335}-{'f1_val': 0.3913428507993099, 'auprc': 0.88605853088642, 'loss_val': 0.7860725936037342, 'psi': 0.589229122834154}
[S11] START round=5 head_norm_before_train=1.264906 (no previous merge yet)
[S11] round=5 local utility u=1.000000 metrics={'f1_val': 0.41575190755414737, 'auprc': 0.9554810650236405, 'loss_val': 0.997784419503262, 'psi': 0.6316435705419446}-{'f1_val': 0.14041368337311058, 'auprc': 0.8784098564910845, 'loss_val': 1.1291716674117398, 'psi': 0.4356121526203002}
[S13] START round=5 head_norm_before_train=1.132156 cos_to_last_merge=1.0000 (last merge round=4)
[S13] round=5 local utility u=0.000000 metrics={'f1_val': 0.37169029467602305, 'auprc': 0.772446044411596, 'loss_val': 0.9040981871758482, 'psi': 0.5319925945702523}-{'f1_val': 0.4162370592043806, 'auprc': 0.7381919565044694, 'loss_val': 0.9897046787259928, 'psi': 0.5450190181244161}
[S14] START round=5 head_norm_before_train=0.763322 cos_to_last_merge=1.0000 (last merge round=4)
[S14] round=5 local utility u=0.125542 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.5665383781285053, 'loss_val': 1.2768518395897561, 'psi': 0.3108300629810244}-{'f1_val': 0.14035785288270378, 'auprc': 0.4866950186103629, 'loss_val': 1.288406493120378, 'psi': 0.27889271917376746}
[S15] START round=5 head_norm_before_train=1.420976 (no previous merge yet)
[S15] round=5 local utility u=0.886395 metrics={'f1_val': 0.6939591681912007, 'auprc': 0.9896820103944112, 'loss_val': 0.6305679513341371, 'psi': 0.8122483050724849}-{'f1_val': 0.4153794692101184, 'auprc': 0.9910902434564579, 'loss_val': 0.736103706792361, 'psi': 0.6456637789086542}
[S16] START round=5 head_norm_before_train=0.799797 cos_to_last_merge=1.0000 (last merge round=4)
[S16] round=5 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8573831770170401, 'loss_val': 1.2991513205600023, 'psi': 0.42733574092633797}-{'f1_val': 0.14063745019920318, 'auprc': 0.9878464931800601, 'loss_val': 1.3285488814684572, 'psi': 0.479521067391546}
[S17] START round=5 head_norm_before_train=1.350010 (no previous merge yet)
[S17] round=5 local utility u=0.000000 metrics={'f1_val': 0.3436703339607888, 'auprc': 0.692983251930712, 'loss_val': 1.1099301771300223, 'psi': 0.48339550114875807}-{'f1_val': 0.3512886345760875, 'auprc': 0.899738186391883, 'loss_val': 0.8753755986424642, 'psi': 0.5706684553024057}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:45912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] → sending delta(kind=head bytes=1792) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] → sending delta(kind=head bytes=1792) to S14@127.0.0.1:45914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:45903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:45909
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] → sending delta(kind=head bytes=1793) to S17@127.0.0.1:45917
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:45917
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S13@127.0.0.1:45913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:45917
[S15] sending update (kind=head size=1793 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1793 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1792 to 1 peers)
[S9] sending update (kind=head size=1792 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S10
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.092445)
[S8] loaded HEAD from S10 (vec_in norm=1.092445)
[S8] cosine check vs S10: cos=-0.0746
[S8] DROPPED delta from S10 (cos=-0.0746 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1798) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.791581)
[S11] loaded HEAD from S14 (vec_in norm=0.791581)
[S11] cosine check vs S14: cos=0.0668
[S11] BUFFERED delta from S14 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1800) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.131876)
[S3] loaded HEAD from S8 (vec_in norm=1.131876)
[S3] cosine check vs S8: cos=0.0236
[S3] BUFFERED delta from S8 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1798) from S3
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.288864)
[S17] loaded HEAD from S3 (vec_in norm=1.288864)
[S17] cosine check vs S3: cos=0.0534
[S17] BUFFERED delta from S3 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1801) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.072513)
[S17] loaded HEAD from S6 (vec_in norm=1.072513)
[S17] cosine check vs S6: cos=-0.1124
[S17] DROPPED delta from S6 (cos=-0.1124 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1793) from S2
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=0.878908)
[S17] loaded HEAD from S2 (vec_in norm=0.878908)
[S17] cosine check vs S2: cos=-0.0060
[S17] DROPPED delta from S2 (cos=-0.0060 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1797) from S11
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.301449)
[S16] loaded HEAD from S11 (vec_in norm=1.301449)
[S16] cosine check vs S11: cos=0.6324
[S16] BUFFERED delta from S11 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1794) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.241786)
[S16] loaded HEAD from S5 (vec_in norm=1.241786)
[S16] cosine check vs S5: cos=0.7855
[S16] BUFFERED delta from S5 (total buffered=2)
[S16] RECEIVED delta(kind=head bytes=1792) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.320371)
[S16] loaded HEAD from S9 (vec_in norm=1.320371)
[S16] cosine check vs S9: cos=0.0846
[S16] BUFFERED delta from S9 (total buffered=3)
[S14] RECEIVED delta(kind=head bytes=1792) from S4
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.078844)
[S14] loaded HEAD from S4 (vec_in norm=1.078844)
[S14] cosine check vs S4: cos=0.7045
[S14] BUFFERED delta from S4 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1793) from S15
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.486028)
[S13] loaded HEAD from S15 (vec_in norm=1.486028)
[S13] cosine check vs S15: cos=0.9086
[S13] BUFFERED delta from S15 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=5 metric=0.3717 head_norm=1.182621
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.214025e-01
[S13] stored merged vector for next round verification (round=5)
[S13] DEBUG after merge:  round=5 metric=0.3716 head_norm=1.303893 delta_norm=0.321403
[S13] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.494 → S2@127.0.0.1:45902
[S7] ⇄ pheromone p=0.429 → S4@127.0.0.1:45904
[S4] ⇄ pheromone p=0.652 → S14@127.0.0.1:45914
[S5] ⇄ pheromone p=0.515 → S16@127.0.0.1:45916
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=5 metric=0.4158 head_norm=1.301449
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.387027e-01
[S11] stored merged vector for next round verification (round=5)
[S11] DEBUG after merge:  round=5 metric=0.4224 head_norm=0.783903 delta_norm=0.738703
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.539 → S16@127.0.0.1:45916
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=5 metric=0.1398 head_norm=1.288864
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.475717e-01
[S3] stored merged vector for next round verification (round=5)
[S3] DEBUG after merge:  round=5 metric=0.1398 head_norm=0.867629 delta_norm=0.847572
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.370 → S17@127.0.0.1:45917
[S15] ⇄ pheromone p=0.705 → S13@127.0.0.1:45913
[S6] ⇄ pheromone p=0.595 → S17@127.0.0.1:45917
[S9] ⇄ pheromone p=0.392 → S16@127.0.0.1:45916
[S8] ⇄ pheromone p=0.492 → S3@127.0.0.1:45903
[S2] ⇄ pheromone p=0.489 → S17@127.0.0.1:45917
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=5 metric=0.1404 head_norm=0.791581
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.831802e-01
[S14] stored merged vector for next round verification (round=5)
[S14] DEBUG after merge:  round=5 metric=0.1404 head_norm=0.865116 delta_norm=0.383180
[S14] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.378 → S11@127.0.0.1:45912
[S10] ⇄ pheromone p=0.627 → S8@127.0.0.1:45909
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=5 metric=0.3437 head_norm=1.404073
[S17] _apply_head_vector_avg (torch): Δ‖w‖=9.272556e-01
[S17] stored merged vector for next round verification (round=5)
[S17] DEBUG after merge:  round=5 metric=0.3354 head_norm=0.978005 delta_norm=0.927256
[S17] aggregate: ROLLBACK (f1_val pre=0.344 post=0.335 tol_abs=0.005 tol_rel=0.0)
[S17] ⇄ pheromone p=0.501 → S14@127.0.0.1:45914
[S16] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=5 metric=0.1406 head_norm=0.816105
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.344993e-01
[S16] stored merged vector for next round verification (round=5)
[S16] DEBUG after merge:  round=5 metric=0.1406 head_norm=0.770863 delta_norm=0.234499
[S16] aggregate: ACCEPT kept=['S11', 'S5', 'S9'] (k=3/3) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.460 → S15@127.0.0.1:45915
[S2] START round=6 head_norm_before_train=0.878908 cos_to_last_merge=0.9852 (last merge round=4)
[S2] round=6 local utility u=0.983116 metrics={'f1_val': 0.7011294018287861, 'auprc': 0.7929742190393885, 'loss_val': 0.7260526395912921, 'psi': 0.7378673287130271}-{'f1_val': 0.4159809982275058, 'auprc': 0.7819244703604329, 'loss_val': 0.9482449277344657, 'psi': 0.5623583870806766}
[S3] START round=6 head_norm_before_train=0.867629 cos_to_last_merge=1.0000 (last merge round=5)
[S3] round=6 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8323845246670236, 'loss_val': 1.1106811785701927, 'psi': 0.4168578492352737}-{'f1_val': 0.13984006561410703, 'auprc': 0.9119540272832882, 'loss_val': 1.12902486218546, 'psi': 0.44868565028177954}
[S4] START round=6 head_norm_before_train=1.078844 cos_to_last_merge=0.9861 (last merge round=4)
[S4] round=6 local utility u=0.000000 metrics={'f1_val': 0.6624814591541285, 'auprc': 0.7262420555834582, 'loss_val': 0.5295186479884889, 'psi': 0.6879856977258604}-{'f1_val': 0.6613741131760095, 'auprc': 0.8567223812123269, 'loss_val': 0.7014258746319223, 'psi': 0.7395134203905365}
[S5] START round=6 head_norm_before_train=1.241786 (no previous merge yet)
[S5] round=6 local utility u=0.062664 metrics={'f1_val': 0.41803043574602833, 'auprc': 0.772640613985939, 'loss_val': 1.003166322972361, 'psi': 0.5598745070419926}-{'f1_val': 0.4167436894719335, 'auprc': 0.7701110411590707, 'loss_val': 1.11318543307473, 'psi': 0.5580906301467884}
[S6] START round=6 head_norm_before_train=1.072513 cos_to_last_merge=0.9511 (last merge round=1)
[S6] round=6 local utility u=0.660192 metrics={'f1_val': 0.7126950860738204, 'auprc': 0.7914954595789022, 'loss_val': 0.564751236047581, 'psi': 0.7442152354758531}-{'f1_val': 0.5600724419372706, 'auprc': 0.7252501834017618, 'loss_val': 0.7706627467591686, 'psi': 0.6261435385230671}
[S7] START round=6 head_norm_before_train=1.259793 (no previous merge yet)
[S7] round=6 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.6999350643929138, 'loss_val': 1.2360279941643522, 'psi': 0.3652081193946205}-{'f1_val': 0.14205682272909165, 'auprc': 0.7316005905734098, 'loss_val': 1.2593283986958554, 'psi': 0.3778743298668189}
[S8] START round=6 head_norm_before_train=1.131876 cos_to_last_merge=0.9202 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.920
[S8] round=6 local utility u=1.000000 metrics={'f1_val': 0.7141742661762565, 'auprc': 0.9951049690195863, 'loss_val': 0.37981618960251434, 'psi': 0.8265465473135885}-{'f1_val': 0.37339943428936406, 'auprc': 0.8636117517887745, 'loss_val': 0.6002396444532757, 'psi': 0.5694843612891283}
[S9] START round=6 head_norm_before_train=1.320371 (no previous merge yet)
[S9] round=6 local utility u=0.885806 metrics={'f1_val': 0.41677413407000763, 'auprc': 0.7618871387940103, 'loss_val': 0.8760136875691935, 'psi': 0.5548193359596088}-{'f1_val': 0.141397957139996, 'auprc': 0.7829438882786013, 'loss_val': 1.0585397191788517, 'psi': 0.39801632959543815}
[S10] START round=6 head_norm_before_train=1.092445 cos_to_last_merge=0.9159 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.916
[S10] round=6 local utility u=0.580056 metrics={'f1_val': 0.7001085408329333, 'auprc': 0.9969807984099776, 'loss_val': 0.4748728661633096, 'psi': 0.818857443863751}-{'f1_val': 0.6265589884666747, 'auprc': 0.8102895558548218, 'loss_val': 0.6336129550797088, 'psi': 0.7000512154219335}
[S11] START round=6 head_norm_before_train=0.783903 cos_to_last_merge=1.0000 (last merge round=5)
[S11] round=6 local utility u=0.000000 metrics={'f1_val': 0.41491559158615293, 'auprc': 0.799578825965763, 'loss_val': 0.9691186902500896, 'psi': 0.568780885337997}-{'f1_val': 0.41575190755414737, 'auprc': 0.9554810650236405, 'loss_val': 0.997784419503262, 'psi': 0.6316435705419446}
[S13] START round=6 head_norm_before_train=1.303893 cos_to_last_merge=1.0000 (last merge round=5)
[S13] round=6 local utility u=0.503304 metrics={'f1_val': 0.5235896070844888, 'auprc': 0.7612669053444939, 'loss_val': 0.7753492208678368, 'psi': 0.6186605263884908}-{'f1_val': 0.37169029467602305, 'auprc': 0.772446044411596, 'loss_val': 0.9040981871758482, 'psi': 0.5319925945702523}
[S14] START round=6 head_norm_before_train=0.865116 cos_to_last_merge=1.0000 (last merge round=5)
[S14] round=6 local utility u=0.004781 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.5608063001506178, 'loss_val': 1.2500933940895673, 'psi': 0.3085372317898694}-{'f1_val': 0.14035785288270378, 'auprc': 0.5665383781285053, 'loss_val': 1.2768518395897561, 'psi': 0.3108300629810244}
[S15] START round=6 head_norm_before_train=1.486028 (no previous merge yet)
[S15] round=6 local utility u=0.077453 metrics={'f1_val': 0.6919273955027526, 'auprc': 0.987996375270348, 'loss_val': 0.45841362080762454, 'psi': 0.8103549874097908}-{'f1_val': 0.6939591681912007, 'auprc': 0.9896820103944112, 'loss_val': 0.6305679513341371, 'psi': 0.8122483050724849}
[S16] START round=6 head_norm_before_train=0.770863 cos_to_last_merge=1.0000 (last merge round=5)
[S16] round=6 local utility u=0.023812 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8587607805136528, 'loss_val': 1.2556603260972947, 'psi': 0.427886782324983}-{'f1_val': 0.14063745019920318, 'auprc': 0.8573831770170401, 'loss_val': 1.2991513205600023, 'psi': 0.42733574092633797}
[S17] START round=6 head_norm_before_train=0.978005 cos_to_last_merge=1.0000 (last merge round=5)
[S17] round=6 local utility u=0.160410 metrics={'f1_val': 0.35338608159357165, 'auprc': 0.709657639165506, 'loss_val': 0.8974278565297931, 'psi': 0.4958947046223454}-{'f1_val': 0.3436703339607888, 'auprc': 0.692983251930712, 'loss_val': 1.1099301771300223, 'psi': 0.48339550114875807}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:45913
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:45915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:45917
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:45909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:45902
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S5] → sending delta(kind=head bytes=1791) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:45912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:45917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:45903
[S10] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1791 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1795 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S10
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.168810)
[S8] loaded HEAD from S10 (vec_in norm=1.168810)
[S8] cosine check vs S10: cos=-0.0756
[S8] DROPPED delta from S10 (cos=-0.0756 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1799) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.894105)
[S11] loaded HEAD from S14 (vec_in norm=0.894105)
[S11] cosine check vs S14: cos=0.5026
[S11] BUFFERED delta from S14 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1799) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.217071)
[S3] loaded HEAD from S8 (vec_in norm=1.217071)
[S3] cosine check vs S8: cos=0.6351
[S3] BUFFERED delta from S8 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1798) from S2
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=0.954157)
[S17] loaded HEAD from S2 (vec_in norm=0.954157)
[S17] cosine check vs S2: cos=0.0788
[S17] BUFFERED delta from S2 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1791) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.270888)
[S16] loaded HEAD from S5 (vec_in norm=1.270888)
[S16] cosine check vs S5: cos=0.7827
[S16] BUFFERED delta from S5 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1801) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.147902)
[S17] loaded HEAD from S6 (vec_in norm=1.147902)
[S17] cosine check vs S6: cos=-0.0718
[S17] DROPPED delta from S6 (cos=-0.0718 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1796) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.360064)
[S16] loaded HEAD from S9 (vec_in norm=1.360064)
[S16] cosine check vs S9: cos=0.3392
[S16] BUFFERED delta from S9 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1796) from S16
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.791910)
[S15] loaded HEAD from S16 (vec_in norm=0.791910)
[S15] cosine check vs S16: cos=0.0194
[S15] BUFFERED delta from S16 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1803) from S15
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.545214)
[S13] loaded HEAD from S15 (vec_in norm=1.545214)
[S13] cosine check vs S15: cos=0.9561
[S13] BUFFERED delta from S15 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1795) from S13
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.351475)
[S2] loaded HEAD from S13 (vec_in norm=1.351475)
[S2] cosine check vs S13: cos=0.6121
[S2] BUFFERED delta from S13 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:45914
[S17] sending update (kind=head size=1801 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1801) from S17
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.032083)
[S14] loaded HEAD from S17 (vec_in norm=1.032083)
[S14] cosine check vs S17: cos=0.0851
[S14] BUFFERED delta from S17 (total buffered=1)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=6 metric=0.1398 head_norm=0.895436
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.739958e-01
[S3] stored merged vector for next round verification (round=6)
[S3] DEBUG after merge:  round=6 metric=0.1398 head_norm=0.957529 delta_norm=0.473996
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=6 metric=0.4149 head_norm=0.827694
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.303131e-01
[S11] stored merged vector for next round verification (round=6)
[S11] DEBUG after merge:  round=6 metric=0.4158 head_norm=0.746379 delta_norm=0.430313
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=6 metric=0.1404 head_norm=0.894105
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.533667e-01
[S14] stored merged vector for next round verification (round=6)
[S14] DEBUG after merge:  round=6 metric=0.1404 head_norm=0.710930 delta_norm=0.653367
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=6 metric=0.1406 head_norm=0.791910
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.444839e-01
[S16] stored merged vector for next round verification (round=6)
[S16] DEBUG after merge:  round=6 metric=0.1406 head_norm=0.833782 delta_norm=0.344484
[S16] aggregate: ACCEPT kept=['S5', 'S9'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=6 metric=0.6919 head_norm=1.545214
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.613019e-01
[S15] stored merged vector for next round verification (round=6)
[S15] DEBUG after merge:  round=6 metric=0.6939 head_norm=0.874965 delta_norm=0.861302
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=6 metric=0.5236 head_norm=1.351475
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.349789e-01
[S13] stored merged vector for next round verification (round=6)
[S13] DEBUG after merge:  round=6 metric=0.6044 head_norm=1.432435 delta_norm=0.234979
[S13] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=6 metric=0.7011 head_norm=0.954157
[S2] _apply_head_vector_avg (torch): Δ‖w‖=5.380986e-01
[S2] stored merged vector for next round verification (round=6)
[S2] DEBUG after merge:  round=6 metric=0.7011 head_norm=1.038701 delta_norm=0.538099
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=6 metric=0.3534 head_norm=1.032083
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.746183e-01
[S17] stored merged vector for next round verification (round=6)
[S17] DEBUG after merge:  round=6 metric=0.3534 head_norm=0.729860 delta_norm=0.674618
[S17] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=1.038701 cos_to_last_merge=1.0000 (last merge round=6)
[S2] round=7 local utility u=0.000000 metrics={'f1_val': 0.7016486554080751, 'auprc': 0.7286912446362247, 'loss_val': 0.5403664207678596, 'psi': 0.7124656910993349}-{'f1_val': 0.7011294018287861, 'auprc': 0.7929742190393885, 'loss_val': 0.7260526395912921, 'psi': 0.7378673287130271}
[S3] START round=7 head_norm_before_train=0.957529 cos_to_last_merge=1.0000 (last merge round=6)
[S3] round=7 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.6487678761502038, 'loss_val': 1.07532242230344, 'psi': 0.3434111898285458}-{'f1_val': 0.13984006561410703, 'auprc': 0.8323845246670236, 'loss_val': 1.1106811785701927, 'psi': 0.4168578492352737}
[S4] START round=7 head_norm_before_train=1.179286 cos_to_last_merge=0.9630 (last merge round=4)
[S4] round=7 local utility u=1.000000 metrics={'f1_val': 0.9485740566415711, 'auprc': 0.9464842845350186, 'loss_val': 0.4119415681046693, 'psi': 0.9477381477989502}-{'f1_val': 0.6624814591541285, 'auprc': 0.7262420555834582, 'loss_val': 0.5295186479884889, 'psi': 0.6879856977258604}
[S5] START round=7 head_norm_before_train=1.270888 (no previous merge yet)
[S5] round=7 local utility u=0.102641 metrics={'f1_val': 0.4175873768787894, 'auprc': 0.7947900161891113, 'loss_val': 0.8616741423544331, 'psi': 0.5684684326029181}-{'f1_val': 0.41803043574602833, 'auprc': 0.772640613985939, 'loss_val': 1.003166322972361, 'psi': 0.5598745070419926}
[S6] START round=7 head_norm_before_train=1.147902 cos_to_last_merge=0.9263 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.926
[S6] round=7 local utility u=0.000000 metrics={'f1_val': 0.7046620865101015, 'auprc': 0.7712922822359447, 'loss_val': 0.5939351609661726, 'psi': 0.7313141648004389}-{'f1_val': 0.7126950860738204, 'auprc': 0.7914954595789022, 'loss_val': 0.564751236047581, 'psi': 0.7442152354758531}
[S7] START round=7 head_norm_before_train=1.270682 (no previous merge yet)
[S7] round=7 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.6133403683756874, 'loss_val': 1.2041678051869298, 'psi': 0.33057024098772997}-{'f1_val': 0.14205682272909165, 'auprc': 0.6999350643929138, 'loss_val': 1.2360279941643522, 'psi': 0.3652081193946205}
[S8] START round=7 head_norm_before_train=1.217071 cos_to_last_merge=0.8882 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.888
[S8] round=7 local utility u=0.003188 metrics={'f1_val': 0.7140170479737811, 'auprc': 0.979067986231652, 'loss_val': 0.32438671186524054, 'psi': 0.8200374232769294}-{'f1_val': 0.7141742661762565, 'auprc': 0.9951049690195863, 'loss_val': 0.37981618960251434, 'psi': 0.8265465473135885}
[S9] START round=7 head_norm_before_train=1.360064 (no previous merge yet)
[S9] round=7 local utility u=1.000000 metrics={'f1_val': 0.7018648842933433, 'auprc': 0.9999423944992215, 'loss_val': 0.6274666791235989, 'psi': 0.8210958883756946}-{'f1_val': 0.41677413407000763, 'auprc': 0.7618871387940103, 'loss_val': 0.8760136875691935, 'psi': 0.5548193359596088}
[S10] START round=7 head_norm_before_train=1.168810 cos_to_last_merge=0.8886 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.889
[S10] round=7 local utility u=0.000000 metrics={'f1_val': 0.6878417320976828, 'auprc': 0.9487203262133229, 'loss_val': 0.3760163053303492, 'psi': 0.7921931697439388}-{'f1_val': 0.7001085408329333, 'auprc': 0.9969807984099776, 'loss_val': 0.4748728661633096, 'psi': 0.818857443863751}
[S11] START round=7 head_norm_before_train=0.746379 cos_to_last_merge=1.0000 (last merge round=6)
[S11] round=7 local utility u=0.000000 metrics={'f1_val': 0.39703471345369445, 'auprc': 0.7920384741523407, 'loss_val': 0.9676897563090712, 'psi': 0.5550362177331529}-{'f1_val': 0.41491559158615293, 'auprc': 0.799578825965763, 'loss_val': 0.9691186902500896, 'psi': 0.568780885337997}
[S13] START round=7 head_norm_before_train=1.432435 cos_to_last_merge=1.0000 (last merge round=6)
[S13] round=7 local utility u=0.636424 metrics={'f1_val': 0.7084042886592661, 'auprc': 0.7684353320297216, 'loss_val': 0.6328947052524716, 'psi': 0.7324167060074482}-{'f1_val': 0.5235896070844888, 'auprc': 0.7612669053444939, 'loss_val': 0.7753492208678368, 'psi': 0.6186605263884908}
[S14] START round=7 head_norm_before_train=0.710930 cos_to_last_merge=1.0000 (last merge round=6)
[S14] round=7 local utility u=0.155054 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.6418189952064757, 'loss_val': 1.183023185040853, 'psi': 0.3409423098122125}-{'f1_val': 0.14035785288270378, 'auprc': 0.5608063001506178, 'loss_val': 1.2500933940895673, 'psi': 0.3085372317898694}
[S15] START round=7 head_norm_before_train=0.874965 cos_to_last_merge=1.0000 (last merge round=6)
[S15] round=7 local utility u=0.000000 metrics={'f1_val': 0.7013484921390984, 'auprc': 0.7992813367248603, 'loss_val': 0.5176394692694194, 'psi': 0.7405216299734032}-{'f1_val': 0.6919273955027526, 'auprc': 0.987996375270348, 'loss_val': 0.45841362080762454, 'psi': 0.8103549874097908}
[S16] START round=7 head_norm_before_train=0.833782 cos_to_last_merge=1.0000 (last merge round=6)
[S16] round=7 local utility u=0.961795 metrics={'f1_val': 0.4144820245979186, 'auprc': 0.9282488030878956, 'loss_val': 1.1836008847577395, 'psi': 0.6199887359939094}-{'f1_val': 0.14063745019920318, 'auprc': 0.8587607805136528, 'loss_val': 1.2556603260972947, 'psi': 0.427886782324983}
[S17] START round=7 head_norm_before_train=0.729860 cos_to_last_merge=1.0000 (last merge round=6)
[S17] round=7 local utility u=0.419917 metrics={'f1_val': 0.41114851972170396, 'auprc': 0.8436473011424406, 'loss_val': 0.8061368278584062, 'psi': 0.5841480322899986}-{'f1_val': 0.35338608159357165, 'auprc': 0.709657639165506, 'loss_val': 0.8974278565297931, 'psi': 0.4958947046223454}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:45916
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:45912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:45915
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:45916
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:45902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:45903
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:45914
[S8] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1794 to 1 peers)
[S13] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1799) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.737992)
[S11] loaded HEAD from S14 (vec_in norm=0.737992)
[S11] cosine check vs S14: cos=0.6168
[S11] BUFFERED delta from S14 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1797) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.296544)
[S3] loaded HEAD from S8 (vec_in norm=1.296544)
[S3] cosine check vs S8: cos=0.9020
[S3] BUFFERED delta from S8 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1801) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.299856)
[S16] loaded HEAD from S5 (vec_in norm=1.299856)
[S16] cosine check vs S5: cos=0.8047
[S16] BUFFERED delta from S5 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1796) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.404554)
[S16] loaded HEAD from S9 (vec_in norm=1.404554)
[S16] cosine check vs S9: cos=0.6123
[S16] BUFFERED delta from S9 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1798) from S16
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.860420)
[S15] loaded HEAD from S16 (vec_in norm=0.860420)
[S15] cosine check vs S16: cos=0.4343
[S15] BUFFERED delta from S16 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1794) from S4
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.270715)
[S14] loaded HEAD from S4 (vec_in norm=1.270715)
[S14] cosine check vs S4: cos=0.6552
[S14] BUFFERED delta from S4 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1795) from S13
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.478819)
[S2] loaded HEAD from S13 (vec_in norm=1.478819)
[S2] cosine check vs S13: cos=0.8648
[S2] BUFFERED delta from S13 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:45914
[S17] sending update (kind=head size=1796 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1796) from S17
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.819109)
[S14] loaded HEAD from S17 (vec_in norm=0.819109)
[S14] cosine check vs S17: cos=0.6867
[S14] BUFFERED delta from S17 (total buffered=2)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=7 metric=0.1398 head_norm=0.977154
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.959079e-01
[S3] stored merged vector for next round verification (round=7)
[S3] DEBUG after merge:  round=7 metric=0.1398 head_norm=1.109219 delta_norm=0.295908
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=7 metric=0.7016 head_norm=1.104626
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.813195e-01
[S2] stored merged vector for next round verification (round=7)
[S2] DEBUG after merge:  round=7 metric=0.7016 head_norm=1.248258 delta_norm=0.381320
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=7 metric=0.3970 head_norm=0.785551
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.341293e-01
[S11] stored merged vector for next round verification (round=7)
[S11] DEBUG after merge:  round=7 metric=0.4154 head_norm=0.684995 delta_norm=0.334129
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=7 metric=0.4145 head_norm=0.860420
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.973110e-01
[S16] stored merged vector for next round verification (round=7)
[S16] DEBUG after merge:  round=7 metric=0.4153 head_norm=0.926771 delta_norm=0.197311
[S16] aggregate: ACCEPT kept=['S5', 'S9'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=7 metric=0.1404 head_norm=0.737992
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.985870e-01
[S14] stored merged vector for next round verification (round=7)
[S14] DEBUG after merge:  round=7 metric=0.1404 head_norm=0.744465 delta_norm=0.198587
[S14] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=7 metric=0.7013 head_norm=0.973634
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.900381e-01
[S15] stored merged vector for next round verification (round=7)
[S15] DEBUG after merge:  round=7 metric=0.7014 head_norm=0.777178 delta_norm=0.490038
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=1.248258 cos_to_last_merge=1.0000 (last merge round=7)
[S2] round=8 local utility u=0.158799 metrics={'f1_val': 0.7015710590385817, 'auprc': 0.8064765910296162, 'loss_val': 0.4556596493074016, 'psi': 0.7435332718349955}-{'f1_val': 0.7016486554080751, 'auprc': 0.7286912446362247, 'loss_val': 0.5403664207678596, 'psi': 0.7124656910993349}
[S3] START round=8 head_norm_before_train=1.109219 cos_to_last_merge=1.0000 (last merge round=7)
[S3] round=8 local utility u=1.000000 metrics={'f1_val': 0.397126933948974, 'auprc': 0.855931147731539, 'loss_val': 0.995227288629263, 'psi': 0.580648619462}-{'f1_val': 0.13984006561410703, 'auprc': 0.6487678761502038, 'loss_val': 1.07532242230344, 'psi': 0.3434111898285458}
[S4] START round=8 head_norm_before_train=1.270715 cos_to_last_merge=0.9436 (last merge round=4)
[S4] ⚠️ Model drifted since last merge! cos=0.944
[S4] round=8 local utility u=0.000000 metrics={'f1_val': 0.941810392672322, 'auprc': 0.903796052039747, 'loss_val': 0.42439545801585565, 'psi': 0.926604656419292}-{'f1_val': 0.9485740566415711, 'auprc': 0.9464842845350186, 'loss_val': 0.4119415681046693, 'psi': 0.9477381477989502}
[S5] START round=8 head_norm_before_train=1.299856 (no previous merge yet)
[S5] round=8 local utility u=0.051048 metrics={'f1_val': 0.41770670426636225, 'auprc': 0.794829863407446, 'loss_val': 0.7604141257685655, 'psi': 0.5685559679227958}-{'f1_val': 0.4175873768787894, 'auprc': 0.7947900161891113, 'loss_val': 0.8616741423544331, 'psi': 0.5684684326029181}
[S6] START round=8 head_norm_before_train=1.218172 cos_to_last_merge=0.9006 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.901
[S6] round=8 local utility u=0.003726 metrics={'f1_val': 0.6960721175175146, 'auprc': 0.7829459417311438, 'loss_val': 0.5699051609683495, 'psi': 0.7308216472029663}-{'f1_val': 0.7046620865101015, 'auprc': 0.7712922822359447, 'loss_val': 0.5939351609661726, 'psi': 0.7313141648004389}
[S7] START round=8 head_norm_before_train=1.282674 (no previous merge yet)
[S7] round=8 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.5770565855469163, 'loss_val': 1.144891848477129, 'psi': 0.3160567278562215}-{'f1_val': 0.14205682272909165, 'auprc': 0.6133403683756874, 'loss_val': 1.2041678051869298, 'psi': 0.33057024098772997}
[S8] START round=8 head_norm_before_train=1.296544 cos_to_last_merge=0.8632 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.863
[S8] round=8 local utility u=0.077598 metrics={'f1_val': 0.7179652498568447, 'auprc': 0.9827725175893384, 'loss_val': 0.20399358357789815, 'psi': 0.8238881569498422}-{'f1_val': 0.7140170479737811, 'auprc': 0.979067986231652, 'loss_val': 0.32438671186524054, 'psi': 0.8200374232769294}
[S9] START round=8 head_norm_before_train=1.404554 (no previous merge yet)
[S9] round=8 local utility u=0.093786 metrics={'f1_val': 0.7017906989076834, 'auprc': 0.9995396230063079, 'loss_val': 0.43824044887922364, 'psi': 0.8208902685471333}-{'f1_val': 0.7018648842933433, 'auprc': 0.9999423944992215, 'loss_val': 0.6274666791235989, 'psi': 0.8210958883756946}
[S10] START round=8 head_norm_before_train=1.249305 cos_to_last_merge=0.8641 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.864
[S10] round=8 local utility u=0.144035 metrics={'f1_val': 0.6984821326114514, 'auprc': 0.9885254568384887, 'loss_val': 0.2712041080015358, 'psi': 0.8144994623022663}-{'f1_val': 0.6878417320976828, 'auprc': 0.9487203262133229, 'loss_val': 0.3760163053303492, 'psi': 0.7921931697439388}
[S11] START round=8 head_norm_before_train=0.684995 cos_to_last_merge=1.0000 (last merge round=7)
[S11] round=8 local utility u=0.234941 metrics={'f1_val': 0.39651855440916606, 'auprc': 0.9392283197703257, 'loss_val': 0.9362811905346263, 'psi': 0.6136024605536299}-{'f1_val': 0.39703471345369445, 'auprc': 0.7920384741523407, 'loss_val': 0.9676897563090712, 'psi': 0.5550362177331529}
[S13] START round=8 head_norm_before_train=1.478819 cos_to_last_merge=0.9966 (last merge round=6)
[S13] round=8 local utility u=0.000000 metrics={'f1_val': 0.4988011715707262, 'auprc': 0.7628993380457059, 'loss_val': 0.6732719438056085, 'psi': 0.604440438160718}-{'f1_val': 0.7084042886592661, 'auprc': 0.7684353320297216, 'loss_val': 0.6328947052524716, 'psi': 0.7324167060074482}
[S14] START round=8 head_norm_before_train=0.744465 cos_to_last_merge=1.0000 (last merge round=7)
[S14] round=8 local utility u=0.507161 metrics={'f1_val': 0.20014329649831172, 'auprc': 0.8207047587492207, 'loss_val': 1.0640717679469025, 'psi': 0.44836788139867534}-{'f1_val': 0.14035785288270378, 'auprc': 0.6418189952064757, 'loss_val': 1.183023185040853, 'psi': 0.3409423098122125}
[S15] START round=8 head_norm_before_train=0.777178 cos_to_last_merge=1.0000 (last merge round=7)
[S15] round=8 local utility u=0.000000 metrics={'f1_val': 0.6985461616389177, 'auprc': 0.7993584595320125, 'loss_val': 0.5268635080472129, 'psi': 0.7388710807961556}-{'f1_val': 0.7013484921390984, 'auprc': 0.7992813367248603, 'loss_val': 0.5176394692694194, 'psi': 0.7405216299734032}
[S16] START round=8 head_norm_before_train=0.926771 cos_to_last_merge=1.0000 (last merge round=7)
[S16] round=8 local utility u=0.000000 metrics={'f1_val': 0.41719231679200464, 'auprc': 0.5205769179977895, 'loss_val': 1.0361263992127279, 'psi': 0.4585461572743186}-{'f1_val': 0.4144820245979186, 'auprc': 0.9282488030878956, 'loss_val': 1.1836008847577395, 'psi': 0.6199887359939094}
[S17] START round=8 head_norm_before_train=0.819109 cos_to_last_merge=0.9817 (last merge round=6)
[S17] round=8 local utility u=0.034419 metrics={'f1_val': 0.4407728506894889, 'auprc': 0.7912314018038361, 'loss_val': 0.7577971540101838, 'psi': 0.5809562711352279}-{'f1_val': 0.41114851972170396, 'auprc': 0.8436473011424406, 'loss_val': 0.8061368278584062, 'psi': 0.5841480322899986}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:45903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:45912
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:45909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:45917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:45917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:45916
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:45917
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1805 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1800) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.355249)
[S3] loaded HEAD from S8 (vec_in norm=1.355249)
[S3] cosine check vs S8: cos=0.9611
[S3] BUFFERED delta from S8 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1803) from S3
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.126149)
[S17] loaded HEAD from S3 (vec_in norm=1.126149)
[S17] cosine check vs S3: cos=0.1051
[S17] BUFFERED delta from S3 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1801) from S2
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.305947)
[S17] loaded HEAD from S2 (vec_in norm=1.305947)
[S17] cosine check vs S2: cos=0.4418
[S17] BUFFERED delta from S2 (total buffered=2)
[S17] RECEIVED delta(kind=head bytes=1805) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.269950)
[S17] loaded HEAD from S6 (vec_in norm=1.269950)
[S17] cosine check vs S6: cos=-0.0691
[S17] DROPPED delta from S6 (cos=-0.0691 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1799) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.458039)
[S16] loaded HEAD from S9 (vec_in norm=1.458039)
[S16] cosine check vs S9: cos=0.6976
[S16] BUFFERED delta from S9 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1802) from S11
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.723592)
[S16] loaded HEAD from S11 (vec_in norm=0.723592)
[S16] cosine check vs S11: cos=0.1099
[S16] BUFFERED delta from S11 (total buffered=2)
[S16] RECEIVED delta(kind=head bytes=1799) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.323199)
[S16] loaded HEAD from S5 (vec_in norm=1.323199)
[S16] cosine check vs S5: cos=0.7743
[S16] BUFFERED delta from S5 (total buffered=3)
[S8] RECEIVED delta(kind=head bytes=1803) from S10
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.316331)
[S8] loaded HEAD from S10 (vec_in norm=1.316331)
[S8] cosine check vs S10: cos=-0.0625
[S8] DROPPED delta from S10 (cos=-0.0625 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1798) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.779280)
[S11] loaded HEAD from S14 (vec_in norm=0.779280)
[S11] cosine check vs S14: cos=0.8864
[S11] BUFFERED delta from S14 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:45914
[S17] sending update (kind=head size=1800 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1800) from S17
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.915113)
[S14] loaded HEAD from S17 (vec_in norm=0.915113)
[S14] cosine check vs S17: cos=0.6565
[S14] BUFFERED delta from S17 (total buffered=1)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=8 metric=0.3965 head_norm=0.723592
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.811253e-01
[S11] stored merged vector for next round verification (round=8)
[S11] DEBUG after merge:  round=8 metric=0.3966 head_norm=0.729811 delta_norm=0.181125
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=8 metric=0.2001 head_norm=0.779280
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.565184e-01
[S14] stored merged vector for next round verification (round=8)
[S14] DEBUG after merge:  round=8 metric=0.1548 head_norm=0.771524 delta_norm=0.356518
[S14] aggregate: ROLLBACK (f1_val pre=0.200 post=0.155 tol_abs=0.005 tol_rel=0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=8 metric=0.3971 head_norm=1.126149
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.068633e-01
[S3] stored merged vector for next round verification (round=8)
[S3] DEBUG after merge:  round=8 metric=0.3980 head_norm=1.228683 delta_norm=0.206863
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=8 metric=0.4172 head_norm=0.960419
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.245142e-01
[S16] stored merged vector for next round verification (round=8)
[S16] DEBUG after merge:  round=8 metric=0.4172 head_norm=0.808226 delta_norm=0.224514
[S16] aggregate: ACCEPT kept=['S9', 'S11', 'S5'] (k=3/3) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=8 metric=0.4408 head_norm=0.915113
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.913808e-01
[S17] stored merged vector for next round verification (round=8)
[S17] DEBUG after merge:  round=8 metric=0.5199 head_norm=0.748062 delta_norm=0.491381
[S17] aggregate: ACCEPT kept=['S3', 'S2'] (k=2/2) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.305947 cos_to_last_merge=0.9928 (last merge round=7)
[S2] round=9 local utility u=0.000000 metrics={'f1_val': 0.7015710590385817, 'auprc': 0.6719249668985922, 'loss_val': 0.34850435106824873, 'psi': 0.6897126221825859}-{'f1_val': 0.7015710590385817, 'auprc': 0.8064765910296162, 'loss_val': 0.4556596493074016, 'psi': 0.7435332718349955}
[S3] START round=9 head_norm_before_train=1.228683 cos_to_last_merge=1.0000 (last merge round=8)
[S3] round=9 local utility u=0.730959 metrics={'f1_val': 0.6250408399975623, 'auprc': 0.866928936407279, 'loss_val': 0.9337863362254727, 'psi': 0.721796078561449}-{'f1_val': 0.397126933948974, 'auprc': 0.855931147731539, 'loss_val': 0.995227288629263, 'psi': 0.580648619462}
[S4] START round=9 head_norm_before_train=1.332852 cos_to_last_merge=0.9317 (last merge round=4)
[S4] ⚠️ Model drifted since last merge! cos=0.932
[S4] round=9 local utility u=0.152050 metrics={'f1_val': 0.9432042569523932, 'auprc': 0.9610286809692403, 'loss_val': 0.3003574164585736, 'psi': 0.950334026559132}-{'f1_val': 0.941810392672322, 'auprc': 0.903796052039747, 'loss_val': 0.42439545801585565, 'psi': 0.926604656419292}
[S5] START round=9 head_norm_before_train=1.323199 (no previous merge yet)
[S5] round=9 local utility u=0.735425 metrics={'f1_val': 0.6481339284822949, 'auprc': 0.7948822475020849, 'loss_val': 0.6722838433585137, 'psi': 0.7068332560902109}-{'f1_val': 0.41770670426636225, 'auprc': 0.794829863407446, 'loss_val': 0.7604141257685655, 'psi': 0.5685559679227958}
[S6] START round=9 head_norm_before_train=1.269950 cos_to_last_merge=0.8836 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.884
[S6] round=9 local utility u=0.248120 metrics={'f1_val': 0.6758119401097913, 'auprc': 0.9198833731179918, 'loss_val': 0.362916674302516, 'psi': 0.7734405133130715}-{'f1_val': 0.6960721175175146, 'auprc': 0.7829459417311438, 'loss_val': 0.5699051609683495, 'psi': 0.7308216472029663}
[S7] START round=9 head_norm_before_train=1.305001 (no previous merge yet)
[S7] round=9 local utility u=0.897698 metrics={'f1_val': 0.4170778520170104, 'auprc': 0.5862080174464644, 'loss_val': 1.027076226865331, 'psi': 0.4847299181887921}-{'f1_val': 0.14205682272909165, 'auprc': 0.5770565855469163, 'loss_val': 1.144891848477129, 'psi': 0.3160567278562215}
[S8] START round=9 head_norm_before_train=1.355249 cos_to_last_merge=0.8450 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.845
[S8] round=9 local utility u=0.888248 metrics={'f1_val': 0.9943397297499055, 'auprc': 0.9976342129284118, 'loss_val': 0.13032902172069535, 'psi': 0.995657523021308}-{'f1_val': 0.7179652498568447, 'auprc': 0.9827725175893384, 'loss_val': 0.20399358357789815, 'psi': 0.8238881569498422}
[S9] START round=9 head_norm_before_train=1.458039 (no previous merge yet)
[S9] round=9 local utility u=0.055773 metrics={'f1_val': 0.7014667606303384, 'auprc': 0.9987205241140614, 'loss_val': 0.32229423308853566, 'psi': 0.8203682660238276}-{'f1_val': 0.7017906989076834, 'auprc': 0.9995396230063079, 'loss_val': 0.43824044887922364, 'psi': 0.8208902685471333}
[S10] START round=9 head_norm_before_train=1.316331 cos_to_last_merge=0.8435 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.844
[S10] round=9 local utility u=0.000000 metrics={'f1_val': 0.5205603070503089, 'auprc': 0.8943554451713358, 'loss_val': 0.5297768407337158, 'psi': 0.6700783622987196}-{'f1_val': 0.6984821326114514, 'auprc': 0.9885254568384887, 'loss_val': 0.2712041080015358, 'psi': 0.8144994623022663}
[S11] START round=9 head_norm_before_train=0.729811 cos_to_last_merge=1.0000 (last merge round=8)
[S11] round=9 local utility u=0.021910 metrics={'f1_val': 0.39655223592620625, 'auprc': 0.939549369660148, 'loss_val': 0.893625809114924, 'psi': 0.613751089419783}-{'f1_val': 0.39651855440916606, 'auprc': 0.9392283197703257, 'loss_val': 0.9362811905346263, 'psi': 0.6136024605536299}
[S13] START round=9 head_norm_before_train=1.527125 cos_to_last_merge=0.9900 (last merge round=6)
[S13] round=9 local utility u=0.665508 metrics={'f1_val': 0.6986806481850054, 'auprc': 0.7424383309586681, 'loss_val': 0.4801501695432236, 'psi': 0.7161837212944705}-{'f1_val': 0.4988011715707262, 'auprc': 0.7628993380457059, 'loss_val': 0.6732719438056085, 'psi': 0.604440438160718}
[S14] START round=9 head_norm_before_train=0.771524 cos_to_last_merge=1.0000 (last merge round=8)
[S14] round=9 local utility u=0.838451 metrics={'f1_val': 0.39652757107859105, 'auprc': 0.945347754764425, 'loss_val': 0.9394044420318606, 'psi': 0.6160556445529246}-{'f1_val': 0.20014329649831172, 'auprc': 0.8207047587492207, 'loss_val': 1.0640717679469025, 'psi': 0.44836788139867534}
[S15] START round=9 head_norm_before_train=0.897250 cos_to_last_merge=0.9817 (last merge round=7)
[S15] round=9 local utility u=0.039773 metrics={'f1_val': 0.6995968404292547, 'auprc': 0.7993921310270682, 'loss_val': 0.45372330809386197, 'psi': 0.7395149566683801}-{'f1_val': 0.6985461616389177, 'auprc': 0.7993584595320125, 'loss_val': 0.5268635080472129, 'psi': 0.7388710807961556}
[S16] START round=9 head_norm_before_train=0.808226 cos_to_last_merge=1.0000 (last merge round=8)
[S16] round=9 local utility u=0.071923 metrics={'f1_val': 0.4168831021970758, 'auprc': 0.5376813794180173, 'loss_val': 0.9417375659359689, 'psi': 0.4652024130854524}-{'f1_val': 0.41719231679200464, 'auprc': 0.5205769179977895, 'loss_val': 1.0361263992127279, 'psi': 0.4585461572743186}
[S17] START round=9 head_norm_before_train=0.748062 cos_to_last_merge=1.0000 (last merge round=8)
[S17] round=9 local utility u=0.758419 metrics={'f1_val': 0.6647550223242054, 'auprc': 0.8387318488809978, 'loss_val': 0.7273535318235751, 'psi': 0.7343457529469224}-{'f1_val': 0.4407728506894889, 'auprc': 0.7912314018038361, 'loss_val': 0.7577971540101838, 'psi': 0.5809562711352279}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:45917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:45914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:45915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:45916
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:45903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:45912
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:45904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:45902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:45913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:45917
[S15] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1793 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S4
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.392054)
[S14] loaded HEAD from S4 (vec_in norm=1.392054)
[S14] cosine check vs S4: cos=0.4919
[S14] BUFFERED delta from S4 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1802) from S15
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.034613)
[S13] loaded HEAD from S15 (vec_in norm=1.034613)
[S13] cosine check vs S15: cos=0.6936
[S13] BUFFERED delta from S15 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1797) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.811635)
[S11] loaded HEAD from S14 (vec_in norm=0.811635)
[S11] cosine check vs S14: cos=0.8176
[S11] BUFFERED delta from S14 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1793) from S11
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.767514)
[S16] loaded HEAD from S11 (vec_in norm=0.767514)
[S16] cosine check vs S11: cos=0.2574
[S16] BUFFERED delta from S11 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1804) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.395994)
[S3] loaded HEAD from S8 (vec_in norm=1.395994)
[S3] cosine check vs S8: cos=0.9767
[S3] BUFFERED delta from S8 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1799) from S3
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.249974)
[S17] loaded HEAD from S3 (vec_in norm=1.249974)
[S17] cosine check vs S3: cos=0.3812
[S17] BUFFERED delta from S3 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1801) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.303358)
[S17] loaded HEAD from S6 (vec_in norm=1.303358)
[S17] cosine check vs S6: cos=-0.0568
[S17] DROPPED delta from S6 (cos=-0.0568 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1797) from S7
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.330171)
[S4] loaded HEAD from S7 (vec_in norm=1.330171)
[S4] cosine check vs S7: cos=0.7862
[S4] BUFFERED delta from S7 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1800) from S13
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.568366)
[S2] loaded HEAD from S13 (vec_in norm=1.568366)
[S2] cosine check vs S13: cos=0.9289
[S2] BUFFERED delta from S13 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1801) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.513589)
[S16] loaded HEAD from S9 (vec_in norm=1.513589)
[S16] cosine check vs S9: cos=0.6764
[S16] BUFFERED delta from S9 (total buffered=2)
[S16] RECEIVED delta(kind=head bytes=1798) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.354301)
[S16] loaded HEAD from S5 (vec_in norm=1.354301)
[S16] cosine check vs S5: cos=0.7535
[S16] BUFFERED delta from S5 (total buffered=3)
[S15] RECEIVED delta(kind=head bytes=1796) from S16
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.850242)
[S15] loaded HEAD from S16 (vec_in norm=0.850242)
[S15] cosine check vs S16: cos=0.6305
[S15] BUFFERED delta from S16 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:45914
[S17] sending update (kind=head size=1797 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1797) from S17
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.835272)
[S14] loaded HEAD from S17 (vec_in norm=0.835272)
[S14] cosine check vs S17: cos=0.8447
[S14] BUFFERED delta from S17 (total buffered=2)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=9 metric=0.7016 head_norm=1.375130
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.931929e-01
[S2] stored merged vector for next round verification (round=9)
[S2] DEBUG after merge:  round=9 metric=0.7016 head_norm=1.445481 delta_norm=0.293193
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=9 metric=0.9432 head_norm=1.392054
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.459351e-01
[S4] stored merged vector for next round verification (round=9)
[S4] DEBUG after merge:  round=9 metric=0.9419 head_norm=1.286361 delta_norm=0.445935
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=9 metric=0.3965 head_norm=0.811635
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.941594e-01
[S14] stored merged vector for next round verification (round=9)
[S14] DEBUG after merge:  round=9 metric=0.3965 head_norm=0.806659 delta_norm=0.294159
[S14] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=9 metric=0.6250 head_norm=1.249974
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.600530e-01
[S3] stored merged vector for next round verification (round=9)
[S3] DEBUG after merge:  round=9 metric=0.6827 head_norm=1.315295 delta_norm=0.160053
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=9 metric=0.6996 head_norm=1.034613
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.135402e-01
[S15] stored merged vector for next round verification (round=9)
[S15] DEBUG after merge:  round=9 metric=0.7001 head_norm=0.851852 delta_norm=0.413540
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=9 metric=0.4169 head_norm=0.850242
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.465871e-01
[S16] stored merged vector for next round verification (round=9)
[S16] DEBUG after merge:  round=9 metric=0.4169 head_norm=0.774912 delta_norm=0.146587
[S16] aggregate: ACCEPT kept=['S11', 'S9', 'S5'] (k=3/3) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=9 metric=0.6987 head_norm=1.568366
[S13] _apply_head_vector_avg (torch): Δ‖w‖=5.654889e-01
[S13] stored merged vector for next round verification (round=9)
[S13] DEBUG after merge:  round=9 metric=0.6922 head_norm=1.202215 delta_norm=0.565489
[S13] aggregate: ROLLBACK (f1_val pre=0.699 post=0.692 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=9 metric=0.3966 head_norm=0.767514
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.394014e-01
[S11] stored merged vector for next round verification (round=9)
[S11] DEBUG after merge:  round=9 metric=0.3966 head_norm=0.752729 delta_norm=0.239401
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=9 metric=0.6648 head_norm=0.835272
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.050078e-01
[S17] stored merged vector for next round verification (round=9)
[S17] DEBUG after merge:  round=9 metric=0.5475 head_norm=0.874084 delta_norm=0.605008
[S17] aggregate: ROLLBACK (f1_val pre=0.665 post=0.548 tol_abs=0.005 tol_rel=0.0)
[S2] START round=10 head_norm_before_train=1.445481 cos_to_last_merge=1.0000 (last merge round=9)
[S2] round=10 local utility u=0.000000 metrics={'f1_val': 0.4936411567194553, 'auprc': 0.6424444446351701, 'loss_val': 0.8081107996861138, 'psi': 0.5531624718857413}-{'f1_val': 0.7015710590385817, 'auprc': 0.6719249668985922, 'loss_val': 0.34850435106824873, 'psi': 0.6897126221825859}
[S3] START round=10 head_norm_before_train=1.315295 cos_to_last_merge=1.0000 (last merge round=9)
[S3] round=10 local utility u=0.000000 metrics={'f1_val': 0.4167285673593337, 'auprc': 0.723681476033857, 'loss_val': 0.8900033311094218, 'psi': 0.539509730829143}-{'f1_val': 0.6250408399975623, 'auprc': 0.866928936407279, 'loss_val': 0.9337863362254727, 'psi': 0.721796078561449}
[S4] START round=10 head_norm_before_train=1.286361 cos_to_last_merge=1.0000 (last merge round=9)
[S4] round=10 local utility u=0.000000 metrics={'f1_val': 0.938115632948632, 'auprc': 0.9536327244281788, 'loss_val': 0.3395893084580214, 'psi': 0.9443224695404507}-{'f1_val': 0.9432042569523932, 'auprc': 0.9610286809692403, 'loss_val': 0.3003574164585736, 'psi': 0.950334026559132}
[S5] START round=10 head_norm_before_train=1.354301 (no previous merge yet)
[S5] round=10 local utility u=0.235766 metrics={'f1_val': 0.7147879814038508, 'auprc': 0.7948262758490829, 'loss_val': 0.6005091418463975, 'psi': 0.7468032991819437}-{'f1_val': 0.6481339284822949, 'auprc': 0.7948822475020849, 'loss_val': 0.6722838433585137, 'psi': 0.7068332560902109}
[S6] START round=10 head_norm_before_train=1.303358 cos_to_last_merge=0.8746 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.875
[S6] round=10 local utility u=0.756712 metrics={'f1_val': 0.9308126693960381, 'auprc': 0.909867036568399, 'loss_val': 0.34944725294986223, 'psi': 0.9224344162649825}-{'f1_val': 0.6758119401097913, 'auprc': 0.9198833731179918, 'loss_val': 0.362916674302516, 'psi': 0.7734405133130715}
[S7] START round=10 head_norm_before_train=1.330171 (no previous merge yet)
[S7] round=10 local utility u=0.000000 metrics={'f1_val': 0.3808730945358947, 'auprc': 0.5892344887393368, 'loss_val': 0.9452888223136724, 'psi': 0.4642176522172715}-{'f1_val': 0.4170778520170104, 'auprc': 0.5862080174464644, 'loss_val': 1.027076226865331, 'psi': 0.4847299181887921}
[S8] START round=10 head_norm_before_train=1.395994 cos_to_last_merge=0.8333 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.833
[S8] round=10 local utility u=0.009641 metrics={'f1_val': 0.9932593276801964, 'auprc': 0.9986407336702653, 'loss_val': 0.10758432989323617, 'psi': 0.9954118900762239}-{'f1_val': 0.9943397297499055, 'auprc': 0.9976342129284118, 'loss_val': 0.13032902172069535, 'psi': 0.995657523021308}
[S9] START round=10 head_norm_before_train=1.513589 (no previous merge yet)
[S9] round=10 local utility u=0.025961 metrics={'f1_val': 0.7014667606303384, 'auprc': 0.998579246049162, 'loss_val': 0.26994934093253464, 'psi': 0.8203117547978679}-{'f1_val': 0.7014667606303384, 'auprc': 0.9987205241140614, 'loss_val': 0.32229423308853566, 'psi': 0.8203682660238276}
[S10] START round=10 head_norm_before_train=1.370238 cos_to_last_merge=0.8290 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.829
[S10] round=10 local utility u=1.000000 metrics={'f1_val': 0.9956047769386365, 'auprc': 0.9975812317704362, 'loss_val': 0.16148709861799912, 'psi': 0.9963953588713564}-{'f1_val': 0.5205603070503089, 'auprc': 0.8943554451713358, 'loss_val': 0.5297768407337158, 'psi': 0.6700783622987196}
[S11] START round=10 head_norm_before_train=0.752729 cos_to_last_merge=1.0000 (last merge round=9)
[S11] round=10 local utility u=0.019873 metrics={'f1_val': 0.39655223592620625, 'auprc': 0.9395448805538704, 'loss_val': 0.8538672881379098, 'psi': 0.6137492937772719}-{'f1_val': 0.39655223592620625, 'auprc': 0.939549369660148, 'loss_val': 0.893625809114924, 'psi': 0.613751089419783}
[S13] START round=10 head_norm_before_train=1.202215 cos_to_last_merge=1.0000 (last merge round=9)
[S13] round=10 local utility u=0.000000 metrics={'f1_val': 0.6942768093229092, 'auprc': 0.7247651251027595, 'loss_val': 0.5556808178335064, 'psi': 0.7064721356348493}-{'f1_val': 0.6986806481850054, 'auprc': 0.7424383309586681, 'loss_val': 0.4801501695432236, 'psi': 0.7161837212944705}
[S14] START round=10 head_norm_before_train=0.806659 cos_to_last_merge=1.0000 (last merge round=9)
[S14] round=10 local utility u=0.112042 metrics={'f1_val': 0.39652757107859105, 'auprc': 0.9695906056113583, 'loss_val': 0.7880489263008047, 'psi': 0.6257527848916979}-{'f1_val': 0.39652757107859105, 'auprc': 0.945347754764425, 'loss_val': 0.9394044420318606, 'psi': 0.6160556445529246}
[S15] START round=10 head_norm_before_train=0.851852 cos_to_last_merge=1.0000 (last merge round=9)
[S15] round=10 local utility u=0.277631 metrics={'f1_val': 0.7081558213189805, 'auprc': 0.9575148652675578, 'loss_val': 0.42418433382473486, 'psi': 0.8078994388984114}-{'f1_val': 0.6995968404292547, 'auprc': 0.7993921310270682, 'loss_val': 0.45372330809386197, 'psi': 0.7395149566683801}
[S16] START round=10 head_norm_before_train=0.774912 cos_to_last_merge=1.0000 (last merge round=9)
[S16] round=10 local utility u=0.234496 metrics={'f1_val': 0.41696372269722326, 'auprc': 0.6688609102409844, 'loss_val': 0.8667678956852212, 'psi': 0.5177225977147277}-{'f1_val': 0.4168831021970758, 'auprc': 0.5376813794180173, 'loss_val': 0.9417375659359689, 'psi': 0.4652024130854524}
[S17] START round=10 head_norm_before_train=0.874084 cos_to_last_merge=1.0000 (last merge round=9)
[S17] round=10 local utility u=0.000000 metrics={'f1_val': 0.39155995014436085, 'auprc': 0.798331942203448, 'loss_val': 0.8080661669245061, 'psi': 0.5542687469679957}-{'f1_val': 0.6647550223242054, 'auprc': 0.8387318488809978, 'loss_val': 0.7273535318235751, 'psi': 0.7343457529469224}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:45909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:45916
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:45917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:45915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:45913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] → sending delta(kind=head bytes=1793) to S11@127.0.0.1:45912
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:45903
[S16] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1793 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S10
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.421940)
[S8] loaded HEAD from S10 (vec_in norm=1.421940)
[S8] cosine check vs S10: cos=-0.0547
[S8] DROPPED delta from S10 (cos=-0.0547 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1793) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.856373)
[S11] loaded HEAD from S14 (vec_in norm=0.856373)
[S11] cosine check vs S14: cos=0.9369
[S11] BUFFERED delta from S14 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1796) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.439427)
[S3] loaded HEAD from S8 (vec_in norm=1.439427)
[S3] cosine check vs S8: cos=0.9819
[S3] BUFFERED delta from S8 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1803) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.332452)
[S17] loaded HEAD from S6 (vec_in norm=1.332452)
[S17] cosine check vs S6: cos=-0.0313
[S17] DROPPED delta from S6 (cos=-0.0313 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1803) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.382753)
[S16] loaded HEAD from S5 (vec_in norm=1.382753)
[S16] cosine check vs S5: cos=0.7264
[S16] BUFFERED delta from S5 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1800) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.564365)
[S16] loaded HEAD from S9 (vec_in norm=1.564365)
[S16] cosine check vs S9: cos=0.6636
[S16] BUFFERED delta from S9 (total buffered=2)
[S16] RECEIVED delta(kind=head bytes=1795) from S11
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.791986)
[S16] loaded HEAD from S11 (vec_in norm=0.791986)
[S16] cosine check vs S11: cos=0.3347
[S16] BUFFERED delta from S11 (total buffered=3)
[S15] RECEIVED delta(kind=head bytes=1797) from S16
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.821019)
[S15] loaded HEAD from S16 (vec_in norm=0.821019)
[S15] cosine check vs S16: cos=0.7992
[S15] BUFFERED delta from S16 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1798) from S15
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.952954)
[S13] loaded HEAD from S15 (vec_in norm=0.952954)
[S13] cosine check vs S15: cos=0.7448
[S13] BUFFERED delta from S15 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=10 metric=0.4167 head_norm=1.343190
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.407334e-01
[S3] stored merged vector for next round verification (round=10)
[S3] DEBUG after merge:  round=10 metric=0.4592 head_norm=1.385009 delta_norm=0.140733
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.366 → S17@127.0.0.1:45917
[S7] ⇄ pheromone p=0.284 → S4@127.0.0.1:45904
[S4] ⇄ pheromone p=0.340 → S14@127.0.0.1:45914
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=10 metric=0.6943 head_norm=1.252813
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.180945e-01
[S13] stored merged vector for next round verification (round=10)
[S13] DEBUG after merge:  round=10 metric=0.6881 head_norm=1.031518 delta_norm=0.418094
[S13] aggregate: ROLLBACK (f1_val pre=0.694 post=0.688 tol_abs=0.005 tol_rel=0.0)
[S13] ⇄ pheromone p=0.375 → S2@127.0.0.1:45902
[S2] ⇄ pheromone p=0.261 → S17@127.0.0.1:45917
[S8] ⇄ pheromone p=0.398 → S3@127.0.0.1:45903
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=10 metric=0.7082 head_norm=0.952954
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.879452e-01
[S15] stored merged vector for next round verification (round=10)
[S15] DEBUG after merge:  round=10 metric=0.7731 head_norm=0.841537 delta_norm=0.287945
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.299 → S13@127.0.0.1:45913
[S10] ⇄ pheromone p=0.471 → S8@127.0.0.1:45909
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=10 metric=0.3966 head_norm=0.791986
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.498388e-01
[S11] stored merged vector for next round verification (round=10)
[S11] DEBUG after merge:  round=10 metric=0.3966 head_norm=0.811084 delta_norm=0.149839
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.214 → S16@127.0.0.1:45916
[S9] ⇄ pheromone p=0.330 → S16@127.0.0.1:45916
[S5] ⇄ pheromone p=0.356 → S16@127.0.0.1:45916
[S16] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=10 metric=0.4170 head_norm=0.821019
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.158853e-01
[S16] stored merged vector for next round verification (round=10)
[S16] DEBUG after merge:  round=10 metric=0.4170 head_norm=0.772146 delta_norm=0.115885
[S16] aggregate: ACCEPT kept=['S5', 'S9', 'S11'] (k=3/3) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.309 → S15@127.0.0.1:45915
[S14] ⇄ pheromone p=0.362 → S11@127.0.0.1:45912
[S6] ⇄ pheromone p=0.440 → S17@127.0.0.1:45917
[S17] ⇄ pheromone p=0.346 → S14@127.0.0.1:45914
[S2] START round=11 head_norm_before_train=1.497243 cos_to_last_merge=0.9973 (last merge round=9)
[S2] round=11 local utility u=0.905100 metrics={'f1_val': 0.7015710590385817, 'auprc': 0.6655946230388816, 'loss_val': 0.3149401139989561, 'psi': 0.6871804846387017}-{'f1_val': 0.4936411567194553, 'auprc': 0.6424444446351701, 'loss_val': 0.8081107996861138, 'psi': 0.5531624718857413}
[S3] START round=11 head_norm_before_train=1.385009 cos_to_last_merge=1.0000 (last merge round=10)
[S3] round=11 local utility u=0.942532 metrics={'f1_val': 0.6281398696251123, 'auprc': 0.8656741702826032, 'loss_val': 0.6993842855728813, 'psi': 0.7231535898881086}-{'f1_val': 0.4167285673593337, 'auprc': 0.723681476033857, 'loss_val': 0.8900033311094218, 'psi': 0.539509730829143}
[S4] START round=11 head_norm_before_train=1.348847 cos_to_last_merge=0.9982 (last merge round=9)
[S4] round=11 local utility u=0.067620 metrics={'f1_val': 0.9426883014814659, 'auprc': 0.9689808856260496, 'loss_val': 0.277829904295651, 'psi': 0.9532053351392993}-{'f1_val': 0.938115632948632, 'auprc': 0.9536327244281788, 'loss_val': 0.3395893084580214, 'psi': 0.9443224695404507}
[S5] START round=11 head_norm_before_train=1.382753 (no previous merge yet)
[S5] round=11 local utility u=0.009695 metrics={'f1_val': 0.7146275168069246, 'auprc': 0.7930863902633896, 'loss_val': 0.5749369753335499, 'psi': 0.7460110661895105}-{'f1_val': 0.7147879814038508, 'auprc': 0.7948262758490829, 'loss_val': 0.6005091418463975, 'psi': 0.7468032991819437}
[S6] START round=11 head_norm_before_train=1.332452 cos_to_last_merge=0.8677 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.868
[S6] round=11 local utility u=0.000000 metrics={'f1_val': 0.7034912942750338, 'auprc': 0.8019572241021712, 'loss_val': 0.4272204392900404, 'psi': 0.7428776662058887}-{'f1_val': 0.9308126693960381, 'auprc': 0.909867036568399, 'loss_val': 0.34944725294986223, 'psi': 0.9224344162649825}
[S7] START round=11 head_norm_before_train=1.360426 (no previous merge yet)
[S7] round=11 local utility u=0.265699 metrics={'f1_val': 0.3871241402073951, 'auprc': 0.728920172595608, 'loss_val': 0.8704548117606014, 'psi': 0.5238425531626802}-{'f1_val': 0.3808730945358947, 'auprc': 0.5892344887393368, 'loss_val': 0.9452888223136724, 'psi': 0.4642176522172715}
[S8] START round=11 head_norm_before_train=1.439427 cos_to_last_merge=0.8220 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.822
[S8] round=11 local utility u=0.000028 metrics={'f1_val': 0.9934242076394499, 'auprc': 0.9905206178653694, 'loss_val': 0.08415682318160425, 'psi': 0.9922627717298177}-{'f1_val': 0.9932593276801964, 'auprc': 0.9986407336702653, 'loss_val': 0.10758432989323617, 'psi': 0.9954118900762239}
[S9] START round=11 head_norm_before_train=1.564365 (no previous merge yet)
[S9] round=11 local utility u=0.021227 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9980804584689422, 'loss_val': 0.2244977645451009, 'psi': 0.8199621318515881}-{'f1_val': 0.7014667606303384, 'auprc': 0.998579246049162, 'loss_val': 0.26994934093253464, 'psi': 0.8203117547978679}
[S10] START round=11 head_norm_before_train=1.421940 cos_to_last_merge=0.8183 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.818
[S10] round=11 local utility u=0.000000 metrics={'f1_val': 0.8806633271001771, 'auprc': 0.9716600590128832, 'loss_val': 0.2697776161402564, 'psi': 0.9170620198652596}-{'f1_val': 0.9956047769386365, 'auprc': 0.9975812317704362, 'loss_val': 0.16148709861799912, 'psi': 0.9963953588713564}
[S11] START round=11 head_norm_before_train=0.811084 cos_to_last_merge=1.0000 (last merge round=10)
[S11] round=11 local utility u=0.410907 metrics={'f1_val': 0.5237362349680965, 'auprc': 0.9389103036036819, 'loss_val': 0.7932543700344735, 'psi': 0.6898058624223307}-{'f1_val': 0.39655223592620625, 'auprc': 0.9395448805538704, 'loss_val': 0.8538672881379098, 'psi': 0.6137492937772719}
[S13] START round=11 head_norm_before_train=1.031518 cos_to_last_merge=1.0000 (last merge round=10)
[S13] round=11 local utility u=0.000000 metrics={'f1_val': 0.6610395626763007, 'auprc': 0.6306968161736471, 'loss_val': 0.608313147721189, 'psi': 0.6489024640752392}-{'f1_val': 0.6942768093229092, 'auprc': 0.7247651251027595, 'loss_val': 0.5556808178335064, 'psi': 0.7064721356348493}
[S14] START round=11 head_norm_before_train=0.856373 cos_to_last_merge=0.9945 (last merge round=9)
[S14] round=11 local utility u=0.492081 metrics={'f1_val': 0.5261677215813346, 'auprc': 0.9974621040284526, 'loss_val': 0.665341813606946, 'psi': 0.7146854745601818}-{'f1_val': 0.39652757107859105, 'auprc': 0.9695906056113583, 'loss_val': 0.7880489263008047, 'psi': 0.6257527848916979}
[S15] START round=11 head_norm_before_train=0.841537 cos_to_last_merge=1.0000 (last merge round=10)
[S15] round=11 local utility u=0.079612 metrics={'f1_val': 0.7265350505330844, 'auprc': 0.9825821749354178, 'loss_val': 0.45043834296789337, 'psi': 0.8289539002940178}-{'f1_val': 0.7081558213189805, 'auprc': 0.9575148652675578, 'loss_val': 0.42418433382473486, 'psi': 0.8078994388984114}
[S16] START round=11 head_norm_before_train=0.772146 cos_to_last_merge=1.0000 (last merge round=10)
[S16] round=11 local utility u=0.000000 metrics={'f1_val': 0.38504655117392317, 'auprc': 0.6583626154695121, 'loss_val': 0.8313358792054167, 'psi': 0.49437297689215876}-{'f1_val': 0.41696372269722326, 'auprc': 0.6688609102409844, 'loss_val': 0.8667678956852212, 'psi': 0.5177225977147277}
[S17] START round=11 head_norm_before_train=0.945488 cos_to_last_merge=0.9823 (last merge round=9)
[S17] round=11 local utility u=0.120082 metrics={'f1_val': 0.421380311827061, 'auprc': 0.797125758513043, 'loss_val': 0.743206486293862, 'psi': 0.5716784905014538}-{'f1_val': 0.39155995014436085, 'auprc': 0.798331942203448, 'loss_val': 0.8080661669245061, 'psi': 0.5542687469679957}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:45916
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:45916
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:45913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:45914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:45917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:45903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:45912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:45917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:45904
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:45916
[S14] sending update (kind=head size=1794 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1796) from S7
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.390388)
[S4] loaded HEAD from S7 (vec_in norm=1.390388)
[S4] cosine check vs S7: cos=0.9007
[S4] BUFFERED delta from S7 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1800) from S4
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.410750)
[S14] loaded HEAD from S4 (vec_in norm=1.410750)
[S14] cosine check vs S4: cos=0.6924
[S14] BUFFERED delta from S4 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1794) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.913237)
[S11] loaded HEAD from S14 (vec_in norm=0.913237)
[S11] cosine check vs S14: cos=0.9605
[S11] BUFFERED delta from S14 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1796) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.492278)
[S3] loaded HEAD from S8 (vec_in norm=1.492278)
[S3] cosine check vs S8: cos=0.9868
[S3] BUFFERED delta from S8 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1799) from S2
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.538658)
[S17] loaded HEAD from S2 (vec_in norm=1.538658)
[S17] cosine check vs S2: cos=0.2975
[S17] BUFFERED delta from S2 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1802) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.407533)
[S16] loaded HEAD from S5 (vec_in norm=1.407533)
[S16] cosine check vs S5: cos=0.7013
[S16] BUFFERED delta from S5 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1796) from S3
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.415422)
[S17] loaded HEAD from S3 (vec_in norm=1.415422)
[S17] cosine check vs S3: cos=0.7471
[S17] BUFFERED delta from S3 (total buffered=2)
[S13] RECEIVED delta(kind=head bytes=1800) from S15
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.948212)
[S13] loaded HEAD from S15 (vec_in norm=0.948212)
[S13] cosine check vs S15: cos=0.8327
[S13] BUFFERED delta from S15 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1801) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.608809)
[S16] loaded HEAD from S9 (vec_in norm=1.608809)
[S16] cosine check vs S9: cos=0.6642
[S16] BUFFERED delta from S9 (total buffered=2)
[S16] RECEIVED delta(kind=head bytes=1795) from S11
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.853376)
[S16] loaded HEAD from S11 (vec_in norm=0.853376)
[S16] cosine check vs S11: cos=0.3862
[S16] BUFFERED delta from S11 (total buffered=3)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:45914
[S17] sending update (kind=head size=1805 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1805) from S17
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.031227)
[S14] loaded HEAD from S17 (vec_in norm=1.031227)
[S14] cosine check vs S17: cos=0.6963
[S14] BUFFERED delta from S17 (total buffered=2)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=11 metric=0.6610 head_norm=1.101399
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.053102e-01
[S13] stored merged vector for next round verification (round=11)
[S13] DEBUG after merge:  round=11 metric=0.6539 head_norm=0.981264 delta_norm=0.305310
[S13] aggregate: ROLLBACK (f1_val pre=0.661 post=0.654 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=11 metric=0.5237 head_norm=0.853376
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.276827e-01
[S11] stored merged vector for next round verification (round=11)
[S11] DEBUG after merge:  round=11 metric=0.5478 head_norm=0.874542 delta_norm=0.127683
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=11 metric=0.6281 head_norm=1.415422
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.241081e-01
[S3] stored merged vector for next round verification (round=11)
[S3] DEBUG after merge:  round=11 metric=0.6493 head_norm=1.449053 delta_norm=0.124108
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=11 metric=0.9427 head_norm=1.410750
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.122964e-01
[S4] stored merged vector for next round verification (round=11)
[S4] DEBUG after merge:  round=11 metric=0.9419 head_norm=1.365345 delta_norm=0.312296
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=11 metric=0.5262 head_norm=0.913237
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.035151e-01
[S14] stored merged vector for next round verification (round=11)
[S14] DEBUG after merge:  round=11 metric=0.5257 head_norm=0.930605 delta_norm=0.303515
[S14] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=11 metric=0.3850 head_norm=0.821346
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.003276e-01
[S16] stored merged vector for next round verification (round=11)
[S16] DEBUG after merge:  round=11 metric=0.3851 head_norm=0.788176 delta_norm=0.100328
[S16] aggregate: ACCEPT kept=['S5', 'S9', 'S11'] (k=3/3) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=11 metric=0.4214 head_norm=1.031227
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.890454e-01
[S17] stored merged vector for next round verification (round=11)
[S17] DEBUG after merge:  round=11 metric=0.4276 head_norm=0.965719 delta_norm=0.389045
[S17] aggregate: ACCEPT kept=['S2', 'S3'] (k=2/2) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.538658 cos_to_last_merge=0.9929 (last merge round=9)
[S2] round=12 local utility u=0.000000 metrics={'f1_val': 0.6999461206362424, 'auprc': 0.6719869981639242, 'loss_val': 0.34032909049793, 'psi': 0.6887624716473151}-{'f1_val': 0.7015710590385817, 'auprc': 0.6655946230388816, 'loss_val': 0.3149401139989561, 'psi': 0.6871804846387017}
[S3] START round=12 head_norm_before_train=1.449053 cos_to_last_merge=1.0000 (last merge round=11)
[S3] round=12 local utility u=0.000000 metrics={'f1_val': 0.643484413393798, 'auprc': 0.7644367117423946, 'loss_val': 0.6179844479508715, 'psi': 0.6918653327332367}-{'f1_val': 0.6281398696251123, 'auprc': 0.8656741702826032, 'loss_val': 0.6993842855728813, 'psi': 0.7231535898881086}
[S4] START round=12 head_norm_before_train=1.365345 cos_to_last_merge=1.0000 (last merge round=11)
[S4] round=12 local utility u=0.000000 metrics={'f1_val': 0.9419040707169832, 'auprc': 0.9622944790074499, 'loss_val': 0.29114018848388734, 'psi': 0.95006023403317}-{'f1_val': 0.9426883014814659, 'auprc': 0.9689808856260496, 'loss_val': 0.277829904295651, 'psi': 0.9532053351392993}
[S5] START round=12 head_norm_before_train=1.407533 (no previous merge yet)
[S5] round=12 local utility u=0.000000 metrics={'f1_val': 0.7008168588441903, 'auprc': 0.7782229776153001, 'loss_val': 0.5231187760018433, 'psi': 0.7317793063526343}-{'f1_val': 0.7146275168069246, 'auprc': 0.7930863902633896, 'loss_val': 0.5749369753335499, 'psi': 0.7460110661895105}
[S6] START round=12 head_norm_before_train=1.372485 cos_to_last_merge=0.8593 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.859
[S6] round=12 local utility u=0.000000 metrics={'f1_val': 0.5228235853368328, 'auprc': 0.7125093107543311, 'loss_val': 0.6356150822811107, 'psi': 0.5986978755038321}-{'f1_val': 0.7034912942750338, 'auprc': 0.8019572241021712, 'loss_val': 0.4272204392900404, 'psi': 0.7428776662058887}
[S7] START round=12 head_norm_before_train=1.390388 (no previous merge yet)
[S7] round=12 local utility u=1.000000 metrics={'f1_val': 0.7123532704380389, 'auprc': 0.7853791958097733, 'loss_val': 0.7020897511539239, 'psi': 0.7415636405867326}-{'f1_val': 0.3871241402073951, 'auprc': 0.728920172595608, 'loss_val': 0.8704548117606014, 'psi': 0.5238425531626802}
[S8] START round=12 head_norm_before_train=1.492278 cos_to_last_merge=0.8122 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.812
[S8] round=12 local utility u=0.008705 metrics={'f1_val': 0.9932593276801964, 'auprc': 0.9907605891755775, 'loss_val': 0.06647735365484835, 'psi': 0.9922598322783489}-{'f1_val': 0.9934242076394499, 'auprc': 0.9905206178653694, 'loss_val': 0.08415682318160425, 'psi': 0.9922627717298177}
[S9] START round=12 head_norm_before_train=1.608809 (no previous merge yet)
[S9] round=12 local utility u=0.378788 metrics={'f1_val': 0.8203674389486003, 'auprc': 0.9980667309189105, 'loss_val': 0.18178566914084698, 'psi': 0.8914471557367244}-{'f1_val': 0.7012165807733519, 'auprc': 0.9980804584689422, 'loss_val': 0.2244977645451009, 'psi': 0.8199621318515881}
[S10] START round=12 head_norm_before_train=1.465933 cos_to_last_merge=0.8084 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.808
[S10] round=12 local utility u=0.460386 metrics={'f1_val': 0.994512139992592, 'auprc': 0.9967521799069012, 'loss_val': 0.10737516416595992, 'psi': 0.9954081559583157}-{'f1_val': 0.8806633271001771, 'auprc': 0.9716600590128832, 'loss_val': 0.2697776161402564, 'psi': 0.9170620198652596}
[S11] START round=12 head_norm_before_train=0.874542 cos_to_last_merge=1.0000 (last merge round=11)
[S11] round=12 local utility u=0.579977 metrics={'f1_val': 0.7017589383281313, 'auprc': 0.9395670229620073, 'loss_val': 0.7034074631342878, 'psi': 0.7968821721816817}-{'f1_val': 0.5237362349680965, 'auprc': 0.9389103036036819, 'loss_val': 0.7932543700344735, 'psi': 0.6898058624223307}
[S13] START round=12 head_norm_before_train=0.981264 cos_to_last_merge=1.0000 (last merge round=11)
[S13] round=12 local utility u=0.020240 metrics={'f1_val': 0.6553731433597734, 'auprc': 0.6564044391904258, 'loss_val': 0.6109576168790919, 'psi': 0.6557856616920343}-{'f1_val': 0.6610395626763007, 'auprc': 0.6306968161736471, 'loss_val': 0.608313147721189, 'psi': 0.6489024640752392}
[S14] START round=12 head_norm_before_train=0.930605 cos_to_last_merge=1.0000 (last merge round=11)
[S14] round=12 local utility u=0.474016 metrics={'f1_val': 0.6716286365539396, 'auprc': 0.9957035887516424, 'loss_val': 0.5847990861917446, 'psi': 0.8012586174330207}-{'f1_val': 0.5261677215813346, 'auprc': 0.9974621040284526, 'loss_val': 0.665341813606946, 'psi': 0.7146854745601818}
[S15] START round=12 head_norm_before_train=0.948212 cos_to_last_merge=0.9842 (last merge round=10)
[S15] round=12 local utility u=0.337692 metrics={'f1_val': 0.8103371473074851, 'auprc': 0.9885889883596455, 'loss_val': 0.2958866714748085, 'psi': 0.8816378837283492}-{'f1_val': 0.7265350505330844, 'auprc': 0.9825821749354178, 'loss_val': 0.45043834296789337, 'psi': 0.8289539002940178}
[S16] START round=12 head_norm_before_train=0.788176 cos_to_last_merge=1.0000 (last merge round=11)
[S16] round=12 local utility u=0.147437 metrics={'f1_val': 0.43701319570077585, 'auprc': 0.6473414276999718, 'loss_val': 0.8151990161274231, 'psi': 0.5211444885004543}-{'f1_val': 0.38504655117392317, 'auprc': 0.6583626154695121, 'loss_val': 0.8313358792054167, 'psi': 0.49437297689215876}
[S17] START round=12 head_norm_before_train=0.965719 cos_to_last_merge=1.0000 (last merge round=11)
[S17] round=12 local utility u=0.354717 metrics={'f1_val': 0.5365817470629535, 'auprc': 0.789726262117814, 'loss_val': 0.7027817930268506, 'psi': 0.6378395530848977}-{'f1_val': 0.421380311827061, 'auprc': 0.797125758513043, 'loss_val': 0.743206486293862, 'psi': 0.5716784905014538}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S15] → sending delta(kind=head bytes=1806) to S13@127.0.0.1:45913
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S2@127.0.0.1:45902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:45909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:45915
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] → sending delta(kind=head bytes=1792) to S11@127.0.0.1:45912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:45904
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:45903
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:45916
[S11] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1792 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1794 to 1 peers)
[S15] sending update (kind=head size=1806 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1797) from S7
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.412721)
[S4] loaded HEAD from S7 (vec_in norm=1.412721)
[S4] cosine check vs S7: cos=0.9548
[S4] BUFFERED delta from S7 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1792) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.979387)
[S11] loaded HEAD from S14 (vec_in norm=0.979387)
[S11] cosine check vs S14: cos=0.9295
[S11] BUFFERED delta from S14 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1800) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.534796)
[S3] loaded HEAD from S8 (vec_in norm=1.534796)
[S3] cosine check vs S8: cos=0.9909
[S3] BUFFERED delta from S8 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1794) from S13
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.056909)
[S2] loaded HEAD from S13 (vec_in norm=1.056909)
[S2] cosine check vs S13: cos=0.6841
[S2] BUFFERED delta from S13 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1798) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.648190)
[S16] loaded HEAD from S9 (vec_in norm=1.648190)
[S16] cosine check vs S9: cos=0.6692
[S16] BUFFERED delta from S9 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1802) from S10
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.498537)
[S8] loaded HEAD from S10 (vec_in norm=1.498537)
[S8] cosine check vs S10: cos=-0.0553
[S8] DROPPED delta from S10 (cos=-0.0553 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1806) from S15
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.070231)
[S13] loaded HEAD from S15 (vec_in norm=1.070231)
[S13] cosine check vs S15: cos=0.9384
[S13] BUFFERED delta from S15 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1797) from S11
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.920103)
[S16] loaded HEAD from S11 (vec_in norm=0.920103)
[S16] cosine check vs S11: cos=0.4128
[S16] BUFFERED delta from S11 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1800) from S16
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.838250)
[S15] loaded HEAD from S16 (vec_in norm=0.838250)
[S15] cosine check vs S16: cos=0.8026
[S15] BUFFERED delta from S16 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:45914
[S17] sending update (kind=head size=1799 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1799) from S17
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.029980)
[S14] loaded HEAD from S17 (vec_in norm=1.029980)
[S14] cosine check vs S17: cos=0.7334
[S14] BUFFERED delta from S17 (total buffered=1)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=12 metric=0.6999 head_norm=1.572048
[S2] _apply_head_vector_avg (torch): Δ‖w‖=5.734154e-01
[S2] stored merged vector for next round verification (round=12)
[S2] DEBUG after merge:  round=12 metric=0.6996 head_norm=1.210533 delta_norm=0.573415
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=12 metric=0.9419 head_norm=1.425146
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.134968e-01
[S4] stored merged vector for next round verification (round=12)
[S4] DEBUG after merge:  round=12 metric=0.9416 head_norm=1.402793 delta_norm=0.213497
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=12 metric=0.6435 head_norm=1.480611
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.054313e-01
[S3] stored merged vector for next round verification (round=12)
[S3] DEBUG after merge:  round=12 metric=0.6592 head_norm=1.504257 delta_norm=0.105431
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=12 metric=0.7018 head_norm=0.920103
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.807357e-01
[S11] stored merged vector for next round verification (round=12)
[S11] DEBUG after merge:  round=12 metric=0.7018 head_norm=0.932861 delta_norm=0.180736
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=12 metric=0.6554 head_norm=1.056909
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.868263e-01
[S13] stored merged vector for next round verification (round=12)
[S13] DEBUG after merge:  round=12 metric=0.6480 head_norm=1.047054 delta_norm=0.186826
[S13] aggregate: ROLLBACK (f1_val pre=0.655 post=0.648 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=12 metric=0.8103 head_norm=1.070231
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.193975e-01
[S15] stored merged vector for next round verification (round=12)
[S15] DEBUG after merge:  round=12 metric=0.8298 head_norm=0.906650 delta_norm=0.319398
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=12 metric=0.4370 head_norm=0.838250
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.098948e-01
[S16] stored merged vector for next round verification (round=12)
[S16] DEBUG after merge:  round=12 metric=0.4349 head_norm=0.847052 delta_norm=0.309895
[S16] aggregate: ACCEPT kept=['S9', 'S11'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=12 metric=0.6716 head_norm=0.979387
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.675997e-01
[S14] stored merged vector for next round verification (round=12)
[S14] DEBUG after merge:  round=12 metric=0.5730 head_norm=0.935361 delta_norm=0.367600
[S14] aggregate: ROLLBACK (f1_val pre=0.672 post=0.573 tol_abs=0.005 tol_rel=0.0)
[S2] START round=13 head_norm_before_train=1.210533 cos_to_last_merge=1.0000 (last merge round=12)
[S2] round=13 local utility u=0.000000 metrics={'f1_val': 0.7015691843323472, 'auprc': 0.665680972497481, 'loss_val': 0.36064876335986973, 'psi': 0.6872138995984007}-{'f1_val': 0.6999461206362424, 'auprc': 0.6719869981639242, 'loss_val': 0.34032909049793, 'psi': 0.6887624716473151}
[S3] START round=13 head_norm_before_train=1.504257 cos_to_last_merge=1.0000 (last merge round=12)
[S3] round=13 local utility u=0.082937 metrics={'f1_val': 0.6683098722807341, 'auprc': 0.7471657778610035, 'loss_val': 0.5492499908448006, 'psi': 0.6998522345128418}-{'f1_val': 0.643484413393798, 'auprc': 0.7644367117423946, 'loss_val': 0.6179844479508715, 'psi': 0.6918653327332367}
[S4] START round=13 head_norm_before_train=1.402793 cos_to_last_merge=1.0000 (last merge round=12)
[S4] round=13 local utility u=0.000000 metrics={'f1_val': 0.9408188564032156, 'auprc': 0.95586791277427, 'loss_val': 0.2995045515992961, 'psi': 0.9468384789516373}-{'f1_val': 0.9419040707169832, 'auprc': 0.9622944790074499, 'loss_val': 0.29114018848388734, 'psi': 0.95006023403317}
[S5] START round=13 head_norm_before_train=1.440730 (no previous merge yet)
[S5] round=13 local utility u=0.047383 metrics={'f1_val': 0.7008569501491988, 'auprc': 0.7899999908342811, 'loss_val': 0.46392454743357936, 'psi': 0.7365141664232318}-{'f1_val': 0.7008168588441903, 'auprc': 0.7782229776153001, 'loss_val': 0.5231187760018433, 'psi': 0.7317793063526343}
[S6] START round=13 head_norm_before_train=1.412717 cos_to_last_merge=0.8503 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.850
[S6] round=13 local utility u=1.000000 metrics={'f1_val': 0.9196281496974013, 'auprc': 0.8981511780455083, 'loss_val': 0.2896275416147865, 'psi': 0.911037361036644}-{'f1_val': 0.5228235853368328, 'auprc': 0.7125093107543311, 'loss_val': 0.6356150822811107, 'psi': 0.5986978755038321}
[S7] START round=13 head_norm_before_train=1.412721 (no previous merge yet)
[S7] round=13 local utility u=0.000000 metrics={'f1_val': 0.4126431041738411, 'auprc': 0.7897867343203523, 'loss_val': 0.8177051367758068, 'psi': 0.5635005562324455}-{'f1_val': 0.7123532704380389, 'auprc': 0.7853791958097733, 'loss_val': 0.7020897511539239, 'psi': 0.7415636405867326}
[S8] START round=13 head_norm_before_train=1.534796 cos_to_last_merge=0.8051 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.805
[S8] round=13 local utility u=0.000000 metrics={'f1_val': 0.9932593276801964, 'auprc': 0.9877621702229347, 'loss_val': 0.05984355210178693, 'psi': 0.9910604646972917}-{'f1_val': 0.9932593276801964, 'auprc': 0.9907605891755775, 'loss_val': 0.06647735365484835, 'psi': 0.9922598322783489}
[S9] START round=13 head_norm_before_train=1.648190 (no previous merge yet)
[S9] round=13 local utility u=0.301838 metrics={'f1_val': 0.9175986448387906, 'auprc': 0.9980622418787, 'loss_val': 0.16148409834590297, 'psi': 0.9497840836547543}-{'f1_val': 0.8203674389486003, 'auprc': 0.9980667309189105, 'loss_val': 0.18178566914084698, 'psi': 0.8914471557367244}
[S10] START round=13 head_norm_before_train=1.498537 cos_to_last_merge=0.8017 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.802
[S10] round=13 local utility u=0.009147 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9951171166085262, 'loss_val': 0.08559568503474979, 'psi': 0.994896012175034}-{'f1_val': 0.994512139992592, 'auprc': 0.9967521799069012, 'loss_val': 0.10737516416595992, 'psi': 0.9954081559583157}
[S11] START round=13 head_norm_before_train=0.932861 cos_to_last_merge=1.0000 (last merge round=12)
[S11] round=13 local utility u=0.038197 metrics={'f1_val': 0.7020007759458987, 'auprc': 0.9403914921571631, 'loss_val': 0.6309388771658797, 'psi': 0.7973570624304045}-{'f1_val': 0.7017589383281313, 'auprc': 0.9395670229620073, 'loss_val': 0.7034074631342878, 'psi': 0.7968821721816817}
[S13] START round=13 head_norm_before_train=1.047054 cos_to_last_merge=1.0000 (last merge round=12)
[S13] round=13 local utility u=0.000000 metrics={'f1_val': 0.6335349545930851, 'auprc': 0.6249535334597953, 'loss_val': 0.6382421259733362, 'psi': 0.6301023861397692}-{'f1_val': 0.6553731433597734, 'auprc': 0.6564044391904258, 'loss_val': 0.6109576168790919, 'psi': 0.6557856616920343}
[S14] START round=13 head_norm_before_train=0.935361 cos_to_last_merge=1.0000 (last merge round=12)
[S14] round=13 local utility u=0.416625 metrics={'f1_val': 0.8166563188315672, 'auprc': 0.9977361920071601, 'loss_val': 0.6278122459391894, 'psi': 0.8890882681018044}-{'f1_val': 0.6716286365539396, 'auprc': 0.9957035887516424, 'loss_val': 0.5847990861917446, 'psi': 0.8012586174330207}
[S15] START round=13 head_norm_before_train=0.906650 cos_to_last_merge=1.0000 (last merge round=12)
[S15] round=13 local utility u=0.560039 metrics={'f1_val': 0.9918585543422882, 'auprc': 0.9892980250624378, 'loss_val': 0.26706468635949676, 'psi': 0.990834342630348}-{'f1_val': 0.8103371473074851, 'auprc': 0.9885889883596455, 'loss_val': 0.2958866714748085, 'psi': 0.8816378837283492}
[S16] START round=13 head_norm_before_train=0.847052 cos_to_last_merge=1.0000 (last merge round=12)
[S16] round=13 local utility u=0.000000 metrics={'f1_val': 0.3528868227822011, 'auprc': 0.6538109328012665, 'loss_val': 0.8309080517113188, 'psi': 0.47325646678982725}-{'f1_val': 0.43701319570077585, 'auprc': 0.6473414276999718, 'loss_val': 0.8151990161274231, 'psi': 0.5211444885004543}
[S17] START round=13 head_norm_before_train=1.029980 cos_to_last_merge=0.9925 (last merge round=11)
[S17] round=13 local utility u=0.000000 metrics={'f1_val': 0.4906682611346477, 'auprc': 0.6744653752633543, 'loss_val': 0.8485646579148964, 'psi': 0.5641871067861304}-{'f1_val': 0.5365817470629535, 'auprc': 0.789726262117814, 'loss_val': 0.7027817930268506, 'psi': 0.6378395530848977}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:45916
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:45913
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:45917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:45912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:45909
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:45917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:45916
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] sending update (kind=head size=1805 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1795) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.980700)
[S11] loaded HEAD from S14 (vec_in norm=0.980700)
[S11] cosine check vs S14: cos=0.9065
[S11] BUFFERED delta from S14 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1805) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.445759)
[S17] loaded HEAD from S6 (vec_in norm=1.445759)
[S17] cosine check vs S6: cos=-0.0376
[S17] DROPPED delta from S6 (cos=-0.0376 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1799) from S3
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.533132)
[S17] loaded HEAD from S3 (vec_in norm=1.533132)
[S17] cosine check vs S3: cos=0.6861
[S17] BUFFERED delta from S3 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1803) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.473133)
[S16] loaded HEAD from S5 (vec_in norm=1.473133)
[S16] cosine check vs S5: cos=0.4145
[S16] BUFFERED delta from S5 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1797) from S11
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.978361)
[S16] loaded HEAD from S11 (vec_in norm=0.978361)
[S16] cosine check vs S11: cos=0.4825
[S16] BUFFERED delta from S11 (total buffered=2)
[S16] RECEIVED delta(kind=head bytes=1797) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.680116)
[S16] loaded HEAD from S9 (vec_in norm=1.680116)
[S16] cosine check vs S9: cos=0.8166
[S16] BUFFERED delta from S9 (total buffered=3)
[S13] RECEIVED delta(kind=head bytes=1803) from S15
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.017480)
[S13] loaded HEAD from S15 (vec_in norm=1.017480)
[S13] cosine check vs S15: cos=0.9362
[S13] BUFFERED delta from S15 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1800) from S10
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.535217)
[S8] loaded HEAD from S10 (vec_in norm=1.535217)
[S8] cosine check vs S10: cos=-0.0573
[S8] DROPPED delta from S10 (cos=-0.0573 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=13 metric=0.6335 head_norm=1.106808
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.947389e-01
[S13] stored merged vector for next round verification (round=13)
[S13] DEBUG after merge:  round=13 metric=0.6323 head_norm=1.045094 delta_norm=0.194739
[S13] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=13 metric=0.7020 head_norm=0.978361
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.118088e-01
[S11] stored merged vector for next round verification (round=13)
[S11] DEBUG after merge:  round=13 metric=0.7020 head_norm=0.956357 delta_norm=0.211809
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=13 metric=0.4907 head_norm=1.096103
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.581163e-01
[S17] stored merged vector for next round verification (round=13)
[S17] DEBUG after merge:  round=13 metric=0.4948 head_norm=1.210155 delta_norm=0.558116
[S17] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=13 metric=0.3529 head_norm=0.899497
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.547735e-01
[S16] stored merged vector for next round verification (round=13)
[S16] DEBUG after merge:  round=13 metric=0.3623 head_norm=0.849113 delta_norm=0.154774
[S16] aggregate: ACCEPT kept=['S5', 'S11', 'S9'] (k=3/3) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.254768 cos_to_last_merge=0.9982 (last merge round=12)
[S2] round=14 local utility u=0.000000 metrics={'f1_val': 0.49925354684611695, 'auprc': 0.6283331463763302, 'loss_val': 0.829919193303878, 'psi': 0.5508853866582022}-{'f1_val': 0.7015691843323472, 'auprc': 0.665680972497481, 'loss_val': 0.36064876335986973, 'psi': 0.6872138995984007}
[S3] START round=14 head_norm_before_train=1.533132 cos_to_last_merge=0.9991 (last merge round=12)
[S3] round=14 local utility u=0.217581 metrics={'f1_val': 0.700330919019862, 'auprc': 0.7822196176864316, 'loss_val': 0.4113752426212165, 'psi': 0.7330863984864898}-{'f1_val': 0.6683098722807341, 'auprc': 0.7471657778610035, 'loss_val': 0.5492499908448006, 'psi': 0.6998522345128418}
[S4] START round=14 head_norm_before_train=1.459173 cos_to_last_merge=0.9971 (last merge round=12)
[S4] round=14 local utility u=0.000000 metrics={'f1_val': 0.9258358656384253, 'auprc': 0.9378582232020716, 'loss_val': 0.3615191601700574, 'psi': 0.9306448086638838}-{'f1_val': 0.9408188564032156, 'auprc': 0.95586791277427, 'loss_val': 0.2995045515992961, 'psi': 0.9468384789516373}
[S5] START round=14 head_norm_before_train=1.473133 (no previous merge yet)
[S5] round=14 local utility u=0.000000 metrics={'f1_val': 0.7005691551769304, 'auprc': 0.7321981355399044, 'loss_val': 0.40225878450161207, 'psi': 0.71322074732212}-{'f1_val': 0.7008569501491988, 'auprc': 0.7899999908342811, 'loss_val': 0.46392454743357936, 'psi': 0.7365141664232318}
[S6] START round=14 head_norm_before_train=1.445759 cos_to_last_merge=0.8436 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.844
[S6] round=14 local utility u=0.000000 metrics={'f1_val': 0.8212727204755832, 'auprc': 0.9278361118274494, 'loss_val': 0.3425718974485361, 'psi': 0.8638980770163297}-{'f1_val': 0.9196281496974013, 'auprc': 0.8981511780455083, 'loss_val': 0.2896275416147865, 'psi': 0.911037361036644}
[S7] START round=14 head_norm_before_train=1.434448 (no previous merge yet)
[S7] round=14 local utility u=0.678564 metrics={'f1_val': 0.5796086424965747, 'auprc': 0.8725383374777811, 'loss_val': 0.710625235539624, 'psi': 0.6967805204890574}-{'f1_val': 0.4126431041738411, 'auprc': 0.7897867343203523, 'loss_val': 0.8177051367758068, 'psi': 0.5635005562324455}
[S8] START round=14 head_norm_before_train=1.567036 cos_to_last_merge=0.8006 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.801
[S8] round=14 local utility u=0.014547 metrics={'f1_val': 0.992174240363445, 'auprc': 0.9982616864158385, 'loss_val': 0.05573706665995711, 'psi': 0.9946092187844024}-{'f1_val': 0.9932593276801964, 'auprc': 0.9877621702229347, 'loss_val': 0.05984355210178693, 'psi': 0.9910604646972917}
[S9] START round=14 head_norm_before_train=1.680116 (no previous merge yet)
[S9] round=14 local utility u=0.000000 metrics={'f1_val': 0.9082180494522382, 'auprc': 0.9984420480580783, 'loss_val': 0.14945749929062743, 'psi': 0.9443076488945743}-{'f1_val': 0.9175986448387906, 'auprc': 0.9980622418787, 'loss_val': 0.16148409834590297, 'psi': 0.9497840836547543}
[S10] START round=14 head_norm_before_train=1.535217 cos_to_last_merge=0.7949 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.795
[S10] round=14 local utility u=0.003128 metrics={'f1_val': 0.993391017001491, 'auprc': 0.9957494879253553, 'loss_val': 0.07309173506431302, 'psi': 0.9943344053710367}-{'f1_val': 0.9947486092193725, 'auprc': 0.9951171166085262, 'loss_val': 0.08559568503474979, 'psi': 0.994896012175034}
[S11] START round=14 head_norm_before_train=0.956357 cos_to_last_merge=1.0000 (last merge round=13)
[S11] round=14 local utility u=0.034954 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9399460286938665, 'loss_val': 0.5593017056426458, 'psi': 0.7971396014565386}-{'f1_val': 0.7020007759458987, 'auprc': 0.9403914921571631, 'loss_val': 0.6309388771658797, 'psi': 0.7973570624304045}
[S13] START round=14 head_norm_before_train=1.045094 cos_to_last_merge=1.0000 (last merge round=13)
[S13] round=14 local utility u=0.052070 metrics={'f1_val': 0.6461947067922145, 'auprc': 0.6218447068334065, 'loss_val': 0.6007338187812556, 'psi': 0.6364547068086912}-{'f1_val': 0.6335349545930851, 'auprc': 0.6249535334597953, 'loss_val': 0.6382421259733362, 'psi': 0.6301023861397692}
[S14] START round=14 head_norm_before_train=0.980700 cos_to_last_merge=0.9968 (last merge round=12)
[S14] round=14 local utility u=0.000000 metrics={'f1_val': 0.5906872368703584, 'auprc': 0.9986250112663791, 'loss_val': 0.502071434275376, 'psi': 0.7538623466287666}-{'f1_val': 0.8166563188315672, 'auprc': 0.9977361920071601, 'loss_val': 0.6278122459391894, 'psi': 0.8890882681018044}
[S15] START round=14 head_norm_before_train=1.017480 cos_to_last_merge=0.9904 (last merge round=12)
[S15] round=14 local utility u=0.000000 metrics={'f1_val': 0.913567350352201, 'auprc': 0.9897160961978726, 'loss_val': 0.20148287904572768, 'psi': 0.9440268486904697}-{'f1_val': 0.9918585543422882, 'auprc': 0.9892980250624378, 'loss_val': 0.26706468635949676, 'psi': 0.990834342630348}
[S16] START round=14 head_norm_before_train=0.849113 cos_to_last_merge=1.0000 (last merge round=13)
[S16] round=14 local utility u=0.313168 metrics={'f1_val': 0.40154453223040343, 'auprc': 0.7535881894226572, 'loss_val': 0.7958507186330612, 'psi': 0.5423619951073049}-{'f1_val': 0.3528868227822011, 'auprc': 0.6538109328012665, 'loss_val': 0.8309080517113188, 'psi': 0.47325646678982725}
[S17] START round=14 head_norm_before_train=1.210155 cos_to_last_merge=1.0000 (last merge round=13)
[S17] round=14 local utility u=0.000000 metrics={'f1_val': 0.36175636362771824, 'auprc': 0.5392521782663088, 'loss_val': 1.1044955124763274, 'psi': 0.43275468948315443}-{'f1_val': 0.4906682611346477, 'auprc': 0.6744653752633543, 'loss_val': 0.8485646579148964, 'psi': 0.5641871067861304}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:45902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:45917
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:45915
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:45909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:45904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:45903
[S16] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1793 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S13] sending update (kind=head size=1795 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1795) from S13
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.117221)
[S2] loaded HEAD from S13 (vec_in norm=1.117221)
[S2] cosine check vs S13: cos=0.7643
[S2] BUFFERED delta from S13 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1799) from S10
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.571360)
[S8] loaded HEAD from S10 (vec_in norm=1.571360)
[S8] cosine check vs S10: cos=-0.0593
[S8] DROPPED delta from S10 (cos=-0.0593 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1797) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.597309)
[S3] loaded HEAD from S8 (vec_in norm=1.597309)
[S3] cosine check vs S8: cos=0.9892
[S3] BUFFERED delta from S8 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1804) from S3
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.559208)
[S17] loaded HEAD from S3 (vec_in norm=1.559208)
[S17] cosine check vs S3: cos=0.9222
[S17] BUFFERED delta from S3 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1794) from S11
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.001275)
[S16] loaded HEAD from S11 (vec_in norm=1.001275)
[S16] cosine check vs S11: cos=0.4783
[S16] BUFFERED delta from S11 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1793) from S7
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.455223)
[S4] loaded HEAD from S7 (vec_in norm=1.455223)
[S4] cosine check vs S7: cos=0.9564
[S4] BUFFERED delta from S7 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1799) from S16
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.904596)
[S15] loaded HEAD from S16 (vec_in norm=0.904596)
[S15] cosine check vs S16: cos=0.8116
[S15] BUFFERED delta from S16 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=14 metric=0.4993 head_norm=1.305758
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.251793e-01
[S2] stored merged vector for next round verification (round=14)
[S2] DEBUG after merge:  round=14 metric=0.4917 head_norm=1.138339 delta_norm=0.425179
[S2] aggregate: ROLLBACK (f1_val pre=0.499 post=0.492 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=14 metric=0.9258 head_norm=1.523208
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.224493e-01
[S4] stored merged vector for next round verification (round=14)
[S4] DEBUG after merge:  round=14 metric=0.9087 head_norm=1.472900 delta_norm=0.222449
[S4] aggregate: ROLLBACK (f1_val pre=0.926 post=0.909 tol_abs=0.005 tol_rel=0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=14 metric=0.7003 head_norm=1.559208
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.173741e-01
[S3] stored merged vector for next round verification (round=14)
[S3] DEBUG after merge:  round=14 metric=0.7006 head_norm=1.574003 delta_norm=0.117374
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=14 metric=0.4015 head_norm=0.904596
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.884642e-01
[S16] stored merged vector for next round verification (round=14)
[S16] DEBUG after merge:  round=14 metric=0.3159 head_norm=0.819649 delta_norm=0.488464
[S16] aggregate: ROLLBACK (f1_val pre=0.402 post=0.316 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=14 metric=0.9136 head_norm=1.135651
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.318256e-01
[S15] stored merged vector for next round verification (round=14)
[S15] DEBUG after merge:  round=14 metric=0.9259 head_norm=0.971540 delta_norm=0.331826
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=14 metric=0.3618 head_norm=1.260122
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.143694e-01
[S17] stored merged vector for next round verification (round=14)
[S17] DEBUG after merge:  round=14 metric=0.3608 head_norm=1.382277 delta_norm=0.314369
[S17] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.138339 cos_to_last_merge=1.0000 (last merge round=14)
[S2] round=15 local utility u=0.892353 metrics={'f1_val': 0.7015710590385817, 'auprc': 0.6646488423545293, 'loss_val': 0.3680650679042887, 'psi': 0.6868021723649607}-{'f1_val': 0.49925354684611695, 'auprc': 0.6283331463763302, 'loss_val': 0.829919193303878, 'psi': 0.5508853866582022}
[S3] START round=15 head_norm_before_train=1.574003 cos_to_last_merge=1.0000 (last merge round=14)
[S3] round=15 local utility u=0.179652 metrics={'f1_val': 0.6611567409430446, 'auprc': 0.9945018384204469, 'loss_val': 0.4538727176297188, 'psi': 0.7944947799340055}-{'f1_val': 0.700330919019862, 'auprc': 0.7822196176864316, 'loss_val': 0.4113752426212165, 'psi': 0.7330863984864898}
[S4] START round=15 head_norm_before_train=1.472900 cos_to_last_merge=1.0000 (last merge round=14)
[S4] round=15 local utility u=0.185524 metrics={'f1_val': 0.9580516330223018, 'auprc': 0.977703448660779, 'loss_val': 0.3033024010043992, 'psi': 0.9659123592776926}-{'f1_val': 0.9258358656384253, 'auprc': 0.9378582232020716, 'loss_val': 0.3615191601700574, 'psi': 0.9306448086638838}
[S5] START round=15 head_norm_before_train=1.501770 (no previous merge yet)
[S5] round=15 local utility u=0.000000 metrics={'f1_val': 0.7005691551769304, 'auprc': 0.6736580840850998, 'loss_val': 0.354745543350229, 'psi': 0.6898047267401981}-{'f1_val': 0.7005691551769304, 'auprc': 0.7321981355399044, 'loss_val': 0.40225878450161207, 'psi': 0.71322074732212}
[S6] START round=15 head_norm_before_train=1.472426 cos_to_last_merge=0.8401 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.840
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.7027710192298028, 'auprc': 0.7794375695701425, 'loss_val': 0.5056803744792834, 'psi': 0.7334376393659388}-{'f1_val': 0.8212727204755832, 'auprc': 0.9278361118274494, 'loss_val': 0.3425718974485361, 'psi': 0.8638980770163297}
[S7] START round=15 head_norm_before_train=1.455223 (no previous merge yet)
[S7] round=15 local utility u=0.197454 metrics={'f1_val': 0.6403214056947086, 'auprc': 0.8503397445232035, 'loss_val': 0.6133972963101789, 'psi': 0.7243287412261066}-{'f1_val': 0.5796086424965747, 'auprc': 0.8725383374777811, 'loss_val': 0.710625235539624, 'psi': 0.6967805204890574}
[S8] START round=15 head_norm_before_train=1.597309 cos_to_last_merge=0.7969 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.797
[S8] round=15 local utility u=0.000583 metrics={'f1_val': 0.9918109678295097, 'auprc': 0.9982564795214544, 'loss_val': 0.05237522300259987, 'psi': 0.9943891725062876}-{'f1_val': 0.992174240363445, 'auprc': 0.9982616864158385, 'loss_val': 0.05573706665995711, 'psi': 0.9946092187844024}
[S9] START round=15 head_norm_before_train=1.708260 (no previous merge yet)
[S9] round=15 local utility u=0.177679 metrics={'f1_val': 0.9639320317682849, 'auprc': 0.9984409096666591, 'loss_val': 0.12838025790292737, 'psi': 0.9777355829276345}-{'f1_val': 0.9082180494522382, 'auprc': 0.9984420480580783, 'loss_val': 0.14945749929062743, 'psi': 0.9443076488945743}
[S10] START round=15 head_norm_before_train=1.571360 cos_to_last_merge=0.7886 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.789
[S10] round=15 local utility u=0.003757 metrics={'f1_val': 0.993391017001491, 'auprc': 0.9951937238348578, 'loss_val': 0.06391060056328751, 'psi': 0.9941120997348377}-{'f1_val': 0.993391017001491, 'auprc': 0.9957494879253553, 'loss_val': 0.07309173506431302, 'psi': 0.9943344053710367}
[S11] START round=15 head_norm_before_train=1.001275 cos_to_last_merge=0.9962 (last merge round=13)
[S11] round=15 local utility u=0.057294 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9409308363589152, 'loss_val': 0.4462176783934246, 'psi': 0.797388422295721}-{'f1_val': 0.7019353166316534, 'auprc': 0.9399460286938665, 'loss_val': 0.5593017056426458, 'psi': 0.7971396014565386}
[S13] START round=15 head_norm_before_train=1.117221 cos_to_last_merge=0.9929 (last merge round=13)
[S13] round=15 local utility u=0.000000 metrics={'f1_val': 0.6316863684148025, 'auprc': 0.6281659290391596, 'loss_val': 0.6133713027802855, 'psi': 0.6302781926645453}-{'f1_val': 0.6461947067922145, 'auprc': 0.6218447068334065, 'loss_val': 0.6007338187812556, 'psi': 0.6364547068086912}
[S14] START round=15 head_norm_before_train=1.030988 cos_to_last_merge=0.9889 (last merge round=12)
[S14] round=15 local utility u=0.707896 metrics={'f1_val': 0.8194072755517576, 'auprc': 0.9987009325529603, 'loss_val': 0.4588265771255933, 'psi': 0.8911247383522387}-{'f1_val': 0.5906872368703584, 'auprc': 0.9986250112663791, 'loss_val': 0.502071434275376, 'psi': 0.7538623466287666}
[S15] START round=15 head_norm_before_train=0.971540 cos_to_last_merge=1.0000 (last merge round=14)
[S15] round=15 local utility u=0.000000 metrics={'f1_val': 0.717310357741747, 'auprc': 0.9850329274869356, 'loss_val': 0.40707880187711115, 'psi': 0.8243993856398224}-{'f1_val': 0.913567350352201, 'auprc': 0.9897160961978726, 'loss_val': 0.20148287904572768, 'psi': 0.9440268486904697}
[S16] START round=15 head_norm_before_train=0.819649 cos_to_last_merge=1.0000 (last merge round=14)
[S16] round=15 local utility u=0.790253 metrics={'f1_val': 0.6568290660860899, 'auprc': 0.7658082547493533, 'loss_val': 0.7837128602306885, 'psi': 0.7004207415513952}-{'f1_val': 0.40154453223040343, 'auprc': 0.7535881894226572, 'loss_val': 0.7958507186330612, 'psi': 0.5423619951073049}
[S17] START round=15 head_norm_before_train=1.382277 cos_to_last_merge=1.0000 (last merge round=14)
[S17] round=15 local utility u=0.804453 metrics={'f1_val': 0.5047569430984573, 'auprc': 0.6938807340177954, 'loss_val': 0.8174781203457784, 'psi': 0.5804064594661925}-{'f1_val': 0.36175636362771824, 'auprc': 0.5392521782663088, 'loss_val': 1.1044955124763274, 'psi': 0.43275468948315443}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S3@127.0.0.1:45903
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:45904
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:45914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:45912
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:45909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:45917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:45917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:45915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:45916
[S9] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1805 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1805 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1805) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.631124)
[S3] loaded HEAD from S8 (vec_in norm=1.631124)
[S3] cosine check vs S8: cos=0.9941
[S3] BUFFERED delta from S8 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1798) from S3
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.601656)
[S17] loaded HEAD from S3 (vec_in norm=1.601656)
[S17] cosine check vs S3: cos=0.9639
[S17] BUFFERED delta from S3 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1800) from S2
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.194869)
[S17] loaded HEAD from S2 (vec_in norm=1.194869)
[S17] cosine check vs S2: cos=0.1568
[S17] BUFFERED delta from S2 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1798) from S16
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.862966)
[S15] loaded HEAD from S16 (vec_in norm=0.862966)
[S15] cosine check vs S16: cos=0.7715
[S15] BUFFERED delta from S16 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1800) from S10
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.605041)
[S8] loaded HEAD from S10 (vec_in norm=1.605041)
[S8] cosine check vs S10: cos=-0.0611
[S8] DROPPED delta from S10 (cos=-0.0611 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1798) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.735343)
[S16] loaded HEAD from S9 (vec_in norm=1.735343)
[S16] cosine check vs S9: cos=0.4826
[S16] BUFFERED delta from S9 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1802) from S7
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.477259)
[S4] loaded HEAD from S7 (vec_in norm=1.477259)
[S4] cosine check vs S7: cos=0.9770
[S4] BUFFERED delta from S7 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1805) from S4
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.525027)
[S14] loaded HEAD from S4 (vec_in norm=1.525027)
[S14] cosine check vs S4: cos=0.6329
[S14] BUFFERED delta from S4 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1796) from S11
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.050388)
[S16] loaded HEAD from S11 (vec_in norm=1.050388)
[S16] cosine check vs S11: cos=0.8463
[S16] BUFFERED delta from S11 (total buffered=2)
[S11] RECEIVED delta(kind=head bytes=1796) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.080703)
[S11] loaded HEAD from S14 (vec_in norm=1.080703)
[S11] cosine check vs S14: cos=0.9536
[S11] BUFFERED delta from S14 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:45914
[S17] sending update (kind=head size=1802 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1802) from S17
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.424195)
[S14] loaded HEAD from S17 (vec_in norm=1.424195)
[S14] cosine check vs S17: cos=0.7406
[S14] BUFFERED delta from S17 (total buffered=2)
[S6] ⇄ pheromone p=0.272 → S17@127.0.0.1:45917
[S13] ⇄ pheromone p=0.133 → S2@127.0.0.1:45902
[S5] ⇄ pheromone p=0.123 → S16@127.0.0.1:45916
[S10] ⇄ pheromone p=0.204 → S8@127.0.0.1:45909
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=15 metric=0.6568 head_norm=0.862966
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.969429e-01
[S16] stored merged vector for next round verification (round=15)
[S16] DEBUG after merge:  round=15 metric=0.6778 head_norm=0.912763 delta_norm=0.296943
[S16] aggregate: ACCEPT kept=['S9', 'S11'] (k=2/2) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.325 → S15@127.0.0.1:45915
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=15 metric=0.7017 head_norm=1.050388
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.630156e-01
[S11] stored merged vector for next round verification (round=15)
[S11] DEBUG after merge:  round=15 metric=0.7017 head_norm=1.053111 delta_norm=0.163016
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.185 → S16@127.0.0.1:45916
[S8] ⇄ pheromone p=0.134 → S3@127.0.0.1:45903
[S7] ⇄ pheromone p=0.365 → S4@127.0.0.1:45904
[S9] ⇄ pheromone p=0.223 → S16@127.0.0.1:45916
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=15 metric=0.6612 head_norm=1.601656
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.869281e-02
[S3] stored merged vector for next round verification (round=15)
[S3] DEBUG after merge:  round=15 metric=0.6667 head_norm=1.614022 delta_norm=0.088693
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.279 → S17@127.0.0.1:45917
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=15 metric=0.8194 head_norm=1.080703
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.941560e-01
[S14] stored merged vector for next round verification (round=15)
[S14] DEBUG after merge:  round=15 metric=0.8875 head_norm=1.116628 delta_norm=0.394156
[S14] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.402 → S11@127.0.0.1:45912
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=15 metric=0.9581 head_norm=1.525027
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.627669e-01
[S4] stored merged vector for next round verification (round=15)
[S4] DEBUG after merge:  round=15 metric=0.9574 head_norm=1.492483 delta_norm=0.162767
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.154 → S14@127.0.0.1:45914
[S2] ⇄ pheromone p=0.338 → S17@127.0.0.1:45917
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=15 metric=0.7173 head_norm=1.069911
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.409033e-01
[S15] stored merged vector for next round verification (round=15)
[S15] DEBUG after merge:  round=15 metric=0.7118 head_norm=0.910217 delta_norm=0.340903
[S15] aggregate: ROLLBACK (f1_val pre=0.717 post=0.712 tol_abs=0.005 tol_rel=0.0)
[S15] ⇄ pheromone p=0.211 → S13@127.0.0.1:45913
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=15 metric=0.5048 head_norm=1.424195
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.891810e-01
[S17] stored merged vector for next round verification (round=15)
[S17] DEBUG after merge:  round=15 metric=0.5195 head_norm=1.176513 delta_norm=0.389181
[S17] aggregate: ACCEPT kept=['S3', 'S2'] (k=2/2) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.320 → S14@127.0.0.1:45914
[S2] START round=16 head_norm_before_train=1.194869 cos_to_last_merge=0.9966 (last merge round=14)
[S2] round=16 local utility u=0.016956 metrics={'f1_val': 0.7015710590385817, 'auprc': 0.6671179292619651, 'loss_val': 0.34156002472677893, 'psi': 0.6877898071279351}-{'f1_val': 0.7015710590385817, 'auprc': 0.6646488423545293, 'loss_val': 0.3680650679042887, 'psi': 0.6868021723649607}
[S3] START round=16 head_norm_before_train=1.614022 cos_to_last_merge=1.0000 (last merge round=15)
[S3] round=16 local utility u=0.000000 metrics={'f1_val': 0.4591993947163031, 'auprc': 0.8806958084183458, 'loss_val': 0.6823531722965561, 'psi': 0.6277979601971202}-{'f1_val': 0.6611567409430446, 'auprc': 0.9945018384204469, 'loss_val': 0.4538727176297188, 'psi': 0.7944947799340055}
[S4] START round=16 head_norm_before_train=1.492483 cos_to_last_merge=1.0000 (last merge round=15)
[S4] round=16 local utility u=0.000000 metrics={'f1_val': 0.9393078967830267, 'auprc': 0.9438618473801547, 'loss_val': 0.31663137157070403, 'psi': 0.9411294770218779}-{'f1_val': 0.9580516330223018, 'auprc': 0.977703448660779, 'loss_val': 0.3033024010043992, 'psi': 0.9659123592776926}
[S5] START round=16 head_norm_before_train=1.531616 (no previous merge yet)
[S5] round=16 local utility u=0.179483 metrics={'f1_val': 0.7008563225598777, 'auprc': 0.7863817881990582, 'loss_val': 0.3356733527782696, 'psi': 0.7350665088155499}-{'f1_val': 0.7005691551769304, 'auprc': 0.6736580840850998, 'loss_val': 0.354745543350229, 'psi': 0.6898047267401981}
[S6] START round=16 head_norm_before_train=1.495664 cos_to_last_merge=0.8387 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.839
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.6267000813796983, 'auprc': 0.7953564538432338, 'loss_val': 0.550157936431649, 'psi': 0.6941626303651125}-{'f1_val': 0.7027710192298028, 'auprc': 0.7794375695701425, 'loss_val': 0.5056803744792834, 'psi': 0.7334376393659388}
[S7] START round=16 head_norm_before_train=1.477259 (no previous merge yet)
[S7] round=16 local utility u=0.000000 metrics={'f1_val': 0.4496828457379519, 'auprc': 0.7818039229913449, 'loss_val': 0.8799593938615476, 'psi': 0.5825312766393091}-{'f1_val': 0.6403214056947086, 'auprc': 0.8503397445232035, 'loss_val': 0.6133972963101789, 'psi': 0.7243287412261066}
[S8] START round=16 head_norm_before_train=1.631124 cos_to_last_merge=0.7925 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.793
[S8] round=16 local utility u=0.000000 metrics={'f1_val': 0.9928938724649488, 'auprc': 0.9853159144685639, 'loss_val': 0.046493947742973864, 'psi': 0.9898626892663949}-{'f1_val': 0.9918109678295097, 'auprc': 0.9982564795214544, 'loss_val': 0.05237522300259987, 'psi': 0.9943891725062876}
[S9] START round=16 head_norm_before_train=1.735343 (no previous merge yet)
[S9] round=16 local utility u=0.104260 metrics={'f1_val': 0.9920653202133933, 'auprc': 0.9984264930799711, 'loss_val': 0.08861578659957503, 'psi': 0.9946097893600245}-{'f1_val': 0.9639320317682849, 'auprc': 0.9984409096666591, 'loss_val': 0.12838025790292737, 'psi': 0.9777355829276345}
[S10] START round=16 head_norm_before_train=1.605041 cos_to_last_merge=0.7827 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.783
[S10] round=16 local utility u=0.002667 metrics={'f1_val': 0.9943334156967715, 'auprc': 0.9923976962878666, 'loss_val': 0.05584309974933157, 'psi': 0.9935591279332096}-{'f1_val': 0.993391017001491, 'auprc': 0.9951937238348578, 'loss_val': 0.06391060056328751, 'psi': 0.9941120997348377}
[S11] START round=16 head_norm_before_train=1.053111 cos_to_last_merge=1.0000 (last merge round=15)
[S11] round=16 local utility u=0.000000 metrics={'f1_val': 0.6569007802926243, 'auprc': 0.9418694517167906, 'loss_val': 0.51352316267763, 'psi': 0.7708882488622908}-{'f1_val': 0.7016934795869249, 'auprc': 0.9409308363589152, 'loss_val': 0.4462176783934246, 'psi': 0.797388422295721}
[S13] START round=16 head_norm_before_train=1.191246 cos_to_last_merge=0.9792 (last merge round=13)
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.6331621447015157, 'auprc': 0.6154398917948734, 'loss_val': 0.6056151838044478, 'psi': 0.6260732435388587}-{'f1_val': 0.6316863684148025, 'auprc': 0.6281659290391596, 'loss_val': 0.6133713027802855, 'psi': 0.6302781926645453}
[S14] START round=16 head_norm_before_train=1.116628 cos_to_last_merge=1.0000 (last merge round=15)
[S14] round=16 local utility u=0.098570 metrics={'f1_val': 0.8802078571663827, 'auprc': 0.9722897415257288, 'loss_val': 0.5472555823232688, 'psi': 0.9170406109101212}-{'f1_val': 0.8194072755517576, 'auprc': 0.9987009325529603, 'loss_val': 0.4588265771255933, 'psi': 0.8911247383522387}
[S15] START round=16 head_norm_before_train=0.910217 cos_to_last_merge=1.0000 (last merge round=15)
[S15] round=16 local utility u=0.376066 metrics={'f1_val': 0.8301079409374038, 'auprc': 0.9898085099671128, 'loss_val': 0.3460589014710079, 'psi': 0.8939881685492874}-{'f1_val': 0.717310357741747, 'auprc': 0.9850329274869356, 'loss_val': 0.40707880187711115, 'psi': 0.8243993856398224}
[S16] START round=16 head_norm_before_train=0.912763 cos_to_last_merge=1.0000 (last merge round=15)
[S16] round=16 local utility u=0.543746 metrics={'f1_val': 0.8189945390188063, 'auprc': 0.7841518399737728, 'loss_val': 0.7242450027726726, 'psi': 0.8050574594007929}-{'f1_val': 0.6568290660860899, 'auprc': 0.7658082547493533, 'loss_val': 0.7837128602306885, 'psi': 0.7004207415513952}
[S17] START round=16 head_norm_before_train=1.176513 cos_to_last_merge=1.0000 (last merge round=15)
[S17] round=16 local utility u=0.000000 metrics={'f1_val': 0.5307129097000665, 'auprc': 0.5633185954930368, 'loss_val': 0.7683185815969835, 'psi': 0.5437551840172545}-{'f1_val': 0.5047569430984573, 'auprc': 0.6938807340177954, 'loss_val': 0.8174781203457784, 'psi': 0.5804064594661925}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:45916
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:45916
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S11@127.0.0.1:45912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:45917
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:45915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:45913
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:45909
[S10] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1804 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1802) from S10
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.631360)
[S8] loaded HEAD from S10 (vec_in norm=1.631360)
[S8] cosine check vs S10: cos=-0.0626
[S8] DROPPED delta from S10 (cos=-0.0626 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1804) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.161700)
[S11] loaded HEAD from S14 (vec_in norm=1.161700)
[S11] cosine check vs S14: cos=0.9245
[S11] BUFFERED delta from S14 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1800) from S2
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.258164)
[S17] loaded HEAD from S2 (vec_in norm=1.258164)
[S17] cosine check vs S2: cos=0.3673
[S17] BUFFERED delta from S2 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1799) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.763460)
[S16] loaded HEAD from S9 (vec_in norm=1.763460)
[S16] cosine check vs S9: cos=0.7280
[S16] BUFFERED delta from S9 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1801) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.553605)
[S16] loaded HEAD from S5 (vec_in norm=1.553605)
[S16] cosine check vs S5: cos=0.2218
[S16] BUFFERED delta from S5 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1797) from S16
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.965433)
[S15] loaded HEAD from S16 (vec_in norm=0.965433)
[S15] cosine check vs S16: cos=0.8847
[S15] BUFFERED delta from S16 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1798) from S15
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.005164)
[S13] loaded HEAD from S15 (vec_in norm=1.005164)
[S13] cosine check vs S15: cos=0.8551
[S13] BUFFERED delta from S15 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=16 metric=0.6332 head_norm=1.241044
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.228956e-01
[S13] stored merged vector for next round verification (round=16)
[S13] DEBUG after merge:  round=16 metric=0.6292 head_norm=1.082133 delta_norm=0.322896
[S13] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=16 metric=0.8301 head_norm=1.005164
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.373904e-01
[S15] stored merged vector for next round verification (round=16)
[S15] DEBUG after merge:  round=16 metric=0.8331 head_norm=0.956479 delta_norm=0.237390
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=16 metric=0.8190 head_norm=0.965433
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.808902e-01
[S16] stored merged vector for next round verification (round=16)
[S16] DEBUG after merge:  round=16 metric=0.8169 head_norm=1.008623 delta_norm=0.480890
[S16] aggregate: ACCEPT kept=['S9', 'S5'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=16 metric=0.6569 head_norm=1.093971
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.215839e-01
[S11] stored merged vector for next round verification (round=16)
[S11] DEBUG after merge:  round=16 metric=0.6562 head_norm=1.106373 delta_norm=0.221584
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=16 metric=0.5307 head_norm=1.222819
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.978690e-01
[S17] stored merged vector for next round verification (round=16)
[S17] DEBUG after merge:  round=16 metric=0.5493 head_norm=1.025725 delta_norm=0.697869
[S17] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.258164 cos_to_last_merge=0.9886 (last merge round=14)
[S2] round=17 local utility u=0.000874 metrics={'f1_val': 0.7004876654878339, 'auprc': 0.6709152523533072, 'loss_val': 0.3447027822994071, 'psi': 0.6886587002340232}-{'f1_val': 0.7015710590385817, 'auprc': 0.6671179292619651, 'loss_val': 0.34156002472677893, 'psi': 0.6877898071279351}
[S3] START round=17 head_norm_before_train=1.642311 cos_to_last_merge=0.9995 (last merge round=15)
[S3] round=17 local utility u=0.710858 metrics={'f1_val': 0.6074036434524808, 'auprc': 0.986723167502538, 'loss_val': 0.46794438885467665, 'psi': 0.7591314530725036}-{'f1_val': 0.4591993947163031, 'auprc': 0.8806958084183458, 'loss_val': 0.6823531722965561, 'psi': 0.6277979601971202}
[S4] START round=17 head_norm_before_train=1.524317 cos_to_last_merge=0.9990 (last merge round=15)
[S4] round=17 local utility u=0.000000 metrics={'f1_val': 0.9373591429999683, 'auprc': 0.9544543016876585, 'loss_val': 0.3384668674226884, 'psi': 0.9441972064750443}-{'f1_val': 0.9393078967830267, 'auprc': 0.9438618473801547, 'loss_val': 0.31663137157070403, 'psi': 0.9411294770218779}
[S5] START round=17 head_norm_before_train=1.553605 (no previous merge yet)
[S5] round=17 local utility u=0.176048 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.8951472565790859, 'loss_val': 0.30839070647037753, 'psi': 0.7784243590351028}-{'f1_val': 0.7008563225598777, 'auprc': 0.7863817881990582, 'loss_val': 0.3356733527782696, 'psi': 0.7350665088155499}
[S6] START round=17 head_norm_before_train=1.527809 cos_to_last_merge=0.8354 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.835
[S6] round=17 local utility u=0.913553 metrics={'f1_val': 0.8539810207731119, 'auprc': 0.8811270144365584, 'loss_val': 0.34404953093992946, 'psi': 0.8648394182384905}-{'f1_val': 0.6267000813796983, 'auprc': 0.7953564538432338, 'loss_val': 0.550157936431649, 'psi': 0.6941626303651125}
[S7] START round=17 head_norm_before_train=1.497764 (no previous merge yet)
[S7] round=17 local utility u=0.217637 metrics={'f1_val': 0.5103005457620529, 'auprc': 0.7850907298741147, 'loss_val': 0.8182512134272765, 'psi': 0.6202166194068777}-{'f1_val': 0.4496828457379519, 'auprc': 0.7818039229913449, 'loss_val': 0.8799593938615476, 'psi': 0.5825312766393091}
[S8] START round=17 head_norm_before_train=1.663404 cos_to_last_merge=0.7879 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.788
[S8] round=17 local utility u=0.000000 metrics={'f1_val': 0.900768914203853, 'auprc': 0.9848547386463857, 'loss_val': 0.1298879576276896, 'psi': 0.934403243980866}-{'f1_val': 0.9928938724649488, 'auprc': 0.9853159144685639, 'loss_val': 0.046493947742973864, 'psi': 0.9898626892663949}
[S9] START round=17 head_norm_before_train=1.763460 (no previous merge yet)
[S9] round=17 local utility u=0.000000 metrics={'f1_val': 0.9871446711497952, 'auprc': 0.9984378150864597, 'loss_val': 0.0826615303641565, 'psi': 0.991661928724461}-{'f1_val': 0.9920653202133933, 'auprc': 0.9984264930799711, 'loss_val': 0.08861578659957503, 'psi': 0.9946097893600245}
[S10] START round=17 head_norm_before_train=1.631360 cos_to_last_merge=0.7791 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.779
[S10] round=17 local utility u=0.007434 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9938569923872924, 'loss_val': 0.04916226798558244, 'psi': 0.9945237088739627}-{'f1_val': 0.9943334156967715, 'auprc': 0.9923976962878666, 'loss_val': 0.05584309974933157, 'psi': 0.9935591279332096}
[S11] START round=17 head_norm_before_train=1.106373 cos_to_last_merge=1.0000 (last merge round=16)
[S11] round=17 local utility u=0.179275 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.941892915958806, 'loss_val': 0.4238004760377572, 'psi': 0.7977732541356772}-{'f1_val': 0.6569007802926243, 'auprc': 0.9418694517167906, 'loss_val': 0.51352316267763, 'psi': 0.7708882488622908}
[S13] START round=17 head_norm_before_train=1.082133 cos_to_last_merge=1.0000 (last merge round=16)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.6289263426746633, 'auprc': 0.610844858677706, 'loss_val': 0.6441342227060616, 'psi': 0.6216937490758804}-{'f1_val': 0.6331621447015157, 'auprc': 0.6154398917948734, 'loss_val': 0.6056151838044478, 'psi': 0.6260732435388587}
[S14] START round=17 head_norm_before_train=1.161700 cos_to_last_merge=0.9982 (last merge round=15)
[S14] round=17 local utility u=0.133248 metrics={'f1_val': 0.887028848556985, 'auprc': 0.9983822089831145, 'loss_val': 0.39996336186273074, 'psi': 0.9315701927274368}-{'f1_val': 0.8802078571663827, 'auprc': 0.9722897415257288, 'loss_val': 0.5472555823232688, 'psi': 0.9170406109101212}
[S15] START round=17 head_norm_before_train=0.956479 cos_to_last_merge=1.0000 (last merge round=16)
[S15] round=17 local utility u=0.567425 metrics={'f1_val': 0.9959577109714866, 'auprc': 0.99590571615289, 'loss_val': 0.22459878790846396, 'psi': 0.995936913044048}-{'f1_val': 0.8301079409374038, 'auprc': 0.9898085099671128, 'loss_val': 0.3460589014710079, 'psi': 0.8939881685492874}
[S16] START round=17 head_norm_before_train=1.008623 cos_to_last_merge=1.0000 (last merge round=16)
[S16] round=17 local utility u=0.000000 metrics={'f1_val': 0.7640760200257014, 'auprc': 0.8392600123669347, 'loss_val': 0.5927486461269479, 'psi': 0.7941496169621947}-{'f1_val': 0.8189945390188063, 'auprc': 0.7841518399737728, 'loss_val': 0.7242450027726726, 'psi': 0.8050574594007929}
[S17] START round=17 head_norm_before_train=1.025725 cos_to_last_merge=1.0000 (last merge round=16)
[S17] round=17 local utility u=0.223967 metrics={'f1_val': 0.5538124932226358, 'auprc': 0.6636097619523155, 'loss_val': 0.7598551505133295, 'psi': 0.5977314007145077}-{'f1_val': 0.5307129097000665, 'auprc': 0.5633185954930368, 'loss_val': 0.7683185815969835, 'psi': 0.5437551840172545}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:45909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S13@127.0.0.1:45913
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:45917
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:45904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S11@127.0.0.1:45912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:45917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:45916
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:45917
[S11] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S3] sending update (kind=head size=1805 to 1 peers)
[S14] sending update (kind=head size=1804 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1804) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.208057)
[S11] loaded HEAD from S14 (vec_in norm=1.208057)
[S11] cosine check vs S14: cos=0.9769
[S11] BUFFERED delta from S14 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1803) from S2
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.312715)
[S17] loaded HEAD from S2 (vec_in norm=1.312715)
[S17] cosine check vs S2: cos=0.8110
[S17] BUFFERED delta from S2 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1798) from S11
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.141311)
[S16] loaded HEAD from S11 (vec_in norm=1.141311)
[S16] cosine check vs S11: cos=0.3557
[S16] BUFFERED delta from S11 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1805) from S3
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.671364)
[S17] loaded HEAD from S3 (vec_in norm=1.671364)
[S17] cosine check vs S3: cos=0.5694
[S17] BUFFERED delta from S3 (total buffered=2)
[S17] RECEIVED delta(kind=head bytes=1795) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.552787)
[S17] loaded HEAD from S6 (vec_in norm=1.552787)
[S17] cosine check vs S6: cos=-0.0434
[S17] DROPPED delta from S6 (cos=-0.0434 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1794) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.571042)
[S16] loaded HEAD from S5 (vec_in norm=1.571042)
[S16] cosine check vs S5: cos=0.5465
[S16] BUFFERED delta from S5 (total buffered=2)
[S4] RECEIVED delta(kind=head bytes=1799) from S7
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.514074)
[S4] loaded HEAD from S7 (vec_in norm=1.514074)
[S4] cosine check vs S7: cos=0.9795
[S4] BUFFERED delta from S7 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1803) from S10
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.660627)
[S8] loaded HEAD from S10 (vec_in norm=1.660627)
[S8] cosine check vs S10: cos=-0.0642
[S8] DROPPED delta from S10 (cos=-0.0642 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1804) from S15
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.042722)
[S13] loaded HEAD from S15 (vec_in norm=1.042722)
[S13] cosine check vs S15: cos=0.9082
[S13] BUFFERED delta from S15 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:45914
[S17] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S17
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.069540)
[S14] loaded HEAD from S17 (vec_in norm=1.069540)
[S14] cosine check vs S17: cos=0.6970
[S14] BUFFERED delta from S17 (total buffered=1)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=17 metric=0.9374 head_norm=1.568885
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.584207e-01
[S4] stored merged vector for next round verification (round=17)
[S4] DEBUG after merge:  round=17 metric=0.9369 head_norm=1.533562 delta_norm=0.158421
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=17 metric=0.6289 head_norm=1.124409
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.355201e-01
[S13] stored merged vector for next round verification (round=17)
[S13] DEBUG after merge:  round=17 metric=0.6257 head_norm=1.058448 delta_norm=0.235520
[S13] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=17 metric=0.7017 head_norm=1.141311
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.305724e-01
[S11] stored merged vector for next round verification (round=17)
[S11] DEBUG after merge:  round=17 metric=0.7017 head_norm=1.167881 delta_norm=0.130572
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=17 metric=0.8870 head_norm=1.208057
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.478371e-01
[S14] stored merged vector for next round verification (round=17)
[S14] DEBUG after merge:  round=17 metric=0.8866 head_norm=1.049333 delta_norm=0.447837
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=17 metric=0.7641 head_norm=1.066977
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.230596e-01
[S16] stored merged vector for next round verification (round=17)
[S16] DEBUG after merge:  round=17 metric=0.7780 head_norm=0.923893 delta_norm=0.423060
[S16] aggregate: ACCEPT kept=['S11', 'S5'] (k=2/2) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=17 metric=0.5538 head_norm=1.069540
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.062170e-01
[S17] stored merged vector for next round verification (round=17)
[S17] DEBUG after merge:  round=17 metric=0.5501 head_norm=1.058677 delta_norm=0.206217
[S17] aggregate: ACCEPT kept=['S2', 'S3'] (k=2/2) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.312715 cos_to_last_merge=0.9807 (last merge round=14)
[S2] round=18 local utility u=0.005091 metrics={'f1_val': 0.7015691843323472, 'auprc': 0.6737366182207338, 'loss_val': 0.3494730512517269, 'psi': 0.6904361578877019}-{'f1_val': 0.7004876654878339, 'auprc': 0.6709152523533072, 'loss_val': 0.3447027822994071, 'psi': 0.6886587002340232}
[S3] START round=18 head_norm_before_train=1.671364 cos_to_last_merge=0.9984 (last merge round=15)
[S3] round=18 local utility u=0.349584 metrics={'f1_val': 0.6927498788157274, 'auprc': 0.99922775958754, 'loss_val': 0.31836759340924164, 'psi': 0.8153410311244524}-{'f1_val': 0.6074036434524808, 'auprc': 0.986723167502538, 'loss_val': 0.46794438885467665, 'psi': 0.7591314530725036}
[S4] START round=18 head_norm_before_train=1.533562 cos_to_last_merge=1.0000 (last merge round=17)
[S4] round=18 local utility u=0.082674 metrics={'f1_val': 0.9472375965654535, 'auprc': 0.9669923677732166, 'loss_val': 0.27000380535209856, 'psi': 0.9551395050485587}-{'f1_val': 0.9373591429999683, 'auprc': 0.9544543016876585, 'loss_val': 0.3384668674226884, 'psi': 0.9441972064750443}
[S5] START round=18 head_norm_before_train=1.571042 (no previous merge yet)
[S5] round=18 local utility u=0.070400 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9424492205148638, 'loss_val': 0.309492900341346, 'psi': 0.79734472380355}-{'f1_val': 0.7006090940057808, 'auprc': 0.8951472565790859, 'loss_val': 0.30839070647037753, 'psi': 0.7784243590351028}
[S6] START round=18 head_norm_before_train=1.552787 cos_to_last_merge=0.8330 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.833
[S6] round=18 local utility u=0.000000 metrics={'f1_val': 0.6883085497791133, 'auprc': 0.7825507360297873, 'loss_val': 0.6812021136609313, 'psi': 0.7260054242793829}-{'f1_val': 0.8539810207731119, 'auprc': 0.8811270144365584, 'loss_val': 0.34404953093992946, 'psi': 0.8648394182384905}
[S7] START round=18 head_norm_before_train=1.514074 (no previous merge yet)
[S7] round=18 local utility u=0.413946 metrics={'f1_val': 0.6094735160555731, 'auprc': 0.804220536331552, 'loss_val': 0.6427871854497919, 'psi': 0.6873723241659646}-{'f1_val': 0.5103005457620529, 'auprc': 0.7850907298741147, 'loss_val': 0.8182512134272765, 'psi': 0.6202166194068777}
[S8] START round=18 head_norm_before_train=1.689201 cos_to_last_merge=0.7842 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.784
[S8] round=18 local utility u=0.326688 metrics={'f1_val': 0.9892831449862951, 'auprc': 0.9985449300797785, 'loss_val': 0.04866753946473522, 'psi': 0.9929878590236885}-{'f1_val': 0.900768914203853, 'auprc': 0.9848547386463857, 'loss_val': 0.1298879576276896, 'psi': 0.934403243980866}
[S9] START round=18 head_norm_before_train=1.792967 (no previous merge yet)
[S9] round=18 local utility u=0.041850 metrics={'f1_val': 0.9955808965143278, 'auprc': 0.9991691476577097, 'loss_val': 0.05177205843460954, 'psi': 0.9970161969716805}-{'f1_val': 0.9871446711497952, 'auprc': 0.9984378150864597, 'loss_val': 0.0826615303641565, 'psi': 0.991661928724461}
[S10] START round=18 head_norm_before_train=1.660627 cos_to_last_merge=0.7753 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.775
[S10] round=18 local utility u=0.004125 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9955536018597417, 'loss_val': 0.04468494759838302, 'psi': 0.9950706062755201}-{'f1_val': 0.9949681865317428, 'auprc': 0.9938569923872924, 'loss_val': 0.04916226798558244, 'psi': 0.9945237088739627}
[S11] START round=18 head_norm_before_train=1.167881 cos_to_last_merge=1.0000 (last merge round=17)
[S11] round=18 local utility u=0.014660 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9449242083268792, 'loss_val': 0.40502613129570375, 'psi': 0.7991308733097437}-{'f1_val': 0.7016934795869249, 'auprc': 0.941892915958806, 'loss_val': 0.4238004760377572, 'psi': 0.7977732541356772}
[S13] START round=18 head_norm_before_train=1.058448 cos_to_last_merge=1.0000 (last merge round=17)
[S13] round=18 local utility u=0.000000 metrics={'f1_val': 0.6116781532256099, 'auprc': 0.5925645565456613, 'loss_val': 0.685074749930798, 'psi': 0.6040327145536305}-{'f1_val': 0.6289263426746633, 'auprc': 0.610844858677706, 'loss_val': 0.6441342227060616, 'psi': 0.6216937490758804}
[S14] START round=18 head_norm_before_train=1.049333 cos_to_last_merge=1.0000 (last merge round=17)
[S14] round=18 local utility u=0.000000 metrics={'f1_val': 0.887042940787516, 'auprc': 0.9971508036641321, 'loss_val': 0.48820648507610426, 'psi': 0.9310860859381624}-{'f1_val': 0.887028848556985, 'auprc': 0.9983822089831145, 'loss_val': 0.39996336186273074, 'psi': 0.9315701927274368}
[S15] START round=18 head_norm_before_train=1.042722 cos_to_last_merge=0.9931 (last merge round=16)
[S15] round=18 local utility u=0.023982 metrics={'f1_val': 0.9929044557791944, 'auprc': 0.995245483685613, 'loss_val': 0.15633381336610597, 'psi': 0.9938408669417619}-{'f1_val': 0.9959577109714866, 'auprc': 0.99590571615289, 'loss_val': 0.22459878790846396, 'psi': 0.995936913044048}
[S16] START round=18 head_norm_before_train=0.923893 cos_to_last_merge=1.0000 (last merge round=17)
[S16] round=18 local utility u=0.333913 metrics={'f1_val': 0.8367946245292467, 'auprc': 0.9098090159433583, 'loss_val': 0.5728809133092276, 'psi': 0.8660003810948913}-{'f1_val': 0.7640760200257014, 'auprc': 0.8392600123669347, 'loss_val': 0.5927486461269479, 'psi': 0.7941496169621947}
[S17] START round=18 head_norm_before_train=1.058677 cos_to_last_merge=1.0000 (last merge round=17)
[S17] round=18 local utility u=0.000000 metrics={'f1_val': 0.44088701745453646, 'auprc': 0.5885493111089333, 'loss_val': 0.920244545449068, 'psi': 0.4999519349162952}-{'f1_val': 0.5538124932226358, 'auprc': 0.6636097619523155, 'loss_val': 0.7598551505133295, 'psi': 0.5977314007145077}
[S5] not sending this round → trigger blocked (psi=0.797)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:45915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:45903
[S3] not sending this round → trigger blocked (psi=0.815)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.994)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:45914
[S11] not sending this round → trigger blocked (psi=0.799)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:45916
[S2] not sending this round → trigger blocked (psi=0.690)
[S10] not sending this round → trigger blocked (psi=0.995)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.687)
[S9] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1799) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.708533)
[S3] loaded HEAD from S8 (vec_in norm=1.708533)
[S3] cosine check vs S8: cos=0.9905
[S3] BUFFERED delta from S8 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1797) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.821317)
[S16] loaded HEAD from S9 (vec_in norm=1.821317)
[S16] cosine check vs S9: cos=0.5676
[S16] BUFFERED delta from S9 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1796) from S16
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.981978)
[S15] loaded HEAD from S16 (vec_in norm=0.981978)
[S15] cosine check vs S16: cos=0.8489
[S15] BUFFERED delta from S16 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1798) from S4
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.585050)
[S14] loaded HEAD from S4 (vec_in norm=1.585050)
[S14] cosine check vs S4: cos=0.6314
[S14] BUFFERED delta from S4 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=18 metric=0.8870 head_norm=1.093890
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.163518e-01
[S14] stored merged vector for next round verification (round=18)
[S14] DEBUG after merge:  round=18 metric=0.8881 head_norm=1.214331 delta_norm=0.616352
[S14] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=18 metric=0.6927 head_norm=1.697852
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.172190e-01
[S3] stored merged vector for next round verification (round=18)
[S3] DEBUG after merge:  round=18 metric=0.6935 head_norm=1.699163 delta_norm=0.117219
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=18 metric=0.8368 head_norm=0.981978
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.501717e-01
[S16] stored merged vector for next round verification (round=18)
[S16] DEBUG after merge:  round=18 metric=0.8266 head_norm=1.256177 delta_norm=0.750172
[S16] aggregate: ROLLBACK (f1_val pre=0.837 post=0.827 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=18 metric=0.9929 head_norm=1.131563
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.992756e-01
[S15] stored merged vector for next round verification (round=18)
[S15] DEBUG after merge:  round=18 metric=0.9927 head_norm=1.016264 delta_norm=0.299276
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.354932 cos_to_last_merge=0.9746 (last merge round=14)
[S2] round=19 local utility u=0.000000 metrics={'f1_val': 0.4342139005488739, 'auprc': 0.5986568373270629, 'loss_val': 1.3331997927560761, 'psi': 0.49999107526014946}-{'f1_val': 0.7015691843323472, 'auprc': 0.6737366182207338, 'loss_val': 0.3494730512517269, 'psi': 0.6904361578877019}
[S3] START round=19 head_norm_before_train=1.699163 cos_to_last_merge=1.0000 (last merge round=18)
[S3] round=19 local utility u=0.044467 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9986916288343974, 'loss_val': 0.27541121640827076, 'psi': 0.8198852273329598}-{'f1_val': 0.6927498788157274, 'auprc': 0.99922775958754, 'loss_val': 0.31836759340924164, 'psi': 0.8153410311244524}
[S4] START round=19 head_norm_before_train=1.585050 cos_to_last_merge=0.9982 (last merge round=17)
[S4] round=19 local utility u=0.000000 metrics={'f1_val': 0.941661527445016, 'auprc': 0.9733023477946686, 'loss_val': 0.2709263104030687, 'psi': 0.954317855584877}-{'f1_val': 0.9472375965654535, 'auprc': 0.9669923677732166, 'loss_val': 0.27000380535209856, 'psi': 0.9551395050485587}
[S5] START round=19 head_norm_before_train=1.589778 (no previous merge yet)
[S5] round=19 local utility u=0.009598 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9461668789789672, 'loss_val': 0.30145063050235277, 'psi': 0.7988317871891915}-{'f1_val': 0.7006083926626743, 'auprc': 0.9424492205148638, 'loss_val': 0.309492900341346, 'psi': 0.79734472380355}
[S6] START round=19 head_norm_before_train=1.580096 cos_to_last_merge=0.8303 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.830
[S6] round=19 local utility u=0.449577 metrics={'f1_val': 0.765130772529824, 'auprc': 0.8685837478253698, 'loss_val': 0.5010812893435039, 'psi': 0.8065119626480424}-{'f1_val': 0.6883085497791133, 'auprc': 0.7825507360297873, 'loss_val': 0.6812021136609313, 'psi': 0.7260054242793829}
[S7] START round=19 head_norm_before_train=1.532557 (no previous merge yet)
[S7] round=19 local utility u=0.000000 metrics={'f1_val': 0.3862270044603392, 'auprc': 0.7774398975262953, 'loss_val': 1.159217208734634, 'psi': 0.5427121616867217}-{'f1_val': 0.6094735160555731, 'auprc': 0.804220536331552, 'loss_val': 0.6427871854497919, 'psi': 0.6873723241659646}
[S8] START round=19 head_norm_before_train=1.708533 cos_to_last_merge=0.7830 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.783
[S8] round=19 local utility u=0.000000 metrics={'f1_val': 0.9921646161217188, 'auprc': 0.9853144245568873, 'loss_val': 0.042534471237404864, 'psi': 0.9894245394957862}-{'f1_val': 0.9892831449862951, 'auprc': 0.9985449300797785, 'loss_val': 0.04866753946473522, 'psi': 0.9929878590236885}
[S9] START round=19 head_norm_before_train=1.821317 (no previous merge yet)
[S9] round=19 local utility u=0.000000 metrics={'f1_val': 0.9063292391317441, 'auprc': 0.999694324852698, 'loss_val': 0.13056651433569394, 'psi': 0.9436752734201257}-{'f1_val': 0.9955808965143278, 'auprc': 0.9991691476577097, 'loss_val': 0.05177205843460954, 'psi': 0.9970161969716805}
[S10] START round=19 head_norm_before_train=1.691144 cos_to_last_merge=0.7715 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.772
[S10] round=19 local utility u=0.002017 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9956518252325162, 'loss_val': 0.040944694428195566, 'psi': 0.99510989562463}-{'f1_val': 0.9947486092193725, 'auprc': 0.9955536018597417, 'loss_val': 0.04468494759838302, 'psi': 0.9950706062755201}
[S11] START round=19 head_norm_before_train=1.200718 cos_to_last_merge=0.9986 (last merge round=17)
[S11] round=19 local utility u=0.062756 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9728151645400649, 'loss_val': 0.36173551360778095, 'psi': 0.8101421535681809}-{'f1_val': 0.7019353166316534, 'auprc': 0.9449242083268792, 'loss_val': 0.40502613129570375, 'psi': 0.7991308733097437}
[S13] START round=19 head_norm_before_train=1.124579 cos_to_last_merge=0.9956 (last merge round=17)
[S13] round=19 local utility u=0.172942 metrics={'f1_val': 0.6118682876287505, 'auprc': 0.6876928345280132, 'loss_val': 0.6257170714418591, 'psi': 0.6421981063884555}-{'f1_val': 0.6116781532256099, 'auprc': 0.5925645565456613, 'loss_val': 0.685074749930798, 'psi': 0.6040327145536305}
[S14] START round=19 head_norm_before_train=1.214331 cos_to_last_merge=1.0000 (last merge round=18)
[S14] round=19 local utility u=0.000000 metrics={'f1_val': 0.868506255594868, 'auprc': 0.9983951917413425, 'loss_val': 0.3886789993830385, 'psi': 0.9204618300534578}-{'f1_val': 0.887042940787516, 'auprc': 0.9971508036641321, 'loss_val': 0.48820648507610426, 'psi': 0.9310860859381624}
[S15] START round=19 head_norm_before_train=1.016264 cos_to_last_merge=1.0000 (last merge round=18)
[S15] round=19 local utility u=0.000000 metrics={'f1_val': 0.7010289742640698, 'auprc': 0.9871960660525652, 'loss_val': 0.4069230645786095, 'psi': 0.815495810979468}-{'f1_val': 0.9929044557791944, 'auprc': 0.995245483685613, 'loss_val': 0.15633381336610597, 'psi': 0.9938408669417619}
[S16] START round=19 head_norm_before_train=1.256177 cos_to_last_merge=1.0000 (last merge round=18)
[S16] round=19 local utility u=0.429299 metrics={'f1_val': 0.9290678552737051, 'auprc': 0.9479396898351773, 'loss_val': 0.38231352177124356, 'psi': 0.936616589098294}-{'f1_val': 0.8367946245292467, 'auprc': 0.9098090159433583, 'loss_val': 0.5728809133092276, 'psi': 0.8660003810948913}
[S17] START round=19 head_norm_before_train=1.100197 cos_to_last_merge=0.9948 (last merge round=17)
[S17] round=19 local utility u=1.000000 metrics={'f1_val': 0.6920424505201221, 'auprc': 0.7659966811581236, 'loss_val': 0.5426118324746867, 'psi': 0.7216241427753227}-{'f1_val': 0.44088701745453646, 'auprc': 0.5885493111089333, 'loss_val': 0.920244545449068, 'psi': 0.4999519349162952}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:45915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:45917
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:45902
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:45909
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:45916
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:45917
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1805 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1796) from S16
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.307649)
[S15] loaded HEAD from S16 (vec_in norm=1.307649)
[S15] cosine check vs S16: cos=0.8206
[S15] BUFFERED delta from S16 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1798) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.609582)
[S17] loaded HEAD from S6 (vec_in norm=1.609582)
[S17] cosine check vs S6: cos=-0.0544
[S17] DROPPED delta from S6 (cos=-0.0544 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1804) from S3
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.725193)
[S17] loaded HEAD from S3 (vec_in norm=1.725193)
[S17] cosine check vs S3: cos=0.6798
[S17] BUFFERED delta from S3 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1797) from S13
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.190794)
[S2] loaded HEAD from S13 (vec_in norm=1.190794)
[S2] cosine check vs S13: cos=0.8207
[S2] BUFFERED delta from S13 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1803) from S11
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.229836)
[S16] loaded HEAD from S11 (vec_in norm=1.229836)
[S16] cosine check vs S11: cos=0.2573
[S16] BUFFERED delta from S11 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1798) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.607775)
[S16] loaded HEAD from S5 (vec_in norm=1.607775)
[S16] cosine check vs S5: cos=0.3780
[S16] BUFFERED delta from S5 (total buffered=2)
[S8] RECEIVED delta(kind=head bytes=1805) from S10
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.719573)
[S8] loaded HEAD from S10 (vec_in norm=1.719573)
[S8] cosine check vs S10: cos=-0.0693
[S8] DROPPED delta from S10 (cos=-0.0693 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:45914
[S17] sending update (kind=head size=1804 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1804) from S17
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.135285)
[S14] loaded HEAD from S17 (vec_in norm=1.135285)
[S14] cosine check vs S17: cos=0.6692
[S14] BUFFERED delta from S17 (total buffered=1)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=19 metric=0.4342 head_norm=1.382051
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.958584e-01
[S2] stored merged vector for next round verification (round=19)
[S2] DEBUG after merge:  round=19 metric=0.4346 head_norm=1.227731 delta_norm=0.395858
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] r=20 psi=0.500 u=0.0000 p_local=0.1412 f1=0.434 auprc=0.599 bytes=16180
[S7] r=20 psi=0.543 u=0.0000 p_local=0.2437 f1=0.386 auprc=0.777 bytes=16152
[S9] r=20 psi=0.944 u=0.0000 p_local=0.1086 f1=0.906 auprc=1.000 bytes=25153
[S4] r=20 psi=0.954 u=0.0000 p_local=0.0764 f1=0.942 auprc=0.973 bytes=14367
[S8] r=20 psi=0.989 u=0.0000 p_local=0.1070 f1=0.992 auprc=0.985 bytes=21588
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=19 metric=0.8685 head_norm=1.258768
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.901134e-01
[S14] stored merged vector for next round verification (round=19)
[S14] DEBUG after merge:  round=19 metric=0.8628 head_norm=1.093835 delta_norm=0.490113
[S14] aggregate: ROLLBACK (f1_val pre=0.869 post=0.863 tol_abs=0.005 tol_rel=0.0)
[S14] r=20 psi=0.920 u=0.0000 p_local=0.1919 f1=0.869 auprc=0.998 bytes=23360
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=19 metric=0.9291 head_norm=1.307649
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.139680e-01
[S16] stored merged vector for next round verification (round=19)
[S16] DEBUG after merge:  round=19 metric=0.9132 head_norm=0.990577 delta_norm=0.613968
[S16] aggregate: ROLLBACK (f1_val pre=0.929 post=0.913 tol_abs=0.005 tol_rel=0.0)
[S16] r=20 psi=0.937 u=0.4293 p_local=0.3279 f1=0.929 auprc=0.948 bytes=21556
[S11] r=20 psi=0.810 u=0.0628 p_local=0.1137 f1=0.702 auprc=0.973 bytes=23362
[S6] r=20 psi=0.807 u=0.4496 p_local=0.3184 f1=0.765 auprc=0.869 bytes=18011
[S5] r=20 psi=0.799 u=0.0096 p_local=0.1047 f1=0.701 auprc=0.946 bytes=23366
[S13] r=20 psi=0.642 u=0.1729 p_local=0.0891 f1=0.612 auprc=0.688 bytes=16165
[S10] r=20 psi=0.995 u=0.0020 p_local=0.0859 f1=0.995 auprc=0.996 bytes=25201
[S3] r=20 psi=0.820 u=0.0445 p_local=0.2699 f1=0.701 auprc=0.999 bytes=18008
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=19 metric=0.7010 head_norm=1.102564
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.739422e-01
[S15] stored merged vector for next round verification (round=19)
[S15] DEBUG after merge:  round=19 metric=0.7012 head_norm=1.150202 delta_norm=0.373942
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S15] r=20 psi=0.815 u=0.0000 p_local=0.2014 f1=0.701 auprc=0.987 bytes=21592
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=19 metric=0.6920 head_norm=1.135285
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.328671e-01
[S17] stored merged vector for next round verification (round=19)
[S17] DEBUG after merge:  round=19 metric=0.6920 head_norm=1.316078 delta_norm=0.632867
[S17] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S17] r=20 psi=0.722 u=1.0000 p_local=0.3599 f1=0.692 auprc=0.766 bytes=21600
[S2] START round=20 head_norm_before_train=1.227731 cos_to_last_merge=1.0000 (last merge round=19)
[S2] round=20 local utility u=1.000000 metrics={'f1_val': 0.7014918162305126, 'auprc': 0.7497157249900258, 'loss_val': 0.3732513687731988, 'psi': 0.7207813797343179}-{'f1_val': 0.4342139005488739, 'auprc': 0.5986568373270629, 'loss_val': 1.3331997927560761, 'psi': 0.49999107526014946}
[S3] START round=20 head_norm_before_train=1.725193 cos_to_last_merge=0.9998 (last merge round=18)
[S3] round=20 local utility u=0.033800 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9986331155111323, 'loss_val': 0.2076358032669987, 'psi': 0.8198618220036538}-{'f1_val': 0.7006809596653347, 'auprc': 0.9986916288343974, 'loss_val': 0.27541121640827076, 'psi': 0.8198852273329598}
[S4] START round=20 head_norm_before_train=1.628816 cos_to_last_merge=0.9949 (last merge round=17)
[S4] round=20 local utility u=0.000000 metrics={'f1_val': 0.9375501956027712, 'auprc': 0.9621468079315199, 'loss_val': 0.31743647908481987, 'psi': 0.9473888405342706}-{'f1_val': 0.941661527445016, 'auprc': 0.9733023477946686, 'loss_val': 0.2709263104030687, 'psi': 0.954317855584877}
[S5] START round=20 head_norm_before_train=1.607775 (no previous merge yet)
[S5] round=20 local utility u=0.085182 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9971120405535644, 'loss_val': 0.28392156888928527, 'psi': 0.8192098518190303}-{'f1_val': 0.7006083926626743, 'auprc': 0.9461668789789672, 'loss_val': 0.30145063050235277, 'psi': 0.7988317871891915}
[S6] START round=20 head_norm_before_train=1.609582 cos_to_last_merge=0.8274 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.827
[S6] round=20 local utility u=0.572154 metrics={'f1_val': 0.8839303555381184, 'auprc': 0.9379270514913463, 'loss_val': 0.2776012725162334, 'psi': 0.9055290339194095}-{'f1_val': 0.765130772529824, 'auprc': 0.8685837478253698, 'loss_val': 0.5010812893435039, 'psi': 0.8065119626480424}
[S7] START round=20 head_norm_before_train=1.549256 (no previous merge yet)
[S7] round=20 local utility u=1.000000 metrics={'f1_val': 0.6285816567766576, 'auprc': 0.8153845744393617, 'loss_val': 0.5755498427856024, 'psi': 0.7033028238417391}-{'f1_val': 0.3862270044603392, 'auprc': 0.7774398975262953, 'loss_val': 1.159217208734634, 'psi': 0.5427121616867217}
[S8] START round=20 head_norm_before_train=1.730553 cos_to_last_merge=0.7815 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.782
[S8] round=20 local utility u=0.002108 metrics={'f1_val': 0.9930990485370332, 'auprc': 0.9848845218609152, 'loss_val': 0.042634573748495226, 'psi': 0.989813237866586}-{'f1_val': 0.9921646161217188, 'auprc': 0.9853144245568873, 'loss_val': 0.042534471237404864, 'psi': 0.9894245394957862}
[S9] START round=20 head_norm_before_train=1.843841 (no previous merge yet)
[S9] round=20 local utility u=0.305219 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9935637257720656, 'loss_val': 0.04126106324240315, 'psi': 0.9951755471763928}-{'f1_val': 0.9063292391317441, 'auprc': 0.999694324852698, 'loss_val': 0.13056651433569394, 'psi': 0.9436752734201257}
[S10] START round=20 head_norm_before_train=1.719573 cos_to_last_merge=0.7682 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.768
[S10] round=20 local utility u=0.001235 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9955378183277195, 'loss_val': 0.03813277258383506, 'psi': 0.9950642928627114}-{'f1_val': 0.9947486092193725, 'auprc': 0.9956518252325162, 'loss_val': 0.040944694428195566, 'psi': 0.99510989562463}
[S11] START round=20 head_norm_before_train=1.229836 cos_to_last_merge=0.9957 (last merge round=17)
[S11] round=20 local utility u=0.030689 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9846196384053267, 'loss_val': 0.33577002834501646, 'psi': 0.8148639431142857}-{'f1_val': 0.7016934795869249, 'auprc': 0.9728151645400649, 'loss_val': 0.36173551360778095, 'psi': 0.8101421535681809}
[S13] START round=20 head_norm_before_train=1.190794 cos_to_last_merge=0.9861 (last merge round=17)
[S13] round=20 local utility u=0.000000 metrics={'f1_val': 0.600710562927743, 'auprc': 0.6042282948319546, 'loss_val': 0.7652119079458839, 'psi': 0.6021176556894277}-{'f1_val': 0.6118682876287505, 'auprc': 0.6876928345280132, 'loss_val': 0.6257170714418591, 'psi': 0.6421981063884555}
[S14] START round=20 head_norm_before_train=1.093835 cos_to_last_merge=1.0000 (last merge round=19)
[S14] round=20 local utility u=0.000000 metrics={'f1_val': 0.8313944534620665, 'auprc': 0.9553259638966575, 'loss_val': 0.5785963541238309, 'psi': 0.880967057635903}-{'f1_val': 0.868506255594868, 'auprc': 0.9983951917413425, 'loss_val': 0.3886789993830385, 'psi': 0.9204618300534578}
[S15] START round=20 head_norm_before_train=1.150202 cos_to_last_merge=1.0000 (last merge round=19)
[S15] round=20 local utility u=0.000000 metrics={'f1_val': 0.7009169771696235, 'auprc': 0.8216895913014193, 'loss_val': 0.41895045775260203, 'psi': 0.7492260228223419}-{'f1_val': 0.7010289742640698, 'auprc': 0.9871960660525652, 'loss_val': 0.4069230645786095, 'psi': 0.815495810979468}
[S16] START round=20 head_norm_before_train=0.990577 cos_to_last_merge=1.0000 (last merge round=19)
[S16] round=20 local utility u=0.000000 metrics={'f1_val': 0.8758352843961439, 'auprc': 0.9849708453907089, 'loss_val': 0.3786828158447368, 'psi': 0.9194895087939698}-{'f1_val': 0.9290678552737051, 'auprc': 0.9479396898351773, 'loss_val': 0.38231352177124356, 'psi': 0.936616589098294}
[S17] START round=20 head_norm_before_train=1.316078 cos_to_last_merge=1.0000 (last merge round=19)
[S17] round=20 local utility u=0.000000 metrics={'f1_val': 0.3705263921860176, 'auprc': 0.572132850675232, 'loss_val': 1.1112871340390893, 'psi': 0.4511689755817033}-{'f1_val': 0.6920424505201221, 'auprc': 0.7659966811581236, 'loss_val': 0.5426118324746867, 'psi': 0.7216241427753227}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] not sending this round → trigger blocked (psi=0.815)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:45917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S7] → sending delta(kind=head bytes=1807) to S4@127.0.0.1:45904
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.819)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.820)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.906)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:45916
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S8] → sending delta(kind=head bytes=1807) to S3@127.0.0.1:45903
[S9] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1807 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1807 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1800) from S2
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.246893)
[S17] loaded HEAD from S2 (vec_in norm=1.246893)
[S17] cosine check vs S2: cos=0.4034
[S17] BUFFERED delta from S2 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1807) from S7
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.561239)
[S4] loaded HEAD from S7 (vec_in norm=1.561239)
[S4] cosine check vs S7: cos=0.9734
[S4] BUFFERED delta from S7 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1798) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.860959)
[S16] loaded HEAD from S9 (vec_in norm=1.860959)
[S16] cosine check vs S9: cos=0.6982
[S16] BUFFERED delta from S9 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1807) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.749851)
[S3] loaded HEAD from S8 (vec_in norm=1.749851)
[S3] cosine check vs S8: cos=0.9944
[S3] BUFFERED delta from S8 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] ⇄ pheromone p=0.161 → S13@127.0.0.1:45913
[S13] ⇄ pheromone p=0.071 → S2@127.0.0.1:45902
[S14] ⇄ pheromone p=0.154 → S11@127.0.0.1:45912
[S5] ⇄ pheromone p=0.101 → S16@127.0.0.1:45916
[S11] ⇄ pheromone p=0.097 → S16@127.0.0.1:45916
[S6] ⇄ pheromone p=0.369 → S17@127.0.0.1:45917
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=20 metric=0.7007 head_norm=1.745570
[S3] _apply_head_vector_avg (torch): Δ‖w‖=9.236450e-02
[S3] stored merged vector for next round verification (round=20)
[S3] DEBUG after merge:  round=20 metric=0.7007 head_norm=1.745270 delta_norm=0.092364
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.223 → S17@127.0.0.1:45917
[S10] ⇄ pheromone p=0.069 → S8@127.0.0.1:45909
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=20 metric=0.9376 head_norm=1.669089
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.939299e-01
[S4] stored merged vector for next round verification (round=20)
[S4] DEBUG after merge:  round=20 metric=0.9363 head_norm=1.604386 delta_norm=0.193930
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.061 → S14@127.0.0.1:45914
[S2] ⇄ pheromone p=0.313 → S17@127.0.0.1:45917
[S7] ⇄ pheromone p=0.395 → S4@127.0.0.1:45904
[S9] ⇄ pheromone p=0.148 → S16@127.0.0.1:45916
[S8] ⇄ pheromone p=0.086 → S3@127.0.0.1:45903
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=20 metric=0.3705 head_norm=1.339245
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.072989e-01
[S17] stored merged vector for next round verification (round=20)
[S17] DEBUG after merge:  round=20 metric=0.3767 head_norm=1.083461 delta_norm=0.707299
[S17] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.288 → S14@127.0.0.1:45914
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=20 metric=0.8758 head_norm=1.038535
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.787993e-01
[S16] stored merged vector for next round verification (round=20)
[S16] DEBUG after merge:  round=20 metric=0.9785 head_norm=1.345397 delta_norm=0.678799
[S16] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.262 → S15@127.0.0.1:45915
[S2] START round=21 head_norm_before_train=1.246893 cos_to_last_merge=0.9998 (last merge round=19)
[S2] round=21 local utility u=0.000000 metrics={'f1_val': 0.7086500354432845, 'auprc': 0.6715138522227545, 'loss_val': 0.3938434580402612, 'psi': 0.6937955621550725}-{'f1_val': 0.7014918162305126, 'auprc': 0.7497157249900258, 'loss_val': 0.3732513687731988, 'psi': 0.7207813797343179}
[S3] START round=21 head_norm_before_train=1.745270 cos_to_last_merge=1.0000 (last merge round=20)
[S3] round=21 local utility u=0.906594 metrics={'f1_val': 0.9978408381428526, 'auprc': 0.9993996778321, 'loss_val': 0.179706399767543, 'psi': 0.9984643740185516}-{'f1_val': 0.7006809596653347, 'auprc': 0.9986331155111323, 'loss_val': 0.2076358032669987, 'psi': 0.8198618220036538}
[S4] START round=21 head_norm_before_train=1.604386 cos_to_last_merge=1.0000 (last merge round=20)
[S4] round=21 local utility u=0.059705 metrics={'f1_val': 0.9416219506011441, 'auprc': 0.9785218444783359, 'loss_val': 0.27158223462876796, 'psi': 0.9563819081520208}-{'f1_val': 0.9375501956027712, 'auprc': 0.9621468079315199, 'loss_val': 0.31743647908481987, 'psi': 0.9473888405342706}
[S5] START round=21 head_norm_before_train=1.622388 (no previous merge yet)
[S5] round=21 local utility u=0.000000 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9480792150707767, 'loss_val': 0.29280861072130304, 'psi': 0.7995967216259152}-{'f1_val': 0.7006083926626743, 'auprc': 0.9971120405535644, 'loss_val': 0.28392156888928527, 'psi': 0.8192098518190303}
[S6] START round=21 head_norm_before_train=1.640820 cos_to_last_merge=0.8239 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.824
[S6] round=21 local utility u=0.000000 metrics={'f1_val': 0.5788762151096402, 'auprc': 0.7278863314050803, 'loss_val': 0.9256922352334419, 'psi': 0.6384802616278162}-{'f1_val': 0.8839303555381184, 'auprc': 0.9379270514913463, 'loss_val': 0.2776012725162334, 'psi': 0.9055290339194095}
[S7] START round=21 head_norm_before_train=1.561239 (no previous merge yet)
[S7] round=21 local utility u=0.000000 metrics={'f1_val': 0.4568144131583294, 'auprc': 0.7822793678296274, 'loss_val': 0.936894663337226, 'psi': 0.5870003950268485}-{'f1_val': 0.6285816567766576, 'auprc': 0.8153845744393617, 'loss_val': 0.5755498427856024, 'psi': 0.7033028238417391}
[S8] START round=21 head_norm_before_train=1.749851 cos_to_last_merge=0.7794 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.779
[S8] round=21 local utility u=0.017165 metrics={'f1_val': 0.9918008107316822, 'auprc': 0.9981376611339784, 'loss_val': 0.040274400123858516, 'psi': 0.9943355508926007}-{'f1_val': 0.9930990485370332, 'auprc': 0.9848845218609152, 'loss_val': 0.042634573748495226, 'psi': 0.989813237866586}
[S9] START round=21 head_norm_before_train=1.860959 (no previous merge yet)
[S9] round=21 local utility u=0.000000 metrics={'f1_val': 0.9880286744602689, 'auprc': 0.9995650697868124, 'loss_val': 0.0556703238372076, 'psi': 0.9926432325908863}-{'f1_val': 0.9962500947792776, 'auprc': 0.9935637257720656, 'loss_val': 0.04126106324240315, 'psi': 0.9951755471763928}
[S10] START round=21 head_norm_before_train=1.746185 cos_to_last_merge=0.7652 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.765
[S10] round=21 local utility u=0.001872 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9960327843539494, 'loss_val': 0.035872909366670085, 'psi': 0.9952622792732033}-{'f1_val': 0.9947486092193725, 'auprc': 0.9955378183277195, 'loss_val': 0.03813277258383506, 'psi': 0.9950642928627114}
[S11] START round=21 head_norm_before_train=1.256856 cos_to_last_merge=0.9923 (last merge round=17)
[S11] round=21 local utility u=0.020085 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9927310985114679, 'loss_val': 0.32138589170873544, 'psi': 0.8182536293835792}-{'f1_val': 0.7016934795869249, 'auprc': 0.9846196384053267, 'loss_val': 0.33577002834501646, 'psi': 0.8148639431142857}
[S13] START round=21 head_norm_before_train=1.228478 cos_to_last_merge=0.9797 (last merge round=17)
[S13] round=21 local utility u=0.144018 metrics={'f1_val': 0.6080878856317762, 'auprc': 0.649863223767247, 'loss_val': 0.6583453323687904, 'psi': 0.6247980208859645}-{'f1_val': 0.600710562927743, 'auprc': 0.6042282948319546, 'loss_val': 0.7652119079458839, 'psi': 0.6021176556894277}
[S14] START round=21 head_norm_before_train=1.140810 cos_to_last_merge=0.9976 (last merge round=19)
[S14] round=21 local utility u=0.331047 metrics={'f1_val': 0.8876097780695936, 'auprc': 0.9981682788508359, 'loss_val': 0.38232199660358657, 'psi': 0.9318331783820906}-{'f1_val': 0.8313944534620665, 'auprc': 0.9553259638966575, 'loss_val': 0.5785963541238309, 'psi': 0.880967057635903}
[S15] START round=21 head_norm_before_train=1.218585 cos_to_last_merge=0.9970 (last merge round=19)
[S15] round=21 local utility u=1.000000 metrics={'f1_val': 0.9950341038182815, 'auprc': 0.9973956666066126, 'loss_val': 0.124748555827456, 'psi': 0.9959787289336139}-{'f1_val': 0.7009169771696235, 'auprc': 0.8216895913014193, 'loss_val': 0.41895045775260203, 'psi': 0.7492260228223419}
[S16] START round=21 head_norm_before_train=1.345397 cos_to_last_merge=1.0000 (last merge round=20)
[S16] round=21 local utility u=0.403382 metrics={'f1_val': 0.9866280213214069, 'auprc': 0.987465322167691, 'loss_val': 0.24415923902098116, 'psi': 0.9869629416599205}-{'f1_val': 0.8758352843961439, 'auprc': 0.9849708453907089, 'loss_val': 0.3786828158447368, 'psi': 0.9194895087939698}
[S17] START round=21 head_norm_before_train=1.083461 cos_to_last_merge=1.0000 (last merge round=20)
[S17] round=21 local utility u=1.000000 metrics={'f1_val': 0.6461482032892373, 'auprc': 0.8039654203147935, 'loss_val': 0.5329501602853454, 'psi': 0.7092750900994598}-{'f1_val': 0.3705263921860176, 'auprc': 0.572132850675232, 'loss_val': 1.1112871340390893, 'psi': 0.4511689755817033}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:45909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:45913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:45917
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:45915
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:45912
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:45902
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.994)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:45914
[S14] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1801) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.193496)
[S11] loaded HEAD from S14 (vec_in norm=1.193496)
[S11] cosine check vs S14: cos=0.9276
[S11] BUFFERED delta from S14 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1801) from S11
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.285275)
[S16] loaded HEAD from S11 (vec_in norm=1.285275)
[S16] cosine check vs S11: cos=0.2433
[S16] BUFFERED delta from S11 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1801) from S16
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.389602)
[S15] loaded HEAD from S16 (vec_in norm=1.389602)
[S15] cosine check vs S16: cos=0.9153
[S15] BUFFERED delta from S16 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1797) from S3
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.764427)
[S17] loaded HEAD from S3 (vec_in norm=1.764427)
[S17] cosine check vs S3: cos=0.6356
[S17] BUFFERED delta from S3 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1797) from S4
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.646623)
[S14] loaded HEAD from S4 (vec_in norm=1.646623)
[S14] cosine check vs S4: cos=0.7314
[S14] BUFFERED delta from S4 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1803) from S15
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.278283)
[S13] loaded HEAD from S15 (vec_in norm=1.278283)
[S13] cosine check vs S15: cos=0.8715
[S13] BUFFERED delta from S15 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1799) from S13
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.253639)
[S2] loaded HEAD from S13 (vec_in norm=1.253639)
[S2] cosine check vs S13: cos=0.9400
[S2] BUFFERED delta from S13 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1800) from S10
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.768346)
[S8] loaded HEAD from S10 (vec_in norm=1.768346)
[S8] cosine check vs S10: cos=-0.0730
[S8] DROPPED delta from S10 (cos=-0.0730 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:45914
[S17] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S17
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.127891)
[S14] loaded HEAD from S17 (vec_in norm=1.127891)
[S14] cosine check vs S17: cos=0.8711
[S14] BUFFERED delta from S17 (total buffered=2)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=21 metric=0.7087 head_norm=1.265377
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.181779e-01
[S2] stored merged vector for next round verification (round=21)
[S2] DEBUG after merge:  round=21 metric=0.7089 head_norm=1.240481 delta_norm=0.218178
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=21 metric=0.8876 head_norm=1.193496
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.077559e-01
[S14] stored merged vector for next round verification (round=21)
[S14] DEBUG after merge:  round=21 metric=0.8879 head_norm=1.161120 delta_norm=0.207756
[S14] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=21 metric=0.6081 head_norm=1.253639
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.211609e-01
[S13] stored merged vector for next round verification (round=21)
[S13] DEBUG after merge:  round=21 metric=0.6068 head_norm=1.224608 delta_norm=0.321161
[S13] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=21 metric=0.7019 head_norm=1.285275
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.400625e-01
[S11] stored merged vector for next round verification (round=21)
[S11] DEBUG after merge:  round=21 metric=0.7019 head_norm=1.216779 delta_norm=0.240062
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=21 metric=0.9950 head_norm=1.278283
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.798602e-01
[S15] stored merged vector for next round verification (round=21)
[S15] DEBUG after merge:  round=21 metric=0.9950 head_norm=1.305442 delta_norm=0.279860
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=21 metric=0.9866 head_norm=1.389602
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.236850e-01
[S16] stored merged vector for next round verification (round=21)
[S16] DEBUG after merge:  round=21 metric=0.9810 head_norm=1.054991 delta_norm=0.823685
[S16] aggregate: ROLLBACK (f1_val pre=0.987 post=0.981 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=21 metric=0.6461 head_norm=1.127891
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.810900e-01
[S17] stored merged vector for next round verification (round=21)
[S17] DEBUG after merge:  round=21 metric=0.6427 head_norm=1.314833 delta_norm=0.681090
[S17] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.240481 cos_to_last_merge=1.0000 (last merge round=21)
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.6596151991434465, 'auprc': 0.6718855710486386, 'loss_val': 0.4345695071143227, 'psi': 0.6645233479055233}-{'f1_val': 0.7086500354432845, 'auprc': 0.6715138522227545, 'loss_val': 0.3938434580402612, 'psi': 0.6937955621550725}
[S3] START round=22 head_norm_before_train=1.764427 cos_to_last_merge=0.9998 (last merge round=20)
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.700330919019862, 'auprc': 0.9998925723668577, 'loss_val': 0.22370269624839562, 'psi': 0.8201555803586603}-{'f1_val': 0.9978408381428526, 'auprc': 0.9993996778321, 'loss_val': 0.179706399767543, 'psi': 0.9984643740185516}
[S4] START round=22 head_norm_before_train=1.646623 cos_to_last_merge=0.9992 (last merge round=20)
[S4] round=22 local utility u=0.057458 metrics={'f1_val': 0.9554585872012921, 'auprc': 0.9824378840229453, 'loss_val': 0.251433801800869, 'psi': 0.9662503059299533}-{'f1_val': 0.9416219506011441, 'auprc': 0.9785218444783359, 'loss_val': 0.27158223462876796, 'psi': 0.9563819081520208}
[S5] START round=22 head_norm_before_train=1.633502 (no previous merge yet)
[S5] round=22 local utility u=0.075150 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9920287852218787, 'loss_val': 0.27435753179523953, 'psi': 0.8171765496863561}-{'f1_val': 0.7006083926626743, 'auprc': 0.9480792150707767, 'loss_val': 0.29280861072130304, 'psi': 0.7995967216259152}
[S6] START round=22 head_norm_before_train=1.660076 cos_to_last_merge=0.8224 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.822
[S6] round=22 local utility u=1.000000 metrics={'f1_val': 0.787767909156458, 'auprc': 0.8965583731541713, 'loss_val': 0.5493183035997912, 'psi': 0.8312840947555433}-{'f1_val': 0.5788762151096402, 'auprc': 0.7278863314050803, 'loss_val': 0.9256922352334419, 'psi': 0.6384802616278162}
[S7] START round=22 head_norm_before_train=1.570635 (no previous merge yet)
[S7] round=22 local utility u=0.000000 metrics={'f1_val': 0.4087290166390023, 'auprc': 0.7797803914072903, 'loss_val': 1.0802339589318426, 'psi': 0.5571495665463175}-{'f1_val': 0.4568144131583294, 'auprc': 0.7822793678296274, 'loss_val': 0.936894663337226, 'psi': 0.5870003950268485}
[S8] START round=22 head_norm_before_train=1.764035 cos_to_last_merge=0.7777 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.778
[S8] round=22 local utility u=0.002628 metrics={'f1_val': 0.9933016371923923, 'auprc': 0.9957419305530195, 'loss_val': 0.0368364395813259, 'psi': 0.9942777545366432}-{'f1_val': 0.9918008107316822, 'auprc': 0.9981376611339784, 'loss_val': 0.040274400123858516, 'psi': 0.9943355508926007}
[S9] START round=22 head_norm_before_train=1.877119 (no previous merge yet)
[S9] round=22 local utility u=0.035445 metrics={'f1_val': 0.9959957888192151, 'auprc': 0.9995486779616312, 'loss_val': 0.0325331465141462, 'psi': 0.9974169444761816}-{'f1_val': 0.9880286744602689, 'auprc': 0.9995650697868124, 'loss_val': 0.0556703238372076, 'psi': 0.9926432325908863}
[S10] START round=22 head_norm_before_train=1.768346 cos_to_last_merge=0.7634 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.763
[S10] round=22 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9955651436323986, 'loss_val': 0.03487862023759985, 'psi': 0.995075222984583}-{'f1_val': 0.9947486092193725, 'auprc': 0.9960327843539494, 'loss_val': 0.035872909366670085, 'psi': 0.9952622792732033}
[S11] START round=22 head_norm_before_train=1.216779 cos_to_last_merge=1.0000 (last merge round=21)
[S11] round=22 local utility u=0.000000 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9965854829548797, 'loss_val': 0.3425023513474787, 'psi': 0.8196502809341069}-{'f1_val': 0.7019353166316534, 'auprc': 0.9927310985114679, 'loss_val': 0.32138589170873544, 'psi': 0.8182536293835792}
[S13] START round=22 head_norm_before_train=1.224608 cos_to_last_merge=1.0000 (last merge round=21)
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.5820125766563926, 'auprc': 0.6448754035484581, 'loss_val': 0.7065866855453528, 'psi': 0.6071577074132188}-{'f1_val': 0.6080878856317762, 'auprc': 0.649863223767247, 'loss_val': 0.6583453323687904, 'psi': 0.6247980208859645}
[S14] START round=22 head_norm_before_train=1.161120 cos_to_last_merge=1.0000 (last merge round=21)
[S14] round=22 local utility u=0.331847 metrics={'f1_val': 0.9760151710563043, 'auprc': 0.9987332475390016, 'loss_val': 0.2507556171983603, 'psi': 0.9851024016493832}-{'f1_val': 0.8876097780695936, 'auprc': 0.9981682788508359, 'loss_val': 0.38232199660358657, 'psi': 0.9318331783820906}
[S15] START round=22 head_norm_before_train=1.305442 cos_to_last_merge=1.0000 (last merge round=21)
[S15] round=22 local utility u=0.000000 metrics={'f1_val': 0.9934185961837458, 'auprc': 0.9917618170076575, 'loss_val': 0.16926536388816485, 'psi': 0.9927558845133105}-{'f1_val': 0.9950341038182815, 'auprc': 0.9973956666066126, 'loss_val': 0.124748555827456, 'psi': 0.9959787289336139}
[S16] START round=22 head_norm_before_train=1.054991 cos_to_last_merge=1.0000 (last merge round=21)
[S16] round=22 local utility u=0.000000 metrics={'f1_val': 0.9416003732908188, 'auprc': 0.9891057885176745, 'loss_val': 0.3388068677012877, 'psi': 0.9606025393815611}-{'f1_val': 0.9866280213214069, 'auprc': 0.987465322167691, 'loss_val': 0.24415923902098116, 'psi': 0.9869629416599205}
[S17] START round=22 head_norm_before_train=1.314833 cos_to_last_merge=1.0000 (last merge round=21)
[S17] round=22 local utility u=0.000000 metrics={'f1_val': 0.4238557335792962, 'auprc': 0.7993878703889088, 'loss_val': 0.903727217876654, 'psi': 0.5740685883031412}-{'f1_val': 0.6461482032892373, 'auprc': 0.8039654203147935, 'loss_val': 0.5329501602853454, 'psi': 0.7092750900994598}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:45903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:45916
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.966)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:45916
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:45917
[S14] not sending this round → trigger blocked (psi=0.985)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1802) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.780359)
[S3] loaded HEAD from S8 (vec_in norm=1.780359)
[S3] cosine check vs S8: cos=0.9964
[S3] BUFFERED delta from S8 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1801) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.676646)
[S17] loaded HEAD from S6 (vec_in norm=1.676646)
[S17] cosine check vs S6: cos=-0.0468
[S17] DROPPED delta from S6 (cos=-0.0468 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1800) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.643857)
[S16] loaded HEAD from S5 (vec_in norm=1.643857)
[S16] cosine check vs S5: cos=0.2258
[S16] BUFFERED delta from S5 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1801) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.895695)
[S16] loaded HEAD from S9 (vec_in norm=1.895695)
[S16] cosine check vs S9: cos=0.6826
[S16] BUFFERED delta from S9 (total buffered=2)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=22 metric=0.7003 head_norm=1.782859
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.582005e-02
[S3] stored merged vector for next round verification (round=22)
[S3] DEBUG after merge:  round=22 metric=0.7003 head_norm=1.779995 delta_norm=0.075820
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=22 metric=0.9416 head_norm=1.104364
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.369058e-01
[S16] stored merged vector for next round verification (round=22)
[S16] DEBUG after merge:  round=22 metric=0.9383 head_norm=1.098993 delta_norm=0.536906
[S16] aggregate: ACCEPT kept=['S5', 'S9'] (k=2/2) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.267292 cos_to_last_merge=0.9991 (last merge round=21)
[S2] round=23 local utility u=0.180643 metrics={'f1_val': 0.7015710590385817, 'auprc': 0.6840886305888263, 'loss_val': 0.3616274740422452, 'psi': 0.6945780876586796}-{'f1_val': 0.6596151991434465, 'auprc': 0.6718855710486386, 'loss_val': 0.4345695071143227, 'psi': 0.6645233479055233}
[S3] START round=23 head_norm_before_train=1.779995 cos_to_last_merge=1.0000 (last merge round=22)
[S3] round=23 local utility u=0.935198 metrics={'f1_val': 0.9978100342676263, 'auprc': 0.9997985001779277, 'loss_val': 0.13789930939561007, 'psi': 0.9986054206317468}-{'f1_val': 0.700330919019862, 'auprc': 0.9998925723668577, 'loss_val': 0.22370269624839562, 'psi': 0.8201555803586603}
[S4] START round=23 head_norm_before_train=1.679656 cos_to_last_merge=0.9976 (last merge round=20)
[S4] round=23 local utility u=0.000000 metrics={'f1_val': 0.9385634318469558, 'auprc': 0.9557105266084241, 'loss_val': 0.2899521002011998, 'psi': 0.9454222697515432}-{'f1_val': 0.9554585872012921, 'auprc': 0.9824378840229453, 'loss_val': 0.251433801800869, 'psi': 0.9662503059299533}
[S5] START round=23 head_norm_before_train=1.643857 (no previous merge yet)
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.6551610877860555, 'auprc': 0.7989232315103305, 'loss_val': 0.49216996284958864, 'psi': 0.7126659452757655}-{'f1_val': 0.7006083926626743, 'auprc': 0.9920287852218787, 'loss_val': 0.27435753179523953, 'psi': 0.8171765496863561}
[S6] START round=23 head_norm_before_train=1.676646 cos_to_last_merge=0.8209 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.821
[S6] round=23 local utility u=0.629357 metrics={'f1_val': 0.9178524461152208, 'auprc': 0.9418972511991306, 'loss_val': 0.20712897869272226, 'psi': 0.9274703681487848}-{'f1_val': 0.787767909156458, 'auprc': 0.8965583731541713, 'loss_val': 0.5493183035997912, 'psi': 0.8312840947555433}
[S7] START round=23 head_norm_before_train=1.580563 (no previous merge yet)
[S7] round=23 local utility u=0.915062 metrics={'f1_val': 0.623925086485071, 'auprc': 0.803034346463039, 'loss_val': 0.6110473077010293, 'psi': 0.6955687904762582}-{'f1_val': 0.4087290166390023, 'auprc': 0.7797803914072903, 'loss_val': 1.0802339589318426, 'psi': 0.5571495665463175}
[S8] START round=23 head_norm_before_train=1.780359 cos_to_last_merge=0.7749 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.775
[S8] round=23 local utility u=0.000000 metrics={'f1_val': 0.9918109678295097, 'auprc': 0.9986444487176378, 'loss_val': 0.03982831870257895, 'psi': 0.994544360184761}-{'f1_val': 0.9933016371923923, 'auprc': 0.9957419305530195, 'loss_val': 0.0368364395813259, 'psi': 0.9942777545366432}
[S9] START round=23 head_norm_before_train=1.895695 (no previous merge yet)
[S9] round=23 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9969952196647646, 'loss_val': 0.030640523789375908, 'psi': 0.9967943949542407}-{'f1_val': 0.9959957888192151, 'auprc': 0.9995486779616312, 'loss_val': 0.0325331465141462, 'psi': 0.9974169444761816}
[S10] START round=23 head_norm_before_train=1.788521 cos_to_last_merge=0.7619 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.762
[S10] round=23 local utility u=0.003550 metrics={'f1_val': 0.9953063309450747, 'auprc': 0.9964163643511976, 'loss_val': 0.03367845633958691, 'psi': 0.995750344307524}-{'f1_val': 0.9947486092193725, 'auprc': 0.9955651436323986, 'loss_val': 0.03487862023759985, 'psi': 0.995075222984583}
[S11] START round=23 head_norm_before_train=1.242406 cos_to_last_merge=0.9995 (last merge round=21)
[S11] round=23 local utility u=0.016144 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.996395866143708, 'loss_val': 0.3110969820151161, 'psi': 0.8197195364364753}-{'f1_val': 0.7016934795869249, 'auprc': 0.9965854829548797, 'loss_val': 0.3425023513474787, 'psi': 0.8196502809341069}
[S13] START round=23 head_norm_before_train=1.256980 cos_to_last_merge=0.9993 (last merge round=21)
[S13] round=23 local utility u=0.000000 metrics={'f1_val': 0.565029221763469, 'auprc': 0.6858215338113978, 'loss_val': 0.7384072979736209, 'psi': 0.6133461465826405}-{'f1_val': 0.5820125766563926, 'auprc': 0.6448754035484581, 'loss_val': 0.7065866855453528, 'psi': 0.6071577074132188}
[S14] START round=23 head_norm_before_train=1.214246 cos_to_last_merge=0.9983 (last merge round=21)
[S14] round=23 local utility u=0.000000 metrics={'f1_val': 0.9415215459007102, 'auprc': 0.9986881826655954, 'loss_val': 0.25318410630361854, 'psi': 0.9643882006066643}-{'f1_val': 0.9760151710563043, 'auprc': 0.9987332475390016, 'loss_val': 0.2507556171983603, 'psi': 0.9851024016493832}
[S15] START round=23 head_norm_before_train=1.342434 cos_to_last_merge=0.9990 (last merge round=21)
[S15] round=23 local utility u=0.000000 metrics={'f1_val': 0.7453587482741867, 'auprc': 0.8172068944102985, 'loss_val': 0.36913564004287036, 'psi': 0.7740980067286314}-{'f1_val': 0.9934185961837458, 'auprc': 0.9917618170076575, 'loss_val': 0.16926536388816485, 'psi': 0.9927558845133105}
[S16] START round=23 head_norm_before_train=1.098993 cos_to_last_merge=1.0000 (last merge round=22)
[S16] round=23 local utility u=0.183692 metrics={'f1_val': 0.9842502552097921, 'auprc': 0.9891278857715692, 'loss_val': 0.227388023856947, 'psi': 0.9862013074345028}-{'f1_val': 0.9416003732908188, 'auprc': 0.9891057885176745, 'loss_val': 0.3388068677012877, 'psi': 0.9606025393815611}
[S17] START round=23 head_norm_before_train=1.342224 cos_to_last_merge=0.9984 (last merge round=21)
[S17] round=23 local utility u=1.000000 metrics={'f1_val': 0.6400228934256642, 'auprc': 0.9054323256064916, 'loss_val': 0.5044610450537207, 'psi': 0.7461866662979952}-{'f1_val': 0.4238557335792962, 'auprc': 0.7993878703889088, 'loss_val': 0.903727217876654, 'psi': 0.5740685883031412}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:45915
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:45917
[S6] not sending this round → trigger blocked (psi=0.927)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:45909
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:45904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:45917
[S7] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S10
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.808923)
[S8] loaded HEAD from S10 (vec_in norm=1.808923)
[S8] cosine check vs S10: cos=-0.0751
[S8] DROPPED delta from S10 (cos=-0.0751 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1804) from S3
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.794952)
[S17] loaded HEAD from S3 (vec_in norm=1.794952)
[S17] cosine check vs S3: cos=0.9225
[S17] BUFFERED delta from S3 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1800) from S7
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.587957)
[S4] loaded HEAD from S7 (vec_in norm=1.587957)
[S4] cosine check vs S7: cos=0.9792
[S4] BUFFERED delta from S7 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1800) from S2
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.302846)
[S17] loaded HEAD from S2 (vec_in norm=1.302846)
[S17] cosine check vs S2: cos=0.4621
[S17] BUFFERED delta from S2 (total buffered=2)
[S16] RECEIVED delta(kind=head bytes=1801) from S11
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.272201)
[S16] loaded HEAD from S11 (vec_in norm=1.272201)
[S16] cosine check vs S11: cos=0.4685
[S16] BUFFERED delta from S11 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:45914
[S17] sending update (kind=head size=1804 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1804) from S17
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.376850)
[S14] loaded HEAD from S17 (vec_in norm=1.376850)
[S14] cosine check vs S17: cos=0.7985
[S14] BUFFERED delta from S17 (total buffered=1)
[S16] sending update (kind=head size=1799 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1799) from S16
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.155937)
[S15] loaded HEAD from S16 (vec_in norm=1.155937)
[S15] cosine check vs S16: cos=0.9580
[S15] BUFFERED delta from S16 (total buffered=1)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=23 metric=0.9386 head_norm=1.700089
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.765695e-01
[S4] stored merged vector for next round verification (round=23)
[S4] DEBUG after merge:  round=23 metric=0.9384 head_norm=1.635475 delta_norm=0.176570
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=23 metric=0.9843 head_norm=1.155937
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.278560e-01
[S16] stored merged vector for next round verification (round=23)
[S16] DEBUG after merge:  round=23 metric=0.9864 head_norm=1.040740 delta_norm=0.627856
[S16] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=23 metric=0.7454 head_norm=1.393004
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.187559e-01
[S15] stored merged vector for next round verification (round=23)
[S15] DEBUG after merge:  round=23 metric=0.7572 head_norm=1.261139 delta_norm=0.218756
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=23 metric=0.9415 head_norm=1.267282
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.228676e-01
[S14] stored merged vector for next round verification (round=23)
[S14] DEBUG after merge:  round=23 metric=0.9057 head_norm=1.253812 delta_norm=0.422868
[S14] aggregate: ROLLBACK (f1_val pre=0.942 post=0.906 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=23 metric=0.6400 head_norm=1.376850
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.107944e-01
[S17] stored merged vector for next round verification (round=23)
[S17] DEBUG after merge:  round=23 metric=0.6323 head_norm=1.264449 delta_norm=0.210794
[S17] aggregate: ROLLBACK (f1_val pre=0.640 post=0.632 tol_abs=0.005 tol_rel=0.0)
[S2] START round=24 head_norm_before_train=1.302846 cos_to_last_merge=0.9960 (last merge round=21)
[S2] round=24 local utility u=0.020983 metrics={'f1_val': 0.7077003317166687, 'auprc': 0.6789620527805469, 'loss_val': 0.3410574069635629, 'psi': 0.69620502014222}-{'f1_val': 0.7015710590385817, 'auprc': 0.6840886305888263, 'loss_val': 0.3616274740422452, 'psi': 0.6945780876586796}
[S3] START round=24 head_norm_before_train=1.794952 cos_to_last_merge=0.9999 (last merge round=22)
[S3] round=24 local utility u=0.006483 metrics={'f1_val': 0.9979555869443051, 'auprc': 0.9998710231581828, 'loss_val': 0.12602421104335065, 'psi': 0.9987217614298561}-{'f1_val': 0.9978100342676263, 'auprc': 0.9997985001779277, 'loss_val': 0.13789930939561007, 'psi': 0.9986054206317468}
[S4] START round=24 head_norm_before_train=1.635475 cos_to_last_merge=1.0000 (last merge round=23)
[S4] round=24 local utility u=0.066067 metrics={'f1_val': 0.9467735065040405, 'auprc': 0.9755770681943772, 'loss_val': 0.2666775388737477, 'psi': 0.9582949311801752}-{'f1_val': 0.9385634318469558, 'auprc': 0.9557105266084241, 'loss_val': 0.2899521002011998, 'psi': 0.9454222697515432}
[S5] START round=24 head_norm_before_train=1.654274 (no previous merge yet)
[S5] round=24 local utility u=0.543586 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.9927535701701362, 'loss_val': 0.25917678354977564, 'psi': 0.8174668844715229}-{'f1_val': 0.6551610877860555, 'auprc': 0.7989232315103305, 'loss_val': 0.49216996284958864, 'psi': 0.7126659452757655}
[S6] START round=24 head_norm_before_train=1.694867 cos_to_last_merge=0.8191 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.819
[S6] round=24 local utility u=0.000000 metrics={'f1_val': 0.7606585974399623, 'auprc': 0.7894482905682116, 'loss_val': 0.6813865393737902, 'psi': 0.772174474691262}-{'f1_val': 0.9178524461152208, 'auprc': 0.9418972511991306, 'loss_val': 0.20712897869272226, 'psi': 0.9274703681487848}
[S7] START round=24 head_norm_before_train=1.587957 (no previous merge yet)
[S7] round=24 local utility u=0.000000 metrics={'f1_val': 0.47432221772339933, 'auprc': 0.7814132638865452, 'loss_val': 0.8853572857920315, 'psi': 0.5971586361886576}-{'f1_val': 0.623925086485071, 'auprc': 0.803034346463039, 'loss_val': 0.6110473077010293, 'psi': 0.6955687904762582}
[S8] START round=24 head_norm_before_train=1.794064 cos_to_last_merge=0.7733 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.773
[S8] round=24 local utility u=0.000000 metrics={'f1_val': 0.9927403794179317, 'auprc': 0.9860148116702657, 'loss_val': 0.03730605311304256, 'psi': 0.9900501523188653}-{'f1_val': 0.9918109678295097, 'auprc': 0.9986444487176378, 'loss_val': 0.03982831870257895, 'psi': 0.994544360184761}
[S9] START round=24 head_norm_before_train=1.914920 (no previous merge yet)
[S9] round=24 local utility u=0.000000 metrics={'f1_val': 0.9871446711497952, 'auprc': 0.99213618604396, 'loss_val': 0.055438171222816475, 'psi': 0.9891412771074611}-{'f1_val': 0.9966605118138915, 'auprc': 0.9969952196647646, 'loss_val': 0.030640523789375908, 'psi': 0.9967943949542407}
[S10] START round=24 head_norm_before_train=1.808923 cos_to_last_merge=0.7602 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.760
[S10] round=24 local utility u=0.000000 metrics={'f1_val': 0.9955259082574451, 'auprc': 0.9952262476801961, 'loss_val': 0.03187862401040778, 'psi': 0.9954060440265455}-{'f1_val': 0.9953063309450747, 'auprc': 0.9964163643511976, 'loss_val': 0.03367845633958691, 'psi': 0.995750344307524}
[S11] START round=24 head_norm_before_train=1.272201 cos_to_last_merge=0.9976 (last merge round=21)
[S11] round=24 local utility u=0.022244 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9979921185238504, 'loss_val': 0.2713982207863846, 'psi': 0.8203580373885322}-{'f1_val': 0.7019353166316534, 'auprc': 0.996395866143708, 'loss_val': 0.3110969820151161, 'psi': 0.8197195364364753}
[S13] START round=24 head_norm_before_train=1.293531 cos_to_last_merge=0.9971 (last merge round=21)
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.6221772214338999, 'auprc': 0.5581753181308097, 'loss_val': 0.8118551717347788, 'psi': 0.5965764601126637}-{'f1_val': 0.565029221763469, 'auprc': 0.6858215338113978, 'loss_val': 0.7384072979736209, 'psi': 0.6133461465826405}
[S14] START round=24 head_norm_before_train=1.253812 cos_to_last_merge=1.0000 (last merge round=23)
[S14] round=24 local utility u=0.000000 metrics={'f1_val': 0.9298231929280758, 'auprc': 0.9980970722825141, 'loss_val': 0.2907785330841965, 'psi': 0.9571327446698511}-{'f1_val': 0.9415215459007102, 'auprc': 0.9986881826655954, 'loss_val': 0.25318410630361854, 'psi': 0.9643882006066643}
[S15] START round=24 head_norm_before_train=1.261139 cos_to_last_merge=1.0000 (last merge round=23)
[S15] round=24 local utility u=1.000000 metrics={'f1_val': 0.9721980816024138, 'auprc': 0.9889577893436732, 'loss_val': 0.18073448930265615, 'psi': 0.9789019646989175}-{'f1_val': 0.7453587482741867, 'auprc': 0.8172068944102985, 'loss_val': 0.36913564004287036, 'psi': 0.7740980067286314}
[S16] START round=24 head_norm_before_train=1.040740 cos_to_last_merge=1.0000 (last merge round=23)
[S16] round=24 local utility u=0.000000 metrics={'f1_val': 0.8498399068098843, 'auprc': 0.9916062343595335, 'loss_val': 0.5177261576663554, 'psi': 0.906546437829744}-{'f1_val': 0.9842502552097921, 'auprc': 0.9891278857715692, 'loss_val': 0.227388023856947, 'psi': 0.9862013074345028}
[S17] START round=24 head_norm_before_train=1.264449 cos_to_last_merge=1.0000 (last merge round=23)
[S17] round=24 local utility u=0.000000 metrics={'f1_val': 0.4625420026612379, 'auprc': 0.9561524732496326, 'loss_val': 0.6971608145073791, 'psi': 0.6599861908965958}-{'f1_val': 0.6400228934256642, 'auprc': 0.9054323256064916, 'loss_val': 0.5044610450537207, 'psi': 0.7461866662979952}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S13@127.0.0.1:45913
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:45909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:45914
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:45916
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:45908
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1804 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S3
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.812951)
[S8] loaded HEAD from S3 (vec_in norm=1.812951)
[S8] cosine check vs S3: cos=0.9976
[S8] BUFFERED delta from S3 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1797) from S4
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.656685)
[S7] loaded HEAD from S4 (vec_in norm=1.656685)
[S7] cosine check vs S4: cos=0.9918
[S7] BUFFERED delta from S4 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1801) from S11
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.304054)
[S14] loaded HEAD from S11 (vec_in norm=1.304054)
[S14] cosine check vs S11: cos=0.9297
[S14] BUFFERED delta from S11 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1804) from S2
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.339260)
[S13] loaded HEAD from S2 (vec_in norm=1.339260)
[S13] cosine check vs S2: cos=0.9313
[S13] BUFFERED delta from S2 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1805 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1805) from S15
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.322368)
[S16] loaded HEAD from S15 (vec_in norm=1.322368)
[S16] cosine check vs S15: cos=0.8298
[S16] BUFFERED delta from S15 (total buffered=1)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=24 metric=0.4743 head_norm=1.594538
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.086101e-01
[S7] stored merged vector for next round verification (round=24)
[S7] DEBUG after merge:  round=24 metric=0.4852 head_norm=1.622277 delta_norm=0.108610
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=24 metric=0.9927 head_norm=1.806767
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.259569e-02
[S8] stored merged vector for next round verification (round=24)
[S8] DEBUG after merge:  round=24 metric=0.9927 head_norm=1.808779 delta_norm=0.062596
[S8] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=24 metric=0.6222 head_norm=1.325673
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.470641e-01
[S13] stored merged vector for next round verification (round=24)
[S13] DEBUG after merge:  round=24 metric=0.6228 head_norm=1.309379 delta_norm=0.247064
[S13] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=24 metric=0.9298 head_norm=1.297226
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.439476e-01
[S14] stored merged vector for next round verification (round=24)
[S14] DEBUG after merge:  round=24 metric=0.9369 head_norm=1.277562 delta_norm=0.243948
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=24 metric=0.8498 head_norm=1.094890
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.689758e-01
[S16] stored merged vector for next round verification (round=24)
[S16] DEBUG after merge:  round=24 metric=0.8483 head_norm=1.156537 delta_norm=0.368976
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.339260 cos_to_last_merge=0.9919 (last merge round=21)
[S2] round=25 local utility u=0.060720 metrics={'f1_val': 0.7081867605552653, 'auprc': 0.7231128748840393, 'loss_val': 0.35498853231519734, 'psi': 0.7141572062867749}-{'f1_val': 0.7077003317166687, 'auprc': 0.6789620527805469, 'loss_val': 0.3410574069635629, 'psi': 0.69620502014222}
[S3] START round=25 head_norm_before_train=1.812951 cos_to_last_merge=0.9996 (last merge round=22)
[S3] round=25 local utility u=0.000000 metrics={'f1_val': 0.8617570007861942, 'auprc': 0.9997702782152704, 'loss_val': 0.19612189079277315, 'psi': 0.9169623117578247}-{'f1_val': 0.9979555869443051, 'auprc': 0.9998710231581828, 'loss_val': 0.12602421104335065, 'psi': 0.9987217614298561}
[S4] START round=25 head_norm_before_train=1.656685 cos_to_last_merge=0.9997 (last merge round=23)
[S4] round=25 local utility u=0.012229 metrics={'f1_val': 0.9525847149052691, 'auprc': 0.9703381115998682, 'loss_val': 0.26137010506647623, 'psi': 0.9596860735831088}-{'f1_val': 0.9467735065040405, 'auprc': 0.9755770681943772, 'loss_val': 0.2666775388737477, 'psi': 0.9582949311801752}
[S5] START round=25 head_norm_before_train=1.664304 (no previous merge yet)
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.6603388720550072, 'auprc': 0.8404104290547876, 'loss_val': 0.3933646898204315, 'psi': 0.7323674948549193}-{'f1_val': 0.7006090940057808, 'auprc': 0.9927535701701362, 'loss_val': 0.25917678354977564, 'psi': 0.8174668844715229}
[S6] START round=25 head_norm_before_train=1.717489 cos_to_last_merge=0.8163 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.816
[S6] round=25 local utility u=0.646188 metrics={'f1_val': 0.8409063359876942, 'auprc': 0.9348377153404492, 'loss_val': 0.30666498893794475, 'psi': 0.8784788877287961}-{'f1_val': 0.7606585974399623, 'auprc': 0.7894482905682116, 'loss_val': 0.6813865393737902, 'psi': 0.772174474691262}
[S7] START round=25 head_norm_before_train=1.622277 cos_to_last_merge=1.0000 (last merge round=24)
[S7] round=25 local utility u=0.509731 metrics={'f1_val': 0.6040234260507433, 'auprc': 0.790488556468822, 'loss_val': 0.6713281462679266, 'psi': 0.6786094782179748}-{'f1_val': 0.47432221772339933, 'auprc': 0.7814132638865452, 'loss_val': 0.8853572857920315, 'psi': 0.5971586361886576}
[S8] START round=25 head_norm_before_train=1.808779 cos_to_last_merge=1.0000 (last merge round=24)
[S8] round=25 local utility u=0.001221 metrics={'f1_val': 0.9928938724649488, 'auprc': 0.9861912517998124, 'loss_val': 0.03631447867681965, 'psi': 0.9902128241988941}-{'f1_val': 0.9927403794179317, 'auprc': 0.9860148116702657, 'loss_val': 0.03730605311304256, 'psi': 0.9900501523188653}
[S9] START round=25 head_norm_before_train=1.932417 (no previous merge yet)
[S9] round=25 local utility u=0.049047 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9954892992669166, 'loss_val': 0.02715269501284402, 'psi': 0.9964574672140524}-{'f1_val': 0.9871446711497952, 'auprc': 0.99213618604396, 'loss_val': 0.055438171222816475, 'psi': 0.9891412771074611}
[S10] START round=25 head_norm_before_train=1.829126 cos_to_last_merge=0.7582 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.758
[S10] round=25 local utility u=0.000000 metrics={'f1_val': 0.9944287677762472, 'auprc': 0.996263568193046, 'loss_val': 0.033269974050545534, 'psi': 0.9951626879429667}-{'f1_val': 0.9955259082574451, 'auprc': 0.9952262476801961, 'loss_val': 0.03187862401040778, 'psi': 0.9954060440265455}
[S11] START round=25 head_norm_before_train=1.304054 cos_to_last_merge=0.9948 (last merge round=21)
[S11] round=25 local utility u=0.009956 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9973003385845891, 'loss_val': 0.2494100821132208, 'psi': 0.8200813254128276}-{'f1_val': 0.7019353166316534, 'auprc': 0.9979921185238504, 'loss_val': 0.2713982207863846, 'psi': 0.8203580373885322}
[S13] START round=25 head_norm_before_train=1.309379 cos_to_last_merge=1.0000 (last merge round=24)
[S13] round=25 local utility u=0.228096 metrics={'f1_val': 0.5754662435920206, 'auprc': 0.7433518740699359, 'loss_val': 0.6309274134031283, 'psi': 0.6426204957831867}-{'f1_val': 0.6221772214338999, 'auprc': 0.5581753181308097, 'loss_val': 0.8118551717347788, 'psi': 0.5965764601126637}
[S14] START round=25 head_norm_before_train=1.277562 cos_to_last_merge=1.0000 (last merge round=24)
[S14] round=25 local utility u=0.077516 metrics={'f1_val': 0.9369664113752207, 'auprc': 0.9986614504797185, 'loss_val': 0.18029803007427175, 'psi': 0.9616444270170199}-{'f1_val': 0.9298231929280758, 'auprc': 0.9980970722825141, 'loss_val': 0.2907785330841965, 'psi': 0.9571327446698511}
[S15] START round=25 head_norm_before_train=1.322368 cos_to_last_merge=0.9981 (last merge round=23)
[S15] round=25 local utility u=0.125608 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9952964141574117, 'loss_val': 0.0958268004602271, 'psi': 0.996166566695477}-{'f1_val': 0.9721980816024138, 'auprc': 0.9889577893436732, 'loss_val': 0.18073448930265615, 'psi': 0.9789019646989175}
[S16] START round=25 head_norm_before_train=1.156537 cos_to_last_merge=1.0000 (last merge round=24)
[S16] round=25 local utility u=0.273554 metrics={'f1_val': 0.9148127367073233, 'auprc': 0.9900651378082387, 'loss_val': 0.355832235969342, 'psi': 0.9449136971476895}-{'f1_val': 0.8498399068098843, 'auprc': 0.9916062343595335, 'loss_val': 0.5177261576663554, 'psi': 0.906546437829744}
[S17] START round=25 head_norm_before_train=1.292802 cos_to_last_merge=0.9983 (last merge round=23)
[S17] round=25 local utility u=0.000000 metrics={'f1_val': 0.4333759031550196, 'auprc': 0.8399645379945317, 'loss_val': 0.8447095566105328, 'psi': 0.5960113570908245}-{'f1_val': 0.4625420026612379, 'auprc': 0.9561524732496326, 'loss_val': 0.6971608145073791, 'psi': 0.6599861908965958}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:45914
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1811 reason=None
[S14] → sending delta(kind=head bytes=1811) to S17@127.0.0.1:45917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:45915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S2] → sending delta(kind=head bytes=1807) to S13@127.0.0.1:45913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] → sending delta(kind=head bytes=1806) to S10@127.0.0.1:45911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:45916
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] sending update (kind=head size=1805 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:45908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:45910
[S8] sending update (kind=head size=1806 to 1 peers)
[S2] sending update (kind=head size=1807 to 1 peers)
[S14] sending update (kind=head size=1811 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1807) from S2
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.377058)
[S13] loaded HEAD from S2 (vec_in norm=1.377058)
[S13] cosine check vs S2: cos=0.9771
[S13] BUFFERED delta from S2 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1800) from S11
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.335747)
[S14] loaded HEAD from S11 (vec_in norm=1.335747)
[S14] cosine check vs S11: cos=0.9797
[S14] BUFFERED delta from S11 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1798) from S16
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.215352)
[S9] loaded HEAD from S16 (vec_in norm=1.215352)
[S9] cosine check vs S16: cos=0.7439
[S9] BUFFERED delta from S16 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1811) from S14
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.321759)
[S17] loaded HEAD from S14 (vec_in norm=1.321759)
[S17] cosine check vs S14: cos=0.8912
[S17] BUFFERED delta from S14 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1800) from S4
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.686424)
[S7] loaded HEAD from S4 (vec_in norm=1.686424)
[S7] cosine check vs S4: cos=0.9959
[S7] BUFFERED delta from S4 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1806) from S8
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.820138)
[S10] loaded HEAD from S8 (vec_in norm=1.820138)
[S10] cosine check vs S8: cos=-0.0708
[S10] DROPPED delta from S8 (cos=-0.0708 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1802) from S15
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.386644)
[S16] loaded HEAD from S15 (vec_in norm=1.386644)
[S16] cosine check vs S15: cos=0.9620
[S16] BUFFERED delta from S15 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1800) from S13
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.322086)
[S15] loaded HEAD from S13 (vec_in norm=1.322086)
[S15] cosine check vs S13: cos=0.8498
[S15] BUFFERED delta from S13 (total buffered=1)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=25 metric=0.6040 head_norm=1.634127
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.941750e-02
[S7] stored merged vector for next round verification (round=25)
[S7] DEBUG after merge:  round=25 metric=0.6068 head_norm=1.658581 delta_norm=0.079418
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=25 metric=0.9971 head_norm=1.948640
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.615683e-01
[S9] stored merged vector for next round verification (round=25)
[S9] DEBUG after merge:  round=25 metric=0.9971 head_norm=1.483060 delta_norm=0.661568
[S9] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.268 → S8@127.0.0.1:45909
[S2] ⇄ pheromone p=0.141 → S13@127.0.0.1:45913
[S4] ⇄ pheromone p=0.044 → S7@127.0.0.1:45908
[S8] ⇄ pheromone p=0.030 → S10@127.0.0.1:45911
[S10] ⇄ pheromone p=0.023 → S8@127.0.0.1:45909
[S11] ⇄ pheromone p=0.041 → S14@127.0.0.1:45914
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=25 metric=0.9370 head_norm=1.321759
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.341214e-01
[S14] stored merged vector for next round verification (round=25)
[S14] DEBUG after merge:  round=25 metric=0.9326 head_norm=1.321985 delta_norm=0.134121
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.127 → S17@127.0.0.1:45917
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=25 metric=0.5755 head_norm=1.322086
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.468588e-01
[S13] stored merged vector for next round verification (round=25)
[S13] DEBUG after merge:  round=25 metric=0.6179 head_norm=1.341840 delta_norm=0.146859
[S13] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.081 → S15@127.0.0.1:45915
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=25 metric=0.9148 head_norm=1.215352
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.984727e-01
[S16] stored merged vector for next round verification (round=25)
[S16] DEBUG after merge:  round=25 metric=0.9113 head_norm=1.288619 delta_norm=0.198473
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.197 → S9@127.0.0.1:45910
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=25 metric=0.9967 head_norm=1.386644
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.724976e-01
[S15] stored merged vector for next round verification (round=25)
[S15] DEBUG after merge:  round=25 metric=0.9967 head_norm=1.302533 delta_norm=0.372498
[S15] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.320 → S16@127.0.0.1:45916
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=25 metric=0.4334 head_norm=1.323817
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.085174e-01
[S17] stored merged vector for next round verification (round=25)
[S17] DEBUG after merge:  round=25 metric=0.4312 head_norm=1.286307 delta_norm=0.308517
[S17] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.304 → S6@127.0.0.1:45907
[S2] START round=26 head_norm_before_train=1.377058 cos_to_last_merge=0.9877 (last merge round=21)
[S2] round=26 local utility u=0.068035 metrics={'f1_val': 0.6985308185904117, 'auprc': 0.7963646718459301, 'loss_val': 0.380738178493774, 'psi': 0.737664359892619}-{'f1_val': 0.7081867605552653, 'auprc': 0.7231128748840393, 'loss_val': 0.35498853231519734, 'psi': 0.7141572062867749}
[S3] START round=26 head_norm_before_train=1.832056 cos_to_last_merge=0.9990 (last merge round=22)
[S3] round=26 local utility u=0.418459 metrics={'f1_val': 0.9887090621182798, 'auprc': 0.9999901587816172, 'loss_val': 0.12157661364598941, 'psi': 0.9932215007836148}-{'f1_val': 0.8617570007861942, 'auprc': 0.9997702782152704, 'loss_val': 0.19612189079277315, 'psi': 0.9169623117578247}
[S4] START round=26 head_norm_before_train=1.686424 cos_to_last_merge=0.9988 (last merge round=23)
[S4] round=26 local utility u=0.000000 metrics={'f1_val': 0.9277016915093264, 'auprc': 0.9654578723332197, 'loss_val': 0.33722523990984676, 'psi': 0.9428041638388837}-{'f1_val': 0.9525847149052691, 'auprc': 0.9703381115998682, 'loss_val': 0.26137010506647623, 'psi': 0.9596860735831088}
[S5] START round=26 head_norm_before_train=1.674090 (no previous merge yet)
[S5] round=26 local utility u=0.431093 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9952398214486309, 'loss_val': 0.23728329968566775, 'psi': 0.8184609641770569}-{'f1_val': 0.6603388720550072, 'auprc': 0.8404104290547876, 'loss_val': 0.3933646898204315, 'psi': 0.7323674948549193}
[S6] START round=26 head_norm_before_train=1.732526 cos_to_last_merge=0.8148 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.815
[S6] round=26 local utility u=0.517457 metrics={'f1_val': 0.9573638742289498, 'auprc': 0.9870302654987504, 'loss_val': 0.1270736879180269, 'psi': 0.96923043073687}-{'f1_val': 0.8409063359876942, 'auprc': 0.9348377153404492, 'loss_val': 0.30666498893794475, 'psi': 0.8784788877287961}
[S7] START round=26 head_norm_before_train=1.658581 cos_to_last_merge=1.0000 (last merge round=25)
[S7] round=26 local utility u=0.384650 metrics={'f1_val': 0.6672046360924141, 'auprc': 0.836721906475773, 'loss_val': 0.41981465195428536, 'psi': 0.7350115442457577}-{'f1_val': 0.6040234260507433, 'auprc': 0.790488556468822, 'loss_val': 0.6713281462679266, 'psi': 0.6786094782179748}
[S8] START round=26 head_norm_before_train=1.820138 cos_to_last_merge=1.0000 (last merge round=24)
[S8] round=26 local utility u=0.013813 metrics={'f1_val': 0.9918109678295097, 'auprc': 0.9986539498414042, 'loss_val': 0.0395788607911341, 'psi': 0.9945481606342675}-{'f1_val': 0.9928938724649488, 'auprc': 0.9861912517998124, 'loss_val': 0.03631447867681965, 'psi': 0.9902128241988941}
[S9] START round=26 head_norm_before_train=1.483060 cos_to_last_merge=1.0000 (last merge round=25)
[S9] round=26 local utility u=0.000000 metrics={'f1_val': 0.994356655862817, 'auprc': 0.999527624777778, 'loss_val': 0.06080688068030419, 'psi': 0.9964250434288013}-{'f1_val': 0.9971029125121428, 'auprc': 0.9954892992669166, 'loss_val': 0.02715269501284402, 'psi': 0.9964574672140524}
[S10] START round=26 head_norm_before_train=1.847353 cos_to_last_merge=0.7564 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.756
[S10] round=26 local utility u=0.000000 metrics={'f1_val': 0.9944043122373717, 'auprc': 0.9963408923262379, 'loss_val': 0.03482775168406103, 'psi': 0.9951789442729182}-{'f1_val': 0.9944287677762472, 'auprc': 0.996263568193046, 'loss_val': 0.033269974050545534, 'psi': 0.9951626879429667}
[S11] START round=26 head_norm_before_train=1.335747 cos_to_last_merge=0.9915 (last merge round=21)
[S11] round=26 local utility u=0.743755 metrics={'f1_val': 0.9478088063523542, 'auprc': 0.9979662775011953, 'loss_val': 0.2391393043327182, 'psi': 0.9678717948118907}-{'f1_val': 0.7019353166316534, 'auprc': 0.9973003385845891, 'loss_val': 0.2494100821132208, 'psi': 0.8200813254128276}
[S13] START round=26 head_norm_before_train=1.341840 cos_to_last_merge=1.0000 (last merge round=25)
[S13] round=26 local utility u=0.134648 metrics={'f1_val': 0.627786605678343, 'auprc': 0.7060348341957987, 'loss_val': 0.5636017352680032, 'psi': 0.6590858970853253}-{'f1_val': 0.5754662435920206, 'auprc': 0.7433518740699359, 'loss_val': 0.6309274134031283, 'psi': 0.6426204957831867}
[S14] START round=26 head_norm_before_train=1.321985 cos_to_last_merge=1.0000 (last merge round=25)
[S14] round=26 local utility u=0.000000 metrics={'f1_val': 0.8872361253099927, 'auprc': 0.9611059325729284, 'loss_val': 0.5097943927023911, 'psi': 0.916784048215167}-{'f1_val': 0.9369664113752207, 'auprc': 0.9986614504797185, 'loss_val': 0.18029803007427175, 'psi': 0.9616444270170199}
[S15] START round=26 head_norm_before_train=1.302533 cos_to_last_merge=1.0000 (last merge round=25)
[S15] round=26 local utility u=0.000000 metrics={'f1_val': 0.9238681132553137, 'auprc': 0.9895248761658129, 'loss_val': 0.1321966347965265, 'psi': 0.9501308184195134}-{'f1_val': 0.9967466683875206, 'auprc': 0.9952964141574117, 'loss_val': 0.0958268004602271, 'psi': 0.996166566695477}
[S16] START round=26 head_norm_before_train=1.288619 cos_to_last_merge=1.0000 (last merge round=25)
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.8731745914027003, 'auprc': 0.9887713551592855, 'loss_val': 0.3150897536455416, 'psi': 0.9194132969053344}-{'f1_val': 0.9148127367073233, 'auprc': 0.9900651378082387, 'loss_val': 0.355832235969342, 'psi': 0.9449136971476895}
[S17] START round=26 head_norm_before_train=1.286307 cos_to_last_merge=1.0000 (last merge round=25)
[S17] round=26 local utility u=1.000000 metrics={'f1_val': 0.8942478514614044, 'auprc': 0.9156078755059717, 'loss_val': 0.3934105610710065, 'psi': 0.9027918610792314}-{'f1_val': 0.4333759031550196, 'auprc': 0.8399645379945317, 'loss_val': 0.8447095566105328, 'psi': 0.5960113570908245}
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S14
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S16
[S13]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:45909
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:45903
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:45914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:45904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:45913
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:45915
[S13] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1804 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1801) from S13
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.353257)
[S15] loaded HEAD from S13 (vec_in norm=1.353257)
[S15] cosine check vs S13: cos=0.9339
[S15] BUFFERED delta from S13 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1802) from S2
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.413874)
[S13] loaded HEAD from S2 (vec_in norm=1.413874)
[S13] cosine check vs S2: cos=0.9921
[S13] BUFFERED delta from S2 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1803) from S3
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.850479)
[S8] loaded HEAD from S3 (vec_in norm=1.850479)
[S8] cosine check vs S3: cos=0.9981
[S8] BUFFERED delta from S3 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1804) from S11
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.364376)
[S14] loaded HEAD from S11 (vec_in norm=1.364376)
[S14] cosine check vs S11: cos=0.9922
[S14] BUFFERED delta from S11 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1801) from S7
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.668986)
[S4] loaded HEAD from S7 (vec_in norm=1.668986)
[S4] cosine check vs S7: cos=0.9977
[S4] BUFFERED delta from S7 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1799) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.832832)
[S3] loaded HEAD from S8 (vec_in norm=1.832832)
[S3] cosine check vs S8: cos=0.9981
[S3] BUFFERED delta from S8 (total buffered=1)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=26 metric=0.9887 head_norm=1.850479
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.740804e-02
[S3] stored merged vector for next round verification (round=26)
[S3] DEBUG after merge:  round=26 metric=0.9887 head_norm=1.840782 delta_norm=0.057408
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=26 metric=0.9918 head_norm=1.832832
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.740805e-02
[S8] stored merged vector for next round verification (round=26)
[S8] DEBUG after merge:  round=26 metric=0.9918 head_norm=1.840782 delta_norm=0.057408
[S8] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=26 metric=0.6278 head_norm=1.353257
[S13] _apply_head_vector_avg (torch): Δ‖w‖=9.200024e-02
[S13] stored merged vector for next round verification (round=26)
[S13] DEBUG after merge:  round=26 metric=0.6315 head_norm=1.380836 delta_norm=0.092000
[S13] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:45917
[S6] sending update (kind=head size=1799 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1799) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.744525)
[S17] loaded HEAD from S6 (vec_in norm=1.744525)
[S17] cosine check vs S6: cos=-0.0523
[S17] DROPPED delta from S6 (cos=-0.0523 < 0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=26 metric=0.9239 head_norm=1.357758
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.464258e-01
[S15] stored merged vector for next round verification (round=26)
[S15] DEBUG after merge:  round=26 metric=0.9191 head_norm=1.332922 delta_norm=0.246426
[S15] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] → sending delta(kind=head bytes=1806) to S6@127.0.0.1:45907
[S17] sending update (kind=head size=1806 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1806) from S17
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.314632)
[S6] loaded HEAD from S17 (vec_in norm=1.314632)
[S6] cosine check vs S17: cos=-0.0523
[S6] DROPPED delta from S17 (cos=-0.0523 < 0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=26 metric=0.8872 head_norm=1.361006
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.513346e-02
[S14] stored merged vector for next round verification (round=26)
[S14] DEBUG after merge:  round=26 metric=0.8868 head_norm=1.360030 delta_norm=0.085133
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S15
[S17]  timeout peer S16
[S15]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S10
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S17
[S2] START round=27 head_norm_before_train=1.413874 cos_to_last_merge=0.9839 (last merge round=21)
[S2] round=27 local utility u=0.000000 metrics={'f1_val': 0.6230701696844758, 'auprc': 0.7697876562042665, 'loss_val': 0.561581805031487, 'psi': 0.6817571642923921}-{'f1_val': 0.6985308185904117, 'auprc': 0.7963646718459301, 'loss_val': 0.380738178493774, 'psi': 0.737664359892619}
[S3] START round=27 head_norm_before_train=1.840782 cos_to_last_merge=1.0000 (last merge round=26)
[S3] round=27 local utility u=0.000000 metrics={'f1_val': 0.8655790396725075, 'auprc': 0.9999831941786599, 'loss_val': 0.2577526533881025, 'psi': 0.9193407014749685}-{'f1_val': 0.9887090621182798, 'auprc': 0.9999901587816172, 'loss_val': 0.12157661364598941, 'psi': 0.9932215007836148}
[S4] START round=27 head_norm_before_train=1.713120 cos_to_last_merge=0.9974 (last merge round=23)
[S4] round=27 local utility u=0.090465 metrics={'f1_val': 0.9417788697437893, 'auprc': 0.979437310770492, 'loss_val': 0.2826972678775366, 'psi': 0.9568422461544704}-{'f1_val': 0.9277016915093264, 'auprc': 0.9654578723332197, 'loss_val': 0.33722523990984676, 'psi': 0.9428041638388837}
[S5] START round=27 head_norm_before_train=1.681512 (no previous merge yet)
[S5] round=27 local utility u=0.000000 metrics={'f1_val': 0.41786857439360237, 'auprc': 0.764423389869188, 'loss_val': 1.4817531136286093, 'psi': 0.5564905005838366}-{'f1_val': 0.7006083926626743, 'auprc': 0.9952398214486309, 'loss_val': 0.23728329968566775, 'psi': 0.8184609641770569}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=27 head_norm_before_train=1.744525 cos_to_last_merge=0.8134 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.813
[S6] round=27 local utility u=0.000000 metrics={'f1_val': 0.6317597413056111, 'auprc': 0.7894964263250847, 'loss_val': 0.5956170201505888, 'psi': 0.6948544153134005}-{'f1_val': 0.9573638742289498, 'auprc': 0.9870302654987504, 'loss_val': 0.1270736879180269, 'psi': 0.96923043073687}
[S7] START round=27 head_norm_before_train=1.668986 cos_to_last_merge=1.0000 (last merge round=25)
[S7] round=27 local utility u=0.000000 metrics={'f1_val': 0.6301999582829605, 'auprc': 0.7952203411776557, 'loss_val': 0.5924087483826058, 'psi': 0.6962081114408386}-{'f1_val': 0.6672046360924141, 'auprc': 0.836721906475773, 'loss_val': 0.41981465195428536, 'psi': 0.7350115442457577}
[S8] START round=27 head_norm_before_train=1.840782 cos_to_last_merge=1.0000 (last merge round=26)
[S8] round=27 local utility u=0.002403 metrics={'f1_val': 0.9922069265978078, 'auprc': 0.9986386945134179, 'loss_val': 0.03710382212405653, 'psi': 0.9947796337640519}-{'f1_val': 0.9918109678295097, 'auprc': 0.9986539498414042, 'loss_val': 0.0395788607911341, 'psi': 0.9945481606342675}
[S9] START round=27 head_norm_before_train=1.508538 cos_to_last_merge=0.9999 (last merge round=25)
[S9] round=27 local utility u=0.000000 metrics={'f1_val': 0.9897381162675762, 'auprc': 0.9995309328990354, 'loss_val': 0.06054083875632044, 'psi': 0.9936552429201598}-{'f1_val': 0.994356655862817, 'auprc': 0.999527624777778, 'loss_val': 0.06080688068030419, 'psi': 0.9964250434288013}
[S10] START round=27 head_norm_before_train=1.862146 cos_to_last_merge=0.7550 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.755
[S10] round=27 local utility u=0.001172 metrics={'f1_val': 0.9944287677762472, 'auprc': 0.9962528905265364, 'loss_val': 0.03236726184329612, 'psi': 0.995158416876363}-{'f1_val': 0.9944043122373717, 'auprc': 0.9963408923262379, 'loss_val': 0.03482775168406103, 'psi': 0.9951789442729182}
[S11] START round=27 head_norm_before_train=1.364376 cos_to_last_merge=0.9880 (last merge round=21)
[S11] round=27 local utility u=0.170644 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9976669671159205, 'loss_val': 0.1893817441996367, 'psi': 0.9969949895545219}-{'f1_val': 0.9478088063523542, 'auprc': 0.9979662775011953, 'loss_val': 0.2391393043327182, 'psi': 0.9678717948118907}
[S13] START round=27 head_norm_before_train=1.380836 cos_to_last_merge=1.0000 (last merge round=26)
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.5955790081371486, 'auprc': 0.7431759561026886, 'loss_val': 0.7239259834637469, 'psi': 0.6546177873233646}-{'f1_val': 0.627786605678343, 'auprc': 0.7060348341957987, 'loss_val': 0.5636017352680032, 'psi': 0.6590858970853253}
[S14] START round=27 head_norm_before_train=1.360030 cos_to_last_merge=1.0000 (last merge round=26)
[S14] round=27 local utility u=0.053835 metrics={'f1_val': 0.8872361253099927, 'auprc': 0.980700442070118, 'loss_val': 0.4609070320606818, 'psi': 0.9246218520140428}-{'f1_val': 0.8872361253099927, 'auprc': 0.9611059325729284, 'loss_val': 0.5097943927023911, 'psi': 0.916784048215167}
[S15] START round=27 head_norm_before_train=1.332922 cos_to_last_merge=1.0000 (last merge round=26)
[S15] round=27 local utility u=0.000000 metrics={'f1_val': 0.7033095065017607, 'auprc': 0.9882085551115258, 'loss_val': 0.44833575511172974, 'psi': 0.8172691259456668}-{'f1_val': 0.9238681132553137, 'auprc': 0.9895248761658129, 'loss_val': 0.1321966347965265, 'psi': 0.9501308184195134}
[S16] START round=27 head_norm_before_train=1.336208 cos_to_last_merge=0.9995 (last merge round=25)
[S16] round=27 local utility u=0.448400 metrics={'f1_val': 0.9884203372132696, 'auprc': 0.9871881792179731, 'loss_val': 0.10501451273154533, 'psi': 0.987927474015151}-{'f1_val': 0.8731745914027003, 'auprc': 0.9887713551592855, 'loss_val': 0.3150897536455416, 'psi': 0.9194132969053344}
[S17] START round=27 head_norm_before_train=1.314632 cos_to_last_merge=0.9994 (last merge round=25)
[S17] round=27 local utility u=0.000000 metrics={'f1_val': 0.42131067659829097, 'auprc': 0.7756350376252938, 'loss_val': 0.936692339304981, 'psi': 0.5630404210090921}-{'f1_val': 0.8942478514614044, 'auprc': 0.9156078755059717, 'loss_val': 0.3934105610710065, 'psi': 0.9027918610792314}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:45914
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:45908
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:45909
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:45903
[S4] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1804 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] RECEIVED delta(kind=head bytes=1800) from S4
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.738426)
[S7] loaded HEAD from S4 (vec_in norm=1.738426)
[S7] cosine check vs S4: cos=0.9962
[S7] BUFFERED delta from S4 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1804) from S11
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.393507)
[S14] loaded HEAD from S11 (vec_in norm=1.393507)
[S14] cosine check vs S11: cos=0.9956
[S14] BUFFERED delta from S11 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1804) from S10
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.875626)
[S8] loaded HEAD from S10 (vec_in norm=1.875626)
[S8] cosine check vs S10: cos=-0.0703
[S8] DROPPED delta from S10 (cos=-0.0703 < 0.0)
[S8] sending update (kind=head size=1797 to 1 peers)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=27 metric=0.9418 head_norm=1.738426
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.055517e-02
[S4] stored merged vector for next round verification (round=27)
[S4] DEBUG after merge:  round=27 metric=0.9416 head_norm=1.702155 delta_norm=0.080555
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S3] RECEIVED delta(kind=head bytes=1797) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.853852)
[S3] loaded HEAD from S8 (vec_in norm=1.853852)
[S3] cosine check vs S8: cos=0.9999
[S3] BUFFERED delta from S8 (total buffered=1)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=27 metric=0.6302 head_norm=1.675178
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.045647e-02
[S7] stored merged vector for next round verification (round=27)
[S7] DEBUG after merge:  round=27 metric=0.6320 head_norm=1.705198 delta_norm=0.080456
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S14] → sending delta(kind=head bytes=1807) to S17@127.0.0.1:45917
[S14] sending update (kind=head size=1807 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1807) from S14
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.393739)
[S17] loaded HEAD from S14 (vec_in norm=1.393739)
[S17] cosine check vs S14: cos=0.9321
[S17] BUFFERED delta from S14 (total buffered=1)
[S17] RoundReady barrier timeout: have=2 need=3 — continuing
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] RoundReady barrier timeout: have=2 need=3 — continuing
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] → sending delta(kind=head bytes=1805) to S15@127.0.0.1:45915
[S16] sending update (kind=head size=1805 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1805) from S16
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.374547)
[S15] loaded HEAD from S16 (vec_in norm=1.374547)
[S15] cosine check vs S16: cos=0.8884
[S15] BUFFERED delta from S16 (total buffered=1)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=27 metric=0.8872 head_norm=1.393739
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.564053e-02
[S14] stored merged vector for next round verification (round=27)
[S14] DEBUG after merge:  round=27 metric=0.8872 head_norm=1.392076 delta_norm=0.065641
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S15]  timeout peer S16
[S2]  timeout peer S13
[S16]  timeout peer S5
[S16]  timeout peer S9
[S16]  timeout peer S11
[S14]  timeout peer S4
[S14]  timeout peer S17
[S3]  timeout peer S8
[S4]  timeout peer S7
[S13]  timeout peer S15
[S11]  timeout peer S14
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S6
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=27 metric=0.4213 head_norm=1.340358
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.532289e-01
[S17] stored merged vector for next round verification (round=27)
[S17] DEBUG after merge:  round=27 metric=0.4235 head_norm=1.343655 delta_norm=0.253229
[S17] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=1.440584 cos_to_last_merge=0.9811 (last merge round=21)
[S2] round=28 local utility u=0.398929 metrics={'f1_val': 0.7101074138302449, 'auprc': 0.797708132252332, 'loss_val': 0.3697078051275195, 'psi': 0.7451477011990797}-{'f1_val': 0.6230701696844758, 'auprc': 0.7697876562042665, 'loss_val': 0.561581805031487, 'psi': 0.6817571642923921}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=28 head_norm_before_train=1.855688 cos_to_last_merge=0.9999 (last merge round=26)
[S3] round=28 local utility u=0.355935 metrics={'f1_val': 0.9605746297510223, 'auprc': 0.9998213420309835, 'loss_val': 0.11536987779330458, 'psi': 0.9762733146630067}-{'f1_val': 0.8655790396725075, 'auprc': 0.9999831941786599, 'loss_val': 0.2577526533881025, 'psi': 0.9193407014749685}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] sending update (kind=head size=1804 to 1 peers)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=28 metric=0.9606 head_norm=1.871312
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.372934e-02
[S3] stored merged vector for next round verification (round=28)
[S3] DEBUG after merge:  round=28 metric=0.9606 head_norm=1.862451 delta_norm=0.023729
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S4] START round=28 head_norm_before_train=1.702155 cos_to_last_merge=1.0000 (last merge round=27)
[S4] round=28 local utility u=0.003663 metrics={'f1_val': 0.9431854800824924, 'auprc': 0.9764590663286923, 'loss_val': 0.27487609380515415, 'psi': 0.9564949145809724}-{'f1_val': 0.9417788697437893, 'auprc': 0.979437310770492, 'loss_val': 0.2826972678775366, 'psi': 0.9568422461544704}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=28 head_norm_before_train=1.686211 (no previous merge yet)
[S5] round=28 local utility u=1.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9975280751063911, 'loss_val': 0.21216895474085729, 'psi': 0.8192040205029048}-{'f1_val': 0.41786857439360237, 'auprc': 0.764423389869188, 'loss_val': 1.4817531136286093, 'psi': 0.5564905005838366}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=28 head_norm_before_train=1.761269 cos_to_last_merge=0.8109 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.811
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.649392283711194, 'auprc': 0.8090452863373278, 'loss_val': 0.9270448767647632, 'psi': 0.7132534847616474}-{'f1_val': 0.6317597413056111, 'auprc': 0.7894964263250847, 'loss_val': 0.5956170201505888, 'psi': 0.6948544153134005}
[S7] START round=28 head_norm_before_train=1.705198 cos_to_last_merge=1.0000 (last merge round=27)
[S7] round=28 local utility u=0.195946 metrics={'f1_val': 0.6604953785630076, 'auprc': 0.8206804366622507, 'loss_val': 0.45866879882411427, 'psi': 0.7245694018027048}-{'f1_val': 0.6301999582829605, 'auprc': 0.7952203411776557, 'loss_val': 0.5924087483826058, 'psi': 0.6962081114408386}
[S8] START round=28 head_norm_before_train=1.853852 cos_to_last_merge=1.0000 (last merge round=26)
[S8] round=28 local utility u=0.000000 metrics={'f1_val': 0.9900027071046373, 'auprc': 0.9986723562271067, 'loss_val': 0.04050416059632124, 'psi': 0.993470566753625}-{'f1_val': 0.9922069265978078, 'auprc': 0.9986386945134179, 'loss_val': 0.03710382212405653, 'psi': 0.9947796337640519}
[S9] START round=28 head_norm_before_train=1.540610 cos_to_last_merge=0.9993 (last merge round=25)
[S9] round=28 local utility u=0.003687 metrics={'f1_val': 0.9901297741397954, 'auprc': 0.9995338038318125, 'loss_val': 0.05552619510346475, 'psi': 0.9938913860166022}-{'f1_val': 0.9897381162675762, 'auprc': 0.9995309328990354, 'loss_val': 0.06054083875632044, 'psi': 0.9936552429201598}
[S10] START round=28 head_norm_before_train=1.875626 cos_to_last_merge=0.7539 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.754
[S10] round=28 local utility u=0.003539 metrics={'f1_val': 0.9953063309450747, 'auprc': 0.9961982020250085, 'loss_val': 0.030391149302431888, 'psi': 0.9956630793770482}-{'f1_val': 0.9944287677762472, 'auprc': 0.9962528905265364, 'loss_val': 0.03236726184329612, 'psi': 0.995158416876363}
[S11] START round=28 head_norm_before_train=1.393507 cos_to_last_merge=0.9839 (last merge round=21)
[S11] round=28 local utility u=0.009289 metrics={'f1_val': 0.9934271414771721, 'auprc': 0.998054133625293, 'loss_val': 0.15324662593558896, 'psi': 0.9952779383364205}-{'f1_val': 0.9965470045135896, 'auprc': 0.9976669671159205, 'loss_val': 0.1893817441996367, 'psi': 0.9969949895545219}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] START round=28 head_norm_before_train=1.389883 cos_to_last_merge=0.9999 (last merge round=26)
[S13] round=28 local utility u=0.000000 metrics={'f1_val': 0.6283586564977433, 'auprc': 0.6058320473977249, 'loss_val': 0.742492682146431, 'psi': 0.619348012857736}-{'f1_val': 0.5955790081371486, 'auprc': 0.7431759561026886, 'loss_val': 0.7239259834637469, 'psi': 0.6546177873233646}
[S14] START round=28 head_norm_before_train=1.392076 cos_to_last_merge=1.0000 (last merge round=27)
[S14] round=28 local utility u=0.000000 metrics={'f1_val': 0.8857213068749228, 'auprc': 0.9650400464826148, 'loss_val': 0.5054987239542295, 'psi': 0.9174488027179996}-{'f1_val': 0.8872361253099927, 'auprc': 0.980700442070118, 'loss_val': 0.4609070320606818, 'psi': 0.9246218520140428}
[S15] START round=28 head_norm_before_train=1.371512 cos_to_last_merge=0.9997 (last merge round=26)
[S15] round=28 local utility u=0.641452 metrics={'f1_val': 0.8761687612909412, 'auprc': 0.9915923782737022, 'loss_val': 0.2127378776860424, 'psi': 0.9223382080840457}-{'f1_val': 0.7033095065017607, 'auprc': 0.9882085551115258, 'loss_val': 0.44833575511172974, 'psi': 0.8172691259456668}
[S16] START round=28 head_norm_before_train=1.374547 cos_to_last_merge=0.9985 (last merge round=25)
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.849588077109994, 'auprc': 0.9858468063243825, 'loss_val': 0.4065743384267634, 'psi': 0.9040915687957494}-{'f1_val': 0.9884203372132696, 'auprc': 0.9871881792179731, 'loss_val': 0.10501451273154533, 'psi': 0.987927474015151}
[S17] START round=28 head_norm_before_train=1.343655 cos_to_last_merge=1.0000 (last merge round=27)
[S17] round=28 local utility u=0.478839 metrics={'f1_val': 0.5232507157600427, 'auprc': 0.8665364665418668, 'loss_val': 0.8633579432708065, 'psi': 0.6605650160727723}-{'f1_val': 0.42131067659829097, 'auprc': 0.7756350376252938, 'loss_val': 0.936692339304981, 'psi': 0.5630404210090921}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S7] sending update (kind=head size=1792 to 1 peers)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=28 metric=0.8762 head_norm=1.405542
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.289634e-01
[S15] stored merged vector for next round verification (round=28)
[S15] DEBUG after merge:  round=28 metric=0.8799 head_norm=1.350646 delta_norm=0.328963
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=29 head_norm_before_train=1.464410 cos_to_last_merge=0.9785 (last merge round=21)
[S2] round=29 local utility u=0.049743 metrics={'f1_val': 0.7100409430453158, 'auprc': 0.832410109773783, 'loss_val': 0.37392975999609745, 'psi': 0.7589886097367027}-{'f1_val': 0.7101074138302449, 'auprc': 0.797708132252332, 'loss_val': 0.3697078051275195, 'psi': 0.7451477011990797}
[S2] not sending this round → trigger blocked (psi=0.759)
[S3] START round=29 head_norm_before_train=1.862451 cos_to_last_merge=1.0000 (last merge round=28)
[S3] round=29 local utility u=0.000000 metrics={'f1_val': 0.9090792732870221, 'auprc': 0.9999861473590801, 'loss_val': 0.17984994279192562, 'psi': 0.9454420229158453}-{'f1_val': 0.9605746297510223, 'auprc': 0.9998213420309835, 'loss_val': 0.11536987779330458, 'psi': 0.9762733146630067}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=29 head_norm_before_train=1.722617 cos_to_last_merge=0.9999 (last merge round=27)
[S4] round=29 local utility u=0.002958 metrics={'f1_val': 0.9501263374325392, 'auprc': 0.9625584840040462, 'loss_val': 0.2689043895334183, 'psi': 0.955099196061142}-{'f1_val': 0.9431854800824924, 'auprc': 0.9764590663286923, 'loss_val': 0.27487609380515415, 'psi': 0.9564949145809724}
[S4] not sending this round → trigger blocked (psi=0.955)
[S5] START round=29 head_norm_before_train=1.688220 (no previous merge yet)
[S5] round=29 local utility u=0.000000 metrics={'f1_val': 0.41884869973023203, 'auprc': 0.8154580021226463, 'loss_val': 1.162703008403519, 'psi': 0.5774924206871977}-{'f1_val': 0.7003213174339138, 'auprc': 0.9975280751063911, 'loss_val': 0.21216895474085729, 'psi': 0.8192040205029048}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=29 head_norm_before_train=1.782592 cos_to_last_merge=0.8080 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.808
[S6] round=29 local utility u=0.258626 metrics={'f1_val': 0.7158784113268809, 'auprc': 0.8328209494881492, 'loss_val': 0.8800373095624584, 'psi': 0.7626554265913883}-{'f1_val': 0.649392283711194, 'auprc': 0.8090452863373278, 'loss_val': 0.9270448767647632, 'psi': 0.7132534847616474}
[S7] START round=29 head_norm_before_train=1.713266 cos_to_last_merge=1.0000 (last merge round=27)
[S7] round=29 local utility u=0.000000 metrics={'f1_val': 0.550598765955373, 'auprc': 0.7814339381396445, 'loss_val': 0.766485012797505, 'psi': 0.6429328348290817}-{'f1_val': 0.6604953785630076, 'auprc': 0.8206804366622507, 'loss_val': 0.45866879882411427, 'psi': 0.7245694018027048}
[S8] START round=29 head_norm_before_train=1.863594 cos_to_last_merge=0.9999 (last merge round=26)
[S8] round=29 local utility u=0.010043 metrics={'f1_val': 0.9934888194563342, 'auprc': 0.9971222108291091, 'loss_val': 0.03668509520216314, 'psi': 0.9949421760054441}-{'f1_val': 0.9900027071046373, 'auprc': 0.9986723562271067, 'loss_val': 0.04050416059632124, 'psi': 0.993470566753625}
[S9] START round=29 head_norm_before_train=1.575103 cos_to_last_merge=0.9986 (last merge round=25)
[S9] round=29 local utility u=0.026677 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9995395591922491, 'loss_val': 0.03987288557757301, 'psi': 0.9976619350772322}-{'f1_val': 0.9901297741397954, 'auprc': 0.9995338038318125, 'loss_val': 0.05552619510346475, 'psi': 0.9938913860166022}
[S10] START round=29 head_norm_before_train=1.887629 cos_to_last_merge=0.7530 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.753
[S10] round=29 local utility u=0.000000 metrics={'f1_val': 0.9946480472226495, 'auprc': 0.996341161683082, 'loss_val': 0.0309062967694604, 'psi': 0.9953252930068225}-{'f1_val': 0.9953063309450747, 'auprc': 0.9961982020250085, 'loss_val': 0.030391149302431888, 'psi': 0.9956630793770482}
[S11] START round=29 head_norm_before_train=1.422053 cos_to_last_merge=0.9798 (last merge round=21)
[S11] round=29 local utility u=0.010510 metrics={'f1_val': 0.996305167468861, 'auprc': 0.99781841914188, 'loss_val': 0.14878778975239, 'psi': 0.9969104681380685}-{'f1_val': 0.9934271414771721, 'auprc': 0.998054133625293, 'loss_val': 0.15324662593558896, 'psi': 0.9952779383364205}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=29 head_norm_before_train=1.402442 cos_to_last_merge=0.9995 (last merge round=26)
[S13] round=29 local utility u=0.232851 metrics={'f1_val': 0.6243287296047844, 'auprc': 0.7366527423182427, 'loss_val': 0.6450723793726183, 'psi': 0.6692583346901677}-{'f1_val': 0.6283586564977433, 'auprc': 0.6058320473977249, 'loss_val': 0.742492682146431, 'psi': 0.619348012857736}
[S14] START round=29 head_norm_before_train=1.421555 cos_to_last_merge=0.9997 (last merge round=27)
[S14] round=29 local utility u=0.026745 metrics={'f1_val': 0.8853218002914738, 'auprc': 0.9775564837462456, 'loss_val': 0.4871618800792492, 'psi': 0.9222156736733824}-{'f1_val': 0.8857213068749228, 'auprc': 0.9650400464826148, 'loss_val': 0.5054987239542295, 'psi': 0.9174488027179996}
[S15] START round=29 head_norm_before_train=1.350646 cos_to_last_merge=1.0000 (last merge round=28)
[S15] round=29 local utility u=0.445943 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9964009317013054, 'loss_val': 0.05874452528460937, 'psi': 0.9966083737130345}-{'f1_val': 0.8761687612909412, 'auprc': 0.9915923782737022, 'loss_val': 0.2127378776860424, 'psi': 0.9223382080840457}
[S16] START round=29 head_norm_before_train=1.405908 cos_to_last_merge=0.9975 (last merge round=25)
[S16] round=29 local utility u=0.597103 metrics={'f1_val': 0.9911662550103195, 'auprc': 0.9913713917027285, 'loss_val': 0.0784102090664561, 'psi': 0.9912483096872831}-{'f1_val': 0.849588077109994, 'auprc': 0.9858468063243825, 'loss_val': 0.4065743384267634, 'psi': 0.9040915687957494}
[S17] START round=29 head_norm_before_train=1.364584 cos_to_last_merge=0.9998 (last merge round=27)
[S17] round=29 local utility u=0.040272 metrics={'f1_val': 0.5129096699128131, 'auprc': 0.8814207558572935, 'loss_val': 0.7654214445123095, 'psi': 0.6603141042906052}-{'f1_val': 0.5232507157600427, 'auprc': 0.8665364665418668, 'loss_val': 0.8633579432708065, 'psi': 0.6605650160727723}
[S17] not sending this round → trigger blocked (psi=0.660)
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1812 reason=None
[S14] sending update (kind=head size=1812 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] sending update (kind=head size=1806 to 1 peers)
[S15] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S6] sending update (kind=head size=1806 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] sending update (kind=head size=1805 to 1 peers)
[S2] START round=30 head_norm_before_train=1.492256 cos_to_last_merge=0.9755 (last merge round=21)
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.7275112043039972, 'auprc': 0.7856529025312354, 'loss_val': 0.4125691460155863, 'psi': 0.7507678835948925}-{'f1_val': 0.7100409430453158, 'auprc': 0.832410109773783, 'loss_val': 0.37392975999609745, 'psi': 0.7589886097367027}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=30 head_norm_before_train=1.879496 cos_to_last_merge=0.9999 (last merge round=28)
[S3] round=30 local utility u=0.000000 metrics={'f1_val': 0.8769706436032889, 'auprc': 0.9997372721010087, 'loss_val': 0.20608983421818125, 'psi': 0.9260772950023768}-{'f1_val': 0.9090792732870221, 'auprc': 0.9999861473590801, 'loss_val': 0.17984994279192562, 'psi': 0.9454420229158453}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=30 head_norm_before_train=1.738757 cos_to_last_merge=0.9996 (last merge round=27)
[S4] round=30 local utility u=0.031582 metrics={'f1_val': 0.9521305339484308, 'auprc': 0.9789836221405986, 'loss_val': 0.26704136908843606, 'psi': 0.9628717692252979}-{'f1_val': 0.9501263374325392, 'auprc': 0.9625584840040462, 'loss_val': 0.2689043895334183, 'psi': 0.955099196061142}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S4] sending update (kind=head size=1808 to 1 peers)
[S5] START round=30 head_norm_before_train=1.693289 (no previous merge yet)
[S5] round=30 local utility u=1.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9952249108709277, 'loss_val': 0.200203153965514, 'psi': 0.8182827548087193}-{'f1_val': 0.41884869973023203, 'auprc': 0.8154580021226463, 'loss_val': 1.162703008403519, 'psi': 0.5774924206871977}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=30 head_norm_before_train=1.802214 cos_to_last_merge=0.8060 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.806
[S6] round=30 local utility u=0.696898 metrics={'f1_val': 0.8205934301915515, 'auprc': 0.9318539743732173, 'loss_val': 0.41163075268096205, 'psi': 0.8650976478642178}-{'f1_val': 0.7158784113268809, 'auprc': 0.8328209494881492, 'loss_val': 0.8800373095624584, 'psi': 0.7626554265913883}
[S7] START round=30 head_norm_before_train=1.721113 cos_to_last_merge=0.9999 (last merge round=27)
[S7] round=30 local utility u=0.383335 metrics={'f1_val': 0.6382234562031875, 'auprc': 0.7945111511976648, 'loss_val': 0.564795592350717, 'psi': 0.7007385342009784}-{'f1_val': 0.550598765955373, 'auprc': 0.7814339381396445, 'loss_val': 0.766485012797505, 'psi': 0.6429328348290817}
[S8] START round=30 head_norm_before_train=1.871443 cos_to_last_merge=0.9998 (last merge round=26)
[S8] round=30 local utility u=0.000000 metrics={'f1_val': 0.9914375510364866, 'auprc': 0.9986662857402138, 'loss_val': 0.03687190461273357, 'psi': 0.9943290449179774}-{'f1_val': 0.9934888194563342, 'auprc': 0.9971222108291091, 'loss_val': 0.03668509520216314, 'psi': 0.9949421760054441}
[S9] START round=30 head_norm_before_train=1.605408 cos_to_last_merge=0.9978 (last merge round=25)
[S9] round=30 local utility u=0.001744 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9995330379177262, 'loss_val': 0.03636616601300476, 'psi': 0.997659326567423}-{'f1_val': 0.9964101856672208, 'auprc': 0.9995395591922491, 'loss_val': 0.03987288557757301, 'psi': 0.9976619350772322}
[S10] START round=30 head_norm_before_train=1.898815 cos_to_last_merge=0.7522 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.752
[S10] round=30 local utility u=0.000000 metrics={'f1_val': 0.9944287677762472, 'auprc': 0.9963514098303424, 'loss_val': 0.03132080258583807, 'psi': 0.9951978245978853}-{'f1_val': 0.9946480472226495, 'auprc': 0.996341161683082, 'loss_val': 0.0309062967694604, 'psi': 0.9953252930068225}
[S11] START round=30 head_norm_before_train=1.446906 cos_to_last_merge=0.9760 (last merge round=21)
[S11] round=30 local utility u=0.015925 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9979399661105678, 'loss_val': 0.11875354198698973, 'psi': 0.9971041891523809}-{'f1_val': 0.996305167468861, 'auprc': 0.99781841914188, 'loss_val': 0.14878778975239, 'psi': 0.9969104681380685}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S11] sending update (kind=head size=1806 to 1 peers)
[S13] START round=30 head_norm_before_train=1.413900 cos_to_last_merge=0.9984 (last merge round=26)
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.6148672076351658, 'auprc': 0.6462981807440982, 'loss_val': 0.7603908183372681, 'psi': 0.6274395968787387}-{'f1_val': 0.6243287296047844, 'auprc': 0.7366527423182427, 'loss_val': 0.6450723793726183, 'psi': 0.6692583346901677}
[S14] START round=30 head_norm_before_train=1.449662 cos_to_last_merge=0.9991 (last merge round=27)
[S14] round=30 local utility u=0.109840 metrics={'f1_val': 0.8872361253099927, 'auprc': 0.9980317931640855, 'loss_val': 0.3403943717790966, 'psi': 0.9315543924516299}-{'f1_val': 0.8853218002914738, 'auprc': 0.9775564837462456, 'loss_val': 0.4871618800792492, 'psi': 0.9222156736733824}
[S15] START round=30 head_norm_before_train=1.380825 cos_to_last_merge=0.9998 (last merge round=28)
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.7009169771696235, 'auprc': 0.9878937762507901, 'loss_val': 0.43356404747513844, 'psi': 0.8157076968020902}-{'f1_val': 0.9967466683875206, 'auprc': 0.9964009317013054, 'loss_val': 0.05874452528460937, 'psi': 0.9966083737130345}
[S16] START round=30 head_norm_before_train=1.432404 cos_to_last_merge=0.9964 (last merge round=25)
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.8240450105730823, 'auprc': 0.9808398322769953, 'loss_val': 0.9044843521942082, 'psi': 0.8867629392546476}-{'f1_val': 0.9911662550103195, 'auprc': 0.9913713917027285, 'loss_val': 0.0784102090664561, 'psi': 0.9912483096872831}
[S17] START round=30 head_norm_before_train=1.390025 cos_to_last_merge=0.9989 (last merge round=27)
[S17] round=30 local utility u=0.531115 metrics={'f1_val': 0.676580786289611, 'auprc': 0.8949004387820474, 'loss_val': 0.7256564141057366, 'psi': 0.7639086472865857}-{'f1_val': 0.5129096699128131, 'auprc': 0.8814207558572935, 'loss_val': 0.7654214445123095, 'psi': 0.6603141042906052}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.932)
[S6] not sending this round → trigger blocked (psi=0.865)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=31 head_norm_before_train=1.512826 cos_to_last_merge=0.9730 (last merge round=21)
[S2] round=31 local utility u=0.000000 metrics={'f1_val': 0.7456621612785483, 'auprc': 0.7679937298478664, 'loss_val': 0.5528186435429904, 'psi': 0.7545947887062756}-{'f1_val': 0.7275112043039972, 'auprc': 0.7856529025312354, 'loss_val': 0.4125691460155863, 'psi': 0.7507678835948925}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=31 head_norm_before_train=1.896048 cos_to_last_merge=0.9997 (last merge round=28)
[S3] round=31 local utility u=0.000000 metrics={'f1_val': 0.8291061202927325, 'auprc': 0.9996396257424972, 'loss_val': 0.2643649172086043, 'psi': 0.8973195224726384}-{'f1_val': 0.8769706436032889, 'auprc': 0.9997372721010087, 'loss_val': 0.20608983421818125, 'psi': 0.9260772950023768}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=31 head_norm_before_train=1.758106 cos_to_last_merge=0.9991 (last merge round=27)
[S4] round=31 local utility u=0.000000 metrics={'f1_val': 0.9374856535186832, 'auprc': 0.9694847002837856, 'loss_val': 0.31850017915115697, 'psi': 0.9502852722247241}-{'f1_val': 0.9521305339484308, 'auprc': 0.9789836221405986, 'loss_val': 0.26704136908843606, 'psi': 0.9628717692252979}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=31 head_norm_before_train=1.698202 (no previous merge yet)
[S5] round=31 local utility u=0.000000 metrics={'f1_val': 0.651221806184154, 'auprc': 0.8539279593251651, 'loss_val': 0.42578227573867516, 'psi': 0.7323042674405584}-{'f1_val': 0.7003213174339138, 'auprc': 0.9952249108709277, 'loss_val': 0.200203153965514, 'psi': 0.8182827548087193}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=31 head_norm_before_train=1.817869 cos_to_last_merge=0.8045 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.805
[S6] round=31 local utility u=0.000000 metrics={'f1_val': 0.7832077091738463, 'auprc': 0.8971267060043544, 'loss_val': 0.5110923361435998, 'psi': 0.8287753079060496}-{'f1_val': 0.8205934301915515, 'auprc': 0.9318539743732173, 'loss_val': 0.41163075268096205, 'psi': 0.8650976478642178}
[S7] START round=31 head_norm_before_train=1.727492 cos_to_last_merge=0.9998 (last merge round=27)
[S7] round=31 local utility u=0.100385 metrics={'f1_val': 0.652376985158096, 'auprc': 0.8129430948209049, 'loss_val': 0.5042421934299409, 'psi': 0.7166034290232195}-{'f1_val': 0.6382234562031875, 'auprc': 0.7945111511976648, 'loss_val': 0.564795592350717, 'psi': 0.7007385342009784}
[S8] START round=31 head_norm_before_train=1.882203 cos_to_last_merge=0.9997 (last merge round=26)
[S8] round=31 local utility u=0.000000 metrics={'f1_val': 0.9860710398489039, 'auprc': 0.9987040353663028, 'loss_val': 0.04419337648728657, 'psi': 0.9911242380558635}-{'f1_val': 0.9914375510364866, 'auprc': 0.9986662857402138, 'loss_val': 0.03687190461273357, 'psi': 0.9943290449179774}
[S9] START round=31 head_norm_before_train=1.633282 cos_to_last_merge=0.9970 (last merge round=25)
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.9909734396342953, 'auprc': 0.9995199940231161, 'loss_val': 0.03992895358100518, 'psi': 0.9943920613898236}-{'f1_val': 0.9964101856672208, 'auprc': 0.9995330379177262, 'loss_val': 0.03636616601300476, 'psi': 0.997659326567423}
[S10] START round=31 head_norm_before_train=1.912435 cos_to_last_merge=0.7509 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.751
[S10] round=31 local utility u=0.001897 metrics={'f1_val': 0.9948674007110037, 'auprc': 0.9963520260619767, 'loss_val': 0.030159996895986262, 'psi': 0.9954612508513929}-{'f1_val': 0.9944287677762472, 'auprc': 0.9963514098303424, 'loss_val': 0.03132080258583807, 'psi': 0.9951978245978853}
[S11] START round=31 head_norm_before_train=1.470919 cos_to_last_merge=0.9723 (last merge round=21)
[S11] round=31 local utility u=0.000000 metrics={'f1_val': 0.9915199581057028, 'auprc': 0.9981608619497015, 'loss_val': 0.10019315311586771, 'psi': 0.9941763196433022}-{'f1_val': 0.9965470045135896, 'auprc': 0.9979399661105678, 'loss_val': 0.11875354198698973, 'psi': 0.9971041891523809}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=31 head_norm_before_train=1.430067 cos_to_last_merge=0.9978 (last merge round=26)
[S13] round=31 local utility u=0.193390 metrics={'f1_val': 0.6568443018107296, 'auprc': 0.674227195678445, 'loss_val': 0.7092613564330666, 'psi': 0.6637974593578158}-{'f1_val': 0.6148672076351658, 'auprc': 0.6462981807440982, 'loss_val': 0.7603908183372681, 'psi': 0.6274395968787387}
[S14] START round=31 head_norm_before_train=1.473927 cos_to_last_merge=0.9982 (last merge round=27)
[S14] round=31 local utility u=0.318231 metrics={'f1_val': 0.952875000786073, 'auprc': 0.9985520741099151, 'loss_val': 0.09932549812575713, 'psi': 0.9711458301156098}-{'f1_val': 0.8872361253099927, 'auprc': 0.9980317931640855, 'loss_val': 0.3403943717790966, 'psi': 0.9315543924516299}
[S15] START round=31 head_norm_before_train=1.415901 cos_to_last_merge=0.9992 (last merge round=28)
[S15] round=31 local utility u=1.000000 metrics={'f1_val': 0.9959452881418331, 'auprc': 0.9911159298086119, 'loss_val': 0.0562956927692679, 'psi': 0.9940135448085446}-{'f1_val': 0.7009169771696235, 'auprc': 0.9878937762507901, 'loss_val': 0.43356404747513844, 'psi': 0.8157076968020902}
[S16] START round=31 head_norm_before_train=1.456619 cos_to_last_merge=0.9953 (last merge round=25)
[S16] round=31 local utility u=0.268642 metrics={'f1_val': 0.8414243249395839, 'auprc': 0.9772429597039844, 'loss_val': 0.4606846530118231, 'psi': 0.8957517788453441}-{'f1_val': 0.8240450105730823, 'auprc': 0.9808398322769953, 'loss_val': 0.9044843521942082, 'psi': 0.8867629392546476}
[S17] START round=31 head_norm_before_train=1.423301 cos_to_last_merge=0.9968 (last merge round=27)
[S17] round=31 local utility u=0.490791 metrics={'f1_val': 0.7800085310129299, 'auprc': 0.9364767933378936, 'loss_val': 0.4893701369484453, 'psi': 0.8425958359429153}-{'f1_val': 0.676580786289611, 'auprc': 0.8949004387820474, 'loss_val': 0.7256564141057366, 'psi': 0.7639086472865857}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S17] not sending this round → trigger blocked (psi=0.843)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S7] not sending this round → trigger blocked (psi=0.717)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=32 head_norm_before_train=1.538309 cos_to_last_merge=0.9697 (last merge round=21)
[S2] round=32 local utility u=0.000000 metrics={'f1_val': 0.7032362528085611, 'auprc': 0.8000066529618332, 'loss_val': 0.49533306330458615, 'psi': 0.74194441286987}-{'f1_val': 0.7456621612785483, 'auprc': 0.7679937298478664, 'loss_val': 0.5528186435429904, 'psi': 0.7545947887062756}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=32 head_norm_before_train=1.913454 cos_to_last_merge=0.9994 (last merge round=28)
[S3] round=32 local utility u=0.581212 metrics={'f1_val': 0.9907797718748208, 'auprc': 0.9999594831506183, 'loss_val': 0.07294281725732162, 'psi': 0.9944516563851398}-{'f1_val': 0.8291061202927325, 'auprc': 0.9996396257424972, 'loss_val': 0.2643649172086043, 'psi': 0.8973195224726384}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S4] START round=32 head_norm_before_train=1.771682 cos_to_last_merge=0.9987 (last merge round=27)
[S4] round=32 local utility u=0.000000 metrics={'f1_val': 0.8687922145864735, 'auprc': 0.96030452151029, 'loss_val': 0.4020332473913636, 'psi': 0.9053971373560001}-{'f1_val': 0.9374856535186832, 'auprc': 0.9694847002837856, 'loss_val': 0.31850017915115697, 'psi': 0.9502852722247241}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=32 head_norm_before_train=1.703969 (no previous merge yet)
[S5] round=32 local utility u=0.482586 metrics={'f1_val': 0.704064501625784, 'auprc': 0.9918929239743801, 'loss_val': 0.19156058689608899, 'psi': 0.8191958705652225}-{'f1_val': 0.651221806184154, 'auprc': 0.8539279593251651, 'loss_val': 0.42578227573867516, 'psi': 0.7323042674405584}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=32 head_norm_before_train=1.830131 cos_to_last_merge=0.8036 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.804
[S6] round=32 local utility u=0.160222 metrics={'f1_val': 0.8184023663453703, 'auprc': 0.9294944588637317, 'loss_val': 0.4989186900141209, 'psi': 0.8628392033527148}-{'f1_val': 0.7832077091738463, 'auprc': 0.8971267060043544, 'loss_val': 0.5110923361435998, 'psi': 0.8287753079060496}
[S7] START round=32 head_norm_before_train=1.735745 cos_to_last_merge=0.9997 (last merge round=27)
[S7] round=32 local utility u=0.000000 metrics={'f1_val': 0.41960444829810495, 'auprc': 0.7792897657987986, 'loss_val': 1.1379630299881738, 'psi': 0.5634785752983824}-{'f1_val': 0.652376985158096, 'auprc': 0.8129430948209049, 'loss_val': 0.5042421934299409, 'psi': 0.7166034290232195}
[S8] START round=32 head_norm_before_train=1.889944 cos_to_last_merge=0.9997 (last merge round=26)
[S8] round=32 local utility u=0.021785 metrics={'f1_val': 0.9927572273717925, 'auprc': 0.9973478606136181, 'loss_val': 0.03667265796510967, 'psi': 0.9945934806685228}-{'f1_val': 0.9860710398489039, 'auprc': 0.9987040353663028, 'loss_val': 0.04419337648728657, 'psi': 0.9911242380558635}
[S9] START round=32 head_norm_before_train=1.663394 cos_to_last_merge=0.9960 (last merge round=25)
[S9] round=32 local utility u=0.018467 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9963725678381159, 'loss_val': 0.03033025285421986, 'psi': 0.9968107746425321}-{'f1_val': 0.9909734396342953, 'auprc': 0.9995199940231161, 'loss_val': 0.03992895358100518, 'psi': 0.9943920613898236}
[S10] START round=32 head_norm_before_train=1.921680 cos_to_last_merge=0.7504 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.750
[S10] round=32 local utility u=0.000000 metrics={'f1_val': 0.9946480472226495, 'auprc': 0.9963578570817423, 'loss_val': 0.030135626252596224, 'psi': 0.9953319711662867}-{'f1_val': 0.9948674007110037, 'auprc': 0.9963520260619767, 'loss_val': 0.030159996895986262, 'psi': 0.9954612508513929}
[S11] START round=32 head_norm_before_train=1.495654 cos_to_last_merge=0.9685 (last merge round=21)
[S11] round=32 local utility u=0.024712 metrics={'f1_val': 0.9958246664506369, 'auprc': 0.9979051345279145, 'loss_val': 0.07583070435182183, 'psi': 0.9966568536815479}-{'f1_val': 0.9915199581057028, 'auprc': 0.9981608619497015, 'loss_val': 0.10019315311586771, 'psi': 0.9941763196433022}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] sending update (kind=head size=1804 to 1 peers)
[S13] START round=32 head_norm_before_train=1.443995 cos_to_last_merge=0.9973 (last merge round=26)
[S13] round=32 local utility u=0.207584 metrics={'f1_val': 0.6773354626038957, 'auprc': 0.7092017365265806, 'loss_val': 0.5219630650717715, 'psi': 0.6900819721729696}-{'f1_val': 0.6568443018107296, 'auprc': 0.674227195678445, 'loss_val': 0.7092613564330666, 'psi': 0.6637974593578158}
[S14] START round=32 head_norm_before_train=1.496093 cos_to_last_merge=0.9971 (last merge round=27)
[S14] round=32 local utility u=0.056298 metrics={'f1_val': 0.9699914143695694, 'auprc': 0.9985842306523023, 'loss_val': 0.08952400718826047, 'psi': 0.9814285408826625}-{'f1_val': 0.952875000786073, 'auprc': 0.9985520741099151, 'loss_val': 0.09932549812575713, 'psi': 0.9711458301156098}
[S15] START round=32 head_norm_before_train=1.449258 cos_to_last_merge=0.9983 (last merge round=28)
[S15] round=32 local utility u=0.000000 metrics={'f1_val': 0.8948620386093225, 'auprc': 0.9954050540827887, 'loss_val': 0.21194626460914545, 'psi': 0.9350792447987089}-{'f1_val': 0.9959452881418331, 'auprc': 0.9911159298086119, 'loss_val': 0.0562956927692679, 'psi': 0.9940135448085446}
[S16] START round=32 head_norm_before_train=1.477311 cos_to_last_merge=0.9943 (last merge round=25)
[S16] round=32 local utility u=0.670394 metrics={'f1_val': 0.9915774718201167, 'auprc': 0.9918817536205768, 'loss_val': 0.06473234425815105, 'psi': 0.9916991845403007}-{'f1_val': 0.8414243249395839, 'auprc': 0.9772429597039844, 'loss_val': 0.4606846530118231, 'psi': 0.8957517788453441}
[S17] START round=32 head_norm_before_train=1.461642 cos_to_last_merge=0.9934 (last merge round=27)
[S17] round=32 local utility u=0.071867 metrics={'f1_val': 0.7907252139920284, 'auprc': 0.9605038819961458, 'loss_val': 0.48201842548356044, 'psi': 0.8586366811936754}-{'f1_val': 0.7800085310129299, 'auprc': 0.9364767933378936, 'loss_val': 0.4893701369484453, 'psi': 0.8425958359429153}
[S14] not sending this round → trigger blocked (psi=0.981)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] sending update (kind=head size=1806 to 1 peers)
[S16] not sending this round → trigger blocked (psi=0.992)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.690)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S2] START round=33 head_norm_before_train=1.564338 cos_to_last_merge=0.9662 (last merge round=21)
[S2] round=33 local utility u=0.000000 metrics={'f1_val': 0.6921666457929945, 'auprc': 0.8000317822807606, 'loss_val': 0.5538438359549372, 'psi': 0.7353127003881009}-{'f1_val': 0.7032362528085611, 'auprc': 0.8000066529618332, 'loss_val': 0.49533306330458615, 'psi': 0.74194441286987}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=33 head_norm_before_train=1.930311 cos_to_last_merge=0.9990 (last merge round=28)
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.9472943928645419, 'auprc': 0.999993741921299, 'loss_val': 0.1295975753618171, 'psi': 0.9683741324872447}-{'f1_val': 0.9907797718748208, 'auprc': 0.9999594831506183, 'loss_val': 0.07294281725732162, 'psi': 0.9944516563851398}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=33 head_norm_before_train=1.790310 cos_to_last_merge=0.9980 (last merge round=27)
[S4] round=33 local utility u=0.301099 metrics={'f1_val': 0.9429667291797941, 'auprc': 0.9740898748921749, 'loss_val': 0.28623833256503284, 'psi': 0.9554159874647464}-{'f1_val': 0.8687922145864735, 'auprc': 0.96030452151029, 'loss_val': 0.4020332473913636, 'psi': 0.9053971373560001}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=33 head_norm_before_train=1.709866 (no previous merge yet)
[S5] round=33 local utility u=0.000000 metrics={'f1_val': 0.6093856772694557, 'auprc': 0.8544246245814245, 'loss_val': 0.5319941608454468, 'psi': 0.7074012561942433}-{'f1_val': 0.704064501625784, 'auprc': 0.9918929239743801, 'loss_val': 0.19156058689608899, 'psi': 0.8191958705652225}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=33 head_norm_before_train=1.842350 cos_to_last_merge=0.8025 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.803
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.64808245016144, 'auprc': 0.6974944094709938, 'loss_val': 1.1473796927951185, 'psi': 0.6678472338852615}-{'f1_val': 0.8184023663453703, 'auprc': 0.9294944588637317, 'loss_val': 0.4989186900141209, 'psi': 0.8628392033527148}
[S7] START round=33 head_norm_before_train=1.744101 cos_to_last_merge=0.9994 (last merge round=27)
[S7] round=33 local utility u=1.000000 metrics={'f1_val': 0.7180245894213344, 'auprc': 0.8992426263308897, 'loss_val': 0.26890865744569803, 'psi': 0.7905118041851565}-{'f1_val': 0.41960444829810495, 'auprc': 0.7792897657987986, 'loss_val': 1.1379630299881738, 'psi': 0.5634785752983824}
[S8] START round=33 head_norm_before_train=1.901162 cos_to_last_merge=0.9996 (last merge round=26)
[S8] round=33 local utility u=0.000000 metrics={'f1_val': 0.9839526961539431, 'auprc': 0.9986911531264085, 'loss_val': 0.04896969252343177, 'psi': 0.9898480789429293}-{'f1_val': 0.9927572273717925, 'auprc': 0.9973478606136181, 'loss_val': 0.03667265796510967, 'psi': 0.9945934806685228}
[S9] START round=33 head_norm_before_train=1.691771 cos_to_last_merge=0.9950 (last merge round=25)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9944251333507128, 'loss_val': 0.029210343724589714, 'psi': 0.9957855480991424}-{'f1_val': 0.9971029125121428, 'auprc': 0.9963725678381159, 'loss_val': 0.03033025285421986, 'psi': 0.9968107746425321}
[S10] START round=33 head_norm_before_train=1.931905 cos_to_last_merge=0.7497 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.750
[S10] round=33 local utility u=0.000071 metrics={'f1_val': 0.9946480472226495, 'auprc': 0.9963661010355387, 'loss_val': 0.03001860457292808, 'psi': 0.9953352687478052}-{'f1_val': 0.9946480472226495, 'auprc': 0.9963578570817423, 'loss_val': 0.030135626252596224, 'psi': 0.9953319711662867}
[S11] START round=33 head_norm_before_train=1.520258 cos_to_last_merge=0.9646 (last merge round=21)
[S11] round=33 local utility u=0.000000 metrics={'f1_val': 0.9939921762939778, 'auprc': 0.9965634755719344, 'loss_val': 0.11078406370727645, 'psi': 0.9950206960051604}-{'f1_val': 0.9958246664506369, 'auprc': 0.9979051345279145, 'loss_val': 0.07583070435182183, 'psi': 0.9966568536815479}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=33 head_norm_before_train=1.453020 cos_to_last_merge=0.9970 (last merge round=26)
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.6289525951872563, 'auprc': 0.6374566608693215, 'loss_val': 0.8918078109406579, 'psi': 0.6323542214600824}-{'f1_val': 0.6773354626038957, 'auprc': 0.7092017365265806, 'loss_val': 0.5219630650717715, 'psi': 0.6900819721729696}
[S14] START round=33 head_norm_before_train=1.517788 cos_to_last_merge=0.9959 (last merge round=27)
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.9042956449584894, 'auprc': 0.9985775012264981, 'loss_val': 0.25464018330077703, 'psi': 0.9420083874656928}-{'f1_val': 0.9699914143695694, 'auprc': 0.9985842306523023, 'loss_val': 0.08952400718826047, 'psi': 0.9814285408826625}
[S15] START round=33 head_norm_before_train=1.481030 cos_to_last_merge=0.9973 (last merge round=28)
[S15] round=33 local utility u=0.000000 metrics={'f1_val': 0.774859286225757, 'auprc': 0.9919852272640122, 'loss_val': 0.37879886319858913, 'psi': 0.8617096626410591}-{'f1_val': 0.8948620386093225, 'auprc': 0.9954050540827887, 'loss_val': 0.21194626460914545, 'psi': 0.9350792447987089}
[S16] START round=33 head_norm_before_train=1.495099 cos_to_last_merge=0.9933 (last merge round=25)
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.989266614553705, 'auprc': 0.9917442165747186, 'loss_val': 0.06520468689040587, 'psi': 0.9902576553621104}-{'f1_val': 0.9915774718201167, 'auprc': 0.9918817536205768, 'loss_val': 0.06473234425815105, 'psi': 0.9916991845403007}
[S17] START round=33 head_norm_before_train=1.496840 cos_to_last_merge=0.9896 (last merge round=27)
[S17] round=33 local utility u=0.000000 metrics={'f1_val': 0.65109288882925, 'auprc': 0.8485369523258227, 'loss_val': 0.7722794300296906, 'psi': 0.7300705142278792}-{'f1_val': 0.7907252139920284, 'auprc': 0.9605038819961458, 'loss_val': 0.48201842548356044, 'psi': 0.8586366811936754}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16]  timeout peer S15
[S9]  timeout peer S16
[S13]  timeout peer S2
[S6]  timeout peer S17
[S10]  timeout peer S8
[S17]  timeout peer S14
[S14]  timeout peer S11
[S8]  timeout peer S3
[S8]  timeout peer S10
[S15]  timeout peer S13
[S7]  timeout peer S4
[S2] START round=34 head_norm_before_train=1.593069 cos_to_last_merge=0.9625 (last merge round=21)
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.6276785401261399, 'auprc': 0.7769585101236125, 'loss_val': 1.0334707681884425, 'psi': 0.6873905281251289}-{'f1_val': 0.6921666457929945, 'auprc': 0.8000317822807606, 'loss_val': 0.5538438359549372, 'psi': 0.7353127003881009}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=34 head_norm_before_train=1.947507 cos_to_last_merge=0.9985 (last merge round=28)
[S3] round=34 local utility u=0.190391 metrics={'f1_val': 0.996947988970087, 'auprc': 0.9999906861888499, 'loss_val': 0.0467282071533009, 'psi': 0.9981650678575922}-{'f1_val': 0.9472943928645419, 'auprc': 0.999993741921299, 'loss_val': 0.1295975753618171, 'psi': 0.9683741324872447}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] START round=34 head_norm_before_train=1.807614 cos_to_last_merge=0.9974 (last merge round=27)
[S4] round=34 local utility u=0.043381 metrics={'f1_val': 0.9562513233279709, 'auprc': 0.9736446267121415, 'loss_val': 0.2778476969780421, 'psi': 0.9632086446816391}-{'f1_val': 0.9429667291797941, 'auprc': 0.9740898748921749, 'loss_val': 0.28623833256503284, 'psi': 0.9554159874647464}
[S4] not sending this round → trigger blocked (psi=0.963)
[S5] START round=34 head_norm_before_train=1.714670 (no previous merge yet)
[S5] round=34 local utility u=0.941322 metrics={'f1_val': 0.7936341446645218, 'auprc': 0.9938884035766675, 'loss_val': 0.17323259247214462, 'psi': 0.8737358482293801}-{'f1_val': 0.6093856772694557, 'auprc': 0.8544246245814245, 'loss_val': 0.5319941608454468, 'psi': 0.7074012561942433}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=34 head_norm_before_train=1.857178 cos_to_last_merge=0.8012 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.801
[S6] round=34 local utility u=1.000000 metrics={'f1_val': 0.9657059779591309, 'auprc': 0.9840109723095392, 'loss_val': 0.12371379737605821, 'psi': 0.9730279756992942}-{'f1_val': 0.64808245016144, 'auprc': 0.6974944094709938, 'loss_val': 1.1473796927951185, 'psi': 0.6678472338852615}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=34 head_norm_before_train=1.750287 cos_to_last_merge=0.9993 (last merge round=27)
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.4378731370730875, 'auprc': 0.7796689510381015, 'loss_val': 1.080530477828684, 'psi': 0.5745914626590931}-{'f1_val': 0.7180245894213344, 'auprc': 0.8992426263308897, 'loss_val': 0.26890865744569803, 'psi': 0.7905118041851565}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=34 head_norm_before_train=1.908124 cos_to_last_merge=0.9996 (last merge round=26)
[S8] round=34 local utility u=0.034436 metrics={'f1_val': 0.9934464462379313, 'auprc': 0.9977868815011885, 'loss_val': 0.03434783072006357, 'psi': 0.9951826203432342}-{'f1_val': 0.9839526961539431, 'auprc': 0.9986911531264085, 'loss_val': 0.04896969252343177, 'psi': 0.9898480789429293}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=34 head_norm_before_train=1.714500 cos_to_last_merge=0.9942 (last merge round=25)
[S9] round=34 local utility u=0.000000 metrics={'f1_val': 0.985716065895656, 'auprc': 0.9996064313290681, 'loss_val': 0.058404228574046584, 'psi': 0.9912722120690208}-{'f1_val': 0.9966924912647621, 'auprc': 0.9944251333507128, 'loss_val': 0.029210343724589714, 'psi': 0.9957855480991424}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=34 head_norm_before_train=1.943896 cos_to_last_merge=0.7486 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.749
[S10] round=34 local utility u=0.001623 metrics={'f1_val': 0.9950868285240967, 'auprc': 0.9963535778183128, 'loss_val': 0.029368387471149143, 'psi': 0.9955935282417832}-{'f1_val': 0.9946480472226495, 'auprc': 0.9963661010355387, 'loss_val': 0.03001860457292808, 'psi': 0.9953352687478052}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=34 head_norm_before_train=1.542218 cos_to_last_merge=0.9612 (last merge round=21)
[S11] round=34 local utility u=0.000000 metrics={'f1_val': 0.9421972570100947, 'auprc': 0.9958023613020079, 'loss_val': 0.1427432075228485, 'psi': 0.96363929872686}-{'f1_val': 0.9939921762939778, 'auprc': 0.9965634755719344, 'loss_val': 0.11078406370727645, 'psi': 0.9950206960051604}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=34 head_norm_before_train=1.460891 cos_to_last_merge=0.9967 (last merge round=26)
[S13] round=34 local utility u=0.413906 metrics={'f1_val': 0.7136021710310053, 'auprc': 0.6904383910747597, 'loss_val': 0.7308385578121575, 'psi': 0.7043366590485071}-{'f1_val': 0.6289525951872563, 'auprc': 0.6374566608693215, 'loss_val': 0.8918078109406579, 'psi': 0.6323542214600824}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=34 head_norm_before_train=1.536784 cos_to_last_merge=0.9948 (last merge round=27)
[S14] round=34 local utility u=0.000000 metrics={'f1_val': 0.8944461895005437, 'auprc': 0.9986079882328429, 'loss_val': 0.3168081925998236, 'psi': 0.9361109089934634}-{'f1_val': 0.9042956449584894, 'auprc': 0.9985775012264981, 'loss_val': 0.25464018330077703, 'psi': 0.9420083874656928}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=34 head_norm_before_train=1.506440 cos_to_last_merge=0.9963 (last merge round=28)
[S15] round=34 local utility u=0.834315 metrics={'f1_val': 0.9963164379542544, 'auprc': 0.991130973756486, 'loss_val': 0.03634887414662692, 'psi': 0.9942422522751471}-{'f1_val': 0.774859286225757, 'auprc': 0.9919852272640122, 'loss_val': 0.37879886319858913, 'psi': 0.8617096626410591}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=34 head_norm_before_train=1.512529 cos_to_last_merge=0.9924 (last merge round=25)
[S16] round=34 local utility u=0.000000 metrics={'f1_val': 0.9396802745118037, 'auprc': 0.9866903196335912, 'loss_val': 0.2018371505908614, 'psi': 0.9584842925605187}-{'f1_val': 0.989266614553705, 'auprc': 0.9917442165747186, 'loss_val': 0.06520468689040587, 'psi': 0.9902576553621104}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=34 head_norm_before_train=1.533870 cos_to_last_merge=0.9856 (last merge round=27)
[S17] round=34 local utility u=0.000000 metrics={'f1_val': 0.6018543492660549, 'auprc': 0.7285055592385515, 'loss_val': 1.0747263261976825, 'psi': 0.6525148332550536}-{'f1_val': 0.65109288882925, 'auprc': 0.8485369523258227, 'loss_val': 0.7722794300296906, 'psi': 0.7300705142278792}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=35 head_norm_before_train=1.617112 cos_to_last_merge=0.9593 (last merge round=21)
[S2] round=35 local utility u=0.824392 metrics={'f1_val': 0.7565806299452228, 'auprc': 0.8466304717252504, 'loss_val': 0.3671153736942366, 'psi': 0.7926005666572338}-{'f1_val': 0.6276785401261399, 'auprc': 0.7769585101236125, 'loss_val': 1.0334707681884425, 'psi': 0.6873905281251289}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=35 head_norm_before_train=1.963256 cos_to_last_merge=0.9980 (last merge round=28)
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.9389506962009984, 'auprc': 0.9999516289630309, 'loss_val': 0.1635789002510851, 'psi': 0.9633510693058114}-{'f1_val': 0.996947988970087, 'auprc': 0.9999906861888499, 'loss_val': 0.0467282071533009, 'psi': 0.9981650678575922}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=35 head_norm_before_train=1.822484 cos_to_last_merge=0.9967 (last merge round=27)
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.9421862776086978, 'auprc': 0.9628607145999095, 'loss_val': 0.29760719390459356, 'psi': 0.9504560524051825}-{'f1_val': 0.9562513233279709, 'auprc': 0.9736446267121415, 'loss_val': 0.2778476969780421, 'psi': 0.9632086446816391}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=35 head_norm_before_train=1.718746 (no previous merge yet)
[S5] round=35 local utility u=0.000000 metrics={'f1_val': 0.4191414935555745, 'auprc': 0.8242740150341714, 'loss_val': 1.1899656757607369, 'psi': 0.5811945021470133}-{'f1_val': 0.7936341446645218, 'auprc': 0.9938884035766675, 'loss_val': 0.17323259247214462, 'psi': 0.8737358482293801}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=35 head_norm_before_train=1.866593 cos_to_last_merge=0.8004 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.800
[S6] round=35 local utility u=0.000000 metrics={'f1_val': 0.5799164927742295, 'auprc': 0.6896573227944697, 'loss_val': 1.3452206165451495, 'psi': 0.6238128247823256}-{'f1_val': 0.9657059779591309, 'auprc': 0.9840109723095392, 'loss_val': 0.12371379737605821, 'psi': 0.9730279756992942}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=35 head_norm_before_train=1.753899 cos_to_last_merge=0.9993 (last merge round=27)
[S7] round=35 local utility u=1.000000 metrics={'f1_val': 0.6629098251702129, 'auprc': 0.831861169937921, 'loss_val': 0.41125088218454786, 'psi': 0.7304903630772961}-{'f1_val': 0.4378731370730875, 'auprc': 0.7796689510381015, 'loss_val': 1.080530477828684, 'psi': 0.5745914626590931}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] START round=35 head_norm_before_train=1.919428 cos_to_last_merge=0.9995 (last merge round=26)
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.9930990485370332, 'auprc': 0.9975065051725646, 'loss_val': 0.0339327771990355, 'psi': 0.9948620311912457}-{'f1_val': 0.9934464462379313, 'auprc': 0.9977868815011885, 'loss_val': 0.03434783072006357, 'psi': 0.9951826203432342}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=35 head_norm_before_train=1.733194 cos_to_last_merge=0.9933 (last merge round=25)
[S9] round=35 local utility u=0.049086 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9995307099622947, 'loss_val': 0.025670907390385245, 'psi': 0.9978085910732527}-{'f1_val': 0.985716065895656, 'auprc': 0.9996064313290681, 'loss_val': 0.058404228574046584, 'psi': 0.9912722120690208}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=35 head_norm_before_train=1.949961 cos_to_last_merge=0.7485 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.749
[S10] round=35 local utility u=0.000000 metrics={'f1_val': 0.9946480472226495, 'auprc': 0.9963590781266468, 'loss_val': 0.029456997033262954, 'psi': 0.9953324595842484}-{'f1_val': 0.9950868285240967, 'auprc': 0.9963535778183128, 'loss_val': 0.029368387471149143, 'psi': 0.9955935282417832}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=35 head_norm_before_train=1.561793 cos_to_last_merge=0.9583 (last merge round=21)
[S11] round=35 local utility u=0.211253 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9978019626194822, 'loss_val': 0.05233532030414945, 'psi': 0.9970489877559466}-{'f1_val': 0.9421972570100947, 'auprc': 0.9958023613020079, 'loss_val': 0.1427432075228485, 'psi': 0.96363929872686}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=35 head_norm_before_train=1.474109 cos_to_last_merge=0.9958 (last merge round=26)
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.6728001674586299, 'auprc': 0.7140754880171691, 'loss_val': 0.6389341394352261, 'psi': 0.6893102956820456}-{'f1_val': 0.7136021710310053, 'auprc': 0.6904383910747597, 'loss_val': 0.7308385578121575, 'psi': 0.7043366590485071}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=35 head_norm_before_train=1.554419 cos_to_last_merge=0.9938 (last merge round=27)
[S14] round=35 local utility u=0.313433 metrics={'f1_val': 0.9624632928140104, 'auprc': 0.9985690819642448, 'loss_val': 0.09792846319451896, 'psi': 0.9769056084741041}-{'f1_val': 0.8944461895005437, 'auprc': 0.9986079882328429, 'loss_val': 0.3168081925998236, 'psi': 0.9361109089934634}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=35 head_norm_before_train=1.529894 cos_to_last_merge=0.9953 (last merge round=28)
[S15] round=35 local utility u=0.000000 metrics={'f1_val': 0.7727135735217929, 'auprc': 0.968634069185034, 'loss_val': 0.43484998461705204, 'psi': 0.8510817717870893}-{'f1_val': 0.9963164379542544, 'auprc': 0.991130973756486, 'loss_val': 0.03634887414662692, 'psi': 0.9942422522751471}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=35 head_norm_before_train=1.528224 cos_to_last_merge=0.9915 (last merge round=25)
[S16] round=35 local utility u=0.208324 metrics={'f1_val': 0.9874773396166371, 'auprc': 0.9886205359688023, 'loss_val': 0.07776291286053931, 'psi': 0.987934618157503}-{'f1_val': 0.9396802745118037, 'auprc': 0.9866903196335912, 'loss_val': 0.2018371505908614, 'psi': 0.9584842925605187}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=35 head_norm_before_train=1.565030 cos_to_last_merge=0.9819 (last merge round=27)
[S17] round=35 local utility u=1.000000 metrics={'f1_val': 0.7347541807742896, 'auprc': 0.9481066938435198, 'loss_val': 0.4873976746255663, 'psi': 0.8200951860019816}-{'f1_val': 0.6018543492660549, 'auprc': 0.7285055592385515, 'loss_val': 1.0747263261976825, 'psi': 0.6525148332550536}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=36 head_norm_before_train=1.639704 cos_to_last_merge=0.9563 (last merge round=21)
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.7271089883151154, 'auprc': 0.8610053756818621, 'loss_val': 0.4094493182714698, 'psi': 0.7806675432618141}-{'f1_val': 0.7565806299452228, 'auprc': 0.8466304717252504, 'loss_val': 0.3671153736942366, 'psi': 0.7926005666572338}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=36 head_norm_before_train=1.975966 cos_to_last_merge=0.9975 (last merge round=28)
[S3] round=36 local utility u=0.232762 metrics={'f1_val': 0.9966508675148381, 'auprc': 0.9999904020133118, 'loss_val': 0.04437189357625088, 'psi': 0.9979866813142276}-{'f1_val': 0.9389506962009984, 'auprc': 0.9999516289630309, 'loss_val': 0.1635789002510851, 'psi': 0.9633510693058114}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=36 head_norm_before_train=1.835276 cos_to_last_merge=0.9961 (last merge round=27)
[S4] round=36 local utility u=0.000000 metrics={'f1_val': 0.7657287846647307, 'auprc': 0.9617993766223738, 'loss_val': 0.4986475963108598, 'psi': 0.8441570214477879}-{'f1_val': 0.9421862776086978, 'auprc': 0.9628607145999095, 'loss_val': 0.29760719390459356, 'psi': 0.9504560524051825}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=36 head_norm_before_train=1.724062 (no previous merge yet)
[S5] round=36 local utility u=1.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9946486587670935, 'loss_val': 0.20368959373670045, 'psi': 0.8180522539671857}-{'f1_val': 0.4191414935555745, 'auprc': 0.8242740150341714, 'loss_val': 1.1899656757607369, 'psi': 0.5811945021470133}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S5] sending update (kind=head size=1791 to 1 peers)
[S6] START round=36 head_norm_before_train=1.875708 cos_to_last_merge=0.7997 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.800
[S6] round=36 local utility u=0.941940 metrics={'f1_val': 0.7206897799850764, 'auprc': 0.8714273405763573, 'loss_val': 0.8512900271119146, 'psi': 0.7809848042215888}-{'f1_val': 0.5799164927742295, 'auprc': 0.6896573227944697, 'loss_val': 1.3452206165451495, 'psi': 0.6238128247823256}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] START round=36 head_norm_before_train=1.758698 cos_to_last_merge=0.9992 (last merge round=27)
[S7] round=36 local utility u=0.000000 metrics={'f1_val': 0.5318845449277614, 'auprc': 0.7817671849551115, 'loss_val': 0.8292236026291655, 'psi': 0.6318376009387014}-{'f1_val': 0.6629098251702129, 'auprc': 0.831861169937921, 'loss_val': 0.41125088218454786, 'psi': 0.7304903630772961}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=36 head_norm_before_train=1.926819 cos_to_last_merge=0.9995 (last merge round=26)
[S8] round=36 local utility u=0.000000 metrics={'f1_val': 0.9914482382097267, 'auprc': 0.9985892867058721, 'loss_val': 0.035722487090376245, 'psi': 0.9943046576081849}-{'f1_val': 0.9930990485370332, 'auprc': 0.9975065051725646, 'loss_val': 0.0339327771990355, 'psi': 0.9948620311912457}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=36 head_norm_before_train=1.749322 cos_to_last_merge=0.9926 (last merge round=25)
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9995325482433093, 'loss_val': 0.02542959053568643, 'psi': 0.9975630761648903}-{'f1_val': 0.9966605118138915, 'auprc': 0.9995307099622947, 'loss_val': 0.025670907390385245, 'psi': 0.9978085910732527}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=36 head_norm_before_train=1.960137 cos_to_last_merge=0.7477 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.748
[S10] round=36 local utility u=0.000000 metrics={'f1_val': 0.9946480472226495, 'auprc': 0.9963081285723364, 'loss_val': 0.029382014440422773, 'psi': 0.9953120797625243}-{'f1_val': 0.9946480472226495, 'auprc': 0.9963590781266468, 'loss_val': 0.029456997033262954, 'psi': 0.9953324595842484}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=36 head_norm_before_train=1.580198 cos_to_last_merge=0.9557 (last merge round=21)
[S11] round=36 local utility u=0.000000 metrics={'f1_val': 0.9946267592006613, 'auprc': 0.9984527239276952, 'loss_val': 0.0566272898264004, 'psi': 0.9961571450914749}-{'f1_val': 0.9965470045135896, 'auprc': 0.9978019626194822, 'loss_val': 0.05233532030414945, 'psi': 0.9970489877559466}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=36 head_norm_before_train=1.488340 cos_to_last_merge=0.9949 (last merge round=26)
[S13] round=36 local utility u=0.174436 metrics={'f1_val': 0.7255306224656151, 'auprc': 0.7400201338465009, 'loss_val': 0.6842782906952456, 'psi': 0.7313264270179693}-{'f1_val': 0.6728001674586299, 'auprc': 0.7140754880171691, 'loss_val': 0.6389341394352261, 'psi': 0.6893102956820456}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=36 head_norm_before_train=1.569419 cos_to_last_merge=0.9930 (last merge round=27)
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.9058680755317634, 'auprc': 0.9973222626001698, 'loss_val': 0.23632612506487433, 'psi': 0.9424497503591259}-{'f1_val': 0.9624632928140104, 'auprc': 0.9985690819642448, 'loss_val': 0.09792846319451896, 'psi': 0.9769056084741041}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=36 head_norm_before_train=1.551476 cos_to_last_merge=0.9943 (last merge round=28)
[S15] round=36 local utility u=0.906302 metrics={'f1_val': 0.9955024063769649, 'auprc': 0.9953193547272214, 'loss_val': 0.03903537650408335, 'psi': 0.9954291857170675}-{'f1_val': 0.7727135735217929, 'auprc': 0.968634069185034, 'loss_val': 0.43484998461705204, 'psi': 0.8510817717870893}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=36 head_norm_before_train=1.542407 cos_to_last_merge=0.9907 (last merge round=25)
[S16] round=36 local utility u=0.000000 metrics={'f1_val': 0.9022911084187495, 'auprc': 0.9824386791516606, 'loss_val': 0.41315688518600985, 'psi': 0.9343501367119139}-{'f1_val': 0.9874773396166371, 'auprc': 0.9886205359688023, 'loss_val': 0.07776291286053931, 'psi': 0.987934618157503}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=36 head_norm_before_train=1.582354 cos_to_last_merge=0.9797 (last merge round=27)
[S17] round=36 local utility u=0.000000 metrics={'f1_val': 0.6150380049133166, 'auprc': 0.7662106943960096, 'loss_val': 1.077776956318776, 'psi': 0.6755070807063939}-{'f1_val': 0.7347541807742896, 'auprc': 0.9481066938435198, 'loss_val': 0.4873976746255663, 'psi': 0.8200951860019816}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=37 head_norm_before_train=1.661715 cos_to_last_merge=0.9535 (last merge round=21)
[S2] round=37 local utility u=0.000000 metrics={'f1_val': 0.6688658645425376, 'auprc': 0.6823742214763991, 'loss_val': 1.2722783979708365, 'psi': 0.6742692073160823}-{'f1_val': 0.7271089883151154, 'auprc': 0.8610053756818621, 'loss_val': 0.4094493182714698, 'psi': 0.7806675432618141}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=37 head_norm_before_train=1.986851 cos_to_last_merge=0.9971 (last merge round=28)
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.9626780918926742, 'auprc': 0.9999621743807606, 'loss_val': 0.08189744846794628, 'psi': 0.9775917248879088}-{'f1_val': 0.9966508675148381, 'auprc': 0.9999904020133118, 'loss_val': 0.04437189357625088, 'psi': 0.9979866813142276}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=37 head_norm_before_train=1.839197 cos_to_last_merge=0.9955 (last merge round=27)
[S4] round=37 local utility u=0.629058 metrics={'f1_val': 0.9413262620742936, 'auprc': 0.9635615600019567, 'loss_val': 0.2994020934580361, 'psi': 0.9502203812453588}-{'f1_val': 0.7657287846647307, 'auprc': 0.9617993766223738, 'loss_val': 0.4986475963108598, 'psi': 0.8441570214477879}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=37 head_norm_before_train=1.728389 (no previous merge yet)
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9897875198125063, 'loss_val': 0.27644944350368533, 'psi': 0.8161077983853509}-{'f1_val': 0.7003213174339138, 'auprc': 0.9946486587670935, 'loss_val': 0.20368959373670045, 'psi': 0.8180522539671857}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=37 head_norm_before_train=1.885770 cos_to_last_merge=0.7990 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.799
[S6] round=37 local utility u=0.658185 metrics={'f1_val': 0.8224226413750841, 'auprc': 0.9426411594377729, 'loss_val': 0.3589587401683221, 'psi': 0.8705100486001597}-{'f1_val': 0.7206897799850764, 'auprc': 0.8714273405763573, 'loss_val': 0.8512900271119146, 'psi': 0.7809848042215888}
[S6] not sending this round → trigger blocked (psi=0.871)
[S7] START round=37 head_norm_before_train=1.762797 cos_to_last_merge=0.9992 (last merge round=27)
[S7] round=37 local utility u=0.697319 metrics={'f1_val': 0.6669403007539099, 'auprc': 0.8337334027533209, 'loss_val': 0.40081890726713476, 'psi': 0.7336575415536744}-{'f1_val': 0.5318845449277614, 'auprc': 0.7817671849551115, 'loss_val': 0.8292236026291655, 'psi': 0.6318376009387014}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] START round=37 head_norm_before_train=1.936014 cos_to_last_merge=0.9995 (last merge round=26)
[S8] round=37 local utility u=0.001864 metrics={'f1_val': 0.9922069265978078, 'auprc': 0.998258267678458, 'loss_val': 0.03555378035394863, 'psi': 0.994627463030068}-{'f1_val': 0.9914482382097267, 'auprc': 0.9985892867058721, 'loss_val': 0.035722487090376245, 'psi': 0.9943046576081849}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=37 head_norm_before_train=1.764208 cos_to_last_merge=0.9920 (last merge round=25)
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.9908021981609972, 'auprc': 0.9996480038985329, 'loss_val': 0.034887813205154404, 'psi': 0.9943405204560114}-{'f1_val': 0.9962500947792776, 'auprc': 0.9995325482433093, 'loss_val': 0.02542959053568643, 'psi': 0.9975630761648903}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=37 head_norm_before_train=1.965899 cos_to_last_merge=0.7476 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.748
[S10] round=37 local utility u=0.001738 metrics={'f1_val': 0.9950868285240967, 'auprc': 0.9963578940817391, 'loss_val': 0.0286874264389736, 'psi': 0.9955952547471536}-{'f1_val': 0.9946480472226495, 'auprc': 0.9963081285723364, 'loss_val': 0.029382014440422773, 'psi': 0.9953120797625243}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=37 head_norm_before_train=1.597596 cos_to_last_merge=0.9532 (last merge round=21)
[S11] round=37 local utility u=0.010923 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.998076780942226, 'loss_val': 0.04517502889619904, 'psi': 0.9971589150850442}-{'f1_val': 0.9946267592006613, 'auprc': 0.9984527239276952, 'loss_val': 0.0566272898264004, 'psi': 0.9961571450914749}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] START round=37 head_norm_before_train=1.501381 cos_to_last_merge=0.9936 (last merge round=26)
[S13] round=37 local utility u=0.000000 metrics={'f1_val': 0.7107190823044877, 'auprc': 0.717185531716965, 'loss_val': 0.880951815290188, 'psi': 0.7133056620694785}-{'f1_val': 0.7255306224656151, 'auprc': 0.7400201338465009, 'loss_val': 0.6842782906952456, 'psi': 0.7313264270179693}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=37 head_norm_before_train=1.579044 cos_to_last_merge=0.9923 (last merge round=27)
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.8904876307685189, 'auprc': 0.9927046379640491, 'loss_val': 0.37440833807748936, 'psi': 0.931374433646731}-{'f1_val': 0.9058680755317634, 'auprc': 0.9973222626001698, 'loss_val': 0.23632612506487433, 'psi': 0.9424497503591259}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=37 head_norm_before_train=1.570810 cos_to_last_merge=0.9934 (last merge round=28)
[S15] round=37 local utility u=0.000000 metrics={'f1_val': 0.9033321865438193, 'auprc': 0.9929377465848087, 'loss_val': 0.19781778459290453, 'psi': 0.9391744105602151}-{'f1_val': 0.9955024063769649, 'auprc': 0.9953193547272214, 'loss_val': 0.03903537650408335, 'psi': 0.9954291857170675}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=37 head_norm_before_train=1.555319 cos_to_last_merge=0.9899 (last merge round=25)
[S16] round=37 local utility u=0.458882 metrics={'f1_val': 0.9907994898050875, 'auprc': 0.9911939207440021, 'loss_val': 0.05270800644321158, 'psi': 0.9909572621806533}-{'f1_val': 0.9022911084187495, 'auprc': 0.9824386791516606, 'loss_val': 0.41315688518600985, 'psi': 0.9343501367119139}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=37 head_norm_before_train=1.596913 cos_to_last_merge=0.9777 (last merge round=27)
[S17] round=37 local utility u=1.000000 metrics={'f1_val': 0.8140831677035367, 'auprc': 0.9551539139421696, 'loss_val': 0.44465306860824333, 'psi': 0.8705114661989899}-{'f1_val': 0.6150380049133166, 'auprc': 0.7662106943960096, 'loss_val': 1.077776956318776, 'psi': 0.6755070807063939}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S2] START round=38 head_norm_before_train=1.679817 cos_to_last_merge=0.9511 (last merge round=21)
[S2] round=38 local utility u=0.998916 metrics={'f1_val': 0.7099244896978717, 'auprc': 0.9925270412569036, 'loss_val': 0.45125750987608987, 'psi': 0.8229655103214846}-{'f1_val': 0.6688658645425376, 'auprc': 0.6823742214763991, 'loss_val': 1.2722783979708365, 'psi': 0.6742692073160823}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=38 head_norm_before_train=1.996134 cos_to_last_merge=0.9968 (last merge round=28)
[S3] round=38 local utility u=0.000000 metrics={'f1_val': 0.9519279065516568, 'auprc': 0.9999839511963015, 'loss_val': 0.12724989693696862, 'psi': 0.9711503244095147}-{'f1_val': 0.9626780918926742, 'auprc': 0.9999621743807606, 'loss_val': 0.08189744846794628, 'psi': 0.9775917248879088}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=38 head_norm_before_train=1.843513 cos_to_last_merge=0.9947 (last merge round=27)
[S4] round=38 local utility u=0.019293 metrics={'f1_val': 0.9462439893206509, 'auprc': 0.9645265065553587, 'loss_val': 0.2932180120876165, 'psi': 0.953556996214534}-{'f1_val': 0.9413262620742936, 'auprc': 0.9635615600019567, 'loss_val': 0.2994020934580361, 'psi': 0.9502203812453588}
[S4] not sending this round → trigger blocked (psi=0.954)
[S5] START round=38 head_norm_before_train=1.732466 (no previous merge yet)
[S5] round=38 local utility u=0.000000 metrics={'f1_val': 0.6899688896722372, 'auprc': 0.8597696604671083, 'loss_val': 0.3687953588570835, 'psi': 0.7578891979901857}-{'f1_val': 0.7003213174339138, 'auprc': 0.9897875198125063, 'loss_val': 0.27644944350368533, 'psi': 0.8161077983853509}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=38 head_norm_before_train=1.901776 cos_to_last_merge=0.7969 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.797
[S6] round=38 local utility u=0.000000 metrics={'f1_val': 0.5885029180136706, 'auprc': 0.7397199919143735, 'loss_val': 1.3409526424918718, 'psi': 0.6489897475739518}-{'f1_val': 0.8224226413750841, 'auprc': 0.9426411594377729, 'loss_val': 0.3589587401683221, 'psi': 0.8705100486001597}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=38 head_norm_before_train=1.771100 cos_to_last_merge=0.9990 (last merge round=27)
[S7] round=38 local utility u=0.000000 metrics={'f1_val': 0.6379648184422516, 'auprc': 0.7931242302398519, 'loss_val': 0.575628960163558, 'psi': 0.7000285831612918}-{'f1_val': 0.6669403007539099, 'auprc': 0.8337334027533209, 'loss_val': 0.40081890726713476, 'psi': 0.7336575415536744}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=38 head_norm_before_train=1.940095 cos_to_last_merge=0.9994 (last merge round=26)
[S8] round=38 local utility u=0.000000 metrics={'f1_val': 0.9839526961539431, 'auprc': 0.998731498252405, 'loss_val': 0.05035218838671299, 'psi': 0.9898642169933278}-{'f1_val': 0.9922069265978078, 'auprc': 0.998258267678458, 'loss_val': 0.03555378035394863, 'psi': 0.994627463030068}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=38 head_norm_before_train=1.779698 cos_to_last_merge=0.9914 (last merge round=25)
[S9] round=38 local utility u=0.000000 metrics={'f1_val': 0.9427504726632173, 'auprc': 0.9856129073476627, 'loss_val': 0.10459941195203268, 'psi': 0.9598954465369954}-{'f1_val': 0.9908021981609972, 'auprc': 0.9996480038985329, 'loss_val': 0.034887813205154404, 'psi': 0.9943405204560114}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=38 head_norm_before_train=1.974736 cos_to_last_merge=0.7470 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.747
[S10] round=38 local utility u=0.000068 metrics={'f1_val': 0.9950868285240967, 'auprc': 0.996351937913335, 'loss_val': 0.028532899149144433, 'psi': 0.995592872279792}-{'f1_val': 0.9950868285240967, 'auprc': 0.9963578940817391, 'loss_val': 0.0286874264389736, 'psi': 0.9955952547471536}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=38 head_norm_before_train=1.613087 cos_to_last_merge=0.9509 (last merge round=21)
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.9958445741966941, 'auprc': 0.9965915272781694, 'loss_val': 0.042609400410923155, 'psi': 0.9961433554292842}-{'f1_val': 0.9965470045135896, 'auprc': 0.998076780942226, 'loss_val': 0.04517502889619904, 'psi': 0.9971589150850442}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=38 head_norm_before_train=1.516646 cos_to_last_merge=0.9922 (last merge round=26)
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.6284257023963478, 'auprc': 0.6923794551996425, 'loss_val': 0.8643800013690528, 'psi': 0.6540072035176656}-{'f1_val': 0.7107190823044877, 'auprc': 0.717185531716965, 'loss_val': 0.880951815290188, 'psi': 0.7133056620694785}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=38 head_norm_before_train=1.587442 cos_to_last_merge=0.9917 (last merge round=27)
[S14] round=38 local utility u=0.116253 metrics={'f1_val': 0.9038459590433849, 'auprc': 0.9964498900581434, 'loss_val': 0.23328891391964496, 'psi': 0.9408875314492884}-{'f1_val': 0.8904876307685189, 'auprc': 0.9927046379640491, 'loss_val': 0.37440833807748936, 'psi': 0.931374433646731}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] START round=38 head_norm_before_train=1.590188 cos_to_last_merge=0.9924 (last merge round=28)
[S15] round=38 local utility u=0.356205 metrics={'f1_val': 0.9942536406128715, 'auprc': 0.9950836831373946, 'loss_val': 0.0373749010632359, 'psi': 0.9945856576226807}-{'f1_val': 0.9033321865438193, 'auprc': 0.9929377465848087, 'loss_val': 0.19781778459290453, 'psi': 0.9391744105602151}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S15] sending update (kind=head size=1806 to 1 peers)
[S16] START round=38 head_norm_before_train=1.567530 cos_to_last_merge=0.9891 (last merge round=25)
[S16] round=38 local utility u=0.000000 metrics={'f1_val': 0.9846530864275032, 'auprc': 0.9881962230134248, 'loss_val': 0.08717869961582145, 'psi': 0.9860703410618719}-{'f1_val': 0.9907994898050875, 'auprc': 0.9911939207440021, 'loss_val': 0.05270800644321158, 'psi': 0.9909572621806533}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=38 head_norm_before_train=1.614131 cos_to_last_merge=0.9759 (last merge round=27)
[S17] round=38 local utility u=0.146576 metrics={'f1_val': 0.8417183096763012, 'auprc': 0.9717531836833979, 'loss_val': 0.36710957592584026, 'psi': 0.8937322592791399}-{'f1_val': 0.8140831677035367, 'auprc': 0.9551539139421696, 'loss_val': 0.44465306860824333, 'psi': 0.8705114661989899}
[S17] not sending this round → trigger blocked (psi=0.894)
[S2] START round=39 head_norm_before_train=1.696396 cos_to_last_merge=0.9489 (last merge round=21)
[S2] ⚠️ Model drifted since last merge! cos=0.949
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.7110760918094717, 'auprc': 0.9899512313719097, 'loss_val': 0.4582378009410188, 'psi': 0.822626147634447}-{'f1_val': 0.7099244896978717, 'auprc': 0.9925270412569036, 'loss_val': 0.45125750987608987, 'psi': 0.8229655103214846}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=40 psi=0.823 u=0.0000 p_local=0.2422 f1=0.711 auprc=0.990 bytes=30593
[S3] START round=39 head_norm_before_train=2.004786 cos_to_last_merge=0.9964 (last merge round=28)
[S3] round=39 local utility u=0.129546 metrics={'f1_val': 0.9846999350698202, 'auprc': 0.9999610594168519, 'loss_val': 0.06472179178901563, 'psi': 0.990804384808633}-{'f1_val': 0.9519279065516568, 'auprc': 0.9999839511963015, 'loss_val': 0.12724989693696862, 'psi': 0.9711503244095147}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S3] r=40 psi=0.991 u=0.1295 p_local=0.1091 f1=0.985 auprc=1.000 bytes=34207
[S4] START round=39 head_norm_before_train=1.855637 cos_to_last_merge=0.9940 (last merge round=27)
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.9423771833892052, 'auprc': 0.9698163222857958, 'loss_val': 0.3039276887037376, 'psi': 0.9533528389478414}-{'f1_val': 0.9462439893206509, 'auprc': 0.9645265065553587, 'loss_val': 0.2932180120876165, 'psi': 0.953556996214534}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=40 psi=0.953 u=0.0000 p_local=0.1064 f1=0.942 auprc=0.970 bytes=28773
[S5] START round=39 head_norm_before_train=1.738083 (no previous merge yet)
[S5] round=39 local utility u=0.317559 metrics={'f1_val': 0.7039848710232467, 'auprc': 0.9887791817822763, 'loss_val': 0.20480123275615272, 'psi': 0.8179025953268586}-{'f1_val': 0.6899688896722372, 'auprc': 0.8597696604671083, 'loss_val': 0.3687953588570835, 'psi': 0.7578891979901857}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S5] r=40 psi=0.818 u=0.3176 p_local=0.3022 f1=0.704 auprc=0.989 bytes=39562
[S6] START round=39 head_norm_before_train=1.916461 cos_to_last_merge=0.7951 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.795
[S6] round=39 local utility u=1.000000 metrics={'f1_val': 0.7649350630081393, 'auprc': 0.9295125707212474, 'loss_val': 0.6824495746189225, 'psi': 0.8307660660933825}-{'f1_val': 0.5885029180136706, 'auprc': 0.7397199919143735, 'loss_val': 1.3409526424918718, 'psi': 0.6489897475739518}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S6] r=40 psi=0.831 u=1.0000 p_local=0.5020 f1=0.765 auprc=0.930 bytes=32433
[S7] START round=39 head_norm_before_train=1.779055 cos_to_last_merge=0.9987 (last merge round=27)
[S7] round=39 local utility u=0.136747 metrics={'f1_val': 0.6584194738869336, 'auprc': 0.808956183822515, 'loss_val': 0.47235892079248165, 'psi': 0.7186341578611661}-{'f1_val': 0.6379648184422516, 'auprc': 0.7931242302398519, 'loss_val': 0.575628960163558, 'psi': 0.7000285831612918}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S7] r=40 psi=0.719 u=0.1367 p_local=0.2875 f1=0.658 auprc=0.809 bytes=34152
[S8] START round=39 head_norm_before_train=1.949500 cos_to_last_merge=0.9993 (last merge round=26)
[S8] round=39 local utility u=0.037006 metrics={'f1_val': 0.993122746315827, 'auprc': 0.9987896249589738, 'loss_val': 0.03153439278450756, 'psi': 0.9953894977730857}-{'f1_val': 0.9839526961539431, 'auprc': 0.998731498252405, 'loss_val': 0.05035218838671299, 'psi': 0.9898642169933278}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S8] r=40 psi=0.995 u=0.0370 p_local=0.0125 f1=0.993 auprc=0.999 bytes=39600
[S9] START round=39 head_norm_before_train=1.796617 cos_to_last_merge=0.9908 (last merge round=25)
[S9] round=39 local utility u=0.218962 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9966504563637943, 'loss_val': 0.023249267082923356, 'psi': 0.9966564896338526}-{'f1_val': 0.9427504726632173, 'auprc': 0.9856129073476627, 'loss_val': 0.10459941195203268, 'psi': 0.9598954465369954}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S9] r=40 psi=0.997 u=0.2190 p_local=0.0520 f1=0.997 auprc=0.997 bytes=39549
[S10] START round=39 head_norm_before_train=1.985094 cos_to_last_merge=0.7461 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.746
[S10] round=39 local utility u=0.000000 metrics={'f1_val': 0.9944287677762472, 'auprc': 0.9959424814144417, 'loss_val': 0.02932102345429148, 'psi': 0.9950342532315251}-{'f1_val': 0.9950868285240967, 'auprc': 0.996351937913335, 'loss_val': 0.028532899149144433, 'psi': 0.995592872279792}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=40 psi=0.995 u=0.0000 p_local=0.0015 f1=0.994 auprc=0.996 bytes=37800
[S11] START round=39 head_norm_before_train=1.627868 cos_to_last_merge=0.9488 (last merge round=21)
[S11] ⚠️ Model drifted since last merge! cos=0.949
[S11] round=39 local utility u=0.000000 metrics={'f1_val': 0.8267371145676445, 'auprc': 0.9946164876823116, 'loss_val': 0.22712087576148093, 'psi': 0.8938888638135114}-{'f1_val': 0.9958445741966941, 'auprc': 0.9965915272781694, 'loss_val': 0.042609400410923155, 'psi': 0.9961433554292842}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=40 psi=0.894 u=0.0000 p_local=0.0329 f1=0.827 auprc=0.995 bytes=43191
[S13] START round=39 head_norm_before_train=1.525594 cos_to_last_merge=0.9912 (last merge round=26)
[S13] round=39 local utility u=0.386240 metrics={'f1_val': 0.7172553903185075, 'auprc': 0.7127155713985837, 'loss_val': 0.6858861969880401, 'psi': 0.715439462750538}-{'f1_val': 0.6284257023963478, 'auprc': 0.6923794551996425, 'loss_val': 0.8643800013690528, 'psi': 0.6540072035176656}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S13] r=40 psi=0.715 u=0.3862 p_local=0.1475 f1=0.717 auprc=0.713 bytes=30577
[S14] START round=39 head_norm_before_train=1.596962 cos_to_last_merge=0.9910 (last merge round=27)
[S14] round=39 local utility u=0.000000 metrics={'f1_val': 0.8625697000724692, 'auprc': 0.996217133621635, 'loss_val': 0.30379132772225476, 'psi': 0.9160286734921355}-{'f1_val': 0.9038459590433849, 'auprc': 0.9964498900581434, 'loss_val': 0.23328891391964496, 'psi': 0.9408875314492884}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=40 psi=0.916 u=0.0000 p_local=0.0672 f1=0.863 auprc=0.996 bytes=35999
[S15] START round=39 head_norm_before_train=1.607959 cos_to_last_merge=0.9915 (last merge round=28)
[S15] round=39 local utility u=0.000000 metrics={'f1_val': 0.7007659221024161, 'auprc': 0.9882817603588194, 'loss_val': 0.5622300084888514, 'psi': 0.8157722574049775}-{'f1_val': 0.9942536406128715, 'auprc': 0.9950836831373946, 'loss_val': 0.0373749010632359, 'psi': 0.9945856576226807}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=40 psi=0.816 u=0.0000 p_local=0.2727 f1=0.701 auprc=0.988 bytes=36008
[S16] START round=39 head_norm_before_train=1.579332 cos_to_last_merge=0.9884 (last merge round=25)
[S16] round=39 local utility u=0.000000 metrics={'f1_val': 0.948395557809103, 'auprc': 0.9857863714454528, 'loss_val': 0.13405660499644007, 'psi': 0.963351883263643}-{'f1_val': 0.9846530864275032, 'auprc': 0.9881962230134248, 'loss_val': 0.08717869961582145, 'psi': 0.9860703410618719}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=40 psi=0.963 u=0.0000 p_local=0.1406 f1=0.948 auprc=0.986 bytes=35970
[S17] START round=39 head_norm_before_train=1.633090 cos_to_last_merge=0.9740 (last merge round=27)
[S17] round=39 local utility u=0.000000 metrics={'f1_val': 0.6370435771048883, 'auprc': 0.9041122588028556, 'loss_val': 0.9713669810192674, 'psi': 0.7438710497840753}-{'f1_val': 0.8417183096763012, 'auprc': 0.9717531836833979, 'loss_val': 0.36710957592584026, 'psi': 0.8937322592791399}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=40 psi=0.744 u=0.0000 p_local=0.3006 f1=0.637 auprc=0.904 bytes=36027
[S2] START round=40 head_norm_before_train=1.713335 cos_to_last_merge=0.9468 (last merge round=21)
[S2] ⚠️ Model drifted since last merge! cos=0.947
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.6911427057328324, 'auprc': 0.8057932200660223, 'loss_val': 0.6618103127676171, 'psi': 0.7370029114661083}-{'f1_val': 0.7110760918094717, 'auprc': 0.9899512313719097, 'loss_val': 0.4582378009410188, 'psi': 0.822626147634447}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=40 head_norm_before_train=2.013502 cos_to_last_merge=0.9960 (last merge round=28)
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.9611152572344858, 'auprc': 0.9999539628056896, 'loss_val': 0.08561445958412364, 'psi': 0.9766507394629673}-{'f1_val': 0.9846999350698202, 'auprc': 0.9999610594168519, 'loss_val': 0.06472179178901563, 'psi': 0.990804384808633}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=40 head_norm_before_train=1.867718 cos_to_last_merge=0.9934 (last merge round=27)
[S4] round=40 local utility u=0.000032 metrics={'f1_val': 0.9422168058248317, 'auprc': 0.9716717173226894, 'loss_val': 0.3084674305135123, 'psi': 0.9539987704239747}-{'f1_val': 0.9423771833892052, 'auprc': 0.9698163222857958, 'loss_val': 0.3039276887037376, 'psi': 0.9533528389478414}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=40 head_norm_before_train=1.744313 (no previous merge yet)
[S5] round=40 local utility u=0.000000 metrics={'f1_val': 0.5978710660876028, 'auprc': 0.8559864998742348, 'loss_val': 0.5559588797670671, 'psi': 0.7011172396022556}-{'f1_val': 0.7039848710232467, 'auprc': 0.9887791817822763, 'loss_val': 0.20480123275615272, 'psi': 0.8179025953268586}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=40 head_norm_before_train=1.930294 cos_to_last_merge=0.7934 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.793
[S6] round=40 local utility u=0.864308 metrics={'f1_val': 0.9558495975048125, 'auprc': 0.9554879733215189, 'loss_val': 0.17724710579980202, 'psi': 0.955704947831495}-{'f1_val': 0.7649350630081393, 'auprc': 0.9295125707212474, 'loss_val': 0.6824495746189225, 'psi': 0.8307660660933825}
[S6] not sending this round → trigger blocked (psi=0.956)
[S7] START round=40 head_norm_before_train=1.784824 cos_to_last_merge=0.9985 (last merge round=27)
[S7] round=40 local utility u=0.000000 metrics={'f1_val': 0.5713959287532139, 'auprc': 0.781948922351542, 'loss_val': 0.7198096100555823, 'psi': 0.6556171261925452}-{'f1_val': 0.6584194738869336, 'auprc': 0.808956183822515, 'loss_val': 0.47235892079248165, 'psi': 0.7186341578611661}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=40 head_norm_before_train=1.957443 cos_to_last_merge=0.9992 (last merge round=26)
[S8] round=40 local utility u=0.000967 metrics={'f1_val': 0.9934316588652294, 'auprc': 0.998671022900091, 'loss_val': 0.03109712153185631, 'psi': 0.9955274044791741}-{'f1_val': 0.993122746315827, 'auprc': 0.9987896249589738, 'loss_val': 0.03153439278450756, 'psi': 0.9953894977730857}
[S8] not sending this round → trigger blocked (psi=0.996)
[S9] START round=40 head_norm_before_train=1.808501 cos_to_last_merge=0.9904 (last merge round=25)
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9939439676146453, 'loss_val': 0.0238601968032221, 'psi': 0.9953276439134247}-{'f1_val': 0.9966605118138915, 'auprc': 0.9966504563637943, 'loss_val': 0.023249267082923356, 'psi': 0.9966564896338526}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=40 head_norm_before_train=1.991924 cos_to_last_merge=0.7458 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.746
[S10] round=40 local utility u=0.002362 metrics={'f1_val': 0.9950868285240967, 'auprc': 0.9958732419651253, 'loss_val': 0.028337660274706272, 'psi': 0.9954013939005081}-{'f1_val': 0.9944287677762472, 'auprc': 0.9959424814144417, 'loss_val': 0.02932102345429148, 'psi': 0.9950342532315251}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=40 head_norm_before_train=1.641832 cos_to_last_merge=0.9471 (last merge round=21)
[S11] ⚠️ Model drifted since last merge! cos=0.947
[S11] round=40 local utility u=0.603345 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9961699035876275, 'loss_val': 0.041593682063390355, 'psi': 0.9961604462814982}-{'f1_val': 0.8267371145676445, 'auprc': 0.9946164876823116, 'loss_val': 0.22712087576148093, 'psi': 0.8938888638135114}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S11] sending update (kind=head size=1806 to 1 peers)
[S13] START round=40 head_norm_before_train=1.534541 cos_to_last_merge=0.9906 (last merge round=26)
[S13] round=40 local utility u=0.000000 metrics={'f1_val': 0.6188535198243197, 'auprc': 0.7125739754008179, 'loss_val': 0.9463876055650667, 'psi': 0.6563417020549189}-{'f1_val': 0.7172553903185075, 'auprc': 0.7127155713985837, 'loss_val': 0.6858861969880401, 'psi': 0.715439462750538}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=40 head_norm_before_train=1.609087 cos_to_last_merge=0.9902 (last merge round=27)
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.8840209072162454, 'auprc': 0.9932092919362745, 'loss_val': 0.44938099115437774, 'psi': 0.927696261104257}-{'f1_val': 0.8625697000724692, 'auprc': 0.996217133621635, 'loss_val': 0.30379132772225476, 'psi': 0.9160286734921355}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=40 head_norm_before_train=1.626292 cos_to_last_merge=0.9906 (last merge round=28)
[S15] round=40 local utility u=1.000000 metrics={'f1_val': 0.9963164379542544, 'auprc': 0.9923048589594066, 'loss_val': 0.027577850904511574, 'psi': 0.9947118063563153}-{'f1_val': 0.7007659221024161, 'auprc': 0.9882817603588194, 'loss_val': 0.5622300084888514, 'psi': 0.8157722574049775}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=40 head_norm_before_train=1.591453 cos_to_last_merge=0.9876 (last merge round=25)
[S16] round=40 local utility u=0.178631 metrics={'f1_val': 0.9915364364988188, 'auprc': 0.9905563489030015, 'loss_val': 0.04995035179855447, 'psi': 0.991144401460492}-{'f1_val': 0.948395557809103, 'auprc': 0.9857863714454528, 'loss_val': 0.13405660499644007, 'psi': 0.963351883263643}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=40 head_norm_before_train=1.645573 cos_to_last_merge=0.9726 (last merge round=27)
[S17] round=40 local utility u=0.815432 metrics={'f1_val': 0.8055709381063797, 'auprc': 0.9262905176941293, 'loss_val': 0.4182018825470101, 'psi': 0.8538587699414796}-{'f1_val': 0.6370435771048883, 'auprc': 0.9041122588028556, 'loss_val': 0.9713669810192674, 'psi': 0.7438710497840753}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=41 head_norm_before_train=1.725420 cos_to_last_merge=0.9453 (last merge round=21)
[S2] ⚠️ Model drifted since last merge! cos=0.945
[S2] round=41 local utility u=0.177948 metrics={'f1_val': 0.6995572189873773, 'auprc': 0.8598909821292596, 'loss_val': 0.518695066686185, 'psi': 0.7636907242441302}-{'f1_val': 0.6911427057328324, 'auprc': 0.8057932200660223, 'loss_val': 0.6618103127676171, 'psi': 0.7370029114661083}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=41 head_norm_before_train=2.020746 cos_to_last_merge=0.9957 (last merge round=28)
[S3] round=41 local utility u=0.000000 metrics={'f1_val': 0.9490612345985034, 'auprc': 0.9998906848730116, 'loss_val': 0.12397131177077848, 'psi': 0.9693930147083066}-{'f1_val': 0.9611152572344858, 'auprc': 0.9999539628056896, 'loss_val': 0.08561445958412364, 'psi': 0.9766507394629673}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=41 head_norm_before_train=1.876503 cos_to_last_merge=0.9928 (last merge round=27)
[S4] round=41 local utility u=0.002505 metrics={'f1_val': 0.9427457248679905, 'auprc': 0.9714415553708147, 'loss_val': 0.30593976679589613, 'psi': 0.9542240570691202}-{'f1_val': 0.9422168058248317, 'auprc': 0.9716717173226894, 'loss_val': 0.3084674305135123, 'psi': 0.9539987704239747}
[S4] not sending this round → trigger blocked (psi=0.954)
[S5] START round=41 head_norm_before_train=1.751326 (no previous merge yet)
[S5] round=41 local utility u=0.681243 metrics={'f1_val': 0.7004932948021524, 'auprc': 0.9903068355002, 'loss_val': 0.21216752089469046, 'psi': 0.8164187110813714}-{'f1_val': 0.5978710660876028, 'auprc': 0.8559864998742348, 'loss_val': 0.5559588797670671, 'psi': 0.7011172396022556}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=41 head_norm_before_train=1.945087 cos_to_last_merge=0.7920 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.792
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.5837629574301291, 'auprc': 0.8148979990620474, 'loss_val': 1.3605604636438984, 'psi': 0.6762169740828965}-{'f1_val': 0.9558495975048125, 'auprc': 0.9554879733215189, 'loss_val': 0.17724710579980202, 'psi': 0.955704947831495}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=41 head_norm_before_train=1.788965 cos_to_last_merge=0.9984 (last merge round=27)
[S7] round=41 local utility u=0.435438 metrics={'f1_val': 0.6578107978027077, 'auprc': 0.8088321203269188, 'loss_val': 0.44807193063192885, 'psi': 0.7182193268123922}-{'f1_val': 0.5713959287532139, 'auprc': 0.781948922351542, 'loss_val': 0.7198096100555823, 'psi': 0.6556171261925452}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=41 head_norm_before_train=1.963381 cos_to_last_merge=0.9991 (last merge round=26)
[S8] round=41 local utility u=0.000000 metrics={'f1_val': 0.9860710398489039, 'auprc': 0.9985472246148701, 'loss_val': 0.04504518687623655, 'psi': 0.9910615137552904}-{'f1_val': 0.9934316588652294, 'auprc': 0.998671022900091, 'loss_val': 0.03109712153185631, 'psi': 0.9955274044791741}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=41 head_norm_before_train=1.819063 cos_to_last_merge=0.9900 (last merge round=25)
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.9650969729462802, 'auprc': 0.9835040195573519, 'loss_val': 0.0962547507405278, 'psi': 0.9724597915907088}-{'f1_val': 0.9962500947792776, 'auprc': 0.9939439676146453, 'loss_val': 0.0238601968032221, 'psi': 0.9953276439134247}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=41 head_norm_before_train=1.998980 cos_to_last_merge=0.7453 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.745
[S10] round=41 local utility u=0.000921 metrics={'f1_val': 0.9953063309450747, 'auprc': 0.9959142496427338, 'loss_val': 0.027936464102162623, 'psi': 0.9955494984241384}-{'f1_val': 0.9950868285240967, 'auprc': 0.9958732419651253, 'loss_val': 0.028337660274706272, 'psi': 0.9954013939005081}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=41 head_norm_before_train=1.656685 cos_to_last_merge=0.9451 (last merge round=21)
[S11] ⚠️ Model drifted since last merge! cos=0.945
[S11] round=41 local utility u=0.006370 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.997564375590839, 'loss_val': 0.03539441250994196, 'psi': 0.9969539529444893}-{'f1_val': 0.9961541414107454, 'auprc': 0.9961699035876275, 'loss_val': 0.041593682063390355, 'psi': 0.9961604462814982}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=41 head_norm_before_train=1.542416 cos_to_last_merge=0.9900 (last merge round=26)
[S13] round=41 local utility u=0.444011 metrics={'f1_val': 0.7289116308076544, 'auprc': 0.7106921551938613, 'loss_val': 0.7130697696691519, 'psi': 0.7216238405621371}-{'f1_val': 0.6188535198243197, 'auprc': 0.7125739754008179, 'loss_val': 0.9463876055650667, 'psi': 0.6563417020549189}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=41 head_norm_before_train=1.622310 cos_to_last_merge=0.9894 (last merge round=27)
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.8876357092653642, 'auprc': 0.9909392038120229, 'loss_val': 0.5072462376087086, 'psi': 0.9289571070840277}-{'f1_val': 0.8840209072162454, 'auprc': 0.9932092919362745, 'loss_val': 0.44938099115437774, 'psi': 0.927696261104257}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=41 head_norm_before_train=1.642931 cos_to_last_merge=0.9896 (last merge round=28)
[S15] round=41 local utility u=0.002648 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.992900957971311, 'loss_val': 0.026652208223317455, 'psi': 0.9952083842210367}-{'f1_val': 0.9963164379542544, 'auprc': 0.9923048589594066, 'loss_val': 0.027577850904511574, 'psi': 0.9947118063563153}
[S15] not sending this round → trigger blocked (psi=0.995)
[S16] START round=41 head_norm_before_train=1.603647 cos_to_last_merge=0.9869 (last merge round=25)
[S16] round=41 local utility u=0.001657 metrics={'f1_val': 0.991584132165747, 'auprc': 0.9912654852947216, 'loss_val': 0.04904973957251529, 'psi': 0.9914566734173369}-{'f1_val': 0.9915364364988188, 'auprc': 0.9905563489030015, 'loss_val': 0.04995035179855447, 'psi': 0.991144401460492}
[S16] not sending this round → trigger blocked (psi=0.991)
[S17] START round=41 head_norm_before_train=1.661687 cos_to_last_merge=0.9708 (last merge round=27)
[S17] round=41 local utility u=0.000000 metrics={'f1_val': 0.6456099032528916, 'auprc': 0.936488004715508, 'loss_val': 0.7860592912626709, 'psi': 0.7619611438379381}-{'f1_val': 0.8055709381063797, 'auprc': 0.9262905176941293, 'loss_val': 0.4182018825470101, 'psi': 0.8538587699414796}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=42 head_norm_before_train=1.741856 cos_to_last_merge=0.9433 (last merge round=21)
[S2] ⚠️ Model drifted since last merge! cos=0.943
[S2] round=42 local utility u=0.000000 metrics={'f1_val': 0.6686032956792104, 'auprc': 0.7424717311547865, 'loss_val': 1.3196297528924181, 'psi': 0.6981506698694409}-{'f1_val': 0.6995572189873773, 'auprc': 0.8598909821292596, 'loss_val': 0.518695066686185, 'psi': 0.7636907242441302}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=42 head_norm_before_train=2.027482 cos_to_last_merge=0.9954 (last merge round=28)
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.7244308060177073, 'auprc': 0.9986580241716079, 'loss_val': 0.39954481601079556, 'psi': 0.8341216932792676}-{'f1_val': 0.9490612345985034, 'auprc': 0.9998906848730116, 'loss_val': 0.12397131177077848, 'psi': 0.9693930147083066}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=42 head_norm_before_train=1.883759 cos_to_last_merge=0.9925 (last merge round=27)
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.947144258757667, 'auprc': 0.9588911229818243, 'loss_val': 0.3032030606586398, 'psi': 0.9518430044473298}-{'f1_val': 0.9427457248679905, 'auprc': 0.9714415553708147, 'loss_val': 0.30593976679589613, 'psi': 0.9542240570691202}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=42 head_norm_before_train=1.759107 (no previous merge yet)
[S5] round=42 local utility u=0.000000 metrics={'f1_val': 0.6624011752293086, 'auprc': 0.858870080387865, 'loss_val': 0.5130153836003919, 'psi': 0.7409887372927313}-{'f1_val': 0.7004932948021524, 'auprc': 0.9903068355002, 'loss_val': 0.21216752089469046, 'psi': 0.8164187110813714}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=42 head_norm_before_train=1.954212 cos_to_last_merge=0.7912 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.791
[S6] round=42 local utility u=0.768660 metrics={'f1_val': 0.7492080203806859, 'auprc': 0.837665155103175, 'loss_val': 0.8842119504046442, 'psi': 0.7845908742696814}-{'f1_val': 0.5837629574301291, 'auprc': 0.8148979990620474, 'loss_val': 1.3605604636438984, 'psi': 0.6762169740828965}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=42 head_norm_before_train=1.796359 cos_to_last_merge=0.9981 (last merge round=27)
[S7] round=42 local utility u=0.000000 metrics={'f1_val': 0.5761288416741456, 'auprc': 0.7824500294311795, 'loss_val': 0.7555215011319945, 'psi': 0.6586573167769592}-{'f1_val': 0.6578107978027077, 'auprc': 0.8088321203269188, 'loss_val': 0.44807193063192885, 'psi': 0.7182193268123922}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=42 head_norm_before_train=1.973865 cos_to_last_merge=0.9989 (last merge round=26)
[S8] round=42 local utility u=0.025829 metrics={'f1_val': 0.9925712794554754, 'auprc': 0.9988244464891596, 'loss_val': 0.033219525522369564, 'psi': 0.995072546268949}-{'f1_val': 0.9860710398489039, 'auprc': 0.9985472246148701, 'loss_val': 0.04504518687623655, 'psi': 0.9910615137552904}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=42 head_norm_before_train=1.830094 cos_to_last_merge=0.9895 (last merge round=25)
[S9] round=42 local utility u=0.150970 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9963627066393201, 'loss_val': 0.02227161881865762, 'psi': 0.9965413897440629}-{'f1_val': 0.9650969729462802, 'auprc': 0.9835040195573519, 'loss_val': 0.0962547507405278, 'psi': 0.9724597915907088}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=42 head_norm_before_train=2.008380 cos_to_last_merge=0.7445 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.745
[S10] round=42 local utility u=0.000000 metrics={'f1_val': 0.9944287677762472, 'auprc': 0.9959188199424154, 'loss_val': 0.02905422133372634, 'psi': 0.9950247886427145}-{'f1_val': 0.9953063309450747, 'auprc': 0.9959142496427338, 'loss_val': 0.027936464102162623, 'psi': 0.9955494984241384}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=42 head_norm_before_train=1.670527 cos_to_last_merge=0.9432 (last merge round=21)
[S11] ⚠️ Model drifted since last merge! cos=0.943
[S11] round=42 local utility u=0.000000 metrics={'f1_val': 0.9928895862972394, 'auprc': 0.9981295612481647, 'loss_val': 0.0420803583088584, 'psi': 0.9949855762776095}-{'f1_val': 0.9965470045135896, 'auprc': 0.997564375590839, 'loss_val': 0.03539441250994196, 'psi': 0.9969539529444893}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=42 head_norm_before_train=1.551415 cos_to_last_merge=0.9894 (last merge round=26)
[S13] round=42 local utility u=0.000000 metrics={'f1_val': 0.6465920454109776, 'auprc': 0.645405327129519, 'loss_val': 0.9944501521185366, 'psi': 0.6461173580983941}-{'f1_val': 0.7289116308076544, 'auprc': 0.7106921551938613, 'loss_val': 0.7130697696691519, 'psi': 0.7216238405621371}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=42 head_norm_before_train=1.635618 cos_to_last_merge=0.9885 (last merge round=27)
[S14] round=42 local utility u=0.138591 metrics={'f1_val': 0.8905508473638242, 'auprc': 0.9985249962877213, 'loss_val': 0.2703131269813922, 'psi': 0.933740506933383}-{'f1_val': 0.8876357092653642, 'auprc': 0.9909392038120229, 'loss_val': 0.5072462376087086, 'psi': 0.9289571070840277}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=42 head_norm_before_train=1.658464 cos_to_last_merge=0.9887 (last merge round=28)
[S15] round=42 local utility u=0.000000 metrics={'f1_val': 0.7839858166830405, 'auprc': 0.9929504806523292, 'loss_val': 0.4099835767426382, 'psi': 0.867571682270756}-{'f1_val': 0.9967466683875206, 'auprc': 0.992900957971311, 'loss_val': 0.026652208223317455, 'psi': 0.9952083842210367}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=42 head_norm_before_train=1.614625 cos_to_last_merge=0.9862 (last merge round=25)
[S16] round=42 local utility u=0.000000 metrics={'f1_val': 0.9898557143021112, 'auprc': 0.9918743949543114, 'loss_val': 0.0518374414146809, 'psi': 0.9906631865629913}-{'f1_val': 0.991584132165747, 'auprc': 0.9912654852947216, 'loss_val': 0.04904973957251529, 'psi': 0.9914566734173369}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=42 head_norm_before_train=1.680963 cos_to_last_merge=0.9687 (last merge round=27)
[S17] round=42 local utility u=0.776250 metrics={'f1_val': 0.8305976624835786, 'auprc': 0.963629766986905, 'loss_val': 0.4249110706028188, 'psi': 0.8838105042849091}-{'f1_val': 0.6456099032528916, 'auprc': 0.936488004715508, 'loss_val': 0.7860592912626709, 'psi': 0.7619611438379381}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=43 head_norm_before_train=1.757145 cos_to_last_merge=0.9413 (last merge round=21)
[S2] ⚠️ Model drifted since last merge! cos=0.941
[S2] round=43 local utility u=0.717312 metrics={'f1_val': 0.72033150436621, 'auprc': 0.8454304250085861, 'loss_val': 0.5042504235718598, 'psi': 0.7703710726231605}-{'f1_val': 0.6686032956792104, 'auprc': 0.7424717311547865, 'loss_val': 1.3196297528924181, 'psi': 0.6981506698694409}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] sending update (kind=head size=1805 to 1 peers)
[S3] START round=43 head_norm_before_train=2.034158 cos_to_last_merge=0.9951 (last merge round=28)
[S3] round=43 local utility u=0.428307 metrics={'f1_val': 0.8419046723372778, 'auprc': 0.9988420775360297, 'loss_val': 0.24832655227090558, 'psi': 0.9046796344167787}-{'f1_val': 0.7244308060177073, 'auprc': 0.9986580241716079, 'loss_val': 0.39954481601079556, 'psi': 0.8341216932792676}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] sending update (kind=head size=1793 to 1 peers)
[S4] START round=43 head_norm_before_train=1.890087 cos_to_last_merge=0.9920 (last merge round=27)
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.9433108175456578, 'auprc': 0.9574303562981727, 'loss_val': 0.30881331056605776, 'psi': 0.9489586330466638}-{'f1_val': 0.947144258757667, 'auprc': 0.9588911229818243, 'loss_val': 0.3032030606586398, 'psi': 0.9518430044473298}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=43 head_norm_before_train=1.764917 (no previous merge yet)
[S5] round=43 local utility u=0.679163 metrics={'f1_val': 0.7608029705724411, 'auprc': 0.9947414791191138, 'loss_val': 0.1527133732106687, 'psi': 0.8543783739911102}-{'f1_val': 0.6624011752293086, 'auprc': 0.858870080387865, 'loss_val': 0.5130153836003919, 'psi': 0.7409887372927313}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=43 head_norm_before_train=1.965808 cos_to_last_merge=0.7905 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.790
[S6] round=43 local utility u=0.526108 metrics={'f1_val': 0.8097158654422131, 'auprc': 0.9176426919920522, 'loss_val': 0.4349765507424583, 'psi': 0.8528865960621487}-{'f1_val': 0.7492080203806859, 'auprc': 0.837665155103175, 'loss_val': 0.8842119504046442, 'psi': 0.7845908742696814}
[S6] not sending this round → trigger blocked (psi=0.853)
[S7] START round=43 head_norm_before_train=1.806624 cos_to_last_merge=0.9977 (last merge round=27)
[S7] round=43 local utility u=0.510167 metrics={'f1_val': 0.6661540838250086, 'auprc': 0.8312531141547375, 'loss_val': 0.42174779321283157, 'psi': 0.7321936959569002}-{'f1_val': 0.5761288416741456, 'auprc': 0.7824500294311795, 'loss_val': 0.7555215011319945, 'psi': 0.6586573167769592}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] START round=43 head_norm_before_train=1.980915 cos_to_last_merge=0.9988 (last merge round=26)
[S8] round=43 local utility u=0.000000 metrics={'f1_val': 0.9921646161217188, 'auprc': 0.9985587851140253, 'loss_val': 0.03370838725341947, 'psi': 0.9947222837186415}-{'f1_val': 0.9925712794554754, 'auprc': 0.9988244464891596, 'loss_val': 0.033219525522369564, 'psi': 0.995072546268949}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=43 head_norm_before_train=1.840453 cos_to_last_merge=0.9891 (last merge round=25)
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9927118840760805, 'loss_val': 0.023669083101446754, 'psi': 0.9948348104979987}-{'f1_val': 0.9966605118138915, 'auprc': 0.9963627066393201, 'loss_val': 0.02227161881865762, 'psi': 0.9965413897440629}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=43 head_norm_before_train=2.018354 cos_to_last_merge=0.7436 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.744
[S10] round=43 local utility u=0.003225 metrics={'f1_val': 0.9953063309450747, 'auprc': 0.9959096765327451, 'loss_val': 0.027842423433950412, 'psi': 0.9955476691801429}-{'f1_val': 0.9944287677762472, 'auprc': 0.9959188199424154, 'loss_val': 0.02905422133372634, 'psi': 0.9950247886427145}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=43 head_norm_before_train=1.682853 cos_to_last_merge=0.9416 (last merge round=21)
[S11] ⚠️ Model drifted since last merge! cos=0.942
[S11] round=43 local utility u=0.000000 metrics={'f1_val': 0.9617681924714565, 'auprc': 0.997874052342032, 'loss_val': 0.06807351646816323, 'psi': 0.9762105364196867}-{'f1_val': 0.9928895862972394, 'auprc': 0.9981295612481647, 'loss_val': 0.0420803583088584, 'psi': 0.9949855762776095}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=43 head_norm_before_train=1.559965 cos_to_last_merge=0.9887 (last merge round=26)
[S13] round=43 local utility u=0.421813 metrics={'f1_val': 0.72500963304385, 'auprc': 0.7026195197026542, 'loss_val': 0.7929718493197042, 'psi': 0.7160535877073717}-{'f1_val': 0.6465920454109776, 'auprc': 0.645405327129519, 'loss_val': 0.9944501521185366, 'psi': 0.6461173580983941}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=43 head_norm_before_train=1.647167 cos_to_last_merge=0.9878 (last merge round=27)
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.8306040040237501, 'auprc': 0.9774188941548703, 'loss_val': 0.64382788505303, 'psi': 0.8893299600761981}-{'f1_val': 0.8905508473638242, 'auprc': 0.9985249962877213, 'loss_val': 0.2703131269813922, 'psi': 0.933740506933383}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=43 head_norm_before_train=1.672511 cos_to_last_merge=0.9879 (last merge round=28)
[S15] round=43 local utility u=0.553664 metrics={'f1_val': 0.922304964278244, 'auprc': 0.992676217172789, 'loss_val': 0.13174701240788753, 'psi': 0.950453465436062}-{'f1_val': 0.7839858166830405, 'auprc': 0.9929504806523292, 'loss_val': 0.4099835767426382, 'psi': 0.867571682270756}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] sending update (kind=head size=1792 to 1 peers)
[S16] START round=43 head_norm_before_train=1.625805 cos_to_last_merge=0.9855 (last merge round=25)
[S16] round=43 local utility u=0.000000 metrics={'f1_val': 0.8759950654295979, 'auprc': 0.9839298122971163, 'loss_val': 0.5155490853494269, 'psi': 0.9191689641766052}-{'f1_val': 0.9898557143021112, 'auprc': 0.9918743949543114, 'loss_val': 0.0518374414146809, 'psi': 0.9906631865629913}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=43 head_norm_before_train=1.698545 cos_to_last_merge=0.9670 (last merge round=27)
[S17] round=43 local utility u=0.000000 metrics={'f1_val': 0.6266158134941388, 'auprc': 0.857544149428926, 'loss_val': 1.048481598291489, 'psi': 0.7189871478680536}-{'f1_val': 0.8305976624835786, 'auprc': 0.963629766986905, 'loss_val': 0.4249110706028188, 'psi': 0.8838105042849091}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=44 head_norm_before_train=1.770441 cos_to_last_merge=0.9396 (last merge round=21)
[S2] ⚠️ Model drifted since last merge! cos=0.940
[S2] round=44 local utility u=0.133435 metrics={'f1_val': 0.7101812175379715, 'auprc': 0.9535250623308038, 'loss_val': 0.5007617505337664, 'psi': 0.8075187554551044}-{'f1_val': 0.72033150436621, 'auprc': 0.8454304250085861, 'loss_val': 0.5042504235718598, 'psi': 0.7703710726231605}
[S2] not sending this round → trigger blocked (psi=0.808)
[S3] START round=44 head_norm_before_train=2.041447 cos_to_last_merge=0.9948 (last merge round=28)
[S3] round=44 local utility u=0.399360 metrics={'f1_val': 0.9510612893582964, 'auprc': 0.9998736851372979, 'loss_val': 0.10764161622069433, 'psi': 0.970586247669897}-{'f1_val': 0.8419046723372778, 'auprc': 0.9988420775360297, 'loss_val': 0.24832655227090558, 'psi': 0.9046796344167787}
[S3] not sending this round → trigger blocked (psi=0.971)
[S4] START round=44 head_norm_before_train=1.900482 cos_to_last_merge=0.9916 (last merge round=27)
[S4] round=44 local utility u=0.000000 metrics={'f1_val': 0.9427166995961582, 'auprc': 0.9582648065405094, 'loss_val': 0.3097591672200042, 'psi': 0.9489359423738987}-{'f1_val': 0.9433108175456578, 'auprc': 0.9574303562981727, 'loss_val': 0.30881331056605776, 'psi': 0.9489586330466638}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=44 head_norm_before_train=1.768110 (no previous merge yet)
[S5] round=44 local utility u=0.000000 metrics={'f1_val': 0.7004069097142683, 'auprc': 0.9489827400611768, 'loss_val': 0.2735933197503882, 'psi': 0.7998372418530317}-{'f1_val': 0.7608029705724411, 'auprc': 0.9947414791191138, 'loss_val': 0.1527133732106687, 'psi': 0.8543783739911102}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=44 head_norm_before_train=1.979703 cos_to_last_merge=0.7890 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.789
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.8075774420527304, 'auprc': 0.9220033772060535, 'loss_val': 0.5076446078671699, 'psi': 0.8533478161140597}-{'f1_val': 0.8097158654422131, 'auprc': 0.9176426919920522, 'loss_val': 0.4349765507424583, 'psi': 0.8528865960621487}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=44 head_norm_before_train=1.817383 cos_to_last_merge=0.9973 (last merge round=27)
[S7] round=44 local utility u=0.000000 metrics={'f1_val': 0.641690021219513, 'auprc': 0.796891443538716, 'loss_val': 0.5855788005528604, 'psi': 0.7037705901471942}-{'f1_val': 0.6661540838250086, 'auprc': 0.8312531141547375, 'loss_val': 0.42174779321283157, 'psi': 0.7321936959569002}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=44 head_norm_before_train=1.983217 cos_to_last_merge=0.9987 (last merge round=26)
[S8] round=44 local utility u=0.001011 metrics={'f1_val': 0.9921646161217188, 'auprc': 0.998864543508255, 'loss_val': 0.0326046536299328, 'psi': 0.9948445870763334}-{'f1_val': 0.9921646161217188, 'auprc': 0.9985587851140253, 'loss_val': 0.03370838725341947, 'psi': 0.9947222837186415}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=44 head_norm_before_train=1.851938 cos_to_last_merge=0.9887 (last merge round=25)
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.9892714523047061, 'auprc': 0.9954291102166325, 'loss_val': 0.04191111861607419, 'psi': 0.9917345154694768}-{'f1_val': 0.9962500947792776, 'auprc': 0.9927118840760805, 'loss_val': 0.023669083101446754, 'psi': 0.9948348104979987}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=44 head_norm_before_train=2.021459 cos_to_last_merge=0.7438 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.744
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.9948674007110037, 'auprc': 0.9956673453322908, 'loss_val': 0.028064378873640425, 'psi': 0.9951873785595186}-{'f1_val': 0.9953063309450747, 'auprc': 0.9959096765327451, 'loss_val': 0.027842423433950412, 'psi': 0.9955476691801429}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=44 head_norm_before_train=1.694678 cos_to_last_merge=0.9401 (last merge round=21)
[S11] ⚠️ Model drifted since last merge! cos=0.940
[S11] round=44 local utility u=0.067254 metrics={'f1_val': 0.981169186686789, 'auprc': 0.9975116353287015, 'loss_val': 0.04888459859931362, 'psi': 0.987706166143554}-{'f1_val': 0.9617681924714565, 'auprc': 0.997874052342032, 'loss_val': 0.06807351646816323, 'psi': 0.9762105364196867}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=44 head_norm_before_train=1.565165 cos_to_last_merge=0.9886 (last merge round=26)
[S13] round=44 local utility u=0.132344 metrics={'f1_val': 0.7199616379580243, 'auprc': 0.7361209545062684, 'loss_val': 0.5984998281381236, 'psi': 0.726425364577322}-{'f1_val': 0.72500963304385, 'auprc': 0.7026195197026542, 'loss_val': 0.7929718493197042, 'psi': 0.7160535877073717}
[S13] not sending this round → trigger blocked (psi=0.726)
[S14] START round=44 head_norm_before_train=1.656428 cos_to_last_merge=0.9869 (last merge round=27)
[S14] round=44 local utility u=0.476080 metrics={'f1_val': 0.9057586041152513, 'auprc': 0.9985410715476006, 'loss_val': 0.20596279100091153, 'psi': 0.9428715910881911}-{'f1_val': 0.8306040040237501, 'auprc': 0.9774188941548703, 'loss_val': 0.64382788505303, 'psi': 0.8893299600761981}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] START round=44 head_norm_before_train=1.685921 cos_to_last_merge=0.9871 (last merge round=28)
[S15] round=44 local utility u=0.282116 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9965312733571586, 'loss_val': 0.025730477728186773, 'psi': 0.9966605103753758}-{'f1_val': 0.922304964278244, 'auprc': 0.992676217172789, 'loss_val': 0.13174701240788753, 'psi': 0.950453465436062}
[S15] not sending this round → trigger blocked (psi=0.997)
[S16] START round=44 head_norm_before_train=1.635565 cos_to_last_merge=0.9849 (last merge round=25)
[S16] round=44 local utility u=0.579999 metrics={'f1_val': 0.989881232674883, 'auprc': 0.9896569999757305, 'loss_val': 0.05605020467670973, 'psi': 0.9897915395952219}-{'f1_val': 0.8759950654295979, 'auprc': 0.9839298122971163, 'loss_val': 0.5155490853494269, 'psi': 0.9191689641766052}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] sending update (kind=head size=1804 to 1 peers)
[S17] START round=44 head_norm_before_train=1.719712 cos_to_last_merge=0.9654 (last merge round=27)
[S17] round=44 local utility u=0.713560 metrics={'f1_val': 0.7657254263702282, 'auprc': 0.9175019974729827, 'loss_val': 0.6358924311101227, 'psi': 0.82643605481133}-{'f1_val': 0.6266158134941388, 'auprc': 0.857544149428926, 'loss_val': 1.048481598291489, 'psi': 0.7189871478680536}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S2] START round=45 head_norm_before_train=1.782050 cos_to_last_merge=0.9383 (last merge round=21)
[S2] ⚠️ Model drifted since last merge! cos=0.938
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.638441669534616, 'auprc': 0.7488497723345895, 'loss_val': 1.3402266212606944, 'psi': 0.6826049106546054}-{'f1_val': 0.7101812175379715, 'auprc': 0.9535250623308038, 'loss_val': 0.5007617505337664, 'psi': 0.8075187554551044}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=45 head_norm_before_train=2.049409 cos_to_last_merge=0.9944 (last merge round=28)
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.94741671805722, 'auprc': 0.9992591298641214, 'loss_val': 0.1657521262027623, 'psi': 0.9681536827799806}-{'f1_val': 0.9510612893582964, 'auprc': 0.9998736851372979, 'loss_val': 0.10764161622069433, 'psi': 0.970586247669897}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=45 head_norm_before_train=1.905460 cos_to_last_merge=0.9912 (last merge round=27)
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.6954346781442475, 'auprc': 0.9641507817299613, 'loss_val': 0.5509192696541417, 'psi': 0.8029211195785331}-{'f1_val': 0.9427166995961582, 'auprc': 0.9582648065405094, 'loss_val': 0.3097591672200042, 'psi': 0.9489359423738987}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=45 head_norm_before_train=1.771157 (no previous merge yet)
[S5] round=45 local utility u=0.000000 metrics={'f1_val': 0.4387997353586003, 'auprc': 0.8560114252351968, 'loss_val': 0.8620940312829262, 'psi': 0.605684411309239}-{'f1_val': 0.7004069097142683, 'auprc': 0.9489827400611768, 'loss_val': 0.2735933197503882, 'psi': 0.7998372418530317}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=45 head_norm_before_train=1.994437 cos_to_last_merge=0.7877 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.788
[S6] round=45 local utility u=0.000000 metrics={'f1_val': 0.756999456405518, 'auprc': 0.9017575621379346, 'loss_val': 0.656035484019907, 'psi': 0.8149026986984846}-{'f1_val': 0.8075774420527304, 'auprc': 0.9220033772060535, 'loss_val': 0.5076446078671699, 'psi': 0.8533478161140597}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=45 head_norm_before_train=1.823484 cos_to_last_merge=0.9970 (last merge round=27)
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.6047834583424327, 'auprc': 0.7872337679116687, 'loss_val': 0.6753676416083392, 'psi': 0.6777635821701271}-{'f1_val': 0.641690021219513, 'auprc': 0.796891443538716, 'loss_val': 0.5855788005528604, 'psi': 0.7037705901471942}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=45 head_norm_before_train=1.989842 cos_to_last_merge=0.9986 (last merge round=26)
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.9838244247777395, 'auprc': 0.9928063461791083, 'loss_val': 0.050803800640746286, 'psi': 0.987417193338287}-{'f1_val': 0.9921646161217188, 'auprc': 0.998864543508255, 'loss_val': 0.0326046536299328, 'psi': 0.9948445870763334}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=45 head_norm_before_train=1.861152 cos_to_last_merge=0.9883 (last merge round=25)
[S9] round=45 local utility u=0.027464 metrics={'f1_val': 0.993909773892786, 'auprc': 0.9995151753436208, 'loss_val': 0.0270713046391472, 'psi': 0.99615193447312}-{'f1_val': 0.9892714523047061, 'auprc': 0.9954291102166325, 'loss_val': 0.04191111861607419, 'psi': 0.9917345154694768}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=45 head_norm_before_train=2.026675 cos_to_last_merge=0.7436 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.744
[S10] round=45 local utility u=0.001942 metrics={'f1_val': 0.9953063309450747, 'auprc': 0.9958632601611802, 'loss_val': 0.027402244235792805, 'psi': 0.995529102631517}-{'f1_val': 0.9948674007110037, 'auprc': 0.9956673453322908, 'loss_val': 0.028064378873640425, 'psi': 0.9951873785595186}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=45 head_norm_before_train=1.705775 cos_to_last_merge=0.9388 (last merge round=21)
[S11] ⚠️ Model drifted since last merge! cos=0.939
[S11] round=45 local utility u=0.048533 metrics={'f1_val': 0.9945901883888901, 'auprc': 0.9980907587494778, 'loss_val': 0.03408223842652269, 'psi': 0.9959904165331253}-{'f1_val': 0.981169186686789, 'auprc': 0.9975116353287015, 'loss_val': 0.04888459859931362, 'psi': 0.987706166143554}
[S11] not sending this round → trigger blocked (psi=0.996)
[S13] START round=45 head_norm_before_train=1.573198 cos_to_last_merge=0.9879 (last merge round=26)
[S13] round=45 local utility u=0.000000 metrics={'f1_val': 0.6692698238504505, 'auprc': 0.7103337593143715, 'loss_val': 0.8127458739419696, 'psi': 0.6856953980360189}-{'f1_val': 0.7199616379580243, 'auprc': 0.7361209545062684, 'loss_val': 0.5984998281381236, 'psi': 0.726425364577322}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=45 head_norm_before_train=1.665846 cos_to_last_merge=0.9863 (last merge round=27)
[S14] round=45 local utility u=0.014819 metrics={'f1_val': 0.9096553045824199, 'auprc': 0.9981372147008543, 'loss_val': 0.19849370812270814, 'psi': 0.9450480686297937}-{'f1_val': 0.9057586041152513, 'auprc': 0.9985410715476006, 'loss_val': 0.20596279100091153, 'psi': 0.9428715910881911}
[S14] not sending this round → trigger blocked (psi=0.945)
[S15] START round=45 head_norm_before_train=1.699225 cos_to_last_merge=0.9864 (last merge round=28)
[S15] round=45 local utility u=0.000000 metrics={'f1_val': 0.9961900430063055, 'auprc': 0.9885276195587371, 'loss_val': 0.028093538252280528, 'psi': 0.9931250736272782}-{'f1_val': 0.9967466683875206, 'auprc': 0.9965312733571586, 'loss_val': 0.025730477728186773, 'psi': 0.9966605103753758}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=45 head_norm_before_train=1.643612 cos_to_last_merge=0.9843 (last merge round=25)
[S16] round=45 local utility u=0.000000 metrics={'f1_val': 0.7442108885952134, 'auprc': 0.914799658300823, 'loss_val': 0.9895104910472976, 'psi': 0.8124463964774573}-{'f1_val': 0.989881232674883, 'auprc': 0.9896569999757305, 'loss_val': 0.05605020467670973, 'psi': 0.9897915395952219}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=45 head_norm_before_train=1.735938 cos_to_last_merge=0.9640 (last merge round=27)
[S17] round=45 local utility u=0.381422 metrics={'f1_val': 0.8368481243048204, 'auprc': 0.9609375132848819, 'loss_val': 0.43009084853359886, 'psi': 0.886483879896845}-{'f1_val': 0.7657254263702282, 'auprc': 0.9175019974729827, 'loss_val': 0.6358924311101227, 'psi': 0.82643605481133}
[S17] not sending this round → trigger blocked (psi=0.886)
[S2] START round=46 head_norm_before_train=1.793847 cos_to_last_merge=0.9367 (last merge round=21)
[S2] ⚠️ Model drifted since last merge! cos=0.937
[S2] round=46 local utility u=0.982705 metrics={'f1_val': 0.7337048542113702, 'auprc': 0.9073039791273806, 'loss_val': 0.42175878006675177, 'psi': 0.8031445041777744}-{'f1_val': 0.638441669534616, 'auprc': 0.7488497723345895, 'loss_val': 1.3402266212606944, 'psi': 0.6826049106546054}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=46 head_norm_before_train=2.057797 cos_to_last_merge=0.9940 (last merge round=28)
[S3] round=46 local utility u=0.211948 metrics={'f1_val': 0.9953464457261353, 'auprc': 0.9999456009492078, 'loss_val': 0.03149376829636703, 'psi': 0.9971861078153643}-{'f1_val': 0.94741671805722, 'auprc': 0.9992591298641214, 'loss_val': 0.1657521262027623, 'psi': 0.9681536827799806}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=46 head_norm_before_train=1.912406 cos_to_last_merge=0.9908 (last merge round=27)
[S4] round=46 local utility u=0.768239 metrics={'f1_val': 0.9241573368091534, 'auprc': 0.965660736771199, 'loss_val': 0.39130773453771267, 'psi': 0.9407586967939716}-{'f1_val': 0.6954346781442475, 'auprc': 0.9641507817299613, 'loss_val': 0.5509192696541417, 'psi': 0.8029211195785331}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=46 head_norm_before_train=1.775843 (no previous merge yet)
[S5] round=46 local utility u=1.000000 metrics={'f1_val': 0.987095643854717, 'auprc': 0.9980096254890887, 'loss_val': 0.12347785170841169, 'psi': 0.9914612365084656}-{'f1_val': 0.4387997353586003, 'auprc': 0.8560114252351968, 'loss_val': 0.8620940312829262, 'psi': 0.605684411309239}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=46 head_norm_before_train=2.003211 cos_to_last_merge=0.7871 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.787
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.7484184891834023, 'auprc': 0.7793302417723803, 'loss_val': 0.8507996304834966, 'psi': 0.7607831902189934}-{'f1_val': 0.756999456405518, 'auprc': 0.9017575621379346, 'loss_val': 0.656035484019907, 'psi': 0.8149026986984846}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=46 head_norm_before_train=1.826931 cos_to_last_merge=0.9968 (last merge round=27)
[S7] round=46 local utility u=0.410151 metrics={'f1_val': 0.6660621651838187, 'auprc': 0.8311758719639311, 'loss_val': 0.35456380945819116, 'psi': 0.7321076478958637}-{'f1_val': 0.6047834583424327, 'auprc': 0.7872337679116687, 'loss_val': 0.6753676416083392, 'psi': 0.6777635821701271}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=46 head_norm_before_train=1.996848 cos_to_last_merge=0.9985 (last merge round=26)
[S8] round=46 local utility u=0.045076 metrics={'f1_val': 0.9925289693239863, 'auprc': 0.9988183748087851, 'loss_val': 0.03091547318225052, 'psi': 0.9950447315179058}-{'f1_val': 0.9838244247777395, 'auprc': 0.9928063461791083, 'loss_val': 0.050803800640746286, 'psi': 0.987417193338287}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=46 head_norm_before_train=1.871099 cos_to_last_merge=0.9879 (last merge round=25)
[S9] round=46 local utility u=0.011505 metrics={'f1_val': 0.9966891482978385, 'auprc': 0.9995154733235628, 'loss_val': 0.020737698100356087, 'psi': 0.9978196783081282}-{'f1_val': 0.993909773892786, 'auprc': 0.9995151753436208, 'loss_val': 0.0270713046391472, 'psi': 0.99615193447312}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=46 head_norm_before_train=2.030354 cos_to_last_merge=0.7437 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.744
[S10] round=46 local utility u=0.000000 metrics={'f1_val': 0.9950868285240967, 'auprc': 0.9958677495397209, 'loss_val': 0.027618136290007558, 'psi': 0.9953991969303464}-{'f1_val': 0.9953063309450747, 'auprc': 0.9958632601611802, 'loss_val': 0.027402244235792805, 'psi': 0.995529102631517}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=46 head_norm_before_train=1.715796 cos_to_last_merge=0.9378 (last merge round=21)
[S11] ⚠️ Model drifted since last merge! cos=0.938
[S11] round=46 local utility u=0.006040 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9966436235921915, 'loss_val': 0.029524496370953373, 'psi': 0.9965979318206049}-{'f1_val': 0.9945901883888901, 'auprc': 0.9980907587494778, 'loss_val': 0.03408223842652269, 'psi': 0.9959904165331253}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=46 head_norm_before_train=1.578978 cos_to_last_merge=0.9874 (last merge round=26)
[S13] round=46 local utility u=0.170738 metrics={'f1_val': 0.7321087962407045, 'auprc': 0.6926091124841522, 'loss_val': 0.7951298393466674, 'psi': 0.7163089227380836}-{'f1_val': 0.6692698238504505, 'auprc': 0.7103337593143715, 'loss_val': 0.8127458739419696, 'psi': 0.6856953980360189}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=46 head_norm_before_train=1.675652 cos_to_last_merge=0.9856 (last merge round=27)
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.9072713501147186, 'auprc': 0.9980280604723863, 'loss_val': 0.26473936706685514, 'psi': 0.9435740342577856}-{'f1_val': 0.9096553045824199, 'auprc': 0.9981372147008543, 'loss_val': 0.19849370812270814, 'psi': 0.9450480686297937}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=46 head_norm_before_train=1.710702 cos_to_last_merge=0.9857 (last merge round=28)
[S15] round=46 local utility u=0.000000 metrics={'f1_val': 0.7067200174194747, 'auprc': 0.8199214342573533, 'loss_val': 0.5725775704478433, 'psi': 0.7520005841546261}-{'f1_val': 0.9961900430063055, 'auprc': 0.9885276195587371, 'loss_val': 0.028093538252280528, 'psi': 0.9931250736272782}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=46 head_norm_before_train=1.651859 cos_to_last_merge=0.9837 (last merge round=25)
[S16] round=46 local utility u=0.450605 metrics={'f1_val': 0.8447216591527091, 'auprc': 0.986053935074636, 'loss_val': 0.905128308690961, 'psi': 0.9012545695214799}-{'f1_val': 0.7442108885952134, 'auprc': 0.914799658300823, 'loss_val': 0.9895104910472976, 'psi': 0.8124463964774573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=46 head_norm_before_train=1.754868 cos_to_last_merge=0.9623 (last merge round=27)
[S17] round=46 local utility u=0.000000 metrics={'f1_val': 0.6366009536625705, 'auprc': 0.8993231043932619, 'loss_val': 1.1817343192613363, 'psi': 0.7416898139548471}-{'f1_val': 0.8368481243048204, 'auprc': 0.9609375132848819, 'loss_val': 0.43009084853359886, 'psi': 0.886483879896845}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=47 head_norm_before_train=1.804682 cos_to_last_merge=0.9353 (last merge round=21)
[S2] ⚠️ Model drifted since last merge! cos=0.935
[S2] round=47 local utility u=0.006486 metrics={'f1_val': 0.7105765177182884, 'auprc': 0.9812459757411198, 'loss_val': 0.4918417841451658, 'psi': 0.818844300927421}-{'f1_val': 0.7337048542113702, 'auprc': 0.9073039791273806, 'loss_val': 0.42175878006675177, 'psi': 0.8031445041777744}
[S2] not sending this round → trigger blocked (psi=0.819)
[S3] START round=47 head_norm_before_train=2.065464 cos_to_last_merge=0.9937 (last merge round=28)
[S3] round=47 local utility u=0.010157 metrics={'f1_val': 0.9973956967430226, 'auprc': 0.9999435432678432, 'loss_val': 0.02346917433613803, 'psi': 0.9984148353529508}-{'f1_val': 0.9953464457261353, 'auprc': 0.9999456009492078, 'loss_val': 0.03149376829636703, 'psi': 0.9971861078153643}
[S3] not sending this round → trigger blocked (psi=0.998)
[S4] START round=47 head_norm_before_train=1.924590 cos_to_last_merge=0.9904 (last merge round=27)
[S4] round=47 local utility u=0.073589 metrics={'f1_val': 0.9402180333739485, 'auprc': 0.9605767086442294, 'loss_val': 0.3252410963252696, 'psi': 0.9483615034820609}-{'f1_val': 0.9241573368091534, 'auprc': 0.965660736771199, 'loss_val': 0.39130773453771267, 'psi': 0.9407586967939716}
[S4] not sending this round → trigger blocked (psi=0.948)
[S5] START round=47 head_norm_before_train=1.775962 (no previous merge yet)
[S5] round=47 local utility u=0.000000 metrics={'f1_val': 0.5863099165006357, 'auprc': 0.8560821965761557, 'loss_val': 0.684062162232447, 'psi': 0.6942188285308437}-{'f1_val': 0.987095643854717, 'auprc': 0.9980096254890887, 'loss_val': 0.12347785170841169, 'psi': 0.9914612365084656}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=47 head_norm_before_train=2.010987 cos_to_last_merge=0.7867 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.787
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.7228703278354626, 'auprc': 0.8147419942431127, 'loss_val': 0.9992101980088766, 'psi': 0.7596189943985227}-{'f1_val': 0.7484184891834023, 'auprc': 0.7793302417723803, 'loss_val': 0.8507996304834966, 'psi': 0.7607831902189934}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=47 head_norm_before_train=1.830057 cos_to_last_merge=0.9967 (last merge round=27)
[S7] round=47 local utility u=0.000000 metrics={'f1_val': 0.6059537944358311, 'auprc': 0.7887203424411255, 'loss_val': 0.6539130573622081, 'psi': 0.6790604136379489}-{'f1_val': 0.6660621651838187, 'auprc': 0.8311758719639311, 'loss_val': 0.35456380945819116, 'psi': 0.7321076478958637}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=47 head_norm_before_train=2.004850 cos_to_last_merge=0.9984 (last merge round=26)
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.9925712794554754, 'auprc': 0.9986277158118646, 'loss_val': 0.03274536225729971, 'psi': 0.994993853998031}-{'f1_val': 0.9925289693239863, 'auprc': 0.9988183748087851, 'loss_val': 0.03091547318225052, 'psi': 0.9950447315179058}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=47 head_norm_before_train=1.880127 cos_to_last_merge=0.9874 (last merge round=25)
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.991254331540241, 'auprc': 0.9996995027746547, 'loss_val': 0.03128720124524792, 'psi': 0.9946324000340064}-{'f1_val': 0.9966891482978385, 'auprc': 0.9995154733235628, 'loss_val': 0.020737698100356087, 'psi': 0.9978196783081282}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=47 head_norm_before_train=2.037991 cos_to_last_merge=0.7431 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.743
[S10] round=47 local utility u=0.000892 metrics={'f1_val': 0.9953063309450747, 'auprc': 0.9959002573654174, 'loss_val': 0.027248262703800902, 'psi': 0.9955439015132118}-{'f1_val': 0.9950868285240967, 'auprc': 0.9958677495397209, 'loss_val': 0.027618136290007558, 'psi': 0.9953991969303464}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=47 head_norm_before_train=1.725115 cos_to_last_merge=0.9368 (last merge round=21)
[S11] ⚠️ Model drifted since last merge! cos=0.937
[S11] round=47 local utility u=0.000000 metrics={'f1_val': 0.9592021167208848, 'auprc': 0.9956101002422907, 'loss_val': 0.09354171578949222, 'psi': 0.9737653101294471}-{'f1_val': 0.996567470639547, 'auprc': 0.9966436235921915, 'loss_val': 0.029524496370953373, 'psi': 0.9965979318206049}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=47 head_norm_before_train=1.584975 cos_to_last_merge=0.9871 (last merge round=26)
[S13] round=47 local utility u=0.000000 metrics={'f1_val': 0.6506977449596877, 'auprc': 0.6447307187630531, 'loss_val': 0.9573882552537374, 'psi': 0.6483109344810338}-{'f1_val': 0.7321087962407045, 'auprc': 0.6926091124841522, 'loss_val': 0.7951298393466674, 'psi': 0.7163089227380836}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=47 head_norm_before_train=1.683713 cos_to_last_merge=0.9849 (last merge round=27)
[S14] round=47 local utility u=0.127879 metrics={'f1_val': 0.9330538444441185, 'auprc': 0.9980738802578287, 'loss_val': 0.16381419129827812, 'psi': 0.9590618587696026}-{'f1_val': 0.9072713501147186, 'auprc': 0.9980280604723863, 'loss_val': 0.26473936706685514, 'psi': 0.9435740342577856}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=47 head_norm_before_train=1.715594 cos_to_last_merge=0.9855 (last merge round=28)
[S15] round=47 local utility u=1.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9977392457885071, 'loss_val': 0.024693717938778014, 'psi': 0.9971436993479152}-{'f1_val': 0.7067200174194747, 'auprc': 0.8199214342573533, 'loss_val': 0.5725775704478433, 'psi': 0.7520005841546261}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=47 head_norm_before_train=1.658412 cos_to_last_merge=0.9832 (last merge round=25)
[S16] round=47 local utility u=0.869669 metrics={'f1_val': 0.9897640993426717, 'auprc': 0.9930147482010688, 'loss_val': 0.05692653839258129, 'psi': 0.9910643588860306}-{'f1_val': 0.8447216591527091, 'auprc': 0.986053935074636, 'loss_val': 0.905128308690961, 'psi': 0.9012545695214799}
[S16] not sending this round → trigger blocked (psi=0.991)
[S17] START round=47 head_norm_before_train=1.767803 cos_to_last_merge=0.9610 (last merge round=27)
[S17] round=47 local utility u=1.000000 metrics={'f1_val': 0.8370356181861178, 'auprc': 0.9843594219304224, 'loss_val': 0.4439865399153448, 'psi': 0.8959651396838396}-{'f1_val': 0.6366009536625705, 'auprc': 0.8993231043932619, 'loss_val': 1.1817343192613363, 'psi': 0.7416898139548471}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=48 head_norm_before_train=1.816695 cos_to_last_merge=0.9339 (last merge round=21)
[S2] ⚠️ Model drifted since last merge! cos=0.934
[S2] round=48 local utility u=0.000000 metrics={'f1_val': 0.7123800613764093, 'auprc': 0.921492425217252, 'loss_val': 0.4810357672248645, 'psi': 0.7960250069127464}-{'f1_val': 0.7105765177182884, 'auprc': 0.9812459757411198, 'loss_val': 0.4918417841451658, 'psi': 0.818844300927421}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=48 head_norm_before_train=2.073121 cos_to_last_merge=0.9933 (last merge round=28)
[S3] round=48 local utility u=0.000000 metrics={'f1_val': 0.7917863436909243, 'auprc': 0.9987045570906117, 'loss_val': 0.3346940441470029, 'psi': 0.8745536290507991}-{'f1_val': 0.9973956967430226, 'auprc': 0.9999435432678432, 'loss_val': 0.02346917433613803, 'psi': 0.9984148353529508}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=48 head_norm_before_train=1.930157 cos_to_last_merge=0.9899 (last merge round=27)
[S4] round=48 local utility u=0.014894 metrics={'f1_val': 0.9430289542856322, 'auprc': 0.9622160283957075, 'loss_val': 0.3172373879269276, 'psi': 0.9507037839296624}-{'f1_val': 0.9402180333739485, 'auprc': 0.9605767086442294, 'loss_val': 0.3252410963252696, 'psi': 0.9483615034820609}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=48 head_norm_before_train=1.777758 (no previous merge yet)
[S5] round=48 local utility u=0.857033 metrics={'f1_val': 0.7246166055139114, 'auprc': 0.9928916241279138, 'loss_val': 0.2102647273293373, 'psi': 0.8319266129595124}-{'f1_val': 0.5863099165006357, 'auprc': 0.8560821965761557, 'loss_val': 0.684062162232447, 'psi': 0.6942188285308437}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=48 head_norm_before_train=2.020380 cos_to_last_merge=0.7858 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.786
[S6] round=48 local utility u=1.000000 metrics={'f1_val': 0.9567749170112625, 'auprc': 0.9621432817282712, 'loss_val': 0.1478860356358135, 'psi': 0.958922262898066}-{'f1_val': 0.7228703278354626, 'auprc': 0.8147419942431127, 'loss_val': 0.9992101980088766, 'psi': 0.7596189943985227}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=48 head_norm_before_train=1.832799 cos_to_last_merge=0.9965 (last merge round=27)
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.6016823703792394, 'auprc': 0.787736228223242, 'loss_val': 0.645401080922489, 'psi': 0.6761039135168405}-{'f1_val': 0.6059537944358311, 'auprc': 0.7887203424411255, 'loss_val': 0.6539130573622081, 'psi': 0.6790604136379489}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=48 head_norm_before_train=2.013364 cos_to_last_merge=0.9982 (last merge round=26)
[S8] round=48 local utility u=0.001574 metrics={'f1_val': 0.9925289693239863, 'auprc': 0.9990105542294409, 'loss_val': 0.03049265946871951, 'psi': 0.995121603286168}-{'f1_val': 0.9925712794554754, 'auprc': 0.9986277158118646, 'loss_val': 0.03274536225729971, 'psi': 0.994993853998031}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=48 head_norm_before_train=1.887664 cos_to_last_merge=0.9870 (last merge round=25)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.9899884433541285, 'auprc': 0.9998018977135823, 'loss_val': 0.03725192361551593, 'psi': 0.99391382509791}-{'f1_val': 0.991254331540241, 'auprc': 0.9996995027746547, 'loss_val': 0.03128720124524792, 'psi': 0.9946324000340064}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=48 head_norm_before_train=2.046922 cos_to_last_merge=0.7423 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.742
[S10] round=48 local utility u=0.000031 metrics={'f1_val': 0.9953063309450747, 'auprc': 0.995879703208338, 'loss_val': 0.027124872124613047, 'psi': 0.99553567985038}-{'f1_val': 0.9953063309450747, 'auprc': 0.9959002573654174, 'loss_val': 0.027248262703800902, 'psi': 0.9955439015132118}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=48 head_norm_before_train=1.735107 cos_to_last_merge=0.9356 (last merge round=21)
[S11] ⚠️ Model drifted since last merge! cos=0.936
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.8491306096734439, 'auprc': 0.9956595185270809, 'loss_val': 0.1990549897003831, 'psi': 0.9077421732148987}-{'f1_val': 0.9592021167208848, 'auprc': 0.9956101002422907, 'loss_val': 0.09354171578949222, 'psi': 0.9737653101294471}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=48 head_norm_before_train=1.596174 cos_to_last_merge=0.9860 (last merge round=26)
[S13] round=48 local utility u=0.097476 metrics={'f1_val': 0.6694185063932804, 'auprc': 0.6585723793047285, 'loss_val': 0.9162861288538791, 'psi': 0.6650800555578595}-{'f1_val': 0.6506977449596877, 'auprc': 0.6447307187630531, 'loss_val': 0.9573882552537374, 'psi': 0.6483109344810338}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=48 head_norm_before_train=1.690859 cos_to_last_merge=0.9844 (last merge round=27)
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.8701147229463891, 'auprc': 0.990513065238617, 'loss_val': 0.47541709268322696, 'psi': 0.9182740598632803}-{'f1_val': 0.9330538444441185, 'auprc': 0.9980738802578287, 'loss_val': 0.16381419129827812, 'psi': 0.9590618587696026}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=48 head_norm_before_train=1.723222 cos_to_last_merge=0.9850 (last merge round=28)
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.912709020879242, 'auprc': 0.9922856030324448, 'loss_val': 0.14101031221113847, 'psi': 0.9445396537405231}-{'f1_val': 0.9967466683875206, 'auprc': 0.9977392457885071, 'loss_val': 0.024693717938778014, 'psi': 0.9971436993479152}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=48 head_norm_before_train=1.664578 cos_to_last_merge=0.9827 (last merge round=25)
[S16] round=48 local utility u=0.000000 metrics={'f1_val': 0.7266205270022096, 'auprc': 0.917208455506811, 'loss_val': 1.0386662819258627, 'psi': 0.8028556984040502}-{'f1_val': 0.9897640993426717, 'auprc': 0.9930147482010688, 'loss_val': 0.05692653839258129, 'psi': 0.9910643588860306}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=48 head_norm_before_train=1.773345 cos_to_last_merge=0.9602 (last merge round=27)
[S17] round=48 local utility u=0.033451 metrics={'f1_val': 0.8490867147012233, 'auprc': 0.9657253294148178, 'loss_val': 0.3934878943742076, 'psi': 0.8957421605866611}-{'f1_val': 0.8370356181861178, 'auprc': 0.9843594219304224, 'loss_val': 0.4439865399153448, 'psi': 0.8959651396838396}
[S17] not sending this round → trigger blocked (psi=0.896)
[S2] START round=49 head_norm_before_train=1.828805 cos_to_last_merge=0.9326 (last merge round=21)
[S2] ⚠️ Model drifted since last merge! cos=0.933
[S2] round=49 local utility u=0.000000 metrics={'f1_val': 0.6578576082779048, 'auprc': 0.7874408941668117, 'loss_val': 0.9316062261742906, 'psi': 0.7096909226334676}-{'f1_val': 0.7123800613764093, 'auprc': 0.921492425217252, 'loss_val': 0.4810357672248645, 'psi': 0.7960250069127464}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=49 head_norm_before_train=2.080252 cos_to_last_merge=0.9929 (last merge round=28)
[S3] round=49 local utility u=0.441029 metrics={'f1_val': 0.9072937421513875, 'auprc': 0.9990410366661117, 'loss_val': 0.14669059181974226, 'psi': 0.9439926599572772}-{'f1_val': 0.7917863436909243, 'auprc': 0.9987045570906117, 'loss_val': 0.3346940441470029, 'psi': 0.8745536290507991}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=49 head_norm_before_train=1.936674 cos_to_last_merge=0.9893 (last merge round=27)
[S4] round=49 local utility u=0.042826 metrics={'f1_val': 0.9554601799739367, 'auprc': 0.9641905219172211, 'loss_val': 0.31209695107638674, 'psi': 0.9589523167512505}-{'f1_val': 0.9430289542856322, 'auprc': 0.9622160283957075, 'loss_val': 0.3172373879269276, 'psi': 0.9507037839296624}
[S4] not sending this round → trigger blocked (psi=0.959)
[S5] START round=49 head_norm_before_train=1.778514 (no previous merge yet)
[S5] round=49 local utility u=0.017313 metrics={'f1_val': 0.7519221986605076, 'auprc': 0.9636629281383939, 'loss_val': 0.2517865265500331, 'psi': 0.8366184904516621}-{'f1_val': 0.7246166055139114, 'auprc': 0.9928916241279138, 'loss_val': 0.2102647273293373, 'psi': 0.8319266129595124}
[S5] not sending this round → trigger blocked (psi=0.837)
[S6] START round=49 head_norm_before_train=2.029837 cos_to_last_merge=0.7851 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.785
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.7980629497924537, 'auprc': 0.9195100350729082, 'loss_val': 0.40913255719577585, 'psi': 0.8466417839046355}-{'f1_val': 0.9567749170112625, 'auprc': 0.9621432817282712, 'loss_val': 0.1478860356358135, 'psi': 0.958922262898066}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=49 head_norm_before_train=1.837677 cos_to_last_merge=0.9964 (last merge round=27)
[S7] round=49 local utility u=0.002592 metrics={'f1_val': 0.6000344691924713, 'auprc': 0.7869346783079422, 'loss_val': 0.6279256148123752, 'psi': 0.6747945528386596}-{'f1_val': 0.6016823703792394, 'auprc': 0.787736228223242, 'loss_val': 0.645401080922489, 'psi': 0.6761039135168405}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S7] sending update (kind=head size=1808 to 1 peers)
[S8] START round=49 head_norm_before_train=2.017507 cos_to_last_merge=0.9981 (last merge round=26)
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.9860710398489039, 'auprc': 0.9979050937345855, 'loss_val': 0.04488426320651459, 'psi': 0.9908046614031765}-{'f1_val': 0.9925289693239863, 'auprc': 0.9990105542294409, 'loss_val': 0.03049265946871951, 'psi': 0.995121603286168}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=49 head_norm_before_train=1.895785 cos_to_last_merge=0.9867 (last merge round=25)
[S9] round=49 local utility u=0.018357 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9943447228358919, 'loss_val': 0.021735583742503853, 'psi': 0.9954879460019234}-{'f1_val': 0.9899884433541285, 'auprc': 0.9998018977135823, 'loss_val': 0.03725192361551593, 'psi': 0.99391382509791}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=49 head_norm_before_train=2.050657 cos_to_last_merge=0.7423 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.742
[S10] round=49 local utility u=0.000272 metrics={'f1_val': 0.9953063309450747, 'auprc': 0.996056961667201, 'loss_val': 0.02711304160007862, 'psi': 0.9956065832339253}-{'f1_val': 0.9953063309450747, 'auprc': 0.995879703208338, 'loss_val': 0.027124872124613047, 'psi': 0.99553567985038}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=49 head_norm_before_train=1.744052 cos_to_last_merge=0.9345 (last merge round=21)
[S11] ⚠️ Model drifted since last merge! cos=0.934
[S11] round=49 local utility u=0.525604 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9962863414012196, 'loss_val': 0.031868992201451764, 'psi': 0.9962070214069351}-{'f1_val': 0.8491306096734439, 'auprc': 0.9956595185270809, 'loss_val': 0.1990549897003831, 'psi': 0.9077421732148987}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=49 head_norm_before_train=1.606622 cos_to_last_merge=0.9848 (last merge round=26)
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.6155414010751505, 'auprc': 0.5965394216373148, 'loss_val': 1.292261772186909, 'psi': 0.6079406093000163}-{'f1_val': 0.6694185063932804, 'auprc': 0.6585723793047285, 'loss_val': 0.9162861288538791, 'psi': 0.6650800555578595}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=49 head_norm_before_train=1.698291 cos_to_last_merge=0.9838 (last merge round=27)
[S14] round=49 local utility u=0.264184 metrics={'f1_val': 0.9113658434364555, 'auprc': 0.9976275808192242, 'loss_val': 0.2158984191631936, 'psi': 0.945870538389563}-{'f1_val': 0.8701147229463891, 'auprc': 0.990513065238617, 'loss_val': 0.47541709268322696, 'psi': 0.9182740598632803}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=49 head_norm_before_train=1.729939 cos_to_last_merge=0.9846 (last merge round=28)
[S15] round=49 local utility u=0.124170 metrics={'f1_val': 0.9437025007651958, 'auprc': 0.9959969612315046, 'loss_val': 0.0897658290031813, 'psi': 0.9646202849517194}-{'f1_val': 0.912709020879242, 'auprc': 0.9922856030324448, 'loss_val': 0.14101031221113847, 'psi': 0.9445396537405231}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=49 head_norm_before_train=1.670252 cos_to_last_merge=0.9822 (last merge round=25)
[S16] round=49 local utility u=1.000000 metrics={'f1_val': 0.931219102391251, 'auprc': 0.9818938092670481, 'loss_val': 0.3353633805825639, 'psi': 0.9514889851415699}-{'f1_val': 0.7266205270022096, 'auprc': 0.917208455506811, 'loss_val': 1.0386662819258627, 'psi': 0.8028556984040502}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=49 head_norm_before_train=1.786038 cos_to_last_merge=0.9591 (last merge round=27)
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.7854155542799007, 'auprc': 0.9039472765549427, 'loss_val': 0.5639109373953305, 'psi': 0.8328282431899175}-{'f1_val': 0.8490867147012233, 'auprc': 0.9657253294148178, 'loss_val': 0.3934878943742076, 'psi': 0.8957421605866611}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[runner] rounds complete.
[runner] all agents stopped.
