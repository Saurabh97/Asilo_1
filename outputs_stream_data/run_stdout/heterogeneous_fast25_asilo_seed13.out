[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:54503
[S3] → join 127.0.0.1:54502
[S4] → join 127.0.0.1:54502
[S5] → join 127.0.0.1:54502
[S6] → join 127.0.0.1:54502
[S7] → join 127.0.0.1:54502
[S8] → join 127.0.0.1:54502
[S9] → join 127.0.0.1:54502
[S10] → join 127.0.0.1:54502
[S11] → join 127.0.0.1:54502
[S13] → join 127.0.0.1:54502
[S14] → join 127.0.0.1:54502
[S15] → join 127.0.0.1:54502
[S16] → join 127.0.0.1:54502
[S17] → join 127.0.0.1:54502
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.134937 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.154217 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.092716 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.234218 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.158103 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.134639 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.146551 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.114869 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.200853 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.236311 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.156174 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.193785 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.138794 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.202864 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.183576 (no previous merge yet)
[S16]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S3] + discovered S5
[S3] + discovered S7
[S3] + discovered S15
[S3] + discovered S6
[S4] + discovered S3
[S4] + discovered S2
[S3] + discovered S13
[S3] + discovered S4
[S3] + discovered S11
[S3] + discovered S10
[S3] + discovered S9
[S3] + discovered S14
[S3] + discovered S17
[S3] + discovered S8
[S3] + discovered S16
[S5] + discovered S4
[S5] + discovered S3
[S5] + discovered S2
[S4] + discovered S13
[S4] + discovered S11
[S4] + discovered S10
[S4] + discovered S9
[S4] + discovered S14
[S4] + discovered S17
[S4] + discovered S16
[S4] + discovered S8
[S4] + discovered S5
[S4] + discovered S7
[S4] + discovered S15
[S4] + discovered S6
[S5] + discovered S7
[S5] + discovered S17
[S5] + discovered S14
[S5] + discovered S9
[S5] + discovered S15
[S5] + discovered S16
[S5] + discovered S10
[S5] + discovered S11
[S5] + discovered S6
[S5] + discovered S13
[S6] + discovered S3
[S6] + discovered S5
[S6] + discovered S2
[S6] + discovered S4
[S5] + discovered S8
[S7] + discovered S6
[S6] + discovered S10
[S7] + discovered S3
[S6] + discovered S11
[S7] + discovered S4
[S7] + discovered S2
[S7] + discovered S5
[S6] + discovered S7
[S6] + discovered S17
[S6] + discovered S14
[S6] + discovered S9
[S6] + discovered S15
[S6] + discovered S16
[S6] + discovered S13
[S6] + discovered S8
[S7] + discovered S11
[S8] + discovered S3
[S8] + discovered S5
[S8] + discovered S2
[S7] + discovered S10
[S7] + discovered S14
[S8] + discovered S4
[S7] + discovered S16
[S8] + discovered S7
[S7] + discovered S9
[S8] + discovered S6
[S7] + discovered S15
[S7] + discovered S13
[S7] + discovered S8
[S7] + discovered S17
[S9] + discovered S6
[S9] + discovered S3
[S8] + discovered S9
[S8] + discovered S17
[S8] + discovered S11
[S8] + discovered S14
[S8] + discovered S16
[S8] + discovered S15
[S8] + discovered S13
[S8] + discovered S10
[S9] + discovered S4
[S9] + discovered S7
[S9] + discovered S5
[S9] + discovered S2
[S9] + discovered S8
[S9] + discovered S16
[S10] + discovered S6
[S9] + discovered S11
[S9] + discovered S14
[S10] + discovered S8
[S10] + discovered S4
[S10] + discovered S2
[S9] + discovered S13
[S9] + discovered S17
[S10] + discovered S5
[S10] + discovered S3
[S10] + discovered S7
[S10] + discovered S9
[S9] + discovered S10
[S9] + discovered S15
[S11] + discovered S10
[S11] + discovered S8
[S10] + discovered S17
[S11] + discovered S4
[S11] + discovered S2
[S10] + discovered S11
[S11] + discovered S9
[S11] + discovered S6
[S11] + discovered S5
[S11] + discovered S3
[S10] + discovered S15
[S10] + discovered S14
[S10] + discovered S13
[S10] + discovered S16
[S11] + discovered S7
[S13] + discovered S4
[S13] + discovered S3
[S13] + discovered S5
[S11] + discovered S13
[S11] + discovered S17
[S11] + discovered S15
[S11] + discovered S14
[S13] + discovered S9
[S13] + discovered S8
[S13] + discovered S10
[S13] + discovered S2
[S13] + discovered S6
[S11] + discovered S16
[S13] + discovered S7
[S13] + discovered S11
[S13] + discovered S16
[S14] + discovered S11
[S14] + discovered S6
[S14] + discovered S7
[S14] + discovered S4
[S14] + discovered S2
[S14] + discovered S13
[S14] + discovered S10
[S13] + discovered S15
[S13] + discovered S14
[S14] + discovered S8
[S14] + discovered S3
[S14] + discovered S5
[S13] + discovered S17
[S14] + discovered S9
[S15] + discovered S2
[S15] + discovered S5
[S15] + discovered S4
[S15] + discovered S14
[S15] + discovered S3
[S15] + discovered S6
[S15] + discovered S9
[S15] + discovered S8
[S15] + discovered S10
[S14] + discovered S17
[S15] + discovered S7
[S15] + discovered S13
[S15] + discovered S11
[S14] + discovered S15
[S14] + discovered S16
[S15] + discovered S16
[S15] + discovered S17
[S16] + discovered S11
[S16] + discovered S10
[S16] + discovered S14
[S16] + discovered S8
[S16] + discovered S7
[S16] + discovered S9
[S16] + discovered S2
[S16] + discovered S13
[S16] + discovered S3
[S16] + discovered S4
[S16] + discovered S5
[S16] + discovered S15
[S16] + discovered S6
[S17] + discovered S11
[S17] + discovered S9
[S17] + discovered S14
[S17] + discovered S6
[S16] + discovered S17
[S17] + discovered S2
[S17] + discovered S8
[S17] + discovered S4
[S17] + discovered S16
[S17] + discovered S15
[S17] + discovered S7
[S17] + discovered S10
[S17] + discovered S13
[S17] + discovered S5
[S17] + discovered S3
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] ⇄ pheromone p=1.000 → S3@127.0.0.1:54503
[S16] ⇄ pheromone p=1.000 → S14@127.0.0.1:54514
[S8] ⇄ pheromone p=1.000 → S5@127.0.0.1:54505
[S13] ⇄ pheromone p=1.000 → S10@127.0.0.1:54511
[S2] ⇄ pheromone p=1.000 → S6@127.0.0.1:54507
[S15] ⇄ pheromone p=1.000 → S14@127.0.0.1:54514
[S7] ⇄ pheromone p=1.000 → S13@127.0.0.1:54513
[S9] ⇄ pheromone p=1.000 → S7@127.0.0.1:54508
[S11] ⇄ pheromone p=1.000 → S2@127.0.0.1:54502
[S10] ⇄ pheromone p=1.000 → S5@127.0.0.1:54505
[S6] ⇄ pheromone p=1.000 → S7@127.0.0.1:54508
[S3] ⇄ pheromone p=1.000 → S14@127.0.0.1:54514
[S4] ⇄ pheromone p=1.000 → S14@127.0.0.1:54514
[S14] ⇄ pheromone p=1.000 → S7@127.0.0.1:54508
[S17] ⇄ pheromone p=1.000 → S8@127.0.0.1:54509
[S2] START round=1 head_norm_before_train=1.142666 (no previous merge yet)
[S2] round=1 local utility u=0.349407 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.8865145902461353, 'loss_val': 1.3105441509683053, 'psi': 0.4396721161315942}-{'f1_val': 0.1417771333885667, 'auprc': 0.6635884065845081, 'loss_val': 1.3405804539648694, 'psi': 0.3505016426669433}
[S3] START round=1 head_norm_before_train=1.164039 (no previous merge yet)
[S3] round=1 local utility u=0.241221 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9959257383952413, 'loss_val': 1.293965613326462, 'psi': 0.4822743347265608}-{'f1_val': 0.1758506376088781, 'auprc': 0.784242094622382, 'loss_val': 1.3574195247413432, 'psi': 0.4192072204142797}
[S4] START round=1 head_norm_before_train=1.090001 (no previous merge yet)
[S4] round=1 local utility u=0.469375 metrics={'f1_val': 0.17211392405063292, 'auprc': 0.4902835233263441, 'loss_val': 1.3604969089428292, 'psi': 0.2993817637609174}-{'f1_val': 0.1261574074074074, 'auprc': 0.2806338767620355, 'loss_val': 1.394559858978731, 'psi': 0.18794799514925864}
[S5] START round=1 head_norm_before_train=1.242252 (no previous merge yet)
[S5] round=1 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7297193154633896, 'loss_val': 1.2664343256310029, 'psi': 0.3772448690424987}-{'f1_val': 0.22323753339819868, 'auprc': 0.7304523027724461, 'loss_val': 1.3321047405982192, 'psi': 0.4261234411478977}
[S6] START round=1 head_norm_before_train=1.167921 (no previous merge yet)
[S6] round=1 local utility u=0.113078 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.940486174155241, 'loss_val': 1.2955756436622443, 'psi': 0.46105023889286567}-{'f1_val': 0.14142628205128205, 'auprc': 0.8766627858069724, 'loss_val': 1.3302613903781764, 'psi': 0.4355208835535582}
[S7] START round=1 head_norm_before_train=1.140670 (no previous merge yet)
[S7] round=1 local utility u=0.024728 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7948978213060813, 'loss_val': 1.281168539617374, 'psi': 0.40319322215988757}-{'f1_val': 0.14205682272909165, 'auprc': 0.7947304618530477, 'loss_val': 1.3301217093170257, 'psi': 0.4031262783786741}
[S8] START round=1 head_norm_before_train=1.146043 (no previous merge yet)
[S8] round=1 local utility u=0.273119 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.6815126362648926, 'loss_val': 1.3176238229633312, 'psi': 0.35657864394173133}-{'f1_val': 0.13995598239295717, 'auprc': 0.5105206295909696, 'loss_val': 1.3508863701024971, 'psi': 0.2881818412721621}
[S9] START round=1 head_norm_before_train=1.131519 (no previous merge yet)
[S9] round=1 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8656303147603664, 'loss_val': 1.2263928219237794, 'psi': 0.4310909001881442}-{'f1_val': 0.3814903890970785, 'auprc': 0.8647908879818376, 'loss_val': 1.331231791440031, 'psi': 0.5748105886509821}
[S10] START round=1 head_norm_before_train=1.195421 (no previous merge yet)
[S10] round=1 local utility u=1.000000 metrics={'f1_val': 0.2906214098862031, 'auprc': 0.5332912864955633, 'loss_val': 1.3611530167808035, 'psi': 0.3876893605299472}-{'f1_val': 0.09576103667911268, 'auprc': 0.18506724211151815, 'loss_val': 1.385870732215355, 'psi': 0.13148351885207488}
[S11] START round=1 head_norm_before_train=1.242638 (no previous merge yet)
[S11] round=1 local utility u=0.081036 metrics={'f1_val': 0.39756716255642854, 'auprc': 0.7641189748155879, 'loss_val': 1.3208817591291993, 'psi': 0.5441878874600923}-{'f1_val': 0.39950266885303426, 'auprc': 0.7171742558821317, 'loss_val': 1.3537335356180533, 'psi': 0.5265713036646733}
[S13] START round=1 head_norm_before_train=1.163996 (no previous merge yet)
[S13] round=1 local utility u=0.107686 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5347547218038731, 'loss_val': 1.3259853251415437, 'psi': 0.2981333462677811}-{'f1_val': 0.1403857625770531, 'auprc': 0.473573023037129, 'loss_val': 1.3578114460188146, 'psi': 0.27366066676108347}
[S14] START round=1 head_norm_before_train=1.195669 (no previous merge yet)
[S14] round=1 local utility u=1.000000 metrics={'f1_val': 0.39007779894755945, 'auprc': 0.7314469402637525, 'loss_val': 1.358403064711599, 'psi': 0.5266254554740366}-{'f1_val': 0.18544600938967137, 'auprc': 0.30878121305861805, 'loss_val': 1.381213813496399, 'psi': 0.23478009085725005}
[S15] START round=1 head_norm_before_train=1.141549 (no previous merge yet)
[S15] round=1 local utility u=0.260115 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7271392480350898, 'loss_val': 1.3305529614671707, 'psi': 0.3746958900309709}-{'f1_val': 0.13973365136155833, 'auprc': 0.5607496666256336, 'loss_val': 1.3516136488498707, 'psi': 0.3081400574671885}
[S16] START round=1 head_norm_before_train=1.213888 (no previous merge yet)
[S16] round=1 local utility u=0.206841 metrics={'f1_val': 0.1668636256204207, 'auprc': 0.785542930414217, 'loss_val': 1.3221629891461872, 'psi': 0.4143353475379392}-{'f1_val': 0.10386473429951691, 'auprc': 0.7848224824057132, 'loss_val': 1.355690672069863, 'psi': 0.3762478335419954}
[S17] START round=1 head_norm_before_train=1.183458 (no previous merge yet)
[S17] round=1 local utility u=0.861761 metrics={'f1_val': 0.3523494365494678, 'auprc': 0.8162406827586275, 'loss_val': 1.337967716491764, 'psi': 0.5379059350331317}-{'f1_val': 0.09754189944134078, 'auprc': 0.7619915832532731, 'loss_val': 1.3698962512039359, 'psi': 0.3633217729661137}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S13] → sending delta(kind=head bytes=1789) to S10@127.0.0.1:54511
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S16] → sending delta(kind=head bytes=1791) to S15@127.0.0.1:54515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S2] → sending delta(kind=head bytes=1788) to S17@127.0.0.1:54517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:54509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S15] → sending delta(kind=head bytes=1786) to S9@127.0.0.1:54510
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S11] → sending delta(kind=head bytes=1788) to S10@127.0.0.1:54511
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S4] → sending delta(kind=head bytes=1789) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:54516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S6] → sending delta(kind=head bytes=1787) to S10@127.0.0.1:54511
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S10] → sending delta(kind=head bytes=1790) to S15@127.0.0.1:54515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:54504
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S8] → sending delta(kind=head bytes=1787) to S14@127.0.0.1:54514
[S3] sending update (kind=head size=1794 to 1 peers)
[S4] sending update (kind=head size=1789 to 1 peers)
[S11] sending update (kind=head size=1788 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1788 to 1 peers)
[S7] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1787 to 1 peers)
[S15] sending update (kind=head size=1786 to 1 peers)
[S16] sending update (kind=head size=1791 to 1 peers)
[S13] sending update (kind=head size=1789 to 1 peers)
[S6] sending update (kind=head size=1787 to 1 peers)
[S10] sending update (kind=head size=1790 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1786) from S15
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.151804)
[S9] loaded HEAD from S15 (vec_in norm=1.151804)
[S9] cosine check vs S15: cos=0.1346
[S9] BUFFERED delta from S15 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1796) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.204329)
[S8] loaded HEAD from S14 (vec_in norm=1.204329)
[S8] cosine check vs S14: cos=0.1252
[S8] BUFFERED delta from S14 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1790) from S10
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.198152)
[S15] loaded HEAD from S10 (vec_in norm=1.198152)
[S15] cosine check vs S10: cos=-0.1375
[S15] DROPPED delta from S10 (cos=-0.1375 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1791) from S16
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.234675)
[S15] loaded HEAD from S16 (vec_in norm=1.234675)
[S15] cosine check vs S16: cos=0.0909
[S15] BUFFERED delta from S16 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1788) from S2
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.157263)
[S17] loaded HEAD from S2 (vec_in norm=1.157263)
[S17] cosine check vs S2: cos=-0.0416
[S17] DROPPED delta from S2 (cos=-0.0416 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1787) from S8
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.155686)
[S14] loaded HEAD from S8 (vec_in norm=1.155686)
[S14] cosine check vs S8: cos=0.1252
[S14] BUFFERED delta from S8 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1789) from S4
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.096245)
[S7] loaded HEAD from S4 (vec_in norm=1.096245)
[S7] cosine check vs S4: cos=0.0710
[S7] BUFFERED delta from S4 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1794) from S3
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.192969)
[S16] loaded HEAD from S3 (vec_in norm=1.192969)
[S16] cosine check vs S3: cos=0.0276
[S16] BUFFERED delta from S3 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1787) from S6
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.186706)
[S10] loaded HEAD from S6 (vec_in norm=1.186706)
[S10] cosine check vs S6: cos=0.1004
[S10] BUFFERED delta from S6 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1794) from S7
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.167566)
[S4] loaded HEAD from S7 (vec_in norm=1.167566)
[S4] cosine check vs S7: cos=0.0710
[S4] BUFFERED delta from S7 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1788) from S11
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.256927)
[S10] loaded HEAD from S11 (vec_in norm=1.256927)
[S10] cosine check vs S11: cos=-0.0328
[S10] DROPPED delta from S11 (cos=-0.0328 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1789) from S13
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.178473)
[S10] loaded HEAD from S13 (vec_in norm=1.178473)
[S10] cosine check vs S13: cos=-0.0555
[S10] DROPPED delta from S13 (cos=-0.0555 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S17] → sending delta(kind=head bytes=1788) to S5@127.0.0.1:54505
[S17] sending update (kind=head size=1788 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1788) from S17
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.198238)
[S5] loaded HEAD from S17 (vec_in norm=1.198238)
[S5] cosine check vs S17: cos=0.0032
[S5] BUFFERED delta from S17 (total buffered=1)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=1 metric=0.1414 head_norm=1.174941
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.653289e-01
[S9] stored merged vector for next round verification (round=1)
[S9] DEBUG after merge:  round=1 metric=0.1414 head_norm=0.876266 delta_norm=0.765329
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=1 metric=0.1423 head_norm=1.277538
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.743841e-01
[S5] stored merged vector for next round verification (round=1)
[S5] DEBUG after merge:  round=1 metric=0.3569 head_norm=0.877150 delta_norm=0.874384
[S5] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=1 metric=0.1400 head_norm=1.155686
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.806047e-01
[S8] stored merged vector for next round verification (round=1)
[S8] DEBUG after merge:  round=1 metric=0.4226 head_norm=0.885249 delta_norm=0.780605
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=1 metric=0.1721 head_norm=1.096245
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.718964e-01
[S4] stored merged vector for next round verification (round=1)
[S4] DEBUG after merge:  round=1 metric=0.3640 head_norm=0.828648 delta_norm=0.771896
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=1 metric=0.3901 head_norm=1.204329
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.806047e-01
[S14] stored merged vector for next round verification (round=1)
[S14] DEBUG after merge:  round=1 metric=0.1404 head_norm=0.885249 delta_norm=0.780605
[S14] aggregate: ROLLBACK (f1_val pre=0.390 post=0.140 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=1 metric=0.1669 head_norm=1.234675
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.465130e-01
[S16] stored merged vector for next round verification (round=1)
[S16] DEBUG after merge:  round=1 metric=0.4142 head_norm=0.870180 delta_norm=0.846513
[S16] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=1 metric=0.2906 head_norm=1.198152
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.997287e-01
[S10] stored merged vector for next round verification (round=1)
[S10] DEBUG after merge:  round=1 metric=0.3848 head_norm=0.884508 delta_norm=0.799729
[S10] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=1 metric=0.1397 head_norm=1.151804
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.050708e-01
[S15] stored merged vector for next round verification (round=1)
[S15] DEBUG after merge:  round=1 metric=0.1397 head_norm=0.881702 delta_norm=0.805071
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=1 metric=0.1421 head_norm=1.167566
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.718964e-01
[S7] stored merged vector for next round verification (round=1)
[S7] DEBUG after merge:  round=1 metric=0.1421 head_norm=0.828648 delta_norm=0.771896
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=1.157263 (no previous merge yet)
[S2] round=2 local utility u=0.010213 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.8815261493705517, 'loss_val': 1.2751532105876895, 'psi': 0.43767673978136074}-{'f1_val': 0.1417771333885667, 'auprc': 0.8865145902461353, 'loss_val': 1.3105441509683053, 'psi': 0.4396721161315942}
[S3] START round=2 head_norm_before_train=1.192969 (no previous merge yet)
[S3] round=2 local utility u=0.045427 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9974049408279237, 'loss_val': 1.207548912261304, 'psi': 0.4828660156996337}-{'f1_val': 0.13984006561410703, 'auprc': 0.9959257383952413, 'loss_val': 1.293965613326462, 'psi': 0.4822743347265608}
[S4] START round=2 head_norm_before_train=0.828648 cos_to_last_merge=1.0000 (last merge round=1)
[S4] round=2 local utility u=1.000000 metrics={'f1_val': 0.39440366696394863, 'auprc': 0.7377301507873133, 'loss_val': 1.3416582861423476, 'psi': 0.5317342604932945}-{'f1_val': 0.17211392405063292, 'auprc': 0.4902835233263441, 'loss_val': 1.3604969089428292, 'psi': 0.2993817637609174}
[S5] START round=2 head_norm_before_train=0.877150 cos_to_last_merge=1.0000 (last merge round=1)
[S5] round=2 local utility u=0.008373 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7315180043213512, 'loss_val': 1.2550844624207418, 'psi': 0.37796434458568334}-{'f1_val': 0.14226190476190476, 'auprc': 0.7297193154633896, 'loss_val': 1.2664343256310029, 'psi': 0.3772448690424987}
[S6] START round=2 head_norm_before_train=1.186706 (no previous merge yet)
[S6] round=2 local utility u=0.021429 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.9419751455095073, 'loss_val': 1.2571844247886779, 'psi': 0.46164582743457216}-{'f1_val': 0.14142628205128205, 'auprc': 0.940486174155241, 'loss_val': 1.2955756436622443, 'psi': 0.46105023889286567}
[S7] START round=2 head_norm_before_train=0.828648 cos_to_last_merge=1.0000 (last merge round=1)
[S7] round=2 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.78669576665946, 'loss_val': 1.264715420958213, 'psi': 0.399912400301239}-{'f1_val': 0.14205682272909165, 'auprc': 0.7948978213060813, 'loss_val': 1.281168539617374, 'psi': 0.40319322215988757}
[S8] START round=2 head_norm_before_train=0.885249 cos_to_last_merge=1.0000 (last merge round=1)
[S8] round=2 local utility u=0.144994 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7771013493491761, 'loss_val': 1.3144021440622915, 'psi': 0.3948141291754448}-{'f1_val': 0.13995598239295717, 'auprc': 0.6815126362648926, 'loss_val': 1.3176238229633312, 'psi': 0.35657864394173133}
[S9] START round=2 head_norm_before_train=0.876266 cos_to_last_merge=1.0000 (last merge round=1)
[S9] round=2 local utility u=0.035672 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8649162478817876, 'loss_val': 1.1529062144465212, 'psi': 0.43080527343671265}-{'f1_val': 0.141397957139996, 'auprc': 0.8656303147603664, 'loss_val': 1.2263928219237794, 'psi': 0.4310909001881442}
[S10] START round=2 head_norm_before_train=0.884508 cos_to_last_merge=1.0000 (last merge round=1)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.22238450083854833, 'auprc': 0.5606341391221731, 'loss_val': 1.3477333521661277, 'psi': 0.35768435615199823}-{'f1_val': 0.2906214098862031, 'auprc': 0.5332912864955633, 'loss_val': 1.3611530167808035, 'psi': 0.3876893605299472}
[S11] START round=2 head_norm_before_train=1.256927 (no previous merge yet)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7674241920828566, 'loss_val': 1.275668564125935, 'psi': 0.39121788685700903}-{'f1_val': 0.39756716255642854, 'auprc': 0.7641189748155879, 'loss_val': 1.3208817591291993, 'psi': 0.5441878874600923}
[S13] START round=2 head_norm_before_train=1.178473 (no previous merge yet)
[S13] round=2 local utility u=0.108015 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5935086968627158, 'loss_val': 1.2862180473179627, 'psi': 0.3216349362913182}-{'f1_val': 0.1403857625770531, 'auprc': 0.5347547218038731, 'loss_val': 1.3259853251415437, 'psi': 0.2981333462677811}
[S14] START round=2 head_norm_before_train=0.885249 cos_to_last_merge=1.0000 (last merge round=1)
[S14] round=2 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7648366660730754, 'loss_val': 1.3392563268019895, 'psi': 0.3901493781588524}-{'f1_val': 0.39007779894755945, 'auprc': 0.7314469402637525, 'loss_val': 1.358403064711599, 'psi': 0.5266254554740366}
[S15] START round=2 head_norm_before_train=0.881702 cos_to_last_merge=1.0000 (last merge round=1)
[S15] round=2 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.684627264543381, 'loss_val': 1.3315147038761062, 'psi': 0.3576910966342874}-{'f1_val': 0.13973365136155833, 'auprc': 0.7271392480350898, 'loss_val': 1.3305529614671707, 'psi': 0.3746958900309709}
[S16] START round=2 head_norm_before_train=0.870180 cos_to_last_merge=1.0000 (last merge round=1)
[S16] round=2 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7964886588136655, 'loss_val': 1.3208764913839273, 'psi': 0.40297793364498813}-{'f1_val': 0.1668636256204207, 'auprc': 0.785542930414217, 'loss_val': 1.3221629891461872, 'psi': 0.4143353475379392}
[S17] START round=2 head_norm_before_train=1.198238 (no previous merge yet)
[S17] round=2 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.7595945573256303, 'loss_val': 1.295370366258122, 'psi': 0.38840720092068276}-{'f1_val': 0.3523494365494678, 'auprc': 0.8162406827586275, 'loss_val': 1.337967716491764, 'psi': 0.5379059350331317}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.483)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:54508
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.395)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S2@127.0.0.1:54502
[S6] not sending this round → trigger blocked (psi=0.462)
[S2] not sending this round → trigger blocked (psi=0.438)
[S13] not sending this round → trigger blocked (psi=0.322)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.532)
[S9] sending update (kind=head size=1794 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1799) from S5
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.909553)
[S7] loaded HEAD from S5 (vec_in norm=0.909553)
[S7] cosine check vs S5: cos=0.0441
[S7] BUFFERED delta from S5 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1794) from S9
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.937343)
[S2] loaded HEAD from S9 (vec_in norm=0.937343)
[S2] cosine check vs S9: cos=-0.0303
[S2] DROPPED delta from S9 (cos=-0.0303 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=2 metric=0.1421 head_norm=0.875773
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.172599e-01
[S7] stored merged vector for next round verification (round=2)
[S7] DEBUG after merge:  round=2 metric=0.1421 head_norm=0.645076 delta_norm=0.617260
[S7] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=1.179542 (no previous merge yet)
[S2] round=3 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7603153895909764, 'loss_val': 1.232725302260904, 'psi': 0.3891924358695306}-{'f1_val': 0.1417771333885667, 'auprc': 0.8815261493705517, 'loss_val': 1.2751532105876895, 'psi': 0.43767673978136074}
[S3] START round=3 head_norm_before_train=1.239884 (no previous merge yet)
[S3] round=3 local utility u=0.863745 metrics={'f1_val': 0.39645225981545407, 'auprc': 0.9981092596006537, 'loss_val': 1.0218440645790197, 'psi': 0.6371150597295339}-{'f1_val': 0.13984006561410703, 'auprc': 0.9974049408279237, 'loss_val': 1.207548912261304, 'psi': 0.4828660156996337}
[S4] START round=3 head_norm_before_train=0.845849 cos_to_last_merge=0.9970 (last merge round=1)
[S4] round=3 local utility u=0.000000 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7704005986784372, 'loss_val': 1.3021183059137122, 'psi': 0.3922962168084854}-{'f1_val': 0.39440366696394863, 'auprc': 0.7377301507873133, 'loss_val': 1.3416582861423476, 'psi': 0.5317342604932945}
[S5] START round=3 head_norm_before_train=0.909553 cos_to_last_merge=0.9926 (last merge round=1)
[S5] round=3 local utility u=0.307942 metrics={'f1_val': 0.20593656009783648, 'auprc': 0.7713781970262462, 'loss_val': 1.1408280624154195, 'psi': 0.4321132148692004}-{'f1_val': 0.14226190476190476, 'auprc': 0.7315180043213512, 'loss_val': 1.2550844624207418, 'psi': 0.37796434458568334}
[S6] START round=3 head_norm_before_train=1.213562 (no previous merge yet)
[S6] round=3 local utility u=0.014180 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.9346703772116114, 'loss_val': 1.2069095323850847, 'psi': 0.4587239201154138}-{'f1_val': 0.14142628205128205, 'auprc': 0.9419751455095073, 'loss_val': 1.2571844247886779, 'psi': 0.46164582743457216}
[S7] START round=3 head_norm_before_train=0.645076 cos_to_last_merge=1.0000 (last merge round=2)
[S7] round=3 local utility u=0.006889 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7873532157172711, 'loss_val': 1.25291039960543, 'psi': 0.4001753799243635}-{'f1_val': 0.14205682272909165, 'auprc': 0.78669576665946, 'loss_val': 1.264715420958213, 'psi': 0.399912400301239}
[S8] START round=3 head_norm_before_train=0.897796 cos_to_last_merge=0.9974 (last merge round=1)
[S8] round=3 local utility u=0.022454 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7770587272579595, 'loss_val': 1.2693668511139957, 'psi': 0.39479708033895816}-{'f1_val': 0.13995598239295717, 'auprc': 0.7771013493491761, 'loss_val': 1.3144021440622915, 'psi': 0.3948141291754448}
[S9] START round=3 head_norm_before_train=0.937343 cos_to_last_merge=0.9933 (last merge round=1)
[S9] round=3 local utility u=0.852805 metrics={'f1_val': 0.3835168583508699, 'auprc': 0.8647542575502123, 'loss_val': 0.8995226837822918, 'psi': 0.5760118180306069}-{'f1_val': 0.141397957139996, 'auprc': 0.8649162478817876, 'loss_val': 1.1529062144465212, 'psi': 0.43080527343671265}
[S10] START round=3 head_norm_before_train=0.893737 cos_to_last_merge=0.9977 (last merge round=1)
[S10] round=3 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.5676415563070958, 'loss_val': 1.3219015397656435, 'psi': 0.31022960504787267}-{'f1_val': 0.22238450083854833, 'auprc': 0.5606341391221731, 'loss_val': 1.3477333521661277, 'psi': 0.35768435615199823}
[S11] START round=3 head_norm_before_train=1.279783 (no previous merge yet)
[S11] round=3 local utility u=0.024306 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7640389347807488, 'loss_val': 1.2169011988868874, 'psi': 0.3898637839361659}-{'f1_val': 0.14041368337311058, 'auprc': 0.7674241920828566, 'loss_val': 1.275668564125935, 'psi': 0.39121788685700903}
[S13] START round=3 head_norm_before_train=1.202465 (no previous merge yet)
[S13] round=3 local utility u=0.186324 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7027863230621012, 'loss_val': 1.2414032427533874, 'psi': 0.36534598677107233}-{'f1_val': 0.1403857625770531, 'auprc': 0.5935086968627158, 'loss_val': 1.2862180473179627, 'psi': 0.3216349362913182}
[S14] START round=3 head_norm_before_train=0.900046 cos_to_last_merge=0.9974 (last merge round=1)
[S14] round=3 local utility u=0.057506 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.795238558933685, 'loss_val': 1.3154504588555194, 'psi': 0.4023101353030963}-{'f1_val': 0.14035785288270378, 'auprc': 0.7648366660730754, 'loss_val': 1.3392563268019895, 'psi': 0.3901493781588524}
[S15] START round=3 head_norm_before_train=0.895107 cos_to_last_merge=0.9973 (last merge round=1)
[S15] round=3 local utility u=0.255491 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.8460762231588275, 'loss_val': 1.3048793184154361, 'psi': 0.42227068008046603}-{'f1_val': 0.13973365136155833, 'auprc': 0.684627264543381, 'loss_val': 1.3315147038761062, 'psi': 0.3576910966342874}
[S16] START round=3 head_norm_before_train=0.892402 cos_to_last_merge=0.9969 (last merge round=1)
[S16] round=3 local utility u=0.055366 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8191303163459916, 'loss_val': 1.2780685991390162, 'psi': 0.41203459665791864}-{'f1_val': 0.14063745019920318, 'auprc': 0.7964886588136655, 'loss_val': 1.3208764913839273, 'psi': 0.40297793364498813}
[S17] START round=3 head_norm_before_train=1.222692 (no previous merge yet)
[S17] round=3 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6109249140087383, 'loss_val': 1.2398148055392293, 'psi': 0.32893934359392596}-{'f1_val': 0.14094896331738438, 'auprc': 0.7595945573256303, 'loss_val': 1.295370366258122, 'psi': 0.38840720092068276}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S16] → sending delta(kind=head bytes=1790) to S14@127.0.0.1:54514
[S9] not sending this round → trigger blocked (psi=0.576)
[S5] not sending this round → trigger blocked (psi=0.432)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S7] → sending delta(kind=head bytes=1792) to S13@127.0.0.1:54513
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] → sending delta(kind=head bytes=1793) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:54511
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:54514
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:54502
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1793 to 1 peers)
[S7] sending update (kind=head size=1792 to 1 peers)
[S8] sending update (kind=head size=1794 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1790 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1795) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.919525)
[S14] loaded HEAD from S15 (vec_in norm=0.919525)
[S14] cosine check vs S15: cos=-0.0237
[S14] DROPPED delta from S15 (cos=-0.0237 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1792) from S7
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.687736)
[S13] loaded HEAD from S7 (vec_in norm=0.687736)
[S13] cosine check vs S7: cos=-0.0268
[S13] DROPPED delta from S7 (cos=-0.0268 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1795) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.920661)
[S7] loaded HEAD from S14 (vec_in norm=0.920661)
[S7] cosine check vs S14: cos=0.0468
[S7] BUFFERED delta from S14 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1793) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.247796)
[S7] loaded HEAD from S6 (vec_in norm=1.247796)
[S7] cosine check vs S6: cos=-0.0270
[S7] DROPPED delta from S6 (cos=-0.0270 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1796) from S13
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.232214)
[S10] loaded HEAD from S13 (vec_in norm=1.232214)
[S10] cosine check vs S13: cos=-0.0180
[S10] DROPPED delta from S13 (cos=-0.0180 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1800) from S3
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.297490)
[S14] loaded HEAD from S3 (vec_in norm=1.297490)
[S14] cosine check vs S3: cos=-0.0127
[S14] DROPPED delta from S3 (cos=-0.0127 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1790) from S16
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.922593)
[S14] loaded HEAD from S16 (vec_in norm=0.922593)
[S14] cosine check vs S16: cos=-0.0276
[S14] DROPPED delta from S16 (cos=-0.0276 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1795) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.310562)
[S2] loaded HEAD from S11 (vec_in norm=1.310562)
[S2] cosine check vs S11: cos=0.0704
[S2] BUFFERED delta from S11 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1794) from S8
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.921174)
[S5] loaded HEAD from S8 (vec_in norm=0.921174)
[S5] cosine check vs S8: cos=0.0965
[S5] BUFFERED delta from S8 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=3 metric=0.2059 head_norm=0.950176
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.289806e-01
[S5] stored merged vector for next round verification (round=3)
[S5] DEBUG after merge:  round=3 metric=0.1792 head_norm=0.692879 delta_norm=0.628981
[S5] aggregate: ROLLBACK (f1_val pre=0.206 post=0.179 tol_abs=0.005 tol_rel=0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=3 metric=0.1418 head_norm=1.206609
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.588883e-01
[S2] stored merged vector for next round verification (round=3)
[S2] DEBUG after merge:  round=3 metric=0.1418 head_norm=0.921439 delta_norm=0.858888
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=3 metric=0.1421 head_norm=0.687736
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.615379e-01
[S7] stored merged vector for next round verification (round=3)
[S7] DEBUG after merge:  round=3 metric=0.1421 head_norm=0.587345 delta_norm=0.561538
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=0.921439 cos_to_last_merge=1.0000 (last merge round=3)
[S2] round=4 local utility u=0.003721 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7625790158795134, 'loss_val': 1.2320748017159593, 'psi': 0.3900978863849454}-{'f1_val': 0.1417771333885667, 'auprc': 0.7603153895909764, 'loss_val': 1.232725302260904, 'psi': 0.3891924358695306}
[S3] START round=4 head_norm_before_train=1.297490 (no previous merge yet)
[S3] round=4 local utility u=0.000000 metrics={'f1_val': 0.41539830533065536, 'auprc': 0.8686852644507996, 'loss_val': 0.7958375112496391, 'psi': 0.5967130889787131}-{'f1_val': 0.39645225981545407, 'auprc': 0.9981092596006537, 'loss_val': 1.0218440645790197, 'psi': 0.6371150597295339}
[S4] START round=4 head_norm_before_train=0.873243 cos_to_last_merge=0.9886 (last merge round=1)
[S4] round=4 local utility u=0.039916 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7749620978096206, 'loss_val': 1.2359715808016134, 'psi': 0.3941208164609587}-{'f1_val': 0.14022662889518414, 'auprc': 0.7704005986784372, 'loss_val': 1.3021183059137122, 'psi': 0.3922962168084854}
[S5] START round=4 head_norm_before_train=0.692879 cos_to_last_merge=1.0000 (last merge round=3)
[S5] round=4 local utility u=0.700000 metrics={'f1_val': 0.4191212159017216, 'auprc': 0.7776608992299474, 'loss_val': 1.0387835572463133, 'psi': 0.5625370892330119}-{'f1_val': 0.20593656009783648, 'auprc': 0.7713781970262462, 'loss_val': 1.1408280624154195, 'psi': 0.4321132148692004}
[S6] START round=4 head_norm_before_train=1.247796 (no previous merge yet)
[S6] round=4 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8544400969114876, 'loss_val': 1.1399147713798279, 'psi': 0.42663180799536427}-{'f1_val': 0.14142628205128205, 'auprc': 0.9346703772116114, 'loss_val': 1.2069095323850847, 'psi': 0.4587239201154138}
[S7] START round=4 head_norm_before_train=0.587345 cos_to_last_merge=1.0000 (last merge round=3)
[S7] round=4 local utility u=0.007268 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7777527623850499, 'loss_val': 1.209573819386504, 'psi': 0.396335198591475}-{'f1_val': 0.14205682272909165, 'auprc': 0.7873532157172711, 'loss_val': 1.25291039960543, 'psi': 0.4001753799243635}
[S8] START round=4 head_norm_before_train=0.921174 cos_to_last_merge=0.9898 (last merge round=1)
[S8] round=4 local utility u=0.027542 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7769719908910213, 'loss_val': 1.2140226218728443, 'psi': 0.39476238579218287}-{'f1_val': 0.13995598239295717, 'auprc': 0.7770587272579595, 'loss_val': 1.2693668511139957, 'psi': 0.39479708033895816}
[S9] START round=4 head_norm_before_train=1.011972 cos_to_last_merge=0.9784 (last merge round=1)
[S9] round=4 local utility u=1.000000 metrics={'f1_val': 0.7005195233974337, 'auprc': 0.9993714273302495, 'loss_val': 0.6877444437918628, 'psi': 0.82006028497056}-{'f1_val': 0.3835168583508699, 'auprc': 0.8647542575502123, 'loss_val': 0.8995226837822918, 'psi': 0.5760118180306069}
[S10] START round=4 head_norm_before_train=0.913440 cos_to_last_merge=0.9910 (last merge round=1)
[S10] round=4 local utility u=0.054053 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.5917612043218359, 'loss_val': 1.2861537698599868, 'psi': 0.31987746425376873}-{'f1_val': 0.13862163754172394, 'auprc': 0.5676415563070958, 'loss_val': 1.3219015397656435, 'psi': 0.31022960504787267}
[S11] START round=4 head_norm_before_train=1.310562 (no previous merge yet)
[S11] round=4 local utility u=0.035252 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.765316309990064, 'loss_val': 1.1502283616993567, 'psi': 0.3903747340198919}-{'f1_val': 0.14041368337311058, 'auprc': 0.7640389347807488, 'loss_val': 1.2169011988868874, 'psi': 0.3898637839361659}
[S13] START round=4 head_norm_before_train=1.232214 (no previous merge yet)
[S13] round=4 local utility u=0.054449 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7233050065985073, 'loss_val': 1.1940612996931064, 'psi': 0.3735534601856348}-{'f1_val': 0.1403857625770531, 'auprc': 0.7027863230621012, 'loss_val': 1.2414032427533874, 'psi': 0.36534598677107233}
[S14] START round=4 head_norm_before_train=0.920661 cos_to_last_merge=0.9903 (last merge round=1)
[S14] round=4 local utility u=0.028244 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8025438247185518, 'loss_val': 1.2808777722970606, 'psi': 0.40523224161704297}-{'f1_val': 0.14035785288270378, 'auprc': 0.795238558933685, 'loss_val': 1.3154504588555194, 'psi': 0.4023101353030963}
[S15] START round=4 head_norm_before_train=0.919525 cos_to_last_merge=0.9897 (last merge round=1)
[S15] round=4 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7847465616579732, 'loss_val': 1.2642025465360227, 'psi': 0.3977388154801243}-{'f1_val': 0.13973365136155833, 'auprc': 0.8460762231588275, 'loss_val': 1.3048793184154361, 'psi': 0.42227068008046603}
[S16] START round=4 head_norm_before_train=0.922593 cos_to_last_merge=0.9890 (last merge round=1)
[S16] round=4 local utility u=0.093638 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8651498572077148, 'loss_val': 1.2288519228744061, 'psi': 0.4304424130026079}-{'f1_val': 0.14063745019920318, 'auprc': 0.8191303163459916, 'loss_val': 1.2780685991390162, 'psi': 0.41203459665791864}
[S17] START round=4 head_norm_before_train=1.252599 (no previous merge yet)
[S17] round=4 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5703850513233477, 'loss_val': 1.172897264678163, 'psi': 0.3127233985197697}-{'f1_val': 0.14094896331738438, 'auprc': 0.6109249140087383, 'loss_val': 1.2398148055392293, 'psi': 0.32893934359392596}
[S8] not sending this round → trigger blocked (psi=0.395)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:54505
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.390)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.396)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:54503
[S14] not sending this round → trigger blocked (psi=0.405)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:54507
[S13] not sending this round → trigger blocked (psi=0.374)
[S16] not sending this round → trigger blocked (psi=0.430)
[S2] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1793 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1796) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=0.941814)
[S5] loaded HEAD from S10 (vec_in norm=0.941814)
[S5] cosine check vs S10: cos=-0.0774
[S5] DROPPED delta from S10 (cos=-0.0774 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1801) from S2
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=0.946332)
[S6] loaded HEAD from S2 (vec_in norm=0.946332)
[S6] cosine check vs S2: cos=0.0423
[S6] BUFFERED delta from S2 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1795) from S9
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.110640)
[S7] loaded HEAD from S9 (vec_in norm=1.110640)
[S7] cosine check vs S9: cos=-0.0292
[S7] DROPPED delta from S9 (cos=-0.0292 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1793) from S4
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.910913)
[S14] loaded HEAD from S4 (vec_in norm=0.910913)
[S14] cosine check vs S4: cos=-0.0203
[S14] DROPPED delta from S4 (cos=-0.0203 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1800) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.758040)
[S3] loaded HEAD from S5 (vec_in norm=0.758040)
[S3] cosine check vs S5: cos=-0.0191
[S3] DROPPED delta from S5 (cos=-0.0191 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=4 metric=0.1414 head_norm=1.277262
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.785852e-01
[S6] stored merged vector for next round verification (round=4)
[S6] DEBUG after merge:  round=4 metric=0.1414 head_norm=0.810725 delta_norm=0.778585
[S6] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=0.946332 cos_to_last_merge=0.9977 (last merge round=3)
[S2] round=5 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6855718488375718, 'loss_val': 1.1807263192996909, 'psi': 0.3592950195681688}-{'f1_val': 0.1417771333885667, 'auprc': 0.7625790158795134, 'loss_val': 1.2320748017159593, 'psi': 0.3900978863849454}
[S3] START round=5 head_norm_before_train=1.369606 (no previous merge yet)
[S3] round=5 local utility u=0.000000 metrics={'f1_val': 0.40660015348722156, 'auprc': 0.8294868079840703, 'loss_val': 0.7566036736099965, 'psi': 0.5757548152859611}-{'f1_val': 0.41539830533065536, 'auprc': 0.8686852644507996, 'loss_val': 0.7958375112496391, 'psi': 0.5967130889787131}
[S4] START round=5 head_norm_before_train=0.910913 cos_to_last_merge=0.9755 (last merge round=1)
[S4] round=5 local utility u=0.022894 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7597261409950046, 'loss_val': 1.1444751177919008, 'psi': 0.3880264337351123}-{'f1_val': 0.14022662889518414, 'auprc': 0.7749620978096206, 'loss_val': 1.2359715808016134, 'psi': 0.3941208164609587}
[S5] START round=5 head_norm_before_train=0.758040 cos_to_last_merge=0.9894 (last merge round=3)
[S5] round=5 local utility u=0.711645 metrics={'f1_val': 0.6198938892615757, 'auprc': 0.7774303665027721, 'loss_val': 0.8194385802392004, 'psi': 0.6829084801580543}-{'f1_val': 0.4191212159017216, 'auprc': 0.7776608992299474, 'loss_val': 1.0387835572463133, 'psi': 0.5625370892330119}
[S6] START round=5 head_norm_before_train=0.810725 cos_to_last_merge=1.0000 (last merge round=4)
[S6] round=5 local utility u=0.727703 metrics={'f1_val': 0.3379242433190346, 'auprc': 0.9434805908000267, 'loss_val': 1.1306189856469915, 'psi': 0.5801467823114315}-{'f1_val': 0.14142628205128205, 'auprc': 0.8544400969114876, 'loss_val': 1.1399147713798279, 'psi': 0.42663180799536427}
[S7] START round=5 head_norm_before_train=0.628867 cos_to_last_merge=0.9883 (last merge round=3)
[S7] round=5 local utility u=0.914033 metrics={'f1_val': 0.41703542715461484, 'auprc': 0.7775461561104985, 'loss_val': 1.0307598567077092, 'psi': 0.5612397187369682}-{'f1_val': 0.14205682272909165, 'auprc': 0.7777527623850499, 'loss_val': 1.209573819386504, 'psi': 0.396335198591475}
[S8] START round=5 head_norm_before_train=0.952467 cos_to_last_merge=0.9793 (last merge round=1)
[S8] round=5 local utility u=0.027774 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7771103879597419, 'loss_val': 1.1588906139145279, 'psi': 0.39481774461967106}-{'f1_val': 0.13995598239295717, 'auprc': 0.7769719908910213, 'loss_val': 1.2140226218728443, 'psi': 0.39476238579218287}
[S9] START round=5 head_norm_before_train=1.110640 cos_to_last_merge=0.9562 (last merge round=1)
[S9] round=5 local utility u=0.096227 metrics={'f1_val': 0.701513881536201, 'auprc': 0.9990263840072968, 'loss_val': 0.5002216838467627, 'psi': 0.8205188825246393}-{'f1_val': 0.7005195233974337, 'auprc': 0.9993714273302495, 'loss_val': 0.6877444437918628, 'psi': 0.82006028497056}
[S10] START round=5 head_norm_before_train=0.941814 cos_to_last_merge=0.9809 (last merge round=1)
[S10] round=5 local utility u=0.041342 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.5993909541418282, 'loss_val': 1.226358488389546, 'psi': 0.32292936418176565}-{'f1_val': 0.13862163754172394, 'auprc': 0.5917612043218359, 'loss_val': 1.2861537698599868, 'psi': 0.31987746425376873}
[S11] START round=5 head_norm_before_train=1.331144 (no previous merge yet)
[S11] round=5 local utility u=0.904156 metrics={'f1_val': 0.42282222891848775, 'auprc': 0.7666115072630738, 'loss_val': 1.0402531922908798, 'psi': 0.5603379402563222}-{'f1_val': 0.14041368337311058, 'auprc': 0.765316309990064, 'loss_val': 1.1502283616993567, 'psi': 0.3903747340198919}
[S13] START round=5 head_norm_before_train=1.265591 (no previous merge yet)
[S13] round=5 local utility u=0.794044 metrics={'f1_val': 0.4108995334140799, 'auprc': 0.6897952756148888, 'loss_val': 1.128526091434214, 'psi': 0.5224578302944034}-{'f1_val': 0.1403857625770531, 'auprc': 0.7233050065985073, 'loss_val': 1.1940612996931064, 'psi': 0.3735534601856348}
[S14] START round=5 head_norm_before_train=0.951022 cos_to_last_merge=0.9793 (last merge round=1)
[S14] round=5 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7736762551748109, 'loss_val': 1.2275141270703176, 'psi': 0.39368521379954663}-{'f1_val': 0.14035785288270378, 'auprc': 0.8025438247185518, 'loss_val': 1.2808777722970606, 'psi': 0.40523224161704297}
[S15] START round=5 head_norm_before_train=0.956915 cos_to_last_merge=0.9779 (last merge round=1)
[S15] round=5 local utility u=0.021514 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7837143922873554, 'loss_val': 1.2180775994151287, 'psi': 0.3973259477318772}-{'f1_val': 0.13973365136155833, 'auprc': 0.7847465616579732, 'loss_val': 1.2642025465360227, 'psi': 0.3977388154801243}
[S16] START round=5 head_norm_before_train=0.954250 cos_to_last_merge=0.9793 (last merge round=1)
[S16] round=5 local utility u=0.862212 metrics={'f1_val': 0.4140870532610207, 'auprc': 0.8649821010238004, 'loss_val': 1.1446232049106055, 'psi': 0.5944450723661325}-{'f1_val': 0.14063745019920318, 'auprc': 0.8651498572077148, 'loss_val': 1.2288519228744061, 'psi': 0.4304424130026079}
[S17] START round=5 head_norm_before_train=1.281163 (no previous merge yet)
[S17] round=5 local utility u=0.781085 metrics={'f1_val': 0.36161909369456535, 'auprc': 0.6162281658551886, 'loss_val': 1.0722770686777519, 'psi': 0.46346272255881465}-{'f1_val': 0.14094896331738438, 'auprc': 0.5703850513233477, 'loss_val': 1.172897264678163, 'psi': 0.3127233985197697}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S16] → sending delta(kind=head bytes=1789) to S14@127.0.0.1:54514
[S10] not sending this round → trigger blocked (psi=0.323)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:54511
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:54514
[S9] not sending this round → trigger blocked (psi=0.821)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:54508
[S5] not sending this round → trigger blocked (psi=0.683)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:54502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S8] → sending delta(kind=head bytes=1791) to S5@127.0.0.1:54505
[S4] not sending this round → trigger blocked (psi=0.388)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] → sending delta(kind=head bytes=1793) to S13@127.0.0.1:54513
[S7] sending update (kind=head size=1793 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1791 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1789 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1798) from S13
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.294527)
[S10] loaded HEAD from S13 (vec_in norm=1.294527)
[S10] cosine check vs S13: cos=-0.0051
[S10] DROPPED delta from S13 (cos=-0.0051 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1801) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.992769)
[S14] loaded HEAD from S15 (vec_in norm=0.992769)
[S14] cosine check vs S15: cos=-0.0363
[S14] DROPPED delta from S15 (cos=-0.0363 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1789) from S16
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.994101)
[S14] loaded HEAD from S16 (vec_in norm=0.994101)
[S14] cosine check vs S16: cos=-0.0374
[S14] DROPPED delta from S16 (cos=-0.0374 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1801) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.358616)
[S2] loaded HEAD from S11 (vec_in norm=1.358616)
[S2] cosine check vs S11: cos=0.7071
[S2] BUFFERED delta from S11 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1798) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.843078)
[S7] loaded HEAD from S6 (vec_in norm=0.843078)
[S7] cosine check vs S6: cos=-0.0779
[S7] DROPPED delta from S6 (cos=-0.0779 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1791) from S8
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.974306)
[S5] loaded HEAD from S8 (vec_in norm=0.974306)
[S5] cosine check vs S8: cos=0.6447
[S5] BUFFERED delta from S8 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1793) from S7
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.675458)
[S13] loaded HEAD from S7 (vec_in norm=0.675458)
[S13] cosine check vs S7: cos=-0.0634
[S13] DROPPED delta from S7 (cos=-0.0634 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:54509
[S17] sending update (kind=head size=1793 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1793) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.306143)
[S8] loaded HEAD from S17 (vec_in norm=1.306143)
[S8] cosine check vs S17: cos=0.0005
[S8] BUFFERED delta from S17 (total buffered=1)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=5 metric=0.1418 head_norm=0.976066
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.803835e-01
[S2] stored merged vector for next round verification (round=5)
[S2] DEBUG after merge:  round=5 metric=0.1418 head_norm=1.080973 delta_norm=0.480384
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.358 → S6@127.0.0.1:54507
[S4] ⇄ pheromone p=0.479 → S14@127.0.0.1:54514
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=5 metric=0.6199 head_norm=0.841264
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.873191e-01
[S5] stored merged vector for next round verification (round=5)
[S5] DEBUG after merge:  round=5 metric=0.7136 head_norm=0.823700 delta_norm=0.387319
[S5] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.622 → S3@127.0.0.1:54503
[S3] ⇄ pheromone p=0.463 → S14@127.0.0.1:54514
[S10] ⇄ pheromone p=0.427 → S5@127.0.0.1:54505
[S14] ⇄ pheromone p=0.421 → S7@127.0.0.1:54508
[S9] ⇄ pheromone p=0.620 → S7@127.0.0.1:54508
[S15] ⇄ pheromone p=0.386 → S14@127.0.0.1:54514
[S6] ⇄ pheromone p=0.486 → S7@127.0.0.1:54508
[S16] ⇄ pheromone p=0.539 → S14@127.0.0.1:54514
[S7] ⇄ pheromone p=0.515 → S13@127.0.0.1:54513
[S11] ⇄ pheromone p=0.524 → S2@127.0.0.1:54502
[S13] ⇄ pheromone p=0.539 → S10@127.0.0.1:54511
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=5 metric=0.1400 head_norm=0.974306
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.145712e-01
[S8] stored merged vector for next round verification (round=5)
[S8] DEBUG after merge:  round=5 metric=0.4259 head_norm=0.814933 delta_norm=0.814571
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.378 → S5@127.0.0.1:54505
[S17] ⇄ pheromone p=0.554 → S8@127.0.0.1:54509
[S2] START round=6 head_norm_before_train=1.080973 cos_to_last_merge=1.0000 (last merge round=5)
[S2] round=6 local utility u=0.974208 metrics={'f1_val': 0.4158821818019893, 'auprc': 0.7718215464450324, 'loss_val': 1.1356894780969473, 'psi': 0.5582579276592066}-{'f1_val': 0.1417771333885667, 'auprc': 0.6855718488375718, 'loss_val': 1.1807263192996909, 'psi': 0.3592950195681688}
[S3] START round=6 head_norm_before_train=1.441676 (no previous merge yet)
[S3] round=6 local utility u=1.000000 metrics={'f1_val': 0.6426227080103201, 'auprc': 0.9926911463554657, 'loss_val': 0.477588879825731, 'psi': 0.7826500833483783}-{'f1_val': 0.40660015348722156, 'auprc': 0.8294868079840703, 'loss_val': 0.7566036736099965, 'psi': 0.5757548152859611}
[S4] START round=6 head_norm_before_train=0.952186 cos_to_last_merge=0.9616 (last merge round=1)
[S4] round=6 local utility u=0.893335 metrics={'f1_val': 0.4176894047328722, 'auprc': 0.760773810759453, 'loss_val': 1.0257248065675801, 'psi': 0.5549231671435045}-{'f1_val': 0.14022662889518414, 'auprc': 0.7597261409950046, 'loss_val': 1.1444751177919008, 'psi': 0.3880264337351123}
[S5] START round=6 head_norm_before_train=0.823700 cos_to_last_merge=1.0000 (last merge round=5)
[S5] round=6 local utility u=0.125054 metrics={'f1_val': 0.7009903122607499, 'auprc': 0.6604889741781486, 'loss_val': 0.705084320076916, 'psi': 0.6847897770277094}-{'f1_val': 0.6198938892615757, 'auprc': 0.7774303665027721, 'loss_val': 0.8194385802392004, 'psi': 0.6829084801580543}
[S6] START round=6 head_norm_before_train=0.843078 cos_to_last_merge=0.9976 (last merge round=4)
[S6] round=6 local utility u=0.077984 metrics={'f1_val': 0.41693470025384477, 'auprc': 0.7802580769855065, 'loss_val': 0.9590464437060309, 'psi': 0.5622640509465096}-{'f1_val': 0.3379242433190346, 'auprc': 0.9434805908000267, 'loss_val': 1.1306189856469915, 'psi': 0.5801467823114315}
[S7] START round=6 head_norm_before_train=0.675458 cos_to_last_merge=0.9634 (last merge round=3)
[S7] round=6 local utility u=0.086443 metrics={'f1_val': 0.41679099637737954, 'auprc': 0.7869548434965018, 'loss_val': 0.884633868278204, 'psi': 0.5648565352250284}-{'f1_val': 0.41703542715461484, 'auprc': 0.7775461561104985, 'loss_val': 1.0307598567077092, 'psi': 0.5612397187369682}
[S8] START round=6 head_norm_before_train=0.814933 cos_to_last_merge=1.0000 (last merge round=5)
[S8] round=6 local utility u=1.000000 metrics={'f1_val': 0.7145237961103252, 'auprc': 0.7754805959477986, 'loss_val': 1.1946410324199037, 'psi': 0.7389065160453145}-{'f1_val': 0.13995598239295717, 'auprc': 0.7771103879597419, 'loss_val': 1.1588906139145279, 'psi': 0.39481774461967106}
[S9] START round=6 head_norm_before_train=1.208659 cos_to_last_merge=0.9345 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.935
[S9] round=6 local utility u=0.094262 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.9984747918250868, 'loss_val': 0.3091470300424074, 'psi': 0.8202087173615402}-{'f1_val': 0.701513881536201, 'auprc': 0.9990263840072968, 'loss_val': 0.5002216838467627, 'psi': 0.8205188825246393}
[S10] START round=6 head_norm_before_train=0.981914 cos_to_last_merge=0.9683 (last merge round=1)
[S10] round=6 local utility u=0.915043 metrics={'f1_val': 0.39897638822357306, 'auprc': 0.6530377145682079, 'loss_val': 1.1193419524216677, 'psi': 0.5006009187614271}-{'f1_val': 0.13862163754172394, 'auprc': 0.5993909541418282, 'loss_val': 1.226358488389546, 'psi': 0.32292936418176565}
[S11] START round=6 head_norm_before_train=1.358616 (no previous merge yet)
[S11] round=6 local utility u=0.005940 metrics={'f1_val': 0.3966199105536595, 'auprc': 0.7706993899595413, 'loss_val': 0.8834234366502052, 'psi': 0.5462517023160123}-{'f1_val': 0.42282222891848775, 'auprc': 0.7666115072630738, 'loss_val': 1.0402531922908798, 'psi': 0.5603379402563222}
[S13] START round=6 head_norm_before_train=1.294527 (no previous merge yet)
[S13] round=6 local utility u=0.000000 metrics={'f1_val': 0.37184157114924216, 'auprc': 0.576450798694131, 'loss_val': 1.065712771986178, 'psi': 0.4536852621671977}-{'f1_val': 0.4108995334140799, 'auprc': 0.6897952756148888, 'loss_val': 1.128526091434214, 'psi': 0.5224578302944034}
[S14] START round=6 head_norm_before_train=0.988815 cos_to_last_merge=0.9654 (last merge round=1)
[S14] round=6 local utility u=0.179614 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8666883767068868, 'loss_val': 1.1473228454414344, 'psi': 0.430890062412377}-{'f1_val': 0.14035785288270378, 'auprc': 0.7736762551748109, 'loss_val': 1.2275141270703176, 'psi': 0.39368521379954663}
[S15] START round=6 head_norm_before_train=0.992769 cos_to_last_merge=0.9662 (last merge round=1)
[S15] round=6 local utility u=0.054435 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7944070583348521, 'loss_val': 1.1412861915365173, 'psi': 0.4016030141508759}-{'f1_val': 0.13973365136155833, 'auprc': 0.7837143922873554, 'loss_val': 1.2180775994151287, 'psi': 0.3973259477318772}
[S16] START round=6 head_norm_before_train=0.994101 cos_to_last_merge=0.9679 (last merge round=1)
[S16] round=6 local utility u=0.062934 metrics={'f1_val': 0.41722699281147574, 'auprc': 0.8550385128989912, 'loss_val': 1.007764576628669, 'psi': 0.592351600846482}-{'f1_val': 0.4140870532610207, 'auprc': 0.8649821010238004, 'loss_val': 1.1446232049106055, 'psi': 0.5944450723661325}
[S17] START round=6 head_norm_before_train=1.306143 (no previous merge yet)
[S17] round=6 local utility u=0.230406 metrics={'f1_val': 0.3918227013590554, 'auprc': 0.6744739466936269, 'loss_val': 0.9674246245672814, 'psi': 0.504883199492884}-{'f1_val': 0.36161909369456535, 'auprc': 0.6162281658551886, 'loss_val': 1.0722770686777519, 'psi': 0.46346272255881465}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] → sending delta(kind=head bytes=1792) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S2] → sending delta(kind=head bytes=1788) to S6@127.0.0.1:54507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:54508
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:54513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:54503
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S11] → sending delta(kind=head bytes=1788) to S2@127.0.0.1:54502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:54514
[S10] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1792 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1788 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1794 to 1 peers)
[S2] sending update (kind=head size=1788 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1788) from S2
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.096957)
[S6] loaded HEAD from S2 (vec_in norm=1.096957)
[S6] cosine check vs S2: cos=0.5312
[S6] BUFFERED delta from S2 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1798) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.898394)
[S3] loaded HEAD from S5 (vec_in norm=0.898394)
[S3] cosine check vs S5: cos=-0.0518
[S3] DROPPED delta from S5 (cos=-0.0518 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1788) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.392774)
[S2] loaded HEAD from S11 (vec_in norm=1.392774)
[S2] cosine check vs S11: cos=0.9315
[S2] BUFFERED delta from S11 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1797) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.027995)
[S5] loaded HEAD from S10 (vec_in norm=1.027995)
[S5] cosine check vs S10: cos=-0.0638
[S5] DROPPED delta from S10 (cos=-0.0638 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1802) from S7
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.724520)
[S13] loaded HEAD from S7 (vec_in norm=0.724520)
[S13] cosine check vs S7: cos=-0.0635
[S13] DROPPED delta from S7 (cos=-0.0635 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1802) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.032912)
[S14] loaded HEAD from S15 (vec_in norm=1.032912)
[S14] cosine check vs S15: cos=-0.0413
[S14] DROPPED delta from S15 (cos=-0.0413 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1794) from S9
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.302766)
[S7] loaded HEAD from S9 (vec_in norm=1.302766)
[S7] cosine check vs S9: cos=-0.0172
[S7] DROPPED delta from S9 (cos=-0.0172 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1800) from S3
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.496840)
[S14] loaded HEAD from S3 (vec_in norm=1.496840)
[S14] cosine check vs S3: cos=-0.0558
[S14] DROPPED delta from S3 (cos=-0.0558 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1795) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.029382)
[S7] loaded HEAD from S14 (vec_in norm=1.029382)
[S7] cosine check vs S14: cos=0.6624
[S7] BUFFERED delta from S14 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1802) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.888484)
[S7] loaded HEAD from S6 (vec_in norm=0.888484)
[S7] cosine check vs S6: cos=-0.0725
[S7] DROPPED delta from S6 (cos=-0.0725 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1798) from S4
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.987650)
[S14] loaded HEAD from S4 (vec_in norm=0.987650)
[S14] cosine check vs S4: cos=-0.0067
[S14] DROPPED delta from S4 (cos=-0.0067 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1792) from S16
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.040404)
[S14] loaded HEAD from S16 (vec_in norm=1.040404)
[S14] cosine check vs S16: cos=-0.0415
[S14] DROPPED delta from S16 (cos=-0.0415 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1795) from S8
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.838495)
[S5] loaded HEAD from S8 (vec_in norm=0.838495)
[S5] cosine check vs S8: cos=0.6730
[S5] BUFFERED delta from S8 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:54509
[S17] sending update (kind=head size=1795 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1795) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.339544)
[S8] loaded HEAD from S17 (vec_in norm=1.339544)
[S8] cosine check vs S17: cos=0.7825
[S8] BUFFERED delta from S17 (total buffered=1)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=6 metric=0.4159 head_norm=1.096957
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.723822e-01
[S2] stored merged vector for next round verification (round=6)
[S2] DEBUG after merge:  round=6 metric=0.4165 head_norm=1.223673 delta_norm=0.272382
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=6 metric=0.4168 head_norm=0.724520
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.861784e-01
[S7] stored merged vector for next round verification (round=6)
[S7] DEBUG after merge:  round=6 metric=0.5015 head_norm=0.801963 delta_norm=0.386178
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=6 metric=0.4169 head_norm=0.888484
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.892211e-01
[S6] stored merged vector for next round verification (round=6)
[S6] DEBUG after merge:  round=6 metric=0.4169 head_norm=0.870070 delta_norm=0.489221
[S6] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=6 metric=0.7010 head_norm=0.898394
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.521999e-01
[S5] stored merged vector for next round verification (round=6)
[S5] DEBUG after merge:  round=6 metric=0.7011 head_norm=0.794386 delta_norm=0.352200
[S5] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=6 metric=0.7145 head_norm=0.838495
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.300011e-01
[S8] stored merged vector for next round verification (round=6)
[S8] DEBUG after merge:  round=6 metric=0.3731 head_norm=1.031419 delta_norm=0.430001
[S8] aggregate: ROLLBACK (f1_val pre=0.715 post=0.373 tol_abs=0.005 tol_rel=0.0)
[S2] START round=7 head_norm_before_train=1.223673 cos_to_last_merge=1.0000 (last merge round=6)
[S2] round=7 local utility u=0.049621 metrics={'f1_val': 0.41702116831542674, 'auprc': 0.7780941830666268, 'loss_val': 1.0620999392557502, 'psi': 0.5614503742159067}-{'f1_val': 0.4158821818019893, 'auprc': 0.7718215464450324, 'loss_val': 1.1356894780969473, 'psi': 0.5582579276592066}
[S3] START round=7 head_norm_before_train=1.496840 (no previous merge yet)
[S3] round=7 local utility u=0.242086 metrics={'f1_val': 0.7000803035935849, 'auprc': 0.9943764667872694, 'loss_val': 0.3432180114985203, 'psi': 0.8177987688710587}-{'f1_val': 0.6426227080103201, 'auprc': 0.9926911463554657, 'loss_val': 0.477588879825731, 'psi': 0.7826500833483783}
[S4] START round=7 head_norm_before_train=0.987650 cos_to_last_merge=0.9497 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.950
[S4] round=7 local utility u=0.000000 metrics={'f1_val': 0.3705166984998414, 'auprc': 0.7602501695696575, 'loss_val': 0.8540699500492925, 'psi': 0.5264100869277679}-{'f1_val': 0.4176894047328722, 'auprc': 0.760773810759453, 'loss_val': 1.0257248065675801, 'psi': 0.5549231671435045}
[S5] START round=7 head_norm_before_train=0.794386 cos_to_last_merge=1.0000 (last merge round=6)
[S5] round=7 local utility u=0.017753 metrics={'f1_val': 0.7008162875368863, 'auprc': 0.654279539811029, 'loss_val': 0.649905377824367, 'psi': 0.6822015884465433}-{'f1_val': 0.7009903122607499, 'auprc': 0.6604889741781486, 'loss_val': 0.705084320076916, 'psi': 0.6847897770277094}
[S6] START round=7 head_norm_before_train=0.870070 cos_to_last_merge=1.0000 (last merge round=6)
[S6] round=7 local utility u=0.172660 metrics={'f1_val': 0.47257215494449284, 'auprc': 0.777154319510325, 'loss_val': 0.9382390825114256, 'psi': 0.5944050207708257}-{'f1_val': 0.41693470025384477, 'auprc': 0.7802580769855065, 'loss_val': 0.9590464437060309, 'psi': 0.5622640509465096}
[S7] START round=7 head_norm_before_train=0.801963 cos_to_last_merge=1.0000 (last merge round=6)
[S7] round=7 local utility u=0.033674 metrics={'f1_val': 0.416587999573199, 'auprc': 0.8028817781563528, 'loss_val': 0.8638493655921065, 'psi': 0.5711055110064605}-{'f1_val': 0.41679099637737954, 'auprc': 0.7869548434965018, 'loss_val': 0.884633868278204, 'psi': 0.5648565352250284}
[S8] START round=7 head_norm_before_train=1.031419 cos_to_last_merge=1.0000 (last merge round=6)
[S8] round=7 local utility u=0.051967 metrics={'f1_val': 0.7150982847375019, 'auprc': 0.7822860334417516, 'loss_val': 1.114569988949801, 'psi': 0.7419733842192018}-{'f1_val': 0.7145237961103252, 'auprc': 0.7754805959477986, 'loss_val': 1.1946410324199037, 'psi': 0.7389065160453145}
[S9] START round=7 head_norm_before_train=1.302766 cos_to_last_merge=0.9147 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.915
[S9] round=7 local utility u=0.023627 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.9987048175054792, 'loss_val': 0.26258215270706137, 'psi': 0.8203007276336972}-{'f1_val': 0.7013646677191758, 'auprc': 0.9984747918250868, 'loss_val': 0.3091470300424074, 'psi': 0.8202087173615402}
[S10] START round=7 head_norm_before_train=1.027995 cos_to_last_merge=0.9550 (last merge round=1)
[S10] round=7 local utility u=0.401201 metrics={'f1_val': 0.41689270364329833, 'auprc': 0.826503491692434, 'loss_val': 0.9448359293304398, 'psi': 0.5807370188629526}-{'f1_val': 0.39897638822357306, 'auprc': 0.6530377145682079, 'loss_val': 1.1193419524216677, 'psi': 0.5006009187614271}
[S11] START round=7 head_norm_before_train=1.392774 (no previous merge yet)
[S11] round=7 local utility u=0.394775 metrics={'f1_val': 0.39070224480672705, 'auprc': 0.9976456180449398, 'loss_val': 0.7392061648494292, 'psi': 0.6334795941020122}-{'f1_val': 0.3966199105536595, 'auprc': 0.7706993899595413, 'loss_val': 0.8834234366502052, 'psi': 0.5462517023160123}
[S13] START round=7 head_norm_before_train=1.320635 (no previous merge yet)
[S13] round=7 local utility u=1.000000 metrics={'f1_val': 0.6397298647486411, 'auprc': 0.7314029295990224, 'loss_val': 0.8898965493286422, 'psi': 0.6763990906887937}-{'f1_val': 0.37184157114924216, 'auprc': 0.576450798694131, 'loss_val': 1.065712771986178, 'psi': 0.4536852621671977}
[S14] START round=7 head_norm_before_train=1.029382 cos_to_last_merge=0.9508 (last merge round=1)
[S14] round=7 local utility u=0.889119 metrics={'f1_val': 0.3964619511854436, 'auprc': 0.9055984161196804, 'loss_val': 1.0224391532362869, 'psi': 0.6001165371591384}-{'f1_val': 0.14035785288270378, 'auprc': 0.8666883767068868, 'loss_val': 1.1473228454414344, 'psi': 0.430890062412377}
[S15] START round=7 head_norm_before_train=1.032912 cos_to_last_merge=0.9544 (last merge round=1)
[S15] round=7 local utility u=1.000000 metrics={'f1_val': 0.4734541897582615, 'auprc': 0.7996720139507979, 'loss_val': 1.0097318982909624, 'psi': 0.6039413194352761}-{'f1_val': 0.13973365136155833, 'auprc': 0.7944070583348521, 'loss_val': 1.1412861915365173, 'psi': 0.4016030141508759}
[S16] START round=7 head_norm_before_train=1.040404 cos_to_last_merge=0.9543 (last merge round=1)
[S16] round=7 local utility u=0.000000 metrics={'f1_val': 0.4171583814486223, 'auprc': 0.7431041413803849, 'loss_val': 0.8826808919921194, 'psi': 0.5475366854213274}-{'f1_val': 0.41722699281147574, 'auprc': 0.8550385128989912, 'loss_val': 1.007764576628669, 'psi': 0.592351600846482}
[S17] START round=7 head_norm_before_train=1.339544 (no previous merge yet)
[S17] round=7 local utility u=0.311111 metrics={'f1_val': 0.390873659960394, 'auprc': 0.8537338411783335, 'loss_val': 0.8772879671708282, 'psi': 0.5760177324475698}-{'f1_val': 0.3918227013590554, 'auprc': 0.6744739466936269, 'loss_val': 0.9674246245672814, 'psi': 0.504883199492884}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:54503
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:54507
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S8] → sending delta(kind=head bytes=1788) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:54508
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:54511
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:54513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:54502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:54505
[S15] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1788 to 1 peers)
[S2] sending update (kind=head size=1793 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1796) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.068397)
[S5] loaded HEAD from S10 (vec_in norm=1.068397)
[S5] cosine check vs S10: cos=-0.0673
[S5] DROPPED delta from S10 (cos=-0.0673 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1788) from S8
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.051010)
[S5] loaded HEAD from S8 (vec_in norm=1.051010)
[S5] cosine check vs S8: cos=0.6829
[S5] BUFFERED delta from S8 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1796) from S7
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.852997)
[S13] loaded HEAD from S7 (vec_in norm=0.852997)
[S13] cosine check vs S7: cos=-0.0656
[S13] DROPPED delta from S7 (cos=-0.0656 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1793) from S2
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.239335)
[S6] loaded HEAD from S2 (vec_in norm=1.239335)
[S6] cosine check vs S2: cos=0.8429
[S6] BUFFERED delta from S2 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1799) from S9
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.371144)
[S7] loaded HEAD from S9 (vec_in norm=1.371144)
[S7] cosine check vs S9: cos=-0.0195
[S7] DROPPED delta from S9 (cos=-0.0195 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1803) from S3
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.548717)
[S14] loaded HEAD from S3 (vec_in norm=1.548717)
[S14] cosine check vs S3: cos=-0.0634
[S14] DROPPED delta from S3 (cos=-0.0634 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1802) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.067719)
[S7] loaded HEAD from S14 (vec_in norm=1.067719)
[S7] cosine check vs S14: cos=0.8958
[S7] BUFFERED delta from S14 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1801) from S13
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.351505)
[S10] loaded HEAD from S13 (vec_in norm=1.351505)
[S10] cosine check vs S13: cos=0.0169
[S10] BUFFERED delta from S13 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1795) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.873251)
[S3] loaded HEAD from S5 (vec_in norm=0.873251)
[S3] cosine check vs S5: cos=-0.0764
[S3] DROPPED delta from S5 (cos=-0.0764 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1802) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.068526)
[S14] loaded HEAD from S15 (vec_in norm=1.068526)
[S14] cosine check vs S15: cos=-0.0417
[S14] DROPPED delta from S15 (cos=-0.0417 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1799) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.429984)
[S2] loaded HEAD from S11 (vec_in norm=1.429984)
[S2] cosine check vs S11: cos=0.9747
[S2] BUFFERED delta from S11 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1798) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.901672)
[S7] loaded HEAD from S6 (vec_in norm=0.901672)
[S7] cosine check vs S6: cos=-0.0745
[S7] DROPPED delta from S6 (cos=-0.0745 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:54509
[S17] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.377321)
[S8] loaded HEAD from S17 (vec_in norm=1.377321)
[S8] cosine check vs S17: cos=0.9507
[S8] BUFFERED delta from S17 (total buffered=1)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=7 metric=0.4166 head_norm=0.852997
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.428063e-01
[S7] stored merged vector for next round verification (round=7)
[S7] DEBUG after merge:  round=7 metric=0.4166 head_norm=0.935339 delta_norm=0.242806
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=7 metric=0.4169 head_norm=1.068397
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.542805e-01
[S10] stored merged vector for next round verification (round=7)
[S10] DEBUG after merge:  round=7 metric=0.4169 head_norm=0.868461 delta_norm=0.854281
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=7 metric=0.7151 head_norm=1.051010
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.495871e-01
[S8] stored merged vector for next round verification (round=7)
[S8] DEBUG after merge:  round=7 metric=0.3729 head_norm=1.199385 delta_norm=0.249587
[S8] aggregate: ROLLBACK (f1_val pre=0.715 post=0.373 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=7 metric=0.7008 head_norm=0.873251
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.916880e-01
[S5] stored merged vector for next round verification (round=7)
[S5] DEBUG after merge:  round=7 metric=0.7008 head_norm=0.883276 delta_norm=0.391688
[S5] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=7 metric=0.4726 head_norm=0.901672
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.409948e-01
[S6] stored merged vector for next round verification (round=7)
[S6] DEBUG after merge:  round=7 metric=0.4173 head_norm=1.028690 delta_norm=0.340995
[S6] aggregate: ROLLBACK (f1_val pre=0.473 post=0.417 tol_abs=0.005 tol_rel=0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=7 metric=0.4170 head_norm=1.239335
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.773826e-01
[S2] stored merged vector for next round verification (round=7)
[S2] DEBUG after merge:  round=7 metric=0.4172 head_norm=1.326249 delta_norm=0.177383
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=1.326249 cos_to_last_merge=1.0000 (last merge round=7)
[S2] round=8 local utility u=0.680798 metrics={'f1_val': 0.6221604648573115, 'auprc': 0.7768514812878025, 'loss_val': 0.9276123709522348, 'psi': 0.6840368714295079}-{'f1_val': 0.41702116831542674, 'auprc': 0.7780941830666268, 'loss_val': 1.0620999392557502, 'psi': 0.5614503742159067}
[S3] START round=8 head_norm_before_train=1.548717 (no previous merge yet)
[S3] round=8 local utility u=0.033505 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9971499733059312, 'loss_val': 0.28858466029797064, 'psi': 0.8193137115635523}-{'f1_val': 0.7000803035935849, 'auprc': 0.9943764667872694, 'loss_val': 0.3432180114985203, 'psi': 0.8177987688710587}
[S4] START round=8 head_norm_before_train=1.038432 cos_to_last_merge=0.9338 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.934
[S4] round=8 local utility u=0.038079 metrics={'f1_val': 0.37555433425835133, 'auprc': 0.7488994364165974, 'loss_val': 0.7740856583829615, 'psi': 0.5248923751216498}-{'f1_val': 0.3705166984998414, 'auprc': 0.7602501695696575, 'loss_val': 0.8540699500492925, 'psi': 0.5264100869277679}
[S5] START round=8 head_norm_before_train=0.883276 cos_to_last_merge=1.0000 (last merge round=7)
[S5] round=8 local utility u=0.037625 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.6656213124234978, 'loss_val': 0.6074337903709084, 'psi': 0.6866135605670036}-{'f1_val': 0.7008162875368863, 'auprc': 0.654279539811029, 'loss_val': 0.649905377824367, 'psi': 0.6822015884465433}
[S6] START round=8 head_norm_before_train=1.028690 cos_to_last_merge=1.0000 (last merge round=7)
[S6] round=8 local utility u=0.184251 metrics={'f1_val': 0.5314638918676087, 'auprc': 0.7764590102787847, 'loss_val': 0.9210012344617411, 'psi': 0.629461939232079}-{'f1_val': 0.47257215494449284, 'auprc': 0.777154319510325, 'loss_val': 0.9382390825114256, 'psi': 0.5944050207708257}
[S7] START round=8 head_norm_before_train=0.935339 cos_to_last_merge=1.0000 (last merge round=7)
[S7] round=8 local utility u=0.063861 metrics={'f1_val': 0.4332037263869923, 'auprc': 0.8011962499695522, 'loss_val': 0.8307649170204378, 'psi': 0.5804007358200163}-{'f1_val': 0.416587999573199, 'auprc': 0.8028817781563528, 'loss_val': 0.8638493655921065, 'psi': 0.5711055110064605}
[S8] START round=8 head_norm_before_train=1.199385 cos_to_last_merge=1.0000 (last merge round=7)
[S8] round=8 local utility u=0.000000 metrics={'f1_val': 0.3728657005221765, 'auprc': 0.8549411158789557, 'loss_val': 0.977232915380794, 'psi': 0.5656958666648881}-{'f1_val': 0.7150982847375019, 'auprc': 0.7822860334417516, 'loss_val': 1.114569988949801, 'psi': 0.7419733842192018}
[S9] START round=8 head_norm_before_train=1.371144 cos_to_last_merge=0.8990 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.899
[S9] round=8 local utility u=0.000000 metrics={'f1_val': 0.6995643863505786, 'auprc': 0.9453797859076284, 'loss_val': 0.29993340379129074, 'psi': 0.7978905461733985}-{'f1_val': 0.7013646677191758, 'auprc': 0.9987048175054792, 'loss_val': 0.26258215270706137, 'psi': 0.8203007276336972}
[S10] START round=8 head_norm_before_train=0.868461 cos_to_last_merge=1.0000 (last merge round=7)
[S10] round=8 local utility u=0.093592 metrics={'f1_val': 0.41670208314018853, 'auprc': 0.8585656356741698, 'loss_val': 0.8526948814566142, 'psi': 0.593447504153781}-{'f1_val': 0.41689270364329833, 'auprc': 0.826503491692434, 'loss_val': 0.9448359293304398, 'psi': 0.5807370188629526}
[S11] START round=8 head_norm_before_train=1.429984 (no previous merge yet)
[S11] round=8 local utility u=0.063765 metrics={'f1_val': 0.3981373814467868, 'auprc': 0.9983807714341141, 'loss_val': 0.6584920359760406, 'psi': 0.6382347374417178}-{'f1_val': 0.39070224480672705, 'auprc': 0.9976456180449398, 'loss_val': 0.7392061648494292, 'psi': 0.6334795941020122}
[S13] START round=8 head_norm_before_train=1.351505 (no previous merge yet)
[S13] round=8 local utility u=0.000000 metrics={'f1_val': 0.47497970409005946, 'auprc': 0.7344025931367244, 'loss_val': 0.7952699249318573, 'psi': 0.5787488597087254}-{'f1_val': 0.6397298647486411, 'auprc': 0.7314029295990224, 'loss_val': 0.8898965493286422, 'psi': 0.6763990906887937}
[S14] START round=8 head_norm_before_train=1.067719 cos_to_last_merge=0.9375 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.937
[S14] round=8 local utility u=0.583029 metrics={'f1_val': 0.5186828316418963, 'auprc': 0.9890033348447683, 'loss_val': 0.8399209073716039, 'psi': 0.7068110329230451}-{'f1_val': 0.3964619511854436, 'auprc': 0.9055984161196804, 'loss_val': 1.0224391532362869, 'psi': 0.6001165371591384}
[S15] START round=8 head_norm_before_train=1.068526 cos_to_last_merge=0.9444 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.944
[S15] round=8 local utility u=0.825782 metrics={'f1_val': 0.7145283320411205, 'auprc': 0.7996655836819065, 'loss_val': 0.8045944402315022, 'psi': 0.748583232697435}-{'f1_val': 0.4734541897582615, 'auprc': 0.7996720139507979, 'loss_val': 1.0097318982909624, 'psi': 0.6039413194352761}
[S16] START round=8 head_norm_before_train=1.071763 cos_to_last_merge=0.9422 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.942
[S16] round=8 local utility u=0.046482 metrics={'f1_val': 0.41700358386742975, 'auprc': 0.7470114644656857, 'loss_val': 0.8005107747127416, 'psi': 0.5490067361067321}-{'f1_val': 0.4171583814486223, 'auprc': 0.7431041413803849, 'loss_val': 0.8826808919921194, 'psi': 0.5475366854213274}
[S17] START round=8 head_norm_before_train=1.377321 (no previous merge yet)
[S17] round=8 local utility u=0.000000 metrics={'f1_val': 0.3530289445322021, 'auprc': 0.8927280131832545, 'loss_val': 0.9114785321399566, 'psi': 0.568908571992623}-{'f1_val': 0.390873659960394, 'auprc': 0.8537338411783335, 'loss_val': 0.8772879671708282, 'psi': 0.5760177324475698}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:54507
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] → sending delta(kind=head bytes=1792) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S10] → sending delta(kind=head bytes=1791) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S16] → sending delta(kind=head bytes=1791) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:54513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:54502
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:54503
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S16] sending update (kind=head size=1791 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1791 to 1 peers)
[S6] sending update (kind=head size=1792 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1791) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=0.905474)
[S5] loaded HEAD from S10 (vec_in norm=0.905474)
[S5] cosine check vs S10: cos=-0.0848
[S5] DROPPED delta from S10 (cos=-0.0848 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1791) from S16
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.106467)
[S14] loaded HEAD from S16 (vec_in norm=1.106467)
[S14] cosine check vs S16: cos=-0.0389
[S14] DROPPED delta from S16 (cos=-0.0389 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1797) from S4
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.091142)
[S14] loaded HEAD from S4 (vec_in norm=1.091142)
[S14] cosine check vs S4: cos=0.0022
[S14] BUFFERED delta from S4 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1796) from S7
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.986661)
[S13] loaded HEAD from S7 (vec_in norm=0.986661)
[S13] cosine check vs S7: cos=-0.0575
[S13] DROPPED delta from S7 (cos=-0.0575 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1792) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.048444)
[S7] loaded HEAD from S6 (vec_in norm=1.048444)
[S7] cosine check vs S6: cos=-0.0699
[S7] DROPPED delta from S6 (cos=-0.0699 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1801) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.955150)
[S3] loaded HEAD from S5 (vec_in norm=0.955150)
[S3] cosine check vs S5: cos=-0.0824
[S3] DROPPED delta from S5 (cos=-0.0824 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1799) from S2
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.347891)
[S6] loaded HEAD from S2 (vec_in norm=1.347891)
[S6] cosine check vs S2: cos=0.9437
[S6] BUFFERED delta from S2 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1795) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.468482)
[S2] loaded HEAD from S11 (vec_in norm=1.468482)
[S2] cosine check vs S11: cos=0.9848
[S2] BUFFERED delta from S11 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1800) from S3
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.601316)
[S14] loaded HEAD from S3 (vec_in norm=1.601316)
[S14] cosine check vs S3: cos=-0.0679
[S14] DROPPED delta from S3 (cos=-0.0679 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1800) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.119871)
[S7] loaded HEAD from S14 (vec_in norm=1.119871)
[S7] cosine check vs S14: cos=0.9476
[S7] BUFFERED delta from S14 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1800) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.114511)
[S14] loaded HEAD from S15 (vec_in norm=1.114511)
[S14] cosine check vs S15: cos=-0.0436
[S14] DROPPED delta from S15 (cos=-0.0436 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=8 metric=0.6222 head_norm=1.347891
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.367465e-01
[S2] stored merged vector for next round verification (round=8)
[S2] DEBUG after merge:  round=8 metric=0.6352 head_norm=1.402827 delta_norm=0.136746
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=8 metric=0.5187 head_norm=1.119871
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.809203e-01
[S14] stored merged vector for next round verification (round=8)
[S14] DEBUG after merge:  round=8 metric=0.3964 head_norm=0.782633 delta_norm=0.780920
[S14] aggregate: ROLLBACK (f1_val pre=0.519 post=0.396 tol_abs=0.005 tol_rel=0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=8 metric=0.5315 head_norm=1.048444
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.493418e-01
[S6] stored merged vector for next round verification (round=8)
[S6] DEBUG after merge:  round=8 metric=0.5437 head_norm=1.181461 delta_norm=0.249342
[S6] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=8 metric=0.4332 head_norm=0.986661
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.827561e-01
[S7] stored merged vector for next round verification (round=8)
[S7] DEBUG after merge:  round=8 metric=0.4369 head_norm=1.039426 delta_norm=0.182756
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.402827 cos_to_last_merge=1.0000 (last merge round=8)
[S2] round=9 local utility u=0.314194 metrics={'f1_val': 0.6980811998137325, 'auprc': 0.7780853533722238, 'loss_val': 0.7584509437990665, 'psi': 0.7300828612371291}-{'f1_val': 0.6221604648573115, 'auprc': 0.7768514812878025, 'loss_val': 0.9276123709522348, 'psi': 0.6840368714295079}
[S3] START round=9 head_norm_before_train=1.601316 (no previous merge yet)
[S3] round=9 local utility u=0.000000 metrics={'f1_val': 0.6940226410609599, 'auprc': 0.9940478469801332, 'loss_val': 0.2834449719342031, 'psi': 0.8140327234286292}-{'f1_val': 0.7007562037352997, 'auprc': 0.9971499733059312, 'loss_val': 0.28858466029797064, 'psi': 0.8193137115635523}
[S4] START round=9 head_norm_before_train=1.091142 cos_to_last_merge=0.9169 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.917
[S4] round=9 local utility u=0.000000 metrics={'f1_val': 0.38002734830391954, 'auprc': 0.6560949758683188, 'loss_val': 0.7031321784283694, 'psi': 0.4904543993296792}-{'f1_val': 0.37555433425835133, 'auprc': 0.7488994364165974, 'loss_val': 0.7740856583829615, 'psi': 0.5248923751216498}
[S5] START round=9 head_norm_before_train=0.955150 cos_to_last_merge=0.9879 (last merge round=7)
[S5] round=9 local utility u=0.356113 metrics={'f1_val': 0.7003603281361598, 'auprc': 0.8542481611184565, 'loss_val': 0.45959946472030705, 'psi': 0.7619154613290785}-{'f1_val': 0.7006083926626743, 'auprc': 0.6656213124234978, 'loss_val': 0.6074337903709084, 'psi': 0.6866135605670036}
[S6] START round=9 head_norm_before_train=1.181461 cos_to_last_merge=1.0000 (last merge round=8)
[S6] round=9 local utility u=0.373501 metrics={'f1_val': 0.6293567286159092, 'auprc': 0.7904466109055749, 'loss_val': 0.8033189201052914, 'psi': 0.6937926815317754}-{'f1_val': 0.5314638918676087, 'auprc': 0.7764590102787847, 'loss_val': 0.9210012344617411, 'psi': 0.629461939232079}
[S7] START round=9 head_norm_before_train=1.039426 cos_to_last_merge=1.0000 (last merge round=8)
[S7] round=9 local utility u=0.809649 metrics={'f1_val': 0.6709158320735003, 'auprc': 0.8448657048248653, 'loss_val': 0.7687488871918947, 'psi': 0.7404957811740462}-{'f1_val': 0.4332037263869923, 'auprc': 0.8011962499695522, 'loss_val': 0.8307649170204378, 'psi': 0.5804007358200163}
[S8] START round=9 head_norm_before_train=1.222900 cos_to_last_merge=0.9971 (last merge round=7)
[S8] round=9 local utility u=0.000000 metrics={'f1_val': 0.3731380036306732, 'auprc': 0.7941391648076028, 'loss_val': 0.8221141911845975, 'psi': 0.541538468101445}-{'f1_val': 0.3728657005221765, 'auprc': 0.8549411158789557, 'loss_val': 0.977232915380794, 'psi': 0.5656958666648881}
[S9] START round=9 head_norm_before_train=1.424255 cos_to_last_merge=0.8876 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.888
[S9] round=9 local utility u=0.147181 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9983262543196879, 'loss_val': 0.17476805848277588, 'psi': 0.8201047918524133}-{'f1_val': 0.6995643863505786, 'auprc': 0.9453797859076284, 'loss_val': 0.29993340379129074, 'psi': 0.7978905461733985}
[S10] START round=9 head_norm_before_train=0.905474 cos_to_last_merge=0.9964 (last merge round=7)
[S10] round=9 local utility u=0.387751 metrics={'f1_val': 0.5202520971541762, 'auprc': 0.863717084510683, 'loss_val': 0.7139466543078309, 'psi': 0.6576380920967789}-{'f1_val': 0.41670208314018853, 'auprc': 0.8585656356741698, 'loss_val': 0.8526948814566142, 'psi': 0.593447504153781}
[S11] START round=9 head_norm_before_train=1.468482 (no previous merge yet)
[S11] round=9 local utility u=0.317430 metrics={'f1_val': 0.4937110986191816, 'auprc': 0.998179353445817, 'loss_val': 0.5964693376767037, 'psi': 0.6954984005498358}-{'f1_val': 0.3981373814467868, 'auprc': 0.9983807714341141, 'loss_val': 0.6584920359760406, 'psi': 0.6382347374417178}
[S13] START round=9 head_norm_before_train=1.386924 (no previous merge yet)
[S13] round=9 local utility u=0.000000 metrics={'f1_val': 0.33750322109523884, 'auprc': 0.6215245963524179, 'loss_val': 0.9262749274190606, 'psi': 0.45111177119811047}-{'f1_val': 0.47497970409005946, 'auprc': 0.7344025931367244, 'loss_val': 0.7952699249318573, 'psi': 0.5787488597087254}
[S14] START round=9 head_norm_before_train=0.782633 cos_to_last_merge=1.0000 (last merge round=8)
[S14] round=9 local utility u=0.000000 metrics={'f1_val': 0.396715089482083, 'auprc': 0.9898993545913601, 'loss_val': 0.8480231418802898, 'psi': 0.6339887955257939}-{'f1_val': 0.5186828316418963, 'auprc': 0.9890033348447683, 'loss_val': 0.8399209073716039, 'psi': 0.7068110329230451}
[S15] START round=9 head_norm_before_train=1.114511 cos_to_last_merge=0.9313 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.931
[S15] round=9 local utility u=0.000000 metrics={'f1_val': 0.6490114643182106, 'auprc': 0.7793127270123155, 'loss_val': 0.702744213055505, 'psi': 0.7011319693958525}-{'f1_val': 0.7145283320411205, 'auprc': 0.7996655836819065, 'loss_val': 0.8045944402315022, 'psi': 0.748583232697435}
[S16] START round=9 head_norm_before_train=1.106467 cos_to_last_merge=0.9282 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.928
[S16] round=9 local utility u=0.000000 metrics={'f1_val': 0.4032466124031213, 'auprc': 0.7417194391140269, 'loss_val': 0.7921316025894181, 'psi': 0.5386357430874835}-{'f1_val': 0.41700358386742975, 'auprc': 0.7470114644656857, 'loss_val': 0.8005107747127416, 'psi': 0.5490067361067321}
[S17] START round=9 head_norm_before_train=1.412629 (no previous merge yet)
[S17] round=9 local utility u=0.022312 metrics={'f1_val': 0.3521394294854705, 'auprc': 0.8989994649529374, 'loss_val': 0.880330934810158, 'psi': 0.5708834436724572}-{'f1_val': 0.3530289445322021, 'auprc': 0.8927280131832545, 'loss_val': 0.9114785321399566, 'psi': 0.568908571992623}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] → sending delta(kind=head bytes=1793) to S13@127.0.0.1:54513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S2@127.0.0.1:54502
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:54508
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:54503
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:54505
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:54507
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:54508
[S6] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1793 to 1 peers)
[S7] sending update (kind=head size=1793 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1800) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=0.951113)
[S5] loaded HEAD from S10 (vec_in norm=0.951113)
[S5] cosine check vs S10: cos=-0.0867
[S5] DROPPED delta from S10 (cos=-0.0867 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1793) from S7
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.082122)
[S13] loaded HEAD from S7 (vec_in norm=1.082122)
[S13] cosine check vs S7: cos=-0.0467
[S13] DROPPED delta from S7 (cos=-0.0467 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1801) from S2
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.431283)
[S6] loaded HEAD from S2 (vec_in norm=1.431283)
[S6] cosine check vs S2: cos=0.9735
[S6] BUFFERED delta from S2 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1801) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.196252)
[S7] loaded HEAD from S6 (vec_in norm=1.196252)
[S7] cosine check vs S6: cos=-0.0708
[S7] DROPPED delta from S6 (cos=-0.0708 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1793) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.502600)
[S2] loaded HEAD from S11 (vec_in norm=1.502600)
[S2] cosine check vs S11: cos=0.9883
[S2] BUFFERED delta from S11 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1799) from S9
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.465506)
[S7] loaded HEAD from S9 (vec_in norm=1.465506)
[S7] cosine check vs S9: cos=-0.0278
[S7] DROPPED delta from S9 (cos=-0.0278 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1798) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.034258)
[S3] loaded HEAD from S5 (vec_in norm=1.034258)
[S3] cosine check vs S5: cos=-0.0934
[S3] DROPPED delta from S5 (cos=-0.0934 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:54509
[S17] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.448413)
[S8] loaded HEAD from S17 (vec_in norm=1.448413)
[S8] cosine check vs S17: cos=0.9638
[S8] BUFFERED delta from S17 (total buffered=1)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=9 metric=0.3731 head_norm=1.260789
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.045475e-01
[S8] stored merged vector for next round verification (round=9)
[S8] DEBUG after merge:  round=9 metric=0.3731 head_norm=1.342351 delta_norm=0.204547
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=9 metric=0.6981 head_norm=1.431283
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.175527e-01
[S2] stored merged vector for next round verification (round=9)
[S2] DEBUG after merge:  round=9 metric=0.7122 head_norm=1.462659 delta_norm=0.117553
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=9 metric=0.6294 head_norm=1.196252
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.909800e-01
[S6] stored merged vector for next round verification (round=9)
[S6] DEBUG after merge:  round=9 metric=0.6517 head_norm=1.305113 delta_norm=0.190980
[S6] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.462659 cos_to_last_merge=1.0000 (last merge round=9)
[S2] round=10 local utility u=0.131188 metrics={'f1_val': 0.7120783521638077, 'auprc': 0.7841558867014, 'loss_val': 0.5982702160889799, 'psi': 0.7409093659788446}-{'f1_val': 0.6980811998137325, 'auprc': 0.7780853533722238, 'loss_val': 0.7584509437990665, 'psi': 0.7300828612371291}
[S3] START round=10 head_norm_before_train=1.639691 (no previous merge yet)
[S3] round=10 local utility u=0.029644 metrics={'f1_val': 0.700330919019862, 'auprc': 0.9955764281337732, 'loss_val': 0.26659210172560927, 'psi': 0.8184291226654266}-{'f1_val': 0.6940226410609599, 'auprc': 0.9940478469801332, 'loss_val': 0.2834449719342031, 'psi': 0.8140327234286292}
[S4] START round=10 head_norm_before_train=1.148284 cos_to_last_merge=0.8993 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.899
[S4] round=10 local utility u=0.853081 metrics={'f1_val': 0.6562285547973302, 'auprc': 0.6524532839997769, 'loss_val': 0.6432528253756169, 'psi': 0.6547184464783089}-{'f1_val': 0.38002734830391954, 'auprc': 0.6560949758683188, 'loss_val': 0.7031321784283694, 'psi': 0.4904543993296792}
[S5] START round=10 head_norm_before_train=1.034258 cos_to_last_merge=0.9668 (last merge round=7)
[S5] round=10 local utility u=0.000000 metrics={'f1_val': 0.6199063773443494, 'auprc': 0.7893754643231167, 'loss_val': 0.5570399336129308, 'psi': 0.6876940121358563}-{'f1_val': 0.7003603281361598, 'auprc': 0.8542481611184565, 'loss_val': 0.45959946472030705, 'psi': 0.7619154613290785}
[S6] START round=10 head_norm_before_train=1.305113 cos_to_last_merge=1.0000 (last merge round=9)
[S6] round=10 local utility u=0.291776 metrics={'f1_val': 0.7103652824549888, 'auprc': 0.7894955858266748, 'loss_val': 0.7029659109384812, 'psi': 0.7420174038036632}-{'f1_val': 0.6293567286159092, 'auprc': 0.7904466109055749, 'loss_val': 0.8033189201052914, 'psi': 0.6937926815317754}
[S7] START round=10 head_norm_before_train=1.082122 cos_to_last_merge=0.9957 (last merge round=8)
[S7] round=10 local utility u=0.241958 metrics={'f1_val': 0.7139737313795297, 'auprc': 0.8863379900789268, 'loss_val': 0.6675964760542673, 'psi': 0.7829194348592885}-{'f1_val': 0.6709158320735003, 'auprc': 0.8448657048248653, 'loss_val': 0.7687488871918947, 'psi': 0.7404957811740462}
[S8] START round=10 head_norm_before_train=1.342351 cos_to_last_merge=1.0000 (last merge round=9)
[S8] round=10 local utility u=1.000000 metrics={'f1_val': 0.6873486992670672, 'auprc': 0.9964907941922168, 'loss_val': 0.6874667899234571, 'psi': 0.811005537237127}-{'f1_val': 0.3731380036306732, 'auprc': 0.7941391648076028, 'loss_val': 0.8221141911845975, 'psi': 0.541538468101445}
[S9] START round=10 head_norm_before_train=1.465506 cos_to_last_merge=0.8803 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.880
[S9] round=10 local utility u=0.912785 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9984425324000676, 'loss_val': 0.12195926670400002, 'psi': 0.9973925077188843}-{'f1_val': 0.7012904835408967, 'auprc': 0.9983262543196879, 'loss_val': 0.17476805848277588, 'psi': 0.8201047918524133}
[S10] START round=10 head_norm_before_train=0.951113 cos_to_last_merge=0.9866 (last merge round=7)
[S10] round=10 local utility u=0.000000 metrics={'f1_val': 0.4363051734387483, 'auprc': 0.8650021390231156, 'loss_val': 0.6838116708664609, 'psi': 0.6077839596724952}-{'f1_val': 0.5202520971541762, 'auprc': 0.863717084510683, 'loss_val': 0.7139466543078309, 'psi': 0.6576380920967789}
[S11] START round=10 head_norm_before_train=1.502600 (no previous merge yet)
[S11] round=10 local utility u=0.539628 metrics={'f1_val': 0.6642782260902982, 'auprc': 0.9987721702666276, 'loss_val': 0.5423942941138187, 'psi': 0.79807580376083}-{'f1_val': 0.4937110986191816, 'auprc': 0.998179353445817, 'loss_val': 0.5964693376767037, 'psi': 0.6954984005498358}
[S13] START round=10 head_norm_before_train=1.421962 (no previous merge yet)
[S13] round=10 local utility u=1.000000 metrics={'f1_val': 0.6637102070603222, 'auprc': 0.8088647714359365, 'loss_val': 0.6352842044182538, 'psi': 0.7217720328105679}-{'f1_val': 0.33750322109523884, 'auprc': 0.6215245963524179, 'loss_val': 0.9262749274190606, 'psi': 0.45111177119811047}
[S14] START round=10 head_norm_before_train=0.832064 cos_to_last_merge=0.9951 (last merge round=8)
[S14] round=10 local utility u=0.453072 metrics={'f1_val': 0.5230963524662755, 'auprc': 0.993028438272464, 'loss_val': 0.7095542894567918, 'psi': 0.7110691867887509}-{'f1_val': 0.396715089482083, 'auprc': 0.9898993545913601, 'loss_val': 0.8480231418802898, 'psi': 0.6339887955257939}
[S15] START round=10 head_norm_before_train=1.165892 cos_to_last_merge=0.9169 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.917
[S15] round=10 local utility u=0.158268 metrics={'f1_val': 0.6847185544639065, 'auprc': 0.7961507886463696, 'loss_val': 0.6509645649658405, 'psi': 0.7292914481368917}-{'f1_val': 0.6490114643182106, 'auprc': 0.7793127270123155, 'loss_val': 0.702744213055505, 'psi': 0.7011319693958525}
[S16] START round=10 head_norm_before_train=1.147319 cos_to_last_merge=0.9128 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.913
[S16] round=10 local utility u=0.029285 metrics={'f1_val': 0.4052335933559376, 'auprc': 0.7416235398483594, 'loss_val': 0.7451948353246048, 'psi': 0.5397895719529063}-{'f1_val': 0.4032466124031213, 'auprc': 0.7417194391140269, 'loss_val': 0.7921316025894181, 'psi': 0.5386357430874835}
[S17] START round=10 head_norm_before_train=1.448413 (no previous merge yet)
[S17] round=10 local utility u=0.002471 metrics={'f1_val': 0.35277173603230394, 'auprc': 0.8957956691568831, 'loss_val': 0.869572038152028, 'psi': 0.5699813092821356}-{'f1_val': 0.3521394294854705, 'auprc': 0.8989994649529374, 'loss_val': 0.880330934810158, 'psi': 0.5708834436724572}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:54511
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:54513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:54507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:54514
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:54514
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:54502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] → sending delta(kind=head bytes=1792) to S14@127.0.0.1:54514
[S9] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1792 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1801) from S8
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.378015)
[S5] loaded HEAD from S8 (vec_in norm=1.378015)
[S5] cosine check vs S8: cos=0.7430
[S5] BUFFERED delta from S8 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1801) from S7
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.126198)
[S13] loaded HEAD from S7 (vec_in norm=1.126198)
[S13] cosine check vs S7: cos=-0.0443
[S13] DROPPED delta from S7 (cos=-0.0443 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1803) from S2
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.493654)
[S6] loaded HEAD from S2 (vec_in norm=1.493654)
[S6] cosine check vs S2: cos=0.9832
[S6] BUFFERED delta from S2 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1799) from S9
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.505730)
[S7] loaded HEAD from S9 (vec_in norm=1.505730)
[S7] cosine check vs S9: cos=-0.0311
[S7] DROPPED delta from S9 (cos=-0.0311 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1796) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.320855)
[S7] loaded HEAD from S6 (vec_in norm=1.320855)
[S7] cosine check vs S6: cos=-0.0605
[S7] DROPPED delta from S6 (cos=-0.0605 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1798) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.890585)
[S7] loaded HEAD from S14 (vec_in norm=0.890585)
[S7] cosine check vs S14: cos=0.7974
[S7] BUFFERED delta from S14 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1796) from S13
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.451021)
[S10] loaded HEAD from S13 (vec_in norm=1.451021)
[S10] cosine check vs S13: cos=0.7090
[S10] BUFFERED delta from S13 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1792) from S16
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.192601)
[S14] loaded HEAD from S16 (vec_in norm=1.192601)
[S14] cosine check vs S16: cos=0.0200
[S14] BUFFERED delta from S16 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1800) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.211604)
[S14] loaded HEAD from S15 (vec_in norm=1.211604)
[S14] cosine check vs S15: cos=0.0145
[S14] BUFFERED delta from S15 (total buffered=2)
[S14] RECEIVED delta(kind=head bytes=1799) from S4
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.208650)
[S14] loaded HEAD from S4 (vec_in norm=1.208650)
[S14] cosine check vs S4: cos=0.6158
[S14] BUFFERED delta from S4 (total buffered=3)
[S14] RECEIVED delta(kind=head bytes=1799) from S3
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.684998)
[S14] loaded HEAD from S3 (vec_in norm=1.684998)
[S14] cosine check vs S3: cos=-0.0569
[S14] DROPPED delta from S3 (cos=-0.0569 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1797) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.531654)
[S2] loaded HEAD from S11 (vec_in norm=1.531654)
[S2] cosine check vs S11: cos=0.9902
[S2] BUFFERED delta from S11 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:54509
[S17] sending update (kind=head size=1795 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1795) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.480286)
[S8] loaded HEAD from S17 (vec_in norm=1.480286)
[S8] cosine check vs S17: cos=0.9836
[S8] BUFFERED delta from S17 (total buffered=1)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=10 metric=0.4363 head_norm=0.999415
[S10] _apply_head_vector_avg (torch): Δ‖w‖=5.118803e-01
[S10] stored merged vector for next round verification (round=10)
[S10] DEBUG after merge:  round=10 metric=0.4363 head_norm=1.135836 delta_norm=0.511880
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.330 → S5@127.0.0.1:54505
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=10 metric=0.6199 head_norm=1.111910
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.632660e-01
[S5] stored merged vector for next round verification (round=10)
[S5] DEBUG after merge:  round=10 metric=0.6535 head_norm=1.163193 delta_norm=0.463266
[S5] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.278 → S3@127.0.0.1:54503
[S3] ⇄ pheromone p=0.269 → S14@127.0.0.1:54514
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=10 metric=0.7121 head_norm=1.493654
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.075107e-01
[S2] stored merged vector for next round verification (round=10)
[S2] DEBUG after merge:  round=10 metric=0.7121 head_norm=1.508948 delta_norm=0.107511
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.366 → S6@127.0.0.1:54507
[S15] ⇄ pheromone p=0.371 → S14@127.0.0.1:54514
[S11] ⇄ pheromone p=0.379 → S2@127.0.0.1:54502
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=10 metric=0.7104 head_norm=1.320855
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.550737e-01
[S6] stored merged vector for next round verification (round=10)
[S6] DEBUG after merge:  round=10 metric=0.7106 head_norm=1.401350 delta_norm=0.155074
[S6] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.325 → S7@127.0.0.1:54508
[S14] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=10 metric=0.5231 head_norm=0.890585
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.492381e-01
[S14] stored merged vector for next round verification (round=10)
[S14] DEBUG after merge:  round=10 metric=0.5278 head_norm=0.687690 delta_norm=0.549238
[S14] aggregate: ACCEPT kept=['S16', 'S15', 'S4'] (k=3/3) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.409 → S7@127.0.0.1:54508
[S16] ⇄ pheromone p=0.194 → S14@127.0.0.1:54514
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=10 metric=0.7140 head_norm=1.126198
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.398592e-01
[S7] stored merged vector for next round verification (round=10)
[S7] DEBUG after merge:  round=10 metric=0.6835 head_norm=0.956675 delta_norm=0.339859
[S7] aggregate: ROLLBACK (f1_val pre=0.714 post=0.684 tol_abs=0.005 tol_rel=0.0)
[S7] ⇄ pheromone p=0.365 → S13@127.0.0.1:54513
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=10 metric=0.6873 head_norm=1.378015
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.392542e-01
[S8] stored merged vector for next round verification (round=10)
[S8] DEBUG after merge:  round=10 metric=0.3728 head_norm=1.423269 delta_norm=0.139254
[S8] aggregate: ROLLBACK (f1_val pre=0.687 post=0.373 tol_abs=0.005 tol_rel=0.0)
[S8] ⇄ pheromone p=0.411 → S5@127.0.0.1:54505
[S13] ⇄ pheromone p=0.479 → S10@127.0.0.1:54511
[S9] ⇄ pheromone p=0.419 → S7@127.0.0.1:54508
[S4] ⇄ pheromone p=0.406 → S14@127.0.0.1:54514
[S17] ⇄ pheromone p=0.236 → S8@127.0.0.1:54509
[S2] START round=11 head_norm_before_train=1.508948 cos_to_last_merge=1.0000 (last merge round=10)
[S2] round=11 local utility u=0.153375 metrics={'f1_val': 0.6996780918098376, 'auprc': 0.8678425724216461, 'loss_val': 0.46817816294562475, 'psi': 0.766943884054561}-{'f1_val': 0.7120783521638077, 'auprc': 0.7841558867014, 'loss_val': 0.5982702160889799, 'psi': 0.7409093659788446}
[S3] START round=11 head_norm_before_train=1.684998 (no previous merge yet)
[S3] round=11 local utility u=0.731905 metrics={'f1_val': 0.9274679411989253, 'auprc': 0.9982457019145443, 'loss_val': 0.17361257124333654, 'psi': 0.9557790454851729}-{'f1_val': 0.700330919019862, 'auprc': 0.9955764281337732, 'loss_val': 0.26659210172560927, 'psi': 0.8184291226654266}
[S4] START round=11 head_norm_before_train=1.208650 cos_to_last_merge=0.8826 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.883
[S4] round=11 local utility u=0.073452 metrics={'f1_val': 0.6665307164878466, 'auprc': 0.6533877822998811, 'loss_val': 0.5609657075144282, 'psi': 0.6612735428126604}-{'f1_val': 0.6562285547973302, 'auprc': 0.6524532839997769, 'loss_val': 0.6432528253756169, 'psi': 0.6547184464783089}
[S5] START round=11 head_norm_before_train=1.163193 cos_to_last_merge=1.0000 (last merge round=10)
[S5] round=11 local utility u=0.458754 metrics={'f1_val': 0.7005783007857125, 'auprc': 0.8854687688897844, 'loss_val': 0.4118440728148107, 'psi': 0.7745344880273413}-{'f1_val': 0.6199063773443494, 'auprc': 0.7893754643231167, 'loss_val': 0.5570399336129308, 'psi': 0.6876940121358563}
[S6] START round=11 head_norm_before_train=1.401350 cos_to_last_merge=1.0000 (last merge round=10)
[S6] round=11 local utility u=0.025565 metrics={'f1_val': 0.7101446273820821, 'auprc': 0.7856738111849664, 'loss_val': 0.6390461565874099, 'psi': 0.7403563009032359}-{'f1_val': 0.7103652824549888, 'auprc': 0.7894955858266748, 'loss_val': 0.7029659109384812, 'psi': 0.7420174038036632}
[S7] START round=11 head_norm_before_train=0.956675 cos_to_last_merge=1.0000 (last merge round=10)
[S7] round=11 local utility u=0.000000 metrics={'f1_val': 0.7139737313795297, 'auprc': 0.8091812843783998, 'loss_val': 0.6605431293718096, 'psi': 0.7520567525790778}-{'f1_val': 0.7139737313795297, 'auprc': 0.8863379900789268, 'loss_val': 0.6675964760542673, 'psi': 0.7829194348592885}
[S8] START round=11 head_norm_before_train=1.423269 cos_to_last_merge=1.0000 (last merge round=10)
[S8] round=11 local utility u=0.126293 metrics={'f1_val': 0.7138874667974482, 'auprc': 0.9953813008402108, 'loss_val': 0.5907851112876447, 'psi': 0.8264850004145532}-{'f1_val': 0.6873486992670672, 'auprc': 0.9964907941922168, 'loss_val': 0.6874667899234571, 'psi': 0.811005537237127}
[S9] START round=11 head_norm_before_train=1.505730 cos_to_last_merge=0.8740 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.874
[S9] round=11 local utility u=0.015188 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9982306708298081, 'loss_val': 0.09341003798243092, 'psi': 0.9975540158392089}-{'f1_val': 0.9966924912647621, 'auprc': 0.9984425324000676, 'loss_val': 0.12195926670400002, 'psi': 0.9973925077188843}
[S10] START round=11 head_norm_before_train=1.135836 cos_to_last_merge=1.0000 (last merge round=10)
[S10] round=11 local utility u=0.038212 metrics={'f1_val': 0.44570358771887225, 'auprc': 0.8579895031397167, 'loss_val': 0.6427401032915667, 'psi': 0.6106179538872101}-{'f1_val': 0.4363051734387483, 'auprc': 0.8650021390231156, 'loss_val': 0.6838116708664609, 'psi': 0.6077839596724952}
[S11] START round=11 head_norm_before_train=1.531654 (no previous merge yet)
[S11] round=11 local utility u=0.000000 metrics={'f1_val': 0.632071298709104, 'auprc': 0.996205407621515, 'loss_val': 0.4944191928229066, 'psi': 0.7777249422740684}-{'f1_val': 0.6642782260902982, 'auprc': 0.9987721702666276, 'loss_val': 0.5423942941138187, 'psi': 0.79807580376083}
[S13] START round=11 head_norm_before_train=1.451021 (no previous merge yet)
[S13] round=11 local utility u=0.093062 metrics={'f1_val': 0.711145766395914, 'auprc': 0.7487281743755252, 'loss_val': 0.5533644886178867, 'psi': 0.7261787295877584}-{'f1_val': 0.6637102070603222, 'auprc': 0.8088647714359365, 'loss_val': 0.6352842044182538, 'psi': 0.7217720328105679}
[S14] START round=11 head_norm_before_train=0.687690 cos_to_last_merge=1.0000 (last merge round=10)
[S14] round=11 local utility u=0.505507 metrics={'f1_val': 0.7013372206695996, 'auprc': 0.9926428835896038, 'loss_val': 0.7668283217295474, 'psi': 0.8178594858376014}-{'f1_val': 0.5230963524662755, 'auprc': 0.993028438272464, 'loss_val': 0.7095542894567918, 'psi': 0.7110691867887509}
[S15] START round=11 head_norm_before_train=1.211604 cos_to_last_merge=0.9044 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.904
[S15] round=11 local utility u=0.000000 metrics={'f1_val': 0.59831293094819, 'auprc': 0.8102348211498179, 'loss_val': 0.6522261654187621, 'psi': 0.6830816870288412}-{'f1_val': 0.6847185544639065, 'auprc': 0.7961507886463696, 'loss_val': 0.6509645649658405, 'psi': 0.7292914481368917}
[S16] START round=11 head_norm_before_train=1.192601 cos_to_last_merge=0.8984 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.898
[S16] round=11 local utility u=0.000000 metrics={'f1_val': 0.3848037847842682, 'auprc': 0.7445971438216531, 'loss_val': 0.7360524452537973, 'psi': 0.5287211283992221}-{'f1_val': 0.4052335933559376, 'auprc': 0.7416235398483594, 'loss_val': 0.7451948353246048, 'psi': 0.5397895719529063}
[S17] START round=11 head_norm_before_train=1.480286 (no previous merge yet)
[S17] round=11 local utility u=0.004012 metrics={'f1_val': 0.3526314172644758, 'auprc': 0.9027107651796135, 'loss_val': 0.8814521031739714, 'psi': 0.5726631564305309}-{'f1_val': 0.35277173603230394, 'auprc': 0.8957956691568831, 'loss_val': 0.869572038152028, 'psi': 0.5699813092821356}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S2] → sending delta(kind=head bytes=1807) to S6@127.0.0.1:54507
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:54514
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:54503
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:54511
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] → sending delta(kind=head bytes=1792) to S5@127.0.0.1:54505
[S10] sending update (kind=head size=1792 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1807 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1798) from S13
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.476503)
[S10] loaded HEAD from S13 (vec_in norm=1.476503)
[S10] cosine check vs S13: cos=0.9332
[S10] BUFFERED delta from S13 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1799) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.215185)
[S3] loaded HEAD from S5 (vec_in norm=1.215185)
[S3] cosine check vs S5: cos=-0.0841
[S3] DROPPED delta from S5 (cos=-0.0841 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1798) from S9
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.540117)
[S7] loaded HEAD from S9 (vec_in norm=1.540117)
[S7] cosine check vs S9: cos=-0.0512
[S7] DROPPED delta from S9 (cos=-0.0512 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1802) from S3
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.721554)
[S14] loaded HEAD from S3 (vec_in norm=1.721554)
[S14] cosine check vs S3: cos=0.1436
[S14] BUFFERED delta from S3 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1800) from S4
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.267279)
[S14] loaded HEAD from S4 (vec_in norm=1.267279)
[S14] cosine check vs S4: cos=0.6388
[S14] BUFFERED delta from S4 (total buffered=2)
[S7] RECEIVED delta(kind=head bytes=1801) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.419492)
[S7] loaded HEAD from S6 (vec_in norm=1.419492)
[S7] cosine check vs S6: cos=-0.0712
[S7] DROPPED delta from S6 (cos=-0.0712 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1792) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.169759)
[S5] loaded HEAD from S10 (vec_in norm=1.169759)
[S5] cosine check vs S10: cos=-0.0689
[S5] DROPPED delta from S10 (cos=-0.0689 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1795) from S8
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.461032)
[S5] loaded HEAD from S8 (vec_in norm=1.461032)
[S5] cosine check vs S8: cos=0.9140
[S5] BUFFERED delta from S8 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1807) from S2
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.545538)
[S6] loaded HEAD from S2 (vec_in norm=1.545538)
[S6] cosine check vs S2: cos=0.9879
[S6] BUFFERED delta from S2 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1795) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.734450)
[S7] loaded HEAD from S14 (vec_in norm=0.734450)
[S7] cosine check vs S14: cos=0.7407
[S7] BUFFERED delta from S14 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:54509
[S17] sending update (kind=head size=1803 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1803) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.506949)
[S8] loaded HEAD from S17 (vec_in norm=1.506949)
[S8] cosine check vs S17: cos=0.9898
[S8] BUFFERED delta from S17 (total buffered=1)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=11 metric=0.7140 head_norm=0.994246
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.340013e-01
[S7] stored merged vector for next round verification (round=11)
[S7] DEBUG after merge:  round=11 metric=0.7140 head_norm=0.807722 delta_norm=0.334001
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=11 metric=0.7101 head_norm=1.419492
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.311612e-01
[S6] stored merged vector for next round verification (round=11)
[S6] DEBUG after merge:  round=11 metric=0.7093 head_norm=1.478046 delta_norm=0.131161
[S6] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=11 metric=0.4457 head_norm=1.169759
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.848988e-01
[S10] stored merged vector for next round verification (round=11)
[S10] DEBUG after merge:  round=11 metric=0.5347 head_norm=1.301166 delta_norm=0.284899
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=11 metric=0.7013 head_norm=0.734450
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.754269e-01
[S14] stored merged vector for next round verification (round=11)
[S14] DEBUG after merge:  round=11 metric=0.6917 head_norm=0.783626 delta_norm=0.475427
[S14] aggregate: ROLLBACK (f1_val pre=0.701 post=0.692 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=11 metric=0.7006 head_norm=1.215185
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.024041e-01
[S5] stored merged vector for next round verification (round=11)
[S5] DEBUG after merge:  round=11 metric=0.7003 head_norm=1.309273 delta_norm=0.302404
[S5] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=11 metric=0.7139 head_norm=1.461032
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.082778e-01
[S8] stored merged vector for next round verification (round=11)
[S8] DEBUG after merge:  round=11 metric=0.3726 head_norm=1.480213 delta_norm=0.108278
[S8] aggregate: ROLLBACK (f1_val pre=0.714 post=0.373 tol_abs=0.005 tol_rel=0.0)
[S2] START round=12 head_norm_before_train=1.545538 cos_to_last_merge=0.9987 (last merge round=10)
[S2] round=12 local utility u=0.242728 metrics={'f1_val': 0.6996906525731519, 'auprc': 0.9948695603182394, 'loss_val': 0.3638786713017957, 'psi': 0.8177622156711869}-{'f1_val': 0.6996780918098376, 'auprc': 0.8678425724216461, 'loss_val': 0.46817816294562475, 'psi': 0.766943884054561}
[S3] START round=12 head_norm_before_train=1.721554 (no previous merge yet)
[S3] round=12 local utility u=0.118324 metrics={'f1_val': 0.960651231474942, 'auprc': 0.9991209075311468, 'loss_val': 0.13868955746324052, 'psi': 0.9760391018974239}-{'f1_val': 0.9274679411989253, 'auprc': 0.9982457019145443, 'loss_val': 0.17361257124333654, 'psi': 0.9557790454851729}
[S4] START round=12 head_norm_before_train=1.267279 cos_to_last_merge=0.8678 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.868
[S4] round=12 local utility u=0.033952 metrics={'f1_val': 0.6675677910413944, 'auprc': 0.6570490489960408, 'loss_val': 0.5102684842047688, 'psi': 0.6633602942232529}-{'f1_val': 0.6665307164878466, 'auprc': 0.6533877822998811, 'loss_val': 0.5609657075144282, 'psi': 0.6612735428126604}
[S5] START round=12 head_norm_before_train=1.309273 cos_to_last_merge=1.0000 (last merge round=11)
[S5] round=12 local utility u=0.151286 metrics={'f1_val': 0.7000733451188393, 'auprc': 0.986350410790161, 'loss_val': 0.40888699398742767, 'psi': 0.814584171387368}-{'f1_val': 0.7005783007857125, 'auprc': 0.8854687688897844, 'loss_val': 0.4118440728148107, 'psi': 0.7745344880273413}
[S6] START round=12 head_norm_before_train=1.478046 cos_to_last_merge=1.0000 (last merge round=11)
[S6] round=12 local utility u=0.043612 metrics={'f1_val': 0.7100102295539007, 'auprc': 0.7883190876421453, 'loss_val': 0.5589525856072015, 'psi': 0.7413337727891985}-{'f1_val': 0.7101446273820821, 'auprc': 0.7856738111849664, 'loss_val': 0.6390461565874099, 'psi': 0.7403563009032359}
[S7] START round=12 head_norm_before_train=0.807722 cos_to_last_merge=1.0000 (last merge round=11)
[S7] round=12 local utility u=0.035193 metrics={'f1_val': 0.7139737313795297, 'auprc': 0.8235639683320859, 'loss_val': 0.6333055523994127, 'psi': 0.7578098261605521}-{'f1_val': 0.7139737313795297, 'auprc': 0.8091812843783998, 'loss_val': 0.6605431293718096, 'psi': 0.7520567525790778}
[S8] START round=12 head_norm_before_train=1.480213 cos_to_last_merge=1.0000 (last merge round=11)
[S8] round=12 local utility u=0.024804 metrics={'f1_val': 0.7138874667974482, 'auprc': 0.9951226556833916, 'loss_val': 0.5404003700267, 'psi': 0.8263815423518256}-{'f1_val': 0.7138874667974482, 'auprc': 0.9953813008402108, 'loss_val': 0.5907851112876447, 'psi': 0.8264850004145532}
[S9] START round=12 head_norm_before_train=1.540117 cos_to_last_merge=0.8687 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.869
[S9] round=12 local utility u=0.000000 metrics={'f1_val': 0.9908221688527771, 'auprc': 0.998219995746754, 'loss_val': 0.0777503063490985, 'psi': 0.9937812996103679}-{'f1_val': 0.9971029125121428, 'auprc': 0.9982306708298081, 'loss_val': 0.09341003798243092, 'psi': 0.9975540158392089}
[S10] START round=12 head_norm_before_train=1.301166 cos_to_last_merge=1.0000 (last merge round=11)
[S10] round=12 local utility u=0.975434 metrics={'f1_val': 0.6886699129794044, 'auprc': 0.9708898536686822, 'loss_val': 0.4883703058140964, 'psi': 0.8015578892551155}-{'f1_val': 0.44570358771887225, 'auprc': 0.8579895031397167, 'loss_val': 0.6427401032915667, 'psi': 0.6106179538872101}
[S11] START round=12 head_norm_before_train=1.565130 (no previous merge yet)
[S11] round=12 local utility u=0.249610 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9962362751556685, 'loss_val': 0.414476854627878, 'psi': 0.8196557000412594}-{'f1_val': 0.632071298709104, 'auprc': 0.996205407621515, 'loss_val': 0.4944191928229066, 'psi': 0.7777249422740684}
[S13] START round=12 head_norm_before_train=1.476503 (no previous merge yet)
[S13] round=12 local utility u=0.000000 metrics={'f1_val': 0.5941646025365622, 'auprc': 0.7341633266047836, 'loss_val': 0.6254743598439446, 'psi': 0.6501640921638507}-{'f1_val': 0.711145766395914, 'auprc': 0.7487281743755252, 'loss_val': 0.5533644886178867, 'psi': 0.7261787295877584}
[S14] START round=12 head_norm_before_train=0.783626 cos_to_last_merge=1.0000 (last merge round=11)
[S14] round=12 local utility u=0.000000 metrics={'f1_val': 0.6936442468873442, 'auprc': 0.9919608826628388, 'loss_val': 0.8186459203414425, 'psi': 0.812970901197542}-{'f1_val': 0.7013372206695996, 'auprc': 0.9926428835896038, 'loss_val': 0.7668283217295474, 'psi': 0.8178594858376014}
[S15] START round=12 head_norm_before_train=1.261980 cos_to_last_merge=0.8921 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.892
[S15] round=12 local utility u=0.449635 metrics={'f1_val': 0.6917079800651297, 'auprc': 0.8645015415214359, 'loss_val': 0.476126545798262, 'psi': 0.7608254046476521}-{'f1_val': 0.59831293094819, 'auprc': 0.8102348211498179, 'loss_val': 0.6522261654187621, 'psi': 0.6830816870288412}
[S16] START round=12 head_norm_before_train=1.242671 cos_to_last_merge=0.8859 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.886
[S16] round=12 local utility u=0.538141 metrics={'f1_val': 0.5450709977783816, 'auprc': 0.7735370271798351, 'loss_val': 0.7081932355939701, 'psi': 0.636457409538963}-{'f1_val': 0.3848037847842682, 'auprc': 0.7445971438216531, 'loss_val': 0.7360524452537973, 'psi': 0.5287211283992221}
[S17] START round=12 head_norm_before_train=1.506949 (no previous merge yet)
[S17] round=12 local utility u=0.000000 metrics={'f1_val': 0.3441804794673821, 'auprc': 0.7843590882540098, 'loss_val': 0.9512878276653199, 'psi': 0.5202519229820332}-{'f1_val': 0.3526314172644758, 'auprc': 0.9027107651796135, 'loss_val': 0.8814521031739714, 'psi': 0.5726631564305309}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:54505
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:54513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:54507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S2@127.0.0.1:54502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:54508
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:54503
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] → sending delta(kind=head bytes=1793) to S14@127.0.0.1:54514
[S5] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1804 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1805 to 1 peers)
[S16] sending update (kind=head size=1793 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1802) from S8
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.520738)
[S5] loaded HEAD from S8 (vec_in norm=1.520738)
[S5] cosine check vs S8: cos=0.9639
[S5] BUFFERED delta from S8 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1805) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.335644)
[S5] loaded HEAD from S10 (vec_in norm=1.335644)
[S5] cosine check vs S10: cos=-0.0505
[S5] DROPPED delta from S10 (cos=-0.0505 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1803) from S2
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.584875)
[S6] loaded HEAD from S2 (vec_in norm=1.584875)
[S6] cosine check vs S2: cos=0.9929
[S6] BUFFERED delta from S2 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1803) from S7
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.856485)
[S13] loaded HEAD from S7 (vec_in norm=0.856485)
[S13] cosine check vs S7: cos=0.0042
[S13] BUFFERED delta from S7 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1795) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.497845)
[S7] loaded HEAD from S6 (vec_in norm=1.497845)
[S7] cosine check vs S6: cos=-0.0603
[S7] DROPPED delta from S6 (cos=-0.0603 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1795) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.349534)
[S3] loaded HEAD from S5 (vec_in norm=1.349534)
[S3] cosine check vs S5: cos=-0.0745
[S3] DROPPED delta from S5 (cos=-0.0745 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1793) from S16
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.287874)
[S14] loaded HEAD from S16 (vec_in norm=1.287874)
[S14] cosine check vs S16: cos=0.5135
[S14] BUFFERED delta from S16 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1799) from S4
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.320873)
[S14] loaded HEAD from S4 (vec_in norm=1.320873)
[S14] cosine check vs S4: cos=0.6836
[S14] BUFFERED delta from S4 (total buffered=2)
[S14] RECEIVED delta(kind=head bytes=1804) from S3
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.759369)
[S14] loaded HEAD from S3 (vec_in norm=1.759369)
[S14] cosine check vs S3: cos=0.5777
[S14] BUFFERED delta from S3 (total buffered=3)
[S14] RECEIVED delta(kind=head bytes=1798) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.309014)
[S14] loaded HEAD from S15 (vec_in norm=1.309014)
[S14] cosine check vs S15: cos=0.2924
[S14] BUFFERED delta from S15 (total buffered=4)
[S2] RECEIVED delta(kind=head bytes=1804) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.601764)
[S2] loaded HEAD from S11 (vec_in norm=1.601764)
[S2] cosine check vs S11: cos=0.9843
[S2] BUFFERED delta from S11 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=12 metric=0.5942 head_norm=1.497028
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.607962e-01
[S13] stored merged vector for next round verification (round=12)
[S13] DEBUG after merge:  round=12 metric=0.5976 head_norm=0.863921 delta_norm=0.860796
[S13] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=4 kept=4 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=12 metric=0.6936 head_norm=0.817663
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.191427e-01
[S14] stored merged vector for next round verification (round=12)
[S14] DEBUG after merge:  round=12 metric=0.6805 head_norm=0.821879 delta_norm=0.319143
[S14] aggregate: ROLLBACK (f1_val pre=0.694 post=0.680 tol_abs=0.005 tol_rel=0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=12 metric=0.6997 head_norm=1.584875
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.415309e-01
[S2] stored merged vector for next round verification (round=12)
[S2] DEBUG after merge:  round=12 metric=0.6997 head_norm=1.587044 delta_norm=0.141531
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=12 metric=0.7100 head_norm=1.497845
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.016612e-01
[S6] stored merged vector for next round verification (round=12)
[S6] DEBUG after merge:  round=12 metric=0.7102 head_norm=1.538619 delta_norm=0.101661
[S6] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=12 metric=0.7001 head_norm=1.349534
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.106206e-01
[S5] stored merged vector for next round verification (round=12)
[S5] DEBUG after merge:  round=12 metric=0.7001 head_norm=1.422175 delta_norm=0.210621
[S5] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.587044 cos_to_last_merge=1.0000 (last merge round=12)
[S2] round=13 local utility u=0.000000 metrics={'f1_val': 0.6999488443093624, 'auprc': 0.9746695601727834, 'loss_val': 0.3445209400351906, 'psi': 0.8098371306547307}-{'f1_val': 0.6996906525731519, 'auprc': 0.9948695603182394, 'loss_val': 0.3638786713017957, 'psi': 0.8177622156711869}
[S3] START round=13 head_norm_before_train=1.759369 (no previous merge yet)
[S3] round=13 local utility u=0.000000 metrics={'f1_val': 0.960651231474942, 'auprc': 0.9991493219709264, 'loss_val': 0.13926899978983573, 'psi': 0.9760504676733357}-{'f1_val': 0.960651231474942, 'auprc': 0.9991209075311468, 'loss_val': 0.13868955746324052, 'psi': 0.9760391018974239}
[S4] START round=13 head_norm_before_train=1.320873 cos_to_last_merge=0.8541 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.854
[S4] round=13 local utility u=0.417082 metrics={'f1_val': 0.6640315409197547, 'auprc': 0.9410211213518919, 'loss_val': 0.506803687164132, 'psi': 0.7748273730926096}-{'f1_val': 0.6675677910413944, 'auprc': 0.6570490489960408, 'loss_val': 0.5102684842047688, 'psi': 0.6633602942232529}
[S5] START round=13 head_norm_before_train=1.422175 cos_to_last_merge=1.0000 (last merge round=12)
[S5] round=13 local utility u=0.000000 metrics={'f1_val': 0.5468488821441082, 'auprc': 0.6604786594655339, 'loss_val': 0.802125114121387, 'psi': 0.5923007930726785}-{'f1_val': 0.7000733451188393, 'auprc': 0.986350410790161, 'loss_val': 0.40888699398742767, 'psi': 0.814584171387368}
[S6] START round=13 head_norm_before_train=1.538619 cos_to_last_merge=1.0000 (last merge round=12)
[S6] round=13 local utility u=0.272871 metrics={'f1_val': 0.6978129018866377, 'auprc': 0.9554387019233663, 'loss_val': 0.44138620832583325, 'psi': 0.8008632219013292}-{'f1_val': 0.7100102295539007, 'auprc': 0.7883190876421453, 'loss_val': 0.5589525856072015, 'psi': 0.7413337727891985}
[S7] START round=13 head_norm_before_train=0.856485 cos_to_last_merge=0.9973 (last merge round=11)
[S7] round=13 local utility u=0.148122 metrics={'f1_val': 0.7139737313795297, 'auprc': 0.9030076024827424, 'loss_val': 0.5753924903317917, 'psi': 0.7895872798208148}-{'f1_val': 0.7139737313795297, 'auprc': 0.8235639683320859, 'loss_val': 0.6333055523994127, 'psi': 0.7578098261605521}
[S8] START round=13 head_norm_before_train=1.520738 cos_to_last_merge=0.9986 (last merge round=11)
[S8] round=13 local utility u=0.087162 metrics={'f1_val': 0.7141738056351523, 'auprc': 0.9957503231162548, 'loss_val': 0.3696769050877705, 'psi': 0.8268044126275933}-{'f1_val': 0.7138874667974482, 'auprc': 0.9951226556833916, 'loss_val': 0.5404003700267, 'psi': 0.8263815423518256}
[S9] START round=13 head_norm_before_train=1.582101 cos_to_last_merge=0.8627 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.863
[S9] round=13 local utility u=0.009528 metrics={'f1_val': 0.9905718417662249, 'auprc': 0.998598980327968, 'loss_val': 0.058328811814558276, 'psi': 0.9937826971909223}-{'f1_val': 0.9908221688527771, 'auprc': 0.998219995746754, 'loss_val': 0.0777503063490985, 'psi': 0.9937812996103679}
[S10] START round=13 head_norm_before_train=1.335644 cos_to_last_merge=0.9974 (last merge round=11)
[S10] round=13 local utility u=0.000000 metrics={'f1_val': 0.6569780555971729, 'auprc': 0.9650330089816339, 'loss_val': 0.3992880361220366, 'psi': 0.7802000369509573}-{'f1_val': 0.6886699129794044, 'auprc': 0.9708898536686822, 'loss_val': 0.4883703058140964, 'psi': 0.8015578892551155}
[S11] START round=13 head_norm_before_train=1.601764 (no previous merge yet)
[S11] round=13 local utility u=0.038880 metrics={'f1_val': 0.7020007759458987, 'auprc': 0.9982776883458263, 'loss_val': 0.3432331805597333, 'psi': 0.8205115409058698}-{'f1_val': 0.7019353166316534, 'auprc': 0.9962362751556685, 'loss_val': 0.414476854627878, 'psi': 0.8196557000412594}
[S13] START round=13 head_norm_before_train=0.863921 cos_to_last_merge=1.0000 (last merge round=12)
[S13] round=13 local utility u=0.278493 metrics={'f1_val': 0.6731711649789833, 'auprc': 0.7866572161468242, 'loss_val': 0.7000084829388528, 'psi': 0.7185655854461197}-{'f1_val': 0.5941646025365622, 'auprc': 0.7341633266047836, 'loss_val': 0.6254743598439446, 'psi': 0.6501640921638507}
[S14] START round=13 head_norm_before_train=0.821879 cos_to_last_merge=1.0000 (last merge round=12)
[S14] round=13 local utility u=0.045763 metrics={'f1_val': 0.6984382336495012, 'auprc': 0.995702697463295, 'loss_val': 0.7671082945743035, 'psi': 0.8173440191750188}-{'f1_val': 0.6936442468873442, 'auprc': 0.9919608826628388, 'loss_val': 0.8186459203414425, 'psi': 0.812970901197542}
[S15] START round=13 head_norm_before_train=1.309014 cos_to_last_merge=0.8823 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.882
[S15] round=13 local utility u=0.000000 metrics={'f1_val': 0.6926518515715301, 'auprc': 0.7856102355437176, 'loss_val': 0.4983791314123866, 'psi': 0.7298352051604051}-{'f1_val': 0.6917079800651297, 'auprc': 0.8645015415214359, 'loss_val': 0.476126545798262, 'psi': 0.7608254046476521}
[S16] START round=13 head_norm_before_train=1.287874 cos_to_last_merge=0.8754 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.875
[S16] round=13 local utility u=0.000000 metrics={'f1_val': 0.4758804250565604, 'auprc': 0.7938012444586421, 'loss_val': 0.604238246697985, 'psi': 0.6030487528173931}-{'f1_val': 0.5450709977783816, 'auprc': 0.7735370271798351, 'loss_val': 0.7081932355939701, 'psi': 0.636457409538963}
[S17] START round=13 head_norm_before_train=1.528289 (no previous merge yet)
[S17] round=13 local utility u=0.047126 metrics={'f1_val': 0.34978177951781986, 'auprc': 0.8006332785350572, 'loss_val': 0.9394666758700367, 'psi': 0.5301223791247148}-{'f1_val': 0.3441804794673821, 'auprc': 0.7843590882540098, 'loss_val': 0.9512878276653199, 'psi': 0.5202519229820332}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S13] → sending delta(kind=head bytes=1789) to S10@127.0.0.1:54511
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:54508
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:54502
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S7] → sending delta(kind=head bytes=1791) to S13@127.0.0.1:54513
[S4] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1789 to 1 peers)
[S7] sending update (kind=head size=1791 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1795) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.849229)
[S7] loaded HEAD from S14 (vec_in norm=0.849229)
[S7] cosine check vs S14: cos=0.6105
[S7] BUFFERED delta from S14 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1799) from S8
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.561094)
[S5] loaded HEAD from S8 (vec_in norm=1.561094)
[S5] cosine check vs S8: cos=0.9831
[S5] BUFFERED delta from S8 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1791) from S7
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.907516)
[S13] loaded HEAD from S7 (vec_in norm=0.907516)
[S13] cosine check vs S7: cos=0.4742
[S13] BUFFERED delta from S7 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1800) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.559714)
[S7] loaded HEAD from S6 (vec_in norm=1.559714)
[S7] cosine check vs S6: cos=-0.0505
[S7] DROPPED delta from S6 (cos=-0.0505 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1798) from S9
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.624447)
[S7] loaded HEAD from S9 (vec_in norm=1.624447)
[S7] cosine check vs S9: cos=-0.0010
[S7] DROPPED delta from S9 (cos=-0.0010 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1795) from S4
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.369957)
[S14] loaded HEAD from S4 (vec_in norm=1.369957)
[S14] cosine check vs S4: cos=0.5339
[S14] BUFFERED delta from S4 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1802) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.641939)
[S2] loaded HEAD from S11 (vec_in norm=1.641939)
[S2] cosine check vs S11: cos=0.9913
[S2] BUFFERED delta from S11 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1789) from S13
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=0.904831)
[S10] loaded HEAD from S13 (vec_in norm=0.904831)
[S10] cosine check vs S13: cos=0.8312
[S10] BUFFERED delta from S13 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:54509
[S17] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.542824)
[S8] loaded HEAD from S17 (vec_in norm=1.542824)
[S8] cosine check vs S17: cos=0.9852
[S8] BUFFERED delta from S17 (total buffered=1)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=13 metric=0.6570 head_norm=1.380750
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.025753e-01
[S10] stored merged vector for next round verification (round=13)
[S10] DEBUG after merge:  round=13 metric=0.6606 head_norm=1.095686 delta_norm=0.402575
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=13 metric=0.5468 head_norm=1.455763
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.482216e-01
[S5] stored merged vector for next round verification (round=13)
[S5] DEBUG after merge:  round=13 metric=0.5739 head_norm=1.502052 delta_norm=0.148222
[S5] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=13 metric=0.6999 head_norm=1.622022
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.080431e-01
[S2] stored merged vector for next round verification (round=13)
[S2] DEBUG after merge:  round=13 metric=0.6999 head_norm=1.628430 delta_norm=0.108043
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=13 metric=0.7142 head_norm=1.561094
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.336983e-01
[S8] stored merged vector for next round verification (round=13)
[S8] DEBUG after merge:  round=13 metric=0.7139 head_norm=1.546216 delta_norm=0.133698
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=13 metric=0.6984 head_norm=0.849229
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.821881e-01
[S14] stored merged vector for next round verification (round=13)
[S14] DEBUG after merge:  round=13 metric=0.6870 head_norm=0.979818 delta_norm=0.582188
[S14] aggregate: ROLLBACK (f1_val pre=0.698 post=0.687 tol_abs=0.005 tol_rel=0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=13 metric=0.6732 head_norm=0.904831
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.646319e-01
[S13] stored merged vector for next round verification (round=13)
[S13] DEBUG after merge:  round=13 metric=0.5637 head_norm=0.777991 delta_norm=0.464632
[S13] aggregate: ROLLBACK (f1_val pre=0.673 post=0.564 tol_abs=0.005 tol_rel=0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=13 metric=0.7140 head_norm=0.907516
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.885083e-01
[S7] stored merged vector for next round verification (round=13)
[S7] DEBUG after merge:  round=13 metric=0.7140 head_norm=0.788321 delta_norm=0.388508
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.628430 cos_to_last_merge=1.0000 (last merge round=13)
[S2] round=14 local utility u=0.013693 metrics={'f1_val': 0.6995852512431988, 'auprc': 0.9774378159081525, 'loss_val': 0.3232582464772859, 'psi': 0.8107262771091803}-{'f1_val': 0.6999488443093624, 'auprc': 0.9746695601727834, 'loss_val': 0.3445209400351906, 'psi': 0.8098371306547307}
[S3] START round=14 head_norm_before_train=1.796491 (no previous merge yet)
[S3] round=14 local utility u=0.041705 metrics={'f1_val': 0.9749958065347903, 'auprc': 0.9996019525152339, 'loss_val': 0.1432833946110836, 'psi': 0.9848382649269677}-{'f1_val': 0.960651231474942, 'auprc': 0.9991493219709264, 'loss_val': 0.13926899978983573, 'psi': 0.9760504676733357}
[S4] START round=14 head_norm_before_train=1.369957 cos_to_last_merge=0.8422 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.842
[S4] round=14 local utility u=0.915881 metrics={'f1_val': 0.9548609489880038, 'auprc': 0.9516714852564789, 'loss_val': 0.4519699351514822, 'psi': 0.9535851634953938}-{'f1_val': 0.6640315409197547, 'auprc': 0.9410211213518919, 'loss_val': 0.506803687164132, 'psi': 0.7748273730926096}
[S5] START round=14 head_norm_before_train=1.502052 cos_to_last_merge=1.0000 (last merge round=13)
[S5] round=14 local utility u=0.764234 metrics={'f1_val': 0.6222041610860278, 'auprc': 0.9268264888314581, 'loss_val': 0.5248331455569868, 'psi': 0.7440530921841999}-{'f1_val': 0.5468488821441082, 'auprc': 0.6604786594655339, 'loss_val': 0.802125114121387, 'psi': 0.5923007930726785}
[S6] START round=14 head_norm_before_train=1.559714 cos_to_last_merge=0.9992 (last merge round=12)
[S6] round=14 local utility u=0.044470 metrics={'f1_val': 0.7018814351999625, 'auprc': 0.958125085155597, 'loss_val': 0.3849168632413253, 'psi': 0.8043788951822164}-{'f1_val': 0.6978129018866377, 'auprc': 0.9554387019233663, 'loss_val': 0.44138620832583325, 'psi': 0.8008632219013292}
[S7] START round=14 head_norm_before_train=0.788321 cos_to_last_merge=1.0000 (last merge round=13)
[S7] round=14 local utility u=0.000000 metrics={'f1_val': 0.7139737313795297, 'auprc': 0.9145978775011974, 'loss_val': 0.6743240646846151, 'psi': 0.7942233898281967}-{'f1_val': 0.7139737313795297, 'auprc': 0.9030076024827424, 'loss_val': 0.5753924903317917, 'psi': 0.7895872798208148}
[S8] START round=14 head_norm_before_train=1.546216 cos_to_last_merge=1.0000 (last merge round=13)
[S8] round=14 local utility u=0.886638 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9969494312915039, 'loss_val': 0.29307473936542283, 'psi': 0.9965916174779763}-{'f1_val': 0.7141738056351523, 'auprc': 0.9957503231162548, 'loss_val': 0.3696769050877705, 'psi': 0.8268044126275933}
[S9] START round=14 head_norm_before_train=1.624447 cos_to_last_merge=0.8564 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.856
[S9] round=14 local utility u=0.010302 metrics={'f1_val': 0.9918361843886205, 'auprc': 0.9985953530150911, 'loss_val': 0.04530020269561804, 'psi': 0.9945398518392088}-{'f1_val': 0.9905718417662249, 'auprc': 0.998598980327968, 'loss_val': 0.058328811814558276, 'psi': 0.9937826971909223}
[S10] START round=14 head_norm_before_train=1.095686 cos_to_last_merge=1.0000 (last merge round=13)
[S10] round=14 local utility u=0.000000 metrics={'f1_val': 0.6372161345820055, 'auprc': 0.9709634114162173, 'loss_val': 0.4662483392357002, 'psi': 0.7707150453156904}-{'f1_val': 0.6569780555971729, 'auprc': 0.9650330089816339, 'loss_val': 0.3992880361220366, 'psi': 0.7802000369509573}
[S11] START round=14 head_norm_before_train=1.641939 (no previous merge yet)
[S11] round=14 local utility u=0.023286 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9966258345866774, 'loss_val': 0.29131313683161075, 'psi': 0.819811523813663}-{'f1_val': 0.7020007759458987, 'auprc': 0.9982776883458263, 'loss_val': 0.3432331805597333, 'psi': 0.8205115409058698}
[S13] START round=14 head_norm_before_train=0.777991 cos_to_last_merge=1.0000 (last merge round=13)
[S13] round=14 local utility u=0.000000 metrics={'f1_val': 0.5970895753532329, 'auprc': 0.7229196810426923, 'loss_val': 0.8466393537575172, 'psi': 0.6474216176290166}-{'f1_val': 0.6731711649789833, 'auprc': 0.7866572161468242, 'loss_val': 0.7000084829388528, 'psi': 0.7185655854461197}
[S14] START round=14 head_norm_before_train=0.979818 cos_to_last_merge=1.0000 (last merge round=13)
[S14] round=14 local utility u=0.048191 metrics={'f1_val': 0.6949661900399069, 'auprc': 0.9954352184299252, 'loss_val': 0.649091530755129, 'psi': 0.8151538013959143}-{'f1_val': 0.6984382336495012, 'auprc': 0.995702697463295, 'loss_val': 0.7671082945743035, 'psi': 0.8173440191750188}
[S15] START round=14 head_norm_before_train=1.352999 cos_to_last_merge=0.8742 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.874
[S15] round=14 local utility u=0.749596 metrics={'f1_val': 0.8067490337026744, 'auprc': 0.9948084709788239, 'loss_val': 0.3113641180695373, 'psi': 0.8819728086131342}-{'f1_val': 0.6926518515715301, 'auprc': 0.7856102355437176, 'loss_val': 0.4983791314123866, 'psi': 0.7298352051604051}
[S16] START round=14 head_norm_before_train=1.324113 cos_to_last_merge=0.8668 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.867
[S16] round=14 local utility u=1.000000 metrics={'f1_val': 0.8799671881714536, 'auprc': 0.898859529539433, 'loss_val': 0.4694209424234511, 'psi': 0.8875241247186454}-{'f1_val': 0.4758804250565604, 'auprc': 0.7938012444586421, 'loss_val': 0.604238246697985, 'psi': 0.6030487528173931}
[S17] START round=14 head_norm_before_train=1.542824 (no previous merge yet)
[S17] round=14 local utility u=0.205536 metrics={'f1_val': 0.357920644801122, 'auprc': 0.9033577223859017, 'loss_val': 0.8854005717023434, 'psi': 0.576095475835034}-{'f1_val': 0.34978177951781986, 'auprc': 0.8006332785350572, 'loss_val': 0.9394666758700367, 'psi': 0.5301223791247148}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:54508
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S15] → sending delta(kind=head bytes=1806) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] → sending delta(kind=head bytes=1793) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S2] → sending delta(kind=head bytes=1807) to S6@127.0.0.1:54507
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:54503
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:54502
[S9] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1807 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1793 to 1 peers)
[S15] sending update (kind=head size=1806 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1802) from S8
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.586776)
[S5] loaded HEAD from S8 (vec_in norm=1.586776)
[S5] cosine check vs S8: cos=0.9858
[S5] BUFFERED delta from S8 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1807) from S2
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.661776)
[S6] loaded HEAD from S2 (vec_in norm=1.661776)
[S6] cosine check vs S2: cos=0.9858
[S6] BUFFERED delta from S2 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1800) from S9
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.660964)
[S7] loaded HEAD from S9 (vec_in norm=1.660964)
[S7] cosine check vs S9: cos=0.0600
[S7] BUFFERED delta from S9 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1795) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.017757)
[S7] loaded HEAD from S14 (vec_in norm=1.017757)
[S7] cosine check vs S14: cos=0.8133
[S7] BUFFERED delta from S14 (total buffered=2)
[S14] RECEIVED delta(kind=head bytes=1798) from S3
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.831871)
[S14] loaded HEAD from S3 (vec_in norm=1.831871)
[S14] cosine check vs S3: cos=0.2417
[S14] BUFFERED delta from S3 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1802) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.581234)
[S7] loaded HEAD from S6 (vec_in norm=1.581234)
[S7] cosine check vs S6: cos=-0.0310
[S7] DROPPED delta from S6 (cos=-0.0310 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1798) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.537641)
[S3] loaded HEAD from S5 (vec_in norm=1.537641)
[S3] cosine check vs S5: cos=-0.0629
[S3] DROPPED delta from S5 (cos=-0.0629 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1802) from S4
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.415586)
[S14] loaded HEAD from S4 (vec_in norm=1.415586)
[S14] cosine check vs S4: cos=0.9122
[S14] BUFFERED delta from S4 (total buffered=2)
[S14] RECEIVED delta(kind=head bytes=1806) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.393645)
[S14] loaded HEAD from S15 (vec_in norm=1.393645)
[S14] cosine check vs S15: cos=0.2721
[S14] BUFFERED delta from S15 (total buffered=3)
[S2] RECEIVED delta(kind=head bytes=1802) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.680838)
[S2] loaded HEAD from S11 (vec_in norm=1.680838)
[S2] cosine check vs S11: cos=0.9948
[S2] BUFFERED delta from S11 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1793) from S16
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.356212)
[S14] loaded HEAD from S16 (vec_in norm=1.356212)
[S14] cosine check vs S16: cos=0.3678
[S14] BUFFERED delta from S16 (total buffered=4)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:54509
[S17] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.553145)
[S8] loaded HEAD from S17 (vec_in norm=1.553145)
[S8] cosine check vs S17: cos=0.9903
[S8] BUFFERED delta from S17 (total buffered=1)
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=14 metric=0.7140 head_norm=0.835089
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.636595e-01
[S7] stored merged vector for next round verification (round=14)
[S7] DEBUG after merge:  round=14 metric=0.7140 head_norm=0.776027 delta_norm=0.463659
[S7] aggregate: ACCEPT kept=['S9', 'S14'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=4 kept=4 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=14 metric=0.6950 head_norm=1.017757
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.428368e-01
[S14] stored merged vector for next round verification (round=14)
[S14] DEBUG after merge:  round=14 metric=0.6970 head_norm=0.900815 delta_norm=0.442837
[S14] aggregate: ACCEPT kept=['S3', 'S4', 'S15', 'S16'] (k=4/4) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=14 metric=0.6996 head_norm=1.661776
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.580080e-02
[S2] stored merged vector for next round verification (round=14)
[S2] DEBUG after merge:  round=14 metric=0.6993 head_norm=1.669130 delta_norm=0.085801
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=14 metric=0.6222 head_norm=1.537641
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.339700e-01
[S5] stored merged vector for next round verification (round=14)
[S5] DEBUG after merge:  round=14 metric=0.6295 head_norm=1.556647 delta_norm=0.133970
[S5] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=14 metric=0.9964 head_norm=1.586776
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.107986e-01
[S8] stored merged vector for next round verification (round=14)
[S8] DEBUG after merge:  round=14 metric=0.9964 head_norm=1.566136 delta_norm=0.110799
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=14 metric=0.7019 head_norm=1.581234
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.423603e-01
[S6] stored merged vector for next round verification (round=14)
[S6] DEBUG after merge:  round=14 metric=0.6984 head_norm=1.615745 delta_norm=0.142360
[S6] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.669130 cos_to_last_merge=1.0000 (last merge round=14)
[S2] round=15 local utility u=0.000000 metrics={'f1_val': 0.7007705716905859, 'auprc': 0.8950297757717836, 'loss_val': 0.30613393254808413, 'psi': 0.778474253323065}-{'f1_val': 0.6995852512431988, 'auprc': 0.9774378159081525, 'loss_val': 0.3232582464772859, 'psi': 0.8107262771091803}
[S3] START round=15 head_norm_before_train=1.831871 (no previous merge yet)
[S3] round=15 local utility u=0.000000 metrics={'f1_val': 0.933322139176921, 'auprc': 0.9766629178821751, 'loss_val': 0.14805758329321705, 'psi': 0.9506584506590225}-{'f1_val': 0.9749958065347903, 'auprc': 0.9996019525152339, 'loss_val': 0.1432833946110836, 'psi': 0.9848382649269677}
[S4] START round=15 head_norm_before_train=1.415586 cos_to_last_merge=0.8324 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.832
[S4] round=15 local utility u=0.066622 metrics={'f1_val': 0.9609030384028521, 'auprc': 0.9557479671907634, 'loss_val': 0.3672080932261683, 'psi': 0.9588410099180166}-{'f1_val': 0.9548609489880038, 'auprc': 0.9516714852564789, 'loss_val': 0.4519699351514822, 'psi': 0.9535851634953938}
[S5] START round=15 head_norm_before_train=1.556647 cos_to_last_merge=1.0000 (last merge round=14)
[S5] round=15 local utility u=0.000000 metrics={'f1_val': 0.4240169636780682, 'auprc': 0.7987689366657732, 'loss_val': 1.1068484002977717, 'psi': 0.5739177528731503}-{'f1_val': 0.6222041610860278, 'auprc': 0.9268264888314581, 'loss_val': 0.5248331455569868, 'psi': 0.7440530921841999}
[S6] START round=15 head_norm_before_train=1.615745 cos_to_last_merge=1.0000 (last merge round=14)
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.6942482464758444, 'auprc': 0.9486671914950588, 'loss_val': 0.42255178671453797, 'psi': 0.7960158244835303}-{'f1_val': 0.7018814351999625, 'auprc': 0.958125085155597, 'loss_val': 0.3849168632413253, 'psi': 0.8043788951822164}
[S7] START round=15 head_norm_before_train=0.776027 cos_to_last_merge=1.0000 (last merge round=14)
[S7] round=15 local utility u=0.000000 metrics={'f1_val': 0.6798113508888207, 'auprc': 0.9330457682864598, 'loss_val': 0.6895042026179956, 'psi': 0.7811051178478763}-{'f1_val': 0.7139737313795297, 'auprc': 0.9145978775011974, 'loss_val': 0.6743240646846151, 'psi': 0.7942233898281967}
[S8] START round=15 head_norm_before_train=1.566136 cos_to_last_merge=1.0000 (last merge round=14)
[S8] round=15 local utility u=0.037357 metrics={'f1_val': 0.9951604936057619, 'auprc': 0.9988230301837835, 'loss_val': 0.2168251052186556, 'psi': 0.9966255082369705}-{'f1_val': 0.9963530749356245, 'auprc': 0.9969494312915039, 'loss_val': 0.29307473936542283, 'psi': 0.9965916174779763}
[S9] START round=15 head_norm_before_train=1.660964 cos_to_last_merge=0.8511 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.851
[S9] round=15 local utility u=0.015987 metrics={'f1_val': 0.9954400132154921, 'auprc': 0.9985910877824467, 'loss_val': 0.034936760922272304, 'psi': 0.9967004430422739}-{'f1_val': 0.9918361843886205, 'auprc': 0.9985953530150911, 'loss_val': 0.04530020269561804, 'psi': 0.9945398518392088}
[S10] START round=15 head_norm_before_train=1.134775 cos_to_last_merge=0.9979 (last merge round=13)
[S10] round=15 local utility u=0.429434 metrics={'f1_val': 0.8022793452538723, 'auprc': 0.9340654688551835, 'loss_val': 0.4870662061674046, 'psi': 0.8549937946943968}-{'f1_val': 0.6372161345820055, 'auprc': 0.9709634114162173, 'loss_val': 0.4662483392357002, 'psi': 0.7707150453156904}
[S11] START round=15 head_norm_before_train=1.680838 (no previous merge yet)
[S11] round=15 local utility u=0.008460 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9968373955086853, 'loss_val': 0.2735764266722651, 'psi': 0.819751045955629}-{'f1_val': 0.7019353166316534, 'auprc': 0.9966258345866774, 'loss_val': 0.29131313683161075, 'psi': 0.819811523813663}
[S13] START round=15 head_norm_before_train=0.819536 cos_to_last_merge=0.9940 (last merge round=13)
[S13] round=15 local utility u=0.250750 metrics={'f1_val': 0.6333027460404109, 'auprc': 0.7716174431914915, 'loss_val': 0.7085113798566977, 'psi': 0.6886286249008431}-{'f1_val': 0.5970895753532329, 'auprc': 0.7229196810426923, 'loss_val': 0.8466393537575172, 'psi': 0.6474216176290166}
[S14] START round=15 head_norm_before_train=0.900815 cos_to_last_merge=1.0000 (last merge round=14)
[S14] round=15 local utility u=0.031123 metrics={'f1_val': 0.7000599664364398, 'auprc': 0.9960038890377386, 'loss_val': 0.6191137629002171, 'psi': 0.8184375354769593}-{'f1_val': 0.6949661900399069, 'auprc': 0.9954352184299252, 'loss_val': 0.649091530755129, 'psi': 0.8151538013959143}
[S15] START round=15 head_norm_before_train=1.393645 cos_to_last_merge=0.8673 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.867
[S15] round=15 local utility u=0.000000 metrics={'f1_val': 0.694790447652467, 'auprc': 0.7947133861895557, 'loss_val': 0.44640895931919444, 'psi': 0.7347596230673025}-{'f1_val': 0.8067490337026744, 'auprc': 0.9948084709788239, 'loss_val': 0.3113641180695373, 'psi': 0.8819728086131342}
[S16] START round=15 head_norm_before_train=1.356212 cos_to_last_merge=0.8599 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.860
[S16] round=15 local utility u=0.106732 metrics={'f1_val': 0.8775033600886586, 'auprc': 0.9557122721635132, 'loss_val': 0.41173217606190754, 'psi': 0.9087869249186005}-{'f1_val': 0.8799671881714536, 'auprc': 0.898859529539433, 'loss_val': 0.4694209424234511, 'psi': 0.8875241247186454}
[S17] START round=15 head_norm_before_train=1.553145 (no previous merge yet)
[S17] round=15 local utility u=0.000000 metrics={'f1_val': 0.3600648732247417, 'auprc': 0.839177848895086, 'loss_val': 0.8479198644965599, 'psi': 0.5517100634928794}-{'f1_val': 0.357920644801122, 'auprc': 0.9033577223859017, 'loss_val': 0.8854005717023434, 'psi': 0.576095475835034}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:54514
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S10] → sending delta(kind=head bytes=1790) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:54511
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:54502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:54514
[S8] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1790 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1798) from S9
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.693958)
[S7] loaded HEAD from S9 (vec_in norm=1.693958)
[S7] cosine check vs S9: cos=0.5234
[S7] BUFFERED delta from S9 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1798) from S4
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.453183)
[S14] loaded HEAD from S4 (vec_in norm=1.453183)
[S14] cosine check vs S4: cos=0.6973
[S14] BUFFERED delta from S4 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1795) from S16
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.390696)
[S14] loaded HEAD from S16 (vec_in norm=1.390696)
[S14] cosine check vs S16: cos=0.6688
[S14] BUFFERED delta from S16 (total buffered=2)
[S5] RECEIVED delta(kind=head bytes=1790) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.172958)
[S5] loaded HEAD from S10 (vec_in norm=1.172958)
[S5] cosine check vs S10: cos=-0.0216
[S5] DROPPED delta from S10 (cos=-0.0216 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1800) from S8
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.602512)
[S5] loaded HEAD from S8 (vec_in norm=1.602512)
[S5] cosine check vs S8: cos=0.9897
[S5] BUFFERED delta from S8 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1802) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.937631)
[S7] loaded HEAD from S14 (vec_in norm=0.937631)
[S7] cosine check vs S14: cos=0.7949
[S7] BUFFERED delta from S14 (total buffered=2)
[S2] RECEIVED delta(kind=head bytes=1802) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.711490)
[S2] loaded HEAD from S11 (vec_in norm=1.711490)
[S2] cosine check vs S11: cos=0.9966
[S2] BUFFERED delta from S11 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1801) from S13
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=0.881873)
[S10] loaded HEAD from S13 (vec_in norm=0.881873)
[S10] cosine check vs S13: cos=0.7086
[S10] BUFFERED delta from S13 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] ⇄ pheromone p=0.167 → S14@127.0.0.1:54514
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=15 metric=0.7008 head_norm=1.700861
[S2] _apply_head_vector_avg (torch): Δ‖w‖=7.036921e-02
[S2] stored merged vector for next round verification (round=15)
[S2] DEBUG after merge:  round=15 metric=0.7008 head_norm=1.704732 delta_norm=0.070369
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.159 → S6@127.0.0.1:54507
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=15 metric=0.4240 head_norm=1.583986
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.149167e-01
[S5] stored merged vector for next round verification (round=15)
[S5] DEBUG after merge:  round=15 metric=0.4249 head_norm=1.589126 delta_norm=0.114917
[S5] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.266 → S3@127.0.0.1:54503
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=15 metric=0.6798 head_norm=0.822252
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.867528e-01
[S7] stored merged vector for next round verification (round=15)
[S7] DEBUG after merge:  round=15 metric=0.6792 head_norm=0.867864 delta_norm=0.286753
[S7] aggregate: ACCEPT kept=['S9', 'S14'] (k=2/2) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.142 → S13@127.0.0.1:54513
[S6] ⇄ pheromone p=0.155 → S7@127.0.0.1:54508
[S15] ⇄ pheromone p=0.287 → S14@127.0.0.1:54514
[S11] ⇄ pheromone p=0.160 → S2@127.0.0.1:54502
[S13] ⇄ pheromone p=0.250 → S10@127.0.0.1:54511
[S16] ⇄ pheromone p=0.300 → S14@127.0.0.1:54514
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=15 metric=0.7001 head_norm=0.937631
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.992964e-01
[S14] stored merged vector for next round verification (round=15)
[S14] DEBUG after merge:  round=15 metric=0.7004 head_norm=0.975086 delta_norm=0.199296
[S14] aggregate: ACCEPT kept=['S4', 'S16'] (k=2/2) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.195 → S7@127.0.0.1:54508
[S9] ⇄ pheromone p=0.145 → S7@127.0.0.1:54508
[S8] ⇄ pheromone p=0.308 → S5@127.0.0.1:54505
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=15 metric=0.8023 head_norm=1.172958
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.146113e-01
[S10] stored merged vector for next round verification (round=15)
[S10] DEBUG after merge:  round=15 metric=0.8014 head_norm=0.951243 delta_norm=0.414611
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.297 → S5@127.0.0.1:54505
[S4] ⇄ pheromone p=0.356 → S14@127.0.0.1:54514
[S17] ⇄ pheromone p=0.117 → S8@127.0.0.1:54509
[S2] START round=16 head_norm_before_train=1.704732 cos_to_last_merge=1.0000 (last merge round=15)
[S2] round=16 local utility u=0.000000 metrics={'f1_val': 0.7007729058908991, 'auprc': 0.8560352092293684, 'loss_val': 0.30902237266187627, 'psi': 0.7628778272262868}-{'f1_val': 0.7007705716905859, 'auprc': 0.8950297757717836, 'loss_val': 0.30613393254808413, 'psi': 0.778474253323065}
[S3] START round=16 head_norm_before_train=1.867628 (no previous merge yet)
[S3] round=16 local utility u=0.252215 metrics={'f1_val': 0.9905305295275408, 'auprc': 0.9992270763491763, 'loss_val': 0.05457001301962106, 'psi': 0.994009148256195}-{'f1_val': 0.933322139176921, 'auprc': 0.9766629178821751, 'loss_val': 0.14805758329321705, 'psi': 0.9506584506590225}
[S4] START round=16 head_norm_before_train=1.453183 cos_to_last_merge=0.8250 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.825
[S4] round=16 local utility u=0.000000 metrics={'f1_val': 0.9489020226370205, 'auprc': 0.9571551848677375, 'loss_val': 0.39894680174463487, 'psi': 0.9522032875293073}-{'f1_val': 0.9609030384028521, 'auprc': 0.9557479671907634, 'loss_val': 0.3672080932261683, 'psi': 0.9588410099180166}
[S5] START round=16 head_norm_before_train=1.589126 cos_to_last_merge=1.0000 (last merge round=15)
[S5] round=16 local utility u=1.000000 metrics={'f1_val': 0.6979590182746016, 'auprc': 0.7126185618808611, 'loss_val': 0.47384145847467657, 'psi': 0.7038228357171055}-{'f1_val': 0.4240169636780682, 'auprc': 0.7987689366657732, 'loss_val': 1.1068484002977717, 'psi': 0.5739177528731503}
[S6] START round=16 head_norm_before_train=1.633965 cos_to_last_merge=0.9996 (last merge round=14)
[S6] round=16 local utility u=0.066364 metrics={'f1_val': 0.7004728128744349, 'auprc': 0.9415496664668789, 'loss_val': 0.3058187084709732, 'psi': 0.7969035543114125}-{'f1_val': 0.6942482464758444, 'auprc': 0.9486671914950588, 'loss_val': 0.42255178671453797, 'psi': 0.7960158244835303}
[S7] START round=16 head_norm_before_train=0.867864 cos_to_last_merge=1.0000 (last merge round=15)
[S7] round=16 local utility u=0.142915 metrics={'f1_val': 0.7137736617503405, 'auprc': 0.9529097085896455, 'loss_val': 0.6670403728176217, 'psi': 0.8094280804860625}-{'f1_val': 0.6798113508888207, 'auprc': 0.9330457682864598, 'loss_val': 0.6895042026179956, 'psi': 0.7811051178478763}
[S8] START round=16 head_norm_before_train=1.602512 cos_to_last_merge=0.9989 (last merge round=14)
[S8] round=16 local utility u=0.025114 metrics={'f1_val': 0.9942782421240355, 'auprc': 0.9987831848622937, 'loss_val': 0.1611833920614599, 'psi': 0.9960802192193388}-{'f1_val': 0.9951604936057619, 'auprc': 0.9988230301837835, 'loss_val': 0.2168251052186556, 'psi': 0.9966255082369705}
[S9] START round=16 head_norm_before_train=1.693958 cos_to_last_merge=0.8465 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.847
[S9] round=16 local utility u=0.004148 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9964328467001822, 'loss_val': 0.030144009399474696, 'psi': 0.9968348861873586}-{'f1_val': 0.9954400132154921, 'auprc': 0.9985910877824467, 'loss_val': 0.034936760922272304, 'psi': 0.9967004430422739}
[S10] START round=16 head_norm_before_train=0.951243 cos_to_last_merge=1.0000 (last merge round=15)
[S10] round=16 local utility u=0.136828 metrics={'f1_val': 0.8427571524128228, 'auprc': 0.967123594091476, 'loss_val': 0.5554506137238666, 'psi': 0.8925037290842841}-{'f1_val': 0.8022793452538723, 'auprc': 0.9340654688551835, 'loss_val': 0.4870662061674046, 'psi': 0.8549937946943968}
[S11] START round=16 head_norm_before_train=1.711490 (no previous merge yet)
[S11] round=16 local utility u=0.005932 metrics={'f1_val': 0.7021770286274283, 'auprc': 0.9966582955143952, 'loss_val': 0.26407672642010466, 'psi': 0.8199695353822151}-{'f1_val': 0.7016934795869249, 'auprc': 0.9968373955086853, 'loss_val': 0.2735764266722651, 'psi': 0.819751045955629}
[S13] START round=16 head_norm_before_train=0.881873 cos_to_last_merge=0.9760 (last merge round=13)
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.6253896199279887, 'auprc': 0.7599843399756205, 'loss_val': 0.6449851147987957, 'psi': 0.6792275079470415}-{'f1_val': 0.6333027460404109, 'auprc': 0.7716174431914915, 'loss_val': 0.7085113798566977, 'psi': 0.6886286249008431}
[S14] START round=16 head_norm_before_train=0.975086 cos_to_last_merge=1.0000 (last merge round=15)
[S14] round=16 local utility u=0.016425 metrics={'f1_val': 0.6962749117455933, 'auprc': 0.9956722052715139, 'loss_val': 0.5625574684001119, 'psi': 0.8160338291559615}-{'f1_val': 0.7000599664364398, 'auprc': 0.9960038890377386, 'loss_val': 0.6191137629002171, 'psi': 0.8184375354769593}
[S15] START round=16 head_norm_before_train=1.429264 cos_to_last_merge=0.8616 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.862
[S15] round=16 local utility u=0.897861 metrics={'f1_val': 0.8954830596988586, 'auprc': 0.931854637878881, 'loss_val': 0.26626668404260984, 'psi': 0.9100316909708676}-{'f1_val': 0.694790447652467, 'auprc': 0.7947133861895557, 'loss_val': 0.44640895931919444, 'psi': 0.7347596230673025}
[S16] START round=16 head_norm_before_train=1.390696 cos_to_last_merge=0.8532 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.853
[S16] round=16 local utility u=0.177018 metrics={'f1_val': 0.9071431445069164, 'auprc': 0.9903743721583858, 'loss_val': 0.339520517686393, 'psi': 0.9404356355675041}-{'f1_val': 0.8775033600886586, 'auprc': 0.9557122721635132, 'loss_val': 0.41173217606190754, 'psi': 0.9087869249186005}
[S17] START round=16 head_norm_before_train=1.568529 (no previous merge yet)
[S17] round=16 local utility u=0.000000 metrics={'f1_val': 0.3690045101677396, 'auprc': 0.8025227819947728, 'loss_val': 0.8178936423421674, 'psi': 0.5424118188985528}-{'f1_val': 0.3600648732247417, 'auprc': 0.839177848895086, 'loss_val': 0.8479198644965599, 'psi': 0.5517100634928794}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:54514
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:54508
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S11] → sending delta(kind=head bytes=1806) to S2@127.0.0.1:54502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S10] → sending delta(kind=head bytes=1790) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:54503
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:54513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:54508
[S5] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1790 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1806 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1798) from S7
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.910394)
[S13] loaded HEAD from S7 (vec_in norm=0.910394)
[S13] cosine check vs S7: cos=0.4598
[S13] BUFFERED delta from S7 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1790) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=0.981572)
[S5] loaded HEAD from S10 (vec_in norm=0.981572)
[S5] cosine check vs S10: cos=0.0113
[S5] BUFFERED delta from S10 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1800) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.607447)
[S3] loaded HEAD from S5 (vec_in norm=1.607447)
[S3] cosine check vs S5: cos=-0.0493
[S3] DROPPED delta from S5 (cos=-0.0493 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1795) from S8
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.638522)
[S5] loaded HEAD from S8 (vec_in norm=1.638522)
[S5] cosine check vs S8: cos=0.9948
[S5] BUFFERED delta from S8 (total buffered=2)
[S7] RECEIVED delta(kind=head bytes=1800) from S9
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.726550)
[S7] loaded HEAD from S9 (vec_in norm=1.726550)
[S7] cosine check vs S9: cos=0.7156
[S7] BUFFERED delta from S9 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1797) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.013822)
[S7] loaded HEAD from S14 (vec_in norm=1.013822)
[S7] cosine check vs S14: cos=0.6279
[S7] BUFFERED delta from S14 (total buffered=2)
[S7] RECEIVED delta(kind=head bytes=1798) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.650375)
[S7] loaded HEAD from S6 (vec_in norm=1.650375)
[S7] cosine check vs S6: cos=-0.0066
[S7] DROPPED delta from S6 (cos=-0.0066 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1796) from S3
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.899098)
[S14] loaded HEAD from S3 (vec_in norm=1.899098)
[S14] cosine check vs S3: cos=0.3801
[S14] BUFFERED delta from S3 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1806) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.735942)
[S2] loaded HEAD from S11 (vec_in norm=1.735942)
[S2] cosine check vs S11: cos=0.9976
[S2] BUFFERED delta from S11 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1800) from S16
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.428179)
[S14] loaded HEAD from S16 (vec_in norm=1.428179)
[S14] cosine check vs S16: cos=0.6907
[S14] BUFFERED delta from S16 (total buffered=2)
[S14] RECEIVED delta(kind=head bytes=1796) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.457792)
[S14] loaded HEAD from S15 (vec_in norm=1.457792)
[S14] cosine check vs S15: cos=0.4112
[S14] BUFFERED delta from S15 (total buffered=3)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=16 metric=0.7008 head_norm=1.733283
[S2] _apply_head_vector_avg (torch): Δ‖w‖=6.001249e-02
[S2] stored merged vector for next round verification (round=16)
[S2] DEBUG after merge:  round=16 metric=0.7008 head_norm=1.733575 delta_norm=0.060012
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=16 metric=0.6980 head_norm=1.607447
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.643432e-01
[S5] stored merged vector for next round verification (round=16)
[S5] DEBUG after merge:  round=16 metric=0.7003 head_norm=1.238774 delta_norm=0.464343
[S5] aggregate: ACCEPT kept=['S10', 'S8'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=16 metric=0.7138 head_norm=0.910394
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.743408e-01
[S7] stored merged vector for next round verification (round=16)
[S7] DEBUG after merge:  round=16 metric=0.7140 head_norm=0.939451 delta_norm=0.174341
[S7] aggregate: ACCEPT kept=['S9', 'S14'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=16 metric=0.6963 head_norm=1.013822
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.502214e-01
[S14] stored merged vector for next round verification (round=16)
[S14] DEBUG after merge:  round=16 metric=0.6749 head_norm=1.028412 delta_norm=0.450221
[S14] aggregate: ROLLBACK (f1_val pre=0.696 post=0.675 tol_abs=0.005 tol_rel=0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=16 metric=0.6254 head_norm=0.948283
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.832520e-01
[S13] stored merged vector for next round verification (round=16)
[S13] DEBUG after merge:  round=16 metric=0.6205 head_norm=0.794038 delta_norm=0.483252
[S13] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.733575 cos_to_last_merge=1.0000 (last merge round=16)
[S2] round=17 local utility u=0.153003 metrics={'f1_val': 0.7000493224451865, 'auprc': 0.9514991411603548, 'loss_val': 0.28506621740171095, 'psi': 0.8006292499312538}-{'f1_val': 0.7007729058908991, 'auprc': 0.8560352092293684, 'loss_val': 0.30902237266187627, 'psi': 0.7628778272262868}
[S3] START round=17 head_norm_before_train=1.899098 (no previous merge yet)
[S3] round=17 local utility u=0.000000 metrics={'f1_val': 0.9605709740356257, 'auprc': 0.9984854380892274, 'loss_val': 0.10818540498107884, 'psi': 0.9757367596570664}-{'f1_val': 0.9905305295275408, 'auprc': 0.9992270763491763, 'loss_val': 0.05457001301962106, 'psi': 0.994009148256195}
[S4] START round=17 head_norm_before_train=1.481201 cos_to_last_merge=0.8197 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.820
[S4] round=17 local utility u=0.068785 metrics={'f1_val': 0.9529671597319523, 'auprc': 0.967632511528719, 'loss_val': 0.3171986359312649, 'psi': 0.958833300450659}-{'f1_val': 0.9489020226370205, 'auprc': 0.9571551848677375, 'loss_val': 0.39894680174463487, 'psi': 0.9522032875293073}
[S5] START round=17 head_norm_before_train=1.238774 cos_to_last_merge=1.0000 (last merge round=16)
[S5] round=17 local utility u=0.000000 metrics={'f1_val': 0.6994291315030916, 'auprc': 0.659948407553526, 'loss_val': 0.5378014897215477, 'psi': 0.6836368419232653}-{'f1_val': 0.6979590182746016, 'auprc': 0.7126185618808611, 'loss_val': 0.47384145847467657, 'psi': 0.7038228357171055}
[S6] START round=17 head_norm_before_train=1.650375 cos_to_last_merge=0.9988 (last merge round=14)
[S6] round=17 local utility u=0.000000 metrics={'f1_val': 0.6464903815930987, 'auprc': 0.8064316967545772, 'loss_val': 0.4426804223299433, 'psi': 0.71046690765769}-{'f1_val': 0.7004728128744349, 'auprc': 0.9415496664668789, 'loss_val': 0.3058187084709732, 'psi': 0.7969035543114125}
[S7] START round=17 head_norm_before_train=0.939451 cos_to_last_merge=1.0000 (last merge round=16)
[S7] round=17 local utility u=0.007370 metrics={'f1_val': 0.6879393067693418, 'auprc': 0.9927849657768858, 'loss_val': 0.6169193053816157, 'psi': 0.8098775703723594}-{'f1_val': 0.7137736617503405, 'auprc': 0.9529097085896455, 'loss_val': 0.6670403728176217, 'psi': 0.8094280804860625}
[S8] START round=17 head_norm_before_train=1.638522 cos_to_last_merge=0.9966 (last merge round=14)
[S8] round=17 local utility u=0.000000 metrics={'f1_val': 0.9680728404534411, 'auprc': 0.997939176321545, 'loss_val': 0.17059024013780677, 'psi': 0.9800193748006827}-{'f1_val': 0.9942782421240355, 'auprc': 0.9987831848622937, 'loss_val': 0.1611833920614599, 'psi': 0.9960802192193388}
[S9] START round=17 head_norm_before_train=1.726550 cos_to_last_merge=0.8425 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.842
[S9] round=17 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9937866062342628, 'loss_val': 0.029516964083218446, 'psi': 0.9955301372525625}-{'f1_val': 0.9971029125121428, 'auprc': 0.9964328467001822, 'loss_val': 0.030144009399474696, 'psi': 0.9968348861873586}
[S10] START round=17 head_norm_before_train=0.981572 cos_to_last_merge=0.9984 (last merge round=15)
[S10] round=17 local utility u=0.129592 metrics={'f1_val': 0.8671239128436451, 'auprc': 0.9812186354111297, 'loss_val': 0.4847516244683438, 'psi': 0.9127618018706389}-{'f1_val': 0.8427571524128228, 'auprc': 0.967123594091476, 'loss_val': 0.5554506137238666, 'psi': 0.8925037290842841}
[S11] START round=17 head_norm_before_train=1.735942 (no previous merge yet)
[S11] round=17 local utility u=0.020365 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9981163067290422, 'loss_val': 0.2262713396702883, 'psi': 0.8204077126706089}-{'f1_val': 0.7021770286274283, 'auprc': 0.9966582955143952, 'loss_val': 0.26407672642010466, 'psi': 0.8199695353822151}
[S13] START round=17 head_norm_before_train=0.794038 cos_to_last_merge=1.0000 (last merge round=16)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.6270021345309474, 'auprc': 0.7693273691324991, 'loss_val': 0.7126581982114696, 'psi': 0.6839322283715681}-{'f1_val': 0.6253896199279887, 'auprc': 0.7599843399756205, 'loss_val': 0.6449851147987957, 'psi': 0.6792275079470415}
[S14] START round=17 head_norm_before_train=1.028412 cos_to_last_merge=1.0000 (last merge round=16)
[S14] round=17 local utility u=0.000000 metrics={'f1_val': 0.6983735727381094, 'auprc': 0.9954482415585914, 'loss_val': 0.5821148791449118, 'psi': 0.8172034402663022}-{'f1_val': 0.6962749117455933, 'auprc': 0.9956722052715139, 'loss_val': 0.5625574684001119, 'psi': 0.8160338291559615}
[S15] START round=17 head_norm_before_train=1.457792 cos_to_last_merge=0.8572 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.857
[S15] round=17 local utility u=0.146223 metrics={'f1_val': 0.9028479911020499, 'auprc': 0.9950818551551217, 'loss_val': 0.20769118697043987, 'psi': 0.9397415367232786}-{'f1_val': 0.8954830596988586, 'auprc': 0.931854637878881, 'loss_val': 0.26626668404260984, 'psi': 0.9100316909708676}
[S16] START round=17 head_norm_before_train=1.428179 cos_to_last_merge=0.8466 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.847
[S16] round=17 local utility u=0.000000 metrics={'f1_val': 0.841791025746827, 'auprc': 0.9942190846730427, 'loss_val': 0.570617204562012, 'psi': 0.9027622493173133}-{'f1_val': 0.9071431445069164, 'auprc': 0.9903743721583858, 'loss_val': 0.339520517686393, 'psi': 0.9404356355675041}
[S17] START round=17 head_norm_before_train=1.579890 (no previous merge yet)
[S17] round=17 local utility u=0.265739 metrics={'f1_val': 0.4415175718115768, 'auprc': 0.8285654831398186, 'loss_val': 0.7996224582993144, 'psi': 0.5963367363428735}-{'f1_val': 0.3690045101677396, 'auprc': 0.8025227819947728, 'loss_val': 0.8178936423421674, 'psi': 0.5424118188985528}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:54514
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:54507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:54514
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:54502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:54505
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:54513
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1794 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1805 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1802) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.761307)
[S2] loaded HEAD from S11 (vec_in norm=1.761307)
[S2] cosine check vs S11: cos=0.9983
[S2] BUFFERED delta from S11 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1799) from S7
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.989654)
[S13] loaded HEAD from S7 (vec_in norm=0.989654)
[S13] cosine check vs S7: cos=0.7807
[S13] BUFFERED delta from S7 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1794) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.010066)
[S5] loaded HEAD from S10 (vec_in norm=1.010066)
[S5] cosine check vs S10: cos=0.2017
[S5] BUFFERED delta from S10 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1802) from S4
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.505704)
[S14] loaded HEAD from S4 (vec_in norm=1.505704)
[S14] cosine check vs S4: cos=0.4205
[S14] BUFFERED delta from S4 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1799) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.490555)
[S14] loaded HEAD from S15 (vec_in norm=1.490555)
[S14] cosine check vs S15: cos=0.5395
[S14] BUFFERED delta from S15 (total buffered=2)
[S6] RECEIVED delta(kind=head bytes=1805) from S2
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.759423)
[S6] loaded HEAD from S2 (vec_in norm=1.759423)
[S6] cosine check vs S2: cos=0.9838
[S6] BUFFERED delta from S2 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:54509
[S17] sending update (kind=head size=1804 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1804) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.592412)
[S8] loaded HEAD from S17 (vec_in norm=1.592412)
[S8] cosine check vs S17: cos=0.9823
[S8] BUFFERED delta from S17 (total buffered=1)
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=17 metric=0.6984 head_norm=1.056688
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.604991e-01
[S14] stored merged vector for next round verification (round=17)
[S14] DEBUG after merge:  round=17 metric=0.6986 head_norm=0.985607 delta_norm=0.460499
[S14] aggregate: ACCEPT kept=['S4', 'S15'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=17 metric=0.6465 head_norm=1.663370
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.612429e-01
[S6] stored merged vector for next round verification (round=17)
[S6] DEBUG after merge:  round=17 metric=0.6985 head_norm=1.704461 delta_norm=0.161243
[S6] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=17 metric=0.9681 head_norm=1.674943
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.591117e-01
[S8] stored merged vector for next round verification (round=17)
[S8] DEBUG after merge:  round=17 metric=0.7860 head_norm=1.626434 delta_norm=0.159112
[S8] aggregate: ROLLBACK (f1_val pre=0.968 post=0.786 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=17 metric=0.6994 head_norm=1.270723
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.275448e-01
[S5] stored merged vector for next round verification (round=17)
[S5] DEBUG after merge:  round=17 metric=0.7001 head_norm=0.887785 delta_norm=0.727545
[S5] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=17 metric=0.6270 head_norm=0.852855
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.118396e-01
[S13] stored merged vector for next round verification (round=17)
[S13] DEBUG after merge:  round=17 metric=0.6256 head_norm=0.869566 delta_norm=0.311840
[S13] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=17 metric=0.7000 head_norm=1.759423
[S2] _apply_head_vector_avg (torch): Δ‖w‖=5.130831e-02
[S2] stored merged vector for next round verification (round=17)
[S2] DEBUG after merge:  round=17 metric=0.7000 head_norm=1.759617 delta_norm=0.051308
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.759617 cos_to_last_merge=1.0000 (last merge round=17)
[S2] round=18 local utility u=0.000000 metrics={'f1_val': 0.7005925029290768, 'auprc': 0.7577850806154108, 'loss_val': 0.3147756772814532, 'psi': 0.7234695340036104}-{'f1_val': 0.7000493224451865, 'auprc': 0.9514991411603548, 'loss_val': 0.28506621740171095, 'psi': 0.8006292499312538}
[S3] START round=18 head_norm_before_train=1.929288 (no previous merge yet)
[S3] round=18 local utility u=0.143591 metrics={'f1_val': 0.9978389274664787, 'auprc': 0.9992351951788607, 'loss_val': 0.04685950429453003, 'psi': 0.9983974345514316}-{'f1_val': 0.9605709740356257, 'auprc': 0.9984854380892274, 'loss_val': 0.10818540498107884, 'psi': 0.9757367596570664}
[S4] START round=18 head_norm_before_train=1.505704 cos_to_last_merge=0.8158 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.816
[S4] round=18 local utility u=0.005501 metrics={'f1_val': 0.9524156739371837, 'auprc': 0.9638041286837538, 'loss_val': 0.2914028451675377, 'psi': 0.9569710558358118}-{'f1_val': 0.9529671597319523, 'auprc': 0.967632511528719, 'loss_val': 0.3171986359312649, 'psi': 0.958833300450659}
[S5] START round=18 head_norm_before_train=0.887785 cos_to_last_merge=1.0000 (last merge round=17)
[S5] round=18 local utility u=0.519017 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9896896718078795, 'loss_val': 0.4943437924603257, 'psi': 0.8160686591835}-{'f1_val': 0.6994291315030916, 'auprc': 0.659948407553526, 'loss_val': 0.5378014897215477, 'psi': 0.6836368419232653}
[S6] START round=18 head_norm_before_train=1.704461 cos_to_last_merge=1.0000 (last merge round=17)
[S6] round=18 local utility u=1.000000 metrics={'f1_val': 0.9622006489726324, 'auprc': 0.9623948721855609, 'loss_val': 0.2863456472460819, 'psi': 0.9622783382578037}-{'f1_val': 0.6464903815930987, 'auprc': 0.8064316967545772, 'loss_val': 0.4426804223299433, 'psi': 0.71046690765769}
[S7] START round=18 head_norm_before_train=0.989654 cos_to_last_merge=0.9920 (last merge round=16)
[S7] round=18 local utility u=0.092359 metrics={'f1_val': 0.6927009012214954, 'auprc': 0.9934619452673293, 'loss_val': 0.46280270056816813, 'psi': 0.813005318839829}-{'f1_val': 0.6879393067693418, 'auprc': 0.9927849657768858, 'loss_val': 0.6169193053816157, 'psi': 0.8098775703723594}
[S8] START round=18 head_norm_before_train=1.626434 cos_to_last_merge=1.0000 (last merge round=17)
[S8] round=18 local utility u=0.087909 metrics={'f1_val': 0.9929024225986427, 'auprc': 0.9976843648133553, 'loss_val': 0.14298558141700585, 'psi': 0.9948151994845278}-{'f1_val': 0.9680728404534411, 'auprc': 0.997939176321545, 'loss_val': 0.17059024013780677, 'psi': 0.9800193748006827}
[S9] START round=18 head_norm_before_train=1.754455 cos_to_last_merge=0.8393 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.839
[S9] round=18 local utility u=0.000000 metrics={'f1_val': 0.9854657388091037, 'auprc': 0.9885229850268584, 'loss_val': 0.07253217461296062, 'psi': 0.9866886372962056}-{'f1_val': 0.9966924912647621, 'auprc': 0.9937866062342628, 'loss_val': 0.029516964083218446, 'psi': 0.9955301372525625}
[S10] START round=18 head_norm_before_train=1.010066 cos_to_last_merge=0.9950 (last merge round=15)
[S10] round=18 local utility u=0.075978 metrics={'f1_val': 0.8807396109405248, 'auprc': 0.9887442763248252, 'loss_val': 0.43706657761805084, 'psi': 0.9239414770942449}-{'f1_val': 0.8671239128436451, 'auprc': 0.9812186354111297, 'loss_val': 0.4847516244683438, 'psi': 0.9127618018706389}
[S11] START round=18 head_norm_before_train=1.761307 (no previous merge yet)
[S11] round=18 local utility u=0.755933 metrics={'f1_val': 0.953493205769675, 'auprc': 0.9983062751982902, 'loss_val': 0.22432253392320117, 'psi': 0.971418433541121}-{'f1_val': 0.7019353166316534, 'auprc': 0.9981163067290422, 'loss_val': 0.2262713396702883, 'psi': 0.8204077126706089}
[S13] START round=18 head_norm_before_train=0.869566 cos_to_last_merge=1.0000 (last merge round=17)
[S13] round=18 local utility u=0.000000 metrics={'f1_val': 0.6324580006335194, 'auprc': 0.7585073334545666, 'loss_val': 0.7265955613200724, 'psi': 0.6828777337619383}-{'f1_val': 0.6270021345309474, 'auprc': 0.7693273691324991, 'loss_val': 0.7126581982114696, 'psi': 0.6839322283715681}
[S14] START round=18 head_norm_before_train=0.985607 cos_to_last_merge=1.0000 (last merge round=17)
[S14] round=18 local utility u=0.008018 metrics={'f1_val': 0.6916262547416147, 'auprc': 0.9978534865406582, 'loss_val': 0.532810521099655, 'psi': 0.8141171474612321}-{'f1_val': 0.6983735727381094, 'auprc': 0.9954482415585914, 'loss_val': 0.5821148791449118, 'psi': 0.8172034402663022}
[S15] START round=18 head_norm_before_train=1.490555 cos_to_last_merge=0.8523 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.852
[S15] round=18 local utility u=0.000000 metrics={'f1_val': 0.6958388645259485, 'auprc': 0.8515135000815652, 'loss_val': 0.4095726414648154, 'psi': 0.7581087187481952}-{'f1_val': 0.9028479911020499, 'auprc': 0.9950818551551217, 'loss_val': 0.20769118697043987, 'psi': 0.9397415367232786}
[S16] START round=18 head_norm_before_train=1.467696 cos_to_last_merge=0.8399 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.840
[S16] round=18 local utility u=0.260198 metrics={'f1_val': 0.8934876592144492, 'auprc': 0.9956446154079792, 'loss_val': 0.36467782031070395, 'psi': 0.9343504416918612}-{'f1_val': 0.841791025746827, 'auprc': 0.9942190846730427, 'loss_val': 0.570617204562012, 'psi': 0.9027622493173133}
[S17] START round=18 head_norm_before_train=1.592412 (no previous merge yet)
[S17] round=18 local utility u=0.000000 metrics={'f1_val': 0.3768223736023524, 'auprc': 0.8584688128042642, 'loss_val': 0.7099575326552187, 'psi': 0.5694809492831172}-{'f1_val': 0.4415175718115768, 'auprc': 0.8285654831398186, 'loss_val': 0.7996224582993144, 'psi': 0.5963367363428735}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:54505
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] → sending delta(kind=head bytes=1805) to S7@127.0.0.1:54508
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:54503
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:54513
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:54502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:54508
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:54505
[S14] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1793 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1805 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1793) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.038495)
[S5] loaded HEAD from S10 (vec_in norm=1.038495)
[S5] cosine check vs S10: cos=0.6754
[S5] BUFFERED delta from S10 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1799) from S8
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.656555)
[S5] loaded HEAD from S8 (vec_in norm=1.656555)
[S5] cosine check vs S8: cos=0.7088
[S5] BUFFERED delta from S8 (total buffered=2)
[S13] RECEIVED delta(kind=head bytes=1802) from S7
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.040689)
[S13] loaded HEAD from S7 (vec_in norm=1.040689)
[S13] cosine check vs S7: cos=0.9246
[S13] BUFFERED delta from S7 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1795) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.016396)
[S7] loaded HEAD from S14 (vec_in norm=1.016396)
[S7] cosine check vs S14: cos=0.6758
[S7] BUFFERED delta from S14 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1805) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.717019)
[S7] loaded HEAD from S6 (vec_in norm=1.717019)
[S7] cosine check vs S6: cos=0.0124
[S7] BUFFERED delta from S6 (total buffered=2)
[S3] RECEIVED delta(kind=head bytes=1801) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.936221)
[S3] loaded HEAD from S5 (vec_in norm=0.936221)
[S3] cosine check vs S5: cos=-0.0440
[S3] DROPPED delta from S5 (cos=-0.0440 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1801) from S4
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.531050)
[S14] loaded HEAD from S4 (vec_in norm=1.531050)
[S14] cosine check vs S4: cos=0.6542
[S14] BUFFERED delta from S4 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1795) from S3
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.955132)
[S14] loaded HEAD from S3 (vec_in norm=1.955132)
[S14] cosine check vs S3: cos=0.3286
[S14] BUFFERED delta from S3 (total buffered=2)
[S14] RECEIVED delta(kind=head bytes=1798) from S16
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.506100)
[S14] loaded HEAD from S16 (vec_in norm=1.506100)
[S14] cosine check vs S16: cos=0.6537
[S14] BUFFERED delta from S16 (total buffered=3)
[S2] RECEIVED delta(kind=head bytes=1803) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.787927)
[S2] loaded HEAD from S11 (vec_in norm=1.787927)
[S2] cosine check vs S11: cos=0.9987
[S2] BUFFERED delta from S11 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=18 metric=0.6325 head_norm=0.922104
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.992342e-01
[S13] stored merged vector for next round verification (round=18)
[S13] DEBUG after merge:  round=18 metric=0.6335 head_norm=0.962788 delta_norm=0.199234
[S13] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=18 metric=0.7006 head_norm=1.781214
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.591659e-02
[S2] stored merged vector for next round verification (round=18)
[S2] DEBUG after merge:  round=18 metric=0.7006 head_norm=1.783983 delta_norm=0.045917
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=18 metric=0.6916 head_norm=1.016396
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.977893e-01
[S14] stored merged vector for next round verification (round=18)
[S14] DEBUG after merge:  round=18 metric=0.6788 head_norm=1.033044 delta_norm=0.397789
[S14] aggregate: ROLLBACK (f1_val pre=0.692 post=0.679 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=18 metric=0.7003 head_norm=0.936221
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.416157e-01
[S5] stored merged vector for next round verification (round=18)
[S5] DEBUG after merge:  round=18 metric=0.7003 head_norm=0.947624 delta_norm=0.141616
[S5] aggregate: ACCEPT kept=['S10', 'S8'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=18 metric=0.6927 head_norm=1.040689
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.855049e-01
[S7] stored merged vector for next round verification (round=18)
[S7] DEBUG after merge:  round=18 metric=0.6753 head_norm=0.843413 delta_norm=0.585505
[S7] aggregate: ROLLBACK (f1_val pre=0.693 post=0.675 tol_abs=0.005 tol_rel=0.0)
[S2] START round=19 head_norm_before_train=1.783983 cos_to_last_merge=1.0000 (last merge round=18)
[S2] round=19 local utility u=0.094519 metrics={'f1_val': 0.7058610972216446, 'auprc': 0.8110688760681861, 'loss_val': 0.3172014344928382, 'psi': 0.7479442087602612}-{'f1_val': 0.7005925029290768, 'auprc': 0.7577850806154108, 'loss_val': 0.3147756772814532, 'psi': 0.7234695340036104}
[S3] START round=19 head_norm_before_train=1.955132 (no previous merge yet)
[S3] round=19 local utility u=0.003917 metrics={'f1_val': 0.9973956967430226, 'auprc': 0.9992377938926873, 'loss_val': 0.036374682669683626, 'psi': 0.9981325356028885}-{'f1_val': 0.9978389274664787, 'auprc': 0.9992351951788607, 'loss_val': 0.04685950429453003, 'psi': 0.9983974345514316}
[S4] START round=19 head_norm_before_train=1.531050 cos_to_last_merge=0.8120 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.812
[S4] round=19 local utility u=0.012952 metrics={'f1_val': 0.9526197260317761, 'auprc': 0.9665779571976101, 'loss_val': 0.275044664677533, 'psi': 0.9582030184981097}-{'f1_val': 0.9524156739371837, 'auprc': 0.9638041286837538, 'loss_val': 0.2914028451675377, 'psi': 0.9569710558358118}
[S5] START round=19 head_norm_before_train=0.947624 cos_to_last_merge=1.0000 (last merge round=18)
[S5] round=19 local utility u=0.028318 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.989534619859781, 'loss_val': 0.4372420137520047, 'psi': 0.8160066384042606}-{'f1_val': 0.7003213174339138, 'auprc': 0.9896896718078795, 'loss_val': 0.4943437924603257, 'psi': 0.8160686591835}
[S6] START round=19 head_norm_before_train=1.717019 cos_to_last_merge=0.9999 (last merge round=17)
[S6] round=19 local utility u=0.000000 metrics={'f1_val': 0.9253449020895868, 'auprc': 0.9543551053154892, 'loss_val': 0.32051298317030225, 'psi': 0.9369489833799477}-{'f1_val': 0.9622006489726324, 'auprc': 0.9623948721855609, 'loss_val': 0.2863456472460819, 'psi': 0.9622783382578037}
[S7] START round=19 head_norm_before_train=0.843413 cos_to_last_merge=1.0000 (last merge round=18)
[S7] round=19 local utility u=0.000000 metrics={'f1_val': 0.6530148813699355, 'auprc': 0.9059360070662915, 'loss_val': 0.6034384551118963, 'psi': 0.7541833316484778}-{'f1_val': 0.6927009012214954, 'auprc': 0.9934619452673293, 'loss_val': 0.46280270056816813, 'psi': 0.813005318839829}
[S8] START round=19 head_norm_before_train=1.656555 cos_to_last_merge=0.9996 (last merge round=17)
[S8] round=19 local utility u=0.000000 metrics={'f1_val': 0.9864258722700556, 'auprc': 0.9985199908732894, 'loss_val': 0.12918293920459514, 'psi': 0.9912635197113492}-{'f1_val': 0.9929024225986427, 'auprc': 0.9976843648133553, 'loss_val': 0.14298558141700585, 'psi': 0.9948151994845278}
[S9] START round=19 head_norm_before_train=1.777172 cos_to_last_merge=0.8370 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.837
[S9] round=19 local utility u=0.049623 metrics={'f1_val': 0.9905718417662249, 'auprc': 0.9987354432144658, 'loss_val': 0.03456013242310831, 'psi': 0.9938372823455213}-{'f1_val': 0.9854657388091037, 'auprc': 0.9885229850268584, 'loss_val': 0.07253217461296062, 'psi': 0.9866886372962056}
[S10] START round=19 head_norm_before_train=1.038495 cos_to_last_merge=0.9907 (last merge round=15)
[S10] round=19 local utility u=0.007270 metrics={'f1_val': 0.8783293527059999, 'auprc': 0.9893968927282429, 'loss_val': 0.410022361360298, 'psi': 0.9227563687148972}-{'f1_val': 0.8807396109405248, 'auprc': 0.9887442763248252, 'loss_val': 0.43706657761805084, 'psi': 0.9239414770942449}
[S11] START round=19 head_norm_before_train=1.787927 (no previous merge yet)
[S11] round=19 local utility u=0.038003 metrics={'f1_val': 0.9582699758185035, 'auprc': 0.9982554201322087, 'loss_val': 0.17682374120234332, 'psi': 0.9742641535439855}-{'f1_val': 0.953493205769675, 'auprc': 0.9983062751982902, 'loss_val': 0.22432253392320117, 'psi': 0.971418433541121}
[S13] START round=19 head_norm_before_train=0.962788 cos_to_last_merge=1.0000 (last merge round=18)
[S13] round=19 local utility u=0.000000 metrics={'f1_val': 0.6211427437910845, 'auprc': 0.7439137445581856, 'loss_val': 0.7576276609191541, 'psi': 0.6702511440979249}-{'f1_val': 0.6324580006335194, 'auprc': 0.7585073334545666, 'loss_val': 0.7265955613200724, 'psi': 0.6828777337619383}
[S14] START round=19 head_norm_before_train=1.033044 cos_to_last_merge=1.0000 (last merge round=18)
[S14] round=19 local utility u=0.790800 metrics={'f1_val': 0.9494824180460818, 'auprc': 0.9953658215774112, 'loss_val': 0.4908848799255134, 'psi': 0.9678357794586137}-{'f1_val': 0.6916262547416147, 'auprc': 0.9978534865406582, 'loss_val': 0.532810521099655, 'psi': 0.8141171474612321}
[S15] START round=19 head_norm_before_train=1.526168 cos_to_last_merge=0.8473 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.847
[S15] round=19 local utility u=0.482398 metrics={'f1_val': 0.8030920800707921, 'auprc': 0.9240656048698579, 'loss_val': 0.3059523960455972, 'psi': 0.8514814899904184}-{'f1_val': 0.6958388645259485, 'auprc': 0.8515135000815652, 'loss_val': 0.4095726414648154, 'psi': 0.7581087187481952}
[S16] START round=19 head_norm_before_train=1.506100 cos_to_last_merge=0.8345 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.834
[S16] round=19 local utility u=0.115472 metrics={'f1_val': 0.9203098391282222, 'auprc': 0.995652050798004, 'loss_val': 0.29468962203724114, 'psi': 0.9504467237961349}-{'f1_val': 0.8934876592144492, 'auprc': 0.9956446154079792, 'loss_val': 0.36467782031070395, 'psi': 0.9343504416918612}
[S17] START round=19 head_norm_before_train=1.605785 (no previous merge yet)
[S17] round=19 local utility u=0.242435 metrics={'f1_val': 0.38975027286830743, 'auprc': 0.9645940559304377, 'loss_val': 0.621031492013327, 'psi': 0.6196877860931596}-{'f1_val': 0.3768223736023524, 'auprc': 0.8584688128042642, 'loss_val': 0.7099575326552187, 'psi': 0.5694809492831172}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:54514
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] → sending delta(kind=head bytes=1805) to S3@127.0.0.1:54503
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:54507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:54502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:54514
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S14] → sending delta(kind=head bytes=1791) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S10] → sending delta(kind=head bytes=1789) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:54508
[S9] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1791 to 1 peers)
[S10] sending update (kind=head size=1789 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1805 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1803) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.817673)
[S2] loaded HEAD from S11 (vec_in norm=1.817673)
[S2] cosine check vs S11: cos=0.9989
[S2] BUFFERED delta from S11 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1797) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.558453)
[S14] loaded HEAD from S15 (vec_in norm=1.558453)
[S14] cosine check vs S15: cos=0.5261
[S14] BUFFERED delta from S15 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1799) from S4
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.556172)
[S14] loaded HEAD from S4 (vec_in norm=1.556172)
[S14] cosine check vs S4: cos=0.5181
[S14] BUFFERED delta from S4 (total buffered=2)
[S5] RECEIVED delta(kind=head bytes=1789) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.066995)
[S5] loaded HEAD from S10 (vec_in norm=1.066995)
[S5] cosine check vs S10: cos=0.5802
[S5] BUFFERED delta from S10 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1802) from S2
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.803711)
[S6] loaded HEAD from S2 (vec_in norm=1.803711)
[S6] cosine check vs S2: cos=0.9913
[S6] BUFFERED delta from S2 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1802) from S9
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.793131)
[S7] loaded HEAD from S9 (vec_in norm=1.793131)
[S7] cosine check vs S9: cos=0.4612
[S7] BUFFERED delta from S9 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1791) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.061588)
[S7] loaded HEAD from S14 (vec_in norm=1.061588)
[S7] cosine check vs S14: cos=0.6732
[S7] BUFFERED delta from S14 (total buffered=2)
[S3] RECEIVED delta(kind=head bytes=1805) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.993976)
[S3] loaded HEAD from S5 (vec_in norm=0.993976)
[S3] cosine check vs S5: cos=-0.0464
[S3] DROPPED delta from S5 (cos=-0.0464 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1798) from S3
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.984257)
[S14] loaded HEAD from S3 (vec_in norm=1.984257)
[S14] cosine check vs S3: cos=0.5843
[S14] BUFFERED delta from S3 (total buffered=3)
[S14] RECEIVED delta(kind=head bytes=1798) from S16
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.541523)
[S14] loaded HEAD from S16 (vec_in norm=1.541523)
[S14] cosine check vs S16: cos=0.8185
[S14] BUFFERED delta from S16 (total buffered=4)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:54509
[S17] sending update (kind=head size=1798 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.620881)
[S8] loaded HEAD from S17 (vec_in norm=1.620881)
[S8] cosine check vs S17: cos=0.9876
[S8] BUFFERED delta from S17 (total buffered=1)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=19 metric=0.9864 head_norm=1.687965
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.342690e-01
[S8] stored merged vector for next round verification (round=19)
[S8] DEBUG after merge:  round=19 metric=0.9896 head_norm=1.649307 delta_norm=0.134269
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] r=20 psi=0.991 u=0.0000 p_local=0.1428 f1=0.986 auprc=0.999 bytes=23348
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=19 metric=0.9253 head_norm=1.731450
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.218124e-01
[S6] stored merged vector for next round verification (round=19)
[S6] DEBUG after merge:  round=19 metric=0.8845 head_norm=1.763748 delta_norm=0.121812
[S6] aggregate: ROLLBACK (f1_val pre=0.925 post=0.884 tol_abs=0.005 tol_rel=0.0)
[S6] r=20 psi=0.937 u=0.0000 p_local=0.2303 f1=0.925 auprc=0.954 bytes=25168
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=19 metric=0.7059 head_norm=1.803711
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.357589e-02
[S2] stored merged vector for next round verification (round=19)
[S2] DEBUG after merge:  round=19 metric=0.7059 head_norm=1.810181 delta_norm=0.043576
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] r=20 psi=0.748 u=0.0945 p_local=0.1038 f1=0.706 auprc=0.811 bytes=21597
[S10] r=20 psi=0.923 u=0.0073 p_local=0.1659 f1=0.878 auprc=0.989 bytes=23323
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=19 metric=0.7003 head_norm=0.993976
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.732381e-01
[S5] stored merged vector for next round verification (round=19)
[S5] DEBUG after merge:  round=19 metric=0.7003 head_norm=0.916121 delta_norm=0.473238
[S5] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S5] r=20 psi=0.816 u=0.0283 p_local=0.3002 f1=0.700 auprc=0.990 bytes=21589
[S11] r=20 psi=0.974 u=0.0380 p_local=0.1974 f1=0.958 auprc=0.998 bytes=28780
[S4] r=20 psi=0.958 u=0.0130 p_local=0.1580 f1=0.953 auprc=0.967 bytes=23372
[S9] r=20 psi=0.994 u=0.0496 p_local=0.0696 f1=0.991 auprc=0.999 bytes=21576
[S13] r=20 psi=0.670 u=0.0000 p_local=0.1026 f1=0.621 auprc=0.744 bytes=14368
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=19 metric=0.6530 head_norm=0.894386
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.793456e-01
[S7] stored merged vector for next round verification (round=19)
[S7] DEBUG after merge:  round=19 metric=0.6655 head_norm=0.912885 delta_norm=0.379346
[S7] aggregate: ACCEPT kept=['S9', 'S14'] (k=2/2) mode=median trim_p=0.1
[S7] r=20 psi=0.754 u=0.0000 p_local=0.0886 f1=0.653 auprc=0.906 bytes=23360
[S14] aggregate: batch=4 kept=4 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=19 metric=0.9495 head_norm=1.061588
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.548147e-01
[S14] stored merged vector for next round verification (round=19)
[S14] DEBUG after merge:  round=19 metric=0.9395 head_norm=1.065126 delta_norm=0.154815
[S14] aggregate: ROLLBACK (f1_val pre=0.949 post=0.939 tol_abs=0.005 tol_rel=0.0)
[S14] r=20 psi=0.968 u=0.7908 p_local=0.2411 f1=0.949 auprc=0.995 bytes=23356
[S16] r=20 psi=0.950 u=0.1155 p_local=0.2057 f1=0.920 auprc=0.996 bytes=21522
[S15] r=20 psi=0.851 u=0.4824 p_local=0.3249 f1=0.803 auprc=0.924 bytes=21582
[S17] r=20 psi=0.620 u=0.2424 p_local=0.1303 f1=0.390 auprc=0.965 bytes=19776
[S3] r=20 psi=0.998 u=0.0039 p_local=0.1179 f1=0.997 auprc=0.999 bytes=21589
[S2] START round=20 head_norm_before_train=1.810181 cos_to_last_merge=1.0000 (last merge round=19)
[S2] round=20 local utility u=0.231136 metrics={'f1_val': 0.7002250022305567, 'auprc': 0.9630313410278698, 'loss_val': 0.2770008241946053, 'psi': 0.805347537749482}-{'f1_val': 0.7058610972216446, 'auprc': 0.8110688760681861, 'loss_val': 0.3172014344928382, 'psi': 0.7479442087602612}
[S3] START round=20 head_norm_before_train=1.984257 (no previous merge yet)
[S3] round=20 local utility u=0.000000 metrics={'f1_val': 0.8910166638021851, 'auprc': 0.9996023453986198, 'loss_val': 0.16317750947741597, 'psi': 0.9344509364407589}-{'f1_val': 0.9973956967430226, 'auprc': 0.9992377938926873, 'loss_val': 0.036374682669683626, 'psi': 0.9981325356028885}
[S4] START round=20 head_norm_before_train=1.556172 cos_to_last_merge=0.8086 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.809
[S4] round=20 local utility u=0.000000 metrics={'f1_val': 0.9477417054147573, 'auprc': 0.9399755340952456, 'loss_val': 0.27992396819185894, 'psi': 0.9446352368869526}-{'f1_val': 0.9526197260317761, 'auprc': 0.9665779571976101, 'loss_val': 0.275044664677533, 'psi': 0.9582030184981097}
[S5] START round=20 head_norm_before_train=0.916121 cos_to_last_merge=1.0000 (last merge round=19)
[S5] round=20 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.8790559122646329, 'loss_val': 0.6017515663506127, 'psi': 0.7718147240006685}-{'f1_val': 0.7003213174339138, 'auprc': 0.989534619859781, 'loss_val': 0.4372420137520047, 'psi': 0.8160066384042606}
[S6] START round=20 head_norm_before_train=1.763748 cos_to_last_merge=1.0000 (last merge round=19)
[S6] round=20 local utility u=0.000000 metrics={'f1_val': 0.8009722927113787, 'auprc': 0.9530064448204878, 'loss_val': 0.31646019903138567, 'psi': 0.8617859535550223}-{'f1_val': 0.9253449020895868, 'auprc': 0.9543551053154892, 'loss_val': 0.32051298317030225, 'psi': 0.9369489833799477}
[S7] START round=20 head_norm_before_train=0.912885 cos_to_last_merge=1.0000 (last merge round=19)
[S7] round=20 local utility u=0.282951 metrics={'f1_val': 0.6850391814309388, 'auprc': 0.9880937164637721, 'loss_val': 0.4761557699460835, 'psi': 0.806260995444072}-{'f1_val': 0.6530148813699355, 'auprc': 0.9059360070662915, 'loss_val': 0.6034384551118963, 'psi': 0.7541833316484778}
[S8] START round=20 head_norm_before_train=1.649307 cos_to_last_merge=1.0000 (last merge round=19)
[S8] round=20 local utility u=0.000000 metrics={'f1_val': 0.9931489740885844, 'auprc': 0.9837576171130666, 'loss_val': 0.13454839711919328, 'psi': 0.9893924312983773}-{'f1_val': 0.9864258722700556, 'auprc': 0.9985199908732894, 'loss_val': 0.12918293920459514, 'psi': 0.9912635197113492}
[S9] START round=20 head_norm_before_train=1.793131 cos_to_last_merge=0.8354 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.835
[S9] round=20 local utility u=0.015524 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9938628333585993, 'loss_val': 0.025618677717687898, 'psi': 0.9955606281022971}-{'f1_val': 0.9905718417662249, 'auprc': 0.9987354432144658, 'loss_val': 0.03456013242310831, 'psi': 0.9938372823455213}
[S10] START round=20 head_norm_before_train=1.066995 cos_to_last_merge=0.9857 (last merge round=15)
[S10] round=20 local utility u=0.000000 metrics={'f1_val': 0.8497319503142542, 'auprc': 0.9769973822842494, 'loss_val': 0.42060493532136334, 'psi': 0.9006381231022522}-{'f1_val': 0.8783293527059999, 'auprc': 0.9893968927282429, 'loss_val': 0.410022361360298, 'psi': 0.9227563687148972}
[S11] START round=20 head_norm_before_train=1.817673 (no previous merge yet)
[S11] round=20 local utility u=0.117638 metrics={'f1_val': 0.9973550136825626, 'auprc': 0.9981310484253934, 'loss_val': 0.1756843027228915, 'psi': 0.997665427579695}-{'f1_val': 0.9582699758185035, 'auprc': 0.9982554201322087, 'loss_val': 0.17682374120234332, 'psi': 0.9742641535439855}
[S13] START round=20 head_norm_before_train=1.010133 cos_to_last_merge=0.9946 (last merge round=18)
[S13] round=20 local utility u=0.098594 metrics={'f1_val': 0.6485119937423371, 'auprc': 0.7133044157015986, 'loss_val': 0.6328274597939971, 'psi': 0.6744289625260418}-{'f1_val': 0.6211427437910845, 'auprc': 0.7439137445581856, 'loss_val': 0.7576276609191541, 'psi': 0.6702511440979249}
[S14] START round=20 head_norm_before_train=1.065126 cos_to_last_merge=1.0000 (last merge round=19)
[S14] round=20 local utility u=0.140195 metrics={'f1_val': 0.9922634811590824, 'auprc': 0.9955832644617184, 'loss_val': 0.46783378111330903, 'psi': 0.9935913944801368}-{'f1_val': 0.9494824180460818, 'auprc': 0.9953658215774112, 'loss_val': 0.4908848799255134, 'psi': 0.9678357794586137}
[S15] START round=20 head_norm_before_train=1.558453 cos_to_last_merge=0.8429 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.843
[S15] round=20 local utility u=0.000000 metrics={'f1_val': 0.7919817181424701, 'auprc': 0.9118860800237601, 'loss_val': 0.3071136637161073, 'psi': 0.8399434628949861}-{'f1_val': 0.8030920800707921, 'auprc': 0.9240656048698579, 'loss_val': 0.3059523960455972, 'psi': 0.8514814899904184}
[S16] START round=20 head_norm_before_train=1.541523 cos_to_last_merge=0.8295 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.830
[S16] round=20 local utility u=0.119561 metrics={'f1_val': 0.940533806735162, 'auprc': 0.9942122800048494, 'loss_val': 0.17259226754023693, 'psi': 0.9620051960430369}-{'f1_val': 0.9203098391282222, 'auprc': 0.995652050798004, 'loss_val': 0.29468962203724114, 'psi': 0.9504467237961349}
[S17] START round=20 head_norm_before_train=1.620881 (no previous merge yet)
[S17] round=20 local utility u=0.019006 metrics={'f1_val': 0.41952341881779043, 'auprc': 0.89935234192756, 'loss_val': 0.5659322328020152, 'psi': 0.6114549880616983}-{'f1_val': 0.38975027286830743, 'auprc': 0.9645940559304377, 'loss_val': 0.621031492013327, 'psi': 0.6196877860931596}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:54511
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:54508
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S7] → sending delta(kind=head bytes=1792) to S13@127.0.0.1:54513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:54502
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S14] → sending delta(kind=head bytes=1791) to S7@127.0.0.1:54508
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:54507
[S2] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1791 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1792 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1792) from S7
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.959850)
[S13] loaded HEAD from S7 (vec_in norm=0.959850)
[S13] cosine check vs S7: cos=0.8955
[S13] BUFFERED delta from S7 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1799) from S2
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.830133)
[S6] loaded HEAD from S2 (vec_in norm=1.830133)
[S6] cosine check vs S2: cos=0.9965
[S6] BUFFERED delta from S2 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1791) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.092766)
[S7] loaded HEAD from S14 (vec_in norm=1.092766)
[S7] cosine check vs S14: cos=0.6745
[S7] BUFFERED delta from S14 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1800) from S9
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.809647)
[S7] loaded HEAD from S9 (vec_in norm=1.809647)
[S7] cosine check vs S9: cos=0.7074
[S7] BUFFERED delta from S9 (total buffered=2)
[S10] RECEIVED delta(kind=head bytes=1802) from S13
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.062779)
[S10] loaded HEAD from S13 (vec_in norm=1.062779)
[S10] cosine check vs S13: cos=0.4884
[S10] BUFFERED delta from S13 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1798) from S16
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.573020)
[S14] loaded HEAD from S16 (vec_in norm=1.573020)
[S14] cosine check vs S16: cos=0.8416
[S14] BUFFERED delta from S16 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1799) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.843480)
[S2] loaded HEAD from S11 (vec_in norm=1.843480)
[S2] cosine check vs S11: cos=0.9990
[S2] BUFFERED delta from S11 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:54509
[S17] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.638042)
[S8] loaded HEAD from S17 (vec_in norm=1.638042)
[S8] cosine check vs S17: cos=0.9938
[S8] BUFFERED delta from S17 (total buffered=1)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=20 metric=0.9931 head_norm=1.677230
[S8] _apply_head_vector_avg (torch): Δ‖w‖=9.431428e-02
[S8] stored merged vector for next round verification (round=20)
[S8] DEBUG after merge:  round=20 metric=0.9924 head_norm=1.655067 delta_norm=0.094314
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.114 → S5@127.0.0.1:54505
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=20 metric=0.8497 head_norm=1.099865
[S10] _apply_head_vector_avg (torch): Δ‖w‖=5.471115e-01
[S10] stored merged vector for next round verification (round=20)
[S10] DEBUG after merge:  round=20 metric=0.7904 head_norm=0.932883 delta_norm=0.547111
[S10] aggregate: ROLLBACK (f1_val pre=0.850 post=0.790 tol_abs=0.005 tol_rel=0.0)
[S10] ⇄ pheromone p=0.133 → S5@127.0.0.1:54505
[S5] ⇄ pheromone p=0.240 → S3@127.0.0.1:54503
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=20 metric=0.8010 head_norm=1.777425
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.026072e-02
[S6] stored merged vector for next round verification (round=20)
[S6] DEBUG after merge:  round=20 metric=0.7864 head_norm=1.802185 delta_norm=0.080261
[S6] aggregate: ROLLBACK (f1_val pre=0.801 post=0.786 tol_abs=0.005 tol_rel=0.0)
[S6] ⇄ pheromone p=0.184 → S7@127.0.0.1:54508
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=20 metric=0.7002 head_norm=1.830133
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.162024e-02
[S2] stored merged vector for next round verification (round=20)
[S2] DEBUG after merge:  round=20 metric=0.7002 head_norm=1.836347 delta_norm=0.041620
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.129 → S6@127.0.0.1:54507
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=20 metric=0.6850 head_norm=0.959850
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.255067e-01
[S7] stored merged vector for next round verification (round=20)
[S7] DEBUG after merge:  round=20 metric=0.6845 head_norm=1.009463 delta_norm=0.225507
[S7] aggregate: ACCEPT kept=['S14', 'S9'] (k=2/2) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.127 → S13@127.0.0.1:54513
[S9] ⇄ pheromone p=0.059 → S7@127.0.0.1:54508
[S11] ⇄ pheromone p=0.181 → S2@127.0.0.1:54502
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=20 metric=0.6485 head_norm=1.062779
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.364935e-01
[S13] stored merged vector for next round verification (round=20)
[S13] DEBUG after merge:  round=20 metric=0.6459 head_norm=0.984620 delta_norm=0.236494
[S13] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.102 → S10@127.0.0.1:54511
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=20 metric=0.9923 head_norm=1.092766
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.402484e-01
[S14] stored merged vector for next round verification (round=20)
[S14] DEBUG after merge:  round=20 metric=0.9927 head_norm=1.280799 delta_norm=0.440248
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.221 → S7@127.0.0.1:54508
[S4] ⇄ pheromone p=0.126 → S14@127.0.0.1:54514
[S3] ⇄ pheromone p=0.094 → S14@127.0.0.1:54514
[S16] ⇄ pheromone p=0.188 → S14@127.0.0.1:54514
[S15] ⇄ pheromone p=0.260 → S14@127.0.0.1:54514
[S17] ⇄ pheromone p=0.108 → S8@127.0.0.1:54509
[S2] START round=21 head_norm_before_train=1.836347 cos_to_last_merge=1.0000 (last merge round=20)
[S2] round=21 local utility u=0.000000 metrics={'f1_val': 0.7215881870240894, 'auprc': 0.8765880303220289, 'loss_val': 0.2984319782804278, 'psi': 0.7835881243432652}-{'f1_val': 0.7002250022305567, 'auprc': 0.9630313410278698, 'loss_val': 0.2770008241946053, 'psi': 0.805347537749482}
[S3] START round=21 head_norm_before_train=2.011016 (no previous merge yet)
[S3] round=21 local utility u=0.321343 metrics={'f1_val': 0.982745947660243, 'auprc': 0.9992077066525964, 'loss_val': 0.06968414407171337, 'psi': 0.9893306512571843}-{'f1_val': 0.8910166638021851, 'auprc': 0.9996023453986198, 'loss_val': 0.16317750947741597, 'psi': 0.9344509364407589}
[S4] START round=21 head_norm_before_train=1.577440 cos_to_last_merge=0.8057 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.806
[S4] round=21 local utility u=0.000000 metrics={'f1_val': 0.9462138482603073, 'auprc': 0.9379341749584037, 'loss_val': 0.27743463071484664, 'psi': 0.9429019789395459}-{'f1_val': 0.9477417054147573, 'auprc': 0.9399755340952456, 'loss_val': 0.27992396819185894, 'psi': 0.9446352368869526}
[S5] START round=21 head_norm_before_train=0.952516 cos_to_last_merge=0.9949 (last merge round=19)
[S5] round=21 local utility u=0.000000 metrics={'f1_val': 0.6214625276953982, 'auprc': 0.8535008114378249, 'loss_val': 0.5927396880466894, 'psi': 0.7142778411923689}-{'f1_val': 0.700320598491359, 'auprc': 0.8790559122646329, 'loss_val': 0.6017515663506127, 'psi': 0.7718147240006685}
[S6] START round=21 head_norm_before_train=1.802185 cos_to_last_merge=1.0000 (last merge round=20)
[S6] round=21 local utility u=0.173186 metrics={'f1_val': 0.8696546817573588, 'auprc': 0.9466286723714702, 'loss_val': 0.36304970739208764, 'psi': 0.9004442780030033}-{'f1_val': 0.8009722927113787, 'auprc': 0.9530064448204878, 'loss_val': 0.31646019903138567, 'psi': 0.8617859535550223}
[S7] START round=21 head_norm_before_train=1.009463 cos_to_last_merge=1.0000 (last merge round=20)
[S7] round=21 local utility u=0.000000 metrics={'f1_val': 0.590042091362251, 'auprc': 0.8266355021756533, 'loss_val': 0.7394070184552632, 'psi': 0.6846794556876119}-{'f1_val': 0.6850391814309388, 'auprc': 0.9880937164637721, 'loss_val': 0.4761557699460835, 'psi': 0.806260995444072}
[S8] START round=21 head_norm_before_train=1.655067 cos_to_last_merge=1.0000 (last merge round=20)
[S8] round=21 local utility u=0.000000 metrics={'f1_val': 0.9770490004777783, 'auprc': 0.9939156946916752, 'loss_val': 0.14683963430364472, 'psi': 0.983795678163337}-{'f1_val': 0.9931489740885844, 'auprc': 0.9837576171130666, 'loss_val': 0.13454839711919328, 'psi': 0.9893924312983773}
[S9] START round=21 head_norm_before_train=1.809647 cos_to_last_merge=0.8338 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.834
[S9] round=21 local utility u=0.000000 metrics={'f1_val': 0.9905718417662249, 'auprc': 0.9987984394358439, 'loss_val': 0.034292974761907055, 'psi': 0.9938624808340726}-{'f1_val': 0.9966924912647621, 'auprc': 0.9938628333585993, 'loss_val': 0.025618677717687898, 'psi': 0.9955606281022971}
[S10] START round=21 head_norm_before_train=0.932883 cos_to_last_merge=1.0000 (last merge round=20)
[S10] round=21 local utility u=0.034888 metrics={'f1_val': 0.8723503546091127, 'auprc': 0.9909681652478383, 'loss_val': 0.5284519099349609, 'psi': 0.919797478864603}-{'f1_val': 0.8497319503142542, 'auprc': 0.9769973822842494, 'loss_val': 0.42060493532136334, 'psi': 0.9006381231022522}
[S11] START round=21 head_norm_before_train=1.843480 (no previous merge yet)
[S11] round=21 local utility u=0.000000 metrics={'f1_val': 0.9916762941264107, 'auprc': 0.9983754807021491, 'loss_val': 0.1798989408279705, 'psi': 0.9943559687567061}-{'f1_val': 0.9973550136825626, 'auprc': 0.9981310484253934, 'loss_val': 0.1756843027228915, 'psi': 0.997665427579695}
[S13] START round=21 head_norm_before_train=0.984620 cos_to_last_merge=1.0000 (last merge round=20)
[S13] round=21 local utility u=0.000000 metrics={'f1_val': 0.5953170864158409, 'auprc': 0.7285151446734262, 'loss_val': 0.7773792215224204, 'psi': 0.6485963097188749}-{'f1_val': 0.6485119937423371, 'auprc': 0.7133044157015986, 'loss_val': 0.6328274597939971, 'psi': 0.6744289625260418}
[S14] START round=21 head_norm_before_train=1.280799 cos_to_last_merge=1.0000 (last merge round=20)
[S14] round=21 local utility u=0.058129 metrics={'f1_val': 0.9962946549157091, 'auprc': 0.9968865069126398, 'loss_val': 0.37967235702364427, 'psi': 0.9965313957144813}-{'f1_val': 0.9922634811590824, 'auprc': 0.9955832644617184, 'loss_val': 0.46783378111330903, 'psi': 0.9935913944801368}
[S15] START round=21 head_norm_before_train=1.582744 cos_to_last_merge=0.8396 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.840
[S15] round=21 local utility u=0.603093 metrics={'f1_val': 0.9276868288410514, 'auprc': 0.9874190369941227, 'loss_val': 0.14175761278164017, 'psi': 0.9515797121022799}-{'f1_val': 0.7919817181424701, 'auprc': 0.9118860800237601, 'loss_val': 0.3071136637161073, 'psi': 0.8399434628949861}
[S16] START round=21 head_norm_before_train=1.573020 cos_to_last_merge=0.8253 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.825
[S16] round=21 local utility u=0.000000 metrics={'f1_val': 0.8629695968672508, 'auprc': 0.9899573495046251, 'loss_val': 0.5882516072519346, 'psi': 0.9137646979222005}-{'f1_val': 0.940533806735162, 'auprc': 0.9942122800048494, 'loss_val': 0.17259226754023693, 'psi': 0.9620051960430369}
[S17] START round=21 head_norm_before_train=1.638042 (no previous merge yet)
[S17] round=21 local utility u=0.000000 metrics={'f1_val': 0.4117506903499045, 'auprc': 0.8583837355503267, 'loss_val': 0.580559218855987, 'psi': 0.5904039084300734}-{'f1_val': 0.41952341881779043, 'auprc': 0.89935234192756, 'loss_val': 0.5659322328020152, 'psi': 0.6114549880616983}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:54508
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:54514
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S7@127.0.0.1:54508
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:54505
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S3
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=2.035336)
[S14] loaded HEAD from S3 (vec_in norm=2.035336)
[S14] cosine check vs S3: cos=0.5557
[S14] BUFFERED delta from S3 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1794) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.306880)
[S7] loaded HEAD from S14 (vec_in norm=1.306880)
[S7] cosine check vs S14: cos=0.5400
[S7] BUFFERED delta from S14 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1798) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=0.960500)
[S5] loaded HEAD from S10 (vec_in norm=0.960500)
[S5] cosine check vs S10: cos=0.7309
[S5] BUFFERED delta from S10 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1801) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.814305)
[S7] loaded HEAD from S6 (vec_in norm=1.814305)
[S7] cosine check vs S6: cos=0.1359
[S7] BUFFERED delta from S6 (total buffered=2)
[S14] RECEIVED delta(kind=head bytes=1799) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.608436)
[S14] loaded HEAD from S15 (vec_in norm=1.608436)
[S14] cosine check vs S15: cos=0.4948
[S14] BUFFERED delta from S15 (total buffered=2)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=21 metric=0.6215 head_norm=1.022883
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.649341e-01
[S5] stored merged vector for next round verification (round=21)
[S5] DEBUG after merge:  round=21 metric=0.6537 head_norm=0.922631 delta_norm=0.364934
[S5] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=21 metric=0.5900 head_norm=1.043713
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.821885e-01
[S7] stored merged vector for next round verification (round=21)
[S7] DEBUG after merge:  round=21 metric=0.5228 head_norm=0.914275 delta_norm=0.582188
[S7] aggregate: ROLLBACK (f1_val pre=0.590 post=0.523 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=21 metric=0.9963 head_norm=1.306880
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.168418e-01
[S14] stored merged vector for next round verification (round=21)
[S14] DEBUG after merge:  round=21 metric=0.9924 head_norm=1.235434 delta_norm=0.516842
[S14] aggregate: ACCEPT kept=['S3', 'S15'] (k=2/2) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.853887 cos_to_last_merge=0.9999 (last merge round=20)
[S2] round=22 local utility u=0.388228 metrics={'f1_val': 0.8317044959514295, 'auprc': 0.9013039339493246, 'loss_val': 0.25682216280162523, 'psi': 0.8595442711505875}-{'f1_val': 0.7215881870240894, 'auprc': 0.8765880303220289, 'loss_val': 0.2984319782804278, 'psi': 0.7835881243432652}
[S3] START round=22 head_norm_before_train=2.035336 (no previous merge yet)
[S3] round=22 local utility u=0.063478 metrics={'f1_val': 0.9978389274664787, 'auprc': 0.9996057833964344, 'loss_val': 0.034481153864404965, 'psi': 0.998545669838461}-{'f1_val': 0.982745947660243, 'auprc': 0.9992077066525964, 'loss_val': 0.06968414407171337, 'psi': 0.9893306512571843}
[S4] START round=22 head_norm_before_train=1.591835 cos_to_last_merge=0.8043 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.804
[S4] round=22 local utility u=0.022127 metrics={'f1_val': 0.9480768953311539, 'auprc': 0.9461105706391127, 'loss_val': 0.26888821029891463, 'psi': 0.9472903654543374}-{'f1_val': 0.9462138482603073, 'auprc': 0.9379341749584037, 'loss_val': 0.27743463071484664, 'psi': 0.9429019789395459}
[S5] START round=22 head_norm_before_train=0.922631 cos_to_last_merge=1.0000 (last merge round=21)
[S5] round=22 local utility u=0.488386 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9889109546501842, 'loss_val': 0.4953517569181853, 'psi': 0.815757172320422}-{'f1_val': 0.6214625276953982, 'auprc': 0.8535008114378249, 'loss_val': 0.5927396880466894, 'psi': 0.7142778411923689}
[S6] START round=22 head_norm_before_train=1.814305 cos_to_last_merge=0.9999 (last merge round=20)
[S6] round=22 local utility u=0.311853 metrics={'f1_val': 0.9583884462827866, 'auprc': 0.9529949063855891, 'loss_val': 0.29084496984646885, 'psi': 0.9562310303239077}-{'f1_val': 0.8696546817573588, 'auprc': 0.9466286723714702, 'loss_val': 0.36304970739208764, 'psi': 0.9004442780030033}
[S7] START round=22 head_norm_before_train=0.914275 cos_to_last_merge=1.0000 (last merge round=21)
[S7] round=22 local utility u=0.000000 metrics={'f1_val': 0.48152830560936033, 'auprc': 0.790713521437071, 'loss_val': 0.8884922574880998, 'psi': 0.6052023919404446}-{'f1_val': 0.590042091362251, 'auprc': 0.8266355021756533, 'loss_val': 0.7394070184552632, 'psi': 0.6846794556876119}
[S8] START round=22 head_norm_before_train=1.681589 cos_to_last_merge=0.9996 (last merge round=20)
[S8] round=22 local utility u=0.067236 metrics={'f1_val': 0.9938130760262815, 'auprc': 0.9865884189811638, 'loss_val': 0.09097099118052042, 'psi': 0.9909232132082344}-{'f1_val': 0.9770490004777783, 'auprc': 0.9939156946916752, 'loss_val': 0.14683963430364472, 'psi': 0.983795678163337}
[S9] START round=22 head_norm_before_train=1.827443 cos_to_last_merge=0.8323 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.832
[S9] round=22 local utility u=0.022277 metrics={'f1_val': 0.9972634903368587, 'auprc': 0.9962229739050262, 'loss_val': 0.022161794324018574, 'psi': 0.9968472837641257}-{'f1_val': 0.9905718417662249, 'auprc': 0.9987984394358439, 'loss_val': 0.034292974761907055, 'psi': 0.9938624808340726}
[S10] START round=22 head_norm_before_train=0.960500 cos_to_last_merge=0.9986 (last merge round=20)
[S10] round=22 local utility u=0.419342 metrics={'f1_val': 0.9891749884814538, 'auprc': 0.9928572213204278, 'loss_val': 0.3963824624785371, 'psi': 0.9906478816170434}-{'f1_val': 0.8723503546091127, 'auprc': 0.9909681652478383, 'loss_val': 0.5284519099349609, 'psi': 0.919797478864603}
[S11] START round=22 head_norm_before_train=1.865394 (no previous merge yet)
[S11] round=22 local utility u=0.048153 metrics={'f1_val': 0.9969406902828911, 'auprc': 0.9982665475878985, 'loss_val': 0.1148530278336128, 'psi': 0.997471033204894}-{'f1_val': 0.9916762941264107, 'auprc': 0.9983754807021491, 'loss_val': 0.1798989408279705, 'psi': 0.9943559687567061}
[S13] START round=22 head_norm_before_train=1.022120 cos_to_last_merge=0.9970 (last merge round=20)
[S13] round=22 local utility u=0.050744 metrics={'f1_val': 0.6118547367489494, 'auprc': 0.7048402736951761, 'loss_val': 0.704092763542776, 'psi': 0.64904895152744}-{'f1_val': 0.5953170864158409, 'auprc': 0.7285151446734262, 'loss_val': 0.7773792215224204, 'psi': 0.6485963097188749}
[S14] START round=22 head_norm_before_train=1.235434 cos_to_last_merge=1.0000 (last merge round=21)
[S14] round=22 local utility u=0.000000 metrics={'f1_val': 0.9972626935085508, 'auprc': 0.9965374826184081, 'loss_val': 0.4108375946508259, 'psi': 0.9969726091524937}-{'f1_val': 0.9962946549157091, 'auprc': 0.9968865069126398, 'loss_val': 0.37967235702364427, 'psi': 0.9965313957144813}
[S15] START round=22 head_norm_before_train=1.608436 cos_to_last_merge=0.8363 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.836
[S15] round=22 local utility u=0.000000 metrics={'f1_val': 0.845889201277386, 'auprc': 0.9230439672853562, 'loss_val': 0.2600027851589231, 'psi': 0.8767511076805741}-{'f1_val': 0.9276868288410514, 'auprc': 0.9874190369941227, 'loss_val': 0.14175761278164017, 'psi': 0.9515797121022799}
[S16] START round=22 head_norm_before_train=1.598522 cos_to_last_merge=0.8226 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.823
[S16] round=22 local utility u=0.000000 metrics={'f1_val': 0.8499234807095197, 'auprc': 0.9946356379579997, 'loss_val': 0.7072413381745197, 'psi': 0.9078083436089117}-{'f1_val': 0.8629695968672508, 'auprc': 0.9899573495046251, 'loss_val': 0.5882516072519346, 'psi': 0.9137646979222005}
[S17] START round=22 head_norm_before_train=1.656647 (no previous merge yet)
[S17] round=22 local utility u=0.809160 metrics={'f1_val': 0.6348465991653054, 'auprc': 0.9203476488440947, 'loss_val': 0.4867066182995212, 'psi': 0.7490470190368211}-{'f1_val': 0.4117506903499045, 'auprc': 0.8583837355503267, 'loss_val': 0.580559218855987, 'psi': 0.5904039084300734}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:54514
[S3] sending update (kind=head size=1796 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1796) from S3
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=2.058656)
[S14] loaded HEAD from S3 (vec_in norm=2.058656)
[S14] cosine check vs S3: cos=0.7338
[S14] BUFFERED delta from S3 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:54511
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:54502
[S10] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1800) from S13
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.063559)
[S10] loaded HEAD from S13 (vec_in norm=1.063559)
[S10] cosine check vs S13: cos=0.7755
[S10] BUFFERED delta from S13 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1796) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.005325)
[S5] loaded HEAD from S10 (vec_in norm=1.005325)
[S5] cosine check vs S10: cos=0.8990
[S5] BUFFERED delta from S10 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:54503
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:54507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:54505
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1804) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.824597)
[S7] loaded HEAD from S6 (vec_in norm=1.824597)
[S7] cosine check vs S6: cos=0.5610
[S7] BUFFERED delta from S6 (total buffered=1)
[S2] sending update (kind=head size=1805 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1805) from S2
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.871431)
[S6] loaded HEAD from S2 (vec_in norm=1.871431)
[S6] cosine check vs S2: cos=0.9976
[S6] BUFFERED delta from S2 (total buffered=1)
[S8] sending update (kind=head size=1793 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1793) from S8
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.711094)
[S5] loaded HEAD from S8 (vec_in norm=1.711094)
[S5] cosine check vs S8: cos=0.3057
[S5] BUFFERED delta from S8 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:54508
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1803 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1803) from S9
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.842175)
[S7] loaded HEAD from S9 (vec_in norm=1.842175)
[S7] cosine check vs S9: cos=0.4517
[S7] BUFFERED delta from S9 (total buffered=2)
[S11] sending update (kind=head size=1799 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1799) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.888539)
[S2] loaded HEAD from S11 (vec_in norm=1.888539)
[S2] cosine check vs S11: cos=0.9982
[S2] BUFFERED delta from S11 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:54509
[S17] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.676390)
[S8] loaded HEAD from S17 (vec_in norm=1.676390)
[S8] cosine check vs S17: cos=0.9913
[S8] BUFFERED delta from S17 (total buffered=1)
[S5] sending update (kind=head size=1800 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1800) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.965787)
[S3] loaded HEAD from S5 (vec_in norm=0.965787)
[S3] cosine check vs S5: cos=0.0460
[S3] BUFFERED delta from S5 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:54514
[S4] sending update (kind=head size=1802 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1802) from S4
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.603281)
[S14] loaded HEAD from S4 (vec_in norm=1.603281)
[S14] cosine check vs S4: cos=0.1736
[S14] BUFFERED delta from S4 (total buffered=2)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=22 metric=0.9978 head_norm=2.058656
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.116693e+00
[S3] stored merged vector for next round verification (round=22)
[S3] DEBUG after merge:  round=22 metric=0.9970 head_norm=1.156892 delta_norm=1.116693
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=22 metric=0.9584 head_norm=1.824597
[S6] _apply_head_vector_avg (torch): Δ‖w‖=6.877053e-02
[S6] stored merged vector for next round verification (round=22)
[S6] DEBUG after merge:  round=22 metric=0.9586 head_norm=1.846882 delta_norm=0.068771
[S6] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=22 metric=0.9892 head_norm=1.005325
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.476691e-01
[S10] stored merged vector for next round verification (round=22)
[S10] DEBUG after merge:  round=22 metric=0.9363 head_norm=0.974702 delta_norm=0.347669
[S10] aggregate: ROLLBACK (f1_val pre=0.989 post=0.936 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=22 metric=0.7003 head_norm=0.965787
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.704066e-01
[S5] stored merged vector for next round verification (round=22)
[S5] DEBUG after merge:  round=22 metric=0.7003 head_norm=0.908973 delta_norm=0.370407
[S5] aggregate: ACCEPT kept=['S10', 'S8'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=22 metric=0.4815 head_norm=0.958191
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.521625e-01
[S7] stored merged vector for next round verification (round=22)
[S7] DEBUG after merge:  round=22 metric=0.4112 head_norm=1.045678 delta_norm=0.452163
[S7] aggregate: ROLLBACK (f1_val pre=0.482 post=0.411 tol_abs=0.005 tol_rel=0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=22 metric=0.8317 head_norm=1.871431
[S2] _apply_head_vector_avg (torch): Δ‖w‖=5.685107e-02
[S2] stored merged vector for next round verification (round=22)
[S2] DEBUG after merge:  round=22 metric=0.8374 head_norm=1.879145 delta_norm=0.056851
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=22 metric=0.9973 head_norm=1.259693
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.943425e-01
[S14] stored merged vector for next round verification (round=22)
[S14] DEBUG after merge:  round=22 metric=0.9973 head_norm=1.170949 delta_norm=0.494342
[S14] aggregate: ACCEPT kept=['S3', 'S4'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=22 metric=0.9938 head_norm=1.711094
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.129802e-01
[S8] stored merged vector for next round verification (round=22)
[S8] DEBUG after merge:  round=22 metric=0.9945 head_norm=1.690059 delta_norm=0.112980
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.879145 cos_to_last_merge=1.0000 (last merge round=22)
[S2] round=23 local utility u=0.113152 metrics={'f1_val': 0.8436334519369765, 'auprc': 0.9430040959380683, 'loss_val': 0.22719203796673387, 'psi': 0.8833817095374132}-{'f1_val': 0.8317044959514295, 'auprc': 0.9013039339493246, 'loss_val': 0.25682216280162523, 'psi': 0.8595442711505875}
[S3] START round=23 head_norm_before_train=1.156892 cos_to_last_merge=1.0000 (last merge round=22)
[S3] round=23 local utility u=0.000000 metrics={'f1_val': 0.9611152572344858, 'auprc': 0.9991220327035297, 'loss_val': 0.15573651364882288, 'psi': 0.9763179674221034}-{'f1_val': 0.9978389274664787, 'auprc': 0.9996057833964344, 'loss_val': 0.034481153864404965, 'psi': 0.998545669838461}
[S4] START round=23 head_norm_before_train=1.603281 cos_to_last_merge=0.8033 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.803
[S4] round=23 local utility u=0.000000 metrics={'f1_val': 0.9480447023352633, 'auprc': 0.9414521065146455, 'loss_val': 0.2711224428018959, 'psi': 0.9454076640070161}-{'f1_val': 0.9480768953311539, 'auprc': 0.9461105706391127, 'loss_val': 0.26888821029891463, 'psi': 0.9472903654543374}
[S5] START round=23 head_norm_before_train=0.908973 cos_to_last_merge=1.0000 (last merge round=22)
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9706249215531134, 'loss_val': 0.4525365621526182, 'psi': 0.8084427590815937}-{'f1_val': 0.7003213174339138, 'auprc': 0.9889109546501842, 'loss_val': 0.4953517569181853, 'psi': 0.815757172320422}
[S6] START round=23 head_norm_before_train=1.846882 cos_to_last_merge=1.0000 (last merge round=22)
[S6] round=23 local utility u=0.003493 metrics={'f1_val': 0.9568916984383523, 'auprc': 0.9547784147909413, 'loss_val': 0.2802294401010779, 'psi': 0.9560463849793879}-{'f1_val': 0.9583884462827866, 'auprc': 0.9529949063855891, 'loss_val': 0.29084496984646885, 'psi': 0.9562310303239077}
[S7] START round=23 head_norm_before_train=1.045678 cos_to_last_merge=1.0000 (last merge round=22)
[S7] round=23 local utility u=0.127911 metrics={'f1_val': 0.5114559426319849, 'auprc': 0.8060473431323044, 'loss_val': 0.8582371137836844, 'psi': 0.6292925028321128}-{'f1_val': 0.48152830560936033, 'auprc': 0.790713521437071, 'loss_val': 0.8884922574880998, 'psi': 0.6052023919404446}
[S8] START round=23 head_norm_before_train=1.690059 cos_to_last_merge=1.0000 (last merge round=22)
[S8] round=23 local utility u=0.001520 metrics={'f1_val': 0.9925289693239863, 'auprc': 0.9908841805781652, 'loss_val': 0.0931141833318044, 'psi': 0.9918710538256579}-{'f1_val': 0.9938130760262815, 'auprc': 0.9865884189811638, 'loss_val': 0.09097099118052042, 'psi': 0.9909232132082344}
[S9] START round=23 head_norm_before_train=1.842175 cos_to_last_merge=0.8308 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.831
[S9] round=23 local utility u=0.000000 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9965072152506094, 'loss_val': 0.02175645168419043, 'psi': 0.9967144373555981}-{'f1_val': 0.9972634903368587, 'auprc': 0.9962229739050262, 'loss_val': 0.022161794324018574, 'psi': 0.9968472837641257}
[S10] START round=23 head_norm_before_train=0.974702 cos_to_last_merge=1.0000 (last merge round=22)
[S10] round=23 local utility u=0.000000 metrics={'f1_val': 0.9927424436016662, 'auprc': 0.9910150094015898, 'loss_val': 0.4772792341341911, 'psi': 0.9920514699216356}-{'f1_val': 0.9891749884814538, 'auprc': 0.9928572213204278, 'loss_val': 0.3963824624785371, 'psi': 0.9906478816170434}
[S11] START round=23 head_norm_before_train=1.888539 (no previous merge yet)
[S11] round=23 local utility u=0.000000 metrics={'f1_val': 0.903713536968269, 'auprc': 0.9973651066326732, 'loss_val': 0.30814997978600017, 'psi': 0.9411741648340307}-{'f1_val': 0.9969406902828911, 'auprc': 0.9982665475878985, 'loss_val': 0.1148530278336128, 'psi': 0.997471033204894}
[S13] START round=23 head_norm_before_train=1.063559 cos_to_last_merge=0.9895 (last merge round=20)
[S13] round=23 local utility u=0.000000 metrics={'f1_val': 0.6098978606546135, 'auprc': 0.663436113379742, 'loss_val': 0.6517527268055819, 'psi': 0.6313131617446649}-{'f1_val': 0.6118547367489494, 'auprc': 0.7048402736951761, 'loss_val': 0.704092763542776, 'psi': 0.64904895152744}
[S14] START round=23 head_norm_before_train=1.170949 cos_to_last_merge=1.0000 (last merge round=22)
[S14] round=23 local utility u=0.031794 metrics={'f1_val': 0.9972408627570057, 'auprc': 0.9964963035150364, 'loss_val': 0.3469944282013505, 'psi': 0.996943039060218}-{'f1_val': 0.9972626935085508, 'auprc': 0.9965374826184081, 'loss_val': 0.4108375946508259, 'psi': 0.9969726091524937}
[S15] START round=23 head_norm_before_train=1.635584 cos_to_last_merge=0.8329 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.833
[S15] round=23 local utility u=0.247513 metrics={'f1_val': 0.8953824467866053, 'auprc': 0.9759552127151303, 'loss_val': 0.2206694783174794, 'psi': 0.9276115531580154}-{'f1_val': 0.845889201277386, 'auprc': 0.9230439672853562, 'loss_val': 0.2600027851589231, 'psi': 0.8767511076805741}
[S16] START round=23 head_norm_before_train=1.622627 cos_to_last_merge=0.8205 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.821
[S16] round=23 local utility u=0.076923 metrics={'f1_val': 0.8610297243931675, 'auprc': 0.9948423423200686, 'loss_val': 0.6206530674754991, 'psi': 0.914554771563928}-{'f1_val': 0.8499234807095197, 'auprc': 0.9946356379579997, 'loss_val': 0.7072413381745197, 'psi': 0.9078083436089117}
[S17] START round=23 head_norm_before_train=1.676390 (no previous merge yet)
[S17] round=23 local utility u=0.000000 metrics={'f1_val': 0.5178030365973194, 'auprc': 0.7499482337996188, 'loss_val': 0.6011340526801876, 'psi': 0.6106611154782391}-{'f1_val': 0.6348465991653054, 'auprc': 0.9203476488440947, 'loss_val': 0.4867066182995212, 'psi': 0.7490470190368211}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:54514
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:54508
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:54508
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:54507
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:54513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:54514
[S2] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1799) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.660248)
[S14] loaded HEAD from S15 (vec_in norm=1.660248)
[S14] cosine check vs S15: cos=0.4293
[S14] BUFFERED delta from S15 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1796) from S16
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.643368)
[S14] loaded HEAD from S16 (vec_in norm=1.643368)
[S14] cosine check vs S16: cos=0.7035
[S14] BUFFERED delta from S16 (total buffered=2)
[S5] RECEIVED delta(kind=head bytes=1798) from S8
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.715546)
[S5] loaded HEAD from S8 (vec_in norm=1.715546)
[S5] cosine check vs S8: cos=0.6452
[S5] BUFFERED delta from S8 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1797) from S7
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.080543)
[S13] loaded HEAD from S7 (vec_in norm=1.080543)
[S13] cosine check vs S7: cos=0.7318
[S13] BUFFERED delta from S7 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1802) from S2
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.898219)
[S6] loaded HEAD from S2 (vec_in norm=1.898219)
[S6] cosine check vs S2: cos=0.9985
[S6] BUFFERED delta from S2 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1803) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.855880)
[S7] loaded HEAD from S6 (vec_in norm=1.855880)
[S7] cosine check vs S6: cos=0.6821
[S7] BUFFERED delta from S6 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1802) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.200970)
[S7] loaded HEAD from S14 (vec_in norm=1.200970)
[S7] cosine check vs S14: cos=0.4157
[S7] BUFFERED delta from S14 (total buffered=2)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=23 metric=0.6099 head_norm=1.107954
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.009431e-01
[S13] stored merged vector for next round verification (round=23)
[S13] DEBUG after merge:  round=23 metric=0.6083 head_norm=1.018240 delta_norm=0.400943
[S13] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=23 metric=0.9972 head_norm=1.200970
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.302991e-01
[S14] stored merged vector for next round verification (round=23)
[S14] DEBUG after merge:  round=23 metric=0.9975 head_norm=1.184652 delta_norm=0.530299
[S14] aggregate: ACCEPT kept=['S15', 'S16'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=23 metric=0.7003 head_norm=0.957208
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.596332e-01
[S5] stored merged vector for next round verification (round=23)
[S5] DEBUG after merge:  round=23 metric=0.7003 head_norm=1.222520 delta_norm=0.659633
[S5] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=23 metric=0.9569 head_norm=1.855880
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.572481e-02
[S6] stored merged vector for next round verification (round=23)
[S6] DEBUG after merge:  round=23 metric=0.9552 head_norm=1.876341 delta_norm=0.055725
[S6] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=23 metric=0.5115 head_norm=1.080543
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.721808e-01
[S7] stored merged vector for next round verification (round=23)
[S7] DEBUG after merge:  round=23 metric=0.5410 head_norm=1.045094 delta_norm=0.372181
[S7] aggregate: ACCEPT kept=['S6', 'S14'] (k=2/2) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.898219 cos_to_last_merge=0.9999 (last merge round=22)
[S2] round=24 local utility u=0.000000 metrics={'f1_val': 0.8478409116873578, 'auprc': 0.8543540620952415, 'loss_val': 0.2890670672716927, 'psi': 0.8504461718505112}-{'f1_val': 0.8436334519369765, 'auprc': 0.9430040959380683, 'loss_val': 0.22719203796673387, 'psi': 0.8833817095374132}
[S3] START round=24 head_norm_before_train=1.250503 cos_to_last_merge=0.9983 (last merge round=22)
[S3] round=24 local utility u=0.000000 metrics={'f1_val': 0.8779402810072126, 'auprc': 0.9995138007150639, 'loss_val': 0.22493921081599694, 'psi': 0.9265696888903531}-{'f1_val': 0.9611152572344858, 'auprc': 0.9991220327035297, 'loss_val': 0.15573651364882288, 'psi': 0.9763179674221034}
[S4] START round=24 head_norm_before_train=1.616132 cos_to_last_merge=0.8021 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.802
[S4] round=24 local utility u=0.036700 metrics={'f1_val': 0.9512202277959803, 'auprc': 0.9573992800981593, 'loss_val': 0.2646171163748227, 'psi': 0.953691848716852}-{'f1_val': 0.9480447023352633, 'auprc': 0.9414521065146455, 'loss_val': 0.2711224428018959, 'psi': 0.9454076640070161}
[S5] START round=24 head_norm_before_train=1.222520 cos_to_last_merge=1.0000 (last merge round=23)
[S5] round=24 local utility u=0.106141 metrics={'f1_val': 0.7004938661094564, 'auprc': 0.9896219718804871, 'loss_val': 0.29828146754836776, 'psi': 0.8161451084178687}-{'f1_val': 0.7003213174339138, 'auprc': 0.9706249215531134, 'loss_val': 0.4525365621526182, 'psi': 0.8084427590815937}
[S6] START round=24 head_norm_before_train=1.876341 cos_to_last_merge=1.0000 (last merge round=23)
[S6] round=24 local utility u=0.000000 metrics={'f1_val': 0.9537782822489855, 'auprc': 0.9575727470781111, 'loss_val': 0.2711801071166154, 'psi': 0.9552960681806357}-{'f1_val': 0.9568916984383523, 'auprc': 0.9547784147909413, 'loss_val': 0.2802294401010779, 'psi': 0.9560463849793879}
[S7] START round=24 head_norm_before_train=1.045094 cos_to_last_merge=1.0000 (last merge round=23)
[S7] round=24 local utility u=0.503202 metrics={'f1_val': 0.631160788341277, 'auprc': 0.8308249841164517, 'loss_val': 0.6443949350347152, 'psi': 0.7110264666513468}-{'f1_val': 0.5114559426319849, 'auprc': 0.8060473431323044, 'loss_val': 0.8582371137836844, 'psi': 0.6292925028321128}
[S8] START round=24 head_norm_before_train=1.715546 cos_to_last_merge=0.9997 (last merge round=22)
[S8] round=24 local utility u=0.000000 metrics={'f1_val': 0.9864258722700556, 'auprc': 0.9976711793409591, 'loss_val': 0.09158476217601483, 'psi': 0.990923995098417}-{'f1_val': 0.9925289693239863, 'auprc': 0.9908841805781652, 'loss_val': 0.0931141833318044, 'psi': 0.9918710538256579}
[S9] START round=24 head_norm_before_train=1.858563 cos_to_last_merge=0.8291 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.829
[S9] round=24 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9952918120840017, 'loss_val': 0.02137093518141632, 'psi': 0.9963784723408864}-{'f1_val': 0.9968525854255906, 'auprc': 0.9965072152506094, 'loss_val': 0.02175645168419043, 'psi': 0.9967144373555981}
[S10] START round=24 head_norm_before_train=1.016802 cos_to_last_merge=0.9953 (last merge round=22)
[S10] round=24 local utility u=0.053901 metrics={'f1_val': 0.9916503035934691, 'auprc': 0.9907371708835828, 'loss_val': 0.36209167149600735, 'psi': 0.9912850505095145}-{'f1_val': 0.9927424436016662, 'auprc': 0.9910150094015898, 'loss_val': 0.4772792341341911, 'psi': 0.9920514699216356}
[S11] START round=24 head_norm_before_train=1.913200 (no previous merge yet)
[S11] round=24 local utility u=0.386373 metrics={'f1_val': 0.9962850284706224, 'auprc': 0.9981075872610448, 'loss_val': 0.09305977265887819, 'psi': 0.9970140519867914}-{'f1_val': 0.903713536968269, 'auprc': 0.9973651066326732, 'loss_val': 0.30814997978600017, 'psi': 0.9411741648340307}
[S13] START round=24 head_norm_before_train=1.018240 cos_to_last_merge=1.0000 (last merge round=23)
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.5943385856422803, 'auprc': 0.6833845440686684, 'loss_val': 0.7699382112746985, 'psi': 0.6299569690128355}-{'f1_val': 0.6098978606546135, 'auprc': 0.663436113379742, 'loss_val': 0.6517527268055819, 'psi': 0.6313131617446649}
[S14] START round=24 head_norm_before_train=1.184652 cos_to_last_merge=1.0000 (last merge round=23)
[S14] round=24 local utility u=0.016876 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9969476262070289, 'loss_val': 0.31459249670174444, 'psi': 0.9971232645062874}-{'f1_val': 0.9972408627570057, 'auprc': 0.9964963035150364, 'loss_val': 0.3469944282013505, 'psi': 0.996943039060218}
[S15] START round=24 head_norm_before_train=1.660248 cos_to_last_merge=0.8300 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.830
[S15] round=24 local utility u=0.000000 metrics={'f1_val': 0.8180070555920214, 'auprc': 0.9228023044458191, 'loss_val': 0.26830357067356764, 'psi': 0.8599251551335405}-{'f1_val': 0.8953824467866053, 'auprc': 0.9759552127151303, 'loss_val': 0.2206694783174794, 'psi': 0.9276115531580154}
[S16] START round=24 head_norm_before_train=1.643368 cos_to_last_merge=0.8190 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.819
[S16] round=24 local utility u=0.629216 metrics={'f1_val': 0.9839470634084841, 'auprc': 0.99318137822093, 'loss_val': 0.09474250250890827, 'psi': 0.9876407893334624}-{'f1_val': 0.8610297243931675, 'auprc': 0.9948423423200686, 'loss_val': 0.6206530674754991, 'psi': 0.914554771563928}
[S17] START round=24 head_norm_before_train=1.702083 (no previous merge yet)
[S17] round=24 local utility u=0.257618 metrics={'f1_val': 0.5912774276308608, 'auprc': 0.7934171353328199, 'loss_val': 0.657152039809121, 'psi': 0.6721333107116445}-{'f1_val': 0.5178030365973194, 'auprc': 0.7499482337996188, 'loss_val': 0.6011340526801876, 'psi': 0.6106611154782391}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S3@127.0.0.1:54503
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] → sending delta(kind=head bytes=1792) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S2@127.0.0.1:54502
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:54514
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S13@127.0.0.1:54513
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1794 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1793 to 1 peers)
[S11] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1792 to 1 peers)
[S5] sending update (kind=head size=1793 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1792) from S4
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.632892)
[S14] loaded HEAD from S4 (vec_in norm=1.632892)
[S14] cosine check vs S4: cos=0.2968
[S14] BUFFERED delta from S4 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1793) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.066018)
[S5] loaded HEAD from S10 (vec_in norm=1.066018)
[S5] cosine check vs S10: cos=0.2755
[S5] BUFFERED delta from S10 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1794) from S7
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.084372)
[S13] loaded HEAD from S7 (vec_in norm=1.084372)
[S13] cosine check vs S7: cos=0.8313
[S13] BUFFERED delta from S7 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1795) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.217240)
[S7] loaded HEAD from S14 (vec_in norm=1.217240)
[S7] cosine check vs S14: cos=0.5396
[S7] BUFFERED delta from S14 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1793) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.250466)
[S3] loaded HEAD from S5 (vec_in norm=1.250466)
[S3] cosine check vs S5: cos=0.1947
[S3] BUFFERED delta from S5 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1803) from S16
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.660173)
[S14] loaded HEAD from S16 (vec_in norm=1.660173)
[S14] cosine check vs S16: cos=0.8453
[S14] BUFFERED delta from S16 (total buffered=2)
[S2] RECEIVED delta(kind=head bytes=1804) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.933783)
[S2] loaded HEAD from S11 (vec_in norm=1.933783)
[S2] cosine check vs S11: cos=0.9979
[S2] BUFFERED delta from S11 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:54509
[S17] sending update (kind=head size=1803 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1803) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.731021)
[S8] loaded HEAD from S17 (vec_in norm=1.731021)
[S8] cosine check vs S17: cos=0.9903
[S8] BUFFERED delta from S17 (total buffered=1)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=24 metric=0.8779 head_norm=1.380885
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.363998e-01
[S3] stored merged vector for next round verification (round=24)
[S3] DEBUG after merge:  round=24 metric=0.9608 head_norm=1.017688 delta_norm=0.836400
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=24 metric=0.5943 head_norm=1.058918
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.115129e-01
[S13] stored merged vector for next round verification (round=24)
[S13] DEBUG after merge:  round=24 metric=0.5939 head_norm=1.025448 delta_norm=0.311513
[S13] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=24 metric=0.8478 head_norm=1.918317
[S2] _apply_head_vector_avg (torch): Δ‖w‖=6.301980e-02
[S2] stored merged vector for next round verification (round=24)
[S2] DEBUG after merge:  round=24 metric=0.8116 head_norm=1.925034 delta_norm=0.063020
[S2] aggregate: ROLLBACK (f1_val pre=0.848 post=0.812 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=24 metric=0.9864 head_norm=1.743666
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.209311e-01
[S8] stored merged vector for next round verification (round=24)
[S8] DEBUG after merge:  round=24 metric=0.9864 head_norm=1.733141 delta_norm=0.120931
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=24 metric=0.6312 head_norm=1.084372
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.552220e-01
[S7] stored merged vector for next round verification (round=24)
[S7] DEBUG after merge:  round=24 metric=0.6473 head_norm=1.010196 delta_norm=0.555222
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=24 metric=0.7005 head_norm=1.250466
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.010127e-01
[S5] stored merged vector for next round verification (round=24)
[S5] DEBUG after merge:  round=24 metric=0.7003 head_norm=0.926613 delta_norm=0.701013
[S5] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=24 metric=0.9972 head_norm=1.217240
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.011295e-01
[S14] stored merged vector for next round verification (round=24)
[S14] DEBUG after merge:  round=24 metric=0.9972 head_norm=1.144543 delta_norm=0.401130
[S14] aggregate: ACCEPT kept=['S4', 'S16'] (k=2/2) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.925034 cos_to_last_merge=1.0000 (last merge round=24)
[S2] round=25 local utility u=0.244381 metrics={'f1_val': 0.9101073801844756, 'auprc': 0.8832098393134006, 'loss_val': 0.2604708543730098, 'psi': 0.8993483638360456}-{'f1_val': 0.8478409116873578, 'auprc': 0.8543540620952415, 'loss_val': 0.2890670672716927, 'psi': 0.8504461718505112}
[S3] START round=25 head_norm_before_train=1.017688 cos_to_last_merge=1.0000 (last merge round=24)
[S3] round=25 local utility u=0.345628 metrics={'f1_val': 0.983004208656469, 'auprc': 0.99856167213018, 'loss_val': 0.16120984700027138, 'psi': 0.9892271940459534}-{'f1_val': 0.8779402810072126, 'auprc': 0.9995138007150639, 'loss_val': 0.22493921081599694, 'psi': 0.9265696888903531}
[S4] START round=25 head_norm_before_train=1.632892 cos_to_last_merge=0.8008 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.801
[S4] round=25 local utility u=0.036095 metrics={'f1_val': 0.9570603310896333, 'auprc': 0.9652030852699115, 'loss_val': 0.25087966948075757, 'psi': 0.9603174327617445}-{'f1_val': 0.9512202277959803, 'auprc': 0.9573992800981593, 'loss_val': 0.2646171163748227, 'psi': 0.953691848716852}
[S5] START round=25 head_norm_before_train=0.926613 cos_to_last_merge=1.0000 (last merge round=24)
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9841758620602434, 'loss_val': 0.48548492103334695, 'psi': 0.8138627039189128}-{'f1_val': 0.7004938661094564, 'auprc': 0.9896219718804871, 'loss_val': 0.29828146754836776, 'psi': 0.8161451084178687}
[S6] START round=25 head_norm_before_train=1.884356 cos_to_last_merge=0.9999 (last merge round=23)
[S6] round=25 local utility u=0.045062 metrics={'f1_val': 0.9621489368050182, 'auprc': 0.9630168447435334, 'loss_val': 0.24761239749209452, 'psi': 0.9624960999804244}-{'f1_val': 0.9537782822489855, 'auprc': 0.9575727470781111, 'loss_val': 0.2711801071166154, 'psi': 0.9552960681806357}
[S7] START round=25 head_norm_before_train=1.010196 cos_to_last_merge=1.0000 (last merge round=24)
[S7] round=25 local utility u=0.000000 metrics={'f1_val': 0.5971434050667395, 'auprc': 0.7914086910361897, 'loss_val': 0.7470708227298476, 'psi': 0.6748495194545197}-{'f1_val': 0.631160788341277, 'auprc': 0.8308249841164517, 'loss_val': 0.6443949350347152, 'psi': 0.7110264666513468}
[S8] START round=25 head_norm_before_train=1.733141 cos_to_last_merge=1.0000 (last merge round=24)
[S8] round=25 local utility u=0.014486 metrics={'f1_val': 0.9938130760262815, 'auprc': 0.9876398127193251, 'loss_val': 0.0768420722896766, 'psi': 0.9913437707034989}-{'f1_val': 0.9864258722700556, 'auprc': 0.9976711793409591, 'loss_val': 0.09158476217601483, 'psi': 0.990923995098417}
[S9] START round=25 head_norm_before_train=1.872973 cos_to_last_merge=0.8276 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.828
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.9910040044536889, 'auprc': 0.9988603805401622, 'loss_val': 0.029195438386459084, 'psi': 0.9941465548882782}-{'f1_val': 0.9971029125121428, 'auprc': 0.9952918120840017, 'loss_val': 0.02137093518141632, 'psi': 0.9963784723408864}
[S10] START round=25 head_norm_before_train=1.066018 cos_to_last_merge=0.9839 (last merge round=22)
[S10] round=25 local utility u=0.000000 metrics={'f1_val': 0.9556548173304513, 'auprc': 0.9908383875003949, 'loss_val': 0.33650326374670075, 'psi': 0.9697282453984288}-{'f1_val': 0.9916503035934691, 'auprc': 0.9907371708835828, 'loss_val': 0.36209167149600735, 'psi': 0.9912850505095145}
[S11] START round=25 head_norm_before_train=1.933783 (no previous merge yet)
[S11] round=25 local utility u=0.006220 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9982870265336703, 'loss_val': 0.08272920407061891, 'psi': 0.9972430133216219}-{'f1_val': 0.9962850284706224, 'auprc': 0.9981075872610448, 'loss_val': 0.09305977265887819, 'psi': 0.9970140519867914}
[S13] START round=25 head_norm_before_train=1.025448 cos_to_last_merge=1.0000 (last merge round=24)
[S13] round=25 local utility u=0.073117 metrics={'f1_val': 0.6252801286954148, 'auprc': 0.6609692603557465, 'loss_val': 0.7421082781541252, 'psi': 0.6395557813595475}-{'f1_val': 0.5943385856422803, 'auprc': 0.6833845440686684, 'loss_val': 0.7699382112746985, 'psi': 0.6299569690128355}
[S14] START round=25 head_norm_before_train=1.144543 cos_to_last_merge=1.0000 (last merge round=24)
[S14] round=25 local utility u=0.036547 metrics={'f1_val': 0.9972596085811116, 'auprc': 0.996912440175757, 'loss_val': 0.2415093997615124, 'psi': 0.9971207412189698}-{'f1_val': 0.997240356705793, 'auprc': 0.9969476262070289, 'loss_val': 0.31459249670174444, 'psi': 0.9971232645062874}
[S15] START round=25 head_norm_before_train=1.685001 cos_to_last_merge=0.8272 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.827
[S15] round=25 local utility u=0.707329 metrics={'f1_val': 0.9924102806709625, 'auprc': 0.98192225496998, 'loss_val': 0.07742480671508957, 'psi': 0.9882150703905694}-{'f1_val': 0.8180070555920214, 'auprc': 0.9228023044458191, 'loss_val': 0.26830357067356764, 'psi': 0.8599251551335405}
[S16] START round=25 head_norm_before_train=1.660173 cos_to_last_merge=0.8174 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.817
[S16] round=25 local utility u=0.000000 metrics={'f1_val': 0.9225479972585693, 'auprc': 0.9902760389011293, 'loss_val': 0.3505238886579657, 'psi': 0.9496392139155934}-{'f1_val': 0.9839470634084841, 'auprc': 0.99318137822093, 'loss_val': 0.09474250250890827, 'psi': 0.9876407893334624}
[S17] START round=25 head_norm_before_train=1.731021 (no previous merge yet)
[S17] round=25 local utility u=0.000000 metrics={'f1_val': 0.5800542484335818, 'auprc': 0.8088046247979265, 'loss_val': 0.780384807695941, 'psi': 0.6715543989793197}-{'f1_val': 0.5912774276308608, 'auprc': 0.7934171353328199, 'loss_val': 0.657152039809121, 'psi': 0.6721333107116445}
[S4] not sending this round → trigger blocked (psi=0.960)
[S11] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:54514
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:54514
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:54505
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:54507
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:54511
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:54508
[S13] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S6] sending update (kind=head size=1804 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1800) from S2
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.945379)
[S6] loaded HEAD from S2 (vec_in norm=1.945379)
[S6] cosine check vs S2: cos=0.9983
[S6] BUFFERED delta from S2 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1804) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.890533)
[S7] loaded HEAD from S6 (vec_in norm=1.890533)
[S7] cosine check vs S6: cos=0.4614
[S7] BUFFERED delta from S6 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1800) from S13
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.064556)
[S10] loaded HEAD from S13 (vec_in norm=1.064556)
[S10] cosine check vs S13: cos=0.6871
[S10] BUFFERED delta from S13 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1797) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.708227)
[S14] loaded HEAD from S15 (vec_in norm=1.708227)
[S14] cosine check vs S15: cos=0.5521
[S14] BUFFERED delta from S15 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1800) from S8
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.760719)
[S5] loaded HEAD from S8 (vec_in norm=1.760719)
[S5] cosine check vs S8: cos=0.6534
[S5] BUFFERED delta from S8 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1804) from S3
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.166684)
[S14] loaded HEAD from S3 (vec_in norm=1.166684)
[S14] cosine check vs S3: cos=0.4380
[S14] BUFFERED delta from S3 (total buffered=2)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=25 metric=0.5971 head_norm=1.057479
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.437072e-01
[S7] stored merged vector for next round verification (round=25)
[S7] DEBUG after merge:  round=25 metric=0.4542 head_norm=1.278416 delta_norm=0.843707
[S7] aggregate: ROLLBACK (f1_val pre=0.597 post=0.454 tol_abs=0.005 tol_rel=0.0)
[S7] ⇄ pheromone p=0.139 → S13@127.0.0.1:54513
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=25 metric=0.7003 head_norm=0.954204
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.736173e-01
[S5] stored merged vector for next round verification (round=25)
[S5] DEBUG after merge:  round=25 metric=0.7003 head_norm=1.245615 delta_norm=0.673617
[S5] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.146 → S3@127.0.0.1:54503
[S11] ⇄ pheromone p=0.127 → S2@127.0.0.1:54502
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=25 metric=0.9973 head_norm=1.191945
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.763991e-01
[S14] stored merged vector for next round verification (round=25)
[S14] DEBUG after merge:  round=25 metric=0.9975 head_norm=1.045736 delta_norm=0.476399
[S14] aggregate: ACCEPT kept=['S15', 'S3'] (k=2/2) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.091 → S7@127.0.0.1:54508
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=25 metric=0.9557 head_norm=1.112415
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.311315e-01
[S10] stored merged vector for next round verification (round=25)
[S10] DEBUG after merge:  round=25 metric=0.9299 head_norm=0.999750 delta_norm=0.431131
[S10] aggregate: ROLLBACK (f1_val pre=0.956 post=0.930 tol_abs=0.005 tol_rel=0.0)
[S10] ⇄ pheromone p=0.098 → S5@127.0.0.1:54505
[S4] ⇄ pheromone p=0.057 → S14@127.0.0.1:54514
[S9] ⇄ pheromone p=0.022 → S7@127.0.0.1:54508
[S2] ⇄ pheromone p=0.145 → S6@127.0.0.1:54507
[S8] ⇄ pheromone p=0.047 → S5@127.0.0.1:54505
[S13] ⇄ pheromone p=0.053 → S10@127.0.0.1:54511
[S3] ⇄ pheromone p=0.133 → S14@127.0.0.1:54514
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=25 metric=0.9621 head_norm=1.890533
[S6] _apply_head_vector_avg (torch): Δ‖w‖=6.223513e-02
[S6] stored merged vector for next round verification (round=25)
[S6] DEBUG after merge:  round=25 metric=0.9621 head_norm=1.917142 delta_norm=0.062235
[S6] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.116 → S7@127.0.0.1:54508
[S15] ⇄ pheromone p=0.308 → S14@127.0.0.1:54514
[S17] ⇄ pheromone p=0.159 → S8@127.0.0.1:54509
[S16] ⇄ pheromone p=0.172 → S14@127.0.0.1:54514
[S2] START round=26 head_norm_before_train=1.945379 cos_to_last_merge=0.9999 (last merge round=24)
[S2] round=26 local utility u=0.077211 metrics={'f1_val': 0.9140300396661072, 'auprc': 0.9139700510197051, 'loss_val': 0.22186635546198416, 'psi': 0.9140060442075464}-{'f1_val': 0.9101073801844756, 'auprc': 0.8832098393134006, 'loss_val': 0.2604708543730098, 'psi': 0.8993483638360456}
[S3] START round=26 head_norm_before_train=1.166684 cos_to_last_merge=0.9858 (last merge round=24)
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9990507101338244, 'loss_val': 0.13589634818520896, 'psi': 0.976265335293202}-{'f1_val': 0.983004208656469, 'auprc': 0.99856167213018, 'loss_val': 0.16120984700027138, 'psi': 0.9892271940459534}
[S4] START round=26 head_norm_before_train=1.653941 cos_to_last_merge=0.7989 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.799
[S4] round=26 local utility u=0.000000 metrics={'f1_val': 0.9414665870635487, 'auprc': 0.9393089410154762, 'loss_val': 0.28090621037751523, 'psi': 0.9406035286443197}-{'f1_val': 0.9570603310896333, 'auprc': 0.9652030852699115, 'loss_val': 0.25087966948075757, 'psi': 0.9603174327617445}
[S5] START round=26 head_norm_before_train=1.245615 cos_to_last_merge=1.0000 (last merge round=25)
[S5] round=26 local utility u=0.052254 metrics={'f1_val': 0.7004069097142683, 'auprc': 0.979812762030686, 'loss_val': 0.36840537071395874, 'psi': 0.8121692506408354}-{'f1_val': 0.700320598491359, 'auprc': 0.9841758620602434, 'loss_val': 0.48548492103334695, 'psi': 0.8138627039189128}
[S6] START round=26 head_norm_before_train=1.917142 cos_to_last_merge=1.0000 (last merge round=25)
[S6] round=26 local utility u=0.000000 metrics={'f1_val': 0.810116685506367, 'auprc': 0.9421500362087607, 'loss_val': 0.44192970926767183, 'psi': 0.8629300257873245}-{'f1_val': 0.9621489368050182, 'auprc': 0.9630168447435334, 'loss_val': 0.24761239749209452, 'psi': 0.9624960999804244}
[S7] START round=26 head_norm_before_train=1.278416 cos_to_last_merge=1.0000 (last merge round=25)
[S7] round=26 local utility u=0.000000 metrics={'f1_val': 0.5035490159545244, 'auprc': 0.7444501170258352, 'loss_val': 0.9565856196191385, 'psi': 0.5999094563830487}-{'f1_val': 0.5971434050667395, 'auprc': 0.7914086910361897, 'loss_val': 0.7470708227298476, 'psi': 0.6748495194545197}
[S8] START round=26 head_norm_before_train=1.760719 cos_to_last_merge=0.9997 (last merge round=24)
[S8] round=26 local utility u=0.000000 metrics={'f1_val': 0.9850095973589028, 'auprc': 0.9862065632373012, 'loss_val': 0.08229781448139178, 'psi': 0.9854883837102622}-{'f1_val': 0.9938130760262815, 'auprc': 0.9876398127193251, 'loss_val': 0.0768420722896766, 'psi': 0.9913437707034989}
[S9] START round=26 head_norm_before_train=1.887255 cos_to_last_merge=0.8262 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.826
[S9] round=26 local utility u=0.020080 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9967970110769018, 'loss_val': 0.01943937197100592, 'psi': 0.9969805519380464}-{'f1_val': 0.9910040044536889, 'auprc': 0.9988603805401622, 'loss_val': 0.029195438386459084, 'psi': 0.9941465548882782}
[S10] START round=26 head_norm_before_train=0.999750 cos_to_last_merge=1.0000 (last merge round=25)
[S10] round=26 local utility u=0.000000 metrics={'f1_val': 0.9129890369744909, 'auprc': 0.9918738221851979, 'loss_val': 0.481548218886563, 'psi': 0.9445429510587737}-{'f1_val': 0.9556548173304513, 'auprc': 0.9908383875003949, 'loss_val': 0.33650326374670075, 'psi': 0.9697282453984288}
[S11] START round=26 head_norm_before_train=1.957447 (no previous merge yet)
[S11] round=26 local utility u=0.000000 metrics={'f1_val': 0.9943851826643143, 'auprc': 0.9981826661129409, 'loss_val': 0.07879292146435453, 'psi': 0.995904176043765}-{'f1_val': 0.9965470045135896, 'auprc': 0.9982870265336703, 'loss_val': 0.08272920407061891, 'psi': 0.9972430133216219}
[S13] START round=26 head_norm_before_train=1.064556 cos_to_last_merge=0.9972 (last merge round=24)
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.6046568511851383, 'auprc': 0.6719531057261425, 'loss_val': 0.7508682960039558, 'psi': 0.63157535300154}-{'f1_val': 0.6252801286954148, 'auprc': 0.6609692603557465, 'loss_val': 0.7421082781541252, 'psi': 0.6395557813595475}
[S14] START round=26 head_norm_before_train=1.045736 cos_to_last_merge=1.0000 (last merge round=25)
[S14] round=26 local utility u=0.000000 metrics={'f1_val': 0.9972626935085508, 'auprc': 0.9969841197939799, 'loss_val': 0.2646786835177686, 'psi': 0.9971512640227225}-{'f1_val': 0.9972596085811116, 'auprc': 0.996912440175757, 'loss_val': 0.2415093997615124, 'psi': 0.9971207412189698}
[S15] START round=26 head_norm_before_train=1.708227 cos_to_last_merge=0.8247 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.825
[S15] round=26 local utility u=0.000000 metrics={'f1_val': 0.8087688201785856, 'auprc': 0.9370918877041725, 'loss_val': 0.27407680037688875, 'psi': 0.8600980471888204}-{'f1_val': 0.9924102806709625, 'auprc': 0.98192225496998, 'loss_val': 0.07742480671508957, 'psi': 0.9882150703905694}
[S16] START round=26 head_norm_before_train=1.676759 cos_to_last_merge=0.8160 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.816
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.8655999228093472, 'auprc': 0.9856259097833128, 'loss_val': 0.6130986144555094, 'psi': 0.9136103175989334}-{'f1_val': 0.9225479972585693, 'auprc': 0.9902760389011293, 'loss_val': 0.3505238886579657, 'psi': 0.9496392139155934}
[S17] START round=26 head_norm_before_train=1.765240 (no previous merge yet)
[S17] round=26 local utility u=0.299619 metrics={'f1_val': 0.5992504928839679, 'auprc': 0.92362794824012, 'loss_val': 0.6407934600821081, 'psi': 0.7290014750264286}-{'f1_val': 0.5800542484335818, 'auprc': 0.8088046247979265, 'loss_val': 0.780384807695941, 'psi': 0.6715543989793197}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] → sending delta(kind=head bytes=1805) to S3@127.0.0.1:54503
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.914)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:54508
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1805 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1802) from S9
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.903231)
[S7] loaded HEAD from S9 (vec_in norm=1.903231)
[S7] cosine check vs S9: cos=0.1310
[S7] BUFFERED delta from S9 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1805) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.285238)
[S3] loaded HEAD from S5 (vec_in norm=1.285238)
[S3] cosine check vs S5: cos=0.5825
[S3] BUFFERED delta from S5 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:54509
[S17] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.796950)
[S8] loaded HEAD from S17 (vec_in norm=1.796950)
[S8] cosine check vs S17: cos=0.9914
[S8] BUFFERED delta from S17 (total buffered=1)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=26 metric=0.5035 head_norm=1.306686
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.081474e+00
[S7] stored merged vector for next round verification (round=26)
[S7] DEBUG after merge:  round=26 metric=0.4274 head_norm=1.222813 delta_norm=1.081474
[S7] aggregate: ROLLBACK (f1_val pre=0.504 post=0.427 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=26 metric=0.9850 head_norm=1.789112
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.176897e-01
[S8] stored merged vector for next round verification (round=26)
[S8] DEBUG after merge:  round=26 metric=0.9861 head_norm=1.789169 delta_norm=0.117690
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=26 metric=0.9611 head_norm=1.334550
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.989049e-01
[S3] stored merged vector for next round verification (round=26)
[S3] DEBUG after merge:  round=26 metric=0.9610 head_norm=1.165223 delta_norm=0.598905
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.965350 cos_to_last_merge=0.9995 (last merge round=24)
[S2] round=27 local utility u=0.098497 metrics={'f1_val': 0.9078323280559775, 'auprc': 0.9798499865671091, 'loss_val': 0.18532508629506275, 'psi': 0.9366393914604301}-{'f1_val': 0.9140300396661072, 'auprc': 0.9139700510197051, 'loss_val': 0.22186635546198416, 'psi': 0.9140060442075464}
[S3] START round=27 head_norm_before_train=1.165223 cos_to_last_merge=1.0000 (last merge round=26)
[S3] round=27 local utility u=0.097370 metrics={'f1_val': 0.9970100543679847, 'auprc': 0.9980151644469771, 'loss_val': 0.15365868400359678, 'psi': 0.9974120983995818}-{'f1_val': 0.9610750853994537, 'auprc': 0.9990507101338244, 'loss_val': 0.13589634818520896, 'psi': 0.976265335293202}
[S4] START round=27 head_norm_before_train=1.672702 cos_to_last_merge=0.7971 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.797
[S4] round=27 local utility u=0.093986 metrics={'f1_val': 0.9505861833700391, 'auprc': 0.9760676342305088, 'loss_val': 0.2579282724412829, 'psi': 0.960778763714227}-{'f1_val': 0.9414665870635487, 'auprc': 0.9393089410154762, 'loss_val': 0.28090621037751523, 'psi': 0.9406035286443197}
[S5] START round=27 head_norm_before_train=1.285238 cos_to_last_merge=0.9982 (last merge round=25)
[S5] round=27 local utility u=0.000000 metrics={'f1_val': 0.6892711826716917, 'auprc': 0.9720015737605462, 'loss_val': 0.3152488997439653, 'psi': 0.8023633391072336}-{'f1_val': 0.7004069097142683, 'auprc': 0.979812762030686, 'loss_val': 0.36840537071395874, 'psi': 0.8121692506408354}
[S6] START round=27 head_norm_before_train=1.921203 cos_to_last_merge=1.0000 (last merge round=25)
[S6] round=27 local utility u=0.592601 metrics={'f1_val': 0.9625359487793973, 'auprc': 0.9581816193178405, 'loss_val': 0.219338448095527, 'psi': 0.9607942169947745}-{'f1_val': 0.810116685506367, 'auprc': 0.9421500362087607, 'loss_val': 0.44192970926767183, 'psi': 0.8629300257873245}
[S7] START round=27 head_norm_before_train=1.222813 cos_to_last_merge=1.0000 (last merge round=26)
[S7] round=27 local utility u=1.000000 metrics={'f1_val': 0.6745959296866111, 'auprc': 0.950240554742193, 'loss_val': 0.5427381842783385, 'psi': 0.784853779708844}-{'f1_val': 0.5035490159545244, 'auprc': 0.7444501170258352, 'loss_val': 0.9565856196191385, 'psi': 0.5999094563830487}
[S8] START round=27 head_norm_before_train=1.789169 cos_to_last_merge=1.0000 (last merge round=26)
[S8] round=27 local utility u=0.049373 metrics={'f1_val': 0.9925289693239863, 'auprc': 0.9980884458310517, 'loss_val': 0.0643137915397031, 'psi': 0.9947527599268124}-{'f1_val': 0.9850095973589028, 'auprc': 0.9862065632373012, 'loss_val': 0.08229781448139178, 'psi': 0.9854883837102622}
[S9] START round=27 head_norm_before_train=1.903231 cos_to_last_merge=0.8248 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.825
[S9] round=27 local utility u=0.000000 metrics={'f1_val': 0.9956054446615002, 'auprc': 0.9988529785543081, 'loss_val': 0.02086094110197326, 'psi': 0.9969044582186234}-{'f1_val': 0.9971029125121428, 'auprc': 0.9967970110769018, 'loss_val': 0.01943937197100592, 'psi': 0.9969805519380464}
[S10] START round=27 head_norm_before_train=1.041489 cos_to_last_merge=0.9971 (last merge round=25)
[S10] round=27 local utility u=0.307487 metrics={'f1_val': 0.9885651468366765, 'auprc': 0.9914502273286147, 'loss_val': 0.31875953435767274, 'psi': 0.9897191790334517}-{'f1_val': 0.9129890369744909, 'auprc': 0.9918738221851979, 'loss_val': 0.481548218886563, 'psi': 0.9445429510587737}
[S11] START round=27 head_norm_before_train=1.984340 (no previous merge yet)
[S11] round=27 local utility u=0.017688 metrics={'f1_val': 0.9965268648289654, 'auprc': 0.9981426171355339, 'loss_val': 0.056147420257994136, 'psi': 0.9971731657515928}-{'f1_val': 0.9943851826643143, 'auprc': 0.9981826661129409, 'loss_val': 0.07879292146435453, 'psi': 0.995904176043765}
[S13] START round=27 head_norm_before_train=1.108036 cos_to_last_merge=0.9904 (last merge round=24)
[S13] round=27 local utility u=0.011312 metrics={'f1_val': 0.6085032165636937, 'auprc': 0.6678471034893197, 'loss_val': 0.7390042630199853, 'psi': 0.6322407713339441}-{'f1_val': 0.6046568511851383, 'auprc': 0.6719531057261425, 'loss_val': 0.7508682960039558, 'psi': 0.63157535300154}
[S14] START round=27 head_norm_before_train=1.096083 cos_to_last_merge=0.9971 (last merge round=25)
[S14] round=27 local utility u=0.024950 metrics={'f1_val': 0.9953280742010686, 'auprc': 0.9954273871351411, 'loss_val': 0.1985000733649049, 'psi': 0.9953677993746977}-{'f1_val': 0.9972626935085508, 'auprc': 0.9969841197939799, 'loss_val': 0.2646786835177686, 'psi': 0.9971512640227225}
[S15] START round=27 head_norm_before_train=1.726205 cos_to_last_merge=0.8228 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.823
[S15] round=27 local utility u=0.716587 metrics={'f1_val': 0.9922924314523676, 'auprc': 0.9842928542006298, 'loss_val': 0.08364811578687915, 'psi': 0.9890926005516725}-{'f1_val': 0.8087688201785856, 'auprc': 0.9370918877041725, 'loss_val': 0.27407680037688875, 'psi': 0.8600980471888204}
[S16] START round=27 head_norm_before_train=1.691098 cos_to_last_merge=0.8151 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.815
[S16] round=27 local utility u=0.668241 metrics={'f1_val': 0.9912877561019581, 'auprc': 0.9924450364522848, 'loss_val': 0.05120187294081975, 'psi': 0.9917506682420887}-{'f1_val': 0.8655999228093472, 'auprc': 0.9856259097833128, 'loss_val': 0.6130986144555094, 'psi': 0.9136103175989334}
[S17] START round=27 head_norm_before_train=1.796950 (no previous merge yet)
[S17] round=27 local utility u=0.000000 metrics={'f1_val': 0.5867033855623688, 'auprc': 0.8453255500543306, 'loss_val': 0.6882568570547002, 'psi': 0.6901522513591536}-{'f1_val': 0.5992504928839679, 'auprc': 0.92362794824012, 'loss_val': 0.6407934600821081, 'psi': 0.7290014750264286}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] sending update (kind=head size=1793 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:54512
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:54507
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:54515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:54513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:54517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] sending update (kind=head size=1792 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:54502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:54508
[S8] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1799) from S10
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.101809)
[S13] loaded HEAD from S10 (vec_in norm=1.101809)
[S13] cosine check vs S10: cos=0.8864
[S13] BUFFERED delta from S10 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1797) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.154824)
[S15] loaded HEAD from S14 (vec_in norm=1.154824)
[S15] cosine check vs S14: cos=0.7219
[S15] BUFFERED delta from S14 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1803) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.248716)
[S6] loaded HEAD from S7 (vec_in norm=1.248716)
[S6] cosine check vs S7: cos=0.4949
[S6] BUFFERED delta from S7 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1801) from S3
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.294002)
[S5] loaded HEAD from S3 (vec_in norm=1.294002)
[S5] cosine check vs S3: cos=0.8030
[S5] BUFFERED delta from S3 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1800) from S2
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.983847)
[S11] loaded HEAD from S2 (vec_in norm=1.983847)
[S11] cosine check vs S2: cos=0.9964
[S11] BUFFERED delta from S2 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1802) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.816448)
[S17] loaded HEAD from S8 (vec_in norm=1.816448)
[S17] cosine check vs S8: cos=0.9958
[S17] BUFFERED delta from S8 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1802) from S6
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.926148)
[S2] loaded HEAD from S6 (vec_in norm=1.926148)
[S2] cosine check vs S6: cos=0.9989
[S2] BUFFERED delta from S6 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1801 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1801) from S13
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.150136)
[S7] loaded HEAD from S13 (vec_in norm=1.150136)
[S7] cosine check vs S13: cos=0.8450
[S7] BUFFERED delta from S13 (total buffered=1)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=27 metric=0.9965 head_norm=2.010516
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.559033e-02
[S11] stored merged vector for next round verification (round=27)
[S11] DEBUG after merge:  round=27 metric=0.9965 head_norm=1.995391 delta_norm=0.085590
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=27 metric=0.6893 head_norm=1.320769
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.105327e-01
[S5] stored merged vector for next round verification (round=27)
[S5] DEBUG after merge:  round=27 metric=0.6992 head_norm=1.241330 delta_norm=0.410533
[S5] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=27 metric=0.9625 head_norm=1.926148
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.498229e-01
[S6] stored merged vector for next round verification (round=27)
[S6] DEBUG after merge:  round=27 metric=0.9626 head_norm=1.382920 delta_norm=0.849823
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=27 metric=0.9078 head_norm=1.983847
[S2] _apply_head_vector_avg (torch): Δ‖w‖=5.496389e-02
[S2] stored merged vector for next round verification (round=27)
[S2] DEBUG after merge:  round=27 metric=0.9040 head_norm=1.954438 delta_norm=0.054964
[S2] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=27 metric=0.6746 head_norm=1.248716
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.372232e-01
[S7] stored merged vector for next round verification (round=27)
[S7] DEBUG after merge:  round=27 metric=0.6784 head_norm=1.152099 delta_norm=0.337223
[S7] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=27 metric=0.9923 head_norm=1.740839
[S15] _apply_head_vector_avg (torch): Δ‖w‖=6.044875e-01
[S15] stored merged vector for next round verification (round=27)
[S15] DEBUG after merge:  round=27 metric=0.9921 head_norm=1.347837 delta_norm=0.604488
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=27 metric=0.5867 head_norm=1.824918
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.315932e-02
[S17] stored merged vector for next round verification (round=27)
[S17] DEBUG after merge:  round=27 metric=0.5916 head_norm=1.818788 delta_norm=0.083159
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=27 metric=0.6085 head_norm=1.150136
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.694160e-01
[S13] stored merged vector for next round verification (round=27)
[S13] DEBUG after merge:  round=27 metric=0.6091 head_norm=1.093532 delta_norm=0.269416
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=1.954438 cos_to_last_merge=1.0000 (last merge round=27)
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.9134660648466977, 'auprc': 0.9602759486912524, 'loss_val': 0.17782590073930585, 'psi': 0.9321900183845195}-{'f1_val': 0.9078323280559775, 'auprc': 0.9798499865671091, 'loss_val': 0.18532508629506275, 'psi': 0.9366393914604301}
[S3] START round=28 head_norm_before_train=1.294002 cos_to_last_merge=0.9873 (last merge round=26)
[S3] round=28 local utility u=0.000000 metrics={'f1_val': 0.7366372758770294, 'auprc': 0.9976933332370069, 'loss_val': 0.3660934951157265, 'psi': 0.8410596988210204}-{'f1_val': 0.9970100543679847, 'auprc': 0.9980151644469771, 'loss_val': 0.15365868400359678, 'psi': 0.9974120983995818}
[S4] START round=28 head_norm_before_train=1.683278 cos_to_last_merge=0.7967 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.797
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.9415419508629898, 'auprc': 0.9301372382175612, 'loss_val': 0.28061683874328525, 'psi': 0.9369800658048183}-{'f1_val': 0.9505861833700391, 'auprc': 0.9760676342305088, 'loss_val': 0.2579282724412829, 'psi': 0.960778763714227}
[S5] START round=28 head_norm_before_train=1.241330 cos_to_last_merge=1.0000 (last merge round=27)
[S5] round=28 local utility u=0.000000 metrics={'f1_val': 0.44363539487483306, 'auprc': 0.7336433588458752, 'loss_val': 0.9434611941941112, 'psi': 0.5596385804632499}-{'f1_val': 0.6892711826716917, 'auprc': 0.9720015737605462, 'loss_val': 0.3152488997439653, 'psi': 0.8023633391072336}
[S6] START round=28 head_norm_before_train=1.382920 cos_to_last_merge=1.0000 (last merge round=27)
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.6712941772305784, 'auprc': 0.8144702023958544, 'loss_val': 0.4819909525152052, 'psi': 0.7285645872966888}-{'f1_val': 0.9625359487793973, 'auprc': 0.9581816193178405, 'loss_val': 0.219338448095527, 'psi': 0.9607942169947745}
[S7] START round=28 head_norm_before_train=1.152099 cos_to_last_merge=1.0000 (last merge round=27)
[S7] round=28 local utility u=0.058295 metrics={'f1_val': 0.6841762665634015, 'auprc': 0.9107347294068372, 'loss_val': 0.3651128500017347, 'psi': 0.7747996517007758}-{'f1_val': 0.6745959296866111, 'auprc': 0.950240554742193, 'loss_val': 0.5427381842783385, 'psi': 0.784853779708844}
[S8] START round=28 head_norm_before_train=1.816448 cos_to_last_merge=0.9997 (last merge round=26)
[S8] round=28 local utility u=0.007451 metrics={'f1_val': 0.9938130760262815, 'auprc': 0.9977382137201608, 'loss_val': 0.05606481631799636, 'psi': 0.9953831311038333}-{'f1_val': 0.9925289693239863, 'auprc': 0.9980884458310517, 'loss_val': 0.0643137915397031, 'psi': 0.9947527599268124}
[S9] START round=28 head_norm_before_train=1.918871 cos_to_last_merge=0.8236 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.824
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.9947734239942433, 'auprc': 0.9988526796223758, 'loss_val': 0.022304083363781983, 'psi': 0.9964051262454963}-{'f1_val': 0.9956054446615002, 'auprc': 0.9988529785543081, 'loss_val': 0.02086094110197326, 'psi': 0.9969044582186234}
[S10] START round=28 head_norm_before_train=1.101809 cos_to_last_merge=0.9875 (last merge round=25)
[S10] round=28 local utility u=0.040218 metrics={'f1_val': 0.9899177975778752, 'auprc': 0.9913238856218469, 'loss_val': 0.24606128699125207, 'psi': 0.9904802327954639}-{'f1_val': 0.9885651468366765, 'auprc': 0.9914502273286147, 'loss_val': 0.31875953435767274, 'psi': 0.9897191790334517}
[S11] START round=28 head_norm_before_train=1.995391 cos_to_last_merge=1.0000 (last merge round=27)
[S11] round=28 local utility u=0.002330 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9982907982639433, 'loss_val': 0.052053509609813475, 'psi': 0.997244522013731}-{'f1_val': 0.9965268648289654, 'auprc': 0.9981426171355339, 'loss_val': 0.056147420257994136, 'psi': 0.9971731657515928}
[S13] START round=28 head_norm_before_train=1.093532 cos_to_last_merge=1.0000 (last merge round=27)
[S13] round=28 local utility u=0.040952 metrics={'f1_val': 0.6161793128525297, 'auprc': 0.6678510487891054, 'loss_val': 0.7031694181752306, 'psi': 0.63684800722716}-{'f1_val': 0.6085032165636937, 'auprc': 0.6678471034893197, 'loss_val': 0.7390042630199853, 'psi': 0.6322407713339441}
[S14] START round=28 head_norm_before_train=1.154824 cos_to_last_merge=0.9895 (last merge round=25)
[S14] round=28 local utility u=0.035795 metrics={'f1_val': 0.9970427648353635, 'auprc': 0.9970775815701147, 'loss_val': 0.14214785191638496, 'psi': 0.997056691529264}-{'f1_val': 0.9953280742010686, 'auprc': 0.9954273871351411, 'loss_val': 0.1985000733649049, 'psi': 0.9953677993746977}
[S15] START round=28 head_norm_before_train=1.347837 cos_to_last_merge=1.0000 (last merge round=27)
[S15] round=28 local utility u=0.000000 metrics={'f1_val': 0.9714860073061917, 'auprc': 0.9785345505015371, 'loss_val': 0.20012327295543247, 'psi': 0.9743054245843299}-{'f1_val': 0.9922924314523676, 'auprc': 0.9842928542006298, 'loss_val': 0.08364811578687915, 'psi': 0.9890926005516725}
[S16] START round=28 head_norm_before_train=1.705361 cos_to_last_merge=0.8144 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.814
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.8342378638462359, 'auprc': 0.8572738570486447, 'loss_val': 0.9817060917207465, 'psi': 0.8434522611271995}-{'f1_val': 0.9912877561019581, 'auprc': 0.9924450364522848, 'loss_val': 0.05120187294081975, 'psi': 0.9917506682420887}
[S17] START round=28 head_norm_before_train=1.818788 cos_to_last_merge=1.0000 (last merge round=27)
[S17] round=28 local utility u=0.000000 metrics={'f1_val': 0.5919769773940907, 'auprc': 0.8213192806156626, 'loss_val': 0.8548899378112216, 'psi': 0.6837138986827196}-{'f1_val': 0.5867033855623688, 'auprc': 0.8453255500543306, 'loss_val': 0.6882568570547002, 'psi': 0.6901522513591536}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:54515
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S13@127.0.0.1:54513
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:54517
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:54507
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1799) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.202749)
[S15] loaded HEAD from S14 (vec_in norm=1.202749)
[S15] cosine check vs S14: cos=0.8810
[S15] BUFFERED delta from S14 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1794) from S10
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.164581)
[S13] loaded HEAD from S10 (vec_in norm=1.164581)
[S13] cosine check vs S10: cos=0.9552
[S13] BUFFERED delta from S10 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1800) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.189914)
[S6] loaded HEAD from S7 (vec_in norm=1.189914)
[S6] cosine check vs S7: cos=0.8198
[S6] BUFFERED delta from S7 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1798) from S13
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.133908)
[S7] loaded HEAD from S13 (vec_in norm=1.133908)
[S7] cosine check vs S13: cos=0.9145
[S7] BUFFERED delta from S13 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1800) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.841611)
[S17] loaded HEAD from S8 (vec_in norm=1.841611)
[S17] cosine check vs S8: cos=0.9974
[S17] BUFFERED delta from S8 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=28 metric=0.6713 head_norm=1.396183
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.003546e-01
[S6] stored merged vector for next round verification (round=28)
[S6] DEBUG after merge:  round=28 metric=0.6567 head_norm=1.233826 delta_norm=0.400355
[S6] aggregate: ROLLBACK (f1_val pre=0.671 post=0.657 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=28 metric=0.9715 head_norm=1.365460
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.229674e-01
[S15] stored merged vector for next round verification (round=28)
[S15] DEBUG after merge:  round=28 metric=0.9710 head_norm=1.245486 delta_norm=0.322967
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=28 metric=0.6842 head_norm=1.189914
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.417368e-01
[S7] stored merged vector for next round verification (round=28)
[S7] DEBUG after merge:  round=28 metric=0.6847 head_norm=1.136831 delta_norm=0.241737
[S7] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=28 metric=0.6162 head_norm=1.133908
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.727247e-01
[S13] stored merged vector for next round verification (round=28)
[S13] DEBUG after merge:  round=28 metric=0.6184 head_norm=1.136294 delta_norm=0.172725
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=28 metric=0.5920 head_norm=1.848205
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.608279e-02
[S17] stored merged vector for next round verification (round=28)
[S17] DEBUG after merge:  round=28 metric=0.5927 head_norm=1.843727 delta_norm=0.066083
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=1.972966 cos_to_last_merge=0.9999 (last merge round=27)
[S2] round=29 local utility u=0.000000 metrics={'f1_val': 0.887580453022291, 'auprc': 0.9836963681610464, 'loss_val': 0.19686628987752594, 'psi': 0.9260268190777932}-{'f1_val': 0.9134660648466977, 'auprc': 0.9602759486912524, 'loss_val': 0.17782590073930585, 'psi': 0.9321900183845195}
[S3] START round=29 head_norm_before_train=1.426442 cos_to_last_merge=0.9651 (last merge round=26)
[S3] round=29 local utility u=0.776565 metrics={'f1_val': 0.960365708577172, 'auprc': 0.9972871170360117, 'loss_val': 0.15411454866579108, 'psi': 0.9751342719607079}-{'f1_val': 0.7366372758770294, 'auprc': 0.9976933332370069, 'loss_val': 0.3660934951157265, 'psi': 0.8410596988210204}
[S4] START round=29 head_norm_before_train=1.692556 cos_to_last_merge=0.7963 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.796
[S4] round=29 local utility u=0.098674 metrics={'f1_val': 0.9538633881004086, 'auprc': 0.9644579202268646, 'loss_val': 0.2601599571189369, 'psi': 0.958101200950991}-{'f1_val': 0.9415419508629898, 'auprc': 0.9301372382175612, 'loss_val': 0.28061683874328525, 'psi': 0.9369800658048183}
[S5] START round=29 head_norm_before_train=1.272071 cos_to_last_merge=0.9992 (last merge round=27)
[S5] round=29 local utility u=1.000000 metrics={'f1_val': 0.7005802511973405, 'auprc': 0.988692045811396, 'loss_val': 0.30142977493014167, 'psi': 0.8158249690429626}-{'f1_val': 0.44363539487483306, 'auprc': 0.7336433588458752, 'loss_val': 0.9434611941941112, 'psi': 0.5596385804632499}
[S6] START round=29 head_norm_before_train=1.233826 cos_to_last_merge=1.0000 (last merge round=28)
[S6] round=29 local utility u=1.000000 metrics={'f1_val': 0.9615526733872889, 'auprc': 0.9559715617197224, 'loss_val': 0.4597903293989439, 'psi': 0.9593202287202622}-{'f1_val': 0.6712941772305784, 'auprc': 0.8144702023958544, 'loss_val': 0.4819909525152052, 'psi': 0.7285645872966888}
[S7] START round=29 head_norm_before_train=1.136831 cos_to_last_merge=1.0000 (last merge round=28)
[S7] round=29 local utility u=0.000000 metrics={'f1_val': 0.6343489773930719, 'auprc': 0.8174267653382055, 'loss_val': 0.5349494654933238, 'psi': 0.7075800925711253}-{'f1_val': 0.6841762665634015, 'auprc': 0.9107347294068372, 'loss_val': 0.3651128500017347, 'psi': 0.7747996517007758}
[S8] START round=29 head_norm_before_train=1.841611 cos_to_last_merge=0.9991 (last merge round=26)
[S8] round=29 local utility u=0.000000 metrics={'f1_val': 0.992174240363445, 'auprc': 0.9986044585521627, 'loss_val': 0.0548498672068516, 'psi': 0.9947463276389321}-{'f1_val': 0.9938130760262815, 'auprc': 0.9977382137201608, 'loss_val': 0.05606481631799636, 'psi': 0.9953831311038333}
[S9] START round=29 head_norm_before_train=1.933603 cos_to_last_merge=0.8223 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.822
[S9] round=29 local utility u=0.000824 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9938617030729839, 'loss_val': 0.01965936548455256, 'psi': 0.9958064287364793}-{'f1_val': 0.9947734239942433, 'auprc': 0.9988526796223758, 'loss_val': 0.022304083363781983, 'psi': 0.9964051262454963}
[S10] START round=29 head_norm_before_train=1.164581 cos_to_last_merge=0.9749 (last merge round=25)
[S10] round=29 local utility u=0.000000 metrics={'f1_val': 0.9268302929320147, 'auprc': 0.9909181765373071, 'loss_val': 0.26864250531758904, 'psi': 0.9524654463741317}-{'f1_val': 0.9899177975778752, 'auprc': 0.9913238856218469, 'loss_val': 0.24606128699125207, 'psi': 0.9904802327954639}
[S11] START round=29 head_norm_before_train=2.019090 cos_to_last_merge=0.9999 (last merge round=27)
[S11] round=29 local utility u=0.002760 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.998281874463816, 'loss_val': 0.04650670095627118, 'psi': 0.9972409524936802}-{'f1_val': 0.9965470045135896, 'auprc': 0.9982907982639433, 'loss_val': 0.052053509609813475, 'psi': 0.997244522013731}
[S13] START round=29 head_norm_before_train=1.136294 cos_to_last_merge=1.0000 (last merge round=28)
[S13] round=29 local utility u=0.000000 metrics={'f1_val': 0.6069110717813765, 'auprc': 0.6646715156584478, 'loss_val': 0.6758570583817125, 'psi': 0.6300152493322051}-{'f1_val': 0.6161793128525297, 'auprc': 0.6678510487891054, 'loss_val': 0.7031694181752306, 'psi': 0.63684800722716}
[S14] START round=29 head_norm_before_train=1.202749 cos_to_last_merge=0.9820 (last merge round=25)
[S14] round=29 local utility u=0.014276 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9965434923575603, 'loss_val': 0.11317962656621924, 'psi': 0.9969616109665}-{'f1_val': 0.9970427648353635, 'auprc': 0.9970775815701147, 'loss_val': 0.14214785191638496, 'psi': 0.997056691529264}
[S15] START round=29 head_norm_before_train=1.245486 cos_to_last_merge=1.0000 (last merge round=28)
[S15] round=29 local utility u=0.000000 metrics={'f1_val': 0.7619975475810854, 'auprc': 0.9461825060929178, 'loss_val': 0.3293488997587649, 'psi': 0.8356715309858184}-{'f1_val': 0.9714860073061917, 'auprc': 0.9785345505015371, 'loss_val': 0.20012327295543247, 'psi': 0.9743054245843299}
[S16] START round=29 head_norm_before_train=1.715048 cos_to_last_merge=0.8138 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.814
[S16] round=29 local utility u=0.250771 metrics={'f1_val': 0.8556486664280759, 'auprc': 0.9062318461379488, 'loss_val': 0.7555025601856896, 'psi': 0.8758819383120251}-{'f1_val': 0.8342378638462359, 'auprc': 0.8572738570486447, 'loss_val': 0.9817060917207465, 'psi': 0.8434522611271995}
[S17] START round=29 head_norm_before_train=1.843727 cos_to_last_merge=1.0000 (last merge round=28)
[S17] round=29 local utility u=0.701360 metrics={'f1_val': 0.691798563383695, 'auprc': 0.9965022232332985, 'loss_val': 0.5766484518523443, 'psi': 0.8136800273235365}-{'f1_val': 0.5919769773940907, 'auprc': 0.8213192806156626, 'loss_val': 0.8548899378112216, 'psi': 0.6837138986827196}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] sending update (kind=head size=1793 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] sending update (kind=head size=1804 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:54511
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:54502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:54515
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1795) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.249214)
[S15] loaded HEAD from S14 (vec_in norm=1.249214)
[S15] cosine check vs S14: cos=0.9545
[S15] BUFFERED delta from S14 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1795) from S3
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.513869)
[S5] loaded HEAD from S3 (vec_in norm=1.513869)
[S5] cosine check vs S3: cos=0.8783
[S5] BUFFERED delta from S3 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1797) from S6
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.255684)
[S2] loaded HEAD from S6 (vec_in norm=1.255684)
[S2] cosine check vs S6: cos=0.8001
[S2] BUFFERED delta from S6 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1797) from S5
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.296733)
[S10] loaded HEAD from S5 (vec_in norm=1.296733)
[S10] cosine check vs S5: cos=0.3604
[S10] BUFFERED delta from S5 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=29 metric=0.7620 head_norm=1.281065
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.915049e-01
[S15] stored merged vector for next round verification (round=29)
[S15] DEBUG after merge:  round=29 metric=0.7763 head_norm=1.250663 delta_norm=0.191505
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=29 metric=0.9268 head_norm=1.222002
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.128452e-01
[S10] stored merged vector for next round verification (round=29)
[S10] DEBUG after merge:  round=29 metric=0.9325 head_norm=1.038871 delta_norm=0.712845
[S10] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=29 metric=0.8876 head_norm=1.990489
[S2] _apply_head_vector_avg (torch): Δ‖w‖=6.203587e-01
[S2] stored merged vector for next round verification (round=29)
[S2] DEBUG after merge:  round=29 metric=0.8743 head_norm=1.544198 delta_norm=0.620359
[S2] aggregate: ROLLBACK (f1_val pre=0.888 post=0.874 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=29 metric=0.7006 head_norm=1.296733
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.622770e-01
[S5] stored merged vector for next round verification (round=29)
[S5] DEBUG after merge:  round=29 metric=0.7006 head_norm=1.362135 delta_norm=0.362277
[S5] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=1.544198 cos_to_last_merge=1.0000 (last merge round=29)
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.8276379325679459, 'auprc': 0.9919914755522354, 'loss_val': 0.2840039728947275, 'psi': 0.8933793497616618}-{'f1_val': 0.887580453022291, 'auprc': 0.9836963681610464, 'loss_val': 0.19686628987752594, 'psi': 0.9260268190777932}
[S3] START round=30 head_norm_before_train=1.513869 cos_to_last_merge=0.9506 (last merge round=26)
[S3] round=30 local utility u=0.081235 metrics={'f1_val': 0.9761348984903176, 'auprc': 0.9974541680922325, 'loss_val': 0.0867612518362017, 'psi': 0.9846626063310837}-{'f1_val': 0.960365708577172, 'auprc': 0.9972871170360117, 'loss_val': 0.15411454866579108, 'psi': 0.9751342719607079}
[S4] START round=30 head_norm_before_train=1.704838 cos_to_last_merge=0.7956 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.796
[S4] round=30 local utility u=0.000000 metrics={'f1_val': 0.9470152088529618, 'auprc': 0.9434494627857117, 'loss_val': 0.27704459205958754, 'psi': 0.9455889104260617}-{'f1_val': 0.9538633881004086, 'auprc': 0.9644579202268646, 'loss_val': 0.2601599571189369, 'psi': 0.958101200950991}
[S5] START round=30 head_norm_before_train=1.362135 cos_to_last_merge=1.0000 (last merge round=29)
[S5] round=30 local utility u=0.000000 metrics={'f1_val': 0.7004932948021524, 'auprc': 0.9832777024846195, 'loss_val': 0.3788811993085772, 'psi': 0.8136070578751393}-{'f1_val': 0.7005802511973405, 'auprc': 0.988692045811396, 'loss_val': 0.30142977493014167, 'psi': 0.8158249690429626}
[S6] START round=30 head_norm_before_train=1.255684 cos_to_last_merge=0.9991 (last merge round=28)
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.9440066081149721, 'auprc': 0.9568614441984182, 'loss_val': 0.42487159942161995, 'psi': 0.9491485425483506}-{'f1_val': 0.9615526733872889, 'auprc': 0.9559715617197224, 'loss_val': 0.4597903293989439, 'psi': 0.9593202287202622}
[S7] START round=30 head_norm_before_train=1.165354 cos_to_last_merge=0.9994 (last merge round=28)
[S7] round=30 local utility u=0.000000 metrics={'f1_val': 0.4924646809414021, 'auprc': 0.7826195956415972, 'loss_val': 0.7943724977225062, 'psi': 0.6085266468214802}-{'f1_val': 0.6343489773930719, 'auprc': 0.8174267653382055, 'loss_val': 0.5349494654933238, 'psi': 0.7075800925711253}
[S8] START round=30 head_norm_before_train=1.862717 cos_to_last_merge=0.9984 (last merge round=26)
[S8] round=30 local utility u=0.002737 metrics={'f1_val': 0.992174240363445, 'auprc': 0.998481253013929, 'loss_val': 0.04900669686666912, 'psi': 0.9946970454236386}-{'f1_val': 0.992174240363445, 'auprc': 0.9986044585521627, 'loss_val': 0.0548498672068516, 'psi': 0.9947463276389321}
[S9] START round=30 head_norm_before_train=1.946791 cos_to_last_merge=0.8213 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.821
[S9] round=30 local utility u=0.004148 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9962179058999732, 'loss_val': 0.018431446959688565, 'psi': 0.9967489098672749}-{'f1_val': 0.9971029125121428, 'auprc': 0.9938617030729839, 'loss_val': 0.01965936548455256, 'psi': 0.9958064287364793}
[S10] START round=30 head_norm_before_train=1.038871 cos_to_last_merge=1.0000 (last merge round=29)
[S10] round=30 local utility u=0.000000 metrics={'f1_val': 0.7951142473253183, 'auprc': 0.9414658392217384, 'loss_val': 0.5396674712302767, 'psi': 0.8536548840838863}-{'f1_val': 0.9268302929320147, 'auprc': 0.9909181765373071, 'loss_val': 0.26864250531758904, 'psi': 0.9524654463741317}
[S11] START round=30 head_norm_before_train=2.042568 cos_to_last_merge=0.9996 (last merge round=27)
[S11] round=30 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9982816582250809, 'loss_val': 0.044556164957803, 'psi': 0.9969928682380179}-{'f1_val': 0.9965470045135896, 'auprc': 0.998281874463816, 'loss_val': 0.04650670095627118, 'psi': 0.9972409524936802}
[S13] START round=30 head_norm_before_train=1.166872 cos_to_last_merge=0.9995 (last merge round=28)
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.6091318984343812, 'auprc': 0.6784610006638702, 'loss_val': 0.7524615736716574, 'psi': 0.6368635393261768}-{'f1_val': 0.6069110717813765, 'auprc': 0.6646715156584478, 'loss_val': 0.6758570583817125, 'psi': 0.6300152493322051}
[S14] START round=30 head_norm_before_train=1.249214 cos_to_last_merge=0.9750 (last merge round=25)
[S14] round=30 local utility u=0.011396 metrics={'f1_val': 0.9970728011695729, 'auprc': 0.9970746627517866, 'loss_val': 0.09097669778023457, 'psi': 0.9970735458024584}-{'f1_val': 0.997240356705793, 'auprc': 0.9965434923575603, 'loss_val': 0.11317962656621924, 'psi': 0.9969616109665}
[S15] START round=30 head_norm_before_train=1.250663 cos_to_last_merge=1.0000 (last merge round=29)
[S15] round=30 local utility u=0.138836 metrics={'f1_val': 0.7767229452469513, 'auprc': 0.9912911867365486, 'loss_val': 0.27535579399090915, 'psi': 0.8625502418427902}-{'f1_val': 0.7619975475810854, 'auprc': 0.9461825060929178, 'loss_val': 0.3293488997587649, 'psi': 0.8356715309858184}
[S16] START round=30 head_norm_before_train=1.724964 cos_to_last_merge=0.8129 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.813
[S16] round=30 local utility u=0.881600 metrics={'f1_val': 0.9898462402445655, 'auprc': 0.992539246209761, 'loss_val': 0.05640933782440941, 'psi': 0.9909234426306437}-{'f1_val': 0.8556486664280759, 'auprc': 0.9062318461379488, 'loss_val': 0.7555025601856896, 'psi': 0.8758819383120251}
[S17] START round=30 head_norm_before_train=1.869115 cos_to_last_merge=0.9998 (last merge round=28)
[S17] round=30 local utility u=0.000000 metrics={'f1_val': 0.5939191608069088, 'auprc': 0.8286592308198907, 'loss_val': 0.9602389445927816, 'psi': 0.6878151888121016}-{'f1_val': 0.691798563383695, 'auprc': 0.9965022232332985, 'loss_val': 0.5766484518523443, 'psi': 0.8136800273235365}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S3] → sending delta(kind=head bytes=1806) to S5@127.0.0.1:54505
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:54517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] sending update (kind=head size=1804 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:54515
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1793 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1806 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1806) from S3
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.574031)
[S5] loaded HEAD from S3 (vec_in norm=1.574031)
[S5] cosine check vs S3: cos=0.9631
[S5] BUFFERED delta from S3 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1799) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.883134)
[S17] loaded HEAD from S8 (vec_in norm=1.883134)
[S17] cosine check vs S8: cos=0.9973
[S17] BUFFERED delta from S8 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1793) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.293161)
[S15] loaded HEAD from S14 (vec_in norm=1.293161)
[S15] cosine check vs S14: cos=0.9785
[S15] BUFFERED delta from S14 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] ⇄ pheromone p=0.024 → S7@127.0.0.1:54508
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=30 metric=0.7005 head_norm=1.381556
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.221709e-01
[S5] stored merged vector for next round verification (round=30)
[S5] DEBUG after merge:  round=30 metric=0.7005 head_norm=1.464164 delta_norm=0.222171
[S5] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.212 → S10@127.0.0.1:54511
[S7] ⇄ pheromone p=0.155 → S6@127.0.0.1:54507
[S2] ⇄ pheromone p=0.064 → S11@127.0.0.1:54512
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=30 metric=0.7767 head_norm=1.296435
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.341117e-01
[S15] stored merged vector for next round verification (round=30)
[S15] DEBUG after merge:  round=30 metric=0.7884 head_norm=1.287835 delta_norm=0.134112
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.069 → S13@127.0.0.1:54513
[S6] ⇄ pheromone p=0.259 → S2@127.0.0.1:54502
[S3] ⇄ pheromone p=0.194 → S5@127.0.0.1:54505
[S8] ⇄ pheromone p=0.022 → S17@127.0.0.1:54517
[S14] ⇄ pheromone p=0.042 → S15@127.0.0.1:54515
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=30 metric=0.5939 head_norm=1.888208
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.914333e-02
[S17] stored merged vector for next round verification (round=30)
[S17] DEBUG after merge:  round=30 metric=0.5947 head_norm=1.884404 delta_norm=0.069143
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=31 head_norm_before_train=1.563125 cos_to_last_merge=0.9999 (last merge round=29)
[S2] round=31 local utility u=0.000000 metrics={'f1_val': 0.6280506972017602, 'auprc': 0.8521842552025644, 'loss_val': 0.426787480784309, 'psi': 0.7177041204020819}-{'f1_val': 0.8276379325679459, 'auprc': 0.9919914755522354, 'loss_val': 0.2840039728947275, 'psi': 0.8933793497616618}
[S3] START round=31 head_norm_before_train=1.574031 cos_to_last_merge=0.9414 (last merge round=26)
[S3] ⚠️ Model drifted since last merge! cos=0.941
[S3] round=31 local utility u=0.000000 metrics={'f1_val': 0.9568210347071022, 'auprc': 0.9984398084464144, 'loss_val': 0.10758023739636749, 'psi': 0.973468544202827}-{'f1_val': 0.9761348984903176, 'auprc': 0.9974541680922325, 'loss_val': 0.0867612518362017, 'psi': 0.9846626063310837}
[S4] START round=31 head_norm_before_train=1.717563 cos_to_last_merge=0.7946 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.795
[S4] round=31 local utility u=0.000000 metrics={'f1_val': 0.9403455161985083, 'auprc': 0.9289153804932615, 'loss_val': 0.28497783267804117, 'psi': 0.9357734619164095}-{'f1_val': 0.9470152088529618, 'auprc': 0.9434494627857117, 'loss_val': 0.27704459205958754, 'psi': 0.9455889104260617}
[S5] START round=31 head_norm_before_train=1.464164 cos_to_last_merge=1.0000 (last merge round=30)
[S5] round=31 local utility u=0.000000 metrics={'f1_val': 0.5981999844040267, 'auprc': 0.7441628677162082, 'loss_val': 0.6579650610069275, 'psi': 0.6565851377288993}-{'f1_val': 0.7004932948021524, 'auprc': 0.9832777024846195, 'loss_val': 0.3788811993085772, 'psi': 0.8136070578751393}
[S6] START round=31 head_norm_before_train=1.282555 cos_to_last_merge=0.9965 (last merge round=28)
[S6] round=31 local utility u=0.000000 metrics={'f1_val': 0.8251513026356914, 'auprc': 0.9543538502809126, 'loss_val': 0.414192188986808, 'psi': 0.8768323216937799}-{'f1_val': 0.9440066081149721, 'auprc': 0.9568614441984182, 'loss_val': 0.42487159942161995, 'psi': 0.9491485425483506}
[S7] START round=31 head_norm_before_train=1.190337 cos_to_last_merge=0.9982 (last merge round=28)
[S7] round=31 local utility u=0.000000 metrics={'f1_val': 0.4426062016086103, 'auprc': 0.7812857621532308, 'loss_val': 0.8153857325118709, 'psi': 0.5780780258264585}-{'f1_val': 0.4924646809414021, 'auprc': 0.7826195956415972, 'loss_val': 0.7943724977225062, 'psi': 0.6085266468214802}
[S8] START round=31 head_norm_before_train=1.883134 cos_to_last_merge=0.9977 (last merge round=26)
[S8] round=31 local utility u=0.000349 metrics={'f1_val': 0.9934464462379313, 'auprc': 0.9950578447658254, 'loss_val': 0.045671763662574624, 'psi': 0.9940910056490889}-{'f1_val': 0.992174240363445, 'auprc': 0.998481253013929, 'loss_val': 0.04900669686666912, 'psi': 0.9946970454236386}
[S9] START round=31 head_norm_before_train=1.960535 cos_to_last_merge=0.8202 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.820
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.9901493298847097, 'auprc': 0.9986572965295824, 'loss_val': 0.03659859818375014, 'psi': 0.9935525165426589}-{'f1_val': 0.9971029125121428, 'auprc': 0.9962179058999732, 'loss_val': 0.018431446959688565, 'psi': 0.9967489098672749}
[S10] START round=31 head_norm_before_train=1.088292 cos_to_last_merge=0.9978 (last merge round=29)
[S10] round=31 local utility u=0.796479 metrics={'f1_val': 0.9878426793094987, 'auprc': 0.9931524949537494, 'loss_val': 0.25813916061889147, 'psi': 0.989966605567199}-{'f1_val': 0.7951142473253183, 'auprc': 0.9414658392217384, 'loss_val': 0.5396674712302767, 'psi': 0.8536548840838863}
[S11] START round=31 head_norm_before_train=2.064978 cos_to_last_merge=0.9993 (last merge round=27)
[S11] round=31 local utility u=0.000000 metrics={'f1_val': 0.914281084139212, 'auprc': 0.9966500107686906, 'loss_val': 0.14747903718693076, 'psi': 0.9472286547910035}-{'f1_val': 0.9961336749133093, 'auprc': 0.9982816582250809, 'loss_val': 0.044556164957803, 'psi': 0.9969928682380179}
[S13] START round=31 head_norm_before_train=1.190095 cos_to_last_merge=0.9986 (last merge round=28)
[S13] round=31 local utility u=0.063672 metrics={'f1_val': 0.6248278402217515, 'auprc': 0.6682455803379889, 'loss_val': 0.6886477221886488, 'psi': 0.6421949362682464}-{'f1_val': 0.6091318984343812, 'auprc': 0.6784610006638702, 'loss_val': 0.7524615736716574, 'psi': 0.6368635393261768}
[S14] START round=31 head_norm_before_train=1.293161 cos_to_last_merge=0.9686 (last merge round=25)
[S14] round=31 local utility u=0.007922 metrics={'f1_val': 0.9970728011695729, 'auprc': 0.998557476871105, 'loss_val': 0.07958133208503897, 'psi': 0.9976666714501857}-{'f1_val': 0.9970728011695729, 'auprc': 0.9970746627517866, 'loss_val': 0.09097669778023457, 'psi': 0.9970735458024584}
[S15] START round=31 head_norm_before_train=1.287835 cos_to_last_merge=1.0000 (last merge round=30)
[S15] round=31 local utility u=0.000000 metrics={'f1_val': 0.7611789882478575, 'auprc': 0.9415899208696143, 'loss_val': 0.3348411044146826, 'psi': 0.8333433612965602}-{'f1_val': 0.7767229452469513, 'auprc': 0.9912911867365486, 'loss_val': 0.27535579399090915, 'psi': 0.8625502418427902}
[S16] START round=31 head_norm_before_train=1.737174 cos_to_last_merge=0.8121 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.812
[S16] round=31 local utility u=0.013591 metrics={'f1_val': 0.9918090767234037, 'auprc': 0.9937794914589686, 'loss_val': 0.04472446797264385, 'psi': 0.9925972426176297}-{'f1_val': 0.9898462402445655, 'auprc': 0.992539246209761, 'loss_val': 0.05640933782440941, 'psi': 0.9909234426306437}
[S17] START round=31 head_norm_before_train=1.884404 cos_to_last_merge=1.0000 (last merge round=30)
[S17] round=31 local utility u=0.000000 metrics={'f1_val': 0.4304233635167336, 'auprc': 0.6581738670139694, 'loss_val': 1.3995197754175435, 'psi': 0.521523564915628}-{'f1_val': 0.5939191608069088, 'auprc': 0.8286592308198907, 'loss_val': 0.9602389445927816, 'psi': 0.6878151888121016}
[S2]  timeout peer S3
[S3]  timeout peer S2
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:54517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:54508
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:54515
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:54505
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1798) from S13
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.207862)
[S7] loaded HEAD from S13 (vec_in norm=1.207862)
[S7] cosine check vs S13: cos=0.9366
[S7] BUFFERED delta from S13 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1800) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.135206)
[S5] loaded HEAD from S10 (vec_in norm=1.135206)
[S5] cosine check vs S10: cos=0.7789
[S5] BUFFERED delta from S10 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1801) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.898007)
[S17] loaded HEAD from S8 (vec_in norm=1.898007)
[S17] cosine check vs S8: cos=0.9989
[S17] BUFFERED delta from S8 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1796) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.328155)
[S15] loaded HEAD from S14 (vec_in norm=1.328155)
[S15] cosine check vs S14: cos=0.9865
[S15] BUFFERED delta from S14 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=31 metric=0.7612 head_norm=1.338096
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.096537e-01
[S15] stored merged vector for next round verification (round=31)
[S15] DEBUG after merge:  round=31 metric=0.7717 head_norm=1.328618 delta_norm=0.109654
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=31 metric=0.4426 head_norm=1.207583
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.149877e-01
[S7] stored merged vector for next round verification (round=31)
[S7] DEBUG after merge:  round=31 metric=0.4501 head_norm=1.188433 delta_norm=0.214988
[S7] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=31 metric=0.5982 head_norm=1.480423
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.643341e-01
[S5] stored merged vector for next round verification (round=31)
[S5] DEBUG after merge:  round=31 metric=0.6050 head_norm=1.234733 delta_norm=0.464334
[S5] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=31 metric=0.4304 head_norm=1.897455
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.408620e-02
[S17] stored merged vector for next round verification (round=31)
[S17] DEBUG after merge:  round=31 metric=0.4287 head_norm=1.897219 delta_norm=0.044086
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=32 head_norm_before_train=1.580727 cos_to_last_merge=0.9996 (last merge round=29)
[S2] round=32 local utility u=0.900764 metrics={'f1_val': 0.8316921337842411, 'auprc': 0.9901131889687813, 'loss_val': 0.26089460951524973, 'psi': 0.8950605558580572}-{'f1_val': 0.6280506972017602, 'auprc': 0.8521842552025644, 'loss_val': 0.426787480784309, 'psi': 0.7177041204020819}
[S3] START round=32 head_norm_before_train=1.618509 cos_to_last_merge=0.9350 (last merge round=26)
[S3] ⚠️ Model drifted since last merge! cos=0.935
[S3] round=32 local utility u=0.072900 metrics={'f1_val': 0.9746816052812316, 'auprc': 0.997232337778227, 'loss_val': 0.06532213993692912, 'psi': 0.9837018982800299}-{'f1_val': 0.9568210347071022, 'auprc': 0.9984398084464144, 'loss_val': 0.10758023739636749, 'psi': 0.973468544202827}
[S4] START round=32 head_norm_before_train=1.728303 cos_to_last_merge=0.7937 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.794
[S4] round=32 local utility u=0.056642 metrics={'f1_val': 0.9482042416441889, 'auprc': 0.9458123639754613, 'loss_val': 0.2695368835846442, 'psi': 0.9472474905766979}-{'f1_val': 0.9403455161985083, 'auprc': 0.9289153804932615, 'loss_val': 0.28497783267804117, 'psi': 0.9357734619164095}
[S5] START round=32 head_norm_before_train=1.234733 cos_to_last_merge=1.0000 (last merge round=31)
[S5] round=32 local utility u=0.000000 metrics={'f1_val': 0.43676623050537206, 'auprc': 0.8508381109651786, 'loss_val': 1.0245204434011002, 'psi': 0.6023949826892947}-{'f1_val': 0.5981999844040267, 'auprc': 0.7441628677162082, 'loss_val': 0.6579650610069275, 'psi': 0.6565851377288993}
[S6] START round=32 head_norm_before_train=1.322576 cos_to_last_merge=0.9914 (last merge round=28)
[S6] round=32 local utility u=0.016152 metrics={'f1_val': 0.8251771443549372, 'auprc': 0.9554595145883237, 'loss_val': 0.3853612032760535, 'psi': 0.8772900924482918}-{'f1_val': 0.8251513026356914, 'auprc': 0.9543538502809126, 'loss_val': 0.414192188986808, 'psi': 0.8768323216937799}
[S7] START round=32 head_norm_before_train=1.188433 cos_to_last_merge=1.0000 (last merge round=31)
[S7] round=32 local utility u=0.975337 metrics={'f1_val': 0.6713922221281104, 'auprc': 0.838313125573318, 'loss_val': 0.4085092935174916, 'psi': 0.7381605835061935}-{'f1_val': 0.4426062016086103, 'auprc': 0.7812857621532308, 'loss_val': 0.8153857325118709, 'psi': 0.5780780258264585}
[S8] START round=32 head_norm_before_train=1.898007 cos_to_last_merge=0.9971 (last merge round=26)
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.9864258722700556, 'auprc': 0.9882319293950851, 'loss_val': 0.05710834286494794, 'psi': 0.9871482951200674}-{'f1_val': 0.9934464462379313, 'auprc': 0.9950578447658254, 'loss_val': 0.045671763662574624, 'psi': 0.9940910056490889}
[S9] START round=32 head_norm_before_train=1.971194 cos_to_last_merge=0.8192 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.819
[S9] round=32 local utility u=0.030497 metrics={'f1_val': 0.9971000495392299, 'auprc': 0.9988516236629761, 'loss_val': 0.017892659315147653, 'psi': 0.9978006791887284}-{'f1_val': 0.9901493298847097, 'auprc': 0.9986572965295824, 'loss_val': 0.03659859818375014, 'psi': 0.9935525165426589}
[S10] START round=32 head_norm_before_train=1.135206 cos_to_last_merge=0.9931 (last merge round=29)
[S10] round=32 local utility u=0.053822 metrics={'f1_val': 0.9931562797758523, 'auprc': 0.994953999712388, 'loss_val': 0.18778202120132956, 'psi': 0.9938753677504666}-{'f1_val': 0.9878426793094987, 'auprc': 0.9931524949537494, 'loss_val': 0.25813916061889147, 'psi': 0.989966605567199}
[S11] START round=32 head_norm_before_train=2.083346 cos_to_last_merge=0.9988 (last merge round=27)
[S11] round=32 local utility u=0.306269 metrics={'f1_val': 0.9965268648289654, 'auprc': 0.9981283343817211, 'loss_val': 0.032850426759706945, 'psi': 0.9971674526500676}-{'f1_val': 0.914281084139212, 'auprc': 0.9966500107686906, 'loss_val': 0.14747903718693076, 'psi': 0.9472286547910035}
[S13] START round=32 head_norm_before_train=1.207862 cos_to_last_merge=0.9973 (last merge round=28)
[S13] round=32 local utility u=0.143369 metrics={'f1_val': 0.657340425702353, 'auprc': 0.6493656129883569, 'loss_val': 0.5403450870197998, 'psi': 0.6541505006167545}-{'f1_val': 0.6248278402217515, 'auprc': 0.6682455803379889, 'loss_val': 0.6886477221886488, 'psi': 0.6421949362682464}
[S14] START round=32 head_norm_before_train=1.328155 cos_to_last_merge=0.9635 (last merge round=25)
[S14] round=32 local utility u=0.002974 metrics={'f1_val': 0.9968300801588782, 'auprc': 0.9970231710189904, 'loss_val': 0.06757490157642154, 'psi': 0.996907316502923}-{'f1_val': 0.9970728011695729, 'auprc': 0.998557476871105, 'loss_val': 0.07958133208503897, 'psi': 0.9976666714501857}
[S15] START round=32 head_norm_before_train=1.328618 cos_to_last_merge=1.0000 (last merge round=31)
[S15] round=32 local utility u=0.828800 metrics={'f1_val': 0.9854301388429003, 'auprc': 0.9840480577400514, 'loss_val': 0.15012142983194124, 'psi': 0.9848773064017607}-{'f1_val': 0.7611789882478575, 'auprc': 0.9415899208696143, 'loss_val': 0.3348411044146826, 'psi': 0.8333433612965602}
[S16] START round=32 head_norm_before_train=1.750081 cos_to_last_merge=0.8113 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.811
[S16] round=32 local utility u=0.000000 metrics={'f1_val': 0.9371381389404801, 'auprc': 0.9882574298849096, 'loss_val': 0.31730275337312824, 'psi': 0.9575858553182519}-{'f1_val': 0.9918090767234037, 'auprc': 0.9937794914589686, 'loss_val': 0.04472446797264385, 'psi': 0.9925972426176297}
[S17] START round=32 head_norm_before_train=1.897219 cos_to_last_merge=1.0000 (last merge round=31)
[S17] round=32 local utility u=1.000000 metrics={'f1_val': 0.7134983287087662, 'auprc': 0.9362688775627391, 'loss_val': 0.6356237545584708, 'psi': 0.8026065482503554}-{'f1_val': 0.4304233635167336, 'auprc': 0.6581738670139694, 'loss_val': 1.3995197754175435, 'psi': 0.521523564915628}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S2] → sending delta(kind=head bytes=1807) to S6@127.0.0.1:54507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:54502
[S2] sending update (kind=head size=1807 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] → sending delta(kind=head bytes=1792) to S15@127.0.0.1:54515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:54508
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:54507
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] RECEIVED delta(kind=head bytes=1807) from S2
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.598179)
[S6] loaded HEAD from S2 (vec_in norm=1.598179)
[S6] cosine check vs S2: cos=0.9267
[S6] BUFFERED delta from S2 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1800) from S3
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.656874)
[S5] loaded HEAD from S3 (vec_in norm=1.656874)
[S5] cosine check vs S3: cos=0.9193
[S5] BUFFERED delta from S3 (total buffered=1)
[S7] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1792 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1800) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.182777)
[S5] loaded HEAD from S10 (vec_in norm=1.182777)
[S5] cosine check vs S10: cos=0.9134
[S5] BUFFERED delta from S10 (total buffered=2)
[S14] RECEIVED delta(kind=head bytes=1798) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.384732)
[S14] loaded HEAD from S15 (vec_in norm=1.384732)
[S14] cosine check vs S15: cos=0.9899
[S14] BUFFERED delta from S15 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1797) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=2.102632)
[S2] loaded HEAD from S11 (vec_in norm=2.102632)
[S2] cosine check vs S11: cos=0.9654
[S2] BUFFERED delta from S11 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1797) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.205666)
[S6] loaded HEAD from S7 (vec_in norm=1.205666)
[S6] cosine check vs S7: cos=0.8112
[S6] BUFFERED delta from S7 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1792) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.360828)
[S15] loaded HEAD from S14 (vec_in norm=1.360828)
[S15] cosine check vs S14: cos=0.9899
[S15] BUFFERED delta from S14 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1802) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.365741)
[S7] loaded HEAD from S6 (vec_in norm=1.365741)
[S7] cosine check vs S6: cos=0.8112
[S7] BUFFERED delta from S6 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1804) from S13
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.219656)
[S7] loaded HEAD from S13 (vec_in norm=1.219656)
[S7] cosine check vs S13: cos=0.9818
[S7] BUFFERED delta from S13 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:54509
[S17] sending update (kind=head size=1796 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1796) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.908798)
[S8] loaded HEAD from S17 (vec_in norm=1.908798)
[S8] cosine check vs S17: cos=0.9994
[S8] BUFFERED delta from S17 (total buffered=1)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=32 metric=0.8317 head_norm=1.598179
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.489746e-01
[S2] stored merged vector for next round verification (round=32)
[S2] DEBUG after merge:  round=32 metric=0.8400 head_norm=1.834621 delta_norm=0.348975
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=32 metric=0.4368 head_norm=1.270189
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.034131e-01
[S5] stored merged vector for next round verification (round=32)
[S5] DEBUG after merge:  round=32 metric=0.4368 head_norm=1.290022 delta_norm=0.103413
[S5] aggregate: ACCEPT kept=['S3', 'S10'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=32 metric=0.9864 head_norm=1.913241
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.270025e-02
[S8] stored merged vector for next round verification (round=32)
[S8] DEBUG after merge:  round=32 metric=0.9864 head_norm=1.910741 delta_norm=0.032700
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=32 metric=0.9854 head_norm=1.384732
[S15] _apply_head_vector_avg (torch): Δ‖w‖=9.851751e-02
[S15] stored merged vector for next round verification (round=32)
[S15] DEBUG after merge:  round=32 metric=0.9889 head_norm=1.369293 delta_norm=0.098518
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=32 metric=0.8252 head_norm=1.365741
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.801743e-01
[S6] stored merged vector for next round verification (round=32)
[S6] DEBUG after merge:  round=32 metric=0.8248 head_norm=1.308305 delta_norm=0.180174
[S6] aggregate: ACCEPT kept=['S2', 'S7'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=32 metric=0.6714 head_norm=1.205666
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.715386e-01
[S7] stored merged vector for next round verification (round=32)
[S7] DEBUG after merge:  round=32 metric=0.6581 head_norm=1.191311 delta_norm=0.171539
[S7] aggregate: ROLLBACK (f1_val pre=0.671 post=0.658 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=32 metric=0.9968 head_norm=1.360828
[S14] _apply_head_vector_avg (torch): Δ‖w‖=9.851751e-02
[S14] stored merged vector for next round verification (round=32)
[S14] DEBUG after merge:  round=32 metric=0.9968 head_norm=1.369293 delta_norm=0.098518
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=33 head_norm_before_train=1.834621 cos_to_last_merge=1.0000 (last merge round=32)
[S2] round=33 local utility u=0.000000 metrics={'f1_val': 0.8024436343404402, 'auprc': 0.8827215711942173, 'loss_val': 0.2496651491659399, 'psi': 0.834554809081951}-{'f1_val': 0.8316921337842411, 'auprc': 0.9901131889687813, 'loss_val': 0.26089460951524973, 'psi': 0.8950605558580572}
[S3] START round=33 head_norm_before_train=1.656874 cos_to_last_merge=0.9298 (last merge round=26)
[S3] ⚠️ Model drifted since last merge! cos=0.930
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.7067057102626948, 'auprc': 0.9925378010897523, 'loss_val': 0.40761246547437907, 'psi': 0.8210385465935177}-{'f1_val': 0.9746816052812316, 'auprc': 0.997232337778227, 'loss_val': 0.06532213993692912, 'psi': 0.9837018982800299}
[S4] START round=33 head_norm_before_train=1.734345 cos_to_last_merge=0.7936 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.794
[S4] round=33 local utility u=0.047233 metrics={'f1_val': 0.9555279861613757, 'auprc': 0.9602610018693136, 'loss_val': 0.26235919411116987, 'psi': 0.9574211924445508}-{'f1_val': 0.9482042416441889, 'auprc': 0.9458123639754613, 'loss_val': 0.2695368835846442, 'psi': 0.9472474905766979}
[S5] START round=33 head_norm_before_train=1.290022 cos_to_last_merge=1.0000 (last merge round=32)
[S5] round=33 local utility u=1.000000 metrics={'f1_val': 0.9959516507971103, 'auprc': 0.9920859031511388, 'loss_val': 0.2367345234702603, 'psi': 0.9944053517387217}-{'f1_val': 0.43676623050537206, 'auprc': 0.8508381109651786, 'loss_val': 1.0245204434011002, 'psi': 0.6023949826892947}
[S6] START round=33 head_norm_before_train=1.308305 cos_to_last_merge=1.0000 (last merge round=32)
[S6] round=33 local utility u=0.486284 metrics={'f1_val': 0.9626720706472306, 'auprc': 0.9624317487752763, 'loss_val': 0.25867995669082594, 'psi': 0.962575941898449}-{'f1_val': 0.8251771443549372, 'auprc': 0.9554595145883237, 'loss_val': 0.3853612032760535, 'psi': 0.8772900924482918}
[S7] START round=33 head_norm_before_train=1.191311 cos_to_last_merge=1.0000 (last merge round=32)
[S7] round=33 local utility u=0.000000 metrics={'f1_val': 0.6559500793000786, 'auprc': 0.8349473710794959, 'loss_val': 0.4436547128519451, 'psi': 0.7275489960118455}-{'f1_val': 0.6713922221281104, 'auprc': 0.838313125573318, 'loss_val': 0.4085092935174916, 'psi': 0.7381605835061935}
[S8] START round=33 head_norm_before_train=1.910741 cos_to_last_merge=1.0000 (last merge round=32)
[S8] round=33 local utility u=0.009297 metrics={'f1_val': 0.9889241575992487, 'auprc': 0.9873389483324952, 'loss_val': 0.050825981985604216, 'psi': 0.9882900738925473}-{'f1_val': 0.9864258722700556, 'auprc': 0.9882319293950851, 'loss_val': 0.05710834286494794, 'psi': 0.9871482951200674}
[S9] START round=33 head_norm_before_train=1.978645 cos_to_last_merge=0.8183 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.818
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.996233918340216, 'loss_val': 0.018067958637454976, 'psi': 0.9967553148433721}-{'f1_val': 0.9971000495392299, 'auprc': 0.9988516236629761, 'loss_val': 0.017892659315147653, 'psi': 0.9978006791887284}
[S10] START round=33 head_norm_before_train=1.182777 cos_to_last_merge=0.9867 (last merge round=29)
[S10] round=33 local utility u=0.012861 metrics={'f1_val': 0.992515759314603, 'auprc': 0.9929920142490432, 'loss_val': 0.15233156706991755, 'psi': 0.992706261288379}-{'f1_val': 0.9931562797758523, 'auprc': 0.994953999712388, 'loss_val': 0.18778202120132956, 'psi': 0.9938753677504666}
[S11] START round=33 head_norm_before_train=2.102632 cos_to_last_merge=0.9983 (last merge round=27)
[S11] round=33 local utility u=0.000000 metrics={'f1_val': 0.990786599815001, 'auprc': 0.9980202584697697, 'loss_val': 0.05746008932662314, 'psi': 0.9936800632769085}-{'f1_val': 0.9965268648289654, 'auprc': 0.9981283343817211, 'loss_val': 0.032850426759706945, 'psi': 0.9971674526500676}
[S13] START round=33 head_norm_before_train=1.219656 cos_to_last_merge=0.9960 (last merge round=28)
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.591820378368663, 'auprc': 0.6914327160402024, 'loss_val': 0.7878165648624905, 'psi': 0.6316653134372787}-{'f1_val': 0.657340425702353, 'auprc': 0.6493656129883569, 'loss_val': 0.5403450870197998, 'psi': 0.6541505006167545}
[S14] START round=33 head_norm_before_train=1.369293 cos_to_last_merge=1.0000 (last merge round=32)
[S14] round=33 local utility u=0.004900 metrics={'f1_val': 0.9970728011695729, 'auprc': 0.998708322580678, 'loss_val': 0.06428642299196669, 'psi': 0.997727009734015}-{'f1_val': 0.9968300801588782, 'auprc': 0.9970231710189904, 'loss_val': 0.06757490157642154, 'psi': 0.996907316502923}
[S15] START round=33 head_norm_before_train=1.369293 cos_to_last_merge=1.0000 (last merge round=32)
[S15] round=33 local utility u=0.000000 metrics={'f1_val': 0.6974508538118995, 'auprc': 0.8497318023090639, 'loss_val': 0.3605496659088045, 'psi': 0.7583632332107653}-{'f1_val': 0.9854301388429003, 'auprc': 0.9840480577400514, 'loss_val': 0.15012142983194124, 'psi': 0.9848773064017607}
[S16] START round=33 head_norm_before_train=1.760714 cos_to_last_merge=0.8109 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.811
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.9344019965144681, 'auprc': 0.9908853561135182, 'loss_val': 0.34312507983322804, 'psi': 0.9569953403540882}-{'f1_val': 0.9371381389404801, 'auprc': 0.9882574298849096, 'loss_val': 0.31730275337312824, 'psi': 0.9575858553182519}
[S17] START round=33 head_norm_before_train=1.908798 cos_to_last_merge=1.0000 (last merge round=31)
[S17] round=33 local utility u=0.000000 metrics={'f1_val': 0.6118399501801389, 'auprc': 0.8331410333391206, 'loss_val': 1.0331597762101379, 'psi': 0.7003603834437315}-{'f1_val': 0.7134983287087662, 'auprc': 0.9362688775627391, 'loss_val': 0.6356237545584708, 'psi': 0.8026065482503554}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:54517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:54508
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:54515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] → sending delta(kind=head bytes=1805) to S3@127.0.0.1:54503
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1805 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1799) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.397544)
[S15] loaded HEAD from S14 (vec_in norm=1.397544)
[S15] cosine check vs S14: cos=0.9986
[S15] BUFFERED delta from S14 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1800) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.345763)
[S7] loaded HEAD from S6 (vec_in norm=1.345763)
[S7] cosine check vs S6: cos=0.9072
[S7] BUFFERED delta from S6 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1805) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.315115)
[S3] loaded HEAD from S5 (vec_in norm=1.315115)
[S3] cosine check vs S5: cos=0.9306
[S3] BUFFERED delta from S5 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1798) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.926322)
[S17] loaded HEAD from S8 (vec_in norm=1.926322)
[S17] cosine check vs S8: cos=0.9996
[S17] BUFFERED delta from S8 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1799) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.233045)
[S5] loaded HEAD from S10 (vec_in norm=1.233045)
[S5] cosine check vs S10: cos=0.8959
[S5] BUFFERED delta from S10 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=33 metric=0.7067 head_norm=1.685402
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.333714e-01
[S3] stored merged vector for next round verification (round=33)
[S3] DEBUG after merge:  round=33 metric=0.7223 head_norm=1.474421 delta_norm=0.333371
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=33 metric=0.6975 head_norm=1.418874
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.844874e-02
[S15] stored merged vector for next round verification (round=33)
[S15] DEBUG after merge:  round=33 metric=0.6976 head_norm=1.407724 delta_norm=0.038449
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=33 metric=0.6560 head_norm=1.207023
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.831786e-01
[S7] stored merged vector for next round verification (round=33)
[S7] DEBUG after merge:  round=33 metric=0.6430 head_norm=1.246516 delta_norm=0.283179
[S7] aggregate: ROLLBACK (f1_val pre=0.656 post=0.643 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=33 metric=0.9960 head_norm=1.315115
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.934688e-01
[S5] stored merged vector for next round verification (round=33)
[S5] DEBUG after merge:  round=33 metric=0.7003 head_norm=1.240500 delta_norm=0.293469
[S5] aggregate: ROLLBACK (f1_val pre=0.996 post=0.700 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=33 metric=0.6118 head_norm=1.919761
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.722547e-02
[S17] stored merged vector for next round verification (round=33)
[S17] DEBUG after merge:  round=33 metric=0.6118 head_norm=1.922852 delta_norm=0.027225
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=34 head_norm_before_train=1.849163 cos_to_last_merge=1.0000 (last merge round=32)
[S2] round=34 local utility u=0.245354 metrics={'f1_val': 0.8311178779015699, 'auprc': 0.9909226943789066, 'loss_val': 0.2556061541015393, 'psi': 0.8950398044925045}-{'f1_val': 0.8024436343404402, 'auprc': 0.8827215711942173, 'loss_val': 0.2496651491659399, 'psi': 0.834554809081951}
[S3] START round=34 head_norm_before_train=1.474421 cos_to_last_merge=1.0000 (last merge round=33)
[S3] round=34 local utility u=0.613959 metrics={'f1_val': 0.8765032026524172, 'auprc': 0.997021837136082, 'loss_val': 0.2119322464721458, 'psi': 0.9247106564458831}-{'f1_val': 0.7067057102626948, 'auprc': 0.9925378010897523, 'loss_val': 0.40761246547437907, 'psi': 0.8210385465935177}
[S4] START round=34 head_norm_before_train=1.742604 cos_to_last_merge=0.7931 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.793
[S4] round=34 local utility u=0.000000 metrics={'f1_val': 0.946157005788083, 'auprc': 0.9369015435260195, 'loss_val': 0.2825820290777155, 'psi': 0.9424548208832577}-{'f1_val': 0.9555279861613757, 'auprc': 0.9602610018693136, 'loss_val': 0.26235919411116987, 'psi': 0.9574211924445508}
[S5] START round=34 head_norm_before_train=1.240500 cos_to_last_merge=1.0000 (last merge round=33)
[S5] round=34 local utility u=0.000000 metrics={'f1_val': 0.43552041580326833, 'auprc': 0.8419783047630472, 'loss_val': 0.8800278789548511, 'psi': 0.5981035713871798}-{'f1_val': 0.9959516507971103, 'auprc': 0.9920859031511388, 'loss_val': 0.2367345234702603, 'psi': 0.9944053517387217}
[S6] START round=34 head_norm_before_train=1.345763 cos_to_last_merge=0.9993 (last merge round=32)
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.6311628144052821, 'auprc': 0.7835437733236859, 'loss_val': 0.68075787119185, 'psi': 0.6921151979726436}-{'f1_val': 0.9626720706472306, 'auprc': 0.9624317487752763, 'loss_val': 0.25867995669082594, 'psi': 0.962575941898449}
[S7] START round=34 head_norm_before_train=1.246516 cos_to_last_merge=1.0000 (last merge round=33)
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.5946898261676018, 'auprc': 0.797591417917211, 'loss_val': 0.6635064411132532, 'psi': 0.6758504628674455}-{'f1_val': 0.6559500793000786, 'auprc': 0.8349473710794959, 'loss_val': 0.4436547128519451, 'psi': 0.7275489960118455}
[S8] START round=34 head_norm_before_train=1.926322 cos_to_last_merge=1.0000 (last merge round=32)
[S8] round=34 local utility u=0.000000 metrics={'f1_val': 0.9910256372156664, 'auprc': 0.9852848705289599, 'loss_val': 0.06409349581364439, 'psi': 0.9887293305409838}-{'f1_val': 0.9889241575992487, 'auprc': 0.9873389483324952, 'loss_val': 0.050825981985604216, 'psi': 0.9882900738925473}
[S9] START round=34 head_norm_before_train=1.984081 cos_to_last_merge=0.8175 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.817
[S9] round=34 local utility u=0.004387 metrics={'f1_val': 0.9971000495392299, 'auprc': 0.9989651763669456, 'loss_val': 0.017470438855209155, 'psi': 0.9978461002703163}-{'f1_val': 0.9971029125121428, 'auprc': 0.996233918340216, 'loss_val': 0.018067958637454976, 'psi': 0.9967553148433721}
[S10] START round=34 head_norm_before_train=1.233045 cos_to_last_merge=0.9796 (last merge round=29)
[S10] round=34 local utility u=0.000000 metrics={'f1_val': 0.9402971375532406, 'auprc': 0.9910041596922926, 'loss_val': 0.20758488622186352, 'psi': 0.9605799464088614}-{'f1_val': 0.992515759314603, 'auprc': 0.9929920142490432, 'loss_val': 0.15233156706991755, 'psi': 0.992706261288379}
[S11] START round=34 head_norm_before_train=2.119905 cos_to_last_merge=0.9978 (last merge round=27)
[S11] round=34 local utility u=0.031410 metrics={'f1_val': 0.9965268648289654, 'auprc': 0.997989256881952, 'loss_val': 0.028988230919736815, 'psi': 0.99711182165016}-{'f1_val': 0.990786599815001, 'auprc': 0.9980202584697697, 'loss_val': 0.05746008932662314, 'psi': 0.9936800632769085}
[S13] START round=34 head_norm_before_train=1.227541 cos_to_last_merge=0.9953 (last merge round=28)
[S13] round=34 local utility u=0.152417 metrics={'f1_val': 0.6257669021793548, 'auprc': 0.6811150838355843, 'loss_val': 0.6557080139001161, 'psi': 0.6479061748418466}-{'f1_val': 0.591820378368663, 'auprc': 0.6914327160402024, 'loss_val': 0.7878165648624905, 'psi': 0.6316653134372787}
[S14] START round=34 head_norm_before_train=1.397544 cos_to_last_merge=0.9999 (last merge round=32)
[S14] round=34 local utility u=0.003947 metrics={'f1_val': 0.9970728011695729, 'auprc': 0.9990838141775404, 'loss_val': 0.0575182672350457, 'psi': 0.9978772063727599}-{'f1_val': 0.9970728011695729, 'auprc': 0.998708322580678, 'loss_val': 0.06428642299196669, 'psi': 0.997727009734015}
[S15] START round=34 head_norm_before_train=1.407724 cos_to_last_merge=1.0000 (last merge round=33)
[S15] round=34 local utility u=1.000000 metrics={'f1_val': 0.9868525995631444, 'auprc': 0.9883501987299825, 'loss_val': 0.13388147941982023, 'psi': 0.9874516392298797}-{'f1_val': 0.6974508538118995, 'auprc': 0.8497318023090639, 'loss_val': 0.3605496659088045, 'psi': 0.7583632332107653}
[S16] START round=34 head_norm_before_train=1.771906 cos_to_last_merge=0.8105 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.811
[S16] round=34 local utility u=0.000000 metrics={'f1_val': 0.9344019965144681, 'auprc': 0.9914890289569568, 'loss_val': 0.3458900540972597, 'psi': 0.9572368094914636}-{'f1_val': 0.9344019965144681, 'auprc': 0.9908853561135182, 'loss_val': 0.34312507983322804, 'psi': 0.9569953403540882}
[S17] START round=34 head_norm_before_train=1.922852 cos_to_last_merge=1.0000 (last merge round=33)
[S17] round=34 local utility u=0.000000 metrics={'f1_val': 0.5902764373265051, 'auprc': 0.792422581282138, 'loss_val': 1.2091758088565383, 'psi': 0.6711348949087583}-{'f1_val': 0.6118399501801389, 'auprc': 0.8331410333391206, 'loss_val': 1.0331597762101379, 'psi': 0.7003603834437315}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:54507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S9] sending update (kind=head size=1807 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S2@127.0.0.1:54502
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:54514
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1804 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] → sending delta(kind=head bytes=1792) to S15@127.0.0.1:54515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:54508
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] RECEIVED delta(kind=head bytes=1804) from S2
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.860789)
[S6] loaded HEAD from S2 (vec_in norm=1.860789)
[S6] cosine check vs S2: cos=0.8870
[S6] BUFFERED delta from S2 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1799) from S3
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.503887)
[S5] loaded HEAD from S3 (vec_in norm=1.503887)
[S5] cosine check vs S3: cos=0.9087
[S5] BUFFERED delta from S3 (total buffered=1)
[S11] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1792 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1792) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.421893)
[S15] loaded HEAD from S14 (vec_in norm=1.421893)
[S15] cosine check vs S14: cos=0.9975
[S15] BUFFERED delta from S14 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1804) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=2.133073)
[S2] loaded HEAD from S11 (vec_in norm=2.133073)
[S2] cosine check vs S11: cos=0.9923
[S2] BUFFERED delta from S11 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1799) from S13
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.238993)
[S7] loaded HEAD from S13 (vec_in norm=1.238993)
[S7] cosine check vs S13: cos=0.8811
[S7] BUFFERED delta from S13 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1796) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.455719)
[S14] loaded HEAD from S15 (vec_in norm=1.455719)
[S14] cosine check vs S15: cos=0.9975
[S14] BUFFERED delta from S15 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=34 metric=0.8311 head_norm=1.860789
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.836488e-01
[S2] stored merged vector for next round verification (round=34)
[S2] DEBUG after merge:  round=34 metric=0.8319 head_norm=1.993124 delta_norm=0.183649
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=34 metric=0.6312 head_norm=1.374898
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.511471e-01
[S6] stored merged vector for next round verification (round=34)
[S6] DEBUG after merge:  round=34 metric=0.6326 head_norm=1.572548 delta_norm=0.451147
[S6] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=34 metric=0.4355 head_norm=1.260821
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.183664e-01
[S5] stored merged vector for next round verification (round=34)
[S5] DEBUG after merge:  round=34 metric=0.4366 head_norm=1.350673 delta_norm=0.318366
[S5] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=34 metric=0.5947 head_norm=1.266519
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.057485e-01
[S7] stored merged vector for next round verification (round=34)
[S7] DEBUG after merge:  round=34 metric=0.6134 head_norm=1.214951 delta_norm=0.305748
[S7] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=34 metric=0.9869 head_norm=1.455719
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.375391e-02
[S15] stored merged vector for next round verification (round=34)
[S15] DEBUG after merge:  round=34 metric=0.9927 head_norm=1.437901 delta_norm=0.053754
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=34 metric=0.9971 head_norm=1.421893
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.375390e-02
[S14] stored merged vector for next round verification (round=34)
[S14] DEBUG after merge:  round=34 metric=0.9971 head_norm=1.437901 delta_norm=0.053754
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=35 head_norm_before_train=1.993124 cos_to_last_merge=1.0000 (last merge round=34)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.8406568053272948, 'auprc': 0.9034941397093843, 'loss_val': 0.25678872953006093, 'psi': 0.8657917390801306}-{'f1_val': 0.8311178779015699, 'auprc': 0.9909226943789066, 'loss_val': 0.2556061541015393, 'psi': 0.8950398044925045}
[S3] START round=35 head_norm_before_train=1.503887 cos_to_last_merge=0.9999 (last merge round=33)
[S3] round=35 local utility u=0.335596 metrics={'f1_val': 0.9667904269867569, 'auprc': 0.9969947244433022, 'loss_val': 0.08238265549555225, 'psi': 0.978872145969375}-{'f1_val': 0.8765032026524172, 'auprc': 0.997021837136082, 'loss_val': 0.2119322464721458, 'psi': 0.9247106564458831}
[S4] START round=35 head_norm_before_train=1.749479 cos_to_last_merge=0.7927 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.793
[S4] round=35 local utility u=0.085071 metrics={'f1_val': 0.9565408143237103, 'auprc': 0.9655318291883672, 'loss_val': 0.2606346618777137, 'psi': 0.960137220269573}-{'f1_val': 0.946157005788083, 'auprc': 0.9369015435260195, 'loss_val': 0.2825820290777155, 'psi': 0.9424548208832577}
[S5] START round=35 head_norm_before_train=1.350673 cos_to_last_merge=1.0000 (last merge round=34)
[S5] round=35 local utility u=1.000000 metrics={'f1_val': 0.7830686425263347, 'auprc': 0.9894580735030838, 'loss_val': 0.2796129602157673, 'psi': 0.8656244149170343}-{'f1_val': 0.43552041580326833, 'auprc': 0.8419783047630472, 'loss_val': 0.8800278789548511, 'psi': 0.5981035713871798}
[S6] START round=35 head_norm_before_train=1.572548 cos_to_last_merge=1.0000 (last merge round=34)
[S6] round=35 local utility u=1.000000 metrics={'f1_val': 0.9618100611327534, 'auprc': 0.9581213089573425, 'loss_val': 0.19552962946728886, 'psi': 0.960334560262589}-{'f1_val': 0.6311628144052821, 'auprc': 0.7835437733236859, 'loss_val': 0.68075787119185, 'psi': 0.6921151979726436}
[S7] START round=35 head_norm_before_train=1.214951 cos_to_last_merge=1.0000 (last merge round=34)
[S7] round=35 local utility u=0.644568 metrics={'f1_val': 0.6951469522815208, 'auprc': 0.9056561020210669, 'loss_val': 0.30130738200152907, 'psi': 0.7793506121773393}-{'f1_val': 0.5946898261676018, 'auprc': 0.797591417917211, 'loss_val': 0.6635064411132532, 'psi': 0.6758504628674455}
[S8] START round=35 head_norm_before_train=1.940975 cos_to_last_merge=0.9998 (last merge round=32)
[S8] round=35 local utility u=0.016595 metrics={'f1_val': 0.9923498862294302, 'auprc': 0.9868916186130808, 'loss_val': 0.04366984547839949, 'psi': 0.9901665791828904}-{'f1_val': 0.9910256372156664, 'auprc': 0.9852848705289599, 'loss_val': 0.06409349581364439, 'psi': 0.9887293305409838}
[S9] START round=35 head_norm_before_train=1.993852 cos_to_last_merge=0.8166 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.817
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.9956054446615002, 'auprc': 0.9991246640796063, 'loss_val': 0.019155864737038952, 'psi': 0.9970131324287427}-{'f1_val': 0.9971000495392299, 'auprc': 0.9989651763669456, 'loss_val': 0.017470438855209155, 'psi': 0.9978461002703163}
[S10] START round=35 head_norm_before_train=1.280102 cos_to_last_merge=0.9729 (last merge round=29)
[S10] round=35 local utility u=0.163850 metrics={'f1_val': 0.9841159930916139, 'auprc': 0.9914047719836401, 'loss_val': 0.14399949863532815, 'psi': 0.9870315046484244}-{'f1_val': 0.9402971375532406, 'auprc': 0.9910041596922926, 'loss_val': 0.20758488622186352, 'psi': 0.9605799464088614}
[S11] START round=35 head_norm_before_train=2.133073 cos_to_last_merge=0.9974 (last merge round=27)
[S11] round=35 local utility u=0.001365 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9983079365019762, 'loss_val': 0.027334304285808863, 'psi': 0.9972513773089442}-{'f1_val': 0.9965268648289654, 'auprc': 0.997989256881952, 'loss_val': 0.028988230919736815, 'psi': 0.99711182165016}
[S13] START round=35 head_norm_before_train=1.238993 cos_to_last_merge=0.9950 (last merge round=28)
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.605746011848057, 'auprc': 0.6846514181463154, 'loss_val': 0.7545843128540427, 'psi': 0.6373081743673603}-{'f1_val': 0.6257669021793548, 'auprc': 0.6811150838355843, 'loss_val': 0.6557080139001161, 'psi': 0.6479061748418466}
[S14] START round=35 head_norm_before_train=1.437901 cos_to_last_merge=1.0000 (last merge round=34)
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.9963900223018398, 'auprc': 0.9985536564611768, 'loss_val': 0.06321012317398784, 'psi': 0.9972554759655746}-{'f1_val': 0.9970728011695729, 'auprc': 0.9990838141775404, 'loss_val': 0.0575182672350457, 'psi': 0.9978772063727599}
[S15] START round=35 head_norm_before_train=1.437901 cos_to_last_merge=1.0000 (last merge round=34)
[S15] round=35 local utility u=0.000000 metrics={'f1_val': 0.8945543180657821, 'auprc': 0.9635868938513033, 'loss_val': 0.18948401737526413, 'psi': 0.9221673483799906}-{'f1_val': 0.9868525995631444, 'auprc': 0.9883501987299825, 'loss_val': 0.13388147941982023, 'psi': 0.9874516392298797}
[S16] START round=35 head_norm_before_train=1.780655 cos_to_last_merge=0.8097 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.810
[S16] round=35 local utility u=0.000000 metrics={'f1_val': 0.8491621499791226, 'auprc': 0.8875056971262816, 'loss_val': 0.926117434282661, 'psi': 0.8644995688379862}-{'f1_val': 0.9344019965144681, 'auprc': 0.9914890289569568, 'loss_val': 0.3458900540972597, 'psi': 0.9572368094914636}
[S17] START round=35 head_norm_before_train=1.933483 cos_to_last_merge=1.0000 (last merge round=33)
[S17] round=35 local utility u=0.459790 metrics={'f1_val': 0.603950044080869, 'auprc': 0.9405594153775181, 'loss_val': 0.8160479367047374, 'psi': 0.7385937925995287}-{'f1_val': 0.5902764373265051, 'auprc': 0.792422581282138, 'loss_val': 1.2091758088565383, 'psi': 0.6711348949087583}
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S3]  timeout peer S4
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S8
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S16
[S15]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S9
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:54505
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:54502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:54508
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:54517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:54503
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:54507
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:54505
[S3] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] sending update (kind=head size=1794 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:54509
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] RECEIVED delta(kind=head bytes=1801) from S3
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.528734)
[S5] loaded HEAD from S3 (vec_in norm=1.528734)
[S5] cosine check vs S3: cos=0.9776
[S5] BUFFERED delta from S3 (total buffered=1)
[S10] sending update (kind=head size=1804 to 1 peers)
[S3] ⇄ pheromone p=0.236 → S5@127.0.0.1:54505
[S15] ⇄ pheromone p=0.311 → S14@127.0.0.1:54514
[S7] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S17] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1799) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=2.146349)
[S2] loaded HEAD from S11 (vec_in norm=2.146349)
[S2] cosine check vs S11: cos=0.9981
[S2] BUFFERED delta from S11 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1799) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.361713)
[S3] loaded HEAD from S5 (vec_in norm=1.361713)
[S3] cosine check vs S5: cos=0.9776
[S3] BUFFERED delta from S5 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1803) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.237002)
[S6] loaded HEAD from S7 (vec_in norm=1.237002)
[S6] cosine check vs S7: cos=0.7780
[S6] BUFFERED delta from S7 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1800) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.592844)
[S7] loaded HEAD from S6 (vec_in norm=1.592844)
[S7] cosine check vs S6: cos=0.7780
[S7] BUFFERED delta from S6 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1797) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.944715)
[S8] loaded HEAD from S17 (vec_in norm=1.944715)
[S8] cosine check vs S17: cos=0.9994
[S8] BUFFERED delta from S17 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1796) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.950813)
[S17] loaded HEAD from S8 (vec_in norm=1.950813)
[S17] cosine check vs S8: cos=0.9994
[S17] BUFFERED delta from S8 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1804) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.321459)
[S5] loaded HEAD from S10 (vec_in norm=1.321459)
[S5] cosine check vs S10: cos=0.8734
[S5] BUFFERED delta from S10 (total buffered=2)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=35 metric=0.9923 head_norm=1.950813
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.304961e-02
[S8] stored merged vector for next round verification (round=35)
[S8] DEBUG after merge:  round=35 metric=0.9923 head_norm=1.947486 delta_norm=0.033050
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.012 → S17@127.0.0.1:54517
[S11] ⇄ pheromone p=0.051 → S2@127.0.0.1:54502
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=35 metric=0.6040 head_norm=1.944715
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.304961e-02
[S17] stored merged vector for next round verification (round=35)
[S17] DEBUG after merge:  round=35 metric=0.6040 head_norm=1.947486 delta_norm=0.033050
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.256 → S8@127.0.0.1:54509
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=35 metric=0.8407 head_norm=2.001150
[S2] _apply_head_vector_avg (torch): Δ‖w‖=9.685420e-02
[S2] stored merged vector for next round verification (round=35)
[S2] DEBUG after merge:  round=35 metric=0.8420 head_norm=2.072758 delta_norm=0.096854
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.152 → S6@127.0.0.1:54507
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=35 metric=0.9618 head_norm=1.592844
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.003337e-01
[S6] stored merged vector for next round verification (round=35)
[S6] DEBUG after merge:  round=35 metric=0.9620 head_norm=1.335414 delta_norm=0.500334
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.349 → S7@127.0.0.1:54508
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=35 metric=0.7831 head_norm=1.361713
[S5] _apply_head_vector_avg (torch): Δ‖w‖=9.948872e-02
[S5] stored merged vector for next round verification (round=35)
[S5] DEBUG after merge:  round=35 metric=0.7006 head_norm=1.346554 delta_norm=0.099489
[S5] aggregate: ROLLBACK (f1_val pre=0.783 post=0.701 tol_abs=0.005 tol_rel=0.0)
[S5] ⇄ pheromone p=0.397 → S3@127.0.0.1:54503
[S13] ⇄ pheromone p=0.052 → S7@127.0.0.1:54508
[S10] ⇄ pheromone p=0.128 → S5@127.0.0.1:54505
[S14] CommDone barrier timeout: have=2 need=3 — continuing
[S14] ⇄ pheromone p=0.016 → S15@127.0.0.1:54515
[S7] CommDone barrier timeout: have=2 need=3 — continuing
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=35 metric=0.6951 head_norm=1.237002
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.003337e-01
[S7] stored merged vector for next round verification (round=35)
[S7] DEBUG after merge:  round=35 metric=0.6899 head_norm=1.335414 delta_norm=0.500334
[S7] aggregate: ROLLBACK (f1_val pre=0.695 post=0.690 tol_abs=0.005 tol_rel=0.0)
[S7] ⇄ pheromone p=0.280 → S6@127.0.0.1:54507
[S2] START round=36 head_norm_before_train=2.072758 cos_to_last_merge=1.0000 (last merge round=35)
[S2] round=36 local utility u=0.138400 metrics={'f1_val': 0.8427408810507321, 'auprc': 0.9788157767146615, 'loss_val': 0.2184574068296846, 'psi': 0.8971708393163038}-{'f1_val': 0.8406568053272948, 'auprc': 0.9034941397093843, 'loss_val': 0.25678872953006093, 'psi': 0.8657917390801306}
[S3] START round=36 head_norm_before_train=1.528734 cos_to_last_merge=0.9996 (last merge round=33)
[S3] round=36 local utility u=0.000000 metrics={'f1_val': 0.8252311490265687, 'auprc': 0.9972168675788996, 'loss_val': 0.2538159029855422, 'psi': 0.8940254364475011}-{'f1_val': 0.9667904269867569, 'auprc': 0.9969947244433022, 'loss_val': 0.08238265549555225, 'psi': 0.978872145969375}
[S4] START round=36 head_norm_before_train=1.754468 cos_to_last_merge=0.7927 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.793
[S4] round=36 local utility u=0.000000 metrics={'f1_val': 0.9461189998527517, 'auprc': 0.9393121569967636, 'loss_val': 0.28327621780976603, 'psi': 0.9433962627103565}-{'f1_val': 0.9565408143237103, 'auprc': 0.9655318291883672, 'loss_val': 0.2606346618777137, 'psi': 0.960137220269573}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=36 head_norm_before_train=1.346554 cos_to_last_merge=1.0000 (last merge round=35)
[S5] round=36 local utility u=0.156721 metrics={'f1_val': 0.834125607857469, 'auprc': 0.9891813570777734, 'loss_val': 0.27168356608196326, 'psi': 0.8961479075455908}-{'f1_val': 0.7830686425263347, 'auprc': 0.9894580735030838, 'loss_val': 0.2796129602157673, 'psi': 0.8656244149170343}
[S6] START round=36 head_norm_before_train=1.335414 cos_to_last_merge=1.0000 (last merge round=35)
[S6] round=36 local utility u=0.000000 metrics={'f1_val': 0.7773212369080531, 'auprc': 0.9465961726416401, 'loss_val': 0.5096444874675748, 'psi': 0.8450312112014879}-{'f1_val': 0.9618100611327534, 'auprc': 0.9581213089573425, 'loss_val': 0.19552962946728886, 'psi': 0.960334560262589}
[S7] START round=36 head_norm_before_train=1.335414 cos_to_last_merge=1.0000 (last merge round=35)
[S7] round=36 local utility u=0.000000 metrics={'f1_val': 0.5213387826191276, 'auprc': 0.7821505566376192, 'loss_val': 0.8950984769526235, 'psi': 0.6256634922265243}-{'f1_val': 0.6951469522815208, 'auprc': 0.9056561020210669, 'loss_val': 0.30130738200152907, 'psi': 0.7793506121773393}
[S8] START round=36 head_norm_before_train=1.947486 cos_to_last_merge=1.0000 (last merge round=35)
[S8] round=36 local utility u=0.000000 metrics={'f1_val': 0.9871370762874481, 'auprc': 0.9868039989426549, 'loss_val': 0.055801066742120924, 'psi': 0.9870038453495308}-{'f1_val': 0.9923498862294302, 'auprc': 0.9868916186130808, 'loss_val': 0.04366984547839949, 'psi': 0.9901665791828904}
[S9] START round=36 head_norm_before_train=2.004104 cos_to_last_merge=0.8158 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.816
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9938175595084885, 'loss_val': 0.018082685834532278, 'psi': 0.9957887713106811}-{'f1_val': 0.9956054446615002, 'auprc': 0.9991246640796063, 'loss_val': 0.019155864737038952, 'psi': 0.9970131324287427}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=36 head_norm_before_train=1.321459 cos_to_last_merge=0.9670 (last merge round=29)
[S10] round=36 local utility u=0.026436 metrics={'f1_val': 0.9898936731333229, 'auprc': 0.9918503688703295, 'loss_val': 0.12712951625661903, 'psi': 0.9906763514281255}-{'f1_val': 0.9841159930916139, 'auprc': 0.9914047719836401, 'loss_val': 0.14399949863532815, 'psi': 0.9870315046484244}
[S11] START round=36 head_norm_before_train=2.146349 cos_to_last_merge=0.9970 (last merge round=27)
[S11] round=36 local utility u=0.000000 metrics={'f1_val': 0.9896753741958163, 'auprc': 0.9981527576611646, 'loss_val': 0.06078910247414899, 'psi': 0.9930663275819556}-{'f1_val': 0.9965470045135896, 'auprc': 0.9983079365019762, 'loss_val': 0.027334304285808863, 'psi': 0.9972513773089442}
[S13] START round=36 head_norm_before_train=1.249736 cos_to_last_merge=0.9944 (last merge round=28)
[S13] round=36 local utility u=0.103863 metrics={'f1_val': 0.6270467842010234, 'auprc': 0.6791126810261978, 'loss_val': 0.6580464996008267, 'psi': 0.6478731429310932}-{'f1_val': 0.605746011848057, 'auprc': 0.6846514181463154, 'loss_val': 0.7545843128540427, 'psi': 0.6373081743673603}
[S14] START round=36 head_norm_before_train=1.454936 cos_to_last_merge=0.9999 (last merge round=34)
[S14] round=36 local utility u=0.002247 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9956744795794679, 'loss_val': 0.05372342368285417, 'psi': 0.9964682967263863}-{'f1_val': 0.9963900223018398, 'auprc': 0.9985536564611768, 'loss_val': 0.06321012317398784, 'psi': 0.9972554759655746}
[S15] START round=36 head_norm_before_train=1.488211 cos_to_last_merge=0.9993 (last merge round=34)
[S15] round=36 local utility u=0.012178 metrics={'f1_val': 0.8951869866407975, 'auprc': 0.9690643126794458, 'loss_val': 0.18535573440660333, 'psi': 0.9247379170562569}-{'f1_val': 0.8945543180657821, 'auprc': 0.9635868938513033, 'loss_val': 0.18948401737526413, 'psi': 0.9221673483799906}
[S16] START round=36 head_norm_before_train=1.790300 cos_to_last_merge=0.8089 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.809
[S16] round=36 local utility u=1.000000 metrics={'f1_val': 0.9891091745343991, 'auprc': 0.9958325194287172, 'loss_val': 0.05284643392610652, 'psi': 0.9917985124921262}-{'f1_val': 0.8491621499791226, 'auprc': 0.8875056971262816, 'loss_val': 0.926117434282661, 'psi': 0.8644995688379862}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S17] START round=36 head_norm_before_train=1.947486 cos_to_last_merge=1.0000 (last merge round=35)
[S17] round=36 local utility u=0.550326 metrics={'f1_val': 0.7185741734342945, 'auprc': 0.9976169388287883, 'loss_val': 0.5743134413342309, 'psi': 0.830191279592092}-{'f1_val': 0.603950044080869, 'auprc': 0.9405594153775181, 'loss_val': 0.8160479367047374, 'psi': 0.7385937925995287}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:54509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:54514
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=36 metric=0.8252 head_norm=1.555689
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.906938e-01
[S3] stored merged vector for next round verification (round=36)
[S3] DEBUG after merge:  round=36 metric=0.8507 head_norm=1.449431 delta_norm=0.190694
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:54507
[S17] sending update (kind=head size=1795 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1795) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.958365)
[S8] loaded HEAD from S17 (vec_in norm=1.958365)
[S8] cosine check vs S17: cos=0.9999
[S8] BUFFERED delta from S17 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1798) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.540808)
[S14] loaded HEAD from S15 (vec_in norm=1.540808)
[S14] cosine check vs S15: cos=0.9966
[S14] BUFFERED delta from S15 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:54503
[S2] sending update (kind=head size=1797 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1797) from S2
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=2.079752)
[S6] loaded HEAD from S2 (vec_in norm=2.079752)
[S6] cosine check vs S2: cos=0.8508
[S6] BUFFERED delta from S2 (total buffered=1)
[S5] sending update (kind=head size=1804 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1804) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.365656)
[S3] loaded HEAD from S5 (vec_in norm=1.365656)
[S3] cosine check vs S5: cos=0.9840
[S3] BUFFERED delta from S5 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:54508
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=36 metric=0.7773 head_norm=1.351438
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.850906e-01
[S6] stored merged vector for next round verification (round=36)
[S6] DEBUG after merge:  round=36 metric=0.7817 head_norm=1.653344 delta_norm=0.585091
[S6] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S10] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1802) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.360196)
[S5] loaded HEAD from S10 (vec_in norm=1.360196)
[S5] cosine check vs S10: cos=0.8969
[S5] BUFFERED delta from S10 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1800) from S13
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.263280)
[S7] loaded HEAD from S13 (vec_in norm=1.263280)
[S7] cosine check vs S13: cos=0.8172
[S7] BUFFERED delta from S13 (total buffered=1)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=36 metric=0.8341 head_norm=1.365656
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.093960e-01
[S5] stored merged vector for next round verification (round=36)
[S5] DEBUG after merge:  round=36 metric=0.7003 head_norm=1.327347 delta_norm=0.309396
[S5] aggregate: ROLLBACK (f1_val pre=0.834 post=0.700 tol_abs=0.005 tol_rel=0.0)
[S13]  timeout peer S7
[S10]  timeout peer S13
[S7]  timeout peer S9
[S7]  timeout peer S14
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S16
[S5]  timeout peer S8
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:54515
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1799) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.472621)
[S15] loaded HEAD from S14 (vec_in norm=1.472621)
[S15] cosine check vs S14: cos=0.9966
[S15] BUFFERED delta from S14 (total buffered=1)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=36 metric=0.5213 head_norm=1.352230
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.976460e-01
[S7] stored merged vector for next round verification (round=36)
[S7] DEBUG after merge:  round=36 metric=0.5519 head_norm=1.246627 delta_norm=0.397646
[S7] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=36 metric=0.9970 head_norm=1.472621
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.121747e-02
[S14] stored merged vector for next round verification (round=36)
[S14] DEBUG after merge:  round=36 metric=0.9970 head_norm=1.505417 delta_norm=0.071217
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=37 head_norm_before_train=2.079752 cos_to_last_merge=1.0000 (last merge round=35)
[S2] round=37 local utility u=0.212469 metrics={'f1_val': 0.907262390455303, 'auprc': 0.9870031204184093, 'loss_val': 0.20521145793134596, 'psi': 0.9391586824405455}-{'f1_val': 0.8427408810507321, 'auprc': 0.9788157767146615, 'loss_val': 0.2184574068296846, 'psi': 0.8971708393163038}
[S3] START round=37 head_norm_before_train=1.449431 cos_to_last_merge=1.0000 (last merge round=36)
[S3] round=37 local utility u=0.525815 metrics={'f1_val': 0.9724549131111073, 'auprc': 0.998134161454866, 'loss_val': 0.08827961021490788, 'psi': 0.9827266124486108}-{'f1_val': 0.8252311490265687, 'auprc': 0.9972168675788996, 'loss_val': 0.2538159029855422, 'psi': 0.8940254364475011}
[S4] START round=37 head_norm_before_train=1.761648 cos_to_last_merge=0.7922 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.792
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.9453608360650705, 'auprc': 0.9366600142397892, 'loss_val': 0.28463101319990164, 'psi': 0.9418805073349579}-{'f1_val': 0.9461189998527517, 'auprc': 0.9393121569967636, 'loss_val': 0.28327621780976603, 'psi': 0.9433962627103565}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=37 head_norm_before_train=1.327347 cos_to_last_merge=1.0000 (last merge round=36)
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.6509057429340308, 'auprc': 0.9373002404627501, 'loss_val': 0.430790176777873, 'psi': 0.7654635419455185}-{'f1_val': 0.834125607857469, 'auprc': 0.9891813570777734, 'loss_val': 0.27168356608196326, 'psi': 0.8961479075455908}
[S6] START round=37 head_norm_before_train=1.653344 cos_to_last_merge=1.0000 (last merge round=36)
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.7469718215322594, 'auprc': 0.8125764125686796, 'loss_val': 0.5582267013854932, 'psi': 0.7732136579468274}-{'f1_val': 0.7773212369080531, 'auprc': 0.9465961726416401, 'loss_val': 0.5096444874675748, 'psi': 0.8450312112014879}
[S7] START round=37 head_norm_before_train=1.246627 cos_to_last_merge=1.0000 (last merge round=36)
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.5070611043109625, 'auprc': 0.7817547206737718, 'loss_val': 0.8348475882628507, 'psi': 0.6169385508560863}-{'f1_val': 0.5213387826191276, 'auprc': 0.7821505566376192, 'loss_val': 0.8950984769526235, 'psi': 0.6256634922265243}
[S8] START round=37 head_norm_before_train=1.956529 cos_to_last_merge=1.0000 (last merge round=35)
[S8] round=37 local utility u=0.026059 metrics={'f1_val': 0.9937333839017813, 'auprc': 0.9860204194323414, 'loss_val': 0.040909347758603505, 'psi': 0.9906481981140054}-{'f1_val': 0.9871370762874481, 'auprc': 0.9868039989426549, 'loss_val': 0.055801066742120924, 'psi': 0.9870038453495308}
[S9] START round=37 head_norm_before_train=2.012767 cos_to_last_merge=0.8149 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.815
[S9] round=37 local utility u=0.003729 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9961065417846313, 'loss_val': 0.017491948946391306, 'psi': 0.9967043642211382}-{'f1_val': 0.9971029125121428, 'auprc': 0.9938175595084885, 'loss_val': 0.018082685834532278, 'psi': 0.9957887713106811}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=37 head_norm_before_train=1.360196 cos_to_last_merge=0.9615 (last merge round=29)
[S10] round=37 local utility u=0.029067 metrics={'f1_val': 0.9929532433629917, 'auprc': 0.9923458941437268, 'loss_val': 0.08884044961572309, 'psi': 0.9927103036752858}-{'f1_val': 0.9898936731333229, 'auprc': 0.9918503688703295, 'loss_val': 0.12712951625661903, 'psi': 0.9906763514281255}
[S11] START round=37 head_norm_before_train=2.155411 cos_to_last_merge=0.9966 (last merge round=27)
[S11] round=37 local utility u=0.036428 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9982379981629476, 'loss_val': 0.026937894974447124, 'psi': 0.9969754042131647}-{'f1_val': 0.9896753741958163, 'auprc': 0.9981527576611646, 'loss_val': 0.06078910247414899, 'psi': 0.9930663275819556}
[S13] START round=37 head_norm_before_train=1.263280 cos_to_last_merge=0.9936 (last merge round=28)
[S13] round=37 local utility u=0.000000 metrics={'f1_val': 0.6111928220401844, 'auprc': 0.6833849205604083, 'loss_val': 0.7698422154774588, 'psi': 0.6400696614482739}-{'f1_val': 0.6270467842010234, 'auprc': 0.6791126810261978, 'loss_val': 0.6580464996008267, 'psi': 0.6478731429310932}
[S14] START round=37 head_norm_before_train=1.505417 cos_to_last_merge=1.0000 (last merge round=36)
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.979147727346884, 'auprc': 0.9991623491107013, 'loss_val': 0.06507148483572725, 'psi': 0.987153576052411}-{'f1_val': 0.9969975081576651, 'auprc': 0.9956744795794679, 'loss_val': 0.05372342368285417, 'psi': 0.9964682967263863}
[S15] START round=37 head_norm_before_train=1.540808 cos_to_last_merge=0.9974 (last merge round=34)
[S15] round=37 local utility u=0.008526 metrics={'f1_val': 0.8972347165363974, 'auprc': 0.9851490783554382, 'loss_val': 0.22884540158245378, 'psi': 0.9324004612640138}-{'f1_val': 0.8951869866407975, 'auprc': 0.9690643126794458, 'loss_val': 0.18535573440660333, 'psi': 0.9247379170562569}
[S16] START round=37 head_norm_before_train=1.799666 cos_to_last_merge=0.8083 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.808
[S16] round=37 local utility u=0.014396 metrics={'f1_val': 0.9924646455200138, 'auprc': 0.9939528064734307, 'loss_val': 0.038548047358385476, 'psi': 0.9930599099013805}-{'f1_val': 0.9891091745343991, 'auprc': 0.9958325194287172, 'loss_val': 0.05284643392610652, 'psi': 0.9917985124921262}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=37 head_norm_before_train=1.958365 cos_to_last_merge=0.9999 (last merge round=35)
[S17] round=37 local utility u=0.000000 metrics={'f1_val': 0.6076759509304069, 'auprc': 0.8585883812554163, 'loss_val': 1.020931396327088, 'psi': 0.7080409230604107}-{'f1_val': 0.7185741734342945, 'auprc': 0.9976169388287883, 'loss_val': 0.5743134413342309, 'psi': 0.830191279592092}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:54517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:54514
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:54505
[S15] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:54512
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] RECEIVED delta(kind=head bytes=1795) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.583109)
[S14] loaded HEAD from S15 (vec_in norm=1.583109)
[S14] cosine check vs S15: cos=0.9977
[S14] BUFFERED delta from S15 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1800) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.964068)
[S17] loaded HEAD from S8 (vec_in norm=1.964068)
[S17] cosine check vs S8: cos=0.9998
[S17] BUFFERED delta from S8 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1800) from S3
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.496580)
[S5] loaded HEAD from S3 (vec_in norm=1.496580)
[S5] cosine check vs S3: cos=0.9130
[S5] BUFFERED delta from S3 (total buffered=1)
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=37 metric=0.9725 head_norm=1.496580
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.573211e-01
[S3] stored merged vector for next round verification (round=37)
[S3] DEBUG after merge:  round=37 metric=0.9720 head_norm=1.423951 delta_norm=0.157321
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=37 metric=0.9937 head_norm=1.964068
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.417445e-02
[S8] stored merged vector for next round verification (round=37)
[S8] DEBUG after merge:  round=37 metric=0.9937 head_norm=1.961168 delta_norm=0.014174
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=37 metric=0.8972 head_norm=1.583109
[S15] _apply_head_vector_avg (torch): Δ‖w‖=9.726514e-02
[S15] stored merged vector for next round verification (round=37)
[S15] DEBUG after merge:  round=37 metric=0.8974 head_norm=1.525766 delta_norm=0.097265
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S11] RECEIVED delta(kind=head bytes=1801) from S2
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=2.090926)
[S11] loaded HEAD from S2 (vec_in norm=2.090926)
[S11] cosine check vs S2: cos=0.9991
[S11] BUFFERED delta from S2 (total buffered=1)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=37 metric=0.6509 head_norm=1.364413
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.053049e-01
[S5] stored merged vector for next round verification (round=37)
[S5] DEBUG after merge:  round=37 metric=0.6531 head_norm=1.399098 delta_norm=0.305305
[S5] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=38 head_norm_before_train=2.090926 cos_to_last_merge=0.9999 (last merge round=35)
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.9032004043226846, 'auprc': 0.9682772427118327, 'loss_val': 0.2497785279149212, 'psi': 0.9292311396783438}-{'f1_val': 0.907262390455303, 'auprc': 0.9870031204184093, 'loss_val': 0.20521145793134596, 'psi': 0.9391586824405455}
[S3] START round=38 head_norm_before_train=1.423951 cos_to_last_merge=1.0000 (last merge round=37)
[S3] round=38 local utility u=0.030040 metrics={'f1_val': 0.983037983226718, 'auprc': 0.9978954916301734, 'loss_val': 0.09098203241499117, 'psi': 0.9889809865881002}-{'f1_val': 0.9724549131111073, 'auprc': 0.998134161454866, 'loss_val': 0.08827961021490788, 'psi': 0.9827266124486108}
[S4] START round=38 head_norm_before_train=1.765981 cos_to_last_merge=0.7923 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.792
[S4] round=38 local utility u=0.085048 metrics={'f1_val': 0.9540311538603639, 'auprc': 0.9693617921107902, 'loss_val': 0.26466238626676925, 'psi': 0.9601634091605344}-{'f1_val': 0.9453608360650705, 'auprc': 0.9366600142397892, 'loss_val': 0.28463101319990164, 'psi': 0.9418805073349579}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=38 head_norm_before_train=1.399098 cos_to_last_merge=1.0000 (last merge round=37)
[S5] round=38 local utility u=0.000000 metrics={'f1_val': 0.6005235609900301, 'auprc': 0.856874444268344, 'loss_val': 0.594562158604931, 'psi': 0.7030639143013557}-{'f1_val': 0.6509057429340308, 'auprc': 0.9373002404627501, 'loss_val': 0.430790176777873, 'psi': 0.7654635419455185}
[S6] START round=38 head_norm_before_train=1.665271 cos_to_last_merge=0.9999 (last merge round=36)
[S6] round=38 local utility u=0.802858 metrics={'f1_val': 0.8959518991090012, 'auprc': 0.9471360270704023, 'loss_val': 0.25006976665375624, 'psi': 0.9164255502935617}-{'f1_val': 0.7469718215322594, 'auprc': 0.8125764125686796, 'loss_val': 0.5582267013854932, 'psi': 0.7732136579468274}
[S7] START round=38 head_norm_before_train=1.259983 cos_to_last_merge=0.9999 (last merge round=36)
[S7] round=38 local utility u=0.305224 metrics={'f1_val': 0.5818014302015247, 'auprc': 0.791983632408922, 'loss_val': 0.7035275677725049, 'psi': 0.6658743110844836}-{'f1_val': 0.5070611043109625, 'auprc': 0.7817547206737718, 'loss_val': 0.8348475882628507, 'psi': 0.6169385508560863}
[S8] START round=38 head_norm_before_train=1.961168 cos_to_last_merge=1.0000 (last merge round=37)
[S8] round=38 local utility u=0.003401 metrics={'f1_val': 0.993080372776832, 'auprc': 0.9894502095935718, 'loss_val': 0.04047868517234185, 'psi': 0.9916283075035279}-{'f1_val': 0.9937333839017813, 'auprc': 0.9860204194323414, 'loss_val': 0.040909347758603505, 'psi': 0.9906481981140054}
[S9] START round=38 head_norm_before_train=2.021040 cos_to_last_merge=0.8140 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.814
[S9] round=38 local utility u=0.002032 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9991857538552474, 'loss_val': 0.017673551582704707, 'psi': 0.9974369189803427}-{'f1_val': 0.9971029125121428, 'auprc': 0.9961065417846313, 'loss_val': 0.017491948946391306, 'psi': 0.9967043642211382}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=38 head_norm_before_train=1.397262 cos_to_last_merge=0.9564 (last merge round=29)
[S10] round=38 local utility u=0.000000 metrics={'f1_val': 0.9331181514003416, 'auprc': 0.9912995107713609, 'loss_val': 0.17714497999118317, 'psi': 0.9563906951487493}-{'f1_val': 0.9929532433629917, 'auprc': 0.9923458941437268, 'loss_val': 0.08884044961572309, 'psi': 0.9927103036752858}
[S11] START round=38 head_norm_before_train=2.165601 cos_to_last_merge=0.9963 (last merge round=27)
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9965631078164638, 'loss_val': 0.08399608841774789, 'psi': 0.9963054480745711}-{'f1_val': 0.9961336749133093, 'auprc': 0.9982379981629476, 'loss_val': 0.026937894974447124, 'psi': 0.9969754042131647}
[S13] START round=38 head_norm_before_train=1.277428 cos_to_last_merge=0.9927 (last merge round=28)
[S13] round=38 local utility u=0.125508 metrics={'f1_val': 0.6348287277934999, 'auprc': 0.6673159738197303, 'loss_val': 0.6124341795316599, 'psi': 0.647823626203992}-{'f1_val': 0.6111928220401844, 'auprc': 0.6833849205604083, 'loss_val': 0.7698422154774588, 'psi': 0.6400696614482739}
[S14] START round=38 head_norm_before_train=1.522480 cos_to_last_merge=1.0000 (last merge round=36)
[S14] round=38 local utility u=0.065480 metrics={'f1_val': 0.9972630104447024, 'auprc': 0.9990729265396338, 'loss_val': 0.04253487574700112, 'psi': 0.997986976882675}-{'f1_val': 0.979147727346884, 'auprc': 0.9991623491107013, 'loss_val': 0.06507148483572725, 'psi': 0.987153576052411}
[S15] START round=38 head_norm_before_train=1.525766 cos_to_last_merge=1.0000 (last merge round=37)
[S15] round=38 local utility u=0.000000 metrics={'f1_val': 0.8872593135328978, 'auprc': 0.9904456519246394, 'loss_val': 0.23676310054564934, 'psi': 0.9285338488895944}-{'f1_val': 0.8972347165363974, 'auprc': 0.9851490783554382, 'loss_val': 0.22884540158245378, 'psi': 0.9324004612640138}
[S16] START round=38 head_norm_before_train=1.807987 cos_to_last_merge=0.8074 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.807
[S16] round=38 local utility u=0.000000 metrics={'f1_val': 0.99139557355251, 'auprc': 0.994968793798805, 'loss_val': 0.0413892572943296, 'psi': 0.9928248616510279}-{'f1_val': 0.9924646455200138, 'auprc': 0.9939528064734307, 'loss_val': 0.038548047358385476, 'psi': 0.9930599099013805}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=38 head_norm_before_train=1.968849 cos_to_last_merge=0.9999 (last merge round=35)
[S17] round=38 local utility u=0.013603 metrics={'f1_val': 0.6072639945255108, 'auprc': 0.8642809856180134, 'loss_val': 1.008331613175129, 'psi': 0.7100707909625119}-{'f1_val': 0.6076759509304069, 'auprc': 0.8585883812554163, 'loss_val': 1.020931396327088, 'psi': 0.7080409230604107}
[S3] not sending this round → trigger blocked (psi=0.989)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:54515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:54509
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.992)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=38 metric=0.9961 head_norm=2.174344
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.296375e-02
[S11] stored merged vector for next round verification (round=38)
[S11] DEBUG after merge:  round=38 metric=0.9961 head_norm=2.132114 delta_norm=0.062964
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S17] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:54508
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] RECEIVED delta(kind=head bytes=1797) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.977831)
[S8] loaded HEAD from S17 (vec_in norm=1.977831)
[S8] cosine check vs S17: cos=0.9998
[S8] BUFFERED delta from S17 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1798) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.539745)
[S15] loaded HEAD from S14 (vec_in norm=1.539745)
[S15] cosine check vs S14: cos=0.9991
[S15] BUFFERED delta from S14 (total buffered=1)
[S6] sending update (kind=head size=1799 to 1 peers)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=38 metric=0.6073 head_norm=1.977831
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.443866e-02
[S17] stored merged vector for next round verification (round=38)
[S17] DEBUG after merge:  round=38 metric=0.6074 head_norm=1.970810 delta_norm=0.024439
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=38 metric=0.9973 head_norm=1.539745
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.226243e-02
[S14] stored merged vector for next round verification (round=38)
[S14] DEBUG after merge:  round=38 metric=0.9973 head_norm=1.560336 delta_norm=0.062262
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S7] RECEIVED delta(kind=head bytes=1799) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.674674)
[S7] loaded HEAD from S6 (vec_in norm=1.674674)
[S7] cosine check vs S6: cos=0.8089
[S7] BUFFERED delta from S6 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:54507
[S7] sending update (kind=head size=1797 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1797) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.274847)
[S6] loaded HEAD from S7 (vec_in norm=1.274847)
[S6] cosine check vs S7: cos=0.8089
[S6] BUFFERED delta from S7 (total buffered=1)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=38 metric=0.8960 head_norm=1.674674
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.939186e-01
[S6] stored merged vector for next round verification (round=38)
[S6] DEBUG after merge:  round=38 metric=0.9012 head_norm=1.403898 delta_norm=0.493919
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=38 metric=0.5818 head_norm=1.274847
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.939186e-01
[S7] stored merged vector for next round verification (round=38)
[S7] DEBUG after merge:  round=38 metric=0.5562 head_norm=1.403898 delta_norm=0.493919
[S7] aggregate: ROLLBACK (f1_val pre=0.582 post=0.556 tol_abs=0.005 tol_rel=0.0)
[S2] START round=39 head_norm_before_train=2.103395 cos_to_last_merge=0.9998 (last merge round=35)
[S2] round=39 local utility u=0.039699 metrics={'f1_val': 0.9128509842824671, 'auprc': 0.9596511592529464, 'loss_val': 0.20240503841306623, 'psi': 0.9315710542706588}-{'f1_val': 0.9032004043226846, 'auprc': 0.9682772427118327, 'loss_val': 0.2497785279149212, 'psi': 0.9292311396783438}
[S3] START round=39 head_norm_before_train=1.488285 cos_to_last_merge=0.9991 (last merge round=37)
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.7634200993265959, 'auprc': 0.9935679629467058, 'loss_val': 0.33273192060868245, 'psi': 0.8554792447746399}-{'f1_val': 0.983037983226718, 'auprc': 0.9978954916301734, 'loss_val': 0.09098203241499117, 'psi': 0.9889809865881002}
[S4] START round=39 head_norm_before_train=1.769436 cos_to_last_merge=0.7922 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.792
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.9391385716510585, 'auprc': 0.9279294067865627, 'loss_val': 0.2948749710674521, 'psi': 0.9346549057052602}-{'f1_val': 0.9540311538603639, 'auprc': 0.9693617921107902, 'loss_val': 0.26466238626676925, 'psi': 0.9601634091605344}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=40 psi=0.935 u=0.0000 p_local=0.0313 f1=0.939 auprc=0.928 bytes=37755
[S5] START round=39 head_norm_before_train=1.434570 cos_to_last_merge=0.9993 (last merge round=37)
[S5] round=39 local utility u=1.000000 metrics={'f1_val': 0.8326360012854828, 'auprc': 0.9858113997202624, 'loss_val': 0.22327624030052562, 'psi': 0.8939061606593947}-{'f1_val': 0.6005235609900301, 'auprc': 0.856874444268344, 'loss_val': 0.594562158604931, 'psi': 0.7030639143013557}
[S6] START round=39 head_norm_before_train=1.403898 cos_to_last_merge=1.0000 (last merge round=38)
[S6] round=39 local utility u=0.000000 metrics={'f1_val': 0.618863544468392, 'auprc': 0.784050746529865, 'loss_val': 0.6815171037919726, 'psi': 0.6849384252929812}-{'f1_val': 0.8959518991090012, 'auprc': 0.9471360270704023, 'loss_val': 0.25006976665375624, 'psi': 0.9164255502935617}
[S7] START round=39 head_norm_before_train=1.403898 cos_to_last_merge=1.0000 (last merge round=38)
[S7] round=39 local utility u=0.000000 metrics={'f1_val': 0.44144471942237873, 'auprc': 0.7751553839682052, 'loss_val': 1.1174402313347436, 'psi': 0.5749289852407093}-{'f1_val': 0.5818014302015247, 'auprc': 0.791983632408922, 'loss_val': 0.7035275677725049, 'psi': 0.6658743110844836}
[S8] START round=39 head_norm_before_train=1.967539 cos_to_last_merge=1.0000 (last merge round=37)
[S8] round=39 local utility u=0.003895 metrics={'f1_val': 0.993122746315827, 'auprc': 0.9915419307702389, 'loss_val': 0.03921900061067411, 'psi': 0.9924904200975917}-{'f1_val': 0.993080372776832, 'auprc': 0.9894502095935718, 'loss_val': 0.04047868517234185, 'psi': 0.9916283075035279}
[S9] START round=39 head_norm_before_train=2.031626 cos_to_last_merge=0.8132 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.813
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9962396606400996, 'loss_val': 0.01700974466083611, 'psi': 0.9967576117633256}-{'f1_val': 0.9962710290637395, 'auprc': 0.9991857538552474, 'loss_val': 0.017673551582704707, 'psi': 0.9974369189803427}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=40 psi=0.997 u=0.0000 p_local=0.0037 f1=0.997 auprc=0.996 bytes=37799
[S10] START round=39 head_norm_before_train=1.430767 cos_to_last_merge=0.9520 (last merge round=29)
[S10] round=39 local utility u=0.239144 metrics={'f1_val': 0.9948674007110037, 'auprc': 0.9950403331847502, 'loss_val': 0.08057590175311984, 'psi': 0.9949365737005023}-{'f1_val': 0.9331181514003416, 'auprc': 0.9912995107713609, 'loss_val': 0.17714497999118317, 'psi': 0.9563906951487493}
[S11] START round=39 head_norm_before_train=2.132114 cos_to_last_merge=1.0000 (last merge round=38)
[S11] round=39 local utility u=0.000000 metrics={'f1_val': 0.9908650857109118, 'auprc': 0.9966401210627969, 'loss_val': 0.06080214505271449, 'psi': 0.9931750998516657}-{'f1_val': 0.9961336749133093, 'auprc': 0.9965631078164638, 'loss_val': 0.08399608841774789, 'psi': 0.9963054480745711}
[S13] START round=39 head_norm_before_train=1.287249 cos_to_last_merge=0.9914 (last merge round=28)
[S13] round=39 local utility u=0.000000 metrics={'f1_val': 0.6015158033577886, 'auprc': 0.6836353099056405, 'loss_val': 0.8339121493948115, 'psi': 0.6343636059769293}-{'f1_val': 0.6348287277934999, 'auprc': 0.6673159738197303, 'loss_val': 0.6124341795316599, 'psi': 0.647823626203992}
[S14] START round=39 head_norm_before_train=1.560336 cos_to_last_merge=1.0000 (last merge round=38)
[S14] round=39 local utility u=0.000000 metrics={'f1_val': 0.996177437545643, 'auprc': 0.9970844310171688, 'loss_val': 0.04754799372696231, 'psi': 0.9965402349342534}-{'f1_val': 0.9972630104447024, 'auprc': 0.9990729265396338, 'loss_val': 0.04253487574700112, 'psi': 0.997986976882675}
[S15] START round=39 head_norm_before_train=1.561009 cos_to_last_merge=0.9998 (last merge round=37)
[S15] round=39 local utility u=0.390750 metrics={'f1_val': 0.9903919370001544, 'auprc': 0.9883185559114348, 'loss_val': 0.06767770231158968, 'psi': 0.9895625845646666}-{'f1_val': 0.8872593135328978, 'auprc': 0.9904456519246394, 'loss_val': 0.23676310054564934, 'psi': 0.9285338488895944}
[S16] START round=39 head_norm_before_train=1.815424 cos_to_last_merge=0.8070 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.807
[S16] round=39 local utility u=0.000000 metrics={'f1_val': 0.9435934381395674, 'auprc': 0.9900503776042483, 'loss_val': 0.1890009644790472, 'psi': 0.9621762139254397}-{'f1_val': 0.99139557355251, 'auprc': 0.994968793798805, 'loss_val': 0.0413892572943296, 'psi': 0.9928248616510279}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=40 psi=0.962 u=0.0000 p_local=0.1505 f1=0.944 auprc=0.990 bytes=37694
[S17] START round=39 head_norm_before_train=1.970810 cos_to_last_merge=1.0000 (last merge round=38)
[S17] round=39 local utility u=0.348456 metrics={'f1_val': 0.6178170176511694, 'auprc': 0.980469838897385, 'loss_val': 0.7233041385644962, 'psi': 0.7628781461496557}-{'f1_val': 0.6072639945255108, 'auprc': 0.8642809856180134, 'loss_val': 1.008331613175129, 'psi': 0.7100707909625119}
[S17] not sending this round → trigger blocked (psi=0.763)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:54517
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:54514
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=40 psi=0.995 u=0.2391 p_local=0.1066 f1=0.995 auprc=0.995 bytes=44910
[S14] r=40 psi=0.997 u=0.0000 p_local=0.0172 f1=0.996 auprc=0.997 bytes=48498
[S15] sending update (kind=head size=1801 to 1 peers)
[S11] r=40 psi=0.993 u=0.0000 p_local=0.0256 f1=0.991 auprc=0.997 bytes=46772
[S3] r=40 psi=0.855 u=0.0000 p_local=0.1689 f1=0.763 auprc=0.994 bytes=39589
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:54512
[S13] r=40 psi=0.634 u=0.0000 p_local=0.0521 f1=0.602 auprc=0.684 bytes=32372
[S8] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:54503
[S17] r=40 psi=0.763 u=0.3485 p_local=0.2332 f1=0.618 auprc=0.980 bytes=35963
[S17] RECEIVED delta(kind=head bytes=1798) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.975654)
[S17] loaded HEAD from S8 (vec_in norm=1.975654)
[S17] cosine check vs S8: cos=0.9999
[S17] BUFFERED delta from S8 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1801) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.594866)
[S14] loaded HEAD from S15 (vec_in norm=1.594866)
[S14] cosine check vs S15: cos=0.9996
[S14] BUFFERED delta from S15 (total buffered=1)
[S5] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=39 metric=0.9931 head_norm=1.975654
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.106450e-02
[S8] stored merged vector for next round verification (round=39)
[S8] DEBUG after merge:  round=39 metric=0.9931 head_norm=1.976631 delta_norm=0.021064
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] r=40 psi=0.992 u=0.0039 p_local=0.0095 f1=0.993 auprc=0.992 bytes=43133
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=39 metric=0.9904 head_norm=1.594866
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.332397e-02
[S15] stored merged vector for next round verification (round=39)
[S15] DEBUG after merge:  round=39 metric=0.9902 head_norm=1.566640 delta_norm=0.053324
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] r=40 psi=0.990 u=0.3907 p_local=0.2079 f1=0.990 auprc=0.988 bytes=39565
[S11] RECEIVED delta(kind=head bytes=1800) from S2
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=2.114267)
[S11] loaded HEAD from S2 (vec_in norm=2.114267)
[S11] cosine check vs S2: cos=0.9994
[S11] BUFFERED delta from S2 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1798) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.462901)
[S3] loaded HEAD from S5 (vec_in norm=1.462901)
[S3] cosine check vs S5: cos=0.9821
[S3] BUFFERED delta from S5 (total buffered=1)
[S5] r=40 psi=0.894 u=1.0000 p_local=0.3789 f1=0.833 auprc=0.986 bytes=35990
[S2] r=40 psi=0.932 u=0.0397 p_local=0.1118 f1=0.913 auprc=0.960 bytes=39612
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] r=40 psi=0.575 u=0.0000 p_local=0.1634 f1=0.441 auprc=0.775 bytes=37743
[S6] r=40 psi=0.685 u=0.0000 p_local=0.2713 f1=0.619 auprc=0.784 bytes=43180
[S2] START round=40 head_norm_before_train=2.114267 cos_to_last_merge=0.9996 (last merge round=35)
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.8425715004860951, 'auprc': 0.9894192595845297, 'loss_val': 0.26327588134416857, 'psi': 0.9013106041254689}-{'f1_val': 0.9128509842824671, 'auprc': 0.9596511592529464, 'loss_val': 0.20240503841306623, 'psi': 0.9315710542706588}
[S3] START round=40 head_norm_before_train=1.548509 cos_to_last_merge=0.9971 (last merge round=37)
[S3] round=40 local utility u=0.548271 metrics={'f1_val': 0.9296290174657442, 'auprc': 0.9819593902479284, 'loss_val': 0.19861832128556994, 'psi': 0.9505611665786179}-{'f1_val': 0.7634200993265959, 'auprc': 0.9935679629467058, 'loss_val': 0.33273192060868245, 'psi': 0.8554792447746399}
[S4] START round=40 head_norm_before_train=1.771526 cos_to_last_merge=0.7921 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.792
[S4] round=40 local utility u=0.043361 metrics={'f1_val': 0.945676925025244, 'auprc': 0.9396300876685075, 'loss_val': 0.282485115088219, 'psi': 0.9432581900825494}-{'f1_val': 0.9391385716510585, 'auprc': 0.9279294067865627, 'loss_val': 0.2948749710674521, 'psi': 0.9346549057052602}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=40 head_norm_before_train=1.462901 cos_to_last_merge=0.9978 (last merge round=37)
[S5] round=40 local utility u=0.067523 metrics={'f1_val': 0.8567046472800177, 'auprc': 0.9823571577794539, 'loss_val': 0.2222787607732104, 'psi': 0.9069656514797921}-{'f1_val': 0.8326360012854828, 'auprc': 0.9858113997202624, 'loss_val': 0.22327624030052562, 'psi': 0.8939061606593947}
[S6] START round=40 head_norm_before_train=1.413125 cos_to_last_merge=0.9999 (last merge round=38)
[S6] round=40 local utility u=1.000000 metrics={'f1_val': 0.8245069984215692, 'auprc': 0.95949286531794, 'loss_val': 0.4075510748777252, 'psi': 0.8785013451801176}-{'f1_val': 0.618863544468392, 'auprc': 0.784050746529865, 'loss_val': 0.6815171037919726, 'psi': 0.6849384252929812}
[S7] START round=40 head_norm_before_train=1.420083 cos_to_last_merge=0.9998 (last merge round=38)
[S7] round=40 local utility u=0.986091 metrics={'f1_val': 0.6458276237236837, 'auprc': 0.8225621610867839, 'loss_val': 0.5137769148893907, 'psi': 0.7165214386689238}-{'f1_val': 0.44144471942237873, 'auprc': 0.7751553839682052, 'loss_val': 1.1174402313347436, 'psi': 0.5749289852407093}
[S8] START round=40 head_norm_before_train=1.976631 cos_to_last_merge=1.0000 (last merge round=39)
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.9910860494090681, 'auprc': 0.9865553260858504, 'loss_val': 0.04341008449420144, 'psi': 0.989273760079781}-{'f1_val': 0.993122746315827, 'auprc': 0.9915419307702389, 'loss_val': 0.03921900061067411, 'psi': 0.9924904200975917}
[S9] START round=40 head_norm_before_train=2.042606 cos_to_last_merge=0.8125 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.813
[S9] round=40 local utility u=0.000314 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9965477456642291, 'loss_val': 0.017305393350531707, 'psi': 0.9968808457729773}-{'f1_val': 0.9971029125121428, 'auprc': 0.9962396606400996, 'loss_val': 0.01700974466083611, 'psi': 0.9967576117633256}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=40 head_norm_before_train=1.459577 cos_to_last_merge=0.9482 (last merge round=29)
[S10] ⚠️ Model drifted since last merge! cos=0.948
[S10] round=40 local utility u=0.000000 metrics={'f1_val': 0.933241221920152, 'auprc': 0.9924290593393822, 'loss_val': 0.17431499495804353, 'psi': 0.956916356887844}-{'f1_val': 0.9948674007110037, 'auprc': 0.9950403331847502, 'loss_val': 0.08057590175311984, 'psi': 0.9949365737005023}
[S11] START round=40 head_norm_before_train=2.142384 cos_to_last_merge=1.0000 (last merge round=38)
[S11] round=40 local utility u=0.035931 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9983625703860017, 'loss_val': 0.025718727493160648, 'psi': 0.9970252331023863}-{'f1_val': 0.9908650857109118, 'auprc': 0.9966401210627969, 'loss_val': 0.06080214505271449, 'psi': 0.9931750998516657}
[S13] START round=40 head_norm_before_train=1.296905 cos_to_last_merge=0.9904 (last merge round=28)
[S13] round=40 local utility u=0.000000 metrics={'f1_val': 0.601193837824205, 'auprc': 0.683589293458019, 'loss_val': 0.8483697591016546, 'psi': 0.6341520200777306}-{'f1_val': 0.6015158033577886, 'auprc': 0.6836353099056405, 'loss_val': 0.8339121493948115, 'psi': 0.6343636059769293}
[S14] START round=40 head_norm_before_train=1.575868 cos_to_last_merge=1.0000 (last merge round=38)
[S14] round=40 local utility u=0.007418 metrics={'f1_val': 0.9968300801588782, 'auprc': 0.9987601679289746, 'loss_val': 0.04165504529889812, 'psi': 0.9976021152669168}-{'f1_val': 0.996177437545643, 'auprc': 0.9970844310171688, 'loss_val': 0.04754799372696231, 'psi': 0.9965402349342534}
[S15] START round=40 head_norm_before_train=1.566640 cos_to_last_merge=1.0000 (last merge round=39)
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.9887985800038324, 'auprc': 0.9804002844185907, 'loss_val': 0.08803078936056566, 'psi': 0.9854392617697357}-{'f1_val': 0.9903919370001544, 'auprc': 0.9883185559114348, 'loss_val': 0.06767770231158968, 'psi': 0.9895625845646666}
[S16] START round=40 head_norm_before_train=1.823577 cos_to_last_merge=0.8066 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.807
[S16] round=40 local utility u=0.000000 metrics={'f1_val': 0.9425666743668032, 'auprc': 0.9904908849209761, 'loss_val': 0.238346315865794, 'psi': 0.9617363585884724}-{'f1_val': 0.9435934381395674, 'auprc': 0.9900503776042483, 'loss_val': 0.1890009644790472, 'psi': 0.9621762139254397}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=40 head_norm_before_train=1.978239 cos_to_last_merge=1.0000 (last merge round=38)
[S17] round=40 local utility u=0.000000 metrics={'f1_val': 0.5976440935591238, 'auprc': 0.9352789702213339, 'loss_val': 0.93189054857429, 'psi': 0.7326980442240079}-{'f1_val': 0.6178170176511694, 'auprc': 0.980469838897385, 'loss_val': 0.7233041385644962, 'psi': 0.7628781461496557}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:54505
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:54515
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:54508
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=40 metric=0.9961 head_norm=2.155079
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.486295e-02
[S11] stored merged vector for next round verification (round=40)
[S11] DEBUG after merge:  round=40 metric=0.9961 head_norm=2.134299 delta_norm=0.044863
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S5] not sending this round → trigger blocked (psi=0.907)
[S14] sending update (kind=head size=1801 to 1 peers)
[S8] ⇄ pheromone p=0.008 → S17@127.0.0.1:54517
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=40 metric=0.5976 head_norm=1.985853
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.080988e-02
[S17] stored merged vector for next round verification (round=40)
[S17] DEBUG after merge:  round=40 metric=0.5976 head_norm=1.980651 delta_norm=0.020810
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.187 → S8@127.0.0.1:54509
[S15] ⇄ pheromone p=0.166 → S14@127.0.0.1:54514
[S15] RECEIVED delta(kind=head bytes=1801) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.588057)
[S15] loaded HEAD from S14 (vec_in norm=1.588057)
[S15] cosine check vs S14: cos=0.9998
[S15] BUFFERED delta from S14 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1804) from S3
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.600994)
[S5] loaded HEAD from S3 (vec_in norm=1.600994)
[S5] cosine check vs S3: cos=0.9760
[S5] BUFFERED delta from S3 (total buffered=1)
[S6] sending update (kind=head size=1803 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=40 metric=0.9968 head_norm=1.588057
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.726630e-02
[S14] stored merged vector for next round verification (round=40)
[S14] DEBUG after merge:  round=40 metric=0.9968 head_norm=1.591232 delta_norm=0.027266
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.015 → S15@127.0.0.1:54515
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=40 metric=0.9296 head_norm=1.600994
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.753938e-01
[S3] stored merged vector for next round verification (round=40)
[S3] DEBUG after merge:  round=40 metric=0.9409 head_norm=1.523439 delta_norm=0.175394
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.245 → S5@127.0.0.1:54505
[S7] RECEIVED delta(kind=head bytes=1803) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.425747)
[S7] loaded HEAD from S6 (vec_in norm=1.425747)
[S7] cosine check vs S6: cos=0.9989
[S7] BUFFERED delta from S6 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] → sending delta(kind=head bytes=1806) to S6@127.0.0.1:54507
[S2] ⇄ pheromone p=0.089 → S11@127.0.0.1:54512
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=40 metric=0.8567 head_norm=1.481625
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.790442e-01
[S5] stored merged vector for next round verification (round=40)
[S5] DEBUG after merge:  round=40 metric=0.8471 head_norm=1.532038 delta_norm=0.179044
[S5] aggregate: ROLLBACK (f1_val pre=0.857 post=0.847 tol_abs=0.005 tol_rel=0.0)
[S5] ⇄ pheromone p=0.317 → S3@127.0.0.1:54503
[S7] sending update (kind=head size=1806 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1806) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.434771)
[S6] loaded HEAD from S7 (vec_in norm=1.434771)
[S6] cosine check vs S7: cos=0.9989
[S6] BUFFERED delta from S7 (total buffered=1)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=40 metric=0.8245 head_norm=1.425747
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.353543e-02
[S6] stored merged vector for next round verification (round=40)
[S6] DEBUG after merge:  round=40 metric=0.8245 head_norm=1.429873 delta_norm=0.033535
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.417 → S7@127.0.0.1:54508
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=40 metric=0.6458 head_norm=1.434771
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.353542e-02
[S7] stored merged vector for next round verification (round=40)
[S7] DEBUG after merge:  round=40 metric=0.6474 head_norm=1.429873 delta_norm=0.033535
[S7] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.328 → S6@127.0.0.1:54507
[S2] START round=41 head_norm_before_train=2.123319 cos_to_last_merge=0.9995 (last merge round=35)
[S2] round=41 local utility u=0.136763 metrics={'f1_val': 0.9142904243713168, 'auprc': 0.9108302370649015, 'loss_val': 0.18429673755691328, 'psi': 0.9129063494487507}-{'f1_val': 0.8425715004860951, 'auprc': 0.9894192595845297, 'loss_val': 0.26327588134416857, 'psi': 0.9013106041254689}
[S3] START round=41 head_norm_before_train=1.523439 cos_to_last_merge=1.0000 (last merge round=40)
[S3] round=41 local utility u=0.048578 metrics={'f1_val': 0.931179448570753, 'auprc': 0.996855954352806, 'loss_val': 0.1554548521304324, 'psi': 0.9574500508835742}-{'f1_val': 0.9296290174657442, 'auprc': 0.9819593902479284, 'loss_val': 0.19861832128556994, 'psi': 0.9505611665786179}
[S4] START round=41 head_norm_before_train=1.771860 cos_to_last_merge=0.7922 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.792
[S4] round=41 local utility u=0.070673 metrics={'f1_val': 0.9569638974430601, 'auprc': 0.9581718350320556, 'loss_val': 0.2644861431061457, 'psi': 0.9574470724786582}-{'f1_val': 0.945676925025244, 'auprc': 0.9396300876685075, 'loss_val': 0.282485115088219, 'psi': 0.9432581900825494}
[S4] not sending this round → trigger blocked (psi=0.957)
[S5] START round=41 head_norm_before_train=1.532038 cos_to_last_merge=1.0000 (last merge round=40)
[S5] round=41 local utility u=0.000000 metrics={'f1_val': 0.7324983117708732, 'auprc': 0.9464198717555012, 'loss_val': 0.3580350092184998, 'psi': 0.8180669357647244}-{'f1_val': 0.8567046472800177, 'auprc': 0.9823571577794539, 'loss_val': 0.2222787607732104, 'psi': 0.9069656514797921}
[S6] START round=41 head_norm_before_train=1.429873 cos_to_last_merge=1.0000 (last merge round=40)
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.8214465882335791, 'auprc': 0.9535614885624984, 'loss_val': 0.4424251618783929, 'psi': 0.8742925483651468}-{'f1_val': 0.8245069984215692, 'auprc': 0.95949286531794, 'loss_val': 0.4075510748777252, 'psi': 0.8785013451801176}
[S7] START round=41 head_norm_before_train=1.429873 cos_to_last_merge=1.0000 (last merge round=40)
[S7] round=41 local utility u=0.396331 metrics={'f1_val': 0.6836359488981532, 'auprc': 0.9431505532829901, 'loss_val': 0.30973063558342645, 'psi': 0.787441790652088}-{'f1_val': 0.6458276237236837, 'auprc': 0.8225621610867839, 'loss_val': 0.5137769148893907, 'psi': 0.7165214386689238}
[S8] START round=41 head_norm_before_train=1.985973 cos_to_last_merge=1.0000 (last merge round=39)
[S8] round=41 local utility u=0.015775 metrics={'f1_val': 0.9938130760262815, 'auprc': 0.9891782744469959, 'loss_val': 0.036091120564321545, 'psi': 0.9919591553945672}-{'f1_val': 0.9910860494090681, 'auprc': 0.9865553260858504, 'loss_val': 0.04341008449420144, 'psi': 0.989273760079781}
[S9] START round=41 head_norm_before_train=2.048988 cos_to_last_merge=0.8117 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.812
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.9916655936035601, 'auprc': 0.9991955900675814, 'loss_val': 0.026927508577756717, 'psi': 0.9946775921891686}-{'f1_val': 0.9971029125121428, 'auprc': 0.9965477456642291, 'loss_val': 0.017305393350531707, 'psi': 0.9968808457729773}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=41 head_norm_before_train=1.482466 cos_to_last_merge=0.9454 (last merge round=29)
[S10] ⚠️ Model drifted since last merge! cos=0.945
[S10] round=41 local utility u=0.000000 metrics={'f1_val': 0.8502852608543265, 'auprc': 0.9897991104951773, 'loss_val': 0.3222402295864459, 'psi': 0.9060908007106669}-{'f1_val': 0.933241221920152, 'auprc': 0.9924290593393822, 'loss_val': 0.17431499495804353, 'psi': 0.956916356887844}
[S11] START round=41 head_norm_before_train=2.134299 cos_to_last_merge=1.0000 (last merge round=40)
[S11] round=41 local utility u=0.000000 metrics={'f1_val': 0.9910402456105957, 'auprc': 0.9983160054870854, 'loss_val': 0.044962609548450314, 'psi': 0.9939505495611916}-{'f1_val': 0.9961336749133093, 'auprc': 0.9983625703860017, 'loss_val': 0.025718727493160648, 'psi': 0.9970252331023863}
[S13] START round=41 head_norm_before_train=1.306614 cos_to_last_merge=0.9897 (last merge round=28)
[S13] round=41 local utility u=0.056655 metrics={'f1_val': 0.6139648846917022, 'auprc': 0.6624929992295755, 'loss_val': 0.7483973587827774, 'psi': 0.6333761305068515}-{'f1_val': 0.601193837824205, 'auprc': 0.683589293458019, 'loss_val': 0.8483697591016546, 'psi': 0.6341520200777306}
[S14] START round=41 head_norm_before_train=1.591232 cos_to_last_merge=1.0000 (last merge round=40)
[S14] round=41 local utility u=0.002831 metrics={'f1_val': 0.9970728011695729, 'auprc': 0.9991312333605975, 'loss_val': 0.03856271367934843, 'psi': 0.9978961740459827}-{'f1_val': 0.9968300801588782, 'auprc': 0.9987601679289746, 'loss_val': 0.04165504529889812, 'psi': 0.9976021152669168}
[S15] START round=41 head_norm_before_train=1.599252 cos_to_last_merge=0.9999 (last merge round=39)
[S15] round=41 local utility u=0.038508 metrics={'f1_val': 0.9926580145464438, 'auprc': 0.9882782668441774, 'loss_val': 0.057804506042530304, 'psi': 0.9909061154655372}-{'f1_val': 0.9887985800038324, 'auprc': 0.9804002844185907, 'loss_val': 0.08803078936056566, 'psi': 0.9854392617697357}
[S16] START round=41 head_norm_before_train=1.832555 cos_to_last_merge=0.8062 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.806
[S16] round=41 local utility u=0.100495 metrics={'f1_val': 0.9570550569136118, 'auprc': 0.9924875859702742, 'loss_val': 0.1302758155423781, 'psi': 0.9712280685362767}-{'f1_val': 0.9425666743668032, 'auprc': 0.9904908849209761, 'loss_val': 0.238346315865794, 'psi': 0.9617363585884724}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=41 head_norm_before_train=1.980651 cos_to_last_merge=1.0000 (last merge round=40)
[S17] round=41 local utility u=0.013847 metrics={'f1_val': 0.6005938020899978, 'auprc': 0.944912192677899, 'loss_val': 0.9507940457118016, 'psi': 0.7383211583251583}-{'f1_val': 0.5976440935591238, 'auprc': 0.9352789702213339, 'loss_val': 0.93189054857429, 'psi': 0.7326980442240079}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] sending update (kind=head size=1796 to 1 peers)
[S14] not sending this round → trigger blocked (psi=0.998)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:54509
[S3] not sending this round → trigger blocked (psi=0.957)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:54517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:54514
[S15] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:54512
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1798 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] RECEIVED delta(kind=head bytes=1798) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.988610)
[S8] loaded HEAD from S17 (vec_in norm=1.988610)
[S8] cosine check vs S17: cos=0.9998
[S8] BUFFERED delta from S17 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1802) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.997056)
[S17] loaded HEAD from S8 (vec_in norm=1.997056)
[S17] cosine check vs S8: cos=0.9998
[S17] BUFFERED delta from S8 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1801) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.629805)
[S14] loaded HEAD from S15 (vec_in norm=1.629805)
[S14] cosine check vs S15: cos=0.9997
[S14] BUFFERED delta from S15 (total buffered=1)
[S2] sending update (kind=head size=1798 to 1 peers)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=41 metric=0.6006 head_norm=1.988610
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.814428e-02
[S17] stored merged vector for next round verification (round=41)
[S17] DEBUG after merge:  round=41 metric=0.6006 head_norm=1.992755 delta_norm=0.018144
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=41 metric=0.9938 head_norm=1.997056
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.814428e-02
[S8] stored merged vector for next round verification (round=41)
[S8] DEBUG after merge:  round=41 metric=0.9938 head_norm=1.992755 delta_norm=0.018144
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=41 metric=0.9927 head_norm=1.629805
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.510121e-02
[S15] stored merged vector for next round verification (round=41)
[S15] DEBUG after merge:  round=41 metric=0.9927 head_norm=1.608684 delta_norm=0.035101
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S11] RECEIVED delta(kind=head bytes=1798) from S2
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=2.133566)
[S11] loaded HEAD from S2 (vec_in norm=2.133566)
[S11] cosine check vs S2: cos=0.9996
[S11] BUFFERED delta from S2 (total buffered=1)
[S7] not sending this round → trigger blocked (psi=0.787)
[S2] START round=42 head_norm_before_train=2.133566 cos_to_last_merge=0.9993 (last merge round=35)
[S2] round=42 local utility u=0.029553 metrics={'f1_val': 0.8941988672544489, 'auprc': 0.9902275349764416, 'loss_val': 0.24283318457879047, 'psi': 0.9326103343432459}-{'f1_val': 0.9142904243713168, 'auprc': 0.9108302370649015, 'loss_val': 0.18429673755691328, 'psi': 0.9129063494487507}
[S3] START round=42 head_norm_before_train=1.576030 cos_to_last_merge=0.9996 (last merge round=40)
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.9120587456870088, 'auprc': 0.9696282972729077, 'loss_val': 0.23476917469469444, 'psi': 0.9350865663213683}-{'f1_val': 0.931179448570753, 'auprc': 0.996855954352806, 'loss_val': 0.1554548521304324, 'psi': 0.9574500508835742}
[S4] START round=42 head_norm_before_train=1.773367 cos_to_last_merge=0.7922 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.792
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.942260661354104, 'auprc': 0.9314460772562392, 'loss_val': 0.28698139672216644, 'psi': 0.9379348277149582}-{'f1_val': 0.9569638974430601, 'auprc': 0.9581718350320556, 'loss_val': 0.2644861431061457, 'psi': 0.9574470724786582}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=42 head_norm_before_train=1.545123 cos_to_last_merge=0.9999 (last merge round=40)
[S5] round=42 local utility u=0.000000 metrics={'f1_val': 0.6866597287961764, 'auprc': 0.9489207886530014, 'loss_val': 0.3715576824728839, 'psi': 0.7915641527389065}-{'f1_val': 0.7324983117708732, 'auprc': 0.9464198717555012, 'loss_val': 0.3580350092184998, 'psi': 0.8180669357647244}
[S6] START round=42 head_norm_before_train=1.444901 cos_to_last_merge=0.9999 (last merge round=40)
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.818464185107555, 'auprc': 0.8996623119917185, 'loss_val': 0.40157636584181905, 'psi': 0.8509434358612205}-{'f1_val': 0.8214465882335791, 'auprc': 0.9535614885624984, 'loss_val': 0.4424251618783929, 'psi': 0.8742925483651468}
[S7] START round=42 head_norm_before_train=1.445889 cos_to_last_merge=0.9998 (last merge round=40)
[S7] round=42 local utility u=0.000000 metrics={'f1_val': 0.6195148786805805, 'auprc': 0.8053060305904662, 'loss_val': 0.5646875741843699, 'psi': 0.6938313394445348}-{'f1_val': 0.6836359488981532, 'auprc': 0.9431505532829901, 'loss_val': 0.30973063558342645, 'psi': 0.787441790652088}
[S8] START round=42 head_norm_before_train=1.992755 cos_to_last_merge=1.0000 (last merge round=41)
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.9874934518419147, 'auprc': 0.9865486272112532, 'loss_val': 0.04833393879383062, 'psi': 0.9871155219896501}-{'f1_val': 0.9938130760262815, 'auprc': 0.9891782744469959, 'loss_val': 0.036091120564321545, 'psi': 0.9919591553945672}
[S9] START round=42 head_norm_before_train=2.058873 cos_to_last_merge=0.8110 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.811
[S9] round=42 local utility u=0.018712 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9992015085076956, 'loss_val': 0.017153766981891912, 'psi': 0.997443220841322}-{'f1_val': 0.9916655936035601, 'auprc': 0.9991955900675814, 'loss_val': 0.026927508577756717, 'psi': 0.9946775921891686}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] sending update (kind=head size=1805 to 1 peers)
[S10] START round=42 head_norm_before_train=1.503020 cos_to_last_merge=0.9429 (last merge round=29)
[S10] ⚠️ Model drifted since last merge! cos=0.943
[S10] round=42 local utility u=0.568266 metrics={'f1_val': 0.9934866838477164, 'auprc': 0.9957121789193378, 'loss_val': 0.06265656251485707, 'psi': 0.994376881876365}-{'f1_val': 0.8502852608543265, 'auprc': 0.9897991104951773, 'loss_val': 0.3222402295864459, 'psi': 0.9060908007106669}
[S11] START round=42 head_norm_before_train=2.146628 cos_to_last_merge=1.0000 (last merge round=40)
[S11] round=42 local utility u=0.027181 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.998400487646109, 'loss_val': 0.023894197770336866, 'psi': 0.9972883977665974}-{'f1_val': 0.9910402456105957, 'auprc': 0.9983160054870854, 'loss_val': 0.044962609548450314, 'psi': 0.9939505495611916}
[S13] START round=42 head_norm_before_train=1.314930 cos_to_last_merge=0.9892 (last merge round=28)
[S13] round=42 local utility u=0.019029 metrics={'f1_val': 0.618639191938894, 'auprc': 0.6671754648227071, 'loss_val': 0.7524328058128793, 'psi': 0.6380537010924192}-{'f1_val': 0.6139648846917022, 'auprc': 0.6624929992295755, 'loss_val': 0.7483973587827774, 'psi': 0.6333761305068515}
[S14] START round=42 head_norm_before_train=1.601680 cos_to_last_merge=1.0000 (last merge round=40)
[S14] round=42 local utility u=0.000000 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9988291447218977, 'loss_val': 0.037382754219380615, 'psi': 0.9974839968552093}-{'f1_val': 0.9970728011695729, 'auprc': 0.9991312333605975, 'loss_val': 0.03856271367934843, 'psi': 0.9978961740459827}
[S15] START round=42 head_norm_before_train=1.608684 cos_to_last_merge=1.0000 (last merge round=41)
[S15] round=42 local utility u=0.000000 metrics={'f1_val': 0.7582987567402559, 'auprc': 0.8719142428757943, 'loss_val': 0.3354800100108221, 'psi': 0.8037449511944712}-{'f1_val': 0.9926580145464438, 'auprc': 0.9882782668441774, 'loss_val': 0.057804506042530304, 'psi': 0.9909061154655372}
[S16] START round=42 head_norm_before_train=1.841958 cos_to_last_merge=0.8058 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.806
[S16] round=42 local utility u=0.137556 metrics={'f1_val': 0.988411141279676, 'auprc': 0.9959730749282202, 'loss_val': 0.05375663381148766, 'psi': 0.9914359147390936}-{'f1_val': 0.9570550569136118, 'auprc': 0.9924875859702742, 'loss_val': 0.1302758155423781, 'psi': 0.9712280685362767}
[S16] not sending this round → trigger blocked (psi=0.991)
[S17] START round=42 head_norm_before_train=1.992755 cos_to_last_merge=1.0000 (last merge round=41)
[S17] round=42 local utility u=0.583790 metrics={'f1_val': 0.7169187445269165, 'auprc': 0.9865767883666234, 'loss_val': 0.6061583644559982, 'psi': 0.8247819620627993}-{'f1_val': 0.6005938020899978, 'auprc': 0.944912192677899, 'loss_val': 0.9507940457118016, 'psi': 0.7383211583251583}
[S10]  timeout peer S5
[S13]  timeout peer S10
[S2]  timeout peer S6
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:54502
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.825)
[S13] not sending this round → trigger blocked (psi=0.638)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.933)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1801 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=42 metric=0.9966 head_norm=1.613620
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.517744e-02
[S14] stored merged vector for next round verification (round=42)
[S14] DEBUG after merge:  round=42 metric=0.9966 head_norm=1.621537 delta_norm=0.025177
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] RECEIVED delta(kind=head bytes=1801) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=2.157231)
[S2] loaded HEAD from S11 (vec_in norm=2.157231)
[S2] cosine check vs S11: cos=0.9994
[S2] BUFFERED delta from S11 (total buffered=1)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=42 metric=0.9965 head_norm=2.157231
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.495934e-02
[S11] stored merged vector for next round verification (round=42)
[S11] DEBUG after merge:  round=42 metric=0.9965 head_norm=2.145146 delta_norm=0.034959
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=42 metric=0.8942 head_norm=2.142336
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.705413e-02
[S2] stored merged vector for next round verification (round=42)
[S2] DEBUG after merge:  round=42 metric=0.8948 head_norm=2.149477 delta_norm=0.037054
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=43 head_norm_before_train=2.149477 cos_to_last_merge=1.0000 (last merge round=42)
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.877463601034066, 'auprc': 0.9903816284459004, 'loss_val': 0.24974951702249315, 'psi': 0.9226308119987997}-{'f1_val': 0.8941988672544489, 'auprc': 0.9902275349764416, 'loss_val': 0.24283318457879047, 'psi': 0.9326103343432459}
[S3] START round=43 head_norm_before_train=1.624503 cos_to_last_merge=0.9986 (last merge round=40)
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.8730297777417068, 'auprc': 0.9959064848174863, 'loss_val': 0.22936627400423037, 'psi': 0.9221804605720186}-{'f1_val': 0.9120587456870088, 'auprc': 0.9696282972729077, 'loss_val': 0.23476917469469444, 'psi': 0.9350865663213683}
[S4] START round=43 head_norm_before_train=1.778989 cos_to_last_merge=0.7917 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.792
[S4] round=43 local utility u=0.007501 metrics={'f1_val': 0.9406818894332843, 'auprc': 0.9398612861738869, 'loss_val': 0.28775200159250636, 'psi': 0.9403536481295254}-{'f1_val': 0.942260661354104, 'auprc': 0.9314460772562392, 'loss_val': 0.28698139672216644, 'psi': 0.9379348277149582}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=43 head_norm_before_train=1.558175 cos_to_last_merge=0.9997 (last merge round=40)
[S5] round=43 local utility u=0.000000 metrics={'f1_val': 0.5782926830456281, 'auprc': 0.8424587065776302, 'loss_val': 0.7110089840872735, 'psi': 0.6839590924584289}-{'f1_val': 0.6866597287961764, 'auprc': 0.9489207886530014, 'loss_val': 0.3715576824728839, 'psi': 0.7915641527389065}
[S6] START round=43 head_norm_before_train=1.465068 cos_to_last_merge=0.9995 (last merge round=40)
[S6] round=43 local utility u=0.614809 metrics={'f1_val': 0.9617024817966042, 'auprc': 0.958319232730008, 'loss_val': 0.20735898897021193, 'psi': 0.9603491821699657}-{'f1_val': 0.818464185107555, 'auprc': 0.8996623119917185, 'loss_val': 0.40157636584181905, 'psi': 0.8509434358612205}
[S7] START round=43 head_norm_before_train=1.461032 cos_to_last_merge=0.9994 (last merge round=40)
[S7] round=43 local utility u=0.000000 metrics={'f1_val': 0.5527723701370633, 'auprc': 0.7885821052574584, 'loss_val': 0.7666068202167925, 'psi': 0.6470962641852214}-{'f1_val': 0.6195148786805805, 'auprc': 0.8053060305904662, 'loss_val': 0.5646875741843699, 'psi': 0.6938313394445348}
[S8] START round=43 head_norm_before_train=2.003638 cos_to_last_merge=1.0000 (last merge round=41)
[S8] round=43 local utility u=0.000000 metrics={'f1_val': 0.9846567949518252, 'auprc': 0.9866488477265736, 'loss_val': 0.0566054970097917, 'psi': 0.9854536160617245}-{'f1_val': 0.9874934518419147, 'auprc': 0.9865486272112532, 'loss_val': 0.04833393879383062, 'psi': 0.9871155219896501}
[S9] START round=43 head_norm_before_train=2.067509 cos_to_last_merge=0.8103 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.810
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9970503815962539, 'loss_val': 0.01657901053289208, 'psi': 0.9970819001457872}-{'f1_val': 0.9962710290637395, 'auprc': 0.9992015085076956, 'loss_val': 0.017153766981891912, 'psi': 0.997443220841322}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=43 head_norm_before_train=1.518313 cos_to_last_merge=0.9411 (last merge round=29)
[S10] ⚠️ Model drifted since last merge! cos=0.941
[S10] round=43 local utility u=0.000000 metrics={'f1_val': 0.9421455965178237, 'auprc': 0.99090661943231, 'loss_val': 0.14296453490835268, 'psi': 0.9616500056836181}-{'f1_val': 0.9934866838477164, 'auprc': 0.9957121789193378, 'loss_val': 0.06265656251485707, 'psi': 0.994376881876365}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=43 head_norm_before_train=2.145146 cos_to_last_merge=1.0000 (last merge round=42)
[S11] round=43 local utility u=0.000145 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9984930440423434, 'loss_val': 0.023882865624110926, 'psi': 0.9973254203250911}-{'f1_val': 0.9965470045135896, 'auprc': 0.998400487646109, 'loss_val': 0.023894197770336866, 'psi': 0.9972883977665974}
[S13] START round=43 head_norm_before_train=1.323028 cos_to_last_merge=0.9889 (last merge round=28)
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.61272750837366, 'auprc': 0.6685047632802715, 'loss_val': 0.7937260386362571, 'psi': 0.6350384103363046}-{'f1_val': 0.618639191938894, 'auprc': 0.6671754648227071, 'loss_val': 0.7524328058128793, 'psi': 0.6380537010924192}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=43 head_norm_before_train=1.621537 cos_to_last_merge=1.0000 (last merge round=42)
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.9965909138827574, 'auprc': 0.9987735630251167, 'loss_val': 0.0402745546252236, 'psi': 0.9974639735397011}-{'f1_val': 0.9965872316107504, 'auprc': 0.9988291447218977, 'loss_val': 0.037382754219380615, 'psi': 0.9974839968552093}
[S15] START round=43 head_norm_before_train=1.632546 cos_to_last_merge=0.9999 (last merge round=41)
[S15] round=43 local utility u=1.000000 metrics={'f1_val': 0.991642025226638, 'auprc': 0.9899449994580664, 'loss_val': 0.05402272142099601, 'psi': 0.9909632149192094}-{'f1_val': 0.7582987567402559, 'auprc': 0.8719142428757943, 'loss_val': 0.3354800100108221, 'psi': 0.8037449511944712}
[S16] START round=43 head_norm_before_train=1.851548 cos_to_last_merge=0.8054 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.805
[S16] round=43 local utility u=0.015098 metrics={'f1_val': 0.9914628528083289, 'auprc': 0.9961154512250103, 'loss_val': 0.042297989546695544, 'psi': 0.9933238921750015}-{'f1_val': 0.988411141279676, 'auprc': 0.9959730749282202, 'loss_val': 0.05375663381148766, 'psi': 0.9914359147390936}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=43 head_norm_before_train=1.998911 cos_to_last_merge=1.0000 (last merge round=41)
[S17] round=43 local utility u=0.000000 metrics={'f1_val': 0.6151951316873894, 'auprc': 0.8495695297023704, 'loss_val': 1.073460412543616, 'psi': 0.7089448908933818}-{'f1_val': 0.7169187445269165, 'auprc': 0.9865767883666234, 'loss_val': 0.6061583644559982, 'psi': 0.8247819620627993}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:54514
[S11] not sending this round → trigger blocked (psi=0.997)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:54508
[S15] sending update (kind=head size=1803 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1803) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.655031)
[S14] loaded HEAD from S15 (vec_in norm=1.655031)
[S14] cosine check vs S15: cos=0.9997
[S14] BUFFERED delta from S15 (total buffered=1)
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1801) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.490578)
[S7] loaded HEAD from S6 (vec_in norm=1.490578)
[S7] cosine check vs S6: cos=0.9970
[S7] BUFFERED delta from S6 (total buffered=1)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=43 metric=0.5528 head_norm=1.480068
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.779938e-02
[S7] stored merged vector for next round verification (round=43)
[S7] DEBUG after merge:  round=43 metric=0.5497 head_norm=1.484208 delta_norm=0.057799
[S7] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=44 head_norm_before_train=2.158048 cos_to_last_merge=1.0000 (last merge round=42)
[S2] round=44 local utility u=0.101358 metrics={'f1_val': 0.9056023264819006, 'auprc': 0.9915904466485205, 'loss_val': 0.21949266506603532, 'psi': 0.9399975745485485}-{'f1_val': 0.877463601034066, 'auprc': 0.9903816284459004, 'loss_val': 0.24974951702249315, 'psi': 0.9226308119987997}
[S3] START round=44 head_norm_before_train=1.665249 cos_to_last_merge=0.9974 (last merge round=40)
[S3] round=44 local utility u=0.241814 metrics={'f1_val': 0.9522165639571257, 'auprc': 0.9784574170867162, 'loss_val': 0.16851115417443155, 'psi': 0.9627129052089618}-{'f1_val': 0.8730297777417068, 'auprc': 0.9959064848174863, 'loss_val': 0.22936627400423037, 'psi': 0.9221804605720186}
[S4] START round=44 head_norm_before_train=1.788987 cos_to_last_merge=0.7908 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.791
[S4] round=44 local utility u=0.000000 metrics={'f1_val': 0.9405364292520225, 'auprc': 0.9322538536101443, 'loss_val': 0.29354391624253534, 'psi': 0.9372233989952712}-{'f1_val': 0.9406818894332843, 'auprc': 0.9398612861738869, 'loss_val': 0.28775200159250636, 'psi': 0.9403536481295254}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=44 head_norm_before_train=1.567582 cos_to_last_merge=0.9995 (last merge round=40)
[S5] round=44 local utility u=0.102718 metrics={'f1_val': 0.6221030125577167, 'auprc': 0.801501282506552, 'loss_val': 0.6455635933539504, 'psi': 0.6938623205372508}-{'f1_val': 0.5782926830456281, 'auprc': 0.8424587065776302, 'loss_val': 0.7110089840872735, 'psi': 0.6839590924584289}
[S6] START round=44 head_norm_before_train=1.490578 cos_to_last_merge=0.9988 (last merge round=40)
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.6203800764110617, 'auprc': 0.9434129571613941, 'loss_val': 0.651373141867286, 'psi': 0.7495932287111947}-{'f1_val': 0.9617024817966042, 'auprc': 0.958319232730008, 'loss_val': 0.20735898897021193, 'psi': 0.9603491821699657}
[S7] START round=44 head_norm_before_train=1.484208 cos_to_last_merge=1.0000 (last merge round=43)
[S7] round=44 local utility u=0.000000 metrics={'f1_val': 0.4850272079435125, 'auprc': 0.7826829029116098, 'loss_val': 0.9320711761156093, 'psi': 0.6040894859307515}-{'f1_val': 0.5527723701370633, 'auprc': 0.7885821052574584, 'loss_val': 0.7666068202167925, 'psi': 0.6470962641852214}
[S8] START round=44 head_norm_before_train=2.013048 cos_to_last_merge=1.0000 (last merge round=41)
[S8] round=44 local utility u=0.020108 metrics={'f1_val': 0.9875357054597707, 'auprc': 0.9907776783427381, 'loss_val': 0.046049377995785575, 'psi': 0.9888324946129576}-{'f1_val': 0.9846567949518252, 'auprc': 0.9866488477265736, 'loss_val': 0.0566054970097917, 'psi': 0.9854536160617245}
[S9] START round=44 head_norm_before_train=2.071329 cos_to_last_merge=0.8098 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.810
[S9] round=44 local utility u=0.000011 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9970494523027467, 'loss_val': 0.01655464660527116, 'psi': 0.9970815284283844}-{'f1_val': 0.9971029125121428, 'auprc': 0.9970503815962539, 'loss_val': 0.01657901053289208, 'psi': 0.9970819001457872}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=44 head_norm_before_train=1.532265 cos_to_last_merge=0.9395 (last merge round=29)
[S10] ⚠️ Model drifted since last merge! cos=0.939
[S10] round=44 local utility u=0.198834 metrics={'f1_val': 0.9929110311196298, 'auprc': 0.994036854105145, 'loss_val': 0.05927926345281423, 'psi': 0.9933613603138358}-{'f1_val': 0.9421455965178237, 'auprc': 0.99090661943231, 'loss_val': 0.14296453490835268, 'psi': 0.9616500056836181}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] sending update (kind=head size=1793 to 1 peers)
[S11] START round=44 head_norm_before_train=2.152649 cos_to_last_merge=1.0000 (last merge round=42)
[S11] round=44 local utility u=0.000120 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9984322561853817, 'loss_val': 0.02346014339737167, 'psi': 0.9973011051823064}-{'f1_val': 0.9965470045135896, 'auprc': 0.9984930440423434, 'loss_val': 0.023882865624110926, 'psi': 0.9973254203250911}
[S13] START round=44 head_norm_before_train=1.329679 cos_to_last_merge=0.9880 (last merge round=28)
[S13] round=44 local utility u=0.009599 metrics={'f1_val': 0.6139253607236727, 'auprc': 0.6692471144428813, 'loss_val': 0.7839412109995042, 'psi': 0.6360540622113562}-{'f1_val': 0.61272750837366, 'auprc': 0.6685047632802715, 'loss_val': 0.7937260386362571, 'psi': 0.6350384103363046}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=44 head_norm_before_train=1.635503 cos_to_last_merge=1.0000 (last merge round=42)
[S14] round=44 local utility u=0.002488 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9987379246685488, 'loss_val': 0.035169057893957106, 'psi': 0.9974475088338697}-{'f1_val': 0.9965909138827574, 'auprc': 0.9987735630251167, 'loss_val': 0.0402745546252236, 'psi': 0.9974639735397011}
[S15] START round=44 head_norm_before_train=1.655031 cos_to_last_merge=0.9998 (last merge round=41)
[S15] round=44 local utility u=0.000000 metrics={'f1_val': 0.9889395452505957, 'auprc': 0.980099191365567, 'loss_val': 0.07744510679550226, 'psi': 0.9854034036965842}-{'f1_val': 0.991642025226638, 'auprc': 0.9899449994580664, 'loss_val': 0.05402272142099601, 'psi': 0.9909632149192094}
[S16] START round=44 head_norm_before_train=1.860694 cos_to_last_merge=0.8050 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.805
[S16] round=44 local utility u=0.000000 metrics={'f1_val': 0.8634698631301654, 'auprc': 0.9596177196936202, 'loss_val': 0.7700152036973069, 'psi': 0.9019290057555474}-{'f1_val': 0.9914628528083289, 'auprc': 0.9961154512250103, 'loss_val': 0.042297989546695544, 'psi': 0.9933238921750015}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=44 head_norm_before_train=2.005257 cos_to_last_merge=0.9998 (last merge round=41)
[S17] round=44 local utility u=0.000000 metrics={'f1_val': 0.6105751522262687, 'auprc': 0.8469254939424667, 'loss_val': 1.0491901280875158, 'psi': 0.7051152889127479}-{'f1_val': 0.6151951316873894, 'auprc': 0.8495695297023704, 'loss_val': 1.073460412543616, 'psi': 0.7089448908933818}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:54515
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:54517
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:54502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:54503
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1796) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=2.018811)
[S17] loaded HEAD from S8 (vec_in norm=2.018811)
[S17] cosine check vs S8: cos=0.9996
[S17] BUFFERED delta from S8 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1797) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.647897)
[S15] loaded HEAD from S14 (vec_in norm=1.647897)
[S15] cosine check vs S14: cos=0.9993
[S15] BUFFERED delta from S14 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1798) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=2.159639)
[S2] loaded HEAD from S11 (vec_in norm=2.159639)
[S2] cosine check vs S11: cos=0.9999
[S2] BUFFERED delta from S11 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1798) from S3
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.701181)
[S5] loaded HEAD from S3 (vec_in norm=1.701181)
[S5] cosine check vs S3: cos=0.9933
[S5] BUFFERED delta from S3 (total buffered=1)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=44 metric=0.9966 head_norm=1.647897
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.310418e-02
[S14] stored merged vector for next round verification (round=44)
[S14] DEBUG after merge:  round=44 metric=0.9966 head_norm=1.651307 delta_norm=0.023104
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] sending update (kind=head size=1798 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1798) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.580793)
[S3] loaded HEAD from S5 (vec_in norm=1.580793)
[S3] cosine check vs S5: cos=0.9933
[S3] BUFFERED delta from S5 (total buffered=1)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=44 metric=0.6221 head_norm=1.580793
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.125864e-01
[S5] stored merged vector for next round verification (round=44)
[S5] DEBUG after merge:  round=44 metric=0.6248 head_norm=1.638226 delta_norm=0.112586
[S5] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=45 head_norm_before_train=2.167031 cos_to_last_merge=1.0000 (last merge round=42)
[S2] round=45 local utility u=0.018641 metrics={'f1_val': 0.912404466545891, 'auprc': 0.9909343349372222, 'loss_val': 0.22105573010780805, 'psi': 0.9438164139024234}-{'f1_val': 0.9056023264819006, 'auprc': 0.9915904466485205, 'loss_val': 0.21949266506603532, 'psi': 0.9399975745485485}
[S3] START round=45 head_norm_before_train=1.701181 cos_to_last_merge=0.9961 (last merge round=40)
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.8110859658351918, 'auprc': 0.9965900427865524, 'loss_val': 0.3765603510848571, 'psi': 0.8852875966157361}-{'f1_val': 0.9522165639571257, 'auprc': 0.9784574170867162, 'loss_val': 0.16851115417443155, 'psi': 0.9627129052089618}
[S4] START round=45 head_norm_before_train=1.794599 cos_to_last_merge=0.7902 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.790
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.939906098072036, 'auprc': 0.9289739909526777, 'loss_val': 0.29826544032368624, 'psi': 0.9355332552242926}-{'f1_val': 0.9405364292520225, 'auprc': 0.9322538536101443, 'loss_val': 0.29354391624253534, 'psi': 0.9372233989952712}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=45 head_norm_before_train=1.638226 cos_to_last_merge=1.0000 (last merge round=44)
[S5] round=45 local utility u=1.000000 metrics={'f1_val': 0.8974253530935797, 'auprc': 0.9819151796115209, 'loss_val': 0.19373097565489333, 'psi': 0.9312212837007563}-{'f1_val': 0.6221030125577167, 'auprc': 0.801501282506552, 'loss_val': 0.6455635933539504, 'psi': 0.6938623205372508}
[S6] START round=45 head_norm_before_train=1.510417 cos_to_last_merge=0.9979 (last merge round=40)
[S6] round=45 local utility u=0.643333 metrics={'f1_val': 0.8015917928970661, 'auprc': 0.9371132698559672, 'loss_val': 0.4330789186836003, 'psi': 0.8558003836806265}-{'f1_val': 0.6203800764110617, 'auprc': 0.9434129571613941, 'loss_val': 0.651373141867286, 'psi': 0.7495932287111947}
[S7] START round=45 head_norm_before_train=1.499022 cos_to_last_merge=0.9999 (last merge round=43)
[S7] round=45 local utility u=1.000000 metrics={'f1_val': 0.6756575348522844, 'auprc': 0.9575236000840471, 'loss_val': 0.3651882766410325, 'psi': 0.7884039609449895}-{'f1_val': 0.4850272079435125, 'auprc': 0.7826829029116098, 'loss_val': 0.9320711761156093, 'psi': 0.6040894859307515}
[S8] START round=45 head_norm_before_train=2.018811 cos_to_last_merge=0.9999 (last merge round=41)
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.9746695083837247, 'auprc': 0.9892916776852397, 'loss_val': 0.06844045999709511, 'psi': 0.9805183761043307}-{'f1_val': 0.9875357054597707, 'auprc': 0.9907776783427381, 'loss_val': 0.046049377995785575, 'psi': 0.9888324946129576}
[S9] START round=45 head_norm_before_train=2.079357 cos_to_last_merge=0.8092 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.809
[S9] round=45 local utility u=0.000000 metrics={'f1_val': 0.9958557717480525, 'auprc': 0.9991888243773599, 'loss_val': 0.01832275388335553, 'psi': 0.9971889927997755}-{'f1_val': 0.9971029125121428, 'auprc': 0.9970494523027467, 'loss_val': 0.01655464660527116, 'psi': 0.9970815284283844}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=45 head_norm_before_train=1.547785 cos_to_last_merge=0.9377 (last merge round=29)
[S10] ⚠️ Model drifted since last merge! cos=0.938
[S10] round=45 local utility u=0.000000 metrics={'f1_val': 0.8619439027299012, 'auprc': 0.9906944833796587, 'loss_val': 0.31406363940538706, 'psi': 0.9134441349898043}-{'f1_val': 0.9929110311196298, 'auprc': 0.994036854105145, 'loss_val': 0.05927926345281423, 'psi': 0.9933613603138358}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=45 head_norm_before_train=2.159639 cos_to_last_merge=1.0000 (last merge round=42)
[S11] round=45 local utility u=0.000066 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9984003639770147, 'loss_val': 0.02323184255648556, 'psi': 0.9972883482989596}-{'f1_val': 0.9965470045135896, 'auprc': 0.9984322561853817, 'loss_val': 0.02346014339737167, 'psi': 0.9973011051823064}
[S13] START round=45 head_norm_before_train=1.336512 cos_to_last_merge=0.9867 (last merge round=28)
[S13] round=45 local utility u=0.000000 metrics={'f1_val': 0.6110698581390414, 'auprc': 0.6818954251162359, 'loss_val': 0.8133084169496343, 'psi': 0.6394000849299192}-{'f1_val': 0.6139253607236727, 'auprc': 0.6692471144428813, 'loss_val': 0.7839412109995042, 'psi': 0.6360540622113562}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=45 head_norm_before_train=1.651307 cos_to_last_merge=1.0000 (last merge round=44)
[S14] round=45 local utility u=0.002387 metrics={'f1_val': 0.9968300801588782, 'auprc': 0.9989652126825526, 'loss_val': 0.03253420501564156, 'psi': 0.9976841331683479}-{'f1_val': 0.9965872316107504, 'auprc': 0.9987379246685488, 'loss_val': 0.035169057893957106, 'psi': 0.9974475088338697}
[S15] START round=45 head_norm_before_train=1.677084 cos_to_last_merge=0.9995 (last merge round=41)
[S15] round=45 local utility u=0.000000 metrics={'f1_val': 0.893308527534261, 'auprc': 0.9667955352139851, 'loss_val': 0.2626820061688242, 'psi': 0.9227033306061506}-{'f1_val': 0.9889395452505957, 'auprc': 0.980099191365567, 'loss_val': 0.07744510679550226, 'psi': 0.9854034036965842}
[S16] START round=45 head_norm_before_train=1.863233 cos_to_last_merge=0.8042 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.804
[S16] round=45 local utility u=0.000000 metrics={'f1_val': 0.8394557173836202, 'auprc': 0.8297890703861613, 'loss_val': 1.1096833289584551, 'psi': 0.8355890585846366}-{'f1_val': 0.8634698631301654, 'auprc': 0.9596177196936202, 'loss_val': 0.7700152036973069, 'psi': 0.9019290057555474}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=45 head_norm_before_train=2.012396 cos_to_last_merge=0.9997 (last merge round=41)
[S17] round=45 local utility u=0.123060 metrics={'f1_val': 0.5989903605620022, 'auprc': 0.8827452290940874, 'loss_val': 0.8410207898203954, 'psi': 0.7124923079748362}-{'f1_val': 0.6105751522262687, 'auprc': 0.8469254939424667, 'loss_val': 1.0491901280875158, 'psi': 0.7051152889127479}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:54502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:54509
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:54515
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=45 metric=0.8111 head_norm=1.727807
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.281965e-01
[S3] stored merged vector for next round verification (round=45)
[S3] DEBUG after merge:  round=45 metric=0.8138 head_norm=1.650962 delta_norm=0.128196
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.123 → S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:54508
[S17] sending update (kind=head size=1793 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=45 metric=0.8933 head_norm=1.696811
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.475567e-02
[S15] stored merged vector for next round verification (round=45)
[S15] DEBUG after merge:  round=45 metric=0.8935 head_norm=1.671934 delta_norm=0.044756
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.186 → S14@127.0.0.1:54514
[S8] ⇄ pheromone p=0.007 → S17@127.0.0.1:54517
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=45 metric=0.9124 head_norm=2.175670
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.037423e-02
[S2] stored merged vector for next round verification (round=45)
[S2] DEBUG after merge:  round=45 metric=0.9124 head_norm=2.167573 delta_norm=0.020374
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:54503
[S8] RECEIVED delta(kind=head bytes=1793) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=2.018639)
[S8] loaded HEAD from S17 (vec_in norm=2.018639)
[S8] cosine check vs S17: cos=0.9994
[S8] BUFFERED delta from S17 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1800) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=2.168636)
[S2] loaded HEAD from S11 (vec_in norm=2.168636)
[S2] cosine check vs S11: cos=0.9999
[S2] BUFFERED delta from S11 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1799) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.663826)
[S15] loaded HEAD from S14 (vec_in norm=1.663826)
[S15] cosine check vs S14: cos=0.9999
[S15] BUFFERED delta from S14 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:54507
[S5] sending update (kind=head size=1803 to 1 peers)
[S14] ⇄ pheromone p=0.006 → S15@127.0.0.1:54515
[S11] ⇄ pheromone p=0.012 → S2@127.0.0.1:54502
[S6] sending update (kind=head size=1797 to 1 peers)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=45 metric=0.5990 head_norm=2.018639
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.342780e-02
[S17] stored merged vector for next round verification (round=45)
[S17] DEBUG after merge:  round=45 metric=0.5993 head_norm=2.018448 delta_norm=0.033428
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.147 → S8@127.0.0.1:54509
[S7] RECEIVED delta(kind=head bytes=1797) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.527142)
[S7] loaded HEAD from S6 (vec_in norm=1.527142)
[S7] cosine check vs S6: cos=0.9969
[S7] BUFFERED delta from S6 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1803) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.651795)
[S3] loaded HEAD from S5 (vec_in norm=1.651795)
[S3] cosine check vs S5: cos=0.9999
[S3] BUFFERED delta from S5 (total buffered=1)
[S7] sending update (kind=head size=1801 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1801) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.511029)
[S6] loaded HEAD from S7 (vec_in norm=1.511029)
[S6] cosine check vs S7: cos=0.9969
[S6] BUFFERED delta from S7 (total buffered=1)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=45 metric=0.8016 head_norm=1.527142
[S6] _apply_head_vector_avg (torch): Δ‖w‖=6.071950e-02
[S6] stored merged vector for next round verification (round=45)
[S6] DEBUG after merge:  round=45 metric=0.7981 head_norm=1.517892 delta_norm=0.060719
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.344 → S7@127.0.0.1:54508
[S5] ⇄ pheromone p=0.320 → S3@127.0.0.1:54503
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=45 metric=0.6757 head_norm=1.511029
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.071950e-02
[S7] stored merged vector for next round verification (round=45)
[S7] DEBUG after merge:  round=45 metric=0.6723 head_norm=1.517892 delta_norm=0.060720
[S7] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.340 → S6@127.0.0.1:54507
[S2] START round=46 head_norm_before_train=2.167573 cos_to_last_merge=1.0000 (last merge round=45)
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.9115296049161091, 'auprc': 0.9870114495295517, 'loss_val': 0.2382696189426945, 'psi': 0.9417223427614861}-{'f1_val': 0.912404466545891, 'auprc': 0.9909343349372222, 'loss_val': 0.22105573010780805, 'psi': 0.9438164139024234}
[S3] START round=46 head_norm_before_train=1.650962 cos_to_last_merge=1.0000 (last merge round=45)
[S3] round=46 local utility u=0.300830 metrics={'f1_val': 0.89979348258146, 'auprc': 0.9717415228869777, 'loss_val': 0.23260020235707676, 'psi': 0.9285726987036671}-{'f1_val': 0.8110859658351918, 'auprc': 0.9965900427865524, 'loss_val': 0.3765603510848571, 'psi': 0.8852875966157361}
[S4] START round=46 head_norm_before_train=1.797417 cos_to_last_merge=0.7898 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.790
[S4] round=46 local utility u=0.023853 metrics={'f1_val': 0.9413106570302539, 'auprc': 0.939135496154636, 'loss_val': 0.28947216529472886, 'psi': 0.9404405926800067}-{'f1_val': 0.939906098072036, 'auprc': 0.9289739909526777, 'loss_val': 0.29826544032368624, 'psi': 0.9355332552242926}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=46 head_norm_before_train=1.651795 cos_to_last_merge=0.9999 (last merge round=44)
[S5] round=46 local utility u=0.000000 metrics={'f1_val': 0.8011886573179372, 'auprc': 0.9875046615437539, 'loss_val': 0.21177295242782757, 'psi': 0.8757150590082639}-{'f1_val': 0.8974253530935797, 'auprc': 0.9819151796115209, 'loss_val': 0.19373097565489333, 'psi': 0.9312212837007563}
[S6] START round=46 head_norm_before_train=1.517892 cos_to_last_merge=1.0000 (last merge round=45)
[S6] round=46 local utility u=0.585738 metrics={'f1_val': 0.9595353484470416, 'auprc': 0.9462786551278123, 'loss_val': 0.23676033811334946, 'psi': 0.9542326711193498}-{'f1_val': 0.8015917928970661, 'auprc': 0.9371132698559672, 'loss_val': 0.4330789186836003, 'psi': 0.8558003836806265}
[S7] START round=46 head_norm_before_train=1.517892 cos_to_last_merge=1.0000 (last merge round=45)
[S7] round=46 local utility u=0.000000 metrics={'f1_val': 0.6631013983506988, 'auprc': 0.8736930195352564, 'loss_val': 0.376697132072467, 'psi': 0.7473380468245219}-{'f1_val': 0.6756575348522844, 'auprc': 0.9575236000840471, 'loss_val': 0.3651882766410325, 'psi': 0.7884039609449895}
[S8] START round=46 head_norm_before_train=2.025162 cos_to_last_merge=0.9998 (last merge round=41)
[S8] round=46 local utility u=0.070866 metrics={'f1_val': 0.9923498862294302, 'auprc': 0.9904289955904713, 'loss_val': 0.0362032092243382, 'psi': 0.9915815299738466}-{'f1_val': 0.9746695083837247, 'auprc': 0.9892916776852397, 'loss_val': 0.06844045999709511, 'psi': 0.9805183761043307}
[S9] START round=46 head_norm_before_train=2.086610 cos_to_last_merge=0.8087 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.809
[S9] round=46 local utility u=0.002036 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9991962092415365, 'loss_val': 0.016765085260294157, 'psi': 0.9974411011348583}-{'f1_val': 0.9958557717480525, 'auprc': 0.9991888243773599, 'loss_val': 0.01832275388335553, 'psi': 0.9971889927997755}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=46 head_norm_before_train=1.563821 cos_to_last_merge=0.9358 (last merge round=29)
[S10] ⚠️ Model drifted since last merge! cos=0.936
[S10] round=46 local utility u=0.467482 metrics={'f1_val': 0.979632574170446, 'auprc': 0.9927493959040801, 'loss_val': 0.09139555725323159, 'psi': 0.9848793028638996}-{'f1_val': 0.8619439027299012, 'auprc': 0.9906944833796587, 'loss_val': 0.31406363940538706, 'psi': 0.9134441349898043}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=46 head_norm_before_train=2.168636 cos_to_last_merge=0.9999 (last merge round=42)
[S11] round=46 local utility u=0.000000 metrics={'f1_val': 0.9919936128685432, 'auprc': 0.9983632311424371, 'loss_val': 0.03274280878836744, 'psi': 0.9945414601781006}-{'f1_val': 0.9965470045135896, 'auprc': 0.9984003639770147, 'loss_val': 0.02323184255648556, 'psi': 0.9972883482989596}
[S13] START round=46 head_norm_before_train=1.347456 cos_to_last_merge=0.9860 (last merge round=28)
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.608110715155852, 'auprc': 0.6834596185214478, 'loss_val': 0.8488346495302962, 'psi': 0.6382502765020903}-{'f1_val': 0.6110698581390414, 'auprc': 0.6818954251162359, 'loss_val': 0.8133084169496343, 'psi': 0.6394000849299192}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=46 head_norm_before_train=1.663826 cos_to_last_merge=1.0000 (last merge round=44)
[S14] round=46 local utility u=0.000511 metrics={'f1_val': 0.9968300801588782, 'auprc': 0.9989546229334196, 'loss_val': 0.03147945346615187, 'psi': 0.9976798972686947}-{'f1_val': 0.9968300801588782, 'auprc': 0.9989652126825526, 'loss_val': 0.03253420501564156, 'psi': 0.9976841331683479}
[S15] START round=46 head_norm_before_train=1.671934 cos_to_last_merge=1.0000 (last merge round=45)
[S15] round=46 local utility u=0.374138 metrics={'f1_val': 0.9744538871328754, 'auprc': 0.9908714177402183, 'loss_val': 0.07350636554409447, 'psi': 0.9810208993758126}-{'f1_val': 0.893308527534261, 'auprc': 0.9667955352139851, 'loss_val': 0.2626820061688242, 'psi': 0.9227033306061506}
[S16] START round=46 head_norm_before_train=1.866574 cos_to_last_merge=0.8037 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.804
[S16] round=46 local utility u=0.831374 metrics={'f1_val': 0.8947383504292982, 'auprc': 0.9904578574794936, 'loss_val': 0.26063709263791823, 'psi': 0.9330261532493763}-{'f1_val': 0.8394557173836202, 'auprc': 0.8297890703861613, 'loss_val': 1.1096833289584551, 'psi': 0.8355890585846366}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=46 head_norm_before_train=2.018448 cos_to_last_merge=1.0000 (last merge round=45)
[S17] round=46 local utility u=0.000000 metrics={'f1_val': 0.6097607929950613, 'auprc': 0.8663929740323009, 'loss_val': 0.9648149486627677, 'psi': 0.7124136654099571}-{'f1_val': 0.5989903605620022, 'auprc': 0.8827452290940874, 'loss_val': 0.8410207898203954, 'psi': 0.7124923079748362}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] → sending delta(kind=head bytes=1792) to S5@127.0.0.1:54505
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:54515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:54517
[S8] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:54508
[S3] sending update (kind=head size=1792 to 1 peers)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=46 metric=0.9115 head_norm=2.176179
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.559517e-02
[S2] stored merged vector for next round verification (round=46)
[S2] DEBUG after merge:  round=46 metric=0.9121 head_norm=2.172354 delta_norm=0.015595
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] RECEIVED delta(kind=head bytes=1804) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.687425)
[S14] loaded HEAD from S15 (vec_in norm=1.687425)
[S14] cosine check vs S15: cos=0.9997
[S14] BUFFERED delta from S15 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1800) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.674057)
[S15] loaded HEAD from S14 (vec_in norm=1.674057)
[S15] cosine check vs S14: cos=0.9997
[S15] BUFFERED delta from S14 (total buffered=2)
[S5] RECEIVED delta(kind=head bytes=1792) from S3
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.680400)
[S5] loaded HEAD from S3 (vec_in norm=1.680400)
[S5] cosine check vs S3: cos=0.9991
[S5] BUFFERED delta from S3 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1797) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=2.032053)
[S17] loaded HEAD from S8 (vec_in norm=2.032053)
[S17] cosine check vs S8: cos=0.9997
[S17] BUFFERED delta from S8 (total buffered=1)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=46 metric=0.8998 head_norm=1.680400
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.810361e-02
[S3] stored merged vector for next round verification (round=46)
[S3] DEBUG after merge:  round=46 metric=0.9030 head_norm=1.665922 delta_norm=0.028104
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=46 metric=0.9745 head_norm=1.687425
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.006705e-02
[S15] stored merged vector for next round verification (round=46)
[S15] DEBUG after merge:  round=46 metric=0.9753 head_norm=1.678086 delta_norm=0.020067
[S15] aggregate: ACCEPT kept=['S14', 'S14'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=46 metric=0.9968 head_norm=1.674057
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.054962e-02
[S14] stored merged vector for next round verification (round=46)
[S14] DEBUG after merge:  round=46 metric=0.9968 head_norm=1.680629 delta_norm=0.020550
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=46 metric=0.9923 head_norm=2.032053
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.016078e-02
[S8] stored merged vector for next round verification (round=46)
[S8] DEBUG after merge:  round=46 metric=0.9923 head_norm=2.024959 delta_norm=0.040161
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1797) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.530923)
[S7] loaded HEAD from S6 (vec_in norm=1.530923)
[S7] cosine check vs S6: cos=0.9998
[S7] BUFFERED delta from S6 (total buffered=1)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=46 metric=0.8012 head_norm=1.671636
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.506202e-02
[S5] stored merged vector for next round verification (round=46)
[S5] DEBUG after merge:  round=46 metric=0.7910 head_norm=1.675657 delta_norm=0.035062
[S5] aggregate: ROLLBACK (f1_val pre=0.801 post=0.791 tol_abs=0.005 tol_rel=0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=46 metric=0.6631 head_norm=1.529361
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.526506e-02
[S7] stored merged vector for next round verification (round=46)
[S7] DEBUG after merge:  round=46 metric=0.6623 head_norm=1.530066 delta_norm=0.015265
[S7] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=47 head_norm_before_train=2.172354 cos_to_last_merge=1.0000 (last merge round=46)
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.9113249345965, 'auprc': 0.9826018099153377, 'loss_val': 0.25114738762636896, 'psi': 0.9398356847240351}-{'f1_val': 0.9115296049161091, 'auprc': 0.9870114495295517, 'loss_val': 0.2382696189426945, 'psi': 0.9417223427614861}
[S3] START round=47 head_norm_before_train=1.665922 cos_to_last_merge=1.0000 (last merge round=46)
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.8336283168725749, 'auprc': 0.9885329761534476, 'loss_val': 0.2871673882906755, 'psi': 0.895590180584924}-{'f1_val': 0.89979348258146, 'auprc': 0.9717415228869777, 'loss_val': 0.23260020235707676, 'psi': 0.9285726987036671}
[S4] START round=47 head_norm_before_train=1.799407 cos_to_last_merge=0.7898 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.790
[S4] round=47 local utility u=0.000000 metrics={'f1_val': 0.9401253525969381, 'auprc': 0.932263887236557, 'loss_val': 0.3014073841328996, 'psi': 0.9369807664527856}-{'f1_val': 0.9413106570302539, 'auprc': 0.939135496154636, 'loss_val': 0.28947216529472886, 'psi': 0.9404405926800067}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=47 head_norm_before_train=1.675657 cos_to_last_merge=1.0000 (last merge round=46)
[S5] round=47 local utility u=0.000000 metrics={'f1_val': 0.6539580214374476, 'auprc': 0.8653988073012355, 'loss_val': 0.6588402555256841, 'psi': 0.7385343357829628}-{'f1_val': 0.8011886573179372, 'auprc': 0.9875046615437539, 'loss_val': 0.21177295242782757, 'psi': 0.8757150590082639}
[S6] START round=47 head_norm_before_train=1.530923 cos_to_last_merge=0.9999 (last merge round=45)
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.6204365723785141, 'auprc': 0.779286644219922, 'loss_val': 0.7263388670064334, 'psi': 0.6839766011150772}-{'f1_val': 0.9595353484470416, 'auprc': 0.9462786551278123, 'loss_val': 0.23676033811334946, 'psi': 0.9542326711193498}
[S7] START round=47 head_norm_before_train=1.530066 cos_to_last_merge=1.0000 (last merge round=46)
[S7] round=47 local utility u=0.000000 metrics={'f1_val': 0.6134447516807634, 'auprc': 0.7987981378150257, 'loss_val': 0.604640547734219, 'psi': 0.6875861061344684}-{'f1_val': 0.6631013983506988, 'auprc': 0.8736930195352564, 'loss_val': 0.376697132072467, 'psi': 0.7473380468245219}
[S8] START round=47 head_norm_before_train=2.024959 cos_to_last_merge=1.0000 (last merge round=46)
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.9923498862294302, 'auprc': 0.9899867738848175, 'loss_val': 0.0360744839456211, 'psi': 0.9914046412915851}-{'f1_val': 0.9923498862294302, 'auprc': 0.9904289955904713, 'loss_val': 0.0362032092243382, 'psi': 0.9915815299738466}
[S9] START round=47 head_norm_before_train=2.095960 cos_to_last_merge=0.8082 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.808
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9949873948136648, 'loss_val': 0.017717841498321583, 'psi': 0.9962567054327516}-{'f1_val': 0.9962710290637395, 'auprc': 0.9991962092415365, 'loss_val': 0.016765085260294157, 'psi': 0.9974411011348583}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=47 head_norm_before_train=1.580327 cos_to_last_merge=0.9339 (last merge round=29)
[S10] ⚠️ Model drifted since last merge! cos=0.934
[S10] round=47 local utility u=0.000000 metrics={'f1_val': 0.9210356753179236, 'auprc': 0.9906135819057014, 'loss_val': 0.1912863854100019, 'psi': 0.9488668379530347}-{'f1_val': 0.979632574170446, 'auprc': 0.9927493959040801, 'loss_val': 0.09139555725323159, 'psi': 0.9848793028638996}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=47 head_norm_before_train=2.178069 cos_to_last_merge=0.9999 (last merge round=42)
[S11] round=47 local utility u=0.019331 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9987439577761092, 'loss_val': 0.022543166128613578, 'psi': 0.9974257858185974}-{'f1_val': 0.9919936128685432, 'auprc': 0.9983632311424371, 'loss_val': 0.03274280878836744, 'psi': 0.9945414601781006}
[S13] START round=47 head_norm_before_train=1.356967 cos_to_last_merge=0.9849 (last merge round=28)
[S13] round=47 local utility u=0.027232 metrics={'f1_val': 0.6120171925104092, 'auprc': 0.6829232618539001, 'loss_val': 0.8162002249784822, 'psi': 0.6403796202478056}-{'f1_val': 0.608110715155852, 'auprc': 0.6834596185214478, 'loss_val': 0.8488346495302962, 'psi': 0.6382502765020903}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=47 head_norm_before_train=1.680629 cos_to_last_merge=1.0000 (last merge round=46)
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9986541882304035, 'loss_val': 0.031589114211797734, 'psi': 0.9974140142586116}-{'f1_val': 0.9968300801588782, 'auprc': 0.9989546229334196, 'loss_val': 0.03147945346615187, 'psi': 0.9976798972686947}
[S15] START round=47 head_norm_before_train=1.678086 cos_to_last_merge=1.0000 (last merge round=46)
[S15] round=47 local utility u=0.000000 metrics={'f1_val': 0.8979388048429493, 'auprc': 0.9770113129080167, 'loss_val': 0.2547577208952482, 'psi': 0.9295678080689762}-{'f1_val': 0.9744538871328754, 'auprc': 0.9908714177402183, 'loss_val': 0.07350636554409447, 'psi': 0.9810208993758126}
[S16] START round=47 head_norm_before_train=1.867923 cos_to_last_merge=0.8033 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.803
[S16] round=47 local utility u=0.395147 metrics={'f1_val': 0.9918596358646127, 'auprc': 0.9860201246733008, 'loss_val': 0.03975776335615282, 'psi': 0.9895238313880879}-{'f1_val': 0.8947383504292982, 'auprc': 0.9904578574794936, 'loss_val': 0.26063709263791823, 'psi': 0.9330261532493763}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] sending update (kind=head size=1805 to 1 peers)
[S17] START round=47 head_norm_before_train=2.026134 cos_to_last_merge=1.0000 (last merge round=45)
[S17] round=47 local utility u=0.234353 metrics={'f1_val': 0.6462489797632744, 'auprc': 0.9052740089575194, 'loss_val': 0.8316819853838233, 'psi': 0.7498589914409725}-{'f1_val': 0.6097607929950613, 'auprc': 0.8663929740323009, 'loss_val': 0.9648149486627677, 'psi': 0.7124136654099571}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:54502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:54509
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1798 to 1 peers)
[S17] sending update (kind=head size=1799 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] RECEIVED delta(kind=head bytes=1798) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=2.188452)
[S2] loaded HEAD from S11 (vec_in norm=2.188452)
[S2] cosine check vs S11: cos=0.9999
[S2] BUFFERED delta from S11 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1799) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=2.036900)
[S8] loaded HEAD from S17 (vec_in norm=2.036900)
[S8] cosine check vs S17: cos=0.9999
[S8] BUFFERED delta from S17 (total buffered=1)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=47 metric=0.6462 head_norm=2.036900
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.062791e-02
[S17] stored merged vector for next round verification (round=47)
[S17] DEBUG after merge:  round=47 metric=0.6473 head_norm=2.034248 delta_norm=0.030628
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=48 head_norm_before_train=2.180588 cos_to_last_merge=1.0000 (last merge round=46)
[S2] round=48 local utility u=0.000000 metrics={'f1_val': 0.913820086469183, 'auprc': 0.8772127033484836, 'loss_val': 0.20242189724199844, 'psi': 0.8991771332209032}-{'f1_val': 0.9113249345965, 'auprc': 0.9826018099153377, 'loss_val': 0.25114738762636896, 'psi': 0.9398356847240351}
[S3] START round=48 head_norm_before_train=1.700334 cos_to_last_merge=0.9999 (last merge round=46)
[S3] round=48 local utility u=0.379363 metrics={'f1_val': 0.9306252573646563, 'auprc': 0.9968429527972138, 'loss_val': 0.1353527912634409, 'psi': 0.9571123355376793}-{'f1_val': 0.8336283168725749, 'auprc': 0.9885329761534476, 'loss_val': 0.2871673882906755, 'psi': 0.895590180584924}
[S4] START round=48 head_norm_before_train=1.805793 cos_to_last_merge=0.7892 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.789
[S4] round=48 local utility u=0.030714 metrics={'f1_val': 0.9414190896783844, 'auprc': 0.9458093772532892, 'loss_val': 0.28837833732794543, 'psi': 0.9431752047083464}-{'f1_val': 0.9401253525969381, 'auprc': 0.932263887236557, 'loss_val': 0.3014073841328996, 'psi': 0.9369807664527856}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=48 head_norm_before_train=1.688962 cos_to_last_merge=0.9999 (last merge round=46)
[S5] round=48 local utility u=0.000000 metrics={'f1_val': 0.6294656473086252, 'auprc': 0.859111440322564, 'loss_val': 0.6023580868876458, 'psi': 0.7213239645142008}-{'f1_val': 0.6539580214374476, 'auprc': 0.8653988073012355, 'loss_val': 0.6588402555256841, 'psi': 0.7385343357829628}
[S6] START round=48 head_norm_before_train=1.539623 cos_to_last_merge=0.9996 (last merge round=45)
[S6] round=48 local utility u=1.000000 metrics={'f1_val': 0.9057734173165806, 'auprc': 0.9538129646663833, 'loss_val': 0.27896354070457674, 'psi': 0.9249892362565016}-{'f1_val': 0.6204365723785141, 'auprc': 0.779286644219922, 'loss_val': 0.7263388670064334, 'psi': 0.6839766011150772}
[S7] START round=48 head_norm_before_train=1.542529 cos_to_last_merge=0.9999 (last merge round=46)
[S7] round=48 local utility u=0.262418 metrics={'f1_val': 0.6433459113626545, 'auprc': 0.8602832085952228, 'loss_val': 0.44366762826397554, 'psi': 0.7301208302556819}-{'f1_val': 0.6134447516807634, 'auprc': 0.7987981378150257, 'loss_val': 0.604640547734219, 'psi': 0.6875861061344684}
[S8] START round=48 head_norm_before_train=2.033924 cos_to_last_merge=1.0000 (last merge round=46)
[S8] round=48 local utility u=0.000633 metrics={'f1_val': 0.9923498862294302, 'auprc': 0.9904054087598708, 'loss_val': 0.03606341534404925, 'psi': 0.9915720952416065}-{'f1_val': 0.9923498862294302, 'auprc': 0.9899867738848175, 'loss_val': 0.0360744839456211, 'psi': 0.9914046412915851}
[S9] START round=48 head_norm_before_train=2.105002 cos_to_last_merge=0.8076 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.808
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.9956054446615002, 'auprc': 0.9987989694505945, 'loss_val': 0.0215832957341133, 'psi': 0.996882854577138}-{'f1_val': 0.9971029125121428, 'auprc': 0.9949873948136648, 'loss_val': 0.017717841498321583, 'psi': 0.9962567054327516}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=48 head_norm_before_train=1.595338 cos_to_last_merge=0.9323 (last merge round=29)
[S10] ⚠️ Model drifted since last merge! cos=0.932
[S10] round=48 local utility u=0.283759 metrics={'f1_val': 0.992994663041229, 'auprc': 0.99301920557704, 'loss_val': 0.06273903697622518, 'psi': 0.9930044800555534}-{'f1_val': 0.9210356753179236, 'auprc': 0.9906135819057014, 'loss_val': 0.1912863854100019, 'psi': 0.9488668379530347}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=48 head_norm_before_train=2.188452 cos_to_last_merge=0.9998 (last merge round=42)
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9987414185594963, 'loss_val': 0.02247271724783708, 'psi': 0.9971767723717841}-{'f1_val': 0.9965470045135896, 'auprc': 0.9987439577761092, 'loss_val': 0.022543166128613578, 'psi': 0.9974257858185974}
[S13] START round=48 head_norm_before_train=1.368508 cos_to_last_merge=0.9836 (last merge round=28)
[S13] round=48 local utility u=0.090356 metrics={'f1_val': 0.6237463969359942, 'auprc': 0.6751618660965564, 'loss_val': 0.6825800346681627, 'psi': 0.6443125846002191}-{'f1_val': 0.6120171925104092, 'auprc': 0.6829232618539001, 'loss_val': 0.8162002249784822, 'psi': 0.6403796202478056}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=48 head_norm_before_train=1.689497 cos_to_last_merge=1.0000 (last merge round=46)
[S14] round=48 local utility u=0.000362 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9986689885730742, 'loss_val': 0.030908590348514186, 'psi': 0.9974199343956799}-{'f1_val': 0.9965872316107504, 'auprc': 0.9986541882304035, 'loss_val': 0.031589114211797734, 'psi': 0.9974140142586116}
[S15] START round=48 head_norm_before_train=1.696194 cos_to_last_merge=1.0000 (last merge round=46)
[S15] round=48 local utility u=0.219425 metrics={'f1_val': 0.9358934441580695, 'auprc': 0.9913285674850074, 'loss_val': 0.08658720570010713, 'psi': 0.9580674934888447}-{'f1_val': 0.8979388048429493, 'auprc': 0.9770113129080167, 'loss_val': 0.2547577208952482, 'psi': 0.9295678080689762}
[S16] START round=48 head_norm_before_train=1.871489 cos_to_last_merge=0.8028 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.803
[S16] round=48 local utility u=0.000000 metrics={'f1_val': 0.843963974804167, 'auprc': 0.8199255228113463, 'loss_val': 1.0932732890106602, 'psi': 0.8343485940070388}-{'f1_val': 0.9918596358646127, 'auprc': 0.9860201246733008, 'loss_val': 0.03975776335615282, 'psi': 0.9895238313880879}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=48 head_norm_before_train=2.034248 cos_to_last_merge=1.0000 (last merge round=47)
[S17] round=48 local utility u=0.000000 metrics={'f1_val': 0.5987215544127507, 'auprc': 0.865212827238578, 'loss_val': 1.2010018696564007, 'psi': 0.7053180635430816}-{'f1_val': 0.6462489797632744, 'auprc': 0.9052740089575194, 'loss_val': 0.8316819853838233, 'psi': 0.7498589914409725}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:54514
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:54517
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:54515
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:54505
[S3] sending update (kind=head size=1798 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1799 to 1 peers)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=48 metric=0.9138 head_norm=2.188001
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.814725e-02
[S2] stored merged vector for next round verification (round=48)
[S2] DEBUG after merge:  round=48 metric=0.9138 head_norm=2.188151 delta_norm=0.018147
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S8] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:54508
[S15] RECEIVED delta(kind=head bytes=1799) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.697758)
[S15] loaded HEAD from S14 (vec_in norm=1.697758)
[S15] cosine check vs S14: cos=0.9998
[S15] BUFFERED delta from S14 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1798) from S3
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.735016)
[S5] loaded HEAD from S3 (vec_in norm=1.735016)
[S5] cosine check vs S3: cos=0.9988
[S5] BUFFERED delta from S3 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1797) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=2.042190)
[S17] loaded HEAD from S8 (vec_in norm=2.042190)
[S17] cosine check vs S8: cos=0.9999
[S17] BUFFERED delta from S8 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1798) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.714774)
[S14] loaded HEAD from S15 (vec_in norm=1.714774)
[S14] cosine check vs S15: cos=0.9998
[S14] BUFFERED delta from S15 (total buffered=1)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=48 metric=0.9923 head_norm=2.042190
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.748127e-02
[S8] stored merged vector for next round verification (round=48)
[S8] DEBUG after merge:  round=48 metric=0.9923 head_norm=2.039472 delta_norm=0.017481
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=48 metric=0.9359 head_norm=1.714774
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.056121e-02
[S15] stored merged vector for next round verification (round=48)
[S15] DEBUG after merge:  round=48 metric=0.9369 head_norm=1.706164 delta_norm=0.020561
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S6] sending update (kind=head size=1800 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=48 metric=0.9966 head_norm=1.697758
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.056121e-02
[S14] stored merged vector for next round verification (round=48)
[S14] DEBUG after merge:  round=48 metric=0.9966 head_norm=1.706164 delta_norm=0.020561
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S7] RECEIVED delta(kind=head bytes=1800) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.550406)
[S7] loaded HEAD from S6 (vec_in norm=1.550406)
[S7] cosine check vs S6: cos=0.9991
[S7] BUFFERED delta from S6 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:54507
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=48 metric=0.6295 head_norm=1.700941
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.609161e-02
[S5] stored merged vector for next round verification (round=48)
[S5] DEBUG after merge:  round=48 metric=0.6297 head_norm=1.717445 delta_norm=0.046092
[S5] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S7] sending update (kind=head size=1799 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1799) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.556635)
[S6] loaded HEAD from S7 (vec_in norm=1.556635)
[S6] cosine check vs S7: cos=0.9991
[S6] BUFFERED delta from S7 (total buffered=1)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=48 metric=0.6433 head_norm=1.556635
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.355016e-02
[S7] stored merged vector for next round verification (round=48)
[S7] DEBUG after merge:  round=48 metric=0.6420 head_norm=1.553161 delta_norm=0.033550
[S7] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=48 metric=0.9058 head_norm=1.550406
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.355017e-02
[S6] stored merged vector for next round verification (round=48)
[S6] DEBUG after merge:  round=48 metric=0.9095 head_norm=1.553161 delta_norm=0.033550
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=49 head_norm_before_train=2.188151 cos_to_last_merge=1.0000 (last merge round=48)
[S2] round=49 local utility u=0.000000 metrics={'f1_val': 0.8288070593851928, 'auprc': 0.9898905448217564, 'loss_val': 0.37949499420648636, 'psi': 0.8932404535598183}-{'f1_val': 0.913820086469183, 'auprc': 0.8772127033484836, 'loss_val': 0.20242189724199844, 'psi': 0.8991771332209032}
[S3] START round=49 head_norm_before_train=1.735016 cos_to_last_merge=0.9995 (last merge round=46)
[S3] round=49 local utility u=0.062482 metrics={'f1_val': 0.9596861317232088, 'auprc': 0.986059889015906, 'loss_val': 0.15240559990913446, 'psi': 0.9702356346402877}-{'f1_val': 0.9306252573646563, 'auprc': 0.9968429527972138, 'loss_val': 0.1353527912634409, 'psi': 0.9571123355376793}
[S4] START round=49 head_norm_before_train=1.814507 cos_to_last_merge=0.7884 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.788
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.9390825739993208, 'auprc': 0.9279956647741285, 'loss_val': 0.3170992643356334, 'psi': 0.9346478103092439}-{'f1_val': 0.9414190896783844, 'auprc': 0.9458093772532892, 'loss_val': 0.28837833732794543, 'psi': 0.9431752047083464}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=49 head_norm_before_train=1.717445 cos_to_last_merge=1.0000 (last merge round=48)
[S5] round=49 local utility u=1.000000 metrics={'f1_val': 0.911312262806012, 'auprc': 0.9748680148917759, 'loss_val': 0.2157059173044445, 'psi': 0.9367345636403176}-{'f1_val': 0.6294656473086252, 'auprc': 0.859111440322564, 'loss_val': 0.6023580868876458, 'psi': 0.7213239645142008}
[S6] START round=49 head_norm_before_train=1.553161 cos_to_last_merge=1.0000 (last merge round=48)
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.5973763449220731, 'auprc': 0.7997904111435283, 'loss_val': 0.8575121760575043, 'psi': 0.6783419714106552}-{'f1_val': 0.9057734173165806, 'auprc': 0.9538129646663833, 'loss_val': 0.27896354070457674, 'psi': 0.9249892362565016}
[S7] START round=49 head_norm_before_train=1.553161 cos_to_last_merge=1.0000 (last merge round=48)
[S7] round=49 local utility u=0.000000 metrics={'f1_val': 0.6112568981388544, 'auprc': 0.8680919391735809, 'loss_val': 0.5442692037539039, 'psi': 0.713990914552745}-{'f1_val': 0.6433459113626545, 'auprc': 0.8602832085952228, 'loss_val': 0.44366762826397554, 'psi': 0.7301208302556819}
[S8] START round=49 head_norm_before_train=2.039472 cos_to_last_merge=1.0000 (last merge round=48)
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.990363285929422, 'auprc': 0.9910604656747011, 'loss_val': 0.03894296311782383, 'psi': 0.9906421578275337}-{'f1_val': 0.9923498862294302, 'auprc': 0.9904054087598708, 'loss_val': 0.03606341534404925, 'psi': 0.9915720952416065}
[S9] START round=49 head_norm_before_train=2.106186 cos_to_last_merge=0.8073 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.807
[S9] round=49 local utility u=0.000000 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9949418470736804, 'loss_val': 0.019476537876250186, 'psi': 0.9960882900848265}-{'f1_val': 0.9956054446615002, 'auprc': 0.9987989694505945, 'loss_val': 0.0215832957341133, 'psi': 0.996882854577138}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=49 head_norm_before_train=1.609536 cos_to_last_merge=0.9307 (last merge round=29)
[S10] ⚠️ Model drifted since last merge! cos=0.931
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.992994663041229, 'auprc': 0.9918268379912507, 'loss_val': 0.06267087376194957, 'psi': 0.9925275330212378}-{'f1_val': 0.992994663041229, 'auprc': 0.99301920557704, 'loss_val': 0.06273903697622518, 'psi': 0.9930044800555534}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=49 head_norm_before_train=2.196924 cos_to_last_merge=0.9998 (last merge round=42)
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.995892772286759, 'auprc': 0.9985113009176043, 'loss_val': 0.02358711860751694, 'psi': 0.9969401837390971}-{'f1_val': 0.9961336749133093, 'auprc': 0.9987414185594963, 'loss_val': 0.02247271724783708, 'psi': 0.9971767723717841}
[S13] START round=49 head_norm_before_train=1.377761 cos_to_last_merge=0.9826 (last merge round=28)
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.5842322792093482, 'auprc': 0.6873686028300348, 'loss_val': 0.9263744033079121, 'psi': 0.6254868086576229}-{'f1_val': 0.6237463969359942, 'auprc': 0.6751618660965564, 'loss_val': 0.6825800346681627, 'psi': 0.6443125846002191}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=49 head_norm_before_train=1.706164 cos_to_last_merge=1.0000 (last merge round=48)
[S14] round=49 local utility u=0.002109 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9989524206968246, 'loss_val': 0.030021144488271003, 'psi': 0.9977813962072766}-{'f1_val': 0.9965872316107504, 'auprc': 0.9986689885730742, 'loss_val': 0.030908590348514186, 'psi': 0.9974199343956799}
[S15] START round=49 head_norm_before_train=1.706164 cos_to_last_merge=1.0000 (last merge round=48)
[S15] round=49 local utility u=0.174343 metrics={'f1_val': 0.9887225458507034, 'auprc': 0.9933090604660267, 'loss_val': 0.060817537864862874, 'psi': 0.9905571516968328}-{'f1_val': 0.9358934441580695, 'auprc': 0.9913285674850074, 'loss_val': 0.08658720570010713, 'psi': 0.9580674934888447}
[S16] START round=49 head_norm_before_train=1.877279 cos_to_last_merge=0.8023 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.802
[S16] round=49 local utility u=1.000000 metrics={'f1_val': 0.9924885462289569, 'auprc': 0.9928841201618677, 'loss_val': 0.03438538763271818, 'psi': 0.9926467758021211}-{'f1_val': 0.843963974804167, 'auprc': 0.8199255228113463, 'loss_val': 1.0932732890106602, 'psi': 0.8343485940070388}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=49 head_norm_before_train=2.044065 cos_to_last_merge=1.0000 (last merge round=47)
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.58933226388833, 'auprc': 0.8656671919750678, 'loss_val': 1.2580199435901391, 'psi': 0.6998662351230251}-{'f1_val': 0.5987215544127507, 'auprc': 0.865212827238578, 'loss_val': 1.2010018696564007, 'psi': 0.7053180635430816}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:54505
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:54515
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1795 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=49 metric=0.5893 head_norm=2.051001
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.698476e-02
[S17] stored merged vector for next round verification (round=49)
[S17] DEBUG after merge:  round=49 metric=0.5901 head_norm=2.046530 delta_norm=0.016985
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:54503
[S14] RECEIVED delta(kind=head bytes=1801) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.724596)
[S14] loaded HEAD from S15 (vec_in norm=1.724596)
[S14] cosine check vs S15: cos=0.9999
[S14] BUFFERED delta from S15 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1802) from S3
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.767272)
[S5] loaded HEAD from S3 (vec_in norm=1.767272)
[S5] cosine check vs S3: cos=0.9989
[S5] BUFFERED delta from S3 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1795) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.716460)
[S15] loaded HEAD from S14 (vec_in norm=1.716460)
[S15] cosine check vs S14: cos=0.9999
[S15] BUFFERED delta from S14 (total buffered=1)
[S5] sending update (kind=head size=1803 to 1 peers)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=49 metric=0.9887 head_norm=1.724596
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.055709e-02
[S15] stored merged vector for next round verification (round=49)
[S15] DEBUG after merge:  round=49 metric=0.9891 head_norm=1.720500 delta_norm=0.010557
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=49 metric=0.9970 head_norm=1.716460
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.055709e-02
[S14] stored merged vector for next round verification (round=49)
[S14] DEBUG after merge:  round=49 metric=0.9970 head_norm=1.720500 delta_norm=0.010557
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S3] RECEIVED delta(kind=head bytes=1803) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.733054)
[S3] loaded HEAD from S5 (vec_in norm=1.733054)
[S3] cosine check vs S5: cos=0.9989
[S3] BUFFERED delta from S5 (total buffered=1)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=49 metric=0.9113 head_norm=1.733054
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.470124e-02
[S5] stored merged vector for next round verification (round=49)
[S5] DEBUG after merge:  round=49 metric=0.9039 head_norm=1.749676 delta_norm=0.044701
[S5] aggregate: ROLLBACK (f1_val pre=0.911 post=0.904 tol_abs=0.005 tol_rel=0.0)
[runner] rounds complete.
[runner] all agents stopped.
