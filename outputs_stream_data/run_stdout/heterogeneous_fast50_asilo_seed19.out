[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:52803
[S3] → join 127.0.0.1:52802
[S4] → join 127.0.0.1:52802
[S5] → join 127.0.0.1:52802
[S6] → join 127.0.0.1:52802
[S7] → join 127.0.0.1:52802
[S8] → join 127.0.0.1:52802
[S9] → join 127.0.0.1:52802
[S10] → join 127.0.0.1:52802
[S11] → join 127.0.0.1:52802
[S13] → join 127.0.0.1:52802
[S14] → join 127.0.0.1:52802
[S15] → join 127.0.0.1:52802
[S16] → join 127.0.0.1:52802
[S17] → join 127.0.0.1:52802
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.181788 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.206746 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.157197 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.187770 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.198459 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.165352 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.150132 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.162958 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.123232 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.157349 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.161141 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.241639 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.216167 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.159922 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.172377 (no previous merge yet)
[S11]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S4] + discovered S2
[S3] + discovered S5
[S3] + discovered S17
[S3] + discovered S9
[S3] + discovered S16
[S3] + discovered S14
[S3] + discovered S15
[S3] + discovered S11
[S3] + discovered S7
[S3] + discovered S13
[S3] + discovered S6
[S3] + discovered S10
[S3] + discovered S4
[S3] + discovered S8
[S4] + discovered S3
[S5] + discovered S3
[S5] + discovered S2
[S5] + discovered S4
[S4] + discovered S13
[S4] + discovered S17
[S4] + discovered S5
[S4] + discovered S16
[S4] + discovered S9
[S4] + discovered S14
[S4] + discovered S15
[S4] + discovered S7
[S4] + discovered S11
[S4] + discovered S6
[S4] + discovered S10
[S4] + discovered S8
[S5] + discovered S10
[S5] + discovered S7
[S5] + discovered S11
[S5] + discovered S15
[S5] + discovered S9
[S5] + discovered S16
[S5] + discovered S17
[S5] + discovered S8
[S5] + discovered S6
[S5] + discovered S13
[S6] + discovered S2
[S6] + discovered S4
[S6] + discovered S3
[S5] + discovered S14
[S6] + discovered S5
[S6] + discovered S10
[S6] + discovered S11
[S6] + discovered S16
[S6] + discovered S8
[S6] + discovered S14
[S6] + discovered S13
[S6] + discovered S7
[S6] + discovered S15
[S6] + discovered S9
[S6] + discovered S17
[S7] + discovered S6
[S7] + discovered S2
[S7] + discovered S4
[S7] + discovered S3
[S7] + discovered S5
[S8] + discovered S6
[S8] + discovered S7
[S8] + discovered S3
[S8] + discovered S2
[S8] + discovered S4
[S7] + discovered S15
[S8] + discovered S5
[S7] + discovered S13
[S7] + discovered S14
[S7] + discovered S8
[S7] + discovered S11
[S7] + discovered S10
[S7] + discovered S17
[S7] + discovered S16
[S7] + discovered S9
[S8] + discovered S11
[S8] + discovered S15
[S8] + discovered S14
[S8] + discovered S13
[S9] + discovered S4
[S9] + discovered S2
[S9] + discovered S7
[S9] + discovered S8
[S9] + discovered S6
[S9] + discovered S3
[S9] + discovered S5
[S8] + discovered S9
[S8] + discovered S16
[S8] + discovered S17
[S8] + discovered S10
[S10] + discovered S6
[S10] + discovered S4
[S9] + discovered S16
[S9] + discovered S17
[S9] + discovered S10
[S9] + discovered S11
[S10] + discovered S9
[S9] + discovered S13
[S9] + discovered S14
[S9] + discovered S15
[S10] + discovered S3
[S10] + discovered S2
[S10] + discovered S8
[S10] + discovered S7
[S10] + discovered S5
[S11] + discovered S2
[S11] + discovered S5
[S10] + discovered S16
[S11] + discovered S10
[S10] + discovered S13
[S10] + discovered S14
[S10] + discovered S17
[S10] + discovered S15
[S10] + discovered S11
[S11] + discovered S3
[S11] + discovered S4
[S11] + discovered S6
[S11] + discovered S7
[S11] + discovered S8
[S11] + discovered S9
[S11] + discovered S17
[S13] + discovered S9
[S13] + discovered S6
[S11] + discovered S13
[S11] + discovered S16
[S11] + discovered S15
[S11] + discovered S14
[S13] + discovered S2
[S13] + discovered S11
[S13] + discovered S5
[S13] + discovered S10
[S13] + discovered S8
[S13] + discovered S7
[S13] + discovered S4
[S13] + discovered S3
[S14] + discovered S7
[S13] + discovered S15
[S13] + discovered S17
[S13] + discovered S16
[S14] + discovered S3
[S13] + discovered S14
[S14] + discovered S10
[S14] + discovered S11
[S14] + discovered S5
[S14] + discovered S8
[S14] + discovered S2
[S14] + discovered S4
[S14] + discovered S6
[S14] + discovered S13
[S14] + discovered S9
[S15] + discovered S8
[S15] + discovered S7
[S14] + discovered S15
[S14] + discovered S17
[S15] + discovered S11
[S15] + discovered S13
[S15] + discovered S2
[S15] + discovered S3
[S15] + discovered S5
[S15] + discovered S14
[S15] + discovered S9
[S15] + discovered S6
[S15] + discovered S4
[S14] + discovered S16
[S15] + discovered S10
[S16] + discovered S6
[S16] + discovered S14
[S15] + discovered S17
[S16] + discovered S9
[S16] + discovered S5
[S16] + discovered S7
[S15] + discovered S16
[S16] + discovered S3
[S16] + discovered S8
[S16] + discovered S11
[S16] + discovered S2
[S16] + discovered S15
[S16] + discovered S13
[S16] + discovered S4
[S16] + discovered S10
[S17] + discovered S16
[S17] + discovered S14
[S17] + discovered S3
[S17] + discovered S5
[S17] + discovered S6
[S17] + discovered S4
[S17] + discovered S9
[S17] + discovered S2
[S17] + discovered S8
[S17] + discovered S15
[S17] + discovered S11
[S17] + discovered S13
[S17] + discovered S7
[S16] + discovered S17
[S17] + discovered S10
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] ⇄ pheromone p=1.000 → S14@127.0.0.1:52814
[S7] ⇄ pheromone p=1.000 → S17@127.0.0.1:52817
[S9] ⇄ pheromone p=1.000 → S17@127.0.0.1:52817
[S5] ⇄ pheromone p=1.000 → S11@127.0.0.1:52812
[S3] ⇄ pheromone p=1.000 → S11@127.0.0.1:52812
[S8] ⇄ pheromone p=1.000 → S15@127.0.0.1:52815
[S15] ⇄ pheromone p=1.000 → S9@127.0.0.1:52810
[S16] ⇄ pheromone p=1.000 → S7@127.0.0.1:52808
[S13] ⇄ pheromone p=1.000 → S7@127.0.0.1:52808
[S2] ⇄ pheromone p=1.000 → S8@127.0.0.1:52809
[S4] ⇄ pheromone p=1.000 → S8@127.0.0.1:52809
[S14] ⇄ pheromone p=1.000 → S8@127.0.0.1:52809
[S6] ⇄ pheromone p=1.000 → S17@127.0.0.1:52817
[S11] ⇄ pheromone p=1.000 → S8@127.0.0.1:52809
[S17] ⇄ pheromone p=1.000 → S13@127.0.0.1:52813
[S2] START round=1 head_norm_before_train=1.184092 (no previous merge yet)
[S2] round=1 local utility u=0.000000 metrics={'f1_val': 0.2504157020344387, 'auprc': 0.6254923231611517, 'loss_val': 1.2850786344478218, 'psi': 0.4004463504851239}-{'f1_val': 0.41931448681371664, 'auprc': 0.6043229515487101, 'loss_val': 1.3600913504565062, 'psi': 0.493317872707714}
[S3] START round=1 head_norm_before_train=1.209506 (no previous merge yet)
[S3] round=1 local utility u=0.293707 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9949483475545066, 'loss_val': 1.3235056115296757, 'psi': 0.48188337839026685}-{'f1_val': 0.13984006561410703, 'auprc': 0.8094166687522653, 'loss_val': 1.3543236143622566, 'psi': 0.40767070686937035}
[S4] START round=1 head_norm_before_train=1.158173 (no previous merge yet)
[S4] round=1 local utility u=0.063983 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7730903876364951, 'loss_val': 1.2741600947371738, 'psi': 0.39337213239170854}-{'f1_val': 0.14022662889518414, 'auprc': 0.7522306119844703, 'loss_val': 1.3395475267434909, 'psi': 0.3850282221308986}
[S5] START round=1 head_norm_before_train=1.188324 (no previous merge yet)
[S5] round=1 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7355942775318669, 'loss_val': 1.3221337699104114, 'psi': 0.3795948538698896}-{'f1_val': 0.14226190476190476, 'auprc': 0.7711219307082493, 'loss_val': 1.347478377419948, 'psi': 0.3938059151404426}
[S6] START round=1 head_norm_before_train=1.203815 (no previous merge yet)
[S6] round=1 local utility u=0.055429 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6855721381115512, 'loss_val': 1.2772894736268137, 'psi': 0.3590846244753897}-{'f1_val': 0.14142628205128205, 'auprc': 0.6686920166787722, 'loss_val': 1.3375078907693019, 'psi': 0.3523325759022781}
[S7] START round=1 head_norm_before_train=1.171230 (no previous merge yet)
[S7] round=1 local utility u=0.180253 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7424216291181113, 'loss_val': 1.3227198933838513, 'psi': 0.3822027452846995}-{'f1_val': 0.14205682272909165, 'auprc': 0.6331778440480181, 'loss_val': 1.355493613602423, 'psi': 0.33850523125666226}
[S8] START round=1 head_norm_before_train=1.168039 (no previous merge yet)
[S8] round=1 local utility u=0.045549 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7660591111531438, 'loss_val': 1.264041983919667, 'psi': 0.3903972338970319}-{'f1_val': 0.13995598239295717, 'auprc': 0.7529547141614314, 'loss_val': 1.3158273861300749, 'psi': 0.3851554751003469}
[S9] START round=1 head_norm_before_train=1.169400 (no previous merge yet)
[S9] round=1 local utility u=0.036443 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9994654515197177, 'loss_val': 1.2797147177579722, 'psi': 0.4846249548918847}-{'f1_val': 0.141397957139996, 'auprc': 0.9894418790660353, 'loss_val': 1.3225290057358698, 'psi': 0.48061552591041173}
[S10] START round=1 head_norm_before_train=1.136804 (no previous merge yet)
[S10] round=1 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7906718590086189, 'loss_val': 1.2876073124651195, 'psi': 0.39944172612848194}-{'f1_val': 0.13862163754172394, 'auprc': 0.8251024904114909, 'loss_val': 1.3425669238423943, 'psi': 0.4132139786896307}
[S11] START round=1 head_norm_before_train=1.160710 (no previous merge yet)
[S11] round=1 local utility u=0.243197 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7795107353918983, 'loss_val': 1.3210270088842837, 'psi': 0.3960525041806257}-{'f1_val': 0.14041368337311058, 'auprc': 0.628135522297884, 'loss_val': 1.3532953287911305, 'psi': 0.33550241894301996}
[S13] START round=1 head_norm_before_train=1.168029 (no previous merge yet)
[S13] round=1 local utility u=0.232754 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7222508542423138, 'loss_val': 1.2706761792444123, 'psi': 0.37313179924315737}-{'f1_val': 0.1403857625770531, 'auprc': 0.5854800457882057, 'loss_val': 1.3258726541935377, 'psi': 0.31842347586151415}
[S14] START round=1 head_norm_before_train=1.243486 (no previous merge yet)
[S14] round=1 local utility u=1.000000 metrics={'f1_val': 0.39322891784691444, 'auprc': 0.5941820831140615, 'loss_val': 1.338496948382073, 'psi': 0.47361018395377324}-{'f1_val': 0.1038107752956636, 'auprc': 0.43785133663211995, 'loss_val': 1.362788001732445, 'psi': 0.23742699983024615}
[S15] START round=1 head_norm_before_train=1.226711 (no previous merge yet)
[S15] round=1 local utility u=0.324493 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7759078853999303, 'loss_val': 1.2944359748381629, 'psi': 0.3942033449769071}-{'f1_val': 0.13973365136155833, 'auprc': 0.575980116281953, 'loss_val': 1.3436391093131663, 'psi': 0.3142322373297162}
[S16] START round=1 head_norm_before_train=1.164259 (no previous merge yet)
[S16] round=1 local utility u=0.472006 metrics={'f1_val': 0.17692939244663383, 'auprc': 0.760327069414603, 'loss_val': 1.3441902679422564, 'psi': 0.4102884632338215}-{'f1_val': 0.10386473429951691, 'auprc': 0.6015588791916938, 'loss_val': 1.3735106987975756, 'psi': 0.3029423922563877}
[S17] START round=1 head_norm_before_train=1.188525 (no previous merge yet)
[S17] round=1 local utility u=0.272127 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.78015599188891, 'loss_val': 1.2900858664836714, 'psi': 0.39663177474599465}-{'f1_val': 0.10127159429772135, 'auprc': 0.699659506287845, 'loss_val': 1.3547856397228746, 'psi': 0.3406267590937708}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:52808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1785 reason=None
[S7] → sending delta(kind=head bytes=1785) to S5@127.0.0.1:52805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S9] → sending delta(kind=head bytes=1789) to S6@127.0.0.1:52807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S3] → sending delta(kind=head bytes=1786) to S6@127.0.0.1:52807
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S6] → sending delta(kind=head bytes=1787) to S9@127.0.0.1:52810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1784 reason=None
[S11] → sending delta(kind=head bytes=1784) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S13] → sending delta(kind=head bytes=1790) to S7@127.0.0.1:52808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1782 reason=None
[S14] → sending delta(kind=head bytes=1782) to S16@127.0.0.1:52816
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:52817
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:52810
[S11] sending update (kind=head size=1784 to 1 peers)
[S6] sending update (kind=head size=1787 to 1 peers)
[S9] sending update (kind=head size=1789 to 1 peers)
[S13] sending update (kind=head size=1790 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1786 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1785 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1782 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1789) from S9
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.189396)
[S6] loaded HEAD from S9 (vec_in norm=1.189396)
[S6] cosine check vs S9: cos=-0.0339
[S6] DROPPED delta from S9 (cos=-0.0339 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1795) from S4
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.189045)
[S8] loaded HEAD from S4 (vec_in norm=1.189045)
[S8] cosine check vs S4: cos=0.0614
[S8] BUFFERED delta from S4 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1784) from S11
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.174327)
[S8] loaded HEAD from S11 (vec_in norm=1.174327)
[S8] cosine check vs S11: cos=-0.0978
[S8] DROPPED delta from S11 (cos=-0.0978 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1796) from S15
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.259284)
[S17] loaded HEAD from S15 (vec_in norm=1.259284)
[S17] cosine check vs S15: cos=0.0264
[S17] BUFFERED delta from S15 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1796) from S16
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.179576)
[S9] loaded HEAD from S16 (vec_in norm=1.179576)
[S9] cosine check vs S16: cos=0.0206
[S9] BUFFERED delta from S16 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1787) from S6
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.239165)
[S9] loaded HEAD from S6 (vec_in norm=1.239165)
[S9] cosine check vs S6: cos=-0.0339
[S9] DROPPED delta from S6 (cos=-0.0339 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1782) from S14
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.254699)
[S16] loaded HEAD from S14 (vec_in norm=1.254699)
[S16] cosine check vs S14: cos=-0.0259
[S16] DROPPED delta from S14 (cos=-0.0259 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1799) from S8
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.205576)
[S7] loaded HEAD from S8 (vec_in norm=1.205576)
[S7] cosine check vs S8: cos=0.0626
[S7] BUFFERED delta from S8 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1785) from S7
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.186319)
[S5] loaded HEAD from S7 (vec_in norm=1.186319)
[S5] cosine check vs S7: cos=0.0751
[S5] BUFFERED delta from S7 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1790) from S13
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.201628)
[S7] loaded HEAD from S13 (vec_in norm=1.201628)
[S7] cosine check vs S13: cos=-0.0007
[S7] DROPPED delta from S13 (cos=-0.0007 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1786) from S3
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.223865)
[S6] loaded HEAD from S3 (vec_in norm=1.223865)
[S6] cosine check vs S3: cos=-0.0443
[S6] DROPPED delta from S3 (cos=-0.0443 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S17] → sending delta(kind=head bytes=1792) to S3@127.0.0.1:52803
[S17] sending update (kind=head size=1792 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1792) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.228636)
[S3] loaded HEAD from S17 (vec_in norm=1.228636)
[S3] cosine check vs S17: cos=-0.0094
[S3] DROPPED delta from S17 (cos=-0.0094 < 0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=1 metric=0.1423 head_norm=1.195888
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.099839e-01
[S5] stored merged vector for next round verification (round=1)
[S5] DEBUG after merge:  round=1 metric=0.1423 head_norm=0.873313 delta_norm=0.809984
[S5] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=1 metric=0.1421 head_norm=1.186319
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.187798e-01
[S7] stored merged vector for next round verification (round=1)
[S7] DEBUG after merge:  round=1 metric=0.1421 head_norm=0.871770 delta_norm=0.818780
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=1 metric=0.1414 head_norm=1.189396
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.288858e-01
[S9] stored merged vector for next round verification (round=1)
[S9] DEBUG after merge:  round=1 metric=0.1414 head_norm=0.846155 delta_norm=0.828886
[S9] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=1 metric=0.1400 head_norm=1.205576
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.202584e-01
[S8] stored merged vector for next round verification (round=1)
[S8] DEBUG after merge:  round=1 metric=0.1400 head_norm=0.872237 delta_norm=0.820258
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=1 metric=0.1409 head_norm=1.228636
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.679772e-01
[S17] stored merged vector for next round verification (round=1)
[S17] DEBUG after merge:  round=1 metric=0.1409 head_norm=0.891228 delta_norm=0.867977
[S17] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=1.209831 (no previous merge yet)
[S2] round=2 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6058489943825678, 'loss_val': 1.1767521394635412, 'psi': 0.32740587778616714}-{'f1_val': 0.2504157020344387, 'auprc': 0.6254923231611517, 'loss_val': 1.2850786344478218, 'psi': 0.4004463504851239}
[S3] START round=2 head_norm_before_train=1.223865 (no previous merge yet)
[S3] round=2 local utility u=0.021302 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9965340722575345, 'loss_val': 1.2856582408115795, 'psi': 0.482517668271478}-{'f1_val': 0.13984006561410703, 'auprc': 0.9949483475545066, 'loss_val': 1.3235056115296757, 'psi': 0.48188337839026685}
[S4] START round=2 head_norm_before_train=1.189045 (no previous merge yet)
[S4] round=2 local utility u=0.075537 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.780788213201058, 'loss_val': 1.1461795723896884, 'psi': 0.39645126261753366}-{'f1_val': 0.14022662889518414, 'auprc': 0.7730903876364951, 'loss_val': 1.2741600947371738, 'psi': 0.39337213239170854}
[S5] START round=2 head_norm_before_train=0.873313 cos_to_last_merge=1.0000 (last merge round=1)
[S5] round=2 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7288845726254857, 'loss_val': 1.3229980922111797, 'psi': 0.37691097190733713}-{'f1_val': 0.14226190476190476, 'auprc': 0.7355942775318669, 'loss_val': 1.3221337699104114, 'psi': 0.3795948538698896}
[S6] START round=2 head_norm_before_train=1.239165 (no previous merge yet)
[S6] round=2 local utility u=0.009399 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6739553980617118, 'loss_val': 1.2236422184692664, 'psi': 0.3544379284554539}-{'f1_val': 0.14142628205128205, 'auprc': 0.6855721381115512, 'loss_val': 1.2772894736268137, 'psi': 0.3590846244753897}
[S7] START round=2 head_norm_before_train=0.871770 cos_to_last_merge=1.0000 (last merge round=1)
[S7] round=2 local utility u=0.050194 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7707202360906806, 'loss_val': 1.3072281468256708, 'psi': 0.39352218807372724}-{'f1_val': 0.14205682272909165, 'auprc': 0.7424216291181113, 'loss_val': 1.3227198933838513, 'psi': 0.3822027452846995}
[S8] START round=2 head_norm_before_train=0.872237 cos_to_last_merge=1.0000 (last merge round=1)
[S8] round=2 local utility u=0.004705 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7664071684779965, 'loss_val': 1.2556768820626958, 'psi': 0.39053645682697297}-{'f1_val': 0.13995598239295717, 'auprc': 0.7660591111531438, 'loss_val': 1.264041983919667, 'psi': 0.3903972338970319}
[S9] START round=2 head_norm_before_train=0.846155 cos_to_last_merge=1.0000 (last merge round=1)
[S9] round=2 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9787017593728755, 'loss_val': 1.2765349176223926, 'psi': 0.47631947803314784}-{'f1_val': 0.141397957139996, 'auprc': 0.9994654515197177, 'loss_val': 1.2797147177579722, 'psi': 0.4846249548918847}
[S10] START round=2 head_norm_before_train=1.178302 (no previous merge yet)
[S10] round=2 local utility u=0.674274 metrics={'f1_val': 0.32253557270483474, 'auprc': 0.8385085303782132, 'loss_val': 1.1860521826274963, 'psi': 0.5289247557741861}-{'f1_val': 0.13862163754172394, 'auprc': 0.7906718590086189, 'loss_val': 1.2876073124651195, 'psi': 0.39944172612848194}
[S11] START round=2 head_norm_before_train=1.174327 (no previous merge yet)
[S11] round=2 local utility u=0.136445 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8573257751417094, 'loss_val': 1.281581260985309, 'psi': 0.42717852008055013}-{'f1_val': 0.14041368337311058, 'auprc': 0.7795107353918983, 'loss_val': 1.3210270088842837, 'psi': 0.3960525041806257}
[S13] START round=2 head_norm_before_train=1.201628 (no previous merge yet)
[S13] round=2 local utility u=0.047934 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7260693685015627, 'loss_val': 1.1862631673359554, 'psi': 0.37465920494685695}-{'f1_val': 0.1403857625770531, 'auprc': 0.7222508542423138, 'loss_val': 1.2706761792444123, 'psi': 0.37313179924315737}
[S14] START round=2 head_norm_before_train=1.254699 (no previous merge yet)
[S14] round=2 local utility u=0.000000 metrics={'f1_val': 0.2499689668073103, 'auprc': 0.7245016976741918, 'loss_val': 1.3095544113158943, 'psi': 0.4397820591540629}-{'f1_val': 0.39322891784691444, 'auprc': 0.5941820831140615, 'loss_val': 1.338496948382073, 'psi': 0.47361018395377324}
[S15] START round=2 head_norm_before_train=1.259284 (no previous merge yet)
[S15] round=2 local utility u=0.033357 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7769937666836034, 'loss_val': 1.230980017207977, 'psi': 0.3946376974903764}-{'f1_val': 0.13973365136155833, 'auprc': 0.7759078853999303, 'loss_val': 1.2944359748381629, 'psi': 0.3942033449769071}
[S16] START round=2 head_norm_before_train=1.179576 (no previous merge yet)
[S16] round=2 local utility u=0.000000 metrics={'f1_val': 0.14274160938131825, 'auprc': 0.75822032596989, 'loss_val': 1.3101509841117784, 'psi': 0.3889330960167469}-{'f1_val': 0.17692939244663383, 'auprc': 0.760327069414603, 'loss_val': 1.3441902679422564, 'psi': 0.4102884632338215}
[S17] START round=2 head_norm_before_train=0.891228 cos_to_last_merge=1.0000 (last merge round=1)
[S17] round=2 local utility u=0.018584 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.773165121010959, 'loss_val': 1.2319455579376626, 'psi': 0.3938354263948143}-{'f1_val': 0.14094896331738438, 'auprc': 0.78015599188891, 'loss_val': 1.2900858664836714, 'psi': 0.39663177474599465}
[S6] not sending this round → trigger blocked (psi=0.354)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.394)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.395)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:52802
[S13] not sending this round → trigger blocked (psi=0.375)
[S4] not sending this round → trigger blocked (psi=0.396)
[S3] not sending this round → trigger blocked (psi=0.483)
[S8] not sending this round → trigger blocked (psi=0.391)
[S11] not sending this round → trigger blocked (psi=0.427)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1802 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1802) from S10
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.240660)
[S2] loaded HEAD from S10 (vec_in norm=1.240660)
[S2] cosine check vs S10: cos=-0.0335
[S2] DROPPED delta from S10 (cos=-0.0335 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.394)
[S2] START round=3 head_norm_before_train=1.260775 (no previous merge yet)
[S2] round=3 local utility u=1.000000 metrics={'f1_val': 0.416729796526099, 'auprc': 0.7815712695647253, 'loss_val': 1.0372482469895232, 'psi': 0.5626663857415495}-{'f1_val': 0.1417771333885667, 'auprc': 0.6058489943825678, 'loss_val': 1.1767521394635412, 'psi': 0.32740587778616714}
[S3] START round=3 head_norm_before_train=1.248907 (no previous merge yet)
[S3] round=3 local utility u=0.020399 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9955588172765608, 'loss_val': 1.2419337545188038, 'psi': 0.4821275662790886}-{'f1_val': 0.13984006561410703, 'auprc': 0.9965340722575345, 'loss_val': 1.2856582408115795, 'psi': 0.482517668271478}
[S4] START round=3 head_norm_before_train=1.244938 (no previous merge yet)
[S4] round=3 local utility u=1.000000 metrics={'f1_val': 0.6761320989280215, 'auprc': 0.7776943949725086, 'loss_val': 0.9038656786575372, 'psi': 0.7167570173458163}-{'f1_val': 0.14022662889518414, 'auprc': 0.780788213201058, 'loss_val': 1.1461795723896884, 'psi': 0.39645126261753366}
[S5] START round=3 head_norm_before_train=0.883789 cos_to_last_merge=0.9977 (last merge round=1)
[S5] round=3 local utility u=0.016758 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7290407695585064, 'loss_val': 1.2899512560740358, 'psi': 0.37697345068054544}-{'f1_val': 0.14226190476190476, 'auprc': 0.7288845726254857, 'loss_val': 1.3229980922111797, 'psi': 0.37691097190733713}
[S6] START round=3 head_norm_before_train=1.280977 (no previous merge yet)
[S6] round=3 local utility u=0.532812 metrics={'f1_val': 0.2985521353999081, 'auprc': 0.6868250840785599, 'loss_val': 1.1393831151490381, 'psi': 0.4538613148713688}-{'f1_val': 0.14142628205128205, 'auprc': 0.6739553980617118, 'loss_val': 1.2236422184692664, 'psi': 0.3544379284554539}
[S7] START round=3 head_norm_before_train=0.888300 cos_to_last_merge=0.9973 (last merge round=1)
[S7] round=3 local utility u=0.019847 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.775000505437653, 'loss_val': 1.2803746713892277, 'psi': 0.3952342958125162}-{'f1_val': 0.14205682272909165, 'auprc': 0.7707202360906806, 'loss_val': 1.3072281468256708, 'psi': 0.39352218807372724}
[S8] START round=3 head_norm_before_train=0.914294 cos_to_last_merge=0.9934 (last merge round=1)
[S8] round=3 local utility u=1.000000 metrics={'f1_val': 0.5253129439295892, 'auprc': 0.7724459760242739, 'loss_val': 1.0953651255808792, 'psi': 0.624166156767463}-{'f1_val': 0.13995598239295717, 'auprc': 0.7664071684779965, 'loss_val': 1.2556768820626958, 'psi': 0.39053645682697297}
[S9] START round=3 head_norm_before_train=0.873386 cos_to_last_merge=0.9964 (last merge round=1)
[S9] round=3 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8012726883110446, 'loss_val': 1.2110994271291686, 'psi': 0.40534784960841547}-{'f1_val': 0.141397957139996, 'auprc': 0.9787017593728755, 'loss_val': 1.2765349176223926, 'psi': 0.47631947803314784}
[S10] START round=3 head_norm_before_train=1.240660 (no previous merge yet)
[S10] round=3 local utility u=0.337497 metrics={'f1_val': 0.37768925423885746, 'auprc': 0.8645566674478302, 'loss_val': 0.9201248385818119, 'psi': 0.5724362195224466}-{'f1_val': 0.32253557270483474, 'auprc': 0.8385085303782132, 'loss_val': 1.1860521826274963, 'psi': 0.5289247557741861}
[S11] START round=3 head_norm_before_train=1.199586 (no previous merge yet)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8241265593026819, 'loss_val': 1.2252741506598035, 'psi': 0.41389883374493913}-{'f1_val': 0.14041368337311058, 'auprc': 0.8573257751417094, 'loss_val': 1.281581260985309, 'psi': 0.42717852008055013}
[S13] START round=3 head_norm_before_train=1.252482 (no previous merge yet)
[S13] round=3 local utility u=0.903560 metrics={'f1_val': 0.4156839344320697, 'auprc': 0.7298100482756837, 'loss_val': 1.0421535789752423, 'psi': 0.5413343799695153}-{'f1_val': 0.1403857625770531, 'auprc': 0.7260693685015627, 'loss_val': 1.1862631673359554, 'psi': 0.37465920494685695}
[S14] START round=3 head_norm_before_train=1.276950 (no previous merge yet)
[S14] round=3 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8416835421563948, 'loss_val': 1.2705005102118117, 'psi': 0.4208881285921802}-{'f1_val': 0.2499689668073103, 'auprc': 0.7245016976741918, 'loss_val': 1.3095544113158943, 'psi': 0.4397820591540629}
[S15] START round=3 head_norm_before_train=1.310076 (no previous merge yet)
[S15] round=3 local utility u=0.631331 metrics={'f1_val': 0.32964309183365115, 'auprc': 0.7833543270771246, 'loss_val': 1.1268569441924032, 'psi': 0.5111275859310406}-{'f1_val': 0.13973365136155833, 'auprc': 0.7769937666836034, 'loss_val': 1.230980017207977, 'psi': 0.3946376974903764}
[S16] START round=3 head_norm_before_train=1.202020 (no previous merge yet)
[S16] round=3 local utility u=0.027539 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7636742402611344, 'loss_val': 1.2588103608513939, 'psi': 0.38985216622397567}-{'f1_val': 0.14274160938131825, 'auprc': 0.75822032596989, 'loss_val': 1.3101509841117784, 'psi': 0.3889330960167469}
[S17] START round=3 head_norm_before_train=0.941362 cos_to_last_merge=0.9938 (last merge round=1)
[S17] round=3 local utility u=0.565939 metrics={'f1_val': 0.38519606575956267, 'auprc': 0.5994770657589775, 'loss_val': 1.0444869969563226, 'psi': 0.47090846575932865}-{'f1_val': 0.14094896331738438, 'auprc': 0.773165121010959, 'loss_val': 1.2319455579376626, 'psi': 0.3938354263948143}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.572)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] → sending delta(kind=head bytes=1793) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S16] → sending delta(kind=head bytes=1790) to S7@127.0.0.1:52808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] → sending delta(kind=head bytes=1793) to S11@127.0.0.1:52812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S7] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:52812
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S8] → sending delta(kind=head bytes=1791) to S15@127.0.0.1:52815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:52808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:52810
[S3] sending update (kind=head size=1793 to 1 peers)
[S16] sending update (kind=head size=1790 to 1 peers)
[S6] sending update (kind=head size=1793 to 1 peers)
[S2] sending update (kind=head size=1804 to 1 peers)
[S7] sending update (kind=head size=1792 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1791 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1793) from S3
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.282298)
[S11] loaded HEAD from S3 (vec_in norm=1.282298)
[S11] cosine check vs S3: cos=-0.0442
[S11] DROPPED delta from S3 (cos=-0.0442 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1792) from S7
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.908586)
[S17] loaded HEAD from S7 (vec_in norm=0.908586)
[S17] cosine check vs S7: cos=0.0582
[S17] BUFFERED delta from S7 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1790) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.234628)
[S7] loaded HEAD from S16 (vec_in norm=1.234628)
[S7] cosine check vs S16: cos=0.0169
[S7] BUFFERED delta from S16 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1798) from S15
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.361933)
[S9] loaded HEAD from S15 (vec_in norm=1.361933)
[S9] cosine check vs S15: cos=0.0895
[S9] BUFFERED delta from S15 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1799) from S4
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.308025)
[S8] loaded HEAD from S4 (vec_in norm=1.308025)
[S8] cosine check vs S4: cos=0.6326
[S8] BUFFERED delta from S4 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1796) from S13
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.305152)
[S7] loaded HEAD from S13 (vec_in norm=1.305152)
[S7] cosine check vs S13: cos=-0.0179
[S7] DROPPED delta from S13 (cos=-0.0179 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1793) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.313520)
[S17] loaded HEAD from S6 (vec_in norm=1.313520)
[S17] cosine check vs S6: cos=0.0731
[S17] BUFFERED delta from S6 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1791) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.979520)
[S15] loaded HEAD from S8 (vec_in norm=0.979520)
[S15] cosine check vs S8: cos=0.0167
[S15] BUFFERED delta from S8 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1804) from S2
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.300406)
[S8] loaded HEAD from S2 (vec_in norm=1.300406)
[S8] cosine check vs S2: cos=-0.0067
[S8] DROPPED delta from S2 (cos=-0.0067 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1799) from S5
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.907402)
[S11] loaded HEAD from S5 (vec_in norm=0.907402)
[S11] cosine check vs S5: cos=-0.0796
[S11] DROPPED delta from S5 (cos=-0.0796 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:52813
[S17] sending update (kind=head size=1802 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1802) from S17
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.002235)
[S13] loaded HEAD from S17 (vec_in norm=1.002235)
[S13] cosine check vs S17: cos=-0.0328
[S13] DROPPED delta from S17 (cos=-0.0328 < 0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=3 metric=0.1414 head_norm=0.909819
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.843474e-01
[S9] stored merged vector for next round verification (round=3)
[S9] DEBUG after merge:  round=3 metric=0.1414 head_norm=0.852125 delta_norm=0.784347
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=3 metric=0.1421 head_norm=0.908586
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.602407e-01
[S7] stored merged vector for next round verification (round=3)
[S7] DEBUG after merge:  round=3 metric=0.1421 head_norm=0.772627 delta_norm=0.760241
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=3 metric=0.3296 head_norm=1.361933
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.321285e-01
[S15] stored merged vector for next round verification (round=3)
[S15] DEBUG after merge:  round=3 metric=0.3959 head_norm=0.845413 delta_norm=0.832128
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=3 metric=0.5253 head_norm=0.979520
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.121741e-01
[S8] stored merged vector for next round verification (round=3)
[S8] DEBUG after merge:  round=3 metric=0.7145 head_norm=1.035796 delta_norm=0.512174
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=3 metric=0.3852 head_norm=1.002235
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.165758e-01
[S17] stored merged vector for next round verification (round=3)
[S17] DEBUG after merge:  round=3 metric=0.3832 head_norm=0.674382 delta_norm=0.616576
[S17] aggregate: ACCEPT kept=['S7', 'S6'] (k=2/2) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=1.300406 (no previous merge yet)
[S2] round=4 local utility u=0.461789 metrics={'f1_val': 0.5389773376177686, 'auprc': 0.7733173239869515, 'loss_val': 0.8223931658027173, 'psi': 0.6327133321654418}-{'f1_val': 0.416729796526099, 'auprc': 0.7815712695647253, 'loss_val': 1.0372482469895232, 'psi': 0.5626663857415495}
[S3] START round=4 head_norm_before_train=1.282298 (no previous merge yet)
[S3] round=4 local utility u=0.020724 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9957522543057407, 'loss_val': 1.20106593695892, 'psi': 0.4822049410907605}-{'f1_val': 0.13984006561410703, 'auprc': 0.9955588172765608, 'loss_val': 1.2419337545188038, 'psi': 0.4821275662790886}
[S4] START round=4 head_norm_before_train=1.308025 (no previous merge yet)
[S4] round=4 local utility u=0.000000 metrics={'f1_val': 0.652606252308433, 'auprc': 0.6614675576733703, 'loss_val': 0.6586714638655815, 'psi': 0.656150774454408}-{'f1_val': 0.6761320989280215, 'auprc': 0.7776943949725086, 'loss_val': 0.9038656786575372, 'psi': 0.7167570173458163}
[S5] START round=4 head_norm_before_train=0.907402 cos_to_last_merge=0.9906 (last merge round=1)
[S5] round=4 local utility u=0.018171 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.729096587450019, 'loss_val': 1.2537768865640155, 'psi': 0.3769957778371505}-{'f1_val': 0.14226190476190476, 'auprc': 0.7290407695585064, 'loss_val': 1.2899512560740358, 'psi': 0.37697345068054544}
[S6] START round=4 head_norm_before_train=1.313520 (no previous merge yet)
[S6] round=4 local utility u=0.354136 metrics={'f1_val': 0.41463700409720844, 'auprc': 0.6490343798024131, 'loss_val': 1.0142479761950065, 'psi': 0.5083959543792903}-{'f1_val': 0.2985521353999081, 'auprc': 0.6868250840785599, 'loss_val': 1.1393831151490381, 'psi': 0.4538613148713688}
[S7] START round=4 head_norm_before_train=0.772627 cos_to_last_merge=1.0000 (last merge round=3)
[S7] round=4 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7776320892890678, 'loss_val': 1.2914904755541845, 'psi': 0.39628692935308213}-{'f1_val': 0.14205682272909165, 'auprc': 0.775000505437653, 'loss_val': 1.2803746713892277, 'psi': 0.3952342958125162}
[S8] START round=4 head_norm_before_train=1.035796 cos_to_last_merge=1.0000 (last merge round=3)
[S8] round=4 local utility u=0.681799 metrics={'f1_val': 0.7142391053978291, 'auprc': 0.7764625175004618, 'loss_val': 0.8773735321346405, 'psi': 0.7391284702388823}-{'f1_val': 0.5253129439295892, 'auprc': 0.7724459760242739, 'loss_val': 1.0953651255808792, 'psi': 0.624166156767463}
[S9] START round=4 head_norm_before_train=0.852125 cos_to_last_merge=1.0000 (last merge round=3)
[S9] round=4 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.6688874183028685, 'loss_val': 1.200281286460089, 'psi': 0.35239374160514503}-{'f1_val': 0.141397957139996, 'auprc': 0.8012726883110446, 'loss_val': 1.2110994271291686, 'psi': 0.40534784960841547}
[S10] START round=4 head_norm_before_train=1.308440 (no previous merge yet)
[S10] round=4 local utility u=1.000000 metrics={'f1_val': 0.6882099993787394, 'auprc': 0.8646634054175542, 'loss_val': 0.6469288777175595, 'psi': 0.7587913617942653}-{'f1_val': 0.37768925423885746, 'auprc': 0.8645566674478302, 'loss_val': 0.9201248385818119, 'psi': 0.5724362195224466}
[S11] START round=4 head_norm_before_train=1.234883 (no previous merge yet)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7648826411590259, 'loss_val': 1.1480187557173007, 'psi': 0.3902012664874767}-{'f1_val': 0.14041368337311058, 'auprc': 0.8241265593026819, 'loss_val': 1.2252741506598035, 'psi': 0.41389883374493913}
[S13] START round=4 head_norm_before_train=1.305152 (no previous merge yet)
[S13] round=4 local utility u=0.000000 metrics={'f1_val': 0.371894717209442, 'auprc': 0.7658840961041324, 'loss_val': 0.956329878018986, 'psi': 0.5294904687673182}-{'f1_val': 0.4156839344320697, 'auprc': 0.7298100482756837, 'loss_val': 1.0421535789752423, 'psi': 0.5413343799695153}
[S14] START round=4 head_norm_before_train=1.310205 (no previous merge yet)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.810681373966126, 'loss_val': 1.2193667477268868, 'psi': 0.4084872613160727}-{'f1_val': 0.14035785288270378, 'auprc': 0.8416835421563948, 'loss_val': 1.2705005102118117, 'psi': 0.4208881285921802}
[S15] START round=4 head_norm_before_train=0.845413 cos_to_last_merge=1.0000 (last merge round=3)
[S15] round=4 local utility u=0.345823 metrics={'f1_val': 0.41735530997059733, 'auprc': 0.7934454007725746, 'loss_val': 0.9917580854470703, 'psi': 0.5677913462913883}-{'f1_val': 0.32964309183365115, 'auprc': 0.7833543270771246, 'loss_val': 1.1268569441924032, 'psi': 0.5111275859310406}
[S16] START round=4 head_norm_before_train=1.234628 (no previous merge yet)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7422949961104756, 'loss_val': 1.1963489608722073, 'psi': 0.38130046856371214}-{'f1_val': 0.14063745019920318, 'auprc': 0.7636742402611344, 'loss_val': 1.2588103608513939, 'psi': 0.38985216622397567}
[S17] START round=4 head_norm_before_train=0.674382 cos_to_last_merge=1.0000 (last merge round=3)
[S17] round=4 local utility u=0.403393 metrics={'f1_val': 0.3920107641552383, 'auprc': 0.8076344598478142, 'loss_val': 0.9030615016296188, 'psi': 0.5582602424322687}-{'f1_val': 0.38519606575956267, 'auprc': 0.5994770657589775, 'loss_val': 1.0444869969563226, 'psi': 0.47090846575932865}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:52814
[S2] not sending this round → trigger blocked (psi=0.633)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.739)
[S5] not sending this round → trigger blocked (psi=0.377)
[S15] not sending this round → trigger blocked (psi=0.568)
[S3] not sending this round → trigger blocked (psi=0.482)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.508)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1800 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1800) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.380283)
[S14] loaded HEAD from S10 (vec_in norm=1.380283)
[S14] cosine check vs S10: cos=-0.0281
[S14] DROPPED delta from S10 (cos=-0.0281 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.558)
[S2] START round=5 head_norm_before_train=1.354615 (no previous merge yet)
[S2] round=5 local utility u=0.549176 metrics={'f1_val': 0.6759120217221277, 'auprc': 0.7947744694832842, 'loss_val': 0.6100205661356677, 'psi': 0.7234570008265904}-{'f1_val': 0.5389773376177686, 'auprc': 0.7733173239869515, 'loss_val': 0.8223931658027173, 'psi': 0.6327133321654418}
[S3] START round=5 head_norm_before_train=1.316780 (no previous merge yet)
[S3] round=5 local utility u=0.029678 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9858734715006043, 'loss_val': 1.1120745540956483, 'psi': 0.47825342796870596}-{'f1_val': 0.13984006561410703, 'auprc': 0.9957522543057407, 'loss_val': 1.20106593695892, 'psi': 0.4822049410907605}
[S4] START round=5 head_norm_before_train=1.386540 (no previous merge yet)
[S4] round=5 local utility u=0.200774 metrics={'f1_val': 0.6896377619044636, 'auprc': 0.6608040032570858, 'loss_val': 0.47732101138995864, 'psi': 0.6781042584455125}-{'f1_val': 0.652606252308433, 'auprc': 0.6614675576733703, 'loss_val': 0.6586714638655815, 'psi': 0.656150774454408}
[S5] START round=5 head_norm_before_train=0.937768 cos_to_last_merge=0.9800 (last merge round=1)
[S5] round=5 local utility u=0.025659 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7374545688468377, 'loss_val': 1.227533137173187, 'psi': 0.38033897039587794}-{'f1_val': 0.14226190476190476, 'auprc': 0.729096587450019, 'loss_val': 1.2537768865640155, 'psi': 0.3769957778371505}
[S6] START round=5 head_norm_before_train=1.376990 (no previous merge yet)
[S6] round=5 local utility u=0.948222 metrics={'f1_val': 0.621175300586227, 'auprc': 0.7518177841579201, 'loss_val': 0.6653834157710959, 'psi': 0.6734322940149042}-{'f1_val': 0.41463700409720844, 'auprc': 0.6490343798024131, 'loss_val': 1.0142479761950065, 'psi': 0.5083959543792903}
[S7] START round=5 head_norm_before_train=0.789047 cos_to_last_merge=0.9967 (last merge round=3)
[S7] round=5 local utility u=0.017362 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7777244095394741, 'loss_val': 1.2570433364182358, 'psi': 0.39632385745324467}-{'f1_val': 0.14205682272909165, 'auprc': 0.7776320892890678, 'loss_val': 1.2914904755541845, 'psi': 0.39628692935308213}
[S8] START round=5 head_norm_before_train=1.103657 cos_to_last_merge=0.9922 (last merge round=3)
[S8] round=5 local utility u=0.495828 metrics={'f1_val': 0.7138229449839267, 'auprc': 0.9879134238805505, 'loss_val': 0.5175734641386538, 'psi': 0.8234591365425763}-{'f1_val': 0.7142391053978291, 'auprc': 0.7764625175004618, 'loss_val': 0.8773735321346405, 'psi': 0.7391284702388823}
[S9] START round=5 head_norm_before_train=0.879513 cos_to_last_merge=0.9967 (last merge round=3)
[S9] round=5 local utility u=0.073798 metrics={'f1_val': 0.141397957139996, 'auprc': 0.6854249474923324, 'loss_val': 1.1022974233909006, 'psi': 0.35900875328093057}-{'f1_val': 0.141397957139996, 'auprc': 0.6688874183028685, 'loss_val': 1.200281286460089, 'psi': 0.35239374160514503}
[S10] START round=5 head_norm_before_train=1.380283 (no previous merge yet)
[S10] round=5 local utility u=0.308363 metrics={'f1_val': 0.6883283370027431, 'auprc': 0.9982245340727766, 'loss_val': 0.43159552510207216, 'psi': 0.8122868158307566}-{'f1_val': 0.6882099993787394, 'auprc': 0.8646634054175542, 'loss_val': 0.6469288777175595, 'psi': 0.7587913617942653}
[S11] START round=5 head_norm_before_train=1.275814 (no previous merge yet)
[S11] round=5 local utility u=0.812299 metrics={'f1_val': 0.3896958147905257, 'auprc': 0.7674258217213554, 'loss_val': 1.026742355046447, 'psi': 0.5407878175628575}-{'f1_val': 0.14041368337311058, 'auprc': 0.7648826411590259, 'loss_val': 1.1480187557173007, 'psi': 0.3902012664874767}
[S13] START round=5 head_norm_before_train=1.351777 (no previous merge yet)
[S13] round=5 local utility u=0.670123 metrics={'f1_val': 0.5213042920240796, 'auprc': 0.8303110123901979, 'loss_val': 0.7058216276701651, 'psi': 0.6449069801705269}-{'f1_val': 0.371894717209442, 'auprc': 0.7658840961041324, 'loss_val': 0.956329878018986, 'psi': 0.5294904687673182}
[S14] START round=5 head_norm_before_train=1.348002 (no previous merge yet)
[S14] round=5 local utility u=0.048929 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8172113642735204, 'loss_val': 1.1410992937949396, 'psi': 0.4110992574390304}-{'f1_val': 0.14035785288270378, 'auprc': 0.810681373966126, 'loss_val': 1.2193667477268868, 'psi': 0.4084872613160727}
[S15] START round=5 head_norm_before_train=0.925790 cos_to_last_merge=0.9911 (last merge round=3)
[S15] round=5 local utility u=0.971775 metrics={'f1_val': 0.6899519817509709, 'auprc': 0.7932810955762096, 'loss_val': 0.6832945519359188, 'psi': 0.7312836272810664}-{'f1_val': 0.41735530997059733, 'auprc': 0.7934454007725746, 'loss_val': 0.9917580854470703, 'psi': 0.5677913462913883}
[S16] START round=5 head_norm_before_train=1.270506 (no previous merge yet)
[S16] round=5 local utility u=0.541695 metrics={'f1_val': 0.4150731431819776, 'auprc': 0.5257235689125668, 'loss_val': 1.1098586366894057, 'psi': 0.45933331347421325}-{'f1_val': 0.14063745019920318, 'auprc': 0.7422949961104756, 'loss_val': 1.1963489608722073, 'psi': 0.38130046856371214}
[S17] START round=5 head_norm_before_train=0.761313 cos_to_last_merge=0.9811 (last merge round=3)
[S17] round=5 local utility u=0.000000 metrics={'f1_val': 0.3518424223898232, 'auprc': 0.7878627760066461, 'loss_val': 0.9488208243268146, 'psi': 0.5262505638365524}-{'f1_val': 0.3920107641552383, 'auprc': 0.8076344598478142, 'loss_val': 0.9030615016296188, 'psi': 0.5582602424322687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S15] → sending delta(kind=head bytes=1788) to S9@127.0.0.1:52810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:52809
[S10] not sending this round → trigger blocked (psi=0.812)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:52808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:52808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S11@127.0.0.1:52812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:52812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:52815
[S6] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1804 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1793 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1788 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1788) from S15
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.036310)
[S9] loaded HEAD from S15 (vec_in norm=1.036310)
[S9] cosine check vs S15: cos=0.6924
[S9] BUFFERED delta from S15 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1798) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.387897)
[S8] loaded HEAD from S14 (vec_in norm=1.387897)
[S8] cosine check vs S14: cos=0.0211
[S8] BUFFERED delta from S14 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1804) from S13
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.415167)
[S7] loaded HEAD from S13 (vec_in norm=1.415167)
[S7] cosine check vs S13: cos=-0.0969
[S7] DROPPED delta from S13 (cos=-0.0969 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1800) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.306701)
[S7] loaded HEAD from S16 (vec_in norm=1.306701)
[S7] cosine check vs S16: cos=0.7668
[S7] BUFFERED delta from S16 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1797) from S3
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.348912)
[S11] loaded HEAD from S3 (vec_in norm=1.348912)
[S11] cosine check vs S3: cos=-0.0384
[S11] DROPPED delta from S3 (cos=-0.0384 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1793) from S5
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.964191)
[S11] loaded HEAD from S5 (vec_in norm=0.964191)
[S11] cosine check vs S5: cos=-0.0864
[S11] DROPPED delta from S5 (cos=-0.0864 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1802) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.436152)
[S17] loaded HEAD from S6 (vec_in norm=1.436152)
[S17] cosine check vs S6: cos=0.4246
[S17] BUFFERED delta from S6 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1797) from S7
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.810394)
[S17] loaded HEAD from S7 (vec_in norm=0.810394)
[S17] cosine check vs S7: cos=0.2131
[S17] BUFFERED delta from S7 (total buffered=2)
[S8] RECEIVED delta(kind=head bytes=1803) from S4
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.471166)
[S8] loaded HEAD from S4 (vec_in norm=1.471166)
[S8] cosine check vs S4: cos=0.8302
[S8] BUFFERED delta from S4 (total buffered=2)
[S8] RECEIVED delta(kind=head bytes=1801) from S2
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.418819)
[S8] loaded HEAD from S2 (vec_in norm=1.418819)
[S8] cosine check vs S2: cos=-0.0326
[S8] DROPPED delta from S2 (cos=-0.0326 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1799) from S11
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.316111)
[S8] loaded HEAD from S11 (vec_in norm=1.316111)
[S8] cosine check vs S11: cos=-0.0759
[S8] DROPPED delta from S11 (cos=-0.0759 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1797) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.911427)
[S17] loaded HEAD from S9 (vec_in norm=0.911427)
[S17] cosine check vs S9: cos=0.3169
[S17] BUFFERED delta from S9 (total buffered=3)
[S15] RECEIVED delta(kind=head bytes=1801) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.192185)
[S15] loaded HEAD from S8 (vec_in norm=1.192185)
[S15] cosine check vs S8: cos=0.4542
[S15] BUFFERED delta from S8 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] ⇄ pheromone p=0.662 → S14@127.0.0.1:52814
[S2] ⇄ pheromone p=0.639 → S8@127.0.0.1:52809
[S14] ⇄ pheromone p=0.419 → S8@127.0.0.1:52809
[S16] ⇄ pheromone p=0.478 → S7@127.0.0.1:52808
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=5 metric=0.1421 head_norm=0.810394
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.301759e-01
[S7] stored merged vector for next round verification (round=5)
[S7] DEBUG after merge:  round=5 metric=0.1421 head_norm=0.998525 delta_norm=0.430176
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.354 → S17@127.0.0.1:52817
[S5] ⇄ pheromone p=0.338 → S11@127.0.0.1:52812
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=5 metric=0.7138 head_norm=1.192185
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.851058e-01
[S8] stored merged vector for next round verification (round=5)
[S8] DEBUG after merge:  round=5 metric=0.7009 head_norm=0.990378 delta_norm=0.485106
[S8] aggregate: ROLLBACK (f1_val pre=0.714 post=0.701 tol_abs=0.005 tol_rel=0.0)
[S8] ⇄ pheromone p=0.668 → S15@127.0.0.1:52815
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=5 metric=0.1414 head_norm=0.911427
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.862256e-01
[S9] stored merged vector for next round verification (round=5)
[S9] DEBUG after merge:  round=5 metric=0.1421 head_norm=0.896186 delta_norm=0.386226
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.345 → S17@127.0.0.1:52817
[S11] ⇄ pheromone p=0.524 → S8@127.0.0.1:52809
[S4] ⇄ pheromone p=0.509 → S8@127.0.0.1:52809
[S6] ⇄ pheromone p=0.648 → S17@127.0.0.1:52817
[S13] ⇄ pheromone p=0.601 → S7@127.0.0.1:52808
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=5 metric=0.6900 head_norm=1.036310
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.858524e-01
[S15] stored merged vector for next round verification (round=5)
[S15] DEBUG after merge:  round=5 metric=0.6926 head_norm=0.950999 delta_norm=0.585852
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.688 → S9@127.0.0.1:52810
[S3] ⇄ pheromone p=0.366 → S11@127.0.0.1:52812
[S17] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=5 metric=0.3518 head_norm=0.865877
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.903144e-01
[S17] stored merged vector for next round verification (round=5)
[S17] DEBUG after merge:  round=5 metric=0.3517 head_norm=0.638787 delta_norm=0.390314
[S17] aggregate: ACCEPT kept=['S6', 'S7', 'S9'] (k=3/3) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.489 → S13@127.0.0.1:52813
[S2] START round=6 head_norm_before_train=1.418819 (no previous merge yet)
[S2] round=6 local utility u=0.216865 metrics={'f1_val': 0.6994849702028609, 'auprc': 0.8328591631239601, 'loss_val': 0.43198196626367524, 'psi': 0.7528346473713006}-{'f1_val': 0.6759120217221277, 'auprc': 0.7947744694832842, 'loss_val': 0.6100205661356677, 'psi': 0.7234570008265904}
[S3] START round=6 head_norm_before_train=1.348912 (no previous merge yet)
[S3] round=6 local utility u=0.864890 metrics={'f1_val': 0.396483704974271, 'auprc': 0.9923410892224364, 'loss_val': 0.9415585786423613, 'psi': 0.6348266586735372}-{'f1_val': 0.13984006561410703, 'auprc': 0.9858734715006043, 'loss_val': 1.1120745540956483, 'psi': 0.47825342796870596}
[S4] START round=6 head_norm_before_train=1.471166 (no previous merge yet)
[S4] round=6 local utility u=0.000000 metrics={'f1_val': 0.6733010435448133, 'auprc': 0.6599910067387076, 'loss_val': 0.415750150699207, 'psi': 0.667977028822371}-{'f1_val': 0.6896377619044636, 'auprc': 0.6608040032570858, 'loss_val': 0.47732101138995864, 'psi': 0.6781042584455125}
[S5] START round=6 head_norm_before_train=0.964191 cos_to_last_merge=0.9704 (last merge round=1)
[S5] round=6 local utility u=0.057395 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7582561529155022, 'loss_val': 1.1751482406331961, 'psi': 0.38865960402334376}-{'f1_val': 0.14226190476190476, 'auprc': 0.7374545688468377, 'loss_val': 1.227533137173187, 'psi': 0.38033897039587794}
[S6] START round=6 head_norm_before_train=1.436152 (no previous merge yet)
[S6] round=6 local utility u=0.043902 metrics={'f1_val': 0.6093693631119276, 'auprc': 0.7809872089161198, 'loss_val': 0.594252701413086, 'psi': 0.6780165014336045}-{'f1_val': 0.621175300586227, 'auprc': 0.7518177841579201, 'loss_val': 0.6653834157710959, 'psi': 0.6734322940149042}
[S7] START round=6 head_norm_before_train=0.998525 cos_to_last_merge=1.0000 (last merge round=5)
[S7] round=6 local utility u=0.005563 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7777349730498722, 'loss_val': 1.2459499983723743, 'psi': 0.3963280828574039}-{'f1_val': 0.14205682272909165, 'auprc': 0.7777244095394741, 'loss_val': 1.2570433364182358, 'psi': 0.39632385745324467}
[S8] START round=6 head_norm_before_train=0.990378 cos_to_last_merge=1.0000 (last merge round=5)
[S8] round=6 local utility u=0.014782 metrics={'f1_val': 0.7002025424693468, 'auprc': 0.9856558239052048, 'loss_val': 0.3995151292511404, 'psi': 0.8143838550436899}-{'f1_val': 0.7138229449839267, 'auprc': 0.9879134238805505, 'loss_val': 0.5175734641386538, 'psi': 0.8234591365425763}
[S9] START round=6 head_norm_before_train=0.896186 cos_to_last_merge=1.0000 (last merge round=5)
[S9] round=6 local utility u=1.000000 metrics={'f1_val': 0.41677413407000763, 'auprc': 0.7903895471232228, 'loss_val': 1.024436702528849, 'psi': 0.5662202992912937}-{'f1_val': 0.141397957139996, 'auprc': 0.6854249474923324, 'loss_val': 1.1022974233909006, 'psi': 0.35900875328093057}
[S10] START round=6 head_norm_before_train=1.452968 (no previous merge yet)
[S10] round=6 local utility u=0.044577 metrics={'f1_val': 0.6892367084759253, 'auprc': 0.9926834993194986, 'loss_val': 0.3312688069792427, 'psi': 0.8106154248133547}-{'f1_val': 0.6883283370027431, 'auprc': 0.9982245340727766, 'loss_val': 0.43159552510207216, 'psi': 0.8122868158307566}
[S11] START round=6 head_norm_before_train=1.316111 (no previous merge yet)
[S11] round=6 local utility u=0.425869 metrics={'f1_val': 0.39651855440916606, 'auprc': 0.9794447401679596, 'loss_val': 0.8519972393210442, 'psi': 0.6296890287126835}-{'f1_val': 0.3896958147905257, 'auprc': 0.7674258217213554, 'loss_val': 1.026742355046447, 'psi': 0.5407878175628575}
[S13] START round=6 head_norm_before_train=1.415167 (no previous merge yet)
[S13] round=6 local utility u=0.000000 metrics={'f1_val': 0.3497693577546329, 'auprc': 0.6196149578491459, 'loss_val': 0.7784051643135269, 'psi': 0.4577075977924381}-{'f1_val': 0.5213042920240796, 'auprc': 0.8303110123901979, 'loss_val': 0.7058216276701651, 'psi': 0.6449069801705269}
[S14] START round=6 head_norm_before_train=1.387897 (no previous merge yet)
[S14] round=6 local utility u=1.000000 metrics={'f1_val': 0.4129526361722988, 'auprc': 0.9386336994786589, 'loss_val': 1.0060137423910414, 'psi': 0.6232250614948429}-{'f1_val': 0.14035785288270378, 'auprc': 0.8172113642735204, 'loss_val': 1.1410992937949396, 'psi': 0.4110992574390304}
[S15] START round=6 head_norm_before_train=0.950999 cos_to_last_merge=1.0000 (last merge round=5)
[S15] round=6 local utility u=0.061010 metrics={'f1_val': 0.6910017562413435, 'auprc': 0.7912528223852598, 'loss_val': 0.5614892999629036, 'psi': 0.7311021826989101}-{'f1_val': 0.6899519817509709, 'auprc': 0.7932810955762096, 'loss_val': 0.6832945519359188, 'psi': 0.7312836272810664}
[S16] START round=6 head_norm_before_train=1.306701 (no previous merge yet)
[S16] round=6 local utility u=0.262070 metrics={'f1_val': 0.3963212993577412, 'auprc': 0.7097941423130774, 'loss_val': 1.0254195963591473, 'psi': 0.5217104365398757}-{'f1_val': 0.4150731431819776, 'auprc': 0.5257235689125668, 'loss_val': 1.1098586366894057, 'psi': 0.45933331347421325}
[S17] START round=6 head_norm_before_train=0.638787 cos_to_last_merge=1.0000 (last merge round=5)
[S17] round=6 local utility u=0.095999 metrics={'f1_val': 0.35988199158749595, 'auprc': 0.8040122404371672, 'loss_val': 0.8535080816310937, 'psi': 0.5375340911273645}-{'f1_val': 0.3518424223898232, 'auprc': 0.7878627760066461, 'loss_val': 0.9488208243268146, 'psi': 0.5262505638365524}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S11@127.0.0.1:52812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:52815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:52812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S7] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:52808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:52810
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:52814
[S16] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1792 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1797) from S15
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.043734)
[S9] loaded HEAD from S15 (vec_in norm=1.043734)
[S9] cosine check vs S15: cos=0.7305
[S9] BUFFERED delta from S15 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1795) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.342043)
[S7] loaded HEAD from S16 (vec_in norm=1.342043)
[S7] cosine check vs S16: cos=0.9529
[S7] BUFFERED delta from S16 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1802) from S5
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.980018)
[S11] loaded HEAD from S5 (vec_in norm=0.980018)
[S11] cosine check vs S5: cos=-0.0905
[S11] DROPPED delta from S5 (cos=-0.0905 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1804) from S3
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.386824)
[S11] loaded HEAD from S3 (vec_in norm=1.386824)
[S11] cosine check vs S3: cos=-0.0360
[S11] DROPPED delta from S3 (cos=-0.0360 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1797) from S11
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.360610)
[S8] loaded HEAD from S11 (vec_in norm=1.360610)
[S8] cosine check vs S11: cos=-0.0658
[S8] DROPPED delta from S11 (cos=-0.0658 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1801) from S2
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.475331)
[S8] loaded HEAD from S2 (vec_in norm=1.475331)
[S8] cosine check vs S2: cos=-0.0250
[S8] DROPPED delta from S2 (cos=-0.0250 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1799) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.434839)
[S8] loaded HEAD from S14 (vec_in norm=1.434839)
[S8] cosine check vs S14: cos=0.3493
[S8] BUFFERED delta from S14 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1800) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.089021)
[S15] loaded HEAD from S8 (vec_in norm=1.089021)
[S15] cosine check vs S8: cos=0.7410
[S15] BUFFERED delta from S8 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1799) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.526185)
[S14] loaded HEAD from S10 (vec_in norm=1.526185)
[S14] cosine check vs S10: cos=-0.0283
[S14] DROPPED delta from S10 (cos=-0.0283 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1798) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.926384)
[S17] loaded HEAD from S9 (vec_in norm=0.926384)
[S17] cosine check vs S9: cos=0.5370
[S17] BUFFERED delta from S9 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1792) from S7
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.009880)
[S17] loaded HEAD from S7 (vec_in norm=1.009880)
[S17] cosine check vs S7: cos=0.3662
[S17] BUFFERED delta from S7 (total buffered=2)
[S17] RECEIVED delta(kind=head bytes=1800) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.492791)
[S17] loaded HEAD from S6 (vec_in norm=1.492791)
[S17] cosine check vs S6: cos=0.3995
[S17] BUFFERED delta from S6 (total buffered=3)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:52813
[S17] sending update (kind=head size=1797 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1797) from S17
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.736241)
[S13] loaded HEAD from S17 (vec_in norm=0.736241)
[S13] cosine check vs S17: cos=-0.0360
[S13] DROPPED delta from S17 (cos=-0.0360 < 0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=6 metric=0.6910 head_norm=1.043734
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.843056e-01
[S15] stored merged vector for next round verification (round=6)
[S15] DEBUG after merge:  round=6 metric=0.6875 head_norm=0.994979 delta_norm=0.384306
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=6 metric=0.7002 head_norm=1.089021
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.336931e-01
[S8] stored merged vector for next round verification (round=6)
[S8] DEBUG after merge:  round=6 metric=0.7013 head_norm=1.041182 delta_norm=0.733693
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=6 metric=0.4168 head_norm=0.926384
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.656937e-01
[S9] stored merged vector for next round verification (round=6)
[S9] DEBUG after merge:  round=6 metric=0.4170 head_norm=0.916544 delta_norm=0.365694
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=6 metric=0.1421 head_norm=1.009880
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.438708e-01
[S7] stored merged vector for next round verification (round=6)
[S7] DEBUG after merge:  round=6 metric=0.1421 head_norm=1.162323 delta_norm=0.243871
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=6 metric=0.3599 head_norm=0.736241
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.764409e-01
[S17] stored merged vector for next round verification (round=6)
[S17] DEBUG after merge:  round=6 metric=0.5026 head_norm=0.649422 delta_norm=0.276441
[S17] aggregate: ACCEPT kept=['S9', 'S7', 'S6'] (k=3/3) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=1.475331 (no previous merge yet)
[S2] round=7 local utility u=0.216173 metrics={'f1_val': 0.6988664978654815, 'auprc': 0.9477088164829006, 'loss_val': 0.34047496646851627, 'psi': 0.7984034253124491}-{'f1_val': 0.6994849702028609, 'auprc': 0.8328591631239601, 'loss_val': 0.43198196626367524, 'psi': 0.7528346473713006}
[S3] START round=7 head_norm_before_train=1.386824 (no previous merge yet)
[S3] round=7 local utility u=0.382007 metrics={'f1_val': 0.4889269643093732, 'auprc': 0.9983843970432073, 'loss_val': 0.7503345802267865, 'psi': 0.6927099374029069}-{'f1_val': 0.396483704974271, 'auprc': 0.9923410892224364, 'loss_val': 0.9415585786423613, 'psi': 0.6348266586735372}
[S4] START round=7 head_norm_before_train=1.539207 (no previous merge yet)
[S4] round=7 local utility u=0.272997 metrics={'f1_val': 0.6670077953128555, 'auprc': 0.8593103771122026, 'loss_val': 0.42995545720188877, 'psi': 0.7439288280325944}-{'f1_val': 0.6733010435448133, 'auprc': 0.6599910067387076, 'loss_val': 0.415750150699207, 'psi': 0.667977028822371}
[S5] START round=7 head_norm_before_train=0.980018 cos_to_last_merge=0.9634 (last merge round=1)
[S5] round=7 local utility u=0.877915 metrics={'f1_val': 0.41654174186412063, 'auprc': 0.771996383332763, 'loss_val': 1.1062172013131424, 'psi': 0.5587235984515776}-{'f1_val': 0.14226190476190476, 'auprc': 0.7582561529155022, 'loss_val': 1.1751482406331961, 'psi': 0.38865960402334376}
[S6] START round=7 head_norm_before_train=1.492791 (no previous merge yet)
[S6] round=7 local utility u=0.694582 metrics={'f1_val': 0.708276017717507, 'auprc': 0.9817754522679412, 'loss_val': 0.4008937426710844, 'psi': 0.8176757915376807}-{'f1_val': 0.6093693631119276, 'auprc': 0.7809872089161198, 'loss_val': 0.594252701413086, 'psi': 0.6780165014336045}
[S7] START round=7 head_norm_before_train=1.162323 cos_to_last_merge=1.0000 (last merge round=6)
[S7] round=7 local utility u=0.011119 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7774454940623862, 'loss_val': 1.2228434411167255, 'psi': 0.3962122912624095}-{'f1_val': 0.14205682272909165, 'auprc': 0.7777349730498722, 'loss_val': 1.2459499983723743, 'psi': 0.3963280828574039}
[S8] START round=7 head_norm_before_train=1.041182 cos_to_last_merge=1.0000 (last merge round=6)
[S8] round=7 local utility u=0.923286 metrics={'f1_val': 0.9939638799200972, 'auprc': 0.9964799982196648, 'loss_val': 0.3479842346308281, 'psi': 0.9949703272399242}-{'f1_val': 0.7002025424693468, 'auprc': 0.9856558239052048, 'loss_val': 0.3995151292511404, 'psi': 0.8143838550436899}
[S9] START round=7 head_norm_before_train=0.916544 cos_to_last_merge=1.0000 (last merge round=6)
[S9] round=7 local utility u=0.000000 metrics={'f1_val': 0.4165312595683305, 'auprc': 0.6688406975149761, 'loss_val': 0.9301901302342019, 'psi': 0.5174550347469887}-{'f1_val': 0.41677413407000763, 'auprc': 0.7903895471232228, 'loss_val': 1.024436702528849, 'psi': 0.5662202992912937}
[S10] START round=7 head_norm_before_train=1.526185 (no previous merge yet)
[S10] round=7 local utility u=0.000000 metrics={'f1_val': 0.5734979299402987, 'auprc': 0.9107742060093948, 'loss_val': 0.4026934238739611, 'psi': 0.7084084403679372}-{'f1_val': 0.6892367084759253, 'auprc': 0.9926834993194986, 'loss_val': 0.3312688069792427, 'psi': 0.8106154248133547}
[S11] START round=7 head_norm_before_train=1.360610 (no previous merge yet)
[S11] round=7 local utility u=0.262427 metrics={'f1_val': 0.44761393659269755, 'auprc': 0.9988142580769546, 'loss_val': 0.6918237836661212, 'psi': 0.6680940651864004}-{'f1_val': 0.39651855440916606, 'auprc': 0.9794447401679596, 'loss_val': 0.8519972393210442, 'psi': 0.6296890287126835}
[S13] START round=7 head_norm_before_train=1.475947 (no previous merge yet)
[S13] round=7 local utility u=1.000000 metrics={'f1_val': 0.6896292640377849, 'auprc': 0.7561801130269935, 'loss_val': 0.4481180861769329, 'psi': 0.7162496036334683}-{'f1_val': 0.3497693577546329, 'auprc': 0.6196149578491459, 'loss_val': 0.7784051643135269, 'psi': 0.4577075977924381}
[S14] START round=7 head_norm_before_train=1.434839 (no previous merge yet)
[S14] round=7 local utility u=0.195668 metrics={'f1_val': 0.41134264189849645, 'auprc': 0.9977838533106171, 'loss_val': 0.7824684345293081, 'psi': 0.6459191264633447}-{'f1_val': 0.4129526361722988, 'auprc': 0.9386336994786589, 'loss_val': 1.0060137423910414, 'psi': 0.6232250614948429}
[S15] START round=7 head_norm_before_train=0.994979 cos_to_last_merge=1.0000 (last merge round=6)
[S15] round=7 local utility u=0.046356 metrics={'f1_val': 0.6922855129905103, 'auprc': 0.8083731829849191, 'loss_val': 0.5278415778991399, 'psi': 0.7387205809882739}-{'f1_val': 0.6910017562413435, 'auprc': 0.7912528223852598, 'loss_val': 0.5614892999629036, 'psi': 0.7311021826989101}
[S16] START round=7 head_norm_before_train=1.342043 (no previous merge yet)
[S16] round=7 local utility u=0.023009 metrics={'f1_val': 0.3861312346826704, 'auprc': 0.7231095430138025, 'loss_val': 0.9582066029332976, 'psi': 0.5209225580151232}-{'f1_val': 0.3963212993577412, 'auprc': 0.7097941423130774, 'loss_val': 1.0254195963591473, 'psi': 0.5217104365398757}
[S17] START round=7 head_norm_before_train=0.649422 cos_to_last_merge=1.0000 (last merge round=6)
[S17] round=7 local utility u=0.159451 metrics={'f1_val': 0.3892077216422175, 'auprc': 0.8172227578247102, 'loss_val': 0.7501922999464851, 'psi': 0.5604137361152146}-{'f1_val': 0.35988199158749595, 'auprc': 0.8040122404371672, 'loss_val': 0.8535080816310937, 'psi': 0.5375340911273645}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:52812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:52815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] → sending delta(kind=head bytes=1792) to S9@127.0.0.1:52810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:52809
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:52808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:52808
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:52812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:52809
[S5] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1792 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1792) from S15
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.075822)
[S9] loaded HEAD from S15 (vec_in norm=1.075822)
[S9] cosine check vs S15: cos=0.8387
[S9] BUFFERED delta from S15 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1802) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.377105)
[S7] loaded HEAD from S16 (vec_in norm=1.377105)
[S7] cosine check vs S16: cos=0.9838
[S7] BUFFERED delta from S16 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1796) from S13
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.521558)
[S7] loaded HEAD from S13 (vec_in norm=1.521558)
[S7] cosine check vs S13: cos=-0.1028
[S7] DROPPED delta from S13 (cos=-0.1028 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1796) from S5
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.002209)
[S11] loaded HEAD from S5 (vec_in norm=1.002209)
[S11] cosine check vs S5: cos=-0.0938
[S11] DROPPED delta from S5 (cos=-0.0938 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1797) from S7
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.172421)
[S17] loaded HEAD from S7 (vec_in norm=1.172421)
[S17] cosine check vs S7: cos=0.4855
[S17] BUFFERED delta from S7 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1802) from S3
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.432661)
[S11] loaded HEAD from S3 (vec_in norm=1.432661)
[S11] cosine check vs S3: cos=-0.0338
[S11] DROPPED delta from S3 (cos=-0.0338 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1803) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.545715)
[S17] loaded HEAD from S6 (vec_in norm=1.545715)
[S17] cosine check vs S6: cos=0.3536
[S17] BUFFERED delta from S6 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1802) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.124858)
[S15] loaded HEAD from S8 (vec_in norm=1.124858)
[S15] cosine check vs S8: cos=0.6491
[S15] BUFFERED delta from S8 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1804) from S4
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.585458)
[S8] loaded HEAD from S4 (vec_in norm=1.585458)
[S8] cosine check vs S4: cos=0.4543
[S8] BUFFERED delta from S4 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1799) from S11
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.407513)
[S8] loaded HEAD from S11 (vec_in norm=1.407513)
[S8] cosine check vs S11: cos=-0.0178
[S8] DROPPED delta from S11 (cos=-0.0178 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1801) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.491685)
[S8] loaded HEAD from S14 (vec_in norm=1.491685)
[S8] cosine check vs S14: cos=0.8295
[S8] BUFFERED delta from S14 (total buffered=2)
[S8] RECEIVED delta(kind=head bytes=1801) from S2
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.540027)
[S8] loaded HEAD from S2 (vec_in norm=1.540027)
[S8] cosine check vs S2: cos=0.0165
[S8] BUFFERED delta from S2 (total buffered=3)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:52813
[S17] sending update (kind=head size=1796 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1796) from S17
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.746051)
[S13] loaded HEAD from S17 (vec_in norm=0.746051)
[S13] cosine check vs S17: cos=-0.0614
[S13] DROPPED delta from S17 (cos=-0.0614 < 0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=7 metric=0.4165 head_norm=0.953180
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.940054e-01
[S9] stored merged vector for next round verification (round=7)
[S9] DEBUG after merge:  round=7 metric=0.4168 head_norm=0.972900 delta_norm=0.294005
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=7 metric=0.1421 head_norm=1.172421
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.534613e-01
[S7] stored merged vector for next round verification (round=7)
[S7] DEBUG after merge:  round=7 metric=0.1421 head_norm=1.269623 delta_norm=0.153461
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=7 metric=0.9940 head_norm=1.124858
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.599361e-01
[S8] stored merged vector for next round verification (round=7)
[S8] DEBUG after merge:  round=7 metric=0.9940 head_norm=0.947943 delta_norm=0.359936
[S8] aggregate: ACCEPT kept=['S4', 'S14', 'S2'] (k=3/3) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=7 metric=0.6923 head_norm=1.075822
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.614229e-01
[S15] stored merged vector for next round verification (round=7)
[S15] DEBUG after merge:  round=7 metric=0.6916 head_norm=0.999219 delta_norm=0.461423
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=7 metric=0.3892 head_norm=0.746051
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.802913e-01
[S17] stored merged vector for next round verification (round=7)
[S17] DEBUG after merge:  round=7 metric=0.3885 head_norm=0.748879 delta_norm=0.380291
[S17] aggregate: ACCEPT kept=['S7', 'S6'] (k=2/2) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=1.540027 (no previous merge yet)
[S2] round=8 local utility u=0.076485 metrics={'f1_val': 0.6977844884088208, 'auprc': 0.9912414741814197, 'loss_val': 0.31161010611710976, 'psi': 0.8151672827178604}-{'f1_val': 0.6988664978654815, 'auprc': 0.9477088164829006, 'loss_val': 0.34047496646851627, 'psi': 0.7984034253124491}
[S3] START round=8 head_norm_before_train=1.432661 (no previous merge yet)
[S3] round=8 local utility u=0.000000 metrics={'f1_val': 0.4024484509855121, 'auprc': 0.8956128580845394, 'loss_val': 0.6832691535312584, 'psi': 0.599714213825123}-{'f1_val': 0.4889269643093732, 'auprc': 0.9983843970432073, 'loss_val': 0.7503345802267865, 'psi': 0.6927099374029069}
[S4] START round=8 head_norm_before_train=1.585458 (no previous merge yet)
[S4] round=8 local utility u=0.000000 metrics={'f1_val': 0.6118490907444283, 'auprc': 0.950511943585974, 'loss_val': 0.44917816819735695, 'psi': 0.7473142318810466}-{'f1_val': 0.6670077953128555, 'auprc': 0.8593103771122026, 'loss_val': 0.42995545720188877, 'psi': 0.7439288280325944}
[S5] START round=8 head_norm_before_train=1.002209 cos_to_last_merge=0.9537 (last merge round=1)
[S5] round=8 local utility u=0.080211 metrics={'f1_val': 0.41795135763108626, 'auprc': 0.7875079873034018, 'loss_val': 1.0007870716140208, 'psi': 0.5657740095000126}-{'f1_val': 0.41654174186412063, 'auprc': 0.771996383332763, 'loss_val': 1.1062172013131424, 'psi': 0.5587235984515776}
[S6] START round=8 head_norm_before_train=1.545715 (no previous merge yet)
[S6] round=8 local utility u=0.000000 metrics={'f1_val': 0.7069492151754729, 'auprc': 0.9590378916823997, 'loss_val': 0.37017547679719354, 'psi': 0.8077846857782437}-{'f1_val': 0.708276017717507, 'auprc': 0.9817754522679412, 'loss_val': 0.4008937426710844, 'psi': 0.8176757915376807}
[S7] START round=8 head_norm_before_train=1.269623 cos_to_last_merge=1.0000 (last merge round=7)
[S7] round=8 local utility u=0.758676 metrics={'f1_val': 0.387820978753007, 'auprc': 0.7777978565835958, 'loss_val': 1.1811330419041093, 'psi': 0.5438117298852425}-{'f1_val': 0.14205682272909165, 'auprc': 0.7774454940623862, 'loss_val': 1.2228434411167255, 'psi': 0.3962122912624095}
[S8] START round=8 head_norm_before_train=0.947943 cos_to_last_merge=1.0000 (last merge round=7)
[S8] round=8 local utility u=0.023837 metrics={'f1_val': 0.9939849501843234, 'auprc': 0.9982887984394999, 'loss_val': 0.3058630044808045, 'psi': 0.9957064894863941}-{'f1_val': 0.9939638799200972, 'auprc': 0.9964799982196648, 'loss_val': 0.3479842346308281, 'psi': 0.9949703272399242}
[S9] START round=8 head_norm_before_train=0.972900 cos_to_last_merge=1.0000 (last merge round=7)
[S9] round=8 local utility u=0.191023 metrics={'f1_val': 0.3846167165770218, 'auprc': 0.8024961044154673, 'loss_val': 0.7576235778077993, 'psi': 0.5517684717124}-{'f1_val': 0.4165312595683305, 'auprc': 0.6688406975149761, 'loss_val': 0.9301901302342019, 'psi': 0.5174550347469887}
[S10] START round=8 head_norm_before_train=1.580032 (no previous merge yet)
[S10] round=8 local utility u=0.620109 metrics={'f1_val': 0.6996640466857562, 'auprc': 0.9977219271565665, 'loss_val': 0.18031449793745125, 'psi': 0.8188871988740803}-{'f1_val': 0.5734979299402987, 'auprc': 0.9107742060093948, 'loss_val': 0.4026934238739611, 'psi': 0.7084084403679372}
[S11] START round=8 head_norm_before_train=1.407513 (no previous merge yet)
[S11] round=8 local utility u=0.374368 metrics={'f1_val': 0.5543633357668446, 'auprc': 0.9974247929059514, 'loss_val': 0.5794155032056252, 'psi': 0.7315879186224874}-{'f1_val': 0.44761393659269755, 'auprc': 0.9988142580769546, 'loss_val': 0.6918237836661212, 'psi': 0.6680940651864004}
[S13] START round=8 head_norm_before_train=1.521558 (no previous merge yet)
[S13] round=8 local utility u=0.000000 metrics={'f1_val': 0.6891322111288347, 'auprc': 0.720821285058284, 'loss_val': 0.46544850011942573, 'psi': 0.7018078407006144}-{'f1_val': 0.6896292640377849, 'auprc': 0.7561801130269935, 'loss_val': 0.4481180861769329, 'psi': 0.7162496036334683}
[S14] START round=8 head_norm_before_train=1.491685 (no previous merge yet)
[S14] round=8 local utility u=0.766168 metrics={'f1_val': 0.6394605883028632, 'auprc': 0.9922372834130666, 'loss_val': 0.6022006254734252, 'psi': 0.7805712663469446}-{'f1_val': 0.41134264189849645, 'auprc': 0.9977838533106171, 'loss_val': 0.7824684345293081, 'psi': 0.6459191264633447}
[S15] START round=8 head_norm_before_train=0.999219 cos_to_last_merge=1.0000 (last merge round=7)
[S15] round=8 local utility u=0.289006 metrics={'f1_val': 0.693757614868665, 'auprc': 0.9715410348144897, 'loss_val': 0.44816630100400445, 'psi': 0.8048709828469949}-{'f1_val': 0.6922855129905103, 'auprc': 0.8083731829849191, 'loss_val': 0.5278415778991399, 'psi': 0.7387205809882739}
[S16] START round=8 head_norm_before_train=1.377105 (no previous merge yet)
[S16] round=8 local utility u=0.000000 metrics={'f1_val': 0.29774103756261944, 'auprc': 0.7577987309817209, 'loss_val': 0.9975219379378094, 'psi': 0.48176411493026006}-{'f1_val': 0.3861312346826704, 'auprc': 0.7231095430138025, 'loss_val': 0.9582066029332976, 'psi': 0.5209225580151232}
[S17] START round=8 head_norm_before_train=0.748879 cos_to_last_merge=1.0000 (last merge round=7)
[S17] round=8 local utility u=0.008108 metrics={'f1_val': 0.38933943659528203, 'auprc': 0.8213014103816579, 'loss_val': 0.747003019233335, 'psi': 0.5621242261098324}-{'f1_val': 0.3892077216422175, 'auprc': 0.8172227578247102, 'loss_val': 0.7501922999464851, 'psi': 0.5604137361152146}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.996)
[S14] not sending this round → trigger blocked (psi=0.781)
[S7] not sending this round → trigger blocked (psi=0.544)
[S11] not sending this round → trigger blocked (psi=0.732)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.815)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:52814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:52817
[S5] not sending this round → trigger blocked (psi=0.566)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.805)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1795) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.014331)
[S17] loaded HEAD from S9 (vec_in norm=1.014331)
[S17] cosine check vs S9: cos=0.3314
[S17] BUFFERED delta from S9 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1803) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.624607)
[S14] loaded HEAD from S10 (vec_in norm=1.624607)
[S14] cosine check vs S10: cos=-0.0259
[S14] DROPPED delta from S10 (cos=-0.0259 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.562)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=8 metric=0.3893 head_norm=0.831463
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.387939e-01
[S17] stored merged vector for next round verification (round=8)
[S17] DEBUG after merge:  round=8 metric=0.3894 head_norm=0.754851 delta_norm=0.538794
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.598718 (no previous merge yet)
[S2] round=9 local utility u=0.000000 metrics={'f1_val': 0.6994076265853314, 'auprc': 0.937811847599082, 'loss_val': 0.2824214897211301, 'psi': 0.7947693149908317}-{'f1_val': 0.6977844884088208, 'auprc': 0.9912414741814197, 'loss_val': 0.31161010611710976, 'psi': 0.8151672827178604}
[S3] START round=9 head_norm_before_train=1.483774 (no previous merge yet)
[S3] round=9 local utility u=0.831416 metrics={'f1_val': 0.6007004521553635, 'auprc': 0.9990332801202167, 'loss_val': 0.5202099511923757, 'psi': 0.7600335833413048}-{'f1_val': 0.4024484509855121, 'auprc': 0.8956128580845394, 'loss_val': 0.6832691535312584, 'psi': 0.599714213825123}
[S4] START round=9 head_norm_before_train=1.633867 (no previous merge yet)
[S4] round=9 local utility u=0.000000 metrics={'f1_val': 0.6142330342132605, 'auprc': 0.9301516475107122, 'loss_val': 0.4848940231920302, 'psi': 0.7406004795322412}-{'f1_val': 0.6118490907444283, 'auprc': 0.950511943585974, 'loss_val': 0.44917816819735695, 'psi': 0.7473142318810466}
[S5] START round=9 head_norm_before_train=1.035948 cos_to_last_merge=0.9397 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.940
[S5] round=9 local utility u=0.071805 metrics={'f1_val': 0.4176671856330787, 'auprc': 0.8020311328243026, 'loss_val': 0.89904147500051, 'psi': 0.5714127645095683}-{'f1_val': 0.41795135763108626, 'auprc': 0.7875079873034018, 'loss_val': 1.0007870716140208, 'psi': 0.5657740095000126}
[S6] START round=9 head_norm_before_train=1.589635 (no previous merge yet)
[S6] round=9 local utility u=0.000000 metrics={'f1_val': 0.6305766167155283, 'auprc': 0.8002066111847848, 'loss_val': 0.4931219422142157, 'psi': 0.6984286145032309}-{'f1_val': 0.7069492151754729, 'auprc': 0.9590378916823997, 'loss_val': 0.37017547679719354, 'psi': 0.8077846857782437}
[S7] START round=9 head_norm_before_train=1.277453 cos_to_last_merge=0.9991 (last merge round=7)
[S7] round=9 local utility u=1.000000 metrics={'f1_val': 0.714398832901065, 'auprc': 0.7776099633242066, 'loss_val': 1.0995784759186409, 'psi': 0.7396832850703217}-{'f1_val': 0.387820978753007, 'auprc': 0.7777978565835958, 'loss_val': 1.1811330419041093, 'psi': 0.5438117298852425}
[S8] START round=9 head_norm_before_train=1.044717 cos_to_last_merge=0.9890 (last merge round=7)
[S8] round=9 local utility u=0.041196 metrics={'f1_val': 0.9934042750107773, 'auprc': 0.994450777925611, 'loss_val': 0.20847272814763645, 'psi': 0.9938228761767107}-{'f1_val': 0.9939849501843234, 'auprc': 0.9982887984394999, 'loss_val': 0.3058630044808045, 'psi': 0.9957064894863941}
[S9] START round=9 head_norm_before_train=1.014331 cos_to_last_merge=0.9957 (last merge round=7)
[S9] round=9 local utility u=0.506674 metrics={'f1_val': 0.4366748822799233, 'auprc': 0.9894066504435157, 'loss_val': 0.6173563636238482, 'psi': 0.6577675895453603}-{'f1_val': 0.3846167165770218, 'auprc': 0.8024961044154673, 'loss_val': 0.7576235778077993, 'psi': 0.5517684717124}
[S10] START round=9 head_norm_before_train=1.624607 (no previous merge yet)
[S10] round=9 local utility u=0.881036 metrics={'f1_val': 0.9907184940410634, 'auprc': 0.9956626184123936, 'loss_val': 0.15839178799313405, 'psi': 0.9926961437895954}-{'f1_val': 0.6996640466857562, 'auprc': 0.9977219271565665, 'loss_val': 0.18031449793745125, 'psi': 0.8188871988740803}
[S11] START round=9 head_norm_before_train=1.458513 (no previous merge yet)
[S11] round=9 local utility u=0.508190 metrics={'f1_val': 0.7020664967782734, 'auprc': 0.9983472404732591, 'loss_val': 0.4520215975454352, 'psi': 0.8205787942562677}-{'f1_val': 0.5543633357668446, 'auprc': 0.9974247929059514, 'loss_val': 0.5794155032056252, 'psi': 0.7315879186224874}
[S13] START round=9 head_norm_before_train=1.555989 (no previous merge yet)
[S13] round=9 local utility u=0.104350 metrics={'f1_val': 0.6880553722782647, 'auprc': 0.7757312627390681, 'loss_val': 0.4150164828297958, 'psi': 0.723125728462586}-{'f1_val': 0.6891322111288347, 'auprc': 0.720821285058284, 'loss_val': 0.46544850011942573, 'psi': 0.7018078407006144}
[S14] START round=9 head_norm_before_train=1.550607 (no previous merge yet)
[S14] round=9 local utility u=0.307818 metrics={'f1_val': 0.7010953924152618, 'auprc': 0.9975265591926312, 'loss_val': 0.3722418988204648, 'psi': 0.8196678591262097}-{'f1_val': 0.6394605883028632, 'auprc': 0.9922372834130666, 'loss_val': 0.6022006254734252, 'psi': 0.7805712663469446}
[S15] START round=9 head_norm_before_train=1.079920 cos_to_last_merge=0.9857 (last merge round=7)
[S15] round=9 local utility u=0.000000 metrics={'f1_val': 0.6939922527607938, 'auprc': 0.9166795172962846, 'loss_val': 0.42885250712595735, 'psi': 0.7830671585749902}-{'f1_val': 0.693757614868665, 'auprc': 0.9715410348144897, 'loss_val': 0.44816630100400445, 'psi': 0.8048709828469949}
[S16] START round=9 head_norm_before_train=1.411149 (no previous merge yet)
[S16] round=9 local utility u=0.451095 metrics={'f1_val': 0.4369640837117893, 'auprc': 0.7425970180939403, 'loss_val': 0.8850659443746404, 'psi': 0.5592172574646497}-{'f1_val': 0.29774103756261944, 'auprc': 0.7577987309817209, 'loss_val': 0.9975219379378094, 'psi': 0.48176411493026006}
[S17] START round=9 head_norm_before_train=0.754851 cos_to_last_merge=1.0000 (last merge round=8)
[S17] round=9 local utility u=0.054963 metrics={'f1_val': 0.38918006077257744, 'auprc': 0.8522376114563694, 'loss_val': 0.7289285874537503, 'psi': 0.5744030810460943}-{'f1_val': 0.38933943659528203, 'auprc': 0.8213014103816579, 'loss_val': 0.747003019233335, 'psi': 0.5621242261098324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:52808
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:52812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:52815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:52814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:52812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] → sending delta(kind=head bytes=1793) to S7@127.0.0.1:52808
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S11] → sending delta(kind=head bytes=1809) to S8@127.0.0.1:52809
[S16] sending update (kind=head size=1793 to 1 peers)
[S11] sending update (kind=head size=1809 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1804 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1793) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.442155)
[S7] loaded HEAD from S16 (vec_in norm=1.442155)
[S7] cosine check vs S16: cos=0.9844
[S7] BUFFERED delta from S16 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1798) from S13
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.588915)
[S7] loaded HEAD from S13 (vec_in norm=1.588915)
[S7] cosine check vs S13: cos=-0.0957
[S7] DROPPED delta from S13 (cos=-0.0957 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1800) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.142141)
[S15] loaded HEAD from S8 (vec_in norm=1.142141)
[S15] cosine check vs S8: cos=0.8111
[S15] BUFFERED delta from S8 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1800) from S5
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.066368)
[S11] loaded HEAD from S5 (vec_in norm=1.066368)
[S11] cosine check vs S5: cos=-0.0956
[S11] DROPPED delta from S5 (cos=-0.0956 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1796) from S3
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.536034)
[S11] loaded HEAD from S3 (vec_in norm=1.536034)
[S11] cosine check vs S3: cos=-0.0351
[S11] DROPPED delta from S3 (cos=-0.0351 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1809) from S11
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.501121)
[S8] loaded HEAD from S11 (vec_in norm=1.501121)
[S8] cosine check vs S11: cos=-0.0283
[S8] DROPPED delta from S11 (cos=-0.0283 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1800) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.611983)
[S8] loaded HEAD from S14 (vec_in norm=1.611983)
[S8] cosine check vs S14: cos=0.7181
[S8] BUFFERED delta from S14 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1796) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.652940)
[S14] loaded HEAD from S10 (vec_in norm=1.652940)
[S14] cosine check vs S10: cos=-0.0227
[S14] DROPPED delta from S10 (cos=-0.0227 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1800) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.066979)
[S17] loaded HEAD from S9 (vec_in norm=1.066979)
[S17] cosine check vs S9: cos=0.8017
[S17] BUFFERED delta from S9 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1804) from S7
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.290350)
[S17] loaded HEAD from S7 (vec_in norm=1.290350)
[S17] cosine check vs S7: cos=0.3997
[S17] BUFFERED delta from S7 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:52813
[S17] sending update (kind=head size=1797 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1797) from S17
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.836001)
[S13] loaded HEAD from S17 (vec_in norm=0.836001)
[S13] cosine check vs S17: cos=-0.0405
[S13] DROPPED delta from S17 (cos=-0.0405 < 0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=9 metric=0.7144 head_norm=1.290350
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.423116e-01
[S7] stored merged vector for next round verification (round=9)
[S7] DEBUG after merge:  round=9 metric=0.7146 head_norm=1.360938 delta_norm=0.142312
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=9 metric=0.9934 head_norm=1.142141
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.609899e-01
[S8] stored merged vector for next round verification (round=9)
[S8] DEBUG after merge:  round=9 metric=0.9927 head_norm=1.279366 delta_norm=0.560990
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=9 metric=0.3892 head_norm=0.836001
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.131880e-01
[S17] stored merged vector for next round verification (round=9)
[S17] DEBUG after merge:  round=9 metric=0.3892 head_norm=0.819259 delta_norm=0.313188
[S17] aggregate: ACCEPT kept=['S9', 'S7'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=9 metric=0.6940 head_norm=1.182540
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.577690e-01
[S15] stored merged vector for next round verification (round=9)
[S15] DEBUG after merge:  round=9 metric=0.6934 head_norm=1.106094 delta_norm=0.357769
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.640519 (no previous merge yet)
[S2] round=10 local utility u=0.082376 metrics={'f1_val': 0.6989664503920486, 'auprc': 0.9846233407667052, 'loss_val': 0.2554566055472425, 'psi': 0.8132292065419113}-{'f1_val': 0.6994076265853314, 'auprc': 0.937811847599082, 'loss_val': 0.2824214897211301, 'psi': 0.7947693149908317}
[S3] START round=10 head_norm_before_train=1.536034 (no previous merge yet)
[S3] round=10 local utility u=0.357889 metrics={'f1_val': 0.7000850230591003, 'auprc': 0.9988586583852579, 'loss_val': 0.40021539047987426, 'psi': 0.8195944771895634}-{'f1_val': 0.6007004521553635, 'auprc': 0.9990332801202167, 'loss_val': 0.5202099511923757, 'psi': 0.7600335833413048}
[S4] START round=10 head_norm_before_train=1.671443 (no previous merge yet)
[S4] round=10 local utility u=0.005701 metrics={'f1_val': 0.6133053062657189, 'auprc': 0.9432668552735466, 'loss_val': 0.5072703139153196, 'psi': 0.74528992586885}-{'f1_val': 0.6142330342132605, 'auprc': 0.9301516475107122, 'loss_val': 0.4848940231920302, 'psi': 0.7406004795322412}
[S5] START round=10 head_norm_before_train=1.066368 cos_to_last_merge=0.9241 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.924
[S5] round=10 local utility u=0.037233 metrics={'f1_val': 0.4183544144322735, 'auprc': 0.8018512695607811, 'loss_val': 0.8281601871780153, 'psi': 0.5717531564836765}-{'f1_val': 0.4176671856330787, 'auprc': 0.8020311328243026, 'loss_val': 0.89904147500051, 'psi': 0.5714127645095683}
[S6] START round=10 head_norm_before_train=1.636881 (no previous merge yet)
[S6] round=10 local utility u=1.000000 metrics={'f1_val': 0.9404878082999915, 'auprc': 0.9619193629660507, 'loss_val': 0.23537412965785795, 'psi': 0.9490604301664152}-{'f1_val': 0.6305766167155283, 'auprc': 0.8002066111847848, 'loss_val': 0.4931219422142157, 'psi': 0.6984286145032309}
[S7] START round=10 head_norm_before_train=1.360938 cos_to_last_merge=1.0000 (last merge round=9)
[S7] round=10 local utility u=0.000000 metrics={'f1_val': 0.6732480136948099, 'auprc': 0.7773485024037314, 'loss_val': 0.9568419987858474, 'psi': 0.7148882091783786}-{'f1_val': 0.714398832901065, 'auprc': 0.7776099633242066, 'loss_val': 1.0995784759186409, 'psi': 0.7396832850703217}
[S8] START round=10 head_norm_before_train=1.279366 cos_to_last_merge=1.0000 (last merge round=9)
[S8] round=10 local utility u=0.003928 metrics={'f1_val': 0.9941380936044745, 'auprc': 0.998293718745497, 'loss_val': 0.21654865848667285, 'psi': 0.9958003436608835}-{'f1_val': 0.9934042750107773, 'auprc': 0.994450777925611, 'loss_val': 0.20847272814763645, 'psi': 0.9938228761767107}
[S9] START round=10 head_norm_before_train=1.066979 cos_to_last_merge=0.9853 (last merge round=7)
[S9] round=10 local utility u=0.886849 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.993180288854121, 'loss_val': 0.44222992156127694, 'psi': 0.8180020640056596}-{'f1_val': 0.4366748822799233, 'auprc': 0.9894066504435157, 'loss_val': 0.6173563636238482, 'psi': 0.6577675895453603}
[S10] START round=10 head_norm_before_train=1.652940 (no previous merge yet)
[S10] round=10 local utility u=0.000000 metrics={'f1_val': 0.9337647774449285, 'auprc': 0.9943093697700812, 'loss_val': 0.22037429376492484, 'psi': 0.9579826143749897}-{'f1_val': 0.9907184940410634, 'auprc': 0.9956626184123936, 'loss_val': 0.15839178799313405, 'psi': 0.9926961437895954}
[S11] START round=10 head_norm_before_train=1.501121 (no previous merge yet)
[S11] round=10 local utility u=0.038933 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.997065291647571, 'loss_val': 0.36807209347868824, 'psi': 0.8198422044111833}-{'f1_val': 0.7020664967782734, 'auprc': 0.9983472404732591, 'loss_val': 0.4520215975454352, 'psi': 0.8205787942562677}
[S13] START round=10 head_norm_before_train=1.588915 (no previous merge yet)
[S13] round=10 local utility u=0.000000 metrics={'f1_val': 0.6738146345748961, 'auprc': 0.783121188946799, 'loss_val': 0.4437725731628696, 'psi': 0.7175372563236573}-{'f1_val': 0.6880553722782647, 'auprc': 0.7757312627390681, 'loss_val': 0.4150164828297958, 'psi': 0.723125728462586}
[S14] START round=10 head_norm_before_train=1.611983 (no previous merge yet)
[S14] round=10 local utility u=0.720431 metrics={'f1_val': 0.9315000589031757, 'auprc': 0.9947764172144496, 'loss_val': 0.30555799285701435, 'psi': 0.9568106022276852}-{'f1_val': 0.7010953924152618, 'auprc': 0.9975265591926312, 'loss_val': 0.3722418988204648, 'psi': 0.8196678591262097}
[S15] START round=10 head_norm_before_train=1.106094 cos_to_last_merge=1.0000 (last merge round=9)
[S15] round=10 local utility u=0.999218 metrics={'f1_val': 0.9804331218170251, 'auprc': 0.9703200562655406, 'loss_val': 0.3099839258786248, 'psi': 0.9763878955964314}-{'f1_val': 0.6939922527607938, 'auprc': 0.9166795172962846, 'loss_val': 0.42885250712595735, 'psi': 0.7830671585749902}
[S16] START round=10 head_norm_before_train=1.442155 (no previous merge yet)
[S16] round=10 local utility u=0.000000 metrics={'f1_val': 0.38469205371725196, 'auprc': 0.7424257453154923, 'loss_val': 0.8025346501301378, 'psi': 0.5277855303565482}-{'f1_val': 0.4369640837117893, 'auprc': 0.7425970180939403, 'loss_val': 0.8850659443746404, 'psi': 0.5592172574646497}
[S17] START round=10 head_norm_before_train=0.819259 cos_to_last_merge=1.0000 (last merge round=9)
[S17] round=10 local utility u=0.000000 metrics={'f1_val': 0.3892306890803001, 'auprc': 0.8443762451142703, 'loss_val': 0.7205321883167147, 'psi': 0.5712889114938882}-{'f1_val': 0.38918006077257744, 'auprc': 0.8522376114563694, 'loss_val': 0.7289285874537503, 'psi': 0.5744030810460943}
[S11] not sending this round → trigger blocked (psi=0.820)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.996)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:52809
[S5] not sending this round → trigger blocked (psi=0.572)
[S14] not sending this round → trigger blocked (psi=0.957)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:52809
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:52810
[S3] not sending this round → trigger blocked (psi=0.820)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:52817
[S9] not sending this round → trigger blocked (psi=0.818)
[S6] sending update (kind=head size=1805 to 1 peers)
[S15] sending update (kind=head size=1794 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1804 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1805) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.669974)
[S17] loaded HEAD from S6 (vec_in norm=1.669974)
[S17] cosine check vs S6: cos=0.1010
[S17] BUFFERED delta from S6 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1794) from S15
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.175952)
[S9] loaded HEAD from S15 (vec_in norm=1.175952)
[S9] cosine check vs S15: cos=0.7628
[S9] BUFFERED delta from S15 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1804) from S2
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.676433)
[S8] loaded HEAD from S2 (vec_in norm=1.676433)
[S8] cosine check vs S2: cos=0.1333
[S8] BUFFERED delta from S2 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1801) from S4
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.698802)
[S8] loaded HEAD from S4 (vec_in norm=1.698802)
[S8] cosine check vs S4: cos=0.2770
[S8] BUFFERED delta from S4 (total buffered=2)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] ⇄ pheromone p=0.441 → S14@127.0.0.1:52814
[S13] ⇄ pheromone p=0.316 → S7@127.0.0.1:52808
[S11] ⇄ pheromone p=0.370 → S8@127.0.0.1:52809
[S14] ⇄ pheromone p=0.531 → S8@127.0.0.1:52809
[S5] ⇄ pheromone p=0.235 → S11@127.0.0.1:52812
[S3] ⇄ pheromone p=0.434 → S11@127.0.0.1:52812
[S7] ⇄ pheromone p=0.375 → S17@127.0.0.1:52817
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=10 metric=0.9941 head_norm=1.336997
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.353326e-01
[S8] stored merged vector for next round verification (round=10)
[S8] DEBUG after merge:  round=10 metric=0.9945 head_norm=1.002356 delta_norm=0.735333
[S8] aggregate: ACCEPT kept=['S2', 'S4'] (k=2/2) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.325 → S15@127.0.0.1:52815
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=10 metric=0.7012 head_norm=1.124692
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.968950e-01
[S9] stored merged vector for next round verification (round=10)
[S9] DEBUG after merge:  round=10 metric=0.7012 head_norm=1.079987 delta_norm=0.396895
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.478 → S17@127.0.0.1:52817
[S6] ⇄ pheromone p=0.487 → S17@127.0.0.1:52817
[S4] ⇄ pheromone p=0.196 → S8@127.0.0.1:52809
[S2] ⇄ pheromone p=0.276 → S8@127.0.0.1:52809
[S15] ⇄ pheromone p=0.472 → S9@127.0.0.1:52810
[S16] ⇄ pheromone p=0.253 → S7@127.0.0.1:52808
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=10 metric=0.3892 head_norm=0.890963
[S17] _apply_head_vector_avg (torch): Δ‖w‖=9.058087e-01
[S17] stored merged vector for next round verification (round=10)
[S17] DEBUG after merge:  round=10 metric=0.3893 head_norm=0.985304 delta_norm=0.905809
[S17] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.194 → S13@127.0.0.1:52813
[S2] START round=11 head_norm_before_train=1.676433 (no previous merge yet)
[S2] round=11 local utility u=0.000000 metrics={'f1_val': 0.6998688180552864, 'auprc': 0.86421618702372, 'loss_val': 0.24349033338084372, 'psi': 0.7656077656426599}-{'f1_val': 0.6989664503920486, 'auprc': 0.9846233407667052, 'loss_val': 0.2554566055472425, 'psi': 0.8132292065419113}
[S3] START round=11 head_norm_before_train=1.586379 (no previous merge yet)
[S3] round=11 local utility u=0.000000 metrics={'f1_val': 0.6927498788157274, 'auprc': 0.99416738628581, 'loss_val': 0.35001559209675437, 'psi': 0.8133168818037604}-{'f1_val': 0.7000850230591003, 'auprc': 0.9988586583852579, 'loss_val': 0.40021539047987426, 'psi': 0.8195944771895634}
[S4] START round=11 head_norm_before_train=1.698802 (no previous merge yet)
[S4] round=11 local utility u=0.018225 metrics={'f1_val': 0.6114573771218618, 'auprc': 0.958099113330218, 'loss_val': 0.5042286764812015, 'psi': 0.7501140716052043}-{'f1_val': 0.6133053062657189, 'auprc': 0.9432668552735466, 'loss_val': 0.5072703139153196, 'psi': 0.74528992586885}
[S5] START round=11 head_norm_before_train=1.106148 cos_to_last_merge=0.9063 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.906
[S5] round=11 local utility u=0.217017 metrics={'f1_val': 0.422176667418166, 'auprc': 0.8952792475572144, 'loss_val': 0.6973436462952781, 'psi': 0.6114176994737854}-{'f1_val': 0.4183544144322735, 'auprc': 0.8018512695607811, 'loss_val': 0.8281601871780153, 'psi': 0.5717531564836765}
[S6] START round=11 head_norm_before_train=1.669974 (no previous merge yet)
[S6] round=11 local utility u=0.000000 metrics={'f1_val': 0.5964511635159228, 'auprc': 0.787591127093625, 'loss_val': 0.7842575393625463, 'psi': 0.6729071489470037}-{'f1_val': 0.9404878082999915, 'auprc': 0.9619193629660507, 'loss_val': 0.23537412965785795, 'psi': 0.9490604301664152}
[S7] START round=11 head_norm_before_train=1.376305 cos_to_last_merge=0.9993 (last merge round=9)
[S7] round=11 local utility u=0.199181 metrics={'f1_val': 0.714792420046008, 'auprc': 0.7940210804530997, 'loss_val': 0.8577640507975676, 'psi': 0.7464838842088446}-{'f1_val': 0.6732480136948099, 'auprc': 0.7773485024037314, 'loss_val': 0.9568419987858474, 'psi': 0.7148882091783786}
[S8] START round=11 head_norm_before_train=1.002356 cos_to_last_merge=1.0000 (last merge round=10)
[S8] round=11 local utility u=0.000000 metrics={'f1_val': 0.993235056744646, 'auprc': 0.9961777791186337, 'loss_val': 0.2497796413496246, 'psi': 0.9944121456942411}-{'f1_val': 0.9941380936044745, 'auprc': 0.998293718745497, 'loss_val': 0.21654865848667285, 'psi': 0.9958003436608835}
[S9] START round=11 head_norm_before_train=1.079987 cos_to_last_merge=1.0000 (last merge round=10)
[S9] round=11 local utility u=0.039038 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9982787207013535, 'loss_val': 0.37944966860023, 'psi': 0.8200414367445525}-{'f1_val': 0.7012165807733519, 'auprc': 0.993180288854121, 'loss_val': 0.44222992156127694, 'psi': 0.8180020640056596}
[S10] START round=11 head_norm_before_train=1.678775 (no previous merge yet)
[S10] round=11 local utility u=0.241147 metrics={'f1_val': 0.9957455607450773, 'auprc': 0.9966312527154236, 'loss_val': 0.11693084847468718, 'psi': 0.9960998375332157}-{'f1_val': 0.9337647774449285, 'auprc': 0.9943093697700812, 'loss_val': 0.22037429376492484, 'psi': 0.9579826143749897}
[S11] START round=11 head_norm_before_train=1.537552 (no previous merge yet)
[S11] round=11 local utility u=0.000000 metrics={'f1_val': 0.6617879294500675, 'auprc': 0.9980771257328048, 'loss_val': 0.37045630053409145, 'psi': 0.7963036079631625}-{'f1_val': 0.7016934795869249, 'auprc': 0.997065291647571, 'loss_val': 0.36807209347868824, 'psi': 0.8198422044111833}
[S13] START round=11 head_norm_before_train=1.619466 (no previous merge yet)
[S13] round=11 local utility u=0.000000 metrics={'f1_val': 0.6171585747690631, 'auprc': 0.8064697179084943, 'loss_val': 0.6011414128903639, 'psi': 0.6928830320248356}-{'f1_val': 0.6738146345748961, 'auprc': 0.783121188946799, 'loss_val': 0.4437725731628696, 'psi': 0.7175372563236573}
[S14] START round=11 head_norm_before_train=1.665535 (no previous merge yet)
[S14] round=11 local utility u=0.225216 metrics={'f1_val': 0.9976936557389067, 'auprc': 0.9961018134075756, 'loss_val': 0.25626398312992504, 'psi': 0.9970569188063743}-{'f1_val': 0.9315000589031757, 'auprc': 0.9947764172144496, 'loss_val': 0.30555799285701435, 'psi': 0.9568106022276852}
[S15] START round=11 head_norm_before_train=1.175952 cos_to_last_merge=0.9944 (last merge round=9)
[S15] round=11 local utility u=0.027450 metrics={'f1_val': 0.972145738328588, 'auprc': 0.9729510198254036, 'loss_val': 0.2132518296532574, 'psi': 0.9724678509273141}-{'f1_val': 0.9804331218170251, 'auprc': 0.9703200562655406, 'loss_val': 0.3099839258786248, 'psi': 0.9763878955964314}
[S16] START round=11 head_norm_before_train=1.468590 (no previous merge yet)
[S16] round=11 local utility u=0.158289 metrics={'f1_val': 0.43239697294008916, 'auprc': 0.7508455160462373, 'loss_val': 0.7974446158490667, 'psi': 0.5597763901825484}-{'f1_val': 0.38469205371725196, 'auprc': 0.7424257453154923, 'loss_val': 0.8025346501301378, 'psi': 0.5277855303565482}
[S17] START round=11 head_norm_before_train=0.985304 cos_to_last_merge=1.0000 (last merge round=10)
[S17] round=11 local utility u=0.042109 metrics={'f1_val': 0.3893205539653627, 'auprc': 0.8844458135930744, 'loss_val': 0.757062026427574, 'psi': 0.5873706578164474}-{'f1_val': 0.3892306890803001, 'auprc': 0.8443762451142703, 'loss_val': 0.7205321883167147, 'psi': 0.5712889114938882}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:52810
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:52808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:52812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:52809
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:52809
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:52817
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:52814
[S14] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1805 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1802) from S7
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.396612)
[S17] loaded HEAD from S7 (vec_in norm=1.396612)
[S17] cosine check vs S7: cos=0.2021
[S17] BUFFERED delta from S7 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1797) from S15
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.247015)
[S9] loaded HEAD from S15 (vec_in norm=1.247015)
[S9] cosine check vs S15: cos=0.9341
[S9] BUFFERED delta from S15 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1802) from S5
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.148900)
[S11] loaded HEAD from S5 (vec_in norm=1.148900)
[S11] cosine check vs S5: cos=-0.0913
[S11] DROPPED delta from S5 (cos=-0.0913 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1801) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.713628)
[S14] loaded HEAD from S10 (vec_in norm=1.713628)
[S14] cosine check vs S10: cos=-0.0267
[S14] DROPPED delta from S10 (cos=-0.0267 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1803) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.502801)
[S7] loaded HEAD from S16 (vec_in norm=1.502801)
[S7] cosine check vs S16: cos=0.9873
[S7] BUFFERED delta from S16 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1805) from S4
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.723671)
[S8] loaded HEAD from S4 (vec_in norm=1.723671)
[S8] cosine check vs S4: cos=0.5773
[S8] BUFFERED delta from S4 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1800) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.705564)
[S8] loaded HEAD from S14 (vec_in norm=1.705564)
[S8] cosine check vs S14: cos=0.6421
[S8] BUFFERED delta from S14 (total buffered=2)
[S17] RECEIVED delta(kind=head bytes=1796) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.132757)
[S17] loaded HEAD from S9 (vec_in norm=1.132757)
[S17] cosine check vs S9: cos=0.3452
[S17] BUFFERED delta from S9 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:52813
[S17] sending update (kind=head size=1799 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1799) from S17
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.035739)
[S13] loaded HEAD from S17 (vec_in norm=1.035739)
[S13] cosine check vs S17: cos=0.0509
[S13] BUFFERED delta from S17 (total buffered=1)
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=11 metric=0.9932 head_norm=1.086329
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.261813e-01
[S8] stored merged vector for next round verification (round=11)
[S8] DEBUG after merge:  round=11 metric=0.9932 head_norm=1.114319 delta_norm=0.326181
[S8] aggregate: ACCEPT kept=['S4', 'S14'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=11 metric=0.6172 head_norm=1.638754
[S13] _apply_head_vector_avg (torch): Δ‖w‖=9.467641e-01
[S13] stored merged vector for next round verification (round=11)
[S13] DEBUG after merge:  round=11 metric=0.6164 head_norm=0.991349 delta_norm=0.946764
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=11 metric=0.7012 head_norm=1.132757
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.231185e-01
[S9] stored merged vector for next round verification (round=11)
[S9] DEBUG after merge:  round=11 metric=0.7012 head_norm=1.170175 delta_norm=0.223118
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=11 metric=0.7148 head_norm=1.396612
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.270759e-01
[S7] stored merged vector for next round verification (round=11)
[S7] DEBUG after merge:  round=11 metric=0.7148 head_norm=1.445102 delta_norm=0.127076
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=11 metric=0.3893 head_norm=1.035739
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.724485e-01
[S17] stored merged vector for next round verification (round=11)
[S17] DEBUG after merge:  round=11 metric=0.3893 head_norm=0.822422 delta_norm=0.572448
[S17] aggregate: ACCEPT kept=['S7', 'S9'] (k=2/2) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.707716 (no previous merge yet)
[S2] round=12 local utility u=0.000000 metrics={'f1_val': 0.7001718904594149, 'auprc': 0.8268148621652848, 'loss_val': 0.24218669041066923, 'psi': 0.7508290791417629}-{'f1_val': 0.6998688180552864, 'auprc': 0.86421618702372, 'loss_val': 0.24349033338084372, 'psi': 0.7656077656426599}
[S3] START round=12 head_norm_before_train=1.631371 (no previous merge yet)
[S3] round=12 local utility u=0.019090 metrics={'f1_val': 0.6930047378052776, 'auprc': 0.9929355452477159, 'loss_val': 0.3096693940437313, 'psi': 0.8129770607822528}-{'f1_val': 0.6927498788157274, 'auprc': 0.99416738628581, 'loss_val': 0.35001559209675437, 'psi': 0.8133168818037604}
[S4] START round=12 head_norm_before_train=1.723671 (no previous merge yet)
[S4] round=12 local utility u=0.186178 metrics={'f1_val': 0.6663620223836746, 'auprc': 0.9599240202477083, 'loss_val': 0.46677525312554763, 'psi': 0.783786821529288}-{'f1_val': 0.6114573771218618, 'auprc': 0.958099113330218, 'loss_val': 0.5042286764812015, 'psi': 0.7501140716052043}
[S5] START round=12 head_norm_before_train=1.148900 cos_to_last_merge=0.8892 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.889
[S5] round=12 local utility u=0.663824 metrics={'f1_val': 0.6411442155614199, 'auprc': 0.8779811625227445, 'loss_val': 0.6316067265061557, 'psi': 0.7358789943459498}-{'f1_val': 0.422176667418166, 'auprc': 0.8952792475572144, 'loss_val': 0.6973436462952781, 'psi': 0.6114176994737854}
[S6] START round=12 head_norm_before_train=1.696449 (no previous merge yet)
[S6] round=12 local utility u=0.162114 metrics={'f1_val': 0.6463486425200203, 'auprc': 0.7840559497217734, 'loss_val': 0.7488083229551807, 'psi': 0.7014315654007216}-{'f1_val': 0.5964511635159228, 'auprc': 0.787591127093625, 'loss_val': 0.7842575393625463, 'psi': 0.6729071489470037}
[S7] START round=12 head_norm_before_train=1.445102 cos_to_last_merge=1.0000 (last merge round=11)
[S7] round=12 local utility u=0.012130 metrics={'f1_val': 0.7002885421842977, 'auprc': 0.7969798983620441, 'loss_val': 0.7553572797024697, 'psi': 0.7389650846553962}-{'f1_val': 0.714792420046008, 'auprc': 0.7940210804530997, 'loss_val': 0.8577640507975676, 'psi': 0.7464838842088446}
[S8] START round=12 head_norm_before_train=1.114319 cos_to_last_merge=1.0000 (last merge round=11)
[S8] round=12 local utility u=0.045807 metrics={'f1_val': 0.9943590272655265, 'auprc': 0.9976099115353272, 'loss_val': 0.1692056342463868, 'psi': 0.9956593809734469}-{'f1_val': 0.993235056744646, 'auprc': 0.9961777791186337, 'loss_val': 0.2497796413496246, 'psi': 0.9944121456942411}
[S9] START round=12 head_norm_before_train=1.170175 cos_to_last_merge=1.0000 (last merge round=11)
[S9] round=12 local utility u=0.407522 metrics={'f1_val': 0.8275758595769748, 'auprc': 0.998905797722686, 'loss_val': 0.3244416913193714, 'psi': 0.8961078348352592}-{'f1_val': 0.7012165807733519, 'auprc': 0.9982787207013535, 'loss_val': 0.37944966860023, 'psi': 0.8200414367445525}
[S10] START round=12 head_norm_before_train=1.713628 (no previous merge yet)
[S10] round=12 local utility u=0.011757 metrics={'f1_val': 0.9941284342670456, 'auprc': 0.9968490964885135, 'loss_val': 0.08436828881156283, 'psi': 0.9952166991556327}-{'f1_val': 0.9957455607450773, 'auprc': 0.9966312527154236, 'loss_val': 0.11693084847468718, 'psi': 0.9960998375332157}
[S11] START round=12 head_norm_before_train=1.573310 (no previous merge yet)
[S11] round=12 local utility u=0.176053 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9973319861715184, 'loss_val': 0.25554865493819806, 'psi': 0.8199488822207623}-{'f1_val': 0.6617879294500675, 'auprc': 0.9980771257328048, 'loss_val': 0.37045630053409145, 'psi': 0.7963036079631625}
[S13] START round=12 head_norm_before_train=0.991349 cos_to_last_merge=1.0000 (last merge round=11)
[S13] round=12 local utility u=0.059907 metrics={'f1_val': 0.655905499928592, 'auprc': 0.7497323500094669, 'loss_val': 0.5435971199440928, 'psi': 0.693436239960942}-{'f1_val': 0.6171585747690631, 'auprc': 0.8064697179084943, 'loss_val': 0.6011414128903639, 'psi': 0.6928830320248356}
[S14] START round=12 head_norm_before_train=1.705564 (no previous merge yet)
[S14] round=12 local utility u=0.034548 metrics={'f1_val': 0.9987633044505082, 'auprc': 0.9975376988704472, 'loss_val': 0.19789405797485582, 'psi': 0.9982730622184839}-{'f1_val': 0.9976936557389067, 'auprc': 0.9961018134075756, 'loss_val': 0.25626398312992504, 'psi': 0.9970569188063743}
[S15] START round=12 head_norm_before_train=1.247015 cos_to_last_merge=0.9832 (last merge round=9)
[S15] round=12 local utility u=0.000000 metrics={'f1_val': 0.6832550302360693, 'auprc': 0.6520429286340725, 'loss_val': 0.5622108875676758, 'psi': 0.6707701895952706}-{'f1_val': 0.972145738328588, 'auprc': 0.9729510198254036, 'loss_val': 0.2132518296532574, 'psi': 0.9724678509273141}
[S16] START round=12 head_norm_before_train=1.502801 (no previous merge yet)
[S16] round=12 local utility u=0.076534 metrics={'f1_val': 0.45681683707610043, 'auprc': 0.7545526458291356, 'loss_val': 0.8020165067451129, 'psi': 0.5759111605773146}-{'f1_val': 0.43239697294008916, 'auprc': 0.7508455160462373, 'loss_val': 0.7974446158490667, 'psi': 0.5597763901825484}
[S17] START round=12 head_norm_before_train=0.822422 cos_to_last_merge=1.0000 (last merge round=11)
[S17] round=12 local utility u=0.121113 metrics={'f1_val': 0.3892499701636696, 'auprc': 0.9527345963985273, 'loss_val': 0.7192795733128581, 'psi': 0.6146438206576127}-{'f1_val': 0.3893205539653627, 'auprc': 0.8844458135930744, 'loss_val': 0.757062026427574, 'psi': 0.5873706578164474}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S11] → sending delta(kind=head bytes=1806) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S6] → sending delta(kind=head bytes=1807) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S10] → sending delta(kind=head bytes=1806) to S14@127.0.0.1:52814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:52812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:52809
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:52812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:52815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:52808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:52808
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1807 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1806 to 1 peers)
[S11] sending update (kind=head size=1806 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1803) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.743494)
[S8] loaded HEAD from S14 (vec_in norm=1.743494)
[S8] cosine check vs S14: cos=0.6890
[S8] BUFFERED delta from S14 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1798) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.218173)
[S17] loaded HEAD from S9 (vec_in norm=1.218173)
[S17] cosine check vs S9: cos=0.5787
[S17] BUFFERED delta from S9 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1796) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.542225)
[S7] loaded HEAD from S16 (vec_in norm=1.542225)
[S7] cosine check vs S16: cos=0.9930
[S7] BUFFERED delta from S16 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1798) from S13
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.065974)
[S7] loaded HEAD from S13 (vec_in norm=1.065974)
[S7] cosine check vs S13: cos=0.0269
[S7] BUFFERED delta from S13 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1801) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.210494)
[S15] loaded HEAD from S8 (vec_in norm=1.210494)
[S15] cosine check vs S8: cos=0.8218
[S15] BUFFERED delta from S8 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1798) from S7
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.466438)
[S17] loaded HEAD from S7 (vec_in norm=1.466438)
[S17] cosine check vs S7: cos=0.5723
[S17] BUFFERED delta from S7 (total buffered=2)
[S11] RECEIVED delta(kind=head bytes=1799) from S3
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.673059)
[S11] loaded HEAD from S3 (vec_in norm=1.673059)
[S11] cosine check vs S3: cos=-0.0437
[S11] DROPPED delta from S3 (cos=-0.0437 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1806) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.751775)
[S14] loaded HEAD from S10 (vec_in norm=1.751775)
[S14] cosine check vs S10: cos=-0.0311
[S14] DROPPED delta from S10 (cos=-0.0311 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1806) from S11
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.611163)
[S8] loaded HEAD from S11 (vec_in norm=1.611163)
[S8] cosine check vs S11: cos=-0.0472
[S8] DROPPED delta from S11 (cos=-0.0472 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1807) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.722118)
[S17] loaded HEAD from S6 (vec_in norm=1.722118)
[S17] cosine check vs S6: cos=0.4503
[S17] BUFFERED delta from S6 (total buffered=3)
[S8] RECEIVED delta(kind=head bytes=1804) from S4
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.750481)
[S8] loaded HEAD from S4 (vec_in norm=1.750481)
[S8] cosine check vs S4: cos=0.6739
[S8] BUFFERED delta from S4 (total buffered=2)
[S11] RECEIVED delta(kind=head bytes=1801) from S5
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.190584)
[S11] loaded HEAD from S5 (vec_in norm=1.190584)
[S11] cosine check vs S5: cos=-0.0862
[S11] DROPPED delta from S5 (cos=-0.0862 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:52813
[S17] sending update (kind=head size=1796 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1796) from S17
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.893224)
[S13] loaded HEAD from S17 (vec_in norm=0.893224)
[S13] cosine check vs S17: cos=0.3934
[S13] BUFFERED delta from S17 (total buffered=1)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=12 metric=0.6559 head_norm=1.065974
[S13] _apply_head_vector_avg (torch): Δ‖w‖=5.442698e-01
[S13] stored merged vector for next round verification (round=12)
[S13] DEBUG after merge:  round=12 metric=0.6458 head_norm=0.819052 delta_norm=0.544270
[S13] aggregate: ROLLBACK (f1_val pre=0.656 post=0.646 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=12 metric=0.9944 head_norm=1.210494
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.978971e-01
[S8] stored merged vector for next round verification (round=12)
[S8] DEBUG after merge:  round=12 metric=0.9944 head_norm=1.216640 delta_norm=0.197897
[S8] aggregate: ACCEPT kept=['S14', 'S4'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=12 metric=0.7003 head_norm=1.466438
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.368506e-01
[S7] stored merged vector for next round verification (round=12)
[S7] DEBUG after merge:  round=12 metric=0.6996 head_norm=1.155307 delta_norm=0.436851
[S7] aggregate: ACCEPT kept=['S16', 'S13'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=12 metric=0.6833 head_norm=1.306381
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.784302e-01
[S15] stored merged vector for next round verification (round=12)
[S15] DEBUG after merge:  round=12 metric=0.6900 head_norm=1.201147 delta_norm=0.378430
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=12 metric=0.3892 head_norm=0.893224
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.874052e-01
[S17] stored merged vector for next round verification (round=12)
[S17] DEBUG after merge:  round=12 metric=0.3892 head_norm=0.846994 delta_norm=0.187405
[S17] aggregate: ACCEPT kept=['S9', 'S7', 'S6'] (k=3/3) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.736686 (no previous merge yet)
[S2] round=13 local utility u=0.019045 metrics={'f1_val': 0.7026413189059436, 'auprc': 0.8354812055308464, 'loss_val': 0.24491200097644733, 'psi': 0.7557772735559047}-{'f1_val': 0.7001718904594149, 'auprc': 0.8268148621652848, 'loss_val': 0.24218669041066923, 'psi': 0.7508290791417629}
[S3] START round=13 head_norm_before_train=1.673059 (no previous merge yet)
[S3] round=13 local utility u=0.060744 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.9952782929216436, 'loss_val': 0.24217096081360684, 'psi': 0.8186103581839439}-{'f1_val': 0.6930047378052776, 'auprc': 0.9929355452477159, 'loss_val': 0.3096693940437313, 'psi': 0.8129770607822528}
[S4] START round=13 head_norm_before_train=1.750481 (no previous merge yet)
[S4] round=13 local utility u=0.909208 metrics={'f1_val': 0.9537988864934196, 'auprc': 0.9570625012152585, 'loss_val': 0.364396158197578, 'psi': 0.9551043323821551}-{'f1_val': 0.6663620223836746, 'auprc': 0.9599240202477083, 'loss_val': 0.46677525312554763, 'psi': 0.783786821529288}
[S5] START round=13 head_norm_before_train=1.190584 cos_to_last_merge=0.8722 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.872
[S5] round=13 local utility u=0.180607 metrics={'f1_val': 0.7008168588441903, 'auprc': 0.860520224405637, 'loss_val': 0.5760456178500153, 'psi': 0.764698205068769}-{'f1_val': 0.6411442155614199, 'auprc': 0.8779811625227445, 'loss_val': 0.6316067265061557, 'psi': 0.7358789943459498}
[S6] START round=13 head_norm_before_train=1.722118 (no previous merge yet)
[S6] round=13 local utility u=0.914952 metrics={'f1_val': 0.8026797815113306, 'auprc': 0.9436069620839568, 'loss_val': 0.33554437119397224, 'psi': 0.859050653740381}-{'f1_val': 0.6463486425200203, 'auprc': 0.7840559497217734, 'loss_val': 0.7488083229551807, 'psi': 0.7014315654007216}
[S7] START round=13 head_norm_before_train=1.155307 cos_to_last_merge=1.0000 (last merge round=12)
[S7] round=13 local utility u=0.143613 metrics={'f1_val': 0.7141649928364396, 'auprc': 0.8612403899710828, 'loss_val': 0.7441716027800966, 'psi': 0.7729951516902969}-{'f1_val': 0.7002885421842977, 'auprc': 0.7969798983620441, 'loss_val': 0.7553572797024697, 'psi': 0.7389650846553962}
[S8] START round=13 head_norm_before_train=1.216640 cos_to_last_merge=1.0000 (last merge round=12)
[S8] round=13 local utility u=0.000000 metrics={'f1_val': 0.993235056744646, 'auprc': 0.9898039447290301, 'loss_val': 0.14673904086175327, 'psi': 0.9918626119383996}-{'f1_val': 0.9943590272655265, 'auprc': 0.9976099115353272, 'loss_val': 0.1692056342463868, 'psi': 0.9956593809734469}
[S9] START round=13 head_norm_before_train=1.218173 cos_to_last_merge=0.9978 (last merge round=11)
[S9] round=13 local utility u=0.518534 metrics={'f1_val': 0.9878214512971564, 'auprc': 0.9992655634083281, 'loss_val': 0.249926185449819, 'psi': 0.992399096141625}-{'f1_val': 0.8275758595769748, 'auprc': 0.998905797722686, 'loss_val': 0.3244416913193714, 'psi': 0.8961078348352592}
[S10] START round=13 head_norm_before_train=1.751775 (no previous merge yet)
[S10] round=13 local utility u=0.013509 metrics={'f1_val': 0.9955259082574451, 'auprc': 0.9945275038099903, 'loss_val': 0.058770423843768155, 'psi': 0.9951265464784632}-{'f1_val': 0.9941284342670456, 'auprc': 0.9968490964885135, 'loss_val': 0.08436828881156283, 'psi': 0.9952166991556327}
[S11] START round=13 head_norm_before_train=1.611163 (no previous merge yet)
[S11] round=13 local utility u=0.023513 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.997521814967828, 'loss_val': 0.2090921057588258, 'psi': 0.820024813739286}-{'f1_val': 0.7016934795869249, 'auprc': 0.9973319861715184, 'loss_val': 0.25554865493819806, 'psi': 0.8199488822207623}
[S13] START round=13 head_norm_before_train=0.819052 cos_to_last_merge=1.0000 (last merge round=12)
[S13] round=13 local utility u=0.000000 metrics={'f1_val': 0.6025022882921485, 'auprc': 0.6997883186583184, 'loss_val': 0.7065223250973072, 'psi': 0.6414167004386164}-{'f1_val': 0.655905499928592, 'auprc': 0.7497323500094669, 'loss_val': 0.5435971199440928, 'psi': 0.693436239960942}
[S14] START round=13 head_norm_before_train=1.743494 (no previous merge yet)
[S14] round=13 local utility u=0.023334 metrics={'f1_val': 0.9976760408229349, 'auprc': 0.9975331476147942, 'loss_val': 0.14468958711903618, 'psi': 0.9976188835396786}-{'f1_val': 0.9987633044505082, 'auprc': 0.9975376988704472, 'loss_val': 0.19789405797485582, 'psi': 0.9982730622184839}
[S15] START round=13 head_norm_before_train=1.201147 cos_to_last_merge=1.0000 (last merge round=12)
[S15] round=13 local utility u=1.000000 metrics={'f1_val': 0.9828126542212958, 'auprc': 0.9699241133747005, 'loss_val': 0.2507292056541806, 'psi': 0.9776572378826577}-{'f1_val': 0.6832550302360693, 'auprc': 0.6520429286340725, 'loss_val': 0.5622108875676758, 'psi': 0.6707701895952706}
[S16] START round=13 head_norm_before_train=1.542225 (no previous merge yet)
[S16] round=13 local utility u=0.324098 metrics={'f1_val': 0.552714221482658, 'auprc': 0.7776322771412945, 'loss_val': 0.7984428666839486, 'psi': 0.6426814437461126}-{'f1_val': 0.45681683707610043, 'auprc': 0.7545526458291356, 'loss_val': 0.8020165067451129, 'psi': 0.5759111605773146}
[S17] START round=13 head_norm_before_train=0.846994 cos_to_last_merge=1.0000 (last merge round=12)
[S17] round=13 local utility u=0.000000 metrics={'f1_val': 0.3938402591449141, 'auprc': 0.8835357193298492, 'loss_val': 0.715986441179491, 'psi': 0.5897184432188882}-{'f1_val': 0.3892499701636696, 'auprc': 0.9527345963985273, 'loss_val': 0.7192795733128581, 'psi': 0.6146438206576127}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:52810
[S7] not sending this round → trigger blocked (psi=0.773)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:52809
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.643)
[S3] not sending this round → trigger blocked (psi=0.819)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.859)
[S4] not sending this round → trigger blocked (psi=0.955)
[S10] not sending this round → trigger blocked (psi=0.995)
[S5] not sending this round → trigger blocked (psi=0.765)
[S14] not sending this round → trigger blocked (psi=0.998)
[S11] not sending this round → trigger blocked (psi=0.820)
[S9] not sending this round → trigger blocked (psi=0.992)
[S2] sending update (kind=head size=1805 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1800) from S15
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.250922)
[S9] loaded HEAD from S15 (vec_in norm=1.250922)
[S9] cosine check vs S15: cos=0.9284
[S9] BUFFERED delta from S15 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1805) from S2
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.760295)
[S8] loaded HEAD from S2 (vec_in norm=1.760295)
[S8] cosine check vs S2: cos=0.0789
[S8] BUFFERED delta from S2 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=13 metric=0.9932 head_norm=1.298020
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.051551e+00
[S8] stored merged vector for next round verification (round=13)
[S8] DEBUG after merge:  round=13 metric=0.9935 head_norm=1.134014 delta_norm=1.051551
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=13 metric=0.9878 head_norm=1.263973
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.380002e-01
[S9] stored merged vector for next round verification (round=13)
[S9] DEBUG after merge:  round=13 metric=0.9874 head_norm=1.234736 delta_norm=0.238000
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.760295 (no previous merge yet)
[S2] round=14 local utility u=0.002081 metrics={'f1_val': 0.7056303847981327, 'auprc': 0.8272266407017271, 'loss_val': 0.23392080479026245, 'psi': 0.7542688871595704}-{'f1_val': 0.7026413189059436, 'auprc': 0.8354812055308464, 'loss_val': 0.24491200097644733, 'psi': 0.7557772735559047}
[S3] START round=14 head_norm_before_train=1.711289 (no previous merge yet)
[S3] round=14 local utility u=0.011032 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.9954876412618334, 'loss_val': 0.22073572971192346, 'psi': 0.8186940975200199}-{'f1_val': 0.7008317350254774, 'auprc': 0.9952782929216436, 'loss_val': 0.24217096081360684, 'psi': 0.8186103581839439}
[S4] START round=14 head_norm_before_train=1.771352 (no previous merge yet)
[S4] round=14 local utility u=0.046177 metrics={'f1_val': 0.956186325763965, 'auprc': 0.9580735949647093, 'loss_val': 0.28940062050930493, 'psi': 0.9569412334442629}-{'f1_val': 0.9537988864934196, 'auprc': 0.9570625012152585, 'loss_val': 0.364396158197578, 'psi': 0.9551043323821551}
[S5] START round=14 head_norm_before_train=1.231021 cos_to_last_merge=0.8573 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.857
[S5] round=14 local utility u=0.254343 metrics={'f1_val': 0.7008175646132602, 'auprc': 0.9900284592054798, 'loss_val': 0.45588810637854155, 'psi': 0.816501922450148}-{'f1_val': 0.7008168588441903, 'auprc': 0.860520224405637, 'loss_val': 0.5760456178500153, 'psi': 0.764698205068769}
[S6] START round=14 head_norm_before_train=1.750760 (no previous merge yet)
[S6] round=14 local utility u=0.028427 metrics={'f1_val': 0.8239939677457958, 'auprc': 0.952229170198439, 'loss_val': 0.4324423032916128, 'psi': 0.8752880487268531}-{'f1_val': 0.8026797815113306, 'auprc': 0.9436069620839568, 'loss_val': 0.33554437119397224, 'psi': 0.859050653740381}
[S7] START round=14 head_norm_before_train=1.178146 cos_to_last_merge=0.9989 (last merge round=12)
[S7] round=14 local utility u=0.000000 metrics={'f1_val': 0.6952521489693106, 'auprc': 0.7899133061756468, 'loss_val': 0.7428432694420938, 'psi': 0.7331166118518451}-{'f1_val': 0.7141649928364396, 'auprc': 0.8612403899710828, 'loss_val': 0.7441716027800966, 'psi': 0.7729951516902969}
[S8] START round=14 head_norm_before_train=1.134014 cos_to_last_merge=1.0000 (last merge round=13)
[S8] round=14 local utility u=0.000000 metrics={'f1_val': 0.9921646161217188, 'auprc': 0.9977990596396781, 'loss_val': 0.27371115124916634, 'psi': 0.9944183935289026}-{'f1_val': 0.993235056744646, 'auprc': 0.9898039447290301, 'loss_val': 0.14673904086175327, 'psi': 0.9918626119383996}
[S9] START round=14 head_norm_before_train=1.234736 cos_to_last_merge=1.0000 (last merge round=13)
[S9] round=14 local utility u=0.010501 metrics={'f1_val': 0.9899455008418782, 'auprc': 0.9992634859636231, 'loss_val': 0.24166187332718664, 'psi': 0.9936726948905762}-{'f1_val': 0.9878214512971564, 'auprc': 0.9992655634083281, 'loss_val': 0.249926185449819, 'psi': 0.992399096141625}
[S10] START round=14 head_norm_before_train=1.784301 (no previous merge yet)
[S10] round=14 local utility u=0.000420 metrics={'f1_val': 0.9957455607450773, 'auprc': 0.9944403705671808, 'loss_val': 0.058987214984504016, 'psi': 0.9952234846739186}-{'f1_val': 0.9955259082574451, 'auprc': 0.9945275038099903, 'loss_val': 0.058770423843768155, 'psi': 0.9951265464784632}
[S11] START round=14 head_norm_before_train=1.645613 (no previous merge yet)
[S11] round=14 local utility u=0.754328 metrics={'f1_val': 0.9484259821110678, 'auprc': 0.997781372335627, 'loss_val': 0.18160907041864882, 'psi': 0.9681681382008915}-{'f1_val': 0.7016934795869249, 'auprc': 0.997521814967828, 'loss_val': 0.2090921057588258, 'psi': 0.820024813739286}
[S13] START round=14 head_norm_before_train=0.909425 cos_to_last_merge=0.9842 (last merge round=12)
[S13] round=14 local utility u=0.426680 metrics={'f1_val': 0.6732013486572584, 'auprc': 0.7806277106213972, 'loss_val': 0.5198750549647534, 'psi': 0.716171893442914}-{'f1_val': 0.6025022882921485, 'auprc': 0.6997883186583184, 'loss_val': 0.7065223250973072, 'psi': 0.6414167004386164}
[S14] START round=14 head_norm_before_train=1.784012 (no previous merge yet)
[S14] round=14 local utility u=0.026422 metrics={'f1_val': 0.9980646079025537, 'auprc': 0.9974073960171259, 'loss_val': 0.09380020210738615, 'psi': 0.9978017231483826}-{'f1_val': 0.9976760408229349, 'auprc': 0.9975331476147942, 'loss_val': 0.14468958711903618, 'psi': 0.9976188835396786}
[S15] START round=14 head_norm_before_train=1.250922 cos_to_last_merge=0.9977 (last merge round=12)
[S15] round=14 local utility u=0.000000 metrics={'f1_val': 0.7613454018379733, 'auprc': 0.9577784296285687, 'loss_val': 0.3357424451722209, 'psi': 0.8399186129542114}-{'f1_val': 0.9828126542212958, 'auprc': 0.9699241133747005, 'loss_val': 0.2507292056541806, 'psi': 0.9776572378826577}
[S16] START round=14 head_norm_before_train=1.581597 (no previous merge yet)
[S16] round=14 local utility u=0.000000 metrics={'f1_val': 0.4898167562058596, 'auprc': 0.7974429661035877, 'loss_val': 0.6940487119345973, 'psi': 0.6128672401649509}-{'f1_val': 0.552714221482658, 'auprc': 0.7776322771412945, 'loss_val': 0.7984428666839486, 'psi': 0.6426814437461126}
[S17] START round=14 head_norm_before_train=0.908788 cos_to_last_merge=0.9878 (last merge round=12)
[S17] round=14 local utility u=0.486405 metrics={'f1_val': 0.5233168509450743, 'auprc': 0.9269496995375535, 'loss_val': 0.6502782470200433, 'psi': 0.684769990382066}-{'f1_val': 0.3938402591449141, 'auprc': 0.8835357193298492, 'loss_val': 0.715986441179491, 'psi': 0.5897184432188882}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:52812
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:52809
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] → sending delta(kind=head bytes=1806) to S7@127.0.0.1:52808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:52812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:52814
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1806 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1805 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1806) from S13
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.009883)
[S7] loaded HEAD from S13 (vec_in norm=1.009883)
[S7] cosine check vs S13: cos=0.4450
[S7] BUFFERED delta from S13 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1804) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.816891)
[S14] loaded HEAD from S10 (vec_in norm=1.816891)
[S14] cosine check vs S10: cos=-0.0362
[S14] DROPPED delta from S10 (cos=-0.0362 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1801) from S3
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.741054)
[S11] loaded HEAD from S3 (vec_in norm=1.741054)
[S11] cosine check vs S3: cos=-0.0447
[S11] DROPPED delta from S3 (cos=-0.0447 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1797) from S5
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.273168)
[S11] loaded HEAD from S5 (vec_in norm=1.273168)
[S11] cosine check vs S5: cos=-0.0754
[S11] DROPPED delta from S5 (cos=-0.0754 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1800) from S11
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.672976)
[S8] loaded HEAD from S11 (vec_in norm=1.672976)
[S8] cosine check vs S11: cos=-0.0094
[S8] DROPPED delta from S11 (cos=-0.0094 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1799) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.824055)
[S8] loaded HEAD from S14 (vec_in norm=1.824055)
[S8] cosine check vs S14: cos=0.4590
[S8] BUFFERED delta from S14 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1803) from S2
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.779020)
[S8] loaded HEAD from S2 (vec_in norm=1.779020)
[S8] cosine check vs S2: cos=0.7787
[S8] BUFFERED delta from S2 (total buffered=2)
[S8] RECEIVED delta(kind=head bytes=1803) from S4
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.797950)
[S8] loaded HEAD from S4 (vec_in norm=1.797950)
[S8] cosine check vs S4: cos=0.3557
[S8] BUFFERED delta from S4 (total buffered=3)
[S17] RECEIVED delta(kind=head bytes=1805) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.771271)
[S17] loaded HEAD from S6 (vec_in norm=1.771271)
[S17] cosine check vs S6: cos=0.4062
[S17] BUFFERED delta from S6 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1800) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.272901)
[S17] loaded HEAD from S9 (vec_in norm=1.272901)
[S17] cosine check vs S9: cos=0.5975
[S17] BUFFERED delta from S9 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S13@127.0.0.1:52813
[S17] sending update (kind=head size=1794 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1794) from S17
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.969899)
[S13] loaded HEAD from S17 (vec_in norm=0.969899)
[S13] cosine check vs S17: cos=0.6334
[S13] BUFFERED delta from S17 (total buffered=1)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=14 metric=0.6953 head_norm=1.207399
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.900318e-01
[S7] stored merged vector for next round verification (round=14)
[S7] DEBUG after merge:  round=14 metric=0.6494 head_norm=0.943769 delta_norm=0.590032
[S7] aggregate: ROLLBACK (f1_val pre=0.695 post=0.649 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=14 metric=0.9922 head_norm=1.203020
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.467644e-01
[S8] stored merged vector for next round verification (round=14)
[S8] DEBUG after merge:  round=14 metric=0.9922 head_norm=1.099250 delta_norm=0.246764
[S8] aggregate: ACCEPT kept=['S14', 'S2', 'S4'] (k=3/3) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=14 metric=0.6732 head_norm=1.009883
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.242186e-01
[S13] stored merged vector for next round verification (round=14)
[S13] DEBUG after merge:  round=14 metric=0.6510 head_norm=0.894607 delta_norm=0.424219
[S13] aggregate: ROLLBACK (f1_val pre=0.673 post=0.651 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=14 metric=0.5233 head_norm=0.969899
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.254669e-01
[S17] stored merged vector for next round verification (round=14)
[S17] DEBUG after merge:  round=14 metric=0.3900 head_norm=0.948048 delta_norm=0.425467
[S17] aggregate: ROLLBACK (f1_val pre=0.523 post=0.390 tol_abs=0.005 tol_rel=0.0)
[S2] START round=15 head_norm_before_train=1.779020 (no previous merge yet)
[S2] round=15 local utility u=0.108388 metrics={'f1_val': 0.7043186539901869, 'auprc': 0.9183774266100884, 'loss_val': 0.282727453049174, 'psi': 0.7899421630381476}-{'f1_val': 0.7056303847981327, 'auprc': 0.8272266407017271, 'loss_val': 0.23392080479026245, 'psi': 0.7542688871595704}
[S3] START round=15 head_norm_before_train=1.741054 (no previous merge yet)
[S3] round=15 local utility u=0.005639 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9984716509088329, 'loss_val': 0.21750496635442632, 'psi': 0.819797236162734}-{'f1_val': 0.7008317350254774, 'auprc': 0.9954876412618334, 'loss_val': 0.22073572971192346, 'psi': 0.8186940975200199}
[S4] START round=15 head_norm_before_train=1.797950 (no previous merge yet)
[S4] round=15 local utility u=0.000000 metrics={'f1_val': 0.946177332652838, 'auprc': 0.9688745524313102, 'loss_val': 0.28967620665720456, 'psi': 0.9552562205642269}-{'f1_val': 0.956186325763965, 'auprc': 0.9580735949647093, 'loss_val': 0.28940062050930493, 'psi': 0.9569412334442629}
[S5] START round=15 head_norm_before_train=1.273168 cos_to_last_merge=0.8435 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.844
[S5] round=15 local utility u=0.032972 metrics={'f1_val': 0.7008175646132602, 'auprc': 0.9902226456685805, 'loss_val': 0.3905269414501883, 'psi': 0.8165795970353884}-{'f1_val': 0.7008175646132602, 'auprc': 0.9900284592054798, 'loss_val': 0.45588810637854155, 'psi': 0.816501922450148}
[S6] START round=15 head_norm_before_train=1.771271 (no previous merge yet)
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.4203800837367119, 'auprc': 0.7822711762056269, 'loss_val': 1.160409328353506, 'psi': 0.5651365207242779}-{'f1_val': 0.8239939677457958, 'auprc': 0.952229170198439, 'loss_val': 0.4324423032916128, 'psi': 0.8752880487268531}
[S7] START round=15 head_norm_before_train=0.943769 cos_to_last_merge=1.0000 (last merge round=14)
[S7] round=15 local utility u=0.000000 metrics={'f1_val': 0.6962008291155835, 'auprc': 0.793737155847137, 'loss_val': 0.7654280580430152, 'psi': 0.735215359808205}-{'f1_val': 0.6952521489693106, 'auprc': 0.7899133061756468, 'loss_val': 0.7428432694420938, 'psi': 0.7331166118518451}
[S8] START round=15 head_norm_before_train=1.099250 cos_to_last_merge=1.0000 (last merge round=14)
[S8] round=15 local utility u=0.000000 metrics={'f1_val': 0.9889702328583625, 'auprc': 0.9836813125677084, 'loss_val': 0.2142556324435445, 'psi': 0.9868546647421009}-{'f1_val': 0.9921646161217188, 'auprc': 0.9977990596396781, 'loss_val': 0.27371115124916634, 'psi': 0.9944183935289026}
[S9] START round=15 head_norm_before_train=1.272901 cos_to_last_merge=0.9988 (last merge round=13)
[S9] round=15 local utility u=0.014633 metrics={'f1_val': 0.986953951516442, 'auprc': 0.9982039841000057, 'loss_val': 0.19126894467230718, 'psi': 0.9914539645498675}-{'f1_val': 0.9899455008418782, 'auprc': 0.9992634859636231, 'loss_val': 0.24166187332718664, 'psi': 0.9936726948905762}
[S10] START round=15 head_norm_before_train=1.816891 (no previous merge yet)
[S10] round=15 local utility u=0.007865 metrics={'f1_val': 0.9946235809987843, 'auprc': 0.9965099397795392, 'loss_val': 0.042734933285058334, 'psi': 0.9953781245110862}-{'f1_val': 0.9957455607450773, 'auprc': 0.9944403705671808, 'loss_val': 0.058987214984504016, 'psi': 0.9952234846739186}
[S11] START round=15 head_norm_before_train=1.672976 (no previous merge yet)
[S11] round=15 local utility u=0.000000 metrics={'f1_val': 0.9374979831620657, 'auprc': 0.9977664517068046, 'loss_val': 0.19028558836776702, 'psi': 0.9616053705799612}-{'f1_val': 0.9484259821110678, 'auprc': 0.997781372335627, 'loss_val': 0.18160907041864882, 'psi': 0.9681681382008915}
[S13] START round=15 head_norm_before_train=0.894607 cos_to_last_merge=1.0000 (last merge round=14)
[S13] round=15 local utility u=0.000000 metrics={'f1_val': 0.6251262695773214, 'auprc': 0.6877921548699741, 'loss_val': 0.6642238696161272, 'psi': 0.6501926236943825}-{'f1_val': 0.6732013486572584, 'auprc': 0.7806277106213972, 'loss_val': 0.5198750549647534, 'psi': 0.716171893442914}
[S14] START round=15 head_norm_before_train=1.824055 (no previous merge yet)
[S14] round=15 local utility u=0.008363 metrics={'f1_val': 0.997843956789816, 'auprc': 0.997425555654651, 'loss_val': 0.07580453614612383, 'psi': 0.99767659633575}-{'f1_val': 0.9980646079025537, 'auprc': 0.9974073960171259, 'loss_val': 0.09380020210738615, 'psi': 0.9978017231483826}
[S15] START round=15 head_norm_before_train=1.326102 cos_to_last_merge=0.9895 (last merge round=12)
[S15] round=15 local utility u=0.839302 metrics={'f1_val': 0.9931651852853013, 'auprc': 0.9843130113451775, 'loss_val': 0.127661550660862, 'psi': 0.9896243157092518}-{'f1_val': 0.7613454018379733, 'auprc': 0.9577784296285687, 'loss_val': 0.3357424451722209, 'psi': 0.8399186129542114}
[S16] START round=15 head_norm_before_train=1.618316 (no previous merge yet)
[S16] round=15 local utility u=1.000000 metrics={'f1_val': 0.8266629907629282, 'auprc': 0.815077170275624, 'loss_val': 0.7544127032953134, 'psi': 0.8220286625680064}-{'f1_val': 0.4898167562058596, 'auprc': 0.7974429661035877, 'loss_val': 0.6940487119345973, 'psi': 0.6128672401649509}
[S17] START round=15 head_norm_before_train=0.948048 cos_to_last_merge=1.0000 (last merge round=14)
[S17] round=15 local utility u=0.000000 metrics={'f1_val': 0.5065978716535228, 'auprc': 0.8932857959242583, 'loss_val': 0.6461847644896658, 'psi': 0.661273041361817}-{'f1_val': 0.5233168509450743, 'auprc': 0.9269496995375535, 'loss_val': 0.6502782470200433, 'psi': 0.684769990382066}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:52808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:52817
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:52814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:52810
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:52812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S14] → sending delta(kind=head bytes=1807) to S8@127.0.0.1:52809
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] → sending delta(kind=head bytes=1805) to S11@127.0.0.1:52812
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1807 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1804 to 1 peers)
[S5] sending update (kind=head size=1805 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1807) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.860000)
[S8] loaded HEAD from S14 (vec_in norm=1.860000)
[S8] cosine check vs S14: cos=0.5757
[S8] BUFFERED delta from S14 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1801) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.653640)
[S7] loaded HEAD from S16 (vec_in norm=1.653640)
[S7] cosine check vs S16: cos=0.7489
[S7] BUFFERED delta from S16 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1804) from S2
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.800331)
[S8] loaded HEAD from S2 (vec_in norm=1.800331)
[S8] cosine check vs S2: cos=0.6344
[S8] BUFFERED delta from S2 (total buffered=2)
[S11] RECEIVED delta(kind=head bytes=1805) from S5
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.309272)
[S11] loaded HEAD from S5 (vec_in norm=1.309272)
[S11] cosine check vs S5: cos=-0.0707
[S11] DROPPED delta from S5 (cos=-0.0707 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1799) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.314805)
[S17] loaded HEAD from S9 (vec_in norm=1.314805)
[S17] cosine check vs S9: cos=0.6367
[S17] BUFFERED delta from S9 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1798) from S3
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.770102)
[S11] loaded HEAD from S3 (vec_in norm=1.770102)
[S11] cosine check vs S3: cos=-0.0449
[S11] DROPPED delta from S3 (cos=-0.0449 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1799) from S15
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.382869)
[S9] loaded HEAD from S15 (vec_in norm=1.382869)
[S9] cosine check vs S15: cos=0.9729
[S9] BUFFERED delta from S15 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1796) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.848588)
[S14] loaded HEAD from S10 (vec_in norm=1.848588)
[S14] cosine check vs S10: cos=-0.0387
[S14] DROPPED delta from S10 (cos=-0.0387 < 0.0)
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=15 metric=0.9890 head_norm=1.194942
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.741268e-01
[S8] stored merged vector for next round verification (round=15)
[S8] DEBUG after merge:  round=15 metric=0.9913 head_norm=1.209195 delta_norm=0.374127
[S8] aggregate: ACCEPT kept=['S14', 'S2'] (k=2/2) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.111 → S15@127.0.0.1:52815
[S13] ⇄ pheromone p=0.178 → S7@127.0.0.1:52808
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=15 metric=0.6962 head_norm=0.969657
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.641448e-01
[S7] stored merged vector for next round verification (round=15)
[S7] DEBUG after merge:  round=15 metric=0.6981 head_norm=1.232526 delta_norm=0.564145
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.159 → S17@127.0.0.1:52817
[S6] ⇄ pheromone p=0.298 → S17@127.0.0.1:52817
[S11] ⇄ pheromone p=0.263 → S8@127.0.0.1:52809
[S4] ⇄ pheromone p=0.208 → S8@127.0.0.1:52809
[S16] ⇄ pheromone p=0.345 → S7@127.0.0.1:52808
[S5] ⇄ pheromone p=0.233 → S11@127.0.0.1:52812
[S10] ⇄ pheromone p=0.169 → S14@127.0.0.1:52814
[S3] ⇄ pheromone p=0.155 → S11@127.0.0.1:52812
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=15 metric=0.9870 head_norm=1.314805
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.605622e-01
[S9] stored merged vector for next round verification (round=15)
[S9] DEBUG after merge:  round=15 metric=0.9870 head_norm=1.339678 delta_norm=0.160562
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.273 → S17@127.0.0.1:52817
[S2] ⇄ pheromone p=0.115 → S8@127.0.0.1:52809
[S14] ⇄ pheromone p=0.205 → S8@127.0.0.1:52809
[S15] ⇄ pheromone p=0.453 → S9@127.0.0.1:52810
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=15 metric=0.5066 head_norm=1.001128
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.134949e-01
[S17] stored merged vector for next round verification (round=15)
[S17] DEBUG after merge:  round=15 metric=0.7468 head_norm=1.049670 delta_norm=0.513495
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.157 → S13@127.0.0.1:52813
[S2] START round=16 head_norm_before_train=1.800331 (no previous merge yet)
[S2] round=16 local utility u=0.000000 metrics={'f1_val': 0.7171893571711945, 'auprc': 0.8015171205383027, 'loss_val': 0.5697148322865546, 'psi': 0.7509204625180378}-{'f1_val': 0.7043186539901869, 'auprc': 0.9183774266100884, 'loss_val': 0.282727453049174, 'psi': 0.7899421630381476}
[S3] START round=16 head_norm_before_train=1.770102 (no previous merge yet)
[S3] round=16 local utility u=0.021399 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9984520028087018, 'loss_val': 0.17464854758905157, 'psi': 0.8197893769226816}-{'f1_val': 0.7006809596653347, 'auprc': 0.9984716509088329, 'loss_val': 0.21750496635442632, 'psi': 0.819797236162734}
[S4] START round=16 head_norm_before_train=1.816344 (no previous merge yet)
[S4] round=16 local utility u=0.019049 metrics={'f1_val': 0.9492647391959306, 'auprc': 0.9726594456825337, 'loss_val': 0.2814566965682845, 'psi': 0.9586226217905719}-{'f1_val': 0.946177332652838, 'auprc': 0.9688745524313102, 'loss_val': 0.28967620665720456, 'psi': 0.9552562205642269}
[S5] START round=16 head_norm_before_train=1.309272 cos_to_last_merge=0.8297 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.830
[S5] round=16 local utility u=0.020209 metrics={'f1_val': 0.7011046720655897, 'auprc': 0.9900389743392963, 'loss_val': 0.35127989121960634, 'psi': 0.8166783929750723}-{'f1_val': 0.7008175646132602, 'auprc': 0.9902226456685805, 'loss_val': 0.3905269414501883, 'psi': 0.8165795970353884}
[S6] START round=16 head_norm_before_train=1.784477 (no previous merge yet)
[S6] round=16 local utility u=1.000000 metrics={'f1_val': 0.6751173663590745, 'auprc': 0.9177550535152009, 'loss_val': 0.7372803744314671, 'psi': 0.7721724412215251}-{'f1_val': 0.4203800837367119, 'auprc': 0.7822711762056269, 'loss_val': 1.160409328353506, 'psi': 0.5651365207242779}
[S7] START round=16 head_norm_before_train=1.232526 cos_to_last_merge=1.0000 (last merge round=15)
[S7] round=16 local utility u=0.000000 metrics={'f1_val': 0.5184907731201722, 'auprc': 0.7917139787932859, 'loss_val': 0.7881700749613694, 'psi': 0.6277800553894177}-{'f1_val': 0.6962008291155835, 'auprc': 0.793737155847137, 'loss_val': 0.7654280580430152, 'psi': 0.735215359808205}
[S8] START round=16 head_norm_before_train=1.209195 cos_to_last_merge=1.0000 (last merge round=15)
[S8] round=16 local utility u=0.015456 metrics={'f1_val': 0.990363285929422, 'auprc': 0.9842329711043512, 'loss_val': 0.1933564796747666, 'psi': 0.9879111599993937}-{'f1_val': 0.9889702328583625, 'auprc': 0.9836813125677084, 'loss_val': 0.2142556324435445, 'psi': 0.9868546647421009}
[S9] START round=16 head_norm_before_train=1.339678 cos_to_last_merge=1.0000 (last merge round=15)
[S9] round=16 local utility u=0.039622 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9954787661110625, 'loss_val': 0.16474389859887323, 'psi': 0.9964532539517107}-{'f1_val': 0.986953951516442, 'auprc': 0.9982039841000057, 'loss_val': 0.19126894467230718, 'psi': 0.9914539645498675}
[S10] START round=16 head_norm_before_train=1.848588 (no previous merge yet)
[S10] round=16 local utility u=0.003529 metrics={'f1_val': 0.9950868285240967, 'auprc': 0.9963623151822655, 'loss_val': 0.03801346553477158, 'psi': 0.9955970231873641}-{'f1_val': 0.9946235809987843, 'auprc': 0.9965099397795392, 'loss_val': 0.042734933285058334, 'psi': 0.9953781245110862}
[S11] START round=16 head_norm_before_train=1.699348 (no previous merge yet)
[S11] round=16 local utility u=0.096780 metrics={'f1_val': 0.9606608608595786, 'auprc': 0.9978378607896152, 'loss_val': 0.13591747907205617, 'psi': 0.9755316608315932}-{'f1_val': 0.9374979831620657, 'auprc': 0.9977664517068046, 'loss_val': 0.19028558836776702, 'psi': 0.9616053705799612}
[S13] START round=16 head_norm_before_train=0.963247 cos_to_last_merge=0.9911 (last merge round=14)
[S13] round=16 local utility u=0.133805 metrics={'f1_val': 0.5991211518957056, 'auprc': 0.8343941559902291, 'loss_val': 0.6803883102540004, 'psi': 0.693230353533515}-{'f1_val': 0.6251262695773214, 'auprc': 0.6877921548699741, 'loss_val': 0.6642238696161272, 'psi': 0.6501926236943825}
[S14] START round=16 head_norm_before_train=1.860000 (no previous merge yet)
[S14] round=16 local utility u=0.008907 metrics={'f1_val': 0.9982552080827751, 'auprc': 0.9974273585188643, 'loss_val': 0.060462466678568895, 'psi': 0.9979240682572108}-{'f1_val': 0.997843956789816, 'auprc': 0.997425555654651, 'loss_val': 0.07580453614612383, 'psi': 0.99767659633575}
[S15] START round=16 head_norm_before_train=1.382869 cos_to_last_merge=0.9816 (last merge round=12)
[S15] round=16 local utility u=0.000000 metrics={'f1_val': 0.8137059024688049, 'auprc': 0.9774436107690606, 'loss_val': 0.24230632712772854, 'psi': 0.8792009857889072}-{'f1_val': 0.9931651852853013, 'auprc': 0.9843130113451775, 'loss_val': 0.127661550660862, 'psi': 0.9896243157092518}
[S16] START round=16 head_norm_before_train=1.653640 (no previous merge yet)
[S16] round=16 local utility u=0.433909 metrics={'f1_val': 0.8737242187791139, 'auprc': 0.915639030493793, 'loss_val': 0.4706472865250626, 'psi': 0.8904901434649856}-{'f1_val': 0.8266629907629282, 'auprc': 0.815077170275624, 'loss_val': 0.7544127032953134, 'psi': 0.8220286625680064}
[S17] START round=16 head_norm_before_train=1.049670 cos_to_last_merge=1.0000 (last merge round=15)
[S17] round=16 local utility u=0.020720 metrics={'f1_val': 0.4980163511936528, 'auprc': 0.9302628753935919, 'loss_val': 0.6641872842934566, 'psi': 0.6709149608736285}-{'f1_val': 0.5065978716535228, 'auprc': 0.8932857959242583, 'loss_val': 0.6461847644896658, 'psi': 0.661273041361817}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:52817
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:52812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:52812
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1802) from S4
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.831082)
[S8] loaded HEAD from S4 (vec_in norm=1.831082)
[S8] cosine check vs S4: cos=0.2325
[S8] BUFFERED delta from S4 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1802) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.794244)
[S17] loaded HEAD from S6 (vec_in norm=1.794244)
[S17] cosine check vs S6: cos=0.3225
[S17] BUFFERED delta from S6 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:52815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:52808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S14] → sending delta(kind=head bytes=1806) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:52814
[S10] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1806 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1802) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.874909)
[S14] loaded HEAD from S10 (vec_in norm=1.874909)
[S14] cosine check vs S10: cos=-0.0405
[S14] DROPPED delta from S10 (cos=-0.0405 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1796) from S13
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.030713)
[S7] loaded HEAD from S13 (vec_in norm=1.030713)
[S7] cosine check vs S13: cos=0.5733
[S7] BUFFERED delta from S13 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1802) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.281351)
[S15] loaded HEAD from S8 (vec_in norm=1.281351)
[S15] cosine check vs S8: cos=0.6644
[S15] BUFFERED delta from S8 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1806) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.893182)
[S8] loaded HEAD from S14 (vec_in norm=1.893182)
[S8] cosine check vs S14: cos=0.6897
[S8] BUFFERED delta from S14 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:52809
[S3] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1803) from S11
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.724878)
[S8] loaded HEAD from S11 (vec_in norm=1.724878)
[S8] cosine check vs S11: cos=0.0041
[S8] BUFFERED delta from S11 (total buffered=3)
[S11] RECEIVED delta(kind=head bytes=1802) from S5
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.333182)
[S11] loaded HEAD from S5 (vec_in norm=1.333182)
[S11] cosine check vs S5: cos=-0.0668
[S11] DROPPED delta from S5 (cos=-0.0668 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1797) from S3
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.797687)
[S11] loaded HEAD from S3 (vec_in norm=1.797687)
[S11] cosine check vs S3: cos=-0.0444
[S11] DROPPED delta from S3 (cos=-0.0444 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:52808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:52817
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1802 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1802) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.690766)
[S7] loaded HEAD from S16 (vec_in norm=1.690766)
[S7] cosine check vs S16: cos=0.9617
[S7] BUFFERED delta from S16 (total buffered=2)
[S9] sending update (kind=head size=1792 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1792) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.379533)
[S17] loaded HEAD from S9 (vec_in norm=1.379533)
[S17] cosine check vs S9: cos=0.9025
[S17] BUFFERED delta from S9 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:52813
[S17] sending update (kind=head size=1796 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1796) from S17
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.097959)
[S13] loaded HEAD from S17 (vec_in norm=1.097959)
[S13] cosine check vs S17: cos=0.6773
[S13] BUFFERED delta from S17 (total buffered=1)
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=16 metric=0.5185 head_norm=1.264367
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.520871e-01
[S7] stored merged vector for next round verification (round=16)
[S7] DEBUG after merge:  round=16 metric=0.4979 head_norm=1.193589 delta_norm=0.152087
[S7] aggregate: ROLLBACK (f1_val pre=0.518 post=0.498 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=16 metric=0.9904 head_norm=1.281351
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.466101e-01
[S8] stored merged vector for next round verification (round=16)
[S8] DEBUG after merge:  round=16 metric=0.9889 head_norm=1.028904 delta_norm=0.546610
[S8] aggregate: ACCEPT kept=['S4', 'S14', 'S11'] (k=3/3) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=16 metric=0.8137 head_norm=1.424840
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.581417e-01
[S15] stored merged vector for next round verification (round=16)
[S15] DEBUG after merge:  round=16 metric=0.8355 head_norm=1.234703 delta_norm=0.558142
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=16 metric=0.5991 head_norm=1.030713
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.286560e-01
[S13] stored merged vector for next round verification (round=16)
[S13] DEBUG after merge:  round=16 metric=0.5979 head_norm=0.974780 delta_norm=0.428656
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=16 metric=0.4980 head_norm=1.097959
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.614179e-01
[S17] stored merged vector for next round verification (round=16)
[S17] DEBUG after merge:  round=16 metric=0.5009 head_norm=1.063839 delta_norm=0.361418
[S17] aggregate: ACCEPT kept=['S6', 'S9'] (k=2/2) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.822848 (no previous merge yet)
[S2] round=17 local utility u=0.746684 metrics={'f1_val': 0.8223788184894638, 'auprc': 0.9776510045089561, 'loss_val': 0.2358857286117034, 'psi': 0.8844876928972607}-{'f1_val': 0.7171893571711945, 'auprc': 0.8015171205383027, 'loss_val': 0.5697148322865546, 'psi': 0.7509204625180378}
[S3] START round=17 head_norm_before_train=1.797687 (no previous merge yet)
[S3] round=17 local utility u=0.809089 metrics={'f1_val': 0.9608255936721991, 'auprc': 0.998660777110818, 'loss_val': 0.11796514222225135, 'psi': 0.9759596670476467}-{'f1_val': 0.7006809596653347, 'auprc': 0.9984520028087018, 'loss_val': 0.17464854758905157, 'psi': 0.8197893769226816}
[S4] START round=17 head_norm_before_train=1.831082 (no previous merge yet)
[S4] round=17 local utility u=0.037955 metrics={'f1_val': 0.9542215064315867, 'auprc': 0.9822939436507362, 'loss_val': 0.26419025636169974, 'psi': 0.9654504813192464}-{'f1_val': 0.9492647391959306, 'auprc': 0.9726594456825337, 'loss_val': 0.2814566965682845, 'psi': 0.9586226217905719}
[S5] START round=17 head_norm_before_train=1.333182 cos_to_last_merge=0.8168 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.817
[S5] round=17 local utility u=0.013721 metrics={'f1_val': 0.7011046720655897, 'auprc': 0.9902946004370228, 'loss_val': 0.32460475134859706, 'psi': 0.8167806434141629}-{'f1_val': 0.7011046720655897, 'auprc': 0.9900389743392963, 'loss_val': 0.35127989121960634, 'psi': 0.8166783929750723}
[S6] START round=17 head_norm_before_train=1.794244 (no previous merge yet)
[S6] round=17 local utility u=0.650319 metrics={'f1_val': 0.8225715174981097, 'auprc': 0.9520229403761293, 'loss_val': 0.42417191314398295, 'psi': 0.8743520866493175}-{'f1_val': 0.6751173663590745, 'auprc': 0.9177550535152009, 'loss_val': 0.7372803744314671, 'psi': 0.7721724412215251}
[S7] START round=17 head_norm_before_train=1.193589 cos_to_last_merge=1.0000 (last merge round=16)
[S7] round=17 local utility u=0.957441 metrics={'f1_val': 0.6997891773383876, 'auprc': 0.9729884294692732, 'loss_val': 0.5049027046043281, 'psi': 0.8090688781907418}-{'f1_val': 0.5184907731201722, 'auprc': 0.7917139787932859, 'loss_val': 0.7881700749613694, 'psi': 0.6277800553894177}
[S8] START round=17 head_norm_before_train=1.028904 cos_to_last_merge=1.0000 (last merge round=16)
[S8] round=17 local utility u=0.014265 metrics={'f1_val': 0.9932593276801964, 'auprc': 0.9844356814843358, 'loss_val': 0.18280986213402028, 'psi': 0.9897298692018521}-{'f1_val': 0.990363285929422, 'auprc': 0.9842329711043512, 'loss_val': 0.1933564796747666, 'psi': 0.9879111599993937}
[S9] START round=17 head_norm_before_train=1.379533 cos_to_last_merge=0.9990 (last merge round=15)
[S9] round=17 local utility u=0.000000 metrics={'f1_val': 0.9854260686028263, 'auprc': 0.9922307369540729, 'loss_val': 0.1502141232388267, 'psi': 0.988147935943325}-{'f1_val': 0.9971029125121428, 'auprc': 0.9954787661110625, 'loss_val': 0.16474389859887323, 'psi': 0.9964532539517107}
[S10] START round=17 head_norm_before_train=1.874909 (no previous merge yet)
[S10] round=17 local utility u=0.001750 metrics={'f1_val': 0.9953063309450747, 'auprc': 0.9962514172418298, 'loss_val': 0.03549791292071845, 'psi': 0.9956843654637768}-{'f1_val': 0.9950868285240967, 'auprc': 0.9963623151822655, 'loss_val': 0.03801346553477158, 'psi': 0.9955970231873641}
[S11] START round=17 head_norm_before_train=1.724878 (no previous merge yet)
[S11] round=17 local utility u=0.054443 metrics={'f1_val': 0.9805551251371883, 'auprc': 0.9979184134983485, 'loss_val': 0.1466384085436177, 'psi': 0.9875004404816525}-{'f1_val': 0.9606608608595786, 'auprc': 0.9978378607896152, 'loss_val': 0.13591747907205617, 'psi': 0.9755316608315932}
[S13] START round=17 head_norm_before_train=0.974780 cos_to_last_merge=1.0000 (last merge round=16)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.627523908660897, 'auprc': 0.7079170933198362, 'loss_val': 0.6427279412057377, 'psi': 0.6596811825244727}-{'f1_val': 0.5991211518957056, 'auprc': 0.8343941559902291, 'loss_val': 0.6803883102540004, 'psi': 0.693230353533515}
[S14] START round=17 head_norm_before_train=1.893182 (no previous merge yet)
[S14] round=17 local utility u=0.000000 metrics={'f1_val': 0.9568512698629685, 'auprc': 0.9981049376679318, 'loss_val': 0.07075524778417207, 'psi': 0.9733527369849538}-{'f1_val': 0.9982552080827751, 'auprc': 0.9974273585188643, 'loss_val': 0.060462466678568895, 'psi': 0.9979240682572108}
[S15] START round=17 head_norm_before_train=1.234703 cos_to_last_merge=1.0000 (last merge round=16)
[S15] round=17 local utility u=0.000000 metrics={'f1_val': 0.7968595198784334, 'auprc': 0.9867024818658755, 'loss_val': 0.30478145878824786, 'psi': 0.8727967046734102}-{'f1_val': 0.8137059024688049, 'auprc': 0.9774436107690606, 'loss_val': 0.24230632712772854, 'psi': 0.8792009857889072}
[S16] START round=17 head_norm_before_train=1.690766 (no previous merge yet)
[S16] round=17 local utility u=0.000000 metrics={'f1_val': 0.8413958000971933, 'auprc': 0.9262518612408802, 'loss_val': 0.6480318565598774, 'psi': 0.8753382245546681}-{'f1_val': 0.8737242187791139, 'auprc': 0.915639030493793, 'loss_val': 0.4706472865250626, 'psi': 0.8904901434649856}
[S17] START round=17 head_norm_before_train=1.063839 cos_to_last_merge=1.0000 (last merge round=16)
[S17] round=17 local utility u=0.076113 metrics={'f1_val': 0.6173200189020164, 'auprc': 0.7616703131377225, 'loss_val': 0.7220053101647261, 'psi': 0.6750601365962988}-{'f1_val': 0.4980163511936528, 'auprc': 0.9302628753935919, 'loss_val': 0.6641872842934566, 'psi': 0.6709149608736285}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S11@127.0.0.1:52812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:52815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:52809
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:52817
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:52812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:52814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:52809
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1794 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1805 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1803) from S5
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.357739)
[S11] loaded HEAD from S5 (vec_in norm=1.357739)
[S11] cosine check vs S5: cos=-0.0630
[S11] DROPPED delta from S5 (cos=-0.0630 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1805) from S11
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.755752)
[S8] loaded HEAD from S11 (vec_in norm=1.755752)
[S8] cosine check vs S11: cos=0.2244
[S8] BUFFERED delta from S11 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1802) from S2
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.839944)
[S8] loaded HEAD from S2 (vec_in norm=1.839944)
[S8] cosine check vs S2: cos=0.4046
[S8] BUFFERED delta from S2 (total buffered=2)
[S17] RECEIVED delta(kind=head bytes=1798) from S7
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.221459)
[S17] loaded HEAD from S7 (vec_in norm=1.221459)
[S17] cosine check vs S7: cos=0.2973
[S17] BUFFERED delta from S7 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1800) from S4
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.840607)
[S8] loaded HEAD from S4 (vec_in norm=1.840607)
[S8] cosine check vs S4: cos=0.4264
[S8] BUFFERED delta from S4 (total buffered=3)
[S15] RECEIVED delta(kind=head bytes=1794) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.116024)
[S15] loaded HEAD from S8 (vec_in norm=1.116024)
[S15] cosine check vs S8: cos=0.9006
[S15] BUFFERED delta from S8 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1799) from S3
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.822834)
[S11] loaded HEAD from S3 (vec_in norm=1.822834)
[S11] cosine check vs S3: cos=-0.0431
[S11] DROPPED delta from S3 (cos=-0.0431 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1802) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.808139)
[S17] loaded HEAD from S6 (vec_in norm=1.808139)
[S17] cosine check vs S6: cos=0.5818
[S17] BUFFERED delta from S6 (total buffered=2)
[S14] RECEIVED delta(kind=head bytes=1801) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.901007)
[S14] loaded HEAD from S10 (vec_in norm=1.901007)
[S14] cosine check vs S10: cos=-0.0422
[S14] DROPPED delta from S10 (cos=-0.0422 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:52813
[S17] sending update (kind=head size=1799 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1799) from S17
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.119678)
[S13] loaded HEAD from S17 (vec_in norm=1.119678)
[S13] cosine check vs S17: cos=0.8768
[S13] BUFFERED delta from S17 (total buffered=1)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=17 metric=0.7969 head_norm=1.294369
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.824405e-01
[S15] stored merged vector for next round verification (round=17)
[S15] DEBUG after merge:  round=17 metric=0.8031 head_norm=1.175022 delta_norm=0.282441
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=17 metric=0.6275 head_norm=1.035769
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.705117e-01
[S13] stored merged vector for next round verification (round=17)
[S13] DEBUG after merge:  round=17 metric=0.6269 head_norm=1.044065 delta_norm=0.270512
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=17 metric=0.9933 head_norm=1.116024
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.529757e-01
[S8] stored merged vector for next round verification (round=17)
[S8] DEBUG after merge:  round=17 metric=0.9929 head_norm=0.953781 delta_norm=0.452976
[S8] aggregate: ACCEPT kept=['S11', 'S2', 'S4'] (k=3/3) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=17 metric=0.6173 head_norm=1.119678
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.762400e-01
[S17] stored merged vector for next round verification (round=17)
[S17] DEBUG after merge:  round=17 metric=0.6336 head_norm=1.009458 delta_norm=0.476240
[S17] aggregate: ACCEPT kept=['S7', 'S6'] (k=2/2) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.839944 (no previous merge yet)
[S2] round=18 local utility u=0.000000 metrics={'f1_val': 0.7118109438802538, 'auprc': 0.9200362894078671, 'loss_val': 0.2839711387166348, 'psi': 0.7951010820912991}-{'f1_val': 0.8223788184894638, 'auprc': 0.9776510045089561, 'loss_val': 0.2358857286117034, 'psi': 0.8844876928972607}
[S3] START round=18 head_norm_before_train=1.822834 (no previous merge yet)
[S3] round=18 local utility u=0.000309 metrics={'f1_val': 0.960995754132836, 'auprc': 0.9978145178989766, 'loss_val': 0.11582963900500566, 'psi': 0.9757232596392923}-{'f1_val': 0.9608255936721991, 'auprc': 0.998660777110818, 'loss_val': 0.11796514222225135, 'psi': 0.9759596670476467}
[S4] START round=18 head_norm_before_train=1.840607 (no previous merge yet)
[S4] round=18 local utility u=0.000000 metrics={'f1_val': 0.9493562655183784, 'auprc': 0.9602334713530465, 'loss_val': 0.2879373468359325, 'psi': 0.9537071478522456}-{'f1_val': 0.9542215064315867, 'auprc': 0.9822939436507362, 'loss_val': 0.26419025636169974, 'psi': 0.9654504813192464}
[S5] START round=18 head_norm_before_train=1.357739 cos_to_last_merge=0.8074 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.807
[S5] round=18 local utility u=0.005071 metrics={'f1_val': 0.7008563225598777, 'auprc': 0.9897676707944396, 'loss_val': 0.3113923670611589, 'psi': 0.8164208618537026}-{'f1_val': 0.7011046720655897, 'auprc': 0.9902946004370228, 'loss_val': 0.32460475134859706, 'psi': 0.8167806434141629}
[S6] START round=18 head_norm_before_train=1.808139 (no previous merge yet)
[S6] round=18 local utility u=0.077487 metrics={'f1_val': 0.8375122307105185, 'auprc': 0.9630478828786799, 'loss_val': 0.39191735731721467, 'psi': 0.8877264915777832}-{'f1_val': 0.8225715174981097, 'auprc': 0.9520229403761293, 'loss_val': 0.42417191314398295, 'psi': 0.8743520866493175}
[S7] START round=18 head_norm_before_train=1.221459 cos_to_last_merge=0.9990 (last merge round=16)
[S7] round=18 local utility u=0.000000 metrics={'f1_val': 0.39063144975263825, 'auprc': 0.6353293450231369, 'loss_val': 1.0725555501186468, 'psi': 0.48851060786083766}-{'f1_val': 0.6997891773383876, 'auprc': 0.9729884294692732, 'loss_val': 0.5049027046043281, 'psi': 0.8090688781907418}
[S8] START round=18 head_norm_before_train=0.953781 cos_to_last_merge=1.0000 (last merge round=17)
[S8] round=18 local utility u=0.000000 metrics={'f1_val': 0.9921646161217188, 'auprc': 0.9904309550808167, 'loss_val': 0.21374155212664084, 'psi': 0.991471151705358}-{'f1_val': 0.9932593276801964, 'auprc': 0.9844356814843358, 'loss_val': 0.18280986213402028, 'psi': 0.9897298692018521}
[S9] START round=18 head_norm_before_train=1.420385 cos_to_last_merge=0.9968 (last merge round=15)
[S9] round=18 local utility u=0.055941 metrics={'f1_val': 0.9929129676379356, 'auprc': 0.9992049988689202, 'loss_val': 0.10417578136170366, 'psi': 0.9954297801303295}-{'f1_val': 0.9854260686028263, 'auprc': 0.9922307369540729, 'loss_val': 0.1502141232388267, 'psi': 0.988147935943325}
[S10] START round=18 head_norm_before_train=1.901007 (no previous merge yet)
[S10] round=18 local utility u=0.001123 metrics={'f1_val': 0.9953063309450747, 'auprc': 0.996319755675864, 'loss_val': 0.03345664969363728, 'psi': 0.9957117008373905}-{'f1_val': 0.9953063309450747, 'auprc': 0.9962514172418298, 'loss_val': 0.03549791292071845, 'psi': 0.9956843654637768}
[S11] START round=18 head_norm_before_train=1.755752 (no previous merge yet)
[S11] round=18 local utility u=0.074377 metrics={'f1_val': 0.996960829744628, 'auprc': 0.9980766328736103, 'loss_val': 0.09679408781493988, 'psi': 0.9974071509962208}-{'f1_val': 0.9805551251371883, 'auprc': 0.9979184134983485, 'loss_val': 0.1466384085436177, 'psi': 0.9875004404816525}
[S13] START round=18 head_norm_before_train=1.044065 cos_to_last_merge=1.0000 (last merge round=17)
[S13] round=18 local utility u=0.050183 metrics={'f1_val': 0.6173571719392391, 'auprc': 0.7746816740557083, 'loss_val': 0.6816558261638714, 'psi': 0.6802869727858267}-{'f1_val': 0.627523908660897, 'auprc': 0.7079170933198362, 'loss_val': 0.6427279412057377, 'psi': 0.6596811825244727}
[S14] START round=18 head_norm_before_train=1.923993 (no previous merge yet)
[S14] round=18 local utility u=0.127234 metrics={'f1_val': 0.9944935406943898, 'auprc': 0.9992323743356706, 'loss_val': 0.04552321634995002, 'psi': 0.9963890741509022}-{'f1_val': 0.9568512698629685, 'auprc': 0.9981049376679318, 'loss_val': 0.07075524778417207, 'psi': 0.9733527369849538}
[S15] START round=18 head_norm_before_train=1.175022 cos_to_last_merge=1.0000 (last merge round=17)
[S15] round=18 local utility u=0.213733 metrics={'f1_val': 0.8703976874906338, 'auprc': 0.9704902334542471, 'loss_val': 0.2699082817428542, 'psi': 0.9104347058760791}-{'f1_val': 0.7968595198784334, 'auprc': 0.9867024818658755, 'loss_val': 0.30478145878824786, 'psi': 0.8727967046734102}
[S16] START round=18 head_norm_before_train=1.729590 (no previous merge yet)
[S16] round=18 local utility u=0.001884 metrics={'f1_val': 0.8385877835730389, 'auprc': 0.942917485941964, 'loss_val': 0.6774130192481491, 'psi': 0.8803196645206088}-{'f1_val': 0.8413958000971933, 'auprc': 0.9262518612408802, 'loss_val': 0.6480318565598774, 'psi': 0.8753382245546681}
[S17] START round=18 head_norm_before_train=1.009458 cos_to_last_merge=1.0000 (last merge round=17)
[S17] round=18 local utility u=0.000000 metrics={'f1_val': 0.34718899281712756, 'auprc': 0.676763155574565, 'loss_val': 1.1717897976008456, 'psi': 0.47901865792010256}-{'f1_val': 0.6173200189020164, 'auprc': 0.7616703131377225, 'loss_val': 0.7220053101647261, 'psi': 0.6750601365962988}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:52810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:52808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:52812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:52814
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S11@127.0.0.1:52812
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:52808
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:52809
[S13] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S10] sending update (kind=head size=1794 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1805 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1797) from S15
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.252210)
[S9] loaded HEAD from S15 (vec_in norm=1.252210)
[S9] cosine check vs S15: cos=0.8867
[S9] BUFFERED delta from S15 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1803) from S13
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.118395)
[S7] loaded HEAD from S13 (vec_in norm=1.118395)
[S7] cosine check vs S13: cos=0.4420
[S7] BUFFERED delta from S13 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1799) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.765552)
[S7] loaded HEAD from S16 (vec_in norm=1.765552)
[S7] cosine check vs S16: cos=0.9341
[S7] BUFFERED delta from S16 (total buffered=2)
[S11] RECEIVED delta(kind=head bytes=1804) from S3
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.848325)
[S11] loaded HEAD from S3 (vec_in norm=1.848325)
[S11] cosine check vs S3: cos=-0.0416
[S11] DROPPED delta from S3 (cos=-0.0416 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1798) from S5
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.384678)
[S11] loaded HEAD from S5 (vec_in norm=1.384678)
[S11] cosine check vs S5: cos=-0.0593
[S11] DROPPED delta from S5 (cos=-0.0593 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1805) from S11
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.788558)
[S8] loaded HEAD from S11 (vec_in norm=1.788558)
[S8] cosine check vs S11: cos=0.3855
[S8] BUFFERED delta from S11 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1799) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.454661)
[S17] loaded HEAD from S9 (vec_in norm=1.454661)
[S17] cosine check vs S9: cos=0.5180
[S17] BUFFERED delta from S9 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1801) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.949162)
[S8] loaded HEAD from S14 (vec_in norm=1.949162)
[S8] cosine check vs S14: cos=0.4905
[S8] BUFFERED delta from S14 (total buffered=2)
[S14] RECEIVED delta(kind=head bytes=1794) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.926388)
[S14] loaded HEAD from S10 (vec_in norm=1.926388)
[S14] cosine check vs S10: cos=-0.0435
[S14] DROPPED delta from S10 (cos=-0.0435 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1801) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.831047)
[S17] loaded HEAD from S6 (vec_in norm=1.831047)
[S17] cosine check vs S6: cos=0.7506
[S17] BUFFERED delta from S6 (total buffered=2)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=18 metric=0.3906 head_norm=1.242346
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.945904e-01
[S7] stored merged vector for next round verification (round=18)
[S7] DEBUG after merge:  round=18 metric=0.3895 head_norm=1.170209 delta_norm=0.194590
[S7] aggregate: ACCEPT kept=['S13', 'S16'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=18 metric=0.9922 head_norm=1.048268
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.415319e-01
[S8] stored merged vector for next round verification (round=18)
[S8] DEBUG after merge:  round=18 metric=0.9922 head_norm=1.075055 delta_norm=0.541532
[S8] aggregate: ACCEPT kept=['S11', 'S14'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=18 metric=0.9929 head_norm=1.454661
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.368430e-01
[S9] stored merged vector for next round verification (round=18)
[S9] DEBUG after merge:  round=18 metric=0.9925 head_norm=1.314751 delta_norm=0.336843
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=18 metric=0.3472 head_norm=1.075884
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.622765e-01
[S17] stored merged vector for next round verification (round=18)
[S17] DEBUG after merge:  round=18 metric=0.4000 head_norm=1.101559 delta_norm=0.262277
[S17] aggregate: ACCEPT kept=['S9', 'S6'] (k=2/2) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.855835 (no previous merge yet)
[S2] round=19 local utility u=0.435931 metrics={'f1_val': 0.8345944272878562, 'auprc': 0.9568378341885259, 'loss_val': 0.259213821318436, 'psi': 0.8834917900481241}-{'f1_val': 0.7118109438802538, 'auprc': 0.9200362894078671, 'loss_val': 0.2839711387166348, 'psi': 0.7951010820912991}
[S3] START round=19 head_norm_before_train=1.848325 (no previous merge yet)
[S3] round=19 local utility u=0.101637 metrics={'f1_val': 0.9881217137222198, 'auprc': 0.9984089664275021, 'loss_val': 0.07709389374524529, 'psi': 0.9922366148043327}-{'f1_val': 0.960995754132836, 'auprc': 0.9978145178989766, 'loss_val': 0.11582963900500566, 'psi': 0.9757232596392923}
[S4] START round=19 head_norm_before_train=1.846246 (no previous merge yet)
[S4] round=19 local utility u=0.010326 metrics={'f1_val': 0.9496048798352008, 'auprc': 0.9662726771289668, 'loss_val': 0.28689542002986673, 'psi': 0.9562719987527073}-{'f1_val': 0.9493562655183784, 'auprc': 0.9602334713530465, 'loss_val': 0.2879373468359325, 'psi': 0.9537071478522456}
[S5] START round=19 head_norm_before_train=1.384678 cos_to_last_merge=0.7987 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.799
[S5] round=19 local utility u=0.000000 metrics={'f1_val': 0.7007520642979546, 'auprc': 0.8930367496599313, 'loss_val': 0.37974950074950464, 'psi': 0.7776659384427452}-{'f1_val': 0.7008563225598777, 'auprc': 0.9897676707944396, 'loss_val': 0.3113923670611589, 'psi': 0.8164208618537026}
[S6] START round=19 head_norm_before_train=1.831047 (no previous merge yet)
[S6] round=19 local utility u=0.000000 metrics={'f1_val': 0.7888624078102868, 'auprc': 0.9615283396806477, 'loss_val': 0.5535677847920261, 'psi': 0.8579287805584312}-{'f1_val': 0.8375122307105185, 'auprc': 0.9630478828786799, 'loss_val': 0.39191735731721467, 'psi': 0.8877264915777832}
[S7] START round=19 head_norm_before_train=1.170209 cos_to_last_merge=1.0000 (last merge round=18)
[S7] round=19 local utility u=1.000000 metrics={'f1_val': 0.6991690804264533, 'auprc': 0.989672062967689, 'loss_val': 0.4958982408355941, 'psi': 0.8153702734429475}-{'f1_val': 0.39063144975263825, 'auprc': 0.6353293450231369, 'loss_val': 1.0725555501186468, 'psi': 0.48851060786083766}
[S8] START round=19 head_norm_before_train=1.075055 cos_to_last_merge=1.0000 (last merge round=18)
[S8] round=19 local utility u=0.000000 metrics={'f1_val': 0.9860710398489039, 'auprc': 0.981682208865716, 'loss_val': 0.2269206792020443, 'psi': 0.9843155074556287}-{'f1_val': 0.9921646161217188, 'auprc': 0.9904309550808167, 'loss_val': 0.21374155212664084, 'psi': 0.991471151705358}
[S9] START round=19 head_norm_before_train=1.314751 cos_to_last_merge=1.0000 (last merge round=18)
[S9] round=19 local utility u=0.000000 metrics={'f1_val': 0.9937490359906899, 'auprc': 0.9989325289933023, 'loss_val': 0.1374186437304708, 'psi': 0.9958224331917348}-{'f1_val': 0.9929129676379356, 'auprc': 0.9992049988689202, 'loss_val': 0.10417578136170366, 'psi': 0.9954297801303295}
[S10] START round=19 head_norm_before_train=1.926388 (no previous merge yet)
[S10] round=19 local utility u=0.000000 metrics={'f1_val': 0.9957455607450773, 'auprc': 0.9952438261121419, 'loss_val': 0.03432499102332979, 'psi': 0.9955448668919031}-{'f1_val': 0.9953063309450747, 'auprc': 0.996319755675864, 'loss_val': 0.03345664969363728, 'psi': 0.9957117008373905}
[S11] START round=19 head_norm_before_train=1.788558 (no previous merge yet)
[S11] round=19 local utility u=0.000000 metrics={'f1_val': 0.992881993202539, 'auprc': 0.9981120636913459, 'loss_val': 0.0967240008815871, 'psi': 0.9949740213980618}-{'f1_val': 0.996960829744628, 'auprc': 0.9980766328736103, 'loss_val': 0.09679408781493988, 'psi': 0.9974071509962208}
[S13] START round=19 head_norm_before_train=1.118395 cos_to_last_merge=0.9901 (last merge round=17)
[S13] round=19 local utility u=0.098392 metrics={'f1_val': 0.6194304737413874, 'auprc': 0.8272120932531893, 'loss_val': 0.654901937243724, 'psi': 0.7025431215461082}-{'f1_val': 0.6173571719392391, 'auprc': 0.7746816740557083, 'loss_val': 0.6816558261638714, 'psi': 0.6802869727858267}
[S14] START round=19 head_norm_before_train=1.949162 (no previous merge yet)
[S14] round=19 local utility u=0.014007 metrics={'f1_val': 0.9975765414632514, 'auprc': 0.9991510121119392, 'loss_val': 0.03576393826506784, 'psi': 0.9982063297227265}-{'f1_val': 0.9944935406943898, 'auprc': 0.9992323743356706, 'loss_val': 0.04552321634995002, 'psi': 0.9963890741509022}
[S15] START round=19 head_norm_before_train=1.252210 cos_to_last_merge=0.9942 (last merge round=17)
[S15] round=19 local utility u=0.000000 metrics={'f1_val': 0.7736980783985974, 'auprc': 0.9856015040999146, 'loss_val': 0.31337289276152197, 'psi': 0.8584594486791243}-{'f1_val': 0.8703976874906338, 'auprc': 0.9704902334542471, 'loss_val': 0.2699082817428542, 'psi': 0.9104347058760791}
[S16] START round=19 head_norm_before_train=1.765552 (no previous merge yet)
[S16] round=19 local utility u=0.000000 metrics={'f1_val': 0.8338347098787744, 'auprc': 0.9367494428490273, 'loss_val': 0.7565911759630332, 'psi': 0.8750006030668755}-{'f1_val': 0.8385877835730389, 'auprc': 0.942917485941964, 'loss_val': 0.6774130192481491, 'psi': 0.8803196645206088}
[S17] START round=19 head_norm_before_train=1.101559 cos_to_last_merge=1.0000 (last merge round=18)
[S17] round=19 local utility u=1.000000 metrics={'f1_val': 0.5687101415192116, 'auprc': 0.8274301169715352, 'loss_val': 0.7010176541724574, 'psi': 0.6721981317001411}-{'f1_val': 0.34718899281712756, 'auprc': 0.676763155574565, 'loss_val': 1.1717897976008456, 'psi': 0.47901865792010256}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:52809
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:52808
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:52817
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S11@127.0.0.1:52812
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1804 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1803) from S2
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.873244)
[S8] loaded HEAD from S2 (vec_in norm=1.873244)
[S8] cosine check vs S2: cos=0.2978
[S8] BUFFERED delta from S2 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1800) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.972738)
[S8] loaded HEAD from S14 (vec_in norm=1.972738)
[S8] cosine check vs S14: cos=0.7055
[S8] BUFFERED delta from S14 (total buffered=2)
[S11] RECEIVED delta(kind=head bytes=1804) from S3
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.873588)
[S11] loaded HEAD from S3 (vec_in norm=1.873588)
[S11] cosine check vs S3: cos=-0.0401
[S11] DROPPED delta from S3 (cos=-0.0401 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1801) from S7
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.184821)
[S17] loaded HEAD from S7 (vec_in norm=1.184821)
[S17] cosine check vs S7: cos=0.4397
[S17] BUFFERED delta from S7 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1797) from S13
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.194229)
[S7] loaded HEAD from S13 (vec_in norm=1.194229)
[S7] cosine check vs S13: cos=0.5357
[S7] BUFFERED delta from S13 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1804) from S4
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.857547)
[S8] loaded HEAD from S4 (vec_in norm=1.857547)
[S8] cosine check vs S4: cos=0.2453
[S8] BUFFERED delta from S4 (total buffered=3)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:52813
[S17] sending update (kind=head size=1801 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1801) from S17
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.155682)
[S13] loaded HEAD from S17 (vec_in norm=1.155682)
[S13] cosine check vs S17: cos=0.8754
[S13] BUFFERED delta from S17 (total buffered=1)
[S6] r=20 psi=0.858 u=0.0000 p_local=0.3200 f1=0.789 auprc=0.962 bytes=19807
[S8] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=19 metric=0.9861 head_norm=1.154901
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.063751e-01
[S8] stored merged vector for next round verification (round=19)
[S8] DEBUG after merge:  round=19 metric=0.9864 head_norm=1.054170 delta_norm=0.406375
[S8] aggregate: ACCEPT kept=['S2', 'S14', 'S4'] (k=3/3) mode=median trim_p=0.1
[S8] r=20 psi=0.984 u=0.0000 p_local=0.0490 f1=0.986 auprc=0.982 bytes=16190
[S15] r=20 psi=0.858 u=0.0000 p_local=0.2197 f1=0.774 auprc=0.986 bytes=17958
[S11] r=20 psi=0.995 u=0.0000 p_local=0.1366 f1=0.993 auprc=0.998 bytes=18007
[S9] r=20 psi=0.996 u=0.0000 p_local=0.1246 f1=0.994 auprc=0.999 bytes=19763
[S10] r=20 psi=0.996 u=0.0000 p_local=0.0699 f1=0.996 auprc=0.995 bytes=21604
[S5] r=20 psi=0.778 u=0.0000 p_local=0.1001 f1=0.701 auprc=0.893 bytes=21598
[S3] r=20 psi=0.992 u=0.1016 p_local=0.1896 f1=0.988 auprc=0.998 bytes=23380
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=19 metric=0.6992 head_norm=1.184821
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.731660e-01
[S7] stored merged vector for next round verification (round=19)
[S7] DEBUG after merge:  round=19 metric=0.6990 head_norm=1.042340 delta_norm=0.573166
[S7] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S7] r=20 psi=0.815 u=1.0000 p_local=0.3875 f1=0.699 auprc=0.990 bytes=17966
[S2] r=20 psi=0.883 u=0.4359 p_local=0.2298 f1=0.835 auprc=0.957 bytes=18028
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=19 metric=0.6194 head_norm=1.194229
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.938196e-01
[S13] stored merged vector for next round verification (round=19)
[S13] DEBUG after merge:  round=19 metric=0.6194 head_norm=1.137788 delta_norm=0.293820
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S13] r=20 psi=0.703 u=0.0984 p_local=0.1143 f1=0.619 auprc=0.827 bytes=17984
[S14] r=20 psi=0.998 u=0.0140 p_local=0.1080 f1=0.998 auprc=0.999 bytes=21596
[S4] r=20 psi=0.956 u=0.0103 p_local=0.0943 f1=0.950 auprc=0.966 bytes=19820
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=19 metric=0.5687 head_norm=1.155682
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.195045e-01
[S17] stored merged vector for next round verification (round=19)
[S17] DEBUG after merge:  round=19 metric=0.5672 head_norm=0.992933 delta_norm=0.619505
[S17] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S17] r=20 psi=0.672 u=1.0000 p_local=0.2763 f1=0.569 auprc=0.827 bytes=19769
[S16] r=20 psi=0.875 u=0.0000 p_local=0.1861 f1=0.834 auprc=0.937 bytes=19777
[S2] START round=20 head_norm_before_train=1.873244 (no previous merge yet)
[S2] round=20 local utility u=0.029686 metrics={'f1_val': 0.8332855810083957, 'auprc': 0.9766351126986582, 'loss_val': 0.25138070606314167, 'psi': 0.8906253936845008}-{'f1_val': 0.8345944272878562, 'auprc': 0.9568378341885259, 'loss_val': 0.259213821318436, 'psi': 0.8834917900481241}
[S3] START round=20 head_norm_before_train=1.873588 (no previous merge yet)
[S3] round=20 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.998681644275368, 'loss_val': 0.08608138768432853, 'psi': 0.9760938083734134}-{'f1_val': 0.9881217137222198, 'auprc': 0.9984089664275021, 'loss_val': 0.07709389374524529, 'psi': 0.9922366148043327}
[S4] START round=20 head_norm_before_train=1.857547 (no previous merge yet)
[S4] round=20 local utility u=0.000000 metrics={'f1_val': 0.9446679863030253, 'auprc': 0.9637484154279488, 'loss_val': 0.2915570477871059, 'psi': 0.9523001579529947}-{'f1_val': 0.9496048798352008, 'auprc': 0.9662726771289668, 'loss_val': 0.28689542002986673, 'psi': 0.9562719987527073}
[S5] START round=20 head_norm_before_train=1.410702 cos_to_last_merge=0.7916 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.792
[S5] round=20 local utility u=0.201141 metrics={'f1_val': 0.7008569501491988, 'auprc': 0.9900895133712708, 'loss_val': 0.26925421614604966, 'psi': 0.8165499754380277}-{'f1_val': 0.7007520642979546, 'auprc': 0.8930367496599313, 'loss_val': 0.37974950074950464, 'psi': 0.7776659384427452}
[S6] START round=20 head_norm_before_train=1.855942 (no previous merge yet)
[S6] round=20 local utility u=0.054417 metrics={'f1_val': 0.807734168792488, 'auprc': 0.9488897413821262, 'loss_val': 0.5200480735213346, 'psi': 0.8641963978283433}-{'f1_val': 0.7888624078102868, 'auprc': 0.9615283396806477, 'loss_val': 0.5535677847920261, 'psi': 0.8579287805584312}
[S7] START round=20 head_norm_before_train=1.042340 cos_to_last_merge=1.0000 (last merge round=19)
[S7] round=20 local utility u=0.000000 metrics={'f1_val': 0.6148586601555459, 'auprc': 0.6440503383341929, 'loss_val': 0.8335654918187333, 'psi': 0.6265353314270047}-{'f1_val': 0.6991690804264533, 'auprc': 0.989672062967689, 'loss_val': 0.4958982408355941, 'psi': 0.8153702734429475}
[S8] START round=20 head_norm_before_train=1.054170 cos_to_last_merge=1.0000 (last merge round=19)
[S8] round=20 local utility u=0.062338 metrics={'f1_val': 0.9921646161217188, 'auprc': 0.985633708521195, 'loss_val': 0.1506615062632469, 'psi': 0.9895522530815093}-{'f1_val': 0.9860710398489039, 'auprc': 0.981682208865716, 'loss_val': 0.2269206792020443, 'psi': 0.9843155074556287}
[S9] START round=20 head_norm_before_train=1.350853 cos_to_last_merge=0.9994 (last merge round=18)
[S9] round=20 local utility u=0.017172 metrics={'f1_val': 0.9937490359906899, 'auprc': 0.9994437631642978, 'loss_val': 0.10460858287367565, 'psi': 0.9960269268601329}-{'f1_val': 0.9937490359906899, 'auprc': 0.9989325289933023, 'loss_val': 0.1374186437304708, 'psi': 0.9958224331917348}
[S10] START round=20 head_norm_before_train=1.949694 (no previous merge yet)
[S10] round=20 local utility u=0.002471 metrics={'f1_val': 0.9955259082574451, 'auprc': 0.9962410527622462, 'loss_val': 0.0310560287350055, 'psi': 0.9958119660593655}-{'f1_val': 0.9957455607450773, 'auprc': 0.9952438261121419, 'loss_val': 0.03432499102332979, 'psi': 0.9955448668919031}
[S11] START round=20 head_norm_before_train=1.821352 (no previous merge yet)
[S11] round=20 local utility u=0.023068 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.997843512499814, 'loss_val': 0.07177325490915368, 'psi': 0.9970656077080793}-{'f1_val': 0.992881993202539, 'auprc': 0.9981120636913459, 'loss_val': 0.0967240008815871, 'psi': 0.9949740213980618}
[S13] START round=20 head_norm_before_train=1.137788 cos_to_last_merge=1.0000 (last merge round=19)
[S13] round=20 local utility u=0.134809 metrics={'f1_val': 0.6151333180169616, 'auprc': 0.928941461410275, 'loss_val': 0.6646897486882554, 'psi': 0.740656575374287}-{'f1_val': 0.6194304737413874, 'auprc': 0.8272120932531893, 'loss_val': 0.654901937243724, 'psi': 0.7025431215461082}
[S14] START round=20 head_norm_before_train=1.972738 (no previous merge yet)
[S14] round=20 local utility u=0.000000 metrics={'f1_val': 0.9965760575063591, 'auprc': 0.9992332355717397, 'loss_val': 0.03131463532604044, 'psi': 0.9976389287325114}-{'f1_val': 0.9975765414632514, 'auprc': 0.9991510121119392, 'loss_val': 0.03576393826506784, 'psi': 0.9982063297227265}
[S15] START round=20 head_norm_before_train=1.343832 cos_to_last_merge=0.9806 (last merge round=17)
[S15] round=20 local utility u=0.347645 metrics={'f1_val': 0.8662350373933779, 'auprc': 0.9900486293651359, 'loss_val': 0.1866469344724096, 'psi': 0.9157604741820811}-{'f1_val': 0.7736980783985974, 'auprc': 0.9856015040999146, 'loss_val': 0.31337289276152197, 'psi': 0.8584594486791243}
[S16] START round=20 head_norm_before_train=1.799522 (no previous merge yet)
[S16] round=20 local utility u=0.771652 metrics={'f1_val': 0.962983485927642, 'auprc': 0.9875019387805961, 'loss_val': 0.1404369460179714, 'psi': 0.9727908670688237}-{'f1_val': 0.8338347098787744, 'auprc': 0.9367494428490273, 'loss_val': 0.7565911759630332, 'psi': 0.8750006030668755}
[S17] START round=20 head_norm_before_train=0.992933 cos_to_last_merge=1.0000 (last merge round=19)
[S17] round=20 local utility u=0.145294 metrics={'f1_val': 0.6120660464534509, 'auprc': 0.817550336928252, 'loss_val': 0.6409266224156384, 'psi': 0.6942597626433713}-{'f1_val': 0.5687101415192116, 'auprc': 0.8274301169715352, 'loss_val': 0.7010176541724574, 'psi': 0.6721981317001411}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:52817
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S11@127.0.0.1:52812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:52814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:52810
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:52809
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.741)
[S2] not sending this round → trigger blocked (psi=0.891)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:52808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:52815
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1796) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.395102)
[S17] loaded HEAD from S9 (vec_in norm=1.395102)
[S17] cosine check vs S9: cos=0.5330
[S17] BUFFERED delta from S9 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1798) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.827012)
[S7] loaded HEAD from S16 (vec_in norm=1.827012)
[S7] cosine check vs S16: cos=0.6282
[S7] BUFFERED delta from S16 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1798) from S15
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.414675)
[S9] loaded HEAD from S15 (vec_in norm=1.414675)
[S9] cosine check vs S15: cos=0.9687
[S9] BUFFERED delta from S15 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1803) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.871772)
[S17] loaded HEAD from S6 (vec_in norm=1.871772)
[S17] cosine check vs S6: cos=0.4878
[S17] BUFFERED delta from S6 (total buffered=2)
[S11] RECEIVED delta(kind=head bytes=1803) from S5
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.430927)
[S11] loaded HEAD from S5 (vec_in norm=1.430927)
[S11] cosine check vs S5: cos=-0.0537
[S11] DROPPED delta from S5 (cos=-0.0537 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1799) from S11
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.853163)
[S8] loaded HEAD from S11 (vec_in norm=1.853163)
[S8] cosine check vs S11: cos=0.2695
[S8] BUFFERED delta from S11 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1799) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.139776)
[S15] loaded HEAD from S8 (vec_in norm=1.139776)
[S15] cosine check vs S8: cos=0.8797
[S15] BUFFERED delta from S8 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1796) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.967317)
[S14] loaded HEAD from S10 (vec_in norm=1.967317)
[S14] cosine check vs S10: cos=-0.0447
[S14] DROPPED delta from S10 (cos=-0.0447 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.694)
[S3] ⇄ pheromone p=0.152 → S11@127.0.0.1:52812
[S2] ⇄ pheromone p=0.190 → S8@127.0.0.1:52809
[S14] ⇄ pheromone p=0.086 → S8@127.0.0.1:52809
[S4] ⇄ pheromone p=0.075 → S8@127.0.0.1:52809
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=20 metric=0.6149 head_norm=1.059401
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.121575e-01
[S7] stored merged vector for next round verification (round=20)
[S7] DEBUG after merge:  round=20 metric=0.6300 head_norm=1.312625 delta_norm=0.712158
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.310 → S17@127.0.0.1:52817
[S13] ⇄ pheromone p=0.118 → S7@127.0.0.1:52808
[S5] ⇄ pheromone p=0.120 → S11@127.0.0.1:52812
[S10] ⇄ pheromone p=0.056 → S14@127.0.0.1:52814
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=20 metric=0.9937 head_norm=1.395102
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.761489e-01
[S9] stored merged vector for next round verification (round=20)
[S9] DEBUG after merge:  round=20 metric=0.9933 head_norm=1.393836 delta_norm=0.176149
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.103 → S17@127.0.0.1:52817
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=20 metric=0.8662 head_norm=1.414675
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.404092e-01
[S15] stored merged vector for next round verification (round=20)
[S15] DEBUG after merge:  round=20 metric=0.9062 head_norm=1.238676 delta_norm=0.340409
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.245 → S9@127.0.0.1:52810
[S16] ⇄ pheromone p=0.303 → S7@127.0.0.1:52808
[S11] ⇄ pheromone p=0.114 → S8@127.0.0.1:52809
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=20 metric=0.9922 head_norm=1.139776
[S8] _apply_head_vector_avg (torch): Δ‖w‖=9.480060e-01
[S8] stored merged vector for next round verification (round=20)
[S8] DEBUG after merge:  round=20 metric=0.9922 head_norm=1.211584 delta_norm=0.948006
[S8] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.052 → S15@127.0.0.1:52815
[S6] ⇄ pheromone p=0.267 → S17@127.0.0.1:52817
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=20 metric=0.6121 head_norm=1.059816
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.440562e-01
[S17] stored merged vector for next round verification (round=20)
[S17] DEBUG after merge:  round=20 metric=0.6625 head_norm=1.036874 delta_norm=0.444056
[S17] aggregate: ACCEPT kept=['S9', 'S6'] (k=2/2) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.250 → S13@127.0.0.1:52813
[S2] START round=21 head_norm_before_train=1.891141 (no previous merge yet)
[S2] round=21 local utility u=0.024777 metrics={'f1_val': 0.8487805427572485, 'auprc': 0.9681720860721792, 'loss_val': 0.2694067850277587, 'psi': 0.8965371600832208}-{'f1_val': 0.8332855810083957, 'auprc': 0.9766351126986582, 'loss_val': 0.25138070606314167, 'psi': 0.8906253936845008}
[S3] START round=21 head_norm_before_train=1.900573 (no previous merge yet)
[S3] round=21 local utility u=0.125587 metrics={'f1_val': 0.9969520501205896, 'auprc': 0.9986878132697512, 'loss_val': 0.050426488808551086, 'psi': 0.9976463553802543}-{'f1_val': 0.9610352511054436, 'auprc': 0.998681644275368, 'loss_val': 0.08608138768432853, 'psi': 0.9760938083734134}
[S4] START round=21 head_norm_before_train=1.870710 (no previous merge yet)
[S4] round=21 local utility u=0.046834 metrics={'f1_val': 0.9514235024256026, 'auprc': 0.9773988840400492, 'loss_val': 0.2793738811108187, 'psi': 0.9618136550713812}-{'f1_val': 0.9446679863030253, 'auprc': 0.9637484154279488, 'loss_val': 0.2915570477871059, 'psi': 0.9523001579529947}
[S5] START round=21 head_norm_before_train=1.430927 cos_to_last_merge=0.7870 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.787
[S5] round=21 local utility u=0.000000 metrics={'f1_val': 0.6645114365876748, 'auprc': 0.9234416060932955, 'loss_val': 0.38438466626315126, 'psi': 0.768083504389923}-{'f1_val': 0.7008569501491988, 'auprc': 0.9900895133712708, 'loss_val': 0.26925421614604966, 'psi': 0.8165499754380277}
[S6] START round=21 head_norm_before_train=1.871772 (no previous merge yet)
[S6] round=21 local utility u=0.061343 metrics={'f1_val': 0.8216938985677555, 'auprc': 0.9499160152911426, 'loss_val': 0.48419851499844563, 'psi': 0.8729827452571104}-{'f1_val': 0.807734168792488, 'auprc': 0.9488897413821262, 'loss_val': 0.5200480735213346, 'psi': 0.8641963978283433}
[S7] START round=21 head_norm_before_train=1.312625 cos_to_last_merge=1.0000 (last merge round=20)
[S7] round=21 local utility u=0.316167 metrics={'f1_val': 0.619034232284826, 'auprc': 0.7901833013170528, 'loss_val': 0.6646833606637642, 'psi': 0.6874938598977167}-{'f1_val': 0.6148586601555459, 'auprc': 0.6440503383341929, 'loss_val': 0.8335654918187333, 'psi': 0.6265353314270047}
[S8] START round=21 head_norm_before_train=1.211584 cos_to_last_merge=1.0000 (last merge round=20)
[S8] round=21 local utility u=0.000000 metrics={'f1_val': 0.9889241575992487, 'auprc': 0.9836036655735407, 'loss_val': 0.283411336423207, 'psi': 0.9867959607889655}-{'f1_val': 0.9921646161217188, 'auprc': 0.985633708521195, 'loss_val': 0.1506615062632469, 'psi': 0.9895522530815093}
[S9] START round=21 head_norm_before_train=1.393836 cos_to_last_merge=1.0000 (last merge round=20)
[S9] round=21 local utility u=0.007543 metrics={'f1_val': 0.9954200568282393, 'auprc': 0.9992157745339592, 'loss_val': 0.09886558602836594, 'psi': 0.9969383439105273}-{'f1_val': 0.9937490359906899, 'auprc': 0.9994437631642978, 'loss_val': 0.10460858287367565, 'psi': 0.9960269268601329}
[S10] START round=21 head_norm_before_train=1.967317 (no previous merge yet)
[S10] round=21 local utility u=0.000000 metrics={'f1_val': 0.9955259082574451, 'auprc': 0.9960623306529549, 'loss_val': 0.03064966637403514, 'psi': 0.9957404772156491}-{'f1_val': 0.9955259082574451, 'auprc': 0.9962410527622462, 'loss_val': 0.0310560287350055, 'psi': 0.9958119660593655}
[S11] START round=21 head_norm_before_train=1.853163 (no previous merge yet)
[S11] round=21 local utility u=0.005775 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9977296484208842, 'loss_val': 0.06000498897233294, 'psi': 0.9970323417520819}-{'f1_val': 0.9965470045135896, 'auprc': 0.997843512499814, 'loss_val': 0.07177325490915368, 'psi': 0.9970656077080793}
[S13] START round=21 head_norm_before_train=1.200385 cos_to_last_merge=0.9959 (last merge round=19)
[S13] round=21 local utility u=0.000000 metrics={'f1_val': 0.578019458199009, 'auprc': 0.8717013844528385, 'loss_val': 0.800657100845526, 'psi': 0.6954922287005408}-{'f1_val': 0.6151333180169616, 'auprc': 0.928941461410275, 'loss_val': 0.6646897486882554, 'psi': 0.740656575374287}
[S14] START round=21 head_norm_before_train=1.995174 (no previous merge yet)
[S14] round=21 local utility u=0.008329 metrics={'f1_val': 0.9980646079025537, 'auprc': 0.9992345244693275, 'loss_val': 0.02359217195312448, 'psi': 0.9985325745292633}-{'f1_val': 0.9965760575063591, 'auprc': 0.9992332355717397, 'loss_val': 0.03131463532604044, 'psi': 0.9976389287325114}
[S15] START round=21 head_norm_before_train=1.238676 cos_to_last_merge=1.0000 (last merge round=20)
[S15] round=21 local utility u=0.000000 metrics={'f1_val': 0.6991401601282092, 'auprc': 0.9853538747158045, 'loss_val': 0.4087782531837809, 'psi': 0.8136256459632474}-{'f1_val': 0.8662350373933779, 'auprc': 0.9900486293651359, 'loss_val': 0.1866469344724096, 'psi': 0.9157604741820811}
[S16] START round=21 head_norm_before_train=1.827012 (no previous merge yet)
[S16] round=21 local utility u=0.000000 metrics={'f1_val': 0.936139276651906, 'auprc': 0.9913305016657042, 'loss_val': 0.23729147798199307, 'psi': 0.9582157666574252}-{'f1_val': 0.962983485927642, 'auprc': 0.9875019387805961, 'loss_val': 0.1404369460179714, 'psi': 0.9727908670688237}
[S17] START round=21 head_norm_before_train=1.036874 cos_to_last_merge=1.0000 (last merge round=20)
[S17] round=21 local utility u=0.315864 metrics={'f1_val': 0.7509133315307286, 'auprc': 0.7682933748644879, 'loss_val': 0.6945117545367357, 'psi': 0.7578653488642323}-{'f1_val': 0.6120660464534509, 'auprc': 0.817550336928252, 'loss_val': 0.6409266224156384, 'psi': 0.6942597626433713}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S11@127.0.0.1:52812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:52817
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:52809
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:52809
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:52817
[S14] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1794 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S11
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.884792)
[S8] loaded HEAD from S11 (vec_in norm=1.884792)
[S8] cosine check vs S11: cos=0.8511
[S8] BUFFERED delta from S11 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1800) from S7
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.334318)
[S17] loaded HEAD from S7 (vec_in norm=1.334318)
[S17] cosine check vs S7: cos=0.5204
[S17] BUFFERED delta from S7 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1794) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.437374)
[S17] loaded HEAD from S9 (vec_in norm=1.437374)
[S17] cosine check vs S9: cos=0.6182
[S17] BUFFERED delta from S9 (total buffered=2)
[S8] RECEIVED delta(kind=head bytes=1799) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=2.013335)
[S8] loaded HEAD from S14 (vec_in norm=2.013335)
[S8] cosine check vs S14: cos=0.3970
[S8] BUFFERED delta from S14 (total buffered=2)
[S8] RECEIVED delta(kind=head bytes=1802) from S2
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.909625)
[S8] loaded HEAD from S2 (vec_in norm=1.909625)
[S8] cosine check vs S2: cos=0.2444
[S8] BUFFERED delta from S2 (total buffered=3)
[S8] RECEIVED delta(kind=head bytes=1804) from S4
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.875067)
[S8] loaded HEAD from S4 (vec_in norm=1.875067)
[S8] cosine check vs S4: cos=0.1468
[S8] BUFFERED delta from S4 (total buffered=4)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:52813
[S17] sending update (kind=head size=1800 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1800) from S17
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.103021)
[S13] loaded HEAD from S17 (vec_in norm=1.103021)
[S13] cosine check vs S17: cos=0.9331
[S13] BUFFERED delta from S17 (total buffered=1)
[S3] sending update (kind=head size=1803 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1803) from S3
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.926012)
[S11] loaded HEAD from S3 (vec_in norm=1.926012)
[S11] cosine check vs S3: cos=-0.0385
[S11] DROPPED delta from S3 (cos=-0.0385 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S6] → sending delta(kind=head bytes=1807) to S17@127.0.0.1:52817
[S6] sending update (kind=head size=1807 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1807) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.884283)
[S17] loaded HEAD from S6 (vec_in norm=1.884283)
[S17] cosine check vs S6: cos=0.6932
[S17] BUFFERED delta from S6 (total buffered=3)
[S8] aggregate: batch=4 kept=4 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=21 metric=0.9889 head_norm=1.263222
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.552109e-01
[S8] stored merged vector for next round verification (round=21)
[S8] DEBUG after merge:  round=21 metric=0.9889 head_norm=1.062513 delta_norm=0.355211
[S8] aggregate: ACCEPT kept=['S11', 'S14', 'S2', 'S4'] (k=4/4) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=21 metric=0.5780 head_norm=1.259278
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.292468e-01
[S13] stored merged vector for next round verification (round=21)
[S13] DEBUG after merge:  round=21 metric=0.5780 head_norm=1.161320 delta_norm=0.229247
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=21 metric=0.7509 head_norm=1.103021
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.094151e-01
[S17] stored merged vector for next round verification (round=21)
[S17] DEBUG after merge:  round=21 metric=0.6729 head_norm=1.020864 delta_norm=0.209415
[S17] aggregate: ROLLBACK (f1_val pre=0.751 post=0.673 tol_abs=0.005 tol_rel=0.0)
[S2] START round=22 head_norm_before_train=1.909625 (no previous merge yet)
[S2] round=22 local utility u=0.162093 metrics={'f1_val': 0.9048111904340314, 'auprc': 0.9632985675109551, 'loss_val': 0.26678353630784357, 'psi': 0.9282061412648008}-{'f1_val': 0.8487805427572485, 'auprc': 0.9681720860721792, 'loss_val': 0.2694067850277587, 'psi': 0.8965371600832208}
[S3] START round=22 head_norm_before_train=1.926012 (no previous merge yet)
[S3] round=22 local utility u=0.001373 metrics={'f1_val': 0.9965365984006044, 'auprc': 0.9986875833094595, 'loss_val': 0.0451876571434186, 'psi': 0.9973969923641464}-{'f1_val': 0.9969520501205896, 'auprc': 0.9986878132697512, 'loss_val': 0.050426488808551086, 'psi': 0.9976463553802543}
[S4] START round=22 head_norm_before_train=1.875067 (no previous merge yet)
[S4] round=22 local utility u=0.000000 metrics={'f1_val': 0.9529455162700969, 'auprc': 0.9533541260328484, 'loss_val': 0.2832443503625059, 'psi': 0.9531089601751975}-{'f1_val': 0.9514235024256026, 'auprc': 0.9773988840400492, 'loss_val': 0.2793738811108187, 'psi': 0.9618136550713812}
[S5] START round=22 head_norm_before_train=1.446036 cos_to_last_merge=0.7836 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.784
[S5] round=22 local utility u=0.288628 metrics={'f1_val': 0.7011046720655897, 'auprc': 0.9925185811742911, 'loss_val': 0.23391802002120157, 'psi': 0.8176702357090703}-{'f1_val': 0.6645114365876748, 'auprc': 0.9234416060932955, 'loss_val': 0.38438466626315126, 'psi': 0.768083504389923}
[S6] START round=22 head_norm_before_train=1.884283 (no previous merge yet)
[S6] round=22 local utility u=0.000000 metrics={'f1_val': 0.6960344763695532, 'auprc': 0.9507309776710261, 'loss_val': 0.811124636507858, 'psi': 0.7979130768901423}-{'f1_val': 0.8216938985677555, 'auprc': 0.9499160152911426, 'loss_val': 0.48419851499844563, 'psi': 0.8729827452571104}
[S7] START round=22 head_norm_before_train=1.334318 cos_to_last_merge=0.9995 (last merge round=20)
[S7] round=22 local utility u=0.527978 metrics={'f1_val': 0.6879393067693418, 'auprc': 0.9308156018628815, 'loss_val': 0.4440548316847147, 'psi': 0.7850898248067577}-{'f1_val': 0.619034232284826, 'auprc': 0.7901833013170528, 'loss_val': 0.6646833606637642, 'psi': 0.6874938598977167}
[S8] START round=22 head_norm_before_train=1.062513 cos_to_last_merge=1.0000 (last merge round=21)
[S8] round=22 local utility u=0.080062 metrics={'f1_val': 0.9918431215757397, 'auprc': 0.9928407308754625, 'loss_val': 0.16851290826702736, 'psi': 0.9922421652956288}-{'f1_val': 0.9889241575992487, 'auprc': 0.9836036655735407, 'loss_val': 0.283411336423207, 'psi': 0.9867959607889655}
[S9] START round=22 head_norm_before_train=1.437374 cos_to_last_merge=0.9992 (last merge round=20)
[S9] round=22 local utility u=0.000000 metrics={'f1_val': 0.9909624519078992, 'auprc': 0.9987619727065373, 'loss_val': 0.08458822608078609, 'psi': 0.9940822602273545}-{'f1_val': 0.9954200568282393, 'auprc': 0.9992157745339592, 'loss_val': 0.09886558602836594, 'psi': 0.9969383439105273}
[S10] START round=22 head_norm_before_train=1.984653 (no previous merge yet)
[S10] round=22 local utility u=0.000502 metrics={'f1_val': 0.9955259082574451, 'auprc': 0.996106742554887, 'loss_val': 0.02977882814964899, 'psi': 0.9957582419764218}-{'f1_val': 0.9955259082574451, 'auprc': 0.9960623306529549, 'loss_val': 0.03064966637403514, 'psi': 0.9957404772156491}
[S11] START round=22 head_norm_before_train=1.884792 (no previous merge yet)
[S11] round=22 local utility u=0.000000 metrics={'f1_val': 0.9872530217409786, 'auprc': 0.9977863225532752, 'loss_val': 0.08224217294039418, 'psi': 0.9914663420658972}-{'f1_val': 0.996567470639547, 'auprc': 0.9977296484208842, 'loss_val': 0.06000498897233294, 'psi': 0.9970323417520819}
[S13] START round=22 head_norm_before_train=1.161320 cos_to_last_merge=1.0000 (last merge round=21)
[S13] round=22 local utility u=0.277337 metrics={'f1_val': 0.6178421295324974, 'auprc': 0.9213118095627519, 'loss_val': 0.6337497471629169, 'psi': 0.7392300015445992}-{'f1_val': 0.578019458199009, 'auprc': 0.8717013844528385, 'loss_val': 0.800657100845526, 'psi': 0.6954922287005408}
[S14] START round=22 head_norm_before_train=2.013335 (no previous merge yet)
[S14] round=22 local utility u=0.000000 metrics={'f1_val': 0.9978217593544257, 'auprc': 0.9991508317773292, 'loss_val': 0.023759180272395652, 'psi': 0.9983533883235871}-{'f1_val': 0.9980646079025537, 'auprc': 0.9992345244693275, 'loss_val': 0.02359217195312448, 'psi': 0.9985325745292633}
[S15] START round=22 head_norm_before_train=1.290902 cos_to_last_merge=0.9985 (last merge round=20)
[S15] round=22 local utility u=0.189566 metrics={'f1_val': 0.7620387905718613, 'auprc': 0.974033136229904, 'loss_val': 0.37307502486588057, 'psi': 0.8468365288350783}-{'f1_val': 0.6991401601282092, 'auprc': 0.9853538747158045, 'loss_val': 0.4087782531837809, 'psi': 0.8136256459632474}
[S16] START round=22 head_norm_before_train=1.854335 (no previous merge yet)
[S16] round=22 local utility u=0.000000 metrics={'f1_val': 0.9223810640032729, 'auprc': 0.9914505457486013, 'loss_val': 0.32951608036779906, 'psi': 0.9500088567014042}-{'f1_val': 0.936139276651906, 'auprc': 0.9913305016657042, 'loss_val': 0.23729147798199307, 'psi': 0.9582157666574252}
[S17] START round=22 head_norm_before_train=1.020864 cos_to_last_merge=1.0000 (last merge round=21)
[S17] round=22 local utility u=0.000000 metrics={'f1_val': 0.6653705322431335, 'auprc': 0.7977281978472872, 'loss_val': 0.719422375279202, 'psi': 0.718313598484795}-{'f1_val': 0.7509133315307286, 'auprc': 0.7682933748644879, 'loss_val': 0.6945117545367357, 'psi': 0.7578653488642323}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:52814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:52817
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:52815
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] → sending delta(kind=head bytes=1806) to S7@127.0.0.1:52808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:52810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:52812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:52812
[S8] sending update (kind=head size=1795 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S13] sending update (kind=head size=1806 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1803) from S7
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.352665)
[S17] loaded HEAD from S7 (vec_in norm=1.352665)
[S17] cosine check vs S7: cos=0.6151
[S17] BUFFERED delta from S7 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1803) from S15
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.345246)
[S9] loaded HEAD from S15 (vec_in norm=1.345246)
[S9] cosine check vs S15: cos=0.9686
[S9] BUFFERED delta from S15 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1806) from S13
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.214300)
[S7] loaded HEAD from S13 (vec_in norm=1.214300)
[S7] cosine check vs S13: cos=0.4795
[S7] BUFFERED delta from S13 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1798) from S3
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.949763)
[S11] loaded HEAD from S3 (vec_in norm=1.949763)
[S11] cosine check vs S3: cos=-0.0381
[S11] DROPPED delta from S3 (cos=-0.0381 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1799) from S5
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.463550)
[S11] loaded HEAD from S5 (vec_in norm=1.463550)
[S11] cosine check vs S5: cos=-0.0487
[S11] DROPPED delta from S5 (cos=-0.0487 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1803) from S2
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.930121)
[S8] loaded HEAD from S2 (vec_in norm=1.930121)
[S8] cosine check vs S2: cos=0.3746
[S8] BUFFERED delta from S2 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1797) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=2.002277)
[S14] loaded HEAD from S10 (vec_in norm=2.002277)
[S14] cosine check vs S10: cos=-0.0455
[S14] DROPPED delta from S10 (cos=-0.0455 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1795) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.158003)
[S15] loaded HEAD from S8 (vec_in norm=1.158003)
[S15] cosine check vs S8: cos=0.7753
[S15] BUFFERED delta from S8 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=22 metric=0.9910 head_norm=1.478089
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.886898e-01
[S9] stored merged vector for next round verification (round=22)
[S9] DEBUG after merge:  round=22 metric=0.9910 head_norm=1.400576 delta_norm=0.188690
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=22 metric=0.6879 head_norm=1.352665
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.574421e-01
[S7] stored merged vector for next round verification (round=22)
[S7] DEBUG after merge:  round=22 metric=0.6811 head_norm=1.104483 delta_norm=0.657442
[S7] aggregate: ROLLBACK (f1_val pre=0.688 post=0.681 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=22 metric=0.9918 head_norm=1.158003
[S8] _apply_head_vector_avg (torch): Δ‖w‖=9.208707e-01
[S8] stored merged vector for next round verification (round=22)
[S8] DEBUG after merge:  round=22 metric=0.9915 head_norm=1.298139 delta_norm=0.920871
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=22 metric=0.7620 head_norm=1.345246
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.286736e-01
[S15] stored merged vector for next round verification (round=22)
[S15] DEBUG after merge:  round=22 metric=0.7648 head_norm=1.179647 delta_norm=0.428674
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=22 metric=0.6654 head_norm=1.087721
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.483464e-01
[S17] stored merged vector for next round verification (round=22)
[S17] DEBUG after merge:  round=22 metric=0.5759 head_norm=1.098060 delta_norm=0.548346
[S17] aggregate: ROLLBACK (f1_val pre=0.665 post=0.576 tol_abs=0.005 tol_rel=0.0)
[S2] START round=23 head_norm_before_train=1.930121 (no previous merge yet)
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.830419645347312, 'auprc': 0.9314797136415784, 'loss_val': 0.3258240329340965, 'psi': 0.8708436726650186}-{'f1_val': 0.9048111904340314, 'auprc': 0.9632985675109551, 'loss_val': 0.26678353630784357, 'psi': 0.9282061412648008}
[S3] START round=23 head_norm_before_train=1.949763 (no previous merge yet)
[S3] round=23 local utility u=0.000000 metrics={'f1_val': 0.9724182866364195, 'auprc': 0.9985645629035125, 'loss_val': 0.06505595684097423, 'psi': 0.9828767971432567}-{'f1_val': 0.9965365984006044, 'auprc': 0.9986875833094595, 'loss_val': 0.0451876571434186, 'psi': 0.9973969923641464}
[S4] START round=23 head_norm_before_train=1.881709 (no previous merge yet)
[S4] round=23 local utility u=0.000000 metrics={'f1_val': 0.9452413817825991, 'auprc': 0.9608266702595487, 'loss_val': 0.2972940111492073, 'psi': 0.951475497173379}-{'f1_val': 0.9529455162700969, 'auprc': 0.9533541260328484, 'loss_val': 0.2832443503625059, 'psi': 0.9531089601751975}
[S5] START round=23 head_norm_before_train=1.463550 cos_to_last_merge=0.7804 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.780
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.42934856836500257, 'auprc': 0.8547778067601496, 'loss_val': 0.8017284209511988, 'psi': 0.5995202637230614}-{'f1_val': 0.7011046720655897, 'auprc': 0.9925185811742911, 'loss_val': 0.23391802002120157, 'psi': 0.8176702357090703}
[S6] START round=23 head_norm_before_train=1.900640 (no previous merge yet)
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.6183246338544927, 'auprc': 0.82291118740247, 'loss_val': 0.8666936724401386, 'psi': 0.7001592552736836}-{'f1_val': 0.6960344763695532, 'auprc': 0.9507309776710261, 'loss_val': 0.811124636507858, 'psi': 0.7979130768901423}
[S7] START round=23 head_norm_before_train=1.104483 cos_to_last_merge=1.0000 (last merge round=22)
[S7] round=23 local utility u=0.000000 metrics={'f1_val': 0.6499323825052037, 'auprc': 0.826347278807085, 'loss_val': 0.6497408447091135, 'psi': 0.7204983410259562}-{'f1_val': 0.6879393067693418, 'auprc': 0.9308156018628815, 'loss_val': 0.4440548316847147, 'psi': 0.7850898248067577}
[S8] START round=23 head_norm_before_train=1.298139 cos_to_last_merge=1.0000 (last merge round=22)
[S8] round=23 local utility u=0.000000 metrics={'f1_val': 0.9859044523533361, 'auprc': 0.9799624903397757, 'loss_val': 0.22018440316864368, 'psi': 0.983527667547912}-{'f1_val': 0.9918431215757397, 'auprc': 0.9928407308754625, 'loss_val': 0.16851290826702736, 'psi': 0.9922421652956288}
[S9] START round=23 head_norm_before_train=1.400576 cos_to_last_merge=1.0000 (last merge round=22)
[S9] round=23 local utility u=0.000000 metrics={'f1_val': 0.9892304409695105, 'auprc': 0.9971644825657421, 'loss_val': 0.10111681578778564, 'psi': 0.9924040576080032}-{'f1_val': 0.9909624519078992, 'auprc': 0.9987619727065373, 'loss_val': 0.08458822608078609, 'psi': 0.9940822602273545}
[S10] START round=23 head_norm_before_train=2.002277 (no previous merge yet)
[S10] round=23 local utility u=0.000000 metrics={'f1_val': 0.9953063309450747, 'auprc': 0.9960995547174972, 'loss_val': 0.029188161128332748, 'psi': 0.9956236204540437}-{'f1_val': 0.9955259082574451, 'auprc': 0.996106742554887, 'loss_val': 0.02977882814964899, 'psi': 0.9957582419764218}
[S11] START round=23 head_norm_before_train=1.915373 (no previous merge yet)
[S11] round=23 local utility u=0.046158 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9976205858352905, 'loss_val': 0.043742460003119155, 'psi': 0.9968313348154327}-{'f1_val': 0.9872530217409786, 'auprc': 0.9977863225532752, 'loss_val': 0.08224217294039418, 'psi': 0.9914663420658972}
[S13] START round=23 head_norm_before_train=1.214300 cos_to_last_merge=0.9980 (last merge round=21)
[S13] round=23 local utility u=0.018660 metrics={'f1_val': 0.617033648606481, 'auprc': 0.9314557400145554, 'loss_val': 0.6220115619776276, 'psi': 0.7428024851697108}-{'f1_val': 0.6178421295324974, 'auprc': 0.9213118095627519, 'loss_val': 0.6337497471629169, 'psi': 0.7392300015445992}
[S14] START round=23 head_norm_before_train=2.030688 (no previous merge yet)
[S14] round=23 local utility u=0.001837 metrics={'f1_val': 0.9982330107938716, 'auprc': 0.9992318822824783, 'loss_val': 0.022795835403903723, 'psi': 0.9986325593893143}-{'f1_val': 0.9978217593544257, 'auprc': 0.9991508317773292, 'loss_val': 0.023759180272395652, 'psi': 0.9983533883235871}
[S15] START round=23 head_norm_before_train=1.179647 cos_to_last_merge=1.0000 (last merge round=22)
[S15] round=23 local utility u=0.205804 metrics={'f1_val': 0.8088510392202151, 'auprc': 0.9871554857789546, 'loss_val': 0.281707435654904, 'psi': 0.8801728178437109}-{'f1_val': 0.7620387905718613, 'auprc': 0.974033136229904, 'loss_val': 0.37307502486588057, 'psi': 0.8468365288350783}
[S16] START round=23 head_norm_before_train=1.879739 (no previous merge yet)
[S16] round=23 local utility u=0.000000 metrics={'f1_val': 0.9050360982203804, 'auprc': 0.9906098400732589, 'loss_val': 0.4066478968962459, 'psi': 0.9392655949615318}-{'f1_val': 0.9223810640032729, 'auprc': 0.9914505457486013, 'loss_val': 0.32951608036779906, 'psi': 0.9500088567014042}
[S17] START round=23 head_norm_before_train=1.098060 cos_to_last_merge=1.0000 (last merge round=22)
[S17] round=23 local utility u=0.402900 metrics={'f1_val': 0.713329750904216, 'auprc': 0.9365711378348116, 'loss_val': 0.6179064177767295, 'psi': 0.8026263056764542}-{'f1_val': 0.6653705322431335, 'auprc': 0.7977281978472872, 'loss_val': 0.719422375279202, 'psi': 0.718313598484795}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:52808
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:52810
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:52809
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:52813
[S13] sending update (kind=head size=1803 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1803) from S13
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.254924)
[S7] loaded HEAD from S13 (vec_in norm=1.254924)
[S7] cosine check vs S13: cos=0.8305
[S7] BUFFERED delta from S13 (total buffered=1)
[S15] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S17] sending update (kind=head size=1797 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S11
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.944047)
[S8] loaded HEAD from S11 (vec_in norm=1.944047)
[S8] cosine check vs S11: cos=0.3280
[S8] BUFFERED delta from S11 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1799) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=2.047707)
[S8] loaded HEAD from S14 (vec_in norm=2.047707)
[S8] cosine check vs S14: cos=0.3065
[S8] BUFFERED delta from S14 (total buffered=2)
[S13] RECEIVED delta(kind=head bytes=1797) from S17
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.157610)
[S13] loaded HEAD from S17 (vec_in norm=1.157610)
[S13] cosine check vs S17: cos=0.7788
[S13] BUFFERED delta from S17 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1800) from S15
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.249416)
[S9] loaded HEAD from S15 (vec_in norm=1.249416)
[S9] cosine check vs S15: cos=0.9390
[S9] BUFFERED delta from S15 (total buffered=1)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=23 metric=0.6499 head_norm=1.125379
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.519374e-01
[S7] stored merged vector for next round verification (round=23)
[S7] DEBUG after merge:  round=23 metric=0.6376 head_norm=1.138770 delta_norm=0.351937
[S7] aggregate: ROLLBACK (f1_val pre=0.650 post=0.638 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=23 metric=0.9892 head_norm=1.439961
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.528941e-01
[S9] stored merged vector for next round verification (round=23)
[S9] DEBUG after merge:  round=23 metric=0.9892 head_norm=1.324125 delta_norm=0.252894
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=23 metric=0.9859 head_norm=1.371298
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.439488e-01
[S8] stored merged vector for next round verification (round=23)
[S8] DEBUG after merge:  round=23 metric=0.9920 head_norm=1.192074 delta_norm=0.743949
[S8] aggregate: ACCEPT kept=['S11', 'S14'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=23 metric=0.6170 head_norm=1.254924
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.037685e-01
[S13] stored merged vector for next round verification (round=23)
[S13] DEBUG after merge:  round=23 metric=0.6172 head_norm=1.137725 delta_norm=0.403769
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.948678 (no previous merge yet)
[S2] round=24 local utility u=0.327148 metrics={'f1_val': 0.9110665490778723, 'auprc': 0.9702887030037798, 'loss_val': 0.27183738704639543, 'psi': 0.9347554106482353}-{'f1_val': 0.830419645347312, 'auprc': 0.9314797136415784, 'loss_val': 0.3258240329340965, 'psi': 0.8708436726650186}
[S3] START round=24 head_norm_before_train=1.971400 (no previous merge yet)
[S3] round=24 local utility u=0.032478 metrics={'f1_val': 0.9817042559657083, 'auprc': 0.9986811564246942, 'loss_val': 0.05616522721975972, 'psi': 0.9884950161493027}-{'f1_val': 0.9724182866364195, 'auprc': 0.9985645629035125, 'loss_val': 0.06505595684097423, 'psi': 0.9828767971432567}
[S4] START round=24 head_norm_before_train=1.894343 (no previous merge yet)
[S4] round=24 local utility u=0.030088 metrics={'f1_val': 0.9481495654309733, 'auprc': 0.9745932198566338, 'loss_val': 0.2958671707535441, 'psi': 0.9587270272012376}-{'f1_val': 0.9452413817825991, 'auprc': 0.9608266702595487, 'loss_val': 0.2972940111492073, 'psi': 0.951475497173379}
[S5] START round=24 head_norm_before_train=1.482398 cos_to_last_merge=0.7774 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.777
[S5] round=24 local utility u=1.000000 metrics={'f1_val': 0.7009432789550658, 'auprc': 0.9899353392418687, 'loss_val': 0.22553714682780188, 'psi': 0.816540103069787}-{'f1_val': 0.42934856836500257, 'auprc': 0.8547778067601496, 'loss_val': 0.8017284209511988, 'psi': 0.5995202637230614}
[S6] START round=24 head_norm_before_train=1.917138 (no previous merge yet)
[S6] round=24 local utility u=1.000000 metrics={'f1_val': 0.8418430161003996, 'auprc': 0.9314943671878712, 'loss_val': 0.37700972920689735, 'psi': 0.8777035565353882}-{'f1_val': 0.6183246338544927, 'auprc': 0.82291118740247, 'loss_val': 0.8666936724401386, 'psi': 0.7001592552736836}
[S7] START round=24 head_norm_before_train=1.138770 cos_to_last_merge=1.0000 (last merge round=23)
[S7] round=24 local utility u=0.000000 metrics={'f1_val': 0.5630239389640264, 'auprc': 0.779819135326808, 'loss_val': 0.8904159601755011, 'psi': 0.6497420175091391}-{'f1_val': 0.6499323825052037, 'auprc': 0.826347278807085, 'loss_val': 0.6497408447091135, 'psi': 0.7204983410259562}
[S8] START round=24 head_norm_before_train=1.192074 cos_to_last_merge=1.0000 (last merge round=23)
[S8] round=24 local utility u=0.072459 metrics={'f1_val': 0.9925712794554754, 'auprc': 0.9925181057073533, 'loss_val': 0.15293421759732637, 'psi': 0.9925500099562266}-{'f1_val': 0.9859044523533361, 'auprc': 0.9799624903397757, 'loss_val': 0.22018440316864368, 'psi': 0.983527667547912}
[S9] START round=24 head_norm_before_train=1.324125 cos_to_last_merge=1.0000 (last merge round=23)
[S9] round=24 local utility u=0.016966 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9943958750874162, 'loss_val': 0.10345894422071933, 'psi': 0.9957546571233014}-{'f1_val': 0.9892304409695105, 'auprc': 0.9971644825657421, 'loss_val': 0.10111681578778564, 'psi': 0.9924040576080032}
[S10] START round=24 head_norm_before_train=2.014253 (no previous merge yet)
[S10] round=24 local utility u=0.000495 metrics={'f1_val': 0.9955259082574451, 'auprc': 0.9958444751542023, 'loss_val': 0.028751224992044272, 'psi': 0.995653335016148}-{'f1_val': 0.9953063309450747, 'auprc': 0.9960995547174972, 'loss_val': 0.029188161128332748, 'psi': 0.9956236204540437}
[S11] START round=24 head_norm_before_train=1.944047 (no previous merge yet)
[S11] round=24 local utility u=0.000000 metrics={'f1_val': 0.9539185820766515, 'auprc': 0.9976795129799283, 'loss_val': 0.14130427950285773, 'psi': 0.9714229544379622}-{'f1_val': 0.996305167468861, 'auprc': 0.9976205858352905, 'loss_val': 0.043742460003119155, 'psi': 0.9968313348154327}
[S13] START round=24 head_norm_before_train=1.137725 cos_to_last_merge=1.0000 (last merge round=23)
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.6003078114437014, 'auprc': 0.8972094154876259, 'loss_val': 0.6882413191982333, 'psi': 0.7190684530612712}-{'f1_val': 0.617033648606481, 'auprc': 0.9314557400145554, 'loss_val': 0.6220115619776276, 'psi': 0.7428024851697108}
[S14] START round=24 head_norm_before_train=2.047707 (no previous merge yet)
[S14] round=24 local utility u=0.000000 metrics={'f1_val': 0.9388554119502449, 'auprc': 0.9992340339013763, 'loss_val': 0.09810878336754277, 'psi': 0.9630068607306975}-{'f1_val': 0.9982330107938716, 'auprc': 0.9992318822824783, 'loss_val': 0.022795835403903723, 'psi': 0.9986325593893143}
[S15] START round=24 head_norm_before_train=1.249416 cos_to_last_merge=0.9962 (last merge round=22)
[S15] round=24 local utility u=0.000000 metrics={'f1_val': 0.7634464133736716, 'auprc': 0.9838268414316766, 'loss_val': 0.3757984389120862, 'psi': 0.8515985845968737}-{'f1_val': 0.8088510392202151, 'auprc': 0.9871554857789546, 'loss_val': 0.281707435654904, 'psi': 0.8801728178437109}
[S16] START round=24 head_norm_before_train=1.901313 (no previous merge yet)
[S16] round=24 local utility u=0.125460 metrics={'f1_val': 0.9303002389432895, 'auprc': 0.9908241197950199, 'loss_val': 0.3079554713991805, 'psi': 0.9545097912839817}-{'f1_val': 0.9050360982203804, 'auprc': 0.9906098400732589, 'loss_val': 0.4066478968962459, 'psi': 0.9392655949615318}
[S17] START round=24 head_norm_before_train=1.157610 cos_to_last_merge=0.9964 (last merge round=22)
[S17] round=24 local utility u=0.000000 metrics={'f1_val': 0.5841549419144365, 'auprc': 0.7904441166992112, 'loss_val': 0.7206662177057072, 'psi': 0.6666706118283464}-{'f1_val': 0.713329750904216, 'auprc': 0.9365711378348116, 'loss_val': 0.6179064177767295, 'psi': 0.8026263056764542}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:52809
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:52817
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:52812
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:52812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:52808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:52814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:52815
[S10] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1805 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1801) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.365175)
[S17] loaded HEAD from S9 (vec_in norm=1.365175)
[S17] cosine check vs S9: cos=0.5003
[S17] BUFFERED delta from S9 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1802) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.932572)
[S17] loaded HEAD from S6 (vec_in norm=1.932572)
[S17] cosine check vs S6: cos=0.3304
[S17] BUFFERED delta from S6 (total buffered=2)
[S7] RECEIVED delta(kind=head bytes=1803) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.922131)
[S7] loaded HEAD from S16 (vec_in norm=1.922131)
[S7] cosine check vs S16: cos=0.4725
[S7] BUFFERED delta from S16 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1802) from S3
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.993237)
[S11] loaded HEAD from S3 (vec_in norm=1.993237)
[S11] cosine check vs S3: cos=-0.0373
[S11] DROPPED delta from S3 (cos=-0.0373 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1799) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=2.028687)
[S14] loaded HEAD from S10 (vec_in norm=2.028687)
[S14] cosine check vs S10: cos=-0.0459
[S14] DROPPED delta from S10 (cos=-0.0459 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1802) from S5
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.494577)
[S11] loaded HEAD from S5 (vec_in norm=1.494577)
[S11] cosine check vs S5: cos=-0.0446
[S11] DROPPED delta from S5 (cos=-0.0446 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1805) from S2
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.966787)
[S8] loaded HEAD from S2 (vec_in norm=1.966787)
[S8] cosine check vs S2: cos=0.5398
[S8] BUFFERED delta from S2 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1800) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.261467)
[S15] loaded HEAD from S8 (vec_in norm=1.261467)
[S15] cosine check vs S8: cos=0.8408
[S15] BUFFERED delta from S8 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1796) from S4
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.904977)
[S8] loaded HEAD from S4 (vec_in norm=1.904977)
[S8] cosine check vs S4: cos=0.0542
[S8] BUFFERED delta from S4 (total buffered=2)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=24 metric=0.5630 head_norm=1.158667
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.562272e-01
[S7] stored merged vector for next round verification (round=24)
[S7] DEBUG after merge:  round=24 metric=0.5799 head_norm=1.336198 delta_norm=0.856227
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=24 metric=0.9926 head_norm=1.261467
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.720287e-01
[S8] stored merged vector for next round verification (round=24)
[S8] DEBUG after merge:  round=24 metric=0.9926 head_norm=1.089208 delta_norm=0.672029
[S8] aggregate: ACCEPT kept=['S2', 'S4'] (k=2/2) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=24 metric=0.5842 head_norm=1.215795
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.809830e-01
[S17] stored merged vector for next round verification (round=24)
[S17] DEBUG after merge:  round=24 metric=0.5890 head_norm=1.068129 delta_norm=0.580983
[S17] aggregate: ACCEPT kept=['S9', 'S6'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=24 metric=0.7634 head_norm=1.334239
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.678187e-01
[S15] stored merged vector for next round verification (round=24)
[S15] DEBUG after merge:  round=24 metric=0.7701 head_norm=1.245173 delta_norm=0.367819
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.966787 (no previous merge yet)
[S2] round=25 local utility u=0.044663 metrics={'f1_val': 0.9141625762712601, 'auprc': 0.9666042475130043, 'loss_val': 0.19003368037722385, 'psi': 0.9351392447679577}-{'f1_val': 0.9110665490778723, 'auprc': 0.9702887030037798, 'loss_val': 0.27183738704639543, 'psi': 0.9347554106482353}
[S3] START round=25 head_norm_before_train=1.993237 (no previous merge yet)
[S3] round=25 local utility u=0.024012 metrics={'f1_val': 0.987695488604234, 'auprc': 0.998346141670996, 'loss_val': 0.04308399701209014, 'psi': 0.9919557498309387}-{'f1_val': 0.9817042559657083, 'auprc': 0.9986811564246942, 'loss_val': 0.05616522721975972, 'psi': 0.9884950161493027}
[S4] START round=25 head_norm_before_train=1.904977 (no previous merge yet)
[S4] round=25 local utility u=0.000000 metrics={'f1_val': 0.9466320390221966, 'auprc': 0.9700349889858545, 'loss_val': 0.2963625412201053, 'psi': 0.9559932190076598}-{'f1_val': 0.9481495654309733, 'auprc': 0.9745932198566338, 'loss_val': 0.2958671707535441, 'psi': 0.9587270272012376}
[S5] START round=25 head_norm_before_train=1.494577 cos_to_last_merge=0.7752 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.775
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.6055700191181359, 'auprc': 0.8550165461322874, 'loss_val': 0.46087264581196136, 'psi': 0.7053486299237965}-{'f1_val': 0.7009432789550658, 'auprc': 0.9899353392418687, 'loss_val': 0.22553714682780188, 'psi': 0.816540103069787}
[S6] START round=25 head_norm_before_train=1.932572 (no previous merge yet)
[S6] round=25 local utility u=0.143058 metrics={'f1_val': 0.8624414159609821, 'auprc': 0.9650619372388182, 'loss_val': 0.31518709844780773, 'psi': 0.9034896244721164}-{'f1_val': 0.8418430161003996, 'auprc': 0.9314943671878712, 'loss_val': 0.37700972920689735, 'psi': 0.8777035565353882}
[S7] START round=25 head_norm_before_train=1.336198 cos_to_last_merge=1.0000 (last merge round=24)
[S7] round=25 local utility u=0.984335 metrics={'f1_val': 0.6989179191025336, 'auprc': 0.988456718123117, 'loss_val': 0.3630226082025482, 'psi': 0.814733438710767}-{'f1_val': 0.5630239389640264, 'auprc': 0.779819135326808, 'loss_val': 0.8904159601755011, 'psi': 0.6497420175091391}
[S8] START round=25 head_norm_before_train=1.089208 cos_to_last_merge=1.0000 (last merge round=24)
[S8] round=25 local utility u=0.000000 metrics={'f1_val': 0.9925289693239863, 'auprc': 0.9839840829566763, 'loss_val': 0.1398179036124981, 'psi': 0.9891110147770623}-{'f1_val': 0.9925712794554754, 'auprc': 0.9925181057073533, 'loss_val': 0.15293421759732637, 'psi': 0.9925500099562266}
[S9] START round=25 head_norm_before_train=1.365175 cos_to_last_merge=0.9993 (last merge round=23)
[S9] round=25 local utility u=0.005287 metrics={'f1_val': 0.9926423765407113, 'auprc': 0.9993851175884332, 'loss_val': 0.08374365661124496, 'psi': 0.9953394729598001}-{'f1_val': 0.9966605118138915, 'auprc': 0.9943958750874162, 'loss_val': 0.10345894422071933, 'psi': 0.9957546571233014}
[S10] START round=25 head_norm_before_train=2.028687 (no previous merge yet)
[S10] round=25 local utility u=0.000244 metrics={'f1_val': 0.9955259082574451, 'auprc': 0.9958593464141466, 'loss_val': 0.028308731154842406, 'psi': 0.9956592835201257}-{'f1_val': 0.9955259082574451, 'auprc': 0.9958444751542023, 'loss_val': 0.028751224992044272, 'psi': 0.995653335016148}
[S11] START round=25 head_norm_before_train=1.966722 (no previous merge yet)
[S11] round=25 local utility u=0.180326 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9976688470178459, 'loss_val': 0.03639155382275621, 'psi': 0.9969957415152921}-{'f1_val': 0.9539185820766515, 'auprc': 0.9976795129799283, 'loss_val': 0.14130427950285773, 'psi': 0.9714229544379622}
[S13] START round=25 head_norm_before_train=1.187426 cos_to_last_merge=0.9981 (last merge round=23)
[S13] round=25 local utility u=0.000000 metrics={'f1_val': 0.6086615059790215, 'auprc': 0.8623302441670788, 'loss_val': 0.7295839618256468, 'psi': 0.7101290012542444}-{'f1_val': 0.6003078114437014, 'auprc': 0.8972094154876259, 'loss_val': 0.6882413191982333, 'psi': 0.7190684530612712}
[S14] START round=25 head_norm_before_train=2.063556 (no previous merge yet)
[S14] round=25 local utility u=0.002688 metrics={'f1_val': 0.9393571567205639, 'auprc': 0.999233042158389, 'loss_val': 0.09573947374296055, 'psi': 0.9633075108956939}-{'f1_val': 0.9388554119502449, 'auprc': 0.9992340339013763, 'loss_val': 0.09810878336754277, 'psi': 0.9630068607306975}
[S15] START round=25 head_norm_before_train=1.245173 cos_to_last_merge=1.0000 (last merge round=24)
[S15] round=25 local utility u=0.000000 metrics={'f1_val': 0.7003242879862208, 'auprc': 0.9870928046593771, 'loss_val': 0.3852758744020151, 'psi': 0.8150316946554834}-{'f1_val': 0.7634464133736716, 'auprc': 0.9838268414316766, 'loss_val': 0.3757984389120862, 'psi': 0.8515985845968737}
[S16] START round=25 head_norm_before_train=1.922131 (no previous merge yet)
[S16] round=25 local utility u=0.000000 metrics={'f1_val': 0.8522794220076833, 'auprc': 0.9690271899553804, 'loss_val': 0.7453716067557808, 'psi': 0.8989785291867621}-{'f1_val': 0.9303002389432895, 'auprc': 0.9908241197950199, 'loss_val': 0.3079554713991805, 'psi': 0.9545097912839817}
[S17] START round=25 head_norm_before_train=1.068129 cos_to_last_merge=1.0000 (last merge round=24)
[S17] round=25 local utility u=0.236375 metrics={'f1_val': 0.6382940196197195, 'auprc': 0.8335077426254273, 'loss_val': 0.7019418914294916, 'psi': 0.7163795088220026}-{'f1_val': 0.5841549419144365, 'auprc': 0.7904441166992112, 'loss_val': 0.7206662177057072, 'psi': 0.6666706118283464}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:52809
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:52814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:52812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:52817
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:52809
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:52817
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1805 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1801) from S3
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=2.013891)
[S11] loaded HEAD from S3 (vec_in norm=2.013891)
[S11] cosine check vs S3: cos=-0.0374
[S11] DROPPED delta from S3 (cos=-0.0374 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1800) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=2.040015)
[S14] loaded HEAD from S10 (vec_in norm=2.040015)
[S14] cosine check vs S10: cos=-0.0458
[S14] DROPPED delta from S10 (cos=-0.0458 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1798) from S2
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.977281)
[S8] loaded HEAD from S2 (vec_in norm=1.977281)
[S8] cosine check vs S2: cos=0.6936
[S8] BUFFERED delta from S2 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1795) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=2.072588)
[S8] loaded HEAD from S14 (vec_in norm=2.072588)
[S8] cosine check vs S14: cos=0.4145
[S8] BUFFERED delta from S14 (total buffered=2)
[S8] RECEIVED delta(kind=head bytes=1800) from S11
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.985589)
[S8] loaded HEAD from S11 (vec_in norm=1.985589)
[S8] cosine check vs S11: cos=0.3136
[S8] BUFFERED delta from S11 (total buffered=3)
[S17] RECEIVED delta(kind=head bytes=1797) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.406927)
[S17] loaded HEAD from S9 (vec_in norm=1.406927)
[S17] cosine check vs S9: cos=0.6284
[S17] BUFFERED delta from S9 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1805) from S7
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.364303)
[S17] loaded HEAD from S7 (vec_in norm=1.364303)
[S17] cosine check vs S7: cos=0.6764
[S17] BUFFERED delta from S7 (total buffered=2)
[S17] RECEIVED delta(kind=head bytes=1801) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.951077)
[S17] loaded HEAD from S6 (vec_in norm=1.951077)
[S17] cosine check vs S6: cos=0.6485
[S17] BUFFERED delta from S6 (total buffered=3)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1810 reason=None
[S17] → sending delta(kind=head bytes=1810) to S13@127.0.0.1:52813
[S17] sending update (kind=head size=1810 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1810) from S17
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.131783)
[S13] loaded HEAD from S17 (vec_in norm=1.131783)
[S13] cosine check vs S17: cos=0.9376
[S13] BUFFERED delta from S17 (total buffered=1)
[S15] ⇄ pheromone p=0.126 → S9@127.0.0.1:52810
[S8] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=25 metric=0.9925 head_norm=1.169513
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.913053e-01
[S8] stored merged vector for next round verification (round=25)
[S8] DEBUG after merge:  round=25 metric=0.9925 head_norm=1.127319 delta_norm=0.391305
[S8] aggregate: ACCEPT kept=['S2', 'S14', 'S11'] (k=3/3) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.037 → S15@127.0.0.1:52815
[S5] ⇄ pheromone p=0.229 → S11@127.0.0.1:52812
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=25 metric=0.6087 head_norm=1.252893
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.189009e-01
[S13] stored merged vector for next round verification (round=25)
[S13] DEBUG after merge:  round=25 metric=0.6087 head_norm=1.173635 delta_norm=0.218901
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.070 → S7@127.0.0.1:52808
[S4] ⇄ pheromone p=0.033 → S8@127.0.0.1:52809
[S9] ⇄ pheromone p=0.038 → S17@127.0.0.1:52817
[S10] ⇄ pheromone p=0.019 → S14@127.0.0.1:52814
[S6] ⇄ pheromone p=0.281 → S17@127.0.0.1:52817
[S7] ⇄ pheromone p=0.378 → S17@127.0.0.1:52817
[S2] ⇄ pheromone p=0.142 → S8@127.0.0.1:52809
[S11] ⇄ pheromone p=0.080 → S8@127.0.0.1:52809
[S14] ⇄ pheromone p=0.030 → S8@127.0.0.1:52809
[S3] ⇄ pheromone p=0.070 → S11@127.0.0.1:52812
[S17] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=25 metric=0.6383 head_norm=1.131783
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.543241e-01
[S17] stored merged vector for next round verification (round=25)
[S17] DEBUG after merge:  round=25 metric=0.6395 head_norm=1.066150 delta_norm=0.154324
[S17] aggregate: ACCEPT kept=['S9', 'S7', 'S6'] (k=3/3) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.207 → S13@127.0.0.1:52813
[S16] ⇄ pheromone p=0.119 → S7@127.0.0.1:52808
[S2] START round=26 head_norm_before_train=1.977281 (no previous merge yet)
[S2] round=26 local utility u=0.000000 metrics={'f1_val': 0.9112244315963443, 'auprc': 0.9225598095642648, 'loss_val': 0.2509206097942927, 'psi': 0.9157585827835124}-{'f1_val': 0.9141625762712601, 'auprc': 0.9666042475130043, 'loss_val': 0.19003368037722385, 'psi': 0.9351392447679577}
[S3] START round=26 head_norm_before_train=2.013891 (no previous merge yet)
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.961498813606586, 'auprc': 0.9981323633591155, 'loss_val': 0.07115668273158235, 'psi': 0.9761522335075977}-{'f1_val': 0.987695488604234, 'auprc': 0.998346141670996, 'loss_val': 0.04308399701209014, 'psi': 0.9919557498309387}
[S4] START round=26 head_norm_before_train=1.914191 (no previous merge yet)
[S4] round=26 local utility u=0.000000 metrics={'f1_val': 0.9418447507140332, 'auprc': 0.9752395513354075, 'loss_val': 0.3017723520011624, 'psi': 0.9552026709625829}-{'f1_val': 0.9466320390221966, 'auprc': 0.9700349889858545, 'loss_val': 0.2963625412201053, 'psi': 0.9559932190076598}
[S5] START round=26 head_norm_before_train=1.505998 cos_to_last_merge=0.7731 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.773
[S5] round=26 local utility u=0.617321 metrics={'f1_val': 0.7009022086989503, 'auprc': 0.9899353392418687, 'loss_val': 0.20298037157798257, 'psi': 0.8165154609161176}-{'f1_val': 0.6055700191181359, 'auprc': 0.8550165461322874, 'loss_val': 0.46087264581196136, 'psi': 0.7053486299237965}
[S6] START round=26 head_norm_before_train=1.951077 (no previous merge yet)
[S6] round=26 local utility u=0.000000 metrics={'f1_val': 0.6077418800947597, 'auprc': 0.9153246548143643, 'loss_val': 1.195054707352291, 'psi': 0.7307749899826016}-{'f1_val': 0.8624414159609821, 'auprc': 0.9650619372388182, 'loss_val': 0.31518709844780773, 'psi': 0.9034896244721164}
[S7] START round=26 head_norm_before_train=1.364303 cos_to_last_merge=0.9994 (last merge round=24)
[S7] round=26 local utility u=0.000000 metrics={'f1_val': 0.6626382404438826, 'auprc': 0.8435027351253557, 'loss_val': 0.4774422215774596, 'psi': 0.7349840383164719}-{'f1_val': 0.6989179191025336, 'auprc': 0.988456718123117, 'loss_val': 0.3630226082025482, 'psi': 0.814733438710767}
[S8] START round=26 head_norm_before_train=1.127319 cos_to_last_merge=1.0000 (last merge round=25)
[S8] round=26 local utility u=0.009955 metrics={'f1_val': 0.9889241575992487, 'auprc': 0.9972975746467998, 'loss_val': 0.1382188768787791, 'psi': 0.9922735244182691}-{'f1_val': 0.9925289693239863, 'auprc': 0.9839840829566763, 'loss_val': 0.1398179036124981, 'psi': 0.9891110147770623}
[S9] START round=26 head_norm_before_train=1.406927 cos_to_last_merge=0.9975 (last merge round=23)
[S9] round=26 local utility u=0.019119 metrics={'f1_val': 0.9955666097086097, 'auprc': 0.9994505573001919, 'loss_val': 0.06324690198773464, 'psi': 0.9971201887452426}-{'f1_val': 0.9926423765407113, 'auprc': 0.9993851175884332, 'loss_val': 0.08374365661124496, 'psi': 0.9953394729598001}
[S10] START round=26 head_norm_before_train=2.040015 (no previous merge yet)
[S10] round=26 local utility u=0.000000 metrics={'f1_val': 0.9955259082574451, 'auprc': 0.9956222965454886, 'loss_val': 0.02804868026068944, 'psi': 0.9955644635726625}-{'f1_val': 0.9955259082574451, 'auprc': 0.9958593464141466, 'loss_val': 0.028308731154842406, 'psi': 0.9956592835201257}
[S11] START round=26 head_norm_before_train=1.985589 (no previous merge yet)
[S11] round=26 local utility u=0.000925 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9976060148150079, 'loss_val': 0.03435254710484326, 'psi': 0.9969706086341569}-{'f1_val': 0.9965470045135896, 'auprc': 0.9976688470178459, 'loss_val': 0.03639155382275621, 'psi': 0.9969957415152921}
[S13] START round=26 head_norm_before_train=1.173635 cos_to_last_merge=1.0000 (last merge round=25)
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.5996578397640697, 'auprc': 0.8484487813388142, 'loss_val': 0.7278231248262645, 'psi': 0.6991742163939675}-{'f1_val': 0.6086615059790215, 'auprc': 0.8623302441670788, 'loss_val': 0.7295839618256468, 'psi': 0.7101290012542444}
[S14] START round=26 head_norm_before_train=2.072588 (no previous merge yet)
[S14] round=26 local utility u=0.214229 metrics={'f1_val': 0.997844401637113, 'auprc': 0.9992341217768954, 'loss_val': 0.018208019615515984, 'psi': 0.998400289693026}-{'f1_val': 0.9393571567205639, 'auprc': 0.999233042158389, 'loss_val': 0.09573947374296055, 'psi': 0.9633075108956939}
[S15] START round=26 head_norm_before_train=1.317347 cos_to_last_merge=0.9966 (last merge round=24)
[S15] round=26 local utility u=1.000000 metrics={'f1_val': 0.9900314527320015, 'auprc': 0.9918089353476606, 'loss_val': 0.11728219639684605, 'psi': 0.9907424457782651}-{'f1_val': 0.7003242879862208, 'auprc': 0.9870928046593771, 'loss_val': 0.3852758744020151, 'psi': 0.8150316946554834}
[S16] START round=26 head_norm_before_train=1.939283 (no previous merge yet)
[S16] round=26 local utility u=0.070231 metrics={'f1_val': 0.8598251851272039, 'auprc': 0.978800741848593, 'loss_val': 0.679504693309006, 'psi': 0.9074154078157595}-{'f1_val': 0.8522794220076833, 'auprc': 0.9690271899553804, 'loss_val': 0.7453716067557808, 'psi': 0.8989785291867621}
[S17] START round=26 head_norm_before_train=1.066150 cos_to_last_merge=1.0000 (last merge round=25)
[S17] round=26 local utility u=0.000000 metrics={'f1_val': 0.5736706125902067, 'auprc': 0.7425617822671657, 'loss_val': 0.8122169986582735, 'psi': 0.6412270804609903}-{'f1_val': 0.6382940196197195, 'auprc': 0.8335077426254273, 'loss_val': 0.7019418914294916, 'psi': 0.7163795088220026}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] → sending delta(kind=head bytes=1805) to S11@127.0.0.1:52812
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:52808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:52815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:52817
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:52809
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:52810
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1794 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1805 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1797) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.952866)
[S7] loaded HEAD from S16 (vec_in norm=1.952866)
[S7] cosine check vs S16: cos=0.9228
[S7] BUFFERED delta from S16 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1803) from S15
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.377862)
[S9] loaded HEAD from S15 (vec_in norm=1.377862)
[S9] cosine check vs S15: cos=0.9436
[S9] BUFFERED delta from S15 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1805) from S5
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.517159)
[S11] loaded HEAD from S5 (vec_in norm=1.517159)
[S11] cosine check vs S5: cos=-0.0410
[S11] DROPPED delta from S5 (cos=-0.0410 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1800) from S11
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=2.002005)
[S8] loaded HEAD from S11 (vec_in norm=2.002005)
[S8] cosine check vs S11: cos=0.4696
[S8] BUFFERED delta from S11 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1794) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.213973)
[S15] loaded HEAD from S8 (vec_in norm=1.213973)
[S15] cosine check vs S8: cos=0.9141
[S15] BUFFERED delta from S8 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1800) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=2.082993)
[S8] loaded HEAD from S14 (vec_in norm=2.082993)
[S8] cosine check vs S14: cos=0.5480
[S8] BUFFERED delta from S14 (total buffered=2)
[S17] RECEIVED delta(kind=head bytes=1795) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.449223)
[S17] loaded HEAD from S9 (vec_in norm=1.449223)
[S17] cosine check vs S9: cos=0.6662
[S17] BUFFERED delta from S9 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=26 metric=0.6626 head_norm=1.385966
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.299237e-01
[S7] stored merged vector for next round verification (round=26)
[S7] DEBUG after merge:  round=26 metric=0.6651 head_norm=1.637822 delta_norm=0.429924
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=26 metric=0.9900 head_norm=1.377862
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.802404e-01
[S15] stored merged vector for next round verification (round=26)
[S15] DEBUG after merge:  round=26 metric=0.9930 head_norm=1.267905 delta_norm=0.280240
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=26 metric=0.9889 head_norm=1.213973
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.291469e-01
[S8] stored merged vector for next round verification (round=26)
[S8] DEBUG after merge:  round=26 metric=0.9886 head_norm=1.242388 delta_norm=0.529147
[S8] aggregate: ACCEPT kept=['S11', 'S14'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=26 metric=0.9956 head_norm=1.449223
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.399721e-01
[S9] stored merged vector for next round verification (round=26)
[S9] DEBUG after merge:  round=26 metric=0.9956 head_norm=1.393481 delta_norm=0.239972
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=26 metric=0.5737 head_norm=1.128582
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.465006e-01
[S17] stored merged vector for next round verification (round=26)
[S17] DEBUG after merge:  round=26 metric=0.5835 head_norm=1.178265 delta_norm=0.546501
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.987622 (no previous merge yet)
[S2] round=27 local utility u=0.093740 metrics={'f1_val': 0.9134574949211229, 'auprc': 0.9697186976681288, 'loss_val': 0.21831548938935516, 'psi': 0.9359619760199253}-{'f1_val': 0.9112244315963443, 'auprc': 0.9225598095642648, 'loss_val': 0.2509206097942927, 'psi': 0.9157585827835124}
[S3] START round=27 head_norm_before_train=2.033045 (no previous merge yet)
[S3] round=27 local utility u=0.108849 metrics={'f1_val': 0.991512366291151, 'auprc': 0.9985751011068345, 'loss_val': 0.03486832238638002, 'psi': 0.9943374602174244}-{'f1_val': 0.961498813606586, 'auprc': 0.9981323633591155, 'loss_val': 0.07115668273158235, 'psi': 0.9761522335075977}
[S4] START round=27 head_norm_before_train=1.926248 (no previous merge yet)
[S4] round=27 local utility u=0.008707 metrics={'f1_val': 0.943172226674934, 'auprc': 0.9785520606516409, 'loss_val': 0.3022613414620491, 'psi': 0.9573241602656167}-{'f1_val': 0.9418447507140332, 'auprc': 0.9752395513354075, 'loss_val': 0.3017723520011624, 'psi': 0.9552026709625829}
[S5] START round=27 head_norm_before_train=1.517159 cos_to_last_merge=0.7708 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.771
[S5] round=27 local utility u=0.000000 metrics={'f1_val': 0.7008152523037622, 'auprc': 0.9545501108989025, 'loss_val': 0.30741392567297576, 'psi': 0.8023091957418182}-{'f1_val': 0.7009022086989503, 'auprc': 0.9899353392418687, 'loss_val': 0.20298037157798257, 'psi': 0.8165154609161176}
[S6] START round=27 head_norm_before_train=1.962882 (no previous merge yet)
[S6] round=27 local utility u=1.000000 metrics={'f1_val': 0.9353012778388421, 'auprc': 0.9751521056880266, 'loss_val': 0.18780966897721232, 'psi': 0.9512416089785158}-{'f1_val': 0.6077418800947597, 'auprc': 0.9153246548143643, 'loss_val': 1.195054707352291, 'psi': 0.7307749899826016}
[S7] START round=27 head_norm_before_train=1.637822 cos_to_last_merge=1.0000 (last merge round=26)
[S7] round=27 local utility u=0.000000 metrics={'f1_val': 0.6532995181411458, 'auprc': 0.836328573812686, 'loss_val': 0.47450796009903257, 'psi': 0.726511140409762}-{'f1_val': 0.6626382404438826, 'auprc': 0.8435027351253557, 'loss_val': 0.4774422215774596, 'psi': 0.7349840383164719}
[S8] START round=27 head_norm_before_train=1.242388 cos_to_last_merge=1.0000 (last merge round=26)
[S8] round=27 local utility u=0.011149 metrics={'f1_val': 0.9907243993413981, 'auprc': 0.9971208240540737, 'loss_val': 0.12619170772336963, 'psi': 0.9932829692264684}-{'f1_val': 0.9889241575992487, 'auprc': 0.9972975746467998, 'loss_val': 0.1382188768787791, 'psi': 0.9922735244182691}
[S9] START round=27 head_norm_before_train=1.393481 cos_to_last_merge=1.0000 (last merge round=26)
[S9] round=27 local utility u=0.000000 metrics={'f1_val': 0.9959812240560731, 'auprc': 0.9990951907804924, 'loss_val': 0.07559164014134752, 'psi': 0.9972268107458409}-{'f1_val': 0.9955666097086097, 'auprc': 0.9994505573001919, 'loss_val': 0.06324690198773464, 'psi': 0.9971201887452426}
[S10] START round=27 head_norm_before_train=2.051739 (no previous merge yet)
[S10] round=27 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9952914184015236, 'loss_val': 0.028226199455816437, 'psi': 0.9953104396988477}-{'f1_val': 0.9955259082574451, 'auprc': 0.9956222965454886, 'loss_val': 0.02804868026068944, 'psi': 0.9955644635726625}
[S11] START round=27 head_norm_before_train=2.002005 (no previous merge yet)
[S11] round=27 local utility u=0.000000 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9974965365055273, 'loss_val': 0.03673406298799681, 'psi': 0.9969390969859391}-{'f1_val': 0.9965470045135896, 'auprc': 0.9976060148150079, 'loss_val': 0.03435254710484326, 'psi': 0.9969706086341569}
[S13] START round=27 head_norm_before_train=1.216321 cos_to_last_merge=0.9988 (last merge round=25)
[S13] round=27 local utility u=0.371688 metrics={'f1_val': 0.6750358418689887, 'auprc': 0.8558624051030821, 'loss_val': 0.45895627329958333, 'psi': 0.7473664671626261}-{'f1_val': 0.5996578397640697, 'auprc': 0.8484487813388142, 'loss_val': 0.7278231248262645, 'psi': 0.6991742163939675}
[S14] START round=27 head_norm_before_train=2.082993 (no previous merge yet)
[S14] round=27 local utility u=0.000000 metrics={'f1_val': 0.9965536345053762, 'auprc': 0.9992314432623908, 'loss_val': 0.022475507583679173, 'psi': 0.997624758008182}-{'f1_val': 0.997844401637113, 'auprc': 0.9992341217768954, 'loss_val': 0.018208019615515984, 'psi': 0.998400289693026}
[S15] START round=27 head_norm_before_train=1.267905 cos_to_last_merge=1.0000 (last merge round=26)
[S15] round=27 local utility u=0.000000 metrics={'f1_val': 0.7009169771696235, 'auprc': 0.9873685034956123, 'loss_val': 0.39892495153789964, 'psi': 0.815497587700019}-{'f1_val': 0.9900314527320015, 'auprc': 0.9918089353476606, 'loss_val': 0.11728219639684605, 'psi': 0.9907424457782651}
[S16] START round=27 head_norm_before_train=1.952866 (no previous merge yet)
[S16] round=27 local utility u=0.479556 metrics={'f1_val': 0.9382080117519445, 'auprc': 0.9917516674012539, 'loss_val': 0.22954335629133765, 'psi': 0.9596254740116682}-{'f1_val': 0.8598251851272039, 'auprc': 0.978800741848593, 'loss_val': 0.679504693309006, 'psi': 0.9074154078157595}
[S17] START round=27 head_norm_before_train=1.178265 cos_to_last_merge=1.0000 (last merge round=26)
[S17] round=27 local utility u=0.079280 metrics={'f1_val': 0.5880454781155608, 'auprc': 0.7652716366781394, 'loss_val': 0.8080359600624594, 'psi': 0.6589359415405922}-{'f1_val': 0.5736706125902067, 'auprc': 0.7425617822671657, 'loss_val': 0.8122169986582735, 'psi': 0.6412270804609903}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:52809
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:52812
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:52809
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:52808
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:52808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:52815
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1804 to 1 peers)
[S13] sending update (kind=head size=1804 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1805 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1801) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.969511)
[S17] loaded HEAD from S6 (vec_in norm=1.969511)
[S17] cosine check vs S6: cos=0.3224
[S17] BUFFERED delta from S6 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1804) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.321759)
[S15] loaded HEAD from S8 (vec_in norm=1.321759)
[S15] cosine check vs S8: cos=0.9164
[S15] BUFFERED delta from S8 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1804) from S13
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.257802)
[S7] loaded HEAD from S13 (vec_in norm=1.257802)
[S7] cosine check vs S13: cos=0.5360
[S7] BUFFERED delta from S13 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1801) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.966814)
[S7] loaded HEAD from S16 (vec_in norm=1.966814)
[S7] cosine check vs S16: cos=0.9856
[S7] BUFFERED delta from S16 (total buffered=2)
[S8] RECEIVED delta(kind=head bytes=1805) from S2
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=2.001743)
[S8] loaded HEAD from S2 (vec_in norm=2.001743)
[S8] cosine check vs S2: cos=0.3750
[S8] BUFFERED delta from S2 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1804) from S4
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.937303)
[S8] loaded HEAD from S4 (vec_in norm=1.937303)
[S8] cosine check vs S4: cos=0.0922
[S8] BUFFERED delta from S4 (total buffered=2)
[S11] RECEIVED delta(kind=head bytes=1798) from S3
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=2.050264)
[S11] loaded HEAD from S3 (vec_in norm=2.050264)
[S11] cosine check vs S3: cos=-0.0375
[S11] DROPPED delta from S3 (cos=-0.0375 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:52813
[S17] sending update (kind=head size=1798 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1798) from S17
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.230956)
[S13] loaded HEAD from S17 (vec_in norm=1.230956)
[S13] cosine check vs S17: cos=0.8448
[S13] BUFFERED delta from S17 (total buffered=1)
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=27 metric=0.6533 head_norm=1.654989
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.587018e-01
[S7] stored merged vector for next round verification (round=27)
[S7] DEBUG after merge:  round=27 metric=0.6480 head_norm=1.492951 delta_norm=0.258702
[S7] aggregate: ROLLBACK (f1_val pre=0.653 post=0.648 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=27 metric=0.9907 head_norm=1.321759
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.511211e-01
[S8] stored merged vector for next round verification (round=27)
[S8] DEBUG after merge:  round=27 metric=0.9906 head_norm=1.085502 delta_norm=0.751121
[S8] aggregate: ACCEPT kept=['S2', 'S4'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=27 metric=0.6750 head_norm=1.257802
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.468355e-01
[S13] stored merged vector for next round verification (round=27)
[S13] DEBUG after merge:  round=27 metric=0.6750 head_norm=1.195142 delta_norm=0.346835
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=27 metric=0.7009 head_norm=1.336522
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.717687e-01
[S15] stored merged vector for next round verification (round=27)
[S15] DEBUG after merge:  round=27 metric=0.7009 head_norm=1.301080 delta_norm=0.271769
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=27 metric=0.5880 head_norm=1.230956
[S17] _apply_head_vector_avg (torch): Δ‖w‖=9.786232e-01
[S17] stored merged vector for next round verification (round=27)
[S17] DEBUG after merge:  round=27 metric=0.5807 head_norm=1.318867 delta_norm=0.978623
[S17] aggregate: ROLLBACK (f1_val pre=0.588 post=0.581 tol_abs=0.005 tol_rel=0.0)
[S2] START round=28 head_norm_before_train=2.001743 (no previous merge yet)
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.9106579583250359, 'auprc': 0.9643872366023855, 'loss_val': 0.27995780499773565, 'psi': 0.9321496696359757}-{'f1_val': 0.9134574949211229, 'auprc': 0.9697186976681288, 'loss_val': 0.21831548938935516, 'psi': 0.9359619760199253}
[S3] START round=28 head_norm_before_train=2.050264 (no previous merge yet)
[S3] round=28 local utility u=0.022806 metrics={'f1_val': 0.9973696976584205, 'auprc': 0.9986862639167443, 'loss_val': 0.024734290109096377, 'psi': 0.99789632416175}-{'f1_val': 0.991512366291151, 'auprc': 0.9985751011068345, 'loss_val': 0.03486832238638002, 'psi': 0.9943374602174244}
[S4] START round=28 head_norm_before_train=1.937303 (no previous merge yet)
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.9514911086909963, 'auprc': 0.9592055534007897, 'loss_val': 0.296760911904489, 'psi': 0.9545768865749137}-{'f1_val': 0.943172226674934, 'auprc': 0.9785520606516409, 'loss_val': 0.3022613414620491, 'psi': 0.9573241602656167}
[S5] START round=28 head_norm_before_train=1.526156 cos_to_last_merge=0.7712 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.771
[S5] round=28 local utility u=0.000000 metrics={'f1_val': 0.664242778348204, 'auprc': 0.9408464431095388, 'loss_val': 0.3241339350910232, 'psi': 0.7748842442527379}-{'f1_val': 0.7008152523037622, 'auprc': 0.9545501108989025, 'loss_val': 0.30741392567297576, 'psi': 0.8023091957418182}
[S6] START round=28 head_norm_before_train=1.969511 (no previous merge yet)
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.596863584109633, 'auprc': 0.8599883406055079, 'loss_val': 1.2123975514064185, 'psi': 0.702113486707983}-{'f1_val': 0.9353012778388421, 'auprc': 0.9751521056880266, 'loss_val': 0.18780966897721232, 'psi': 0.9512416089785158}
[S7] START round=28 head_norm_before_train=1.492951 cos_to_last_merge=1.0000 (last merge round=27)
[S7] round=28 local utility u=0.000000 metrics={'f1_val': 0.5699261601839816, 'auprc': 0.7988843230022259, 'loss_val': 0.7098356414930761, 'psi': 0.6615094253112793}-{'f1_val': 0.6532995181411458, 'auprc': 0.836328573812686, 'loss_val': 0.47450796009903257, 'psi': 0.726511140409762}
[S8] START round=28 head_norm_before_train=1.085502 cos_to_last_merge=1.0000 (last merge round=27)
[S8] round=28 local utility u=0.000000 metrics={'f1_val': 0.9871370762874481, 'auprc': 0.9972407325690718, 'loss_val': 0.1363497946239538, 'psi': 0.9911785388000975}-{'f1_val': 0.9907243993413981, 'auprc': 0.9971208240540737, 'loss_val': 0.12619170772336963, 'psi': 0.9932829692264684}
[S9] START round=28 head_norm_before_train=1.431697 cos_to_last_merge=0.9995 (last merge round=26)
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.9926423765407113, 'auprc': 0.9992019917804092, 'loss_val': 0.06876127646872603, 'psi': 0.9952662226365905}-{'f1_val': 0.9959812240560731, 'auprc': 0.9990951907804924, 'loss_val': 0.07559164014134752, 'psi': 0.9972268107458409}
[S10] START round=28 head_norm_before_train=2.060417 (no previous merge yet)
[S10] round=28 local utility u=0.001415 metrics={'f1_val': 0.9953063309450747, 'auprc': 0.99584838334372, 'loss_val': 0.02696619819823334, 'psi': 0.9955231519045329}-{'f1_val': 0.9953231205637304, 'auprc': 0.9952914184015236, 'loss_val': 0.028226199455816437, 'psi': 0.9953104396988477}
[S11] START round=28 head_norm_before_train=2.017885 (no previous merge yet)
[S11] round=28 local utility u=0.002792 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9975420038746929, 'loss_val': 0.031163769036192404, 'psi': 0.9969450042580309}-{'f1_val': 0.996567470639547, 'auprc': 0.9974965365055273, 'loss_val': 0.03673406298799681, 'psi': 0.9969390969859391}
[S13] START round=28 head_norm_before_train=1.195142 cos_to_last_merge=1.0000 (last merge round=27)
[S13] round=28 local utility u=0.000000 metrics={'f1_val': 0.592478498315766, 'auprc': 0.9264197973193959, 'loss_val': 0.7498917883244968, 'psi': 0.726055017917218}-{'f1_val': 0.6750358418689887, 'auprc': 0.8558624051030821, 'loss_val': 0.45895627329958333, 'psi': 0.7473664671626261}
[S14] START round=28 head_norm_before_train=2.093206 (no previous merge yet)
[S14] round=28 local utility u=0.000000 metrics={'f1_val': 0.9383527625584585, 'auprc': 0.9992346617934266, 'loss_val': 0.10408637428161076, 'psi': 0.9627055222524458}-{'f1_val': 0.9965536345053762, 'auprc': 0.9992314432623908, 'loss_val': 0.022475507583679173, 'psi': 0.997624758008182}
[S15] START round=28 head_norm_before_train=1.301080 cos_to_last_merge=1.0000 (last merge round=27)
[S15] round=28 local utility u=0.827094 metrics={'f1_val': 0.9408279485627797, 'auprc': 0.9894908760099406, 'loss_val': 0.19057028879075802, 'psi': 0.960293119541644}-{'f1_val': 0.7009169771696235, 'auprc': 0.9873685034956123, 'loss_val': 0.39892495153789964, 'psi': 0.815497587700019}
[S16] START round=28 head_norm_before_train=1.966814 (no previous merge yet)
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.914832728487455, 'auprc': 0.9912504633890951, 'loss_val': 0.4103461379161288, 'psi': 0.945399822448111}-{'f1_val': 0.9382080117519445, 'auprc': 0.9917516674012539, 'loss_val': 0.22954335629133765, 'psi': 0.9596254740116682}
[S17] START round=28 head_norm_before_train=1.318867 cos_to_last_merge=1.0000 (last merge round=27)
[S17] round=28 local utility u=0.113081 metrics={'f1_val': 0.5887646423764876, 'auprc': 0.8494852389048778, 'loss_val': 0.838829305443008, 'psi': 0.6930528809878438}-{'f1_val': 0.5880454781155608, 'auprc': 0.7652716366781394, 'loss_val': 0.8080359600624594, 'psi': 0.6589359415405922}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:52809
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:52805
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1801) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=2.034469)
[S5] loaded HEAD from S11 (vec_in norm=2.034469)
[S5] cosine check vs S11: cos=-0.0379
[S5] DROPPED delta from S11 (cos=-0.0379 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1802) from S15
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.373930)
[S8] loaded HEAD from S15 (vec_in norm=1.373930)
[S8] cosine check vs S15: cos=0.8947
[S8] BUFFERED delta from S15 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:52808
[S17] sending update (kind=head size=1795 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1795) from S17
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.366961)
[S7] loaded HEAD from S17 (vec_in norm=1.366961)
[S7] cosine check vs S17: cos=0.2926
[S7] BUFFERED delta from S17 (total buffered=1)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=28 metric=0.9871 head_norm=1.157247
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.089786e-01
[S8] stored merged vector for next round verification (round=28)
[S8] DEBUG after merge:  round=28 metric=0.9871 head_norm=1.232065 delta_norm=0.308979
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=28 metric=0.5699 head_norm=1.507909
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.567779e-01
[S7] stored merged vector for next round verification (round=28)
[S7] DEBUG after merge:  round=28 metric=0.5530 head_norm=1.156338 delta_norm=0.856778
[S7] aggregate: ROLLBACK (f1_val pre=0.570 post=0.553 tol_abs=0.005 tol_rel=0.0)
[S2] START round=29 head_norm_before_train=2.014527 (no previous merge yet)
[S2] round=29 local utility u=0.016319 metrics={'f1_val': 0.9115799172641371, 'auprc': 0.9696131967390301, 'loss_val': 0.2685286962001931, 'psi': 0.9347932290540943}-{'f1_val': 0.9106579583250359, 'auprc': 0.9643872366023855, 'loss_val': 0.27995780499773565, 'psi': 0.9321496696359757}
[S3] START round=29 head_norm_before_train=2.066220 (no previous merge yet)
[S3] round=29 local utility u=0.000000 metrics={'f1_val': 0.9846966392084899, 'auprc': 0.9984967890933438, 'loss_val': 0.038354112262259536, 'psi': 0.9902166991624315}-{'f1_val': 0.9973696976584205, 'auprc': 0.9986862639167443, 'loss_val': 0.024734290109096377, 'psi': 0.99789632416175}
[S4] START round=29 head_norm_before_train=1.947237 (no previous merge yet)
[S4] round=29 local utility u=0.000000 metrics={'f1_val': 0.9466917420338898, 'auprc': 0.9355208983311256, 'loss_val': 0.30940496174087806, 'psi': 0.9422234045527842}-{'f1_val': 0.9514911086909963, 'auprc': 0.9592055534007897, 'loss_val': 0.296760911904489, 'psi': 0.9545768865749137}
[S5] START round=29 head_norm_before_train=1.539581 cos_to_last_merge=0.7702 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.770
[S5] round=29 local utility u=0.408101 metrics={'f1_val': 0.7482102816706118, 'auprc': 0.9899818422180592, 'loss_val': 0.15914263977248283, 'psi': 0.8449189058895907}-{'f1_val': 0.664242778348204, 'auprc': 0.9408464431095388, 'loss_val': 0.3241339350910232, 'psi': 0.7748842442527379}
[S6] START round=29 head_norm_before_train=1.978866 (no previous merge yet)
[S6] round=29 local utility u=1.000000 metrics={'f1_val': 0.864877533741503, 'auprc': 0.9752873291860232, 'loss_val': 0.29193282188205394, 'psi': 0.9090414519193111}-{'f1_val': 0.596863584109633, 'auprc': 0.8599883406055079, 'loss_val': 1.2123975514064185, 'psi': 0.702113486707983}
[S7] START round=29 head_norm_before_train=1.156338 cos_to_last_merge=1.0000 (last merge round=28)
[S7] round=29 local utility u=0.039855 metrics={'f1_val': 0.5916961865029022, 'auprc': 0.7965468325216254, 'loss_val': 0.7537332395757483, 'psi': 0.6736364449103915}-{'f1_val': 0.5699261601839816, 'auprc': 0.7988843230022259, 'loss_val': 0.7098356414930761, 'psi': 0.6615094253112793}
[S8] START round=29 head_norm_before_train=1.232065 cos_to_last_merge=1.0000 (last merge round=28)
[S8] round=29 local utility u=0.028396 metrics={'f1_val': 0.9934888194563342, 'auprc': 0.9853661214495196, 'loss_val': 0.08204449353039804, 'psi': 0.9902397402536083}-{'f1_val': 0.9871370762874481, 'auprc': 0.9972407325690718, 'loss_val': 0.1363497946239538, 'psi': 0.9911785388000975}
[S9] START round=29 head_norm_before_train=1.470417 cos_to_last_merge=0.9983 (last merge round=26)
[S9] round=29 local utility u=0.015661 metrics={'f1_val': 0.9963953425060355, 'auprc': 0.9962324424042568, 'loss_val': 0.05104835555418301, 'psi': 0.996330182465324}-{'f1_val': 0.9926423765407113, 'auprc': 0.9992019917804092, 'loss_val': 0.06876127646872603, 'psi': 0.9952662226365905}
[S10] START round=29 head_norm_before_train=2.071512 (no previous merge yet)
[S10] round=29 local utility u=0.000000 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.995532284343361, 'loss_val': 0.027214278137906403, 'psi': 0.9952749945830034}-{'f1_val': 0.9953063309450747, 'auprc': 0.99584838334372, 'loss_val': 0.02696619819823334, 'psi': 0.9955231519045329}
[S11] START round=29 head_norm_before_train=2.034469 (no previous merge yet)
[S11] round=29 local utility u=0.000707 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9976060576892106, 'loss_val': 0.03006443680273839, 'psi': 0.9969829054594125}-{'f1_val': 0.9965470045135896, 'auprc': 0.9975420038746929, 'loss_val': 0.031163769036192404, 'psi': 0.9969450042580309}
[S13] START round=29 head_norm_before_train=1.227532 cos_to_last_merge=0.9992 (last merge round=27)
[S13] round=29 local utility u=0.000000 metrics={'f1_val': 0.5818809356522845, 'auprc': 0.8479224462924146, 'loss_val': 0.8371311972425001, 'psi': 0.6882975399083365}-{'f1_val': 0.592478498315766, 'auprc': 0.9264197973193959, 'loss_val': 0.7498917883244968, 'psi': 0.726055017917218}
[S14] START round=29 head_norm_before_train=2.102392 (no previous merge yet)
[S14] round=29 local utility u=0.107109 metrics={'f1_val': 0.966100218347998, 'auprc': 0.9992325493775865, 'loss_val': 0.05634604322060162, 'psi': 0.9793531507598334}-{'f1_val': 0.9383527625584585, 'auprc': 0.9992346617934266, 'loss_val': 0.10408637428161076, 'psi': 0.9627055222524458}
[S15] START round=29 head_norm_before_train=1.373930 cos_to_last_merge=0.9960 (last merge round=27)
[S15] round=29 local utility u=0.000000 metrics={'f1_val': 0.9309865736063311, 'auprc': 0.9912545365883559, 'loss_val': 0.14364260529552797, 'psi': 0.955093758799141}-{'f1_val': 0.9408279485627797, 'auprc': 0.9894908760099406, 'loss_val': 0.19057028879075802, 'psi': 0.960293119541644}
[S16] START round=29 head_norm_before_train=1.979916 (no previous merge yet)
[S16] round=29 local utility u=0.031919 metrics={'f1_val': 0.9213042551166011, 'auprc': 0.99164482719452, 'loss_val': 0.38651978796762093, 'psi': 0.9494404839477686}-{'f1_val': 0.914832728487455, 'auprc': 0.9912504633890951, 'loss_val': 0.4103461379161288, 'psi': 0.945399822448111}
[S17] START round=29 head_norm_before_train=1.366961 cos_to_last_merge=0.9977 (last merge round=27)
[S17] round=29 local utility u=0.035713 metrics={'f1_val': 0.5965201626465331, 'auprc': 0.8491263299149159, 'loss_val': 0.8128601390063835, 'psi': 0.6975626295538861}-{'f1_val': 0.5887646423764876, 'auprc': 0.8494852389048778, 'loss_val': 0.838829305443008, 'psi': 0.6930528809878438}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:52816
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] sending update (kind=head size=1805 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S16] sending update (kind=head size=1791 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:52805
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:52815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:52811
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:52802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:52808
[S8] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1798) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=2.049813)
[S5] loaded HEAD from S11 (vec_in norm=2.049813)
[S5] cosine check vs S11: cos=-0.0365
[S5] DROPPED delta from S11 (cos=-0.0365 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1803) from S8
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.285239)
[S2] loaded HEAD from S8 (vec_in norm=1.285239)
[S2] cosine check vs S8: cos=0.5382
[S2] BUFFERED delta from S8 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1799) from S7
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.172305)
[S16] loaded HEAD from S7 (vec_in norm=1.172305)
[S16] cosine check vs S7: cos=0.6585
[S16] BUFFERED delta from S7 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1800) from S9
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.507468)
[S15] loaded HEAD from S9 (vec_in norm=1.507468)
[S15] cosine check vs S9: cos=0.9480
[S15] BUFFERED delta from S9 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1800) from S14
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=2.109040)
[S10] loaded HEAD from S14 (vec_in norm=2.109040)
[S10] cosine check vs S14: cos=-0.0456
[S10] DROPPED delta from S14 (cos=-0.0456 < 0.0)
[S17] sending update (kind=head size=1797 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1797) from S17
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.414361)
[S7] loaded HEAD from S17 (vec_in norm=1.414361)
[S7] cosine check vs S17: cos=0.7844
[S7] BUFFERED delta from S17 (total buffered=1)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=29 metric=0.9116 head_norm=2.025967
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.592910e-01
[S2] stored merged vector for next round verification (round=29)
[S2] DEBUG after merge:  round=29 metric=0.9118 head_norm=1.462809 delta_norm=0.859291
[S2] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=29 metric=0.9310 head_norm=1.448810
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.400199e-01
[S15] stored merged vector for next round verification (round=29)
[S15] DEBUG after merge:  round=29 metric=0.9189 head_norm=1.458816 delta_norm=0.240020
[S15] aggregate: ROLLBACK (f1_val pre=0.931 post=0.919 tol_abs=0.005 tol_rel=0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=29 metric=0.5917 head_norm=1.172305
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.397740e-01
[S7] stored merged vector for next round verification (round=29)
[S7] DEBUG after merge:  round=29 metric=0.5703 head_norm=1.222275 delta_norm=0.439774
[S7] aggregate: ROLLBACK (f1_val pre=0.592 post=0.570 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=29 metric=0.9213 head_norm=1.993406
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.534125e-01
[S16] stored merged vector for next round verification (round=29)
[S16] DEBUG after merge:  round=29 metric=0.9198 head_norm=1.451328 delta_norm=0.753412
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=1.462809 cos_to_last_merge=1.0000 (last merge round=29)
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.911475311824254, 'auprc': 0.9591620887635508, 'loss_val': 0.24056833134529393, 'psi': 0.9305500225999728}-{'f1_val': 0.9115799172641371, 'auprc': 0.9696131967390301, 'loss_val': 0.2685286962001931, 'psi': 0.9347932290540943}
[S3] START round=30 head_norm_before_train=2.080642 (no previous merge yet)
[S3] round=30 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9984906960428463, 'loss_val': 0.09182366096548998, 'psi': 0.9760174290804047}-{'f1_val': 0.9846966392084899, 'auprc': 0.9984967890933438, 'loss_val': 0.038354112262259536, 'psi': 0.9902166991624315}
[S4] START round=30 head_norm_before_train=1.947236 (no previous merge yet)
[S4] round=30 local utility u=0.049489 metrics={'f1_val': 0.9511492921093133, 'auprc': 0.9567143985476527, 'loss_val': 0.30075262847929235, 'psi': 0.9533753346846491}-{'f1_val': 0.9466917420338898, 'auprc': 0.9355208983311256, 'loss_val': 0.30940496174087806, 'psi': 0.9422234045527842}
[S5] START round=30 head_norm_before_train=1.554619 cos_to_last_merge=0.7699 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.770
[S5] round=30 local utility u=0.000000 metrics={'f1_val': 0.4388828763064277, 'auprc': 0.802732822069562, 'loss_val': 0.8541960741452802, 'psi': 0.5844228546116814}-{'f1_val': 0.7482102816706118, 'auprc': 0.9899818422180592, 'loss_val': 0.15914263977248283, 'psi': 0.8449189058895907}
[S6] START round=30 head_norm_before_train=1.996891 (no previous merge yet)
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.7426280733553189, 'auprc': 0.9316867220419641, 'loss_val': 0.8804790632113163, 'psi': 0.818251532829977}-{'f1_val': 0.864877533741503, 'auprc': 0.9752873291860232, 'loss_val': 0.29193282188205394, 'psi': 0.9090414519193111}
[S7] START round=30 head_norm_before_train=1.222275 cos_to_last_merge=1.0000 (last merge round=29)
[S7] round=30 local utility u=0.033226 metrics={'f1_val': 0.6163524716518514, 'auprc': 0.7881605766454662, 'loss_val': 0.8100601657772281, 'psi': 0.6850757136492973}-{'f1_val': 0.5916961865029022, 'auprc': 0.7965468325216254, 'loss_val': 0.7537332395757483, 'psi': 0.6736364449103915}
[S8] START round=30 head_norm_before_train=1.285239 cos_to_last_merge=0.9993 (last merge round=28)
[S8] round=30 local utility u=0.003928 metrics={'f1_val': 0.9928938724649488, 'auprc': 0.9847489683412326, 'loss_val': 0.06876690894933639, 'psi': 0.9896359108154622}-{'f1_val': 0.9934888194563342, 'auprc': 0.9853661214495196, 'loss_val': 0.08204449353039804, 'psi': 0.9902397402536083}
[S9] START round=30 head_norm_before_train=1.507468 cos_to_last_merge=0.9966 (last merge round=26)
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.9892740760156413, 'auprc': 0.9940175061076642, 'loss_val': 0.06110140188065429, 'psi': 0.9911714480524505}-{'f1_val': 0.9963953425060355, 'auprc': 0.9962324424042568, 'loss_val': 0.05104835555418301, 'psi': 0.996330182465324}
[S10] START round=30 head_norm_before_train=2.084002 (no previous merge yet)
[S10] round=30 local utility u=0.001035 metrics={'f1_val': 0.9953063309450747, 'auprc': 0.9956979599791752, 'loss_val': 0.02685901569683954, 'psi': 0.9954629825587149}-{'f1_val': 0.9951034680760983, 'auprc': 0.995532284343361, 'loss_val': 0.027214278137906403, 'psi': 0.9952749945830034}
[S11] START round=30 head_norm_before_train=2.049813 (no previous merge yet)
[S11] round=30 local utility u=0.000479 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9976416027255581, 'loss_val': 0.029213536167039974, 'psi': 0.9969971234739514}-{'f1_val': 0.996567470639547, 'auprc': 0.9976060576892106, 'loss_val': 0.03006443680273839, 'psi': 0.9969829054594125}
[S13] START round=30 head_norm_before_train=1.276444 cos_to_last_merge=0.9964 (last merge round=27)
[S13] round=30 local utility u=0.253566 metrics={'f1_val': 0.6186039389342127, 'auprc': 0.8788294328624886, 'loss_val': 0.6430591640765562, 'psi': 0.722694136505523}-{'f1_val': 0.5818809356522845, 'auprc': 0.8479224462924146, 'loss_val': 0.8371311972425001, 'psi': 0.6882975399083365}
[S14] START round=30 head_norm_before_train=2.109040 (no previous merge yet)
[S14] round=30 local utility u=0.113112 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9992328840700377, 'loss_val': 0.020439026962083048, 'psi': 0.9983848644083462}-{'f1_val': 0.966100218347998, 'auprc': 0.9992325493775865, 'loss_val': 0.05634604322060162, 'psi': 0.9793531507598334}
[S15] START round=30 head_norm_before_train=1.458816 cos_to_last_merge=1.0000 (last merge round=29)
[S15] round=30 local utility u=0.203869 metrics={'f1_val': 0.9883166813929687, 'auprc': 0.991504347882307, 'loss_val': 0.08063423624376775, 'psi': 0.9895917479887041}-{'f1_val': 0.9309865736063311, 'auprc': 0.9912545365883559, 'loss_val': 0.14364260529552797, 'psi': 0.955093758799141}
[S16] START round=30 head_norm_before_train=1.451328 cos_to_last_merge=1.0000 (last merge round=29)
[S16] round=30 local utility u=0.108541 metrics={'f1_val': 0.9365385851574485, 'auprc': 0.9923867492073759, 'loss_val': 0.2630702731378311, 'psi': 0.9588778507774195}-{'f1_val': 0.9213042551166011, 'auprc': 0.99164482719452, 'loss_val': 0.38651978796762093, 'psi': 0.9494404839477686}
[S17] START round=30 head_norm_before_train=1.414361 cos_to_last_merge=0.9915 (last merge round=27)
[S17] round=30 local utility u=0.023772 metrics={'f1_val': 0.6045153489527418, 'auprc': 0.8507070317276064, 'loss_val': 0.818029221031384, 'psi': 0.7029920220626877}-{'f1_val': 0.5965201626465331, 'auprc': 0.8491263299149159, 'loss_val': 0.8128601390063835, 'psi': 0.6975626295538861}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:52809
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:52802
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:52811
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:52816
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:52805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1803) from S15
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.516977)
[S8] loaded HEAD from S15 (vec_in norm=1.516977)
[S8] cosine check vs S15: cos=0.9512
[S8] BUFFERED delta from S15 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1798) from S8
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.330876)
[S2] loaded HEAD from S8 (vec_in norm=1.330876)
[S2] cosine check vs S8: cos=0.8022
[S2] BUFFERED delta from S8 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1800) from S7
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.239175)
[S16] loaded HEAD from S7 (vec_in norm=1.239175)
[S16] cosine check vs S7: cos=0.6291
[S16] BUFFERED delta from S7 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1801) from S14
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=2.115147)
[S10] loaded HEAD from S14 (vec_in norm=2.115147)
[S10] cosine check vs S14: cos=-0.0455
[S10] DROPPED delta from S14 (cos=-0.0455 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1801) from S13
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.317701)
[S17] loaded HEAD from S13 (vec_in norm=1.317701)
[S17] cosine check vs S13: cos=0.8261
[S17] BUFFERED delta from S13 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1802) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=2.065252)
[S5] loaded HEAD from S11 (vec_in norm=2.065252)
[S5] cosine check vs S11: cos=-0.0353
[S5] DROPPED delta from S11 (cos=-0.0353 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:52808
[S17] sending update (kind=head size=1795 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1795) from S17
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.455492)
[S7] loaded HEAD from S17 (vec_in norm=1.455492)
[S7] cosine check vs S17: cos=0.9487
[S7] BUFFERED delta from S17 (total buffered=1)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=30 metric=0.9115 head_norm=1.500598
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.525097e-01
[S2] stored merged vector for next round verification (round=30)
[S2] DEBUG after merge:  round=30 metric=0.9111 head_norm=1.344153 delta_norm=0.452510
[S2] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.017 → S15@127.0.0.1:52815
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=30 metric=0.6164 head_norm=1.239175
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.406748e-01
[S7] stored merged vector for next round verification (round=30)
[S7] DEBUG after merge:  round=30 metric=0.5899 head_norm=1.330068 delta_norm=0.240675
[S7] aggregate: ROLLBACK (f1_val pre=0.616 post=0.590 tol_abs=0.005 tol_rel=0.0)
[S7] ⇄ pheromone p=0.137 → S16@127.0.0.1:52816
[S14] ⇄ pheromone p=0.067 → S10@127.0.0.1:52811
[S13] ⇄ pheromone p=0.112 → S17@127.0.0.1:52817
[S11] ⇄ pheromone p=0.027 → S5@127.0.0.1:52805
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=30 metric=0.9929 head_norm=1.330876
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.406407e-01
[S8] stored merged vector for next round verification (round=30)
[S8] DEBUG after merge:  round=30 metric=0.9929 head_norm=1.406527 delta_norm=0.240641
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.019 → S2@127.0.0.1:52802
[S15] ⇄ pheromone p=0.270 → S8@127.0.0.1:52809
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=30 metric=0.9365 head_norm=1.475478
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.941608e-01
[S16] stored merged vector for next round verification (round=30)
[S16] DEBUG after merge:  round=30 metric=0.9366 head_norm=1.226078 delta_norm=0.594161
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=30 metric=0.6045 head_norm=1.455492
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.141021e-01
[S17] stored merged vector for next round verification (round=30)
[S17] DEBUG after merge:  round=30 metric=0.6054 head_norm=1.325109 delta_norm=0.414102
[S17] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.101 → S7@127.0.0.1:52808
[S2] START round=31 head_norm_before_train=1.344153 cos_to_last_merge=1.0000 (last merge round=30)
[S2] round=31 local utility u=0.000000 metrics={'f1_val': 0.8361162110952541, 'auprc': 0.9743295149830875, 'loss_val': 0.2682334263854836, 'psi': 0.8914015326503875}-{'f1_val': 0.911475311824254, 'auprc': 0.9591620887635508, 'loss_val': 0.24056833134529393, 'psi': 0.9305500225999728}
[S3] START round=31 head_norm_before_train=2.091584 (no previous merge yet)
[S3] round=31 local utility u=0.141255 metrics={'f1_val': 0.9973982357793907, 'auprc': 0.998503361092288, 'loss_val': 0.027528769395300554, 'psi': 0.9978402859045497}-{'f1_val': 0.9610352511054436, 'auprc': 0.9984906960428463, 'loss_val': 0.09182366096548998, 'psi': 0.9760174290804047}
[S4] START round=31 head_norm_before_train=1.948851 (no previous merge yet)
[S4] round=31 local utility u=0.000000 metrics={'f1_val': 0.9409788370815477, 'auprc': 0.923434141164761, 'loss_val': 0.32604748704049785, 'psi': 0.933960958714833}-{'f1_val': 0.9511492921093133, 'auprc': 0.9567143985476527, 'loss_val': 0.30075262847929235, 'psi': 0.9533753346846491}
[S5] START round=31 head_norm_before_train=1.566162 cos_to_last_merge=0.7696 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.770
[S5] round=31 local utility u=1.000000 metrics={'f1_val': 0.7009022086989503, 'auprc': 0.9889792841916734, 'loss_val': 0.2478840735525354, 'psi': 0.8161330388960395}-{'f1_val': 0.4388828763064277, 'auprc': 0.802732822069562, 'loss_val': 0.8541960741452802, 'psi': 0.5844228546116814}
[S6] START round=31 head_norm_before_train=2.009831 (no previous merge yet)
[S6] round=31 local utility u=0.142095 metrics={'f1_val': 0.7672662360208358, 'auprc': 0.9014985057049861, 'loss_val': 0.6535531065314458, 'psi': 0.8209591438944959}-{'f1_val': 0.7426280733553189, 'auprc': 0.9316867220419641, 'loss_val': 0.8804790632113163, 'psi': 0.818251532829977}
[S7] START round=31 head_norm_before_train=1.330068 cos_to_last_merge=1.0000 (last merge round=30)
[S7] round=31 local utility u=0.227688 metrics={'f1_val': 0.6598264781507317, 'auprc': 0.8253285881407054, 'loss_val': 0.7270328025608029, 'psi': 0.7260273221467213}-{'f1_val': 0.6163524716518514, 'auprc': 0.7881605766454662, 'loss_val': 0.8100601657772281, 'psi': 0.6850757136492973}
[S8] START round=31 head_norm_before_train=1.406527 cos_to_last_merge=1.0000 (last merge round=30)
[S8] round=31 local utility u=0.014542 metrics={'f1_val': 0.9916698259783234, 'auprc': 0.9939383962890755, 'loss_val': 0.059906108623494, 'psi': 0.9925772541026243}-{'f1_val': 0.9928938724649488, 'auprc': 0.9847489683412326, 'loss_val': 0.06876690894933639, 'psi': 0.9896359108154622}
[S9] START round=31 head_norm_before_train=1.538486 cos_to_last_merge=0.9950 (last merge round=26)
[S9] round=31 local utility u=0.036118 metrics={'f1_val': 0.996808967411047, 'auprc': 0.9956906405714809, 'loss_val': 0.03909500238728344, 'psi': 0.9963616366752206}-{'f1_val': 0.9892740760156413, 'auprc': 0.9940175061076642, 'loss_val': 0.06110140188065429, 'psi': 0.9911714480524505}
[S10] START round=31 head_norm_before_train=2.096528 (no previous merge yet)
[S10] round=31 local utility u=0.000000 metrics={'f1_val': 0.9948838907637279, 'auprc': 0.9955703183144706, 'loss_val': 0.02688161103240614, 'psi': 0.995158461784025}-{'f1_val': 0.9953063309450747, 'auprc': 0.9956979599791752, 'loss_val': 0.02685901569683954, 'psi': 0.9954629825587149}
[S11] START round=31 head_norm_before_train=2.065252 (no previous merge yet)
[S11] round=31 local utility u=0.000713 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9976886650706582, 'loss_val': 0.027805462614816593, 'psi': 0.997003668736417}-{'f1_val': 0.996567470639547, 'auprc': 0.9976416027255581, 'loss_val': 0.029213536167039974, 'psi': 0.9969971234739514}
[S13] START round=31 head_norm_before_train=1.317701 cos_to_last_merge=0.9928 (last merge round=27)
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.5872641975398667, 'auprc': 0.8709781984493516, 'loss_val': 0.8175480004517516, 'psi': 0.7007497979036608}-{'f1_val': 0.6186039389342127, 'auprc': 0.8788294328624886, 'loss_val': 0.6430591640765562, 'psi': 0.722694136505523}
[S14] START round=31 head_norm_before_train=2.115147 (no previous merge yet)
[S14] round=31 local utility u=0.000524 metrics={'f1_val': 0.9979900342899044, 'auprc': 0.9992340050211707, 'loss_val': 0.020417556758523404, 'psi': 0.9984876225824109}-{'f1_val': 0.9978195179672185, 'auprc': 0.9992328840700377, 'loss_val': 0.020439026962083048, 'psi': 0.9983848644083462}
[S15] START round=31 head_norm_before_train=1.516977 cos_to_last_merge=0.9993 (last merge round=29)
[S15] round=31 local utility u=0.000000 metrics={'f1_val': 0.937293238993142, 'auprc': 0.9906439544904738, 'loss_val': 0.11036118654602935, 'psi': 0.9586335251920747}-{'f1_val': 0.9883166813929687, 'auprc': 0.991504347882307, 'loss_val': 0.08063423624376775, 'psi': 0.9895917479887041}
[S16] START round=31 head_norm_before_train=1.226078 cos_to_last_merge=1.0000 (last merge round=30)
[S16] round=31 local utility u=0.000000 metrics={'f1_val': 0.8360824995985638, 'auprc': 0.9088176875668197, 'loss_val': 0.7419357746992319, 'psi': 0.8651765747858662}-{'f1_val': 0.9365385851574485, 'auprc': 0.9923867492073759, 'loss_val': 0.2630702731378311, 'psi': 0.9588778507774195}
[S17] START round=31 head_norm_before_train=1.325109 cos_to_last_merge=1.0000 (last merge round=30)
[S17] round=31 local utility u=0.103974 metrics={'f1_val': 0.6686776248054469, 'auprc': 0.7867889011071879, 'loss_val': 0.8033012282776864, 'psi': 0.7159221353261433}-{'f1_val': 0.6045153489527418, 'auprc': 0.8507070317276064, 'loss_val': 0.818029221031384, 'psi': 0.7029920220626877}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:52816
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:52811
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:52815
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:52812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:52815
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:52805
[S11] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1803) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.443353)
[S15] loaded HEAD from S8 (vec_in norm=1.443353)
[S15] cosine check vs S8: cos=0.9857
[S15] BUFFERED delta from S8 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1803) from S9
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.564442)
[S15] loaded HEAD from S9 (vec_in norm=1.564442)
[S15] cosine check vs S9: cos=0.9866
[S15] BUFFERED delta from S9 (total buffered=2)
[S16] RECEIVED delta(kind=head bytes=1801) from S7
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.345636)
[S16] loaded HEAD from S7 (vec_in norm=1.345636)
[S16] cosine check vs S7: cos=0.7899
[S16] BUFFERED delta from S7 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1800) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=2.081139)
[S5] loaded HEAD from S11 (vec_in norm=2.081139)
[S5] cosine check vs S11: cos=-0.0342
[S5] DROPPED delta from S11 (cos=-0.0342 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1799) from S5
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.572977)
[S11] loaded HEAD from S5 (vec_in norm=1.572977)
[S11] cosine check vs S5: cos=-0.0342
[S11] DROPPED delta from S5 (cos=-0.0342 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1800) from S14
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=2.123657)
[S10] loaded HEAD from S14 (vec_in norm=2.123657)
[S10] cosine check vs S14: cos=-0.0455
[S10] DROPPED delta from S14 (cos=-0.0455 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:52808
[S17] sending update (kind=head size=1795 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1795) from S17
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.364641)
[S7] loaded HEAD from S17 (vec_in norm=1.364641)
[S7] cosine check vs S17: cos=0.9695
[S7] BUFFERED delta from S17 (total buffered=1)
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S14
[S7]  timeout peer S15
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S8
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S11]  timeout peer S2
[S11]  timeout peer S4
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S16
[S9]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S8]  timeout peer S3
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S13
[S8]  timeout peer S16
[S8]  timeout peer S17
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=31 metric=0.8361 head_norm=1.265653
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.248207e-01
[S16] stored merged vector for next round verification (round=31)
[S16] DEBUG after merge:  round=31 metric=0.8363 head_norm=1.235246 delta_norm=0.424821
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=31 metric=0.9373 head_norm=1.550423
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.737725e-02
[S15] stored merged vector for next round verification (round=31)
[S15] DEBUG after merge:  round=31 metric=0.9383 head_norm=1.518360 delta_norm=0.077377
[S15] aggregate: ACCEPT kept=['S8', 'S9'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=31 metric=0.6598 head_norm=1.345636
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.675690e-01
[S7] stored merged vector for next round verification (round=31)
[S7] DEBUG after merge:  round=31 metric=0.6489 head_norm=1.344772 delta_norm=0.167569
[S7] aggregate: ROLLBACK (f1_val pre=0.660 post=0.649 tol_abs=0.005 tol_rel=0.0)
[S2] START round=32 head_norm_before_train=1.422286 cos_to_last_merge=0.9982 (last merge round=30)
[S2] round=32 local utility u=0.254390 metrics={'f1_val': 0.911475311824254, 'auprc': 0.9823542346671639, 'loss_val': 0.2356829725320405, 'psi': 0.9398268809614179}-{'f1_val': 0.8361162110952541, 'auprc': 0.9743295149830875, 'loss_val': 0.2682334263854836, 'psi': 0.8914015326503875}
[S3] START round=32 head_norm_before_train=2.101805 (no previous merge yet)
[S3] round=32 local utility u=0.000000 metrics={'f1_val': 0.9777729257200269, 'auprc': 0.9986641444958035, 'loss_val': 0.056078511452268984, 'psi': 0.9861294132303375}-{'f1_val': 0.9973982357793907, 'auprc': 0.998503361092288, 'loss_val': 0.027528769395300554, 'psi': 0.9978402859045497}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=32 head_norm_before_train=1.952192 (no previous merge yet)
[S4] round=32 local utility u=0.052355 metrics={'f1_val': 0.9513116308248897, 'auprc': 0.9406868354508487, 'loss_val': 0.33509316821314494, 'psi': 0.9470617126752733}-{'f1_val': 0.9409788370815477, 'auprc': 0.923434141164761, 'loss_val': 0.32604748704049785, 'psi': 0.933960958714833}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=32 head_norm_before_train=1.572977 cos_to_last_merge=0.7688 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.769
[S5] round=32 local utility u=0.000000 metrics={'f1_val': 0.5779895150986255, 'auprc': 0.8548750267074877, 'loss_val': 0.6550983982885711, 'psi': 0.6887437197421704}-{'f1_val': 0.7009022086989503, 'auprc': 0.9889792841916734, 'loss_val': 0.2478840735525354, 'psi': 0.8161330388960395}
[S6] START round=32 head_norm_before_train=2.019692 (no previous merge yet)
[S6] round=32 local utility u=0.399663 metrics={'f1_val': 0.8311537393815913, 'auprc': 0.9609162485449216, 'loss_val': 0.41580463799583334, 'psi': 0.8830587430469234}-{'f1_val': 0.7672662360208358, 'auprc': 0.9014985057049861, 'loss_val': 0.6535531065314458, 'psi': 0.8209591438944959}
[S6] not sending this round → trigger blocked (psi=0.883)
[S7] START round=32 head_norm_before_train=1.344772 cos_to_last_merge=1.0000 (last merge round=31)
[S7] round=32 local utility u=0.000000 metrics={'f1_val': 0.46879241824104223, 'auprc': 0.780404094812291, 'loss_val': 0.9656267099392379, 'psi': 0.5934370888695417}-{'f1_val': 0.6598264781507317, 'auprc': 0.8253285881407054, 'loss_val': 0.7270328025608029, 'psi': 0.7260273221467213}
[S8] START round=32 head_norm_before_train=1.443353 cos_to_last_merge=0.9997 (last merge round=30)
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.9942226369520374, 'auprc': 0.9843113737079598, 'loss_val': 0.052538755377105714, 'psi': 0.9902581316544063}-{'f1_val': 0.9916698259783234, 'auprc': 0.9939383962890755, 'loss_val': 0.059906108623494, 'psi': 0.9925772541026243}
[S9] START round=32 head_norm_before_train=1.564442 cos_to_last_merge=0.9934 (last merge round=26)
[S9] round=32 local utility u=0.002589 metrics={'f1_val': 0.9955666097086097, 'auprc': 0.9994821659913691, 'loss_val': 0.03783677258109358, 'psi': 0.9971328322217134}-{'f1_val': 0.996808967411047, 'auprc': 0.9956906405714809, 'loss_val': 0.03909500238728344, 'psi': 0.9963616366752206}
[S10] START round=32 head_norm_before_train=2.107836 (no previous merge yet)
[S10] round=32 local utility u=0.000348 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9953440154626315, 'loss_val': 0.02682398905747468, 'psi': 0.9951996870307116}-{'f1_val': 0.9948838907637279, 'auprc': 0.9955703183144706, 'loss_val': 0.02688161103240614, 'psi': 0.995158461784025}
[S11] START round=32 head_norm_before_train=2.081139 (no previous merge yet)
[S11] round=32 local utility u=0.000000 metrics={'f1_val': 0.9927900074047047, 'auprc': 0.9971923550766031, 'loss_val': 0.03822022943715538, 'psi': 0.9945509464734641}-{'f1_val': 0.9965470045135896, 'auprc': 0.9976886650706582, 'loss_val': 0.027805462614816593, 'psi': 0.997003668736417}
[S13] START round=32 head_norm_before_train=1.343083 cos_to_last_merge=0.9903 (last merge round=27)
[S13] round=32 local utility u=0.334166 metrics={'f1_val': 0.6373964532092135, 'auprc': 0.901153434389273, 'loss_val': 0.5405355255850128, 'psi': 0.7428992456812373}-{'f1_val': 0.5872641975398667, 'auprc': 0.8709781984493516, 'loss_val': 0.8175480004517516, 'psi': 0.7007497979036608}
[S14] START round=32 head_norm_before_train=2.123657 (no previous merge yet)
[S14] round=32 local utility u=0.000000 metrics={'f1_val': 0.995501598651872, 'auprc': 0.9992345093004267, 'loss_val': 0.027007919503032867, 'psi': 0.996994762911294}-{'f1_val': 0.9979900342899044, 'auprc': 0.9992340050211707, 'loss_val': 0.020417556758523404, 'psi': 0.9984876225824109}
[S15] START round=32 head_norm_before_train=1.518360 cos_to_last_merge=1.0000 (last merge round=31)
[S15] round=32 local utility u=0.000000 metrics={'f1_val': 0.6926633417809875, 'auprc': 0.9002952905073263, 'loss_val': 0.5299948342401068, 'psi': 0.7757161212715231}-{'f1_val': 0.937293238993142, 'auprc': 0.9906439544904738, 'loss_val': 0.11036118654602935, 'psi': 0.9586335251920747}
[S16] START round=32 head_norm_before_train=1.235246 cos_to_last_merge=1.0000 (last merge round=31)
[S16] round=32 local utility u=0.603498 metrics={'f1_val': 0.938198320929516, 'auprc': 0.9867502193373731, 'loss_val': 0.3814331342668365, 'psi': 0.9576190802926589}-{'f1_val': 0.8360824995985638, 'auprc': 0.9088176875668197, 'loss_val': 0.7419357746992319, 'psi': 0.8651765747858662}
[S17] START round=32 head_norm_before_train=1.364641 cos_to_last_merge=0.9994 (last merge round=30)
[S17] round=32 local utility u=0.000000 metrics={'f1_val': 0.5933036758386457, 'auprc': 0.6039967555476107, 'loss_val': 0.9496365073700511, 'psi': 0.5975809077222317}-{'f1_val': 0.6686776248054469, 'auprc': 0.7867889011071879, 'loss_val': 0.8033012282776864, 'psi': 0.7159221353261433}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:52808
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:52815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:52814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:52809
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1802 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] RECEIVED delta(kind=head bytes=1797) from S9
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.586643)
[S15] loaded HEAD from S9 (vec_in norm=1.586643)
[S15] cosine check vs S9: cos=0.9890
[S15] BUFFERED delta from S9 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1800) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=2.114591)
[S14] loaded HEAD from S10 (vec_in norm=2.114591)
[S14] cosine check vs S10: cos=-0.0454
[S14] DROPPED delta from S10 (cos=-0.0454 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1802) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.284245)
[S7] loaded HEAD from S16 (vec_in norm=1.284245)
[S7] cosine check vs S16: cos=0.9260
[S7] BUFFERED delta from S16 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1798) from S2
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.501933)
[S8] loaded HEAD from S2 (vec_in norm=1.501933)
[S8] cosine check vs S2: cos=0.8716
[S8] BUFFERED delta from S2 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1803) from S13
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.366039)
[S17] loaded HEAD from S13 (vec_in norm=1.366039)
[S17] cosine check vs S13: cos=0.9455
[S17] BUFFERED delta from S13 (total buffered=1)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=32 metric=0.6927 head_norm=1.539140
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.181917e-01
[S15] stored merged vector for next round verification (round=32)
[S15] DEBUG after merge:  round=32 metric=0.6927 head_norm=1.558597 delta_norm=0.118192
[S15] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S7] CommDone barrier timeout: have=1 need=2 — continuing
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=32 metric=0.4688 head_norm=1.364830
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.578676e-01
[S7] stored merged vector for next round verification (round=32)
[S7] DEBUG after merge:  round=32 metric=0.5102 head_norm=1.299818 delta_norm=0.257868
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S8] RoundReady barrier timeout: have=2 need=4 — continuing
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] RoundReady barrier timeout: have=2 need=3 — continuing
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13]  timeout peer S17
[S7]  timeout peer S13
[S7]  timeout peer S16
[S8]  timeout peer S2
[S8]  timeout peer S4
[S8]  timeout peer S11
[S8]  timeout peer S14
[S11]  timeout peer S3
[S11]  timeout peer S5
[S9]  timeout peer S15
[S14]  timeout peer S10
[S15]  timeout peer S8
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S9
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=32 metric=0.5933 head_norm=1.401703
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.291492e-01
[S17] stored merged vector for next round verification (round=32)
[S17] DEBUG after merge:  round=32 metric=0.5936 head_norm=1.364884 delta_norm=0.229149
[S17] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=32 metric=0.9942 head_norm=1.471343
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.770380e-01
[S8] stored merged vector for next round verification (round=32)
[S8] DEBUG after merge:  round=32 metric=0.9942 head_norm=1.438113 delta_norm=0.377038
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=33 head_norm_before_train=1.501933 cos_to_last_merge=0.9940 (last merge round=30)
[S2] round=33 local utility u=0.000000 metrics={'f1_val': 0.9120102762433575, 'auprc': 0.9790317122509028, 'loss_val': 0.24420046481522067, 'psi': 0.9388188506463756}-{'f1_val': 0.911475311824254, 'auprc': 0.9823542346671639, 'loss_val': 0.2356829725320405, 'psi': 0.9398268809614179}
[S3] START round=33 head_norm_before_train=2.110833 (no previous merge yet)
[S3] round=33 local utility u=0.063782 metrics={'f1_val': 0.9948994170532618, 'auprc': 0.9986668622712528, 'loss_val': 0.031281777913408325, 'psi': 0.9964063951404583}-{'f1_val': 0.9777729257200269, 'auprc': 0.9986641444958035, 'loss_val': 0.056078511452268984, 'psi': 0.9861294132303375}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=33 head_norm_before_train=1.950046 (no previous merge yet)
[S4] round=33 local utility u=0.002087 metrics={'f1_val': 0.9422103955133172, 'auprc': 0.9576592804795832, 'loss_val': 0.3272288012827884, 'psi': 0.9483899494998236}-{'f1_val': 0.9513116308248897, 'auprc': 0.9406868354508487, 'loss_val': 0.33509316821314494, 'psi': 0.9470617126752733}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=33 head_norm_before_train=1.576119 cos_to_last_merge=0.7676 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.768
[S5] round=33 local utility u=1.000000 metrics={'f1_val': 0.9967570864652012, 'auprc': 0.9949231854584035, 'loss_val': 0.11452103418798101, 'psi': 0.9960235260624821}-{'f1_val': 0.5779895150986255, 'auprc': 0.8548750267074877, 'loss_val': 0.6550983982885711, 'psi': 0.6887437197421704}
[S6] START round=33 head_norm_before_train=2.028936 (no previous merge yet)
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.8103122505012088, 'auprc': 0.9692275513801191, 'loss_val': 0.4427118281666835, 'psi': 0.8738783708527729}-{'f1_val': 0.8311537393815913, 'auprc': 0.9609162485449216, 'loss_val': 0.41580463799583334, 'psi': 0.8830587430469234}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=33 head_norm_before_train=1.299818 cos_to_last_merge=1.0000 (last merge round=32)
[S7] round=33 local utility u=0.765037 metrics={'f1_val': 0.6485111372164711, 'auprc': 0.8063355793386457, 'loss_val': 0.5916600033473765, 'psi': 0.711640914065341}-{'f1_val': 0.46879241824104223, 'auprc': 0.780404094812291, 'loss_val': 0.9656267099392379, 'psi': 0.5934370888695417}
[S8] START round=33 head_norm_before_train=1.438113 cos_to_last_merge=1.0000 (last merge round=32)
[S8] round=33 local utility u=0.000000 metrics={'f1_val': 0.9766772540677624, 'auprc': 0.9982722156584185, 'loss_val': 0.09132508004736968, 'psi': 0.9853152387040249}-{'f1_val': 0.9942226369520374, 'auprc': 0.9843113737079598, 'loss_val': 0.052538755377105714, 'psi': 0.9902581316544063}
[S9] START round=33 head_norm_before_train=1.586643 cos_to_last_merge=0.9920 (last merge round=26)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.9938968689134425, 'auprc': 0.9994998837400355, 'loss_val': 0.03796140036281856, 'psi': 0.9961380748440798}-{'f1_val': 0.9955666097086097, 'auprc': 0.9994821659913691, 'loss_val': 0.03783677258109358, 'psi': 0.9971328322217134}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=33 head_norm_before_train=2.114591 (no previous merge yet)
[S10] round=33 local utility u=0.000605 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.995591961189055, 'loss_val': 0.026357442991658438, 'psi': 0.995298865321281}-{'f1_val': 0.9951034680760983, 'auprc': 0.9953440154626315, 'loss_val': 0.02682398905747468, 'psi': 0.9951996870307116}
[S11] START round=33 head_norm_before_train=2.094560 (no previous merge yet)
[S11] round=33 local utility u=0.004130 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9963876847232443, 'loss_val': 0.047730303697232475, 'psi': 0.996247558735745}-{'f1_val': 0.9927900074047047, 'auprc': 0.9971923550766031, 'loss_val': 0.03822022943715538, 'psi': 0.9945509464734641}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=33 head_norm_before_train=1.366039 cos_to_last_merge=0.9879 (last merge round=27)
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.573110120959502, 'auprc': 0.86102855227715, 'loss_val': 0.8657764078582816, 'psi': 0.6882774934865612}-{'f1_val': 0.6373964532092135, 'auprc': 0.901153434389273, 'loss_val': 0.5405355255850128, 'psi': 0.7428992456812373}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=33 head_norm_before_train=2.130801 (no previous merge yet)
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.9624218924614607, 'auprc': 0.9992320345976168, 'loss_val': 0.058170963195670854, 'psi': 0.9771459493159231}-{'f1_val': 0.995501598651872, 'auprc': 0.9992345093004267, 'loss_val': 0.027007919503032867, 'psi': 0.996994762911294}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=33 head_norm_before_train=1.558597 cos_to_last_merge=1.0000 (last merge round=32)
[S15] round=33 local utility u=1.000000 metrics={'f1_val': 0.9963755136436562, 'auprc': 0.9908307977729893, 'loss_val': 0.04456392569506557, 'psi': 0.9941576272953895}-{'f1_val': 0.6926633417809875, 'auprc': 0.9002952905073263, 'loss_val': 0.5299948342401068, 'psi': 0.7757161212715231}
[S16] START round=33 head_norm_before_train=1.284245 cos_to_last_merge=0.9966 (last merge round=31)
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.8941865587268769, 'auprc': 0.9641514426331559, 'loss_val': 0.4849967424047114, 'psi': 0.9221725122893886}-{'f1_val': 0.938198320929516, 'auprc': 0.9867502193373731, 'loss_val': 0.3814331342668365, 'psi': 0.9576190802926589}
[S17] START round=33 head_norm_before_train=1.364884 cos_to_last_merge=1.0000 (last merge round=32)
[S17] round=33 local utility u=1.000000 metrics={'f1_val': 0.7359519400375749, 'auprc': 0.9395794523054226, 'loss_val': 0.6375569218093342, 'psi': 0.817402944944714}-{'f1_val': 0.5933036758386457, 'auprc': 0.6039967555476107, 'loss_val': 0.9496365073700511, 'psi': 0.5975809077222317}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=34 head_norm_before_train=1.574129 cos_to_last_merge=0.9891 (last merge round=30)
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.8910310055077314, 'auprc': 0.9837692275075834, 'loss_val': 0.2775259681251758, 'psi': 0.9281262943076722}-{'f1_val': 0.9120102762433575, 'auprc': 0.9790317122509028, 'loss_val': 0.24420046481522067, 'psi': 0.9388188506463756}
[S3] START round=34 head_norm_before_train=2.121739 (no previous merge yet)
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.932811158571069, 'auprc': 0.9983197739002363, 'loss_val': 0.18182026215099983, 'psi': 0.9590146047027359}-{'f1_val': 0.9948994170532618, 'auprc': 0.9986668622712528, 'loss_val': 0.031281777913408325, 'psi': 0.9964063951404583}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=34 head_norm_before_train=1.946764 (no previous merge yet)
[S4] round=34 local utility u=0.000000 metrics={'f1_val': 0.9237443867008797, 'auprc': 0.909610990699756, 'loss_val': 0.4156457634658119, 'psi': 0.9180910283004302}-{'f1_val': 0.9422103955133172, 'auprc': 0.9576592804795832, 'loss_val': 0.3272288012827884, 'psi': 0.9483899494998236}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=34 head_norm_before_train=1.578541 cos_to_last_merge=0.7668 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.767
[S5] round=34 local utility u=0.000000 metrics={'f1_val': 0.6749527100753527, 'auprc': 0.928367878314198, 'loss_val': 0.3941889208624724, 'psi': 0.7763187773708908}-{'f1_val': 0.9967570864652012, 'auprc': 0.9949231854584035, 'loss_val': 0.11452103418798101, 'psi': 0.9960235260624821}
[S6] START round=34 head_norm_before_train=2.041334 (no previous merge yet)
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.6072126481051174, 'auprc': 0.863574767497365, 'loss_val': 1.2944330414482719, 'psi': 0.7097574958620164}-{'f1_val': 0.8103122505012088, 'auprc': 0.9692275513801191, 'loss_val': 0.4427118281666835, 'psi': 0.8738783708527729}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=34 head_norm_before_train=1.325070 cos_to_last_merge=0.9992 (last merge round=32)
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.5662542168818052, 'auprc': 0.7836932432854563, 'loss_val': 0.8123894588175447, 'psi': 0.6532298274432657}-{'f1_val': 0.6485111372164711, 'auprc': 0.8063355793386457, 'loss_val': 0.5916600033473765, 'psi': 0.711640914065341}
[S8] START round=34 head_norm_before_train=1.466435 cos_to_last_merge=0.9999 (last merge round=32)
[S8] round=34 local utility u=0.051312 metrics={'f1_val': 0.9921646161217188, 'auprc': 0.9896615014874017, 'loss_val': 0.05579357576554813, 'psi': 0.9911633702679921}-{'f1_val': 0.9766772540677624, 'auprc': 0.9982722156584185, 'loss_val': 0.09132508004736968, 'psi': 0.9853152387040249}
[S9] START round=34 head_norm_before_train=1.605128 cos_to_last_merge=0.9908 (last merge round=26)
[S9] round=34 local utility u=0.004064 metrics={'f1_val': 0.996808967411047, 'auprc': 0.9941460206044763, 'loss_val': 0.03124384417014533, 'psi': 0.9957437886884187}-{'f1_val': 0.9938968689134425, 'auprc': 0.9994998837400355, 'loss_val': 0.03796140036281856, 'psi': 0.9961380748440798}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=34 head_norm_before_train=2.120793 (no previous merge yet)
[S10] round=34 local utility u=0.000909 metrics={'f1_val': 0.9953063309450747, 'auprc': 0.9956824834868205, 'loss_val': 0.026027533693497605, 'psi': 0.9954567919617731}-{'f1_val': 0.9951034680760983, 'auprc': 0.995591961189055, 'loss_val': 0.026357442991658438, 'psi': 0.995298865321281}
[S11] START round=34 head_norm_before_train=2.107153 (no previous merge yet)
[S11] round=34 local utility u=0.011825 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9972943603543957, 'loss_val': 0.026801190764439597, 'psi': 0.9966102289882055}-{'f1_val': 0.9961541414107454, 'auprc': 0.9963876847232443, 'loss_val': 0.047730303697232475, 'psi': 0.996247558735745}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=34 head_norm_before_train=1.383662 cos_to_last_merge=0.9858 (last merge round=27)
[S13] round=34 local utility u=0.506969 metrics={'f1_val': 0.6622958472791332, 'auprc': 0.9397770603292901, 'loss_val': 0.6231980010966511, 'psi': 0.7732883324991959}-{'f1_val': 0.573110120959502, 'auprc': 0.86102855227715, 'loss_val': 0.8657764078582816, 'psi': 0.6882774934865612}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=34 head_norm_before_train=2.138484 (no previous merge yet)
[S14] round=34 local utility u=0.044035 metrics={'f1_val': 0.9751047262688567, 'auprc': 0.9988451146447718, 'loss_val': 0.045036431620884616, 'psi': 0.9846008816192228}-{'f1_val': 0.9624218924614607, 'auprc': 0.9992320345976168, 'loss_val': 0.058170963195670854, 'psi': 0.9771459493159231}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] START round=34 head_norm_before_train=1.573803 cos_to_last_merge=0.9999 (last merge round=32)
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.7252902630547263, 'auprc': 0.984205622909545, 'loss_val': 0.47693793046000044, 'psi': 0.8288564069966539}-{'f1_val': 0.9963755136436562, 'auprc': 0.9908307977729893, 'loss_val': 0.04456392569506557, 'psi': 0.9941576272953895}
[S16] START round=34 head_norm_before_train=1.357808 cos_to_last_merge=0.9846 (last merge round=31)
[S16] round=34 local utility u=0.402341 metrics={'f1_val': 0.9623397031951533, 'auprc': 0.9912663194396854, 'loss_val': 0.17057840096046753, 'psi': 0.9739103496929661}-{'f1_val': 0.8941865587268769, 'auprc': 0.9641514426331559, 'loss_val': 0.4849967424047114, 'psi': 0.9221725122893886}
[S17] START round=34 head_norm_before_train=1.390730 cos_to_last_merge=0.9998 (last merge round=32)
[S17] round=34 local utility u=0.021740 metrics={'f1_val': 0.7891508107451661, 'auprc': 0.8373282145729439, 'loss_val': 0.6065165689439509, 'psi': 0.8084217722762772}-{'f1_val': 0.7359519400375749, 'auprc': 0.9395794523054226, 'loss_val': 0.6375569218093342, 'psi': 0.817402944944714}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] sending update (kind=head size=1805 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.995)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.808)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=35 head_norm_before_train=1.634849 cos_to_last_merge=0.9846 (last merge round=30)
[S2] round=35 local utility u=0.067412 metrics={'f1_val': 0.9115772180766027, 'auprc': 0.9824862754325199, 'loss_val': 0.26213060192335036, 'psi': 0.9399408410189696}-{'f1_val': 0.8910310055077314, 'auprc': 0.9837692275075834, 'loss_val': 0.2775259681251758, 'psi': 0.9281262943076722}
[S3] START round=35 head_norm_before_train=2.132306 (no previous merge yet)
[S3] round=35 local utility u=0.274565 metrics={'f1_val': 0.9973696976584205, 'auprc': 0.9984993678487861, 'loss_val': 0.0205796656808719, 'psi': 0.9978215657345668}-{'f1_val': 0.932811158571069, 'auprc': 0.9983197739002363, 'loss_val': 0.18182026215099983, 'psi': 0.9590146047027359}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=35 head_norm_before_train=1.942474 (no previous merge yet)
[S4] round=35 local utility u=0.190291 metrics={'f1_val': 0.9480918867156591, 'auprc': 0.9560600577628455, 'loss_val': 0.32049596343744874, 'psi': 0.9512791551345336}-{'f1_val': 0.9237443867008797, 'auprc': 0.909610990699756, 'loss_val': 0.4156457634658119, 'psi': 0.9180910283004302}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] sending update (kind=head size=1795 to 1 peers)
[S5] START round=35 head_norm_before_train=1.583002 cos_to_last_merge=0.7668 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.767
[S5] round=35 local utility u=0.885082 metrics={'f1_val': 0.8959341500810498, 'auprc': 0.9900462288990358, 'loss_val': 0.13494903421233234, 'psi': 0.9335789816082442}-{'f1_val': 0.6749527100753527, 'auprc': 0.928367878314198, 'loss_val': 0.3941889208624724, 'psi': 0.7763187773708908}
[S6] START round=35 head_norm_before_train=2.058352 (no previous merge yet)
[S6] round=35 local utility u=1.000000 metrics={'f1_val': 0.8807029287505295, 'auprc': 0.9766972835238579, 'loss_val': 0.20923905710592844, 'psi': 0.9191006706598609}-{'f1_val': 0.6072126481051174, 'auprc': 0.863574767497365, 'loss_val': 1.2944330414482719, 'psi': 0.7097574958620164}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=35 head_norm_before_train=1.347950 cos_to_last_merge=0.9974 (last merge round=32)
[S7] round=35 local utility u=0.799881 metrics={'f1_val': 0.6992601949445102, 'auprc': 0.9016232644205309, 'loss_val': 0.36445375332386915, 'psi': 0.7802054227349184}-{'f1_val': 0.5662542168818052, 'auprc': 0.7836932432854563, 'loss_val': 0.8123894588175447, 'psi': 0.6532298274432657}
[S8] START round=35 head_norm_before_train=1.490752 cos_to_last_merge=0.9995 (last merge round=32)
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.9770490004777783, 'auprc': 0.9984897042744212, 'loss_val': 0.0869255317818175, 'psi': 0.9856252819964354}-{'f1_val': 0.9921646161217188, 'auprc': 0.9896615014874017, 'loss_val': 0.05579357576554813, 'psi': 0.9911633702679921}
[S9] START round=35 head_norm_before_train=1.623210 cos_to_last_merge=0.9896 (last merge round=26)
[S9] round=35 local utility u=0.002822 metrics={'f1_val': 0.9963953425060355, 'auprc': 0.9963608119290523, 'loss_val': 0.02976148320769009, 'psi': 0.9963815302752422}-{'f1_val': 0.996808967411047, 'auprc': 0.9941460206044763, 'loss_val': 0.03124384417014533, 'psi': 0.9957437886884187}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=35 head_norm_before_train=2.128290 (no previous merge yet)
[S10] round=35 local utility u=0.000000 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9954842420935555, 'loss_val': 0.026233665225566187, 'psi': 0.9952557776830812}-{'f1_val': 0.9953063309450747, 'auprc': 0.9956824834868205, 'loss_val': 0.026027533693497605, 'psi': 0.9954567919617731}
[S11] START round=35 head_norm_before_train=2.119127 (no previous merge yet)
[S11] round=35 local utility u=0.002465 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9976048570610276, 'loss_val': 0.025159161053155875, 'psi': 0.9969701455325648}-{'f1_val': 0.9961541414107454, 'auprc': 0.9972943603543957, 'loss_val': 0.026801190764439597, 'psi': 0.9966102289882055}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=35 head_norm_before_train=1.401293 cos_to_last_merge=0.9837 (last merge round=27)
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.6108195052132749, 'auprc': 0.8247594270098284, 'loss_val': 0.6943343405198278, 'psi': 0.6963954739318963}-{'f1_val': 0.6622958472791332, 'auprc': 0.9397770603292901, 'loss_val': 0.6231980010966511, 'psi': 0.7732883324991959}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=35 head_norm_before_train=2.145009 (no previous merge yet)
[S14] round=35 local utility u=0.082423 metrics={'f1_val': 0.9977998904431125, 'auprc': 0.9991989619580367, 'loss_val': 0.01742312886270277, 'psi': 0.9983595190490822}-{'f1_val': 0.9751047262688567, 'auprc': 0.9988451146447718, 'loss_val': 0.045036431620884616, 'psi': 0.9846008816192228}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=35 head_norm_before_train=1.583815 cos_to_last_merge=0.9999 (last merge round=32)
[S15] round=35 local utility u=0.321097 metrics={'f1_val': 0.8042910564604524, 'auprc': 0.9898927299629656, 'loss_val': 0.3258091904688378, 'psi': 0.8785317258614577}-{'f1_val': 0.7252902630547263, 'auprc': 0.984205622909545, 'loss_val': 0.47693793046000044, 'psi': 0.8288564069966539}
[S16] START round=35 head_norm_before_train=1.435244 cos_to_last_merge=0.9702 (last merge round=31)
[S16] round=35 local utility u=0.120055 metrics={'f1_val': 0.988912208026714, 'auprc': 0.9910552443473677, 'loss_val': 0.0892711799261223, 'psi': 0.9897694225549755}-{'f1_val': 0.9623397031951533, 'auprc': 0.9912663194396854, 'loss_val': 0.17057840096046753, 'psi': 0.9739103496929661}
[S17] START round=35 head_norm_before_train=1.413982 cos_to_last_merge=0.9994 (last merge round=32)
[S17] round=35 local utility u=0.000000 metrics={'f1_val': 0.6097701312351458, 'auprc': 0.8080332010778115, 'loss_val': 0.8865209441717523, 'psi': 0.6890753591722121}-{'f1_val': 0.7891508107451661, 'auprc': 0.8373282145729439, 'loss_val': 0.6065165689439509, 'psi': 0.8084217722762772}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] sending update (kind=head size=1805 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S2] START round=36 head_norm_before_train=1.680812 cos_to_last_merge=0.9811 (last merge round=30)
[S2] round=36 local utility u=0.025086 metrics={'f1_val': 0.9134075830440551, 'auprc': 0.9684719479157059, 'loss_val': 0.18089847211387705, 'psi': 0.9354333289927155}-{'f1_val': 0.9115772180766027, 'auprc': 0.9824862754325199, 'loss_val': 0.26213060192335036, 'psi': 0.9399408410189696}
[S3] START round=36 head_norm_before_train=2.141051 (no previous merge yet)
[S3] round=36 local utility u=0.000000 metrics={'f1_val': 0.9978100342676263, 'auprc': 0.9986617760636538, 'loss_val': 0.023951397254166163, 'psi': 0.9981507309860373}-{'f1_val': 0.9973696976584205, 'auprc': 0.9984993678487861, 'loss_val': 0.0205796656808719, 'psi': 0.9978215657345668}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=36 head_norm_before_train=1.921533 (no previous merge yet)
[S4] round=36 local utility u=0.027742 metrics={'f1_val': 0.9494302755223498, 'auprc': 0.9722551810401517, 'loss_val': 0.32162824943113333, 'psi': 0.9585602377294706}-{'f1_val': 0.9480918867156591, 'auprc': 0.9560600577628455, 'loss_val': 0.32049596343744874, 'psi': 0.9512791551345336}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=36 head_norm_before_train=1.589300 cos_to_last_merge=0.7663 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.766
[S5] round=36 local utility u=0.000000 metrics={'f1_val': 0.7007406076076139, 'auprc': 0.9877760399863509, 'loss_val': 0.26126168825044555, 'psi': 0.8155547805591088}-{'f1_val': 0.8959341500810498, 'auprc': 0.9900462288990358, 'loss_val': 0.13494903421233234, 'psi': 0.9335789816082442}
[S6] START round=36 head_norm_before_train=2.068810 (no previous merge yet)
[S6] round=36 local utility u=0.000000 metrics={'f1_val': 0.8762104248282705, 'auprc': 0.9754941423012914, 'loss_val': 0.2661901274112655, 'psi': 0.9159239118174788}-{'f1_val': 0.8807029287505295, 'auprc': 0.9766972835238579, 'loss_val': 0.20923905710592844, 'psi': 0.9191006706598609}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=36 head_norm_before_train=1.365447 cos_to_last_merge=0.9956 (last merge round=32)
[S7] round=36 local utility u=0.000000 metrics={'f1_val': 0.6516197310707057, 'auprc': 0.7912975074419247, 'loss_val': 0.5999233502224314, 'psi': 0.7074908416191934}-{'f1_val': 0.6992601949445102, 'auprc': 0.9016232644205309, 'loss_val': 0.36445375332386915, 'psi': 0.7802054227349184}
[S8] START round=36 head_norm_before_train=1.510362 cos_to_last_merge=0.9991 (last merge round=32)
[S8] round=36 local utility u=0.054983 metrics={'f1_val': 0.9942226369520374, 'auprc': 0.987782595805095, 'loss_val': 0.0478803169152896, 'psi': 0.9916466204932605}-{'f1_val': 0.9770490004777783, 'auprc': 0.9984897042744212, 'loss_val': 0.0869255317818175, 'psi': 0.9856252819964354}
[S9] START round=36 head_norm_before_train=1.639491 cos_to_last_merge=0.9886 (last merge round=26)
[S9] round=36 local utility u=0.002616 metrics={'f1_val': 0.9963953425060355, 'auprc': 0.9976290864349191, 'loss_val': 0.028335148166405397, 'psi': 0.9968888400775889}-{'f1_val': 0.9963953425060355, 'auprc': 0.9963608119290523, 'loss_val': 0.02976148320769009, 'psi': 0.9963815302752422}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=36 head_norm_before_train=2.138079 (no previous merge yet)
[S10] round=36 local utility u=0.000000 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9953459528197411, 'loss_val': 0.026316070750126867, 'psi': 0.9952004619735554}-{'f1_val': 0.9951034680760983, 'auprc': 0.9954842420935555, 'loss_val': 0.026233665225566187, 'psi': 0.9952557776830812}
[S11] START round=36 head_norm_before_train=2.130815 (no previous merge yet)
[S11] round=36 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9972679309278395, 'loss_val': 0.025994721261747067, 'psi': 0.9968353750792895}-{'f1_val': 0.9965470045135896, 'auprc': 0.9976048570610276, 'loss_val': 0.025159161053155875, 'psi': 0.9969701455325648}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=36 head_norm_before_train=1.416392 cos_to_last_merge=0.9821 (last merge round=27)
[S13] round=36 local utility u=0.082486 metrics={'f1_val': 0.6541320368279298, 'auprc': 0.8207782820439387, 'loss_val': 0.7772939209585448, 'psi': 0.7207905349143333}-{'f1_val': 0.6108195052132749, 'auprc': 0.8247594270098284, 'loss_val': 0.6943343405198278, 'psi': 0.6963954739318963}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] sending update (kind=head size=1795 to 1 peers)
[S14] START round=36 head_norm_before_train=2.152867 (no previous merge yet)
[S14] round=36 local utility u=0.000348 metrics={'f1_val': 0.9978217593544257, 'auprc': 0.9991958534190525, 'loss_val': 0.016849872053217044, 'psi': 0.9983713969802764}-{'f1_val': 0.9977998904431125, 'auprc': 0.9991989619580367, 'loss_val': 0.01742312886270277, 'psi': 0.9983595190490822}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=36 head_norm_before_train=1.593543 cos_to_last_merge=0.9997 (last merge round=32)
[S15] round=36 local utility u=0.000000 metrics={'f1_val': 0.8017956308117612, 'auprc': 0.9882526986639898, 'loss_val': 0.33335654507154955, 'psi': 0.8763784579526526}-{'f1_val': 0.8042910564604524, 'auprc': 0.9898927299629656, 'loss_val': 0.3258091904688378, 'psi': 0.8785317258614577}
[S16] START round=36 head_norm_before_train=1.500871 cos_to_last_merge=0.9584 (last merge round=31)
[S16] round=36 local utility u=0.000000 metrics={'f1_val': 0.9380243717834862, 'auprc': 0.9922463793322134, 'loss_val': 0.277022907776642, 'psi': 0.959713174802977}-{'f1_val': 0.988912208026714, 'auprc': 0.9910552443473677, 'loss_val': 0.0892711799261223, 'psi': 0.9897694225549755}
[S17] START round=36 head_norm_before_train=1.432004 cos_to_last_merge=0.9989 (last merge round=32)
[S17] round=36 local utility u=0.000000 metrics={'f1_val': 0.5972732963001599, 'auprc': 0.7194711063862649, 'loss_val': 0.9459070173690838, 'psi': 0.6461524203346019}-{'f1_val': 0.6097701312351458, 'auprc': 0.8080332010778115, 'loss_val': 0.8865209441717523, 'psi': 0.6890753591722121}
[S2] not sending this round → trigger blocked (psi=0.935)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S8] sending update (kind=head size=1807 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=37 head_norm_before_train=1.714086 cos_to_last_merge=0.9786 (last merge round=30)
[S2] round=37 local utility u=0.000000 metrics={'f1_val': 0.8947900812916445, 'auprc': 0.9813771485478335, 'loss_val': 0.2890638051411615, 'psi': 0.9294249081941202}-{'f1_val': 0.9134075830440551, 'auprc': 0.9684719479157059, 'loss_val': 0.18089847211387705, 'psi': 0.9354333289927155}
[S3] START round=37 head_norm_before_train=2.148557 (no previous merge yet)
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.9307578479511782, 'auprc': 0.9983095035412244, 'loss_val': 0.20577090396067857, 'psi': 0.9577785101871967}-{'f1_val': 0.9978100342676263, 'auprc': 0.9986617760636538, 'loss_val': 0.023951397254166163, 'psi': 0.9981507309860373}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=37 head_norm_before_train=1.918380 (no previous merge yet)
[S4] round=37 local utility u=0.000139 metrics={'f1_val': 0.9480208900859023, 'auprc': 0.9720096211489269, 'loss_val': 0.3121577809719482, 'psi': 0.9576163825111121}-{'f1_val': 0.9494302755223498, 'auprc': 0.9722551810401517, 'loss_val': 0.32162824943113333, 'psi': 0.9585602377294706}
[S4] not sending this round → trigger blocked (psi=0.958)
[S5] START round=37 head_norm_before_train=1.598006 cos_to_last_merge=0.7661 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.766
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.700781124122831, 'auprc': 0.9402896119112338, 'loss_val': 0.37296792188593064, 'psi': 0.7965845192381922}-{'f1_val': 0.7007406076076139, 'auprc': 0.9877760399863509, 'loss_val': 0.26126168825044555, 'psi': 0.8155547805591088}
[S6] START round=37 head_norm_before_train=2.079747 (no previous merge yet)
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.6115517499145311, 'auprc': 0.8994701431723073, 'loss_val': 0.8555418811074411, 'psi': 0.7267191072176415}-{'f1_val': 0.8762104248282705, 'auprc': 0.9754941423012914, 'loss_val': 0.2661901274112655, 'psi': 0.9159239118174788}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=37 head_norm_before_train=1.379948 cos_to_last_merge=0.9940 (last merge round=32)
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.5757296875091139, 'auprc': 0.7820766538496606, 'loss_val': 0.8039367609517641, 'psi': 0.6582684740453326}-{'f1_val': 0.6516197310707057, 'auprc': 0.7912975074419247, 'loss_val': 0.5999233502224314, 'psi': 0.7074908416191934}
[S8] START round=37 head_norm_before_train=1.528948 cos_to_last_merge=0.9987 (last merge round=32)
[S8] round=37 local utility u=0.000000 metrics={'f1_val': 0.9763668728725028, 'auprc': 0.998601313280551, 'loss_val': 0.0839616960165915, 'psi': 0.9852606490357221}-{'f1_val': 0.9942226369520374, 'auprc': 0.987782595805095, 'loss_val': 0.0478803169152896, 'psi': 0.9916466204932605}
[S9] START round=37 head_norm_before_train=1.654639 cos_to_last_merge=0.9878 (last merge round=26)
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.9951514971019639, 'auprc': 0.9995099308529232, 'loss_val': 0.030162844171371283, 'psi': 0.9968948706023476}-{'f1_val': 0.9963953425060355, 'auprc': 0.9976290864349191, 'loss_val': 0.028335148166405397, 'psi': 0.9968888400775889}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=37 head_norm_before_train=2.148274 (no previous merge yet)
[S10] round=37 local utility u=0.001530 metrics={'f1_val': 0.9953063309450747, 'auprc': 0.9957909951043594, 'loss_val': 0.025808378242963077, 'psi': 0.9955001966087886}-{'f1_val': 0.9951034680760983, 'auprc': 0.9953459528197411, 'loss_val': 0.026316070750126867, 'psi': 0.9952004619735554}
[S11] START round=37 head_norm_before_train=2.141268 (no previous merge yet)
[S11] round=37 local utility u=0.000000 metrics={'f1_val': 0.9915300483457061, 'auprc': 0.9974850980891935, 'loss_val': 0.03705095290460245, 'psi': 0.9939120682431011}-{'f1_val': 0.9965470045135896, 'auprc': 0.9972679309278395, 'loss_val': 0.025994721261747067, 'psi': 0.9968353750792895}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=37 head_norm_before_train=1.433182 cos_to_last_merge=0.9801 (last merge round=27)
[S13] round=37 local utility u=0.000000 metrics={'f1_val': 0.6235958472464613, 'auprc': 0.7520182620770468, 'loss_val': 1.0056726309739694, 'psi': 0.6749648131786956}-{'f1_val': 0.6541320368279298, 'auprc': 0.8207782820439387, 'loss_val': 0.7772939209585448, 'psi': 0.7207905349143333}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=37 head_norm_before_train=2.158917 (no previous merge yet)
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.9975765414632514, 'auprc': 0.999225044612714, 'loss_val': 0.018127446510764637, 'psi': 0.9982359427230364}-{'f1_val': 0.9978217593544257, 'auprc': 0.9991958534190525, 'loss_val': 0.016849872053217044, 'psi': 0.9983713969802764}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=37 head_norm_before_train=1.610201 cos_to_last_merge=0.9995 (last merge round=32)
[S15] round=37 local utility u=0.088726 metrics={'f1_val': 0.8219497594903514, 'auprc': 0.9897948668054761, 'loss_val': 0.2814562126311032, 'psi': 0.8890878024164013}-{'f1_val': 0.8017956308117612, 'auprc': 0.9882526986639898, 'loss_val': 0.33335654507154955, 'psi': 0.8763784579526526}
[S16] START round=37 head_norm_before_train=1.552075 cos_to_last_merge=0.9499 (last merge round=31)
[S16] ⚠️ Model drifted since last merge! cos=0.950
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.8999637469802052, 'auprc': 0.9869077021388991, 'loss_val': 0.4724216247163056, 'psi': 0.9347413290436828}-{'f1_val': 0.9380243717834862, 'auprc': 0.9922463793322134, 'loss_val': 0.277022907776642, 'psi': 0.959713174802977}
[S17] START round=37 head_norm_before_train=1.452263 cos_to_last_merge=0.9982 (last merge round=32)
[S17] round=37 local utility u=0.000000 metrics={'f1_val': 0.565223833974446, 'auprc': 0.6416010214668897, 'loss_val': 1.0281642600249443, 'psi': 0.5957747089714235}-{'f1_val': 0.5972732963001599, 'auprc': 0.7194711063862649, 'loss_val': 0.9459070173690838, 'psi': 0.6461524203346019}
[S7]  timeout peer S17
[S17]  timeout peer S13
[S2]  timeout peer S8
[S15]  timeout peer S9
[S10]  timeout peer S14
[S8]  timeout peer S15
[S5]  timeout peer S11
[S16]  timeout peer S7
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=38 head_norm_before_train=1.739261 cos_to_last_merge=0.9768 (last merge round=30)
[S2] round=38 local utility u=0.006167 metrics={'f1_val': 0.8971765021835539, 'auprc': 0.9807557598918228, 'loss_val': 0.289184971645948, 'psi': 0.9306082052668615}-{'f1_val': 0.8947900812916445, 'auprc': 0.9813771485478335, 'loss_val': 0.2890638051411615, 'psi': 0.9294249081941202}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] sending update (kind=head size=1805 to 1 peers)
[S3] START round=38 head_norm_before_train=2.155499 (no previous merge yet)
[S3] round=38 local utility u=0.288681 metrics={'f1_val': 0.9978389274664787, 'auprc': 0.9984984977737101, 'loss_val': 0.03146217988472834, 'psi': 0.9981027555893713}-{'f1_val': 0.9307578479511782, 'auprc': 0.9983095035412244, 'loss_val': 0.20577090396067857, 'psi': 0.9577785101871967}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] sending update (kind=head size=1804 to 1 peers)
[S4] START round=38 head_norm_before_train=1.922431 (no previous merge yet)
[S4] round=38 local utility u=0.027225 metrics={'f1_val': 0.9546603144247183, 'auprc': 0.9715736012969753, 'loss_val': 0.29623610770062764, 'psi': 0.9614256291736212}-{'f1_val': 0.9480208900859023, 'auprc': 0.9720096211489269, 'loss_val': 0.3121577809719482, 'psi': 0.9576163825111121}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=38 head_norm_before_train=1.605674 cos_to_last_merge=0.7655 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.766
[S5] round=38 local utility u=0.894740 metrics={'f1_val': 0.9329369145126277, 'auprc': 0.9901390468442538, 'loss_val': 0.12597025365163722, 'psi': 0.9558177674452781}-{'f1_val': 0.700781124122831, 'auprc': 0.9402896119112338, 'loss_val': 0.37296792188593064, 'psi': 0.7965845192381922}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=38 head_norm_before_train=2.087790 (no previous merge yet)
[S6] round=38 local utility u=0.003474 metrics={'f1_val': 0.6246524283924414, 'auprc': 0.9073207459192596, 'loss_val': 0.9507505859044222, 'psi': 0.7377197554031687}-{'f1_val': 0.6115517499145311, 'auprc': 0.8994701431723073, 'loss_val': 0.8555418811074411, 'psi': 0.7267191072176415}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=38 head_norm_before_train=1.394444 cos_to_last_merge=0.9923 (last merge round=32)
[S7] round=38 local utility u=0.552954 metrics={'f1_val': 0.6813263346322789, 'auprc': 0.8200618588598315, 'loss_val': 0.4455632701273791, 'psi': 0.7368205443233}-{'f1_val': 0.5757296875091139, 'auprc': 0.7820766538496606, 'loss_val': 0.8039367609517641, 'psi': 0.6582684740453326}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=38 head_norm_before_train=1.548140 cos_to_last_merge=0.9981 (last merge round=32)
[S8] round=38 local utility u=0.053147 metrics={'f1_val': 0.9936676463518993, 'auprc': 0.9861616533661524, 'loss_val': 0.04415266510396855, 'psi': 0.9906652491576006}-{'f1_val': 0.9763668728725028, 'auprc': 0.998601313280551, 'loss_val': 0.0839616960165915, 'psi': 0.9852606490357221}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=38 head_norm_before_train=1.668926 cos_to_last_merge=0.9869 (last merge round=26)
[S9] round=38 local utility u=0.002458 metrics={'f1_val': 0.9955666097086097, 'auprc': 0.9994828758704173, 'loss_val': 0.027655658842658522, 'psi': 0.9971331161733328}-{'f1_val': 0.9951514971019639, 'auprc': 0.9995099308529232, 'loss_val': 0.030162844171371283, 'psi': 0.9968948706023476}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=38 head_norm_before_train=2.153457 (no previous merge yet)
[S10] round=38 local utility u=0.000000 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9959924757297316, 'loss_val': 0.025895018258223938, 'psi': 0.9954590711375516}-{'f1_val': 0.9953063309450747, 'auprc': 0.9957909951043594, 'loss_val': 0.025808378242963077, 'psi': 0.9955001966087886}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=38 head_norm_before_train=2.148639 (no previous merge yet)
[S11] round=38 local utility u=0.020696 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9978927063729655, 'loss_val': 0.024626777101842, 'psi': 0.9968495673956335}-{'f1_val': 0.9915300483457061, 'auprc': 0.9974850980891935, 'loss_val': 0.03705095290460245, 'psi': 0.9939120682431011}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] sending update (kind=head size=1804 to 1 peers)
[S13] START round=38 head_norm_before_train=1.450156 cos_to_last_merge=0.9780 (last merge round=27)
[S13] round=38 local utility u=0.682031 metrics={'f1_val': 0.7484133006898762, 'auprc': 0.8737904013266232, 'loss_val': 0.7558316029405993, 'psi': 0.7985641409445751}-{'f1_val': 0.6235958472464613, 'auprc': 0.7520182620770468, 'loss_val': 1.0056726309739694, 'psi': 0.6749648131786956}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=38 head_norm_before_train=2.166851 (no previous merge yet)
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.9355437946340048, 'auprc': 0.9988416312004552, 'loss_val': 0.11739556113103454, 'psi': 0.960862929260585}-{'f1_val': 0.9975765414632514, 'auprc': 0.999225044612714, 'loss_val': 0.018127446510764637, 'psi': 0.9982359427230364}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=38 head_norm_before_train=1.629907 cos_to_last_merge=0.9993 (last merge round=32)
[S15] round=38 local utility u=0.000000 metrics={'f1_val': 0.7380633561243884, 'auprc': 0.9834255582960176, 'loss_val': 0.5042473926160107, 'psi': 0.8362082369930401}-{'f1_val': 0.8219497594903514, 'auprc': 0.9897948668054761, 'loss_val': 0.2814562126311032, 'psi': 0.8890878024164013}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=38 head_norm_before_train=1.594441 cos_to_last_merge=0.9434 (last merge round=31)
[S16] ⚠️ Model drifted since last merge! cos=0.943
[S16] round=38 local utility u=0.000000 metrics={'f1_val': 0.8718424108541105, 'auprc': 0.9829824204548994, 'loss_val': 0.6323338522769502, 'psi': 0.916298414694426}-{'f1_val': 0.8999637469802052, 'auprc': 0.9869077021388991, 'loss_val': 0.4724216247163056, 'psi': 0.9347413290436828}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=38 head_norm_before_train=1.470755 cos_to_last_merge=0.9976 (last merge round=32)
[S17] round=38 local utility u=0.372136 metrics={'f1_val': 0.610111407471796, 'auprc': 0.7630863474038727, 'loss_val': 0.9176730325482649, 'psi': 0.6713013834446268}-{'f1_val': 0.565223833974446, 'auprc': 0.6416010214668897, 'loss_val': 1.0281642600249443, 'psi': 0.5957747089714235}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=39 head_norm_before_train=1.763998 cos_to_last_merge=0.9751 (last merge round=30)
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.830542032946186, 'auprc': 0.9498236750566846, 'loss_val': 0.3252456268319715, 'psi': 0.8782546897903855}-{'f1_val': 0.8971765021835539, 'auprc': 0.9807557598918228, 'loss_val': 0.289184971645948, 'psi': 0.9306082052668615}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=40 psi=0.878 u=0.0000 p_local=0.0276 f1=0.831 auprc=0.950 bytes=34254
[S3] START round=39 head_norm_before_train=2.162158 (no previous merge yet)
[S3] round=39 local utility u=0.000926 metrics={'f1_val': 0.9973982357793907, 'auprc': 0.9984991429965986, 'loss_val': 0.026967690179826583, 'psi': 0.9978385986662739}-{'f1_val': 0.9978389274664787, 'auprc': 0.9984984977737101, 'loss_val': 0.03146217988472834, 'psi': 0.9981027555893713}
[S3] not sending this round → trigger blocked (psi=0.998)
[S3] r=40 psi=0.998 u=0.0009 p_local=0.0819 f1=0.997 auprc=0.998 bytes=41384
[S4] START round=39 head_norm_before_train=1.937476 (no previous merge yet)
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.9449950274255915, 'auprc': 0.9654996643837735, 'loss_val': 0.32016294162230613, 'psi': 0.9531968822088643}-{'f1_val': 0.9546603144247183, 'auprc': 0.9715736012969753, 'loss_val': 0.29623610770062764, 'psi': 0.9614256291736212}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=40 psi=0.953 u=0.0000 p_local=0.0280 f1=0.945 auprc=0.965 bytes=36018
[S5] START round=39 head_norm_before_train=1.611270 cos_to_last_merge=0.7645 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.765
[S5] round=39 local utility u=0.000000 metrics={'f1_val': 0.43708818800698185, 'auprc': 0.8559228213234299, 'loss_val': 0.7997613481153871, 'psi': 0.604622041333561}-{'f1_val': 0.9329369145126277, 'auprc': 0.9901390468442538, 'loss_val': 0.12597025365163722, 'psi': 0.9558177674452781}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=40 psi=0.605 u=0.0000 p_local=0.3273 f1=0.437 auprc=0.856 bytes=37808
[S6] START round=39 head_norm_before_train=2.098046 (no previous merge yet)
[S6] round=39 local utility u=1.000000 metrics={'f1_val': 0.8603917988144958, 'auprc': 0.974861000998178, 'loss_val': 0.33245397973588975, 'psi': 0.9061794796879687}-{'f1_val': 0.6246524283924414, 'auprc': 0.9073207459192596, 'loss_val': 0.9507505859044222, 'psi': 0.7377197554031687}
[S6] not sending this round → trigger blocked (psi=0.906)
[S6] r=40 psi=0.906 u=1.0000 p_local=0.3516 f1=0.860 auprc=0.975 bytes=36021
[S7] START round=39 head_norm_before_train=1.408842 cos_to_last_merge=0.9905 (last merge round=32)
[S7] round=39 local utility u=0.000000 metrics={'f1_val': 0.5133969256453088, 'auprc': 0.7821967256146737, 'loss_val': 0.8944009540388425, 'psi': 0.6209168456330547}-{'f1_val': 0.6813263346322789, 'auprc': 0.8200618588598315, 'loss_val': 0.4455632701273791, 'psi': 0.7368205443233}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] r=40 psi=0.621 u=0.0000 p_local=0.2201 f1=0.513 auprc=0.782 bytes=34184
[S8] START round=39 head_norm_before_train=1.566067 cos_to_last_merge=0.9975 (last merge round=32)
[S8] round=39 local utility u=0.000000 metrics={'f1_val': 0.9916590737414651, 'auprc': 0.986087333585856, 'loss_val': 0.045594660379724594, 'psi': 0.9894303776792215}-{'f1_val': 0.9936676463518993, 'auprc': 0.9861616533661524, 'loss_val': 0.04415266510396855, 'psi': 0.9906652491576006}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=40 psi=0.989 u=0.0000 p_local=0.0206 f1=0.992 auprc=0.986 bytes=35990
[S9] START round=39 head_norm_before_train=1.681871 cos_to_last_merge=0.9860 (last merge round=26)
[S9] round=39 local utility u=0.003508 metrics={'f1_val': 0.9963953425060355, 'auprc': 0.9994960465416282, 'loss_val': 0.025651429529216847, 'psi': 0.9976356241202726}-{'f1_val': 0.9955666097086097, 'auprc': 0.9994828758704173, 'loss_val': 0.027655658842658522, 'psi': 0.9971331161733328}
[S9] not sending this round → trigger blocked (psi=0.998)
[S9] r=40 psi=0.998 u=0.0035 p_local=0.0054 f1=0.996 auprc=0.999 bytes=41342
[S10] START round=39 head_norm_before_train=2.160691 (no previous merge yet)
[S10] round=39 local utility u=0.000620 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.996349076951213, 'loss_val': 0.025724932303906566, 'psi': 0.9956017116261442}-{'f1_val': 0.9951034680760983, 'auprc': 0.9959924757297316, 'loss_val': 0.025895018258223938, 'psi': 0.9954590711375516}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S10] r=40 psi=0.996 u=0.0006 p_local=0.0013 f1=0.995 auprc=0.996 bytes=39579
[S11] START round=39 head_norm_before_train=2.157078 (no previous merge yet)
[S11] round=39 local utility u=0.000000 metrics={'f1_val': 0.9913554099762413, 'auprc': 0.9979291986581957, 'loss_val': 0.034184424699321786, 'psi': 0.993984925449023}-{'f1_val': 0.9961541414107454, 'auprc': 0.9978927063729655, 'loss_val': 0.024626777101842, 'psi': 0.9968495673956335}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=40 psi=0.994 u=0.0000 p_local=0.0081 f1=0.991 auprc=0.998 bytes=39612
[S13] START round=39 head_norm_before_train=1.460079 cos_to_last_merge=0.9768 (last merge round=27)
[S13] round=39 local utility u=0.000000 metrics={'f1_val': 0.6314093766679039, 'auprc': 0.8135258348126159, 'loss_val': 0.8440516885672399, 'psi': 0.7042559599257887}-{'f1_val': 0.7484133006898762, 'auprc': 0.8737904013266232, 'loss_val': 0.7558316029405993, 'psi': 0.7985641409445751}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=40 psi=0.704 u=0.0000 p_local=0.1798 f1=0.631 auprc=0.814 bytes=32399
[S14] START round=39 head_norm_before_train=2.174999 (no previous merge yet)
[S14] round=39 local utility u=0.005614 metrics={'f1_val': 0.9373060440103239, 'auprc': 0.998825933199444, 'loss_val': 0.11669347436380995, 'psi': 0.961913999685972}-{'f1_val': 0.9355437946340048, 'auprc': 0.9988416312004552, 'loss_val': 0.11739556113103454, 'psi': 0.960862929260585}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S14] r=40 psi=0.962 u=0.0056 p_local=0.0198 f1=0.937 auprc=0.999 bytes=39578
[S15] START round=39 head_norm_before_train=1.649037 cos_to_last_merge=0.9989 (last merge round=32)
[S15] round=39 local utility u=1.000000 metrics={'f1_val': 0.9963755136436562, 'auprc': 0.9910470693543569, 'loss_val': 0.03353861285567012, 'psi': 0.9942441359279366}-{'f1_val': 0.7380633561243884, 'auprc': 0.9834255582960176, 'loss_val': 0.5042473926160107, 'psi': 0.8362082369930401}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S15] r=40 psi=0.994 u=1.0000 p_local=0.3263 f1=0.996 auprc=0.991 bytes=35965
[S16] START round=39 head_norm_before_train=1.628236 cos_to_last_merge=0.9384 (last merge round=31)
[S16] ⚠️ Model drifted since last merge! cos=0.938
[S16] round=39 local utility u=0.025491 metrics={'f1_val': 0.8759492716052564, 'auprc': 0.9857362848668368, 'loss_val': 0.6142538294533337, 'psi': 0.9198640769098886}-{'f1_val': 0.8718424108541105, 'auprc': 0.9829824204548994, 'loss_val': 0.6323338522769502, 'psi': 0.916298414694426}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S16] r=40 psi=0.920 u=0.0255 p_local=0.0828 f1=0.876 auprc=0.986 bytes=37771
[S17] START round=39 head_norm_before_train=1.489778 cos_to_last_merge=0.9969 (last merge round=32)
[S17] round=39 local utility u=0.000000 metrics={'f1_val': 0.6054743639090987, 'auprc': 0.7812308087021117, 'loss_val': 1.0155787344005796, 'psi': 0.675776941826304}-{'f1_val': 0.610111407471796, 'auprc': 0.7630863474038727, 'loss_val': 0.9176730325482649, 'psi': 0.6713013834446268}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=40 psi=0.676 u=0.0000 p_local=0.1304 f1=0.605 auprc=0.781 bytes=37759
[S2] START round=40 head_norm_before_train=1.780461 cos_to_last_merge=0.9738 (last merge round=30)
[S2] round=40 local utility u=0.347254 metrics={'f1_val': 0.919103954402501, 'auprc': 0.9456704820288553, 'loss_val': 0.1496501369780012, 'psi': 0.9297305654530427}-{'f1_val': 0.830542032946186, 'auprc': 0.9498236750566846, 'loss_val': 0.3252456268319715, 'psi': 0.8782546897903855}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=40 head_norm_before_train=2.170087 (no previous merge yet)
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9981540130071499, 'loss_val': 0.12680423913147854, 'psi': 0.975882755866126}-{'f1_val': 0.9973982357793907, 'auprc': 0.9984991429965986, 'loss_val': 0.026967690179826583, 'psi': 0.9978385986662739}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=40 head_norm_before_train=1.943880 (no previous merge yet)
[S4] round=40 local utility u=0.032984 metrics={'f1_val': 0.9501343501897331, 'auprc': 0.9734125349000262, 'loss_val': 0.30876917464209513, 'psi': 0.9594456240738503}-{'f1_val': 0.9449950274255915, 'auprc': 0.9654996643837735, 'loss_val': 0.32016294162230613, 'psi': 0.9531968822088643}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=40 head_norm_before_train=1.618522 cos_to_last_merge=0.7636 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.764
[S5] round=40 local utility u=1.000000 metrics={'f1_val': 0.8192655289236311, 'auprc': 0.9899205606551792, 'loss_val': 0.15848254675872886, 'psi': 0.8875275416162504}-{'f1_val': 0.43708818800698185, 'auprc': 0.8559228213234299, 'loss_val': 0.7997613481153871, 'psi': 0.604622041333561}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] sending update (kind=head size=1806 to 1 peers)
[S6] START round=40 head_norm_before_train=2.110311 (no previous merge yet)
[S6] round=40 local utility u=0.000000 metrics={'f1_val': 0.8434930997981661, 'auprc': 0.9687850651747798, 'loss_val': 0.37967065469072786, 'psi': 0.8936098859488115}-{'f1_val': 0.8603917988144958, 'auprc': 0.974861000998178, 'loss_val': 0.33245397973588975, 'psi': 0.9061794796879687}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=40 head_norm_before_train=1.426376 cos_to_last_merge=0.9882 (last merge round=32)
[S7] round=40 local utility u=0.402349 metrics={'f1_val': 0.5857649785461403, 'auprc': 0.801340176356959, 'loss_val': 0.5813418401978081, 'psi': 0.6719950576704677}-{'f1_val': 0.5133969256453088, 'auprc': 0.7821967256146737, 'loss_val': 0.8944009540388425, 'psi': 0.6209168456330547}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S7] sending update (kind=head size=1807 to 1 peers)
[S8] START round=40 head_norm_before_train=1.584369 cos_to_last_merge=0.9968 (last merge round=32)
[S8] round=40 local utility u=0.008433 metrics={'f1_val': 0.9892831449862951, 'auprc': 0.9984664243997032, 'loss_val': 0.05160972156182242, 'psi': 0.9929564567516583}-{'f1_val': 0.9916590737414651, 'auprc': 0.986087333585856, 'loss_val': 0.045594660379724594, 'psi': 0.9894303776792215}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=40 head_norm_before_train=1.691965 cos_to_last_merge=0.9855 (last merge round=26)
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.992612221589589, 'auprc': 0.9994954685325272, 'loss_val': 0.03159570337584922, 'psi': 0.9953655203667642}-{'f1_val': 0.9963953425060355, 'auprc': 0.9994960465416282, 'loss_val': 0.025651429529216847, 'psi': 0.9976356241202726}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=40 head_norm_before_train=2.165185 (no previous merge yet)
[S10] round=40 local utility u=0.000164 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.996438990537174, 'loss_val': 0.025667428881884096, 'psi': 0.9956376770605285}-{'f1_val': 0.9951034680760983, 'auprc': 0.996349076951213, 'loss_val': 0.025724932303906566, 'psi': 0.9956017116261442}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=40 head_norm_before_train=2.166641 (no previous merge yet)
[S11] round=40 local utility u=0.017065 metrics={'f1_val': 0.9956720869712891, 'auprc': 0.9979503185309418, 'loss_val': 0.02601742453253934, 'psi': 0.9965833795951502}-{'f1_val': 0.9913554099762413, 'auprc': 0.9979291986581957, 'loss_val': 0.034184424699321786, 'psi': 0.993984925449023}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=40 head_norm_before_train=1.466898 cos_to_last_merge=0.9758 (last merge round=27)
[S13] round=40 local utility u=0.000000 metrics={'f1_val': 0.6063971222899467, 'auprc': 0.7881951036839426, 'loss_val': 1.004212419423076, 'psi': 0.6791163148475451}-{'f1_val': 0.6314093766679039, 'auprc': 0.8135258348126159, 'loss_val': 0.8440516885672399, 'psi': 0.7042559599257887}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=40 head_norm_before_train=2.180951 (no previous merge yet)
[S14] round=40 local utility u=0.233524 metrics={'f1_val': 0.9980427385234248, 'auprc': 0.9991324736070628, 'loss_val': 0.014985299301542606, 'psi': 0.99847863255688}-{'f1_val': 0.9373060440103239, 'auprc': 0.998825933199444, 'loss_val': 0.11669347436380995, 'psi': 0.961913999685972}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=40 head_norm_before_train=1.669021 cos_to_last_merge=0.9986 (last merge round=32)
[S15] round=40 local utility u=0.000156 metrics={'f1_val': 0.9959021853469847, 'auprc': 0.9910989621099998, 'loss_val': 0.030542106764255134, 'psi': 0.9939808960521908}-{'f1_val': 0.9963755136436562, 'auprc': 0.9910470693543569, 'loss_val': 0.03353861285567012, 'psi': 0.9942441359279366}
[S15] not sending this round → trigger blocked (psi=0.994)
[S16] START round=40 head_norm_before_train=1.658221 cos_to_last_merge=0.9346 (last merge round=31)
[S16] ⚠️ Model drifted since last merge! cos=0.935
[S16] round=40 local utility u=0.000000 metrics={'f1_val': 0.8445338322387623, 'auprc': 0.896057210945939, 'loss_val': 0.9045984807611107, 'psi': 0.865143183721633}-{'f1_val': 0.8759492716052564, 'auprc': 0.9857362848668368, 'loss_val': 0.6142538294533337, 'psi': 0.9198640769098886}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=40 head_norm_before_train=1.509099 cos_to_last_merge=0.9960 (last merge round=32)
[S17] round=40 local utility u=1.000000 metrics={'f1_val': 0.7881371724089274, 'auprc': 0.988807507511084, 'loss_val': 0.6186813803000026, 'psi': 0.8684053064497901}-{'f1_val': 0.6054743639090987, 'auprc': 0.7812308087021117, 'loss_val': 1.0155787344005796, 'psi': 0.675776941826304}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=41 head_norm_before_train=1.798008 cos_to_last_merge=0.9724 (last merge round=30)
[S2] round=41 local utility u=0.000000 metrics={'f1_val': 0.9099400798814207, 'auprc': 0.9712971015995874, 'loss_val': 0.2914532165378856, 'psi': 0.9344828885686873}-{'f1_val': 0.919103954402501, 'auprc': 0.9456704820288553, 'loss_val': 0.1496501369780012, 'psi': 0.9297305654530427}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=41 head_norm_before_train=2.178112 (no previous merge yet)
[S3] round=41 local utility u=0.164405 metrics={'f1_val': 0.9977814963782642, 'auprc': 0.9985299404055125, 'loss_val': 0.019599542364802592, 'psi': 0.9980808739891636}-{'f1_val': 0.9610352511054436, 'auprc': 0.9981540130071499, 'loss_val': 0.12680423913147854, 'psi': 0.975882755866126}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=41 head_norm_before_train=1.929232 (no previous merge yet)
[S4] round=41 local utility u=0.000000 metrics={'f1_val': 0.9428808756932682, 'auprc': 0.975343799687532, 'loss_val': 0.3154314906563821, 'psi': 0.9558660452909737}-{'f1_val': 0.9501343501897331, 'auprc': 0.9734125349000262, 'loss_val': 0.30876917464209513, 'psi': 0.9594456240738503}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=41 head_norm_before_train=1.624789 cos_to_last_merge=0.7628 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.763
[S5] round=41 local utility u=0.358870 metrics={'f1_val': 0.9319173191024576, 'auprc': 0.9912774460243565, 'loss_val': 0.12072382337979175, 'psi': 0.9556613698712171}-{'f1_val': 0.8192655289236311, 'auprc': 0.9899205606551792, 'loss_val': 0.15848254675872886, 'psi': 0.8875275416162504}
[S5] not sending this round → trigger blocked (psi=0.956)
[S6] START round=41 head_norm_before_train=2.115945 (no previous merge yet)
[S6] round=41 local utility u=0.103558 metrics={'f1_val': 0.8689445889538867, 'auprc': 0.9592131966230769, 'loss_val': 0.2965473844813358, 'psi': 0.9050520320215627}-{'f1_val': 0.8434930997981661, 'auprc': 0.9687850651747798, 'loss_val': 0.37967065469072786, 'psi': 0.8936098859488115}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=41 head_norm_before_train=1.440302 cos_to_last_merge=0.9863 (last merge round=32)
[S7] round=41 local utility u=0.046759 metrics={'f1_val': 0.6030798350658468, 'auprc': 0.8024438768856603, 'loss_val': 0.5950240828674734, 'psi': 0.6828254517937722}-{'f1_val': 0.5857649785461403, 'auprc': 0.801340176356959, 'loss_val': 0.5813418401978081, 'psi': 0.6719950576704677}
[S7] not sending this round → trigger blocked (psi=0.683)
[S8] START round=41 head_norm_before_train=1.593435 cos_to_last_merge=0.9963 (last merge round=32)
[S8] round=41 local utility u=0.010734 metrics={'f1_val': 0.992750298431487, 'auprc': 0.995269939527852, 'loss_val': 0.04135543624498968, 'psi': 0.9937581548700329}-{'f1_val': 0.9892831449862951, 'auprc': 0.9984664243997032, 'loss_val': 0.05160972156182242, 'psi': 0.9929564567516583}
[S8] not sending this round → trigger blocked (psi=0.994)
[S9] START round=41 head_norm_before_train=1.699546 cos_to_last_merge=0.9851 (last merge round=26)
[S9] round=41 local utility u=0.011310 metrics={'f1_val': 0.9954158325366191, 'auprc': 0.9995101536846679, 'loss_val': 0.025841313802130086, 'psi': 0.9970535609958386}-{'f1_val': 0.992612221589589, 'auprc': 0.9994954685325272, 'loss_val': 0.03159570337584922, 'psi': 0.9953655203667642}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=41 head_norm_before_train=2.173394 (no previous merge yet)
[S10] round=41 local utility u=0.000000 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9958694900658751, 'loss_val': 0.0257379104902642, 'psi': 0.995409876872009}-{'f1_val': 0.9951034680760983, 'auprc': 0.996438990537174, 'loss_val': 0.025667428881884096, 'psi': 0.9956376770605285}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=41 head_norm_before_train=2.177137 (no previous merge yet)
[S11] round=41 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9963647834253062, 'loss_val': 0.056960742163958245, 'psi': 0.9962383982165697}-{'f1_val': 0.9956720869712891, 'auprc': 0.9979503185309418, 'loss_val': 0.02601742453253934, 'psi': 0.9965833795951502}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=41 head_norm_before_train=1.481672 cos_to_last_merge=0.9741 (last merge round=27)
[S13] round=41 local utility u=0.283556 metrics={'f1_val': 0.6729423109595172, 'auprc': 0.8142446033010292, 'loss_val': 0.9145191478628182, 'psi': 0.729463227896122}-{'f1_val': 0.6063971222899467, 'auprc': 0.7881951036839426, 'loss_val': 1.004212419423076, 'psi': 0.6791163148475451}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=41 head_norm_before_train=2.187871 (no previous merge yet)
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.997411628228889, 'auprc': 0.9991372291794757, 'loss_val': 0.0169362183157542, 'psi': 0.9981018686091236}-{'f1_val': 0.9980427385234248, 'auprc': 0.9991324736070628, 'loss_val': 0.014985299301542606, 'psi': 0.99847863255688}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=41 head_norm_before_train=1.684898 cos_to_last_merge=0.9983 (last merge round=32)
[S15] round=41 local utility u=0.000000 metrics={'f1_val': 0.7773006455345368, 'auprc': 0.9887455945478458, 'loss_val': 0.40552855452048786, 'psi': 0.8618786251398605}-{'f1_val': 0.9959021853469847, 'auprc': 0.9910989621099998, 'loss_val': 0.030542106764255134, 'psi': 0.9939808960521908}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=41 head_norm_before_train=1.683720 cos_to_last_merge=0.9314 (last merge round=31)
[S16] ⚠️ Model drifted since last merge! cos=0.931
[S16] round=41 local utility u=0.136943 metrics={'f1_val': 0.8514316244776927, 'auprc': 0.955061712517971, 'loss_val': 0.8491124786105826, 'psi': 0.892883659693804}-{'f1_val': 0.8445338322387623, 'auprc': 0.896057210945939, 'loss_val': 0.9045984807611107, 'psi': 0.865143183721633}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=41 head_norm_before_train=1.525526 cos_to_last_merge=0.9952 (last merge round=32)
[S17] round=41 local utility u=0.000000 metrics={'f1_val': 0.7136567000528609, 'auprc': 0.8117646338367036, 'loss_val': 0.8084429378433704, 'psi': 0.752899873566398}-{'f1_val': 0.7881371724089274, 'auprc': 0.988807507511084, 'loss_val': 0.6186813803000026, 'psi': 0.8684053064497901}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=42 head_norm_before_train=1.813522 cos_to_last_merge=0.9712 (last merge round=30)
[S2] round=42 local utility u=0.030198 metrics={'f1_val': 0.912343288700995, 'auprc': 0.9782820161039139, 'loss_val': 0.26643105677000534, 'psi': 0.9387187796621626}-{'f1_val': 0.9099400798814207, 'auprc': 0.9712971015995874, 'loss_val': 0.2914532165378856, 'psi': 0.9344828885686873}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=42 head_norm_before_train=2.186796 (no previous merge yet)
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.9973696976584205, 'auprc': 0.9986742844139889, 'loss_val': 0.018718604192053102, 'psi': 0.9978915323606479}-{'f1_val': 0.9977814963782642, 'auprc': 0.9985299404055125, 'loss_val': 0.019599542364802592, 'psi': 0.9980808739891636}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=42 head_norm_before_train=1.930083 (no previous merge yet)
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.9415245327667344, 'auprc': 0.9750090720735073, 'loss_val': 0.3223444597559687, 'psi': 0.9549183484894435}-{'f1_val': 0.9428808756932682, 'auprc': 0.975343799687532, 'loss_val': 0.3154314906563821, 'psi': 0.9558660452909737}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=42 head_norm_before_train=1.635481 cos_to_last_merge=0.7619 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.762
[S5] round=42 local utility u=0.000000 metrics={'f1_val': 0.8175448288982721, 'auprc': 0.9558772572405612, 'loss_val': 0.4258643807261101, 'psi': 0.8728778002351877}-{'f1_val': 0.9319173191024576, 'auprc': 0.9912774460243565, 'loss_val': 0.12072382337979175, 'psi': 0.9556613698712171}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=42 head_norm_before_train=2.124795 (no previous merge yet)
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.6509726988606193, 'auprc': 0.9088484999918447, 'loss_val': 0.9611381426182295, 'psi': 0.7541230193131094}-{'f1_val': 0.8689445889538867, 'auprc': 0.9592131966230769, 'loss_val': 0.2965473844813358, 'psi': 0.9050520320215627}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=42 head_norm_before_train=1.454602 cos_to_last_merge=0.9846 (last merge round=32)
[S7] round=42 local utility u=0.224693 metrics={'f1_val': 0.6531049963756562, 'auprc': 0.8112660090165122, 'loss_val': 0.47225547544355667, 'psi': 0.7163694014319987}-{'f1_val': 0.6030798350658468, 'auprc': 0.8024438768856603, 'loss_val': 0.5950240828674734, 'psi': 0.6828254517937722}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=42 head_norm_before_train=1.603263 cos_to_last_merge=0.9957 (last merge round=32)
[S8] round=42 local utility u=0.001682 metrics={'f1_val': 0.9940342119076258, 'auprc': 0.9931394891178708, 'loss_val': 0.039304276268222235, 'psi': 0.9936763227917237}-{'f1_val': 0.992750298431487, 'auprc': 0.995269939527852, 'loss_val': 0.04135543624498968, 'psi': 0.9937581548700329}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=42 head_norm_before_train=1.709657 cos_to_last_merge=0.9844 (last merge round=26)
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9940330348898703, 'loss_val': 0.024807876905967106, 'psi': 0.9953632708235147}-{'f1_val': 0.9954158325366191, 'auprc': 0.9995101536846679, 'loss_val': 0.025841313802130086, 'psi': 0.9970535609958386}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=42 head_norm_before_train=2.177418 (no previous merge yet)
[S10] round=42 local utility u=0.000000 metrics={'f1_val': 0.9948838907637279, 'auprc': 0.996232216092846, 'loss_val': 0.02554212923336842, 'psi': 0.9954232208953752}-{'f1_val': 0.9951034680760983, 'auprc': 0.9958694900658751, 'loss_val': 0.0257379104902642, 'psi': 0.995409876872009}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=42 head_norm_before_train=2.186091 (no previous merge yet)
[S11] round=42 local utility u=0.015378 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9970272301104053, 'loss_val': 0.02819238890160672, 'psi': 0.9965033768906093}-{'f1_val': 0.9961541414107454, 'auprc': 0.9963647834253062, 'loss_val': 0.056960742163958245, 'psi': 0.9962383982165697}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=42 head_norm_before_train=1.499633 cos_to_last_merge=0.9719 (last merge round=27)
[S13] round=42 local utility u=0.000000 metrics={'f1_val': 0.6350822610380288, 'auprc': 0.8204085957684966, 'loss_val': 0.9330919295383148, 'psi': 0.7092127949302158}-{'f1_val': 0.6729423109595172, 'auprc': 0.8142446033010292, 'loss_val': 0.9145191478628182, 'psi': 0.729463227896122}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=42 head_norm_before_train=2.196491 (no previous merge yet)
[S14] round=42 local utility u=0.000818 metrics={'f1_val': 0.9977975102598944, 'auprc': 0.9991144414852052, 'loss_val': 0.017546636665647375, 'psi': 0.9983242827500187}-{'f1_val': 0.997411628228889, 'auprc': 0.9991372291794757, 'loss_val': 0.0169362183157542, 'psi': 0.9981018686091236}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] sending update (kind=head size=1792 to 1 peers)
[S15] START round=42 head_norm_before_train=1.698857 cos_to_last_merge=0.9979 (last merge round=32)
[S15] round=42 local utility u=0.683131 metrics={'f1_val': 0.9501359813538621, 'auprc': 0.9908850528805409, 'loss_val': 0.08269639130034456, 'psi': 0.9664356099645337}-{'f1_val': 0.7773006455345368, 'auprc': 0.9887455945478458, 'loss_val': 0.40552855452048786, 'psi': 0.8618786251398605}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] sending update (kind=head size=1803 to 1 peers)
[S16] START round=42 head_norm_before_train=1.704769 cos_to_last_merge=0.9289 (last merge round=31)
[S16] ⚠️ Model drifted since last merge! cos=0.929
[S16] round=42 local utility u=0.566842 metrics={'f1_val': 0.9354720414542864, 'auprc': 0.992925269758397, 'loss_val': 0.33326180021430774, 'psi': 0.9584533327759307}-{'f1_val': 0.8514316244776927, 'auprc': 0.955061712517971, 'loss_val': 0.8491124786105826, 'psi': 0.892883659693804}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=42 head_norm_before_train=1.538684 cos_to_last_merge=0.9945 (last merge round=32)
[S17] round=42 local utility u=1.000000 metrics={'f1_val': 0.9126831349485892, 'auprc': 0.9658111746525563, 'loss_val': 0.3543463272660103, 'psi': 0.9339343508301761}-{'f1_val': 0.7136567000528609, 'auprc': 0.8117646338367036, 'loss_val': 0.8084429378433704, 'psi': 0.752899873566398}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=43 head_norm_before_train=1.832848 cos_to_last_merge=0.9698 (last merge round=30)
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.8303505829421098, 'auprc': 0.9555171589791027, 'loss_val': 0.34638927392290586, 'psi': 0.880417213356907}-{'f1_val': 0.912343288700995, 'auprc': 0.9782820161039139, 'loss_val': 0.26643105677000534, 'psi': 0.9387187796621626}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=43 head_norm_before_train=2.196424 (no previous merge yet)
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.9808691885975782, 'auprc': 0.998604777989514, 'loss_val': 0.057650530708001475, 'psi': 0.9879634243543526}-{'f1_val': 0.9973696976584205, 'auprc': 0.9986742844139889, 'loss_val': 0.018718604192053102, 'psi': 0.9978915323606479}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=43 head_norm_before_train=1.938880 (no previous merge yet)
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.9408989581358326, 'auprc': 0.9739470320814414, 'loss_val': 0.32413944792114247, 'psi': 0.9541181877140761}-{'f1_val': 0.9415245327667344, 'auprc': 0.9750090720735073, 'loss_val': 0.3223444597559687, 'psi': 0.9549183484894435}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=43 head_norm_before_train=1.646345 cos_to_last_merge=0.7606 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.761
[S5] round=43 local utility u=0.248218 metrics={'f1_val': 0.8391777487733945, 'auprc': 0.990788497948051, 'loss_val': 0.16395919580416657, 'psi': 0.8998220484432571}-{'f1_val': 0.8175448288982721, 'auprc': 0.9558772572405612, 'loss_val': 0.4258643807261101, 'psi': 0.8728778002351877}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=43 head_norm_before_train=2.135184 (no previous merge yet)
[S6] round=43 local utility u=0.011970 metrics={'f1_val': 0.6484935972429537, 'auprc': 0.9164104697360875, 'loss_val': 0.9450096466122461, 'psi': 0.7556603462402072}-{'f1_val': 0.6509726988606193, 'auprc': 0.9088484999918447, 'loss_val': 0.9611381426182295, 'psi': 0.7541230193131094}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=43 head_norm_before_train=1.465866 cos_to_last_merge=0.9832 (last merge round=32)
[S7] round=43 local utility u=0.000000 metrics={'f1_val': 0.564832091011531, 'auprc': 0.787814768049022, 'loss_val': 0.8055278435813661, 'psi': 0.6540251618265274}-{'f1_val': 0.6531049963756562, 'auprc': 0.8112660090165122, 'loss_val': 0.47225547544355667, 'psi': 0.7163694014319987}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=43 head_norm_before_train=1.615775 cos_to_last_merge=0.9952 (last merge round=32)
[S8] round=43 local utility u=0.000000 metrics={'f1_val': 0.9914482382097267, 'auprc': 0.9986471342539427, 'loss_val': 0.046520376200268165, 'psi': 0.9943277966274131}-{'f1_val': 0.9940342119076258, 'auprc': 0.9931394891178708, 'loss_val': 0.039304276268222235, 'psi': 0.9936763227917237}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=43 head_norm_before_train=1.718843 cos_to_last_merge=0.9839 (last merge round=26)
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.9926423765407113, 'auprc': 0.9995357724807155, 'loss_val': 0.03334948014435616, 'psi': 0.995399734916713}-{'f1_val': 0.9962500947792776, 'auprc': 0.9940330348898703, 'loss_val': 0.024807876905967106, 'psi': 0.9953632708235147}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=43 head_norm_before_train=2.185238 (no previous merge yet)
[S10] round=43 local utility u=0.000000 metrics={'f1_val': 0.9948838907637279, 'auprc': 0.9960621041619716, 'loss_val': 0.025633470204487432, 'psi': 0.9953551761230254}-{'f1_val': 0.9948838907637279, 'auprc': 0.996232216092846, 'loss_val': 0.02554212923336842, 'psi': 0.9954232208953752}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=43 head_norm_before_train=2.196254 (no previous merge yet)
[S11] round=43 local utility u=0.005388 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9980454693849897, 'loss_val': 0.02282801311459412, 'psi': 0.9971463904621496}-{'f1_val': 0.9961541414107454, 'auprc': 0.9970272301104053, 'loss_val': 0.02819238890160672, 'psi': 0.9965033768906093}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=43 head_norm_before_train=1.513770 cos_to_last_merge=0.9701 (last merge round=27)
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.6273197960875487, 'auprc': 0.8107388133810668, 'loss_val': 1.0657729824712812, 'psi': 0.7006874030049559}-{'f1_val': 0.6350822610380288, 'auprc': 0.8204085957684966, 'loss_val': 0.9330919295383148, 'psi': 0.7092127949302158}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=43 head_norm_before_train=2.204670 (no previous merge yet)
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.9825579831124402, 'auprc': 0.9991733122784754, 'loss_val': 0.03392756510577798, 'psi': 0.9892041147788543}-{'f1_val': 0.9977975102598944, 'auprc': 0.9991144414852052, 'loss_val': 0.017546636665647375, 'psi': 0.9983242827500187}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=43 head_norm_before_train=1.712367 cos_to_last_merge=0.9976 (last merge round=32)
[S15] round=43 local utility u=0.000000 metrics={'f1_val': 0.8189026416692728, 'auprc': 0.9892762020259396, 'loss_val': 0.31667358500813686, 'psi': 0.8870520658119395}-{'f1_val': 0.9501359813538621, 'auprc': 0.9908850528805409, 'loss_val': 0.08269639130034456, 'psi': 0.9664356099645337}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=43 head_norm_before_train=1.724542 cos_to_last_merge=0.9268 (last merge round=31)
[S16] ⚠️ Model drifted since last merge! cos=0.927
[S16] round=43 local utility u=0.141842 metrics={'f1_val': 0.953878236881988, 'auprc': 0.9921884590439659, 'loss_val': 0.15780470481882647, 'psi': 0.9692023257467792}-{'f1_val': 0.9354720414542864, 'auprc': 0.992925269758397, 'loss_val': 0.33326180021430774, 'psi': 0.9584533327759307}
[S16] not sending this round → trigger blocked (psi=0.969)
[S17] START round=43 head_norm_before_train=1.549506 cos_to_last_merge=0.9939 (last merge round=32)
[S17] round=43 local utility u=0.000000 metrics={'f1_val': 0.9127142626175732, 'auprc': 0.9676321384998154, 'loss_val': 0.36100000804836807, 'psi': 0.93468141297047}-{'f1_val': 0.9126831349485892, 'auprc': 0.9658111746525563, 'loss_val': 0.3543463272660103, 'psi': 0.9339343508301761}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=44 head_norm_before_train=1.841209 cos_to_last_merge=0.9689 (last merge round=30)
[S2] round=44 local utility u=0.318815 metrics={'f1_val': 0.912553953353519, 'auprc': 0.973128083189364, 'loss_val': 0.2548114663603189, 'psi': 0.936783605287857}-{'f1_val': 0.8303505829421098, 'auprc': 0.9555171589791027, 'loss_val': 0.34638927392290586, 'psi': 0.880417213356907}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=44 head_norm_before_train=2.202392 (no previous merge yet)
[S3] round=44 local utility u=0.000000 metrics={'f1_val': 0.9191845197535404, 'auprc': 0.9980989223382001, 'loss_val': 0.2486485418940865, 'psi': 0.9507502807874042}-{'f1_val': 0.9808691885975782, 'auprc': 0.998604777989514, 'loss_val': 0.057650530708001475, 'psi': 0.9879634243543526}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=44 head_norm_before_train=1.944708 (no previous merge yet)
[S4] round=44 local utility u=0.021632 metrics={'f1_val': 0.9459996823170509, 'auprc': 0.9723001159051237, 'loss_val': 0.30653937786161384, 'psi': 0.9565198557522799}-{'f1_val': 0.9408989581358326, 'auprc': 0.9739470320814414, 'loss_val': 0.32413944792114247, 'psi': 0.9541181877140761}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=44 head_norm_before_train=1.655978 cos_to_last_merge=0.7601 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.760
[S5] round=44 local utility u=0.000000 metrics={'f1_val': 0.7938608191567882, 'auprc': 0.9907635517275305, 'loss_val': 0.19866088433794163, 'psi': 0.8726219121850851}-{'f1_val': 0.8391777487733945, 'auprc': 0.990788497948051, 'loss_val': 0.16395919580416657, 'psi': 0.8998220484432571}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=44 head_norm_before_train=2.148381 (no previous merge yet)
[S6] round=44 local utility u=0.860291 metrics={'f1_val': 0.838968473874825, 'auprc': 0.9374242781427623, 'loss_val': 0.43031921792881817, 'psi': 0.8783507955819998}-{'f1_val': 0.6484935972429537, 'auprc': 0.9164104697360875, 'loss_val': 0.9450096466122461, 'psi': 0.7556603462402072}
[S6] not sending this round → trigger blocked (psi=0.878)
[S7] START round=44 head_norm_before_train=1.474000 cos_to_last_merge=0.9821 (last merge round=32)
[S7] round=44 local utility u=0.681153 metrics={'f1_val': 0.6848950751756533, 'auprc': 0.8460220047915417, 'loss_val': 0.3382211697371119, 'psi': 0.7493458470220087}-{'f1_val': 0.564832091011531, 'auprc': 0.787814768049022, 'loss_val': 0.8055278435813661, 'psi': 0.6540251618265274}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=44 head_norm_before_train=1.627850 cos_to_last_merge=0.9946 (last merge round=32)
[S8] round=44 local utility u=0.003598 metrics={'f1_val': 0.9942226369520374, 'auprc': 0.9927182543314277, 'loss_val': 0.03818406807133023, 'psi': 0.9936208839037936}-{'f1_val': 0.9914482382097267, 'auprc': 0.9986471342539427, 'loss_val': 0.046520376200268165, 'psi': 0.9943277966274131}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=44 head_norm_before_train=1.724594 cos_to_last_merge=0.9835 (last merge round=26)
[S9] round=44 local utility u=0.012214 metrics={'f1_val': 0.9955666097086097, 'auprc': 0.9995271227873967, 'loss_val': 0.026440255812274473, 'psi': 0.9971508149401245}-{'f1_val': 0.9926423765407113, 'auprc': 0.9995357724807155, 'loss_val': 0.03334948014435616, 'psi': 0.995399734916713}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=44 head_norm_before_train=2.194262 (no previous merge yet)
[S10] round=44 local utility u=0.000184 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.995752931474749, 'loss_val': 0.025656255425167643, 'psi': 0.9953632534355585}-{'f1_val': 0.9948838907637279, 'auprc': 0.9960621041619716, 'loss_val': 0.025633470204487432, 'psi': 0.9953551761230254}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=44 head_norm_before_train=2.207075 (no previous merge yet)
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.921385363227076, 'auprc': 0.9974748007178051, 'loss_val': 0.2819698073125441, 'psi': 0.9518211382233677}-{'f1_val': 0.9965470045135896, 'auprc': 0.9980454693849897, 'loss_val': 0.02282801311459412, 'psi': 0.9971463904621496}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=44 head_norm_before_train=1.525695 cos_to_last_merge=0.9685 (last merge round=27)
[S13] round=44 local utility u=0.006135 metrics={'f1_val': 0.6314685475358406, 'auprc': 0.8020194557784932, 'loss_val': 1.0522374917410493, 'psi': 0.6996889108329016}-{'f1_val': 0.6273197960875487, 'auprc': 0.8107388133810668, 'loss_val': 1.0657729824712812, 'psi': 0.7006874030049559}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] sending update (kind=head size=1794 to 1 peers)
[S14] START round=44 head_norm_before_train=2.209121 (no previous merge yet)
[S14] round=44 local utility u=0.054535 metrics={'f1_val': 0.9978223933154866, 'auprc': 0.9990763428864778, 'loss_val': 0.01615304000025892, 'psi': 0.9983239731438831}-{'f1_val': 0.9825579831124402, 'auprc': 0.9991733122784754, 'loss_val': 0.03392756510577798, 'psi': 0.9892041147788543}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=44 head_norm_before_train=1.724997 cos_to_last_merge=0.9972 (last merge round=32)
[S15] round=44 local utility u=0.000000 metrics={'f1_val': 0.7033074474745398, 'auprc': 0.966496671390439, 'loss_val': 0.588375183232157, 'psi': 0.8085831370408996}-{'f1_val': 0.8189026416692728, 'auprc': 0.9892762020259396, 'loss_val': 0.31667358500813686, 'psi': 0.8870520658119395}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=44 head_norm_before_train=1.741920 cos_to_last_merge=0.9249 (last merge round=31)
[S16] ⚠️ Model drifted since last merge! cos=0.925
[S16] round=44 local utility u=0.000855 metrics={'f1_val': 0.9540883877199664, 'auprc': 0.9922257382208116, 'loss_val': 0.1574673454610061, 'psi': 0.9693433279203044}-{'f1_val': 0.953878236881988, 'auprc': 0.9921884590439659, 'loss_val': 0.15780470481882647, 'psi': 0.9692023257467792}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] sending update (kind=head size=1805 to 1 peers)
[S17] START round=44 head_norm_before_train=1.558164 cos_to_last_merge=0.9934 (last merge round=32)
[S17] round=44 local utility u=0.000000 metrics={'f1_val': 0.6225010758173035, 'auprc': 0.8723957913647906, 'loss_val': 1.0310999065470245, 'psi': 0.7224589620362983}-{'f1_val': 0.9127142626175732, 'auprc': 0.9676321384998154, 'loss_val': 0.36100000804836807, 'psi': 0.93468141297047}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=45 head_norm_before_train=1.855159 cos_to_last_merge=0.9679 (last merge round=30)
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.912343288700995, 'auprc': 0.9596155979745126, 'loss_val': 0.2708803762386965, 'psi': 0.9312522124104021}-{'f1_val': 0.912553953353519, 'auprc': 0.973128083189364, 'loss_val': 0.2548114663603189, 'psi': 0.936783605287857}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=45 head_norm_before_train=2.209712 (no previous merge yet)
[S3] round=45 local utility u=0.325529 metrics={'f1_val': 0.9965342232254032, 'auprc': 0.9984058023694636, 'loss_val': 0.06260918360614796, 'psi': 0.9972828548830274}-{'f1_val': 0.9191845197535404, 'auprc': 0.9980989223382001, 'loss_val': 0.2486485418940865, 'psi': 0.9507502807874042}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=45 head_norm_before_train=1.949576 (no previous merge yet)
[S4] round=45 local utility u=0.026318 metrics={'f1_val': 0.9557330982760472, 'auprc': 0.9683865280261674, 'loss_val': 0.3005626282575873, 'psi': 0.9607944701760953}-{'f1_val': 0.9459996823170509, 'auprc': 0.9723001159051237, 'loss_val': 0.30653937786161384, 'psi': 0.9565198557522799}
[S4] not sending this round → trigger blocked (psi=0.961)
[S5] START round=45 head_norm_before_train=1.664863 cos_to_last_merge=0.7601 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.760
[S5] round=45 local utility u=0.680175 metrics={'f1_val': 0.9971410286679584, 'auprc': 0.9985728731417893, 'loss_val': 0.08141931407020268, 'psi': 0.9977137664574907}-{'f1_val': 0.7938608191567882, 'auprc': 0.9907635517275305, 'loss_val': 0.19866088433794163, 'psi': 0.8726219121850851}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=45 head_norm_before_train=2.158934 (no previous merge yet)
[S6] round=45 local utility u=0.000000 metrics={'f1_val': 0.6178025224385202, 'auprc': 0.8893585029282782, 'loss_val': 0.9027217085073653, 'psi': 0.7264249146344235}-{'f1_val': 0.838968473874825, 'auprc': 0.9374242781427623, 'loss_val': 0.43031921792881817, 'psi': 0.8783507955819998}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=45 head_norm_before_train=1.480109 cos_to_last_merge=0.9814 (last merge round=32)
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.5469040421215035, 'auprc': 0.7803444958277952, 'loss_val': 0.9129764005895098, 'psi': 0.6402802236040201}-{'f1_val': 0.6848950751756533, 'auprc': 0.8460220047915417, 'loss_val': 0.3382211697371119, 'psi': 0.7493458470220087}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=45 head_norm_before_train=1.639997 cos_to_last_merge=0.9942 (last merge round=32)
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.9918008107316822, 'auprc': 0.9986283684187581, 'loss_val': 0.04286366202179726, 'psi': 0.9945318338065126}-{'f1_val': 0.9942226369520374, 'auprc': 0.9927182543314277, 'loss_val': 0.03818406807133023, 'psi': 0.9936208839037936}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=45 head_norm_before_train=1.730809 cos_to_last_merge=0.9831 (last merge round=26)
[S9] round=45 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9940085328155897, 'loss_val': 0.02384394056493274, 'psi': 0.9953534699938025}-{'f1_val': 0.9955666097086097, 'auprc': 0.9995271227873967, 'loss_val': 0.026440255812274473, 'psi': 0.9971508149401245}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=45 head_norm_before_train=2.200134 (no previous merge yet)
[S10] round=45 local utility u=0.000383 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9959564779942619, 'loss_val': 0.025501624148939986, 'psi': 0.9954446720433637}-{'f1_val': 0.9951034680760983, 'auprc': 0.995752931474749, 'loss_val': 0.025656255425167643, 'psi': 0.9953632534355585}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=45 head_norm_before_train=2.213951 (no previous merge yet)
[S11] round=45 local utility u=0.354766 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9973775324450735, 'loss_val': 0.023115408274052906, 'psi': 0.9968792156861832}-{'f1_val': 0.921385363227076, 'auprc': 0.9974748007178051, 'loss_val': 0.2819698073125441, 'psi': 0.9518211382233677}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=45 head_norm_before_train=1.538375 cos_to_last_merge=0.9669 (last merge round=27)
[S13] round=45 local utility u=0.093152 metrics={'f1_val': 0.6487575002726631, 'auprc': 0.8145708109482591, 'loss_val': 1.0073221956549834, 'psi': 0.7150828245429015}-{'f1_val': 0.6314685475358406, 'auprc': 0.8020194557784932, 'loss_val': 1.0522374917410493, 'psi': 0.6996889108329016}
[S13] not sending this round → trigger blocked (psi=0.715)
[S14] START round=45 head_norm_before_train=2.211546 (no previous merge yet)
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.9980427385234248, 'auprc': 0.9986340425250124, 'loss_val': 0.017829413991221073, 'psi': 0.9982792601240598}-{'f1_val': 0.9978223933154866, 'auprc': 0.9990763428864778, 'loss_val': 0.01615304000025892, 'psi': 0.9983239731438831}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=45 head_norm_before_train=1.737954 cos_to_last_merge=0.9968 (last merge round=32)
[S15] round=45 local utility u=0.000000 metrics={'f1_val': 0.7009211775784895, 'auprc': 0.8905899824531982, 'loss_val': 0.6660488789688364, 'psi': 0.776788699528373}-{'f1_val': 0.7033074474745398, 'auprc': 0.966496671390439, 'loss_val': 0.588375183232157, 'psi': 0.8085831370408996}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=45 head_norm_before_train=1.756953 cos_to_last_merge=0.9231 (last merge round=31)
[S16] ⚠️ Model drifted since last merge! cos=0.923
[S16] round=45 local utility u=0.000000 metrics={'f1_val': 0.8549887657101283, 'auprc': 0.9508437268223353, 'loss_val': 0.8426845667639085, 'psi': 0.8933307501550112}-{'f1_val': 0.9540883877199664, 'auprc': 0.9922257382208116, 'loss_val': 0.1574673454610061, 'psi': 0.9693433279203044}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=45 head_norm_before_train=1.567847 cos_to_last_merge=0.9929 (last merge round=32)
[S17] round=45 local utility u=1.000000 metrics={'f1_val': 0.9116173345280933, 'auprc': 0.9538924690176738, 'loss_val': 0.36865361857616746, 'psi': 0.9285273883239256}-{'f1_val': 0.6225010758173035, 'auprc': 0.8723957913647906, 'loss_val': 1.0310999065470245, 'psi': 0.7224589620362983}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=46 head_norm_before_train=1.863901 cos_to_last_merge=0.9670 (last merge round=30)
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.9093750572970187, 'auprc': 0.9635047226297051, 'loss_val': 0.28899909364701903, 'psi': 0.9310269234300932}-{'f1_val': 0.912343288700995, 'auprc': 0.9596155979745126, 'loss_val': 0.2708803762386965, 'psi': 0.9312522124104021}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=46 head_norm_before_train=2.215003 (no previous merge yet)
[S3] round=46 local utility u=0.019809 metrics={'f1_val': 0.9974271292865575, 'auprc': 0.9983914253324849, 'loss_val': 0.028305818253122075, 'psi': 0.9978128477049285}-{'f1_val': 0.9965342232254032, 'auprc': 0.9984058023694636, 'loss_val': 0.06260918360614796, 'psi': 0.9972828548830274}
[S3] not sending this round → trigger blocked (psi=0.998)
[S4] START round=46 head_norm_before_train=1.948205 (no previous merge yet)
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.9397329091230313, 'auprc': 0.9614633000056512, 'loss_val': 0.31541483743712295, 'psi': 0.9484250654760793}-{'f1_val': 0.9557330982760472, 'auprc': 0.9683865280261674, 'loss_val': 0.3005626282575873, 'psi': 0.9607944701760953}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=46 head_norm_before_train=1.672735 cos_to_last_merge=0.7602 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.760
[S5] round=46 local utility u=0.000000 metrics={'f1_val': 0.700781124122831, 'auprc': 0.9741714008264791, 'loss_val': 0.42758547857129015, 'psi': 0.8101372348042902}-{'f1_val': 0.9971410286679584, 'auprc': 0.9985728731417893, 'loss_val': 0.08141931407020268, 'psi': 0.9977137664574907}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=46 head_norm_before_train=2.169354 (no previous merge yet)
[S6] round=46 local utility u=0.512553 metrics={'f1_val': 0.7345450956970585, 'auprc': 0.9581569703012034, 'loss_val': 0.7844673062767638, 'psi': 0.8239898455387165}-{'f1_val': 0.6178025224385202, 'auprc': 0.8893585029282782, 'loss_val': 0.9027217085073653, 'psi': 0.7264249146344235}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=46 head_norm_before_train=1.485542 cos_to_last_merge=0.9807 (last merge round=32)
[S7] round=46 local utility u=0.538463 metrics={'f1_val': 0.6470631597278502, 'auprc': 0.8034826143682823, 'loss_val': 0.5064204490881421, 'psi': 0.7096309415840231}-{'f1_val': 0.5469040421215035, 'auprc': 0.7803444958277952, 'loss_val': 0.9129764005895098, 'psi': 0.6402802236040201}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=46 head_norm_before_train=1.652951 cos_to_last_merge=0.9937 (last merge round=32)
[S8] round=46 local utility u=0.001797 metrics={'f1_val': 0.9921646161217188, 'auprc': 0.9985759199483051, 'loss_val': 0.041294630304846446, 'psi': 0.9947291376523534}-{'f1_val': 0.9918008107316822, 'auprc': 0.9986283684187581, 'loss_val': 0.04286366202179726, 'psi': 0.9945318338065126}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] sending update (kind=head size=1806 to 1 peers)
[S9] START round=46 head_norm_before_train=1.738391 cos_to_last_merge=0.9826 (last merge round=26)
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.9833144528039904, 'auprc': 0.9666659391648407, 'loss_val': 0.0759385695379924, 'psi': 0.9766550473483305}-{'f1_val': 0.9962500947792776, 'auprc': 0.9940085328155897, 'loss_val': 0.02384394056493274, 'psi': 0.9953534699938025}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=46 head_norm_before_train=2.206182 (no previous merge yet)
[S10] round=46 local utility u=0.000000 metrics={'f1_val': 0.9948838907637279, 'auprc': 0.9959791152473778, 'loss_val': 0.02553379252753319, 'psi': 0.9953219805571879}-{'f1_val': 0.9951034680760983, 'auprc': 0.9959564779942619, 'loss_val': 0.025501624148939986, 'psi': 0.9954446720433637}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=46 head_norm_before_train=2.221128 (no previous merge yet)
[S11] round=46 local utility u=0.000240 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9975135701836944, 'loss_val': 0.02304267211974714, 'psi': 0.9969336307816314}-{'f1_val': 0.9965470045135896, 'auprc': 0.9973775324450735, 'loss_val': 0.023115408274052906, 'psi': 0.9968792156861832}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=46 head_norm_before_train=1.549413 cos_to_last_merge=0.9655 (last merge round=27)
[S13] round=46 local utility u=0.236209 metrics={'f1_val': 0.6763893633307885, 'auprc': 0.8680299738571133, 'loss_val': 0.8610738166504681, 'psi': 0.7530456075413184}-{'f1_val': 0.6487575002726631, 'auprc': 0.8145708109482591, 'loss_val': 1.0073221956549834, 'psi': 0.7150828245429015}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=46 head_norm_before_train=2.211823 (no previous merge yet)
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.9977998904431125, 'auprc': 0.9990102059409485, 'loss_val': 0.0179584837131041, 'psi': 0.9982840166422469}-{'f1_val': 0.9980427385234248, 'auprc': 0.9986340425250124, 'loss_val': 0.017829413991221073, 'psi': 0.9982792601240598}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=46 head_norm_before_train=1.748400 cos_to_last_merge=0.9965 (last merge round=32)
[S15] round=46 local utility u=1.000000 metrics={'f1_val': 0.9801187655993676, 'auprc': 0.9900901216476141, 'loss_val': 0.04825587179473391, 'psi': 0.9841073080186662}-{'f1_val': 0.7009211775784895, 'auprc': 0.8905899824531982, 'loss_val': 0.6660488789688364, 'psi': 0.776788699528373}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] sending update (kind=head size=1803 to 1 peers)
[S16] START round=46 head_norm_before_train=1.766741 cos_to_last_merge=0.9215 (last merge round=31)
[S16] ⚠️ Model drifted since last merge! cos=0.922
[S16] round=46 local utility u=0.000000 metrics={'f1_val': 0.8499327241906375, 'auprc': 0.897991702438371, 'loss_val': 0.9175728623915079, 'psi': 0.8691563154897308}-{'f1_val': 0.8549887657101283, 'auprc': 0.9508437268223353, 'loss_val': 0.8426845667639085, 'psi': 0.8933307501550112}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=46 head_norm_before_train=1.579418 cos_to_last_merge=0.9923 (last merge round=32)
[S17] round=46 local utility u=0.000000 metrics={'f1_val': 0.8748295001244568, 'auprc': 0.9648893813840576, 'loss_val': 0.4412340639247758, 'psi': 0.9108534526282971}-{'f1_val': 0.9116173345280933, 'auprc': 0.9538924690176738, 'loss_val': 0.36865361857616746, 'psi': 0.9285273883239256}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=47 head_norm_before_train=1.878618 cos_to_last_merge=0.9657 (last merge round=30)
[S2] round=47 local utility u=0.027488 metrics={'f1_val': 0.912343288700995, 'auprc': 0.9728035089943079, 'loss_val': 0.2797280649311588, 'psi': 0.9365273768183202}-{'f1_val': 0.9093750572970187, 'auprc': 0.9635047226297051, 'loss_val': 0.28899909364701903, 'psi': 0.9310269234300932}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=47 head_norm_before_train=2.222029 (no previous merge yet)
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9986211509226919, 'loss_val': 0.11668685489484684, 'psi': 0.9760696110323429}-{'f1_val': 0.9974271292865575, 'auprc': 0.9983914253324849, 'loss_val': 0.028305818253122075, 'psi': 0.9978128477049285}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=47 head_norm_before_train=1.955246 (no previous merge yet)
[S4] round=47 local utility u=0.022467 metrics={'f1_val': 0.9409439239110025, 'auprc': 0.9730505233443473, 'loss_val': 0.3125089421255433, 'psi': 0.9537865636843403}-{'f1_val': 0.9397329091230313, 'auprc': 0.9614633000056512, 'loss_val': 0.31541483743712295, 'psi': 0.9484250654760793}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=47 head_norm_before_train=1.679889 cos_to_last_merge=0.7607 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.761
[S5] round=47 local utility u=0.913890 metrics={'f1_val': 0.9469183236143494, 'auprc': 0.9992509306549269, 'loss_val': 0.1518666338663806, 'psi': 0.9678513664305803}-{'f1_val': 0.700781124122831, 'auprc': 0.9741714008264791, 'loss_val': 0.42758547857129015, 'psi': 0.8101372348042902}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=47 head_norm_before_train=2.181660 (no previous merge yet)
[S6] round=47 local utility u=0.722752 metrics={'f1_val': 0.8806598573236162, 'auprc': 0.9740032637991333, 'loss_val': 0.2631907188487595, 'psi': 0.917997219913823}-{'f1_val': 0.7345450956970585, 'auprc': 0.9581569703012034, 'loss_val': 0.7844673062767638, 'psi': 0.8239898455387165}
[S6] not sending this round → trigger blocked (psi=0.918)
[S7] START round=47 head_norm_before_train=1.491593 cos_to_last_merge=0.9800 (last merge round=32)
[S7] round=47 local utility u=0.000000 metrics={'f1_val': 0.6297921038728218, 'auprc': 0.802505955612632, 'loss_val': 0.49874323900042783, 'psi': 0.6988776445687459}-{'f1_val': 0.6470631597278502, 'auprc': 0.8034826143682823, 'loss_val': 0.5064204490881421, 'psi': 0.7096309415840231}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=47 head_norm_before_train=1.666072 cos_to_last_merge=0.9931 (last merge round=32)
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.9773611464556267, 'auprc': 0.9986456605977837, 'loss_val': 0.07764910418235593, 'psi': 0.9858749521124894}-{'f1_val': 0.9921646161217188, 'auprc': 0.9985759199483051, 'loss_val': 0.041294630304846446, 'psi': 0.9947291376523534}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=47 head_norm_before_train=1.745610 cos_to_last_merge=0.9822 (last merge round=26)
[S9] round=47 local utility u=0.116201 metrics={'f1_val': 0.996808967411047, 'auprc': 0.999363790407765, 'loss_val': 0.022596431284135427, 'psi': 0.9978308966097342}-{'f1_val': 0.9833144528039904, 'auprc': 0.9666659391648407, 'loss_val': 0.0759385695379924, 'psi': 0.9766550473483305}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=47 head_norm_before_train=2.214380 (no previous merge yet)
[S10] round=47 local utility u=0.000000 metrics={'f1_val': 0.9948838907637279, 'auprc': 0.9957690702828843, 'loss_val': 0.025731511651538898, 'psi': 0.9952379625713905}-{'f1_val': 0.9948838907637279, 'auprc': 0.9959791152473778, 'loss_val': 0.02553379252753319, 'psi': 0.9953219805571879}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=47 head_norm_before_train=2.228551 (no previous merge yet)
[S11] round=47 local utility u=0.000149 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9974033626048625, 'loss_val': 0.02253767207343396, 'psi': 0.9969018274256732}-{'f1_val': 0.9965470045135896, 'auprc': 0.9975135701836944, 'loss_val': 0.02304267211974714, 'psi': 0.9969336307816314}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] START round=47 head_norm_before_train=1.563465 cos_to_last_merge=0.9637 (last merge round=27)
[S13] round=47 local utility u=0.000000 metrics={'f1_val': 0.6765307304060563, 'auprc': 0.7682276670459922, 'loss_val': 1.0238583112574433, 'psi': 0.7132095050620306}-{'f1_val': 0.6763893633307885, 'auprc': 0.8680299738571133, 'loss_val': 0.8610738166504681, 'psi': 0.7530456075413184}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=47 head_norm_before_train=2.212796 (no previous merge yet)
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.9977998904431125, 'auprc': 0.9990233499468509, 'loss_val': 0.018197211924694593, 'psi': 0.9982892742446078}-{'f1_val': 0.9977998904431125, 'auprc': 0.9990102059409485, 'loss_val': 0.0179584837131041, 'psi': 0.9982840166422469}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=47 head_norm_before_train=1.755541 cos_to_last_merge=0.9963 (last merge round=32)
[S15] round=47 local utility u=0.059592 metrics={'f1_val': 0.9959021853469847, 'auprc': 0.9915859887517081, 'loss_val': 0.02825986431254281, 'psi': 0.994175706708874}-{'f1_val': 0.9801187655993676, 'auprc': 0.9900901216476141, 'loss_val': 0.04825587179473391, 'psi': 0.9841073080186662}
[S15] not sending this round → trigger blocked (psi=0.994)
[S16] START round=47 head_norm_before_train=1.776247 cos_to_last_merge=0.9201 (last merge round=31)
[S16] ⚠️ Model drifted since last merge! cos=0.920
[S16] round=47 local utility u=0.632745 metrics={'f1_val': 0.9281944687960536, 'auprc': 0.9907834193882887, 'loss_val': 0.40002927873176086, 'psi': 0.9532300490329477}-{'f1_val': 0.8499327241906375, 'auprc': 0.897991702438371, 'loss_val': 0.9175728623915079, 'psi': 0.8691563154897308}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=47 head_norm_before_train=1.586556 cos_to_last_merge=0.9919 (last merge round=32)
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.651757314011978, 'auprc': 0.8919986968527447, 'loss_val': 0.8940736454937777, 'psi': 0.7478538671482847}-{'f1_val': 0.8748295001244568, 'auprc': 0.9648893813840576, 'loss_val': 0.4412340639247758, 'psi': 0.9108534526282971}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=48 head_norm_before_train=1.897802 cos_to_last_merge=0.9642 (last merge round=30)
[S2] round=48 local utility u=0.030536 metrics={'f1_val': 0.9133734316042061, 'auprc': 0.9809187100242718, 'loss_val': 0.2491834969649462, 'psi': 0.9403915429722325}-{'f1_val': 0.912343288700995, 'auprc': 0.9728035089943079, 'loss_val': 0.2797280649311588, 'psi': 0.9365273768183202}
[S2] not sending this round → trigger blocked (psi=0.940)
[S3] START round=48 head_norm_before_train=2.229565 (no previous merge yet)
[S3] round=48 local utility u=0.092906 metrics={'f1_val': 0.9807668776533067, 'auprc': 0.9984885858837451, 'loss_val': 0.04886724871784592, 'psi': 0.987855560945482}-{'f1_val': 0.9610352511054436, 'auprc': 0.9986211509226919, 'loss_val': 0.11668685489484684, 'psi': 0.9760696110323429}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=48 head_norm_before_train=1.966100 (no previous merge yet)
[S4] round=48 local utility u=0.000000 metrics={'f1_val': 0.9414847799666489, 'auprc': 0.9695291430559754, 'loss_val': 0.30966519873702164, 'psi': 0.9527025252023795}-{'f1_val': 0.9409439239110025, 'auprc': 0.9730505233443473, 'loss_val': 0.3125089421255433, 'psi': 0.9537865636843403}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=48 head_norm_before_train=1.685425 cos_to_last_merge=0.7600 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.760
[S5] round=48 local utility u=0.064494 metrics={'f1_val': 0.9657649855881385, 'auprc': 0.9961187746919328, 'loss_val': 0.1265619195000145, 'psi': 0.9779065012296562}-{'f1_val': 0.9469183236143494, 'auprc': 0.9992509306549269, 'loss_val': 0.1518666338663806, 'psi': 0.9678513664305803}
[S5] not sending this round → trigger blocked (psi=0.978)
[S6] START round=48 head_norm_before_train=2.190824 (no previous merge yet)
[S6] round=48 local utility u=0.000000 metrics={'f1_val': 0.6738256203906945, 'auprc': 0.862516730841872, 'loss_val': 1.0914863142337996, 'psi': 0.7493020645711654}-{'f1_val': 0.8806598573236162, 'auprc': 0.9740032637991333, 'loss_val': 0.2631907188487595, 'psi': 0.917997219913823}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=48 head_norm_before_train=1.498733 cos_to_last_merge=0.9792 (last merge round=32)
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.5236207810966168, 'auprc': 0.7794325118334591, 'loss_val': 1.0341219636152361, 'psi': 0.6259454733913536}-{'f1_val': 0.6297921038728218, 'auprc': 0.802505955612632, 'loss_val': 0.49874323900042783, 'psi': 0.6988776445687459}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=48 head_norm_before_train=1.678341 cos_to_last_merge=0.9926 (last merge round=32)
[S8] round=48 local utility u=0.065620 metrics={'f1_val': 0.9942226369520374, 'auprc': 0.9948210238912825, 'loss_val': 0.03610354997609175, 'psi': 0.9944619917277354}-{'f1_val': 0.9773611464556267, 'auprc': 0.9986456605977837, 'loss_val': 0.07764910418235593, 'psi': 0.9858749521124894}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] sending update (kind=head size=1805 to 1 peers)
[S9] START round=48 head_norm_before_train=1.752011 cos_to_last_merge=0.9818 (last merge round=26)
[S9] round=48 local utility u=0.000064 metrics={'f1_val': 0.996808967411047, 'auprc': 0.9993812302494527, 'loss_val': 0.022520894763671594, 'psi': 0.9978378725464092}-{'f1_val': 0.996808967411047, 'auprc': 0.999363790407765, 'loss_val': 0.022596431284135427, 'psi': 0.9978308966097342}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=48 head_norm_before_train=2.223058 (no previous merge yet)
[S10] round=48 local utility u=0.000667 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9953990455643851, 'loss_val': 0.02592324038214107, 'psi': 0.9953534905639922}-{'f1_val': 0.9948838907637279, 'auprc': 0.9957690702828843, 'loss_val': 0.025731511651538898, 'psi': 0.9952379625713905}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=48 head_norm_before_train=2.236629 (no previous merge yet)
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9977996334551269, 'loss_val': 0.02214547462857262, 'psi': 0.996812338228498}-{'f1_val': 0.996567470639547, 'auprc': 0.9974033626048625, 'loss_val': 0.02253767207343396, 'psi': 0.9969018274256732}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=48 head_norm_before_train=1.574062 cos_to_last_merge=0.9623 (last merge round=27)
[S13] round=48 local utility u=0.000000 metrics={'f1_val': 0.6246927146812185, 'auprc': 0.683325505017602, 'loss_val': 1.195869311853663, 'psi': 0.6481458308157719}-{'f1_val': 0.6765307304060563, 'auprc': 0.7682276670459922, 'loss_val': 1.0238583112574433, 'psi': 0.7132095050620306}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=48 head_norm_before_train=2.215749 (no previous merge yet)
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.9959647244635018, 'auprc': 0.9989686305425666, 'loss_val': 0.030867268364457186, 'psi': 0.9971662868951277}-{'f1_val': 0.9977998904431125, 'auprc': 0.9990233499468509, 'loss_val': 0.018197211924694593, 'psi': 0.9982892742446078}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=48 head_norm_before_train=1.761648 cos_to_last_merge=0.9961 (last merge round=32)
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.7009169771696235, 'auprc': 0.9837304761375002, 'loss_val': 0.6168534629041132, 'psi': 0.8140423767567742}-{'f1_val': 0.9959021853469847, 'auprc': 0.9915859887517081, 'loss_val': 0.02825986431254281, 'psi': 0.994175706708874}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=48 head_norm_before_train=1.787560 cos_to_last_merge=0.9189 (last merge round=31)
[S16] ⚠️ Model drifted since last merge! cos=0.919
[S16] round=48 local utility u=0.204514 metrics={'f1_val': 0.9551164092272881, 'auprc': 0.9920501404558957, 'loss_val': 0.15633405448836152, 'psi': 0.9698899017187311}-{'f1_val': 0.9281944687960536, 'auprc': 0.9907834193882887, 'loss_val': 0.40002927873176086, 'psi': 0.9532300490329477}
[S16] not sending this round → trigger blocked (psi=0.970)
[S17] START round=48 head_norm_before_train=1.594789 cos_to_last_merge=0.9914 (last merge round=32)
[S17] round=48 local utility u=1.000000 metrics={'f1_val': 0.9124077568872817, 'auprc': 0.9461695131284948, 'loss_val': 0.36207359107305553, 'psi': 0.9259124593837669}-{'f1_val': 0.651757314011978, 'auprc': 0.8919986968527447, 'loss_val': 0.8940736454937777, 'psi': 0.7478538671482847}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=49 head_norm_before_train=1.911500 cos_to_last_merge=0.9635 (last merge round=30)
[S2] round=49 local utility u=0.000241 metrics={'f1_val': 0.9134633227758115, 'auprc': 0.9740056470408519, 'loss_val': 0.2285010713875761, 'psi': 0.9376802524818277}-{'f1_val': 0.9133734316042061, 'auprc': 0.9809187100242718, 'loss_val': 0.2491834969649462, 'psi': 0.9403915429722325}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=49 head_norm_before_train=2.236843 (no previous merge yet)
[S3] round=49 local utility u=0.064916 metrics={'f1_val': 0.9973415147416245, 'auprc': 0.9984920471959801, 'loss_val': 0.01849305553540166, 'psi': 0.9978017277233667}-{'f1_val': 0.9807668776533067, 'auprc': 0.9984885858837451, 'loss_val': 0.04886724871784592, 'psi': 0.987855560945482}
[S3] not sending this round → trigger blocked (psi=0.998)
[S4] START round=49 head_norm_before_train=1.978804 (no previous merge yet)
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.9425971815413506, 'auprc': 0.9671723610583902, 'loss_val': 0.31150115360495634, 'psi': 0.9524272533481666}-{'f1_val': 0.9414847799666489, 'auprc': 0.9695291430559754, 'loss_val': 0.30966519873702164, 'psi': 0.9527025252023795}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=49 head_norm_before_train=1.689007 cos_to_last_merge=0.7595 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.760
[S5] round=49 local utility u=0.123356 metrics={'f1_val': 0.9969946151368354, 'auprc': 0.9994648970524358, 'loss_val': 0.07726592317903197, 'psi': 0.9979827279030755}-{'f1_val': 0.9657649855881385, 'auprc': 0.9961187746919328, 'loss_val': 0.1265619195000145, 'psi': 0.9779065012296562}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=49 head_norm_before_train=2.200090 (no previous merge yet)
[S6] round=49 local utility u=0.384750 metrics={'f1_val': 0.7357904539354324, 'auprc': 0.9090714128728051, 'loss_val': 0.8334398486204742, 'psi': 0.8051028375103815}-{'f1_val': 0.6738256203906945, 'auprc': 0.862516730841872, 'loss_val': 1.0914863142337996, 'psi': 0.7493020645711654}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=49 head_norm_before_train=1.506834 cos_to_last_merge=0.9782 (last merge round=32)
[S7] round=49 local utility u=0.847037 metrics={'f1_val': 0.6789688140027876, 'auprc': 0.8295967508669618, 'loss_val': 0.42262981867668087, 'psi': 0.7392199887484574}-{'f1_val': 0.5236207810966168, 'auprc': 0.7794325118334591, 'loss_val': 1.0341219636152361, 'psi': 0.6259454733913536}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] sending update (kind=head size=1806 to 1 peers)
[S8] START round=49 head_norm_before_train=1.687636 cos_to_last_merge=0.9921 (last merge round=32)
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.9914375510364866, 'auprc': 0.9986866266390325, 'loss_val': 0.042517402244415574, 'psi': 0.9943371812775049}-{'f1_val': 0.9942226369520374, 'auprc': 0.9948210238912825, 'loss_val': 0.03610354997609175, 'psi': 0.9944619917277354}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=49 head_norm_before_train=1.757646 cos_to_last_merge=0.9815 (last merge round=26)
[S9] round=49 local utility u=0.000000 metrics={'f1_val': 0.9951945592007305, 'auprc': 0.9993041834437566, 'loss_val': 0.02697706981744971, 'psi': 0.996838408897941}-{'f1_val': 0.996808967411047, 'auprc': 0.9993812302494527, 'loss_val': 0.022520894763671594, 'psi': 0.9978378725464092}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=49 head_norm_before_train=2.227519 (no previous merge yet)
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.9948838907637279, 'auprc': 0.995896767730625, 'loss_val': 0.025553001255521204, 'psi': 0.9952890415504867}-{'f1_val': 0.9953231205637304, 'auprc': 0.9953990455643851, 'loss_val': 0.02592324038214107, 'psi': 0.9953534905639922}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=49 head_norm_before_train=2.238270 (no previous merge yet)
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9975135015252119, 'loss_val': 0.025356813572767672, 'psi': 0.9965405033312331}-{'f1_val': 0.9961541414107454, 'auprc': 0.9977996334551269, 'loss_val': 0.02214547462857262, 'psi': 0.996812338228498}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=49 head_norm_before_train=1.587863 cos_to_last_merge=0.9606 (last merge round=27)
[S13] round=49 local utility u=0.395259 metrics={'f1_val': 0.6438935039149957, 'auprc': 0.864510380484042, 'loss_val': 1.064111297920708, 'psi': 0.7321402545426142}-{'f1_val': 0.6246927146812185, 'auprc': 0.683325505017602, 'loss_val': 1.195869311853663, 'psi': 0.6481458308157719}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=49 head_norm_before_train=2.221076 (no previous merge yet)
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.9713283884133248, 'auprc': 0.9989567487238404, 'loss_val': 0.06295254701974592, 'psi': 0.9823797325375311}-{'f1_val': 0.9959647244635018, 'auprc': 0.9989686305425666, 'loss_val': 0.030867268364457186, 'psi': 0.9971662868951277}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=49 head_norm_before_train=1.766912 cos_to_last_merge=0.9960 (last merge round=32)
[S15] round=49 local utility u=1.000000 metrics={'f1_val': 0.9959021853469847, 'auprc': 0.9966592972477313, 'loss_val': 0.023884926828335228, 'psi': 0.9962050301072833}-{'f1_val': 0.7009169771696235, 'auprc': 0.9837304761375002, 'loss_val': 0.6168534629041132, 'psi': 0.8140423767567742}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=49 head_norm_before_train=1.800181 cos_to_last_merge=0.9177 (last merge round=31)
[S16] ⚠️ Model drifted since last merge! cos=0.918
[S16] round=49 local utility u=0.000000 metrics={'f1_val': 0.93069640673175, 'auprc': 0.9913891193991334, 'loss_val': 0.393408926227703, 'psi': 0.9549734917987034}-{'f1_val': 0.9551164092272881, 'auprc': 0.9920501404558957, 'loss_val': 0.15633405448836152, 'psi': 0.9698899017187311}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=49 head_norm_before_train=1.604697 cos_to_last_merge=0.9909 (last merge round=32)
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.6781367330457777, 'auprc': 0.9655834787631462, 'loss_val': 0.8641752356528749, 'psi': 0.7931154313327251}-{'f1_val': 0.9124077568872817, 'auprc': 0.9461695131284948, 'loss_val': 0.36207359107305553, 'psi': 0.9259124593837669}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[runner] rounds complete.
[runner] all agents stopped.
