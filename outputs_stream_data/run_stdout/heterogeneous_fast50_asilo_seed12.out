[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:39403
[S3] → join 127.0.0.1:39402
[S4] → join 127.0.0.1:39402
[S5] → join 127.0.0.1:39402
[S6] → join 127.0.0.1:39402
[S7] → join 127.0.0.1:39402
[S8] → join 127.0.0.1:39402
[S9] → join 127.0.0.1:39402
[S10] → join 127.0.0.1:39402
[S11] → join 127.0.0.1:39402
[S13] → join 127.0.0.1:39402
[S14] → join 127.0.0.1:39402
[S15] → join 127.0.0.1:39402
[S16] → join 127.0.0.1:39402
[S17] → join 127.0.0.1:39402
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.215654 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.148502 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.160562 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.177613 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.155555 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.162285 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.144849 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.152354 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.122732 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.162440 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.187704 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.150589 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.200105 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.147197 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.176870 (no previous merge yet)
[S17]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S3] + discovered S9
[S3] + discovered S7
[S3] + discovered S15
[S3] + discovered S16
[S3] + discovered S8
[S3] + discovered S5
[S3] + discovered S17
[S3] + discovered S13
[S3] + discovered S4
[S3] + discovered S11
[S4] + discovered S2
[S4] + discovered S3
[S3] + discovered S10
[S3] + discovered S14
[S3] + discovered S6
[S5] + discovered S2
[S5] + discovered S3
[S5] + discovered S4
[S4] + discovered S7
[S4] + discovered S10
[S4] + discovered S6
[S4] + discovered S14
[S4] + discovered S9
[S4] + discovered S15
[S4] + discovered S16
[S4] + discovered S8
[S4] + discovered S5
[S4] + discovered S13
[S4] + discovered S11
[S4] + discovered S17
[S6] + discovered S3
[S6] + discovered S2
[S6] + discovered S4
[S6] + discovered S5
[S5] + discovered S11
[S5] + discovered S8
[S5] + discovered S13
[S5] + discovered S9
[S5] + discovered S14
[S5] + discovered S10
[S5] + discovered S17
[S5] + discovered S16
[S5] + discovered S15
[S5] + discovered S6
[S5] + discovered S7
[S7] + discovered S3
[S7] + discovered S4
[S7] + discovered S6
[S7] + discovered S5
[S7] + discovered S2
[S6] + discovered S16
[S6] + discovered S9
[S6] + discovered S13
[S6] + discovered S8
[S6] + discovered S7
[S6] + discovered S15
[S6] + discovered S17
[S6] + discovered S10
[S6] + discovered S14
[S6] + discovered S11
[S8] + discovered S6
[S8] + discovered S2
[S8] + discovered S5
[S8] + discovered S7
[S8] + discovered S4
[S8] + discovered S3
[S7] + discovered S16
[S7] + discovered S13
[S7] + discovered S11
[S7] + discovered S10
[S7] + discovered S9
[S7] + discovered S8
[S7] + discovered S14
[S7] + discovered S17
[S7] + discovered S15
[S8] + discovered S17
[S8] + discovered S15
[S9] + discovered S8
[S9] + discovered S5
[S9] + discovered S7
[S9] + discovered S6
[S9] + discovered S2
[S9] + discovered S4
[S9] + discovered S3
[S8] + discovered S11
[S8] + discovered S16
[S8] + discovered S10
[S8] + discovered S14
[S8] + discovered S13
[S8] + discovered S9
[S10] + discovered S8
[S10] + discovered S5
[S10] + discovered S2
[S10] + discovered S7
[S10] + discovered S6
[S10] + discovered S9
[S10] + discovered S4
[S10] + discovered S3
[S9] + discovered S16
[S9] + discovered S10
[S9] + discovered S13
[S9] + discovered S15
[S9] + discovered S11
[S9] + discovered S14
[S9] + discovered S17
[S11] + discovered S3
[S11] + discovered S4
[S11] + discovered S9
[S11] + discovered S7
[S11] + discovered S6
[S11] + discovered S2
[S11] + discovered S8
[S11] + discovered S5
[S11] + discovered S10
[S10] + discovered S11
[S10] + discovered S17
[S10] + discovered S16
[S10] + discovered S13
[S10] + discovered S14
[S10] + discovered S15
[S11] + discovered S15
[S11] + discovered S16
[S11] + discovered S17
[S11] + discovered S14
[S11] + discovered S13
[S13] + discovered S6
[S13] + discovered S9
[S13] + discovered S4
[S13] + discovered S10
[S13] + discovered S5
[S13] + discovered S2
[S13] + discovered S8
[S13] + discovered S11
[S13] + discovered S7
[S13] + discovered S3
[S13] + discovered S15
[S14] + discovered S9
[S14] + discovered S6
[S14] + discovered S5
[S14] + discovered S3
[S14] + discovered S7
[S14] + discovered S13
[S14] + discovered S11
[S14] + discovered S8
[S13] + discovered S14
[S14] + discovered S2
[S14] + discovered S4
[S13] + discovered S17
[S13] + discovered S16
[S14] + discovered S10
[S15] + discovered S14
[S15] + discovered S5
[S15] + discovered S2
[S15] + discovered S11
[S15] + discovered S7
[S15] + discovered S4
[S15] + discovered S8
[S15] + discovered S10
[S15] + discovered S13
[S15] + discovered S3
[S15] + discovered S6
[S15] + discovered S9
[S14] + discovered S15
[S14] + discovered S17
[S14] + discovered S16
[S16] + discovered S6
[S16] + discovered S3
[S16] + discovered S13
[S16] + discovered S15
[S16] + discovered S2
[S16] + discovered S9
[S16] + discovered S8
[S16] + discovered S10
[S16] + discovered S4
[S16] + discovered S7
[S16] + discovered S11
[S16] + discovered S14
[S16] + discovered S5
[S15] + discovered S16
[S15] + discovered S17
[S17] + discovered S16
[S17] + discovered S5
[S17] + discovered S11
[S17] + discovered S14
[S17] + discovered S7
[S17] + discovered S8
[S17] + discovered S4
[S16] + discovered S17
[S17] + discovered S3
[S17] + discovered S6
[S17] + discovered S10
[S17] + discovered S2
[S17] + discovered S15
[S17] + discovered S13
[S17] + discovered S9
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] ⇄ pheromone p=1.000 → S15@127.0.0.1:39415
[S9] ⇄ pheromone p=1.000 → S3@127.0.0.1:39403
[S7] ⇄ pheromone p=1.000 → S15@127.0.0.1:39415
[S5] ⇄ pheromone p=1.000 → S9@127.0.0.1:39410
[S11] ⇄ pheromone p=1.000 → S7@127.0.0.1:39408
[S13] ⇄ pheromone p=1.000 → S15@127.0.0.1:39415
[S14] ⇄ pheromone p=1.000 → S6@127.0.0.1:39407
[S6] ⇄ pheromone p=1.000 → S8@127.0.0.1:39409
[S16] ⇄ pheromone p=1.000 → S6@127.0.0.1:39407
[S15] ⇄ pheromone p=1.000 → S10@127.0.0.1:39411
[S2] ⇄ pheromone p=1.000 → S10@127.0.0.1:39411
[S4] ⇄ pheromone p=1.000 → S2@127.0.0.1:39402
[S10] ⇄ pheromone p=1.000 → S7@127.0.0.1:39408
[S8] ⇄ pheromone p=1.000 → S3@127.0.0.1:39403
[S17] ⇄ pheromone p=1.000 → S8@127.0.0.1:39409
[S2] START round=1 head_norm_before_train=1.233759 (no previous merge yet)
[S2] round=1 local utility u=0.187471 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.777739315963707, 'loss_val': 1.256174216972809, 'psi': 0.39616200641862287}-{'f1_val': 0.1417771333885667, 'auprc': 0.6755337241387688, 'loss_val': 1.3244991710791834, 'psi': 0.35527976968864755}
[S3] START round=1 head_norm_before_train=1.150804 (no previous merge yet)
[S3] round=1 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8790747844672543, 'loss_val': 1.3462198532115501, 'psi': 0.4355339531553659}-{'f1_val': 0.33626343403571124, 'auprc': 0.704419728413339, 'loss_val': 1.3801731825500736, 'psi': 0.48352595178676233}
[S4] START round=1 head_norm_before_train=1.171680 (no previous merge yet)
[S4] round=1 local utility u=0.000000 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7734212600622933, 'loss_val': 1.2575673111038186, 'psi': 0.3935044813620278}-{'f1_val': 0.17551822563286695, 'auprc': 0.9059877692204881, 'loss_val': 1.327844263787074, 'psi': 0.4677060430679154}
[S5] START round=1 head_norm_before_train=1.182456 (no previous merge yet)
[S5] round=1 local utility u=0.000000 metrics={'f1_val': 0.1592090774260997, 'auprc': 0.759284312161428, 'loss_val': 1.327648194103364, 'psi': 0.399239171320231}-{'f1_val': 0.41702538450920135, 'auprc': 0.5913332983888632, 'loss_val': 1.362618454625927, 'psi': 0.4867485500610661}
[S6] START round=1 head_norm_before_train=1.166306 (no previous merge yet)
[S6] round=1 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8277281808248397, 'loss_val': 1.273829922146796, 'psi': 0.4159470415607051}-{'f1_val': 0.4006736677058834, 'auprc': 0.8124401531424063, 'loss_val': 1.3340362537428576, 'psi': 0.5653802618804926}
[S7] START round=1 head_norm_before_train=1.171910 (no previous merge yet)
[S7] round=1 local utility u=0.053930 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.4136518597949927, 'loss_val': 1.3265206468278397, 'psi': 0.2506948375554521}-{'f1_val': 0.14205682272909165, 'auprc': 0.3866246161688042, 'loss_val': 1.3532990659053559, 'psi': 0.23988394010497668}
[S8] START round=1 head_norm_before_train=1.150765 (no previous merge yet)
[S8] round=1 local utility u=0.059259 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7709370569851284, 'loss_val': 1.2612569075365934, 'psi': 0.3923484122298257}-{'f1_val': 0.13995598239295717, 'auprc': 0.7497408120964615, 'loss_val': 1.3161857193631246, 'psi': 0.3838699142743589}
[S9] START round=1 head_norm_before_train=1.158264 (no previous merge yet)
[S9] round=1 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.6902786454359562, 'loss_val': 1.3162781912010204, 'psi': 0.3609502324583801}-{'f1_val': 0.401889580354423, 'auprc': 0.6676889691243258, 'loss_val': 1.3579217423173089, 'psi': 0.5082093358623841}
[S10] START round=1 head_norm_before_train=1.122532 (no previous merge yet)
[S10] round=1 local utility u=0.037372 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.5563007873001489, 'loss_val': 1.3227547991225643, 'psi': 0.3056932974450939}-{'f1_val': 0.13862163754172394, 'auprc': 0.5441488830992907, 'loss_val': 1.3610439487239452, 'psi': 0.30083253576475066}
[S11] START round=1 head_norm_before_train=1.165218 (no previous merge yet)
[S11] round=1 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7986558943877045, 'loss_val': 1.3230468740962822, 'psi': 0.40371056777894815}-{'f1_val': 0.35652411212175994, 'auprc': 0.6540895343702571, 'loss_val': 1.353990097312495, 'psi': 0.4755502810211588}
[S13] START round=1 head_norm_before_train=1.207676 (no previous merge yet)
[S13] round=1 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7602302763721314, 'loss_val': 1.2563878397599215, 'psi': 0.3883235680950844}-{'f1_val': 0.1403857625770531, 'auprc': 0.7834353292496372, 'loss_val': 1.3076785846159276, 'psi': 0.39760558924608674}
[S14] START round=1 head_norm_before_train=1.152042 (no previous merge yet)
[S14] round=1 local utility u=1.000000 metrics={'f1_val': 0.41590155861719064, 'auprc': 0.9724434357945406, 'loss_val': 1.3396099136935058, 'psi': 0.6385183094881306}-{'f1_val': 0.09277053305879661, 'auprc': 0.6779523382620873, 'loss_val': 1.3605370318977512, 'psi': 0.3268432551401129}
[S15] START round=1 head_norm_before_train=1.218532 (no previous merge yet)
[S15] round=1 local utility u=0.062206 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.744098903030171, 'loss_val': 1.2810654881372712, 'psi': 0.3814797520290034}-{'f1_val': 0.13973365136155833, 'auprc': 0.725229323416094, 'loss_val': 1.3488685696798297, 'psi': 0.3739319201833726}
[S16] START round=1 head_norm_before_train=1.152478 (no previous merge yet)
[S16] round=1 local utility u=0.341712 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7829210100428203, 'loss_val': 1.3114727945529243, 'psi': 0.39755087413665}-{'f1_val': 0.14063745019920318, 'auprc': 0.5647651035305135, 'loss_val': 1.3404295668345692, 'psi': 0.3102885115317273}
[S17] START round=1 head_norm_before_train=1.196821 (no previous merge yet)
[S17] round=1 local utility u=0.109034 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.585802628811581, 'loss_val': 1.2773164315510401, 'psi': 0.318890429515063}-{'f1_val': 0.14094896331738438, 'auprc': 0.5331556927355345, 'loss_val': 1.3374430971447613, 'psi': 0.2978316550846445}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] → sending delta(kind=head bytes=1793) to S17@127.0.0.1:39417
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:39415
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:39417
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S8] → sending delta(kind=head bytes=1791) to S4@127.0.0.1:39404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S16] → sending delta(kind=head bytes=1787) to S5@127.0.0.1:39405
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S7] → sending delta(kind=head bytes=1786) to S8@127.0.0.1:39409
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:39417
[S7] sending update (kind=head size=1786 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] sending update (kind=head size=1787 to 1 peers)
[S8] sending update (kind=head size=1791 to 1 peers)
[S10] sending update (kind=head size=1792 to 1 peers)
[S2] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1793 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1786) from S7
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.188119)
[S8] loaded HEAD from S7 (vec_in norm=1.188119)
[S8] cosine check vs S7: cos=0.0413
[S8] BUFFERED delta from S7 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1793) from S14
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.161015)
[S17] loaded HEAD from S14 (vec_in norm=1.161015)
[S17] cosine check vs S14: cos=-0.1445
[S17] DROPPED delta from S14 (cos=-0.1445 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1792) from S10
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.146641)
[S17] loaded HEAD from S10 (vec_in norm=1.146641)
[S17] cosine check vs S10: cos=0.0409
[S17] BUFFERED delta from S10 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1794) from S2
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.270102)
[S15] loaded HEAD from S2 (vec_in norm=1.270102)
[S15] cosine check vs S2: cos=-0.1345
[S15] DROPPED delta from S2 (cos=-0.1345 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1795) from S15
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.257434)
[S17] loaded HEAD from S15 (vec_in norm=1.257434)
[S17] cosine check vs S15: cos=-0.1132
[S17] DROPPED delta from S15 (cos=-0.1132 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1791) from S8
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.189987)
[S4] loaded HEAD from S8 (vec_in norm=1.189987)
[S4] cosine check vs S8: cos=0.0971
[S4] BUFFERED delta from S8 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1787) from S16
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.170990)
[S5] loaded HEAD from S16 (vec_in norm=1.170990)
[S5] cosine check vs S16: cos=0.0258
[S5] BUFFERED delta from S16 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:39407
[S17] sending update (kind=head size=1793 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1793) from S17
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.236873)
[S6] loaded HEAD from S17 (vec_in norm=1.236873)
[S6] cosine check vs S17: cos=0.0648
[S6] BUFFERED delta from S17 (total buffered=1)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=1 metric=0.1414 head_norm=1.202982
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.343005e-01
[S6] stored merged vector for next round verification (round=1)
[S6] DEBUG after merge:  round=1 metric=0.1414 head_norm=0.890198 delta_norm=0.834301
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=1 metric=0.1592 head_norm=1.196923
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.263783e-01
[S5] stored merged vector for next round verification (round=1)
[S5] DEBUG after merge:  round=1 metric=0.1423 head_norm=0.847951 delta_norm=0.826378
[S5] aggregate: ROLLBACK (f1_val pre=0.159 post=0.142 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=1 metric=0.1402 head_norm=1.205544
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.047977e-01
[S4] stored merged vector for next round verification (round=1)
[S4] DEBUG after merge:  round=1 metric=0.1402 head_norm=0.887132 delta_norm=0.804798
[S4] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=1 metric=0.1400 head_norm=1.189987
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.232476e-01
[S8] stored merged vector for next round verification (round=1)
[S8] DEBUG after merge:  round=1 metric=0.1400 head_norm=0.857969 delta_norm=0.823248
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=1 metric=0.1409 head_norm=1.236873
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.259482e-01
[S17] stored merged vector for next round verification (round=1)
[S17] DEBUG after merge:  round=1 metric=0.1409 head_norm=0.860308 delta_norm=0.825948
[S17] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=1.270102 (no previous merge yet)
[S2] round=2 local utility u=0.019967 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7634134569647528, 'loss_val': 1.1732635970901955, 'psi': 0.3904316628190412}-{'f1_val': 0.1417771333885667, 'auprc': 0.777739315963707, 'loss_val': 1.256174216972809, 'psi': 0.39616200641862287}
[S3] START round=2 head_norm_before_train=1.163551 (no previous merge yet)
[S3] round=2 local utility u=0.145433 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9625770801587114, 'loss_val': 1.3058601083986647, 'psi': 0.4689348714319488}-{'f1_val': 0.13984006561410703, 'auprc': 0.8790747844672543, 'loss_val': 1.3462198532115501, 'psi': 0.4355339531553659}
[S4] START round=2 head_norm_before_train=0.887132 cos_to_last_merge=1.0000 (last merge round=1)
[S4] round=2 local utility u=0.000000 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.5871387717959217, 'loss_val': 1.201466840292287, 'psi': 0.31899148605547917}-{'f1_val': 0.14022662889518414, 'auprc': 0.7734212600622933, 'loss_val': 1.2575673111038186, 'psi': 0.3935044813620278}
[S5] START round=2 head_norm_before_train=0.847951 cos_to_last_merge=1.0000 (last merge round=1)
[S5] round=2 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7698706855260911, 'loss_val': 1.3040774726757727, 'psi': 0.3933054170675793}-{'f1_val': 0.1592090774260997, 'auprc': 0.759284312161428, 'loss_val': 1.327648194103364, 'psi': 0.399239171320231}
[S6] START round=2 head_norm_before_train=0.890198 cos_to_last_merge=1.0000 (last merge round=1)
[S6] round=2 local utility u=0.041971 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8460253687572623, 'loss_val': 1.2447799754189721, 'psi': 0.42326591673367414}-{'f1_val': 0.14142628205128205, 'auprc': 0.8277281808248397, 'loss_val': 1.273829922146796, 'psi': 0.4159470415607051}
[S7] START round=2 head_norm_before_train=1.188119 (no previous merge yet)
[S7] round=2 local utility u=0.182144 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.5249875443662474, 'loss_val': 1.2962397835176942, 'psi': 0.29522911138395397}-{'f1_val': 0.14205682272909165, 'auprc': 0.4136518597949927, 'loss_val': 1.3265206468278397, 'psi': 0.2506948375554521}
[S8] START round=2 head_norm_before_train=0.857969 cos_to_last_merge=1.0000 (last merge round=1)
[S8] round=2 local utility u=0.017678 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7702519894707487, 'loss_val': 1.2238451693222794, 'psi': 0.39207438522407384}-{'f1_val': 0.13995598239295717, 'auprc': 0.7709370569851284, 'loss_val': 1.2612569075365934, 'psi': 0.3923484122298257}
[S9] START round=2 head_norm_before_train=1.175310 (no previous merge yet)
[S9] round=2 local utility u=0.145888 metrics={'f1_val': 0.141397957139996, 'auprc': 0.7714588657375935, 'loss_val': 1.268043342296182, 'psi': 0.39342232057903503}-{'f1_val': 0.141397957139996, 'auprc': 0.6902786454359562, 'loss_val': 1.3162781912010204, 'psi': 0.3609502324583801}
[S10] START round=2 head_norm_before_train=1.146641 (no previous merge yet)
[S10] round=2 local utility u=0.065022 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.5791585842680917, 'loss_val': 1.2612842489069964, 'psi': 0.3148364162322711}-{'f1_val': 0.13862163754172394, 'auprc': 0.5563007873001489, 'loss_val': 1.3227547991225643, 'psi': 0.3056932974450939}
[S11] START round=2 head_norm_before_train=1.179054 (no previous merge yet)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7683290197890605, 'loss_val': 1.2881290019288216, 'psi': 0.3915798179394906}-{'f1_val': 0.14041368337311058, 'auprc': 0.7986558943877045, 'loss_val': 1.3230468740962822, 'psi': 0.40371056777894815}
[S13] START round=2 head_norm_before_train=1.244453 (no previous merge yet)
[S13] round=2 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7333305228099514, 'loss_val': 1.1843910438784837, 'psi': 0.3775636666702124}-{'f1_val': 0.1403857625770531, 'auprc': 0.7602302763721314, 'loss_val': 1.2563878397599215, 'psi': 0.3883235680950844}
[S14] START round=2 head_norm_before_train=1.161015 (no previous merge yet)
[S14] round=2 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.9967875455255282, 'loss_val': 1.3132530234704411, 'psi': 0.4829297299398335}-{'f1_val': 0.41590155861719064, 'auprc': 0.9724434357945406, 'loss_val': 1.3396099136935058, 'psi': 0.6385183094881306}
[S15] START round=2 head_norm_before_train=1.257434 (no previous merge yet)
[S15] round=2 local utility u=0.075267 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7740579292303938, 'loss_val': 1.2204095405745847, 'psi': 0.3934633625090926}-{'f1_val': 0.13973365136155833, 'auprc': 0.744098903030171, 'loss_val': 1.2810654881372712, 'psi': 0.3814797520290034}
[S16] START round=2 head_norm_before_train=1.170990 (no previous merge yet)
[S16] round=2 local utility u=0.059574 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8121594489733754, 'loss_val': 1.2800392593441934, 'psi': 0.40924624970887213}-{'f1_val': 0.14063745019920318, 'auprc': 0.7829210100428203, 'loss_val': 1.3114727945529243, 'psi': 0.39755087413665}
[S17] START round=2 head_norm_before_train=0.860308 cos_to_last_merge=1.0000 (last merge round=1)
[S17] round=2 local utility u=0.004737 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5694131937060278, 'loss_val': 1.2186750610319559, 'psi': 0.3123346554728418}-{'f1_val': 0.14094896331738438, 'auprc': 0.585802628811581, 'loss_val': 1.2773164315510401, 'psi': 0.318890429515063}
[S16] not sending this round → trigger blocked (psi=0.409)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:39407
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.392)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.393)
[S7] not sending this round → trigger blocked (psi=0.295)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S3] → sending delta(kind=head bytes=1788) to S11@127.0.0.1:39412
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.390)
[S10] not sending this round → trigger blocked (psi=0.315)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:39408
[S3] sending update (kind=head size=1788 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1800) from S9
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.203518)
[S6] loaded HEAD from S9 (vec_in norm=1.203518)
[S6] cosine check vs S9: cos=0.0511
[S6] BUFFERED delta from S9 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1795) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.940263)
[S7] loaded HEAD from S6 (vec_in norm=0.940263)
[S7] cosine check vs S6: cos=0.0215
[S7] BUFFERED delta from S6 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1788) from S3
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.184955)
[S11] loaded HEAD from S3 (vec_in norm=1.184955)
[S11] cosine check vs S3: cos=-0.0494
[S11] DROPPED delta from S3 (cos=-0.0494 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.312)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=2 metric=0.1421 head_norm=1.208939
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.577665e-01
[S7] stored merged vector for next round verification (round=2)
[S7] DEBUG after merge:  round=2 metric=0.1421 head_norm=0.773695 delta_norm=0.757767
[S7] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=2 metric=0.1414 head_norm=0.940263
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.444739e-01
[S6] stored merged vector for next round verification (round=2)
[S6] DEBUG after merge:  round=2 metric=0.1414 head_norm=0.782325 delta_norm=0.744474
[S6] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=1.314749 (no previous merge yet)
[S2] round=3 local utility u=0.926073 metrics={'f1_val': 0.4168093390637936, 'auprc': 0.7782852958313231, 'loss_val': 1.0159267632326348, 'psi': 0.5613997217708053}-{'f1_val': 0.1417771333885667, 'auprc': 0.7634134569647528, 'loss_val': 1.1732635970901955, 'psi': 0.3904316628190412}
[S3] START round=3 head_norm_before_train=1.184955 (no previous merge yet)
[S3] round=3 local utility u=0.080196 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.998103739478088, 'loss_val': 1.252048469324489, 'psi': 0.4831455351596994}-{'f1_val': 0.13984006561410703, 'auprc': 0.9625770801587114, 'loss_val': 1.3058601083986647, 'psi': 0.4689348714319488}
[S4] START round=3 head_norm_before_train=0.936216 cos_to_last_merge=0.9939 (last merge round=1)
[S4] round=3 local utility u=0.340303 metrics={'f1_val': 0.14159059035220026, 'auprc': 0.7595867041005531, 'loss_val': 1.046387798508463, 'psi': 0.3887890358515414}-{'f1_val': 0.14022662889518414, 'auprc': 0.5871387717959217, 'loss_val': 1.201466840292287, 'psi': 0.31899148605547917}
[S5] START round=3 head_norm_before_train=0.871355 cos_to_last_merge=0.9972 (last merge round=1)
[S5] round=3 local utility u=0.020793 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.76999024498077, 'loss_val': 1.2628503986288366, 'psi': 0.39335324084945084}-{'f1_val': 0.14226190476190476, 'auprc': 0.7698706855260911, 'loss_val': 1.3040774726757727, 'psi': 0.3933054170675793}
[S6] START round=3 head_norm_before_train=0.782325 cos_to_last_merge=1.0000 (last merge round=2)
[S6] round=3 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.7989216709583138, 'loss_val': 1.1906635882551462, 'psi': 0.40442443761409475}-{'f1_val': 0.14142628205128205, 'auprc': 0.8460253687572623, 'loss_val': 1.2447799754189721, 'psi': 0.42326591673367414}
[S7] START round=3 head_norm_before_train=0.773695 cos_to_last_merge=1.0000 (last merge round=2)
[S7] round=3 local utility u=0.079590 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.5790795027003344, 'loss_val': 1.299336213752963, 'psi': 0.31686589471758875}-{'f1_val': 0.14205682272909165, 'auprc': 0.5249875443662474, 'loss_val': 1.2962397835176942, 'psi': 0.29522911138395397}
[S8] START round=3 head_norm_before_train=0.911853 cos_to_last_merge=0.9928 (last merge round=1)
[S8] round=3 local utility u=1.000000 metrics={'f1_val': 0.6116589246136175, 'auprc': 0.7944015213280635, 'loss_val': 1.028994282398843, 'psi': 0.6847559632993959}-{'f1_val': 0.13995598239295717, 'auprc': 0.7702519894707487, 'loss_val': 1.2238451693222794, 'psi': 0.39207438522407384}
[S9] START round=3 head_norm_before_train=1.203518 (no previous merge yet)
[S9] round=3 local utility u=0.175267 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8662222370030122, 'loss_val': 1.201799501052754, 'psi': 0.4313276690852025}-{'f1_val': 0.141397957139996, 'auprc': 0.7714588657375935, 'loss_val': 1.268043342296182, 'psi': 0.39342232057903503}
[S10] START round=3 head_norm_before_train=1.187318 (no previous merge yet)
[S10] round=3 local utility u=0.086716 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.605927634928036, 'loss_val': 1.1681593337442095, 'psi': 0.32554403649624875}-{'f1_val': 0.13862163754172394, 'auprc': 0.5791585842680917, 'loss_val': 1.2612842489069964, 'psi': 0.3148364162322711}
[S11] START round=3 head_norm_before_train=1.200674 (no previous merge yet)
[S11] round=3 local utility u=0.019613 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7660781049483045, 'loss_val': 1.2421508346128123, 'psi': 0.39067945200318815}-{'f1_val': 0.14041368337311058, 'auprc': 0.7683290197890605, 'loss_val': 1.2881290019288216, 'psi': 0.3915798179394906}
[S13] START round=3 head_norm_before_train=1.288014 (no previous merge yet)
[S13] round=3 local utility u=1.000000 metrics={'f1_val': 0.41627458463323097, 'auprc': 0.8255984988841811, 'loss_val': 1.0341142835550958, 'psi': 0.5800041503336111}-{'f1_val': 0.1403857625770531, 'auprc': 0.7333305228099514, 'loss_val': 1.1843910438784837, 'psi': 0.3775636666702124}
[S14] START round=3 head_norm_before_train=1.181647 (no previous merge yet)
[S14] round=3 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.9333414636462447, 'loss_val': 1.2776027437447792, 'psi': 0.45755129718812015}-{'f1_val': 0.14035785288270378, 'auprc': 0.9967875455255282, 'loss_val': 1.3132530234704411, 'psi': 0.4829297299398335}
[S15] START round=3 head_norm_before_train=1.298905 (no previous merge yet)
[S15] round=3 local utility u=0.879272 metrics={'f1_val': 0.41599167481162613, 'auprc': 0.7770081799572915, 'loss_val': 1.1282646127510514, 'psi': 0.5603982768698923}-{'f1_val': 0.13973365136155833, 'auprc': 0.7740579292303938, 'loss_val': 1.2204095405745847, 'psi': 0.3934633625090926}
[S16] START round=3 head_norm_before_train=1.197581 (no previous merge yet)
[S16] round=3 local utility u=0.022149 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.81357978590703, 'loss_val': 1.2400020573992292, 'psi': 0.40981438448233387}-{'f1_val': 0.14063745019920318, 'auprc': 0.8121594489733754, 'loss_val': 1.2800392593441934, 'psi': 0.40924624970887213}
[S17] START round=3 head_norm_before_train=0.916657 cos_to_last_merge=0.9916 (last merge round=1)
[S17] round=3 local utility u=0.893927 metrics={'f1_val': 0.3900009712509712, 'auprc': 0.6150715745128802, 'loss_val': 1.0621080161939682, 'psi': 0.48002921255573483}-{'f1_val': 0.14094896331738438, 'auprc': 0.5694131937060278, 'loss_val': 1.2186750610319559, 'psi': 0.3123346554728418}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:39408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:39411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:39402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:39403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:39411
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:39408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] → sending delta(kind=head bytes=1792) to S9@127.0.0.1:39410
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.483)
[S9] not sending this round → trigger blocked (psi=0.431)
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1794 to 1 peers)
[S16] sending update (kind=head size=1794 to 1 peers)
[S5] sending update (kind=head size=1792 to 1 peers)
[S8] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1798) from S15
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.344405)
[S10] loaded HEAD from S15 (vec_in norm=1.344405)
[S10] cosine check vs S15: cos=-0.0042
[S10] DROPPED delta from S15 (cos=-0.0042 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1797) from S2
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.363667)
[S10] loaded HEAD from S2 (vec_in norm=1.363667)
[S10] cosine check vs S2: cos=0.0233
[S10] BUFFERED delta from S2 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1800) from S11
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.228571)
[S7] loaded HEAD from S11 (vec_in norm=1.228571)
[S7] cosine check vs S11: cos=0.0553
[S7] BUFFERED delta from S11 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1792) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.902839)
[S9] loaded HEAD from S5 (vec_in norm=0.902839)
[S9] cosine check vs S5: cos=0.0291
[S9] BUFFERED delta from S5 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1798) from S4
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.989270)
[S2] loaded HEAD from S4 (vec_in norm=0.989270)
[S2] cosine check vs S4: cos=-0.0829
[S2] DROPPED delta from S4 (cos=-0.0829 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1794) from S13
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.325510)
[S15] loaded HEAD from S13 (vec_in norm=1.325510)
[S15] cosine check vs S13: cos=0.1324
[S15] BUFFERED delta from S13 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1798) from S7
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.796861)
[S15] loaded HEAD from S7 (vec_in norm=0.796861)
[S15] cosine check vs S7: cos=-0.1277
[S15] DROPPED delta from S7 (cos=-0.1277 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1796) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.235759)
[S7] loaded HEAD from S10 (vec_in norm=1.235759)
[S7] cosine check vs S10: cos=0.0947
[S7] BUFFERED delta from S10 (total buffered=2)
[S3] RECEIVED delta(kind=head bytes=1794) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.985742)
[S3] loaded HEAD from S8 (vec_in norm=0.985742)
[S3] cosine check vs S8: cos=0.0154
[S3] BUFFERED delta from S8 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1794) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.231996)
[S6] loaded HEAD from S16 (vec_in norm=1.231996)
[S6] cosine check vs S16: cos=0.0490
[S6] BUFFERED delta from S16 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S17] → sending delta(kind=head bytes=1791) to S8@127.0.0.1:39409
[S17] sending update (kind=head size=1791 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1791) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.979720)
[S8] loaded HEAD from S17 (vec_in norm=0.979720)
[S8] cosine check vs S17: cos=-0.0232
[S8] DROPPED delta from S17 (cos=-0.0232 < 0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=3 metric=0.1414 head_norm=0.826627
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.247856e-01
[S6] stored merged vector for next round verification (round=3)
[S6] DEBUG after merge:  round=3 metric=0.1414 head_norm=0.758452 delta_norm=0.724786
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=3 metric=0.1414 head_norm=1.243836
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.577674e-01
[S9] stored merged vector for next round verification (round=3)
[S9] DEBUG after merge:  round=3 metric=0.1414 head_norm=0.779045 delta_norm=0.757767
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=3 metric=0.1398 head_norm=1.213618
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.758273e-01
[S3] stored merged vector for next round verification (round=3)
[S3] DEBUG after merge:  round=3 metric=0.1398 head_norm=0.787636 delta_norm=0.775827
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=3 metric=0.1421 head_norm=0.796861
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.532984e-01
[S7] stored merged vector for next round verification (round=3)
[S7] DEBUG after merge:  round=3 metric=0.1421 head_norm=0.616318 delta_norm=0.553298
[S7] aggregate: ACCEPT kept=['S11', 'S10'] (k=2/2) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=3 metric=0.1386 head_norm=1.235759
[S10] _apply_head_vector_avg (torch): Δ‖w‖=9.094155e-01
[S10] stored merged vector for next round verification (round=3)
[S10] DEBUG after merge:  round=3 metric=0.1386 head_norm=0.930757 delta_norm=0.909416
[S10] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=3 metric=0.4160 head_norm=1.344405
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.792870e-01
[S15] stored merged vector for next round verification (round=3)
[S15] DEBUG after merge:  round=3 metric=0.4033 head_norm=1.004517 delta_norm=0.879287
[S15] aggregate: ROLLBACK (f1_val pre=0.416 post=0.403 tol_abs=0.005 tol_rel=0.0)
[S2] START round=4 head_norm_before_train=1.363667 (no previous merge yet)
[S2] round=4 local utility u=0.787350 metrics={'f1_val': 0.6369294917513975, 'auprc': 0.7763743883568817, 'loss_val': 0.7562148011821662, 'psi': 0.6927074503935912}-{'f1_val': 0.4168093390637936, 'auprc': 0.7782852958313231, 'loss_val': 1.0159267632326348, 'psi': 0.5613997217708053}
[S3] START round=4 head_norm_before_train=0.787636 cos_to_last_merge=1.0000 (last merge round=3)
[S3] round=4 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7718571502541856, 'loss_val': 1.2458605918823622, 'psi': 0.3926468994701384}-{'f1_val': 0.13984006561410703, 'auprc': 0.998103739478088, 'loss_val': 1.252048469324489, 'psi': 0.4831455351596994}
[S4] START round=4 head_norm_before_train=0.989270 cos_to_last_merge=0.9818 (last merge round=1)
[S4] round=4 local utility u=0.614488 metrics={'f1_val': 0.37479220333490126, 'auprc': 0.6408880647408713, 'loss_val': 0.8605256174226807, 'psi': 0.48123054789728936}-{'f1_val': 0.14159059035220026, 'auprc': 0.7595867041005531, 'loss_val': 1.046387798508463, 'psi': 0.3887890358515414}
[S5] START round=4 head_norm_before_train=0.902839 cos_to_last_merge=0.9900 (last merge round=1)
[S5] round=4 local utility u=0.023045 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7700978720144308, 'loss_val': 1.2170838046913435, 'psi': 0.3933962916629152}-{'f1_val': 0.14226190476190476, 'auprc': 0.76999024498077, 'loss_val': 1.2628503986288366, 'psi': 0.39335324084945084}
[S6] START round=4 head_norm_before_train=0.758452 cos_to_last_merge=1.0000 (last merge round=3)
[S6] round=4 local utility u=0.206269 metrics={'f1_val': 0.1669291950594157, 'auprc': 0.8509558170676141, 'loss_val': 1.0872452013644347, 'psi': 0.44053984386269507}-{'f1_val': 0.14142628205128205, 'auprc': 0.7989216709583138, 'loss_val': 1.1906635882551462, 'psi': 0.40442443761409475}
[S7] START round=4 head_norm_before_train=0.616318 cos_to_last_merge=1.0000 (last merge round=3)
[S7] round=4 local utility u=0.287184 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7711578786273122, 'loss_val': 1.3012033183007554, 'psi': 0.3936972450883799}-{'f1_val': 0.14205682272909165, 'auprc': 0.5790795027003344, 'loss_val': 1.299336213752963, 'psi': 0.31686589471758875}
[S8] START round=4 head_norm_before_train=0.985742 cos_to_last_merge=0.9767 (last merge round=1)
[S8] round=4 local utility u=0.540763 metrics={'f1_val': 0.7145254456069222, 'auprc': 0.8052880251700515, 'loss_val': 0.5973266011815187, 'psi': 0.7508304774321739}-{'f1_val': 0.6116589246136175, 'auprc': 0.7944015213280635, 'loss_val': 1.028994282398843, 'psi': 0.6847559632993959}
[S9] START round=4 head_norm_before_train=0.779045 cos_to_last_merge=1.0000 (last merge round=3)
[S9] round=4 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8659907573581551, 'loss_val': 1.2102099700161666, 'psi': 0.4312350772272597}-{'f1_val': 0.141397957139996, 'auprc': 0.8662222370030122, 'loss_val': 1.201799501052754, 'psi': 0.4313276690852025}
[S10] START round=4 head_norm_before_train=0.930757 cos_to_last_merge=1.0000 (last merge round=3)
[S10] round=4 local utility u=0.992078 metrics={'f1_val': 0.4170518629654155, 'auprc': 0.6516597106788947, 'loss_val': 0.9917809888056345, 'psi': 0.5108950020508072}-{'f1_val': 0.13862163754172394, 'auprc': 0.605927634928036, 'loss_val': 1.1681593337442095, 'psi': 0.32554403649624875}
[S11] START round=4 head_norm_before_train=1.228571 (no previous merge yet)
[S11] round=4 local utility u=0.033328 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7654171574417279, 'loss_val': 1.173512442854972, 'psi': 0.3904150730005575}-{'f1_val': 0.14041368337311058, 'auprc': 0.7660781049483045, 'loss_val': 1.2421508346128123, 'psi': 0.39067945200318815}
[S13] START round=4 head_norm_before_train=1.325510 (no previous merge yet)
[S13] round=4 local utility u=0.000000 metrics={'f1_val': 0.44556018988754936, 'auprc': 0.6829568717696242, 'loss_val': 0.8616181452516122, 'psi': 0.5405188626403793}-{'f1_val': 0.41627458463323097, 'auprc': 0.8255984988841811, 'loss_val': 1.0341142835550958, 'psi': 0.5800041503336111}
[S14] START round=4 head_norm_before_train=1.211738 (no previous merge yet)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8513347061139269, 'loss_val': 1.2348420098947221, 'psi': 0.42474859417519306}-{'f1_val': 0.14035785288270378, 'auprc': 0.9333414636462447, 'loss_val': 1.2776027437447792, 'psi': 0.45755129718812015}
[S15] START round=4 head_norm_before_train=1.004517 cos_to_last_merge=1.0000 (last merge round=3)
[S15] round=4 local utility u=0.078994 metrics={'f1_val': 0.4156068426860873, 'auprc': 0.7899993048280989, 'loss_val': 1.006941974658964, 'psi': 0.5653638275428919}-{'f1_val': 0.41599167481162613, 'auprc': 0.7770081799572915, 'loss_val': 1.1282646127510514, 'psi': 0.5603982768698923}
[S16] START round=4 head_norm_before_train=1.231996 (no previous merge yet)
[S16] round=4 local utility u=0.022884 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8132459177933462, 'loss_val': 1.1932318174274126, 'psi': 0.40968083723686044}-{'f1_val': 0.14063745019920318, 'auprc': 0.81357978590703, 'loss_val': 1.2400020573992292, 'psi': 0.40981438448233387}
[S17] START round=4 head_norm_before_train=0.979720 cos_to_last_merge=0.9746 (last merge round=1)
[S17] round=4 local utility u=0.475396 metrics={'f1_val': 0.38795738422529547, 'auprc': 0.8878401619199331, 'loss_val': 0.9173595986216916, 'psi': 0.5879104953031505}-{'f1_val': 0.3900009712509712, 'auprc': 0.6150715745128802, 'loss_val': 1.0621080161939682, 'psi': 0.48002921255573483}
[S11] not sending this round → trigger blocked (psi=0.390)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S6] → sending delta(kind=head bytes=1790) to S8@127.0.0.1:39409
[S5] not sending this round → trigger blocked (psi=0.393)
[S2] not sending this round → trigger blocked (psi=0.693)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.481)
[S7] not sending this round → trigger blocked (psi=0.394)
[S8] not sending this round → trigger blocked (psi=0.751)
[S10] not sending this round → trigger blocked (psi=0.511)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.565)
[S16] not sending this round → trigger blocked (psi=0.410)
[S6] sending update (kind=head size=1790 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1790) from S6
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.808192)
[S8] loaded HEAD from S6 (vec_in norm=0.808192)
[S8] cosine check vs S6: cos=-0.0329
[S8] DROPPED delta from S6 (cos=-0.0329 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.588)
[S2] START round=5 head_norm_before_train=1.427267 (no previous merge yet)
[S2] round=5 local utility u=0.251321 metrics={'f1_val': 0.7015719066528542, 'auprc': 0.7371344231303336, 'loss_val': 0.5237075134016125, 'psi': 0.715796913243846}-{'f1_val': 0.6369294917513975, 'auprc': 0.7763743883568817, 'loss_val': 0.7562148011821662, 'psi': 0.6927074503935912}
[S3] START round=5 head_norm_before_train=0.816985 cos_to_last_merge=0.9967 (last merge round=3)
[S3] round=5 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.6702576179279602, 'loss_val': 1.1885839047998623, 'psi': 0.3520070865396483}-{'f1_val': 0.13984006561410703, 'auprc': 0.7718571502541856, 'loss_val': 1.2458605918823622, 'psi': 0.3926468994701384}
[S4] START round=5 head_norm_before_train=1.059049 cos_to_last_merge=0.9631 (last merge round=1)
[S4] round=5 local utility u=0.265466 metrics={'f1_val': 0.37396895454721796, 'auprc': 0.788466056275213, 'loss_val': 0.7673883896910444, 'psi': 0.539767795238416}-{'f1_val': 0.37479220333490126, 'auprc': 0.6408880647408713, 'loss_val': 0.8605256174226807, 'psi': 0.48123054789728936}
[S5] START round=5 head_norm_before_train=0.941156 cos_to_last_merge=0.9801 (last merge round=1)
[S5] round=5 local utility u=0.029477 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7710172497705763, 'loss_val': 1.1608878248745982, 'psi': 0.3937640427653734}-{'f1_val': 0.14226190476190476, 'auprc': 0.7700978720144308, 'loss_val': 1.2170838046913435, 'psi': 0.3933962916629152}
[S6] START round=5 head_norm_before_train=0.808192 cos_to_last_merge=0.9877 (last merge round=3)
[S6] round=5 local utility u=1.000000 metrics={'f1_val': 0.4171358730402079, 'auprc': 0.9673598142709235, 'loss_val': 0.8486961741382423, 'psi': 0.6372254495324942}-{'f1_val': 0.1669291950594157, 'auprc': 0.8509558170676141, 'loss_val': 1.0872452013644347, 'psi': 0.44053984386269507}
[S7] START round=5 head_norm_before_train=0.634225 cos_to_last_merge=0.9945 (last merge round=3)
[S7] round=5 local utility u=0.005983 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7576505276443508, 'loss_val': 1.248714873361211, 'psi': 0.3882943046951953}-{'f1_val': 0.14205682272909165, 'auprc': 0.7711578786273122, 'loss_val': 1.3012033183007554, 'psi': 0.3936972450883799}
[S8] START round=5 head_norm_before_train=1.071468 cos_to_last_merge=0.9547 (last merge round=1)
[S8] round=5 local utility u=0.364948 metrics={'f1_val': 0.7011482055830367, 'auprc': 0.9930687069735444, 'loss_val': 0.35050887520470736, 'psi': 0.8179164061392398}-{'f1_val': 0.7145254456069222, 'auprc': 0.8052880251700515, 'loss_val': 0.5973266011815187, 'psi': 0.7508304774321739}
[S9] START round=5 head_norm_before_train=0.820820 cos_to_last_merge=0.9961 (last merge round=3)
[S9] round=5 local utility u=0.032610 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8660239750016208, 'loss_val': 1.1450888838618858, 'psi': 0.4312483642846459}-{'f1_val': 0.141397957139996, 'auprc': 0.8659907573581551, 'loss_val': 1.2102099700161666, 'psi': 0.4312350772272597}
[S10] START round=5 head_norm_before_train=0.986555 cos_to_last_merge=0.9934 (last merge round=3)
[S10] round=5 local utility u=0.446875 metrics={'f1_val': 0.4114272190250352, 'auprc': 0.8573871589847992, 'loss_val': 0.681465778917406, 'psi': 0.5898111950089409}-{'f1_val': 0.4170518629654155, 'auprc': 0.6516597106788947, 'loss_val': 0.9917809888056345, 'psi': 0.5108950020508072}
[S11] START round=5 head_norm_before_train=1.264957 (no previous merge yet)
[S11] round=5 local utility u=0.905831 metrics={'f1_val': 0.4229120744550575, 'auprc': 0.7687121462218971, 'loss_val': 1.066726523228491, 'psi': 0.5612321031617933}-{'f1_val': 0.14041368337311058, 'auprc': 0.7654171574417279, 'loss_val': 1.173512442854972, 'psi': 0.3904150730005575}
[S13] START round=5 head_norm_before_train=1.388660 (no previous merge yet)
[S13] round=5 local utility u=1.000000 metrics={'f1_val': 0.7115091406168195, 'auprc': 0.7694721347120834, 'loss_val': 0.6630055874011382, 'psi': 0.7346943382549251}-{'f1_val': 0.44556018988754936, 'auprc': 0.6829568717696242, 'loss_val': 0.8616181452516122, 'psi': 0.5405188626403793}
[S14] START round=5 head_norm_before_train=1.247472 (no previous merge yet)
[S14] round=5 local utility u=0.095065 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8948418231130376, 'loss_val': 1.1752328462562203, 'psi': 0.44215144097483733}-{'f1_val': 0.14035785288270378, 'auprc': 0.8513347061139269, 'loss_val': 1.2348420098947221, 'psi': 0.42474859417519306}
[S15] START round=5 head_norm_before_train=1.049523 cos_to_last_merge=0.9947 (last merge round=3)
[S15] round=5 local utility u=1.000000 metrics={'f1_val': 0.6848295083125739, 'auprc': 0.9753993505233779, 'loss_val': 0.7426306817237931, 'psi': 0.8010574451968955}-{'f1_val': 0.4156068426860873, 'auprc': 0.7899993048280989, 'loss_val': 1.006941974658964, 'psi': 0.5653638275428919}
[S16] START round=5 head_norm_before_train=1.268636 (no previous merge yet)
[S16] round=5 local utility u=0.650291 metrics={'f1_val': 0.3744695042514127, 'auprc': 0.7532674620598389, 'loss_val': 1.115706273288888, 'psi': 0.5259886873747832}-{'f1_val': 0.14063745019920318, 'auprc': 0.8132459177933462, 'loss_val': 1.1932318174274126, 'psi': 0.40968083723686044}
[S17] START round=5 head_norm_before_train=1.056717 cos_to_last_merge=0.9509 (last merge round=1)
[S17] round=5 local utility u=0.000000 metrics={'f1_val': 0.35480128428545776, 'auprc': 0.7702687869382486, 'loss_val': 0.849899189007847, 'psi': 0.5209882853465742}-{'f1_val': 0.38795738422529547, 'auprc': 0.8878401619199331, 'loss_val': 0.9173595986216916, 'psi': 0.5879104953031505}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] → sending delta(kind=head bytes=1792) to S9@127.0.0.1:39410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:39403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:39403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S2@127.0.0.1:39402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:39411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:39411
[S6] not sending this round → trigger blocked (psi=0.637)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:39408
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S16] → sending delta(kind=head bytes=1789) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:39408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:39415
[S7] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S16] sending update (kind=head size=1789 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1792 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1798) from S11
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.297973)
[S7] loaded HEAD from S11 (vec_in norm=1.297973)
[S7] cosine check vs S11: cos=0.4733
[S7] BUFFERED delta from S11 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1801) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.066311)
[S7] loaded HEAD from S10 (vec_in norm=1.066311)
[S7] cosine check vs S10: cos=0.3939
[S7] BUFFERED delta from S10 (total buffered=2)
[S6] RECEIVED delta(kind=head bytes=1789) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.301049)
[S6] loaded HEAD from S16 (vec_in norm=1.301049)
[S6] cosine check vs S16: cos=0.7371
[S6] BUFFERED delta from S16 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1794) from S4
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.142161)
[S2] loaded HEAD from S4 (vec_in norm=1.142161)
[S2] cosine check vs S4: cos=-0.0772
[S2] DROPPED delta from S4 (cos=-0.0772 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1798) from S7
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.662466)
[S15] loaded HEAD from S7 (vec_in norm=0.662466)
[S15] cosine check vs S7: cos=-0.0722
[S15] DROPPED delta from S7 (cos=-0.0722 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1803) from S15
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.113663)
[S10] loaded HEAD from S15 (vec_in norm=1.113663)
[S10] cosine check vs S15: cos=-0.0558
[S10] DROPPED delta from S15 (cos=-0.0558 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1798) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.173659)
[S3] loaded HEAD from S8 (vec_in norm=1.173659)
[S3] cosine check vs S8: cos=0.5669
[S3] BUFFERED delta from S8 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1796) from S2
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.503642)
[S10] loaded HEAD from S2 (vec_in norm=1.503642)
[S10] cosine check vs S2: cos=0.6774
[S10] BUFFERED delta from S2 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1792) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.975884)
[S9] loaded HEAD from S5 (vec_in norm=0.975884)
[S9] cosine check vs S5: cos=0.5503
[S9] BUFFERED delta from S5 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1796) from S13
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.443679)
[S15] loaded HEAD from S13 (vec_in norm=1.443679)
[S15] cosine check vs S13: cos=0.6880
[S15] BUFFERED delta from S13 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1795) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.869945)
[S3] loaded HEAD from S9 (vec_in norm=0.869945)
[S3] cosine check vs S9: cos=-0.0194
[S3] DROPPED delta from S9 (cos=-0.0194 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1796) from S14
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.284276)
[S6] loaded HEAD from S14 (vec_in norm=1.284276)
[S6] cosine check vs S14: cos=0.0306
[S6] BUFFERED delta from S14 (total buffered=2)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=5 metric=0.4171 head_norm=0.883886
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.407724e-01
[S6] stored merged vector for next round verification (round=5)
[S6] DEBUG after merge:  round=5 metric=0.4173 head_norm=0.797168 delta_norm=0.440772
[S6] aggregate: ACCEPT kept=['S16', 'S14'] (k=2/2) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.565 → S8@127.0.0.1:39409
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=5 metric=0.1398 head_norm=0.846732
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.918658e-01
[S3] stored merged vector for next round verification (round=5)
[S3] DEBUG after merge:  round=5 metric=0.1398 head_norm=0.897376 delta_norm=0.491866
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.353 → S15@127.0.0.1:39415
[S2] ⇄ pheromone p=0.640 → S10@127.0.0.1:39411
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=5 metric=0.1414 head_norm=0.869945
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.400957e-01
[S9] stored merged vector for next round verification (round=5)
[S9] DEBUG after merge:  round=5 metric=0.1414 head_norm=0.812953 delta_norm=0.440096
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.372 → S3@127.0.0.1:39403
[S14] ⇄ pheromone p=0.429 → S6@127.0.0.1:39407
[S4] ⇄ pheromone p=0.523 → S2@127.0.0.1:39402
[S5] ⇄ pheromone p=0.340 → S9@127.0.0.1:39410
[S8] ⇄ pheromone p=0.622 → S3@127.0.0.1:39403
[S11] ⇄ pheromone p=0.517 → S7@127.0.0.1:39408
[S13] ⇄ pheromone p=0.656 → S15@127.0.0.1:39415
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=5 metric=0.4114 head_norm=1.066311
[S10] _apply_head_vector_avg (torch): Δ‖w‖=5.535703e-01
[S10] stored merged vector for next round verification (round=5)
[S10] DEBUG after merge:  round=5 metric=0.4115 head_norm=1.180059 delta_norm=0.553570
[S10] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.597 → S7@127.0.0.1:39408
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=5 metric=0.1421 head_norm=0.662466
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.433792e-01
[S7] stored merged vector for next round verification (round=5)
[S7] DEBUG after merge:  round=5 metric=0.1421 head_norm=0.678629 delta_norm=0.343379
[S7] aggregate: ACCEPT kept=['S11', 'S10'] (k=2/2) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.408 → S15@127.0.0.1:39415
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=5 metric=0.6848 head_norm=1.113663
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.272714e-01
[S15] stored merged vector for next round verification (round=5)
[S15] DEBUG after merge:  round=5 metric=0.4172 head_norm=1.176525 delta_norm=0.527271
[S15] aggregate: ROLLBACK (f1_val pre=0.685 post=0.417 tol_abs=0.005 tol_rel=0.0)
[S15] ⇄ pheromone p=0.666 → S10@127.0.0.1:39411
[S16] ⇄ pheromone p=0.498 → S6@127.0.0.1:39407
[S17] ⇄ pheromone p=0.528 → S8@127.0.0.1:39409
[S2] START round=6 head_norm_before_train=1.503642 (no previous merge yet)
[S2] round=6 local utility u=0.042365 metrics={'f1_val': 0.7018318238212289, 'auprc': 0.7220130910402538, 'loss_val': 0.39517326848351325, 'psi': 0.7099043307088388}-{'f1_val': 0.7015719066528542, 'auprc': 0.7371344231303336, 'loss_val': 0.5237075134016125, 'psi': 0.715796913243846}
[S3] START round=6 head_norm_before_train=0.897376 cos_to_last_merge=1.0000 (last merge round=5)
[S3] round=6 local utility u=0.410029 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9326977080633331, 'loss_val': 1.1558457291965516, 'psi': 0.4569831225937975}-{'f1_val': 0.13984006561410703, 'auprc': 0.6702576179279602, 'loss_val': 1.1885839047998623, 'psi': 0.3520070865396483}
[S4] START round=6 head_norm_before_train=1.142161 cos_to_last_merge=0.9396 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.940
[S4] round=6 local utility u=0.213173 metrics={'f1_val': 0.37332541967779714, 'auprc': 0.9233122529977221, 'loss_val': 0.7417199291841297, 'psi': 0.5933201530057672}-{'f1_val': 0.37396895454721796, 'auprc': 0.788466056275213, 'loss_val': 0.7673883896910444, 'psi': 0.539767795238416}
[S5] START round=6 head_norm_before_train=0.975884 cos_to_last_merge=0.9712 (last merge round=1)
[S5] round=6 local utility u=0.877179 metrics={'f1_val': 0.41875765132080744, 'auprc': 0.7777933856156133, 'loss_val': 1.0858320762769544, 'psi': 0.5623719450387298}-{'f1_val': 0.14226190476190476, 'auprc': 0.7710172497705763, 'loss_val': 1.1608878248745982, 'psi': 0.3937640427653734}
[S6] START round=6 head_norm_before_train=0.797168 cos_to_last_merge=1.0000 (last merge round=5)
[S6] round=6 local utility u=0.000000 metrics={'f1_val': 0.4158034991322031, 'auprc': 0.7861254435622429, 'loss_val': 0.76152667273221, 'psi': 0.563932276904219}-{'f1_val': 0.4171358730402079, 'auprc': 0.9673598142709235, 'loss_val': 0.8486961741382423, 'psi': 0.6372254495324942}
[S7] START round=6 head_norm_before_train=0.678629 cos_to_last_merge=1.0000 (last merge round=5)
[S7] round=6 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.5795490751437339, 'loss_val': 1.2222083673905721, 'psi': 0.31705372369494855}-{'f1_val': 0.14205682272909165, 'auprc': 0.7576505276443508, 'loss_val': 1.248714873361211, 'psi': 0.3882943046951953}
[S8] START round=6 head_norm_before_train=1.173659 cos_to_last_merge=0.9273 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.927
[S8] round=6 local utility u=0.101849 metrics={'f1_val': 0.7141738056351523, 'auprc': 0.9975478747820137, 'loss_val': 0.23840244634403993, 'psi': 0.8275234332938969}-{'f1_val': 0.7011482055830367, 'auprc': 0.9930687069735444, 'loss_val': 0.35050887520470736, 'psi': 0.8179164061392398}
[S9] START round=6 head_norm_before_train=0.812953 cos_to_last_merge=1.0000 (last merge round=5)
[S9] round=6 local utility u=0.053394 metrics={'f1_val': 0.1419951729686243, 'auprc': 0.8661183571895587, 'loss_val': 1.0421679805616926, 'psi': 0.431644446656998}-{'f1_val': 0.141397957139996, 'auprc': 0.8660239750016208, 'loss_val': 1.1450888838618858, 'psi': 0.4312483642846459}
[S10] START round=6 head_norm_before_train=1.180059 cos_to_last_merge=1.0000 (last merge round=5)
[S10] round=6 local utility u=1.000000 metrics={'f1_val': 0.688677047063993, 'auprc': 0.9931514616655392, 'loss_val': 0.4970237170173305, 'psi': 0.8104668129046115}-{'f1_val': 0.4114272190250352, 'auprc': 0.8573871589847992, 'loss_val': 0.681465778917406, 'psi': 0.5898111950089409}
[S11] START round=6 head_norm_before_train=1.297973 (no previous merge yet)
[S11] round=6 local utility u=0.110547 metrics={'f1_val': 0.41201846536531284, 'auprc': 0.8039617120206289, 'loss_val': 0.8860196017671507, 'psi': 0.5687957640274393}-{'f1_val': 0.4229120744550575, 'auprc': 0.7687121462218971, 'loss_val': 1.066726523228491, 'psi': 0.5612321031617933}
[S13] START round=6 head_norm_before_train=1.443679 (no previous merge yet)
[S13] round=6 local utility u=0.000000 metrics={'f1_val': 0.6073077058530659, 'auprc': 0.7291859055552541, 'loss_val': 0.6153950099883195, 'psi': 0.6560589857339412}-{'f1_val': 0.7115091406168195, 'auprc': 0.7694721347120834, 'loss_val': 0.6630055874011382, 'psi': 0.7346943382549251}
[S14] START round=6 head_norm_before_train=1.284276 (no previous merge yet)
[S14] round=6 local utility u=0.380223 metrics={'f1_val': 0.2579585118300798, 'auprc': 0.8777680642334369, 'loss_val': 1.0691686943655245, 'psi': 0.5058823327914226}-{'f1_val': 0.14035785288270378, 'auprc': 0.8948418231130376, 'loss_val': 1.1752328462562203, 'psi': 0.44215144097483733}
[S15] START round=6 head_norm_before_train=1.176525 cos_to_last_merge=1.0000 (last merge round=5)
[S15] round=6 local utility u=0.063625 metrics={'f1_val': 0.6905129834114858, 'auprc': 0.9829591250080432, 'loss_val': 0.672160266715114, 'psi': 0.8074914400501088}-{'f1_val': 0.6848295083125739, 'auprc': 0.9753993505233779, 'loss_val': 0.7426306817237931, 'psi': 0.8010574451968955}
[S16] START round=6 head_norm_before_train=1.301049 (no previous merge yet)
[S16] round=6 local utility u=0.155049 metrics={'f1_val': 0.41730798768076294, 'auprc': 0.7392607453144143, 'loss_val': 1.0206189090768698, 'psi': 0.5460890907342235}-{'f1_val': 0.3744695042514127, 'auprc': 0.7532674620598389, 'loss_val': 1.115706273288888, 'psi': 0.5259886873747832}
[S17] START round=6 head_norm_before_train=1.139823 cos_to_last_merge=0.9250 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.925
[S17] round=6 local utility u=0.000000 metrics={'f1_val': 0.35332495072624465, 'auprc': 0.7346327616802031, 'loss_val': 0.8735922218692777, 'psi': 0.505848075107828}-{'f1_val': 0.35480128428545776, 'auprc': 0.7702687869382486, 'loss_val': 0.849899189007847, 'psi': 0.5209882853465742}
[S9] not sending this round → trigger blocked (psi=0.432)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S3] → sending delta(kind=head bytes=1789) to S15@127.0.0.1:39415
[S2] not sending this round → trigger blocked (psi=0.710)
[S10] not sending this round → trigger blocked (psi=0.810)
[S15] not sending this round → trigger blocked (psi=0.807)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.546)
[S5] not sending this round → trigger blocked (psi=0.562)
[S14] not sending this round → trigger blocked (psi=0.506)
[S8] not sending this round → trigger blocked (psi=0.828)
[S11] not sending this round → trigger blocked (psi=0.569)
[S4] not sending this round → trigger blocked (psi=0.593)
[S3] sending update (kind=head size=1789 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1789) from S3
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=0.915100)
[S15] loaded HEAD from S3 (vec_in norm=0.915100)
[S15] cosine check vs S3: cos=0.0246
[S15] BUFFERED delta from S3 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=6 metric=0.6905 head_norm=1.233944
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.590316e-01
[S15] stored merged vector for next round verification (round=6)
[S15] DEBUG after merge:  round=6 metric=0.6319 head_norm=0.777100 delta_norm=0.759032
[S15] aggregate: ROLLBACK (f1_val pre=0.691 post=0.632 tol_abs=0.005 tol_rel=0.0)
[S2] START round=7 head_norm_before_train=1.590745 (no previous merge yet)
[S2] round=7 local utility u=0.000000 metrics={'f1_val': 0.6109725304976397, 'auprc': 0.6587818798963184, 'loss_val': 0.5253088772974469, 'psi': 0.6300962702571111}-{'f1_val': 0.7018318238212289, 'auprc': 0.7220130910402538, 'loss_val': 0.39517326848351325, 'psi': 0.7099043307088388}
[S3] START round=7 head_norm_before_train=0.915100 cos_to_last_merge=0.9962 (last merge round=5)
[S3] round=7 local utility u=0.078361 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9508888109147868, 'loss_val': 1.0536970495935978, 'psi': 0.46425956373437893}-{'f1_val': 0.13984006561410703, 'auprc': 0.9326977080633331, 'loss_val': 1.1558457291965516, 'psi': 0.4569831225937975}
[S4] START round=7 head_norm_before_train=1.221096 cos_to_last_merge=0.9182 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.918
[S4] round=7 local utility u=0.088283 metrics={'f1_val': 0.4348042654150791, 'auprc': 0.8321583292984319, 'loss_val': 0.6605650287508917, 'psi': 0.5937458909684202}-{'f1_val': 0.37332541967779714, 'auprc': 0.9233122529977221, 'loss_val': 0.7417199291841297, 'psi': 0.5933201530057672}
[S5] START round=7 head_norm_before_train=0.999281 cos_to_last_merge=0.9640 (last merge round=1)
[S5] round=7 local utility u=0.076959 metrics={'f1_val': 0.41952548118843314, 'auprc': 0.7778200046619603, 'loss_val': 0.9366001953203729, 'psi': 0.562843290577844}-{'f1_val': 0.41875765132080744, 'auprc': 0.7777933856156133, 'loss_val': 1.0858320762769544, 'psi': 0.5623719450387298}
[S6] START round=7 head_norm_before_train=0.869234 cos_to_last_merge=0.9869 (last merge round=5)
[S6] round=7 local utility u=0.672917 metrics={'f1_val': 0.6141012694888244, 'auprc': 0.7903452117222854, 'loss_val': 0.6181393272968428, 'psi': 0.6845988463822088}-{'f1_val': 0.4158034991322031, 'auprc': 0.7861254435622429, 'loss_val': 0.76152667273221, 'psi': 0.563932276904219}
[S7] START round=7 head_norm_before_train=0.700828 cos_to_last_merge=0.9941 (last merge round=5)
[S7] round=7 local utility u=0.150571 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.6497427894902097, 'loss_val': 1.1316471935153671, 'psi': 0.34513120943353887}-{'f1_val': 0.14205682272909165, 'auprc': 0.5795490751437339, 'loss_val': 1.2222083673905721, 'psi': 0.31705372369494855}
[S8] START round=7 head_norm_before_train=1.251920 cos_to_last_merge=0.9038 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.904
[S8] round=7 local utility u=0.883345 metrics={'f1_val': 0.9950223643478788, 'auprc': 0.9981011710598162, 'loss_val': 0.15846281744534946, 'psi': 0.9962538870326538}-{'f1_val': 0.7141738056351523, 'auprc': 0.9975478747820137, 'loss_val': 0.23840244634403993, 'psi': 0.8275234332938969}
[S9] START round=7 head_norm_before_train=0.846029 cos_to_last_merge=0.9956 (last merge round=5)
[S9] round=7 local utility u=1.000000 metrics={'f1_val': 0.6759385232691169, 'auprc': 0.8986002456317701, 'loss_val': 0.8214773263043567, 'psi': 0.7650032122141781}-{'f1_val': 0.1419951729686243, 'auprc': 0.8661183571895587, 'loss_val': 1.0421679805616926, 'psi': 0.431644446656998}
[S10] START round=7 head_norm_before_train=1.248920 cos_to_last_merge=0.9939 (last merge round=5)
[S10] round=7 local utility u=0.000000 metrics={'f1_val': 0.6884085598604146, 'auprc': 0.9427254539271267, 'loss_val': 0.37629742037151587, 'psi': 0.7901353174870995}-{'f1_val': 0.688677047063993, 'auprc': 0.9931514616655392, 'loss_val': 0.4970237170173305, 'psi': 0.8104668129046115}
[S11] START round=7 head_norm_before_train=1.340405 (no previous merge yet)
[S11] round=7 local utility u=0.327580 metrics={'f1_val': 0.3998848669786352, 'auprc': 0.99457585580289, 'loss_val': 0.7299013225919546, 'psi': 0.6377612625083371}-{'f1_val': 0.41201846536531284, 'auprc': 0.8039617120206289, 'loss_val': 0.8860196017671507, 'psi': 0.5687957640274393}
[S13] START round=7 head_norm_before_train=1.500884 (no previous merge yet)
[S13] round=7 local utility u=0.046834 metrics={'f1_val': 0.6328049402644566, 'auprc': 0.6811942543729474, 'loss_val': 0.5307359433294839, 'psi': 0.6521606659078529}-{'f1_val': 0.6073077058530659, 'auprc': 0.7291859055552541, 'loss_val': 0.6153950099883195, 'psi': 0.6560589857339412}
[S14] START round=7 head_norm_before_train=1.321311 (no previous merge yet)
[S14] round=7 local utility u=0.234780 metrics={'f1_val': 0.2820423653155787, 'auprc': 0.9175046496185749, 'loss_val': 0.8633212584566387, 'psi': 0.5362272790367772}-{'f1_val': 0.2579585118300798, 'auprc': 0.8777680642334369, 'loss_val': 1.0691686943655245, 'psi': 0.5058823327914226}
[S15] START round=7 head_norm_before_train=0.777100 cos_to_last_merge=1.0000 (last merge round=6)
[S15] round=7 local utility u=0.000000 metrics={'f1_val': 0.6992440016150824, 'auprc': 0.8104605052439809, 'loss_val': 0.6197428480978666, 'psi': 0.7437306030666418}-{'f1_val': 0.6905129834114858, 'auprc': 0.9829591250080432, 'loss_val': 0.672160266715114, 'psi': 0.8074914400501088}
[S16] START round=7 head_norm_before_train=1.330059 (no previous merge yet)
[S16] round=7 local utility u=0.044376 metrics={'f1_val': 0.41731184350684625, 'auprc': 0.7388824543620569, 'loss_val': 0.9307550733599088, 'psi': 0.5459400878489304}-{'f1_val': 0.41730798768076294, 'auprc': 0.7392607453144143, 'loss_val': 1.0206189090768698, 'psi': 0.5460890907342235}
[S17] START round=7 head_norm_before_train=1.192734 cos_to_last_merge=0.9053 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.905
[S17] round=7 local utility u=0.020446 metrics={'f1_val': 0.3583219334245326, 'auprc': 0.712057640474963, 'loss_val': 0.7949559061346609, 'psi': 0.49981621624470474}-{'f1_val': 0.35332495072624465, 'auprc': 0.7346327616802031, 'loss_val': 0.8735922218692777, 'psi': 0.505848075107828}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S2@127.0.0.1:39402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:39403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:39410
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:39415
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:39409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:39403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:39408
[S3] not sending this round → trigger blocked (psi=0.464)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1793 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1795) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.896000)
[S3] loaded HEAD from S9 (vec_in norm=0.896000)
[S3] cosine check vs S9: cos=-0.0186
[S3] DROPPED delta from S9 (cos=-0.0186 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1797) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.323338)
[S3] loaded HEAD from S8 (vec_in norm=1.323338)
[S3] cosine check vs S8: cos=0.8554
[S3] BUFFERED delta from S8 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1794) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.036040)
[S9] loaded HEAD from S5 (vec_in norm=1.036040)
[S9] cosine check vs S5: cos=0.8263
[S9] BUFFERED delta from S5 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1793) from S6
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.958130)
[S8] loaded HEAD from S6 (vec_in norm=0.958130)
[S8] cosine check vs S6: cos=-0.0619
[S8] DROPPED delta from S6 (cos=-0.0619 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1804) from S4
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.302054)
[S2] loaded HEAD from S4 (vec_in norm=1.302054)
[S2] cosine check vs S4: cos=-0.0661
[S2] DROPPED delta from S4 (cos=-0.0661 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1802) from S11
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.386840)
[S7] loaded HEAD from S11 (vec_in norm=1.386840)
[S7] cosine check vs S11: cos=0.6525
[S7] BUFFERED delta from S11 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1794) from S14
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.371256)
[S6] loaded HEAD from S14 (vec_in norm=1.371256)
[S6] cosine check vs S14: cos=0.3758
[S6] BUFFERED delta from S14 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1798) from S13
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.548408)
[S15] loaded HEAD from S13 (vec_in norm=1.548408)
[S15] cosine check vs S13: cos=0.7121
[S15] BUFFERED delta from S13 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1797) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.368003)
[S6] loaded HEAD from S16 (vec_in norm=1.368003)
[S6] cosine check vs S16: cos=0.7352
[S6] BUFFERED delta from S16 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1803) from S7
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.733215)
[S15] loaded HEAD from S7 (vec_in norm=0.733215)
[S15] cosine check vs S7: cos=0.0420
[S15] BUFFERED delta from S7 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:39409
[S17] sending update (kind=head size=1803 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1803) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.232353)
[S8] loaded HEAD from S17 (vec_in norm=1.232353)
[S8] cosine check vs S17: cos=-0.0248
[S8] DROPPED delta from S17 (cos=-0.0248 < 0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=7 metric=0.1398 head_norm=0.943909
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.554075e-01
[S3] stored merged vector for next round verification (round=7)
[S3] DEBUG after merge:  round=7 metric=0.1398 head_norm=1.093060 delta_norm=0.355407
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=7 metric=0.6141 head_norm=0.958130
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.318200e-01
[S6] stored merged vector for next round verification (round=7)
[S6] DEBUG after merge:  round=7 metric=0.7021 head_norm=0.915880 delta_norm=0.331820
[S6] aggregate: ACCEPT kept=['S14', 'S16'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=7 metric=0.1421 head_norm=0.733215
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.324262e-01
[S7] stored merged vector for next round verification (round=7)
[S7] DEBUG after merge:  round=7 metric=0.1421 head_norm=0.973133 delta_norm=0.532426
[S7] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=7 metric=0.6759 head_norm=0.896000
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.924728e-01
[S9] stored merged vector for next round verification (round=7)
[S9] DEBUG after merge:  round=7 metric=0.4369 head_norm=0.923340 delta_norm=0.292473
[S9] aggregate: ROLLBACK (f1_val pre=0.676 post=0.437 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=7 metric=0.6992 head_norm=0.854696
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.478666e-01
[S15] stored merged vector for next round verification (round=7)
[S15] DEBUG after merge:  round=7 metric=0.6991 head_norm=0.778054 delta_norm=0.347867
[S15] aggregate: ACCEPT kept=['S13', 'S7'] (k=2/2) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=1.657396 (no previous merge yet)
[S2] round=8 local utility u=0.418495 metrics={'f1_val': 0.7015710590385817, 'auprc': 0.6770850731955855, 'loss_val': 0.28681888984293485, 'psi': 0.6917766647013832}-{'f1_val': 0.6109725304976397, 'auprc': 0.6587818798963184, 'loss_val': 0.5253088772974469, 'psi': 0.6300962702571111}
[S3] START round=8 head_norm_before_train=1.093060 cos_to_last_merge=1.0000 (last merge round=7)
[S3] round=8 local utility u=0.842797 metrics={'f1_val': 0.396483704974271, 'auprc': 0.9705678006153527, 'loss_val': 0.9670009343908876, 'psi': 0.6261173432307037}-{'f1_val': 0.13984006561410703, 'auprc': 0.9508888109147868, 'loss_val': 1.0536970495935978, 'psi': 0.46425956373437893}
[S4] START round=8 head_norm_before_train=1.302054 cos_to_last_merge=0.8984 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.898
[S4] round=8 local utility u=0.833601 metrics={'f1_val': 0.6498193061317994, 'auprc': 0.9324988860151637, 'loss_val': 0.5844751997597363, 'psi': 0.7628911380851451}-{'f1_val': 0.4348042654150791, 'auprc': 0.8321583292984319, 'loss_val': 0.6605650287508917, 'psi': 0.5937458909684202}
[S5] START round=8 head_norm_before_train=1.036040 cos_to_last_merge=0.9517 (last merge round=1)
[S5] round=8 local utility u=0.931653 metrics={'f1_val': 0.714571317832885, 'auprc': 0.7774849339398527, 'loss_val': 0.842563768514915, 'psi': 0.739736764275672}-{'f1_val': 0.41952548118843314, 'auprc': 0.7778200046619603, 'loss_val': 0.9366001953203729, 'psi': 0.562843290577844}
[S6] START round=8 head_norm_before_train=0.915880 cos_to_last_merge=1.0000 (last merge round=7)
[S6] round=8 local utility u=0.314837 metrics={'f1_val': 0.7073348755151215, 'auprc': 0.7965108328033687, 'loss_val': 0.5663647800754945, 'psi': 0.7430052584304204}-{'f1_val': 0.6141012694888244, 'auprc': 0.7903452117222854, 'loss_val': 0.6181393272968428, 'psi': 0.6845988463822088}
[S7] START round=8 head_norm_before_train=0.973133 cos_to_last_merge=1.0000 (last merge round=7)
[S7] round=8 local utility u=0.783532 metrics={'f1_val': 0.4170778520170104, 'auprc': 0.603728899086898, 'loss_val': 1.0766674204980198, 'psi': 0.49173827084496546}-{'f1_val': 0.14205682272909165, 'auprc': 0.6497427894902097, 'loss_val': 1.1316471935153671, 'psi': 0.34513120943353887}
[S8] START round=8 head_norm_before_train=1.323338 cos_to_last_merge=0.8841 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.884
[S8] round=8 local utility u=0.000000 metrics={'f1_val': 0.9476061334942893, 'auprc': 0.9951443830925978, 'loss_val': 0.15332228995767516, 'psi': 0.9666214333336127}-{'f1_val': 0.9950223643478788, 'auprc': 0.9981011710598162, 'loss_val': 0.15846281744534946, 'psi': 0.9962538870326538}
[S9] START round=8 head_norm_before_train=0.923340 cos_to_last_merge=1.0000 (last merge round=7)
[S9] round=8 local utility u=0.289553 metrics={'f1_val': 0.7016148490515617, 'auprc': 0.9995664650646399, 'loss_val': 0.6993282933611947, 'psi': 0.820795495456793}-{'f1_val': 0.6759385232691169, 'auprc': 0.8986002456317701, 'loss_val': 0.8214773263043567, 'psi': 0.7650032122141781}
[S10] START round=8 head_norm_before_train=1.330920 cos_to_last_merge=0.9808 (last merge round=5)
[S10] round=8 local utility u=0.044398 metrics={'f1_val': 0.6876309051880161, 'auprc': 0.9443349613328099, 'loss_val': 0.28766409923271197, 'psi': 0.7903125276459336}-{'f1_val': 0.6884085598604146, 'auprc': 0.9427254539271267, 'loss_val': 0.37629742037151587, 'psi': 0.7901353174870995}
[S11] START round=8 head_norm_before_train=1.386840 (no previous merge yet)
[S11] round=8 local utility u=0.000000 metrics={'f1_val': 0.39992541946910537, 'auprc': 0.9766049209734652, 'loss_val': 0.6906635134134806, 'psi': 0.6305972200708493}-{'f1_val': 0.3998848669786352, 'auprc': 0.99457585580289, 'loss_val': 0.7299013225919546, 'psi': 0.6377612625083371}
[S13] START round=8 head_norm_before_train=1.548408 (no previous merge yet)
[S13] round=8 local utility u=0.000000 metrics={'f1_val': 0.6009685618768849, 'auprc': 0.6735243353825934, 'loss_val': 0.6382996932983455, 'psi': 0.6299908712791682}-{'f1_val': 0.6328049402644566, 'auprc': 0.6811942543729474, 'loss_val': 0.5307359433294839, 'psi': 0.6521606659078529}
[S14] START round=8 head_norm_before_train=1.371256 (no previous merge yet)
[S14] round=8 local utility u=1.000000 metrics={'f1_val': 0.7018019035365319, 'auprc': 0.9935893119418072, 'loss_val': 0.6279688931180439, 'psi': 0.818516866898642}-{'f1_val': 0.2820423653155787, 'auprc': 0.9175046496185749, 'loss_val': 0.8633212584566387, 'psi': 0.5362272790367772}
[S15] START round=8 head_norm_before_train=0.778054 cos_to_last_merge=1.0000 (last merge round=7)
[S15] round=8 local utility u=0.224677 metrics={'f1_val': 0.6954048367789638, 'auprc': 0.9323332880026545, 'loss_val': 0.5129715462508962, 'psi': 0.7901762172684401}-{'f1_val': 0.6992440016150824, 'auprc': 0.8104605052439809, 'loss_val': 0.6197428480978666, 'psi': 0.7437306030666418}
[S16] START round=8 head_norm_before_train=1.368003 (no previous merge yet)
[S16] round=8 local utility u=0.000000 metrics={'f1_val': 0.3500764307867914, 'auprc': 0.7275610432759142, 'loss_val': 1.0003087024622674, 'psi': 0.5010702757824406}-{'f1_val': 0.41731184350684625, 'auprc': 0.7388824543620569, 'loss_val': 0.9307550733599088, 'psi': 0.5459400878489304}
[S17] START round=8 head_norm_before_train=1.232353 cos_to_last_merge=0.8888 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.889
[S17] round=8 local utility u=0.873653 metrics={'f1_val': 0.5443471924843991, 'auprc': 0.8530271043029061, 'loss_val': 0.5867103380176966, 'psi': 0.667819157211802}-{'f1_val': 0.3583219334245326, 'auprc': 0.712057640474963, 'loss_val': 0.7949559061346609, 'psi': 0.49981621624470474}
[S7] not sending this round → trigger blocked (psi=0.492)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] → sending delta(kind=head bytes=1793) to S10@127.0.0.1:39411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:39415
[S9] not sending this round → trigger blocked (psi=0.821)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.743)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:39408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:39411
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.740)
[S4] not sending this round → trigger blocked (psi=0.763)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.819)
[S10] sending update (kind=head size=1804 to 1 peers)
[S3] sending update (kind=head size=1794 to 1 peers)
[S2] sending update (kind=head size=1793 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1794) from S3
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.119950)
[S15] loaded HEAD from S3 (vec_in norm=1.119950)
[S15] cosine check vs S3: cos=0.2981
[S15] BUFFERED delta from S3 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1804) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.402428)
[S7] loaded HEAD from S10 (vec_in norm=1.402428)
[S7] cosine check vs S10: cos=0.2304
[S7] BUFFERED delta from S10 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1796) from S15
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.880594)
[S10] loaded HEAD from S15 (vec_in norm=0.880594)
[S10] cosine check vs S15: cos=0.0135
[S10] BUFFERED delta from S15 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1793) from S2
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.703626)
[S10] loaded HEAD from S2 (vec_in norm=1.703626)
[S10] cosine check vs S2: cos=0.8528
[S10] BUFFERED delta from S2 (total buffered=2)
[S17] not sending this round → trigger blocked (psi=0.668)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=8 metric=0.4171 head_norm=0.991480
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.597654e-01
[S7] stored merged vector for next round verification (round=8)
[S7] DEBUG after merge:  round=8 metric=0.4171 head_norm=0.947457 delta_norm=0.759765
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=8 metric=0.6954 head_norm=0.880594
[S15] _apply_head_vector_avg (torch): Δ‖w‖=6.003487e-01
[S15] stored merged vector for next round verification (round=8)
[S15] DEBUG after merge:  round=8 metric=0.6937 head_norm=0.808980 delta_norm=0.600349
[S15] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=8 metric=0.6876 head_norm=1.402428
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.621038e-01
[S10] stored merged vector for next round verification (round=8)
[S10] DEBUG after merge:  round=8 metric=0.6877 head_norm=1.113835 delta_norm=0.462104
[S10] aggregate: ACCEPT kept=['S15', 'S2'] (k=2/2) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.703626 (no previous merge yet)
[S2] round=9 local utility u=0.000000 metrics={'f1_val': 0.6934536261420056, 'auprc': 0.6774615544746088, 'loss_val': 0.3315490457689349, 'psi': 0.6870567974750468}-{'f1_val': 0.7015710590385817, 'auprc': 0.6770850731955855, 'loss_val': 0.28681888984293485, 'psi': 0.6917766647013832}
[S3] START round=9 head_norm_before_train=1.119950 cos_to_last_merge=0.9963 (last merge round=7)
[S3] round=9 local utility u=0.638635 metrics={'f1_val': 0.5820558957210374, 'auprc': 0.9924862288375976, 'loss_val': 0.8689184189589891, 'psi': 0.7462280289676615}-{'f1_val': 0.396483704974271, 'auprc': 0.9705678006153527, 'loss_val': 0.9670009343908876, 'psi': 0.6261173432307037}
[S4] START round=9 head_norm_before_train=1.367046 cos_to_last_merge=0.8835 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.884
[S4] round=9 local utility u=0.966290 metrics={'f1_val': 0.9446924802359463, 'auprc': 0.9431313022600701, 'loss_val': 0.453031380973994, 'psi': 0.9440680090455958}-{'f1_val': 0.6498193061317994, 'auprc': 0.9324988860151637, 'loss_val': 0.5844751997597363, 'psi': 0.7628911380851451}
[S5] START round=9 head_norm_before_train=1.075092 cos_to_last_merge=0.9372 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.937
[S5] round=9 local utility u=0.000000 metrics={'f1_val': 0.4048147062287474, 'auprc': 0.6723802101480645, 'loss_val': 0.7798331957143266, 'psi': 0.5118409077964743}-{'f1_val': 0.714571317832885, 'auprc': 0.7774849339398527, 'loss_val': 0.842563768514915, 'psi': 0.739736764275672}
[S6] START round=9 head_norm_before_train=0.983285 cos_to_last_merge=0.9926 (last merge round=7)
[S6] round=9 local utility u=0.267566 metrics={'f1_val': 0.6957179270733, 'auprc': 0.9521623839651643, 'loss_val': 0.42848610172929075, 'psi': 0.7982957098300458}-{'f1_val': 0.7073348755151215, 'auprc': 0.7965108328033687, 'loss_val': 0.5663647800754945, 'psi': 0.7430052584304204}
[S7] START round=9 head_norm_before_train=0.947457 cos_to_last_merge=1.0000 (last merge round=8)
[S7] round=9 local utility u=0.048427 metrics={'f1_val': 0.41683246609844005, 'auprc': 0.6147588355691102, 'loss_val': 1.0114307123542405, 'psi': 0.4960030138867081}-{'f1_val': 0.4170778520170104, 'auprc': 0.603728899086898, 'loss_val': 1.0766674204980198, 'psi': 0.49173827084496546}
[S8] START round=9 head_norm_before_train=1.379891 cos_to_last_merge=0.8713 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.871
[S8] round=9 local utility u=0.157929 metrics={'f1_val': 0.9937111453033, 'auprc': 0.9922185271596187, 'loss_val': 0.10531737017438857, 'psi': 0.9931140980458274}-{'f1_val': 0.9476061334942893, 'auprc': 0.9951443830925978, 'loss_val': 0.15332228995767516, 'psi': 0.9666214333336127}
[S9] START round=9 head_norm_before_train=0.966990 cos_to_last_merge=0.9950 (last merge round=7)
[S9] round=9 local utility u=0.104760 metrics={'f1_val': 0.7016148490515617, 'auprc': 0.9990873924235861, 'loss_val': 0.488370405003453, 'psi': 0.8206038664003714}-{'f1_val': 0.7016148490515617, 'auprc': 0.9995664650646399, 'loss_val': 0.6993282933611947, 'psi': 0.820795495456793}
[S10] START round=9 head_norm_before_train=1.113835 cos_to_last_merge=1.0000 (last merge round=8)
[S10] round=9 local utility u=0.944515 metrics={'f1_val': 0.9800231280945144, 'auprc': 0.9970145019751395, 'loss_val': 0.31102589727669366, 'psi': 0.9868196776467644}-{'f1_val': 0.6876309051880161, 'auprc': 0.9443349613328099, 'loss_val': 0.28766409923271197, 'psi': 0.7903125276459336}
[S11] START round=9 head_norm_before_train=1.429480 (no previous merge yet)
[S11] round=9 local utility u=0.072049 metrics={'f1_val': 0.4005844218082196, 'auprc': 0.9989726733089395, 'loss_val': 0.617622611648626, 'psi': 0.6399397224085075}-{'f1_val': 0.39992541946910537, 'auprc': 0.9766049209734652, 'loss_val': 0.6906635134134806, 'psi': 0.6305972200708493}
[S13] START round=9 head_norm_before_train=1.578700 (no previous merge yet)
[S13] round=9 local utility u=0.000000 metrics={'f1_val': 0.5938210524100647, 'auprc': 0.6743524004154523, 'loss_val': 0.7061085807702059, 'psi': 0.6260335916122197}-{'f1_val': 0.6009685618768849, 'auprc': 0.6735243353825934, 'loss_val': 0.6382996932983455, 'psi': 0.6299908712791682}
[S14] START round=9 head_norm_before_train=1.430062 (no previous merge yet)
[S14] round=9 local utility u=0.882344 metrics={'f1_val': 0.9683618945668641, 'auprc': 0.9935225163874175, 'loss_val': 0.462439801678582, 'psi': 0.9784261432950855}-{'f1_val': 0.7018019035365319, 'auprc': 0.9935893119418072, 'loss_val': 0.6279688931180439, 'psi': 0.818516866898642}
[S15] START round=9 head_norm_before_train=0.808980 cos_to_last_merge=1.0000 (last merge round=8)
[S15] round=9 local utility u=0.082783 metrics={'f1_val': 0.6961049506723274, 'auprc': 0.9852945512110021, 'loss_val': 0.5104893830780811, 'psi': 0.8117807908877972}-{'f1_val': 0.6954048367789638, 'auprc': 0.9323332880026545, 'loss_val': 0.5129715462508962, 'psi': 0.7901762172684401}
[S16] START round=9 head_norm_before_train=1.414735 (no previous merge yet)
[S16] round=9 local utility u=0.027484 metrics={'f1_val': 0.3512857336393125, 'auprc': 0.7292697478182234, 'loss_val': 0.9577217811170012, 'psi': 0.5024793393108768}-{'f1_val': 0.3500764307867914, 'auprc': 0.7275610432759142, 'loss_val': 1.0003087024622674, 'psi': 0.5010702757824406}
[S17] START round=9 head_norm_before_train=1.275459 cos_to_last_merge=0.8764 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.876
[S17] round=9 local utility u=0.320159 metrics={'f1_val': 0.582870525768036, 'auprc': 0.9734605207657203, 'loss_val': 0.5388329191870811, 'psi': 0.7391065237671097}-{'f1_val': 0.5443471924843991, 'auprc': 0.8530271043029061, 'loss_val': 0.5867103380176966, 'psi': 0.667819157211802}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S7] → sending delta(kind=head bytes=1791) to S15@127.0.0.1:39415
[S15] not sending this round → trigger blocked (psi=0.812)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:39403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:39402
[S10] not sending this round → trigger blocked (psi=0.987)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:39408
[S3] not sending this round → trigger blocked (psi=0.746)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:39409
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:39407
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:39403
[S16] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1791 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1791) from S7
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.969729)
[S15] loaded HEAD from S7 (vec_in norm=0.969729)
[S15] cosine check vs S7: cos=0.0657
[S15] BUFFERED delta from S7 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1796) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.025303)
[S3] loaded HEAD from S9 (vec_in norm=1.025303)
[S3] cosine check vs S9: cos=-0.0352
[S3] DROPPED delta from S9 (cos=-0.0352 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1797) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.424635)
[S3] loaded HEAD from S8 (vec_in norm=1.424635)
[S3] cosine check vs S8: cos=0.9283
[S3] BUFFERED delta from S8 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1796) from S6
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.047415)
[S8] loaded HEAD from S6 (vec_in norm=1.047415)
[S8] cosine check vs S6: cos=-0.0730
[S8] DROPPED delta from S6 (cos=-0.0730 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1804) from S11
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.472039)
[S7] loaded HEAD from S11 (vec_in norm=1.472039)
[S7] cosine check vs S11: cos=0.5210
[S7] BUFFERED delta from S11 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1802) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.459131)
[S6] loaded HEAD from S16 (vec_in norm=1.459131)
[S6] cosine check vs S16: cos=0.7252
[S6] BUFFERED delta from S16 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1803) from S14
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.493787)
[S6] loaded HEAD from S14 (vec_in norm=1.493787)
[S6] cosine check vs S14: cos=0.5196
[S6] BUFFERED delta from S14 (total buffered=2)
[S2] RECEIVED delta(kind=head bytes=1802) from S4
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.431849)
[S2] loaded HEAD from S4 (vec_in norm=1.431849)
[S2] cosine check vs S4: cos=-0.0549
[S2] DROPPED delta from S4 (cos=-0.0549 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:39409
[S17] sending update (kind=head size=1798 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.322367)
[S8] loaded HEAD from S17 (vec_in norm=1.322367)
[S8] cosine check vs S17: cos=-0.0274
[S8] DROPPED delta from S17 (cos=-0.0274 < 0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=9 metric=0.5821 head_norm=1.161145
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.769056e-01
[S3] stored merged vector for next round verification (round=9)
[S3] DEBUG after merge:  round=9 metric=0.6229 head_norm=1.269742 delta_norm=0.276906
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=9 metric=0.4168 head_norm=0.969729
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.363617e-01
[S7] stored merged vector for next round verification (round=9)
[S7] DEBUG after merge:  round=9 metric=0.4168 head_norm=1.071765 delta_norm=0.636362
[S7] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=9 metric=0.6957 head_norm=1.047415
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.743679e-01
[S6] stored merged vector for next round verification (round=9)
[S6] DEBUG after merge:  round=9 metric=0.9600 head_norm=1.017800 delta_norm=0.274368
[S6] aggregate: ACCEPT kept=['S16', 'S14'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=9 metric=0.6961 head_norm=0.890551
[S15] _apply_head_vector_avg (torch): Δ‖w‖=6.363965e-01
[S15] stored merged vector for next round verification (round=9)
[S15] DEBUG after merge:  round=9 metric=0.6951 head_norm=0.679505 delta_norm=0.636397
[S15] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.738067 (no previous merge yet)
[S2] round=10 local utility u=0.039085 metrics={'f1_val': 0.7015710590385817, 'auprc': 0.6857745491289691, 'loss_val': 0.3270218510297247, 'psi': 0.6952524550747367}-{'f1_val': 0.6934536261420056, 'auprc': 0.6774615544746088, 'loss_val': 0.3315490457689349, 'psi': 0.6870567974750468}
[S3] START round=10 head_norm_before_train=1.269742 cos_to_last_merge=1.0000 (last merge round=9)
[S3] round=10 local utility u=0.000000 metrics={'f1_val': 0.4079710948137161, 'auprc': 0.7578385512074778, 'loss_val': 0.8794465363960182, 'psi': 0.5479180773712208}-{'f1_val': 0.5820558957210374, 'auprc': 0.9924862288375976, 'loss_val': 0.8689184189589891, 'psi': 0.7462280289676615}
[S4] START round=10 head_norm_before_train=1.431849 cos_to_last_merge=0.8713 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.871
[S4] round=10 local utility u=0.000000 metrics={'f1_val': 0.9407740006675568, 'auprc': 0.9292877269165362, 'loss_val': 0.4135607307496769, 'psi': 0.9361794911671485}-{'f1_val': 0.9446924802359463, 'auprc': 0.9431313022600701, 'loss_val': 0.453031380973994, 'psi': 0.9440680090455958}
[S5] START round=10 head_norm_before_train=1.108538 cos_to_last_merge=0.9239 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.924
[S5] round=10 local utility u=1.000000 metrics={'f1_val': 0.7148267802347954, 'auprc': 0.7776867476181313, 'loss_val': 0.6827958529869415, 'psi': 0.7399707671881297}-{'f1_val': 0.4048147062287474, 'auprc': 0.6723802101480645, 'loss_val': 0.7798331957143266, 'psi': 0.5118409077964743}
[S6] START round=10 head_norm_before_train=1.017800 cos_to_last_merge=1.0000 (last merge round=9)
[S6] round=10 local utility u=0.058646 metrics={'f1_val': 0.7061782074859648, 'auprc': 0.9675149981508128, 'loss_val': 0.42001274770822455, 'psi': 0.810712923751904}-{'f1_val': 0.6957179270733, 'auprc': 0.9521623839651643, 'loss_val': 0.42848610172929075, 'psi': 0.7982957098300458}
[S7] START round=10 head_norm_before_train=1.071765 cos_to_last_merge=1.0000 (last merge round=9)
[S7] round=10 local utility u=0.236406 metrics={'f1_val': 0.41683246609844005, 'auprc': 0.7562970074071135, 'loss_val': 0.963233534346256, 'psi': 0.5526182826219095}-{'f1_val': 0.41683246609844005, 'auprc': 0.6147588355691102, 'loss_val': 1.0114307123542405, 'psi': 0.4960030138867081}
[S8] START round=10 head_norm_before_train=1.424635 cos_to_last_merge=0.8616 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.862
[S8] round=10 local utility u=0.020406 metrics={'f1_val': 0.9928938724649488, 'auprc': 0.9979267795623485, 'loss_val': 0.07672718270977415, 'psi': 0.9949070353039087}-{'f1_val': 0.9937111453033, 'auprc': 0.9922185271596187, 'loss_val': 0.10531737017438857, 'psi': 0.9931140980458274}
[S9] START round=10 head_norm_before_train=1.025303 cos_to_last_merge=0.9813 (last merge round=7)
[S9] round=10 local utility u=0.054722 metrics={'f1_val': 0.7015406642019387, 'auprc': 0.9989044482601424, 'loss_val': 0.3779315281474139, 'psi': 0.8204861778252202}-{'f1_val': 0.7016148490515617, 'auprc': 0.9990873924235861, 'loss_val': 0.488370405003453, 'psi': 0.8206038664003714}
[S10] START round=10 head_norm_before_train=1.172147 cos_to_last_merge=0.9979 (last merge round=8)
[S10] round=10 local utility u=0.028991 metrics={'f1_val': 0.9796667332281475, 'auprc': 0.9923317242454894, 'loss_val': 0.23685697499288294, 'psi': 0.9847327296350843}-{'f1_val': 0.9800231280945144, 'auprc': 0.9970145019751395, 'loss_val': 0.31102589727669366, 'psi': 0.9868196776467644}
[S11] START round=10 head_norm_before_train=1.472039 (no previous merge yet)
[S11] round=10 local utility u=0.008804 metrics={'f1_val': 0.39992541946910537, 'auprc': 0.9990603572411181, 'loss_val': 0.5963236266172444, 'psi': 0.6395793945779105}-{'f1_val': 0.4005844218082196, 'auprc': 0.9989726733089395, 'loss_val': 0.617622611648626, 'psi': 0.6399397224085075}
[S13] START round=10 head_norm_before_train=1.611161 (no previous merge yet)
[S13] round=10 local utility u=0.000000 metrics={'f1_val': 0.5744284983959098, 'auprc': 0.6862215764597064, 'loss_val': 0.8431027367630418, 'psi': 0.6191457296214284}-{'f1_val': 0.5938210524100647, 'auprc': 0.6743524004154523, 'loss_val': 0.7061085807702059, 'psi': 0.6260335916122197}
[S14] START round=10 head_norm_before_train=1.493787 (no previous merge yet)
[S14] round=10 local utility u=0.000000 metrics={'f1_val': 0.6205637456666455, 'auprc': 0.9649113620101712, 'loss_val': 0.45884855009588676, 'psi': 0.7583027922040557}-{'f1_val': 0.9683618945668641, 'auprc': 0.9935225163874175, 'loss_val': 0.462439801678582, 'psi': 0.9784261432950855}
[S15] START round=10 head_norm_before_train=0.679505 cos_to_last_merge=1.0000 (last merge round=9)
[S15] round=10 local utility u=0.000000 metrics={'f1_val': 0.696207818598054, 'auprc': 0.942149703231452, 'loss_val': 0.5712842877876185, 'psi': 0.7945845724514132}-{'f1_val': 0.6961049506723274, 'auprc': 0.9852945512110021, 'loss_val': 0.5104893830780811, 'psi': 0.8117807908877972}
[S16] START round=10 head_norm_before_train=1.459131 (no previous merge yet)
[S16] round=10 local utility u=0.137818 metrics={'f1_val': 0.3914790231694507, 'auprc': 0.7286972530510242, 'loss_val': 0.9215281949469425, 'psi': 0.5263663151220801}-{'f1_val': 0.3512857336393125, 'auprc': 0.7292697478182234, 'loss_val': 0.9577217811170012, 'psi': 0.5024793393108768}
[S17] START round=10 head_norm_before_train=1.322367 cos_to_last_merge=0.8669 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.867
[S17] round=10 local utility u=0.000000 metrics={'f1_val': 0.5772831043030072, 'auprc': 0.8503612199514773, 'loss_val': 0.5552394393260814, 'psi': 0.6865143505623952}-{'f1_val': 0.582870525768036, 'auprc': 0.9734605207657203, 'loss_val': 0.5388329191870811, 'psi': 0.7391065237671097}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:39403
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:39410
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:39411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:39408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:39403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:39408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:39409
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1793 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1799) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.232864)
[S7] loaded HEAD from S10 (vec_in norm=1.232864)
[S7] cosine check vs S10: cos=0.4555
[S7] BUFFERED delta from S10 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1802) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.500811)
[S6] loaded HEAD from S16 (vec_in norm=1.500811)
[S6] cosine check vs S16: cos=0.7339
[S6] BUFFERED delta from S16 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1793) from S7
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.094890)
[S15] loaded HEAD from S7 (vec_in norm=1.094890)
[S15] cosine check vs S7: cos=0.5870
[S15] BUFFERED delta from S7 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1799) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.473815)
[S3] loaded HEAD from S8 (vec_in norm=1.473815)
[S3] cosine check vs S8: cos=0.9702
[S3] BUFFERED delta from S8 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1796) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.088895)
[S3] loaded HEAD from S9 (vec_in norm=1.088895)
[S3] cosine check vs S9: cos=-0.0323
[S3] DROPPED delta from S9 (cos=-0.0323 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1798) from S11
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.511731)
[S7] loaded HEAD from S11 (vec_in norm=1.511731)
[S7] cosine check vs S11: cos=0.9082
[S7] BUFFERED delta from S11 (total buffered=2)
[S10] RECEIVED delta(kind=head bytes=1802) from S2
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.766395)
[S10] loaded HEAD from S2 (vec_in norm=1.766395)
[S10] cosine check vs S2: cos=0.8981
[S10] BUFFERED delta from S2 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1794) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.140294)
[S9] loaded HEAD from S5 (vec_in norm=1.140294)
[S9] cosine check vs S5: cos=0.8660
[S9] BUFFERED delta from S5 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1799) from S6
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.071153)
[S8] loaded HEAD from S6 (vec_in norm=1.071153)
[S8] cosine check vs S6: cos=-0.0717
[S8] DROPPED delta from S6 (cos=-0.0717 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] ⇄ pheromone p=0.220 → S15@127.0.0.1:39415
[S4] ⇄ pheromone p=0.459 → S2@127.0.0.1:39402
[S14] ⇄ pheromone p=0.465 → S6@127.0.0.1:39407
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=10 metric=0.4080 head_norm=1.307484
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.888566e-01
[S3] stored merged vector for next round verification (round=10)
[S3] DEBUG after merge:  round=10 metric=0.4239 head_norm=1.380274 delta_norm=0.188857
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.367 → S15@127.0.0.1:39415
[S2] ⇄ pheromone p=0.275 → S10@127.0.0.1:39411
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=10 metric=0.7062 head_norm=1.071153
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.099193e-01
[S6] stored merged vector for next round verification (round=10)
[S6] DEBUG after merge:  round=10 metric=0.9540 head_norm=1.199952 delta_norm=0.509919
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.349 → S8@127.0.0.1:39409
[S5] ⇄ pheromone p=0.510 → S9@127.0.0.1:39410
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=10 metric=0.4168 head_norm=1.094890
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.760849e-01
[S7] stored merged vector for next round verification (round=10)
[S7] DEBUG after merge:  round=10 metric=0.4168 head_norm=1.044055 delta_norm=0.176085
[S7] aggregate: ACCEPT kept=['S10', 'S11'] (k=2/2) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.304 → S15@127.0.0.1:39415
[S11] ⇄ pheromone p=0.225 → S7@127.0.0.1:39408
[S8] ⇄ pheromone p=0.332 → S3@127.0.0.1:39403
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=10 metric=0.7015 head_norm=1.088895
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.896093e-01
[S9] stored merged vector for next round verification (round=10)
[S9] DEBUG after merge:  round=10 metric=0.7015 head_norm=1.076619 delta_norm=0.289609
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.293 → S3@127.0.0.1:39403
[S16] ⇄ pheromone p=0.212 → S6@127.0.0.1:39407
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=10 metric=0.9797 head_norm=1.232864
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.267326e-01
[S10] stored merged vector for next round verification (round=10)
[S10] DEBUG after merge:  round=10 metric=0.9803 head_norm=1.462173 delta_norm=0.426733
[S10] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.440 → S7@127.0.0.1:39408
[S17] ⇄ pheromone p=0.338 → S8@127.0.0.1:39409
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=10 metric=0.6962 head_norm=0.772204
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.479015e-01
[S15] stored merged vector for next round verification (round=10)
[S15] DEBUG after merge:  round=10 metric=0.6945 head_norm=0.834821 delta_norm=0.447902
[S15] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.265 → S10@127.0.0.1:39411
[S2] START round=11 head_norm_before_train=1.766395 (no previous merge yet)
[S2] round=11 local utility u=0.003795 metrics={'f1_val': 0.7070783140923017, 'auprc': 0.682206884500905, 'loss_val': 0.34177200530209945, 'psi': 0.697129742255743}-{'f1_val': 0.7015710590385817, 'auprc': 0.6857745491289691, 'loss_val': 0.3270218510297247, 'psi': 0.6952524550747367}
[S3] START round=11 head_norm_before_train=1.380274 cos_to_last_merge=1.0000 (last merge round=10)
[S3] round=11 local utility u=1.000000 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.9938549049100776, 'loss_val': 0.6161553431076735, 'psi': 0.8180410029793175}-{'f1_val': 0.4079710948137161, 'auprc': 0.7578385512074778, 'loss_val': 0.8794465363960182, 'psi': 0.5479180773712208}
[S4] START round=11 head_norm_before_train=1.488738 cos_to_last_merge=0.8621 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.862
[S4] round=11 local utility u=0.039300 metrics={'f1_val': 0.9401142464663025, 'auprc': 0.9346441840751544, 'loss_val': 0.34707094033169783, 'psi': 0.9379262215098432}-{'f1_val': 0.9407740006675568, 'auprc': 0.9292877269165362, 'loss_val': 0.4135607307496769, 'psi': 0.9361794911671485}
[S5] START round=11 head_norm_before_train=1.140294 cos_to_last_merge=0.9117 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.912
[S5] round=11 local utility u=0.084173 metrics={'f1_val': 0.7010644289311239, 'auprc': 0.8414387882460898, 'loss_val': 0.6231326072625691, 'psi': 0.7572141726571102}-{'f1_val': 0.7148267802347954, 'auprc': 0.7776867476181313, 'loss_val': 0.6827958529869415, 'psi': 0.7399707671881297}
[S6] START round=11 head_norm_before_train=1.199952 cos_to_last_merge=1.0000 (last merge round=10)
[S6] round=11 local utility u=0.756921 metrics={'f1_val': 0.9597725357730009, 'auprc': 0.9542428660740839, 'loss_val': 0.3879203560627995, 'psi': 0.9575606678934341}-{'f1_val': 0.7061782074859648, 'auprc': 0.9675149981508128, 'loss_val': 0.42001274770822455, 'psi': 0.810712923751904}
[S7] START round=11 head_norm_before_train=1.044055 cos_to_last_merge=1.0000 (last merge round=10)
[S7] round=11 local utility u=0.046804 metrics={'f1_val': 0.41683246609844005, 'auprc': 0.7733194839132076, 'loss_val': 0.9206921173386808, 'psi': 0.559427273224347}-{'f1_val': 0.41683246609844005, 'auprc': 0.7562970074071135, 'loss_val': 0.963233534346256, 'psi': 0.5526182826219095}
[S8] START round=11 head_norm_before_train=1.473815 cos_to_last_merge=0.8523 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.852
[S8] round=11 local utility u=0.000085 metrics={'f1_val': 0.9937260093124592, 'auprc': 0.9926067714781494, 'loss_val': 0.0655890535361543, 'psi': 0.9932783141787354}-{'f1_val': 0.9928938724649488, 'auprc': 0.9979267795623485, 'loss_val': 0.07672718270977415, 'psi': 0.9949070353039087}
[S9] START round=11 head_norm_before_train=1.076619 cos_to_last_merge=1.0000 (last merge round=10)
[S9] round=11 local utility u=0.003048 metrics={'f1_val': 0.7015406642019387, 'auprc': 0.9984172533625741, 'loss_val': 0.37037403318997225, 'psi': 0.8202912998661929}-{'f1_val': 0.7015406642019387, 'auprc': 0.9989044482601424, 'loss_val': 0.3779315281474139, 'psi': 0.8204861778252202}
[S10] START round=11 head_norm_before_train=1.462173 cos_to_last_merge=1.0000 (last merge round=10)
[S10] round=11 local utility u=0.077024 metrics={'f1_val': 0.991981023185222, 'auprc': 0.9975870722922295, 'loss_val': 0.1724600253027906, 'psi': 0.994223442828025}-{'f1_val': 0.9796667332281475, 'auprc': 0.9923317242454894, 'loss_val': 0.23685697499288294, 'psi': 0.9847327296350843}
[S11] START round=11 head_norm_before_train=1.511731 (no previous merge yet)
[S11] round=11 local utility u=1.000000 metrics={'f1_val': 0.9569352178492031, 'auprc': 0.9991425613120182, 'loss_val': 0.4052621245585188, 'psi': 0.973818155234329}-{'f1_val': 0.39992541946910537, 'auprc': 0.9990603572411181, 'loss_val': 0.5963236266172444, 'psi': 0.6395793945779105}
[S13] START round=11 head_norm_before_train=1.640469 (no previous merge yet)
[S13] round=11 local utility u=0.001666 metrics={'f1_val': 0.5787554238811746, 'auprc': 0.6854002595251308, 'loss_val': 0.8632679928991067, 'psi': 0.6214133581387571}-{'f1_val': 0.5744284983959098, 'auprc': 0.6862215764597064, 'loss_val': 0.8431027367630418, 'psi': 0.6191457296214284}
[S14] START round=11 head_norm_before_train=1.550480 (no previous merge yet)
[S14] round=11 local utility u=0.055289 metrics={'f1_val': 0.6203213413581947, 'auprc': 0.9939540327150418, 'loss_val': 0.4339432882654021, 'psi': 0.7697744179009336}-{'f1_val': 0.6205637456666455, 'auprc': 0.9649113620101712, 'loss_val': 0.45884855009588676, 'psi': 0.7583027922040557}
[S15] START round=11 head_norm_before_train=0.834821 cos_to_last_merge=1.0000 (last merge round=10)
[S15] round=11 local utility u=0.055527 metrics={'f1_val': 0.6943548334315073, 'auprc': 0.9709129314355893, 'loss_val': 0.5354015963097619, 'psi': 0.8049780726331401}-{'f1_val': 0.696207818598054, 'auprc': 0.942149703231452, 'loss_val': 0.5712842877876185, 'psi': 0.7945845724514132}
[S16] START round=11 head_norm_before_train=1.500811 (no previous merge yet)
[S16] round=11 local utility u=0.466276 metrics={'f1_val': 0.5413907357049923, 'auprc': 0.744927589658002, 'loss_val': 0.9371367623965813, 'psi': 0.6228054772861962}-{'f1_val': 0.3914790231694507, 'auprc': 0.7286972530510242, 'loss_val': 0.9215281949469425, 'psi': 0.5263663151220801}
[S17] START round=11 head_norm_before_train=1.374726 cos_to_last_merge=0.8551 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.855
[S17] round=11 local utility u=0.246260 metrics={'f1_val': 0.6371900648790794, 'auprc': 0.9037812831698877, 'loss_val': 0.5824212718145584, 'psi': 0.7438265521954026}-{'f1_val': 0.5772831043030072, 'auprc': 0.8503612199514773, 'loss_val': 0.5552394393260814, 'psi': 0.6865143505623952}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:39402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:39403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:39410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:39408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:39409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:39403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:39408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:39411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S10@127.0.0.1:39411
[S5] sending update (kind=head size=1795 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1793 to 1 peers)
[S16] sending update (kind=head size=1793 to 1 peers)
[S7] sending update (kind=head size=1793 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1796) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.516270)
[S3] loaded HEAD from S8 (vec_in norm=1.516270)
[S3] cosine check vs S8: cos=0.9838
[S3] BUFFERED delta from S8 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1802) from S14
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.599024)
[S6] loaded HEAD from S14 (vec_in norm=1.599024)
[S6] cosine check vs S14: cos=0.2884
[S6] BUFFERED delta from S14 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1796) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.126758)
[S3] loaded HEAD from S9 (vec_in norm=1.126758)
[S3] cosine check vs S9: cos=-0.0632
[S3] DROPPED delta from S9 (cos=-0.0632 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1800) from S4
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.529507)
[S2] loaded HEAD from S4 (vec_in norm=1.529507)
[S2] cosine check vs S4: cos=-0.0509
[S2] DROPPED delta from S4 (cos=-0.0509 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1802) from S11
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.551805)
[S7] loaded HEAD from S11 (vec_in norm=1.551805)
[S7] cosine check vs S11: cos=0.8536
[S7] BUFFERED delta from S11 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1799) from S6
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.250097)
[S8] loaded HEAD from S6 (vec_in norm=1.250097)
[S8] cosine check vs S6: cos=-0.0692
[S8] DROPPED delta from S6 (cos=-0.0692 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1793) from S15
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.912480)
[S10] loaded HEAD from S15 (vec_in norm=0.912480)
[S10] cosine check vs S15: cos=0.4718
[S10] BUFFERED delta from S15 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1795) from S2
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.788833)
[S10] loaded HEAD from S2 (vec_in norm=1.788833)
[S10] cosine check vs S2: cos=0.9756
[S10] BUFFERED delta from S2 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1804) from S3
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.417799)
[S15] loaded HEAD from S3 (vec_in norm=1.417799)
[S15] cosine check vs S3: cos=0.2436
[S15] BUFFERED delta from S3 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1793) from S7
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.071393)
[S15] loaded HEAD from S7 (vec_in norm=1.071393)
[S15] cosine check vs S7: cos=0.8779
[S15] BUFFERED delta from S7 (total buffered=2)
[S7] RECEIVED delta(kind=head bytes=1798) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.513926)
[S7] loaded HEAD from S10 (vec_in norm=1.513926)
[S7] cosine check vs S10: cos=0.5426
[S7] BUFFERED delta from S10 (total buffered=2)
[S6] RECEIVED delta(kind=head bytes=1793) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.538186)
[S6] loaded HEAD from S16 (vec_in norm=1.538186)
[S6] cosine check vs S16: cos=0.9403
[S6] BUFFERED delta from S16 (total buffered=2)
[S9] RECEIVED delta(kind=head bytes=1795) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.170788)
[S9] loaded HEAD from S5 (vec_in norm=1.170788)
[S9] cosine check vs S5: cos=0.9477
[S9] BUFFERED delta from S5 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1798) from S13
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.668117)
[S15] loaded HEAD from S13 (vec_in norm=1.668117)
[S15] cosine check vs S13: cos=0.2141
[S15] BUFFERED delta from S13 (total buffered=3)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:39409
[S17] sending update (kind=head size=1802 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1802) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.435002)
[S8] loaded HEAD from S17 (vec_in norm=1.435002)
[S8] cosine check vs S17: cos=-0.0268
[S8] DROPPED delta from S17 (cos=-0.0268 < 0.0)
[S15] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=11 metric=0.6944 head_norm=0.912480
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.113199e-01
[S15] stored merged vector for next round verification (round=11)
[S15] DEBUG after merge:  round=11 metric=0.6940 head_norm=0.800868 delta_norm=0.311320
[S15] aggregate: ACCEPT kept=['S3', 'S7', 'S13'] (k=3/3) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=11 metric=0.9598 head_norm=1.250097
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.305198e-01
[S6] stored merged vector for next round verification (round=11)
[S6] DEBUG after merge:  round=11 metric=0.9468 head_norm=1.140824 delta_norm=0.330520
[S6] aggregate: ROLLBACK (f1_val pre=0.960 post=0.947 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=11 metric=0.7015 head_norm=1.126758
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.870939e-01
[S9] stored merged vector for next round verification (round=11)
[S9] DEBUG after merge:  round=11 metric=0.7015 head_norm=1.133649 delta_norm=0.187094
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=11 metric=0.9920 head_norm=1.513926
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.859057e-01
[S10] stored merged vector for next round verification (round=11)
[S10] DEBUG after merge:  round=11 metric=0.9913 head_norm=1.314781 delta_norm=0.285906
[S10] aggregate: ACCEPT kept=['S15', 'S2'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=11 metric=0.4168 head_norm=1.071393
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.846796e-01
[S7] stored merged vector for next round verification (round=11)
[S7] DEBUG after merge:  round=11 metric=0.4168 head_norm=1.087998 delta_norm=0.184680
[S7] aggregate: ACCEPT kept=['S11', 'S10'] (k=2/2) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=11 metric=0.7008 head_norm=1.417799
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.407162e-01
[S3] stored merged vector for next round verification (round=11)
[S3] DEBUG after merge:  round=11 metric=0.7008 head_norm=1.461100 delta_norm=0.140716
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.788833 (no previous merge yet)
[S2] round=12 local utility u=0.048164 metrics={'f1_val': 0.7074353752970295, 'auprc': 0.7339106035956782, 'loss_val': 0.4026979339826469, 'psi': 0.7180254666164889}-{'f1_val': 0.7070783140923017, 'auprc': 0.682206884500905, 'loss_val': 0.34177200530209945, 'psi': 0.697129742255743}
[S3] START round=12 head_norm_before_train=1.461100 cos_to_last_merge=1.0000 (last merge round=11)
[S3] round=12 local utility u=0.000000 metrics={'f1_val': 0.6885440098122174, 'auprc': 0.9831751562453973, 'loss_val': 0.6488122747463634, 'psi': 0.8063964683854894}-{'f1_val': 0.7008317350254774, 'auprc': 0.9938549049100776, 'loss_val': 0.6161553431076735, 'psi': 0.8180410029793175}
[S4] START round=12 head_norm_before_train=1.529507 cos_to_last_merge=0.8569 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.857
[S4] round=12 local utility u=0.139271 metrics={'f1_val': 0.9574457479947068, 'auprc': 0.9653676954096021, 'loss_val': 0.26468866951039943, 'psi': 0.960614526960665}-{'f1_val': 0.9401142464663025, 'auprc': 0.9346441840751544, 'loss_val': 0.34707094033169783, 'psi': 0.9379262215098432}
[S5] START round=12 head_norm_before_train=1.170788 cos_to_last_merge=0.9009 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.901
[S5] round=12 local utility u=0.024664 metrics={'f1_val': 0.7149864615098203, 'auprc': 0.7954088957633505, 'loss_val': 0.5192463723733853, 'psi': 0.7471554352112324}-{'f1_val': 0.7010644289311239, 'auprc': 0.8414387882460898, 'loss_val': 0.6231326072625691, 'psi': 0.7572141726571102}
[S6] START round=12 head_norm_before_train=1.140824 cos_to_last_merge=1.0000 (last merge round=11)
[S6] round=12 local utility u=0.018476 metrics={'f1_val': 0.9588877169130392, 'auprc': 0.9626304898898344, 'loss_val': 0.3708223048212475, 'psi': 0.9603848261037573}-{'f1_val': 0.9597725357730009, 'auprc': 0.9542428660740839, 'loss_val': 0.3879203560627995, 'psi': 0.9575606678934341}
[S7] START round=12 head_norm_before_train=1.087998 cos_to_last_merge=1.0000 (last merge round=11)
[S7] round=12 local utility u=0.707945 metrics={'f1_val': 0.6518565853477496, 'auprc': 0.7727525296346757, 'loss_val': 0.9132462801074703, 'psi': 0.7002149630625201}-{'f1_val': 0.41683246609844005, 'auprc': 0.7733194839132076, 'loss_val': 0.9206921173386808, 'psi': 0.559427273224347}
[S8] START round=12 head_norm_before_train=1.516270 cos_to_last_merge=0.8455 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.846
[S8] round=12 local utility u=0.007559 metrics={'f1_val': 0.992174240363445, 'auprc': 0.9983061004274675, 'loss_val': 0.058259088564908044, 'psi': 0.9946269843890541}-{'f1_val': 0.9937260093124592, 'auprc': 0.9926067714781494, 'loss_val': 0.0655890535361543, 'psi': 0.9932783141787354}
[S9] START round=12 head_norm_before_train=1.133649 cos_to_last_merge=1.0000 (last merge round=11)
[S9] round=12 local utility u=0.005066 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9980051947794311, 'loss_val': 0.35706179268401866, 'psi': 0.8199320263757836}-{'f1_val': 0.7015406642019387, 'auprc': 0.9984172533625741, 'loss_val': 0.37037403318997225, 'psi': 0.8202912998661929}
[S10] START round=12 head_norm_before_train=1.314781 cos_to_last_merge=1.0000 (last merge round=11)
[S10] round=12 local utility u=0.000000 metrics={'f1_val': 0.9952638196745391, 'auprc': 0.9949952854040207, 'loss_val': 0.19377390084768828, 'psi': 0.9951564059663318}-{'f1_val': 0.991981023185222, 'auprc': 0.9975870722922295, 'loss_val': 0.1724600253027906, 'psi': 0.994223442828025}
[S11] START round=12 head_norm_before_train=1.551805 (no previous merge yet)
[S11] round=12 local utility u=0.058215 metrics={'f1_val': 0.9583661809174511, 'auprc': 0.9989811717465418, 'loss_val': 0.2969340578991656, 'psi': 0.9746121772490873}-{'f1_val': 0.9569352178492031, 'auprc': 0.9991425613120182, 'loss_val': 0.4052621245585188, 'psi': 0.973818155234329}
[S13] START round=12 head_norm_before_train=1.668117 (no previous merge yet)
[S13] round=12 local utility u=0.087224 metrics={'f1_val': 0.5976787762380794, 'auprc': 0.6738251513892508, 'loss_val': 0.7676344309402796, 'psi': 0.6281373262985479}-{'f1_val': 0.5787554238811746, 'auprc': 0.6854002595251308, 'loss_val': 0.8632679928991067, 'psi': 0.6214133581387571}
[S14] START round=12 head_norm_before_train=1.599024 (no previous merge yet)
[S14] round=12 local utility u=0.069134 metrics={'f1_val': 0.6246822658429712, 'auprc': 0.995707240123327, 'loss_val': 0.32710132983853224, 'psi': 0.7730922555551135}-{'f1_val': 0.6203213413581947, 'auprc': 0.9939540327150418, 'loss_val': 0.4339432882654021, 'psi': 0.7697744179009336}
[S15] START round=12 head_norm_before_train=0.800868 cos_to_last_merge=1.0000 (last merge round=11)
[S15] round=12 local utility u=0.112539 metrics={'f1_val': 0.7015435105358478, 'auprc': 0.9894941058103792, 'loss_val': 0.40919850718649065, 'psi': 0.8167237486456604}-{'f1_val': 0.6943548334315073, 'auprc': 0.9709129314355893, 'loss_val': 0.5354015963097619, 'psi': 0.8049780726331401}
[S16] START round=12 head_norm_before_train=1.538186 (no previous merge yet)
[S16] round=12 local utility u=0.000000 metrics={'f1_val': 0.4330051567051709, 'auprc': 0.7386988112015443, 'loss_val': 0.9356060933273073, 'psi': 0.5552826185037203}-{'f1_val': 0.5413907357049923, 'auprc': 0.744927589658002, 'loss_val': 0.9371367623965813, 'psi': 0.6228054772861962}
[S17] START round=12 head_norm_before_train=1.435002 cos_to_last_merge=0.8457 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.846
[S17] round=12 local utility u=0.000000 metrics={'f1_val': 0.5881102533187681, 'auprc': 0.9331110231699538, 'loss_val': 0.5642108697330062, 'psi': 0.7261105612592424}-{'f1_val': 0.6371900648790794, 'auprc': 0.9037812831698877, 'loss_val': 0.5824212718145584, 'psi': 0.7438265521954026}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:39411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:39408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:39403
[S8] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1804) from S14
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.643225)
[S6] loaded HEAD from S14 (vec_in norm=1.643225)
[S6] cosine check vs S14: cos=0.5010
[S6] BUFFERED delta from S14 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1798) from S15
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.893898)
[S10] loaded HEAD from S15 (vec_in norm=0.893898)
[S10] cosine check vs S15: cos=0.4825
[S10] BUFFERED delta from S15 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1803) from S11
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.605960)
[S7] loaded HEAD from S11 (vec_in norm=1.605960)
[S7] cosine check vs S11: cos=0.8025
[S7] BUFFERED delta from S11 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1797) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.556841)
[S3] loaded HEAD from S8 (vec_in norm=1.556841)
[S3] cosine check vs S8: cos=0.9892
[S3] BUFFERED delta from S8 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:39415
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:39411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] → sending delta(kind=head bytes=1792) to S3@127.0.0.1:39403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:39410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:39409
[S13] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1800) from S2
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.810087)
[S10] loaded HEAD from S2 (vec_in norm=1.810087)
[S10] cosine check vs S2: cos=0.9621
[S10] BUFFERED delta from S2 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1795) from S7
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.114798)
[S15] loaded HEAD from S7 (vec_in norm=1.114798)
[S15] cosine check vs S7: cos=0.7206
[S15] BUFFERED delta from S7 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1799) from S13
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.685269)
[S15] loaded HEAD from S13 (vec_in norm=1.685269)
[S15] cosine check vs S13: cos=0.4370
[S15] BUFFERED delta from S13 (total buffered=2)
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1797) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.205701)
[S9] loaded HEAD from S5 (vec_in norm=1.205701)
[S9] cosine check vs S5: cos=0.9740
[S9] BUFFERED delta from S5 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1803) from S6
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.197721)
[S8] loaded HEAD from S6 (vec_in norm=1.197721)
[S8] cosine check vs S6: cos=-0.0721
[S8] DROPPED delta from S6 (cos=-0.0721 < 0.0)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:39402
[S4] sending update (kind=head size=1802 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1802) from S4
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.566315)
[S2] loaded HEAD from S4 (vec_in norm=1.566315)
[S2] cosine check vs S4: cos=-0.0518
[S2] DROPPED delta from S4 (cos=-0.0518 < 0.0)
[S9] sending update (kind=head size=1792 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1792) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.180801)
[S3] loaded HEAD from S9 (vec_in norm=1.180801)
[S3] cosine check vs S9: cos=-0.0787
[S3] DROPPED delta from S9 (cos=-0.0787 < 0.0)
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=12 metric=0.9953 head_norm=1.375149
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.046595e-01
[S10] stored merged vector for next round verification (round=12)
[S10] DEBUG after merge:  round=12 metric=0.9950 head_norm=1.239310 delta_norm=0.204660
[S10] aggregate: ACCEPT kept=['S15', 'S2'] (k=2/2) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=12 metric=0.6885 head_norm=1.501019
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.157321e-01
[S3] stored merged vector for next round verification (round=12)
[S3] DEBUG after merge:  round=12 metric=0.6866 head_norm=1.524799 delta_norm=0.115732
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=12 metric=0.7015 head_norm=0.893898
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.514433e-01
[S15] stored merged vector for next round verification (round=12)
[S15] DEBUG after merge:  round=12 metric=0.8919 head_norm=0.900953 delta_norm=0.351443
[S15] aggregate: ACCEPT kept=['S7', 'S13'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=12 metric=0.6519 head_norm=1.114798
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.869496e-01
[S7] stored merged vector for next round verification (round=12)
[S7] DEBUG after merge:  round=12 metric=0.5400 head_norm=1.293762 delta_norm=0.486950
[S7] aggregate: ROLLBACK (f1_val pre=0.652 post=0.540 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=12 metric=0.7012 head_norm=1.180801
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.365075e-01
[S9] stored merged vector for next round verification (round=12)
[S9] DEBUG after merge:  round=12 metric=0.7012 head_norm=1.185483 delta_norm=0.136508
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=12 metric=0.9589 head_norm=1.197721
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.352863e-01
[S6] stored merged vector for next round verification (round=12)
[S6] DEBUG after merge:  round=12 metric=0.9612 head_norm=1.235604 delta_norm=0.735286
[S6] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.810087 (no previous merge yet)
[S2] round=13 local utility u=0.000000 metrics={'f1_val': 0.6023085526708656, 'auprc': 0.7032052440910392, 'loss_val': 0.7260909105023378, 'psi': 0.642667229238935}-{'f1_val': 0.7074353752970295, 'auprc': 0.7339106035956782, 'loss_val': 0.4026979339826469, 'psi': 0.7180254666164889}
[S3] START round=13 head_norm_before_train=1.524799 cos_to_last_merge=1.0000 (last merge round=12)
[S3] round=13 local utility u=0.071672 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9478654052684989, 'loss_val': 0.4723614930736223, 'psi': 0.7995547379066004}-{'f1_val': 0.6885440098122174, 'auprc': 0.9831751562453973, 'loss_val': 0.6488122747463634, 'psi': 0.8063964683854894}
[S4] START round=13 head_norm_before_train=1.566315 cos_to_last_merge=0.8551 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.855
[S4] round=13 local utility u=0.000000 metrics={'f1_val': 0.9411948706193414, 'auprc': 0.9361944579082632, 'loss_val': 0.286349217152831, 'psi': 0.93919470553491}-{'f1_val': 0.9574457479947068, 'auprc': 0.9653676954096021, 'loss_val': 0.26468866951039943, 'psi': 0.960614526960665}
[S5] START round=13 head_norm_before_train=1.205701 cos_to_last_merge=0.8890 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.889
[S5] round=13 local utility u=0.025591 metrics={'f1_val': 0.7146274551983124, 'auprc': 0.7954113622264449, 'loss_val': 0.4659172754696046, 'psi': 0.7469410180095655}-{'f1_val': 0.7149864615098203, 'auprc': 0.7954088957633505, 'loss_val': 0.5192463723733853, 'psi': 0.7471554352112324}
[S6] START round=13 head_norm_before_train=1.235604 cos_to_last_merge=1.0000 (last merge round=12)
[S6] round=13 local utility u=0.012513 metrics={'f1_val': 0.9597636379778973, 'auprc': 0.9726329287507434, 'loss_val': 0.3810587942643706, 'psi': 0.9649113542870358}-{'f1_val': 0.9588877169130392, 'auprc': 0.9626304898898344, 'loss_val': 0.3708223048212475, 'psi': 0.9603848261037573}
[S7] START round=13 head_norm_before_train=1.293762 cos_to_last_merge=1.0000 (last merge round=12)
[S7] round=13 local utility u=0.260621 metrics={'f1_val': 0.7140699654073116, 'auprc': 0.7732049391774041, 'loss_val': 0.7666416813297215, 'psi': 0.7377239549153486}-{'f1_val': 0.6518565853477496, 'auprc': 0.7727525296346757, 'loss_val': 0.9132462801074703, 'psi': 0.7002149630625201}
[S8] START round=13 head_norm_before_train=1.556841 cos_to_last_merge=0.8396 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.840
[S8] round=13 local utility u=0.003498 metrics={'f1_val': 0.992174240363445, 'auprc': 0.998474975494763, 'loss_val': 0.05176911680991776, 'psi': 0.9946945344159722}-{'f1_val': 0.992174240363445, 'auprc': 0.9983061004274675, 'loss_val': 0.058259088564908044, 'psi': 0.9946269843890541}
[S9] START round=13 head_norm_before_train=1.185483 cos_to_last_merge=1.0000 (last merge round=12)
[S9] round=13 local utility u=0.024440 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9978950383193025, 'loss_val': 0.3078513649432463, 'psi': 0.8198879637917321}-{'f1_val': 0.7012165807733519, 'auprc': 0.9980051947794311, 'loss_val': 0.35706179268401866, 'psi': 0.8199320263757836}
[S10] START round=13 head_norm_before_train=1.239310 cos_to_last_merge=1.0000 (last merge round=12)
[S10] round=13 local utility u=0.000584 metrics={'f1_val': 0.992359425649064, 'auprc': 0.9940318822181827, 'loss_val': 0.17228926712913392, 'psi': 0.9930284082767116}-{'f1_val': 0.9952638196745391, 'auprc': 0.9949952854040207, 'loss_val': 0.19377390084768828, 'psi': 0.9951564059663318}
[S11] START round=13 head_norm_before_train=1.605960 (no previous merge yet)
[S11] round=13 local utility u=0.056363 metrics={'f1_val': 0.9592794997384312, 'auprc': 0.998519493794406, 'loss_val': 0.18830316552542506, 'psi': 0.9749754973608211}-{'f1_val': 0.9583661809174511, 'auprc': 0.9989811717465418, 'loss_val': 0.2969340578991656, 'psi': 0.9746121772490873}
[S13] START round=13 head_norm_before_train=1.685269 (no previous merge yet)
[S13] round=13 local utility u=0.066354 metrics={'f1_val': 0.6156458675193911, 'auprc': 0.6572627687207907, 'loss_val': 0.6930418983110416, 'psi': 0.632292627999951}-{'f1_val': 0.5976787762380794, 'auprc': 0.6738251513892508, 'loss_val': 0.7676344309402796, 'psi': 0.6281373262985479}
[S14] START round=13 head_norm_before_train=1.643225 (no previous merge yet)
[S14] round=13 local utility u=1.000000 metrics={'f1_val': 0.9980847028057478, 'auprc': 0.9957228776013047, 'loss_val': 0.17773267216410735, 'psi': 0.9971399727239705}-{'f1_val': 0.6246822658429712, 'auprc': 0.995707240123327, 'loss_val': 0.32710132983853224, 'psi': 0.7730922555551135}
[S15] START round=13 head_norm_before_train=0.900953 cos_to_last_merge=1.0000 (last merge round=12)
[S15] round=13 local utility u=0.667459 metrics={'f1_val': 0.9053398555323631, 'auprc': 0.9967566164043237, 'loss_val': 0.31884698103415754, 'psi': 0.9419065598811474}-{'f1_val': 0.7015435105358478, 'auprc': 0.9894941058103792, 'loss_val': 0.40919850718649065, 'psi': 0.8167237486456604}
[S16] START round=13 head_norm_before_train=1.574042 (no previous merge yet)
[S16] round=13 local utility u=0.439964 metrics={'f1_val': 0.5542853237869534, 'auprc': 0.7628395046535505, 'loss_val': 0.8557814995546815, 'psi': 0.6377069961335923}-{'f1_val': 0.4330051567051709, 'auprc': 0.7386988112015443, 'loss_val': 0.9356060933273073, 'psi': 0.5552826185037203}
[S17] START round=13 head_norm_before_train=1.495441 cos_to_last_merge=0.8381 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.838
[S17] round=13 local utility u=0.155369 metrics={'f1_val': 0.6540782131552239, 'auprc': 0.9160601375675494, 'loss_val': 0.5981276956326932, 'psi': 0.7588709829201541}-{'f1_val': 0.5881102533187681, 'auprc': 0.9331110231699538, 'loss_val': 0.5642108697330062, 'psi': 0.7261105612592424}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:39409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:39403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S10@127.0.0.1:39411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:39408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:39410
[S6] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:39407
[S8] RECEIVED delta(kind=head bytes=1796) from S6
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.279256)
[S8] loaded HEAD from S6 (vec_in norm=1.279256)
[S8] cosine check vs S6: cos=-0.0606
[S8] DROPPED delta from S6 (cos=-0.0606 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] → sending delta(kind=head bytes=1805) to S3@127.0.0.1:39403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:39408
[S3] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:39407
[S15] sending update (kind=head size=1794 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:39415
[S10] RECEIVED delta(kind=head bytes=1794) from S15
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.985634)
[S10] loaded HEAD from S15 (vec_in norm=0.985634)
[S10] cosine check vs S15: cos=0.5393
[S10] BUFFERED delta from S15 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1798) from S3
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.555449)
[S15] loaded HEAD from S3 (vec_in norm=1.555449)
[S15] cosine check vs S3: cos=0.2240
[S15] BUFFERED delta from S3 (total buffered=1)
[S5] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1797) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.237885)
[S9] loaded HEAD from S5 (vec_in norm=1.237885)
[S9] cosine check vs S5: cos=0.9840
[S9] BUFFERED delta from S5 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1803) from S7
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.315781)
[S15] loaded HEAD from S7 (vec_in norm=1.315781)
[S15] cosine check vs S7: cos=0.6242
[S15] BUFFERED delta from S7 (total buffered=2)
[S7] RECEIVED delta(kind=head bytes=1803) from S11
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.666573)
[S7] loaded HEAD from S11 (vec_in norm=1.666573)
[S7] cosine check vs S11: cos=0.9607
[S7] BUFFERED delta from S11 (total buffered=1)
[S16] sending update (kind=head size=1801 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1801) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.610824)
[S6] loaded HEAD from S16 (vec_in norm=1.610824)
[S6] cosine check vs S16: cos=0.4425
[S6] BUFFERED delta from S16 (total buffered=1)
[S9] sending update (kind=head size=1805 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1801) from S14
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.682675)
[S6] loaded HEAD from S14 (vec_in norm=1.682675)
[S6] cosine check vs S14: cos=0.8853
[S6] BUFFERED delta from S14 (total buffered=2)
[S3] RECEIVED delta(kind=head bytes=1805) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.227661)
[S3] loaded HEAD from S9 (vec_in norm=1.227661)
[S3] cosine check vs S9: cos=-0.0867
[S3] DROPPED delta from S9 (cos=-0.0867 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1799) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.305479)
[S7] loaded HEAD from S10 (vec_in norm=1.305479)
[S7] cosine check vs S10: cos=0.4912
[S7] BUFFERED delta from S10 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1803) from S13
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.701670)
[S15] loaded HEAD from S13 (vec_in norm=1.701670)
[S15] cosine check vs S13: cos=0.6888
[S15] BUFFERED delta from S13 (total buffered=3)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:39409
[S8] sending update (kind=head size=1798 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1798) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.586846)
[S3] loaded HEAD from S8 (vec_in norm=1.586846)
[S3] cosine check vs S8: cos=0.9933
[S3] BUFFERED delta from S8 (total buffered=1)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.544701)
[S8] loaded HEAD from S17 (vec_in norm=1.544701)
[S8] cosine check vs S17: cos=-0.0282
[S8] DROPPED delta from S17 (cos=-0.0282 < 0.0)
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=13 metric=0.7141 head_norm=1.315781
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.135234e-01
[S7] stored merged vector for next round verification (round=13)
[S7] DEBUG after merge:  round=13 metric=0.6786 head_norm=1.233236 delta_norm=0.213523
[S7] aggregate: ROLLBACK (f1_val pre=0.714 post=0.679 tol_abs=0.005 tol_rel=0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=13 metric=0.9924 head_norm=1.305479
[S10] _apply_head_vector_avg (torch): Δ‖w‖=5.674024e-01
[S10] stored merged vector for next round verification (round=13)
[S10] DEBUG after merge:  round=13 metric=0.9917 head_norm=1.007933 delta_norm=0.567402
[S10] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=13 metric=0.7012 head_norm=1.227661
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.102530e-01
[S9] stored merged vector for next round verification (round=13)
[S9] DEBUG after merge:  round=13 metric=0.7012 head_norm=1.227844 delta_norm=0.110253
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=13 metric=0.7007 head_norm=1.555449
[S3] _apply_head_vector_avg (torch): Δ‖w‖=9.237269e-02
[S3] stored merged vector for next round verification (round=13)
[S3] DEBUG after merge:  round=13 metric=0.7007 head_norm=1.568508 delta_norm=0.092373
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=13 metric=0.9598 head_norm=1.279256
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.215808e-01
[S6] stored merged vector for next round verification (round=13)
[S6] DEBUG after merge:  round=13 metric=0.9595 head_norm=1.207401 delta_norm=0.221581
[S6] aggregate: ACCEPT kept=['S16', 'S14'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=13 metric=0.9053 head_norm=0.985634
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.565164e-01
[S15] stored merged vector for next round verification (round=13)
[S15] DEBUG after merge:  round=13 metric=0.9046 head_norm=0.910086 delta_norm=0.256516
[S15] aggregate: ACCEPT kept=['S3', 'S7', 'S13'] (k=3/3) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.829619 (no previous merge yet)
[S2] round=14 local utility u=0.428770 metrics={'f1_val': 0.6965205430055923, 'auprc': 0.7635045509968187, 'loss_val': 0.6147215837907601, 'psi': 0.7233141462020829}-{'f1_val': 0.6023085526708656, 'auprc': 0.7032052440910392, 'loss_val': 0.7260909105023378, 'psi': 0.642667229238935}
[S3] START round=14 head_norm_before_train=1.568508 cos_to_last_merge=1.0000 (last merge round=13)
[S3] round=14 local utility u=0.043603 metrics={'f1_val': 0.7010108237857944, 'auprc': 0.9752501332709511, 'loss_val': 0.4692884767515215, 'psi': 0.8107065475798572}-{'f1_val': 0.7006809596653347, 'auprc': 0.9478654052684989, 'loss_val': 0.4723614930736223, 'psi': 0.7995547379066004}
[S4] START round=14 head_norm_before_train=1.596617 cos_to_last_merge=0.8530 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.853
[S4] round=14 local utility u=0.084883 metrics={'f1_val': 0.9487192999663658, 'auprc': 0.9701530579860774, 'loss_val': 0.2636056896402464, 'psi': 0.9572928031742505}-{'f1_val': 0.9411948706193414, 'auprc': 0.9361944579082632, 'loss_val': 0.286349217152831, 'psi': 0.93919470553491}
[S5] START round=14 head_norm_before_train=1.237885 cos_to_last_merge=0.8775 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.877
[S5] round=14 local utility u=0.287134 metrics={'f1_val': 0.7011046720655897, 'auprc': 0.9981379058223223, 'loss_val': 0.41869194202473364, 'psi': 0.8199179655682827}-{'f1_val': 0.7146274551983124, 'auprc': 0.7954113622264449, 'loss_val': 0.4659172754696046, 'psi': 0.7469410180095655}
[S6] START round=14 head_norm_before_train=1.207401 cos_to_last_merge=1.0000 (last merge round=13)
[S6] round=14 local utility u=0.000000 metrics={'f1_val': 0.8855031736773449, 'auprc': 0.9668637019764001, 'loss_val': 0.3765908882295792, 'psi': 0.918047384996967}-{'f1_val': 0.9597636379778973, 'auprc': 0.9726329287507434, 'loss_val': 0.3810587942643706, 'psi': 0.9649113542870358}
[S7] START round=14 head_norm_before_train=1.233236 cos_to_last_merge=1.0000 (last merge round=13)
[S7] round=14 local utility u=0.000000 metrics={'f1_val': 0.47724422169093345, 'auprc': 0.7914081572297835, 'loss_val': 0.8773939149269484, 'psi': 0.6029097959064735}-{'f1_val': 0.7140699654073116, 'auprc': 0.7732049391774041, 'loss_val': 0.7666416813297215, 'psi': 0.7377239549153486}
[S8] START round=14 head_norm_before_train=1.586846 cos_to_last_merge=0.8350 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.835
[S8] round=14 local utility u=0.000000 metrics={'f1_val': 0.9936566772467331, 'auprc': 0.9878236471280911, 'loss_val': 0.052217447106562925, 'psi': 0.9913234651992764}-{'f1_val': 0.992174240363445, 'auprc': 0.998474975494763, 'loss_val': 0.05176911680991776, 'psi': 0.9946945344159722}
[S9] START round=14 head_norm_before_train=1.227844 cos_to_last_merge=1.0000 (last merge round=13)
[S9] round=14 local utility u=0.022031 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.997804083946284, 'loss_val': 0.26351558944677866, 'psi': 0.8198515820425247}-{'f1_val': 0.7012165807733519, 'auprc': 0.9978950383193025, 'loss_val': 0.3078513649432463, 'psi': 0.8198879637917321}
[S10] START round=14 head_norm_before_train=1.007933 cos_to_last_merge=1.0000 (last merge round=13)
[S10] round=14 local utility u=0.000000 metrics={'f1_val': 0.992320636222502, 'auprc': 0.99554082485942, 'loss_val': 0.25613112134229626, 'psi': 0.9936087116772692}-{'f1_val': 0.992359425649064, 'auprc': 0.9940318822181827, 'loss_val': 0.17228926712913392, 'psi': 0.9930284082767116}
[S11] START round=14 head_norm_before_train=1.666573 (no previous merge yet)
[S11] round=14 local utility u=0.144798 metrics={'f1_val': 0.9967394579561065, 'auprc': 0.9983857796363449, 'loss_val': 0.12306674173019454, 'psi': 0.9973979866282019}-{'f1_val': 0.9592794997384312, 'auprc': 0.998519493794406, 'loss_val': 0.18830316552542506, 'psi': 0.9749754973608211}
[S13] START round=14 head_norm_before_train=1.701670 (no previous merge yet)
[S13] round=14 local utility u=0.000000 metrics={'f1_val': 0.5765620175455648, 'auprc': 0.6868091026610209, 'loss_val': 0.9404540468618939, 'psi': 0.6206608515917473}-{'f1_val': 0.6156458675193911, 'auprc': 0.6572627687207907, 'loss_val': 0.6930418983110416, 'psi': 0.632292627999951}
[S14] START round=14 head_norm_before_train=1.682675 (no previous merge yet)
[S14] round=14 local utility u=0.022525 metrics={'f1_val': 0.9968524173284324, 'auprc': 0.9971277515475714, 'loss_val': 0.12950434208039793, 'psi': 0.996962551016088}-{'f1_val': 0.9980847028057478, 'auprc': 0.9957228776013047, 'loss_val': 0.17773267216410735, 'psi': 0.9971399727239705}
[S15] START round=14 head_norm_before_train=0.910086 cos_to_last_merge=1.0000 (last merge round=13)
[S15] round=14 local utility u=0.000000 metrics={'f1_val': 0.7157772618458956, 'auprc': 0.9781902860468155, 'loss_val': 0.4269680662133554, 'psi': 0.8207424715262637}-{'f1_val': 0.9053398555323631, 'auprc': 0.9967566164043237, 'loss_val': 0.31884698103415754, 'psi': 0.9419065598811474}
[S16] START round=14 head_norm_before_train=1.610824 (no previous merge yet)
[S16] round=14 local utility u=0.138416 metrics={'f1_val': 0.5664955330419624, 'auprc': 0.7975103902451183, 'loss_val': 0.7562234492382057, 'psi': 0.6589014759232248}-{'f1_val': 0.5542853237869534, 'auprc': 0.7628395046535505, 'loss_val': 0.8557814995546815, 'psi': 0.6377069961335923}
[S17] START round=14 head_norm_before_train=1.544701 cos_to_last_merge=0.8333 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.833
[S17] round=14 local utility u=0.000000 metrics={'f1_val': 0.5967349968923242, 'auprc': 0.9613052424227084, 'loss_val': 0.6599777562905316, 'psi': 0.7425630951044779}-{'f1_val': 0.6540782131552239, 'auprc': 0.9160601375675494, 'loss_val': 0.5981276956326932, 'psi': 0.7588709829201541}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:39410
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:39415
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:39408
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S4] → sending delta(kind=head bytes=1807) to S2@127.0.0.1:39402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:39407
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:39403
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S10@127.0.0.1:39411
[S2] sending update (kind=head size=1804 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1807 to 1 peers)
[S3] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1807) from S4
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.623140)
[S2] loaded HEAD from S4 (vec_in norm=1.623140)
[S2] cosine check vs S4: cos=-0.0544
[S2] DROPPED delta from S4 (cos=-0.0544 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1802) from S14
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.718967)
[S6] loaded HEAD from S14 (vec_in norm=1.718967)
[S6] cosine check vs S14: cos=0.7989
[S6] BUFFERED delta from S14 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1794) from S3
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.599616)
[S15] loaded HEAD from S3 (vec_in norm=1.599616)
[S15] cosine check vs S3: cos=0.3977
[S15] BUFFERED delta from S3 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1804) from S2
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.849434)
[S10] loaded HEAD from S2 (vec_in norm=1.849434)
[S10] cosine check vs S2: cos=0.7765
[S10] BUFFERED delta from S2 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1800) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.268195)
[S3] loaded HEAD from S9 (vec_in norm=1.268195)
[S3] cosine check vs S9: cos=-0.0909
[S3] DROPPED delta from S9 (cos=-0.0909 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1798) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.267694)
[S9] loaded HEAD from S5 (vec_in norm=1.267694)
[S9] cosine check vs S5: cos=0.9883
[S9] BUFFERED delta from S5 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1805 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1802) from S11
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.723031)
[S7] loaded HEAD from S11 (vec_in norm=1.723031)
[S7] cosine check vs S11: cos=0.9141
[S7] BUFFERED delta from S11 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1805) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.645954)
[S6] loaded HEAD from S16 (vec_in norm=1.645954)
[S6] cosine check vs S16: cos=0.5845
[S6] BUFFERED delta from S16 (total buffered=2)
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=14 metric=0.8855 head_norm=1.262319
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.425876e-01
[S6] stored merged vector for next round verification (round=14)
[S6] DEBUG after merge:  round=14 metric=0.8447 head_norm=1.222422 delta_norm=0.142588
[S6] aggregate: ROLLBACK (f1_val pre=0.886 post=0.845 tol_abs=0.005 tol_rel=0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=14 metric=0.4772 head_norm=1.257155
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.838525e-01
[S7] stored merged vector for next round verification (round=14)
[S7] DEBUG after merge:  round=14 metric=0.4454 head_norm=1.458525 delta_norm=0.383852
[S7] aggregate: ROLLBACK (f1_val pre=0.477 post=0.445 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=14 metric=0.7012 head_norm=1.268195
[S9] _apply_head_vector_avg (torch): Δ‖w‖=9.704584e-02
[S9] stored merged vector for next round verification (round=14)
[S9] DEBUG after merge:  round=14 metric=0.7012 head_norm=1.264225 delta_norm=0.097046
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=14 metric=0.9923 head_norm=1.070190
[S10] _apply_head_vector_avg (torch): Δ‖w‖=6.107551e-01
[S10] stored merged vector for next round verification (round=14)
[S10] DEBUG after merge:  round=14 metric=0.9923 head_norm=1.381967 delta_norm=0.610755
[S10] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=14 metric=0.7158 head_norm=0.974511
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.531062e-01
[S15] stored merged vector for next round verification (round=14)
[S15] DEBUG after merge:  round=14 metric=0.7044 head_norm=1.089519 delta_norm=0.753106
[S15] aggregate: ROLLBACK (f1_val pre=0.716 post=0.704 tol_abs=0.005 tol_rel=0.0)
[S2] START round=15 head_norm_before_train=1.849434 (no previous merge yet)
[S2] round=15 local utility u=0.000000 metrics={'f1_val': 0.6864450285607473, 'auprc': 0.7421773826557101, 'loss_val': 0.8453418234807142, 'psi': 0.7087379701987324}-{'f1_val': 0.6965205430055923, 'auprc': 0.7635045509968187, 'loss_val': 0.6147215837907601, 'psi': 0.7233141462020829}
[S3] START round=15 head_norm_before_train=1.599616 cos_to_last_merge=0.9992 (last merge round=13)
[S3] round=15 local utility u=0.061844 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9833170877473358, 'loss_val': 0.36827459083831615, 'psi': 0.8137805573401141}-{'f1_val': 0.7010108237857944, 'auprc': 0.9752501332709511, 'loss_val': 0.4692884767515215, 'psi': 0.8107065475798572}
[S4] START round=15 head_norm_before_train=1.623140 cos_to_last_merge=0.8510 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.851
[S4] round=15 local utility u=0.034982 metrics={'f1_val': 0.9584202101470747, 'auprc': 0.9730846671646332, 'loss_val': 0.26064175868886463, 'psi': 0.964285992954098}-{'f1_val': 0.9487192999663658, 'auprc': 0.9701530579860774, 'loss_val': 0.2636056896402464, 'psi': 0.9572928031742505}
[S5] START round=15 head_norm_before_train=1.267694 cos_to_last_merge=0.8670 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.867
[S5] round=15 local utility u=0.020526 metrics={'f1_val': 0.7011041183246911, 'auprc': 0.9981392497521726, 'loss_val': 0.37764088982807015, 'psi': 0.8199181708956838}-{'f1_val': 0.7011046720655897, 'auprc': 0.9981379058223223, 'loss_val': 0.41869194202473364, 'psi': 0.8199179655682827}
[S6] START round=15 head_norm_before_train=1.222422 cos_to_last_merge=1.0000 (last merge round=14)
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.8241918839089429, 'auprc': 0.9656725645862902, 'loss_val': 0.41442381964931263, 'psi': 0.8807841561798819}-{'f1_val': 0.8855031736773449, 'auprc': 0.9668637019764001, 'loss_val': 0.3765908882295792, 'psi': 0.918047384996967}
[S7] START round=15 head_norm_before_train=1.458525 cos_to_last_merge=1.0000 (last merge round=14)
[S7] round=15 local utility u=0.650210 metrics={'f1_val': 0.6629994418154028, 'auprc': 0.8022745864726674, 'loss_val': 0.724104514632198, 'psi': 0.7187094996783087}-{'f1_val': 0.47724422169093345, 'auprc': 0.7914081572297835, 'loss_val': 0.8773939149269484, 'psi': 0.6029097959064735}
[S8] START round=15 head_norm_before_train=1.618421 cos_to_last_merge=0.8302 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.830
[S8] round=15 local utility u=0.016682 metrics={'f1_val': 0.9937185965290795, 'auprc': 0.9959011414567762, 'loss_val': 0.04345668042219133, 'psi': 0.9945916145001581}-{'f1_val': 0.9936566772467331, 'auprc': 0.9878236471280911, 'loss_val': 0.052217447106562925, 'psi': 0.9913234651992764}
[S9] START round=15 head_norm_before_train=1.264225 cos_to_last_merge=1.0000 (last merge round=14)
[S9] round=15 local utility u=0.860951 metrics={'f1_val': 0.9800583557618099, 'auprc': 0.997800594623462, 'loss_val': 0.21465415652115, 'psi': 0.9871552513064707}-{'f1_val': 0.7012165807733519, 'auprc': 0.997804083946284, 'loss_val': 0.26351558944677866, 'psi': 0.8198515820425247}
[S10] START round=15 head_norm_before_train=1.381967 cos_to_last_merge=1.0000 (last merge round=14)
[S10] round=15 local utility u=0.072455 metrics={'f1_val': 0.9939487387271932, 'auprc': 0.9968892882915104, 'loss_val': 0.12503435150866188, 'psi': 0.99512495855292}-{'f1_val': 0.992320636222502, 'auprc': 0.99554082485942, 'loss_val': 0.25613112134229626, 'psi': 0.9936087116772692}
[S11] START round=15 head_norm_before_train=1.723031 (no previous merge yet)
[S11] round=15 local utility u=0.006615 metrics={'f1_val': 0.9965882633272201, 'auprc': 0.9984806803341075, 'loss_val': 0.10921357706143106, 'psi': 0.997345230129975}-{'f1_val': 0.9967394579561065, 'auprc': 0.9983857796363449, 'loss_val': 0.12306674173019454, 'psi': 0.9973979866282019}
[S13] START round=15 head_norm_before_train=1.719216 (no previous merge yet)
[S13] round=15 local utility u=0.002180 metrics={'f1_val': 0.5732108462830438, 'auprc': 0.6893542334924646, 'loss_val': 0.923621811032497, 'psi': 0.6196682011668121}-{'f1_val': 0.5765620175455648, 'auprc': 0.6868091026610209, 'loss_val': 0.9404540468618939, 'psi': 0.6206608515917473}
[S14] START round=15 head_norm_before_train=1.718967 (no previous merge yet)
[S14] round=15 local utility u=0.014856 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9956320573693664, 'loss_val': 0.0976320234400913, 'psi': 0.9965970369712225}-{'f1_val': 0.9968524173284324, 'auprc': 0.9971277515475714, 'loss_val': 0.12950434208039793, 'psi': 0.996962551016088}
[S15] START round=15 head_norm_before_train=1.089519 cos_to_last_merge=1.0000 (last merge round=14)
[S15] round=15 local utility u=0.596756 metrics={'f1_val': 0.8989990092578382, 'auprc': 0.9978432305699871, 'loss_val': 0.3917455150844264, 'psi': 0.9385366977826978}-{'f1_val': 0.7157772618458956, 'auprc': 0.9781902860468155, 'loss_val': 0.4269680662133554, 'psi': 0.8207424715262637}
[S16] START round=15 head_norm_before_train=1.645954 (no previous merge yet)
[S16] round=15 local utility u=0.923950 metrics={'f1_val': 0.8041424837348035, 'auprc': 0.8638339203728682, 'loss_val': 0.5331757142113214, 'psi': 0.8280190583900293}-{'f1_val': 0.5664955330419624, 'auprc': 0.7975103902451183, 'loss_val': 0.7562234492382057, 'psi': 0.6589014759232248}
[S17] START round=15 head_norm_before_train=1.587586 cos_to_last_merge=0.8304 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.830
[S17] round=15 local utility u=0.000000 metrics={'f1_val': 0.5854647514875916, 'auprc': 0.8940307774824018, 'loss_val': 0.7658013830488142, 'psi': 0.7088911618855157}-{'f1_val': 0.5967349968923242, 'auprc': 0.9613052424227084, 'loss_val': 0.6599777562905316, 'psi': 0.7425630951044779}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:39403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:39411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:39410
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] → sending delta(kind=head bytes=1805) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:39402
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] → sending delta(kind=head bytes=1805) to S7@127.0.0.1:39408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:39408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:39403
[S14] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1805 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1805 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1805 to 1 peers)
[S5] sending update (kind=head size=1804 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1795) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.646896)
[S3] loaded HEAD from S8 (vec_in norm=1.646896)
[S3] cosine check vs S8: cos=0.9911
[S3] BUFFERED delta from S8 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1799) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.305713)
[S3] loaded HEAD from S9 (vec_in norm=1.305713)
[S3] cosine check vs S9: cos=-0.0946
[S3] DROPPED delta from S9 (cos=-0.0946 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1805) from S7
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.476368)
[S15] loaded HEAD from S7 (vec_in norm=1.476368)
[S15] cosine check vs S7: cos=0.3139
[S15] BUFFERED delta from S7 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1797) from S15
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.135293)
[S10] loaded HEAD from S15 (vec_in norm=1.135293)
[S10] cosine check vs S15: cos=0.2119
[S10] BUFFERED delta from S15 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1804) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.292634)
[S9] loaded HEAD from S5 (vec_in norm=1.292634)
[S9] cosine check vs S5: cos=0.9902
[S9] BUFFERED delta from S5 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1800) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.441732)
[S7] loaded HEAD from S10 (vec_in norm=1.441732)
[S7] cosine check vs S10: cos=0.3902
[S7] BUFFERED delta from S10 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1805) from S11
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.770360)
[S7] loaded HEAD from S11 (vec_in norm=1.770360)
[S7] cosine check vs S11: cos=0.9817
[S7] BUFFERED delta from S11 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1799) from S13
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.731028)
[S15] loaded HEAD from S13 (vec_in norm=1.731028)
[S15] cosine check vs S13: cos=0.3373
[S15] BUFFERED delta from S13 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1798) from S3
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.628649)
[S15] loaded HEAD from S3 (vec_in norm=1.628649)
[S15] cosine check vs S3: cos=0.8826
[S15] BUFFERED delta from S3 (total buffered=3)
[S6] RECEIVED delta(kind=head bytes=1801) from S14
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.754359)
[S6] loaded HEAD from S14 (vec_in norm=1.754359)
[S6] cosine check vs S14: cos=0.7483
[S6] BUFFERED delta from S14 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1805) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.680498)
[S6] loaded HEAD from S16 (vec_in norm=1.680498)
[S6] cosine check vs S16: cos=0.6492
[S6] BUFFERED delta from S16 (total buffered=2)
[S2] RECEIVED delta(kind=head bytes=1801) from S4
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.644403)
[S2] loaded HEAD from S4 (vec_in norm=1.644403)
[S2] cosine check vs S4: cos=-0.0556
[S2] DROPPED delta from S4 (cos=-0.0556 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] ⇄ pheromone p=0.164 → S10@127.0.0.1:39411
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=15 metric=0.8242 head_norm=1.282361
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.191981e-01
[S6] stored merged vector for next round verification (round=15)
[S6] DEBUG after merge:  round=15 metric=0.8238 head_norm=1.247206 delta_norm=0.119198
[S6] aggregate: ACCEPT kept=['S14', 'S16'] (k=2/2) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.180 → S8@127.0.0.1:39409
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=15 metric=0.9939 head_norm=1.441732
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.175888e-01
[S10] stored merged vector for next round verification (round=15)
[S10] DEBUG after merge:  round=15 metric=0.9939 head_norm=1.007616 delta_norm=0.817589
[S10] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.165 → S7@127.0.0.1:39408
[S8] ⇄ pheromone p=0.113 → S3@127.0.0.1:39403
[S15] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=15 metric=0.8990 head_norm=1.135293
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.030682e-01
[S15] stored merged vector for next round verification (round=15)
[S15] DEBUG after merge:  round=15 metric=0.9067 head_norm=1.008665 delta_norm=0.303068
[S15] aggregate: ACCEPT kept=['S7', 'S13', 'S3'] (k=3/3) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.308 → S10@127.0.0.1:39411
[S13] ⇄ pheromone p=0.090 → S15@127.0.0.1:39415
[S16] ⇄ pheromone p=0.371 → S6@127.0.0.1:39407
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=15 metric=0.6630 head_norm=1.476368
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.080061e-01
[S7] stored merged vector for next round verification (round=15)
[S7] DEBUG after merge:  round=15 metric=0.6660 head_norm=1.339061 delta_norm=0.308006
[S7] aggregate: ACCEPT kept=['S10', 'S11'] (k=2/2) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.339 → S15@127.0.0.1:39415
[S14] ⇄ pheromone p=0.298 → S6@127.0.0.1:39407
[S4] ⇄ pheromone p=0.188 → S2@127.0.0.1:39402
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=15 metric=0.7008 head_norm=1.628649
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.099110e-01
[S3] stored merged vector for next round verification (round=15)
[S3] DEBUG after merge:  round=15 metric=0.7008 head_norm=1.634105 delta_norm=0.109911
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.231 → S15@127.0.0.1:39415
[S5] ⇄ pheromone p=0.230 → S9@127.0.0.1:39410
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=15 metric=0.9801 head_norm=1.305713
[S9] _apply_head_vector_avg (torch): Δ‖w‖=9.110492e-02
[S9] stored merged vector for next round verification (round=15)
[S9] DEBUG after merge:  round=15 metric=0.9390 head_norm=1.295992 delta_norm=0.091105
[S9] aggregate: ROLLBACK (f1_val pre=0.980 post=0.939 tol_abs=0.005 tol_rel=0.0)
[S9] ⇄ pheromone p=0.276 → S3@127.0.0.1:39403
[S11] ⇄ pheromone p=0.193 → S7@127.0.0.1:39408
[S17] ⇄ pheromone p=0.151 → S8@127.0.0.1:39409
[S2] START round=16 head_norm_before_train=1.865191 (no previous merge yet)
[S2] round=16 local utility u=0.011972 metrics={'f1_val': 0.6967805175512192, 'auprc': 0.7359062801767867, 'loss_val': 0.864596639547132, 'psi': 0.7124308226014462}-{'f1_val': 0.6864450285607473, 'auprc': 0.7421773826557101, 'loss_val': 0.8453418234807142, 'psi': 0.7087379701987324}
[S3] START round=16 head_norm_before_train=1.634105 cos_to_last_merge=1.0000 (last merge round=15)
[S3] round=16 local utility u=0.005554 metrics={'f1_val': 0.7010108237857944, 'auprc': 0.9848133031195199, 'loss_val': 0.363182446280372, 'psi': 0.8145318155192847}-{'f1_val': 0.7007562037352997, 'auprc': 0.9833170877473358, 'loss_val': 0.36827459083831615, 'psi': 0.8137805573401141}
[S4] START round=16 head_norm_before_train=1.644403 cos_to_last_merge=0.8493 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.849
[S4] round=16 local utility u=0.000000 metrics={'f1_val': 0.8392780158303449, 'auprc': 0.9437717661666893, 'loss_val': 0.43308925305499896, 'psi': 0.8810755159648826}-{'f1_val': 0.9584202101470747, 'auprc': 0.9730846671646332, 'loss_val': 0.26064175868886463, 'psi': 0.964285992954098}
[S5] START round=16 head_norm_before_train=1.292634 cos_to_last_merge=0.8561 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.856
[S5] round=16 local utility u=0.000000 metrics={'f1_val': 0.7008563225598777, 'auprc': 0.918722795164808, 'loss_val': 0.3492072987280122, 'psi': 0.7880029116018499}-{'f1_val': 0.7011041183246911, 'auprc': 0.9981392497521726, 'loss_val': 0.37764088982807015, 'psi': 0.8199181708956838}
[S6] START round=16 head_norm_before_train=1.247206 cos_to_last_merge=1.0000 (last merge round=15)
[S6] round=16 local utility u=0.007184 metrics={'f1_val': 0.8242829004479727, 'auprc': 0.9640210689753949, 'loss_val': 0.39564648533185875, 'psi': 0.8801781678589415}-{'f1_val': 0.8241918839089429, 'auprc': 0.9656725645862902, 'loss_val': 0.41442381964931263, 'psi': 0.8807841561798819}
[S7] START round=16 head_norm_before_train=1.339061 cos_to_last_merge=1.0000 (last merge round=15)
[S7] round=16 local utility u=0.044684 metrics={'f1_val': 0.6622220682025493, 'auprc': 0.8285367004145402, 'loss_val': 0.708858657230482, 'psi': 0.7287479210873457}-{'f1_val': 0.6629994418154028, 'auprc': 0.8022745864726674, 'loss_val': 0.724104514632198, 'psi': 0.7187094996783087}
[S8] START round=16 head_norm_before_train=1.646896 cos_to_last_merge=0.8266 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.827
[S8] round=16 local utility u=0.000000 metrics={'f1_val': 0.9935252750776847, 'auprc': 0.987599657677089, 'loss_val': 0.05060943014021378, 'psi': 0.9911550281174464}-{'f1_val': 0.9937185965290795, 'auprc': 0.9959011414567762, 'loss_val': 0.04345668042219133, 'psi': 0.9945916145001581}
[S9] START round=16 head_norm_before_train=1.295992 cos_to_last_merge=1.0000 (last merge round=15)
[S9] round=16 local utility u=0.063905 metrics={'f1_val': 0.9945775144926113, 'auprc': 0.9977945351537426, 'loss_val': 0.17394095903332762, 'psi': 0.9958643227570638}-{'f1_val': 0.9800583557618099, 'auprc': 0.997800594623462, 'loss_val': 0.21465415652115, 'psi': 0.9871552513064707}
[S10] START round=16 head_norm_before_train=1.007616 cos_to_last_merge=1.0000 (last merge round=15)
[S10] round=16 local utility u=0.000000 metrics={'f1_val': 0.9929767808544108, 'auprc': 0.9941985126223607, 'loss_val': 0.24558457194782482, 'psi': 0.9934654735615908}-{'f1_val': 0.9939487387271932, 'auprc': 0.9968892882915104, 'loss_val': 0.12503435150866188, 'psi': 0.99512495855292}
[S11] START round=16 head_norm_before_train=1.770360 (no previous merge yet)
[S11] round=16 local utility u=0.014527 metrics={'f1_val': 0.9967427451611812, 'auprc': 0.998465391531845, 'loss_val': 0.08104113067072272, 'psi': 0.9974318037094467}-{'f1_val': 0.9965882633272201, 'auprc': 0.9984806803341075, 'loss_val': 0.10921357706143106, 'psi': 0.997345230129975}
[S13] START round=16 head_norm_before_train=1.731028 (no previous merge yet)
[S13] round=16 local utility u=0.027970 metrics={'f1_val': 0.5961304735029715, 'auprc': 0.626342886167667, 'loss_val': 0.8161653675269437, 'psi': 0.6082154385688497}-{'f1_val': 0.5732108462830438, 'auprc': 0.6893542334924646, 'loss_val': 0.923621811032497, 'psi': 0.6196682011668121}
[S14] START round=16 head_norm_before_train=1.754359 (no previous merge yet)
[S14] round=16 local utility u=0.016950 metrics={'f1_val': 0.9970728011695729, 'auprc': 0.9971553605804278, 'loss_val': 0.06729599090981993, 'psi': 0.9971058249339149}-{'f1_val': 0.997240356705793, 'auprc': 0.9956320573693664, 'loss_val': 0.0976320234400913, 'psi': 0.9965970369712225}
[S15] START round=16 head_norm_before_train=1.008665 cos_to_last_merge=1.0000 (last merge round=15)
[S15] round=16 local utility u=0.032246 metrics={'f1_val': 0.8999149533843095, 'auprc': 0.99819334787351, 'loss_val': 0.33379908684010273, 'psi': 0.9392263111799897}-{'f1_val': 0.8989990092578382, 'auprc': 0.9978432305699871, 'loss_val': 0.3917455150844264, 'psi': 0.9385366977826978}
[S16] START round=16 head_norm_before_train=1.680498 (no previous merge yet)
[S16] round=16 local utility u=0.245885 metrics={'f1_val': 0.8715367926217092, 'auprc': 0.8936252815216534, 'loss_val': 0.5351460377084766, 'psi': 0.8803721881816868}-{'f1_val': 0.8041424837348035, 'auprc': 0.8638339203728682, 'loss_val': 0.5331757142113214, 'psi': 0.8280190583900293}
[S17] START round=16 head_norm_before_train=1.625222 cos_to_last_merge=0.8284 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.828
[S17] round=16 local utility u=0.127305 metrics={'f1_val': 0.6002050288176797, 'auprc': 0.970451654842102, 'loss_val': 0.8288955512733841, 'psi': 0.7483036792274487}-{'f1_val': 0.5854647514875916, 'auprc': 0.8940307774824018, 'loss_val': 0.7658013830488142, 'psi': 0.7088911618855157}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:39407
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:39408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:39403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:39411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:39409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:39415
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:39411
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1800) from S11
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.811905)
[S7] loaded HEAD from S11 (vec_in norm=1.811905)
[S7] cosine check vs S11: cos=0.9311
[S7] BUFFERED delta from S11 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1801) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.712834)
[S6] loaded HEAD from S16 (vec_in norm=1.712834)
[S6] cosine check vs S16: cos=0.6778
[S6] BUFFERED delta from S16 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1797) from S14
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.789220)
[S6] loaded HEAD from S14 (vec_in norm=1.789220)
[S6] cosine check vs S14: cos=0.7235
[S6] BUFFERED delta from S14 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1800) from S7
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.357142)
[S15] loaded HEAD from S7 (vec_in norm=1.357142)
[S15] cosine check vs S7: cos=0.4798
[S15] BUFFERED delta from S7 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1801) from S13
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.739903)
[S15] loaded HEAD from S13 (vec_in norm=1.739903)
[S15] cosine check vs S13: cos=0.4919
[S15] BUFFERED delta from S13 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1804) from S3
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.661089)
[S15] loaded HEAD from S3 (vec_in norm=1.661089)
[S15] cosine check vs S3: cos=0.7394
[S15] BUFFERED delta from S3 (total buffered=3)
[S10] RECEIVED delta(kind=head bytes=1798) from S2
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.874687)
[S10] loaded HEAD from S2 (vec_in norm=1.874687)
[S10] cosine check vs S2: cos=0.7400
[S10] BUFFERED delta from S2 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1798) from S15
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.076082)
[S10] loaded HEAD from S15 (vec_in norm=1.076082)
[S10] cosine check vs S15: cos=0.7026
[S10] BUFFERED delta from S15 (total buffered=2)
[S3] RECEIVED delta(kind=head bytes=1800) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.335835)
[S3] loaded HEAD from S9 (vec_in norm=1.335835)
[S3] cosine check vs S9: cos=-0.0947
[S3] DROPPED delta from S9 (cos=-0.0947 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1801) from S6
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.307840)
[S8] loaded HEAD from S6 (vec_in norm=1.307840)
[S8] cosine check vs S6: cos=-0.0611
[S8] DROPPED delta from S6 (cos=-0.0611 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:39409
[S17] sending update (kind=head size=1798 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.653750)
[S8] loaded HEAD from S17 (vec_in norm=1.653750)
[S8] cosine check vs S17: cos=-0.0290
[S8] DROPPED delta from S17 (cos=-0.0290 < 0.0)
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=16 metric=0.9930 head_norm=1.084153
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.651207e-01
[S10] stored merged vector for next round verification (round=16)
[S10] DEBUG after merge:  round=16 metric=0.9934 head_norm=1.090477 delta_norm=0.165121
[S10] aggregate: ACCEPT kept=['S2', 'S15'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=16 metric=0.6622 head_norm=1.357142
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.693790e-01
[S7] stored merged vector for next round verification (round=16)
[S7] DEBUG after merge:  round=16 metric=0.6617 head_norm=1.557555 delta_norm=0.369379
[S7] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=16 metric=0.8243 head_norm=1.307840
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.144369e-01
[S6] stored merged vector for next round verification (round=16)
[S6] DEBUG after merge:  round=16 metric=0.8238 head_norm=1.272275 delta_norm=0.114437
[S6] aggregate: ACCEPT kept=['S16', 'S14'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=16 metric=0.8999 head_norm=1.076082
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.894932e-01
[S15] stored merged vector for next round verification (round=16)
[S15] DEBUG after merge:  round=16 metric=0.9007 head_norm=0.996011 delta_norm=0.189493
[S15] aggregate: ACCEPT kept=['S7', 'S13', 'S3'] (k=3/3) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.874687 (no previous merge yet)
[S2] round=17 local utility u=0.038598 metrics={'f1_val': 0.6991396843877808, 'auprc': 0.7477188010499436, 'loss_val': 0.8369931124044947, 'psi': 0.7185713310526459}-{'f1_val': 0.6967805175512192, 'auprc': 0.7359062801767867, 'loss_val': 0.864596639547132, 'psi': 0.7124308226014462}
[S3] START round=17 head_norm_before_train=1.661089 cos_to_last_merge=0.9996 (last merge round=15)
[S3] round=17 local utility u=0.000000 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.9305495837749507, 'loss_val': 0.3261803061112027, 'psi': 0.7925834350101036}-{'f1_val': 0.7010108237857944, 'auprc': 0.9848133031195199, 'loss_val': 0.363182446280372, 'psi': 0.8145318155192847}
[S4] START round=17 head_norm_before_train=1.656208 cos_to_last_merge=0.8482 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.848
[S4] round=17 local utility u=0.446254 metrics={'f1_val': 0.9589317576147912, 'auprc': 0.9527757755612329, 'loss_val': 0.28551491723897443, 'psi': 0.956469364793368}-{'f1_val': 0.8392780158303449, 'auprc': 0.9437717661666893, 'loss_val': 0.43308925305499896, 'psi': 0.8810755159648826}
[S5] START round=17 head_norm_before_train=1.320073 cos_to_last_merge=0.8440 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.844
[S5] round=17 local utility u=0.128160 metrics={'f1_val': 0.7008563225598777, 'auprc': 0.9955480609903984, 'loss_val': 0.32336253166209367, 'psi': 0.818733017932086}-{'f1_val': 0.7008563225598777, 'auprc': 0.918722795164808, 'loss_val': 0.3492072987280122, 'psi': 0.7880029116018499}
[S6] START round=17 head_norm_before_train=1.272275 cos_to_last_merge=1.0000 (last merge round=16)
[S6] round=17 local utility u=0.159782 metrics={'f1_val': 0.8674880353252323, 'auprc': 0.96495835014616, 'loss_val': 0.3381249356816257, 'psi': 0.9064761612536034}-{'f1_val': 0.8242829004479727, 'auprc': 0.9640210689753949, 'loss_val': 0.39564648533185875, 'psi': 0.8801781678589415}
[S7] START round=17 head_norm_before_train=1.557555 cos_to_last_merge=1.0000 (last merge round=16)
[S7] round=17 local utility u=0.000000 metrics={'f1_val': 0.5284738610242152, 'auprc': 0.7757825397750174, 'loss_val': 0.8333203962579689, 'psi': 0.6273973325245361}-{'f1_val': 0.6622220682025493, 'auprc': 0.8285367004145402, 'loss_val': 0.708858657230482, 'psi': 0.7287479210873457}
[S8] START round=17 head_norm_before_train=1.667450 cos_to_last_merge=0.8255 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.825
[S8] round=17 local utility u=0.018475 metrics={'f1_val': 0.9925289693239863, 'auprc': 0.9987906579521064, 'loss_val': 0.041254563956609216, 'psi': 0.9950336447752344}-{'f1_val': 0.9935252750776847, 'auprc': 0.987599657677089, 'loss_val': 0.05060943014021378, 'psi': 0.9911550281174464}
[S9] START round=17 head_norm_before_train=1.335835 cos_to_last_merge=0.9986 (last merge round=15)
[S9] round=17 local utility u=0.010348 metrics={'f1_val': 0.9916448056378947, 'auprc': 0.9981705068976602, 'loss_val': 0.13677736097821214, 'psi': 0.9942550861418009}-{'f1_val': 0.9945775144926113, 'auprc': 0.9977945351537426, 'loss_val': 0.17394095903332762, 'psi': 0.9958643227570638}
[S10] START round=17 head_norm_before_train=1.090477 cos_to_last_merge=1.0000 (last merge round=16)
[S10] round=17 local utility u=0.047496 metrics={'f1_val': 0.9941912883790185, 'auprc': 0.993674775439209, 'loss_val': 0.15630849185136922, 'psi': 0.9939846832030947}-{'f1_val': 0.9929767808544108, 'auprc': 0.9941985126223607, 'loss_val': 0.24558457194782482, 'psi': 0.9934654735615908}
[S11] START round=17 head_norm_before_train=1.811905 (no previous merge yet)
[S11] round=17 local utility u=0.000000 metrics={'f1_val': 0.9912914732062101, 'auprc': 0.9984085332853043, 'loss_val': 0.0938306601729927, 'psi': 0.9941382972378477}-{'f1_val': 0.9967427451611812, 'auprc': 0.998465391531845, 'loss_val': 0.08104113067072272, 'psi': 0.9974318037094467}
[S13] START round=17 head_norm_before_train=1.739903 (no previous merge yet)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.5788758034340109, 'auprc': 0.5941108324278804, 'loss_val': 0.7887905666316714, 'psi': 0.5849698150315588}-{'f1_val': 0.5961304735029715, 'auprc': 0.626342886167667, 'loss_val': 0.8161653675269437, 'psi': 0.6082154385688497}
[S14] START round=17 head_norm_before_train=1.789220 (no previous merge yet)
[S14] round=17 local utility u=0.004869 metrics={'f1_val': 0.9968300801588782, 'auprc': 0.9971545506689045, 'loss_val': 0.05609888447382787, 'psi': 0.9969598683628886}-{'f1_val': 0.9970728011695729, 'auprc': 0.9971553605804278, 'loss_val': 0.06729599090981993, 'psi': 0.9971058249339149}
[S15] START round=17 head_norm_before_train=0.996011 cos_to_last_merge=1.0000 (last merge round=16)
[S15] round=17 local utility u=0.078081 metrics={'f1_val': 0.9148869992230775, 'auprc': 0.9986536781687977, 'loss_val': 0.26885086283169135, 'psi': 0.9483936708013655}-{'f1_val': 0.8999149533843095, 'auprc': 0.99819334787351, 'loss_val': 0.33379908684010273, 'psi': 0.9392263111799897}
[S16] START round=17 head_norm_before_train=1.712834 (no previous merge yet)
[S16] round=17 local utility u=0.071367 metrics={'f1_val': 0.8651030384815211, 'auprc': 0.9587719233261862, 'loss_val': 0.5492501263227801, 'psi': 0.9025705924193872}-{'f1_val': 0.8715367926217092, 'auprc': 0.8936252815216534, 'loss_val': 0.5351460377084766, 'psi': 0.8803721881816868}
[S17] START round=17 head_norm_before_train=1.653750 cos_to_last_merge=0.8271 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.827
[S17] round=17 local utility u=0.000000 metrics={'f1_val': 0.5873129969194509, 'auprc': 0.837725472301693, 'loss_val': 0.8982074323129677, 'psi': 0.6874779870723478}-{'f1_val': 0.6002050288176797, 'auprc': 0.970451654842102, 'loss_val': 0.8288955512733841, 'psi': 0.7483036792274487}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:39408
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:39402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:39403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S14] → sending delta(kind=head bytes=1808) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:39410
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:39403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:39411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] → sending delta(kind=head bytes=1792) to S10@127.0.0.1:39411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:39409
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1792 to 1 peers)
[S8] sending update (kind=head size=1794 to 1 peers)
[S5] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1808 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S6] sending update (kind=head size=1805 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1805) from S6
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.329121)
[S8] loaded HEAD from S6 (vec_in norm=1.329121)
[S8] cosine check vs S6: cos=-0.0595
[S8] DROPPED delta from S6 (cos=-0.0595 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1800) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.195119)
[S7] loaded HEAD from S10 (vec_in norm=1.195119)
[S7] cosine check vs S10: cos=0.4451
[S7] BUFFERED delta from S10 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1803) from S4
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.660753)
[S2] loaded HEAD from S4 (vec_in norm=1.660753)
[S2] cosine check vs S4: cos=-0.0565
[S2] DROPPED delta from S4 (cos=-0.0565 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1794) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.682416)
[S3] loaded HEAD from S8 (vec_in norm=1.682416)
[S3] cosine check vs S8: cos=0.9927
[S3] BUFFERED delta from S8 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1803) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.742010)
[S6] loaded HEAD from S16 (vec_in norm=1.742010)
[S6] cosine check vs S16: cos=0.6903
[S6] BUFFERED delta from S16 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1799) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.374658)
[S3] loaded HEAD from S9 (vec_in norm=1.374658)
[S3] cosine check vs S9: cos=-0.0917
[S3] DROPPED delta from S9 (cos=-0.0917 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1808) from S14
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.822469)
[S6] loaded HEAD from S14 (vec_in norm=1.822469)
[S6] cosine check vs S14: cos=0.7121
[S6] BUFFERED delta from S14 (total buffered=2)
[S10] RECEIVED delta(kind=head bytes=1792) from S15
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.067381)
[S10] loaded HEAD from S15 (vec_in norm=1.067381)
[S10] cosine check vs S15: cos=0.6356
[S10] BUFFERED delta from S15 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1803) from S2
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.886879)
[S10] loaded HEAD from S2 (vec_in norm=1.886879)
[S10] cosine check vs S2: cos=0.8261
[S10] BUFFERED delta from S2 (total buffered=2)
[S9] RECEIVED delta(kind=head bytes=1804) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.350259)
[S9] loaded HEAD from S5 (vec_in norm=1.350259)
[S9] cosine check vs S5: cos=0.9839
[S9] BUFFERED delta from S5 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=17 metric=0.5285 head_norm=1.571707
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.460484e-01
[S7] stored merged vector for next round verification (round=17)
[S7] DEBUG after merge:  round=17 metric=0.6079 head_norm=1.180126 delta_norm=0.746048
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=17 metric=0.7006 head_norm=1.687491
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.020499e-01
[S3] stored merged vector for next round verification (round=17)
[S3] DEBUG after merge:  round=17 metric=0.7006 head_norm=1.681863 delta_norm=0.102050
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=17 metric=0.9916 head_norm=1.374658
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.226719e-01
[S9] stored merged vector for next round verification (round=17)
[S9] DEBUG after merge:  round=17 metric=0.9916 head_norm=1.356980 delta_norm=0.122672
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=17 metric=0.8675 head_norm=1.329121
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.125307e-01
[S6] stored merged vector for next round verification (round=17)
[S6] DEBUG after merge:  round=17 metric=0.8394 head_norm=1.293913 delta_norm=0.112531
[S6] aggregate: ROLLBACK (f1_val pre=0.867 post=0.839 tol_abs=0.005 tol_rel=0.0)
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=17 metric=0.9942 head_norm=1.195119
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.388082e-01
[S10] stored merged vector for next round verification (round=17)
[S10] DEBUG after merge:  round=17 metric=0.9940 head_norm=1.164531 delta_norm=0.138808
[S10] aggregate: ACCEPT kept=['S15', 'S2'] (k=2/2) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.886879 (no previous merge yet)
[S2] round=18 local utility u=0.050479 metrics={'f1_val': 0.7151711461430786, 'auprc': 0.7519466906417505, 'loss_val': 0.8449072914103347, 'psi': 0.7298813639425474}-{'f1_val': 0.6991396843877808, 'auprc': 0.7477188010499436, 'loss_val': 0.8369931124044947, 'psi': 0.7185713310526459}
[S3] START round=18 head_norm_before_train=1.681863 cos_to_last_merge=1.0000 (last merge round=17)
[S3] round=18 local utility u=0.127211 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9966563488038913, 'loss_val': 0.27052931586738244, 'psi': 0.8190711153207574}-{'f1_val': 0.7006060025002057, 'auprc': 0.9305495837749507, 'loss_val': 0.3261803061112027, 'psi': 0.7925834350101036}
[S4] START round=18 head_norm_before_train=1.660753 cos_to_last_merge=0.8494 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.849
[S4] round=18 local utility u=0.000000 metrics={'f1_val': 0.8358107018849159, 'auprc': 0.8974990976392889, 'loss_val': 0.43486807808028516, 'psi': 0.8604860601866651}-{'f1_val': 0.9589317576147912, 'auprc': 0.9527757755612329, 'loss_val': 0.28551491723897443, 'psi': 0.956469364793368}
[S5] START round=18 head_norm_before_train=1.350259 cos_to_last_merge=0.8350 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.835
[S5] round=18 local utility u=0.000000 metrics={'f1_val': 0.714400588689728, 'auprc': 0.7951431941349085, 'loss_val': 0.40417952808713015, 'psi': 0.7466976308678002}-{'f1_val': 0.7008563225598777, 'auprc': 0.9955480609903984, 'loss_val': 0.32336253166209367, 'psi': 0.818733017932086}
[S6] START round=18 head_norm_before_train=1.293913 cos_to_last_merge=1.0000 (last merge round=17)
[S6] round=18 local utility u=0.191875 metrics={'f1_val': 0.9214698184686578, 'auprc': 0.9707065108149103, 'loss_val': 0.2955095465831043, 'psi': 0.9411644954071589}-{'f1_val': 0.8674880353252323, 'auprc': 0.96495835014616, 'loss_val': 0.3381249356816257, 'psi': 0.9064761612536034}
[S7] START round=18 head_norm_before_train=1.180126 cos_to_last_merge=1.0000 (last merge round=17)
[S7] round=18 local utility u=0.006820 metrics={'f1_val': 0.5233995692168519, 'auprc': 0.7846456316913086, 'loss_val': 0.815823869697839, 'psi': 0.6278979942066346}-{'f1_val': 0.5284738610242152, 'auprc': 0.7757825397750174, 'loss_val': 0.8333203962579689, 'psi': 0.6273973325245361}
[S8] START round=18 head_norm_before_train=1.682416 cos_to_last_merge=0.8242 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.824
[S8] round=18 local utility u=0.002616 metrics={'f1_val': 0.9928938724649488, 'auprc': 0.9990416401814902, 'loss_val': 0.038964183901043774, 'psi': 0.9953529795515653}-{'f1_val': 0.9925289693239863, 'auprc': 0.9987906579521064, 'loss_val': 0.041254563956609216, 'psi': 0.9950336447752344}
[S9] START round=18 head_norm_before_train=1.356980 cos_to_last_merge=1.0000 (last merge round=17)
[S9] round=18 local utility u=0.002515 metrics={'f1_val': 0.9916448056378947, 'auprc': 0.9981569228940919, 'loss_val': 0.13170566376397708, 'psi': 0.9942496525403735}-{'f1_val': 0.9916448056378947, 'auprc': 0.9981705068976602, 'loss_val': 0.13677736097821214, 'psi': 0.9942550861418009}
[S10] START round=18 head_norm_before_train=1.164531 cos_to_last_merge=1.0000 (last merge round=17)
[S10] round=18 local utility u=0.014719 metrics={'f1_val': 0.992869746824563, 'auprc': 0.9964759279034623, 'loss_val': 0.12734527923457517, 'psi': 0.9943122192561227}-{'f1_val': 0.9941912883790185, 'auprc': 0.993674775439209, 'loss_val': 0.15630849185136922, 'psi': 0.9939846832030947}
[S11] START round=18 head_norm_before_train=1.843081 (no previous merge yet)
[S11] round=18 local utility u=0.034298 metrics={'f1_val': 0.9967427451611812, 'auprc': 0.9983812640873254, 'loss_val': 0.05786125504324505, 'psi': 0.9973981527316389}-{'f1_val': 0.9912914732062101, 'auprc': 0.9984085332853043, 'loss_val': 0.0938306601729927, 'psi': 0.9941382972378477}
[S13] START round=18 head_norm_before_train=1.747936 (no previous merge yet)
[S13] round=18 local utility u=0.246720 metrics={'f1_val': 0.6132987257200951, 'auprc': 0.6723541259278949, 'loss_val': 0.736618763581947, 'psi': 0.636920885803215}-{'f1_val': 0.5788758034340109, 'auprc': 0.5941108324278804, 'loss_val': 0.7887905666316714, 'psi': 0.5849698150315588}
[S14] START round=18 head_norm_before_train=1.822469 (no previous merge yet)
[S14] round=18 local utility u=0.000000 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9956306206171421, 'loss_val': 0.061269234511888274, 'psi': 0.9964507531414559}-{'f1_val': 0.9968300801588782, 'auprc': 0.9971545506689045, 'loss_val': 0.05609888447382787, 'psi': 0.9969598683628886}
[S15] START round=18 head_norm_before_train=1.067381 cos_to_last_merge=0.9931 (last merge round=16)
[S15] round=18 local utility u=0.000000 metrics={'f1_val': 0.9019970488144871, 'auprc': 0.9973038899037425, 'loss_val': 0.2258979963648439, 'psi': 0.9401197852501892}-{'f1_val': 0.9148869992230775, 'auprc': 0.9986536781687977, 'loss_val': 0.26885086283169135, 'psi': 0.9483936708013655}
[S16] START round=18 head_norm_before_train=1.742010 (no previous merge yet)
[S16] round=18 local utility u=0.000000 metrics={'f1_val': 0.8423032317894044, 'auprc': 0.8800059734295609, 'loss_val': 0.7262795823605867, 'psi': 0.857384328445467}-{'f1_val': 0.8651030384815211, 'auprc': 0.9587719233261862, 'loss_val': 0.5492501263227801, 'psi': 0.9025705924193872}
[S17] START round=18 head_norm_before_train=1.676399 cos_to_last_merge=0.8258 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.826
[S17] round=18 local utility u=0.152067 metrics={'f1_val': 0.5985583801065026, 'auprc': 0.9295616697959899, 'loss_val': 0.9370538985286736, 'psi': 0.7309596959822975}-{'f1_val': 0.5873129969194509, 'auprc': 0.837725472301693, 'loss_val': 0.8982074323129677, 'psi': 0.6874779870723478}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S3] → sending delta(kind=head bytes=1791) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S11] → sending delta(kind=head bytes=1807) to S7@127.0.0.1:39408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:39403
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:39415
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:39408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:39411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:39409
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:39415
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:39403
[S11] sending update (kind=head size=1807 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1791 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1797) from S7
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.197216)
[S15] loaded HEAD from S7 (vec_in norm=1.197216)
[S15] cosine check vs S7: cos=0.6619
[S15] BUFFERED delta from S7 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1791) from S3
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.705945)
[S15] loaded HEAD from S3 (vec_in norm=1.705945)
[S15] cosine check vs S3: cos=0.6152
[S15] BUFFERED delta from S3 (total buffered=2)
[S7] RECEIVED delta(kind=head bytes=1807) from S11
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.865935)
[S7] loaded HEAD from S11 (vec_in norm=1.865935)
[S7] cosine check vs S11: cos=0.8129
[S7] BUFFERED delta from S11 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1800) from S13
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.762166)
[S15] loaded HEAD from S13 (vec_in norm=1.762166)
[S15] cosine check vs S13: cos=0.5636
[S15] BUFFERED delta from S13 (total buffered=3)
[S3] RECEIVED delta(kind=head bytes=1800) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.393255)
[S3] loaded HEAD from S9 (vec_in norm=1.393255)
[S3] cosine check vs S9: cos=-0.0935
[S3] DROPPED delta from S9 (cos=-0.0935 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1800) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.707216)
[S3] loaded HEAD from S8 (vec_in norm=1.707216)
[S3] cosine check vs S8: cos=0.9965
[S3] BUFFERED delta from S8 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1802) from S2
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.903045)
[S10] loaded HEAD from S2 (vec_in norm=1.903045)
[S10] cosine check vs S2: cos=0.8621
[S10] BUFFERED delta from S2 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1801) from S6
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.337185)
[S8] loaded HEAD from S6 (vec_in norm=1.337185)
[S8] cosine check vs S6: cos=-0.0564
[S8] DROPPED delta from S6 (cos=-0.0564 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1797) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.256870)
[S7] loaded HEAD from S10 (vec_in norm=1.256870)
[S7] cosine check vs S10: cos=0.8019
[S7] BUFFERED delta from S10 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:39409
[S17] sending update (kind=head size=1798 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.702330)
[S8] loaded HEAD from S17 (vec_in norm=1.702330)
[S8] cosine check vs S17: cos=-0.0288
[S8] DROPPED delta from S17 (cos=-0.0288 < 0.0)
[S15] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=18 metric=0.9020 head_norm=1.152698
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.003517e-01
[S15] stored merged vector for next round verification (round=18)
[S15] DEBUG after merge:  round=18 metric=0.9016 head_norm=1.045805 delta_norm=0.200352
[S15] aggregate: ACCEPT kept=['S7', 'S3', 'S13'] (k=3/3) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=18 metric=0.5234 head_norm=1.197216
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.017431e-01
[S7] stored merged vector for next round verification (round=18)
[S7] DEBUG after merge:  round=18 metric=0.5269 head_norm=1.233578 delta_norm=0.101743
[S7] aggregate: ACCEPT kept=['S11', 'S10'] (k=2/2) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=18 metric=0.9929 head_norm=1.256870
[S10] _apply_head_vector_avg (torch): Δ‖w‖=5.189897e-01
[S10] stored merged vector for next round verification (round=18)
[S10] DEBUG after merge:  round=18 metric=0.9929 head_norm=1.526860 delta_norm=0.518990
[S10] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=18 metric=0.7007 head_norm=1.705945
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.125261e-02
[S3] stored merged vector for next round verification (round=18)
[S3] DEBUG after merge:  round=18 metric=0.7007 head_norm=1.705092 delta_norm=0.071253
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.903045 (no previous merge yet)
[S2] round=19 local utility u=0.000000 metrics={'f1_val': 0.6944294456590879, 'auprc': 0.754779536026945, 'loss_val': 0.8640914634822544, 'psi': 0.7185694818062307}-{'f1_val': 0.7151711461430786, 'auprc': 0.7519466906417505, 'loss_val': 0.8449072914103347, 'psi': 0.7298813639425474}
[S3] START round=19 head_norm_before_train=1.705092 cos_to_last_merge=1.0000 (last merge round=18)
[S3] round=19 local utility u=0.015969 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.9980370918423358, 'loss_val': 0.24228333196890378, 'psi': 0.8195784382370577}-{'f1_val': 0.7006809596653347, 'auprc': 0.9966563488038913, 'loss_val': 0.27052931586738244, 'psi': 0.8190711153207574}
[S4] START round=19 head_norm_before_train=1.668696 cos_to_last_merge=0.8491 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.849
[S4] round=19 local utility u=0.546556 metrics={'f1_val': 0.9578400510816588, 'auprc': 0.9569945771839055, 'loss_val': 0.2524184478727683, 'psi': 0.9575018615225575}-{'f1_val': 0.8358107018849159, 'auprc': 0.8974990976392889, 'loss_val': 0.43486807808028516, 'psi': 0.8604860601866651}
[S5] START round=19 head_norm_before_train=1.377472 cos_to_last_merge=0.8277 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.828
[S5] round=19 local utility u=0.311211 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.9956801525321127, 'loss_val': 0.30061864679877953, 'psi': 0.8186375174163136}-{'f1_val': 0.714400588689728, 'auprc': 0.7951431941349085, 'loss_val': 0.40417952808713015, 'psi': 0.7466976308678002}
[S6] START round=19 head_norm_before_train=1.337185 cos_to_last_merge=0.9982 (last merge round=17)
[S6] round=19 local utility u=0.000000 metrics={'f1_val': 0.8287338170136239, 'auprc': 0.9687626150180859, 'loss_val': 0.3460444872510384, 'psi': 0.8847453362154087}-{'f1_val': 0.9214698184686578, 'auprc': 0.9707065108149103, 'loss_val': 0.2955095465831043, 'psi': 0.9411644954071589}
[S7] START round=19 head_norm_before_train=1.233578 cos_to_last_merge=1.0000 (last merge round=18)
[S7] round=19 local utility u=0.246018 metrics={'f1_val': 0.5820252933153085, 'auprc': 0.8022870943983824, 'loss_val': 0.7284656365245433, 'psi': 0.6701300137485381}-{'f1_val': 0.5233995692168519, 'auprc': 0.7846456316913086, 'loss_val': 0.815823869697839, 'psi': 0.6278979942066346}
[S8] START round=19 head_norm_before_train=1.707216 cos_to_last_merge=0.8211 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.821
[S8] round=19 local utility u=0.000000 metrics={'f1_val': 0.9936566772467331, 'auprc': 0.9861382852682684, 'loss_val': 0.04261096264665174, 'psi': 0.9906493204553473}-{'f1_val': 0.9928938724649488, 'auprc': 0.9990416401814902, 'loss_val': 0.038964183901043774, 'psi': 0.9953529795515653}
[S9] START round=19 head_norm_before_train=1.393255 cos_to_last_merge=0.9992 (last merge round=17)
[S9] round=19 local utility u=0.033203 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9981530209514483, 'loss_val': 0.09538215031997441, 'psi': 0.9972575154689142}-{'f1_val': 0.9916448056378947, 'auprc': 0.9981569228940919, 'loss_val': 0.13170566376397708, 'psi': 0.9942496525403735}
[S10] START round=19 head_norm_before_train=1.526860 cos_to_last_merge=1.0000 (last merge round=18)
[S10] round=19 local utility u=0.035338 metrics={'f1_val': 0.9944287677762472, 'auprc': 0.9966442719852602, 'loss_val': 0.06652908337630158, 'psi': 0.9953149694598524}-{'f1_val': 0.992869746824563, 'auprc': 0.9964759279034623, 'loss_val': 0.12734527923457517, 'psi': 0.9943122192561227}
[S11] START round=19 head_norm_before_train=1.865935 (no previous merge yet)
[S11] round=19 local utility u=0.000000 metrics={'f1_val': 0.9953188960218294, 'auprc': 0.9985010712302749, 'loss_val': 0.07961987701137663, 'psi': 0.9965917661052076}-{'f1_val': 0.9967427451611812, 'auprc': 0.9983812640873254, 'loss_val': 0.05786125504324505, 'psi': 0.9973981527316389}
[S13] START round=19 head_norm_before_train=1.762166 (no previous merge yet)
[S13] round=19 local utility u=0.000000 metrics={'f1_val': 0.5919716351406348, 'auprc': 0.6943192951229271, 'loss_val': 0.9005729122302981, 'psi': 0.6329106991335517}-{'f1_val': 0.6132987257200951, 'auprc': 0.6723541259278949, 'loss_val': 0.736618763581947, 'psi': 0.636920885803215}
[S14] START round=19 head_norm_before_train=1.848997 (no previous merge yet)
[S14] round=19 local utility u=0.011211 metrics={'f1_val': 0.9968300801588782, 'auprc': 0.9971528256912571, 'loss_val': 0.04241021440707077, 'psi': 0.9969591783718297}-{'f1_val': 0.9969975081576651, 'auprc': 0.9956306206171421, 'loss_val': 0.061269234511888274, 'psi': 0.9964507531414559}
[S15] START round=19 head_norm_before_train=1.045805 cos_to_last_merge=1.0000 (last merge round=18)
[S15] round=19 local utility u=0.000105 metrics={'f1_val': 0.9019621611946333, 'auprc': 0.9981234119087028, 'loss_val': 0.2279382081568347, 'psi': 0.9404266614802611}-{'f1_val': 0.9019970488144871, 'auprc': 0.9973038899037425, 'loss_val': 0.2258979963648439, 'psi': 0.9401197852501892}
[S16] START round=19 head_norm_before_train=1.768862 (no previous merge yet)
[S16] round=19 local utility u=0.833083 metrics={'f1_val': 0.9672505460379666, 'auprc': 0.9905923813325628, 'loss_val': 0.1415565332002473, 'psi': 0.9765872801558051}-{'f1_val': 0.8423032317894044, 'auprc': 0.8800059734295609, 'loss_val': 0.7262795823605867, 'psi': 0.857384328445467}
[S17] START round=19 head_norm_before_train=1.702330 cos_to_last_merge=0.8243 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.824
[S17] round=19 local utility u=0.000000 metrics={'f1_val': 0.5566381335669095, 'auprc': 0.7650863229212527, 'loss_val': 0.992793174533787, 'psi': 0.6400174093086468}-{'f1_val': 0.5985583801065026, 'auprc': 0.9295616697959899, 'loss_val': 0.9370538985286736, 'psi': 0.7309596959822975}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:39408
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:39415
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:39402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:39415
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S9] → sending delta(kind=head bytes=1809) to S3@127.0.0.1:39403
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:39410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:39407
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:39411
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1793 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1809 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1809) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.430122)
[S3] loaded HEAD from S9 (vec_in norm=1.430122)
[S3] cosine check vs S9: cos=-0.0897
[S3] DROPPED delta from S9 (cos=-0.0897 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1802) from S4
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.683051)
[S2] loaded HEAD from S4 (vec_in norm=1.683051)
[S2] cosine check vs S4: cos=-0.0585
[S2] DROPPED delta from S4 (cos=-0.0585 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1802) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.396023)
[S9] loaded HEAD from S5 (vec_in norm=1.396023)
[S9] cosine check vs S5: cos=0.9859
[S9] BUFFERED delta from S5 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1800) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.597567)
[S7] loaded HEAD from S10 (vec_in norm=1.597567)
[S7] cosine check vs S10: cos=0.6538
[S7] BUFFERED delta from S10 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1802) from S7
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.254651)
[S15] loaded HEAD from S7 (vec_in norm=1.254651)
[S15] cosine check vs S7: cos=0.6891
[S15] BUFFERED delta from S7 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1800) from S14
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.871481)
[S6] loaded HEAD from S14 (vec_in norm=1.871481)
[S6] cosine check vs S14: cos=0.6993
[S6] BUFFERED delta from S14 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1793) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.796056)
[S6] loaded HEAD from S16 (vec_in norm=1.796056)
[S6] cosine check vs S16: cos=0.6956
[S6] BUFFERED delta from S16 (total buffered=2)
[S10] RECEIVED delta(kind=head bytes=1800) from S15
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.129087)
[S10] loaded HEAD from S15 (vec_in norm=1.129087)
[S10] cosine check vs S15: cos=0.3971
[S10] BUFFERED delta from S15 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1798) from S3
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.732984)
[S15] loaded HEAD from S3 (vec_in norm=1.732984)
[S15] cosine check vs S3: cos=0.6007
[S15] BUFFERED delta from S3 (total buffered=2)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=20 psi=0.719 u=0.0000 p_local=0.0813 f1=0.694 auprc=0.755 bytes=19784
[S8] r=20 psi=0.991 u=0.0000 p_local=0.0492 f1=0.994 auprc=0.986 bytes=21556
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=19 metric=0.8287 head_norm=1.378704
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.355219e-01
[S6] stored merged vector for next round verification (round=19)
[S6] DEBUG after merge:  round=19 metric=0.8265 head_norm=1.334797 delta_norm=0.135522
[S6] aggregate: ACCEPT kept=['S14', 'S16'] (k=2/2) mode=median trim_p=0.1
[S6] r=20 psi=0.885 u=0.0000 p_local=0.1255 f1=0.829 auprc=0.969 bytes=19778
[S11] r=20 psi=0.997 u=0.0000 p_local=0.0862 f1=0.995 auprc=0.999 bytes=21624
[S13] r=20 psi=0.633 u=0.0000 p_local=0.0792 f1=0.592 auprc=0.694 bytes=16188
[S4] r=20 psi=0.958 u=0.5466 p_local=0.2436 f1=0.958 auprc=0.957 bytes=18013
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=19 metric=0.5820 head_norm=1.254651
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.134740e-01
[S7] stored merged vector for next round verification (round=19)
[S7] DEBUG after merge:  round=19 metric=0.6528 head_norm=1.298782 delta_norm=0.613474
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S7] r=20 psi=0.670 u=0.2460 p_local=0.1939 f1=0.582 auprc=0.802 bytes=23364
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=19 metric=0.9020 head_norm=1.129087
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.414187e-01
[S15] stored merged vector for next round verification (round=19)
[S15] DEBUG after merge:  round=19 metric=0.9012 head_norm=1.091950 delta_norm=0.341419
[S15] aggregate: ACCEPT kept=['S7', 'S3'] (k=2/2) mode=median trim_p=0.1
[S15] r=20 psi=0.940 u=0.0001 p_local=0.1394 f1=0.902 auprc=0.998 bytes=19764
[S3] r=20 psi=0.820 u=0.0160 p_local=0.1186 f1=0.701 auprc=0.998 bytes=17958
[S16] r=20 psi=0.977 u=0.8331 p_local=0.3529 f1=0.967 auprc=0.991 bytes=23372
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=19 metric=0.9967 head_norm=1.430122
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.197241e-01
[S9] stored merged vector for next round verification (round=19)
[S9] DEBUG after merge:  round=19 metric=0.9967 head_norm=1.408095 delta_norm=0.119724
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] r=20 psi=0.997 u=0.0332 p_local=0.1278 f1=0.997 auprc=0.998 bytes=25182
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=19 metric=0.9944 head_norm=1.597567
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.737308e-01
[S10] stored merged vector for next round verification (round=19)
[S10] DEBUG after merge:  round=19 metric=0.9939 head_norm=1.146678 delta_norm=0.773731
[S10] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S10] r=20 psi=0.995 u=0.0353 p_local=0.0831 f1=0.994 auprc=0.997 bytes=19786
[S14] r=20 psi=0.997 u=0.0112 p_local=0.1269 f1=0.997 auprc=0.997 bytes=21601
[S5] r=20 psi=0.819 u=0.3112 p_local=0.1728 f1=0.701 auprc=0.996 bytes=19769
[S17] r=20 psi=0.640 u=0.0000 p_local=0.0991 f1=0.557 auprc=0.765 bytes=14382
[S2] START round=20 head_norm_before_train=1.922316 (no previous merge yet)
[S2] round=20 local utility u=0.000000 metrics={'f1_val': 0.5216297468962156, 'auprc': 0.636902300002596, 'loss_val': 1.7525189161564112, 'psi': 0.5677387681387678}-{'f1_val': 0.6944294456590879, 'auprc': 0.754779536026945, 'loss_val': 0.8640914634822544, 'psi': 0.7185694818062307}
[S3] START round=20 head_norm_before_train=1.732984 cos_to_last_merge=0.9997 (last merge round=18)
[S3] round=20 local utility u=0.536214 metrics={'f1_val': 0.8742644090552356, 'auprc': 0.9981250959413168, 'loss_val': 0.2120690923515116, 'psi': 0.9238086838096681}-{'f1_val': 0.7006060025002057, 'auprc': 0.9980370918423358, 'loss_val': 0.24228333196890378, 'psi': 0.8195784382370577}
[S4] START round=20 head_norm_before_train=1.683051 cos_to_last_merge=0.8483 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.848
[S4] round=20 local utility u=0.000000 metrics={'f1_val': 0.9396748355492828, 'auprc': 0.9427314960091869, 'loss_val': 0.2941049565588052, 'psi': 0.9408974997332444}-{'f1_val': 0.9578400510816588, 'auprc': 0.9569945771839055, 'loss_val': 0.2524184478727683, 'psi': 0.9575018615225575}
[S5] START round=20 head_norm_before_train=1.396023 cos_to_last_merge=0.8222 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.822
[S5] round=20 local utility u=0.005761 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9961465008782485, 'loss_val': 0.2904906345026237, 'psi': 0.8188236359489041}-{'f1_val': 0.7006090940057808, 'auprc': 0.9956801525321127, 'loss_val': 0.30061864679877953, 'psi': 0.8186375174163136}
[S6] START round=20 head_norm_before_train=1.334797 cos_to_last_merge=1.0000 (last merge round=19)
[S6] round=20 local utility u=0.000000 metrics={'f1_val': 0.8219771460967022, 'auprc': 0.963224940917805, 'loss_val': 0.4374055393133387, 'psi': 0.8784762640251433}-{'f1_val': 0.8287338170136239, 'auprc': 0.9687626150180859, 'loss_val': 0.3460444872510384, 'psi': 0.8847453362154087}
[S7] START round=20 head_norm_before_train=1.298782 cos_to_last_merge=1.0000 (last merge round=19)
[S7] round=20 local utility u=0.582959 metrics={'f1_val': 0.6667955181087066, 'auprc': 0.9866060030609833, 'loss_val': 0.6241252746643903, 'psi': 0.7947197120896173}-{'f1_val': 0.5820252933153085, 'auprc': 0.8022870943983824, 'loss_val': 0.7284656365245433, 'psi': 0.6701300137485381}
[S8] START round=20 head_norm_before_train=1.733601 cos_to_last_merge=0.8179 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.818
[S8] round=20 local utility u=0.018517 metrics={'f1_val': 0.9930990485370332, 'auprc': 0.997697777955564, 'loss_val': 0.036909092291827844, 'psi': 0.9949385403044455}-{'f1_val': 0.9936566772467331, 'auprc': 0.9861382852682684, 'loss_val': 0.04261096264665174, 'psi': 0.9906493204553473}
[S9] START round=20 head_norm_before_train=1.408095 cos_to_last_merge=1.0000 (last merge round=19)
[S9] round=20 local utility u=0.000000 metrics={'f1_val': 0.9828824722028254, 'auprc': 0.9848052972763908, 'loss_val': 0.14768039822964404, 'psi': 0.9836516022322517}-{'f1_val': 0.9966605118138915, 'auprc': 0.9981530209514483, 'loss_val': 0.09538215031997441, 'psi': 0.9972575154689142}
[S10] START round=20 head_norm_before_train=1.146678 cos_to_last_merge=1.0000 (last merge round=19)
[S10] round=20 local utility u=0.000000 metrics={'f1_val': 0.9940903254969471, 'auprc': 0.9959739752509325, 'loss_val': 0.130697248025099, 'psi': 0.9948437853985412}-{'f1_val': 0.9944287677762472, 'auprc': 0.9966442719852602, 'loss_val': 0.06652908337630158, 'psi': 0.9953149694598524}
[S11] START round=20 head_norm_before_train=1.887854 (no previous merge yet)
[S11] round=20 local utility u=0.017328 metrics={'f1_val': 0.9963294104943571, 'auprc': 0.9984717659122964, 'loss_val': 0.05093817637610863, 'psi': 0.9971863526615328}-{'f1_val': 0.9953188960218294, 'auprc': 0.9985010712302749, 'loss_val': 0.07961987701137663, 'psi': 0.9965917661052076}
[S13] START round=20 head_norm_before_train=1.777747 (no previous merge yet)
[S13] round=20 local utility u=0.000000 metrics={'f1_val': 0.5431991724903866, 'auprc': 0.6942537540777508, 'loss_val': 0.973526456640597, 'psi': 0.6036210051253323}-{'f1_val': 0.5919716351406348, 'auprc': 0.6943192951229271, 'loss_val': 0.9005729122302981, 'psi': 0.6329106991335517}
[S14] START round=20 head_norm_before_train=1.871481 (no previous merge yet)
[S14] round=20 local utility u=0.001777 metrics={'f1_val': 0.9968300801588782, 'auprc': 0.9970648136898781, 'loss_val': 0.03859169033188453, 'psi': 0.996923973571278}-{'f1_val': 0.9968300801588782, 'auprc': 0.9971528256912571, 'loss_val': 0.04241021440707077, 'psi': 0.9969591783718297}
[S15] START round=20 head_norm_before_train=1.091950 cos_to_last_merge=1.0000 (last merge round=19)
[S15] round=20 local utility u=0.000000 metrics={'f1_val': 0.9023638335285724, 'auprc': 0.9983839061654638, 'loss_val': 0.27032974693384854, 'psi': 0.940771862583329}-{'f1_val': 0.9019621611946333, 'auprc': 0.9981234119087028, 'loss_val': 0.2279382081568347, 'psi': 0.9404266614802611}
[S16] START round=20 head_norm_before_train=1.796056 (no previous merge yet)
[S16] round=20 local utility u=0.000000 metrics={'f1_val': 0.8800891974187475, 'auprc': 0.9853626099664852, 'loss_val': 0.4526175796623558, 'psi': 0.9221985624378426}-{'f1_val': 0.9672505460379666, 'auprc': 0.9905923813325628, 'loss_val': 0.1415565332002473, 'psi': 0.9765872801558051}
[S17] START round=20 head_norm_before_train=1.727503 cos_to_last_merge=0.8225 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.823
[S17] round=20 local utility u=0.458378 metrics={'f1_val': 0.613073015977855, 'auprc': 0.9592203126812434, 'loss_val': 0.9970488515448575, 'psi': 0.7515319346592104}-{'f1_val': 0.5566381335669095, 'auprc': 0.7650863229212527, 'loss_val': 0.992793174533787, 'psi': 0.6400174093086468}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:39415
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:39410
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:39408
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:39407
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:39403
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1802) from S11
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.909291)
[S7] loaded HEAD from S11 (vec_in norm=1.909291)
[S7] cosine check vs S11: cos=0.5395
[S7] BUFFERED delta from S11 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1795) from S7
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.318866)
[S15] loaded HEAD from S7 (vec_in norm=1.318866)
[S15] cosine check vs S7: cos=0.5983
[S15] BUFFERED delta from S7 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1801) from S14
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.893452)
[S6] loaded HEAD from S14 (vec_in norm=1.893452)
[S6] cosine check vs S14: cos=0.7059
[S6] BUFFERED delta from S14 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1800) from S3
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.762041)
[S15] loaded HEAD from S3 (vec_in norm=1.762041)
[S15] cosine check vs S3: cos=0.7420
[S15] BUFFERED delta from S3 (total buffered=2)
[S3] RECEIVED delta(kind=head bytes=1799) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.753111)
[S3] loaded HEAD from S8 (vec_in norm=1.753111)
[S3] cosine check vs S8: cos=0.9961
[S3] BUFFERED delta from S8 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1799) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.411421)
[S9] loaded HEAD from S5 (vec_in norm=1.411421)
[S9] cosine check vs S5: cos=0.9933
[S9] BUFFERED delta from S5 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:39409
[S17] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.745483)
[S8] loaded HEAD from S17 (vec_in norm=1.745483)
[S8] cosine check vs S17: cos=-0.0292
[S8] DROPPED delta from S17 (cos=-0.0292 < 0.0)
[S4] ⇄ pheromone p=0.195 → S2@127.0.0.1:39402
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=20 metric=0.9024 head_norm=1.149465
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.636985e-01
[S15] stored merged vector for next round verification (round=20)
[S15] DEBUG after merge:  round=20 metric=0.9027 head_norm=1.128903 delta_norm=0.263699
[S15] aggregate: ACCEPT kept=['S7', 'S3'] (k=2/2) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.112 → S10@127.0.0.1:39411
[S10] ⇄ pheromone p=0.066 → S7@127.0.0.1:39408
[S2] ⇄ pheromone p=0.065 → S10@127.0.0.1:39411
[S13] ⇄ pheromone p=0.063 → S15@127.0.0.1:39415
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=20 metric=0.8220 head_norm=1.368616
[S6] _apply_head_vector_avg (torch): Δ‖w‖=6.707727e-01
[S6] stored merged vector for next round verification (round=20)
[S6] DEBUG after merge:  round=20 metric=0.8217 head_norm=1.509701 delta_norm=0.670773
[S6] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.100 → S8@127.0.0.1:39409
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=20 metric=0.9829 head_norm=1.439170
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.349044e-02
[S9] stored merged vector for next round verification (round=20)
[S9] DEBUG after merge:  round=20 metric=0.9816 head_norm=1.422916 delta_norm=0.083490
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.102 → S3@127.0.0.1:39403
[S16] ⇄ pheromone p=0.282 → S6@127.0.0.1:39407
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=20 metric=0.8743 head_norm=1.762041
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.782696e-02
[S3] stored merged vector for next round verification (round=20)
[S3] DEBUG after merge:  round=20 metric=0.7956 head_norm=1.755858 delta_norm=0.077827
[S3] aggregate: ROLLBACK (f1_val pre=0.874 post=0.796 tol_abs=0.005 tol_rel=0.0)
[S3] ⇄ pheromone p=0.202 → S15@127.0.0.1:39415
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=20 metric=0.6668 head_norm=1.318866
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.166540e-01
[S7] stored merged vector for next round verification (round=20)
[S7] DEBUG after merge:  round=20 metric=0.6614 head_norm=1.423192 delta_norm=0.816654
[S7] aggregate: ROLLBACK (f1_val pre=0.667 post=0.661 tol_abs=0.005 tol_rel=0.0)
[S7] ⇄ pheromone p=0.272 → S15@127.0.0.1:39415
[S5] ⇄ pheromone p=0.139 → S9@127.0.0.1:39410
[S11] ⇄ pheromone p=0.072 → S7@127.0.0.1:39408
[S14] ⇄ pheromone p=0.102 → S6@127.0.0.1:39407
[S8] ⇄ pheromone p=0.043 → S3@127.0.0.1:39403
[S17] ⇄ pheromone p=0.171 → S8@127.0.0.1:39409
[S2] START round=21 head_norm_before_train=1.937065 (no previous merge yet)
[S2] round=21 local utility u=0.905832 metrics={'f1_val': 0.6592255101674979, 'auprc': 0.7282067924223131, 'loss_val': 1.0403430441310544, 'psi': 0.686818023069424}-{'f1_val': 0.5216297468962156, 'auprc': 0.636902300002596, 'loss_val': 1.7525189161564112, 'psi': 0.5677387681387678}
[S3] START round=21 head_norm_before_train=1.755858 cos_to_last_merge=1.0000 (last merge round=20)
[S3] round=21 local utility u=0.411546 metrics={'f1_val': 0.9978100342676263, 'auprc': 0.9984806081354467, 'loss_val': 0.13131816043291403, 'psi': 0.9980782638147545}-{'f1_val': 0.8742644090552356, 'auprc': 0.9981250959413168, 'loss_val': 0.2120690923515116, 'psi': 0.9238086838096681}
[S4] START round=21 head_norm_before_train=1.690490 cos_to_last_merge=0.8483 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.848
[S4] round=21 local utility u=0.000000 metrics={'f1_val': 0.9275363495692017, 'auprc': 0.9398343126957325, 'loss_val': 0.3637451846366108, 'psi': 0.932455534819814}-{'f1_val': 0.9396748355492828, 'auprc': 0.9427314960091869, 'loss_val': 0.2941049565588052, 'psi': 0.9408974997332444}
[S5] START round=21 head_norm_before_train=1.411421 cos_to_last_merge=0.8186 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.819
[S5] round=21 local utility u=0.002581 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9955634353130983, 'loss_val': 0.28357994220969557, 'psi': 0.8185904097228439}-{'f1_val': 0.7006083926626743, 'auprc': 0.9961465008782485, 'loss_val': 0.2904906345026237, 'psi': 0.8188236359489041}
[S6] START round=21 head_norm_before_train=1.509701 cos_to_last_merge=1.0000 (last merge round=20)
[S6] round=21 local utility u=0.074180 metrics={'f1_val': 0.831945609626686, 'auprc': 0.9712174455549215, 'loss_val': 0.3728341980997376, 'psi': 0.8876543439979803}-{'f1_val': 0.8219771460967022, 'auprc': 0.963224940917805, 'loss_val': 0.4374055393133387, 'psi': 0.8784762640251433}
[S7] START round=21 head_norm_before_train=1.423192 cos_to_last_merge=1.0000 (last merge round=20)
[S7] round=21 local utility u=0.000000 metrics={'f1_val': 0.4047151019581253, 'auprc': 0.7726850538294726, 'loss_val': 1.06370127473176, 'psi': 0.5519030827066642}-{'f1_val': 0.6667955181087066, 'auprc': 0.9866060030609833, 'loss_val': 0.6241252746643903, 'psi': 0.7947197120896173}
[S8] START round=21 head_norm_before_train=1.753111 cos_to_last_merge=0.8162 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.816
[S8] round=21 local utility u=0.000000 metrics={'f1_val': 0.9918109678295097, 'auprc': 0.9982981364736908, 'loss_val': 0.038790977254143454, 'psi': 0.9944058352871822}-{'f1_val': 0.9930990485370332, 'auprc': 0.997697777955564, 'loss_val': 0.036909092291827844, 'psi': 0.9949385403044455}
[S9] START round=21 head_norm_before_train=1.422916 cos_to_last_merge=1.0000 (last merge round=20)
[S9] round=21 local utility u=0.086857 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.997911333201437, 'loss_val': 0.09860773083261443, 'psi': 0.9974262807878604}-{'f1_val': 0.9828824722028254, 'auprc': 0.9848052972763908, 'loss_val': 0.14768039822964404, 'psi': 0.9836516022322517}
[S10] START round=21 head_norm_before_train=1.231607 cos_to_last_merge=0.9966 (last merge round=19)
[S10] round=21 local utility u=0.020859 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.994011097383484, 'loss_val': 0.08572303351082887, 'psi': 0.9943219030324302}-{'f1_val': 0.9940903254969471, 'auprc': 0.9959739752509325, 'loss_val': 0.130697248025099, 'psi': 0.9948437853985412}
[S11] START round=21 head_norm_before_train=1.909291 (no previous merge yet)
[S11] round=21 local utility u=0.000000 metrics={'f1_val': 0.9568213683793463, 'auprc': 0.9985268535474898, 'loss_val': 0.12742226164901338, 'psi': 0.9735035624466037}-{'f1_val': 0.9963294104943571, 'auprc': 0.9984717659122964, 'loss_val': 0.05093817637610863, 'psi': 0.9971863526615328}
[S13] START round=21 head_norm_before_train=1.790770 (no previous merge yet)
[S13] round=21 local utility u=0.197772 metrics={'f1_val': 0.5808062060496141, 'auprc': 0.6879954011918357, 'loss_val': 0.7848491987330793, 'psi': 0.6236818841065027}-{'f1_val': 0.5431991724903866, 'auprc': 0.6942537540777508, 'loss_val': 0.973526456640597, 'psi': 0.6036210051253323}
[S14] START round=21 head_norm_before_train=1.893452 (no previous merge yet)
[S14] round=21 local utility u=0.000000 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9955443317749595, 'loss_val': 0.04072359762077529, 'psi': 0.996170071676434}-{'f1_val': 0.9968300801588782, 'auprc': 0.9970648136898781, 'loss_val': 0.03859169033188453, 'psi': 0.996923973571278}
[S15] START round=21 head_norm_before_train=1.128903 cos_to_last_merge=1.0000 (last merge round=20)
[S15] round=21 local utility u=0.312409 metrics={'f1_val': 0.9971172535281002, 'auprc': 0.9985828339311807, 'loss_val': 0.21462931454811437, 'psi': 0.9977034856893324}-{'f1_val': 0.9023638335285724, 'auprc': 0.9983839061654638, 'loss_val': 0.27032974693384854, 'psi': 0.940771862583329}
[S16] START round=21 head_norm_before_train=1.821924 (no previous merge yet)
[S16] round=21 local utility u=0.000000 metrics={'f1_val': 0.8441763215571326, 'auprc': 0.8582667172281481, 'loss_val': 0.7855765568335342, 'psi': 0.8498124798255389}-{'f1_val': 0.8800891974187475, 'auprc': 0.9853626099664852, 'loss_val': 0.4526175796623558, 'psi': 0.9221985624378426}
[S17] START round=21 head_norm_before_train=1.745483 cos_to_last_merge=0.8213 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.821
[S17] round=21 local utility u=0.000000 metrics={'f1_val': 0.3567952564433893, 'auprc': 0.699100992060018, 'loss_val': 1.8686395662206834, 'psi': 0.49371755069004075}-{'f1_val': 0.613073015977855, 'auprc': 0.9592203126812434, 'loss_val': 0.9970488515448575, 'psi': 0.7515319346592104}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:39411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:39403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] → sending delta(kind=head bytes=1805) to S9@127.0.0.1:39410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:39415
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:39409
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:39408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:39411
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1805 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1804) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.447386)
[S3] loaded HEAD from S9 (vec_in norm=1.447386)
[S3] cosine check vs S9: cos=-0.0925
[S3] DROPPED delta from S9 (cos=-0.0925 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1797) from S2
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.947366)
[S10] loaded HEAD from S2 (vec_in norm=1.947366)
[S10] cosine check vs S2: cos=0.7922
[S10] BUFFERED delta from S2 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1802) from S15
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.182356)
[S10] loaded HEAD from S15 (vec_in norm=1.182356)
[S10] cosine check vs S15: cos=0.7660
[S10] BUFFERED delta from S15 (total buffered=2)
[S9] RECEIVED delta(kind=head bytes=1805) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.429802)
[S9] loaded HEAD from S5 (vec_in norm=1.429802)
[S9] cosine check vs S5: cos=0.9963
[S9] BUFFERED delta from S5 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1794) from S6
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.538571)
[S8] loaded HEAD from S6 (vec_in norm=1.538571)
[S8] cosine check vs S6: cos=-0.0410
[S8] DROPPED delta from S6 (cos=-0.0410 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1801) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.329771)
[S7] loaded HEAD from S10 (vec_in norm=1.329771)
[S7] cosine check vs S10: cos=0.6812
[S7] BUFFERED delta from S10 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1796) from S3
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.782726)
[S15] loaded HEAD from S3 (vec_in norm=1.782726)
[S15] cosine check vs S3: cos=0.7913
[S15] BUFFERED delta from S3 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1800) from S13
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.800872)
[S15] loaded HEAD from S13 (vec_in norm=1.800872)
[S15] cosine check vs S13: cos=0.2607
[S15] BUFFERED delta from S13 (total buffered=2)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=21 metric=0.4047 head_norm=1.443813
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.561433e-01
[S7] stored merged vector for next round verification (round=21)
[S7] DEBUG after merge:  round=21 metric=0.4405 head_norm=1.271671 delta_norm=0.556143
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=21 metric=0.9971 head_norm=1.447386
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.288576e-02
[S9] stored merged vector for next round verification (round=21)
[S9] DEBUG after merge:  round=21 metric=0.9967 head_norm=1.437246 delta_norm=0.062886
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=21 metric=0.9945 head_norm=1.329771
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.132574e-01
[S10] stored merged vector for next round verification (round=21)
[S10] DEBUG after merge:  round=21 metric=0.9945 head_norm=1.293558 delta_norm=0.213257
[S10] aggregate: ACCEPT kept=['S2', 'S15'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=21 metric=0.9971 head_norm=1.182356
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.509485e-01
[S15] stored merged vector for next round verification (round=21)
[S15] DEBUG after merge:  round=21 metric=0.9971 head_norm=1.146661 delta_norm=0.450949
[S15] aggregate: ACCEPT kept=['S3', 'S13'] (k=2/2) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.947366 (no previous merge yet)
[S2] round=22 local utility u=0.153364 metrics={'f1_val': 0.6910225448336285, 'auprc': 0.7476704409793926, 'loss_val': 0.9827885213829156, 'psi': 0.713681703291934}-{'f1_val': 0.6592255101674979, 'auprc': 0.7282067924223131, 'loss_val': 1.0403430441310544, 'psi': 0.686818023069424}
[S3] START round=22 head_norm_before_train=1.782726 cos_to_last_merge=0.9997 (last merge round=20)
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9981125724633177, 'loss_val': 0.14796794106856775, 'psi': 0.9758900802249993}-{'f1_val': 0.9978100342676263, 'auprc': 0.9984806081354467, 'loss_val': 0.13131816043291403, 'psi': 0.9980782638147545}
[S4] START round=22 head_norm_before_train=1.705692 cos_to_last_merge=0.8473 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.847
[S4] round=22 local utility u=0.127162 metrics={'f1_val': 0.9430438667058629, 'auprc': 0.9675832740851533, 'loss_val': 0.28571222189351225, 'psi': 0.9528596296575791}-{'f1_val': 0.9275363495692017, 'auprc': 0.9398343126957325, 'loss_val': 0.3637451846366108, 'psi': 0.932455534819814}
[S5] START round=22 head_norm_before_train=1.429802 cos_to_last_merge=0.8138 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.814
[S5] round=22 local utility u=0.000000 metrics={'f1_val': 0.7049101749558733, 'auprc': 0.8143890527044007, 'loss_val': 0.30978685653375254, 'psi': 0.7487017260552842}-{'f1_val': 0.7006083926626743, 'auprc': 0.9955634353130983, 'loss_val': 0.28357994220969557, 'psi': 0.8185904097228439}
[S6] START round=22 head_norm_before_train=1.538571 cos_to_last_merge=0.9979 (last merge round=20)
[S6] round=22 local utility u=0.000000 metrics={'f1_val': 0.6934669689813009, 'auprc': 0.949933663625988, 'loss_val': 0.645315699383486, 'psi': 0.7960536468391757}-{'f1_val': 0.831945609626686, 'auprc': 0.9712174455549215, 'loss_val': 0.3728341980997376, 'psi': 0.8876543439979803}
[S7] START round=22 head_norm_before_train=1.271671 cos_to_last_merge=1.0000 (last merge round=21)
[S7] round=22 local utility u=0.725981 metrics={'f1_val': 0.5804158039640971, 'auprc': 0.7902809729402317, 'loss_val': 0.7187304319064078, 'psi': 0.664361871554551}-{'f1_val': 0.4047151019581253, 'auprc': 0.7726850538294726, 'loss_val': 1.06370127473176, 'psi': 0.5519030827066642}
[S8] START round=22 head_norm_before_train=1.764324 cos_to_last_merge=0.8164 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.816
[S8] round=22 local utility u=0.007555 metrics={'f1_val': 0.9938554489473111, 'auprc': 0.9979253190838996, 'loss_val': 0.03482982605333336, 'psi': 0.9954833970019465}-{'f1_val': 0.9918109678295097, 'auprc': 0.9982981364736908, 'loss_val': 0.038790977254143454, 'psi': 0.9944058352871822}
[S9] START round=22 head_norm_before_train=1.437246 cos_to_last_merge=1.0000 (last merge round=21)
[S9] round=22 local utility u=0.000000 metrics={'f1_val': 0.9941897064172326, 'auprc': 0.9981261184306347, 'loss_val': 0.10065773656697397, 'psi': 0.9957642712225935}-{'f1_val': 0.9971029125121428, 'auprc': 0.997911333201437, 'loss_val': 0.09860773083261443, 'psi': 0.9974262807878604}
[S10] START round=22 head_norm_before_train=1.293558 cos_to_last_merge=1.0000 (last merge round=21)
[S10] round=22 local utility u=0.005568 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9934835883981656, 'loss_val': 0.0743210094936473, 'psi': 0.9942426008908898}-{'f1_val': 0.9945291067983943, 'auprc': 0.994011097383484, 'loss_val': 0.08572303351082887, 'psi': 0.9943219030324302}
[S11] START round=22 head_norm_before_train=1.930603 (no previous merge yet)
[S11] round=22 local utility u=0.162764 metrics={'f1_val': 0.9963256330217796, 'auprc': 0.9986927551342053, 'loss_val': 0.03941655916610427, 'psi': 0.9972724818667499}-{'f1_val': 0.9568213683793463, 'auprc': 0.9985268535474898, 'loss_val': 0.12742226164901338, 'psi': 0.9735035624466037}
[S13] START round=22 head_norm_before_train=1.800872 (no previous merge yet)
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.542992378992634, 'auprc': 0.7021225257759643, 'loss_val': 0.9630262607565943, 'psi': 0.6066444377059661}-{'f1_val': 0.5808062060496141, 'auprc': 0.6879954011918357, 'loss_val': 0.7848491987330793, 'psi': 0.6236818841065027}
[S14] START round=22 head_norm_before_train=1.914488 (no previous merge yet)
[S14] round=22 local utility u=0.006204 metrics={'f1_val': 0.9968300801588782, 'auprc': 0.9975305215895003, 'loss_val': 0.03573038785546694, 'psi': 0.997110256731127}-{'f1_val': 0.9965872316107504, 'auprc': 0.9955443317749595, 'loss_val': 0.04072359762077529, 'psi': 0.996170071676434}
[S15] START round=22 head_norm_before_train=1.146661 cos_to_last_merge=1.0000 (last merge round=21)
[S15] round=22 local utility u=0.029958 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9985937972663166, 'loss_val': 0.152521826135199, 'psi': 0.997485519939039}-{'f1_val': 0.9971172535281002, 'auprc': 0.9985828339311807, 'loss_val': 0.21462931454811437, 'psi': 0.9977034856893324}
[S16] START round=22 head_norm_before_train=1.845959 (no previous merge yet)
[S16] round=22 local utility u=0.808522 metrics={'f1_val': 0.9407387645646319, 'auprc': 0.995457852000892, 'loss_val': 0.1594797496879829, 'psi': 0.962626399539136}-{'f1_val': 0.8441763215571326, 'auprc': 0.8582667172281481, 'loss_val': 0.7855765568335342, 'psi': 0.8498124798255389}
[S17] START round=22 head_norm_before_train=1.761587 cos_to_last_merge=0.8200 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.820
[S17] round=22 local utility u=1.000000 metrics={'f1_val': 0.6489548298522091, 'auprc': 0.9981798477682201, 'loss_val': 0.8915975959193689, 'psi': 0.7886448370186135}-{'f1_val': 0.3567952564433893, 'auprc': 0.699100992060018, 'loss_val': 1.8686395662206834, 'psi': 0.49371755069004075}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:39408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S11] → sending delta(kind=head bytes=1806) to S7@127.0.0.1:39408
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:39407
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:39403
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:39411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:39402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:39411
[S15] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1806 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1795) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.774677)
[S3] loaded HEAD from S8 (vec_in norm=1.774677)
[S3] cosine check vs S8: cos=0.9963
[S3] BUFFERED delta from S8 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1799) from S7
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.287463)
[S15] loaded HEAD from S7 (vec_in norm=1.287463)
[S15] cosine check vs S7: cos=0.5465
[S15] BUFFERED delta from S7 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1800) from S15
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.213707)
[S10] loaded HEAD from S15 (vec_in norm=1.213707)
[S10] cosine check vs S15: cos=0.5821
[S10] BUFFERED delta from S15 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1798) from S2
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.961318)
[S10] loaded HEAD from S2 (vec_in norm=1.961318)
[S10] cosine check vs S2: cos=0.8558
[S10] BUFFERED delta from S2 (total buffered=2)
[S7] RECEIVED delta(kind=head bytes=1806) from S11
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.952477)
[S7] loaded HEAD from S11 (vec_in norm=1.952477)
[S7] cosine check vs S11: cos=0.7179
[S7] BUFFERED delta from S11 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1804) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.377211)
[S7] loaded HEAD from S10 (vec_in norm=1.377211)
[S7] cosine check vs S10: cos=0.8867
[S7] BUFFERED delta from S10 (total buffered=2)
[S6] RECEIVED delta(kind=head bytes=1801) from S14
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.931797)
[S6] loaded HEAD from S14 (vec_in norm=1.931797)
[S6] cosine check vs S14: cos=0.9211
[S6] BUFFERED delta from S14 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1795) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.865446)
[S6] loaded HEAD from S16 (vec_in norm=1.865446)
[S6] cosine check vs S16: cos=0.3497
[S6] BUFFERED delta from S16 (total buffered=2)
[S2] RECEIVED delta(kind=head bytes=1802) from S4
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.716728)
[S2] loaded HEAD from S4 (vec_in norm=1.716728)
[S2] cosine check vs S4: cos=-0.0619
[S2] DROPPED delta from S4 (cos=-0.0619 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:39409
[S17] sending update (kind=head size=1797 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1797) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.779400)
[S8] loaded HEAD from S17 (vec_in norm=1.779400)
[S8] cosine check vs S17: cos=-0.0294
[S8] DROPPED delta from S17 (cos=-0.0294 < 0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=22 metric=0.9611 head_norm=1.811275
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.886783e-02
[S3] stored merged vector for next round verification (round=22)
[S3] DEBUG after merge:  round=22 metric=0.9611 head_norm=1.791334 delta_norm=0.078868
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=22 metric=0.6935 head_norm=1.577081
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.412961e-01
[S6] stored merged vector for next round verification (round=22)
[S6] DEBUG after merge:  round=22 metric=0.6790 head_norm=1.426181 delta_norm=0.341296
[S6] aggregate: ROLLBACK (f1_val pre=0.693 post=0.679 tol_abs=0.005 tol_rel=0.0)
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=22 metric=0.5804 head_norm=1.287463
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.891154e-01
[S7] stored merged vector for next round verification (round=22)
[S7] DEBUG after merge:  round=22 metric=0.5776 head_norm=1.313073 delta_norm=0.189115
[S7] aggregate: ACCEPT kept=['S11', 'S10'] (k=2/2) mode=median trim_p=0.1
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=22 metric=0.9947 head_norm=1.377211
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.700904e-01
[S10] stored merged vector for next round verification (round=22)
[S10] DEBUG after merge:  round=22 metric=0.9945 head_norm=1.292770 delta_norm=0.170090
[S10] aggregate: ACCEPT kept=['S15', 'S2'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=22 metric=0.9967 head_norm=1.213707
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.963823e-01
[S15] stored merged vector for next round verification (round=22)
[S15] DEBUG after merge:  round=22 metric=0.9967 head_norm=1.099841 delta_norm=0.596382
[S15] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.961318 (no previous merge yet)
[S2] round=23 local utility u=0.067012 metrics={'f1_val': 0.707673815477915, 'auprc': 0.7449424130451627, 'loss_val': 0.9404879491633755, 'psi': 0.722581254504814}-{'f1_val': 0.6910225448336285, 'auprc': 0.7476704409793926, 'loss_val': 0.9827885213829156, 'psi': 0.713681703291934}
[S3] START round=23 head_norm_before_train=1.791334 cos_to_last_merge=1.0000 (last merge round=22)
[S3] round=23 local utility u=0.000000 metrics={'f1_val': 0.9330020072855973, 'auprc': 0.9982556383697433, 'loss_val': 0.20773397895185394, 'psi': 0.9591034597192557}-{'f1_val': 0.9610750853994537, 'auprc': 0.9981125724633177, 'loss_val': 0.14796794106856775, 'psi': 0.9758900802249993}
[S4] START round=23 head_norm_before_train=1.716728 cos_to_last_merge=0.8464 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.846
[S4] round=23 local utility u=0.002772 metrics={'f1_val': 0.9434787341260065, 'auprc': 0.9662257020308358, 'loss_val': 0.27870397996993607, 'psi': 0.9525775212879382}-{'f1_val': 0.9430438667058629, 'auprc': 0.9675832740851533, 'loss_val': 0.28571222189351225, 'psi': 0.9528596296575791}
[S5] START round=23 head_norm_before_train=1.444810 cos_to_last_merge=0.8079 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.808
[S5] round=23 local utility u=0.077388 metrics={'f1_val': 0.7017989039197601, 'auprc': 0.8664906561490708, 'loss_val': 0.2926473239618274, 'psi': 0.7676756048114843}-{'f1_val': 0.7049101749558733, 'auprc': 0.8143890527044007, 'loss_val': 0.30978685653375254, 'psi': 0.7487017260552842}
[S6] START round=23 head_norm_before_train=1.426181 cos_to_last_merge=1.0000 (last merge round=22)
[S6] round=23 local utility u=0.593337 metrics={'f1_val': 0.8290609399814146, 'auprc': 0.9731429566012417, 'loss_val': 0.34183375768362195, 'psi': 0.8866937466293454}-{'f1_val': 0.6934669689813009, 'auprc': 0.949933663625988, 'loss_val': 0.645315699383486, 'psi': 0.7960536468391757}
[S7] START round=23 head_norm_before_train=1.313073 cos_to_last_merge=1.0000 (last merge round=22)
[S7] round=23 local utility u=0.259594 metrics={'f1_val': 0.6522627211378096, 'auprc': 0.7929484396171586, 'loss_val': 0.6386262568146889, 'psi': 0.7085370085295493}-{'f1_val': 0.5804158039640971, 'auprc': 0.7902809729402317, 'loss_val': 0.7187304319064078, 'psi': 0.664361871554551}
[S8] START round=23 head_norm_before_train=1.774677 cos_to_last_merge=0.8163 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.816
[S8] round=23 local utility u=0.000000 metrics={'f1_val': 0.9934464462379313, 'auprc': 0.9979788706705641, 'loss_val': 0.033775494886445524, 'psi': 0.9952594160109844}-{'f1_val': 0.9938554489473111, 'auprc': 0.9979253190838996, 'loss_val': 0.03482982605333336, 'psi': 0.9954833970019465}
[S9] START round=23 head_norm_before_train=1.463521 cos_to_last_merge=0.9996 (last merge round=21)
[S9] round=23 local utility u=0.015215 metrics={'f1_val': 0.9958601375429889, 'auprc': 0.9981202517718551, 'loss_val': 0.08023225107778195, 'psi': 0.9967641832345353}-{'f1_val': 0.9941897064172326, 'auprc': 0.9981261184306347, 'loss_val': 0.10065773656697397, 'psi': 0.9957642712225935}
[S10] START round=23 head_norm_before_train=1.292770 cos_to_last_merge=1.0000 (last merge round=22)
[S10] round=23 local utility u=0.000000 metrics={'f1_val': 0.9943096789853013, 'auprc': 0.9956380171528352, 'loss_val': 0.07874938206875973, 'psi': 0.9948410142523147}-{'f1_val': 0.9947486092193725, 'auprc': 0.9934835883981656, 'loss_val': 0.0743210094936473, 'psi': 0.9942426008908898}
[S11] START round=23 head_norm_before_train=1.952477 (no previous merge yet)
[S11] round=23 local utility u=0.001402 metrics={'f1_val': 0.9963256330217796, 'auprc': 0.9987798716766217, 'loss_val': 0.03687452679579049, 'psi': 0.9973073284837164}-{'f1_val': 0.9963256330217796, 'auprc': 0.9986927551342053, 'loss_val': 0.03941655916610427, 'psi': 0.9972724818667499}
[S13] START round=23 head_norm_before_train=1.811338 (no previous merge yet)
[S13] round=23 local utility u=0.241507 metrics={'f1_val': 0.5972748745000711, 'auprc': 0.6728867772297479, 'loss_val': 0.7180006933137955, 'psi': 0.6275196355919419}-{'f1_val': 0.542992378992634, 'auprc': 0.7021225257759643, 'loss_val': 0.9630262607565943, 'psi': 0.6066444377059661}
[S14] START round=23 head_norm_before_train=1.931797 (no previous merge yet)
[S14] round=23 local utility u=0.000000 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9970620009683141, 'loss_val': 0.03567242237959927, 'psi': 0.9967771393537759}-{'f1_val': 0.9968300801588782, 'auprc': 0.9975305215895003, 'loss_val': 0.03573038785546694, 'psi': 0.997110256731127}
[S15] START round=23 head_norm_before_train=1.099841 cos_to_last_merge=1.0000 (last merge round=22)
[S15] round=23 local utility u=0.002648 metrics={'f1_val': 0.9963164379542544, 'auprc': 0.9972432674477161, 'loss_val': 0.14059228110328548, 'psi': 0.9966871697516391}-{'f1_val': 0.9967466683875206, 'auprc': 0.9985937972663166, 'loss_val': 0.152521826135199, 'psi': 0.997485519939039}
[S16] START round=23 head_norm_before_train=1.865446 (no previous merge yet)
[S16] round=23 local utility u=0.000000 metrics={'f1_val': 0.8579021873724644, 'auprc': 0.9782050274581437, 'loss_val': 0.6123346438258888, 'psi': 0.9060233234067362}-{'f1_val': 0.9407387645646319, 'auprc': 0.995457852000892, 'loss_val': 0.1594797496879829, 'psi': 0.962626399539136}
[S17] START round=23 head_norm_before_train=1.779400 cos_to_last_merge=0.8189 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.819
[S17] round=23 local utility u=0.000000 metrics={'f1_val': 0.49627563448976963, 'auprc': 0.6896909974278079, 'loss_val': 1.4232277163754385, 'psi': 0.573641779664985}-{'f1_val': 0.6489548298522091, 'auprc': 0.9981798477682201, 'loss_val': 0.8915975959193689, 'psi': 0.7886448370186135}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:39410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:39411
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:39403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] → sending delta(kind=head bytes=1805) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:39415
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:39411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:39402
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:39408
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:39409
[S11] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1805 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1802) from S7
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.332079)
[S15] loaded HEAD from S7 (vec_in norm=1.332079)
[S15] cosine check vs S7: cos=0.8395
[S15] BUFFERED delta from S7 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1805) from S13
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.821670)
[S15] loaded HEAD from S13 (vec_in norm=1.821670)
[S15] cosine check vs S13: cos=0.4407
[S15] BUFFERED delta from S13 (total buffered=2)
[S3] RECEIVED delta(kind=head bytes=1803) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.489889)
[S3] loaded HEAD from S9 (vec_in norm=1.489889)
[S3] cosine check vs S9: cos=-0.0899
[S3] DROPPED delta from S9 (cos=-0.0899 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1800) from S15
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.184319)
[S10] loaded HEAD from S15 (vec_in norm=1.184319)
[S10] cosine check vs S15: cos=0.8074
[S10] BUFFERED delta from S15 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1799) from S2
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.976514)
[S10] loaded HEAD from S2 (vec_in norm=1.976514)
[S10] cosine check vs S2: cos=0.8677
[S10] BUFFERED delta from S2 (total buffered=2)
[S9] RECEIVED delta(kind=head bytes=1800) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.456247)
[S9] loaded HEAD from S5 (vec_in norm=1.456247)
[S9] cosine check vs S5: cos=0.9943
[S9] BUFFERED delta from S5 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1800) from S6
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.458756)
[S8] loaded HEAD from S6 (vec_in norm=1.458756)
[S8] cosine check vs S6: cos=-0.0467
[S8] DROPPED delta from S6 (cos=-0.0467 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1798) from S11
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.972362)
[S7] loaded HEAD from S11 (vec_in norm=1.972362)
[S7] cosine check vs S11: cos=0.8103
[S7] BUFFERED delta from S11 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1800) from S4
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.729528)
[S2] loaded HEAD from S4 (vec_in norm=1.729528)
[S2] cosine check vs S4: cos=-0.0631
[S2] DROPPED delta from S4 (cos=-0.0631 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=23 metric=0.9943 head_norm=1.369212
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.260157e-01
[S10] stored merged vector for next round verification (round=23)
[S10] DEBUG after merge:  round=23 metric=0.9941 head_norm=1.358202 delta_norm=0.126016
[S10] aggregate: ACCEPT kept=['S15', 'S2'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=23 metric=0.6523 head_norm=1.332079
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.930601e-01
[S7] stored merged vector for next round verification (round=23)
[S7] DEBUG after merge:  round=23 metric=0.6122 head_norm=1.574993 delta_norm=0.593060
[S7] aggregate: ROLLBACK (f1_val pre=0.652 post=0.612 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=23 metric=0.9963 head_norm=1.184319
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.965185e-01
[S15] stored merged vector for next round verification (round=23)
[S15] DEBUG after merge:  round=23 metric=0.9963 head_norm=1.137915 delta_norm=0.396518
[S15] aggregate: ACCEPT kept=['S7', 'S13'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=23 metric=0.9959 head_norm=1.489889
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.054252e-02
[S9] stored merged vector for next round verification (round=23)
[S9] DEBUG after merge:  round=23 metric=0.9959 head_norm=1.470961 delta_norm=0.080543
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.976514 (no previous merge yet)
[S2] round=24 local utility u=0.010480 metrics={'f1_val': 0.7187215262065241, 'auprc': 0.7411799117709119, 'loss_val': 0.9745274796143812, 'psi': 0.7277048804322792}-{'f1_val': 0.707673815477915, 'auprc': 0.7449424130451627, 'loss_val': 0.9404879491633755, 'psi': 0.722581254504814}
[S3] START round=24 head_norm_before_train=1.815881 cos_to_last_merge=0.9998 (last merge round=22)
[S3] round=24 local utility u=0.234100 metrics={'f1_val': 0.9936748943334078, 'auprc': 0.998216214146384, 'loss_val': 0.10345299748936185, 'psi': 0.9954914222585983}-{'f1_val': 0.9330020072855973, 'auprc': 0.9982556383697433, 'loss_val': 0.20773397895185394, 'psi': 0.9591034597192557}
[S4] START round=24 head_norm_before_train=1.729528 cos_to_last_merge=0.8455 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.845
[S4] round=24 local utility u=0.027007 metrics={'f1_val': 0.9472945873001036, 'auprc': 0.9732775267883572, 'loss_val': 0.26874081962796414, 'psi': 0.957687763095405}-{'f1_val': 0.9434787341260065, 'auprc': 0.9662257020308358, 'loss_val': 0.27870397996993607, 'psi': 0.9525775212879382}
[S5] START round=24 head_norm_before_train=1.456247 cos_to_last_merge=0.8038 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.804
[S5] round=24 local utility u=0.205919 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9980549506142415, 'loss_val': 0.268359739731659, 'psi': 0.8195870158433012}-{'f1_val': 0.7017989039197601, 'auprc': 0.8664906561490708, 'loss_val': 0.2926473239618274, 'psi': 0.7676756048114843}
[S6] START round=24 head_norm_before_train=1.458756 cos_to_last_merge=0.9989 (last merge round=22)
[S6] round=24 local utility u=0.000000 metrics={'f1_val': 0.8258926516052874, 'auprc': 0.9612276536824231, 'loss_val': 0.3614338185144792, 'psi': 0.8800266524361418}-{'f1_val': 0.8290609399814146, 'auprc': 0.9731429566012417, 'loss_val': 0.34183375768362195, 'psi': 0.8866937466293454}
[S7] START round=24 head_norm_before_train=1.574993 cos_to_last_merge=1.0000 (last merge round=23)
[S7] round=24 local utility u=0.000000 metrics={'f1_val': 0.5168835442677547, 'auprc': 0.7799581457997191, 'loss_val': 0.9269319297323863, 'psi': 0.6221133848805405}-{'f1_val': 0.6522627211378096, 'auprc': 0.7929484396171586, 'loss_val': 0.6386262568146889, 'psi': 0.7085370085295493}
[S8] START round=24 head_norm_before_train=1.786529 cos_to_last_merge=0.8152 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.815
[S8] round=24 local utility u=0.000000 metrics={'f1_val': 0.993122746315827, 'auprc': 0.9987805082881651, 'loss_val': 0.03591553446904655, 'psi': 0.9953858511047622}-{'f1_val': 0.9934464462379313, 'auprc': 0.9979788706705641, 'loss_val': 0.033775494886445524, 'psi': 0.9952594160109844}
[S9] START round=24 head_norm_before_train=1.470961 cos_to_last_merge=1.0000 (last merge round=23)
[S9] round=24 local utility u=0.000522 metrics={'f1_val': 0.9958601375429889, 'auprc': 0.9981265992611955, 'loss_val': 0.07920719461805387, 'psi': 0.9967667222302714}-{'f1_val': 0.9958601375429889, 'auprc': 0.9981202517718551, 'loss_val': 0.08023225107778195, 'psi': 0.9967641832345353}
[S10] START round=24 head_norm_before_train=1.358202 cos_to_last_merge=1.0000 (last merge round=23)
[S10] round=24 local utility u=0.003666 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9960515306621336, 'loss_val': 0.06820853976750348, 'psi': 0.9945614060840101}-{'f1_val': 0.9943096789853013, 'auprc': 0.9956380171528352, 'loss_val': 0.07874938206875973, 'psi': 0.9948410142523147}
[S11] START round=24 head_norm_before_train=1.972362 (no previous merge yet)
[S11] round=24 local utility u=0.000000 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9987215914333422, 'loss_val': 0.041491595384351564, 'psi': 0.9974291189570651}-{'f1_val': 0.9963256330217796, 'auprc': 0.9987798716766217, 'loss_val': 0.03687452679579049, 'psi': 0.9973073284837164}
[S13] START round=24 head_norm_before_train=1.821670 (no previous merge yet)
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.5719525943901563, 'auprc': 0.5697917507751656, 'loss_val': 1.1618338594983066, 'psi': 0.57108825694416}-{'f1_val': 0.5972748745000711, 'auprc': 0.6728867772297479, 'loss_val': 0.7180006933137955, 'psi': 0.6275196355919419}
[S14] START round=24 head_norm_before_train=1.947951 (no previous merge yet)
[S14] round=24 local utility u=0.000000 metrics={'f1_val': 0.9963442551067831, 'auprc': 0.9966242135848745, 'loss_val': 0.035967258608790874, 'psi': 0.9964562384980197}-{'f1_val': 0.9965872316107504, 'auprc': 0.9970620009683141, 'loss_val': 0.03567242237959927, 'psi': 0.9967771393537759}
[S15] START round=24 head_norm_before_train=1.137915 cos_to_last_merge=1.0000 (last merge round=23)
[S15] round=24 local utility u=0.000000 metrics={'f1_val': 0.9070198478666971, 'auprc': 0.9984923690459127, 'loss_val': 0.17326202810339453, 'psi': 0.9436088563383833}-{'f1_val': 0.9963164379542544, 'auprc': 0.9972432674477161, 'loss_val': 0.14059228110328548, 'psi': 0.9966871697516391}
[S16] START round=24 head_norm_before_train=1.879972 (no previous merge yet)
[S16] round=24 local utility u=0.134449 metrics={'f1_val': 0.8706721430385882, 'auprc': 0.9958884653626885, 'loss_val': 0.4731073037428755, 'psi': 0.9207586719682284}-{'f1_val': 0.8579021873724644, 'auprc': 0.9782050274581437, 'loss_val': 0.6123346438258888, 'psi': 0.9060233234067362}
[S17] START round=24 head_norm_before_train=1.794480 cos_to_last_merge=0.8177 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.818
[S17] round=24 local utility u=0.831787 metrics={'f1_val': 0.6252338283029364, 'auprc': 0.8797041615188627, 'loss_val': 1.1034430356973088, 'psi': 0.727021961589307}-{'f1_val': 0.49627563448976963, 'auprc': 0.6896909974278079, 'loss_val': 1.4232277163754385, 'psi': 0.573641779664985}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:39408
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:39407
[S2] not sending this round → trigger blocked (psi=0.728)
[S9] not sending this round → trigger blocked (psi=0.997)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.820)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.958)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:39415
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1802) from S3
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.842001)
[S15] loaded HEAD from S3 (vec_in norm=1.842001)
[S15] cosine check vs S3: cos=0.3620
[S15] BUFFERED delta from S3 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1803) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.424727)
[S7] loaded HEAD from S10 (vec_in norm=1.424727)
[S7] cosine check vs S10: cos=0.5232
[S7] BUFFERED delta from S10 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1800) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.897400)
[S6] loaded HEAD from S16 (vec_in norm=1.897400)
[S6] cosine check vs S16: cos=0.5324
[S6] BUFFERED delta from S16 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:39409
[S17] sending update (kind=head size=1798 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.804897)
[S8] loaded HEAD from S17 (vec_in norm=1.804897)
[S8] cosine check vs S17: cos=-0.0290
[S8] DROPPED delta from S17 (cos=-0.0290 < 0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=24 metric=0.8259 head_norm=1.492654
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.384963e-01
[S6] stored merged vector for next round verification (round=24)
[S6] DEBUG after merge:  round=24 metric=0.8241 head_norm=1.486942 delta_norm=0.838496
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=24 metric=0.5169 head_norm=1.590642
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.397006e-01
[S7] stored merged vector for next round verification (round=24)
[S7] DEBUG after merge:  round=24 metric=0.5471 head_norm=1.316373 delta_norm=0.739701
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=24 metric=0.9070 head_norm=1.210771
[S15] _apply_head_vector_avg (torch): Δ‖w‖=9.005827e-01
[S15] stored merged vector for next round verification (round=24)
[S15] DEBUG after merge:  round=24 metric=0.9034 head_norm=1.272171 delta_norm=0.900583
[S15] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.997699 (no previous merge yet)
[S2] round=25 local utility u=0.000000 metrics={'f1_val': 0.7057364521364089, 'auprc': 0.7489808141515936, 'loss_val': 0.9712699952698914, 'psi': 0.7230341969424827}-{'f1_val': 0.7187215262065241, 'auprc': 0.7411799117709119, 'loss_val': 0.9745274796143812, 'psi': 0.7277048804322792}
[S3] START round=25 head_norm_before_train=1.842001 cos_to_last_merge=0.9992 (last merge round=22)
[S3] round=25 local utility u=0.028199 metrics={'f1_val': 0.9976528558298854, 'auprc': 0.9985244941859748, 'loss_val': 0.07184704818960297, 'psi': 0.998001511172321}-{'f1_val': 0.9936748943334078, 'auprc': 0.998216214146384, 'loss_val': 0.10345299748936185, 'psi': 0.9954914222585983}
[S4] START round=25 head_norm_before_train=1.732615 cos_to_last_merge=0.8455 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.845
[S4] round=25 local utility u=0.000000 metrics={'f1_val': 0.9436451170196054, 'auprc': 0.9703678462822708, 'loss_val': 0.2815276880879883, 'psi': 0.9543342087246716}-{'f1_val': 0.9472945873001036, 'auprc': 0.9732775267883572, 'loss_val': 0.26874081962796414, 'psi': 0.957687763095405}
[S5] START round=25 head_norm_before_train=1.467984 cos_to_last_merge=0.7999 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.800
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.7191526519215716, 'auprc': 0.7936750831058178, 'loss_val': 0.37030929027887843, 'psi': 0.7489616243952701}-{'f1_val': 0.7006083926626743, 'auprc': 0.9980549506142415, 'loss_val': 0.268359739731659, 'psi': 0.8195870158433012}
[S6] START round=25 head_norm_before_train=1.486942 cos_to_last_merge=1.0000 (last merge round=24)
[S6] round=25 local utility u=0.000000 metrics={'f1_val': 0.8396625312064889, 'auprc': 0.9445341682328513, 'loss_val': 0.4052060284788061, 'psi': 0.8816111860170339}-{'f1_val': 0.8258926516052874, 'auprc': 0.9612276536824231, 'loss_val': 0.3614338185144792, 'psi': 0.8800266524361418}
[S7] START round=25 head_norm_before_train=1.316373 cos_to_last_merge=1.0000 (last merge round=24)
[S7] round=25 local utility u=0.000000 metrics={'f1_val': 0.504721526227355, 'auprc': 0.7810527477411058, 'loss_val': 0.8920269119056186, 'psi': 0.6152540148328554}-{'f1_val': 0.5168835442677547, 'auprc': 0.7799581457997191, 'loss_val': 0.9269319297323863, 'psi': 0.6221133848805405}
[S8] START round=25 head_norm_before_train=1.794515 cos_to_last_merge=0.8147 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.815
[S8] round=25 local utility u=0.000000 metrics={'f1_val': 0.9926368238932805, 'auprc': 0.9989041851730914, 'loss_val': 0.034923473387556525, 'psi': 0.9951437684052048}-{'f1_val': 0.993122746315827, 'auprc': 0.9987805082881651, 'loss_val': 0.03591553446904655, 'psi': 0.9953858511047622}
[S9] START round=25 head_norm_before_train=1.498246 cos_to_last_merge=0.9997 (last merge round=23)
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.9933536184876286, 'auprc': 0.998250020919136, 'loss_val': 0.0699081030458138, 'psi': 0.9953121794602315}-{'f1_val': 0.9958601375429889, 'auprc': 0.9981265992611955, 'loss_val': 0.07920719461805387, 'psi': 0.9967667222302714}
[S10] START round=25 head_norm_before_train=1.424727 cos_to_last_merge=0.9988 (last merge round=23)
[S10] round=25 local utility u=0.005322 metrics={'f1_val': 0.9940063275949004, 'auprc': 0.9943979456149793, 'loss_val': 0.05523395887820973, 'psi': 0.9941629748029319}-{'f1_val': 0.9935679896985945, 'auprc': 0.9960515306621336, 'loss_val': 0.06820853976750348, 'psi': 0.9945614060840101}
[S11] START round=25 head_norm_before_train=1.988690 (no previous merge yet)
[S11] round=25 local utility u=0.003788 metrics={'f1_val': 0.9963256330217796, 'auprc': 0.9987285702434813, 'loss_val': 0.032485953744785044, 'psi': 0.9972868079104602}-{'f1_val': 0.996567470639547, 'auprc': 0.9987215914333422, 'loss_val': 0.041491595384351564, 'psi': 0.9974291189570651}
[S13] START round=25 head_norm_before_train=1.833097 (no previous merge yet)
[S13] round=25 local utility u=0.202047 metrics={'f1_val': 0.5910951034611726, 'auprc': 0.6383079241363218, 'loss_val': 1.0781441170726072, 'psi': 0.6099802317312322}-{'f1_val': 0.5719525943901563, 'auprc': 0.5697917507751656, 'loss_val': 1.1618338594983066, 'psi': 0.57108825694416}
[S14] START round=25 head_norm_before_train=1.961869 (no previous merge yet)
[S14] round=25 local utility u=0.002132 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.995632143615494, 'loss_val': 0.032645906490930625, 'psi': 0.9964513623407967}-{'f1_val': 0.9963442551067831, 'auprc': 0.9966242135848745, 'loss_val': 0.035967258608790874, 'psi': 0.9964562384980197}
[S15] START round=25 head_norm_before_train=1.272171 cos_to_last_merge=1.0000 (last merge round=24)
[S15] round=25 local utility u=0.000000 metrics={'f1_val': 0.9041776514628593, 'auprc': 0.9979674643679126, 'loss_val': 0.19908774224628653, 'psi': 0.9416935766248806}-{'f1_val': 0.9070198478666971, 'auprc': 0.9984923690459127, 'loss_val': 0.17326202810339453, 'psi': 0.9436088563383833}
[S16] START round=25 head_norm_before_train=1.897400 (no previous merge yet)
[S16] round=25 local utility u=0.295341 metrics={'f1_val': 0.9268316606523437, 'auprc': 0.9972045898178219, 'loss_val': 0.22333127775547207, 'psi': 0.9549808323185349}-{'f1_val': 0.8706721430385882, 'auprc': 0.9958884653626885, 'loss_val': 0.4731073037428755, 'psi': 0.9207586719682284}
[S17] START round=25 head_norm_before_train=1.804897 cos_to_last_merge=0.8169 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.817
[S17] round=25 local utility u=0.361498 metrics={'f1_val': 0.647539996144804, 'auprc': 0.9984293260123702, 'loss_val': 0.8704589514920262, 'psi': 0.7878957280918304}-{'f1_val': 0.6252338283029364, 'auprc': 0.8797041615188627, 'loss_val': 1.1034430356973088, 'psi': 0.727021961589307}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:39408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:39407
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:39415
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:39408
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1796) from S3
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.867606)
[S15] loaded HEAD from S3 (vec_in norm=1.867606)
[S15] cosine check vs S3: cos=0.8806
[S15] BUFFERED delta from S3 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1803) from S13
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.838943)
[S15] loaded HEAD from S13 (vec_in norm=1.838943)
[S15] cosine check vs S13: cos=0.3490
[S15] BUFFERED delta from S13 (total buffered=2)
[S7] RECEIVED delta(kind=head bytes=1800) from S11
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=2.005931)
[S7] loaded HEAD from S11 (vec_in norm=2.005931)
[S7] cosine check vs S11: cos=0.7476
[S7] BUFFERED delta from S11 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1795) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.483723)
[S7] loaded HEAD from S10 (vec_in norm=1.483723)
[S7] cosine check vs S10: cos=0.8551
[S7] BUFFERED delta from S10 (total buffered=2)
[S6] RECEIVED delta(kind=head bytes=1802) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.914890)
[S6] loaded HEAD from S16 (vec_in norm=1.914890)
[S6] cosine check vs S16: cos=0.9011
[S6] BUFFERED delta from S16 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1797) from S14
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.975737)
[S6] loaded HEAD from S14 (vec_in norm=1.975737)
[S6] cosine check vs S14: cos=0.4200
[S6] BUFFERED delta from S14 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:39409
[S17] sending update (kind=head size=1805 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1805) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.815461)
[S8] loaded HEAD from S17 (vec_in norm=1.815461)
[S8] cosine check vs S17: cos=-0.0283
[S8] DROPPED delta from S17 (cos=-0.0283 < 0.0)
[S4] ⇄ pheromone p=0.082 → S2@127.0.0.1:39402
[S8] ⇄ pheromone p=0.015 → S3@127.0.0.1:39403
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=25 metric=0.5047 head_norm=1.333516
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.474897e-01
[S7] stored merged vector for next round verification (round=25)
[S7] DEBUG after merge:  round=25 metric=0.5032 head_norm=1.366585 delta_norm=0.147490
[S7] aggregate: ACCEPT kept=['S11', 'S10'] (k=2/2) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.197 → S15@127.0.0.1:39415
[S5] ⇄ pheromone p=0.089 → S9@127.0.0.1:39410
[S9] ⇄ pheromone p=0.043 → S3@127.0.0.1:39403
[S2] ⇄ pheromone p=0.121 → S10@127.0.0.1:39411
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=25 metric=0.8397 head_norm=1.515458
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.832328e-01
[S6] stored merged vector for next round verification (round=25)
[S6] DEBUG after merge:  round=25 metric=0.8435 head_norm=1.419989 delta_norm=0.283233
[S6] aggregate: ACCEPT kept=['S16', 'S14'] (k=2/2) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.115 → S8@127.0.0.1:39409
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=25 metric=0.9042 head_norm=1.329889
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.464966e-01
[S15] stored merged vector for next round verification (round=25)
[S15] DEBUG after merge:  round=25 metric=0.9047 head_norm=1.280771 delta_norm=0.346497
[S15] aggregate: ACCEPT kept=['S3', 'S13'] (k=2/2) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.066 → S10@127.0.0.1:39411
[S3] ⇄ pheromone p=0.143 → S15@127.0.0.1:39415
[S14] ⇄ pheromone p=0.034 → S6@127.0.0.1:39407
[S13] ⇄ pheromone p=0.108 → S15@127.0.0.1:39415
[S11] ⇄ pheromone p=0.041 → S7@127.0.0.1:39408
[S10] ⇄ pheromone p=0.026 → S7@127.0.0.1:39408
[S16] ⇄ pheromone p=0.256 → S6@127.0.0.1:39407
[S17] ⇄ pheromone p=0.364 → S8@127.0.0.1:39409
[S2] START round=26 head_norm_before_train=2.014876 (no previous merge yet)
[S2] round=26 local utility u=0.000000 metrics={'f1_val': 0.7216546626814174, 'auprc': 0.7430359349081462, 'loss_val': 1.048966857262685, 'psi': 0.730207171572109}-{'f1_val': 0.7057364521364089, 'auprc': 0.7489808141515936, 'loss_val': 0.9712699952698914, 'psi': 0.7230341969424827}
[S3] START round=26 head_norm_before_train=1.867606 cos_to_last_merge=0.9984 (last merge round=22)
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.960995754132836, 'auprc': 0.9979040414656506, 'loss_val': 0.1299275393133751, 'psi': 0.9757590690659619}-{'f1_val': 0.9976528558298854, 'auprc': 0.9985244941859748, 'loss_val': 0.07184704818960297, 'psi': 0.998001511172321}
[S4] START round=26 head_norm_before_train=1.746639 cos_to_last_merge=0.8441 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.844
[S4] round=26 local utility u=0.042897 metrics={'f1_val': 0.9528268500622374, 'auprc': 0.9754707656394906, 'loss_val': 0.26613344090780205, 'psi': 0.9618844162931387}-{'f1_val': 0.9436451170196054, 'auprc': 0.9703678462822708, 'loss_val': 0.2815276880879883, 'psi': 0.9543342087246716}
[S5] START round=26 head_norm_before_train=1.479436 cos_to_last_merge=0.7981 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.798
[S5] round=26 local utility u=0.309053 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9979670768260571, 'loss_val': 0.25381287698896576, 'psi': 0.8195518663280275}-{'f1_val': 0.7191526519215716, 'auprc': 0.7936750831058178, 'loss_val': 0.37030929027887843, 'psi': 0.7489616243952701}
[S6] START round=26 head_norm_before_train=1.419989 cos_to_last_merge=1.0000 (last merge round=25)
[S6] round=26 local utility u=0.000000 metrics={'f1_val': 0.8125454230108416, 'auprc': 0.947008023946785, 'loss_val': 0.47715902601510457, 'psi': 0.8663304633852189}-{'f1_val': 0.8396625312064889, 'auprc': 0.9445341682328513, 'loss_val': 0.4052060284788061, 'psi': 0.8816111860170339}
[S7] START round=26 head_norm_before_train=1.366585 cos_to_last_merge=1.0000 (last merge round=25)
[S7] round=26 local utility u=0.000000 metrics={'f1_val': 0.4802627125107417, 'auprc': 0.7801541458273297, 'loss_val': 0.9579602499728457, 'psi': 0.6002192858373769}-{'f1_val': 0.504721526227355, 'auprc': 0.7810527477411058, 'loss_val': 0.8920269119056186, 'psi': 0.6152540148328554}
[S8] START round=26 head_norm_before_train=1.805187 cos_to_last_merge=0.8139 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.814
[S8] round=26 local utility u=0.000963 metrics={'f1_val': 0.993122746315827, 'auprc': 0.9988072146813977, 'loss_val': 0.03562119717906186, 'psi': 0.9953965336620552}-{'f1_val': 0.9926368238932805, 'auprc': 0.9989041851730914, 'loss_val': 0.034923473387556525, 'psi': 0.9951437684052048}
[S9] START round=26 head_norm_before_train=1.525710 cos_to_last_merge=0.9987 (last merge round=23)
[S9] round=26 local utility u=0.014399 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.995374130129663, 'loss_val': 0.05497795880394328, 'psi': 0.9964113995591509}-{'f1_val': 0.9933536184876286, 'auprc': 0.998250020919136, 'loss_val': 0.0699081030458138, 'psi': 0.9953121794602315}
[S10] START round=26 head_norm_before_train=1.483723 cos_to_last_merge=0.9964 (last merge round=23)
[S10] round=26 local utility u=0.006283 metrics={'f1_val': 0.9940063275949004, 'auprc': 0.9960750387034704, 'loss_val': 0.047699380564180945, 'psi': 0.9948338120383284}-{'f1_val': 0.9940063275949004, 'auprc': 0.9943979456149793, 'loss_val': 0.05523395887820973, 'psi': 0.9941629748029319}
[S11] START round=26 head_norm_before_train=2.005931 (no previous merge yet)
[S11] round=26 local utility u=0.000000 metrics={'f1_val': 0.9965882633272201, 'auprc': 0.9987188906265343, 'loss_val': 0.03538080518183658, 'psi': 0.9974405142469457}-{'f1_val': 0.9963256330217796, 'auprc': 0.9987285702434813, 'loss_val': 0.032485953744785044, 'psi': 0.9972868079104602}
[S13] START round=26 head_norm_before_train=1.838943 (no previous merge yet)
[S13] round=26 local utility u=0.264392 metrics={'f1_val': 0.6019593020274576, 'auprc': 0.7281461245838114, 'loss_val': 0.884059681287089, 'psi': 0.6524340310499992}-{'f1_val': 0.5910951034611726, 'auprc': 0.6383079241363218, 'loss_val': 1.0781441170726072, 'psi': 0.6099802317312322}
[S14] START round=26 head_norm_before_train=1.975737 (no previous merge yet)
[S14] round=26 local utility u=0.005493 metrics={'f1_val': 0.9968300801588782, 'auprc': 0.9987586869318009, 'loss_val': 0.030035498891023492, 'psi': 0.9976015228680473}-{'f1_val': 0.9969975081576651, 'auprc': 0.995632143615494, 'loss_val': 0.032645906490930625, 'psi': 0.9964513623407967}
[S15] START round=26 head_norm_before_train=1.280771 cos_to_last_merge=1.0000 (last merge round=25)
[S15] round=26 local utility u=0.004343 metrics={'f1_val': 0.9036281862866441, 'auprc': 0.9979639972846281, 'loss_val': 0.18709413926437884, 'psi': 0.9413625106858378}-{'f1_val': 0.9041776514628593, 'auprc': 0.9979674643679126, 'loss_val': 0.19908774224628653, 'psi': 0.9416935766248806}
[S16] START round=26 head_norm_before_train=1.914890 (no previous merge yet)
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.8832991362587346, 'auprc': 0.9928845836620782, 'loss_val': 0.43018824604807576, 'psi': 0.927133315220072}-{'f1_val': 0.9268316606523437, 'auprc': 0.9972045898178219, 'loss_val': 0.22333127775547207, 'psi': 0.9549808323185349}
[S17] START round=26 head_norm_before_train=1.815461 cos_to_last_merge=0.8162 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.816
[S17] round=26 local utility u=0.000000 metrics={'f1_val': 0.6397186335380769, 'auprc': 0.9144506112399076, 'loss_val': 1.0170667064278072, 'psi': 0.7496114246188091}-{'f1_val': 0.647539996144804, 'auprc': 0.9984293260123702, 'loss_val': 0.8704589514920262, 'psi': 0.7878957280918304}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:39403
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:39403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] → sending delta(kind=head bytes=1805) to S9@127.0.0.1:39410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:39415
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:39408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:39402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:39411
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S14] → sending delta(kind=head bytes=1806) to S6@127.0.0.1:39407
[S10] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1806 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1805 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1802) from S13
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.846332)
[S15] loaded HEAD from S13 (vec_in norm=1.846332)
[S15] cosine check vs S13: cos=0.5507
[S15] BUFFERED delta from S13 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1801) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.814111)
[S3] loaded HEAD from S8 (vec_in norm=1.814111)
[S3] cosine check vs S8: cos=0.9938
[S3] BUFFERED delta from S8 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1803) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.550529)
[S3] loaded HEAD from S9 (vec_in norm=1.550529)
[S3] cosine check vs S9: cos=-0.0833
[S3] DROPPED delta from S9 (cos=-0.0833 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1802) from S15
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.331381)
[S10] loaded HEAD from S15 (vec_in norm=1.331381)
[S10] cosine check vs S15: cos=0.4397
[S10] BUFFERED delta from S15 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1805) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.491865)
[S9] loaded HEAD from S5 (vec_in norm=1.491865)
[S9] cosine check vs S5: cos=0.9923
[S9] BUFFERED delta from S5 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1800) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.531175)
[S7] loaded HEAD from S10 (vec_in norm=1.531175)
[S7] cosine check vs S10: cos=0.7965
[S7] BUFFERED delta from S10 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1806) from S14
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.990202)
[S6] loaded HEAD from S14 (vec_in norm=1.990202)
[S6] cosine check vs S14: cos=0.5702
[S6] BUFFERED delta from S14 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1803) from S4
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.759779)
[S2] loaded HEAD from S4 (vec_in norm=1.759779)
[S2] cosine check vs S4: cos=-0.0638
[S2] DROPPED delta from S4 (cos=-0.0638 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=26 metric=0.9610 head_norm=1.892214
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.106289e-01
[S3] stored merged vector for next round verification (round=26)
[S3] DEBUG after merge:  round=26 metric=0.9610 head_norm=1.850269 delta_norm=0.110629
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=26 metric=0.4803 head_norm=1.383169
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.700702e-01
[S7] stored merged vector for next round verification (round=26)
[S7] DEBUG after merge:  round=26 metric=0.5020 head_norm=1.381254 delta_norm=0.470070
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=26 metric=0.8125 head_norm=1.450058
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.325083e-01
[S6] stored merged vector for next round verification (round=26)
[S6] DEBUG after merge:  round=26 metric=0.8211 head_norm=1.529286 delta_norm=0.832508
[S6] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=26 metric=0.9036 head_norm=1.331381
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.864448e-01
[S15] stored merged vector for next round verification (round=26)
[S15] DEBUG after merge:  round=26 metric=0.9104 head_norm=1.404373 delta_norm=0.786445
[S15] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=26 metric=0.9971 head_norm=1.550529
[S9] _apply_head_vector_avg (torch): Δ‖w‖=9.900793e-02
[S9] stored merged vector for next round verification (round=26)
[S9] DEBUG after merge:  round=26 metric=0.9971 head_norm=1.518255 delta_norm=0.099008
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=26 metric=0.9940 head_norm=1.531175
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.622888e-01
[S10] stored merged vector for next round verification (round=26)
[S10] DEBUG after merge:  round=26 metric=0.9938 head_norm=1.215505 delta_norm=0.762289
[S10] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=2.031726 (no previous merge yet)
[S2] round=27 local utility u=0.000000 metrics={'f1_val': 0.7094060377894225, 'auprc': 0.7447651888606277, 'loss_val': 1.0011570004436532, 'psi': 0.7235496982179046}-{'f1_val': 0.7216546626814174, 'auprc': 0.7430359349081462, 'loss_val': 1.048966857262685, 'psi': 0.730207171572109}
[S3] START round=27 head_norm_before_train=1.850269 cos_to_last_merge=1.0000 (last merge round=26)
[S3] round=27 local utility u=0.000000 metrics={'f1_val': 0.960995754132836, 'auprc': 0.997951522708906, 'loss_val': 0.1314628162260777, 'psi': 0.9757780615632641}-{'f1_val': 0.960995754132836, 'auprc': 0.9979040414656506, 'loss_val': 0.1299275393133751, 'psi': 0.9757590690659619}
[S4] START round=27 head_norm_before_train=1.759779 cos_to_last_merge=0.8430 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.843
[S4] round=27 local utility u=0.000000 metrics={'f1_val': 0.9443766056342784, 'auprc': 0.9616768907291626, 'loss_val': 0.27975217289057225, 'psi': 0.9512967196722322}-{'f1_val': 0.9528268500622374, 'auprc': 0.9754707656394906, 'loss_val': 0.26613344090780205, 'psi': 0.9618844162931387}
[S5] START round=27 head_norm_before_train=1.491865 cos_to_last_merge=0.7987 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.799
[S5] round=27 local utility u=0.005274 metrics={'f1_val': 0.7006070944832098, 'auprc': 0.997940627657927, 'loss_val': 0.24317739149239065, 'psi': 0.8195405077530967}-{'f1_val': 0.7006083926626743, 'auprc': 0.9979670768260571, 'loss_val': 0.25381287698896576, 'psi': 0.8195518663280275}
[S6] START round=27 head_norm_before_train=1.529286 cos_to_last_merge=1.0000 (last merge round=26)
[S6] round=27 local utility u=0.000000 metrics={'f1_val': 0.6754008700246001, 'auprc': 0.9480255939238185, 'loss_val': 0.6438889226776513, 'psi': 0.7844507595842876}-{'f1_val': 0.8125454230108416, 'auprc': 0.947008023946785, 'loss_val': 0.47715902601510457, 'psi': 0.8663304633852189}
[S7] START round=27 head_norm_before_train=1.381254 cos_to_last_merge=1.0000 (last merge round=26)
[S7] round=27 local utility u=0.890206 metrics={'f1_val': 0.6757057675677023, 'auprc': 0.8343662857740719, 'loss_val': 0.5128425003212358, 'psi': 0.73916997485025}-{'f1_val': 0.4802627125107417, 'auprc': 0.7801541458273297, 'loss_val': 0.9579602499728457, 'psi': 0.6002192858373769}
[S8] START round=27 head_norm_before_train=1.814111 cos_to_last_merge=0.8134 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.813
[S8] round=27 local utility u=0.000000 metrics={'f1_val': 0.9898734612970058, 'auprc': 0.9864408183697317, 'loss_val': 0.05970230279463164, 'psi': 0.9885004041260962}-{'f1_val': 0.993122746315827, 'auprc': 0.9988072146813977, 'loss_val': 0.03562119717906186, 'psi': 0.9953965336620552}
[S9] START round=27 head_norm_before_train=1.518255 cos_to_last_merge=1.0000 (last merge round=26)
[S9] round=27 local utility u=0.000000 metrics={'f1_val': 0.994612880162602, 'auprc': 0.9982712398806256, 'loss_val': 0.06370155394383027, 'psi': 0.9960762240498114}-{'f1_val': 0.9971029125121428, 'auprc': 0.995374130129663, 'loss_val': 0.05497795880394328, 'psi': 0.9964113995591509}
[S10] START round=27 head_norm_before_train=1.215505 cos_to_last_merge=1.0000 (last merge round=26)
[S10] round=27 local utility u=0.000000 metrics={'f1_val': 0.9940903254969471, 'auprc': 0.9910029890406197, 'loss_val': 0.11952768272703093, 'psi': 0.9928553909144161}-{'f1_val': 0.9940063275949004, 'auprc': 0.9960750387034704, 'loss_val': 0.047699380564180945, 'psi': 0.9948338120383284}
[S11] START round=27 head_norm_before_train=2.020656 (no previous merge yet)
[S11] round=27 local utility u=0.001522 metrics={'f1_val': 0.9963500633431623, 'auprc': 0.998649760423381, 'loss_val': 0.03069991083094061, 'psi': 0.9972699421752498}-{'f1_val': 0.9965882633272201, 'auprc': 0.9987188906265343, 'loss_val': 0.03538080518183658, 'psi': 0.9974405142469457}
[S13] START round=27 head_norm_before_train=1.846332 (no previous merge yet)
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.5881795608804304, 'auprc': 0.693421227456797, 'loss_val': 1.1638710798510623, 'psi': 0.630276227510977}-{'f1_val': 0.6019593020274576, 'auprc': 0.7281461245838114, 'loss_val': 0.884059681287089, 'psi': 0.6524340310499992}
[S14] START round=27 head_norm_before_train=1.990202 (no previous merge yet)
[S14] round=27 local utility u=0.000179 metrics={'f1_val': 0.9968300801588782, 'auprc': 0.9987125712788733, 'loss_val': 0.02953908493574741, 'psi': 0.9975830766068762}-{'f1_val': 0.9968300801588782, 'auprc': 0.9987586869318009, 'loss_val': 0.030035498891023492, 'psi': 0.9976015228680473}
[S15] START round=27 head_norm_before_train=1.404373 cos_to_last_merge=1.0000 (last merge round=26)
[S15] round=27 local utility u=0.325483 metrics={'f1_val': 0.9971172535281002, 'auprc': 0.998876391083338, 'loss_val': 0.09979895451566496, 'psi': 0.9978209085501953}-{'f1_val': 0.9036281862866441, 'auprc': 0.9979639972846281, 'loss_val': 0.18709413926437884, 'psi': 0.9413625106858378}
[S16] START round=27 head_norm_before_train=1.928710 (no previous merge yet)
[S16] round=27 local utility u=0.000000 metrics={'f1_val': 0.8423827875745166, 'auprc': 0.9667674207098352, 'loss_val': 0.7812129229185193, 'psi': 0.8921366408286441}-{'f1_val': 0.8832991362587346, 'auprc': 0.9928845836620782, 'loss_val': 0.43018824604807576, 'psi': 0.927133315220072}
[S17] START round=27 head_norm_before_train=1.831449 cos_to_last_merge=0.8150 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.815
[S17] round=27 local utility u=0.156973 metrics={'f1_val': 0.646215417317845, 'auprc': 0.982481887245229, 'loss_val': 0.9461953809776404, 'psi': 0.7807220052887986}-{'f1_val': 0.6397186335380769, 'auprc': 0.9144506112399076, 'loss_val': 1.0170667064278072, 'psi': 0.7496114246188091}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:39408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S11@127.0.0.1:39412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1803) from S7
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.392487)
[S11] loaded HEAD from S7 (vec_in norm=1.392487)
[S11] cosine check vs S7: cos=0.5754
[S11] BUFFERED delta from S7 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1799) from S15
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.447381)
[S7] loaded HEAD from S15 (vec_in norm=1.447381)
[S7] cosine check vs S15: cos=0.3513
[S7] BUFFERED delta from S15 (total buffered=1)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=27 metric=0.9964 head_norm=2.035294
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.396055e-01
[S11] stored merged vector for next round verification (round=27)
[S11] DEBUG after merge:  round=27 metric=0.9964 head_norm=1.528327 delta_norm=0.839606
[S11] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=27 metric=0.6757 head_norm=1.392487
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.089796e-01
[S7] stored merged vector for next round verification (round=27)
[S7] DEBUG after merge:  round=27 metric=0.6865 head_norm=1.167270 delta_norm=0.808980
[S7] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=2.044216 (no previous merge yet)
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.6993236336904848, 'auprc': 0.7419607953514517, 'loss_val': 1.0435494821649374, 'psi': 0.7163784983548716}-{'f1_val': 0.7094060377894225, 'auprc': 0.7447651888606277, 'loss_val': 1.0011570004436532, 'psi': 0.7235496982179046}
[S3] START round=28 head_norm_before_train=1.873133 cos_to_last_merge=0.9999 (last merge round=26)
[S3] round=28 local utility u=0.152185 metrics={'f1_val': 0.9973982357793907, 'auprc': 0.9984159287086833, 'loss_val': 0.04690154030681036, 'psi': 0.9978053129511077}-{'f1_val': 0.960995754132836, 'auprc': 0.997951522708906, 'loss_val': 0.1314628162260777, 'psi': 0.9757780615632641}
[S4] START round=28 head_norm_before_train=1.776604 cos_to_last_merge=0.8415 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.841
[S4] round=28 local utility u=0.002786 metrics={'f1_val': 0.9466685346484506, 'auprc': 0.9587281983351479, 'loss_val': 0.2790849158450705, 'psi': 0.9514924001231295}-{'f1_val': 0.9443766056342784, 'auprc': 0.9616768907291626, 'loss_val': 0.27975217289057225, 'psi': 0.9512967196722322}
[S5] START round=28 head_norm_before_train=1.507909 cos_to_last_merge=0.7997 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.800
[S5] round=28 local utility u=0.000000 metrics={'f1_val': 0.7142032229273318, 'auprc': 0.8000663862184295, 'loss_val': 0.36403101181724773, 'psi': 0.748548488243771}-{'f1_val': 0.7006070944832098, 'auprc': 0.997940627657927, 'loss_val': 0.24317739149239065, 'psi': 0.8195405077530967}
[S6] START round=28 head_norm_before_train=1.561353 cos_to_last_merge=0.9980 (last merge round=26)
[S6] round=28 local utility u=0.465738 metrics={'f1_val': 0.7936655798260759, 'auprc': 0.9653404209346916, 'loss_val': 0.473946245904512, 'psi': 0.8623355162695221}-{'f1_val': 0.6754008700246001, 'auprc': 0.9480255939238185, 'loss_val': 0.6438889226776513, 'psi': 0.7844507595842876}
[S7] START round=28 head_norm_before_train=1.167270 cos_to_last_merge=1.0000 (last merge round=27)
[S7] round=28 local utility u=0.000000 metrics={'f1_val': 0.4568144131583294, 'auprc': 0.7749410080631843, 'loss_val': 0.8871279057106949, 'psi': 0.5840650511202714}-{'f1_val': 0.6757057675677023, 'auprc': 0.8343662857740719, 'loss_val': 0.5128425003212358, 'psi': 0.73916997485025}
[S8] START round=28 head_norm_before_train=1.823967 cos_to_last_merge=0.8137 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.814
[S8] round=28 local utility u=0.038225 metrics={'f1_val': 0.9924611780272952, 'auprc': 0.9986735347687925, 'loss_val': 0.03547685777826898, 'psi': 0.9949461207238941}-{'f1_val': 0.9898734612970058, 'auprc': 0.9864408183697317, 'loss_val': 0.05970230279463164, 'psi': 0.9885004041260962}
[S9] START round=28 head_norm_before_train=1.541241 cos_to_last_merge=0.9998 (last merge round=26)
[S9] round=28 local utility u=0.009497 metrics={'f1_val': 0.9958601375429889, 'auprc': 0.9985276162604584, 'loss_val': 0.05295940148228995, 'psi': 0.9969271290299766}-{'f1_val': 0.994612880162602, 'auprc': 0.9982712398806256, 'loss_val': 0.06370155394383027, 'psi': 0.9960762240498114}
[S10] START round=28 head_norm_before_train=1.287747 cos_to_last_merge=0.9974 (last merge round=26)
[S10] round=28 local utility u=0.025036 metrics={'f1_val': 0.9944449605296568, 'auprc': 0.9929682985700866, 'loss_val': 0.07747906055296325, 'psi': 0.9938542957458287}-{'f1_val': 0.9940903254969471, 'auprc': 0.9910029890406197, 'loss_val': 0.11952768272703093, 'psi': 0.9928553909144161}
[S11] START round=28 head_norm_before_train=1.528327 cos_to_last_merge=1.0000 (last merge round=27)
[S11] round=28 local utility u=0.000000 metrics={'f1_val': 0.9965919014202035, 'auprc': 0.9989345569583362, 'loss_val': 0.07375894385216619, 'psi': 0.9975289636354566}-{'f1_val': 0.9963500633431623, 'auprc': 0.998649760423381, 'loss_val': 0.03069991083094061, 'psi': 0.9972699421752498}
[S13] START round=28 head_norm_before_train=1.853538 (no previous merge yet)
[S13] round=28 local utility u=0.065304 metrics={'f1_val': 0.6059286415395617, 'auprc': 0.6233055971942919, 'loss_val': 0.9294100649362952, 'psi': 0.6128794238014538}-{'f1_val': 0.5881795608804304, 'auprc': 0.693421227456797, 'loss_val': 1.1638710798510623, 'psi': 0.630276227510977}
[S14] START round=28 head_norm_before_train=2.006875 (no previous merge yet)
[S14] round=28 local utility u=0.000000 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.996973909257575, 'loss_val': 0.030769179377404022, 'psi': 0.9967419026694802}-{'f1_val': 0.9968300801588782, 'auprc': 0.9987125712788733, 'loss_val': 0.02953908493574741, 'psi': 0.9975830766068762}
[S15] START round=28 head_norm_before_train=1.447381 cos_to_last_merge=0.9984 (last merge round=26)
[S15] round=28 local utility u=0.000000 metrics={'f1_val': 0.9030580232598932, 'auprc': 0.9978075976098788, 'loss_val': 0.1917897169196537, 'psi': 0.9409578529998874}-{'f1_val': 0.9971172535281002, 'auprc': 0.998876391083338, 'loss_val': 0.09979895451566496, 'psi': 0.9978209085501953}
[S16] START round=28 head_norm_before_train=1.942726 (no previous merge yet)
[S16] round=28 local utility u=0.478912 metrics={'f1_val': 0.9177987722594858, 'auprc': 0.9889592440682108, 'loss_val': 0.34245938348087124, 'psi': 0.9462629609829758}-{'f1_val': 0.8423827875745166, 'auprc': 0.9667674207098352, 'loss_val': 0.7812129229185193, 'psi': 0.8921366408286441}
[S17] START round=28 head_norm_before_train=1.846215 cos_to_last_merge=0.8140 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.814
[S17] round=28 local utility u=0.000000 metrics={'f1_val': 0.6149957327975151, 'auprc': 0.8942786885929692, 'loss_val': 1.1892542937738602, 'psi': 0.7267089151156967}-{'f1_val': 0.646215417317845, 'auprc': 0.982481887245229, 'loss_val': 0.9461953809776404, 'psi': 0.7807220052887986}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:39410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:39416
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:39405
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:39402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1804 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1799) from S3
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.894618)
[S9] loaded HEAD from S3 (vec_in norm=1.894618)
[S9] cosine check vs S3: cos=-0.0887
[S9] DROPPED delta from S3 (cos=-0.0887 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1801) from S9
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.563785)
[S5] loaded HEAD from S9 (vec_in norm=1.563785)
[S5] cosine check vs S9: cos=0.9945
[S5] BUFFERED delta from S9 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1804) from S6
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.599148)
[S16] loaded HEAD from S6 (vec_in norm=1.599148)
[S16] cosine check vs S6: cos=0.4073
[S16] BUFFERED delta from S6 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1802) from S10
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.379350)
[S2] loaded HEAD from S10 (vec_in norm=1.379350)
[S2] cosine check vs S10: cos=0.6315
[S2] BUFFERED delta from S10 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] sending update (kind=head size=1792 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:39417
[S8] sending update (kind=head size=1792 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1792) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.833712)
[S17] loaded HEAD from S8 (vec_in norm=1.833712)
[S17] cosine check vs S8: cos=-0.0267
[S17] DROPPED delta from S8 (cos=-0.0267 < 0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=28 metric=0.7142 head_norm=1.519785
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.343147e-02
[S5] stored merged vector for next round verification (round=28)
[S5] DEBUG after merge:  round=28 metric=0.7142 head_norm=1.539683 delta_norm=0.083431
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=28 metric=0.6993 head_norm=2.056127
[S2] _apply_head_vector_avg (torch): Δ‖w‖=7.981348e-01
[S2] stored merged vector for next round verification (round=28)
[S2] DEBUG after merge:  round=28 metric=0.6975 head_norm=1.558241 delta_norm=0.798135
[S2] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=28 metric=0.9178 head_norm=1.952873
[S16] _apply_head_vector_avg (torch): Δ‖w‖=9.781396e-01
[S16] stored merged vector for next round verification (round=28)
[S16] DEBUG after merge:  round=28 metric=0.9136 head_norm=1.492895 delta_norm=0.978140
[S16] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=1.558241 cos_to_last_merge=1.0000 (last merge round=28)
[S2] round=29 local utility u=0.086612 metrics={'f1_val': 0.6951945160517147, 'auprc': 0.7387087880447156, 'loss_val': 0.8357942943482785, 'psi': 0.712600224848915}-{'f1_val': 0.6993236336904848, 'auprc': 0.7419607953514517, 'loss_val': 1.0435494821649374, 'psi': 0.7163784983548716}
[S3] START round=29 head_norm_before_train=1.894618 cos_to_last_merge=0.9995 (last merge round=26)
[S3] round=29 local utility u=0.003242 metrics={'f1_val': 0.9973982357793907, 'auprc': 0.9985106825951751, 'loss_val': 0.040701732871850284, 'psi': 0.9978432145057045}-{'f1_val': 0.9973982357793907, 'auprc': 0.9984159287086833, 'loss_val': 0.04690154030681036, 'psi': 0.9978053129511077}
[S4] START round=29 head_norm_before_train=1.787687 cos_to_last_merge=0.8406 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.841
[S4] round=29 local utility u=0.002982 metrics={'f1_val': 0.9458049208617125, 'auprc': 0.9626858445872258, 'loss_val': 0.279812640392567, 'psi': 0.9525572903519179}-{'f1_val': 0.9466685346484506, 'auprc': 0.9587281983351479, 'loss_val': 0.2790849158450705, 'psi': 0.9514924001231295}
[S5] START round=29 head_norm_before_train=1.539683 cos_to_last_merge=1.0000 (last merge round=28)
[S5] round=29 local utility u=0.320828 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9979923601685183, 'loss_val': 0.23458327993234748, 'psi': 0.819561979665012}-{'f1_val': 0.7142032229273318, 'auprc': 0.8000663862184295, 'loss_val': 0.36403101181724773, 'psi': 0.748548488243771}
[S6] START round=29 head_norm_before_train=1.599148 cos_to_last_merge=0.9932 (last merge round=26)
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.6331910886348999, 'auprc': 0.9527348292948906, 'loss_val': 0.6833812337362221, 'psi': 0.7610085848988961}-{'f1_val': 0.7936655798260759, 'auprc': 0.9653404209346916, 'loss_val': 0.473946245904512, 'psi': 0.8623355162695221}
[S7] START round=29 head_norm_before_train=1.180674 cos_to_last_merge=0.9996 (last merge round=27)
[S7] round=29 local utility u=0.852803 metrics={'f1_val': 0.677100652464554, 'auprc': 0.8103755469478175, 'loss_val': 0.6095438871753855, 'psi': 0.7304106102578594}-{'f1_val': 0.4568144131583294, 'auprc': 0.7749410080631843, 'loss_val': 0.8871279057106949, 'psi': 0.5840650511202714}
[S8] START round=29 head_norm_before_train=1.833712 cos_to_last_merge=0.8130 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.813
[S8] round=29 local utility u=0.000000 metrics={'f1_val': 0.9867812170912436, 'auprc': 0.9956655471264111, 'loss_val': 0.04414072316019806, 'psi': 0.9903349491053106}-{'f1_val': 0.9924611780272952, 'auprc': 0.9986735347687925, 'loss_val': 0.03547685777826898, 'psi': 0.9949461207238941}
[S9] START round=29 head_norm_before_train=1.563785 cos_to_last_merge=0.9991 (last merge round=26)
[S9] round=29 local utility u=0.001352 metrics={'f1_val': 0.9958601375429889, 'auprc': 0.9981466671721979, 'loss_val': 0.049112250492147264, 'psi': 0.9967747493946724}-{'f1_val': 0.9958601375429889, 'auprc': 0.9985276162604584, 'loss_val': 0.05295940148228995, 'psi': 0.9969271290299766}
[S10] START round=29 head_norm_before_train=1.379350 cos_to_last_merge=0.9901 (last merge round=26)
[S10] round=29 local utility u=0.006922 metrics={'f1_val': 0.9931299445855843, 'auprc': 0.9946929645367696, 'loss_val': 0.060919388004530076, 'psi': 0.9937551525660585}-{'f1_val': 0.9944449605296568, 'auprc': 0.9929682985700866, 'loss_val': 0.07747906055296325, 'psi': 0.9938542957458287}
[S11] START round=29 head_norm_before_train=1.554191 cos_to_last_merge=0.9999 (last merge round=27)
[S11] round=29 local utility u=0.004313 metrics={'f1_val': 0.9963500633431623, 'auprc': 0.9988433731662495, 'loss_val': 0.06340821416161593, 'psi': 0.9973473872723972}-{'f1_val': 0.9965919014202035, 'auprc': 0.9989345569583362, 'loss_val': 0.07375894385216619, 'psi': 0.9975289636354566}
[S13] START round=29 head_norm_before_train=1.859117 (no previous merge yet)
[S13] round=29 local utility u=0.099053 metrics={'f1_val': 0.6013624533155516, 'auprc': 0.6912337130991895, 'loss_val': 0.9076913192345962, 'psi': 0.6373109572290068}-{'f1_val': 0.6059286415395617, 'auprc': 0.6233055971942919, 'loss_val': 0.9294100649362952, 'psi': 0.6128794238014538}
[S14] START round=29 head_norm_before_train=2.024282 (no previous merge yet)
[S14] round=29 local utility u=0.000279 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9969733323872851, 'loss_val': 0.030209821207722733, 'psi': 0.9967416719213642}-{'f1_val': 0.9965872316107504, 'auprc': 0.996973909257575, 'loss_val': 0.030769179377404022, 'psi': 0.9967419026694802}
[S15] START round=29 head_norm_before_train=1.483177 cos_to_last_merge=0.9954 (last merge round=26)
[S15] round=29 local utility u=0.349729 metrics={'f1_val': 0.9971172535281002, 'auprc': 0.9991701210276472, 'loss_val': 0.060775619275540066, 'psi': 0.997938400527919}-{'f1_val': 0.9030580232598932, 'auprc': 0.9978075976098788, 'loss_val': 0.1917897169196537, 'psi': 0.9409578529998874}
[S16] START round=29 head_norm_before_train=1.492895 cos_to_last_merge=1.0000 (last merge round=28)
[S16] round=29 local utility u=0.000000 metrics={'f1_val': 0.8351654318575552, 'auprc': 0.9787672299427633, 'loss_val': 0.45370543760538007, 'psi': 0.8926061510916385}-{'f1_val': 0.9177987722594858, 'auprc': 0.9889592440682108, 'loss_val': 0.34245938348087124, 'psi': 0.9462629609829758}
[S17] START round=29 head_norm_before_train=1.860342 cos_to_last_merge=0.8129 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.813
[S17] round=29 local utility u=1.000000 metrics={'f1_val': 0.851386580902369, 'auprc': 0.9390207228349442, 'loss_val': 0.4591877525952837, 'psi': 0.886440237675399}-{'f1_val': 0.6149957327975151, 'auprc': 0.8942786885929692, 'loss_val': 1.1892542937738602, 'psi': 0.7267089151156967}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:39410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:39402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:39405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:39404
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1801) from S2
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.603828)
[S4] loaded HEAD from S2 (vec_in norm=1.603828)
[S4] cosine check vs S2: cos=0.0042
[S4] BUFFERED delta from S2 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1798) from S9
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.582725)
[S5] loaded HEAD from S9 (vec_in norm=1.582725)
[S5] cosine check vs S9: cos=0.9978
[S5] BUFFERED delta from S9 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1797) from S10
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.454911)
[S2] loaded HEAD from S10 (vec_in norm=1.454911)
[S2] cosine check vs S10: cos=0.8599
[S2] BUFFERED delta from S10 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1796) from S3
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.915305)
[S9] loaded HEAD from S3 (vec_in norm=1.915305)
[S9] cosine check vs S3: cos=-0.0858
[S9] DROPPED delta from S3 (cos=-0.0858 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:39408
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1799) from S15
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.518111)
[S7] loaded HEAD from S15 (vec_in norm=1.518111)
[S7] cosine check vs S15: cos=0.8215
[S7] BUFFERED delta from S15 (total buffered=1)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:39412
[S7] sending update (kind=head size=1800 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1800) from S7
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.198622)
[S11] loaded HEAD from S7 (vec_in norm=1.198622)
[S11] cosine check vs S7: cos=0.6682
[S11] BUFFERED delta from S7 (total buffered=1)
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S2]  timeout peer S3
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S15]  timeout peer S2
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S16
[S10]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S15
[S6]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=29 metric=0.9458 head_norm=1.788935
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.198805e+00
[S4] stored merged vector for next round verification (round=29)
[S4] DEBUG after merge:  round=29 metric=0.9430 head_norm=1.203803 delta_norm=1.198805
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=29 metric=0.7006 head_norm=1.545509
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.527939e-02
[S5] stored merged vector for next round verification (round=29)
[S5] DEBUG after merge:  round=29 metric=0.7006 head_norm=1.563250 delta_norm=0.055279
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=29 metric=0.6952 head_norm=1.603828
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.111561e-01
[S2] stored merged vector for next round verification (round=29)
[S2] DEBUG after merge:  round=29 metric=0.6937 head_norm=1.474946 delta_norm=0.411156
[S2] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=29 metric=0.9964 head_norm=1.590428
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.955135e-01
[S11] stored merged vector for next round verification (round=29)
[S11] DEBUG after merge:  round=29 metric=0.9964 head_norm=1.276104 delta_norm=0.595513
[S11] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=29 metric=0.6771 head_norm=1.198622
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.335129e-01
[S7] stored merged vector for next round verification (round=29)
[S7] DEBUG after merge:  round=29 metric=0.6865 head_norm=1.297206 delta_norm=0.433513
[S7] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=1.474946 cos_to_last_merge=1.0000 (last merge round=29)
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.6417041518427071, 'auprc': 0.7427497063654571, 'loss_val': 0.9343699295628339, 'psi': 0.6821223736518072}-{'f1_val': 0.6951945160517147, 'auprc': 0.7387087880447156, 'loss_val': 0.8357942943482785, 'psi': 0.712600224848915}
[S3] START round=30 head_norm_before_train=1.915305 cos_to_last_merge=0.9990 (last merge round=26)
[S3] round=30 local utility u=0.000000 metrics={'f1_val': 0.9932252906909314, 'auprc': 0.9982691414283561, 'loss_val': 0.043568008253416085, 'psi': 0.9952428309859013}-{'f1_val': 0.9973982357793907, 'auprc': 0.9985106825951751, 'loss_val': 0.040701732871850284, 'psi': 0.9978432145057045}
[S4] START round=30 head_norm_before_train=1.203803 cos_to_last_merge=1.0000 (last merge round=29)
[S4] round=30 local utility u=0.000000 metrics={'f1_val': 0.9390273169590112, 'auprc': 0.9402573115747772, 'loss_val': 0.32198172864540425, 'psi': 0.9395193148053176}-{'f1_val': 0.9458049208617125, 'auprc': 0.9626858445872258, 'loss_val': 0.279812640392567, 'psi': 0.9525572903519179}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=30 head_norm_before_train=1.563250 cos_to_last_merge=1.0000 (last merge round=29)
[S5] round=30 local utility u=0.000000 metrics={'f1_val': 0.714400588689728, 'auprc': 0.793564537505735, 'loss_val': 0.39208871304194265, 'psi': 0.7460661682161308}-{'f1_val': 0.7006083926626743, 'auprc': 0.9979923601685183, 'loss_val': 0.23458327993234748, 'psi': 0.819561979665012}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=30 head_norm_before_train=1.638028 cos_to_last_merge=0.9889 (last merge round=26)
[S6] round=30 local utility u=1.000000 metrics={'f1_val': 0.8953576625986741, 'auprc': 0.9866057942964712, 'loss_val': 0.21647600390204025, 'psi': 0.9318569152777929}-{'f1_val': 0.6331910886348999, 'auprc': 0.9527348292948906, 'loss_val': 0.6833812337362221, 'psi': 0.7610085848988961}
[S7] START round=30 head_norm_before_train=1.297206 cos_to_last_merge=1.0000 (last merge round=29)
[S7] round=30 local utility u=0.000000 metrics={'f1_val': 0.4574861728531901, 'auprc': 0.7560782908077908, 'loss_val': 0.8807477955655146, 'psi': 0.5769230200350304}-{'f1_val': 0.677100652464554, 'auprc': 0.8103755469478175, 'loss_val': 0.6095438871753855, 'psi': 0.7304106102578594}
[S8] START round=30 head_norm_before_train=1.847619 cos_to_last_merge=0.8111 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.811
[S8] round=30 local utility u=0.027856 metrics={'f1_val': 0.9929361822751569, 'auprc': 0.9986223533912135, 'loss_val': 0.03422992083450278, 'psi': 0.9952106507215795}-{'f1_val': 0.9867812170912436, 'auprc': 0.9956655471264111, 'loss_val': 0.04414072316019806, 'psi': 0.9903349491053106}
[S9] START round=30 head_norm_before_train=1.582725 cos_to_last_merge=0.9984 (last merge round=26)
[S9] round=30 local utility u=0.007613 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9985283408871971, 'loss_val': 0.04248845540078819, 'psi': 0.9976730838621646}-{'f1_val': 0.9958601375429889, 'auprc': 0.9981466671721979, 'loss_val': 0.049112250492147264, 'psi': 0.9967747493946724}
[S10] START round=30 head_norm_before_train=1.454911 cos_to_last_merge=0.9833 (last merge round=26)
[S10] round=30 local utility u=0.006310 metrics={'f1_val': 0.992869746824563, 'auprc': 0.9968081292320046, 'loss_val': 0.05308466910531303, 'psi': 0.9944450997875396}-{'f1_val': 0.9931299445855843, 'auprc': 0.9946929645367696, 'loss_val': 0.060919388004530076, 'psi': 0.9937551525660585}
[S11] START round=30 head_norm_before_train=1.276104 cos_to_last_merge=1.0000 (last merge round=29)
[S11] round=30 local utility u=0.000000 metrics={'f1_val': 0.9963256330217796, 'auprc': 0.9987454889225967, 'loss_val': 0.12671159737033888, 'psi': 0.9972935753821064}-{'f1_val': 0.9963500633431623, 'auprc': 0.9988433731662495, 'loss_val': 0.06340821416161593, 'psi': 0.9973473872723972}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=30 head_norm_before_train=1.861276 (no previous merge yet)
[S13] round=30 local utility u=0.222643 metrics={'f1_val': 0.6817636623812343, 'auprc': 0.717383110975693, 'loss_val': 1.023259968996121, 'psi': 0.6960114418190178}-{'f1_val': 0.6013624533155516, 'auprc': 0.6912337130991895, 'loss_val': 0.9076913192345962, 'psi': 0.6373109572290068}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=30 head_norm_before_train=2.033161 (no previous merge yet)
[S14] round=30 local utility u=0.000352 metrics={'f1_val': 0.9964202860937709, 'auprc': 0.9970602144545656, 'loss_val': 0.028764461320564972, 'psi': 0.9966762574380887}-{'f1_val': 0.9965872316107504, 'auprc': 0.9969733323872851, 'loss_val': 0.030209821207722733, 'psi': 0.9967416719213642}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=30 head_norm_before_train=1.518111 cos_to_last_merge=0.9922 (last merge round=26)
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.9963164379542544, 'auprc': 0.9982084861323128, 'loss_val': 0.057459243025121925, 'psi': 0.9970732572254778}-{'f1_val': 0.9971172535281002, 'auprc': 0.9991701210276472, 'loss_val': 0.060775619275540066, 'psi': 0.997938400527919}
[S16] START round=30 head_norm_before_train=1.518072 cos_to_last_merge=0.9998 (last merge round=28)
[S16] round=30 local utility u=0.482657 metrics={'f1_val': 0.9420372215730396, 'auprc': 0.9932825532406943, 'loss_val': 0.17316898066749364, 'psi': 0.9625353542401014}-{'f1_val': 0.8351654318575552, 'auprc': 0.9787672299427633, 'loss_val': 0.45370543760538007, 'psi': 0.8926061510916385}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=30 head_norm_before_train=1.873512 cos_to_last_merge=0.8118 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.812
[S17] round=30 local utility u=0.000000 metrics={'f1_val': 0.6390975680685015, 'auprc': 0.959760398696637, 'loss_val': 1.1833832514792089, 'psi': 0.7673627003197556}-{'f1_val': 0.851386580902369, 'auprc': 0.9390207228349442, 'loss_val': 0.4591877525952837, 'psi': 0.886440237675399}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:39405
[S2] ⇄ pheromone p=0.054 → S4@127.0.0.1:39404
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:39416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:39417
[S9] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:39402
[S5] RECEIVED delta(kind=head bytes=1803) from S9
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.600856)
[S5] loaded HEAD from S9 (vec_in norm=1.600856)
[S5] cosine check vs S9: cos=0.9989
[S5] BUFFERED delta from S9 (total buffered=1)
[S8] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S9] ⇄ pheromone p=0.018 → S5@127.0.0.1:39405
[S10] sending update (kind=head size=1797 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1797) from S10
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.512604)
[S2] loaded HEAD from S10 (vec_in norm=1.512604)
[S2] cosine check vs S10: cos=0.9505
[S2] BUFFERED delta from S10 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1796) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.857144)
[S17] loaded HEAD from S8 (vec_in norm=1.857144)
[S17] cosine check vs S8: cos=-0.0278
[S17] DROPPED delta from S8 (cos=-0.0278 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1796) from S6
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.666680)
[S16] loaded HEAD from S6 (vec_in norm=1.666680)
[S16] cosine check vs S6: cos=0.7940
[S16] BUFFERED delta from S6 (total buffered=1)
[S8] ⇄ pheromone p=0.015 → S17@127.0.0.1:39417
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] ⇄ pheromone p=0.015 → S2@127.0.0.1:39402
[S6] ⇄ pheromone p=0.297 → S16@127.0.0.1:39416
[S3] CommDone barrier timeout: have=0 need=1 — continuing
[S3] ⇄ pheromone p=0.067 → S9@127.0.0.1:39410
[S7] CommDone barrier timeout: have=0 need=1 — continuing
[S7] ⇄ pheromone p=0.292 → S11@127.0.0.1:39412
[S15] RoundReady barrier timeout: have=1 need=2 — continuing
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9]  timeout peer S5
[S10]  timeout peer S2
[S10]  timeout peer S15
[S2]  timeout peer S4
[S7]  timeout peer S10
[S7]  timeout peer S11
[S8]  timeout peer S6
[S8]  timeout peer S17
[S3]  timeout peer S8
[S3]  timeout peer S9
[S6]  timeout peer S14
[S6]  timeout peer S16
[S15]  timeout peer S3
[S15]  timeout peer S7
[S15]  timeout peer S13
[S2] START round=31 head_norm_before_train=1.551772 cos_to_last_merge=0.9982 (last merge round=29)
[S2] round=31 local utility u=0.051538 metrics={'f1_val': 0.6603719955138715, 'auprc': 0.7457004674136193, 'loss_val': 0.9521542320675951, 'psi': 0.6945033842737707}-{'f1_val': 0.6417041518427071, 'auprc': 0.7427497063654571, 'loss_val': 0.9343699295628339, 'psi': 0.6821223736518072}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S2] sending update (kind=head size=1791 to 1 peers)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=31 metric=0.6604 head_norm=1.635175
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.852911e-01
[S2] stored merged vector for next round verification (round=31)
[S2] DEBUG after merge:  round=31 metric=0.6515 head_norm=1.549030 delta_norm=0.285291
[S2] aggregate: ROLLBACK (f1_val pre=0.660 post=0.651 tol_abs=0.005 tol_rel=0.0)
[S3] START round=31 head_norm_before_train=1.934687 cos_to_last_merge=0.9985 (last merge round=26)
[S3] round=31 local utility u=0.000000 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9980297130037616, 'loss_val': 0.14129491325042176, 'psi': 0.9758569364411769}-{'f1_val': 0.9932252906909314, 'auprc': 0.9982691414283561, 'loss_val': 0.043568008253416085, 'psi': 0.9952428309859013}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=31 head_norm_before_train=1.246981 cos_to_last_merge=0.9987 (last merge round=29)
[S4] round=31 local utility u=0.088892 metrics={'f1_val': 0.947763085527466, 'auprc': 0.9617018068527328, 'loss_val': 0.26094610911363847, 'psi': 0.9533385740575727}-{'f1_val': 0.9390273169590112, 'auprc': 0.9402573115747772, 'loss_val': 0.32198172864540425, 'psi': 0.9395193148053176}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=31 head_norm_before_train=1.568278 cos_to_last_merge=1.0000 (last merge round=29)
[S5] round=31 local utility u=0.357860 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9978838593101701, 'loss_val': 0.2065731520189866, 'psi': 0.8195185793216726}-{'f1_val': 0.714400588689728, 'auprc': 0.793564537505735, 'loss_val': 0.39208871304194265, 'psi': 0.7460661682161308}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=31 metric=0.7006 head_norm=1.576310
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.118486e-02
[S5] stored merged vector for next round verification (round=31)
[S5] DEBUG after merge:  round=31 metric=0.7006 head_norm=1.588096 delta_norm=0.041185
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S6] START round=31 head_norm_before_train=1.666680 cos_to_last_merge=0.9861 (last merge round=26)
[S6] round=31 local utility u=0.000000 metrics={'f1_val': 0.598745599577917, 'auprc': 0.7254058984522394, 'loss_val': 1.0757567170170255, 'psi': 0.6494097191276459}-{'f1_val': 0.8953576625986741, 'auprc': 0.9866057942964712, 'loss_val': 0.21647600390204025, 'psi': 0.9318569152777929}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=31 head_norm_before_train=1.312995 cos_to_last_merge=0.9991 (last merge round=29)
[S7] round=31 local utility u=1.000000 metrics={'f1_val': 0.6841429939059664, 'auprc': 0.8869637434884371, 'loss_val': 0.5589634312831384, 'psi': 0.7652712937389547}-{'f1_val': 0.4574861728531901, 'auprc': 0.7560782908077908, 'loss_val': 0.8807477955655146, 'psi': 0.5769230200350304}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=31 head_norm_before_train=1.857144 cos_to_last_merge=0.8104 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.810
[S8] round=31 local utility u=0.000490 metrics={'f1_val': 0.9928938724649488, 'auprc': 0.9987118946010752, 'loss_val': 0.03326522639184849, 'psi': 0.9952210813193993}-{'f1_val': 0.9929361822751569, 'auprc': 0.9986223533912135, 'loss_val': 0.03422992083450278, 'psi': 0.9952106507215795}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=31 head_norm_before_train=1.600856 cos_to_last_merge=0.9975 (last merge round=26)
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.9946069829493691, 'auprc': 0.9985560205434371, 'loss_val': 0.042569957342169965, 'psi': 0.9961865979869963}-{'f1_val': 0.9971029125121428, 'auprc': 0.9985283408871971, 'loss_val': 0.04248845540078819, 'psi': 0.9976730838621646}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=31 head_norm_before_train=1.512604 cos_to_last_merge=0.9779 (last merge round=26)
[S10] round=31 local utility u=0.003878 metrics={'f1_val': 0.9940903254969471, 'auprc': 0.993666586215305, 'loss_val': 0.043227442210386324, 'psi': 0.9939208297842903}-{'f1_val': 0.992869746824563, 'auprc': 0.9968081292320046, 'loss_val': 0.05308466910531303, 'psi': 0.9944450997875396}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=31 head_norm_before_train=1.333902 cos_to_last_merge=0.9984 (last merge round=29)
[S11] round=31 local utility u=0.017394 metrics={'f1_val': 0.9963256330217796, 'auprc': 0.9984824522931961, 'loss_val': 0.09113472522904884, 'psi': 0.9971883607303462}-{'f1_val': 0.9963256330217796, 'auprc': 0.9987454889225967, 'loss_val': 0.12671159737033888, 'psi': 0.9972935753821064}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] sending update (kind=head size=1805 to 1 peers)
[S13] START round=31 head_norm_before_train=1.871034 (no previous merge yet)
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.6359319971519264, 'auprc': 0.6495073670999734, 'loss_val': 0.8910572978942887, 'psi': 0.6413621451311451}-{'f1_val': 0.6817636623812343, 'auprc': 0.717383110975693, 'loss_val': 1.023259968996121, 'psi': 0.6960114418190178}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=31 head_norm_before_train=2.040862 (no previous merge yet)
[S14] round=31 local utility u=0.006119 metrics={'f1_val': 0.997050791983753, 'auprc': 0.998671936179355, 'loss_val': 0.025145298801648355, 'psi': 0.9976992496619937}-{'f1_val': 0.9964202860937709, 'auprc': 0.9970602144545656, 'loss_val': 0.028764461320564972, 'psi': 0.9966762574380887}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] sending update (kind=head size=1805 to 1 peers)
[S15] START round=31 head_norm_before_train=1.549604 cos_to_last_merge=0.9893 (last merge round=26)
[S15] round=31 local utility u=0.000000 metrics={'f1_val': 0.9082574443353278, 'auprc': 0.9983367423324812, 'loss_val': 0.12000577907446199, 'psi': 0.9442891635341892}-{'f1_val': 0.9963164379542544, 'auprc': 0.9982084861323128, 'loss_val': 0.057459243025121925, 'psi': 0.9970732572254778}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=31 head_norm_before_train=1.556495 cos_to_last_merge=0.9992 (last merge round=28)
[S16] round=31 local utility u=0.000000 metrics={'f1_val': 0.9149535477236909, 'auprc': 0.9930516327039589, 'loss_val': 0.3594944436010377, 'psi': 0.9461927817157981}-{'f1_val': 0.9420372215730396, 'auprc': 0.9932825532406943, 'loss_val': 0.17316898066749364, 'psi': 0.9625353542401014}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=31 metric=0.9150 head_norm=1.600103
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.377349e-01
[S16] stored merged vector for next round verification (round=31)
[S16] DEBUG after merge:  round=31 metric=0.9122 head_norm=1.542698 delta_norm=0.537735
[S16] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S17] START round=31 head_norm_before_train=1.885557 cos_to_last_merge=0.8110 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.811
[S17] round=31 local utility u=1.000000 metrics={'f1_val': 0.8468906237390887, 'auprc': 0.9849593744354103, 'loss_val': 0.4644315301230324, 'psi': 0.9021181240176173}-{'f1_val': 0.6390975680685015, 'auprc': 0.959760398696637, 'loss_val': 1.1833832514792089, 'psi': 0.7673627003197556}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=32 head_norm_before_train=1.549030 cos_to_last_merge=1.0000 (last merge round=31)
[S2] round=32 local utility u=0.159572 metrics={'f1_val': 0.6936144236862671, 'auprc': 0.7370319844961036, 'loss_val': 0.8064590627326781, 'psi': 0.7109814480102017}-{'f1_val': 0.6603719955138715, 'auprc': 0.7457004674136193, 'loss_val': 0.9521542320675951, 'psi': 0.6945033842737707}
[S2] not sending this round → trigger blocked (psi=0.711)
[S3] START round=32 head_norm_before_train=1.951825 cos_to_last_merge=0.9979 (last merge round=26)
[S3] round=32 local utility u=0.065269 metrics={'f1_val': 0.9724549131111073, 'auprc': 0.9981437173574429, 'loss_val': 0.07937846186764573, 'psi': 0.9827304348096415}-{'f1_val': 0.9610750853994537, 'auprc': 0.9980297130037616, 'loss_val': 0.14129491325042176, 'psi': 0.9758569364411769}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=32 head_norm_before_train=1.337926 cos_to_last_merge=0.9915 (last merge round=29)
[S4] round=32 local utility u=0.000000 metrics={'f1_val': 0.9437786894931034, 'auprc': 0.9679175363105795, 'loss_val': 0.2588618956575822, 'psi': 0.9534342282200938}-{'f1_val': 0.947763085527466, 'auprc': 0.9617018068527328, 'loss_val': 0.26094610911363847, 'psi': 0.9533385740575727}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=32 head_norm_before_train=1.588096 cos_to_last_merge=1.0000 (last merge round=31)
[S5] round=32 local utility u=0.000000 metrics={'f1_val': 0.7145982412546548, 'auprc': 0.7931646479846557, 'loss_val': 0.46069296426416606, 'psi': 0.7460248039466552}-{'f1_val': 0.7006083926626743, 'auprc': 0.9978838593101701, 'loss_val': 0.2065731520189866, 'psi': 0.8195185793216726}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=32 head_norm_before_train=1.685876 cos_to_last_merge=0.9846 (last merge round=26)
[S6] round=32 local utility u=1.000000 metrics={'f1_val': 0.9770595838040724, 'auprc': 0.987700992093853, 'loss_val': 0.12131955621643518, 'psi': 0.9813161471199847}-{'f1_val': 0.598745599577917, 'auprc': 0.7254058984522394, 'loss_val': 1.0757567170170255, 'psi': 0.6494097191276459}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] START round=32 head_norm_before_train=1.330064 cos_to_last_merge=0.9969 (last merge round=29)
[S7] round=32 local utility u=0.000000 metrics={'f1_val': 0.5675329398785472, 'auprc': 0.7867557209115688, 'loss_val': 0.7401147350287204, 'psi': 0.6552220522917559}-{'f1_val': 0.6841429939059664, 'auprc': 0.8869637434884371, 'loss_val': 0.5589634312831384, 'psi': 0.7652712937389547}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=32 head_norm_before_train=1.864813 cos_to_last_merge=0.8103 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.810
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.9939009886418481, 'auprc': 0.9973950705708899, 'loss_val': 0.03807530836946326, 'psi': 0.9952986214134648}-{'f1_val': 0.9928938724649488, 'auprc': 0.9987118946010752, 'loss_val': 0.03326522639184849, 'psi': 0.9952210813193993}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=32 head_norm_before_train=1.617528 cos_to_last_merge=0.9966 (last merge round=26)
[S9] round=32 local utility u=0.001729 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9936728594229168, 'loss_val': 0.03697556687340766, 'psi': 0.995484638528024}-{'f1_val': 0.9946069829493691, 'auprc': 0.9985560205434371, 'loss_val': 0.042569957342169965, 'psi': 0.9961865979869963}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=32 head_norm_before_train=1.556590 cos_to_last_merge=0.9738 (last merge round=26)
[S10] round=32 local utility u=0.002743 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.992263851717679, 'loss_val': 0.040119293393140035, 'psi': 0.9940182440986964}-{'f1_val': 0.9940903254969471, 'auprc': 0.993666586215305, 'loss_val': 0.043227442210386324, 'psi': 0.9939208297842903}
[S10] not sending this round → trigger blocked (psi=0.994)
[S11] START round=32 head_norm_before_train=1.404993 cos_to_last_merge=0.9939 (last merge round=29)
[S11] round=32 local utility u=0.011427 metrics={'f1_val': 0.9963256330217796, 'auprc': 0.9983746524838459, 'loss_val': 0.0679580946398775, 'psi': 0.9971452408066062}-{'f1_val': 0.9963256330217796, 'auprc': 0.9984824522931961, 'loss_val': 0.09113472522904884, 'psi': 0.9971883607303462}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=32 head_norm_before_train=1.883656 (no previous merge yet)
[S13] round=32 local utility u=0.322373 metrics={'f1_val': 0.7155710042125187, 'auprc': 0.6972726321745236, 'loss_val': 0.867441764688058, 'psi': 0.7082516553973206}-{'f1_val': 0.6359319971519264, 'auprc': 0.6495073670999734, 'loss_val': 0.8910572978942887, 'psi': 0.6413621451311451}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=32 head_norm_before_train=2.052228 (no previous merge yet)
[S14] round=32 local utility u=0.000000 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9962217553256694, 'loss_val': 0.027614819466369046, 'psi': 0.9966872070248668}-{'f1_val': 0.997050791983753, 'auprc': 0.998671936179355, 'loss_val': 0.025145298801648355, 'psi': 0.9976992496619937}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=32 head_norm_before_train=1.577217 cos_to_last_merge=0.9868 (last merge round=26)
[S15] round=32 local utility u=0.000000 metrics={'f1_val': 0.9023580338722137, 'auprc': 0.9980565989305021, 'loss_val': 0.15011424363592926, 'psi': 0.9406374598955292}-{'f1_val': 0.9082574443353278, 'auprc': 0.9983367423324812, 'loss_val': 0.12000577907446199, 'psi': 0.9442891635341892}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=32 head_norm_before_train=1.542698 cos_to_last_merge=1.0000 (last merge round=31)
[S16] round=32 local utility u=0.000000 metrics={'f1_val': 0.8514066815572281, 'auprc': 0.9966916034220873, 'loss_val': 0.622415333485102, 'psi': 0.9095206503031718}-{'f1_val': 0.9149535477236909, 'auprc': 0.9930516327039589, 'loss_val': 0.3594944436010377, 'psi': 0.9461927817157981}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=32 head_norm_before_train=1.896058 cos_to_last_merge=0.8102 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.810
[S17] round=32 local utility u=0.000000 metrics={'f1_val': 0.607572745768642, 'auprc': 0.9354708347259357, 'loss_val': 1.3375354178400873, 'psi': 0.7387319813515595}-{'f1_val': 0.8468906237390887, 'auprc': 0.9849593744354103, 'loss_val': 0.4644315301230324, 'psi': 0.9021181240176173}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=33 head_norm_before_train=1.634565 cos_to_last_merge=0.9984 (last merge round=31)
[S2] round=33 local utility u=0.013719 metrics={'f1_val': 0.7002262637286036, 'auprc': 0.7437198395894997, 'loss_val': 0.8387565252017424, 'psi': 0.7176236940729621}-{'f1_val': 0.6936144236862671, 'auprc': 0.7370319844961036, 'loss_val': 0.8064590627326781, 'psi': 0.7109814480102017}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=33 head_norm_before_train=1.967957 cos_to_last_merge=0.9973 (last merge round=26)
[S3] round=33 local utility u=0.095379 metrics={'f1_val': 0.9974271292865575, 'auprc': 0.9983466348647223, 'loss_val': 0.03906332380051039, 'psi': 0.9977949315178235}-{'f1_val': 0.9724549131111073, 'auprc': 0.9981437173574429, 'loss_val': 0.07937846186764573, 'psi': 0.9827304348096415}
[S3] not sending this round → trigger blocked (psi=0.998)
[S4] START round=33 head_norm_before_train=1.437945 cos_to_last_merge=0.9806 (last merge round=29)
[S4] round=33 local utility u=0.041627 metrics={'f1_val': 0.9530752464483853, 'auprc': 0.9745135502905387, 'loss_val': 0.25117604078669165, 'psi': 0.9616505679852467}-{'f1_val': 0.9437786894931034, 'auprc': 0.9679175363105795, 'loss_val': 0.2588618956575822, 'psi': 0.9534342282200938}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=33 head_norm_before_train=1.598448 cos_to_last_merge=1.0000 (last merge round=31)
[S5] round=33 local utility u=0.663845 metrics={'f1_val': 0.8099731729628773, 'auprc': 0.97090106801414, 'loss_val': 0.23846193844417118, 'psi': 0.8743443309833824}-{'f1_val': 0.7145982412546548, 'auprc': 0.7931646479846557, 'loss_val': 0.46069296426416606, 'psi': 0.7460248039466552}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=33 head_norm_before_train=1.701477 cos_to_last_merge=0.9835 (last merge round=26)
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.7056146806952537, 'auprc': 0.9129683621743887, 'loss_val': 0.8191021021572938, 'psi': 0.7885561532869076}-{'f1_val': 0.9770595838040724, 'auprc': 0.987700992093853, 'loss_val': 0.12131955621643518, 'psi': 0.9813161471199847}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=33 head_norm_before_train=1.348134 cos_to_last_merge=0.9938 (last merge round=29)
[S7] round=33 local utility u=0.008190 metrics={'f1_val': 0.5676568902669995, 'auprc': 0.7882594492803866, 'loss_val': 0.7289888160864102, 'psi': 0.6558979138723544}-{'f1_val': 0.5675329398785472, 'auprc': 0.7867557209115688, 'loss_val': 0.7401147350287204, 'psi': 0.6552220522917559}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=33 head_norm_before_train=1.873584 cos_to_last_merge=0.8100 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.810
[S8] round=33 local utility u=0.004204 metrics={'f1_val': 0.9940342119076258, 'auprc': 0.9987023039240123, 'loss_val': 0.03438932500316314, 'psi': 0.9959014487141803}-{'f1_val': 0.9939009886418481, 'auprc': 0.9973950705708899, 'loss_val': 0.03807530836946326, 'psi': 0.9952986214134648}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=33 head_norm_before_train=1.633616 cos_to_last_merge=0.9957 (last merge round=26)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.9946069829493691, 'auprc': 0.9982550422087876, 'loss_val': 0.03907151998993102, 'psi': 0.9960662066531365}-{'f1_val': 0.9966924912647621, 'auprc': 0.9936728594229168, 'loss_val': 0.03697556687340766, 'psi': 0.995484638528024}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=33 head_norm_before_train=1.589655 cos_to_last_merge=0.9709 (last merge round=26)
[S10] round=33 local utility u=0.003879 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9937550098847798, 'loss_val': 0.03683408930441029, 'psi': 0.9946147073655367}-{'f1_val': 0.9951878390193748, 'auprc': 0.992263851717679, 'loss_val': 0.040119293393140035, 'psi': 0.9940182440986964}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] sending update (kind=head size=1804 to 1 peers)
[S11] START round=33 head_norm_before_train=1.472880 cos_to_last_merge=0.9888 (last merge round=29)
[S11] round=33 local utility u=0.006397 metrics={'f1_val': 0.9963256330217796, 'auprc': 0.9981651143188985, 'loss_val': 0.054535750223558166, 'psi': 0.9970614255406272}-{'f1_val': 0.9963256330217796, 'auprc': 0.9983746524838459, 'loss_val': 0.0679580946398775, 'psi': 0.9971452408066062}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] START round=33 head_norm_before_train=1.893780 (no previous merge yet)
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.7042612404763224, 'auprc': 0.6750604136062192, 'loss_val': 0.9750440142246631, 'psi': 0.6925809097282811}-{'f1_val': 0.7155710042125187, 'auprc': 0.6972726321745236, 'loss_val': 0.867441764688058, 'psi': 0.7082516553973206}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=33 head_norm_before_train=2.063450 (no previous merge yet)
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9955398464743197, 'loss_val': 0.029058459732697852, 'psi': 0.996414443484327}-{'f1_val': 0.9969975081576651, 'auprc': 0.9962217553256694, 'loss_val': 0.027614819466369046, 'psi': 0.9966872070248668}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=33 head_norm_before_train=1.602077 cos_to_last_merge=0.9844 (last merge round=26)
[S15] round=33 local utility u=0.341130 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.998490788582521, 'loss_val': 0.035487788071797886, 'psi': 0.9974443164655208}-{'f1_val': 0.9023580338722137, 'auprc': 0.9980565989305021, 'loss_val': 0.15011424363592926, 'psi': 0.9406374598955292}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=33 head_norm_before_train=1.589729 cos_to_last_merge=0.9991 (last merge round=31)
[S16] round=33 local utility u=0.295756 metrics={'f1_val': 0.90558363506339, 'auprc': 0.9974742846141954, 'loss_val': 0.3583128709067638, 'psi': 0.9423398948837122}-{'f1_val': 0.8514066815572281, 'auprc': 0.9966916034220873, 'loss_val': 0.622415333485102, 'psi': 0.9095206503031718}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S16] sending update (kind=head size=1806 to 1 peers)
[S17] START round=33 head_norm_before_train=1.909654 cos_to_last_merge=0.8092 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.809
[S17] round=33 local utility u=0.681729 metrics={'f1_val': 0.7256826494961028, 'auprc': 0.963031925807168, 'loss_val': 0.7654208546238858, 'psi': 0.8206223600205289}-{'f1_val': 0.607572745768642, 'auprc': 0.9354708347259357, 'loss_val': 1.3375354178400873, 'psi': 0.7387319813515595}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=34 head_norm_before_train=1.708105 cos_to_last_merge=0.9951 (last merge round=31)
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.6917769069633659, 'auprc': 0.7527638194689489, 'loss_val': 0.9602772595024527, 'psi': 0.716171671965599}-{'f1_val': 0.7002262637286036, 'auprc': 0.7437198395894997, 'loss_val': 0.8387565252017424, 'psi': 0.7176236940729621}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=34 head_norm_before_train=1.982868 cos_to_last_merge=0.9968 (last merge round=26)
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.9959418785045752, 'auprc': 0.9983012282934881, 'loss_val': 0.05104987686986616, 'psi': 0.9968856184201405}-{'f1_val': 0.9974271292865575, 'auprc': 0.9983466348647223, 'loss_val': 0.03906332380051039, 'psi': 0.9977949315178235}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=34 head_norm_before_train=1.512737 cos_to_last_merge=0.9720 (last merge round=29)
[S4] round=34 local utility u=0.000000 metrics={'f1_val': 0.9412954244905305, 'auprc': 0.9519330354201916, 'loss_val': 0.2829112147547059, 'psi': 0.9455504688623949}-{'f1_val': 0.9530752464483853, 'auprc': 0.9745135502905387, 'loss_val': 0.25117604078669165, 'psi': 0.9616505679852467}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=34 head_norm_before_train=1.606876 cos_to_last_merge=0.9999 (last merge round=31)
[S5] round=34 local utility u=0.636488 metrics={'f1_val': 0.9967731002659072, 'auprc': 0.9977323037165184, 'loss_val': 0.16677930366382182, 'psi': 0.9971567816461517}-{'f1_val': 0.8099731729628773, 'auprc': 0.97090106801414, 'loss_val': 0.23846193844417118, 'psi': 0.8743443309833824}
[S5] not sending this round → trigger blocked (psi=0.997)
[S6] START round=34 head_norm_before_train=1.718232 cos_to_last_merge=0.9817 (last merge round=26)
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.5693499583041659, 'auprc': 0.7763412070133393, 'loss_val': 0.7633892066948874, 'psi': 0.6521464577878353}-{'f1_val': 0.7056146806952537, 'auprc': 0.9129683621743887, 'loss_val': 0.8191021021572938, 'psi': 0.7885561532869076}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=34 head_norm_before_train=1.369458 cos_to_last_merge=0.9899 (last merge round=29)
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.5301655298389407, 'auprc': 0.7778938918260749, 'loss_val': 0.8569754292872399, 'psi': 0.6292568746337944}-{'f1_val': 0.5676568902669995, 'auprc': 0.7882594492803866, 'loss_val': 0.7289888160864102, 'psi': 0.6558979138723544}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=34 head_norm_before_train=1.882262 cos_to_last_merge=0.8100 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.810
[S8] round=34 local utility u=0.000876 metrics={'f1_val': 0.9938554489473111, 'auprc': 0.9989848548690605, 'loss_val': 0.03241325315873188, 'psi': 0.9959072113160109}-{'f1_val': 0.9940342119076258, 'auprc': 0.9987023039240123, 'loss_val': 0.03438932500316314, 'psi': 0.9959014487141803}
[S8] not sending this round → trigger blocked (psi=0.996)
[S9] START round=34 head_norm_before_train=1.648907 cos_to_last_merge=0.9947 (last merge round=26)
[S9] round=34 local utility u=0.008995 metrics={'f1_val': 0.9962748907591257, 'auprc': 0.9987594948044798, 'loss_val': 0.03260197255301309, 'psi': 0.9972687323772673}-{'f1_val': 0.9946069829493691, 'auprc': 0.9982550422087876, 'loss_val': 0.03907151998993102, 'psi': 0.9960662066531365}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=34 head_norm_before_train=1.619275 cos_to_last_merge=0.9682 (last merge round=26)
[S10] round=34 local utility u=0.006167 metrics={'f1_val': 0.9952985899745774, 'auprc': 0.9963857118822005, 'loss_val': 0.03305708825345689, 'psi': 0.9957334387376267}-{'f1_val': 0.9951878390193748, 'auprc': 0.9937550098847798, 'loss_val': 0.03683408930441029, 'psi': 0.9946147073655367}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=34 head_norm_before_train=1.535608 cos_to_last_merge=0.9840 (last merge round=29)
[S11] round=34 local utility u=0.004467 metrics={'f1_val': 0.9963256330217796, 'auprc': 0.9981966419097652, 'loss_val': 0.04569602996378238, 'psi': 0.9970740365769739}-{'f1_val': 0.9963256330217796, 'auprc': 0.9981651143188985, 'loss_val': 0.054535750223558166, 'psi': 0.9970614255406272}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=34 head_norm_before_train=1.903180 (no previous merge yet)
[S13] round=34 local utility u=0.000000 metrics={'f1_val': 0.6344108666907409, 'auprc': 0.6413096284704227, 'loss_val': 1.0644182913788207, 'psi': 0.6371703714026136}-{'f1_val': 0.7042612404763224, 'auprc': 0.6750604136062192, 'loss_val': 0.9750440142246631, 'psi': 0.6925809097282811}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=34 head_norm_before_train=2.070098 (no previous merge yet)
[S14] round=34 local utility u=0.002581 metrics={'f1_val': 0.9963671647723179, 'auprc': 0.9971148678796447, 'loss_val': 0.02483920214992901, 'psi': 0.9966662460152487}-{'f1_val': 0.9969975081576651, 'auprc': 0.9955398464743197, 'loss_val': 0.029058459732697852, 'psi': 0.996414443484327}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=34 head_norm_before_train=1.626240 cos_to_last_merge=0.9822 (last merge round=26)
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.9971172535281002, 'auprc': 0.9988234840829864, 'loss_val': 0.04572737032561305, 'psi': 0.9977997457500547}-{'f1_val': 0.9967466683875206, 'auprc': 0.998490788582521, 'loss_val': 0.035487788071797886, 'psi': 0.9974443164655208}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=34 head_norm_before_train=1.643266 cos_to_last_merge=0.9966 (last merge round=31)
[S16] round=34 local utility u=0.000000 metrics={'f1_val': 0.8993987495046252, 'auprc': 0.9924550965946385, 'loss_val': 0.40880369758182383, 'psi': 0.9366212883406305}-{'f1_val': 0.90558363506339, 'auprc': 0.9974742846141954, 'loss_val': 0.3583128709067638, 'psi': 0.9423398948837122}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=34 head_norm_before_train=1.920375 cos_to_last_merge=0.8084 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.808
[S17] round=34 local utility u=0.000000 metrics={'f1_val': 0.6163482627130697, 'auprc': 0.9546496574266466, 'loss_val': 1.3650385102307656, 'psi': 0.7516688205985005}-{'f1_val': 0.7256826494961028, 'auprc': 0.963031925807168, 'loss_val': 0.7654208546238858, 'psi': 0.8206223600205289}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=35 head_norm_before_train=1.770201 cos_to_last_merge=0.9917 (last merge round=31)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.6950075703887004, 'auprc': 0.7413840925551449, 'loss_val': 1.0085386630184532, 'psi': 0.7135581792552783}-{'f1_val': 0.6917769069633659, 'auprc': 0.7527638194689489, 'loss_val': 0.9602772595024527, 'psi': 0.716171671965599}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=35 head_norm_before_train=1.997510 cos_to_last_merge=0.9963 (last merge round=26)
[S3] round=35 local utility u=0.015625 metrics={'f1_val': 0.9973982357793907, 'auprc': 0.9983288283983988, 'loss_val': 0.028621024000520152, 'psi': 0.9977704728269939}-{'f1_val': 0.9959418785045752, 'auprc': 0.9983012282934881, 'loss_val': 0.05104987686986616, 'psi': 0.9968856184201405}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=35 head_norm_before_train=1.555432 cos_to_last_merge=0.9674 (last merge round=29)
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.9159851285059059, 'auprc': 0.9238175221352659, 'loss_val': 0.3684615845684094, 'psi': 0.9191180859576499}-{'f1_val': 0.9412954244905305, 'auprc': 0.9519330354201916, 'loss_val': 0.2829112147547059, 'psi': 0.9455504688623949}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=35 head_norm_before_train=1.613431 cos_to_last_merge=0.9996 (last merge round=31)
[S5] round=35 local utility u=0.000000 metrics={'f1_val': 0.7146647020320098, 'auprc': 0.7945553489648917, 'loss_val': 0.48268444206844546, 'psi': 0.7466209608051626}-{'f1_val': 0.9967731002659072, 'auprc': 0.9977323037165184, 'loss_val': 0.16677930366382182, 'psi': 0.9971567816461517}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=35 head_norm_before_train=1.735329 cos_to_last_merge=0.9801 (last merge round=26)
[S6] round=35 local utility u=1.000000 metrics={'f1_val': 0.8320887335095217, 'auprc': 0.9596211011201309, 'loss_val': 0.37336489573504456, 'psi': 0.8831016805537655}-{'f1_val': 0.5693499583041659, 'auprc': 0.7763412070133393, 'loss_val': 0.7633892066948874, 'psi': 0.6521464577878353}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=35 head_norm_before_train=1.388253 cos_to_last_merge=0.9863 (last merge round=29)
[S7] round=35 local utility u=0.653483 metrics={'f1_val': 0.6777079332112483, 'auprc': 0.8048704346627952, 'loss_val': 0.516192523842153, 'psi': 0.7285729337918672}-{'f1_val': 0.5301655298389407, 'auprc': 0.7778938918260749, 'loss_val': 0.8569754292872399, 'psi': 0.6292568746337944}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=35 head_norm_before_train=1.889609 cos_to_last_merge=0.8085 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.809
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.9923167377520978, 'auprc': 0.9993149205370229, 'loss_val': 0.03261643554186267, 'psi': 0.9951160108660679}-{'f1_val': 0.9938554489473111, 'auprc': 0.9989848548690605, 'loss_val': 0.03241325315873188, 'psi': 0.9959072113160109}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=35 head_norm_before_train=1.662345 cos_to_last_merge=0.9937 (last merge round=26)
[S9] round=35 local utility u=0.004195 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9990943823079178, 'loss_val': 0.030185022528300832, 'psi': 0.9978995004304528}-{'f1_val': 0.9962748907591257, 'auprc': 0.9987594948044798, 'loss_val': 0.03260197255301309, 'psi': 0.9972687323772673}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=35 head_norm_before_train=1.642263 cos_to_last_merge=0.9662 (last merge round=26)
[S10] round=35 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9932450883683251, 'loss_val': 0.03283256238614398, 'psi': 0.9944107387589549}-{'f1_val': 0.9952985899745774, 'auprc': 0.9963857118822005, 'loss_val': 0.03305708825345689, 'psi': 0.9957334387376267}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=35 head_norm_before_train=1.591940 cos_to_last_merge=0.9798 (last merge round=29)
[S11] round=35 local utility u=0.003444 metrics={'f1_val': 0.9963256330217796, 'auprc': 0.9981508656410495, 'loss_val': 0.03867034451674136, 'psi': 0.9970557260694876}-{'f1_val': 0.9963256330217796, 'auprc': 0.9981966419097652, 'loss_val': 0.04569602996378238, 'psi': 0.9970740365769739}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] START round=35 head_norm_before_train=1.909836 (no previous merge yet)
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.6096791030922639, 'auprc': 0.6257364090155688, 'loss_val': 1.2574524340414226, 'psi': 0.6161020254615859}-{'f1_val': 0.6344108666907409, 'auprc': 0.6413096284704227, 'loss_val': 1.0644182913788207, 'psi': 0.6371703714026136}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=35 head_norm_before_train=2.076696 (no previous merge yet)
[S14] round=35 local utility u=0.000251 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9970639293537298, 'loss_val': 0.025505363154062283, 'psi': 0.9967779107079421}-{'f1_val': 0.9963671647723179, 'auprc': 0.9971148678796447, 'loss_val': 0.02483920214992901, 'psi': 0.9966662460152487}
[S14] not sending this round → trigger blocked (psi=0.997)
[S15] START round=35 head_norm_before_train=1.648834 cos_to_last_merge=0.9801 (last merge round=26)
[S15] round=35 local utility u=0.000000 metrics={'f1_val': 0.9024866320579021, 'auprc': 0.9984265737266129, 'loss_val': 0.180371303295852, 'psi': 0.9408626087253864}-{'f1_val': 0.9971172535281002, 'auprc': 0.9988234840829864, 'loss_val': 0.04572737032561305, 'psi': 0.9977997457500547}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=35 head_norm_before_train=1.691509 cos_to_last_merge=0.9933 (last merge round=31)
[S16] round=35 local utility u=0.204639 metrics={'f1_val': 0.9380512871325419, 'auprc': 0.9930014788329135, 'loss_val': 0.23307966184300413, 'psi': 0.9600313638126905}-{'f1_val': 0.8993987495046252, 'auprc': 0.9924550965946385, 'loss_val': 0.40880369758182383, 'psi': 0.9366212883406305}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=35 head_norm_before_train=1.931515 cos_to_last_merge=0.8077 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.808
[S17] round=35 local utility u=0.991235 metrics={'f1_val': 0.8251752211223575, 'auprc': 0.9336970255428955, 'loss_val': 0.5726715454973106, 'psi': 0.8685839428905727}-{'f1_val': 0.6163482627130697, 'auprc': 0.9546496574266466, 'loss_val': 1.3650385102307656, 'psi': 0.7516688205985005}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=36 head_norm_before_train=1.816404 cos_to_last_merge=0.9891 (last merge round=31)
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.658072842932246, 'auprc': 0.7265736024344382, 'loss_val': 1.1145331026297727, 'psi': 0.6854731467331229}-{'f1_val': 0.6950075703887004, 'auprc': 0.7413840925551449, 'loss_val': 1.0085386630184532, 'psi': 0.7135581792552783}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=36 head_norm_before_train=2.012068 cos_to_last_merge=0.9958 (last merge round=26)
[S3] round=36 local utility u=0.000000 metrics={'f1_val': 0.9605709740356257, 'auprc': 0.9979299537800805, 'loss_val': 0.15084817746077817, 'psi': 0.9755145659334077}-{'f1_val': 0.9973982357793907, 'auprc': 0.9983288283983988, 'loss_val': 0.028621024000520152, 'psi': 0.9977704728269939}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=36 head_norm_before_train=1.588218 cos_to_last_merge=0.9638 (last merge round=29)
[S4] round=36 local utility u=0.203014 metrics={'f1_val': 0.9476888980794205, 'auprc': 0.9645926148366357, 'loss_val': 0.2749815913865867, 'psi': 0.9544503847823066}-{'f1_val': 0.9159851285059059, 'auprc': 0.9238175221352659, 'loss_val': 0.3684615845684094, 'psi': 0.9191180859576499}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=36 head_norm_before_train=1.618603 cos_to_last_merge=0.9994 (last merge round=31)
[S5] round=36 local utility u=1.000000 metrics={'f1_val': 0.9967731002659072, 'auprc': 0.9979374210817199, 'loss_val': 0.13285692356944842, 'psi': 0.9972388285922322}-{'f1_val': 0.7146647020320098, 'auprc': 0.7945553489648917, 'loss_val': 0.48268444206844546, 'psi': 0.7466209608051626}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=36 head_norm_before_train=1.745930 cos_to_last_merge=0.9790 (last merge round=26)
[S6] round=36 local utility u=0.000000 metrics={'f1_val': 0.6979594200878669, 'auprc': 0.9512113587182016, 'loss_val': 0.7014079248436593, 'psi': 0.7992601955400008}-{'f1_val': 0.8320887335095217, 'auprc': 0.9596211011201309, 'loss_val': 0.37336489573504456, 'psi': 0.8831016805537655}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=36 head_norm_before_train=1.405167 cos_to_last_merge=0.9831 (last merge round=29)
[S7] round=36 local utility u=0.000000 metrics={'f1_val': 0.4941257895437815, 'auprc': 0.7765654852876205, 'loss_val': 0.9402096384711982, 'psi': 0.607101667841317}-{'f1_val': 0.6777079332112483, 'auprc': 0.8048704346627952, 'loss_val': 0.516192523842153, 'psi': 0.7285729337918672}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=36 head_norm_before_train=1.900990 cos_to_last_merge=0.8064 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.806
[S8] round=36 local utility u=0.006735 metrics={'f1_val': 0.9942226369520374, 'auprc': 0.9992370720139807, 'loss_val': 0.03034829358833227, 'psi': 0.9962284109768147}-{'f1_val': 0.9923167377520978, 'auprc': 0.9993149205370229, 'loss_val': 0.03261643554186267, 'psi': 0.9951160108660679}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=36 head_norm_before_train=1.675526 cos_to_last_merge=0.9928 (last merge round=26)
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9950853792664944, 'loss_val': 0.02883353217008106, 'psi': 0.9962958992138835}-{'f1_val': 0.9971029125121428, 'auprc': 0.9990943823079178, 'loss_val': 0.030185022528300832, 'psi': 0.9978995004304528}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=36 head_norm_before_train=1.664128 cos_to_last_merge=0.9643 (last merge round=26)
[S10] round=36 local utility u=0.000715 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9946715174524667, 'loss_val': 0.032540623944441724, 'psi': 0.9946672399866365}-{'f1_val': 0.9951878390193748, 'auprc': 0.9932450883683251, 'loss_val': 0.03283256238614398, 'psi': 0.9944107387589549}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=36 head_norm_before_train=1.640367 cos_to_last_merge=0.9762 (last merge round=29)
[S11] round=36 local utility u=0.001996 metrics={'f1_val': 0.9963256330217796, 'auprc': 0.9980702279596283, 'loss_val': 0.034435976294982934, 'psi': 0.997023470996919}-{'f1_val': 0.9963256330217796, 'auprc': 0.9981508656410495, 'loss_val': 0.03867034451674136, 'psi': 0.9970557260694876}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=36 head_norm_before_train=1.917303 (no previous merge yet)
[S13] round=36 local utility u=0.292227 metrics={'f1_val': 0.6354040113542638, 'auprc': 0.6716012858714042, 'loss_val': 0.9649425208335043, 'psi': 0.6498829211611199}-{'f1_val': 0.6096791030922639, 'auprc': 0.6257364090155688, 'loss_val': 1.2574524340414226, 'psi': 0.6161020254615859}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] sending update (kind=head size=1796 to 1 peers)
[S14] START round=36 head_norm_before_train=2.083623 (no previous merge yet)
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9969744602588223, 'loss_val': 0.02639478176080959, 'psi': 0.9967421230699791}-{'f1_val': 0.9965872316107504, 'auprc': 0.9970639293537298, 'loss_val': 0.025505363154062283, 'psi': 0.9967779107079421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=36 head_norm_before_train=1.668400 cos_to_last_merge=0.9782 (last merge round=26)
[S15] round=36 local utility u=0.342109 metrics={'f1_val': 0.9937792893764241, 'auprc': 0.9989372302302686, 'loss_val': 0.04544129512030634, 'psi': 0.9958424657179619}-{'f1_val': 0.9024866320579021, 'auprc': 0.9984265737266129, 'loss_val': 0.180371303295852, 'psi': 0.9408626087253864}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] sending update (kind=head size=1804 to 1 peers)
[S16] START round=36 head_norm_before_train=1.734387 cos_to_last_merge=0.9900 (last merge round=31)
[S16] round=36 local utility u=0.263661 metrics={'f1_val': 0.9932326750676236, 'auprc': 0.9981077874897959, 'loss_val': 0.052164379422550415, 'psi': 0.9951827200364924}-{'f1_val': 0.9380512871325419, 'auprc': 0.9930014788329135, 'loss_val': 0.23307966184300413, 'psi': 0.9600313638126905}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=36 head_norm_before_train=1.944238 cos_to_last_merge=0.8068 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.807
[S17] round=36 local utility u=0.000000 metrics={'f1_val': 0.5636477815229202, 'auprc': 0.7801523342411509, 'loss_val': 1.5297464302591708, 'psi': 0.6502496026102125}-{'f1_val': 0.8251752211223575, 'auprc': 0.9336970255428955, 'loss_val': 0.5726715454973106, 'psi': 0.8685839428905727}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=37 head_norm_before_train=1.843096 cos_to_last_merge=0.9875 (last merge round=31)
[S2] round=37 local utility u=0.100747 metrics={'f1_val': 0.6722192897623113, 'auprc': 0.7438962760706391, 'loss_val': 1.0498863367657505, 'psi': 0.7008900842856425}-{'f1_val': 0.658072842932246, 'auprc': 0.7265736024344382, 'loss_val': 1.1145331026297727, 'psi': 0.6854731467331229}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=37 head_norm_before_train=2.025543 cos_to_last_merge=0.9954 (last merge round=26)
[S3] round=37 local utility u=0.173884 metrics={'f1_val': 0.9973696976584205, 'auprc': 0.998255338637457, 'loss_val': 0.024848550219747943, 'psi': 0.9977239540500351}-{'f1_val': 0.9605709740356257, 'auprc': 0.9979299537800805, 'loss_val': 0.15084817746077817, 'psi': 0.9755145659334077}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S4] START round=37 head_norm_before_train=1.604111 cos_to_last_merge=0.9622 (last merge round=29)
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.9385263955879426, 'auprc': 0.9433852021801362, 'loss_val': 0.3092369517146066, 'psi': 0.94046991822482}-{'f1_val': 0.9476888980794205, 'auprc': 0.9645926148366357, 'loss_val': 0.2749815913865867, 'psi': 0.9544503847823066}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=37 head_norm_before_train=1.623080 cos_to_last_merge=0.9991 (last merge round=31)
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.7147298887569742, 'auprc': 0.871534960949742, 'loss_val': 0.31116764768835986, 'psi': 0.7774519176340813}-{'f1_val': 0.9967731002659072, 'auprc': 0.9979374210817199, 'loss_val': 0.13285692356944842, 'psi': 0.9972388285922322}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=37 head_norm_before_train=1.759692 cos_to_last_merge=0.9779 (last merge round=26)
[S6] round=37 local utility u=0.084339 metrics={'f1_val': 0.7111865754321749, 'auprc': 0.9650919019693167, 'loss_val': 0.6537350989208953, 'psi': 0.8127487060470316}-{'f1_val': 0.6979594200878669, 'auprc': 0.9512113587182016, 'loss_val': 0.7014079248436593, 'psi': 0.7992601955400008}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] START round=37 head_norm_before_train=1.425394 cos_to_last_merge=0.9790 (last merge round=29)
[S7] round=37 local utility u=0.780787 metrics={'f1_val': 0.6734490604101105, 'auprc': 0.799652070240821, 'loss_val': 0.5238356429400568, 'psi': 0.7239302643423948}-{'f1_val': 0.4941257895437815, 'auprc': 0.7765654852876205, 'loss_val': 0.9402096384711982, 'psi': 0.607101667841317}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S7] sending update (kind=head size=1807 to 1 peers)
[S8] START round=37 head_norm_before_train=1.911294 cos_to_last_merge=0.8047 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.805
[S8] round=37 local utility u=0.000000 metrics={'f1_val': 0.9289814647693545, 'auprc': 0.9894305821910966, 'loss_val': 0.10429002434182505, 'psi': 0.9531611117380514}-{'f1_val': 0.9942226369520374, 'auprc': 0.9992370720139807, 'loss_val': 0.03034829358833227, 'psi': 0.9962284109768147}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=37 head_norm_before_train=1.689290 cos_to_last_merge=0.9920 (last merge round=26)
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.992684475148198, 'auprc': 0.9986088459711158, 'loss_val': 0.038161653293205526, 'psi': 0.9950542234773652}-{'f1_val': 0.9971029125121428, 'auprc': 0.9950853792664944, 'loss_val': 0.02883353217008106, 'psi': 0.9962958992138835}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=37 head_norm_before_train=1.682215 cos_to_last_merge=0.9628 (last merge round=26)
[S10] round=37 local utility u=0.000140 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.994711274966902, 'loss_val': 0.032380080957096075, 'psi': 0.9946831429924107}-{'f1_val': 0.9946643883427498, 'auprc': 0.9946715174524667, 'loss_val': 0.032540623944441724, 'psi': 0.9946672399866365}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=37 head_norm_before_train=1.680715 cos_to_last_merge=0.9734 (last merge round=29)
[S11] round=37 local utility u=0.000552 metrics={'f1_val': 0.9959123037929781, 'auprc': 0.9983754146227382, 'loss_val': 0.031766728846621045, 'psi': 0.9968975481248821}-{'f1_val': 0.9963256330217796, 'auprc': 0.9980702279596283, 'loss_val': 0.034435976294982934, 'psi': 0.997023470996919}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] START round=37 head_norm_before_train=1.925162 (no previous merge yet)
[S13] round=37 local utility u=0.000000 metrics={'f1_val': 0.6187179428038103, 'auprc': 0.6657731987653115, 'loss_val': 1.1684281307057618, 'psi': 0.6375400451884108}-{'f1_val': 0.6354040113542638, 'auprc': 0.6716012858714042, 'loss_val': 0.9649425208335043, 'psi': 0.6498829211611199}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=37 head_norm_before_train=2.092713 (no previous merge yet)
[S14] round=37 local utility u=0.002055 metrics={'f1_val': 0.9965652232429598, 'auprc': 0.998670700051459, 'loss_val': 0.027240733993395414, 'psi': 0.9974074139663596}-{'f1_val': 0.9965872316107504, 'auprc': 0.9969744602588223, 'loss_val': 0.02639478176080959, 'psi': 0.9967421230699791}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=37 head_norm_before_train=1.683786 cos_to_last_merge=0.9768 (last merge round=26)
[S15] round=37 local utility u=0.016289 metrics={'f1_val': 0.9963878930881959, 'auprc': 0.9992650210257789, 'loss_val': 0.029497441047651916, 'psi': 0.9975387442632291}-{'f1_val': 0.9937792893764241, 'auprc': 0.9989372302302686, 'loss_val': 0.04544129512030634, 'psi': 0.9958424657179619}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=37 head_norm_before_train=1.771550 cos_to_last_merge=0.9870 (last merge round=31)
[S16] round=37 local utility u=0.003557 metrics={'f1_val': 0.9932326750676236, 'auprc': 0.9981933684594024, 'loss_val': 0.045307372066180414, 'psi': 0.995216952424335}-{'f1_val': 0.9932326750676236, 'auprc': 0.9981077874897959, 'loss_val': 0.052164379422550415, 'psi': 0.9951827200364924}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=37 head_norm_before_train=1.956907 cos_to_last_merge=0.8060 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.806
[S17] round=37 local utility u=1.000000 metrics={'f1_val': 0.9111265474668162, 'auprc': 0.965759782560908, 'loss_val': 0.4005509319055648, 'psi': 0.932979841504453}-{'f1_val': 0.5636477815229202, 'auprc': 0.7801523342411509, 'loss_val': 1.5297464302591708, 'psi': 0.6502496026102125}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=38 head_norm_before_train=1.864926 cos_to_last_merge=0.9863 (last merge round=31)
[S2] round=38 local utility u=0.141622 metrics={'f1_val': 0.7229488966848611, 'auprc': 0.7126508113464525, 'loss_val': 0.9772827999109672, 'psi': 0.7188296625494976}-{'f1_val': 0.6722192897623113, 'auprc': 0.7438962760706391, 'loss_val': 1.0498863367657505, 'psi': 0.7008900842856425}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S2] sending update (kind=head size=1791 to 1 peers)
[S3] START round=38 head_norm_before_train=2.037235 cos_to_last_merge=0.9949 (last merge round=26)
[S3] round=38 local utility u=0.000000 metrics={'f1_val': 0.9970158049264538, 'auprc': 0.9982285619559981, 'loss_val': 0.0293249733775933, 'psi': 0.9975009077382715}-{'f1_val': 0.9973696976584205, 'auprc': 0.998255338637457, 'loss_val': 0.024848550219747943, 'psi': 0.9977239540500351}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=38 head_norm_before_train=1.615990 cos_to_last_merge=0.9607 (last merge round=29)
[S4] round=38 local utility u=0.055770 metrics={'f1_val': 0.941834897423812, 'auprc': 0.966887734389085, 'loss_val': 0.2880552824107336, 'psi': 0.9518560322099212}-{'f1_val': 0.9385263955879426, 'auprc': 0.9433852021801362, 'loss_val': 0.3092369517146066, 'psi': 0.94046991822482}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=38 head_norm_before_train=1.627236 cos_to_last_merge=0.9988 (last merge round=31)
[S5] round=38 local utility u=1.000000 metrics={'f1_val': 0.996625909096903, 'auprc': 0.9973810594849148, 'loss_val': 0.12031111888163648, 'psi': 0.9969279692521078}-{'f1_val': 0.7147298887569742, 'auprc': 0.871534960949742, 'loss_val': 0.31116764768835986, 'psi': 0.7774519176340813}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=38 head_norm_before_train=1.772148 cos_to_last_merge=0.9772 (last merge round=26)
[S6] round=38 local utility u=0.000000 metrics={'f1_val': 0.644839083828294, 'auprc': 0.9552670178073615, 'loss_val': 0.707153615648899, 'psi': 0.769010257419921}-{'f1_val': 0.7111865754321749, 'auprc': 0.9650919019693167, 'loss_val': 0.6537350989208953, 'psi': 0.8127487060470316}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=38 head_norm_before_train=1.438432 cos_to_last_merge=0.9763 (last merge round=29)
[S7] round=38 local utility u=0.000000 metrics={'f1_val': 0.6185677612151445, 'auprc': 0.7902371464104504, 'loss_val': 0.6145255753073812, 'psi': 0.6872355152932668}-{'f1_val': 0.6734490604101105, 'auprc': 0.799652070240821, 'loss_val': 0.5238356429400568, 'psi': 0.7239302643423948}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=38 head_norm_before_train=1.920811 cos_to_last_merge=0.8039 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.804
[S8] round=38 local utility u=0.235614 metrics={'f1_val': 0.9918109678295097, 'auprc': 0.9972361663211875, 'loss_val': 0.03345565761245168, 'psi': 0.9939810472261809}-{'f1_val': 0.9289814647693545, 'auprc': 0.9894305821910966, 'loss_val': 0.10429002434182505, 'psi': 0.9531611117380514}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] sending update (kind=head size=1793 to 1 peers)
[S9] START round=38 head_norm_before_train=1.701769 cos_to_last_merge=0.9912 (last merge round=26)
[S9] round=38 local utility u=0.018225 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9987547460463695, 'loss_val': 0.0271579638202371, 'psi': 0.9976134496739022}-{'f1_val': 0.992684475148198, 'auprc': 0.9986088459711158, 'loss_val': 0.038161653293205526, 'psi': 0.9950542234773652}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=38 head_norm_before_train=1.700514 cos_to_last_merge=0.9613 (last merge round=26)
[S10] round=38 local utility u=0.000000 metrics={'f1_val': 0.9944449605296568, 'auprc': 0.9947001660106845, 'loss_val': 0.03200113236848802, 'psi': 0.994547042722068}-{'f1_val': 0.9946643883427498, 'auprc': 0.994711274966902, 'loss_val': 0.032380080957096075, 'psi': 0.9946831429924107}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=38 head_norm_before_train=1.709952 cos_to_last_merge=0.9717 (last merge round=29)
[S11] round=38 local utility u=0.001100 metrics={'f1_val': 0.9959123037929781, 'auprc': 0.9984210142387406, 'loss_val': 0.029702975220249093, 'psi': 0.9969157879712831}-{'f1_val': 0.9959123037929781, 'auprc': 0.9983754146227382, 'loss_val': 0.031766728846621045, 'psi': 0.9968975481248821}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=38 head_norm_before_train=1.931285 (no previous merge yet)
[S13] round=38 local utility u=0.325532 metrics={'f1_val': 0.6659071008094997, 'auprc': 0.7321259645475194, 'loss_val': 0.9995579508003205, 'psi': 0.6923946463047076}-{'f1_val': 0.6187179428038103, 'auprc': 0.6657731987653115, 'loss_val': 1.1684281307057618, 'psi': 0.6375400451884108}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=38 head_norm_before_train=2.100520 (no previous merge yet)
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.996177437545643, 'auprc': 0.9970343521831406, 'loss_val': 0.02613735949772021, 'psi': 0.9965202034006421}-{'f1_val': 0.9965652232429598, 'auprc': 0.998670700051459, 'loss_val': 0.027240733993395414, 'psi': 0.9974074139663596}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=38 head_norm_before_train=1.699327 cos_to_last_merge=0.9754 (last merge round=26)
[S15] round=38 local utility u=0.002108 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9988547193685424, 'loss_val': 0.026203958857155322, 'psi': 0.9975898887799293}-{'f1_val': 0.9963878930881959, 'auprc': 0.9992650210257789, 'loss_val': 0.029497441047651916, 'psi': 0.9975387442632291}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=38 head_norm_before_train=1.802621 cos_to_last_merge=0.9844 (last merge round=31)
[S16] round=38 local utility u=0.000000 metrics={'f1_val': 0.9271459120300012, 'auprc': 0.9899405142465836, 'loss_val': 0.3295401426655802, 'psi': 0.9522637529166341}-{'f1_val': 0.9932326750676236, 'auprc': 0.9981933684594024, 'loss_val': 0.045307372066180414, 'psi': 0.995216952424335}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=38 head_norm_before_train=1.964998 cos_to_last_merge=0.8055 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.805
[S17] round=38 local utility u=0.000000 metrics={'f1_val': 0.5616166622437132, 'auprc': 0.790635814774537, 'loss_val': 1.5947186018338124, 'psi': 0.6532243232560427}-{'f1_val': 0.9111265474668162, 'auprc': 0.965759782560908, 'loss_val': 0.4005509319055648, 'psi': 0.932979841504453}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=39 head_norm_before_train=1.887937 cos_to_last_merge=0.9850 (last merge round=31)
[S2] round=39 local utility u=0.035317 metrics={'f1_val': 0.7119306316624311, 'auprc': 0.7448364172562928, 'loss_val': 0.9370968447025227, 'psi': 0.7250929458999757}-{'f1_val': 0.7229488966848611, 'auprc': 0.7126508113464525, 'loss_val': 0.9772827999109672, 'psi': 0.7188296625494976}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S2] sending update (kind=head size=1792 to 1 peers)
[S2] r=40 psi=0.725 u=0.0353 p_local=0.0590 f1=0.712 auprc=0.745 bytes=35952
[S3] START round=39 head_norm_before_train=2.048033 cos_to_last_merge=0.9945 (last merge round=26)
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9981913297458983, 'loss_val': 0.10265639673488351, 'psi': 0.9758976825616255}-{'f1_val': 0.9970158049264538, 'auprc': 0.9982285619559981, 'loss_val': 0.0293249733775933, 'psi': 0.9975009077382715}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=40 psi=0.976 u=0.0000 p_local=0.0403 f1=0.961 auprc=0.998 bytes=34143
[S4] START round=39 head_norm_before_train=1.627368 cos_to_last_merge=0.9593 (last merge round=29)
[S4] round=39 local utility u=0.046481 metrics={'f1_val': 0.9506089106563507, 'auprc': 0.9750851058016496, 'loss_val': 0.2723297366209042, 'psi': 0.9603993887144703}-{'f1_val': 0.941834897423812, 'auprc': 0.966887734389085, 'loss_val': 0.2880552824107336, 'psi': 0.9518560322099212}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S4] r=40 psi=0.960 u=0.0465 p_local=0.0483 f1=0.951 auprc=0.975 bytes=36027
[S5] START round=39 head_norm_before_train=1.631800 cos_to_last_merge=0.9984 (last merge round=31)
[S5] round=39 local utility u=0.000000 metrics={'f1_val': 0.996625909096903, 'auprc': 0.9944966406850022, 'loss_val': 0.13042713980843393, 'psi': 0.9957742017321427}-{'f1_val': 0.996625909096903, 'auprc': 0.9973810594849148, 'loss_val': 0.12031111888163648, 'psi': 0.9969279692521078}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=40 psi=0.996 u=0.0000 p_local=0.3652 f1=0.997 auprc=0.994 bytes=37789
[S6] START round=39 head_norm_before_train=1.783314 cos_to_last_merge=0.9764 (last merge round=26)
[S6] round=39 local utility u=0.444773 metrics={'f1_val': 0.7425141684237924, 'auprc': 0.9669252279041879, 'loss_val': 0.43863323716578084, 'psi': 0.8322785922159506}-{'f1_val': 0.644839083828294, 'auprc': 0.9552670178073615, 'loss_val': 0.707153615648899, 'psi': 0.769010257419921}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S6] r=40 psi=0.832 u=0.4448 p_local=0.2635 f1=0.743 auprc=0.967 bytes=34175
[S7] START round=39 head_norm_before_train=1.449966 cos_to_last_merge=0.9741 (last merge round=29)
[S7] round=39 local utility u=0.006498 metrics={'f1_val': 0.6199942256385795, 'auprc': 0.7877162422456483, 'loss_val': 0.6025248454144753, 'psi': 0.687083032281407}-{'f1_val': 0.6185677612151445, 'auprc': 0.7902371464104504, 'loss_val': 0.6145255753073812, 'psi': 0.6872355152932668}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S7] sending update (kind=head size=1808 to 1 peers)
[S7] r=40 psi=0.687 u=0.0065 p_local=0.2280 f1=0.620 auprc=0.788 bytes=41383
[S8] START round=39 head_norm_before_train=1.930199 cos_to_last_merge=0.8029 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.803
[S8] round=39 local utility u=0.005262 metrics={'f1_val': 0.9922069265978078, 'auprc': 0.999090520245358, 'loss_val': 0.030869677254598854, 'psi': 0.994960364056828}-{'f1_val': 0.9918109678295097, 'auprc': 0.9972361663211875, 'loss_val': 0.03345565761245168, 'psi': 0.9939810472261809}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] sending update (kind=head size=1794 to 1 peers)
[S8] r=40 psi=0.995 u=0.0053 p_local=0.0418 f1=0.992 auprc=0.999 bytes=39519
[S9] START round=39 head_norm_before_train=1.713509 cos_to_last_merge=0.9904 (last merge round=26)
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9956095196056327, 'loss_val': 0.025724540132340754, 'psi': 0.9965055553495388}-{'f1_val': 0.9968525854255906, 'auprc': 0.9987547460463695, 'loss_val': 0.0271579638202371, 'psi': 0.9976134496739022}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=40 psi=0.997 u=0.0000 p_local=0.0064 f1=0.997 auprc=0.996 bytes=41392
[S10] START round=39 head_norm_before_train=1.718171 cos_to_last_merge=0.9597 (last merge round=26)
[S10] round=39 local utility u=0.001097 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9947162172608098, 'loss_val': 0.031171073439112417, 'psi': 0.9946851199099738}-{'f1_val': 0.9944449605296568, 'auprc': 0.9947001660106845, 'loss_val': 0.03200113236848802, 'psi': 0.994547042722068}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S10] r=40 psi=0.995 u=0.0011 p_local=0.0031 f1=0.995 auprc=0.995 bytes=43185
[S11] START round=39 head_norm_before_train=1.734976 cos_to_last_merge=0.9701 (last merge round=29)
[S11] round=39 local utility u=0.000912 metrics={'f1_val': 0.9959123037929781, 'auprc': 0.9984759761716339, 'loss_val': 0.028044321942077826, 'psi': 0.9969377727444404}-{'f1_val': 0.9959123037929781, 'auprc': 0.9984210142387406, 'loss_val': 0.029702975220249093, 'psi': 0.9969157879712831}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S11] sending update (kind=head size=1806 to 1 peers)
[S11] r=40 psi=0.997 u=0.0009 p_local=0.0045 f1=0.996 auprc=0.998 bytes=45055
[S13] START round=39 head_norm_before_train=1.933918 (no previous merge yet)
[S13] round=39 local utility u=0.193875 metrics={'f1_val': 0.7249177797448014, 'auprc': 0.7270568354841487, 'loss_val': 0.9506651324127325, 'psi': 0.7257734020405404}-{'f1_val': 0.6659071008094997, 'auprc': 0.7321259645475194, 'loss_val': 0.9995579508003205, 'psi': 0.6923946463047076}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S13] r=40 psi=0.726 u=0.1939 p_local=0.1512 f1=0.725 auprc=0.727 bytes=36009
[S14] START round=39 head_norm_before_train=2.109733 (no previous merge yet)
[S14] round=39 local utility u=0.000000 metrics={'f1_val': 0.9963442551067831, 'auprc': 0.9969907892212015, 'loss_val': 0.028693201208229175, 'psi': 0.9966028687525504}-{'f1_val': 0.996177437545643, 'auprc': 0.9970343521831406, 'loss_val': 0.02613735949772021, 'psi': 0.9965202034006421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=40 psi=0.997 u=0.0000 p_local=0.0023 f1=0.996 auprc=0.997 bytes=39612
[S15] START round=39 head_norm_before_train=1.712971 cos_to_last_merge=0.9742 (last merge round=26)
[S15] round=39 local utility u=0.000000 metrics={'f1_val': 0.9057475166813964, 'auprc': 0.998167193343325, 'loss_val': 0.11373985664609124, 'psi': 0.9427153873461679}-{'f1_val': 0.9967466683875206, 'auprc': 0.9988547193685424, 'loss_val': 0.026203958857155322, 'psi': 0.9975898887799293}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=40 psi=0.943 u=0.0000 p_local=0.0703 f1=0.906 auprc=0.998 bytes=37766
[S16] START round=39 head_norm_before_train=1.829019 cos_to_last_merge=0.9822 (last merge round=31)
[S16] round=39 local utility u=0.000000 metrics={'f1_val': 0.8615318800318006, 'auprc': 0.9879984804479084, 'loss_val': 0.7059184347323666, 'psi': 0.9121185201982438}-{'f1_val': 0.9271459120300012, 'auprc': 0.9899405142465836, 'loss_val': 0.3295401426655802, 'psi': 0.9522637529166341}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=40 psi=0.912 u=0.0000 p_local=0.0922 f1=0.862 auprc=0.988 bytes=39578
[S17] START round=39 head_norm_before_train=1.968963 cos_to_last_merge=0.8052 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.805
[S17] round=39 local utility u=1.000000 metrics={'f1_val': 0.8845187577593625, 'auprc': 0.9175867189317994, 'loss_val': 0.4955397317490767, 'psi': 0.8977459422283374}-{'f1_val': 0.5616166622437132, 'auprc': 0.790635814774537, 'loss_val': 1.5947186018338124, 'psi': 0.6532243232560427}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S17] r=40 psi=0.898 u=1.0000 p_local=0.5181 f1=0.885 auprc=0.918 bytes=34180
[S2] START round=40 head_norm_before_train=1.908070 cos_to_last_merge=0.9838 (last merge round=31)
[S2] round=40 local utility u=0.069199 metrics={'f1_val': 0.7097065232095003, 'auprc': 0.7891381929747255, 'loss_val': 0.9182587203499837, 'psi': 0.7414791911155905}-{'f1_val': 0.7119306316624311, 'auprc': 0.7448364172562928, 'loss_val': 0.9370968447025227, 'psi': 0.7250929458999757}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] sending update (kind=head size=1794 to 1 peers)
[S3] START round=40 head_norm_before_train=2.055067 cos_to_last_merge=0.9943 (last merge round=26)
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.9343413143756535, 'auprc': 0.9788102705519148, 'loss_val': 0.20764835659271375, 'psi': 0.9521288968461581}-{'f1_val': 0.9610352511054436, 'auprc': 0.9981913297458983, 'loss_val': 0.10265639673488351, 'psi': 0.9758976825616255}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=40 head_norm_before_train=1.632850 cos_to_last_merge=0.9582 (last merge round=29)
[S4] round=40 local utility u=0.000000 metrics={'f1_val': 0.9398501651796255, 'auprc': 0.9658262365537257, 'loss_val': 0.300885517006098, 'psi': 0.9502405937292655}-{'f1_val': 0.9506089106563507, 'auprc': 0.9750851058016496, 'loss_val': 0.2723297366209042, 'psi': 0.9603993887144703}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=40 head_norm_before_train=1.638450 cos_to_last_merge=0.9980 (last merge round=31)
[S5] round=40 local utility u=0.000000 metrics={'f1_val': 0.984143197687514, 'auprc': 0.9960159043831345, 'loss_val': 0.12841791202909894, 'psi': 0.9888922803657623}-{'f1_val': 0.996625909096903, 'auprc': 0.9944966406850022, 'loss_val': 0.13042713980843393, 'psi': 0.9957742017321427}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=40 head_norm_before_train=1.796052 cos_to_last_merge=0.9754 (last merge round=26)
[S6] round=40 local utility u=0.000000 metrics={'f1_val': 0.6281528091775962, 'auprc': 0.9573928442025161, 'loss_val': 0.6357112120048714, 'psi': 0.7598488231875642}-{'f1_val': 0.7425141684237924, 'auprc': 0.9669252279041879, 'loss_val': 0.43863323716578084, 'psi': 0.8322785922159506}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=40 head_norm_before_train=1.460951 cos_to_last_merge=0.9721 (last merge round=29)
[S7] round=40 local utility u=0.060310 metrics={'f1_val': 0.631950899244049, 'auprc': 0.7933680838081167, 'loss_val': 0.5706012364067411, 'psi': 0.6965177730696761}-{'f1_val': 0.6199942256385795, 'auprc': 0.7877162422456483, 'loss_val': 0.6025248454144753, 'psi': 0.687083032281407}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] sending update (kind=head size=1806 to 1 peers)
[S8] START round=40 head_norm_before_train=1.945193 cos_to_last_merge=0.8011 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.801
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.992174240363445, 'auprc': 0.9990570494194123, 'loss_val': 0.03177105081859287, 'psi': 0.9949273639858319}-{'f1_val': 0.9922069265978078, 'auprc': 0.999090520245358, 'loss_val': 0.030869677254598854, 'psi': 0.994960364056828}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=40 head_norm_before_train=1.725177 cos_to_last_merge=0.9896 (last merge round=26)
[S9] round=40 local utility u=0.000075 metrics={'f1_val': 0.9958601375429889, 'auprc': 0.9983751694841021, 'loss_val': 0.026415420922262234, 'psi': 0.996866150319434}-{'f1_val': 0.9971029125121428, 'auprc': 0.9956095196056327, 'loss_val': 0.025724540132340754, 'psi': 0.9965055553495388}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=40 head_norm_before_train=1.732432 cos_to_last_merge=0.9585 (last merge round=26)
[S10] round=40 local utility u=0.000000 metrics={'f1_val': 0.9942256070413027, 'auprc': 0.9947194826322893, 'loss_val': 0.031324920455004554, 'psi': 0.9944231572776974}-{'f1_val': 0.9946643883427498, 'auprc': 0.9947162172608098, 'loss_val': 0.031171073439112417, 'psi': 0.9946851199099738}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=40 head_norm_before_train=1.757764 cos_to_last_merge=0.9686 (last merge round=29)
[S11] round=40 local utility u=0.000490 metrics={'f1_val': 0.9959123037929781, 'auprc': 0.9984554266915275, 'loss_val': 0.02700283693122195, 'psi': 0.9969295529523978}-{'f1_val': 0.9959123037929781, 'auprc': 0.9984759761716339, 'loss_val': 0.028044321942077826, 'psi': 0.9969377727444404}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] START round=40 head_norm_before_train=1.938009 (no previous merge yet)
[S13] round=40 local utility u=0.000000 metrics={'f1_val': 0.6153767701062746, 'auprc': 0.7105496897092626, 'loss_val': 1.0627477652592514, 'psi': 0.6534459379474697}-{'f1_val': 0.7249177797448014, 'auprc': 0.7270568354841487, 'loss_val': 0.9506651324127325, 'psi': 0.7257734020405404}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=40 head_norm_before_train=2.120047 (no previous merge yet)
[S14] round=40 local utility u=0.001948 metrics={'f1_val': 0.9963442551067831, 'auprc': 0.9971102009609479, 'loss_val': 0.025156017718754024, 'psi': 0.9966506334484491}-{'f1_val': 0.9963442551067831, 'auprc': 0.9969907892212015, 'loss_val': 0.028693201208229175, 'psi': 0.9966028687525504}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=40 head_norm_before_train=1.726291 cos_to_last_merge=0.9729 (last merge round=26)
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.9013401414455775, 'auprc': 0.9924875517994782, 'loss_val': 0.29501155608970864, 'psi': 0.9377991055871377}-{'f1_val': 0.9057475166813964, 'auprc': 0.998167193343325, 'loss_val': 0.11373985664609124, 'psi': 0.9427153873461679}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=40 head_norm_before_train=1.852724 cos_to_last_merge=0.9803 (last merge round=31)
[S16] round=40 local utility u=0.000000 metrics={'f1_val': 0.84871291033771, 'auprc': 0.9881251973164571, 'loss_val': 0.8663904773603341, 'psi': 0.9044778251292089}-{'f1_val': 0.8615318800318006, 'auprc': 0.9879984804479084, 'loss_val': 0.7059184347323666, 'psi': 0.9121185201982438}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=40 head_norm_before_train=1.974346 cos_to_last_merge=0.8047 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.805
[S17] round=40 local utility u=0.000000 metrics={'f1_val': 0.581042480710023, 'auprc': 0.8829732749554813, 'loss_val': 1.5386346884162896, 'psi': 0.7018147984082064}-{'f1_val': 0.8845187577593625, 'auprc': 0.9175867189317994, 'loss_val': 0.4955397317490767, 'psi': 0.8977459422283374}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=41 head_norm_before_train=1.921484 cos_to_last_merge=0.9830 (last merge round=31)
[S2] round=41 local utility u=0.016094 metrics={'f1_val': 0.7141910304662591, 'auprc': 0.7890251422192627, 'loss_val': 0.9126391971045879, 'psi': 0.7441246751674606}-{'f1_val': 0.7097065232095003, 'auprc': 0.7891381929747255, 'loss_val': 0.9182587203499837, 'psi': 0.7414791911155905}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] sending update (kind=head size=1795 to 1 peers)
[S3] START round=41 head_norm_before_train=2.063643 cos_to_last_merge=0.9940 (last merge round=26)
[S3] round=41 local utility u=0.309157 metrics={'f1_val': 0.9969869110332736, 'auprc': 0.9983302754857543, 'loss_val': 0.023768174090545928, 'psi': 0.9975242568142658}-{'f1_val': 0.9343413143756535, 'auprc': 0.9788102705519148, 'loss_val': 0.20764835659271375, 'psi': 0.9521288968461581}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=41 head_norm_before_train=1.654261 cos_to_last_merge=0.9561 (last merge round=29)
[S4] round=41 local utility u=0.007372 metrics={'f1_val': 0.941834897423812, 'auprc': 0.9645526379680935, 'loss_val': 0.29422976209875273, 'psi': 0.9509219936415246}-{'f1_val': 0.9398501651796255, 'auprc': 0.9658262365537257, 'loss_val': 0.300885517006098, 'psi': 0.9502405937292655}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=41 head_norm_before_train=1.647028 cos_to_last_merge=0.9972 (last merge round=31)
[S5] round=41 local utility u=0.000000 metrics={'f1_val': 0.963852974629248, 'auprc': 0.9972772169124438, 'loss_val': 0.12963064495086818, 'psi': 0.9772226715425263}-{'f1_val': 0.984143197687514, 'auprc': 0.9960159043831345, 'loss_val': 0.12841791202909894, 'psi': 0.9888922803657623}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=41 head_norm_before_train=1.805168 cos_to_last_merge=0.9740 (last merge round=26)
[S6] round=41 local utility u=0.868084 metrics={'f1_val': 0.8621821557199456, 'auprc': 0.9714882757448451, 'loss_val': 0.3460061234713325, 'psi': 0.9059046037299053}-{'f1_val': 0.6281528091775962, 'auprc': 0.9573928442025161, 'loss_val': 0.6357112120048714, 'psi': 0.7598488231875642}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=41 head_norm_before_train=1.472865 cos_to_last_merge=0.9700 (last merge round=29)
[S7] round=41 local utility u=0.000000 metrics={'f1_val': 0.5460675112200308, 'auprc': 0.7822117218127127, 'loss_val': 0.8565705797103353, 'psi': 0.6405251954571036}-{'f1_val': 0.631950899244049, 'auprc': 0.7933680838081167, 'loss_val': 0.5706012364067411, 'psi': 0.6965177730696761}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=41 head_norm_before_train=1.958435 cos_to_last_merge=0.8000 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.800
[S8] round=41 local utility u=0.008837 metrics={'f1_val': 0.9944672019690619, 'auprc': 0.9991038806095731, 'loss_val': 0.02799566705848561, 'psi': 0.9963218734252663}-{'f1_val': 0.992174240363445, 'auprc': 0.9990570494194123, 'loss_val': 0.03177105081859287, 'psi': 0.9949273639858319}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=41 head_norm_before_train=1.733791 cos_to_last_merge=0.9888 (last merge round=26)
[S9] round=41 local utility u=0.004715 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9983767891622652, 'loss_val': 0.024446410958578652, 'psi': 0.9976124631721918}-{'f1_val': 0.9958601375429889, 'auprc': 0.9983751694841021, 'loss_val': 0.026415420922262234, 'psi': 0.996866150319434}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=41 head_norm_before_train=1.746992 cos_to_last_merge=0.9573 (last merge round=26)
[S10] round=41 local utility u=0.000000 metrics={'f1_val': 0.9940903254969471, 'auprc': 0.9942452552956297, 'loss_val': 0.03117871625455116, 'psi': 0.9941522974164201}-{'f1_val': 0.9942256070413027, 'auprc': 0.9947194826322893, 'loss_val': 0.031324920455004554, 'psi': 0.9944231572776974}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=41 head_norm_before_train=1.776576 cos_to_last_merge=0.9673 (last merge round=29)
[S11] round=41 local utility u=0.001450 metrics={'f1_val': 0.9959123037929781, 'auprc': 0.9987541246700191, 'loss_val': 0.024998473056287017, 'psi': 0.9970490321437946}-{'f1_val': 0.9959123037929781, 'auprc': 0.9984554266915275, 'loss_val': 0.02700283693122195, 'psi': 0.9969295529523978}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=41 head_norm_before_train=1.944456 (no previous merge yet)
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.6300570114133394, 'auprc': 0.646751124861399, 'loss_val': 1.049314595026582, 'psi': 0.6367346567925631}-{'f1_val': 0.6153767701062746, 'auprc': 0.7105496897092626, 'loss_val': 1.0627477652592514, 'psi': 0.6534459379474697}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=41 head_norm_before_train=2.123156 (no previous merge yet)
[S14] round=41 local utility u=0.001559 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9971502202893348, 'loss_val': 0.02361529344267051, 'psi': 0.9968124270821841}-{'f1_val': 0.9963442551067831, 'auprc': 0.9971102009609479, 'loss_val': 0.025156017718754024, 'psi': 0.9966506334484491}
[S14] not sending this round → trigger blocked (psi=0.997)
[S15] START round=41 head_norm_before_train=1.740164 cos_to_last_merge=0.9716 (last merge round=26)
[S15] round=41 local utility u=0.428637 metrics={'f1_val': 0.9971172535281002, 'auprc': 0.9963346478573424, 'loss_val': 0.023941964489566543, 'psi': 0.996804211259797}-{'f1_val': 0.9013401414455775, 'auprc': 0.9924875517994782, 'loss_val': 0.29501155608970864, 'psi': 0.9377991055871377}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] START round=41 head_norm_before_train=1.871702 cos_to_last_merge=0.9789 (last merge round=31)
[S16] round=41 local utility u=0.821449 metrics={'f1_val': 0.9846884005911405, 'auprc': 0.9964094765319089, 'loss_val': 0.06419772025635634, 'psi': 0.9893768309674479}-{'f1_val': 0.84871291033771, 'auprc': 0.9881251973164571, 'loss_val': 0.8663904773603341, 'psi': 0.9044778251292089}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=41 head_norm_before_train=1.983197 cos_to_last_merge=0.8041 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.804
[S17] round=41 local utility u=1.000000 metrics={'f1_val': 0.907577641705639, 'auprc': 0.943684790689171, 'loss_val': 0.49686920610303387, 'psi': 0.9220205012990518}-{'f1_val': 0.581042480710023, 'auprc': 0.8829732749554813, 'loss_val': 1.5386346884162896, 'psi': 0.7018147984082064}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=42 head_norm_before_train=1.933849 cos_to_last_merge=0.9822 (last merge round=31)
[S2] round=42 local utility u=0.000000 metrics={'f1_val': 0.7220486392151195, 'auprc': 0.7452314234764295, 'loss_val': 1.0349905147001872, 'psi': 0.7313217529196434}-{'f1_val': 0.7141910304662591, 'auprc': 0.7890251422192627, 'loss_val': 0.9126391971045879, 'psi': 0.7441246751674606}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=42 head_norm_before_train=2.071639 cos_to_last_merge=0.9936 (last merge round=26)
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.9970158049264538, 'auprc': 0.9983697841066471, 'loss_val': 0.029765579337943028, 'psi': 0.9975573965985312}-{'f1_val': 0.9969869110332736, 'auprc': 0.9983302754857543, 'loss_val': 0.023768174090545928, 'psi': 0.9975242568142658}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=42 head_norm_before_train=1.673800 cos_to_last_merge=0.9541 (last merge round=29)
[S4] round=42 local utility u=0.011279 metrics={'f1_val': 0.9460469437843082, 'auprc': 0.961165701911011, 'loss_val': 0.2867835522139768, 'psi': 0.9520944470349892}-{'f1_val': 0.941834897423812, 'auprc': 0.9645526379680935, 'loss_val': 0.29422976209875273, 'psi': 0.9509219936415246}
[S4] not sending this round → trigger blocked (psi=0.952)
[S5] START round=42 head_norm_before_train=1.653272 cos_to_last_merge=0.9967 (last merge round=31)
[S5] round=42 local utility u=0.000000 metrics={'f1_val': 0.7146647020320098, 'auprc': 0.7942064207936965, 'loss_val': 0.4913003002123855, 'psi': 0.7464813895366845}-{'f1_val': 0.963852974629248, 'auprc': 0.9972772169124438, 'loss_val': 0.12963064495086818, 'psi': 0.9772226715425263}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=42 head_norm_before_train=1.814170 cos_to_last_merge=0.9729 (last merge round=26)
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.8320254535252589, 'auprc': 0.9757675093239232, 'loss_val': 0.32015793411657395, 'psi': 0.8895222758447245}-{'f1_val': 0.8621821557199456, 'auprc': 0.9714882757448451, 'loss_val': 0.3460061234713325, 'psi': 0.9059046037299053}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=42 head_norm_before_train=1.487453 cos_to_last_merge=0.9672 (last merge round=29)
[S7] round=42 local utility u=0.061564 metrics={'f1_val': 0.5595656263234912, 'auprc': 0.7851019929385623, 'loss_val': 0.8231014418824071, 'psi': 0.6497801729695196}-{'f1_val': 0.5460675112200308, 'auprc': 0.7822117218127127, 'loss_val': 0.8565705797103353, 'psi': 0.6405251954571036}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=42 head_norm_before_train=1.968129 cos_to_last_merge=0.7998 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.800
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.9929361822751569, 'auprc': 0.9989093276867316, 'loss_val': 0.030711442353780267, 'psi': 0.9953254404397868}-{'f1_val': 0.9944672019690619, 'auprc': 0.9991038806095731, 'loss_val': 0.02799566705848561, 'psi': 0.9963218734252663}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=42 head_norm_before_train=1.743543 cos_to_last_merge=0.9880 (last merge round=26)
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.9893150859224193, 'auprc': 0.9983685844135228, 'loss_val': 0.0440504050297337, 'psi': 0.9929364853188607}-{'f1_val': 0.9971029125121428, 'auprc': 0.9983767891622652, 'loss_val': 0.024446410958578652, 'psi': 0.9976124631721918}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=42 head_norm_before_train=1.760138 cos_to_last_merge=0.9562 (last merge round=26)
[S10] round=42 local utility u=0.001575 metrics={'f1_val': 0.9943096789853013, 'auprc': 0.9946350327242075, 'loss_val': 0.030514402626771388, 'psi': 0.9944398204808638}-{'f1_val': 0.9940903254969471, 'auprc': 0.9942452552956297, 'loss_val': 0.03117871625455116, 'psi': 0.9941522974164201}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=42 head_norm_before_train=1.792603 cos_to_last_merge=0.9662 (last merge round=29)
[S11] round=42 local utility u=0.000130 metrics={'f1_val': 0.9959123037929781, 'auprc': 0.9987353327684331, 'loss_val': 0.02468119715445798, 'psi': 0.9970415153831601}-{'f1_val': 0.9959123037929781, 'auprc': 0.9987541246700191, 'loss_val': 0.024998473056287017, 'psi': 0.9970490321437946}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=42 head_norm_before_train=1.948540 (no previous merge yet)
[S13] round=42 local utility u=0.354471 metrics={'f1_val': 0.7279848944035553, 'auprc': 0.6946003658395669, 'loss_val': 1.0714872662617838, 'psi': 0.7146310829779599}-{'f1_val': 0.6300570114133394, 'auprc': 0.646751124861399, 'loss_val': 1.049314595026582, 'psi': 0.6367346567925631}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=42 head_norm_before_train=2.125427 (no previous merge yet)
[S14] round=42 local utility u=0.000271 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9971530115534817, 'loss_val': 0.023082302504830586, 'psi': 0.9968135435878429}-{'f1_val': 0.9965872316107504, 'auprc': 0.9971502202893348, 'loss_val': 0.02361529344267051, 'psi': 0.9968124270821841}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=42 head_norm_before_train=1.751512 cos_to_last_merge=0.9704 (last merge round=26)
[S15] round=42 local utility u=0.000000 metrics={'f1_val': 0.7776726199642368, 'auprc': 0.9978217142687341, 'loss_val': 0.3532934174515274, 'psi': 0.8657322576860357}-{'f1_val': 0.9971172535281002, 'auprc': 0.9963346478573424, 'loss_val': 0.023941964489566543, 'psi': 0.996804211259797}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=42 head_norm_before_train=1.889777 cos_to_last_merge=0.9775 (last merge round=31)
[S16] round=42 local utility u=0.000000 metrics={'f1_val': 0.978877024681128, 'auprc': 0.9963697679312742, 'loss_val': 0.07637212157339432, 'psi': 0.9858741219811864}-{'f1_val': 0.9846884005911405, 'auprc': 0.9964094765319089, 'loss_val': 0.06419772025635634, 'psi': 0.9893768309674479}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=42 head_norm_before_train=1.983453 cos_to_last_merge=0.8038 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.804
[S17] round=42 local utility u=0.000000 metrics={'f1_val': 0.6565565333217844, 'auprc': 0.95201505915316, 'loss_val': 1.0761373549116584, 'psi': 0.7747399436543347}-{'f1_val': 0.907577641705639, 'auprc': 0.943684790689171, 'loss_val': 0.49686920610303387, 'psi': 0.9220205012990518}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=43 head_norm_before_train=1.942653 cos_to_last_merge=0.9813 (last merge round=31)
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.7222635502100333, 'auprc': 0.7398152728434606, 'loss_val': 1.0285079086818132, 'psi': 0.7292842392634042}-{'f1_val': 0.7220486392151195, 'auprc': 0.7452314234764295, 'loss_val': 1.0349905147001872, 'psi': 0.7313217529196434}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=43 head_norm_before_train=2.079579 cos_to_last_merge=0.9933 (last merge round=26)
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.9605709740356257, 'auprc': 0.9982602083868057, 'loss_val': 0.15700848180951388, 'psi': 0.9756466677760978}-{'f1_val': 0.9970158049264538, 'auprc': 0.9983697841066471, 'loss_val': 0.029765579337943028, 'psi': 0.9975573965985312}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=43 head_norm_before_train=1.689421 cos_to_last_merge=0.9520 (last merge round=29)
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.9415500736309181, 'auprc': 0.9598919318561535, 'loss_val': 0.2976928915311592, 'psi': 0.9488868169210123}-{'f1_val': 0.9460469437843082, 'auprc': 0.961165701911011, 'loss_val': 0.2867835522139768, 'psi': 0.9520944470349892}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=43 head_norm_before_train=1.659098 cos_to_last_merge=0.9962 (last merge round=31)
[S5] round=43 local utility u=0.414972 metrics={'f1_val': 0.7147298887569742, 'auprc': 0.9918137707518428, 'loss_val': 0.2545690083097212, 'psi': 0.8255634415549217}-{'f1_val': 0.7146647020320098, 'auprc': 0.7942064207936965, 'loss_val': 0.4913003002123855, 'psi': 0.7464813895366845}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=43 head_norm_before_train=1.827287 cos_to_last_merge=0.9712 (last merge round=26)
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.7657484163118131, 'auprc': 0.9563393113237457, 'loss_val': 0.4848880178415429, 'psi': 0.8419847743165861}-{'f1_val': 0.8320254535252589, 'auprc': 0.9757675093239232, 'loss_val': 0.32015793411657395, 'psi': 0.8895222758447245}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=43 head_norm_before_train=1.498608 cos_to_last_merge=0.9652 (last merge round=29)
[S7] round=43 local utility u=0.608246 metrics={'f1_val': 0.6806798359942003, 'auprc': 0.813468566177669, 'loss_val': 0.4183935692123666, 'psi': 0.7337953280675878}-{'f1_val': 0.5595656263234912, 'auprc': 0.7851019929385623, 'loss_val': 0.8231014418824071, 'psi': 0.6497801729695196}
[S7] not sending this round → trigger blocked (psi=0.734)
[S8] START round=43 head_norm_before_train=1.970387 cos_to_last_merge=0.8005 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.801
[S8] round=43 local utility u=0.000954 metrics={'f1_val': 0.9936253371144965, 'auprc': 0.9990484352286642, 'loss_val': 0.033356275373110165, 'psi': 0.9957945763601637}-{'f1_val': 0.9929361822751569, 'auprc': 0.9989093276867316, 'loss_val': 0.030711442353780267, 'psi': 0.9953254404397868}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] sending update (kind=head size=1792 to 1 peers)
[S9] START round=43 head_norm_before_train=1.753497 cos_to_last_merge=0.9873 (last merge round=26)
[S9] round=43 local utility u=0.029673 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9956167572065338, 'loss_val': 0.023175920843458774, 'psi': 0.9965084503898992}-{'f1_val': 0.9893150859224193, 'auprc': 0.9983685844135228, 'loss_val': 0.0440504050297337, 'psi': 0.9929364853188607}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=43 head_norm_before_train=1.772027 cos_to_last_merge=0.9553 (last merge round=26)
[S10] round=43 local utility u=0.000176 metrics={'f1_val': 0.9943096789853013, 'auprc': 0.9946463036472467, 'loss_val': 0.03019612035317581, 'psi': 0.9944443288500795}-{'f1_val': 0.9943096789853013, 'auprc': 0.9946350327242075, 'loss_val': 0.030514402626771388, 'psi': 0.9944398204808638}
[S10] not sending this round → trigger blocked (psi=0.994)
[S11] START round=43 head_norm_before_train=1.806560 cos_to_last_merge=0.9652 (last merge round=29)
[S11] round=43 local utility u=0.000000 metrics={'f1_val': 0.9959123037929781, 'auprc': 0.9984444872177518, 'loss_val': 0.0245497876359201, 'psi': 0.9969251771628875}-{'f1_val': 0.9959123037929781, 'auprc': 0.9987353327684331, 'loss_val': 0.02468119715445798, 'psi': 0.9970415153831601}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=43 head_norm_before_train=1.953319 (no previous merge yet)
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.6694182975008913, 'auprc': 0.7213126372649872, 'loss_val': 0.9490701129838494, 'psi': 0.6901760334065297}-{'f1_val': 0.7279848944035553, 'auprc': 0.6946003658395669, 'loss_val': 1.0714872662617838, 'psi': 0.7146310829779599}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=43 head_norm_before_train=2.131262 (no previous merge yet)
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9956750968234162, 'loss_val': 0.027456614637283557, 'psi': 0.9964685436239655}-{'f1_val': 0.9965872316107504, 'auprc': 0.9971530115534817, 'loss_val': 0.023082302504830586, 'psi': 0.9968135435878429}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=43 head_norm_before_train=1.762191 cos_to_last_merge=0.9694 (last merge round=26)
[S15] round=43 local utility u=0.822108 metrics={'f1_val': 0.9963164379542544, 'auprc': 0.9988101954184954, 'loss_val': 0.023905224656811292, 'psi': 0.9973139409399507}-{'f1_val': 0.7776726199642368, 'auprc': 0.9978217142687341, 'loss_val': 0.3532934174515274, 'psi': 0.8657322576860357}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=43 head_norm_before_train=1.906502 cos_to_last_merge=0.9762 (last merge round=31)
[S16] round=43 local utility u=0.000000 metrics={'f1_val': 0.9608806702132523, 'auprc': 0.9961902735091815, 'loss_val': 0.11386799803318588, 'psi': 0.9750045115316239}-{'f1_val': 0.978877024681128, 'auprc': 0.9963697679312742, 'loss_val': 0.07637212157339432, 'psi': 0.9858741219811864}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=43 head_norm_before_train=1.990257 cos_to_last_merge=0.8033 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.803
[S17] round=43 local utility u=0.521008 metrics={'f1_val': 0.7914829649446551, 'auprc': 0.9369064346957408, 'loss_val': 0.7983550711904067, 'psi': 0.8496523528450893}-{'f1_val': 0.6565565333217844, 'auprc': 0.95201505915316, 'loss_val': 1.0761373549116584, 'psi': 0.7747399436543347}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S2] START round=44 head_norm_before_train=1.959585 cos_to_last_merge=0.9803 (last merge round=31)
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.6587413383729878, 'auprc': 0.7448812680591196, 'loss_val': 1.308110569623395, 'psi': 0.6931973102474405}-{'f1_val': 0.7222635502100333, 'auprc': 0.7398152728434606, 'loss_val': 1.0285079086818132, 'psi': 0.7292842392634042}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=44 head_norm_before_train=2.086585 cos_to_last_merge=0.9930 (last merge round=26)
[S3] round=44 local utility u=0.177973 metrics={'f1_val': 0.9973696976584205, 'auprc': 0.998306347122897, 'loss_val': 0.021994008419865825, 'psi': 0.9977443574442111}-{'f1_val': 0.9605709740356257, 'auprc': 0.9982602083868057, 'loss_val': 0.15700848180951388, 'psi': 0.9756466677760978}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=44 head_norm_before_train=1.706421 cos_to_last_merge=0.9499 (last merge round=29)
[S4] ⚠️ Model drifted since last merge! cos=0.950
[S4] round=44 local utility u=0.030754 metrics={'f1_val': 0.9489574775765814, 'auprc': 0.9634250691608404, 'loss_val': 0.29122918663401653, 'psi': 0.954744514210285}-{'f1_val': 0.9415500736309181, 'auprc': 0.9598919318561535, 'loss_val': 0.2976928915311592, 'psi': 0.9488868169210123}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] sending update (kind=head size=1805 to 1 peers)
[S5] START round=44 head_norm_before_train=1.662604 cos_to_last_merge=0.9958 (last merge round=31)
[S5] round=44 local utility u=0.104768 metrics={'f1_val': 0.7312396169680548, 'auprc': 0.9949645622788189, 'loss_val': 0.1535440946345821, 'psi': 0.8367295950923604}-{'f1_val': 0.7147298887569742, 'auprc': 0.9918137707518428, 'loss_val': 0.2545690083097212, 'psi': 0.8255634415549217}
[S5] not sending this round → trigger blocked (psi=0.837)
[S6] START round=44 head_norm_before_train=1.836873 cos_to_last_merge=0.9702 (last merge round=26)
[S6] round=44 local utility u=0.139605 metrics={'f1_val': 0.7936519630983719, 'auprc': 0.9646309144884705, 'loss_val': 0.39797320873497755, 'psi': 0.8620435436544114}-{'f1_val': 0.7657484163118131, 'auprc': 0.9563393113237457, 'loss_val': 0.4848880178415429, 'psi': 0.8419847743165861}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=44 head_norm_before_train=1.508460 cos_to_last_merge=0.9635 (last merge round=29)
[S7] round=44 local utility u=0.000000 metrics={'f1_val': 0.5429029832577466, 'auprc': 0.7813947053647894, 'loss_val': 0.8147466689715875, 'psi': 0.6382996721005637}-{'f1_val': 0.6806798359942003, 'auprc': 0.813468566177669, 'loss_val': 0.4183935692123666, 'psi': 0.7337953280675878}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=44 head_norm_before_train=1.964608 cos_to_last_merge=0.8013 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.801
[S8] round=44 local utility u=0.001887 metrics={'f1_val': 0.9939919029218467, 'auprc': 0.9992890621294631, 'loss_val': 0.03250389201794389, 'psi': 0.9961107666048933}-{'f1_val': 0.9936253371144965, 'auprc': 0.9990484352286642, 'loss_val': 0.033356275373110165, 'psi': 0.9957945763601637}
[S8] not sending this round → trigger blocked (psi=0.996)
[S9] START round=44 head_norm_before_train=1.762022 cos_to_last_merge=0.9867 (last merge round=26)
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.993814715591089, 'loss_val': 0.023671532355369427, 'psi': 0.9955413809952929}-{'f1_val': 0.9971029125121428, 'auprc': 0.9956167572065338, 'loss_val': 0.023175920843458774, 'psi': 0.9965084503898992}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=44 head_norm_before_train=1.784879 cos_to_last_merge=0.9542 (last merge round=26)
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.9940903254969471, 'auprc': 0.994198062298045, 'loss_val': 0.030458901723088298, 'psi': 0.9941334202173863}-{'f1_val': 0.9943096789853013, 'auprc': 0.9946463036472467, 'loss_val': 0.03019612035317581, 'psi': 0.9944443288500795}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=44 head_norm_before_train=1.820737 cos_to_last_merge=0.9642 (last merge round=29)
[S11] round=44 local utility u=0.001784 metrics={'f1_val': 0.9963294104943571, 'auprc': 0.9988336387109054, 'loss_val': 0.024651615665998963, 'psi': 0.9973311017809764}-{'f1_val': 0.9959123037929781, 'auprc': 0.9984444872177518, 'loss_val': 0.0245497876359201, 'psi': 0.9969251771628875}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] START round=44 head_norm_before_train=1.957529 (no previous merge yet)
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.6160879957040599, 'auprc': 0.6233607982912519, 'loss_val': 1.3225074983975802, 'psi': 0.6189971167389368}-{'f1_val': 0.6694182975008913, 'auprc': 0.7213126372649872, 'loss_val': 0.9490701129838494, 'psi': 0.6901760334065297}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=44 head_norm_before_train=2.136688 (no previous merge yet)
[S14] round=44 local utility u=0.005518 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9981182635977555, 'loss_val': 0.023750820777343754, 'psi': 0.9974458103337012}-{'f1_val': 0.9969975081576651, 'auprc': 0.9956750968234162, 'loss_val': 0.027456614637283557, 'psi': 0.9964685436239655}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=44 head_norm_before_train=1.773591 cos_to_last_merge=0.9684 (last merge round=26)
[S15] round=44 local utility u=0.000000 metrics={'f1_val': 0.9960225428652264, 'auprc': 0.9992845295741657, 'loss_val': 0.02478845509363352, 'psi': 0.9973273375488021}-{'f1_val': 0.9963164379542544, 'auprc': 0.9988101954184954, 'loss_val': 0.023905224656811292, 'psi': 0.9973139409399507}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=44 head_norm_before_train=1.922305 cos_to_last_merge=0.9750 (last merge round=31)
[S16] round=44 local utility u=0.000000 metrics={'f1_val': 0.9416136947830238, 'auprc': 0.9930700922906819, 'loss_val': 0.2223178157545505, 'psi': 0.9621962537860871}-{'f1_val': 0.9608806702132523, 'auprc': 0.9961902735091815, 'loss_val': 0.11386799803318588, 'psi': 0.9750045115316239}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=44 head_norm_before_train=2.002942 cos_to_last_merge=0.8025 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.802
[S17] round=44 local utility u=0.000000 metrics={'f1_val': 0.6304640292819872, 'auprc': 0.9276405309563573, 'loss_val': 1.2854178674042789, 'psi': 0.7493346299517352}-{'f1_val': 0.7914829649446551, 'auprc': 0.9369064346957408, 'loss_val': 0.7983550711904067, 'psi': 0.8496523528450893}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=45 head_norm_before_train=1.974829 cos_to_last_merge=0.9793 (last merge round=31)
[S2] round=45 local utility u=0.336089 metrics={'f1_val': 0.7106969030080578, 'auprc': 0.7570943726999502, 'loss_val': 0.9843051389876823, 'psi': 0.7292558908848148}-{'f1_val': 0.6587413383729878, 'auprc': 0.7448812680591196, 'loss_val': 1.308110569623395, 'psi': 0.6931973102474405}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=45 head_norm_before_train=2.094266 cos_to_last_merge=0.9926 (last merge round=26)
[S3] round=45 local utility u=0.000187 metrics={'f1_val': 0.9973696976584205, 'auprc': 0.998373329968903, 'loss_val': 0.021820690073731462, 'psi': 0.9977711505826135}-{'f1_val': 0.9973696976584205, 'auprc': 0.998306347122897, 'loss_val': 0.021994008419865825, 'psi': 0.9977443574442111}
[S3] not sending this round → trigger blocked (psi=0.998)
[S4] START round=45 head_norm_before_train=1.718411 cos_to_last_merge=0.9484 (last merge round=29)
[S4] ⚠️ Model drifted since last merge! cos=0.948
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.9404671527719253, 'auprc': 0.9654458599546546, 'loss_val': 0.3128374736730755, 'psi': 0.9504586356450171}-{'f1_val': 0.9489574775765814, 'auprc': 0.9634250691608404, 'loss_val': 0.29122918663401653, 'psi': 0.954744514210285}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=45 head_norm_before_train=1.665994 cos_to_last_merge=0.9954 (last merge round=31)
[S5] round=45 local utility u=0.808736 metrics={'f1_val': 0.9964794802860635, 'auprc': 0.9918776313505737, 'loss_val': 0.11824961912107317, 'psi': 0.9946387407118675}-{'f1_val': 0.7312396169680548, 'auprc': 0.9949645622788189, 'loss_val': 0.1535440946345821, 'psi': 0.8367295950923604}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[S6] START round=45 head_norm_before_train=1.853206 cos_to_last_merge=0.9694 (last merge round=26)
[S6] round=45 local utility u=0.000000 metrics={'f1_val': 0.6123848261290984, 'auprc': 0.777670882745861, 'loss_val': 0.878857236924001, 'psi': 0.6784992487758035}-{'f1_val': 0.7936519630983719, 'auprc': 0.9646309144884705, 'loss_val': 0.39797320873497755, 'psi': 0.8620435436544114}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=45 head_norm_before_train=1.514571 cos_to_last_merge=0.9624 (last merge round=29)
[S7] round=45 local utility u=0.382737 metrics={'f1_val': 0.619347538677367, 'auprc': 0.7950032941585707, 'loss_val': 0.5487657345574134, 'psi': 0.6896098408698486}-{'f1_val': 0.5429029832577466, 'auprc': 0.7813947053647894, 'loss_val': 0.8147466689715875, 'psi': 0.6382996721005637}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=45 head_norm_before_train=1.971731 cos_to_last_merge=0.8006 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.801
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.992174240363445, 'auprc': 0.9992747544382159, 'loss_val': 0.033046175334614694, 'psi': 0.9950144459933534}-{'f1_val': 0.9939919029218467, 'auprc': 0.9992890621294631, 'loss_val': 0.03250389201794389, 'psi': 0.9961107666048933}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=45 head_norm_before_train=1.768174 cos_to_last_merge=0.9861 (last merge round=26)
[S9] round=45 local utility u=0.005592 metrics={'f1_val': 0.9962461149658858, 'auprc': 0.9983772072298558, 'loss_val': 0.023497204078642298, 'psi': 0.9970985518714738}-{'f1_val': 0.9966924912647621, 'auprc': 0.993814715591089, 'loss_val': 0.023671532355369427, 'psi': 0.9955413809952929}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=45 head_norm_before_train=1.797593 cos_to_last_merge=0.9531 (last merge round=26)
[S10] round=45 local utility u=0.001740 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9941437914470045, 'loss_val': 0.029448608777334094, 'psi': 0.9943749806578384}-{'f1_val': 0.9940903254969471, 'auprc': 0.994198062298045, 'loss_val': 0.030458901723088298, 'psi': 0.9941334202173863}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=45 head_norm_before_train=1.833382 cos_to_last_merge=0.9633 (last merge round=29)
[S11] round=45 local utility u=0.000000 metrics={'f1_val': 0.9956275407172045, 'auprc': 0.9990907946826126, 'loss_val': 0.038392743769977554, 'psi': 0.9970128423033677}-{'f1_val': 0.9963294104943571, 'auprc': 0.9988336387109054, 'loss_val': 0.024651615665998963, 'psi': 0.9973311017809764}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=45 head_norm_before_train=1.961535 (no previous merge yet)
[S13] round=45 local utility u=0.439751 metrics={'f1_val': 0.6333403687637059, 'auprc': 0.7758669262546046, 'loss_val': 1.0040378964110737, 'psi': 0.6903509917600654}-{'f1_val': 0.6160879957040599, 'auprc': 0.6233607982912519, 'loss_val': 1.3225074983975802, 'psi': 0.6189971167389368}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=45 head_norm_before_train=2.145298 (no previous merge yet)
[S14] round=45 local utility u=0.000391 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9988467473445639, 'loss_val': 0.0226922728545171, 'psi': 0.9974910379042757}-{'f1_val': 0.9969975081576651, 'auprc': 0.9981182635977555, 'loss_val': 0.023750820777343754, 'psi': 0.9974458103337012}
[S14] not sending this round → trigger blocked (psi=0.997)
[S15] START round=45 head_norm_before_train=1.785105 cos_to_last_merge=0.9673 (last merge round=26)
[S15] round=45 local utility u=0.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9956556793886735, 'loss_val': 0.022163124003679802, 'psi': 0.9963102727879818}-{'f1_val': 0.9960225428652264, 'auprc': 0.9992845295741657, 'loss_val': 0.02478845509363352, 'psi': 0.9973273375488021}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=45 head_norm_before_train=1.933844 cos_to_last_merge=0.9741 (last merge round=31)
[S16] round=45 local utility u=0.000000 metrics={'f1_val': 0.936419473946697, 'auprc': 0.9904259036025815, 'loss_val': 0.3342899585743118, 'psi': 0.9580220458090507}-{'f1_val': 0.9416136947830238, 'auprc': 0.9930700922906819, 'loss_val': 0.2223178157545505, 'psi': 0.9621962537860871}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=45 head_norm_before_train=2.013428 cos_to_last_merge=0.8017 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.802
[S17] round=45 local utility u=1.000000 metrics={'f1_val': 0.9111764462296575, 'auprc': 0.9414564679381957, 'loss_val': 0.5013509908944075, 'psi': 0.9232884549130729}-{'f1_val': 0.6304640292819872, 'auprc': 0.9276405309563573, 'loss_val': 1.2854178674042789, 'psi': 0.7493346299517352}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=46 head_norm_before_train=1.990495 cos_to_last_merge=0.9784 (last merge round=31)
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.7106943329282904, 'auprc': 0.7608832382711799, 'loss_val': 1.0034298484395912, 'psi': 0.7307698950654462}-{'f1_val': 0.7106969030080578, 'auprc': 0.7570943726999502, 'loss_val': 0.9843051389876823, 'psi': 0.7292558908848148}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=46 head_norm_before_train=2.102266 cos_to_last_merge=0.9923 (last merge round=26)
[S3] round=46 local utility u=0.000000 metrics={'f1_val': 0.9851267008196317, 'auprc': 0.9981855657634449, 'loss_val': 0.04206199963074693, 'psi': 0.990350246797157}-{'f1_val': 0.9973696976584205, 'auprc': 0.998373329968903, 'loss_val': 0.021820690073731462, 'psi': 0.9977711505826135}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=46 head_norm_before_train=1.727183 cos_to_last_merge=0.9469 (last merge round=29)
[S4] ⚠️ Model drifted since last merge! cos=0.947
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.9392949055283588, 'auprc': 0.9696423260796369, 'loss_val': 0.3367587331919023, 'psi': 0.95143387374887}-{'f1_val': 0.9404671527719253, 'auprc': 0.9654458599546546, 'loss_val': 0.3128374736730755, 'psi': 0.9504586356450171}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=46 head_norm_before_train=1.668722 cos_to_last_merge=0.9951 (last merge round=31)
[S5] round=46 local utility u=0.029644 metrics={'f1_val': 0.9964794802860635, 'auprc': 0.9959741328626481, 'loss_val': 0.07125196765480486, 'psi': 0.9962773413166973}-{'f1_val': 0.9964794802860635, 'auprc': 0.9918776313505737, 'loss_val': 0.11824961912107317, 'psi': 0.9946387407118675}
[S5] not sending this round → trigger blocked (psi=0.996)
[S6] START round=46 head_norm_before_train=1.870415 cos_to_last_merge=0.9682 (last merge round=26)
[S6] round=46 local utility u=0.015911 metrics={'f1_val': 0.6075062572149337, 'auprc': 0.8868075689918742, 'loss_val': 1.145174832809339, 'psi': 0.7192267819257099}-{'f1_val': 0.6123848261290984, 'auprc': 0.777670882745861, 'loss_val': 0.878857236924001, 'psi': 0.6784992487758035}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=46 head_norm_before_train=1.519099 cos_to_last_merge=0.9616 (last merge round=29)
[S7] round=46 local utility u=0.159870 metrics={'f1_val': 0.6565563582544902, 'auprc': 0.801543706407966, 'loss_val': 0.4718996780876102, 'psi': 0.7145512975158805}-{'f1_val': 0.619347538677367, 'auprc': 0.7950032941585707, 'loss_val': 0.5487657345574134, 'psi': 0.6896098408698486}
[S7] not sending this round → trigger blocked (psi=0.715)
[S8] START round=46 head_norm_before_train=1.978327 cos_to_last_merge=0.8001 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.800
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.9925289693239863, 'auprc': 0.999070786538496, 'loss_val': 0.03556724077188666, 'psi': 0.9951456962097902}-{'f1_val': 0.992174240363445, 'auprc': 0.9992747544382159, 'loss_val': 0.033046175334614694, 'psi': 0.9950144459933534}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=46 head_norm_before_train=1.775249 cos_to_last_merge=0.9854 (last merge round=26)
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.9946069829493691, 'auprc': 0.9983692965950957, 'loss_val': 0.02684619685990248, 'psi': 0.9961119084076597}-{'f1_val': 0.9962461149658858, 'auprc': 0.9983772072298558, 'loss_val': 0.023497204078642298, 'psi': 0.9970985518714738}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=46 head_norm_before_train=1.808960 cos_to_last_merge=0.9521 (last merge round=26)
[S10] round=46 local utility u=0.000000 metrics={'f1_val': 0.9940903254969471, 'auprc': 0.9941912663308428, 'loss_val': 0.029933012249369163, 'psi': 0.9941307018305053}-{'f1_val': 0.9945291067983943, 'auprc': 0.9941437914470045, 'loss_val': 0.029448608777334094, 'psi': 0.9943749806578384}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=46 head_norm_before_train=1.846798 cos_to_last_merge=0.9624 (last merge round=29)
[S11] round=46 local utility u=0.010165 metrics={'f1_val': 0.9963500633431623, 'auprc': 0.9989778253581115, 'loss_val': 0.022059020540174265, 'psi': 0.997401168149142}-{'f1_val': 0.9956275407172045, 'auprc': 0.9990907946826126, 'loss_val': 0.038392743769977554, 'psi': 0.9970128423033677}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] START round=46 head_norm_before_train=1.966851 (no previous merge yet)
[S13] round=46 local utility u=0.338531 metrics={'f1_val': 0.7480824339265093, 'auprc': 0.729832488670711, 'loss_val': 0.877324871184002, 'psi': 0.74078245582419}-{'f1_val': 0.6333403687637059, 'auprc': 0.7758669262546046, 'loss_val': 1.0040378964110737, 'psi': 0.6903509917600654}
[S13] not sending this round → trigger blocked (psi=0.741)
[S14] START round=46 head_norm_before_train=2.150247 (no previous merge yet)
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9988494264949366, 'loss_val': 0.023223480596163373, 'psi': 0.9974921095644248}-{'f1_val': 0.9965872316107504, 'auprc': 0.9988467473445639, 'loss_val': 0.0226922728545171, 'psi': 0.9974910379042757}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=46 head_norm_before_train=1.795657 cos_to_last_merge=0.9664 (last merge round=26)
[S15] round=46 local utility u=0.000000 metrics={'f1_val': 0.9011920887978451, 'auprc': 0.9984363381327277, 'loss_val': 0.26903690865079644, 'psi': 0.9400897885317981}-{'f1_val': 0.9967466683875206, 'auprc': 0.9956556793886735, 'loss_val': 0.022163124003679802, 'psi': 0.9963102727879818}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=46 head_norm_before_train=1.937305 cos_to_last_merge=0.9740 (last merge round=31)
[S16] round=46 local utility u=0.053082 metrics={'f1_val': 0.9407794452004634, 'auprc': 0.9930068556675987, 'loss_val': 0.26202868709061505, 'psi': 0.9616704093873176}-{'f1_val': 0.936419473946697, 'auprc': 0.9904259036025815, 'loss_val': 0.3342899585743118, 'psi': 0.9580220458090507}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=46 head_norm_before_train=2.024355 cos_to_last_merge=0.8009 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.801
[S17] round=46 local utility u=0.000000 metrics={'f1_val': 0.6542367889161023, 'auprc': 0.9969968757182135, 'loss_val': 1.259805880721477, 'psi': 0.7913408236369468}-{'f1_val': 0.9111764462296575, 'auprc': 0.9414564679381957, 'loss_val': 0.5013509908944075, 'psi': 0.9232884549130729}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=47 head_norm_before_train=2.008296 cos_to_last_merge=0.9774 (last merge round=31)
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.6947460198267406, 'auprc': 0.7277000121325945, 'loss_val': 1.156083324178249, 'psi': 0.7079276167490821}-{'f1_val': 0.7106943329282904, 'auprc': 0.7608832382711799, 'loss_val': 1.0034298484395912, 'psi': 0.7307698950654462}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=47 head_norm_before_train=2.110565 cos_to_last_merge=0.9919 (last merge round=26)
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.9514838305425584, 'auprc': 0.9983653038486164, 'loss_val': 0.11663135232481434, 'psi': 0.9702364198649815}-{'f1_val': 0.9851267008196317, 'auprc': 0.9981855657634449, 'loss_val': 0.04206199963074693, 'psi': 0.990350246797157}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=47 head_norm_before_train=1.740751 cos_to_last_merge=0.9451 (last merge round=29)
[S4] ⚠️ Model drifted since last merge! cos=0.945
[S4] round=47 local utility u=0.004831 metrics={'f1_val': 0.9424931301669202, 'auprc': 0.9559744909464899, 'loss_val': 0.30528171475765725, 'psi': 0.947885674478748}-{'f1_val': 0.9392949055283588, 'auprc': 0.9696423260796369, 'loss_val': 0.3367587331919023, 'psi': 0.95143387374887}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=47 head_norm_before_train=1.676348 cos_to_last_merge=0.9945 (last merge round=31)
[S5] round=47 local utility u=0.000000 metrics={'f1_val': 0.9964794802860635, 'auprc': 0.9916557100352421, 'loss_val': 0.10683747941665699, 'psi': 0.9945499721857349}-{'f1_val': 0.9964794802860635, 'auprc': 0.9959741328626481, 'loss_val': 0.07125196765480486, 'psi': 0.9962773413166973}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=47 head_norm_before_train=1.882835 cos_to_last_merge=0.9668 (last merge round=26)
[S6] round=47 local utility u=0.749557 metrics={'f1_val': 0.7452059575924046, 'auprc': 0.9574003469503567, 'loss_val': 0.6840366715683619, 'psi': 0.8300837133355854}-{'f1_val': 0.6075062572149337, 'auprc': 0.8868075689918742, 'loss_val': 1.145174832809339, 'psi': 0.7192267819257099}
[S6] not sending this round → trigger blocked (psi=0.830)
[S7] START round=47 head_norm_before_train=1.529909 cos_to_last_merge=0.9596 (last merge round=29)
[S7] round=47 local utility u=0.000000 metrics={'f1_val': 0.5724677211468886, 'auprc': 0.78843168324369, 'loss_val': 0.7493528709689634, 'psi': 0.6588533059856092}-{'f1_val': 0.6565563582544902, 'auprc': 0.801543706407966, 'loss_val': 0.4718996780876102, 'psi': 0.7145512975158805}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=47 head_norm_before_train=1.981459 cos_to_last_merge=0.7998 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.800
[S8] round=47 local utility u=0.004293 metrics={'f1_val': 0.9926726816424898, 'auprc': 0.9992855206115356, 'loss_val': 0.02848844106146529, 'psi': 0.995317817230108}-{'f1_val': 0.9925289693239863, 'auprc': 0.999070786538496, 'loss_val': 0.03556724077188666, 'psi': 0.9951456962097902}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] sending update (kind=head size=1793 to 1 peers)
[S9] START round=47 head_norm_before_train=1.782583 cos_to_last_merge=0.9847 (last merge round=26)
[S9] round=47 local utility u=0.000296 metrics={'f1_val': 0.9946069829493691, 'auprc': 0.9983717176182968, 'loss_val': 0.026262107355494602, 'psi': 0.9961128768169402}-{'f1_val': 0.9946069829493691, 'auprc': 0.9983692965950957, 'loss_val': 0.02684619685990248, 'psi': 0.9961119084076597}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=47 head_norm_before_train=1.817537 cos_to_last_merge=0.9515 (last merge round=26)
[S10] round=47 local utility u=0.000148 metrics={'f1_val': 0.9940903254969471, 'auprc': 0.9944039663115146, 'loss_val': 0.030276086515185874, 'psi': 0.9942157818227741}-{'f1_val': 0.9940903254969471, 'auprc': 0.9941912663308428, 'loss_val': 0.029933012249369163, 'psi': 0.9941307018305053}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] sending update (kind=head size=1805 to 1 peers)
[S11] START round=47 head_norm_before_train=1.860105 cos_to_last_merge=0.9615 (last merge round=29)
[S11] round=47 local utility u=0.000546 metrics={'f1_val': 0.9963256330217796, 'auprc': 0.9989327105762484, 'loss_val': 0.020684672021535275, 'psi': 0.9973684640435672}-{'f1_val': 0.9963500633431623, 'auprc': 0.9989778253581115, 'loss_val': 0.022059020540174265, 'psi': 0.997401168149142}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=47 head_norm_before_train=1.975502 (no previous merge yet)
[S13] round=47 local utility u=0.000000 metrics={'f1_val': 0.7168062284702938, 'auprc': 0.6710035672307393, 'loss_val': 1.0567817441315293, 'psi': 0.698485163974472}-{'f1_val': 0.7480824339265093, 'auprc': 0.729832488670711, 'loss_val': 0.877324871184002, 'psi': 0.74078245582419}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=47 head_norm_before_train=2.155839 (no previous merge yet)
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.9965652232429598, 'auprc': 0.9987324675163667, 'loss_val': 0.028557577110256572, 'psi': 0.9974321209523226}-{'f1_val': 0.9965872316107504, 'auprc': 0.9988494264949366, 'loss_val': 0.023223480596163373, 'psi': 0.9974921095644248}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=47 head_norm_before_train=1.804913 cos_to_last_merge=0.9656 (last merge round=26)
[S15] round=47 local utility u=0.408233 metrics={'f1_val': 0.9963164379542544, 'auprc': 0.9989132857950944, 'loss_val': 0.024748711675592287, 'psi': 0.9973551770905904}-{'f1_val': 0.9011920887978451, 'auprc': 0.9984363381327277, 'loss_val': 0.26903690865079644, 'psi': 0.9400897885317981}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=47 head_norm_before_train=1.945407 cos_to_last_merge=0.9734 (last merge round=31)
[S16] round=47 local utility u=0.000000 metrics={'f1_val': 0.9155016918950794, 'auprc': 0.9189868756547137, 'loss_val': 0.4949664242441439, 'psi': 0.916895765398933}-{'f1_val': 0.9407794452004634, 'auprc': 0.9930068556675987, 'loss_val': 0.26202868709061505, 'psi': 0.9616704093873176}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=47 head_norm_before_train=2.037894 cos_to_last_merge=0.8000 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.800
[S17] round=47 local utility u=0.194345 metrics={'f1_val': 0.7125890097014169, 'auprc': 0.9582599427518883, 'loss_val': 1.1050180353849979, 'psi': 0.8108573829216055}-{'f1_val': 0.6542367889161023, 'auprc': 0.9969968757182135, 'loss_val': 1.259805880721477, 'psi': 0.7913408236369468}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S17] sending update (kind=head size=1792 to 1 peers)
[S2] START round=48 head_norm_before_train=2.025088 cos_to_last_merge=0.9764 (last merge round=31)
[S2] round=48 local utility u=0.000000 metrics={'f1_val': 0.6220849083376283, 'auprc': 0.7136867169569652, 'loss_val': 1.8249302587811664, 'psi': 0.6587256317853631}-{'f1_val': 0.6947460198267406, 'auprc': 0.7277000121325945, 'loss_val': 1.156083324178249, 'psi': 0.7079276167490821}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=48 head_norm_before_train=2.119330 cos_to_last_merge=0.9915 (last merge round=26)
[S3] round=48 local utility u=0.011107 metrics={'f1_val': 0.9611152572344858, 'auprc': 0.9986812181274016, 'loss_val': 0.15315371088837826, 'psi': 0.9761416415916522}-{'f1_val': 0.9514838305425584, 'auprc': 0.9983653038486164, 'loss_val': 0.11663135232481434, 'psi': 0.9702364198649815}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=48 head_norm_before_train=1.745960 cos_to_last_merge=0.9436 (last merge round=29)
[S4] ⚠️ Model drifted since last merge! cos=0.944
[S4] round=48 local utility u=0.000000 metrics={'f1_val': 0.9410873383314377, 'auprc': 0.9600047153308826, 'loss_val': 0.312407008718598, 'psi': 0.9486542891312156}-{'f1_val': 0.9424931301669202, 'auprc': 0.9559744909464899, 'loss_val': 0.30528171475765725, 'psi': 0.947885674478748}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=48 head_norm_before_train=1.689736 cos_to_last_merge=0.9935 (last merge round=31)
[S5] round=48 local utility u=0.008514 metrics={'f1_val': 0.9964794802860635, 'auprc': 0.9916040103630541, 'loss_val': 0.0896549803157026, 'psi': 0.9945292923168597}-{'f1_val': 0.9964794802860635, 'auprc': 0.9916557100352421, 'loss_val': 0.10683747941665699, 'psi': 0.9945499721857349}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] sending update (kind=head size=1795 to 1 peers)
[S6] START round=48 head_norm_before_train=1.891568 cos_to_last_merge=0.9653 (last merge round=26)
[S6] round=48 local utility u=0.000000 metrics={'f1_val': 0.6195438699551872, 'auprc': 0.9513946374989904, 'loss_val': 0.7446970262751741, 'psi': 0.7522841769727084}-{'f1_val': 0.7452059575924046, 'auprc': 0.9574003469503567, 'loss_val': 0.6840366715683619, 'psi': 0.8300837133355854}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=48 head_norm_before_train=1.539336 cos_to_last_merge=0.9578 (last merge round=29)
[S7] round=48 local utility u=0.108943 metrics={'f1_val': 0.5958962213218029, 'auprc': 0.7902358714189368, 'loss_val': 0.677451423853735, 'psi': 0.6736320813606564}-{'f1_val': 0.5724677211468886, 'auprc': 0.78843168324369, 'loss_val': 0.7493528709689634, 'psi': 0.6588533059856092}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=48 head_norm_before_train=1.991491 cos_to_last_merge=0.7992 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.799
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.9871538275294434, 'auprc': 0.9984354620093119, 'loss_val': 0.0469200152507285, 'psi': 0.9916664813213908}-{'f1_val': 0.9926726816424898, 'auprc': 0.9992855206115356, 'loss_val': 0.02848844106146529, 'psi': 0.995317817230108}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=48 head_norm_before_train=1.789662 cos_to_last_merge=0.9843 (last merge round=26)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.9929348022347503, 'auprc': 0.998372358088946, 'loss_val': 0.030733530329096946, 'psi': 0.9951098245764285}-{'f1_val': 0.9946069829493691, 'auprc': 0.9983717176182968, 'loss_val': 0.026262107355494602, 'psi': 0.9961128768169402}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=48 head_norm_before_train=1.825234 cos_to_last_merge=0.9509 (last merge round=26)
[S10] round=48 local utility u=0.001715 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9941905443757402, 'loss_val': 0.02883879818920859, 'psi': 0.9943936818293326}-{'f1_val': 0.9940903254969471, 'auprc': 0.9944039663115146, 'loss_val': 0.030276086515185874, 'psi': 0.9942157818227741}
[S10] not sending this round → trigger blocked (psi=0.994)
[S11] START round=48 head_norm_before_train=1.872930 cos_to_last_merge=0.9608 (last merge round=29)
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9985625448577014, 'loss_val': 0.0215907678866634, 'psi': 0.9973655003268087}-{'f1_val': 0.9963256330217796, 'auprc': 0.9989327105762484, 'loss_val': 0.020684672021535275, 'psi': 0.9973684640435672}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=48 head_norm_before_train=1.983205 (no previous merge yet)
[S13] round=48 local utility u=0.000000 metrics={'f1_val': 0.6241110844419677, 'auprc': 0.6313520515565597, 'loss_val': 1.2988780516580674, 'psi': 0.6270074712878045}-{'f1_val': 0.7168062284702938, 'auprc': 0.6710035672307393, 'loss_val': 1.0567817441315293, 'psi': 0.698485163974472}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=48 head_norm_before_train=2.162044 (no previous merge yet)
[S14] round=48 local utility u=0.003048 metrics={'f1_val': 0.9965652232429598, 'auprc': 0.9988503140656044, 'loss_val': 0.022816039816997282, 'psi': 0.9974792595720177}-{'f1_val': 0.9965652232429598, 'auprc': 0.9987324675163667, 'loss_val': 0.028557577110256572, 'psi': 0.9974321209523226}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=48 head_norm_before_train=1.814502 cos_to_last_merge=0.9647 (last merge round=26)
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.9507483734480218, 'auprc': 0.9989140746233298, 'loss_val': 0.10918266102157365, 'psi': 0.970014653918145}-{'f1_val': 0.9963164379542544, 'auprc': 0.9989132857950944, 'loss_val': 0.024748711675592287, 'psi': 0.9973551770905904}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=48 head_norm_before_train=1.951306 cos_to_last_merge=0.9730 (last merge round=31)
[S16] round=48 local utility u=0.044015 metrics={'f1_val': 0.9140778824941558, 'auprc': 0.9497178085581734, 'loss_val': 0.49058637318638426, 'psi': 0.9283338529197629}-{'f1_val': 0.9155016918950794, 'auprc': 0.9189868756547137, 'loss_val': 0.4949664242441439, 'psi': 0.916895765398933}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=48 head_norm_before_train=2.048262 cos_to_last_merge=0.7991 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.799
[S17] round=48 local utility u=0.444590 metrics={'f1_val': 0.845354214651198, 'auprc': 0.843813688928363, 'loss_val': 0.66909079083157, 'psi': 0.844738004362064}-{'f1_val': 0.7125890097014169, 'auprc': 0.9582599427518883, 'loss_val': 1.1050180353849979, 'psi': 0.8108573829216055}
[S17] not sending this round → trigger blocked (psi=0.845)
[S2] START round=49 head_norm_before_train=2.036820 cos_to_last_merge=0.9756 (last merge round=31)
[S2] round=49 local utility u=0.355141 metrics={'f1_val': 0.6722623837332611, 'auprc': 0.7137138945782613, 'loss_val': 1.4157943181469612, 'psi': 0.6888429880712612}-{'f1_val': 0.6220849083376283, 'auprc': 0.7136867169569652, 'loss_val': 1.8249302587811664, 'psi': 0.6587256317853631}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S2] sending update (kind=head size=1789 to 1 peers)
[S3] START round=49 head_norm_before_train=2.126153 cos_to_last_merge=0.9910 (last merge round=26)
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.9569422228881527, 'auprc': 0.9991473130707949, 'loss_val': 0.136434701054075, 'psi': 0.9738242589612096}-{'f1_val': 0.9611152572344858, 'auprc': 0.9986812181274016, 'loss_val': 0.15315371088837826, 'psi': 0.9761416415916522}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=49 head_norm_before_train=1.754792 cos_to_last_merge=0.9424 (last merge round=29)
[S4] ⚠️ Model drifted since last merge! cos=0.942
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.9371684838580788, 'auprc': 0.9351243737248196, 'loss_val': 0.3640675768126694, 'psi': 0.9363508398047752}-{'f1_val': 0.9410873383314377, 'auprc': 0.9600047153308826, 'loss_val': 0.312407008718598, 'psi': 0.9486542891312156}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=49 head_norm_before_train=1.699558 cos_to_last_merge=0.9926 (last merge round=31)
[S5] round=49 local utility u=0.028176 metrics={'f1_val': 0.996625909096903, 'auprc': 0.9974993932530534, 'loss_val': 0.05186797998923417, 'psi': 0.9969753027593632}-{'f1_val': 0.9964794802860635, 'auprc': 0.9916040103630541, 'loss_val': 0.0896549803157026, 'psi': 0.9945292923168597}
[S5] not sending this round → trigger blocked (psi=0.997)
[S6] START round=49 head_norm_before_train=1.899167 cos_to_last_merge=0.9640 (last merge round=26)
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.6074609921489558, 'auprc': 0.929161087274379, 'loss_val': 0.9349702768166848, 'psi': 0.736141030199125}-{'f1_val': 0.6195438699551872, 'auprc': 0.9513946374989904, 'loss_val': 0.7446970262751741, 'psi': 0.7522841769727084}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=49 head_norm_before_train=1.546346 cos_to_last_merge=0.9565 (last merge round=29)
[S7] round=49 local utility u=0.026404 metrics={'f1_val': 0.6019940400066348, 'auprc': 0.7853639175698447, 'loss_val': 0.6466148597163462, 'psi': 0.6753419910319187}-{'f1_val': 0.5958962213218029, 'auprc': 0.7902358714189368, 'loss_val': 0.677451423853735, 'psi': 0.6736320813606564}
[S7] not sending this round → trigger blocked (psi=0.675)
[S8] START round=49 head_norm_before_train=2.000941 cos_to_last_merge=0.7981 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.798
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.7140170479737811, 'auprc': 0.9891081440936833, 'loss_val': 0.5398453739133677, 'psi': 0.8240534864217419}-{'f1_val': 0.9871538275294434, 'auprc': 0.9984354620093119, 'loss_val': 0.0469200152507285, 'psi': 0.9916664813213908}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=49 head_norm_before_train=1.796777 cos_to_last_merge=0.9838 (last merge round=26)
[S9] round=49 local utility u=0.016352 metrics={'f1_val': 0.9966891482978385, 'auprc': 0.9987488577835075, 'loss_val': 0.021685620049775374, 'psi': 0.9975130320921062}-{'f1_val': 0.9929348022347503, 'auprc': 0.998372358088946, 'loss_val': 0.030733530329096946, 'psi': 0.9951098245764285}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=49 head_norm_before_train=1.835053 cos_to_last_merge=0.9501 (last merge round=26)
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.9940903254969471, 'auprc': 0.9942313185317245, 'loss_val': 0.02962172811227697, 'psi': 0.994146722710858}-{'f1_val': 0.9945291067983943, 'auprc': 0.9941905443757402, 'loss_val': 0.02883879818920859, 'psi': 0.9943936818293326}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=49 head_norm_before_train=1.883944 cos_to_last_merge=0.9605 (last merge round=29)
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.9963256330217796, 'auprc': 0.9982712582679707, 'loss_val': 0.02255282057646137, 'psi': 0.9971038831202561}-{'f1_val': 0.996567470639547, 'auprc': 0.9985625448577014, 'loss_val': 0.0215907678866634, 'psi': 0.9973655003268087}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=49 head_norm_before_train=1.996715 (no previous merge yet)
[S13] round=49 local utility u=0.127578 metrics={'f1_val': 0.6398550589508863, 'auprc': 0.6389519211464372, 'loss_val': 1.1609852227174802, 'psi': 0.6394938038291067}-{'f1_val': 0.6241110844419677, 'auprc': 0.6313520515565597, 'loss_val': 1.2988780516580674, 'psi': 0.6270074712878045}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] sending update (kind=head size=1794 to 1 peers)
[S14] START round=49 head_norm_before_train=2.169193 (no previous merge yet)
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9988502109529958, 'loss_val': 0.022964811705734743, 'psi': 0.9974924233476485}-{'f1_val': 0.9965652232429598, 'auprc': 0.9988503140656044, 'loss_val': 0.022816039816997282, 'psi': 0.9974792595720177}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=49 head_norm_before_train=1.824169 cos_to_last_merge=0.9639 (last merge round=26)
[S15] round=49 local utility u=0.138296 metrics={'f1_val': 0.9850571630700105, 'auprc': 0.998999018668641, 'loss_val': 0.03869759251778688, 'psi': 0.9906339053094626}-{'f1_val': 0.9507483734480218, 'auprc': 0.9989140746233298, 'loss_val': 0.10918266102157365, 'psi': 0.970014653918145}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=49 head_norm_before_train=1.960119 cos_to_last_merge=0.9724 (last merge round=31)
[S16] round=49 local utility u=0.242684 metrics={'f1_val': 0.938923098455456, 'auprc': 0.9932909030022831, 'loss_val': 0.2850085079116537, 'psi': 0.9606702202741868}-{'f1_val': 0.9140778824941558, 'auprc': 0.9497178085581734, 'loss_val': 0.49058637318638426, 'psi': 0.9283338529197629}
[S16] not sending this round → trigger blocked (psi=0.961)
[S17] START round=49 head_norm_before_train=2.058022 cos_to_last_merge=0.7984 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.798
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.6140713258166052, 'auprc': 0.8092598413113501, 'loss_val': 1.4260700332747978, 'psi': 0.6921467320145032}-{'f1_val': 0.845354214651198, 'auprc': 0.843813688928363, 'loss_val': 0.66909079083157, 'psi': 0.844738004362064}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[runner] rounds complete.
[runner] all agents stopped.
