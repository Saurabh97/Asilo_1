[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:58303
[S3] → join 127.0.0.1:58302
[S4] → join 127.0.0.1:58302
[S5] → join 127.0.0.1:58302
[S6] → join 127.0.0.1:58302
[S7] → join 127.0.0.1:58302
[S8] → join 127.0.0.1:58302
[S9] → join 127.0.0.1:58302
[S10] → join 127.0.0.1:58302
[S11] → join 127.0.0.1:58302
[S13] → join 127.0.0.1:58302
[S14] → join 127.0.0.1:58302
[S15] → join 127.0.0.1:58302
[S16] → join 127.0.0.1:58302
[S17] → join 127.0.0.1:58302
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.127885 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.165845 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.187222 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.213923 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.110739 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.159302 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.128660 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.144787 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.115232 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.167059 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.133612 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.236808 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.200397 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.143811 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.147058 (no previous merge yet)
[S11]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S3] + discovered S15
[S3] + discovered S6
[S3] + discovered S14
[S3] + discovered S13
[S3] + discovered S4
[S3] + discovered S11
[S3] + discovered S5
[S4] + discovered S2
[S4] + discovered S3
[S3] + discovered S10
[S3] + discovered S9
[S3] + discovered S17
[S3] + discovered S8
[S3] + discovered S16
[S3] + discovered S7
[S4] + discovered S8
[S4] + discovered S9
[S4] + discovered S17
[S4] + discovered S10
[S4] + discovered S16
[S4] + discovered S7
[S4] + discovered S15
[S4] + discovered S6
[S4] + discovered S14
[S4] + discovered S13
[S4] + discovered S11
[S4] + discovered S5
[S5] + discovered S2
[S5] + discovered S3
[S5] + discovered S4
[S6] + discovered S5
[S6] + discovered S3
[S6] + discovered S4
[S6] + discovered S2
[S5] + discovered S14
[S5] + discovered S15
[S5] + discovered S16
[S5] + discovered S17
[S5] + discovered S9
[S5] + discovered S11
[S5] + discovered S13
[S5] + discovered S6
[S5] + discovered S7
[S5] + discovered S10
[S5] + discovered S8
[S6] + discovered S17
[S7] + discovered S5
[S6] + discovered S13
[S7] + discovered S4
[S6] + discovered S10
[S6] + discovered S9
[S7] + discovered S6
[S6] + discovered S15
[S6] + discovered S7
[S6] + discovered S14
[S6] + discovered S16
[S7] + discovered S3
[S7] + discovered S2
[S6] + discovered S8
[S6] + discovered S11
[S7] + discovered S14
[S7] + discovered S16
[S7] + discovered S8
[S7] + discovered S10
[S7] + discovered S17
[S7] + discovered S11
[S7] + discovered S15
[S7] + discovered S13
[S8] + discovered S6
[S8] + discovered S2
[S8] + discovered S3
[S8] + discovered S7
[S8] + discovered S5
[S8] + discovered S4
[S7] + discovered S9
[S8] + discovered S11
[S8] + discovered S16
[S8] + discovered S9
[S8] + discovered S14
[S8] + discovered S13
[S8] + discovered S15
[S8] + discovered S17
[S8] + discovered S10
[S9] + discovered S8
[S9] + discovered S3
[S9] + discovered S2
[S9] + discovered S7
[S9] + discovered S5
[S9] + discovered S4
[S9] + discovered S6
[S10] + discovered S9
[S10] + discovered S2
[S10] + discovered S7
[S10] + discovered S5
[S10] + discovered S4
[S10] + discovered S3
[S10] + discovered S6
[S10] + discovered S8
[S9] + discovered S16
[S9] + discovered S11
[S9] + discovered S17
[S9] + discovered S15
[S9] + discovered S10
[S9] + discovered S13
[S9] + discovered S14
[S11] + discovered S5
[S10] + discovered S11
[S11] + discovered S10
[S10] + discovered S13
[S11] + discovered S7
[S11] + discovered S4
[S10] + discovered S14
[S10] + discovered S15
[S10] + discovered S17
[S11] + discovered S3
[S11] + discovered S6
[S11] + discovered S8
[S11] + discovered S9
[S11] + discovered S2
[S10] + discovered S16
[S13] + discovered S11
[S13] + discovered S10
[S13] + discovered S6
[S13] + discovered S3
[S13] + discovered S8
[S13] + discovered S5
[S13] + discovered S7
[S13] + discovered S9
[S13] + discovered S4
[S13] + discovered S2
[S11] + discovered S13
[S11] + discovered S17
[S11] + discovered S14
[S11] + discovered S15
[S11] + discovered S16
[S13] + discovered S16
[S13] + discovered S15
[S13] + discovered S17
[S14] + discovered S5
[S13] + discovered S14
[S14] + discovered S3
[S14] + discovered S13
[S14] + discovered S2
[S14] + discovered S9
[S14] + discovered S4
[S14] + discovered S7
[S14] + discovered S8
[S14] + discovered S6
[S14] + discovered S10
[S14] + discovered S11
[S14] + discovered S15
[S14] + discovered S17
[S14] + discovered S16
[S15] + discovered S11
[S15] + discovered S6
[S15] + discovered S7
[S15] + discovered S9
[S15] + discovered S2
[S15] + discovered S3
[S15] + discovered S5
[S15] + discovered S10
[S15] + discovered S8
[S15] + discovered S14
[S15] + discovered S4
[S15] + discovered S13
[S16] + discovered S14
[S16] + discovered S10
[S16] + discovered S15
[S16] + discovered S9
[S16] + discovered S6
[S16] + discovered S3
[S16] + discovered S13
[S16] + discovered S4
[S16] + discovered S8
[S16] + discovered S5
[S16] + discovered S2
[S16] + discovered S7
[S16] + discovered S11
[S15] + discovered S16
[S15] + discovered S17
[S17] + discovered S10
[S17] + discovered S6
[S17] + discovered S7
[S17] + discovered S14
[S17] + discovered S3
[S17] + discovered S13
[S17] + discovered S5
[S17] + discovered S9
[S16] + discovered S17
[S17] + discovered S15
[S17] + discovered S16
[S17] + discovered S11
[S17] + discovered S4
[S17] + discovered S2
[S17] + discovered S8
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] ⇄ pheromone p=1.000 → S5@127.0.0.1:58305
[S4] ⇄ pheromone p=1.000 → S11@127.0.0.1:58312
[S2] ⇄ pheromone p=1.000 → S5@127.0.0.1:58305
[S13] ⇄ pheromone p=1.000 → S10@127.0.0.1:58311
[S14] ⇄ pheromone p=1.000 → S11@127.0.0.1:58312
[S5] ⇄ pheromone p=1.000 → S16@127.0.0.1:58316
[S10] ⇄ pheromone p=1.000 → S13@127.0.0.1:58313
[S7] ⇄ pheromone p=1.000 → S14@127.0.0.1:58314
[S15] ⇄ pheromone p=1.000 → S5@127.0.0.1:58305
[S11] ⇄ pheromone p=1.000 → S14@127.0.0.1:58314
[S6] ⇄ pheromone p=1.000 → S9@127.0.0.1:58310
[S8] ⇄ pheromone p=1.000 → S7@127.0.0.1:58308
[S9] ⇄ pheromone p=1.000 → S6@127.0.0.1:58307
[S16] ⇄ pheromone p=1.000 → S6@127.0.0.1:58307
[S17] ⇄ pheromone p=1.000 → S9@127.0.0.1:58310
[S2] START round=1 head_norm_before_train=1.145029 (no previous merge yet)
[S2] round=1 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7445648594408449, 'loss_val': 1.246483851641258, 'psi': 0.382892223809478}-{'f1_val': 0.40027894936281333, 'auprc': 0.5549639735937126, 'loss_val': 1.3361238149362975, 'psi': 0.46215295905517306}
[S3] START round=1 head_norm_before_train=1.175160 (no previous merge yet)
[S3] round=1 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8505320993299454, 'loss_val': 1.3206664512180368, 'psi': 0.4241168791004424}-{'f1_val': 0.27389624879950286, 'auprc': 0.7607592289602041, 'loss_val': 1.3532880512618997, 'psi': 0.46864144086378334}
[S4] START round=1 head_norm_before_train=1.202346 (no previous merge yet)
[S4] round=1 local utility u=0.171018 metrics={'f1_val': 0.4146850260251823, 'auprc': 0.7763482749542315, 'loss_val': 1.2656949506162292, 'psi': 0.559350325596802}-{'f1_val': 0.37953317844286866, 'auprc': 0.7570269806445004, 'loss_val': 1.3388564887386847, 'psi': 0.5305306993235214}
[S5] START round=1 head_norm_before_train=1.215018 (no previous merge yet)
[S5] round=1 local utility u=0.045733 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.5777825351916972, 'loss_val': 1.3198633988826647, 'psi': 0.31647015693382174}-{'f1_val': 0.14229013693193093, 'auprc': 0.5573640650423538, 'loss_val': 1.3502434163307704, 'psi': 0.3083197081761001}
[S6] START round=1 head_norm_before_train=1.134294 (no previous merge yet)
[S6] round=1 local utility u=0.269438 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8550857098417108, 'loss_val': 1.267454572490687, 'psi': 0.42689005316745354}-{'f1_val': 0.14142628205128205, 'auprc': 0.6953033813641947, 'loss_val': 1.3269832202828642, 'psi': 0.3629771217764471}
[S7] START round=1 head_norm_before_train=1.170572 (no previous merge yet)
[S7] round=1 local utility u=0.131678 metrics={'f1_val': 0.14211369095276222, 'auprc': 0.778434137944916, 'loss_val': 1.3353287493809596, 'psi': 0.3966418697496238}-{'f1_val': 0.105787934718529, 'auprc': 0.7743619748842563, 'loss_val': 1.3685138808160116, 'psi': 0.37321755078481994}
[S8] START round=1 head_norm_before_train=1.140893 (no previous merge yet)
[S8] round=1 local utility u=0.098205 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7402999510864509, 'loss_val': 1.286373561084875, 'psi': 0.3800935698703547}-{'f1_val': 0.10450549450549451, 'auprc': 0.7660122988865076, 'loss_val': 1.3472167764029555, 'psi': 0.36910821625789975}
[S9] START round=1 head_norm_before_train=1.146235 (no previous merge yet)
[S9] round=1 local utility u=1.000000 metrics={'f1_val': 0.38109043756074557, 'auprc': 0.8649656563640611, 'loss_val': 1.3338415124753762, 'psi': 0.5746405250820719}-{'f1_val': 0.08895775941230487, 'auprc': 0.7925554086454666, 'loss_val': 1.3741465565385613, 'psi': 0.3703968191055696}
[S10] START round=1 head_norm_before_train=1.123265 (no previous merge yet)
[S10] round=1 local utility u=0.038290 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.776145225255936, 'loss_val': 1.2721036414132239, 'psi': 0.39363107262740876}-{'f1_val': 0.13862163754172394, 'auprc': 0.7682150775091823, 'loss_val': 1.3248922433773067, 'psi': 0.39045901352870727}
[S11] START round=1 head_norm_before_train=1.173033 (no previous merge yet)
[S11] round=1 local utility u=0.273333 metrics={'f1_val': 0.17291207445505755, 'auprc': 0.8199616762715674, 'loss_val': 1.328281146554705, 'psi': 0.4317319151816615}-{'f1_val': 0.0921497856981728, 'auprc': 0.811481769407382, 'loss_val': 1.3649337806235529, 'psi': 0.37988257918185653}
[S13] START round=1 head_norm_before_train=1.145887 (no previous merge yet)
[S13] round=1 local utility u=0.163735 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6381029358235505, 'loss_val': 1.2830065906324482, 'psi': 0.3394726318756521}-{'f1_val': 0.1403857625770531, 'auprc': 0.5470594439820072, 'loss_val': 1.3373452440923166, 'psi': 0.30305523513903476}
[S14] START round=1 head_norm_before_train=1.233545 (no previous merge yet)
[S14] round=1 local utility u=0.578679 metrics={'f1_val': 0.2851916705612798, 'auprc': 0.7823678928805551, 'loss_val': 1.356357512949253, 'psi': 0.4840621594889899}-{'f1_val': 0.09155565590426733, 'auprc': 0.7935365106073012, 'loss_val': 1.3854056126558452, 'psi': 0.3723479977854809}
[S15] START round=1 head_norm_before_train=1.188895 (no previous merge yet)
[S15] round=1 local utility u=0.237371 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.6602304133279067, 'loss_val': 1.327124114234249, 'psi': 0.3479323561480977}-{'f1_val': 0.19484789816875708, 'auprc': 0.41025464888380436, 'loss_val': 1.3826233058813677, 'psi': 0.281010598454776}
[S16] START round=1 head_norm_before_train=1.146587 (no previous merge yet)
[S16] round=1 local utility u=0.534402 metrics={'f1_val': 0.16686376537369915, 'auprc': 0.7254392258480262, 'loss_val': 1.3414149067994625, 'psi': 0.39029394956343}-{'f1_val': 0.10824742268041238, 'auprc': 0.49768787541353127, 'loss_val': 1.3752674990635947, 'psi': 0.26402360377365997}
[S17] START round=1 head_norm_before_train=1.154510 (no previous merge yet)
[S17] round=1 local utility u=0.081593 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5326552409041041, 'loss_val': 1.276405275321254, 'psi': 0.29763147435207227}-{'f1_val': 0.14094896331738438, 'auprc': 0.4950504913662248, 'loss_val': 1.3267773719232951, 'psi': 0.2825895745369206}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S7@127.0.0.1:58308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S7] → sending delta(kind=head bytes=1789) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:58302
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:58316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S11] → sending delta(kind=head bytes=1788) to S16@127.0.0.1:58316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:58317
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:58309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:58307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S9] → sending delta(kind=head bytes=1786) to S14@127.0.0.1:58314
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] → sending delta(kind=head bytes=1792) to S15@127.0.0.1:58315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S14] → sending delta(kind=head bytes=1789) to S16@127.0.0.1:58316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1784 reason=None
[S5] → sending delta(kind=head bytes=1784) to S9@127.0.0.1:58310
[S10] sending update (kind=head size=1792 to 1 peers)
[S14] sending update (kind=head size=1789 to 1 peers)
[S9] sending update (kind=head size=1786 to 1 peers)
[S8] sending update (kind=head size=1793 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1788 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1784 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1789 to 1 peers)
[S6] sending update (kind=head size=1794 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1797) from S13
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.177840)
[S17] loaded HEAD from S13 (vec_in norm=1.177840)
[S17] cosine check vs S13: cos=-0.0136
[S17] DROPPED delta from S13 (cos=-0.0136 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1789) from S14
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.241377)
[S16] loaded HEAD from S14 (vec_in norm=1.241377)
[S16] cosine check vs S14: cos=-0.1338
[S16] DROPPED delta from S14 (cos=-0.1338 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1788) from S11
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.188426)
[S16] loaded HEAD from S11 (vec_in norm=1.188426)
[S16] cosine check vs S11: cos=-0.0946
[S16] DROPPED delta from S11 (cos=-0.0946 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1795) from S15
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.207560)
[S16] loaded HEAD from S15 (vec_in norm=1.207560)
[S16] cosine check vs S15: cos=0.0332
[S16] BUFFERED delta from S15 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1799) from S4
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.244127)
[S2] loaded HEAD from S4 (vec_in norm=1.244127)
[S2] cosine check vs S4: cos=-0.0505
[S2] DROPPED delta from S4 (cos=-0.0505 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1793) from S8
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.177510)
[S6] loaded HEAD from S8 (vec_in norm=1.177510)
[S6] cosine check vs S8: cos=-0.0120
[S6] DROPPED delta from S8 (cos=-0.0120 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1792) from S10
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.156348)
[S15] loaded HEAD from S10 (vec_in norm=1.156348)
[S15] cosine check vs S10: cos=0.0001
[S15] BUFFERED delta from S10 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1786) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.156016)
[S14] loaded HEAD from S9 (vec_in norm=1.156016)
[S14] cosine check vs S9: cos=0.0161
[S14] BUFFERED delta from S9 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1789) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.189685)
[S14] loaded HEAD from S7 (vec_in norm=1.189685)
[S14] cosine check vs S7: cos=0.0141
[S14] BUFFERED delta from S7 (total buffered=2)
[S8] RECEIVED delta(kind=head bytes=1799) from S16
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.161661)
[S8] loaded HEAD from S16 (vec_in norm=1.161661)
[S8] cosine check vs S16: cos=-0.0159
[S8] DROPPED delta from S16 (cos=-0.0159 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1794) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.179436)
[S7] loaded HEAD from S6 (vec_in norm=1.179436)
[S7] cosine check vs S6: cos=-0.0559
[S7] DROPPED delta from S6 (cos=-0.0559 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1784) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.226099)
[S9] loaded HEAD from S5 (vec_in norm=1.226099)
[S9] cosine check vs S5: cos=0.1220
[S9] BUFFERED delta from S5 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S17] → sending delta(kind=head bytes=1790) to S13@127.0.0.1:58313
[S17] sending update (kind=head size=1790 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1790) from S17
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.190024)
[S13] loaded HEAD from S17 (vec_in norm=1.190024)
[S13] cosine check vs S17: cos=-0.0136
[S13] DROPPED delta from S17 (cos=-0.0136 < 0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=1 metric=0.1669 head_norm=1.161661
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.237820e-01
[S16] stored merged vector for next round verification (round=1)
[S16] DEBUG after merge:  round=1 metric=0.3830 head_norm=0.851593 delta_norm=0.823782
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=1 metric=0.2852 head_norm=1.241377
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.391061e-01
[S14] stored merged vector for next round verification (round=1)
[S14] DEBUG after merge:  round=1 metric=0.0916 head_norm=0.753802 delta_norm=0.739106
[S14] aggregate: ROLLBACK (f1_val pre=0.285 post=0.092 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=1 metric=0.3811 head_norm=1.156016
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.895852e-01
[S9] stored merged vector for next round verification (round=1)
[S9] DEBUG after merge:  round=1 metric=0.1414 head_norm=0.892413 delta_norm=0.789585
[S9] aggregate: ROLLBACK (f1_val pre=0.381 post=0.141 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=1 metric=0.1397 head_norm=1.207560
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.359016e-01
[S15] stored merged vector for next round verification (round=1)
[S15] DEBUG after merge:  round=1 metric=0.1397 head_norm=0.836025 delta_norm=0.835902
[S15] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=1.192329 (no previous merge yet)
[S2] round=2 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6116137534117038, 'loss_val': 1.1814098108291815, 'psi': 0.32971178139782154}-{'f1_val': 0.1417771333885667, 'auprc': 0.7445648594408449, 'loss_val': 1.246483851641258, 'psi': 0.382892223809478}
[S3] START round=2 head_norm_before_train=1.192806 (no previous merge yet)
[S3] round=2 local utility u=0.069195 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.882527867498096, 'loss_val': 1.2782646252873973, 'psi': 0.43691518636770266}-{'f1_val': 0.13984006561410703, 'auprc': 0.8505320993299454, 'loss_val': 1.3206664512180368, 'psi': 0.4241168791004424}
[S4] START round=2 head_norm_before_train=1.244127 (no previous merge yet)
[S4] round=2 local utility u=0.075685 metrics={'f1_val': 0.41234085793469244, 'auprc': 0.7823354727810031, 'loss_val': 1.1182213913673655, 'psi': 0.5603387038732167}-{'f1_val': 0.4146850260251823, 'auprc': 0.7763482749542315, 'loss_val': 1.2656949506162292, 'psi': 0.559350325596802}
[S5] START round=2 head_norm_before_train=1.226099 (no previous merge yet)
[S5] round=2 local utility u=0.267103 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7439593560352207, 'loss_val': 1.2841887887001646, 'psi': 0.38294088527123116}-{'f1_val': 0.14226190476190476, 'auprc': 0.5777825351916972, 'loss_val': 1.3198633988826647, 'psi': 0.31647015693382174}
[S6] START round=2 head_norm_before_train=1.179436 (no previous merge yet)
[S6] round=2 local utility u=0.019399 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8439463179626405, 'loss_val': 1.19523879614389, 'psi': 0.4224342964158254}-{'f1_val': 0.14142628205128205, 'auprc': 0.8550857098417108, 'loss_val': 1.267454572490687, 'psi': 0.42689005316745354}
[S7] START round=2 head_norm_before_train=1.189685 (no previous merge yet)
[S7] round=2 local utility u=0.014538 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7733125639171953, 'loss_val': 1.2905460162060145, 'psi': 0.3945591192043331}-{'f1_val': 0.14211369095276222, 'auprc': 0.778434137944916, 'loss_val': 1.3353287493809596, 'psi': 0.3966418697496238}
[S8] START round=2 head_norm_before_train=1.177510 (no previous merge yet)
[S8] round=2 local utility u=0.041096 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7363164191951114, 'loss_val': 1.1922306281346187, 'psi': 0.3785001571138189}-{'f1_val': 0.13995598239295717, 'auprc': 0.7402999510864509, 'loss_val': 1.286373561084875, 'psi': 0.3800935698703547}
[S9] START round=2 head_norm_before_train=0.892413 cos_to_last_merge=1.0000 (last merge round=1)
[S9] round=2 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8659551293588759, 'loss_val': 1.3008300454338022, 'psi': 0.43122082602754797}-{'f1_val': 0.38109043756074557, 'auprc': 0.8649656563640611, 'loss_val': 1.3338415124753762, 'psi': 0.5746405250820719}
[S10] START round=2 head_norm_before_train=1.156348 (no previous merge yet)
[S10] round=2 local utility u=0.043967 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.777362419995389, 'loss_val': 1.1878208307272469, 'psi': 0.39411795052319}-{'f1_val': 0.13862163754172394, 'auprc': 0.776145225255936, 'loss_val': 1.2721036414132239, 'psi': 0.39363107262740876}
[S11] START round=2 head_norm_before_train=1.188426 (no previous merge yet)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8448362784402109, 'loss_val': 1.279798976810464, 'psi': 0.4221827213999507}-{'f1_val': 0.17291207445505755, 'auprc': 0.8199616762715674, 'loss_val': 1.328281146554705, 'psi': 0.4317319151816615}
[S13] START round=2 head_norm_before_train=1.177840 (no previous merge yet)
[S13] round=2 local utility u=0.145006 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7098749817715733, 'loss_val': 1.2083104994875218, 'psi': 0.36818145025486115}-{'f1_val': 0.1403857625770531, 'auprc': 0.6381029358235505, 'loss_val': 1.2830065906324482, 'psi': 0.3394726318756521}
[S14] START round=2 head_norm_before_train=0.753802 cos_to_last_merge=1.0000 (last merge round=1)
[S14] round=2 local utility u=0.000000 metrics={'f1_val': 0.2579585118300798, 'auprc': 0.7500126156104698, 'loss_val': 1.3600605716221832, 'psi': 0.4547801533422358}-{'f1_val': 0.2851916705612798, 'auprc': 0.7823678928805551, 'loss_val': 1.356357512949253, 'psi': 0.4840621594889899}
[S15] START round=2 head_norm_before_train=0.836025 cos_to_last_merge=1.0000 (last merge round=1)
[S15] round=2 local utility u=0.082449 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.705148690492858, 'loss_val': 1.2969800406792327, 'psi': 0.3658996670140782}-{'f1_val': 0.13973365136155833, 'auprc': 0.6602304133279067, 'loss_val': 1.327124114234249, 'psi': 0.3479323561480977}
[S16] START round=2 head_norm_before_train=0.851593 cos_to_last_merge=1.0000 (last merge round=1)
[S16] round=2 local utility u=0.427377 metrics={'f1_val': 0.27462011295204214, 'auprc': 0.7949063468605584, 'loss_val': 1.341600911556379, 'psi': 0.48273460651544864}-{'f1_val': 0.16686376537369915, 'auprc': 0.7254392258480262, 'loss_val': 1.3414149067994625, 'psi': 0.39029394956343}
[S17] START round=2 head_norm_before_train=1.190024 (no previous merge yet)
[S17] round=2 local utility u=0.079495 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5509201403857062, 'loss_val': 1.1722105836959422, 'psi': 0.30493743414471314}-{'f1_val': 0.14094896331738438, 'auprc': 0.5326552409041041, 'loss_val': 1.276405275321254, 'psi': 0.29763147435207227}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:58317
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S15] → sending delta(kind=head bytes=1791) to S16@127.0.0.1:58316
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] → sending delta(kind=head bytes=1793) to S11@127.0.0.1:58312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:58309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:58315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:58312
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:58313
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] → sending delta(kind=head bytes=1792) to S9@127.0.0.1:58310
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S5] → sending delta(kind=head bytes=1790) to S9@127.0.0.1:58310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:58315
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] sending update (kind=head size=1790 to 1 peers)
[S3] sending update (kind=head size=1792 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1794 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1793 to 1 peers)
[S15] sending update (kind=head size=1791 to 1 peers)
[S7] sending update (kind=head size=1794 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1795) from S8
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.241820)
[S13] loaded HEAD from S8 (vec_in norm=1.241820)
[S13] cosine check vs S8: cos=0.0425
[S13] BUFFERED delta from S8 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1794) from S7
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.215421)
[S17] loaded HEAD from S7 (vec_in norm=1.215421)
[S17] cosine check vs S7: cos=-0.0001
[S17] DROPPED delta from S7 (cos=-0.0001 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1791) from S15
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.868459)
[S16] loaded HEAD from S15 (vec_in norm=0.868459)
[S16] cosine check vs S15: cos=0.5349
[S16] BUFFERED delta from S15 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1790) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.246324)
[S9] loaded HEAD from S5 (vec_in norm=1.246324)
[S9] cosine check vs S5: cos=0.7579
[S9] BUFFERED delta from S5 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1798) from S13
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.222864)
[S8] loaded HEAD from S13 (vec_in norm=1.222864)
[S8] cosine check vs S13: cos=0.0425
[S8] BUFFERED delta from S13 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1792) from S3
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.219569)
[S9] loaded HEAD from S3 (vec_in norm=1.219569)
[S9] cosine check vs S3: cos=0.0074
[S9] BUFFERED delta from S3 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1804) from S4
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.309706)
[S15] loaded HEAD from S4 (vec_in norm=1.309706)
[S15] cosine check vs S4: cos=-0.0496
[S15] DROPPED delta from S4 (cos=-0.0496 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1797) from S16
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.868046)
[S15] loaded HEAD from S16 (vec_in norm=0.868046)
[S15] cosine check vs S16: cos=0.5349
[S15] BUFFERED delta from S16 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1794) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.234177)
[S11] loaded HEAD from S6 (vec_in norm=1.234177)
[S11] cosine check vs S6: cos=-0.0414
[S11] DROPPED delta from S6 (cos=-0.0414 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1793) from S10
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.207741)
[S11] loaded HEAD from S10 (vec_in norm=1.207741)
[S11] cosine check vs S10: cos=-0.0211
[S11] DROPPED delta from S10 (cos=-0.0211 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S17] → sending delta(kind=head bytes=1790) to S16@127.0.0.1:58316
[S17] sending update (kind=head size=1790 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1790) from S17
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.250835)
[S16] loaded HEAD from S17 (vec_in norm=1.250835)
[S16] cosine check vs S17: cos=0.0307
[S16] BUFFERED delta from S17 (total buffered=2)
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=2 metric=0.1414 head_norm=0.912929
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.318936e-01
[S9] stored merged vector for next round verification (round=2)
[S9] DEBUG after merge:  round=2 metric=0.1414 head_norm=0.788578 delta_norm=0.431894
[S9] aggregate: ACCEPT kept=['S5', 'S3'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=2 metric=0.1397 head_norm=0.868459
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.186821e-01
[S15] stored merged vector for next round verification (round=2)
[S15] DEBUG after merge:  round=2 metric=0.1397 head_norm=0.760636 delta_norm=0.418682
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=2 metric=0.1404 head_norm=1.222864
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.527094e-01
[S13] stored merged vector for next round verification (round=2)
[S13] DEBUG after merge:  round=2 metric=0.1404 head_norm=0.889744 delta_norm=0.852709
[S13] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=2 metric=0.1400 head_norm=1.241820
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.527094e-01
[S8] stored merged vector for next round verification (round=2)
[S8] DEBUG after merge:  round=2 metric=0.4570 head_norm=0.889744 delta_norm=0.852709
[S8] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=2 metric=0.2746 head_norm=0.868046
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.721136e-01
[S16] stored merged vector for next round verification (round=2)
[S16] DEBUG after merge:  round=2 metric=0.1406 head_norm=0.664234 delta_norm=0.472114
[S16] aggregate: ROLLBACK (f1_val pre=0.275 post=0.141 tol_abs=0.005 tol_rel=0.0)
[S2] START round=3 head_norm_before_train=1.243724 (no previous merge yet)
[S2] round=3 local utility u=1.000000 metrics={'f1_val': 0.4167275806938775, 'auprc': 0.7705910143893004, 'loss_val': 1.0469264401003453, 'psi': 0.5582729541720467}-{'f1_val': 0.1417771333885667, 'auprc': 0.6116137534117038, 'loss_val': 1.1814098108291815, 'psi': 0.32971178139782154}
[S3] START round=3 head_norm_before_train=1.219569 (no previous merge yet)
[S3] round=3 local utility u=0.194675 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9973352610756131, 'loss_val': 1.2333363113269724, 'psi': 0.4828381437987095}-{'f1_val': 0.13984006561410703, 'auprc': 0.882527867498096, 'loss_val': 1.2782646252873973, 'psi': 0.43691518636770266}
[S4] START round=3 head_norm_before_train=1.309706 (no previous merge yet)
[S4] round=3 local utility u=0.425562 metrics={'f1_val': 0.5093336364534355, 'auprc': 0.7863239150143209, 'loss_val': 0.8610196738829019, 'psi': 0.6201297478777896}-{'f1_val': 0.41234085793469244, 'auprc': 0.7823354727810031, 'loss_val': 1.1182213913673655, 'psi': 0.5603387038732167}
[S5] START round=3 head_norm_before_train=1.246324 (no previous merge yet)
[S5] round=3 local utility u=0.012445 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7367629068799806, 'loss_val': 1.2377084964967078, 'psi': 0.3800623056091351}-{'f1_val': 0.14226190476190476, 'auprc': 0.7439593560352207, 'loss_val': 1.2841887887001646, 'psi': 0.38294088527123116}
[S6] START round=3 head_norm_before_train=1.234177 (no previous merge yet)
[S6] round=3 local utility u=0.994281 metrics={'f1_val': 0.41463700409720844, 'auprc': 0.8977517512873381, 'loss_val': 1.0073570096375841, 'psi': 0.6078829029732603}-{'f1_val': 0.14142628205128205, 'auprc': 0.8439463179626405, 'loss_val': 1.19523879614389, 'psi': 0.4224342964158254}
[S7] START round=3 head_norm_before_train=1.215421 (no previous merge yet)
[S7] round=3 local utility u=0.030233 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7772953312597416, 'loss_val': 1.2420290633118654, 'psi': 0.39615222614135165}-{'f1_val': 0.14205682272909165, 'auprc': 0.7733125639171953, 'loss_val': 1.2905460162060145, 'psi': 0.3945591192043331}
[S8] START round=3 head_norm_before_train=0.889744 cos_to_last_merge=1.0000 (last merge round=2)
[S8] round=3 local utility u=0.080865 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7654320331457797, 'loss_val': 1.1178465993194937, 'psi': 0.39014640269408624}-{'f1_val': 0.13995598239295717, 'auprc': 0.7363164191951114, 'loss_val': 1.1922306281346187, 'psi': 0.3785001571138189}
[S9] START round=3 head_norm_before_train=0.788578 cos_to_last_merge=1.0000 (last merge round=2)
[S9] round=3 local utility u=0.007210 metrics={'f1_val': 0.141397957139996, 'auprc': 0.866202456948501, 'loss_val': 1.2871522320986863, 'psi': 0.43131975706339803}-{'f1_val': 0.141397957139996, 'auprc': 0.8659551293588759, 'loss_val': 1.3008300454338022, 'psi': 0.43122082602754797}
[S10] START round=3 head_norm_before_train=1.207741 (no previous merge yet)
[S10] round=3 local utility u=0.775742 metrics={'f1_val': 0.41689270364329833, 'auprc': 0.6846892369475743, 'loss_val': 1.0279429360343089, 'psi': 0.5240113169650087}-{'f1_val': 0.13862163754172394, 'auprc': 0.777362419995389, 'loss_val': 1.1878208307272469, 'psi': 0.39411795052319}
[S11] START round=3 head_norm_before_train=1.212345 (no previous merge yet)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6373875813895618, 'loss_val': 1.2070432416378953, 'psi': 0.33920324257969103}-{'f1_val': 0.14041368337311058, 'auprc': 0.8448362784402109, 'loss_val': 1.279798976810464, 'psi': 0.4221827213999507}
[S13] START round=3 head_norm_before_train=0.889744 cos_to_last_merge=1.0000 (last merge round=2)
[S13] round=3 local utility u=0.652748 metrics={'f1_val': 0.34930046332353204, 'auprc': 0.7044950335546802, 'loss_val': 1.1401619429156993, 'psi': 0.4913782914159913}-{'f1_val': 0.1403857625770531, 'auprc': 0.7098749817715733, 'loss_val': 1.2083104994875218, 'psi': 0.36818145025486115}
[S14] START round=3 head_norm_before_train=0.765136 cos_to_last_merge=0.9961 (last merge round=1)
[S14] round=3 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7381747167827367, 'loss_val': 1.3326373693981266, 'psi': 0.3794845984427169}-{'f1_val': 0.2579585118300798, 'auprc': 0.7500126156104698, 'loss_val': 1.3600605716221832, 'psi': 0.4547801533422358}
[S15] START round=3 head_norm_before_train=0.760636 cos_to_last_merge=1.0000 (last merge round=2)
[S15] round=3 local utility u=0.065421 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.740119715196786, 'loss_val': 1.2710510662700967, 'psi': 0.3798880768956494}-{'f1_val': 0.13973365136155833, 'auprc': 0.705148690492858, 'loss_val': 1.2969800406792327, 'psi': 0.3658996670140782}
[S16] START round=3 head_norm_before_train=0.664234 cos_to_last_merge=1.0000 (last merge round=2)
[S16] round=3 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7938212880036674, 'loss_val': 1.3142391858745595, 'psi': 0.4019109853209889}-{'f1_val': 0.27462011295204214, 'auprc': 0.7949063468605584, 'loss_val': 1.341600911556379, 'psi': 0.48273460651544864}
[S17] START round=3 head_norm_before_train=1.250835 (no previous merge yet)
[S17] round=3 local utility u=0.953675 metrics={'f1_val': 0.39194328393368116, 'auprc': 0.6284119323438677, 'loss_val': 1.0033011473149547, 'psi': 0.4865307432977558}-{'f1_val': 0.14094896331738438, 'auprc': 0.5509201403857062, 'loss_val': 1.1722105836959422, 'psi': 0.30493743414471314}
[S10] not sending this round → trigger blocked (psi=0.524)
[S4] not sending this round → trigger blocked (psi=0.620)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:58314
[S7] not sending this round → trigger blocked (psi=0.396)
[S13] not sending this round → trigger blocked (psi=0.491)
[S15] not sending this round → trigger blocked (psi=0.380)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.380)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.483)
[S6] not sending this round → trigger blocked (psi=0.608)
[S8] not sending this round → trigger blocked (psi=0.390)
[S2] sending update (kind=head size=1804 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1804) from S2
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.286035)
[S5] loaded HEAD from S2 (vec_in norm=1.286035)
[S5] cosine check vs S2: cos=-0.0559
[S5] DROPPED delta from S2 (cos=-0.0559 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1800) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.809008)
[S14] loaded HEAD from S9 (vec_in norm=0.809008)
[S14] cosine check vs S9: cos=0.1099
[S14] BUFFERED delta from S9 (total buffered=1)
[S17] not sending this round → trigger blocked (psi=0.487)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=3 metric=0.1404 head_norm=0.787425
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.325748e-01
[S14] stored merged vector for next round verification (round=3)
[S14] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.594668 delta_norm=0.532575
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=1.286035 (no previous merge yet)
[S2] round=4 local utility u=0.725660 metrics={'f1_val': 0.6439435449180715, 'auprc': 0.7313298808330588, 'loss_val': 0.8411183193921379, 'psi': 0.6788980792840664}-{'f1_val': 0.4167275806938775, 'auprc': 0.7705910143893004, 'loss_val': 1.0469264401003453, 'psi': 0.5582729541720467}
[S3] START round=4 head_norm_before_train=1.251345 (no previous merge yet)
[S3] round=4 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7404612259469987, 'loss_val': 1.1805213496543017, 'psi': 0.3800885297472637}-{'f1_val': 0.13984006561410703, 'auprc': 0.9973352610756131, 'loss_val': 1.2333363113269724, 'psi': 0.4828381437987095}
[S4] START round=4 head_norm_before_train=1.383106 (no previous merge yet)
[S4] round=4 local utility u=0.397105 metrics={'f1_val': 0.666975931065091, 'auprc': 0.6603069898892131, 'loss_val': 0.6346118021439126, 'psi': 0.6643083545947399}-{'f1_val': 0.5093336364534355, 'auprc': 0.7863239150143209, 'loss_val': 0.8610196738829019, 'psi': 0.6201297478777896}
[S5] START round=4 head_norm_before_train=1.271345 (no previous merge yet)
[S5] round=4 local utility u=0.036210 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7401200065339867, 'loss_val': 1.1753602536656655, 'psi': 0.38140514547073756}-{'f1_val': 0.14226190476190476, 'auprc': 0.7367629068799806, 'loss_val': 1.2377084964967078, 'psi': 0.3800623056091351}
[S6] START round=4 head_norm_before_train=1.294623 (no previous merge yet)
[S6] round=4 local utility u=0.757525 metrics={'f1_val': 0.5756465305469579, 'auprc': 0.9614887063707498, 'loss_val': 0.6495744064298491, 'psi': 0.7299834008764747}-{'f1_val': 0.41463700409720844, 'auprc': 0.8977517512873381, 'loss_val': 1.0073570096375841, 'psi': 0.6078829029732603}
[S7] START round=4 head_norm_before_train=1.246921 (no previous merge yet)
[S7] round=4 local utility u=0.020382 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7772776557560617, 'loss_val': 1.2012114397309714, 'psi': 0.3961451559398797}-{'f1_val': 0.14205682272909165, 'auprc': 0.7772953312597416, 'loss_val': 1.2420290633118654, 'psi': 0.39615222614135165}
[S8] START round=4 head_norm_before_train=0.953325 cos_to_last_merge=0.9940 (last merge round=2)
[S8] round=4 local utility u=0.788925 metrics={'f1_val': 0.37307134877987713, 'auprc': 0.77345786018662, 'loss_val': 0.96276665762586, 'psi': 0.5332259533425743}-{'f1_val': 0.13995598239295717, 'auprc': 0.7654320331457797, 'loss_val': 1.1178465993194937, 'psi': 0.39014640269408624}
[S9] START round=4 head_norm_before_train=0.809008 cos_to_last_merge=0.9969 (last merge round=2)
[S9] round=4 local utility u=0.024072 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8659999259182739, 'loss_val': 1.2384011664507943, 'psi': 0.4312387446513072}-{'f1_val': 0.141397957139996, 'auprc': 0.866202456948501, 'loss_val': 1.2871522320986863, 'psi': 0.43131975706339803}
[S10] START round=4 head_norm_before_train=1.262491 (no previous merge yet)
[S10] round=4 local utility u=1.000000 metrics={'f1_val': 0.7016401924031649, 'auprc': 0.865024845783889, 'loss_val': 0.6950763000225608, 'psi': 0.7669940537554545}-{'f1_val': 0.41689270364329833, 'auprc': 0.6846892369475743, 'loss_val': 1.0279429360343089, 'psi': 0.5240113169650087}
[S11] START round=4 head_norm_before_train=1.246263 (no previous merge yet)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.596540713450795, 'loss_val': 1.1310738369129718, 'psi': 0.3228644954041843}-{'f1_val': 0.14041368337311058, 'auprc': 0.6373875813895618, 'loss_val': 1.2070432416378953, 'psi': 0.33920324257969103}
[S13] START round=4 head_norm_before_train=0.939461 cos_to_last_merge=0.9954 (last merge round=2)
[S13] round=4 local utility u=0.210267 metrics={'f1_val': 0.37189073220722907, 'auprc': 0.7423935167438522, 'loss_val': 0.9688645546607928, 'psi': 0.5200918460218783}-{'f1_val': 0.34930046332353204, 'auprc': 0.7044950335546802, 'loss_val': 1.1401619429156993, 'psi': 0.4913782914159913}
[S14] START round=4 head_norm_before_train=0.594668 cos_to_last_merge=1.0000 (last merge round=3)
[S14] round=4 local utility u=0.066076 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7766700247554862, 'loss_val': 1.3159717594182374, 'psi': 0.39488272163181676}-{'f1_val': 0.14035785288270378, 'auprc': 0.7381747167827367, 'loss_val': 1.3326373693981266, 'psi': 0.3794845984427169}
[S15] START round=4 head_norm_before_train=0.807399 cos_to_last_merge=0.9934 (last merge round=2)
[S15] round=4 local utility u=0.252477 metrics={'f1_val': 0.1935367127437927, 'auprc': 0.7769854236766527, 'loss_val': 1.19951340213939, 'psi': 0.4269161971169367}-{'f1_val': 0.13973365136155833, 'auprc': 0.740119715196786, 'loss_val': 1.2710510662700967, 'psi': 0.3798880768956494}
[S16] START round=4 head_norm_before_train=0.682723 cos_to_last_merge=0.9945 (last merge round=2)
[S16] round=4 local utility u=0.029722 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.797882361055649, 'loss_val': 1.2669774307300812, 'psi': 0.40353541454178155}-{'f1_val': 0.14063745019920318, 'auprc': 0.7938212880036674, 'loss_val': 1.3142391858745595, 'psi': 0.4019109853209889}
[S17] START round=4 head_norm_before_train=1.314288 (no previous merge yet)
[S17] round=4 local utility u=0.217912 metrics={'f1_val': 0.3581299897427781, 'auprc': 0.7813122943576805, 'loss_val': 0.8232991484922191, 'psi': 0.5274029115887391}-{'f1_val': 0.39194328393368116, 'auprc': 0.6284119323438677, 'loss_val': 1.0033011473149547, 'psi': 0.4865307432977558}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S7] → sending delta(kind=head bytes=1792) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] → sending delta(kind=head bytes=1792) to S4@127.0.0.1:58304
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:58307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S15] → sending delta(kind=head bytes=1791) to S5@127.0.0.1:58305
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:58316
[S9] not sending this round → trigger blocked (psi=0.431)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:58310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:58308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:58312
[S2] not sending this round → trigger blocked (psi=0.679)
[S4] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1791 to 1 peers)
[S6] sending update (kind=head size=1792 to 1 peers)
[S7] sending update (kind=head size=1792 to 1 peers)
[S16] sending update (kind=head size=1805 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1792) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.273141)
[S14] loaded HEAD from S7 (vec_in norm=1.273141)
[S14] cosine check vs S7: cos=0.2056
[S14] BUFFERED delta from S7 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1803) from S8
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.010289)
[S7] loaded HEAD from S8 (vec_in norm=1.010289)
[S7] cosine check vs S8: cos=-0.0075
[S7] DROPPED delta from S8 (cos=-0.0075 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1802) from S13
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=0.998511)
[S9] loaded HEAD from S13 (vec_in norm=0.998511)
[S9] cosine check vs S13: cos=0.1390
[S9] BUFFERED delta from S13 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1801) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.464056)
[S11] loaded HEAD from S4 (vec_in norm=1.464056)
[S11] cosine check vs S4: cos=0.0014
[S11] BUFFERED delta from S4 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1795) from S14
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.622280)
[S5] loaded HEAD from S14 (vec_in norm=0.622280)
[S5] cosine check vs S14: cos=0.5296
[S5] BUFFERED delta from S14 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1796) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.332839)
[S5] loaded HEAD from S10 (vec_in norm=1.332839)
[S5] cosine check vs S10: cos=0.0889
[S5] BUFFERED delta from S10 (total buffered=2)
[S5] RECEIVED delta(kind=head bytes=1791) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.832943)
[S5] loaded HEAD from S15 (vec_in norm=0.832943)
[S5] cosine check vs S15: cos=0.0007
[S5] BUFFERED delta from S15 (total buffered=3)
[S4] RECEIVED delta(kind=head bytes=1792) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.369643)
[S4] loaded HEAD from S6 (vec_in norm=1.369643)
[S4] cosine check vs S6: cos=-0.0470
[S4] DROPPED delta from S6 (cos=-0.0470 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1805) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.713216)
[S6] loaded HEAD from S16 (vec_in norm=0.713216)
[S6] cosine check vs S16: cos=0.0314
[S6] BUFFERED delta from S16 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1795) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.300268)
[S16] loaded HEAD from S5 (vec_in norm=1.300268)
[S16] cosine check vs S5: cos=-0.0219
[S16] DROPPED delta from S5 (cos=-0.0219 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:58310
[S17] sending update (kind=head size=1797 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1797) from S17
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.392092)
[S9] loaded HEAD from S17 (vec_in norm=1.392092)
[S9] cosine check vs S17: cos=0.0054
[S9] BUFFERED delta from S17 (total buffered=2)
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=4 metric=0.1414 head_norm=0.839258
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.760313e-01
[S9] stored merged vector for next round verification (round=4)
[S9] DEBUG after merge:  round=4 metric=0.1414 head_norm=0.627093 delta_norm=0.576031
[S9] aggregate: ACCEPT kept=['S13', 'S17'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=4 metric=0.1404 head_norm=1.281191
[S11] _apply_head_vector_avg (torch): Δ‖w‖=9.720573e-01
[S11] stored merged vector for next round verification (round=4)
[S11] DEBUG after merge:  round=4 metric=0.3576 head_norm=0.973427 delta_norm=0.972057
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=4 metric=0.5756 head_norm=1.369643
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.621099e-01
[S6] stored merged vector for next round verification (round=4)
[S6] DEBUG after merge:  round=4 metric=0.5308 head_norm=0.781977 delta_norm=0.762110
[S6] aggregate: ROLLBACK (f1_val pre=0.576 post=0.531 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=4 metric=0.1404 head_norm=0.622280
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.485183e-01
[S14] stored merged vector for next round verification (round=4)
[S14] DEBUG after merge:  round=4 metric=0.1404 head_norm=0.763861 delta_norm=0.648518
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=4 metric=0.1423 head_norm=1.300268
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.513095e-01
[S5] stored merged vector for next round verification (round=4)
[S5] DEBUG after merge:  round=4 metric=0.1423 head_norm=0.772032 delta_norm=0.651309
[S5] aggregate: ACCEPT kept=['S14', 'S10', 'S15'] (k=3/3) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=1.348676 (no previous merge yet)
[S2] round=5 local utility u=0.370195 metrics={'f1_val': 0.7124692692474335, 'auprc': 0.7785755023752049, 'loss_val': 0.6536196414047011, 'psi': 0.7389117624985421}-{'f1_val': 0.6439435449180715, 'auprc': 0.7313298808330588, 'loss_val': 0.8411183193921379, 'psi': 0.6788980792840664}
[S3] START round=5 head_norm_before_train=1.284148 (no previous merge yet)
[S3] round=5 local utility u=0.410413 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9821927657384064, 'loss_val': 1.0848896459246313, 'psi': 0.4767811456638268}-{'f1_val': 0.13984006561410703, 'auprc': 0.7404612259469987, 'loss_val': 1.1805213496543017, 'psi': 0.3800885297472637}
[S4] START round=5 head_norm_before_train=1.464056 (no previous merge yet)
[S4] round=5 local utility u=0.051079 metrics={'f1_val': 0.6609149733292801, 'auprc': 0.6608840295117938, 'loss_val': 0.4978192039153197, 'psi': 0.6609025958022856}-{'f1_val': 0.666975931065091, 'auprc': 0.6603069898892131, 'loss_val': 0.6346118021439126, 'psi': 0.6643083545947399}
[S5] START round=5 head_norm_before_train=0.772032 cos_to_last_merge=1.0000 (last merge round=4)
[S5] round=5 local utility u=0.008730 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7411830544022735, 'loss_val': 1.161089274684248, 'psi': 0.38183036461805225}-{'f1_val': 0.14226190476190476, 'auprc': 0.7401200065339867, 'loss_val': 1.1753602536656655, 'psi': 0.38140514547073756}
[S6] START round=5 head_norm_before_train=0.781977 cos_to_last_merge=1.0000 (last merge round=4)
[S6] round=5 local utility u=0.192658 metrics={'f1_val': 0.6308930274354075, 'auprc': 0.9718849382514894, 'loss_val': 0.626925556000617, 'psi': 0.7672897917618402}-{'f1_val': 0.5756465305469579, 'auprc': 0.9614887063707498, 'loss_val': 0.6495744064298491, 'psi': 0.7299834008764747}
[S7] START round=5 head_norm_before_train=1.273141 (no previous merge yet)
[S7] round=5 local utility u=0.028733 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7775488060504615, 'loss_val': 1.1445585844279444, 'psi': 0.3962536160576396}-{'f1_val': 0.14205682272909165, 'auprc': 0.7772776557560617, 'loss_val': 1.2012114397309714, 'psi': 0.3961451559398797}
[S8] START round=5 head_norm_before_train=1.010289 cos_to_last_merge=0.9836 (last merge round=2)
[S8] round=5 local utility u=1.000000 metrics={'f1_val': 0.7140451255766143, 'auprc': 0.9962776983312467, 'loss_val': 0.6651540597008656, 'psi': 0.8269381546784672}-{'f1_val': 0.37307134877987713, 'auprc': 0.77345786018662, 'loss_val': 0.96276665762586, 'psi': 0.5332259533425743}
[S9] START round=5 head_norm_before_train=0.627093 cos_to_last_merge=1.0000 (last merge round=4)
[S9] round=5 local utility u=0.007325 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8658827282317397, 'loss_val': 1.223399211487162, 'psi': 0.43119186557669353}-{'f1_val': 0.141397957139996, 'auprc': 0.8659999259182739, 'loss_val': 1.2384011664507943, 'psi': 0.4312387446513072}
[S10] START round=5 head_norm_before_train=1.332839 (no previous merge yet)
[S10] round=5 local utility u=0.250602 metrics={'f1_val': 0.6889456628288311, 'auprc': 0.9741035999256282, 'loss_val': 0.44494155729418555, 'psi': 0.8030088376675499}-{'f1_val': 0.7016401924031649, 'auprc': 0.865024845783889, 'loss_val': 0.6950763000225608, 'psi': 0.7669940537554545}
[S11] START round=5 head_norm_before_train=0.973427 cos_to_last_merge=1.0000 (last merge round=4)
[S11] round=5 local utility u=0.859749 metrics={'f1_val': 0.4225625868721864, 'auprc': 0.5961047512488569, 'loss_val': 1.103162122142037, 'psi': 0.4919794526228546}-{'f1_val': 0.14041368337311058, 'auprc': 0.596540713450795, 'loss_val': 1.1310738369129718, 'psi': 0.3228644954041843}
[S13] START round=5 head_norm_before_train=0.998511 cos_to_last_merge=0.9846 (last merge round=2)
[S13] round=5 local utility u=0.122051 metrics={'f1_val': 0.3853013457669673, 'auprc': 0.7388652234608404, 'loss_val': 0.7946409871725043, 'psi': 0.5267268968445166}-{'f1_val': 0.37189073220722907, 'auprc': 0.7423935167438522, 'loss_val': 0.9688645546607928, 'psi': 0.5200918460218783}
[S14] START round=5 head_norm_before_train=0.763861 cos_to_last_merge=1.0000 (last merge round=4)
[S14] round=5 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7318527753041887, 'loss_val': 1.306789005121865, 'psi': 0.3769558218512977}-{'f1_val': 0.14035785288270378, 'auprc': 0.7766700247554862, 'loss_val': 1.3159717594182374, 'psi': 0.39488272163181676}
[S15] START round=5 head_norm_before_train=0.832943 cos_to_last_merge=0.9839 (last merge round=2)
[S15] round=5 local utility u=0.806479 metrics={'f1_val': 0.4161838404121786, 'auprc': 0.7998311778684494, 'loss_val': 0.9909756585756266, 'psi': 0.5696427753946869}-{'f1_val': 0.1935367127437927, 'auprc': 0.7769854236766527, 'loss_val': 1.19951340213939, 'psi': 0.4269161971169367}
[S16] START round=5 head_norm_before_train=0.713216 cos_to_last_merge=0.9797 (last merge round=2)
[S16] round=5 local utility u=0.012730 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7934341615050792, 'loss_val': 1.2281731852636946, 'psi': 0.4017561347215536}-{'f1_val': 0.14063745019920318, 'auprc': 0.797882361055649, 'loss_val': 1.2669774307300812, 'psi': 0.40353541454178155}
[S17] START round=5 head_norm_before_train=1.392092 (no previous merge yet)
[S17] round=5 local utility u=0.000000 metrics={'f1_val': 0.35332495072624465, 'auprc': 0.65415926013991, 'loss_val': 0.8892371970666011, 'psi': 0.4736586744917108}-{'f1_val': 0.3581299897427781, 'auprc': 0.7813122943576805, 'loss_val': 0.8232991484922191, 'psi': 0.5274029115887391}
[S4] not sending this round → trigger blocked (psi=0.661)
[S5] not sending this round → trigger blocked (psi=0.382)
[S8] not sending this round → trigger blocked (psi=0.827)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:58305
[S10] not sending this round → trigger blocked (psi=0.803)
[S13] not sending this round → trigger blocked (psi=0.527)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:58305
[S16] not sending this round → trigger blocked (psi=0.402)
[S15] not sending this round → trigger blocked (psi=0.570)
[S6] not sending this round → trigger blocked (psi=0.767)
[S7] not sending this round → trigger blocked (psi=0.396)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:58310
[S11] sending update (kind=head size=1794 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1802) from S2
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.425732)
[S5] loaded HEAD from S2 (vec_in norm=1.425732)
[S5] cosine check vs S2: cos=-0.0414
[S5] DROPPED delta from S2 (cos=-0.0414 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1799) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.655823)
[S14] loaded HEAD from S9 (vec_in norm=0.655823)
[S14] cosine check vs S9: cos=0.2162
[S14] BUFFERED delta from S9 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1794) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.002043)
[S9] loaded HEAD from S11 (vec_in norm=1.002043)
[S9] cosine check vs S11: cos=-0.0009
[S9] DROPPED delta from S11 (cos=-0.0009 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1798) from S3
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.314905)
[S5] loaded HEAD from S3 (vec_in norm=1.314905)
[S5] cosine check vs S3: cos=0.0664
[S5] BUFFERED delta from S3 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] ⇄ pheromone p=0.645 → S5@127.0.0.1:58305
[S7] ⇄ pheromone p=0.353 → S14@127.0.0.1:58314
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=5 metric=0.1404 head_norm=0.778784
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.515870e-01
[S14] stored merged vector for next round verification (round=5)
[S14] DEBUG after merge:  round=5 metric=0.1404 head_norm=0.560690 delta_norm=0.451587
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.386 → S5@127.0.0.1:58305
[S4] ⇄ pheromone p=0.478 → S11@127.0.0.1:58312
[S15] ⇄ pheromone p=0.566 → S5@127.0.0.1:58305
[S6] ⇄ pheromone p=0.639 → S4@127.0.0.1:58304
[S13] ⇄ pheromone p=0.498 → S9@127.0.0.1:58310
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=5 metric=0.1423 head_norm=0.805955
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.479758e-01
[S5] stored merged vector for next round verification (round=5)
[S5] DEBUG after merge:  round=5 metric=0.1423 head_norm=0.793601 delta_norm=0.747976
[S5] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.368 → S16@127.0.0.1:58316
[S8] ⇄ pheromone p=0.677 → S7@127.0.0.1:58308
[S3] ⇄ pheromone p=0.442 → S5@127.0.0.1:58305
[S2] ⇄ pheromone p=0.646 → S5@127.0.0.1:58305
[S11] ⇄ pheromone p=0.522 → S9@127.0.0.1:58310
[S9] ⇄ pheromone p=0.416 → S14@127.0.0.1:58314
[S17] ⇄ pheromone p=0.499 → S9@127.0.0.1:58310
[S16] ⇄ pheromone p=0.423 → S6@127.0.0.1:58307
[S2] START round=6 head_norm_before_train=1.425732 (no previous merge yet)
[S2] round=6 local utility u=0.058615 metrics={'f1_val': 0.6998459069236436, 'auprc': 0.7778948992778363, 'loss_val': 0.4586076534752783, 'psi': 0.7310655038653207}-{'f1_val': 0.7124692692474335, 'auprc': 0.7785755023752049, 'loss_val': 0.6536196414047011, 'psi': 0.7389117624985421}
[S3] START round=6 head_norm_before_train=1.314905 (no previous merge yet)
[S3] round=6 local utility u=0.866603 metrics={'f1_val': 0.39645225981545407, 'auprc': 0.996584259304968, 'loss_val': 0.9345310144734436, 'psi': 0.6365050596112596}-{'f1_val': 0.13984006561410703, 'auprc': 0.9821927657384064, 'loss_val': 1.0848896459246313, 'psi': 0.4767811456638268}
[S4] START round=6 head_norm_before_train=1.550524 (no previous merge yet)
[S4] round=6 local utility u=0.416268 metrics={'f1_val': 0.6615218742476329, 'auprc': 0.9388625169651406, 'loss_val': 0.5028592766584161, 'psi': 0.7724581313346359}-{'f1_val': 0.6609149733292801, 'auprc': 0.6608840295117938, 'loss_val': 0.4978192039153197, 'psi': 0.6609025958022856}
[S5] START round=6 head_norm_before_train=0.793601 cos_to_last_merge=1.0000 (last merge round=5)
[S5] round=6 local utility u=0.884348 metrics={'f1_val': 0.41654174186412063, 'auprc': 0.7722090123603108, 'loss_val': 1.1311503313165874, 'psi': 0.5588086500625967}-{'f1_val': 0.14226190476190476, 'auprc': 0.7411830544022735, 'loss_val': 1.161089274684248, 'psi': 0.38183036461805225}
[S6] START round=6 head_norm_before_train=0.878083 cos_to_last_merge=0.9923 (last merge round=4)
[S6] round=6 local utility u=0.000000 metrics={'f1_val': 0.4058871117628937, 'auprc': 0.6998296779577957, 'loss_val': 0.8307629800879333, 'psi': 0.5234641382408545}-{'f1_val': 0.6308930274354075, 'auprc': 0.9718849382514894, 'loss_val': 0.626925556000617, 'psi': 0.7672897917618402}
[S7] START round=6 head_norm_before_train=1.290349 (no previous merge yet)
[S7] round=6 local utility u=0.851209 metrics={'f1_val': 0.41748350776510673, 'auprc': 0.7777682700005564, 'loss_val': 1.0953600568361634, 'psi': 0.5615974126592866}-{'f1_val': 0.14205682272909165, 'auprc': 0.7775488060504615, 'loss_val': 1.1445585844279444, 'psi': 0.3962536160576396}
[S8] START round=6 head_norm_before_train=1.098258 cos_to_last_merge=0.9650 (last merge round=2)
[S8] round=6 local utility u=0.137208 metrics={'f1_val': 0.7139807753193125, 'auprc': 0.9962159212585442, 'loss_val': 0.39016715932486135, 'psi': 0.8268748336950051}-{'f1_val': 0.7140451255766143, 'auprc': 0.9962776983312467, 'loss_val': 0.6651540597008656, 'psi': 0.8269381546784672}
[S9] START round=6 head_norm_before_train=0.655823 cos_to_last_merge=0.9954 (last merge round=4)
[S9] round=6 local utility u=0.040954 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8657128593393993, 'loss_val': 1.14098232602117, 'psi': 0.43112391801975736}-{'f1_val': 0.141397957139996, 'auprc': 0.8658827282317397, 'loss_val': 1.223399211487162, 'psi': 0.43119186557669353}
[S10] START round=6 head_norm_before_train=1.421399 (no previous merge yet)
[S10] round=6 local utility u=0.109280 metrics={'f1_val': 0.6925073191163755, 'auprc': 0.9892625371395619, 'loss_val': 0.29322837458746065, 'psi': 0.8112094063256501}-{'f1_val': 0.6889456628288311, 'auprc': 0.9741035999256282, 'loss_val': 0.44494155729418555, 'psi': 0.8030088376675499}
[S11] START round=6 head_norm_before_train=1.002043 cos_to_last_merge=0.9978 (last merge round=4)
[S11] round=6 local utility u=0.147449 metrics={'f1_val': 0.41409654937956825, 'auprc': 0.6602126020330773, 'loss_val': 0.9497914741985518, 'psi': 0.5125429704409719}-{'f1_val': 0.4225625868721864, 'auprc': 0.5961047512488569, 'loss_val': 1.103162122142037, 'psi': 0.4919794526228546}
[S13] START round=6 head_norm_before_train=1.064978 cos_to_last_merge=0.9664 (last merge round=2)
[S13] round=6 local utility u=0.000000 metrics={'f1_val': 0.3482680606519893, 'auprc': 0.5966141152570922, 'loss_val': 0.8190338808516372, 'psi': 0.44760648249403046}-{'f1_val': 0.3853013457669673, 'auprc': 0.7388652234608404, 'loss_val': 0.7946409871725043, 'psi': 0.5267268968445166}
[S14] START round=6 head_norm_before_train=0.560690 cos_to_last_merge=1.0000 (last merge round=5)
[S14] round=6 local utility u=0.070156 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.772067723406643, 'loss_val': 1.2871213788465794, 'psi': 0.3930418010922795}-{'f1_val': 0.14035785288270378, 'auprc': 0.7318527753041887, 'loss_val': 1.306789005121865, 'psi': 0.3769558218512977}
[S15] START round=6 head_norm_before_train=0.891920 cos_to_last_merge=0.9635 (last merge round=2)
[S15] round=6 local utility u=0.298241 metrics={'f1_val': 0.4167276561389307, 'auprc': 0.93801801283826, 'loss_val': 0.8123173775992133, 'psi': 0.6252437988186624}-{'f1_val': 0.4161838404121786, 'auprc': 0.7998311778684494, 'loss_val': 0.9909756585756266, 'psi': 0.5696427753946869}
[S16] START round=6 head_norm_before_train=0.748824 cos_to_last_merge=0.9615 (last merge round=2)
[S16] round=6 local utility u=0.478800 metrics={'f1_val': 0.413691364517153, 'auprc': 0.5409470241940215, 'loss_val': 1.1514342740921113, 'psi': 0.4645936283879004}-{'f1_val': 0.14063745019920318, 'auprc': 0.7934341615050792, 'loss_val': 1.2281731852636946, 'psi': 0.4017561347215536}
[S17] START round=6 head_norm_before_train=1.455406 (no previous merge yet)
[S17] round=6 local utility u=0.115630 metrics={'f1_val': 0.35800530403751923, 'auprc': 0.6879287945189723, 'loss_val': 0.7873673166109678, 'psi': 0.4899747002301005}-{'f1_val': 0.35332495072624465, 'auprc': 0.65415926013991, 'loss_val': 0.8892371970666011, 'psi': 0.4736586744917108}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:58307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:58308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:58316
[S11] not sending this round → trigger blocked (psi=0.513)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S11@127.0.0.1:58312
[S2] not sending this round → trigger blocked (psi=0.731)
[S3] not sending this round → trigger blocked (psi=0.637)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:58305
[S9] not sending this round → trigger blocked (psi=0.431)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:58305
[S15] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S7] sending update (kind=head size=1794 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1801) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.965684)
[S5] loaded HEAD from S15 (vec_in norm=0.965684)
[S5] cosine check vs S15: cos=0.1470
[S5] BUFFERED delta from S15 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1799) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.786419)
[S6] loaded HEAD from S16 (vec_in norm=0.786419)
[S6] cosine check vs S16: cos=0.3773
[S6] BUFFERED delta from S16 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1795) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.821935)
[S16] loaded HEAD from S5 (vec_in norm=0.821935)
[S16] cosine check vs S5: cos=0.0576
[S16] BUFFERED delta from S5 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1794) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.310210)
[S14] loaded HEAD from S7 (vec_in norm=1.310210)
[S14] cosine check vs S7: cos=0.5856
[S14] BUFFERED delta from S7 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1800) from S8
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.197016)
[S7] loaded HEAD from S8 (vec_in norm=1.197016)
[S7] cosine check vs S8: cos=0.0311
[S7] BUFFERED delta from S8 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1804) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.628288)
[S11] loaded HEAD from S4 (vec_in norm=1.628288)
[S11] cosine check vs S4: cos=0.6972
[S11] BUFFERED delta from S4 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1800) from S14
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.586281)
[S5] loaded HEAD from S14 (vec_in norm=0.586281)
[S5] cosine check vs S14: cos=0.4276
[S5] BUFFERED delta from S14 (total buffered=2)
[S5] RECEIVED delta(kind=head bytes=1799) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.509213)
[S5] loaded HEAD from S10 (vec_in norm=1.509213)
[S5] cosine check vs S10: cos=0.1697
[S5] BUFFERED delta from S10 (total buffered=3)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S17] → sending delta(kind=head bytes=1792) to S9@127.0.0.1:58310
[S17] sending update (kind=head size=1792 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1792) from S17
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.491953)
[S9] loaded HEAD from S17 (vec_in norm=1.491953)
[S9] cosine check vs S17: cos=0.5183
[S9] BUFFERED delta from S17 (total buffered=1)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=6 metric=0.4141 head_norm=1.036311
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.857250e-01
[S11] stored merged vector for next round verification (round=6)
[S11] DEBUG after merge:  round=6 metric=0.3965 head_norm=1.232703 delta_norm=0.585725
[S11] aggregate: ROLLBACK (f1_val pre=0.414 post=0.397 tol_abs=0.005 tol_rel=0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=6 metric=0.4059 head_norm=0.978718
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.988778e-01
[S6] stored merged vector for next round verification (round=6)
[S6] DEBUG after merge:  round=6 metric=0.4307 head_norm=0.734366 delta_norm=0.498878
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=6 metric=0.1414 head_norm=0.690313
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.393011e-01
[S9] stored merged vector for next round verification (round=6)
[S9] DEBUG after merge:  round=6 metric=0.1414 head_norm=0.970836 delta_norm=0.639301
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=6 metric=0.1404 head_norm=0.586281
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.386733e-01
[S14] stored merged vector for next round verification (round=6)
[S14] DEBUG after merge:  round=6 metric=0.1404 head_norm=0.860243 delta_norm=0.538673
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=6 metric=0.4175 head_norm=1.310210
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.734704e-01
[S7] stored merged vector for next round verification (round=6)
[S7] DEBUG after merge:  round=6 metric=0.4178 head_norm=0.900998 delta_norm=0.873470
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=6 metric=0.4165 head_norm=0.821935
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.315713e-01
[S5] stored merged vector for next round verification (round=6)
[S5] DEBUG after merge:  round=6 metric=0.3397 head_norm=0.594999 delta_norm=0.431571
[S5] aggregate: ROLLBACK (f1_val pre=0.417 post=0.340 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=6 metric=0.4137 head_norm=0.786419
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.521623e-01
[S16] stored merged vector for next round verification (round=6)
[S16] DEBUG after merge:  round=6 metric=0.3820 head_norm=0.584921 delta_norm=0.552162
[S16] aggregate: ROLLBACK (f1_val pre=0.414 post=0.382 tol_abs=0.005 tol_rel=0.0)
[S2] START round=7 head_norm_before_train=1.515165 (no previous merge yet)
[S2] round=7 local utility u=0.000000 metrics={'f1_val': 0.6974193756946119, 'auprc': 0.7523771940871214, 'loss_val': 0.37549106278934297, 'psi': 0.7194025030516158}-{'f1_val': 0.6998459069236436, 'auprc': 0.7778948992778363, 'loss_val': 0.4586076534752783, 'psi': 0.7310655038653207}
[S3] START round=7 head_norm_before_train=1.356999 (no previous merge yet)
[S3] round=7 local utility u=0.998198 metrics={'f1_val': 0.69982954919712, 'auprc': 0.9987118460791548, 'loss_val': 0.7647805248857088, 'psi': 0.819382467949934}-{'f1_val': 0.39645225981545407, 'auprc': 0.996584259304968, 'loss_val': 0.9345310144734436, 'psi': 0.6365050596112596}
[S4] START round=7 head_norm_before_train=1.628288 (no previous merge yet)
[S4] round=7 local utility u=0.892083 metrics={'f1_val': 0.9459597474220972, 'auprc': 0.9462974806011303, 'loss_val': 0.4476263904484008, 'psi': 0.9460948406937104}-{'f1_val': 0.6615218742476329, 'auprc': 0.9388625169651406, 'loss_val': 0.5028592766584161, 'psi': 0.7724581313346359}
[S5] START round=7 head_norm_before_train=0.594999 cos_to_last_merge=1.0000 (last merge round=6)
[S5] round=7 local utility u=0.032203 metrics={'f1_val': 0.41754956401939425, 'auprc': 0.7777361941497682, 'loss_val': 1.0893735187758156, 'psi': 0.5616242160715439}-{'f1_val': 0.41654174186412063, 'auprc': 0.7722090123603108, 'loss_val': 1.1311503313165874, 'psi': 0.5588086500625967}
[S6] START round=7 head_norm_before_train=0.734366 cos_to_last_merge=1.0000 (last merge round=6)
[S6] round=7 local utility u=0.912432 metrics={'f1_val': 0.619721927059431, 'auprc': 0.8196041000473087, 'loss_val': 0.6482307321294133, 'psi': 0.699674796254582}-{'f1_val': 0.4058871117628937, 'auprc': 0.6998296779577957, 'loss_val': 0.8307629800879333, 'psi': 0.5234641382408545}
[S7] START round=7 head_norm_before_train=0.900998 cos_to_last_merge=1.0000 (last merge round=6)
[S7] round=7 local utility u=0.014352 metrics={'f1_val': 0.41675063022786896, 'auprc': 0.7776117246394258, 'loss_val': 1.0617889953720545, 'psi': 0.5610950679924918}-{'f1_val': 0.41748350776510673, 'auprc': 0.7777682700005564, 'loss_val': 1.0953600568361634, 'psi': 0.5615974126592866}
[S8] START round=7 head_norm_before_train=1.197016 cos_to_last_merge=0.9429 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.943
[S8] round=7 local utility u=0.070570 metrics={'f1_val': 0.7140449400060004, 'auprc': 0.9993518301739992, 'loss_val': 0.2588205129433588, 'psi': 0.8281676960731998}-{'f1_val': 0.7139807753193125, 'auprc': 0.9962159212585442, 'loss_val': 0.39016715932486135, 'psi': 0.8268748336950051}
[S9] START round=7 head_norm_before_train=0.970836 cos_to_last_merge=1.0000 (last merge round=6)
[S9] round=7 local utility u=0.046529 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8653925322833957, 'loss_val': 1.046962369125971, 'psi': 0.43099578719735593}-{'f1_val': 0.141397957139996, 'auprc': 0.8657128593393993, 'loss_val': 1.14098232602117, 'psi': 0.43112391801975736}
[S10] START round=7 head_norm_before_train=1.509213 (no previous merge yet)
[S10] round=7 local utility u=0.019551 metrics={'f1_val': 0.7005624563555293, 'auprc': 0.9863549385713927, 'loss_val': 0.2937343322929932, 'psi': 0.8148794492418746}-{'f1_val': 0.6925073191163755, 'auprc': 0.9892625371395619, 'loss_val': 0.29322837458746065, 'psi': 0.8112094063256501}
[S11] START round=7 head_norm_before_train=1.232703 cos_to_last_merge=1.0000 (last merge round=6)
[S11] round=7 local utility u=0.161296 metrics={'f1_val': 0.39651855440916606, 'auprc': 0.778664020240668, 'loss_val': 0.8770854646960377, 'psi': 0.5493767407417669}-{'f1_val': 0.41409654937956825, 'auprc': 0.6602126020330773, 'loss_val': 0.9497914741985518, 'psi': 0.5125429704409719}
[S13] START round=7 head_norm_before_train=1.143938 cos_to_last_merge=0.9461 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.946
[S13] round=7 local utility u=1.000000 metrics={'f1_val': 0.6537746793879877, 'auprc': 0.7163694796315226, 'loss_val': 0.5402280039895803, 'psi': 0.6788125994854017}-{'f1_val': 0.3482680606519893, 'auprc': 0.5966141152570922, 'loss_val': 0.8190338808516372, 'psi': 0.44760648249403046}
[S14] START round=7 head_norm_before_train=0.860243 cos_to_last_merge=1.0000 (last merge round=6)
[S14] round=7 local utility u=0.051293 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7981009884208115, 'loss_val': 1.2626344185756333, 'psi': 0.40345510709794685}-{'f1_val': 0.14035785288270378, 'auprc': 0.772067723406643, 'loss_val': 1.2871213788465794, 'psi': 0.3930418010922795}
[S15] START round=7 head_norm_before_train=0.965684 cos_to_last_merge=0.9323 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.932
[S15] round=7 local utility u=0.000000 metrics={'f1_val': 0.4166476271967524, 'auprc': 0.8376080866105383, 'loss_val': 0.7837004963759676, 'psi': 0.5850318109622668}-{'f1_val': 0.4167276561389307, 'auprc': 0.93801801283826, 'loss_val': 0.8123173775992133, 'psi': 0.6252437988186624}
[S16] START round=7 head_norm_before_train=0.584921 cos_to_last_merge=1.0000 (last merge round=6)
[S16] round=7 local utility u=0.059542 metrics={'f1_val': 0.41711215249276345, 'auprc': 0.5562335674645259, 'loss_val': 1.0987345723622095, 'psi': 0.47276071848146844}-{'f1_val': 0.413691364517153, 'auprc': 0.5409470241940215, 'loss_val': 1.1514342740921113, 'psi': 0.4645936283879004}
[S17] START round=7 head_norm_before_train=1.491953 (no previous merge yet)
[S17] round=7 local utility u=0.104805 metrics={'f1_val': 0.37866388118942734, 'auprc': 0.6938367539831879, 'loss_val': 0.7194316885495221, 'psi': 0.5047330303069315}-{'f1_val': 0.35800530403751923, 'auprc': 0.6879287945189723, 'loss_val': 0.7873673166109678, 'psi': 0.4899747002301005}
[S5] not sending this round → trigger blocked (psi=0.562)
[S4] not sending this round → trigger blocked (psi=0.946)
[S8] not sending this round → trigger blocked (psi=0.828)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:58304
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:58310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:58310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S9] → sending delta(kind=head bytes=1789) to S14@127.0.0.1:58314
[S10] not sending this round → trigger blocked (psi=0.815)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:58305
[S14] not sending this round → trigger blocked (psi=0.403)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.473)
[S7] not sending this round → trigger blocked (psi=0.561)
[S9] sending update (kind=head size=1789 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1794 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1794) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.817312)
[S4] loaded HEAD from S6 (vec_in norm=0.817312)
[S4] cosine check vs S6: cos=0.0245
[S4] BUFFERED delta from S6 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1789) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.991196)
[S14] loaded HEAD from S9 (vec_in norm=0.991196)
[S14] cosine check vs S9: cos=0.1793
[S14] BUFFERED delta from S9 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1801) from S13
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.212968)
[S9] loaded HEAD from S13 (vec_in norm=1.212968)
[S9] cosine check vs S13: cos=0.2013
[S9] BUFFERED delta from S13 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1801) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.255516)
[S9] loaded HEAD from S11 (vec_in norm=1.255516)
[S9] cosine check vs S11: cos=0.0004
[S9] BUFFERED delta from S11 (total buffered=2)
[S5] RECEIVED delta(kind=head bytes=1798) from S3
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.403919)
[S5] loaded HEAD from S3 (vec_in norm=1.403919)
[S5] cosine check vs S3: cos=0.5832
[S5] BUFFERED delta from S3 (total buffered=1)
[S17] not sending this round → trigger blocked (psi=0.505)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=7 metric=0.9460 head_norm=1.691034
[S4] _apply_head_vector_avg (torch): Δ‖w‖=9.300486e-01
[S4] stored merged vector for next round verification (round=7)
[S4] DEBUG after merge:  round=7 metric=0.9453 head_norm=0.948054 delta_norm=0.930049
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=7 metric=0.4175 head_norm=0.633004
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.777298e-01
[S5] stored merged vector for next round verification (round=7)
[S5] DEBUG after merge:  round=7 metric=0.4175 head_norm=0.923076 delta_norm=0.577730
[S5] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=7 metric=0.1404 head_norm=0.873421
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.989292e-01
[S14] stored merged vector for next round verification (round=7)
[S14] DEBUG after merge:  round=7 metric=0.1404 head_norm=0.716904 delta_norm=0.598929
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=7 metric=0.1414 head_norm=0.991196
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.143836e-01
[S9] stored merged vector for next round verification (round=7)
[S9] DEBUG after merge:  round=7 metric=0.4361 head_norm=0.706202 delta_norm=0.614384
[S9] aggregate: ACCEPT kept=['S13', 'S11'] (k=2/2) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=1.586224 (no previous merge yet)
[S2] round=8 local utility u=0.091530 metrics={'f1_val': 0.700119666705471, 'auprc': 0.7890613457168958, 'loss_val': 0.318684816908828, 'psi': 0.735696338310041}-{'f1_val': 0.6974193756946119, 'auprc': 0.7523771940871214, 'loss_val': 0.37549106278934297, 'psi': 0.7194025030516158}
[S3] START round=8 head_norm_before_train=1.403919 (no previous merge yet)
[S3] round=8 local utility u=0.000000 metrics={'f1_val': 0.6190837867338614, 'auprc': 0.9952241688611335, 'loss_val': 0.6470409989856005, 'psi': 0.7695399395847702}-{'f1_val': 0.69982954919712, 'auprc': 0.9987118460791548, 'loss_val': 0.7647805248857088, 'psi': 0.819382467949934}
[S4] START round=8 head_norm_before_train=0.948054 cos_to_last_merge=1.0000 (last merge round=7)
[S4] round=8 local utility u=0.015373 metrics={'f1_val': 0.9451515590726071, 'auprc': 0.9518999274356205, 'loss_val': 0.42883807082414255, 'psi': 0.9478509064178124}-{'f1_val': 0.9459597474220972, 'auprc': 0.9462974806011303, 'loss_val': 0.4476263904484008, 'psi': 0.9460948406937104}
[S5] START round=8 head_norm_before_train=0.923076 cos_to_last_merge=1.0000 (last merge round=7)
[S5] round=8 local utility u=0.046202 metrics={'f1_val': 0.4175465518408786, 'auprc': 0.7902759697807764, 'loss_val': 1.0345717127467844, 'psi': 0.5666383190168378}-{'f1_val': 0.41754956401939425, 'auprc': 0.7777361941497682, 'loss_val': 1.0893735187758156, 'psi': 0.5616242160715439}
[S6] START round=8 head_norm_before_train=0.817312 cos_to_last_merge=0.9852 (last merge round=6)
[S6] round=8 local utility u=0.000000 metrics={'f1_val': 0.4383331890938935, 'auprc': 0.7613670844082329, 'loss_val': 0.7610112724819719, 'psi': 0.5675467472196293}-{'f1_val': 0.619721927059431, 'auprc': 0.8196041000473087, 'loss_val': 0.6482307321294133, 'psi': 0.699674796254582}
[S7] START round=8 head_norm_before_train=0.931137 cos_to_last_merge=0.9978 (last merge round=6)
[S7] round=8 local utility u=0.046690 metrics={'f1_val': 0.41955143146130297, 'auprc': 0.7770716957447431, 'loss_val': 0.9835931702809794, 'psi': 0.562559537174679}-{'f1_val': 0.41675063022786896, 'auprc': 0.7776117246394258, 'loss_val': 1.0617889953720545, 'psi': 0.5610950679924918}
[S8] START round=8 head_norm_before_train=1.279286 cos_to_last_merge=0.9223 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.922
[S8] round=8 local utility u=0.011071 metrics={'f1_val': 0.7141738056351523, 'auprc': 0.9973145647155409, 'loss_val': 0.2313395367088769, 'psi': 0.8274301092673078}-{'f1_val': 0.7140449400060004, 'auprc': 0.9993518301739992, 'loss_val': 0.2588205129433588, 'psi': 0.8281676960731998}
[S9] START round=8 head_norm_before_train=0.706202 cos_to_last_merge=1.0000 (last merge round=7)
[S9] round=8 local utility u=0.852480 metrics={'f1_val': 0.41677413407000763, 'auprc': 0.8657617773824021, 'loss_val': 0.9953680896176538, 'psi': 0.5963691913949655}-{'f1_val': 0.141397957139996, 'auprc': 0.8653925322833957, 'loss_val': 1.046962369125971, 'psi': 0.43099578719735593}
[S10] START round=8 head_norm_before_train=1.574008 (no previous merge yet)
[S10] round=8 local utility u=0.860888 metrics={'f1_val': 0.9572407697314703, 'auprc': 0.997484211706287, 'loss_val': 0.14541604364836744, 'psi': 0.973338146521397}-{'f1_val': 0.7005624563555293, 'auprc': 0.9863549385713927, 'loss_val': 0.2937343322929932, 'psi': 0.8148794492418746}
[S11] START round=8 head_norm_before_train=1.255516 cos_to_last_merge=0.9973 (last merge round=6)
[S11] round=8 local utility u=1.000000 metrics={'f1_val': 0.6870004097292062, 'auprc': 0.9186105875132052, 'loss_val': 0.7269267203101246, 'psi': 0.7796444808428058}-{'f1_val': 0.39651855440916606, 'auprc': 0.778664020240668, 'loss_val': 0.8770854646960377, 'psi': 0.5493767407417669}
[S13] START round=8 head_norm_before_train=1.212968 cos_to_last_merge=0.9296 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.930
[S13] round=8 local utility u=0.000000 metrics={'f1_val': 0.6265990145695953, 'auprc': 0.6738479880240922, 'loss_val': 0.5791424396136243, 'psi': 0.6454986039513941}-{'f1_val': 0.6537746793879877, 'auprc': 0.7163694796315226, 'loss_val': 0.5402280039895803, 'psi': 0.6788125994854017}
[S14] START round=8 head_norm_before_train=0.716904 cos_to_last_merge=1.0000 (last merge round=7)
[S14] round=8 local utility u=0.083294 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8426985021082959, 'loss_val': 1.229838392205794, 'psi': 0.42129411257294064}-{'f1_val': 0.14035785288270378, 'auprc': 0.7981009884208115, 'loss_val': 1.2626344185756333, 'psi': 0.40345510709794685}
[S15] START round=8 head_norm_before_train=1.030671 cos_to_last_merge=0.9004 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.900
[S15] round=8 local utility u=0.289209 metrics={'f1_val': 0.4165758656721796, 'auprc': 0.9849573554501914, 'loss_val': 0.6469002662425094, 'psi': 0.6439284615833842}-{'f1_val': 0.4166476271967524, 'auprc': 0.8376080866105383, 'loss_val': 0.7837004963759676, 'psi': 0.5850318109622668}
[S16] START round=8 head_norm_before_train=0.621425 cos_to_last_merge=0.9927 (last merge round=6)
[S16] round=8 local utility u=0.000000 metrics={'f1_val': 0.38446087052526656, 'auprc': 0.5647874299336679, 'loss_val': 0.9995869284335782, 'psi': 0.4565914942886271}-{'f1_val': 0.41711215249276345, 'auprc': 0.5562335674645259, 'loss_val': 1.0987345723622095, 'psi': 0.47276071848146844}
[S17] START round=8 head_norm_before_train=1.520616 (no previous merge yet)
[S17] round=8 local utility u=0.323077 metrics={'f1_val': 0.41726765663321946, 'auprc': 0.7848747626027438, 'loss_val': 0.5780137987578653, 'psi': 0.5643104990210293}-{'f1_val': 0.37866388118942734, 'auprc': 0.6938367539831879, 'loss_val': 0.7194316885495221, 'psi': 0.5047330303069315}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] → sending delta(kind=head bytes=1806) to S7@127.0.0.1:58308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:58314
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:58312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:58310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S5] → sending delta(kind=head bytes=1787) to S16@127.0.0.1:58316
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] → sending delta(kind=head bytes=1792) to S5@127.0.0.1:58305
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1792 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1806 to 1 peers)
[S5] sending update (kind=head size=1787 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1796) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.960377)
[S14] loaded HEAD from S7 (vec_in norm=0.960377)
[S14] cosine check vs S7: cos=0.5744
[S14] BUFFERED delta from S7 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1806) from S8
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.342621)
[S7] loaded HEAD from S8 (vec_in norm=1.342621)
[S7] cosine check vs S8: cos=0.6592
[S7] BUFFERED delta from S8 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1799) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.288106)
[S9] loaded HEAD from S11 (vec_in norm=1.288106)
[S9] cosine check vs S11: cos=0.4238
[S9] BUFFERED delta from S11 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1796) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.024792)
[S11] loaded HEAD from S4 (vec_in norm=1.024792)
[S11] cosine check vs S4: cos=0.8063
[S11] BUFFERED delta from S4 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1792) from S14
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.738230)
[S5] loaded HEAD from S14 (vec_in norm=0.738230)
[S5] cosine check vs S14: cos=0.1497
[S5] BUFFERED delta from S14 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1795) from S2
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.646083)
[S5] loaded HEAD from S2 (vec_in norm=1.646083)
[S5] cosine check vs S2: cos=-0.0871
[S5] DROPPED delta from S2 (cos=-0.0871 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1797) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.741385)
[S14] loaded HEAD from S9 (vec_in norm=0.741385)
[S14] cosine check vs S9: cos=0.6416
[S14] BUFFERED delta from S9 (total buffered=2)
[S5] RECEIVED delta(kind=head bytes=1801) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.616661)
[S5] loaded HEAD from S10 (vec_in norm=1.616661)
[S5] cosine check vs S10: cos=0.1582
[S5] BUFFERED delta from S10 (total buffered=2)
[S5] RECEIVED delta(kind=head bytes=1796) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.104217)
[S5] loaded HEAD from S15 (vec_in norm=1.104217)
[S5] cosine check vs S15: cos=0.1891
[S5] BUFFERED delta from S15 (total buffered=3)
[S16] RECEIVED delta(kind=head bytes=1787) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.948842)
[S16] loaded HEAD from S5 (vec_in norm=0.948842)
[S16] cosine check vs S5: cos=0.6531
[S16] BUFFERED delta from S5 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:58310
[S17] sending update (kind=head size=1802 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1802) from S17
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.555054)
[S9] loaded HEAD from S17 (vec_in norm=1.555054)
[S9] cosine check vs S17: cos=0.6514
[S9] BUFFERED delta from S17 (total buffered=2)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=8 metric=0.6870 head_norm=1.288106
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.810606e-01
[S11] stored merged vector for next round verification (round=8)
[S11] DEBUG after merge:  round=8 metric=0.6939 head_norm=1.099773 delta_norm=0.381061
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=8 metric=0.4175 head_norm=0.948842
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.154483e-01
[S5] stored merged vector for next round verification (round=8)
[S5] DEBUG after merge:  round=8 metric=0.4177 head_norm=0.665554 delta_norm=0.515448
[S5] aggregate: ACCEPT kept=['S14', 'S10', 'S15'] (k=3/3) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=8 metric=0.1404 head_norm=0.738230
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.596419e-01
[S14] stored merged vector for next round verification (round=8)
[S14] DEBUG after merge:  round=8 metric=0.1404 head_norm=0.668280 delta_norm=0.259642
[S14] aggregate: ACCEPT kept=['S7', 'S9'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=8 metric=0.4168 head_norm=0.741385
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.241854e-01
[S9] stored merged vector for next round verification (round=8)
[S9] DEBUG after merge:  round=8 metric=0.4167 head_norm=0.826390 delta_norm=0.324185
[S9] aggregate: ACCEPT kept=['S11', 'S17'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=8 metric=0.4196 head_norm=0.960377
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.061859e-01
[S7] stored merged vector for next round verification (round=8)
[S7] DEBUG after merge:  round=8 metric=0.4189 head_norm=1.051785 delta_norm=0.506186
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=8 metric=0.3845 head_norm=0.660782
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.598702e-01
[S16] stored merged vector for next round verification (round=8)
[S16] DEBUG after merge:  round=8 metric=0.3906 head_norm=0.734139 delta_norm=0.359870
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.646083 (no previous merge yet)
[S2] round=9 local utility u=0.000000 metrics={'f1_val': 0.7000345296847245, 'auprc': 0.6778283827709224, 'loss_val': 0.3267013038890541, 'psi': 0.6911520709192036}-{'f1_val': 0.700119666705471, 'auprc': 0.7890613457168958, 'loss_val': 0.318684816908828, 'psi': 0.735696338310041}
[S3] START round=9 head_norm_before_train=1.456303 (no previous merge yet)
[S3] round=9 local utility u=0.000000 metrics={'f1_val': 0.5384937499581307, 'auprc': 0.9960158322446455, 'loss_val': 0.5651744833302127, 'psi': 0.7215025828727366}-{'f1_val': 0.6190837867338614, 'auprc': 0.9952241688611335, 'loss_val': 0.6470409989856005, 'psi': 0.7695399395847702}
[S4] START round=9 head_norm_before_train=1.024792 cos_to_last_merge=0.9964 (last merge round=7)
[S4] round=9 local utility u=0.077839 metrics={'f1_val': 0.9469264314878232, 'auprc': 0.9668550903649836, 'loss_val': 0.3286752637984946, 'psi': 0.9548978950386874}-{'f1_val': 0.9451515590726071, 'auprc': 0.9518999274356205, 'loss_val': 0.42883807082414255, 'psi': 0.9478509064178124}
[S5] START round=9 head_norm_before_train=0.665554 cos_to_last_merge=1.0000 (last merge round=8)
[S5] round=9 local utility u=0.000000 metrics={'f1_val': 0.4174665005497404, 'auprc': 0.7746639053281235, 'loss_val': 1.0015780546037767, 'psi': 0.5603454624610936}-{'f1_val': 0.4175465518408786, 'auprc': 0.7902759697807764, 'loss_val': 1.0345717127467844, 'psi': 0.5666383190168378}
[S6] START round=9 head_norm_before_train=0.918982 cos_to_last_merge=0.9546 (last merge round=6)
[S6] round=9 local utility u=0.701299 metrics={'f1_val': 0.6141403603446273, 'auprc': 0.8109021763778652, 'loss_val': 0.5618624524073119, 'psi': 0.6928450867579224}-{'f1_val': 0.4383331890938935, 'auprc': 0.7613670844082329, 'loss_val': 0.7610112724819719, 'psi': 0.5675467472196293}
[S7] START round=9 head_norm_before_train=1.051785 cos_to_last_merge=1.0000 (last merge round=8)
[S7] round=9 local utility u=0.831385 metrics={'f1_val': 0.7144306615089584, 'auprc': 0.7423968102297427, 'loss_val': 0.9860730952008163, 'psi': 0.7256171209972722}-{'f1_val': 0.41955143146130297, 'auprc': 0.7770716957447431, 'loss_val': 0.9835931702809794, 'psi': 0.562559537174679}
[S8] START round=9 head_norm_before_train=1.342621 cos_to_last_merge=0.9077 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.908
[S8] round=9 local utility u=0.889919 metrics={'f1_val': 0.9956124759962259, 'auprc': 0.9992351886343518, 'loss_val': 0.14589548238577427, 'psi': 0.9970615610514764}-{'f1_val': 0.7141738056351523, 'auprc': 0.9973145647155409, 'loss_val': 0.2313395367088769, 'psi': 0.8274301092673078}
[S9] START round=9 head_norm_before_train=0.826390 cos_to_last_merge=1.0000 (last merge round=8)
[S9] round=9 local utility u=0.128923 metrics={'f1_val': 0.4378582197325261, 'auprc': 0.8658721786717439, 'loss_val': 0.8643584961851074, 'psi': 0.6090638033082132}-{'f1_val': 0.41677413407000763, 'auprc': 0.8657617773824021, 'loss_val': 0.9953680896176538, 'psi': 0.5963691913949655}
[S10] START round=9 head_norm_before_train=1.616661 (no previous merge yet)
[S10] round=9 local utility u=0.126818 metrics={'f1_val': 0.9961684647169089, 'auprc': 0.9973364227094793, 'loss_val': 0.1249023484697709, 'psi': 0.9966356479139371}-{'f1_val': 0.9572407697314703, 'auprc': 0.997484211706287, 'loss_val': 0.14541604364836744, 'psi': 0.973338146521397}
[S11] START round=9 head_norm_before_train=1.099773 cos_to_last_merge=1.0000 (last merge round=8)
[S11] round=9 local utility u=0.000000 metrics={'f1_val': 0.5993417125669712, 'auprc': 0.84135911331215, 'loss_val': 0.7296394659053989, 'psi': 0.6961486728650428}-{'f1_val': 0.6870004097292062, 'auprc': 0.9186105875132052, 'loss_val': 0.7269267203101246, 'psi': 0.7796444808428058}
[S13] START round=9 head_norm_before_train=1.264487 cos_to_last_merge=0.9178 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.918
[S13] round=9 local utility u=0.000000 metrics={'f1_val': 0.6008222040297994, 'auprc': 0.685412243829934, 'loss_val': 0.6985087066959578, 'psi': 0.6346582199498533}-{'f1_val': 0.6265990145695953, 'auprc': 0.6738479880240922, 'loss_val': 0.5791424396136243, 'psi': 0.6454986039513941}
[S14] START round=9 head_norm_before_train=0.668280 cos_to_last_merge=1.0000 (last merge round=8)
[S14] round=9 local utility u=0.061787 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8648724199739783, 'loss_val': 1.172786904963654, 'psi': 0.4301636797192136}-{'f1_val': 0.14035785288270378, 'auprc': 0.8426985021082959, 'loss_val': 1.229838392205794, 'psi': 0.42129411257294064}
[S15] START round=9 head_norm_before_train=1.104217 cos_to_last_merge=0.8779 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.878
[S15] round=9 local utility u=0.804153 metrics={'f1_val': 0.7070718939668525, 'auprc': 0.9157077787240828, 'loss_val': 0.5738210168149047, 'psi': 0.7905262478697447}-{'f1_val': 0.4165758656721796, 'auprc': 0.9849573554501914, 'loss_val': 0.6469002662425094, 'psi': 0.6439284615833842}
[S16] START round=9 head_norm_before_train=0.734139 cos_to_last_merge=1.0000 (last merge round=8)
[S16] round=9 local utility u=0.365211 metrics={'f1_val': 0.41642751344040885, 'auprc': 0.733062511709353, 'loss_val': 0.9657905613018705, 'psi': 0.5430815127479864}-{'f1_val': 0.38446087052526656, 'auprc': 0.5647874299336679, 'loss_val': 0.9995869284335782, 'psi': 0.4565914942886271}
[S17] START round=9 head_norm_before_train=1.555054 (no previous merge yet)
[S17] round=9 local utility u=0.085103 metrics={'f1_val': 0.4213953127871242, 'auprc': 0.8315422401417837, 'loss_val': 0.5725755309777336, 'psi': 0.5854540837289881}-{'f1_val': 0.41726765663321946, 'auprc': 0.7848747626027438, 'loss_val': 0.5780137987578653, 'psi': 0.5643104990210293}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] → sending delta(kind=head bytes=1793) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] → sending delta(kind=head bytes=1792) to S4@127.0.0.1:58304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:58305
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:58308
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:58314
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:58312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] → sending delta(kind=head bytes=1792) to S6@127.0.0.1:58307
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1792 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1793 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S6] sending update (kind=head size=1792 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1792) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.002527)
[S4] loaded HEAD from S6 (vec_in norm=1.002527)
[S4] cosine check vs S6: cos=0.3767
[S4] BUFFERED delta from S6 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1801) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.859737)
[S14] loaded HEAD from S9 (vec_in norm=0.859737)
[S14] cosine check vs S9: cos=0.6581
[S14] BUFFERED delta from S9 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1792) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.765009)
[S6] loaded HEAD from S16 (vec_in norm=0.765009)
[S6] cosine check vs S16: cos=0.2380
[S6] BUFFERED delta from S16 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1793) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.073683)
[S14] loaded HEAD from S7 (vec_in norm=1.073683)
[S14] cosine check vs S7: cos=0.6820
[S14] BUFFERED delta from S7 (total buffered=2)
[S7] RECEIVED delta(kind=head bytes=1804) from S8
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.397533)
[S7] loaded HEAD from S8 (vec_in norm=1.397533)
[S7] cosine check vs S8: cos=0.9216
[S7] BUFFERED delta from S8 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1797) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.138793)
[S11] loaded HEAD from S4 (vec_in norm=1.138793)
[S11] cosine check vs S4: cos=0.9191
[S11] BUFFERED delta from S4 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1795) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.178822)
[S5] loaded HEAD from S15 (vec_in norm=1.178822)
[S5] cosine check vs S15: cos=0.5537
[S5] BUFFERED delta from S15 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1794) from S14
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.697877)
[S5] loaded HEAD from S14 (vec_in norm=0.697877)
[S5] cosine check vs S14: cos=0.2490
[S5] BUFFERED delta from S14 (total buffered=2)
[S5] RECEIVED delta(kind=head bytes=1798) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.650227)
[S5] loaded HEAD from S10 (vec_in norm=1.650227)
[S5] cosine check vs S10: cos=0.4682
[S5] BUFFERED delta from S10 (total buffered=3)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:58310
[S17] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1800) from S17
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.601002)
[S9] loaded HEAD from S17 (vec_in norm=1.601002)
[S9] cosine check vs S17: cos=0.7534
[S9] BUFFERED delta from S17 (total buffered=1)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=9 metric=0.5993 head_norm=1.129500
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.281158e-01
[S11] stored merged vector for next round verification (round=9)
[S11] DEBUG after merge:  round=9 metric=0.6507 head_norm=1.110979 delta_norm=0.228116
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=9 metric=0.4175 head_norm=0.702781
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.790322e-01
[S5] stored merged vector for next round verification (round=9)
[S5] DEBUG after merge:  round=9 metric=0.4175 head_norm=0.664528 delta_norm=0.279032
[S5] aggregate: ACCEPT kept=['S15', 'S14', 'S10'] (k=3/3) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=9 metric=0.1404 head_norm=0.697877
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.090375e-01
[S14] stored merged vector for next round verification (round=9)
[S14] DEBUG after merge:  round=9 metric=0.1404 head_norm=0.704724 delta_norm=0.209037
[S14] aggregate: ACCEPT kept=['S9', 'S7'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=9 metric=0.7144 head_norm=1.073683
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.916205e-01
[S7] stored merged vector for next round verification (round=9)
[S7] DEBUG after merge:  round=9 metric=0.6542 head_norm=1.211571 delta_norm=0.291621
[S7] aggregate: ROLLBACK (f1_val pre=0.714 post=0.654 tol_abs=0.005 tol_rel=0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=9 metric=0.6141 head_norm=1.002527
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.534645e-01
[S6] stored merged vector for next round verification (round=9)
[S6] DEBUG after merge:  round=9 metric=0.7912 head_norm=0.699162 delta_norm=0.553465
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=9 metric=0.4379 head_norm=0.859737
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.541716e-01
[S9] stored merged vector for next round verification (round=9)
[S9] DEBUG after merge:  round=9 metric=0.4365 head_norm=1.159341 delta_norm=0.554172
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=9 metric=0.9469 head_norm=1.138793
[S4] _apply_head_vector_avg (torch): Δ‖w‖=6.003917e-01
[S4] stored merged vector for next round verification (round=9)
[S4] DEBUG after merge:  round=9 metric=0.9460 head_norm=0.889092 delta_norm=0.600392
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.688933 (no previous merge yet)
[S2] round=10 local utility u=0.000000 metrics={'f1_val': 0.6998771004384357, 'auprc': 0.6663564739466485, 'loss_val': 0.33519488994759017, 'psi': 0.6864688498417209}-{'f1_val': 0.7000345296847245, 'auprc': 0.6778283827709224, 'loss_val': 0.3267013038890541, 'psi': 0.6911520709192036}
[S3] START round=10 head_norm_before_train=1.508576 (no previous merge yet)
[S3] round=10 local utility u=0.574779 metrics={'f1_val': 0.7005813959920884, 'auprc': 0.9990676140805552, 'loss_val': 0.39729856155161053, 'psi': 0.819975883227475}-{'f1_val': 0.5384937499581307, 'auprc': 0.9960158322446455, 'loss_val': 0.5651744833302127, 'psi': 0.7215025828727366}
[S4] START round=10 head_norm_before_train=0.889092 cos_to_last_merge=1.0000 (last merge round=9)
[S4] round=10 local utility u=0.000000 metrics={'f1_val': 0.9495262996643339, 'auprc': 0.9655556050460978, 'loss_val': 0.3774115541838593, 'psi': 0.9559380218170395}-{'f1_val': 0.9469264314878232, 'auprc': 0.9668550903649836, 'loss_val': 0.3286752637984946, 'psi': 0.9548978950386874}
[S5] START round=10 head_norm_before_train=0.664528 cos_to_last_merge=1.0000 (last merge round=9)
[S5] round=10 local utility u=0.043696 metrics={'f1_val': 0.4175465518408786, 'auprc': 0.7801377438964028, 'loss_val': 0.9310870287870314, 'psi': 0.5625830286630883}-{'f1_val': 0.4174665005497404, 'auprc': 0.7746639053281235, 'loss_val': 1.0015780546037767, 'psi': 0.5603454624610936}
[S6] START round=10 head_norm_before_train=0.699162 cos_to_last_merge=1.0000 (last merge round=9)
[S6] round=10 local utility u=1.000000 metrics={'f1_val': 0.926604067930632, 'auprc': 0.9677005770876759, 'loss_val': 0.5111196207238297, 'psi': 0.9430426715934496}-{'f1_val': 0.6141403603446273, 'auprc': 0.8109021763778652, 'loss_val': 0.5618624524073119, 'psi': 0.6928450867579224}
[S7] START round=10 head_norm_before_train=1.211571 cos_to_last_merge=1.0000 (last merge round=9)
[S7] round=10 local utility u=0.000000 metrics={'f1_val': 0.4169130971024577, 'auprc': 0.7896356955313764, 'loss_val': 0.9121278355590398, 'psi': 0.5660021364740252}-{'f1_val': 0.7144306615089584, 'auprc': 0.7423968102297427, 'loss_val': 0.9860730952008163, 'psi': 0.7256171209972722}
[S8] START round=10 head_norm_before_train=1.397533 cos_to_last_merge=0.8946 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.895
[S8] round=10 local utility u=0.000000 metrics={'f1_val': 0.9841226745624889, 'auprc': 0.9992190989746981, 'loss_val': 0.1448437039929274, 'psi': 0.9901612443273726}-{'f1_val': 0.9956124759962259, 'auprc': 0.9992351886343518, 'loss_val': 0.14589548238577427, 'psi': 0.9970615610514764}
[S9] START round=10 head_norm_before_train=1.159341 cos_to_last_merge=1.0000 (last merge round=9)
[S9] round=10 local utility u=1.000000 metrics={'f1_val': 0.7016148490515617, 'auprc': 0.999199094557443, 'loss_val': 0.6710488688083783, 'psi': 0.8206485472539142}-{'f1_val': 0.4378582197325261, 'auprc': 0.8658721786717439, 'loss_val': 0.8643584961851074, 'psi': 0.6090638033082132}
[S10] START round=10 head_norm_before_train=1.650227 (no previous merge yet)
[S10] round=10 local utility u=0.008759 metrics={'f1_val': 0.9939447192382613, 'auprc': 0.9959511357311923, 'loss_val': 0.08988570181804079, 'psi': 0.9947472858354337}-{'f1_val': 0.9961684647169089, 'auprc': 0.9973364227094793, 'loss_val': 0.1249023484697709, 'psi': 0.9966356479139371}
[S11] START round=10 head_norm_before_train=1.110979 cos_to_last_merge=1.0000 (last merge round=9)
[S11] round=10 local utility u=0.567843 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9967293498249942, 'loss_val': 0.6756254781099936, 'psi': 0.8198529299089897}-{'f1_val': 0.5993417125669712, 'auprc': 0.84135911331215, 'loss_val': 0.7296394659053989, 'psi': 0.6961486728650428}
[S13] START round=10 head_norm_before_train=1.307202 cos_to_last_merge=0.9084 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.908
[S13] round=10 local utility u=0.014409 metrics={'f1_val': 0.6018550610431087, 'auprc': 0.6887635541182777, 'loss_val': 0.6859410584229342, 'psi': 0.6366184582731763}-{'f1_val': 0.6008222040297994, 'auprc': 0.685412243829934, 'loss_val': 0.6985087066959578, 'psi': 0.6346582199498533}
[S14] START round=10 head_norm_before_train=0.704724 cos_to_last_merge=1.0000 (last merge round=9)
[S14] round=10 local utility u=0.233170 metrics={'f1_val': 0.14742117352265607, 'auprc': 0.9793682604758267, 'loss_val': 1.092313472943358, 'psi': 0.48020000830392434}-{'f1_val': 0.14035785288270378, 'auprc': 0.8648724199739783, 'loss_val': 1.172786904963654, 'psi': 0.4301636797192136}
[S15] START round=10 head_norm_before_train=1.178822 cos_to_last_merge=0.8611 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.861
[S15] round=10 local utility u=0.406467 metrics={'f1_val': 0.7821112987297041, 'auprc': 0.9768951139330492, 'loss_val': 0.394686421194216, 'psi': 0.8600248248110421}-{'f1_val': 0.7070718939668525, 'auprc': 0.9157077787240828, 'loss_val': 0.5738210168149047, 'psi': 0.7905262478697447}
[S16] START round=10 head_norm_before_train=0.765009 cos_to_last_merge=0.9937 (last merge round=8)
[S16] round=10 local utility u=0.000000 metrics={'f1_val': 0.38563562202703117, 'auprc': 0.7632383338250871, 'loss_val': 0.8726746673743244, 'psi': 0.5366767067462536}-{'f1_val': 0.41642751344040885, 'auprc': 0.733062511709353, 'loss_val': 0.9657905613018705, 'psi': 0.5430815127479864}
[S17] START round=10 head_norm_before_train=1.601002 (no previous merge yet)
[S17] round=10 local utility u=0.131799 metrics={'f1_val': 0.5397073119651822, 'auprc': 0.7223921366224436, 'loss_val': 0.6913986773919669, 'psi': 0.6127812418280867}-{'f1_val': 0.4213953127871242, 'auprc': 0.8315422401417837, 'loss_val': 0.5725755309777336, 'psi': 0.5854540837289881}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:58310
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:58304
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S10] → sending delta(kind=head bytes=1806) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] → sending delta(kind=head bytes=1793) to S14@127.0.0.1:58314
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:58316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:58310
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:58305
[S11] sending update (kind=head size=1794 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1793 to 1 peers)
[S10] sending update (kind=head size=1806 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1806) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.678716)
[S5] loaded HEAD from S10 (vec_in norm=1.678716)
[S5] cosine check vs S10: cos=0.6030
[S5] BUFFERED delta from S10 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1795) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.702801)
[S16] loaded HEAD from S5 (vec_in norm=0.702801)
[S16] cosine check vs S5: cos=0.7130
[S16] BUFFERED delta from S5 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1801) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.772624)
[S4] loaded HEAD from S6 (vec_in norm=0.772624)
[S4] cosine check vs S6: cos=0.6444
[S4] BUFFERED delta from S6 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1793) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.195767)
[S14] loaded HEAD from S9 (vec_in norm=1.195767)
[S14] cosine check vs S9: cos=0.6514
[S14] BUFFERED delta from S9 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1796) from S13
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.331134)
[S9] loaded HEAD from S13 (vec_in norm=1.331134)
[S9] cosine check vs S13: cos=0.1305
[S9] BUFFERED delta from S13 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1794) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.141787)
[S9] loaded HEAD from S11 (vec_in norm=1.141787)
[S9] cosine check vs S11: cos=0.2537
[S9] BUFFERED delta from S11 (total buffered=2)
[S5] RECEIVED delta(kind=head bytes=1797) from S14
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.740024)
[S5] loaded HEAD from S14 (vec_in norm=0.740024)
[S5] cosine check vs S14: cos=0.2501
[S5] BUFFERED delta from S14 (total buffered=2)
[S5] RECEIVED delta(kind=head bytes=1796) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.249823)
[S5] loaded HEAD from S15 (vec_in norm=1.249823)
[S5] cosine check vs S15: cos=0.7199
[S5] BUFFERED delta from S15 (total buffered=3)
[S5] RECEIVED delta(kind=head bytes=1797) from S3
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.557134)
[S5] loaded HEAD from S3 (vec_in norm=1.557134)
[S5] cosine check vs S3: cos=0.3743
[S5] BUFFERED delta from S3 (total buffered=4)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:58310
[S17] sending update (kind=head size=1801 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1801) from S17
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.652260)
[S9] loaded HEAD from S17 (vec_in norm=1.652260)
[S9] cosine check vs S17: cos=0.9570
[S9] BUFFERED delta from S17 (total buffered=3)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=10 metric=0.9495 head_norm=0.989142
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.841725e-01
[S4] stored merged vector for next round verification (round=10)
[S4] DEBUG after merge:  round=10 metric=0.9507 head_norm=0.800054 delta_norm=0.384173
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.296 → S11@127.0.0.1:58312
[S2] ⇄ pheromone p=0.228 → S5@127.0.0.1:58305
[S7] ⇄ pheromone p=0.326 → S14@127.0.0.1:58314
[S8] ⇄ pheromone p=0.384 → S7@127.0.0.1:58308
[S5] aggregate: batch=4 kept=4 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=10 metric=0.4175 head_norm=0.702801
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.094407e-01
[S5] stored merged vector for next round verification (round=10)
[S5] DEBUG after merge:  round=10 metric=0.4175 head_norm=0.675080 delta_norm=0.109441
[S5] aggregate: ACCEPT kept=['S10', 'S14', 'S15', 'S3'] (k=4/4) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.211 → S16@127.0.0.1:58316
[S11] ⇄ pheromone p=0.441 → S9@127.0.0.1:58310
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=10 metric=0.1474 head_norm=0.740024
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.540607e-01
[S14] stored merged vector for next round verification (round=10)
[S14] DEBUG after merge:  round=10 metric=0.1539 head_norm=0.884634 delta_norm=0.454061
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.205 → S5@127.0.0.1:58305
[S13] ⇄ pheromone p=0.268 → S9@127.0.0.1:58310
[S3] ⇄ pheromone p=0.433 → S5@127.0.0.1:58305
[S10] ⇄ pheromone p=0.354 → S5@127.0.0.1:58305
[S6] ⇄ pheromone p=0.615 → S4@127.0.0.1:58304
[S9] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=10 metric=0.7016 head_norm=1.195767
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.955458e-01
[S9] stored merged vector for next round verification (round=10)
[S9] DEBUG after merge:  round=10 metric=0.7017 head_norm=0.938073 delta_norm=0.395546
[S9] aggregate: ACCEPT kept=['S13', 'S11', 'S17'] (k=3/3) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.474 → S14@127.0.0.1:58314
[S15] ⇄ pheromone p=0.457 → S5@127.0.0.1:58305
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=10 metric=0.3856 head_norm=0.812425
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.914648e-01
[S16] stored merged vector for next round verification (round=10)
[S16] DEBUG after merge:  round=10 metric=0.3855 head_norm=0.701448 delta_norm=0.291465
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.242 → S6@127.0.0.1:58307
[S17] ⇄ pheromone p=0.265 → S9@127.0.0.1:58310
[S2] START round=11 head_norm_before_train=1.719527 (no previous merge yet)
[S2] round=11 local utility u=0.000000 metrics={'f1_val': 0.6972753983129719, 'auprc': 0.6680172842748091, 'loss_val': 0.3677891208407386, 'psi': 0.6855721526977068}-{'f1_val': 0.6998771004384357, 'auprc': 0.6663564739466485, 'loss_val': 0.33519488994759017, 'psi': 0.6864688498417209}
[S3] START round=11 head_norm_before_train=1.557134 (no previous merge yet)
[S3] round=11 local utility u=0.039587 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9986655692078606, 'loss_val': 0.3175149658285116, 'psi': 0.8198748034823451}-{'f1_val': 0.7005813959920884, 'auprc': 0.9990676140805552, 'loss_val': 0.39729856155161053, 'psi': 0.819975883227475}
[S4] START round=11 head_norm_before_train=0.800054 cos_to_last_merge=1.0000 (last merge round=10)
[S4] round=11 local utility u=0.000000 metrics={'f1_val': 0.9447921190478381, 'auprc': 0.9696884275638942, 'loss_val': 0.42473656537330834, 'psi': 0.9547506424542606}-{'f1_val': 0.9495262996643339, 'auprc': 0.9655556050460978, 'loss_val': 0.3774115541838593, 'psi': 0.9559380218170395}
[S5] START round=11 head_norm_before_train=0.675080 cos_to_last_merge=1.0000 (last merge round=10)
[S5] round=11 local utility u=0.085980 metrics={'f1_val': 0.428716452971043, 'auprc': 0.791411263508275, 'loss_val': 0.8599675008144517, 'psi': 0.5737943771859357}-{'f1_val': 0.4175465518408786, 'auprc': 0.7801377438964028, 'loss_val': 0.9310870287870314, 'psi': 0.5625830286630883}
[S6] START round=11 head_norm_before_train=0.772624 cos_to_last_merge=0.9913 (last merge round=9)
[S6] round=11 local utility u=0.000000 metrics={'f1_val': 0.8224379007245134, 'auprc': 0.9584066857261854, 'loss_val': 0.46640268550969505, 'psi': 0.8768254147251822}-{'f1_val': 0.926604067930632, 'auprc': 0.9677005770876759, 'loss_val': 0.5111196207238297, 'psi': 0.9430426715934496}
[S7] START round=11 head_norm_before_train=1.232294 cos_to_last_merge=0.9975 (last merge round=9)
[S7] round=11 local utility u=0.022883 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.782598121559263, 'loss_val': 0.8440311924149707, 'psi': 0.5630653194903192}-{'f1_val': 0.4169130971024577, 'auprc': 0.7896356955313764, 'loss_val': 0.9121278355590398, 'psi': 0.5660021364740252}
[S8] START round=11 head_norm_before_train=1.447318 cos_to_last_merge=0.8828 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.883
[S8] round=11 local utility u=0.052187 metrics={'f1_val': 0.994792642153961, 'auprc': 0.9983007447171143, 'loss_val': 0.10173518499080546, 'psi': 0.9961958831792224}-{'f1_val': 0.9841226745624889, 'auprc': 0.9992190989746981, 'loss_val': 0.1448437039929274, 'psi': 0.9901612443273726}
[S9] START round=11 head_norm_before_train=0.938073 cos_to_last_merge=1.0000 (last merge round=10)
[S9] round=11 local utility u=0.041080 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.9985734221236635, 'loss_val': 0.5855104454643881, 'psi': 0.8202481694809709}-{'f1_val': 0.7016148490515617, 'auprc': 0.999199094557443, 'loss_val': 0.6710488688083783, 'psi': 0.8206485472539142}
[S10] START round=11 head_norm_before_train=1.678716 (no previous merge yet)
[S10] round=11 local utility u=0.015722 metrics={'f1_val': 0.9957455607450773, 'auprc': 0.9971362182592682, 'loss_val': 0.07280193602890021, 'psi': 0.9963018237507536}-{'f1_val': 0.9939447192382613, 'auprc': 0.9959511357311923, 'loss_val': 0.08988570181804079, 'psi': 0.9947472858354337}
[S11] START round=11 head_norm_before_train=1.141787 cos_to_last_merge=0.9963 (last merge round=9)
[S11] round=11 local utility u=0.081635 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9954742788449649, 'loss_val': 0.507139041318533, 'psi': 0.8192057992901409}-{'f1_val': 0.7019353166316534, 'auprc': 0.9967293498249942, 'loss_val': 0.6756254781099936, 'psi': 0.8198529299089897}
[S13] START round=11 head_norm_before_train=1.331134 cos_to_last_merge=0.9023 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.902
[S13] round=11 local utility u=0.134854 metrics={'f1_val': 0.6300171800580379, 'auprc': 0.6662555579150133, 'loss_val': 0.5176822032184059, 'psi': 0.6445125312008281}-{'f1_val': 0.6018550610431087, 'auprc': 0.6887635541182777, 'loss_val': 0.6859410584229342, 'psi': 0.6366184582731763}
[S14] START round=11 head_norm_before_train=0.884634 cos_to_last_merge=1.0000 (last merge round=10)
[S14] round=11 local utility u=1.000000 metrics={'f1_val': 0.5195560932266448, 'auprc': 0.9913462430121566, 'loss_val': 0.9474597488840826, 'psi': 0.7082721531408496}-{'f1_val': 0.14742117352265607, 'auprc': 0.9793682604758267, 'loss_val': 1.092313472943358, 'psi': 0.48020000830392434}
[S15] START round=11 head_norm_before_train=1.249823 cos_to_last_merge=0.8505 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.850
[S15] round=11 local utility u=0.518298 metrics={'f1_val': 0.9245916686459228, 'auprc': 0.9985786758233486, 'loss_val': 0.2780226308818796, 'psi': 0.9541864715168931}-{'f1_val': 0.7821112987297041, 'auprc': 0.9768951139330492, 'loss_val': 0.394686421194216, 'psi': 0.8600248248110421}
[S16] START round=11 head_norm_before_train=0.701448 cos_to_last_merge=1.0000 (last merge round=10)
[S16] round=11 local utility u=0.014359 metrics={'f1_val': 0.4023451638609613, 'auprc': 0.7437452681524384, 'loss_val': 0.8857343899667927, 'psi': 0.5389052055775522}-{'f1_val': 0.38563562202703117, 'auprc': 0.7632383338250871, 'loss_val': 0.8726746673743244, 'psi': 0.5366767067462536}
[S17] START round=11 head_norm_before_train=1.652260 (no previous merge yet)
[S17] round=11 local utility u=0.146999 metrics={'f1_val': 0.5930787597140643, 'auprc': 0.7753713227700949, 'loss_val': 0.876566019020793, 'psi': 0.6659957849364766}-{'f1_val': 0.5397073119651822, 'auprc': 0.7223921366224436, 'loss_val': 0.6913986773919669, 'psi': 0.6127812418280867}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:58310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:58305
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:58316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] → sending delta(kind=head bytes=1806) to S7@127.0.0.1:58308
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] → sending delta(kind=head bytes=1806) to S14@127.0.0.1:58314
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S3] → sending delta(kind=head bytes=1806) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:58310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:58314
[S13] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1806 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1806 to 1 peers)
[S5] sending update (kind=head size=1805 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1805) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.717579)
[S16] loaded HEAD from S5 (vec_in norm=0.717579)
[S16] cosine check vs S5: cos=0.9020
[S16] BUFFERED delta from S5 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1803) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.989325)
[S14] loaded HEAD from S9 (vec_in norm=0.989325)
[S14] cosine check vs S9: cos=0.9452
[S14] BUFFERED delta from S9 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1806) from S8
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.483552)
[S7] loaded HEAD from S8 (vec_in norm=1.483552)
[S7] cosine check vs S8: cos=0.9557
[S7] BUFFERED delta from S8 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1801) from S13
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.353686)
[S9] loaded HEAD from S13 (vec_in norm=1.353686)
[S9] cosine check vs S13: cos=0.3307
[S9] BUFFERED delta from S13 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1794) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.185797)
[S9] loaded HEAD from S11 (vec_in norm=1.185797)
[S9] cosine check vs S11: cos=0.4087
[S9] BUFFERED delta from S11 (total buffered=2)
[S5] RECEIVED delta(kind=head bytes=1806) from S3
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.599968)
[S5] loaded HEAD from S3 (vec_in norm=1.599968)
[S5] cosine check vs S3: cos=0.4374
[S5] BUFFERED delta from S3 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1798) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.325119)
[S5] loaded HEAD from S15 (vec_in norm=1.325119)
[S5] cosine check vs S15: cos=0.6854
[S5] BUFFERED delta from S15 (total buffered=2)
[S5] RECEIVED delta(kind=head bytes=1799) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.705696)
[S5] loaded HEAD from S10 (vec_in norm=1.705696)
[S5] cosine check vs S10: cos=0.5849
[S5] BUFFERED delta from S10 (total buffered=3)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:58307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:58310
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] sending update (kind=head size=1795 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1795) from S17
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.710697)
[S9] loaded HEAD from S17 (vec_in norm=1.710697)
[S9] cosine check vs S17: cos=0.8543
[S9] BUFFERED delta from S17 (total buffered=3)
[S6] RECEIVED delta(kind=head bytes=1801) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.753880)
[S6] loaded HEAD from S16 (vec_in norm=0.753880)
[S6] cosine check vs S16: cos=0.6320
[S6] BUFFERED delta from S16 (total buffered=1)
[S7] sending update (kind=head size=1806 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1806) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.258865)
[S14] loaded HEAD from S7 (vec_in norm=1.258865)
[S14] cosine check vs S7: cos=0.4344
[S14] BUFFERED delta from S7 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:58305
[S5] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=11 metric=0.4287 head_norm=0.717579
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.354300e-01
[S5] stored merged vector for next round verification (round=11)
[S5] DEBUG after merge:  round=11 metric=0.6213 head_norm=0.829900 delta_norm=0.235430
[S5] aggregate: ACCEPT kept=['S3', 'S15', 'S10'] (k=3/3) mode=median trim_p=0.1
[S14] sending update (kind=head size=1796 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1796) from S14
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.919046)
[S5] loaded HEAD from S14 (vec_in norm=0.919046)
[S5] cosine check vs S14: cos=0.0539
[S5] BUFFERED delta from S14 (total buffered=1)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=11 metric=0.8224 head_norm=0.869151
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.519802e-01
[S6] stored merged vector for next round verification (round=11)
[S6] DEBUG after merge:  round=11 metric=0.8232 head_norm=0.733478 delta_norm=0.351980
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=11 metric=0.7014 head_norm=0.989325
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.221260e-01
[S9] stored merged vector for next round verification (round=11)
[S9] DEBUG after merge:  round=11 metric=0.7014 head_norm=0.883092 delta_norm=0.222126
[S9] aggregate: ACCEPT kept=['S13', 'S11', 'S17'] (k=3/3) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=11 metric=0.5196 head_norm=0.919046
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.856346e-01
[S14] stored merged vector for next round verification (round=11)
[S14] DEBUG after merge:  round=11 metric=0.5205 head_norm=0.873263 delta_norm=0.285635
[S14] aggregate: ACCEPT kept=['S9', 'S7'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=11 metric=0.4167 head_norm=1.258865
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.323869e-01
[S7] stored merged vector for next round verification (round=11)
[S7] DEBUG after merge:  round=11 metric=0.4167 head_norm=1.356035 delta_norm=0.232387
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=11 metric=0.4023 head_norm=0.753880
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.638009e-01
[S16] stored merged vector for next round verification (round=11)
[S16] DEBUG after merge:  round=11 metric=0.3948 head_norm=0.717493 delta_norm=0.163801
[S16] aggregate: ROLLBACK (f1_val pre=0.402 post=0.395 tol_abs=0.005 tol_rel=0.0)
[S2] START round=12 head_norm_before_train=1.743847 (no previous merge yet)
[S2] round=12 local utility u=0.000000 metrics={'f1_val': 0.661230656794543, 'auprc': 0.7783835534249558, 'loss_val': 1.0296995956477935, 'psi': 0.7080918154467082}-{'f1_val': 0.6972753983129719, 'auprc': 0.6680172842748091, 'loss_val': 0.3677891208407386, 'psi': 0.6855721526977068}
[S3] START round=12 head_norm_before_train=1.599968 (no previous merge yet)
[S3] round=12 local utility u=0.030714 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9984572908727879, 'loss_val': 0.25546217129848114, 'psi': 0.819791492148316}-{'f1_val': 0.7006809596653347, 'auprc': 0.9986655692078606, 'loss_val': 0.3175149658285116, 'psi': 0.8198748034823451}
[S4] START round=12 head_norm_before_train=0.910686 cos_to_last_merge=0.9773 (last merge round=10)
[S4] round=12 local utility u=0.032880 metrics={'f1_val': 0.9464347272937714, 'auprc': 0.9627405507612212, 'loss_val': 0.34798830105794154, 'psi': 0.9529570566807514}-{'f1_val': 0.9447921190478381, 'auprc': 0.9696884275638942, 'loss_val': 0.42473656537330834, 'psi': 0.9547506424542606}
[S5] START round=12 head_norm_before_train=0.829900 cos_to_last_merge=1.0000 (last merge round=11)
[S5] round=12 local utility u=0.000000 metrics={'f1_val': 0.42600182019581356, 'auprc': 0.6711942437103791, 'loss_val': 0.8194974437784153, 'psi': 0.5240787896016397}-{'f1_val': 0.428716452971043, 'auprc': 0.791411263508275, 'loss_val': 0.8599675008144517, 'psi': 0.5737943771859357}
[S6] START round=12 head_norm_before_train=0.733478 cos_to_last_merge=1.0000 (last merge round=11)
[S6] round=12 local utility u=0.366024 metrics={'f1_val': 0.938014299048549, 'auprc': 0.9702823677270762, 'loss_val': 0.4634408964118072, 'psi': 0.95092152651996}-{'f1_val': 0.8224379007245134, 'auprc': 0.9584066857261854, 'loss_val': 0.46640268550969505, 'psi': 0.8768254147251822}
[S7] START round=12 head_norm_before_train=1.356035 cos_to_last_merge=1.0000 (last merge round=11)
[S7] round=12 local utility u=0.206035 metrics={'f1_val': 0.48034182271407894, 'auprc': 0.7801356281515581, 'loss_val': 0.8063631615893037, 'psi': 0.6002593448890706}-{'f1_val': 0.41671011811102343, 'auprc': 0.782598121559263, 'loss_val': 0.8440311924149707, 'psi': 0.5630653194903192}
[S8] START round=12 head_norm_before_train=1.483552 cos_to_last_merge=0.8760 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.876
[S8] round=12 local utility u=0.013061 metrics={'f1_val': 0.993919739519144, 'auprc': 0.9992420840032121, 'loss_val': 0.07319927477891021, 'psi': 0.9960486773127712}-{'f1_val': 0.994792642153961, 'auprc': 0.9983007447171143, 'loss_val': 0.10173518499080546, 'psi': 0.9961958831792224}
[S9] START round=12 head_norm_before_train=0.883092 cos_to_last_merge=1.0000 (last merge round=11)
[S9] round=12 local utility u=0.041509 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9986050713650056, 'loss_val': 0.5021429708157988, 'psi': 0.8202163186705403}-{'f1_val': 0.7013646677191758, 'auprc': 0.9985734221236635, 'loss_val': 0.5855104454643881, 'psi': 0.8202481694809709}
[S10] START round=12 head_norm_before_train=1.705696 (no previous merge yet)
[S10] round=12 local utility u=0.007851 metrics={'f1_val': 0.9957455607450773, 'auprc': 0.9964464522963504, 'loss_val': 0.055030227248534486, 'psi': 0.9960259173655865}-{'f1_val': 0.9957455607450773, 'auprc': 0.9971362182592682, 'loss_val': 0.07280193602890021, 'psi': 0.9963018237507536}
[S11] START round=12 head_norm_before_train=1.185797 cos_to_last_merge=0.9869 (last merge round=9)
[S11] round=12 local utility u=0.000000 metrics={'f1_val': 0.6128184547379666, 'auprc': 0.9875492831897289, 'loss_val': 0.5401674941842597, 'psi': 0.7627107861186715}-{'f1_val': 0.7016934795869249, 'auprc': 0.9954742788449649, 'loss_val': 0.507139041318533, 'psi': 0.8192057992901409}
[S13] START round=12 head_norm_before_train=1.353686 cos_to_last_merge=0.8989 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.899
[S13] round=12 local utility u=0.000000 metrics={'f1_val': 0.6141026656882117, 'auprc': 0.6837846649441754, 'loss_val': 0.6515520478685902, 'psi': 0.6419754653905971}-{'f1_val': 0.6300171800580379, 'auprc': 0.6662555579150133, 'loss_val': 0.5176822032184059, 'psi': 0.6445125312008281}
[S14] START round=12 head_norm_before_train=0.873263 cos_to_last_merge=1.0000 (last merge round=11)
[S14] round=12 local utility u=0.641265 metrics={'f1_val': 0.7013350841591286, 'auprc': 0.9963999702357677, 'loss_val': 0.7707641135521731, 'psi': 0.8193610385897843}-{'f1_val': 0.5195560932266448, 'auprc': 0.9913462430121566, 'loss_val': 0.9474597488840826, 'psi': 0.7082721531408496}
[S15] START round=12 head_norm_before_train=1.325119 cos_to_last_merge=0.8424 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.842
[S15] round=12 local utility u=0.247051 metrics={'f1_val': 0.9892442802361823, 'auprc': 0.9984134760821693, 'loss_val': 0.17134107878752375, 'psi': 0.9929119585745771}-{'f1_val': 0.9245916686459228, 'auprc': 0.9985786758233486, 'loss_val': 0.2780226308818796, 'psi': 0.9541864715168931}
[S16] START round=12 head_norm_before_train=0.717493 cos_to_last_merge=1.0000 (last merge round=11)
[S16] round=12 local utility u=0.415201 metrics={'f1_val': 0.5234350898905762, 'auprc': 0.7697108294291385, 'loss_val': 0.8597677984434099, 'psi': 0.6219453857060011}-{'f1_val': 0.4023451638609613, 'auprc': 0.7437452681524384, 'loss_val': 0.8857343899667927, 'psi': 0.5389052055775522}
[S17] START round=12 head_norm_before_train=1.710697 (no previous merge yet)
[S17] round=12 local utility u=0.371907 metrics={'f1_val': 0.6091901055328626, 'auprc': 0.9244312249553768, 'loss_val': 0.6765993637402443, 'psi': 0.7352865533018682}-{'f1_val': 0.5930787597140643, 'auprc': 0.7753713227700949, 'loss_val': 0.876566019020793, 'psi': 0.6659957849364766}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:58312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:58305
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:58304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:58308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:58314
[S6] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1798) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.825833)
[S4] loaded HEAD from S6 (vec_in norm=0.825833)
[S4] cosine check vs S6: cos=0.6521
[S4] BUFFERED delta from S6 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1801) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.944240)
[S14] loaded HEAD from S9 (vec_in norm=0.944240)
[S14] cosine check vs S9: cos=0.8875
[S14] BUFFERED delta from S9 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1794) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.024931)
[S11] loaded HEAD from S4 (vec_in norm=1.024931)
[S11] cosine check vs S4: cos=0.7072
[S11] BUFFERED delta from S4 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1802) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.747198)
[S5] loaded HEAD from S10 (vec_in norm=1.747198)
[S5] cosine check vs S10: cos=0.6522
[S5] BUFFERED delta from S10 (total buffered=2)
[S7] RECEIVED delta(kind=head bytes=1799) from S8
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.529124)
[S7] loaded HEAD from S8 (vec_in norm=1.529124)
[S7] cosine check vs S8: cos=0.9809
[S7] BUFFERED delta from S8 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1802) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.377987)
[S14] loaded HEAD from S7 (vec_in norm=1.377987)
[S14] cosine check vs S7: cos=0.6637
[S14] BUFFERED delta from S7 (total buffered=2)
[S5] RECEIVED delta(kind=head bytes=1801) from S3
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.637060)
[S5] loaded HEAD from S3 (vec_in norm=1.637060)
[S5] cosine check vs S3: cos=0.4543
[S5] BUFFERED delta from S3 (total buffered=3)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:58307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:58310
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1799) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.771404)
[S6] loaded HEAD from S16 (vec_in norm=0.771404)
[S6] cosine check vs S16: cos=0.7983
[S6] BUFFERED delta from S16 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1796) from S14
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.916497)
[S5] loaded HEAD from S14 (vec_in norm=0.916497)
[S5] cosine check vs S14: cos=0.0969
[S5] BUFFERED delta from S14 (total buffered=4)
[S15] sending update (kind=head size=1803 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1803) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.389630)
[S5] loaded HEAD from S15 (vec_in norm=1.389630)
[S5] cosine check vs S15: cos=0.7277
[S5] BUFFERED delta from S15 (total buffered=5)
[S17] sending update (kind=head size=1798 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1798) from S17
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.763535)
[S9] loaded HEAD from S17 (vec_in norm=1.763535)
[S9] cosine check vs S17: cos=0.7513
[S9] BUFFERED delta from S17 (total buffered=1)
[S5] aggregate: batch=5 kept=5 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=12 metric=0.4260 head_norm=0.865031
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.971446e-01
[S5] stored merged vector for next round verification (round=12)
[S5] DEBUG after merge:  round=12 metric=0.4317 head_norm=0.671930 delta_norm=0.397145
[S5] aggregate: ACCEPT kept=['S14', 'S10', 'S3', 'S14', 'S15'] (k=5/5) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=12 metric=0.7013 head_norm=0.944240
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.122513e-01
[S9] stored merged vector for next round verification (round=12)
[S9] DEBUG after merge:  round=12 metric=0.7013 head_norm=1.275136 delta_norm=0.612251
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=12 metric=0.4803 head_norm=1.377987
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.607630e-01
[S7] stored merged vector for next round verification (round=12)
[S7] DEBUG after merge:  round=12 metric=0.4167 head_norm=1.446613 delta_norm=0.160763
[S7] aggregate: ROLLBACK (f1_val pre=0.480 post=0.417 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=12 metric=0.9464 head_norm=1.024931
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.964239e-01
[S4] stored merged vector for next round verification (round=12)
[S4] DEBUG after merge:  round=12 metric=0.9470 head_norm=0.842075 delta_norm=0.396424
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=12 metric=0.9380 head_norm=0.825833
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.549399e-01
[S6] stored merged vector for next round verification (round=12)
[S6] DEBUG after merge:  round=12 metric=0.9265 head_norm=0.757323 delta_norm=0.254940
[S6] aggregate: ROLLBACK (f1_val pre=0.938 post=0.926 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=12 metric=0.6128 head_norm=1.231973
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.422449e-01
[S11] stored merged vector for next round verification (round=12)
[S11] DEBUG after merge:  round=12 metric=0.6060 head_norm=1.043331 delta_norm=0.442245
[S11] aggregate: ROLLBACK (f1_val pre=0.613 post=0.606 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=12 metric=0.7013 head_norm=0.916497
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.229077e-01
[S14] stored merged vector for next round verification (round=12)
[S14] DEBUG after merge:  round=12 metric=0.6837 head_norm=0.923490 delta_norm=0.222908
[S14] aggregate: ROLLBACK (f1_val pre=0.701 post=0.684 tol_abs=0.005 tol_rel=0.0)
[S2] START round=13 head_norm_before_train=1.761912 (no previous merge yet)
[S2] round=13 local utility u=0.347446 metrics={'f1_val': 0.6994319643639791, 'auprc': 0.7268963802317563, 'loss_val': 0.40955297156924053, 'psi': 0.7104177307110899}-{'f1_val': 0.661230656794543, 'auprc': 0.7783835534249558, 'loss_val': 1.0296995956477935, 'psi': 0.7080918154467082}
[S3] START round=13 head_norm_before_train=1.637060 (no previous merge yet)
[S3] round=13 local utility u=0.017045 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9984630248676997, 'loss_val': 0.22139008005068964, 'psi': 0.8197937857462807}-{'f1_val': 0.7006809596653347, 'auprc': 0.9984572908727879, 'loss_val': 0.25546217129848114, 'psi': 0.819791492148316}
[S4] START round=13 head_norm_before_train=0.842075 cos_to_last_merge=1.0000 (last merge round=12)
[S4] round=13 local utility u=0.000000 metrics={'f1_val': 0.9485207413926698, 'auprc': 0.9660885437948868, 'loss_val': 0.3973892607034232, 'psi': 0.9555478623535566}-{'f1_val': 0.9464347272937714, 'auprc': 0.9627405507612212, 'loss_val': 0.34798830105794154, 'psi': 0.9529570566807514}
[S5] START round=13 head_norm_before_train=0.671930 cos_to_last_merge=1.0000 (last merge round=12)
[S5] round=13 local utility u=0.000000 metrics={'f1_val': 0.41754551926731287, 'auprc': 0.6654621977024054, 'loss_val': 0.8660427875606862, 'psi': 0.5167121906413499}-{'f1_val': 0.42600182019581356, 'auprc': 0.6711942437103791, 'loss_val': 0.8194974437784153, 'psi': 0.5240787896016397}
[S6] START round=13 head_norm_before_train=0.757323 cos_to_last_merge=1.0000 (last merge round=12)
[S6] round=13 local utility u=0.000000 metrics={'f1_val': 0.5963687292724111, 'auprc': 0.7836229072736123, 'loss_val': 0.7707772794338172, 'psi': 0.6712704004728915}-{'f1_val': 0.938014299048549, 'auprc': 0.9702823677270762, 'loss_val': 0.4634408964118072, 'psi': 0.95092152651996}
[S7] START round=13 head_norm_before_train=1.446613 cos_to_last_merge=1.0000 (last merge round=12)
[S7] round=13 local utility u=0.717597 metrics={'f1_val': 0.7139363254397838, 'auprc': 0.7821781782519598, 'loss_val': 0.7788632673880813, 'psi': 0.7412330665646543}-{'f1_val': 0.48034182271407894, 'auprc': 0.7801356281515581, 'loss_val': 0.8063631615893037, 'psi': 0.6002593448890706}
[S8] START round=13 head_norm_before_train=1.529124 cos_to_last_merge=0.8681 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.868
[S8] round=13 local utility u=0.000000 metrics={'f1_val': 0.9915895183459548, 'auprc': 0.9992869654543297, 'loss_val': 0.06157828071033343, 'psi': 0.9946684971893047}-{'f1_val': 0.993919739519144, 'auprc': 0.9992420840032121, 'loss_val': 0.07319927477891021, 'psi': 0.9960486773127712}
[S9] START round=13 head_norm_before_train=1.275136 cos_to_last_merge=1.0000 (last merge round=12)
[S9] round=13 local utility u=0.062025 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9982385397985796, 'loss_val': 0.3769929851573954, 'psi': 0.8200697060439699}-{'f1_val': 0.7012904835408967, 'auprc': 0.9986050713650056, 'loss_val': 0.5021429708157988, 'psi': 0.8202163186705403}
[S10] START round=13 head_norm_before_train=1.747198 (no previous merge yet)
[S10] round=13 local utility u=0.005855 metrics={'f1_val': 0.9959407510105199, 'auprc': 0.9964587205596733, 'loss_val': 0.04452790283093132, 'psi': 0.9961479388301813}-{'f1_val': 0.9957455607450773, 'auprc': 0.9964464522963504, 'loss_val': 0.055030227248534486, 'psi': 0.9960259173655865}
[S11] START round=13 head_norm_before_train=1.043331 cos_to_last_merge=1.0000 (last merge round=12)
[S11] round=13 local utility u=0.288928 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9948968592938319, 'loss_val': 0.5176043092561775, 'psi': 0.8189748314696876}-{'f1_val': 0.6128184547379666, 'auprc': 0.9875492831897289, 'loss_val': 0.5401674941842597, 'psi': 0.7627107861186715}
[S13] START round=13 head_norm_before_train=1.376690 cos_to_last_merge=0.8960 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.896
[S13] round=13 local utility u=0.000000 metrics={'f1_val': 0.5946539834609238, 'auprc': 0.6870583687989895, 'loss_val': 0.7943428165301223, 'psi': 0.6316157375961501}-{'f1_val': 0.6141026656882117, 'auprc': 0.6837846649441754, 'loss_val': 0.6515520478685902, 'psi': 0.6419754653905971}
[S14] START round=13 head_norm_before_train=0.923490 cos_to_last_merge=1.0000 (last merge round=12)
[S14] round=13 local utility u=0.051786 metrics={'f1_val': 0.7011648480749666, 'auprc': 0.9935758730570721, 'loss_val': 0.6576988446666582, 'psi': 0.8181292580678088}-{'f1_val': 0.7013350841591286, 'auprc': 0.9963999702357677, 'loss_val': 0.7707641135521731, 'psi': 0.8193610385897843}
[S15] START round=13 head_norm_before_train=1.389630 cos_to_last_merge=0.8355 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.835
[S15] round=13 local utility u=0.000000 metrics={'f1_val': 0.9001818091781164, 'auprc': 0.994073616722635, 'loss_val': 0.19866858049621702, 'psi': 0.9377385321959238}-{'f1_val': 0.9892442802361823, 'auprc': 0.9984134760821693, 'loss_val': 0.17134107878752375, 'psi': 0.9929119585745771}
[S16] START round=13 head_norm_before_train=0.771404 cos_to_last_merge=0.9943 (last merge round=11)
[S16] round=13 local utility u=0.000000 metrics={'f1_val': 0.4237772487357285, 'auprc': 0.7852851472312954, 'loss_val': 0.8063232073883306, 'psi': 0.5683804081339553}-{'f1_val': 0.5234350898905762, 'auprc': 0.7697108294291385, 'loss_val': 0.8597677984434099, 'psi': 0.6219453857060011}
[S17] START round=13 head_norm_before_train=1.763535 (no previous merge yet)
[S17] round=13 local utility u=0.000000 metrics={'f1_val': 0.594107780314522, 'auprc': 0.8125194856091753, 'loss_val': 0.8876728649201583, 'psi': 0.6814724624323834}-{'f1_val': 0.6091901055328626, 'auprc': 0.9244312249553768, 'loss_val': 0.6765993637402443, 'psi': 0.7352865533018682}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S2] → sending delta(kind=head bytes=1806) to S5@127.0.0.1:58305
[S2] sending update (kind=head size=1806 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1806) from S2
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.776888)
[S5] loaded HEAD from S2 (vec_in norm=1.776888)
[S5] cosine check vs S2: cos=-0.0432
[S5] DROPPED delta from S2 (cos=-0.0432 < 0.0)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:58310
[S11] sending update (kind=head size=1797 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1797) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.074271)
[S9] loaded HEAD from S11 (vec_in norm=1.074271)
[S9] cosine check vs S11: cos=0.2611
[S9] BUFFERED delta from S11 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:58305
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:58305
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1804 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1804) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.467199)
[S14] loaded HEAD from S7 (vec_in norm=1.467199)
[S14] cosine check vs S7: cos=0.7870
[S14] BUFFERED delta from S7 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1802) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.785875)
[S5] loaded HEAD from S10 (vec_in norm=1.785875)
[S5] cosine check vs S10: cos=0.5031
[S5] BUFFERED delta from S10 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1798) from S14
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.968693)
[S5] loaded HEAD from S14 (vec_in norm=0.968693)
[S5] cosine check vs S14: cos=0.4971
[S5] BUFFERED delta from S14 (total buffered=2)
[S3] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1800) from S3
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.669933)
[S5] loaded HEAD from S3 (vec_in norm=1.669933)
[S5] cosine check vs S3: cos=0.4124
[S5] BUFFERED delta from S3 (total buffered=3)
[S14] RECEIVED delta(kind=head bytes=1802) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.326344)
[S14] loaded HEAD from S9 (vec_in norm=1.326344)
[S14] cosine check vs S9: cos=0.7192
[S14] BUFFERED delta from S9 (total buffered=2)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=13 metric=0.7012 head_norm=0.968693
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.438002e-01
[S14] stored merged vector for next round verification (round=13)
[S14] DEBUG after merge:  round=13 metric=0.7009 head_norm=1.020750 delta_norm=0.143800
[S14] aggregate: ACCEPT kept=['S7', 'S9'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=13 metric=0.7013 head_norm=1.326344
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.363984e-01
[S9] stored merged vector for next round verification (round=13)
[S9] DEBUG after merge:  round=13 metric=0.7013 head_norm=0.956211 delta_norm=0.736398
[S9] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=13 metric=0.4175 head_norm=0.719606
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.167892e-01
[S5] stored merged vector for next round verification (round=13)
[S5] DEBUG after merge:  round=13 metric=0.4181 head_norm=0.719105 delta_norm=0.216789
[S5] aggregate: ACCEPT kept=['S10', 'S14', 'S3'] (k=3/3) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.776888 (no previous merge yet)
[S2] round=14 local utility u=0.000000 metrics={'f1_val': 0.6946421530501954, 'auprc': 0.7029582438974025, 'loss_val': 0.4279538562735974, 'psi': 0.6979685893890781}-{'f1_val': 0.6994319643639791, 'auprc': 0.7268963802317563, 'loss_val': 0.40955297156924053, 'psi': 0.7104177307110899}
[S3] START round=14 head_norm_before_train=1.669933 (no previous merge yet)
[S3] round=14 local utility u=0.011484 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.998468539887304, 'loss_val': 0.19798818335735865, 'psi': 0.819751017455045}-{'f1_val': 0.7006809596653347, 'auprc': 0.9984630248676997, 'loss_val': 0.22139008005068964, 'psi': 0.8197937857462807}
[S4] START round=14 head_norm_before_train=0.935442 cos_to_last_merge=0.9893 (last merge round=12)
[S4] round=14 local utility u=0.039663 metrics={'f1_val': 0.9529062309854555, 'auprc': 0.9591971290679552, 'loss_val': 0.32370111657703377, 'psi': 0.9554225902184553}-{'f1_val': 0.9485207413926698, 'auprc': 0.9660885437948868, 'loss_val': 0.3973892607034232, 'psi': 0.9555478623535566}
[S5] START round=14 head_norm_before_train=0.719105 cos_to_last_merge=1.0000 (last merge round=13)
[S5] round=14 local utility u=0.996181 metrics={'f1_val': 0.6771072475446241, 'auprc': 0.7592477080637502, 'loss_val': 0.712407380609158, 'psi': 0.7099634317522745}-{'f1_val': 0.41754551926731287, 'auprc': 0.6654621977024054, 'loss_val': 0.8660427875606862, 'psi': 0.5167121906413499}
[S6] START round=14 head_norm_before_train=0.834185 cos_to_last_merge=0.9847 (last merge round=12)
[S6] round=14 local utility u=0.056877 metrics={'f1_val': 0.5783801440041559, 'auprc': 0.8060179633800627, 'loss_val': 0.6162764896454412, 'psi': 0.6694352717545187}-{'f1_val': 0.5963687292724111, 'auprc': 0.7836229072736123, 'loss_val': 0.7707772794338172, 'psi': 0.6712704004728915}
[S7] START round=14 head_norm_before_train=1.467199 cos_to_last_merge=0.9989 (last merge round=12)
[S7] round=14 local utility u=0.000000 metrics={'f1_val': 0.5946015882331954, 'auprc': 0.7807310907396051, 'loss_val': 0.7769902735895441, 'psi': 0.6690533892357593}-{'f1_val': 0.7139363254397838, 'auprc': 0.7821781782519598, 'loss_val': 0.7788632673880813, 'psi': 0.7412330665646543}
[S8] START round=14 head_norm_before_train=1.575511 cos_to_last_merge=0.8615 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.862
[S8] round=14 local utility u=0.003156 metrics={'f1_val': 0.9914482382097267, 'auprc': 0.9990928607805564, 'loss_val': 0.05383554732990164, 'psi': 0.9945060872380587}-{'f1_val': 0.9915895183459548, 'auprc': 0.9992869654543297, 'loss_val': 0.06157828071033343, 'psi': 0.9946684971893047}
[S9] START round=14 head_norm_before_train=0.956211 cos_to_last_merge=1.0000 (last merge round=13)
[S9] round=14 local utility u=0.000000 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9989939880025867, 'loss_val': 0.4321596796086318, 'psi': 0.8203718853255727}-{'f1_val': 0.7012904835408967, 'auprc': 0.9982385397985796, 'loss_val': 0.3769929851573954, 'psi': 0.8200697060439699}
[S10] START round=14 head_norm_before_train=1.785875 (no previous merge yet)
[S10] round=14 local utility u=0.001760 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9964933215156863, 'loss_val': 0.03912564428375256, 'psi': 0.9959631207152864}-{'f1_val': 0.9959407510105199, 'auprc': 0.9964587205596733, 'loss_val': 0.04452790283093132, 'psi': 0.9961479388301813}
[S11] START round=14 head_norm_before_train=1.074271 cos_to_last_merge=0.9984 (last merge round=12)
[S11] round=14 local utility u=0.019469 metrics={'f1_val': 0.6985737623829675, 'auprc': 0.9964493768960297, 'loss_val': 0.46460577792129865, 'psi': 0.8177240081881925}-{'f1_val': 0.7016934795869249, 'auprc': 0.9948968592938319, 'loss_val': 0.5176043092561775, 'psi': 0.8189748314696876}
[S13] START round=14 head_norm_before_train=1.400552 cos_to_last_merge=0.8940 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.894
[S13] round=14 local utility u=0.054014 metrics={'f1_val': 0.6105027369043945, 'auprc': 0.6736964315045799, 'loss_val': 0.7413222381264214, 'psi': 0.6357802147444687}-{'f1_val': 0.5946539834609238, 'auprc': 0.6870583687989895, 'loss_val': 0.7943428165301223, 'psi': 0.6316157375961501}
[S14] START round=14 head_norm_before_train=1.020750 cos_to_last_merge=1.0000 (last merge round=13)
[S14] round=14 local utility u=0.747167 metrics={'f1_val': 0.9281612905449683, 'auprc': 0.9948018771139706, 'loss_val': 0.5290206747776517, 'psi': 0.9548175251725692}-{'f1_val': 0.7011648480749666, 'auprc': 0.9935758730570721, 'loss_val': 0.6576988446666582, 'psi': 0.8181292580678088}
[S15] START round=14 head_norm_before_train=1.450874 cos_to_last_merge=0.8298 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.830
[S15] round=14 local utility u=0.062556 metrics={'f1_val': 0.9109615297975653, 'auprc': 0.9940077936400278, 'loss_val': 0.1380370919800432, 'psi': 0.9441800353345502}-{'f1_val': 0.9001818091781164, 'auprc': 0.994073616722635, 'loss_val': 0.19866858049621702, 'psi': 0.9377385321959238}
[S16] START round=14 head_norm_before_train=0.831263 cos_to_last_merge=0.9818 (last merge round=11)
[S16] round=14 local utility u=0.299210 metrics={'f1_val': 0.5003045420259488, 'auprc': 0.8077989164728071, 'loss_val': 0.7346080289384656, 'psi': 0.6233022918046922}-{'f1_val': 0.4237772487357285, 'auprc': 0.7852851472312954, 'loss_val': 0.8063232073883306, 'psi': 0.5683804081339553}
[S17] START round=14 head_norm_before_train=1.802698 (no previous merge yet)
[S17] round=14 local utility u=0.000000 metrics={'f1_val': 0.579169871921146, 'auprc': 0.7720355161151897, 'loss_val': 1.0033316700871469, 'psi': 0.6563161295987635}-{'f1_val': 0.594107780314522, 'auprc': 0.8125194856091753, 'loss_val': 0.8876728649201583, 'psi': 0.6814724624323834}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:58310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:58305
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1801) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.116581)
[S9] loaded HEAD from S11 (vec_in norm=1.116581)
[S9] cosine check vs S11: cos=0.7159
[S9] BUFFERED delta from S11 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1802) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.823696)
[S5] loaded HEAD from S10 (vec_in norm=1.823696)
[S5] cosine check vs S10: cos=0.5352
[S5] BUFFERED delta from S10 (total buffered=1)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:58316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:58308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:58310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:58304
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:58305
[S5] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:58305
[S16] RECEIVED delta(kind=head bytes=1797) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.763737)
[S16] loaded HEAD from S5 (vec_in norm=0.763737)
[S16] cosine check vs S5: cos=0.8324
[S16] BUFFERED delta from S5 (total buffered=1)
[S8] sending update (kind=head size=1804 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1803) from S13
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.429653)
[S9] loaded HEAD from S13 (vec_in norm=1.429653)
[S9] cosine check vs S13: cos=0.1545
[S9] BUFFERED delta from S13 (total buffered=2)
[S4] RECEIVED delta(kind=head bytes=1797) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.918224)
[S4] loaded HEAD from S6 (vec_in norm=0.918224)
[S4] cosine check vs S6: cos=0.7351
[S4] BUFFERED delta from S6 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1804) from S8
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.618151)
[S7] loaded HEAD from S8 (vec_in norm=1.618151)
[S7] cosine check vs S8: cos=0.9818
[S7] BUFFERED delta from S8 (total buffered=1)
[S3] sending update (kind=head size=1801 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1801) from S3
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.699911)
[S5] loaded HEAD from S3 (vec_in norm=1.699911)
[S5] cosine check vs S3: cos=0.5469
[S5] BUFFERED delta from S3 (total buffered=2)
[S15] sending update (kind=head size=1802 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1802) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.503264)
[S5] loaded HEAD from S15 (vec_in norm=1.503264)
[S5] cosine check vs S15: cos=0.3976
[S5] BUFFERED delta from S15 (total buffered=3)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:58312
[S4] sending update (kind=head size=1796 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1796) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.024904)
[S11] loaded HEAD from S4 (vec_in norm=1.024904)
[S11] cosine check vs S4: cos=0.7975
[S11] BUFFERED delta from S4 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:58305
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:58307
[S16] sending update (kind=head size=1794 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1794) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.889488)
[S6] loaded HEAD from S16 (vec_in norm=0.889488)
[S6] cosine check vs S16: cos=0.8089
[S6] BUFFERED delta from S16 (total buffered=1)
[S14] sending update (kind=head size=1796 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1796) from S14
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.067302)
[S5] loaded HEAD from S14 (vec_in norm=1.067302)
[S5] cosine check vs S14: cos=0.5069
[S5] BUFFERED delta from S14 (total buffered=4)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=14 metric=0.6986 head_norm=1.116581
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.434464e-01
[S11] stored merged vector for next round verification (round=14)
[S11] DEBUG after merge:  round=14 metric=0.6722 head_norm=1.015202 delta_norm=0.343446
[S11] aggregate: ROLLBACK (f1_val pre=0.699 post=0.672 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=14 metric=0.7013 head_norm=1.012037
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.554346e-01
[S9] stored merged vector for next round verification (round=14)
[S9] DEBUG after merge:  round=14 metric=0.7013 head_norm=0.850699 delta_norm=0.455435
[S9] aggregate: ACCEPT kept=['S11', 'S13'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=14 metric=0.5784 head_norm=0.918224
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.797345e-01
[S6] stored merged vector for next round verification (round=14)
[S6] DEBUG after merge:  round=14 metric=0.7562 head_norm=0.859599 delta_norm=0.279734
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=14 metric=0.5946 head_norm=1.490120
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.612371e-01
[S7] stored merged vector for next round verification (round=14)
[S7] DEBUG after merge:  round=14 metric=0.6823 head_norm=1.547074 delta_norm=0.161237
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=4 kept=4 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=14 metric=0.6771 head_norm=0.763737
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.756083e-01
[S5] stored merged vector for next round verification (round=14)
[S5] DEBUG after merge:  round=14 metric=0.7008 head_norm=0.767916 delta_norm=0.175608
[S5] aggregate: ACCEPT kept=['S10', 'S3', 'S15', 'S14'] (k=4/4) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=14 metric=0.9529 head_norm=1.024904
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.570714e-01
[S4] stored merged vector for next round verification (round=14)
[S4] DEBUG after merge:  round=14 metric=0.9551 head_norm=0.905142 delta_norm=0.357071
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=14 metric=0.5003 head_norm=0.889488
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.467376e-01
[S16] stored merged vector for next round verification (round=14)
[S16] DEBUG after merge:  round=14 metric=0.5658 head_norm=0.791430 delta_norm=0.246738
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.789857 (no previous merge yet)
[S2] round=15 local utility u=0.000000 metrics={'f1_val': 0.7032483944357321, 'auprc': 0.7739104855464684, 'loss_val': 0.9095695208613571, 'psi': 0.7315132308800266}-{'f1_val': 0.6946421530501954, 'auprc': 0.7029582438974025, 'loss_val': 0.4279538562735974, 'psi': 0.6979685893890781}
[S3] START round=15 head_norm_before_train=1.699911 (no previous merge yet)
[S3] round=15 local utility u=0.000000 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.9968164243059996, 'loss_val': 0.22518946515235927, 'psi': 0.8190901712225231}-{'f1_val': 0.7006060025002057, 'auprc': 0.998468539887304, 'loss_val': 0.19798818335735865, 'psi': 0.819751017455045}
[S4] START round=15 head_norm_before_train=0.905142 cos_to_last_merge=1.0000 (last merge round=14)
[S4] round=15 local utility u=0.000000 metrics={'f1_val': 0.9389536128520375, 'auprc': 0.9376168888667495, 'loss_val': 0.4435604258787212, 'psi': 0.9384189232579223}-{'f1_val': 0.9529062309854555, 'auprc': 0.9591971290679552, 'loss_val': 0.32370111657703377, 'psi': 0.9554225902184553}
[S5] START round=15 head_norm_before_train=0.767916 cos_to_last_merge=1.0000 (last merge round=14)
[S5] round=15 local utility u=0.155585 metrics={'f1_val': 0.7008168588441903, 'auprc': 0.7927886391786242, 'loss_val': 0.6441185968603064, 'psi': 0.7376055709779639}-{'f1_val': 0.6771072475446241, 'auprc': 0.7592477080637502, 'loss_val': 0.712407380609158, 'psi': 0.7099634317522745}
[S6] START round=15 head_norm_before_train=0.859599 cos_to_last_merge=1.0000 (last merge round=14)
[S6] round=15 local utility u=0.850438 metrics={'f1_val': 0.7855377232576237, 'auprc': 0.9466950941074285, 'loss_val': 0.5803782087311882, 'psi': 0.8500006715975457}-{'f1_val': 0.5783801440041559, 'auprc': 0.8060179633800627, 'loss_val': 0.6162764896454412, 'psi': 0.6694352717545187}
[S7] START round=15 head_norm_before_train=1.547074 cos_to_last_merge=1.0000 (last merge round=14)
[S7] round=15 local utility u=0.314820 metrics={'f1_val': 0.6729026904472175, 'auprc': 0.8022901865802288, 'loss_val': 0.6818333625759472, 'psi': 0.724657688900422}-{'f1_val': 0.5946015882331954, 'auprc': 0.7807310907396051, 'loss_val': 0.7769902735895441, 'psi': 0.6690533892357593}
[S8] START round=15 head_norm_before_train=1.618151 cos_to_last_merge=0.8557 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.856
[S8] round=15 local utility u=0.000000 metrics={'f1_val': 0.7139758603458082, 'auprc': 0.986489569308104, 'loss_val': 0.4438051687922166, 'psi': 0.8229813439307265}-{'f1_val': 0.9914482382097267, 'auprc': 0.9990928607805564, 'loss_val': 0.05383554732990164, 'psi': 0.9945060872380587}
[S9] START round=15 head_norm_before_train=0.850699 cos_to_last_merge=1.0000 (last merge round=14)
[S9] round=15 local utility u=0.007755 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9986163185760168, 'loss_val': 0.415073073400536, 'psi': 0.8201764758944179}-{'f1_val': 0.7012904835408967, 'auprc': 0.9989939880025867, 'loss_val': 0.4321596796086318, 'psi': 0.8203718853255727}
[S10] START round=15 head_norm_before_train=1.823696 (no previous merge yet)
[S10] round=15 local utility u=0.002073 metrics={'f1_val': 0.9955259082574451, 'auprc': 0.9965159689356453, 'loss_val': 0.034544614525534506, 'psi': 0.9959219325287252}-{'f1_val': 0.9956096535150197, 'auprc': 0.9964933215156863, 'loss_val': 0.03912564428375256, 'psi': 0.9959631207152864}
[S11] START round=15 head_norm_before_train=1.015202 cos_to_last_merge=1.0000 (last merge round=14)
[S11] round=15 local utility u=0.000000 metrics={'f1_val': 0.7016282822309048, 'auprc': 0.9952049084432338, 'loss_val': 0.5149220850538456, 'psi': 0.8190589327158364}-{'f1_val': 0.6985737623829675, 'auprc': 0.9964493768960297, 'loss_val': 0.46460577792129865, 'psi': 0.8177240081881925}
[S13] START round=15 head_norm_before_train=1.429653 cos_to_last_merge=0.8911 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.891
[S13] round=15 local utility u=0.031328 metrics={'f1_val': 0.6133566934829461, 'auprc': 0.6554626243027178, 'loss_val': 0.6410884121386998, 'psi': 0.6301990658108547}-{'f1_val': 0.6105027369043945, 'auprc': 0.6736964315045799, 'loss_val': 0.7413222381264214, 'psi': 0.6357802147444687}
[S14] START round=15 head_norm_before_train=1.067302 cos_to_last_merge=0.9971 (last merge round=13)
[S14] round=15 local utility u=0.267437 metrics={'f1_val': 0.9967519236658979, 'auprc': 0.995159481025997, 'loss_val': 0.4067631236599936, 'psi': 0.9961149466099375}-{'f1_val': 0.9281612905449683, 'auprc': 0.9948018771139706, 'loss_val': 0.5290206747776517, 'psi': 0.9548175251725692}
[S15] START round=15 head_norm_before_train=1.503264 cos_to_last_merge=0.8247 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.825
[S15] round=15 local utility u=0.000000 metrics={'f1_val': 0.850418922189262, 'auprc': 0.9240219340256836, 'loss_val': 0.3125611445432875, 'psi': 0.8798601269238306}-{'f1_val': 0.9109615297975653, 'auprc': 0.9940077936400278, 'loss_val': 0.1380370919800432, 'psi': 0.9441800353345502}
[S16] START round=15 head_norm_before_train=0.791430 cos_to_last_merge=1.0000 (last merge round=14)
[S16] round=15 local utility u=0.890065 metrics={'f1_val': 0.7695130794412627, 'auprc': 0.8663587784978377, 'loss_val': 0.7454092248088462, 'psi': 0.8082513590638927}-{'f1_val': 0.5003045420259488, 'auprc': 0.8077989164728071, 'loss_val': 0.7346080289384656, 'psi': 0.6233022918046922}
[S17] START round=15 head_norm_before_train=1.831644 (no previous merge yet)
[S17] round=15 local utility u=0.292273 metrics={'f1_val': 0.590169176549765, 'auprc': 0.904730315216812, 'loss_val': 0.8828649870266545, 'psi': 0.7159936320165838}-{'f1_val': 0.579169871921146, 'auprc': 0.7720355161151897, 'loss_val': 1.0033316700871469, 'psi': 0.6563161295987635}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:58310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:58314
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:58314
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:58304
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:58305
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:58307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:58316
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1793 to 1 peers)
[S13] sending update (kind=head size=1804 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1804) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.859672)
[S5] loaded HEAD from S10 (vec_in norm=1.859672)
[S5] cosine check vs S10: cos=0.5783
[S5] BUFFERED delta from S10 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1796) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.846001)
[S6] loaded HEAD from S16 (vec_in norm=0.846001)
[S6] cosine check vs S16: cos=0.8876
[S6] BUFFERED delta from S16 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1797) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.805304)
[S16] loaded HEAD from S5 (vec_in norm=0.805304)
[S16] cosine check vs S5: cos=0.9450
[S16] BUFFERED delta from S5 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1793) from S14
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.118409)
[S5] loaded HEAD from S14 (vec_in norm=1.118409)
[S5] cosine check vs S14: cos=0.4386
[S5] BUFFERED delta from S14 (total buffered=2)
[S4] RECEIVED delta(kind=head bytes=1799) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.922931)
[S4] loaded HEAD from S6 (vec_in norm=0.922931)
[S4] cosine check vs S6: cos=0.8463
[S4] BUFFERED delta from S6 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1804) from S13
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.456103)
[S9] loaded HEAD from S13 (vec_in norm=1.456103)
[S9] cosine check vs S13: cos=0.5077
[S9] BUFFERED delta from S13 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1794) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.905654)
[S14] loaded HEAD from S9 (vec_in norm=0.905654)
[S14] cosine check vs S9: cos=0.7305
[S14] BUFFERED delta from S9 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1802) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.565517)
[S14] loaded HEAD from S7 (vec_in norm=1.565517)
[S14] cosine check vs S7: cos=0.7727
[S14] BUFFERED delta from S7 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:58310
[S17] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1800) from S17
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.851480)
[S9] loaded HEAD from S17 (vec_in norm=1.851480)
[S9] cosine check vs S17: cos=0.4822
[S9] BUFFERED delta from S17 (total buffered=2)
[S8] ⇄ pheromone p=0.132 → S7@127.0.0.1:58308
[S11] ⇄ pheromone p=0.191 → S9@127.0.0.1:58310
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=15 metric=0.9390 head_norm=0.965732
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.625993e-01
[S4] stored merged vector for next round verification (round=15)
[S4] DEBUG after merge:  round=15 metric=0.9394 head_norm=0.907338 delta_norm=0.262599
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.107 → S11@127.0.0.1:58312
[S2] ⇄ pheromone p=0.119 → S5@127.0.0.1:58305
[S3] ⇄ pheromone p=0.152 → S5@127.0.0.1:58305
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=15 metric=0.7008 head_norm=0.805304
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.537385e-01
[S5] stored merged vector for next round verification (round=15)
[S5] DEBUG after merge:  round=15 metric=0.7008 head_norm=0.869289 delta_norm=0.353738
[S5] aggregate: ACCEPT kept=['S10', 'S14'] (k=2/2) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.267 → S16@127.0.0.1:58316
[S13] ⇄ pheromone p=0.114 → S9@127.0.0.1:58310
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=15 metric=0.7012 head_norm=0.905654
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.316266e-01
[S9] stored merged vector for next round verification (round=15)
[S9] DEBUG after merge:  round=15 metric=0.7012 head_norm=0.961949 delta_norm=0.431627
[S9] aggregate: ACCEPT kept=['S13', 'S17'] (k=2/2) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.172 → S14@127.0.0.1:58314
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=15 metric=0.7855 head_norm=0.922931
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.129945e-01
[S6] stored merged vector for next round verification (round=15)
[S6] DEBUG after merge:  round=15 metric=0.7844 head_norm=0.859298 delta_norm=0.212994
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.418 → S4@127.0.0.1:58304
[S10] ⇄ pheromone p=0.120 → S5@127.0.0.1:58305
[S7] ⇄ pheromone p=0.285 → S14@127.0.0.1:58314
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=15 metric=0.7695 head_norm=0.846001
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.383911e-01
[S16] stored merged vector for next round verification (round=15)
[S16] DEBUG after merge:  round=15 metric=0.7035 head_norm=0.814226 delta_norm=0.138391
[S16] aggregate: ROLLBACK (f1_val pre=0.770 post=0.703 tol_abs=0.005 tol_rel=0.0)
[S16] ⇄ pheromone p=0.349 → S6@127.0.0.1:58307
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=15 metric=0.9968 head_norm=1.118409
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.671546e-01
[S14] stored merged vector for next round verification (round=15)
[S14] DEBUG after merge:  round=15 metric=0.9955 head_norm=1.057233 delta_norm=0.267155
[S14] aggregate: ACCEPT kept=['S9', 'S7'] (k=2/2) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.394 → S5@127.0.0.1:58305
[S15] ⇄ pheromone p=0.227 → S5@127.0.0.1:58305
[S17] ⇄ pheromone p=0.195 → S9@127.0.0.1:58310
[S2] START round=16 head_norm_before_train=1.807549 (no previous merge yet)
[S2] round=16 local utility u=0.052942 metrics={'f1_val': 0.712086687723557, 'auprc': 0.7564745864154357, 'loss_val': 0.8044074240352871, 'psi': 0.7298418472003085}-{'f1_val': 0.7032483944357321, 'auprc': 0.7739104855464684, 'loss_val': 0.9095695208613571, 'psi': 0.7315132308800266}
[S3] START round=16 head_norm_before_train=1.723575 (no previous merge yet)
[S3] round=16 local utility u=0.944297 metrics={'f1_val': 0.996697285043245, 'auprc': 0.9983687961979791, 'loss_val': 0.11780048027168538, 'psi': 0.9973658895051386}-{'f1_val': 0.7006060025002057, 'auprc': 0.9968164243059996, 'loss_val': 0.22518946515235927, 'psi': 0.8190901712225231}
[S4] START round=16 head_norm_before_train=0.907338 cos_to_last_merge=1.0000 (last merge round=15)
[S4] round=16 local utility u=0.059525 metrics={'f1_val': 0.9463498124076933, 'auprc': 0.9578715713121311, 'loss_val': 0.42965159263424235, 'psi': 0.9509585159694685}-{'f1_val': 0.9389536128520375, 'auprc': 0.9376168888667495, 'loss_val': 0.4435604258787212, 'psi': 0.9384189232579223}
[S5] START round=16 head_norm_before_train=0.869289 cos_to_last_merge=1.0000 (last merge round=15)
[S5] round=16 local utility u=0.000000 metrics={'f1_val': 0.7005685100046517, 'auprc': 0.7213247995660181, 'loss_val': 0.6458123217937292, 'psi': 0.7088710258291983}-{'f1_val': 0.7008168588441903, 'auprc': 0.7927886391786242, 'loss_val': 0.6441185968603064, 'psi': 0.7376055709779639}
[S6] START round=16 head_norm_before_train=0.859298 cos_to_last_merge=1.0000 (last merge round=15)
[S6] round=16 local utility u=0.130698 metrics={'f1_val': 0.8211796890499418, 'auprc': 0.9547007210262308, 'loss_val': 0.5568513459108944, 'psi': 0.8745881018404574}-{'f1_val': 0.7855377232576237, 'auprc': 0.9466950941074285, 'loss_val': 0.5803782087311882, 'psi': 0.8500006715975457}
[S7] START round=16 head_norm_before_train=1.565517 cos_to_last_merge=0.9994 (last merge round=14)
[S7] round=16 local utility u=0.000000 metrics={'f1_val': 0.602139458943406, 'auprc': 0.785290615427296, 'loss_val': 0.6890179102572972, 'psi': 0.6753999215369619}-{'f1_val': 0.6729026904472175, 'auprc': 0.8022901865802288, 'loss_val': 0.6818333625759472, 'psi': 0.724657688900422}
[S8] START round=16 head_norm_before_train=1.654339 cos_to_last_merge=0.8508 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.851
[S8] round=16 local utility u=1.000000 metrics={'f1_val': 0.9929024225986427, 'auprc': 0.9988820762696202, 'loss_val': 0.04321198387455583, 'psi': 0.9952942840670338}-{'f1_val': 0.7139758603458082, 'auprc': 0.986489569308104, 'loss_val': 0.4438051687922166, 'psi': 0.8229813439307265}
[S9] START round=16 head_norm_before_train=0.961949 cos_to_last_merge=1.0000 (last merge round=15)
[S9] round=16 local utility u=0.049460 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.99823481655951, 'loss_val': 0.31500876639961123, 'psi': 0.8200238750878152}-{'f1_val': 0.7012165807733519, 'auprc': 0.9986163185760168, 'loss_val': 0.415073073400536, 'psi': 0.8201764758944179}
[S10] START round=16 head_norm_before_train=1.859672 (no previous merge yet)
[S10] round=16 local utility u=0.002422 metrics={'f1_val': 0.9959407510105199, 'auprc': 0.9965135802311299, 'loss_val': 0.032181653264017264, 'psi': 0.9961698826987639}-{'f1_val': 0.9955259082574451, 'auprc': 0.9965159689356453, 'loss_val': 0.034544614525534506, 'psi': 0.9959219325287252}
[S11] START round=16 head_norm_before_train=1.052571 cos_to_last_merge=0.9964 (last merge round=14)
[S11] round=16 local utility u=0.026813 metrics={'f1_val': 0.6973171582909299, 'auprc': 0.9965289408633505, 'loss_val': 0.4394011911157879, 'psi': 0.8170018713198981}-{'f1_val': 0.7016282822309048, 'auprc': 0.9952049084432338, 'loss_val': 0.5149220850538456, 'psi': 0.8190589327158364}
[S13] START round=16 head_norm_before_train=1.456103 cos_to_last_merge=0.8874 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.887
[S13] round=16 local utility u=0.061690 metrics={'f1_val': 0.6280170828125973, 'auprc': 0.6790885342471056, 'loss_val': 0.6765484634445662, 'psi': 0.6484456633864006}-{'f1_val': 0.6133566934829461, 'auprc': 0.6554626243027178, 'loss_val': 0.6410884121386998, 'psi': 0.6301990658108547}
[S14] START round=16 head_norm_before_train=1.057233 cos_to_last_merge=1.0000 (last merge round=15)
[S14] round=16 local utility u=0.012652 metrics={'f1_val': 0.9976961193890743, 'auprc': 0.994628164353175, 'loss_val': 0.38553022868074155, 'psi': 0.9964689373747146}-{'f1_val': 0.9967519236658979, 'auprc': 0.995159481025997, 'loss_val': 0.4067631236599936, 'psi': 0.9961149466099375}
[S15] START round=16 head_norm_before_train=1.544602 cos_to_last_merge=0.8210 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.821
[S15] round=16 local utility u=0.671293 metrics={'f1_val': 0.9966196520233872, 'auprc': 0.9964040093347886, 'loss_val': 0.06432583117163466, 'psi': 0.9965333949479478}-{'f1_val': 0.850418922189262, 'auprc': 0.9240219340256836, 'loss_val': 0.3125611445432875, 'psi': 0.8798601269238306}
[S16] START round=16 head_norm_before_train=0.814226 cos_to_last_merge=1.0000 (last merge round=15)
[S16] round=16 local utility u=0.274517 metrics={'f1_val': 0.8374179447087818, 'auprc': 0.9158415029140556, 'loss_val': 0.7522534069745425, 'psi': 0.8687873679908914}-{'f1_val': 0.7695130794412627, 'auprc': 0.8663587784978377, 'loss_val': 0.7454092248088462, 'psi': 0.8082513590638927}
[S17] START round=16 head_norm_before_train=1.851480 (no previous merge yet)
[S17] round=16 local utility u=0.000000 metrics={'f1_val': 0.5979240398828574, 'auprc': 0.9009392971383209, 'loss_val': 0.9982960024396805, 'psi': 0.7191301427850427}-{'f1_val': 0.590169176549765, 'auprc': 0.904730315216812, 'loss_val': 0.8828649870266545, 'psi': 0.7159936320165838}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:58310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:58307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:58305
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:58308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S11@127.0.0.1:58312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] → sending delta(kind=head bytes=1805) to S4@127.0.0.1:58304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:58310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:58305
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:58305
[S14] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1805 to 1 peers)
[S6] sending update (kind=head size=1805 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1798) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.584925)
[S5] loaded HEAD from S15 (vec_in norm=1.584925)
[S5] cosine check vs S15: cos=0.4268
[S5] BUFFERED delta from S15 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1798) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.875175)
[S6] loaded HEAD from S16 (vec_in norm=0.875175)
[S6] cosine check vs S16: cos=0.9153
[S6] BUFFERED delta from S16 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1796) from S14
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.106064)
[S5] loaded HEAD from S14 (vec_in norm=1.106064)
[S5] cosine check vs S14: cos=0.4819
[S5] BUFFERED delta from S14 (total buffered=2)
[S4] RECEIVED delta(kind=head bytes=1805) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.934240)
[S4] loaded HEAD from S6 (vec_in norm=0.934240)
[S4] cosine check vs S6: cos=0.8813
[S4] BUFFERED delta from S6 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1801) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.022886)
[S14] loaded HEAD from S9 (vec_in norm=1.022886)
[S14] cosine check vs S9: cos=0.8431
[S14] BUFFERED delta from S9 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1801) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.888010)
[S5] loaded HEAD from S10 (vec_in norm=1.888010)
[S5] cosine check vs S10: cos=0.7654
[S5] BUFFERED delta from S10 (total buffered=3)
[S9] RECEIVED delta(kind=head bytes=1794) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.097871)
[S9] loaded HEAD from S11 (vec_in norm=1.097871)
[S9] cosine check vs S11: cos=0.4127
[S9] BUFFERED delta from S11 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1800) from S2
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.823800)
[S5] loaded HEAD from S2 (vec_in norm=1.823800)
[S5] cosine check vs S2: cos=-0.0006
[S5] DROPPED delta from S2 (cos=-0.0006 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1803) from S13
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.472063)
[S9] loaded HEAD from S13 (vec_in norm=1.472063)
[S9] cosine check vs S13: cos=0.6024
[S9] BUFFERED delta from S13 (total buffered=2)
[S7] RECEIVED delta(kind=head bytes=1804) from S8
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.682593)
[S7] loaded HEAD from S8 (vec_in norm=1.682593)
[S7] cosine check vs S8: cos=0.9865
[S7] BUFFERED delta from S8 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1805) from S3
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.743540)
[S5] loaded HEAD from S3 (vec_in norm=1.743540)
[S5] cosine check vs S3: cos=0.2451
[S5] BUFFERED delta from S3 (total buffered=4)
[S11] RECEIVED delta(kind=head bytes=1804) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.990073)
[S11] loaded HEAD from S4 (vec_in norm=0.990073)
[S11] cosine check vs S4: cos=0.7247
[S11] BUFFERED delta from S4 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=4 kept=4 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=16 metric=0.7006 head_norm=0.902796
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.139403e-01
[S5] stored merged vector for next round verification (round=16)
[S5] DEBUG after merge:  round=16 metric=0.7006 head_norm=0.848757 delta_norm=0.213940
[S5] aggregate: ACCEPT kept=['S15', 'S14', 'S10', 'S3'] (k=4/4) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=16 metric=0.6021 head_norm=1.586120
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.427962e-01
[S7] stored merged vector for next round verification (round=16)
[S7] DEBUG after merge:  round=16 metric=0.6670 head_norm=1.628821 delta_norm=0.142796
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=16 metric=0.7012 head_norm=1.022886
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.722492e-01
[S9] stored merged vector for next round verification (round=16)
[S9] DEBUG after merge:  round=16 metric=0.7012 head_norm=0.907653 delta_norm=0.372249
[S9] aggregate: ACCEPT kept=['S11', 'S13'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=16 metric=0.6973 head_norm=1.097871
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.905191e-01
[S11] stored merged vector for next round verification (round=16)
[S11] DEBUG after merge:  round=16 metric=0.6727 head_norm=0.969679 delta_norm=0.390519
[S11] aggregate: ROLLBACK (f1_val pre=0.697 post=0.673 tol_abs=0.005 tol_rel=0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=16 metric=0.8212 head_norm=0.934240
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.883974e-01
[S6] stored merged vector for next round verification (round=16)
[S6] DEBUG after merge:  round=16 metric=0.8209 head_norm=0.885367 delta_norm=0.188397
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=16 metric=0.9463 head_norm=0.990073
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.359993e-01
[S4] stored merged vector for next round verification (round=16)
[S4] DEBUG after merge:  round=16 metric=0.9472 head_norm=0.933182 delta_norm=0.235999
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=16 metric=0.9977 head_norm=1.106064
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.008145e-01
[S14] stored merged vector for next round verification (round=16)
[S14] DEBUG after merge:  round=16 metric=0.9977 head_norm=1.021933 delta_norm=0.300815
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.823800 (no previous merge yet)
[S2] round=17 local utility u=0.000000 metrics={'f1_val': 0.6066116052309279, 'auprc': 0.7201405770416143, 'loss_val': 1.0860653418213657, 'psi': 0.6520231939552025}-{'f1_val': 0.712086687723557, 'auprc': 0.7564745864154357, 'loss_val': 0.8044074240352871, 'psi': 0.7298418472003085}
[S3] START round=17 head_norm_before_train=1.743540 (no previous merge yet)
[S3] round=17 local utility u=0.000000 metrics={'f1_val': 0.9109526613168432, 'auprc': 0.9964579307408326, 'loss_val': 0.18353584322279506, 'psi': 0.945154769086439}-{'f1_val': 0.996697285043245, 'auprc': 0.9983687961979791, 'loss_val': 0.11780048027168538, 'psi': 0.9973658895051386}
[S4] START round=17 head_norm_before_train=0.933182 cos_to_last_merge=1.0000 (last merge round=16)
[S4] round=17 local utility u=0.000000 metrics={'f1_val': 0.9413384876352038, 'auprc': 0.9464627371358982, 'loss_val': 0.41729404813317345, 'psi': 0.9433881874354816}-{'f1_val': 0.9463498124076933, 'auprc': 0.9578715713121311, 'loss_val': 0.42965159263424235, 'psi': 0.9509585159694685}
[S5] START round=17 head_norm_before_train=0.848757 cos_to_last_merge=1.0000 (last merge round=16)
[S5] round=17 local utility u=0.140162 metrics={'f1_val': 0.700320598491359, 'auprc': 0.7960143566333095, 'loss_val': 0.5880692084155283, 'psi': 0.7385981017481392}-{'f1_val': 0.7005685100046517, 'auprc': 0.7213247995660181, 'loss_val': 0.6458123217937292, 'psi': 0.7088710258291983}
[S6] START round=17 head_norm_before_train=0.885367 cos_to_last_merge=1.0000 (last merge round=16)
[S6] round=17 local utility u=0.000000 metrics={'f1_val': 0.6991345109173365, 'auprc': 0.9464452434526625, 'loss_val': 0.6762792427195593, 'psi': 0.7980588039314669}-{'f1_val': 0.8211796890499418, 'auprc': 0.9547007210262308, 'loss_val': 0.5568513459108944, 'psi': 0.8745881018404574}
[S7] START round=17 head_norm_before_train=1.628821 cos_to_last_merge=1.0000 (last merge round=16)
[S7] round=17 local utility u=0.437777 metrics={'f1_val': 0.6783207334451171, 'auprc': 0.8725441355561371, 'loss_val': 0.5323119033503275, 'psi': 0.7560100942895251}-{'f1_val': 0.602139458943406, 'auprc': 0.785290615427296, 'loss_val': 0.6890179102572972, 'psi': 0.6753999215369619}
[S8] START round=17 head_norm_before_train=1.682593 cos_to_last_merge=0.8469 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.847
[S8] round=17 local utility u=0.002590 metrics={'f1_val': 0.9932593276801964, 'auprc': 0.999034014797644, 'loss_val': 0.040629219331851346, 'psi': 0.9955692025271754}-{'f1_val': 0.9929024225986427, 'auprc': 0.9988820762696202, 'loss_val': 0.04321198387455583, 'psi': 0.9952942840670338}
[S9] START round=17 head_norm_before_train=0.907653 cos_to_last_merge=1.0000 (last merge round=16)
[S9] round=17 local utility u=0.000000 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9982159857187324, 'loss_val': 0.32868978124608106, 'psi': 0.8200163427515041}-{'f1_val': 0.7012165807733519, 'auprc': 0.99823481655951, 'loss_val': 0.31500876639961123, 'psi': 0.8200238750878152}
[S10] START round=17 head_norm_before_train=1.888010 (no previous merge yet)
[S10] round=17 local utility u=0.000000 metrics={'f1_val': 0.9957210358491089, 'auprc': 0.9965065725917995, 'loss_val': 0.031052904169155186, 'psi': 0.9960352505461851}-{'f1_val': 0.9959407510105199, 'auprc': 0.9965135802311299, 'loss_val': 0.032181653264017264, 'psi': 0.9961698826987639}
[S11] START round=17 head_norm_before_train=0.969679 cos_to_last_merge=1.0000 (last merge round=16)
[S11] round=17 local utility u=0.713945 metrics={'f1_val': 0.9535720775450554, 'auprc': 0.9966480194881753, 'loss_val': 0.5493980383574787, 'psi': 0.9708024543223033}-{'f1_val': 0.6973171582909299, 'auprc': 0.9965289408633505, 'loss_val': 0.4394011911157879, 'psi': 0.8170018713198981}
[S13] START round=17 head_norm_before_train=1.472063 cos_to_last_merge=0.8856 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.886
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.5587145240408673, 'auprc': 0.697978308311891, 'loss_val': 0.8327314721695328, 'psi': 0.6144200377492768}-{'f1_val': 0.6280170828125973, 'auprc': 0.6790885342471056, 'loss_val': 0.6765484634445662, 'psi': 0.6484456633864006}
[S14] START round=17 head_norm_before_train=1.021933 cos_to_last_merge=1.0000 (last merge round=16)
[S14] round=17 local utility u=0.017672 metrics={'f1_val': 0.9969473164239916, 'auprc': 0.9956358893165702, 'loss_val': 0.34871649416812717, 'psi': 0.9964227455810231}-{'f1_val': 0.9976961193890743, 'auprc': 0.994628164353175, 'loss_val': 0.38553022868074155, 'psi': 0.9964689373747146}
[S15] START round=17 head_norm_before_train=1.584925 cos_to_last_merge=0.8188 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.819
[S15] round=17 local utility u=0.000000 metrics={'f1_val': 0.9792725652417421, 'auprc': 0.9977260258847925, 'loss_val': 0.08665615311823954, 'psi': 0.9866539494989622}-{'f1_val': 0.9966196520233872, 'auprc': 0.9964040093347886, 'loss_val': 0.06432583117163466, 'psi': 0.9965333949479478}
[S16] START round=17 head_norm_before_train=0.875175 cos_to_last_merge=0.9963 (last merge round=15)
[S16] round=17 local utility u=0.060975 metrics={'f1_val': 0.8270122243340622, 'auprc': 0.9130594069204795, 'loss_val': 0.5595233173623477, 'psi': 0.8614310973686291}-{'f1_val': 0.8374179447087818, 'auprc': 0.9158415029140556, 'loss_val': 0.7522534069745425, 'psi': 0.8687873679908914}
[S17] START round=17 head_norm_before_train=1.875548 (no previous merge yet)
[S17] round=17 local utility u=0.000000 metrics={'f1_val': 0.594906470793579, 'auprc': 0.8787553679600497, 'loss_val': 1.0859482715765385, 'psi': 0.7084460296601672}-{'f1_val': 0.5979240398828574, 'auprc': 0.9009392971383209, 'loss_val': 0.9982960024396805, 'psi': 0.7191301427850427}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:58308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] → sending delta(kind=head bytes=1806) to S14@127.0.0.1:58314
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:58305
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S16] → sending delta(kind=head bytes=1791) to S6@127.0.0.1:58307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:58310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:58316
[S11] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1791 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1806 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1799) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.003546)
[S9] loaded HEAD from S11 (vec_in norm=1.003546)
[S9] cosine check vs S11: cos=0.5576
[S9] BUFFERED delta from S11 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1796) from S14
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.070386)
[S5] loaded HEAD from S14 (vec_in norm=1.070386)
[S5] cosine check vs S14: cos=0.4459
[S5] BUFFERED delta from S14 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1791) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.943930)
[S6] loaded HEAD from S16 (vec_in norm=0.943930)
[S6] cosine check vs S16: cos=0.9397
[S6] BUFFERED delta from S16 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1796) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.890025)
[S16] loaded HEAD from S5 (vec_in norm=0.890025)
[S16] cosine check vs S5: cos=0.9156
[S16] BUFFERED delta from S5 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1806) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.644629)
[S14] loaded HEAD from S7 (vec_in norm=1.644629)
[S14] cosine check vs S7: cos=0.7206
[S14] BUFFERED delta from S7 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1800) from S8
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.706169)
[S7] loaded HEAD from S8 (vec_in norm=1.706169)
[S7] cosine check vs S8: cos=0.9940
[S7] BUFFERED delta from S8 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=17 metric=0.7012 head_norm=0.965063
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.632480e-01
[S9] stored merged vector for next round verification (round=17)
[S9] DEBUG after merge:  round=17 metric=0.7012 head_norm=0.868692 delta_norm=0.463248
[S9] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=17 metric=0.6991 head_norm=0.951304
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.646202e-01
[S6] stored merged vector for next round verification (round=17)
[S6] DEBUG after merge:  round=17 metric=0.6958 head_norm=0.933216 delta_norm=0.164620
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=17 metric=0.9969 head_norm=1.070386
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.730229e-01
[S14] stored merged vector for next round verification (round=17)
[S14] DEBUG after merge:  round=17 metric=0.9976 head_norm=1.263689 delta_norm=0.573023
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=17 metric=0.6783 head_norm=1.644629
[S7] _apply_head_vector_avg (torch): Δ‖w‖=9.677633e-02
[S7] stored merged vector for next round verification (round=17)
[S7] DEBUG after merge:  round=17 metric=0.6811 head_norm=1.672884 delta_norm=0.096776
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=17 metric=0.8270 head_norm=0.943930
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.902173e-01
[S16] stored merged vector for next round verification (round=17)
[S16] DEBUG after merge:  round=17 metric=0.8331 head_norm=0.897436 delta_norm=0.190217
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=17 metric=0.7003 head_norm=0.890025
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.216257e-01
[S5] stored merged vector for next round verification (round=17)
[S5] DEBUG after merge:  round=17 metric=0.7006 head_norm=0.834770 delta_norm=0.521626
[S5] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.842554 (no previous merge yet)
[S2] round=18 local utility u=0.147591 metrics={'f1_val': 0.6578593378395151, 'auprc': 0.7189743782885616, 'loss_val': 1.0948720012952808, 'psi': 0.6823053540191337}-{'f1_val': 0.6066116052309279, 'auprc': 0.7201405770416143, 'loss_val': 1.0860653418213657, 'psi': 0.6520231939552025}
[S3] START round=18 head_norm_before_train=1.763878 (no previous merge yet)
[S3] round=18 local utility u=0.268075 metrics={'f1_val': 0.9868095683361822, 'auprc': 0.9970510596713703, 'loss_val': 0.104306630456834, 'psi': 0.9909061648702575}-{'f1_val': 0.9109526613168432, 'auprc': 0.9964579307408326, 'loss_val': 0.18353584322279506, 'psi': 0.945154769086439}
[S4] START round=18 head_norm_before_train=1.030564 cos_to_last_merge=0.9813 (last merge round=16)
[S4] round=18 local utility u=0.072649 metrics={'f1_val': 0.9420774604903279, 'auprc': 0.961748815212536, 'loss_val': 0.32228881587865377, 'psi': 0.9499460023792112}-{'f1_val': 0.9413384876352038, 'auprc': 0.9464627371358982, 'loss_val': 0.41729404813317345, 'psi': 0.9433881874354816}
[S5] START round=18 head_norm_before_train=0.834770 cos_to_last_merge=1.0000 (last merge round=17)
[S5] round=18 local utility u=0.000000 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.7729136804043923, 'loss_val': 0.5867561621872295, 'psi': 0.7295305077593615}-{'f1_val': 0.700320598491359, 'auprc': 0.7960143566333095, 'loss_val': 0.5880692084155283, 'psi': 0.7385981017481392}
[S6] START round=18 head_norm_before_train=0.933216 cos_to_last_merge=1.0000 (last merge round=17)
[S6] round=18 local utility u=0.360115 metrics={'f1_val': 0.796597492522471, 'auprc': 0.948121811181798, 'loss_val': 0.545857750349335, 'psi': 0.8572072199862018}-{'f1_val': 0.6991345109173365, 'auprc': 0.9464452434526625, 'loss_val': 0.6762792427195593, 'psi': 0.7980588039314669}
[S7] START round=18 head_norm_before_train=1.672884 cos_to_last_merge=1.0000 (last merge round=17)
[S7] round=18 local utility u=0.000000 metrics={'f1_val': 0.40278610933789916, 'auprc': 0.7767351469630672, 'loss_val': 0.9850869179020556, 'psi': 0.5523657243879664}-{'f1_val': 0.6783207334451171, 'auprc': 0.8725441355561371, 'loss_val': 0.5323119033503275, 'psi': 0.7560100942895251}
[S8] START round=18 head_norm_before_train=1.706169 cos_to_last_merge=0.8434 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.843
[S8] round=18 local utility u=0.000000 metrics={'f1_val': 0.9829227792597723, 'auprc': 0.9992880199375515, 'loss_val': 0.058828873299658746, 'psi': 0.9894688755308839}-{'f1_val': 0.9932593276801964, 'auprc': 0.999034014797644, 'loss_val': 0.040629219331851346, 'psi': 0.9955692025271754}
[S9] START round=18 head_norm_before_train=0.868692 cos_to_last_merge=1.0000 (last merge round=17)
[S9] round=18 local utility u=0.378270 metrics={'f1_val': 0.8288589939627435, 'auprc': 0.9995875057114577, 'loss_val': 0.3421195661197769, 'psi': 0.8971503986622292}-{'f1_val': 0.7012165807733519, 'auprc': 0.9982159857187324, 'loss_val': 0.32868978124608106, 'psi': 0.8200163427515041}
[S10] START round=18 head_norm_before_train=1.912350 (no previous merge yet)
[S10] round=18 local utility u=0.000535 metrics={'f1_val': 0.9957210358491089, 'auprc': 0.9965078136653286, 'loss_val': 0.029987386774185065, 'psi': 0.9960357469755967}-{'f1_val': 0.9957210358491089, 'auprc': 0.9965065725917995, 'loss_val': 0.031052904169155186, 'psi': 0.9960352505461851}
[S11] START round=18 head_norm_before_train=1.003546 cos_to_last_merge=0.9960 (last merge round=16)
[S11] round=18 local utility u=0.000000 metrics={'f1_val': 0.702134836243133, 'auprc': 0.9982928913302855, 'loss_val': 0.4518288391585249, 'psi': 0.820598058277994}-{'f1_val': 0.9535720775450554, 'auprc': 0.9966480194881753, 'loss_val': 0.5493980383574787, 'psi': 0.9708024543223033}
[S13] START round=18 head_norm_before_train=1.492612 cos_to_last_merge=0.8826 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.883
[S13] round=18 local utility u=0.185728 metrics={'f1_val': 0.602819943117025, 'auprc': 0.7055280209984697, 'loss_val': 0.7485563623752093, 'psi': 0.6439031742696029}-{'f1_val': 0.5587145240408673, 'auprc': 0.697978308311891, 'loss_val': 0.8327314721695328, 'psi': 0.6144200377492768}
[S14] START round=18 head_norm_before_train=1.263689 cos_to_last_merge=1.0000 (last merge round=17)
[S14] round=18 local utility u=0.041409 metrics={'f1_val': 0.997673454559638, 'auprc': 0.9956337632553806, 'loss_val': 0.27024970459372166, 'psi': 0.996857578037935}-{'f1_val': 0.9969473164239916, 'auprc': 0.9956358893165702, 'loss_val': 0.34871649416812717, 'psi': 0.9964227455810231}
[S15] START round=18 head_norm_before_train=1.619892 cos_to_last_merge=0.8164 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.816
[S15] round=18 local utility u=0.000000 metrics={'f1_val': 0.7884143271804558, 'auprc': 0.9928813105666779, 'loss_val': 0.30277654945646915, 'psi': 0.8702011205349447}-{'f1_val': 0.9792725652417421, 'auprc': 0.9977260258847925, 'loss_val': 0.08665615311823954, 'psi': 0.9866539494989622}
[S16] START round=18 head_norm_before_train=0.897436 cos_to_last_merge=1.0000 (last merge round=17)
[S16] round=18 local utility u=0.074401 metrics={'f1_val': 0.840899703423551, 'auprc': 0.9838470814073017, 'loss_val': 0.7064083904421717, 'psi': 0.8980786546170514}-{'f1_val': 0.8270122243340622, 'auprc': 0.9130594069204795, 'loss_val': 0.5595233173623477, 'psi': 0.8614310973686291}
[S17] START round=18 head_norm_before_train=1.895313 (no previous merge yet)
[S17] round=18 local utility u=0.000000 metrics={'f1_val': 0.5151124652710474, 'auprc': 0.6883640689238629, 'loss_val': 1.454151711976261, 'psi': 0.5844131067321736}-{'f1_val': 0.594906470793579, 'auprc': 0.8787553679600497, 'loss_val': 1.0859482715765385, 'psi': 0.7084460296601672}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:58310
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:58314
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:58312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:58304
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1797) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.007875)
[S4] loaded HEAD from S6 (vec_in norm=1.007875)
[S4] cosine check vs S6: cos=0.8205
[S4] BUFFERED delta from S6 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1796) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.926099)
[S14] loaded HEAD from S9 (vec_in norm=0.926099)
[S14] cosine check vs S9: cos=0.5631
[S14] BUFFERED delta from S9 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1800) from S14
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.309158)
[S5] loaded HEAD from S14 (vec_in norm=1.309158)
[S5] cosine check vs S14: cos=0.7846
[S5] BUFFERED delta from S14 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1802) from S13
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.510731)
[S9] loaded HEAD from S13 (vec_in norm=1.510731)
[S9] cosine check vs S13: cos=0.4507
[S9] BUFFERED delta from S13 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1799) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.936425)
[S5] loaded HEAD from S10 (vec_in norm=1.936425)
[S5] cosine check vs S10: cos=0.3356
[S5] BUFFERED delta from S10 (total buffered=2)
[S11] RECEIVED delta(kind=head bytes=1799) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.139408)
[S11] loaded HEAD from S4 (vec_in norm=1.139408)
[S11] cosine check vs S4: cos=0.8742
[S11] BUFFERED delta from S4 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1803) from S3
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.780789)
[S5] loaded HEAD from S3 (vec_in norm=1.780789)
[S5] cosine check vs S3: cos=0.2044
[S5] BUFFERED delta from S3 (total buffered=3)
[S5] RECEIVED delta(kind=head bytes=1802) from S2
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.857936)
[S5] loaded HEAD from S2 (vec_in norm=1.857936)
[S5] cosine check vs S2: cos=-0.0571
[S5] DROPPED delta from S2 (cos=-0.0571 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:58307
[S16] sending update (kind=head size=1802 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1802) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.955855)
[S6] loaded HEAD from S16 (vec_in norm=0.955855)
[S6] cosine check vs S16: cos=0.9393
[S6] BUFFERED delta from S16 (total buffered=1)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=18 metric=0.7021 head_norm=1.046115
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.777366e-01
[S11] stored merged vector for next round verification (round=18)
[S11] DEBUG after merge:  round=18 metric=0.7088 head_norm=1.057907 delta_norm=0.277737
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=18 metric=0.7966 head_norm=1.007875
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.729669e-01
[S6] stored merged vector for next round verification (round=18)
[S6] DEBUG after merge:  round=18 metric=0.7932 head_norm=0.966860 delta_norm=0.172967
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=18 metric=0.9421 head_norm=1.139408
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.277206e-01
[S4] stored merged vector for next round verification (round=18)
[S4] DEBUG after merge:  round=18 metric=0.9431 head_norm=1.024515 delta_norm=0.327721
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=18 metric=0.9977 head_norm=1.309158
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.490966e-01
[S14] stored merged vector for next round verification (round=18)
[S14] DEBUG after merge:  round=18 metric=0.9977 head_norm=0.992104 delta_norm=0.549097
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=18 metric=0.8289 head_norm=0.926099
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.853753e-01
[S9] stored merged vector for next round verification (round=18)
[S9] DEBUG after merge:  round=18 metric=0.9848 head_norm=1.048925 delta_norm=0.685375
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=18 metric=0.7006 head_norm=0.875619
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.043095e-01
[S5] stored merged vector for next round verification (round=18)
[S5] DEBUG after merge:  round=18 metric=0.7006 head_norm=0.846097 delta_norm=0.304310
[S5] aggregate: ACCEPT kept=['S14', 'S10', 'S3'] (k=3/3) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.857936 (no previous merge yet)
[S2] round=19 local utility u=0.000000 metrics={'f1_val': 0.63568909001359, 'auprc': 0.6946914990849444, 'loss_val': 1.2827885248705406, 'psi': 0.6592900536421318}-{'f1_val': 0.6578593378395151, 'auprc': 0.7189743782885616, 'loss_val': 1.0948720012952808, 'psi': 0.6823053540191337}
[S3] START round=19 head_norm_before_train=1.780789 (no previous merge yet)
[S3] round=19 local utility u=0.000000 metrics={'f1_val': 0.960995754132836, 'auprc': 0.9968220162708595, 'loss_val': 0.10401394331619807, 'psi': 0.9753262589880455}-{'f1_val': 0.9868095683361822, 'auprc': 0.9970510596713703, 'loss_val': 0.104306630456834, 'psi': 0.9909061648702575}
[S4] START round=19 head_norm_before_train=1.024515 cos_to_last_merge=1.0000 (last merge round=18)
[S4] round=19 local utility u=0.000000 metrics={'f1_val': 0.9479771884843256, 'auprc': 0.9590642234993966, 'loss_val': 0.3513828243244068, 'psi': 0.952412002490354}-{'f1_val': 0.9420774604903279, 'auprc': 0.961748815212536, 'loss_val': 0.32228881587865377, 'psi': 0.9499460023792112}
[S5] START round=19 head_norm_before_train=0.846097 cos_to_last_merge=1.0000 (last merge round=18)
[S5] round=19 local utility u=0.385809 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9903891267355776, 'loss_val': 0.46584272586255315, 'psi': 0.8163484411545793}-{'f1_val': 0.7006083926626743, 'auprc': 0.7729136804043923, 'loss_val': 0.5867561621872295, 'psi': 0.7295305077593615}
[S6] START round=19 head_norm_before_train=0.966860 cos_to_last_merge=1.0000 (last merge round=18)
[S6] round=19 local utility u=0.158955 metrics={'f1_val': 0.8242579999322431, 'auprc': 0.968804071358107, 'loss_val': 0.4559579762056432, 'psi': 0.8820764285025886}-{'f1_val': 0.796597492522471, 'auprc': 0.948121811181798, 'loss_val': 0.545857750349335, 'psi': 0.8572072199862018}
[S7] START round=19 head_norm_before_train=1.685047 cos_to_last_merge=0.9998 (last merge round=17)
[S7] round=19 local utility u=0.730971 metrics={'f1_val': 0.5891368848999883, 'auprc': 0.789486013821004, 'loss_val': 0.6795012894169993, 'psi': 0.6692765364683946}-{'f1_val': 0.40278610933789916, 'auprc': 0.7767351469630672, 'loss_val': 0.9850869179020556, 'psi': 0.5523657243879664}
[S8] START round=19 head_norm_before_train=1.731940 cos_to_last_merge=0.8408 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.841
[S8] round=19 local utility u=0.033750 metrics={'f1_val': 0.9914482382097267, 'auprc': 0.9990281411552253, 'loss_val': 0.04170237499157287, 'psi': 0.9944801993879262}-{'f1_val': 0.9829227792597723, 'auprc': 0.9992880199375515, 'loss_val': 0.058828873299658746, 'psi': 0.9894688755308839}
[S9] START round=19 head_norm_before_train=1.048925 cos_to_last_merge=1.0000 (last merge round=18)
[S9] round=19 local utility u=0.519687 metrics={'f1_val': 0.9941832549489744, 'auprc': 0.9981493710902082, 'loss_val': 0.29037606589776993, 'psi': 0.9957697014054678}-{'f1_val': 0.8288589939627435, 'auprc': 0.9995875057114577, 'loss_val': 0.3421195661197769, 'psi': 0.8971503986622292}
[S10] START round=19 head_norm_before_train=1.936425 (no previous merge yet)
[S10] round=19 local utility u=0.000657 metrics={'f1_val': 0.9957210358491089, 'auprc': 0.9965019743685263, 'loss_val': 0.02865569095174442, 'psi': 0.9960334112568758}-{'f1_val': 0.9957210358491089, 'auprc': 0.9965078136653286, 'loss_val': 0.029987386774185065, 'psi': 0.9960357469755967}
[S11] START round=19 head_norm_before_train=1.057907 cos_to_last_merge=1.0000 (last merge round=18)
[S11] round=19 local utility u=0.224077 metrics={'f1_val': 0.7905062735379367, 'auprc': 0.9947102176371154, 'loss_val': 0.523154821387181, 'psi': 0.8721878511776082}-{'f1_val': 0.702134836243133, 'auprc': 0.9982928913302855, 'loss_val': 0.4518288391585249, 'psi': 0.820598058277994}
[S13] START round=19 head_norm_before_train=1.510731 cos_to_last_merge=0.8807 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.881
[S13] round=19 local utility u=0.216037 metrics={'f1_val': 0.646626554903359, 'auprc': 0.706274807047082, 'loss_val': 0.581563170929191, 'psi': 0.6704858557608482}-{'f1_val': 0.602819943117025, 'auprc': 0.7055280209984697, 'loss_val': 0.7485563623752093, 'psi': 0.6439031742696029}
[S14] START round=19 head_norm_before_train=0.992104 cos_to_last_merge=1.0000 (last merge round=18)
[S14] round=19 local utility u=0.000000 metrics={'f1_val': 0.9972630104447024, 'auprc': 0.9956331879951994, 'loss_val': 0.3075918388607879, 'psi': 0.9966110814649012}-{'f1_val': 0.997673454559638, 'auprc': 0.9956337632553806, 'loss_val': 0.27024970459372166, 'psi': 0.996857578037935}
[S15] START round=19 head_norm_before_train=1.652746 cos_to_last_merge=0.8139 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.814
[S15] round=19 local utility u=0.709797 metrics={'f1_val': 0.9829755198718928, 'auprc': 0.9981955377178916, 'loss_val': 0.06649203722870285, 'psi': 0.9890635270102923}-{'f1_val': 0.7884143271804558, 'auprc': 0.9928813105666779, 'loss_val': 0.30277654945646915, 'psi': 0.8702011205349447}
[S16] START round=19 head_norm_before_train=0.955855 cos_to_last_merge=0.9976 (last merge round=17)
[S16] round=19 local utility u=0.107255 metrics={'f1_val': 0.8530252836120074, 'auprc': 0.9951259974113663, 'loss_val': 0.5984884191034148, 'psi': 0.9098655691317509}-{'f1_val': 0.840899703423551, 'auprc': 0.9838470814073017, 'loss_val': 0.7064083904421717, 'psi': 0.8980786546170514}
[S17] START round=19 head_norm_before_train=1.914027 (no previous merge yet)
[S17] round=19 local utility u=0.968566 metrics={'f1_val': 0.613421166223376, 'auprc': 0.9929915065802198, 'loss_val': 1.020755068791485, 'psi': 0.7652493023661135}-{'f1_val': 0.5151124652710474, 'auprc': 0.6883640689238629, 'loss_val': 1.454151711976261, 'psi': 0.5844131067321736}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:58308
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:58316
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:58307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] → sending delta(kind=head bytes=1806) to S9@127.0.0.1:58310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:58305
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:58304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:58310
[S11] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1804 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1806 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1804) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.043919)
[S4] loaded HEAD from S6 (vec_in norm=1.043919)
[S4] cosine check vs S6: cos=0.8950
[S4] BUFFERED delta from S6 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1799) from S8
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.750577)
[S7] loaded HEAD from S8 (vec_in norm=1.750577)
[S7] cosine check vs S8: cos=0.9957
[S7] BUFFERED delta from S8 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1796) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.959193)
[S5] loaded HEAD from S10 (vec_in norm=1.959193)
[S5] cosine check vs S10: cos=0.4743
[S5] BUFFERED delta from S10 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1799) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.018939)
[S6] loaded HEAD from S16 (vec_in norm=1.018939)
[S6] cosine check vs S16: cos=0.9527
[S6] BUFFERED delta from S16 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1802) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.896435)
[S16] loaded HEAD from S5 (vec_in norm=0.896435)
[S16] cosine check vs S5: cos=0.8744
[S16] BUFFERED delta from S5 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1800) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.096383)
[S14] loaded HEAD from S9 (vec_in norm=1.096383)
[S14] cosine check vs S9: cos=0.8916
[S14] BUFFERED delta from S9 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1802) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.679579)
[S5] loaded HEAD from S15 (vec_in norm=1.679579)
[S5] cosine check vs S15: cos=0.3073
[S5] BUFFERED delta from S15 (total buffered=2)
[S14] RECEIVED delta(kind=head bytes=1801) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.693635)
[S14] loaded HEAD from S7 (vec_in norm=1.693635)
[S14] cosine check vs S7: cos=0.7953
[S14] BUFFERED delta from S7 (total buffered=2)
[S9] RECEIVED delta(kind=head bytes=1798) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.089130)
[S9] loaded HEAD from S11 (vec_in norm=1.089130)
[S9] cosine check vs S11: cos=0.4723
[S9] BUFFERED delta from S11 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1806) from S13
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.522777)
[S9] loaded HEAD from S13 (vec_in norm=1.522777)
[S9] cosine check vs S13: cos=0.8986
[S9] BUFFERED delta from S13 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:58310
[S17] sending update (kind=head size=1798 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1798) from S17
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.928312)
[S9] loaded HEAD from S17 (vec_in norm=1.928312)
[S9] cosine check vs S17: cos=0.2031
[S9] BUFFERED delta from S17 (total buffered=3)
[S3] r=20 psi=0.975 u=0.0000 p_local=0.2020 f1=0.961 auprc=0.997 bytes=18001
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=19 metric=0.9973 head_norm=1.042185
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.877132e-01
[S14] stored merged vector for next round verification (round=19)
[S14] DEBUG after merge:  round=19 metric=0.9973 head_norm=1.137554 delta_norm=0.287713
[S14] aggregate: ACCEPT kept=['S9', 'S7'] (k=2/2) mode=median trim_p=0.1
[S14] r=20 psi=0.997 u=0.0000 p_local=0.1717 f1=0.997 auprc=0.996 bytes=25138
[S2] r=20 psi=0.659 u=0.0000 p_local=0.0779 f1=0.636 auprc=0.695 bytes=10809
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=19 metric=0.9480 head_norm=1.104279
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.478728e-01
[S4] stored merged vector for next round verification (round=19)
[S4] DEBUG after merge:  round=19 metric=0.9482 head_norm=1.045542 delta_norm=0.247873
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] r=20 psi=0.952 u=0.0000 p_local=0.0615 f1=0.948 auprc=0.959 bytes=17994
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=19 metric=0.8530 head_norm=1.018939
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.472437e-01
[S16] stored merged vector for next round verification (round=19)
[S16] DEBUG after merge:  round=19 metric=0.8474 head_norm=0.927247 delta_norm=0.247244
[S16] aggregate: ROLLBACK (f1_val pre=0.853 post=0.847 tol_abs=0.005 tol_rel=0.0)
[S16] r=20 psi=0.910 u=0.1073 p_local=0.2122 f1=0.853 auprc=0.995 bytes=23372
[S11] r=20 psi=0.872 u=0.2241 p_local=0.2173 f1=0.791 auprc=0.995 bytes=19759
[S9] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=19 metric=0.9942 head_norm=1.096383
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.062157e-01
[S9] stored merged vector for next round verification (round=19)
[S9] DEBUG after merge:  round=19 metric=0.9904 head_norm=0.950342 delta_norm=0.306216
[S9] aggregate: ACCEPT kept=['S11', 'S13', 'S17'] (k=3/3) mode=median trim_p=0.1
[S9] r=20 psi=0.996 u=0.5197 p_local=0.2402 f1=0.994 auprc=0.998 bytes=25162
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=19 metric=0.7003 head_norm=0.896435
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.445747e-01
[S5] stored merged vector for next round verification (round=19)
[S5] DEBUG after merge:  round=19 metric=0.7003 head_norm=1.031206 delta_norm=0.644575
[S5] aggregate: ACCEPT kept=['S10', 'S15'] (k=2/2) mode=median trim_p=0.1
[S5] r=20 psi=0.816 u=0.3858 p_local=0.2043 f1=0.700 auprc=0.990 bytes=19743
[S8] r=20 psi=0.994 u=0.0337 p_local=0.1635 f1=0.991 auprc=0.999 bytes=21613
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=19 metric=0.8243 head_norm=1.043919
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.590585e-01
[S6] stored merged vector for next round verification (round=19)
[S6] DEBUG after merge:  round=19 metric=0.8241 head_norm=1.019167 delta_norm=0.159059
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S6] r=20 psi=0.882 u=0.1590 p_local=0.2741 f1=0.824 auprc=0.969 bytes=21567
[S13] r=20 psi=0.670 u=0.2160 p_local=0.1259 f1=0.647 auprc=0.706 bytes=19813
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=19 metric=0.5891 head_norm=1.693635
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.436947e-02
[S7] stored merged vector for next round verification (round=19)
[S7] DEBUG after merge:  round=19 metric=0.6107 head_norm=1.720274 delta_norm=0.084369
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S7] r=20 psi=0.669 u=0.7310 p_local=0.3188 f1=0.589 auprc=0.789 bytes=21579
[S10] r=20 psi=0.996 u=0.0007 p_local=0.0495 f1=0.996 auprc=0.997 bytes=26990
[S15] r=20 psi=0.989 u=0.7098 p_local=0.3039 f1=0.983 auprc=0.998 bytes=21568
[S17] r=20 psi=0.765 u=0.9686 p_local=0.2738 f1=0.613 auprc=0.993 bytes=19763
[S2] START round=20 head_norm_before_train=1.875253 (no previous merge yet)
[S2] round=20 local utility u=0.211383 metrics={'f1_val': 0.6698726994946208, 'auprc': 0.714464951734333, 'loss_val': 1.1244445577012203, 'psi': 0.6877096003905057}-{'f1_val': 0.63568909001359, 'auprc': 0.6946914990849444, 'loss_val': 1.2827885248705406, 'psi': 0.6592900536421318}
[S3] START round=20 head_norm_before_train=1.797937 (no previous merge yet)
[S3] round=20 local utility u=0.128859 metrics={'f1_val': 0.9973670153333725, 'auprc': 0.9986324557564407, 'loss_val': 0.06995523460614322, 'psi': 0.9978731915025998}-{'f1_val': 0.960995754132836, 'auprc': 0.9968220162708595, 'loss_val': 0.10401394331619807, 'psi': 0.9753262589880455}
[S4] START round=20 head_norm_before_train=1.045542 cos_to_last_merge=1.0000 (last merge round=19)
[S4] round=20 local utility u=0.000000 metrics={'f1_val': 0.9407558771321404, 'auprc': 0.955825179438029, 'loss_val': 0.3814162300101716, 'psi': 0.9467835980544959}-{'f1_val': 0.9479771884843256, 'auprc': 0.9590642234993966, 'loss_val': 0.3513828243244068, 'psi': 0.952412002490354}
[S5] START round=20 head_norm_before_train=1.031206 cos_to_last_merge=1.0000 (last merge round=19)
[S5] round=20 local utility u=0.000000 metrics={'f1_val': 0.6295165993227608, 'auprc': 0.8126243523089003, 'loss_val': 0.6526017149330271, 'psi': 0.7027597005172166}-{'f1_val': 0.7003213174339138, 'auprc': 0.9903891267355776, 'loss_val': 0.46584272586255315, 'psi': 0.8163484411545793}
[S6] START round=20 head_norm_before_train=1.019167 cos_to_last_merge=1.0000 (last merge round=19)
[S6] round=20 local utility u=0.000000 metrics={'f1_val': 0.8233355151846027, 'auprc': 0.9675616986077474, 'loss_val': 0.4731774003540041, 'psi': 0.8810259885538605}-{'f1_val': 0.8242579999322431, 'auprc': 0.968804071358107, 'loss_val': 0.4559579762056432, 'psi': 0.8820764285025886}
[S7] START round=20 head_norm_before_train=1.720274 cos_to_last_merge=1.0000 (last merge round=19)
[S7] round=20 local utility u=0.000000 metrics={'f1_val': 0.4820526695529628, 'auprc': 0.7797622672272392, 'loss_val': 0.8938399100817778, 'psi': 0.6011365086226733}-{'f1_val': 0.5891368848999883, 'auprc': 0.789486013821004, 'loss_val': 0.6795012894169993, 'psi': 0.6692765364683946}
[S8] START round=20 head_norm_before_train=1.750577 cos_to_last_merge=0.8386 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.839
[S8] round=20 local utility u=0.005463 metrics={'f1_val': 0.9925380579155019, 'auprc': 0.9990481613033434, 'loss_val': 0.03737439252148331, 'psi': 0.9951420992706386}-{'f1_val': 0.9914482382097267, 'auprc': 0.9990281411552253, 'loss_val': 0.04170237499157287, 'psi': 0.9944801993879262}
[S9] START round=20 head_norm_before_train=0.950342 cos_to_last_merge=1.0000 (last merge round=19)
[S9] round=20 local utility u=0.015532 metrics={'f1_val': 0.9895530216146718, 'auprc': 0.9993174173599819, 'loss_val': 0.23503399451388385, 'psi': 0.9934587799127959}-{'f1_val': 0.9941832549489744, 'auprc': 0.9981493710902082, 'loss_val': 0.29037606589776993, 'psi': 0.9957697014054678}
[S10] START round=20 head_norm_before_train=1.959193 (no previous merge yet)
[S10] round=20 local utility u=0.000000 metrics={'f1_val': 0.9955259082574451, 'auprc': 0.9964835439963564, 'loss_val': 0.02841377582804105, 'psi': 0.9959089625530096}-{'f1_val': 0.9957210358491089, 'auprc': 0.9965019743685263, 'loss_val': 0.02865569095174442, 'psi': 0.9960334112568758}
[S11] START round=20 head_norm_before_train=1.089130 cos_to_last_merge=0.9971 (last merge round=18)
[S11] round=20 local utility u=0.547302 metrics={'f1_val': 0.9513503066611694, 'auprc': 0.9986077219480679, 'loss_val': 0.4053073804869787, 'psi': 0.9702532727759288}-{'f1_val': 0.7905062735379367, 'auprc': 0.9947102176371154, 'loss_val': 0.523154821387181, 'psi': 0.8721878511776082}
[S13] START round=20 head_norm_before_train=1.522777 cos_to_last_merge=0.8794 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.879
[S13] round=20 local utility u=0.000000 metrics={'f1_val': 0.603883098569065, 'auprc': 0.7173440455088302, 'loss_val': 0.8661464153331978, 'psi': 0.649267477344971}-{'f1_val': 0.646626554903359, 'auprc': 0.706274807047082, 'loss_val': 0.581563170929191, 'psi': 0.6704858557608482}
[S14] START round=20 head_norm_before_train=1.137554 cos_to_last_merge=1.0000 (last merge round=19)
[S14] round=20 local utility u=0.042637 metrics={'f1_val': 0.9976516241010662, 'auprc': 0.9969763919858747, 'loss_val': 0.22867957372429792, 'psi': 0.9973815312549896}-{'f1_val': 0.9972630104447024, 'auprc': 0.9956331879951994, 'loss_val': 0.3075918388607879, 'psi': 0.9966110814649012}
[S15] START round=20 head_norm_before_train=1.679579 cos_to_last_merge=0.8116 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.812
[S15] round=20 local utility u=0.056364 metrics={'f1_val': 0.9965606190356983, 'auprc': 0.9979364264180286, 'loss_val': 0.03449630716122375, 'psi': 0.9971109419886304}-{'f1_val': 0.9829755198718928, 'auprc': 0.9981955377178916, 'loss_val': 0.06649203722870285, 'psi': 0.9890635270102923}
[S16] START round=20 head_norm_before_train=0.927247 cos_to_last_merge=1.0000 (last merge round=19)
[S16] round=20 local utility u=0.374710 metrics={'f1_val': 0.936924539771367, 'auprc': 0.9949469128345325, 'loss_val': 0.3519260802361385, 'psi': 0.9601334889966332}-{'f1_val': 0.8530252836120074, 'auprc': 0.9951259974113663, 'loss_val': 0.5984884191034148, 'psi': 0.9098655691317509}
[S17] START round=20 head_norm_before_train=1.928312 (no previous merge yet)
[S17] round=20 local utility u=0.000000 metrics={'f1_val': 0.6086488445136424, 'auprc': 0.9261409574140917, 'loss_val': 1.117585449369477, 'psi': 0.7356456896738222}-{'f1_val': 0.613421166223376, 'auprc': 0.9929915065802198, 'loss_val': 1.020755068791485, 'psi': 0.7652493023661135}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:58307
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S8] → sending delta(kind=head bytes=1808) to S7@127.0.0.1:58308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:58305
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:58310
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1808 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1802) from S14
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.190758)
[S5] loaded HEAD from S14 (vec_in norm=1.190758)
[S5] cosine check vs S14: cos=0.3481
[S5] BUFFERED delta from S14 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1798) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.991301)
[S6] loaded HEAD from S16 (vec_in norm=0.991301)
[S6] cosine check vs S16: cos=0.9459
[S6] BUFFERED delta from S16 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1799) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.012660)
[S14] loaded HEAD from S9 (vec_in norm=1.012660)
[S14] cosine check vs S9: cos=0.8788
[S14] BUFFERED delta from S9 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1808) from S8
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.769321)
[S7] loaded HEAD from S8 (vec_in norm=1.769321)
[S7] cosine check vs S8: cos=0.9984
[S7] BUFFERED delta from S8 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1800) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.127389)
[S9] loaded HEAD from S11 (vec_in norm=1.127389)
[S9] cosine check vs S11: cos=0.5994
[S9] BUFFERED delta from S11 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1799) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.705730)
[S5] loaded HEAD from S15 (vec_in norm=1.705730)
[S5] cosine check vs S15: cos=0.6734
[S5] BUFFERED delta from S15 (total buffered=2)
[S5] RECEIVED delta(kind=head bytes=1799) from S3
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.819969)
[S5] loaded HEAD from S3 (vec_in norm=1.819969)
[S5] cosine check vs S3: cos=0.2138
[S5] BUFFERED delta from S3 (total buffered=3)
[S5] RECEIVED delta(kind=head bytes=1803) from S2
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.888556)
[S5] loaded HEAD from S2 (vec_in norm=1.888556)
[S5] cosine check vs S2: cos=-0.0062
[S5] DROPPED delta from S2 (cos=-0.0062 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] ⇄ pheromone p=0.049 → S11@127.0.0.1:58312
[S10] ⇄ pheromone p=0.040 → S5@127.0.0.1:58305
[S13] ⇄ pheromone p=0.101 → S9@127.0.0.1:58310
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=20 metric=0.4821 head_norm=1.726196
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.440575e-02
[S7] stored merged vector for next round verification (round=20)
[S7] DEBUG after merge:  round=20 metric=0.5004 head_norm=1.747045 delta_norm=0.054406
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.255 → S14@127.0.0.1:58314
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=20 metric=0.8233 head_norm=1.080404
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.759324e-01
[S6] stored merged vector for next round verification (round=20)
[S6] DEBUG after merge:  round=20 metric=0.8232 head_norm=1.021774 delta_norm=0.175932
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.219 → S4@127.0.0.1:58304
[S5] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=20 metric=0.6295 head_norm=1.066055
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.005678e-01
[S5] stored merged vector for next round verification (round=20)
[S5] DEBUG after merge:  round=20 metric=0.6480 head_norm=0.914563 delta_norm=0.400568
[S5] aggregate: ACCEPT kept=['S14', 'S15', 'S3'] (k=3/3) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.163 → S16@127.0.0.1:58316
[S2] ⇄ pheromone p=0.105 → S5@127.0.0.1:58305
[S11] ⇄ pheromone p=0.283 → S9@127.0.0.1:58310
[S16] ⇄ pheromone p=0.245 → S6@127.0.0.1:58307
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=20 metric=0.9977 head_norm=1.190758
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.845626e-01
[S14] stored merged vector for next round verification (round=20)
[S14] DEBUG after merge:  round=20 metric=0.9977 head_norm=1.068043 delta_norm=0.284563
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.146 → S5@127.0.0.1:58305
[S8] ⇄ pheromone p=0.132 → S7@127.0.0.1:58308
[S3] ⇄ pheromone p=0.187 → S5@127.0.0.1:58305
[S15] ⇄ pheromone p=0.254 → S5@127.0.0.1:58305
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=20 metric=0.9896 head_norm=1.012660
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.816556e-01
[S9] stored merged vector for next round verification (round=20)
[S9] DEBUG after merge:  round=20 metric=0.9593 head_norm=0.957210 delta_norm=0.481656
[S9] aggregate: ROLLBACK (f1_val pre=0.990 post=0.959 tol_abs=0.005 tol_rel=0.0)
[S9] ⇄ pheromone p=0.195 → S14@127.0.0.1:58314
[S17] ⇄ pheromone p=0.219 → S9@127.0.0.1:58310
[S2] START round=21 head_norm_before_train=1.888556 (no previous merge yet)
[S2] round=21 local utility u=0.000000 metrics={'f1_val': 0.6223828156406778, 'auprc': 0.7275096753923329, 'loss_val': 1.50664286256916, 'psi': 0.6644335595413398}-{'f1_val': 0.6698726994946208, 'auprc': 0.714464951734333, 'loss_val': 1.1244445577012203, 'psi': 0.6877096003905057}
[S3] START round=21 head_norm_before_train=1.819969 (no previous merge yet)
[S3] round=21 local utility u=0.000000 metrics={'f1_val': 0.9606109340814555, 'auprc': 0.9972705626755022, 'loss_val': 0.11769027483233505, 'psi': 0.9752747855190742}-{'f1_val': 0.9973670153333725, 'auprc': 0.9986324557564407, 'loss_val': 0.06995523460614322, 'psi': 0.9978731915025998}
[S4] START round=21 head_norm_before_train=1.121733 cos_to_last_merge=0.9916 (last merge round=19)
[S4] round=21 local utility u=0.077293 metrics={'f1_val': 0.9473259990139905, 'auprc': 0.9669398565599956, 'loss_val': 0.2995949406522461, 'psi': 0.9551715420323925}-{'f1_val': 0.9407558771321404, 'auprc': 0.955825179438029, 'loss_val': 0.3814162300101716, 'psi': 0.9467835980544959}
[S5] START round=21 head_norm_before_train=0.914563 cos_to_last_merge=1.0000 (last merge round=20)
[S5] round=21 local utility u=0.233441 metrics={'f1_val': 0.6623989092242408, 'auprc': 0.8675650809040258, 'loss_val': 0.5478351894688162, 'psi': 0.7444653778961547}-{'f1_val': 0.6295165993227608, 'auprc': 0.8126243523089003, 'loss_val': 0.6526017149330271, 'psi': 0.7027597005172166}
[S6] START round=21 head_norm_before_train=1.021774 cos_to_last_merge=1.0000 (last merge round=20)
[S6] round=21 local utility u=0.000000 metrics={'f1_val': 0.8230451709199044, 'auprc': 0.963979821594127, 'loss_val': 0.4792486172321925, 'psi': 0.8794190311895934}-{'f1_val': 0.8233355151846027, 'auprc': 0.9675616986077474, 'loss_val': 0.4731774003540041, 'psi': 0.8810259885538605}
[S7] START round=21 head_norm_before_train=1.747045 cos_to_last_merge=1.0000 (last merge round=20)
[S7] round=21 local utility u=0.596242 metrics={'f1_val': 0.6284058960373082, 'auprc': 0.7960924048673333, 'loss_val': 0.6284659544014092, 'psi': 0.6954804995693182}-{'f1_val': 0.4820526695529628, 'auprc': 0.7797622672272392, 'loss_val': 0.8938399100817778, 'psi': 0.6011365086226733}
[S8] START round=21 head_norm_before_train=1.769321 cos_to_last_merge=0.8371 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.837
[S8] round=21 local utility u=0.003272 metrics={'f1_val': 0.9932593276801964, 'auprc': 0.9989585413115637, 'loss_val': 0.03488842954648564, 'psi': 0.9955390131327433}-{'f1_val': 0.9925380579155019, 'auprc': 0.9990481613033434, 'loss_val': 0.03737439252148331, 'psi': 0.9951420992706386}
[S9] START round=21 head_norm_before_train=0.957210 cos_to_last_merge=1.0000 (last merge round=20)
[S9] round=21 local utility u=0.010070 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9973354224287309, 'loss_val': 0.2515926539414824, 'psi': 0.9969304760598272}-{'f1_val': 0.9895530216146718, 'auprc': 0.9993174173599819, 'loss_val': 0.23503399451388385, 'psi': 0.9934587799127959}
[S10] START round=21 head_norm_before_train=1.980060 (no previous merge yet)
[S10] round=21 local utility u=0.000000 metrics={'f1_val': 0.9948838907637279, 'auprc': 0.9964924904833468, 'loss_val': 0.027881520952422502, 'psi': 0.9955273306515755}-{'f1_val': 0.9955259082574451, 'auprc': 0.9964835439963564, 'loss_val': 0.02841377582804105, 'psi': 0.9959089625530096}
[S11] START round=21 head_norm_before_train=1.127389 cos_to_last_merge=0.9897 (last merge round=18)
[S11] round=21 local utility u=0.000000 metrics={'f1_val': 0.7913240271381143, 'auprc': 0.9957609644262526, 'loss_val': 0.32054713387822087, 'psi': 0.8730988020533696}-{'f1_val': 0.9513503066611694, 'auprc': 0.9986077219480679, 'loss_val': 0.4053073804869787, 'psi': 0.9702532727759288}
[S13] START round=21 head_norm_before_train=1.530259 cos_to_last_merge=0.8786 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.879
[S13] round=21 local utility u=0.138431 metrics={'f1_val': 0.6086970178672372, 'auprc': 0.7292160726775763, 'loss_val': 0.6537832135569797, 'psi': 0.6569046397913728}-{'f1_val': 0.603883098569065, 'auprc': 0.7173440455088302, 'loss_val': 0.8661464153331978, 'psi': 0.649267477344971}
[S14] START round=21 head_norm_before_train=1.068043 cos_to_last_merge=1.0000 (last merge round=20)
[S14] round=21 local utility u=0.000000 metrics={'f1_val': 0.9668651254257795, 'auprc': 0.9938792430397296, 'loss_val': 0.2470156298120877, 'psi': 0.9776707724713596}-{'f1_val': 0.9976516241010662, 'auprc': 0.9969763919858747, 'loss_val': 0.22867957372429792, 'psi': 0.9973815312549896}
[S15] START round=21 head_norm_before_train=1.705730 cos_to_last_merge=0.8093 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.809
[S15] round=21 local utility u=0.000000 metrics={'f1_val': 0.9014957201159066, 'auprc': 0.9955792473698699, 'loss_val': 0.2424333916042137, 'psi': 0.939129131017492}-{'f1_val': 0.9965606190356983, 'auprc': 0.9979364264180286, 'loss_val': 0.03449630716122375, 'psi': 0.9971109419886304}
[S16] START round=21 head_norm_before_train=0.991301 cos_to_last_merge=0.9977 (last merge round=19)
[S16] round=21 local utility u=0.000000 metrics={'f1_val': 0.8401120504361673, 'auprc': 0.9473129430427152, 'loss_val': 0.4652859535185429, 'psi': 0.8829924074787865}-{'f1_val': 0.936924539771367, 'auprc': 0.9949469128345325, 'loss_val': 0.3519260802361385, 'psi': 0.9601334889966332}
[S17] START round=21 head_norm_before_train=1.943530 (no previous merge yet)
[S17] round=21 local utility u=0.000000 metrics={'f1_val': 0.5915846887684659, 'auprc': 0.8283991112022209, 'loss_val': 1.310161533953383, 'psi': 0.6863104577419679}-{'f1_val': 0.6086488445136424, 'auprc': 0.9261409574140917, 'loss_val': 1.117585449369477, 'psi': 0.7356456896738222}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:58314
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S7@127.0.0.1:58308
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:58310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:58312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:58316
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:58314
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1805 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1805) from S8
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.788828)
[S7] loaded HEAD from S8 (vec_in norm=1.788828)
[S7] cosine check vs S8: cos=0.9991
[S7] BUFFERED delta from S8 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1795) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.950394)
[S16] loaded HEAD from S5 (vec_in norm=0.950394)
[S16] cosine check vs S5: cos=0.9232
[S16] BUFFERED delta from S5 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1802) from S13
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.537393)
[S9] loaded HEAD from S13 (vec_in norm=1.537393)
[S9] cosine check vs S13: cos=0.4740
[S9] BUFFERED delta from S13 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1802) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.207854)
[S11] loaded HEAD from S4 (vec_in norm=1.207854)
[S11] cosine check vs S4: cos=0.8471
[S11] BUFFERED delta from S4 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1803) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.016160)
[S14] loaded HEAD from S9 (vec_in norm=1.016160)
[S14] cosine check vs S9: cos=0.8105
[S14] BUFFERED delta from S9 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1802) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.755553)
[S14] loaded HEAD from S7 (vec_in norm=1.755553)
[S14] cosine check vs S7: cos=0.7824
[S14] BUFFERED delta from S7 (total buffered=2)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=21 metric=0.9669 head_norm=1.121755
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.998672e-01
[S14] stored merged vector for next round verification (round=21)
[S14] DEBUG after merge:  round=21 metric=0.9641 head_norm=1.127972 delta_norm=0.199867
[S14] aggregate: ACCEPT kept=['S9', 'S7'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=21 metric=0.7913 head_norm=1.173541
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.296633e-01
[S11] stored merged vector for next round verification (round=21)
[S11] DEBUG after merge:  round=21 metric=0.9512 head_norm=1.144280 delta_norm=0.329663
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=21 metric=0.9967 head_norm=1.016160
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.919692e-01
[S9] stored merged vector for next round verification (round=21)
[S9] DEBUG after merge:  round=21 metric=0.9967 head_norm=1.104200 delta_norm=0.691969
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=21 metric=0.6284 head_norm=1.755553
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.188064e-02
[S7] stored merged vector for next round verification (round=21)
[S7] DEBUG after merge:  round=21 metric=0.6341 head_norm=1.771774 delta_norm=0.041881
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=21 metric=0.8401 head_norm=1.056486
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.033913e-01
[S16] stored merged vector for next round verification (round=21)
[S16] DEBUG after merge:  round=21 metric=0.8551 head_norm=0.984042 delta_norm=0.203391
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.901795 (no previous merge yet)
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.6021514889731316, 'auprc': 0.7146164161692142, 'loss_val': 1.486692983717244, 'psi': 0.6471374598515647}-{'f1_val': 0.6223828156406778, 'auprc': 0.7275096753923329, 'loss_val': 1.50664286256916, 'psi': 0.6644335595413398}
[S3] START round=22 head_norm_before_train=1.843711 (no previous merge yet)
[S3] round=22 local utility u=0.109383 metrics={'f1_val': 0.9902759094770461, 'auprc': 0.9971954009031014, 'loss_val': 0.07668859421108142, 'psi': 0.9930437060474683}-{'f1_val': 0.9606109340814555, 'auprc': 0.9972705626755022, 'loss_val': 0.11769027483233505, 'psi': 0.9752747855190742}
[S4] START round=22 head_norm_before_train=1.207854 cos_to_last_merge=0.9750 (last merge round=19)
[S4] round=22 local utility u=0.000000 metrics={'f1_val': 0.9433392691301637, 'auprc': 0.9519913947510059, 'loss_val': 0.2778064670558709, 'psi': 0.9468001193785007}-{'f1_val': 0.9473259990139905, 'auprc': 0.9669398565599956, 'loss_val': 0.2995949406522461, 'psi': 0.9551715420323925}
[S5] START round=22 head_norm_before_train=0.950394 cos_to_last_merge=0.9980 (last merge round=20)
[S5] round=22 local utility u=0.077529 metrics={'f1_val': 0.6810729046472216, 'auprc': 0.8518325441916255, 'loss_val': 0.45762413482462794, 'psi': 0.7493767604649831}-{'f1_val': 0.6623989092242408, 'auprc': 0.8675650809040258, 'loss_val': 0.5478351894688162, 'psi': 0.7444653778961547}
[S6] START round=22 head_norm_before_train=1.086270 cos_to_last_merge=0.9943 (last merge round=20)
[S6] round=22 local utility u=0.000000 metrics={'f1_val': 0.7599259017870509, 'auprc': 0.9404762872521812, 'loss_val': 0.5550355410134499, 'psi': 0.8321460559731031}-{'f1_val': 0.8230451709199044, 'auprc': 0.963979821594127, 'loss_val': 0.4792486172321925, 'psi': 0.8794190311895934}
[S7] START round=22 head_norm_before_train=1.771774 cos_to_last_merge=1.0000 (last merge round=21)
[S7] round=22 local utility u=0.030775 metrics={'f1_val': 0.6327874317980584, 'auprc': 0.7994337503273696, 'loss_val': 0.6032293286824677, 'psi': 0.6994459592097828}-{'f1_val': 0.6284058960373082, 'auprc': 0.7960924048673333, 'loss_val': 0.6284659544014092, 'psi': 0.6954804995693182}
[S8] START round=22 head_norm_before_train=1.788828 cos_to_last_merge=0.8356 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.836
[S8] round=22 local utility u=0.000000 metrics={'f1_val': 0.9889241575992487, 'auprc': 0.9990168963712843, 'loss_val': 0.04168971819365451, 'psi': 0.9929612531080629}-{'f1_val': 0.9932593276801964, 'auprc': 0.9989585413115637, 'loss_val': 0.03488842954648564, 'psi': 0.9955390131327433}
[S9] START round=22 head_norm_before_train=1.104200 cos_to_last_merge=1.0000 (last merge round=21)
[S9] round=22 local utility u=0.000000 metrics={'f1_val': 0.9878532334303461, 'auprc': 0.9992204205871659, 'loss_val': 0.2163810858317696, 'psi': 0.992400108293074}-{'f1_val': 0.9966605118138915, 'auprc': 0.9973354224287309, 'loss_val': 0.2515926539414824, 'psi': 0.9969304760598272}
[S10] START round=22 head_norm_before_train=1.992599 (no previous merge yet)
[S10] round=22 local utility u=0.000257 metrics={'f1_val': 0.9948838907637279, 'auprc': 0.9964880502197558, 'loss_val': 0.02735472785978511, 'psi': 0.9955255545461391}-{'f1_val': 0.9948838907637279, 'auprc': 0.9964924904833468, 'loss_val': 0.027881520952422502, 'psi': 0.9955273306515755}
[S11] START round=22 head_norm_before_train=1.144280 cos_to_last_merge=1.0000 (last merge round=21)
[S11] round=22 local utility u=0.457536 metrics={'f1_val': 0.9572318957473441, 'auprc': 0.9984440641187151, 'loss_val': 0.4089707960831051, 'psi': 0.9737167630958925}-{'f1_val': 0.7913240271381143, 'auprc': 0.9957609644262526, 'loss_val': 0.32054713387822087, 'psi': 0.8730988020533696}
[S13] START round=22 head_norm_before_train=1.537393 cos_to_last_merge=0.8777 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.878
[S13] round=22 local utility u=0.013808 metrics={'f1_val': 0.6343822088908566, 'auprc': 0.7447940581521545, 'loss_val': 0.8270124452893111, 'psi': 0.6785469485953757}-{'f1_val': 0.6086970178672372, 'auprc': 0.7292160726775763, 'loss_val': 0.6537832135569797, 'psi': 0.6569046397913728}
[S14] START round=22 head_norm_before_train=1.127972 cos_to_last_merge=1.0000 (last merge round=21)
[S14] round=22 local utility u=0.124924 metrics={'f1_val': 0.9974535255208126, 'auprc': 0.9954097435180598, 'loss_val': 0.18528958851012314, 'psi': 0.9966360127197115}-{'f1_val': 0.9668651254257795, 'auprc': 0.9938792430397296, 'loss_val': 0.2470156298120877, 'psi': 0.9776707724713596}
[S15] START round=22 head_norm_before_train=1.729382 cos_to_last_merge=0.8072 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.807
[S15] round=22 local utility u=0.331849 metrics={'f1_val': 0.9804639082021529, 'auprc': 0.999225757477388, 'loss_val': 0.0634844639525229, 'psi': 0.9879686479122469}-{'f1_val': 0.9014957201159066, 'auprc': 0.9955792473698699, 'loss_val': 0.2424333916042137, 'psi': 0.939129131017492}
[S16] START round=22 head_norm_before_train=0.984042 cos_to_last_merge=1.0000 (last merge round=21)
[S16] round=22 local utility u=0.301002 metrics={'f1_val': 0.9089673894619559, 'auprc': 0.9881707983231101, 'loss_val': 0.3989878243529952, 'psi': 0.9406487530064176}-{'f1_val': 0.8401120504361673, 'auprc': 0.9473129430427152, 'loss_val': 0.4652859535185429, 'psi': 0.8829924074787865}
[S17] START round=22 head_norm_before_train=1.956823 (no previous merge yet)
[S17] round=22 local utility u=0.260134 metrics={'f1_val': 0.6021161685095853, 'auprc': 0.9445563452307993, 'loss_val': 1.2015549163602885, 'psi': 0.7390922391980709}-{'f1_val': 0.5915846887684659, 'auprc': 0.8283991112022209, 'loss_val': 1.310161533953383, 'psi': 0.6863104577419679}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S15] → sending delta(kind=head bytes=1806) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S11] → sending delta(kind=head bytes=1807) to S9@127.0.0.1:58310
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:58316
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:58310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:58307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:58305
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1805 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1793 to 1 peers)
[S15] sending update (kind=head size=1806 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1807 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1804) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.781170)
[S14] loaded HEAD from S7 (vec_in norm=1.781170)
[S14] cosine check vs S7: cos=0.8582
[S14] BUFFERED delta from S7 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1807) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.181112)
[S9] loaded HEAD from S11 (vec_in norm=1.181112)
[S9] cosine check vs S11: cos=0.5386
[S9] BUFFERED delta from S11 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1802) from S13
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.551139)
[S9] loaded HEAD from S13 (vec_in norm=1.551139)
[S9] cosine check vs S13: cos=0.8976
[S9] BUFFERED delta from S13 (total buffered=2)
[S5] RECEIVED delta(kind=head bytes=1806) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.754956)
[S5] loaded HEAD from S15 (vec_in norm=1.754956)
[S5] cosine check vs S15: cos=0.6922
[S5] BUFFERED delta from S15 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1798) from S14
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.181713)
[S5] loaded HEAD from S14 (vec_in norm=1.181713)
[S5] cosine check vs S14: cos=0.5600
[S5] BUFFERED delta from S14 (total buffered=2)
[S16] RECEIVED delta(kind=head bytes=1793) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.994439)
[S16] loaded HEAD from S5 (vec_in norm=0.994439)
[S16] cosine check vs S5: cos=0.9708
[S16] BUFFERED delta from S5 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1805) from S3
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.866109)
[S5] loaded HEAD from S3 (vec_in norm=1.866109)
[S5] cosine check vs S3: cos=0.4151
[S5] BUFFERED delta from S3 (total buffered=3)
[S6] RECEIVED delta(kind=head bytes=1798) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.043731)
[S6] loaded HEAD from S16 (vec_in norm=1.043731)
[S6] cosine check vs S16: cos=0.9453
[S6] BUFFERED delta from S16 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1801) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=2.007481)
[S5] loaded HEAD from S10 (vec_in norm=2.007481)
[S5] cosine check vs S10: cos=0.5210
[S5] BUFFERED delta from S10 (total buffered=4)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:58310
[S17] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1800) from S17
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.964474)
[S9] loaded HEAD from S17 (vec_in norm=1.964474)
[S9] cosine check vs S17: cos=0.1833
[S9] BUFFERED delta from S17 (total buffered=3)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=22 metric=0.7599 head_norm=1.156397
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.901421e-01
[S6] stored merged vector for next round verification (round=22)
[S6] DEBUG after merge:  round=22 metric=0.7547 head_norm=1.084970 delta_norm=0.190142
[S6] aggregate: ROLLBACK (f1_val pre=0.760 post=0.755 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=22 metric=0.9879 head_norm=1.154477
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.197719e-01
[S9] stored merged vector for next round verification (round=22)
[S9] DEBUG after merge:  round=22 metric=0.9879 head_norm=1.009092 delta_norm=0.319772
[S9] aggregate: ACCEPT kept=['S11', 'S13', 'S17'] (k=3/3) mode=median trim_p=0.1
[S5] aggregate: batch=4 kept=4 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=22 metric=0.6811 head_norm=0.994439
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.137086e-01
[S5] stored merged vector for next round verification (round=22)
[S5] DEBUG after merge:  round=22 metric=0.7004 head_norm=0.960557 delta_norm=0.113709
[S5] aggregate: ACCEPT kept=['S15', 'S14', 'S3', 'S10'] (k=4/4) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=22 metric=0.9975 head_norm=1.181713
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.889485e-01
[S14] stored merged vector for next round verification (round=22)
[S14] DEBUG after merge:  round=22 metric=0.9975 head_norm=1.430187 delta_norm=0.488948
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=22 metric=0.9090 head_norm=1.043731
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.255678e-01
[S16] stored merged vector for next round verification (round=22)
[S16] DEBUG after merge:  round=22 metric=0.9016 head_norm=1.011620 delta_norm=0.125568
[S16] aggregate: ROLLBACK (f1_val pre=0.909 post=0.902 tol_abs=0.005 tol_rel=0.0)
[S2] START round=23 head_norm_before_train=1.914135 (no previous merge yet)
[S2] round=23 local utility u=0.337334 metrics={'f1_val': 0.665273632247016, 'auprc': 0.726255913297871, 'loss_val': 1.2256757217102054, 'psi': 0.689666544667358}-{'f1_val': 0.6021514889731316, 'auprc': 0.7146164161692142, 'loss_val': 1.486692983717244, 'psi': 0.6471374598515647}
[S3] START round=23 head_norm_before_train=1.866109 (no previous merge yet)
[S3] round=23 local utility u=0.035711 metrics={'f1_val': 0.9971122502560278, 'auprc': 0.997647121258976, 'loss_val': 0.047640125948144735, 'psi': 0.9973261986572071}-{'f1_val': 0.9902759094770461, 'auprc': 0.9971954009031014, 'loss_val': 0.07668859421108142, 'psi': 0.9930437060474683}
[S4] START round=23 head_norm_before_train=1.290897 cos_to_last_merge=0.9586 (last merge round=19)
[S4] round=23 local utility u=0.015187 metrics={'f1_val': 0.9425325220952571, 'auprc': 0.9604733363009454, 'loss_val': 0.2680384262651938, 'psi': 0.9497088477775324}-{'f1_val': 0.9433392691301637, 'auprc': 0.9519913947510059, 'loss_val': 0.2778064670558709, 'psi': 0.9468001193785007}
[S5] START round=23 head_norm_before_train=0.960557 cos_to_last_merge=1.0000 (last merge round=22)
[S5] round=23 local utility u=0.229775 metrics={'f1_val': 0.7003603281361598, 'auprc': 0.951958364402463, 'loss_val': 0.4141758335397992, 'psi': 0.800999542642681}-{'f1_val': 0.6810729046472216, 'auprc': 0.8518325441916255, 'loss_val': 0.45762413482462794, 'psi': 0.7493767604649831}
[S6] START round=23 head_norm_before_train=1.084970 cos_to_last_merge=1.0000 (last merge round=22)
[S6] round=23 local utility u=0.286168 metrics={'f1_val': 0.8230451709199044, 'auprc': 0.9677742976563684, 'loss_val': 0.4433083380738821, 'psi': 0.8809368216144899}-{'f1_val': 0.7599259017870509, 'auprc': 0.9404762872521812, 'loss_val': 0.5550355410134499, 'psi': 0.8321460559731031}
[S7] START round=23 head_norm_before_train=1.781170 cos_to_last_merge=0.9999 (last merge round=21)
[S7] round=23 local utility u=0.000000 metrics={'f1_val': 0.536967502679634, 'auprc': 0.7842342342606267, 'loss_val': 0.8450616201718425, 'psi': 0.635874195312031}-{'f1_val': 0.6327874317980584, 'auprc': 0.7994337503273696, 'loss_val': 0.6032293286824677, 'psi': 0.6994459592097828}
[S8] START round=23 head_norm_before_train=1.805105 cos_to_last_merge=0.8346 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.835
[S8] round=23 local utility u=0.001500 metrics={'f1_val': 0.9892831449862951, 'auprc': 0.9991003945187127, 'loss_val': 0.04109383113312336, 'psi': 0.9932100447992621}-{'f1_val': 0.9889241575992487, 'auprc': 0.9990168963712843, 'loss_val': 0.04168971819365451, 'psi': 0.9929612531080629}
[S9] START round=23 head_norm_before_train=1.009092 cos_to_last_merge=1.0000 (last merge round=22)
[S9] round=23 local utility u=0.039942 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.99741223699904, 'loss_val': 0.18157915485406217, 'psi': 0.9967275122378597}-{'f1_val': 0.9878532334303461, 'auprc': 0.9992204205871659, 'loss_val': 0.2163810858317696, 'psi': 0.992400108293074}
[S10] START round=23 head_norm_before_train=2.007481 (no previous merge yet)
[S10] round=23 local utility u=0.000093 metrics={'f1_val': 0.9948838907637279, 'auprc': 0.9964955430503966, 'loss_val': 0.027191400932916904, 'psi': 0.9955285516783954}-{'f1_val': 0.9948838907637279, 'auprc': 0.9964880502197558, 'loss_val': 0.02735472785978511, 'psi': 0.9955255545461391}
[S11] START round=23 head_norm_before_train=1.181112 cos_to_last_merge=0.9978 (last merge round=21)
[S11] round=23 local utility u=0.178864 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9964605537087156, 'loss_val': 0.2822352161106943, 'psi': 0.9966176732323955}-{'f1_val': 0.9572318957473441, 'auprc': 0.9984440641187151, 'loss_val': 0.4089707960831051, 'psi': 0.9737167630958925}
[S13] START round=23 head_norm_before_train=1.551139 cos_to_last_merge=0.8763 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.876
[S13] round=23 local utility u=0.222561 metrics={'f1_val': 0.6889580766007422, 'auprc': 0.741083339442512, 'loss_val': 0.6982131957327953, 'psi': 0.7098081817374501}-{'f1_val': 0.6343822088908566, 'auprc': 0.7447940581521545, 'loss_val': 0.8270124452893111, 'psi': 0.6785469485953757}
[S14] START round=23 head_norm_before_train=1.430187 cos_to_last_merge=1.0000 (last merge round=22)
[S14] round=23 local utility u=0.031501 metrics={'f1_val': 0.9974830777164877, 'auprc': 0.9963039094399488, 'loss_val': 0.12514707077173776, 'psi': 0.9970114104058722}-{'f1_val': 0.9974535255208126, 'auprc': 0.9954097435180598, 'loss_val': 0.18528958851012314, 'psi': 0.9966360127197115}
[S15] START round=23 head_norm_before_train=1.754956 cos_to_last_merge=0.8050 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.805
[S15] round=23 local utility u=0.000000 metrics={'f1_val': 0.9185382388758088, 'auprc': 0.9965092615036804, 'loss_val': 0.09876228264807033, 'psi': 0.9497266479269575}-{'f1_val': 0.9804639082021529, 'auprc': 0.999225757477388, 'loss_val': 0.0634844639525229, 'psi': 0.9879686479122469}
[S16] START round=23 head_norm_before_train=1.011620 cos_to_last_merge=1.0000 (last merge round=22)
[S16] round=23 local utility u=0.000000 metrics={'f1_val': 0.8783817878977963, 'auprc': 0.9942014537828046, 'loss_val': 0.4296968604718444, 'psi': 0.9247096542517996}-{'f1_val': 0.9089673894619559, 'auprc': 0.9881707983231101, 'loss_val': 0.3989878243529952, 'psi': 0.9406487530064176}
[S17] START round=23 head_norm_before_train=1.964474 (no previous merge yet)
[S17] round=23 local utility u=0.110425 metrics={'f1_val': 0.6198811312355262, 'auprc': 0.9567523558094075, 'loss_val': 1.1238829450424124, 'psi': 0.7546296210650788}-{'f1_val': 0.6021161685095853, 'auprc': 0.9445563452307993, 'loss_val': 1.2015549163602885, 'psi': 0.7390922391980709}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S11] → sending delta(kind=head bytes=1807) to S4@127.0.0.1:58304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:58312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S3] sending update (kind=head size=1807 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:58316
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:58307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] sending update (kind=head size=1792 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:58315
[S5] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1805 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1807 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1798) from S9
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.061525)
[S11] loaded HEAD from S9 (vec_in norm=1.061525)
[S11] cosine check vs S9: cos=0.6587
[S11] BUFFERED delta from S9 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1805) from S4
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.356150)
[S6] loaded HEAD from S4 (vec_in norm=1.356150)
[S6] cosine check vs S4: cos=0.8322
[S6] BUFFERED delta from S4 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1802) from S6
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.141567)
[S16] loaded HEAD from S6 (vec_in norm=1.141567)
[S16] cosine check vs S6: cos=0.9668
[S16] BUFFERED delta from S6 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1807) from S11
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.226763)
[S4] loaded HEAD from S11 (vec_in norm=1.226763)
[S4] cosine check vs S11: cos=0.9394
[S4] BUFFERED delta from S11 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1800) from S5
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.003178)
[S15] loaded HEAD from S5 (vec_in norm=1.003178)
[S15] cosine check vs S5: cos=0.6954
[S15] BUFFERED delta from S5 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] sending update (kind=head size=1794 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:58308
[S14] sending update (kind=head size=1803 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1803) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.475112)
[S7] loaded HEAD from S14 (vec_in norm=1.475112)
[S7] cosine check vs S14: cos=0.9729
[S7] BUFFERED delta from S14 (total buffered=1)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=23 metric=0.9425 head_norm=1.356150
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.335889e-01
[S4] stored merged vector for next round verification (round=23)
[S4] DEBUG after merge:  round=23 metric=0.9425 head_norm=1.271802 delta_norm=0.233589
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=23 metric=0.8230 head_norm=1.141567
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.760777e-01
[S6] stored merged vector for next round verification (round=23)
[S6] DEBUG after merge:  round=23 metric=0.8230 head_norm=1.195711 delta_norm=0.376078
[S6] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=23 metric=0.5370 head_norm=1.790604
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.463770e-01
[S7] stored merged vector for next round verification (round=23)
[S7] DEBUG after merge:  round=23 metric=0.5376 head_norm=1.621853 delta_norm=0.246377
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=23 metric=0.9185 head_norm=1.780055
[S15] _apply_head_vector_avg (torch): Δ‖w‖=6.502879e-01
[S15] stored merged vector for next round verification (round=23)
[S15] DEBUG after merge:  round=23 metric=0.9154 head_norm=1.290196 delta_norm=0.650288
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=23 metric=0.9967 head_norm=1.226763
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.786144e-01
[S11] stored merged vector for next round verification (round=23)
[S11] DEBUG after merge:  round=23 metric=0.9963 head_norm=1.042506 delta_norm=0.478614
[S11] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=23 metric=0.8784 head_norm=1.070522
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.467200e-01
[S16] stored merged vector for next round verification (round=23)
[S16] DEBUG after merge:  round=23 metric=0.8743 head_norm=1.096845 delta_norm=0.146720
[S16] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.926631 (no previous merge yet)
[S2] round=24 local utility u=0.087885 metrics={'f1_val': 0.6780611925962521, 'auprc': 0.7271001004072634, 'loss_val': 1.12916339521585, 'psi': 0.6976767557206567}-{'f1_val': 0.665273632247016, 'auprc': 0.726255913297871, 'loss_val': 1.2256757217102054, 'psi': 0.689666544667358}
[S3] START round=24 head_norm_before_train=1.889676 (no previous merge yet)
[S3] round=24 local utility u=0.000000 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9557591934505733, 'loss_val': 0.3677381232304959, 'psi': 0.8027122531794302}-{'f1_val': 0.9971122502560278, 'auprc': 0.997647121258976, 'loss_val': 0.047640125948144735, 'psi': 0.9973261986572071}
[S4] START round=24 head_norm_before_train=1.271802 cos_to_last_merge=1.0000 (last merge round=23)
[S4] round=24 local utility u=0.000000 metrics={'f1_val': 0.9407468196812927, 'auprc': 0.9577051960835644, 'loss_val': 0.2747223525486518, 'psi': 0.9475301702422014}-{'f1_val': 0.9425325220952571, 'auprc': 0.9604733363009454, 'loss_val': 0.2680384262651938, 'psi': 0.9497088477775324}
[S5] START round=24 head_norm_before_train=1.003178 cos_to_last_merge=0.9982 (last merge round=22)
[S5] round=24 local utility u=0.055764 metrics={'f1_val': 0.7000725525005456, 'auprc': 0.9688701205465227, 'loss_val': 0.3516562568052033, 'psi': 0.8075915797189364}-{'f1_val': 0.7003603281361598, 'auprc': 0.951958364402463, 'loss_val': 0.4141758335397992, 'psi': 0.800999542642681}
[S6] START round=24 head_norm_before_train=1.195711 cos_to_last_merge=1.0000 (last merge round=23)
[S6] round=24 local utility u=0.000000 metrics={'f1_val': 0.822598037353951, 'auprc': 0.9578694741324868, 'loss_val': 0.4400179282378954, 'psi': 0.8767066120653653}-{'f1_val': 0.8230451709199044, 'auprc': 0.9677742976563684, 'loss_val': 0.4433083380738821, 'psi': 0.8809368216144899}
[S7] START round=24 head_norm_before_train=1.621853 cos_to_last_merge=1.0000 (last merge round=23)
[S7] round=24 local utility u=0.000000 metrics={'f1_val': 0.4050635441272131, 'auprc': 0.7795083246125217, 'loss_val': 1.0700144673360426, 'psi': 0.5548414563213365}-{'f1_val': 0.536967502679634, 'auprc': 0.7842342342606267, 'loss_val': 0.8450616201718425, 'psi': 0.635874195312031}
[S8] START round=24 head_norm_before_train=1.815975 cos_to_last_merge=0.8335 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.834
[S8] round=24 local utility u=0.017181 metrics={'f1_val': 0.9941000136901317, 'auprc': 0.9984827057801111, 'loss_val': 0.0337806028956067, 'psi': 0.9958530905261234}-{'f1_val': 0.9892831449862951, 'auprc': 0.9991003945187127, 'loss_val': 0.04109383113312336, 'psi': 0.9932100447992621}
[S9] START round=24 head_norm_before_train=1.061525 cos_to_last_merge=0.9977 (last merge round=22)
[S9] round=24 local utility u=0.000000 metrics={'f1_val': 0.9887042205730695, 'auprc': 0.9964590045437098, 'loss_val': 0.14857869633307172, 'psi': 0.9918061341613257}-{'f1_val': 0.9962710290637395, 'auprc': 0.99741223699904, 'loss_val': 0.18157915485406217, 'psi': 0.9967275122378597}
[S10] START round=24 head_norm_before_train=2.017069 (no previous merge yet)
[S10] round=24 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9964907592874227, 'loss_val': 0.02699011234851473, 'psi': 0.9954454692465926}-{'f1_val': 0.9948838907637279, 'auprc': 0.9964955430503966, 'loss_val': 0.027191400932916904, 'psi': 0.9955285516783954}
[S11] START round=24 head_norm_before_train=1.042506 cos_to_last_merge=1.0000 (last merge round=23)
[S11] round=24 local utility u=0.000000 metrics={'f1_val': 0.989119248788934, 'auprc': 0.9990148472012822, 'loss_val': 0.3253596444992775, 'psi': 0.9930774881538732}-{'f1_val': 0.9967224195815153, 'auprc': 0.9964605537087156, 'loss_val': 0.2822352161106943, 'psi': 0.9966176732323955}
[S13] START round=24 head_norm_before_train=1.568213 cos_to_last_merge=0.8743 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.874
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.6727794726231651, 'auprc': 0.7320232796684886, 'loss_val': 0.7541373175158784, 'psi': 0.6964769954412945}-{'f1_val': 0.6889580766007422, 'auprc': 0.741083339442512, 'loss_val': 0.6982131957327953, 'psi': 0.7098081817374501}
[S14] START round=24 head_norm_before_train=1.475112 cos_to_last_merge=0.9992 (last merge round=22)
[S14] round=24 local utility u=0.004704 metrics={'f1_val': 0.9970233560109115, 'auprc': 0.9921215312425684, 'loss_val': 0.10043347567456265, 'psi': 0.9950626261035743}-{'f1_val': 0.9974830777164877, 'auprc': 0.9963039094399488, 'loss_val': 0.12514707077173776, 'psi': 0.9970114104058722}
[S15] START round=24 head_norm_before_train=1.290196 cos_to_last_merge=1.0000 (last merge round=23)
[S15] round=24 local utility u=0.000000 metrics={'f1_val': 0.7884894732267411, 'auprc': 0.9243750008170682, 'loss_val': 0.3256201697288939, 'psi': 0.8428436842628719}-{'f1_val': 0.9185382388758088, 'auprc': 0.9965092615036804, 'loss_val': 0.09876228264807033, 'psi': 0.9497266479269575}
[S16] START round=24 head_norm_before_train=1.096845 cos_to_last_merge=1.0000 (last merge round=23)
[S16] round=24 local utility u=0.288494 metrics={'f1_val': 0.9390760048682134, 'auprc': 0.9943137971223152, 'loss_val': 0.21721210985509007, 'psi': 0.9611711217698542}-{'f1_val': 0.8783817878977963, 'auprc': 0.9942014537828046, 'loss_val': 0.4296968604718444, 'psi': 0.9247096542517996}
[S17] START round=24 head_norm_before_train=1.972885 (no previous merge yet)
[S17] round=24 local utility u=0.000000 metrics={'f1_val': 0.6428981696124256, 'auprc': 0.8013769617477737, 'loss_val': 0.9698000974305384, 'psi': 0.7062896864665649}-{'f1_val': 0.6198811312355262, 'auprc': 0.9567523558094075, 'loss_val': 1.1238829450424124, 'psi': 0.7546296210650788}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] → sending delta(kind=head bytes=1792) to S15@127.0.0.1:58315
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:58305
[S14] not sending this round → trigger blocked (psi=0.995)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1792 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1795) from S16
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.152760)
[S5] loaded HEAD from S16 (vec_in norm=1.152760)
[S5] cosine check vs S16: cos=0.9634
[S5] BUFFERED delta from S16 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1792) from S5
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.044764)
[S15] loaded HEAD from S5 (vec_in norm=1.044764)
[S15] cosine check vs S5: cos=0.8529
[S15] BUFFERED delta from S5 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=24 metric=0.7001 head_norm=1.044764
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.579100e-01
[S5] stored merged vector for next round verification (round=24)
[S5] DEBUG after merge:  round=24 metric=0.7001 head_norm=1.088695 delta_norm=0.157910
[S5] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=24 metric=0.7885 head_norm=1.334701
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.515589e-01
[S15] stored merged vector for next round verification (round=24)
[S15] DEBUG after merge:  round=24 metric=0.7831 head_norm=1.145812 delta_norm=0.351559
[S15] aggregate: ROLLBACK (f1_val pre=0.788 post=0.783 tol_abs=0.005 tol_rel=0.0)
[S2] START round=25 head_norm_before_train=1.933786 (no previous merge yet)
[S2] round=25 local utility u=0.000000 metrics={'f1_val': 0.6714010920403973, 'auprc': 0.7247649411517633, 'loss_val': 1.1477667430697658, 'psi': 0.6927466316849438}-{'f1_val': 0.6780611925962521, 'auprc': 0.7271001004072634, 'loss_val': 1.12916339521585, 'psi': 0.6976767557206567}
[S3] START round=25 head_norm_before_train=1.907670 (no previous merge yet)
[S3] round=25 local utility u=1.000000 metrics={'f1_val': 0.9973982357793907, 'auprc': 0.9988594853190937, 'loss_val': 0.04608255432562124, 'psi': 0.997982735595272}-{'f1_val': 0.7006809596653347, 'auprc': 0.9557591934505733, 'loss_val': 0.3677381232304959, 'psi': 0.8027122531794302}
[S4] START round=25 head_norm_before_train=1.318606 cos_to_last_merge=0.9996 (last merge round=23)
[S4] round=25 local utility u=0.038027 metrics={'f1_val': 0.9419452036597928, 'auprc': 0.9760547339357818, 'loss_val': 0.260907653429838, 'psi': 0.9555890157701885}-{'f1_val': 0.9407468196812927, 'auprc': 0.9577051960835644, 'loss_val': 0.2747223525486518, 'psi': 0.9475301702422014}
[S5] START round=25 head_norm_before_train=1.088695 cos_to_last_merge=1.0000 (last merge round=24)
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.7000725525005456, 'auprc': 0.9408314777649225, 'loss_val': 0.3564465122221374, 'psi': 0.7963761226062963}-{'f1_val': 0.7000725525005456, 'auprc': 0.9688701205465227, 'loss_val': 0.3516562568052033, 'psi': 0.8075915797189364}
[S6] START round=25 head_norm_before_train=1.238833 cos_to_last_merge=0.9991 (last merge round=23)
[S6] round=25 local utility u=0.391524 metrics={'f1_val': 0.9191632036754367, 'auprc': 0.9702599890636466, 'loss_val': 0.27353320591920555, 'psi': 0.9396019178307207}-{'f1_val': 0.822598037353951, 'auprc': 0.9578694741324868, 'loss_val': 0.4400179282378954, 'psi': 0.8767066120653653}
[S7] START round=25 head_norm_before_train=1.628174 cos_to_last_merge=0.9999 (last merge round=23)
[S7] round=25 local utility u=1.000000 metrics={'f1_val': 0.6831980145772676, 'auprc': 0.8860079338265773, 'loss_val': 0.41371112099471957, 'psi': 0.7643219822769916}-{'f1_val': 0.4050635441272131, 'auprc': 0.7795083246125217, 'loss_val': 1.0700144673360426, 'psi': 0.5548414563213365}
[S8] START round=25 head_norm_before_train=1.828094 cos_to_last_merge=0.8320 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.832
[S8] round=25 local utility u=0.000000 metrics={'f1_val': 0.9704529147180777, 'auprc': 0.9992869508961107, 'loss_val': 0.08312860779936591, 'psi': 0.981986529189291}-{'f1_val': 0.9941000136901317, 'auprc': 0.9984827057801111, 'loss_val': 0.0337806028956067, 'psi': 0.9958530905261234}
[S9] START round=25 head_norm_before_train=1.115579 cos_to_last_merge=0.9923 (last merge round=22)
[S9] round=25 local utility u=0.040390 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9949434932835418, 'loss_val': 0.11118236191107635, 'psi': 0.995992892072274}-{'f1_val': 0.9887042205730695, 'auprc': 0.9964590045437098, 'loss_val': 0.14857869633307172, 'psi': 0.9918061341613257}
[S10] START round=25 head_norm_before_train=2.028747 (no previous merge yet)
[S10] round=25 local utility u=0.000627 metrics={'f1_val': 0.9948838907637279, 'auprc': 0.996494006369957, 'loss_val': 0.02655844762537491, 'psi': 0.9955279370062196}-{'f1_val': 0.9947486092193725, 'auprc': 0.9964907592874227, 'loss_val': 0.02699011234851473, 'psi': 0.9954454692465926}
[S11] START round=25 head_norm_before_train=1.097418 cos_to_last_merge=0.9967 (last merge round=23)
[S11] round=25 local utility u=0.076625 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9988054422000704, 'loss_val': 0.21710135801531402, 'psi': 0.9975556286289373}-{'f1_val': 0.989119248788934, 'auprc': 0.9990148472012822, 'loss_val': 0.3253596444992775, 'psi': 0.9930774881538732}
[S13] START round=25 head_norm_before_train=1.577612 cos_to_last_merge=0.8730 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.873
[S13] round=25 local utility u=0.097875 metrics={'f1_val': 0.669306904507009, 'auprc': 0.7808469629981903, 'loss_val': 0.6840219916313981, 'psi': 0.7139229279034816}-{'f1_val': 0.6727794726231651, 'auprc': 0.7320232796684886, 'loss_val': 0.7541373175158784, 'psi': 0.6964769954412945}
[S14] START round=25 head_norm_before_train=1.515597 cos_to_last_merge=0.9973 (last merge round=22)
[S14] round=25 local utility u=0.013144 metrics={'f1_val': 0.9968028443251822, 'auprc': 0.9949712791661147, 'loss_val': 0.08137187364865002, 'psi': 0.9960702182615552}-{'f1_val': 0.9970233560109115, 'auprc': 0.9921215312425684, 'loss_val': 0.10043347567456265, 'psi': 0.9950626261035743}
[S15] START round=25 head_norm_before_train=1.145812 cos_to_last_merge=1.0000 (last merge round=24)
[S15] round=25 local utility u=0.739147 metrics={'f1_val': 0.9727001093416474, 'auprc': 0.9987200414382289, 'loss_val': 0.17562499042619278, 'psi': 0.98310808218028}-{'f1_val': 0.7884894732267411, 'auprc': 0.9243750008170682, 'loss_val': 0.3256201697288939, 'psi': 0.8428436842628719}
[S16] START round=25 head_norm_before_train=1.152760 cos_to_last_merge=0.9990 (last merge round=23)
[S16] round=25 local utility u=0.025679 metrics={'f1_val': 0.9419332498888123, 'auprc': 0.9931129606779256, 'loss_val': 0.1793952579556561, 'psi': 0.9624051342044576}-{'f1_val': 0.9390760048682134, 'auprc': 0.9943137971223152, 'loss_val': 0.21721210985509007, 'psi': 0.9611711217698542}
[S17] START round=25 head_norm_before_train=1.983938 (no previous merge yet)
[S17] round=25 local utility u=0.074672 metrics={'f1_val': 0.6132457134181728, 'auprc': 0.9792302808267883, 'loss_val': 1.1761011438268647, 'psi': 0.759639540381619}-{'f1_val': 0.6428981696124256, 'auprc': 0.8013769617477737, 'loss_val': 0.9698000974305384, 'psi': 0.7062896864665649}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:58316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:58307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] sending update (kind=head size=1805 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:58304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:58312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:58305
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:58308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S7] → sending delta(kind=head bytes=1808) to S8@127.0.0.1:58309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1808 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S6] sending update (kind=head size=1805 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1799) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.551265)
[S7] loaded HEAD from S14 (vec_in norm=1.551265)
[S7] cosine check vs S14: cos=0.9856
[S7] BUFFERED delta from S14 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1799) from S16
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.200719)
[S5] loaded HEAD from S16 (vec_in norm=1.200719)
[S5] cosine check vs S16: cos=0.9857
[S5] BUFFERED delta from S16 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1802) from S11
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.162932)
[S4] loaded HEAD from S11 (vec_in norm=1.162932)
[S4] cosine check vs S11: cos=0.9061
[S4] BUFFERED delta from S11 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1802) from S9
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.161610)
[S11] loaded HEAD from S9 (vec_in norm=1.161610)
[S11] cosine check vs S9: cos=0.8508
[S11] BUFFERED delta from S9 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1808) from S7
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.633585)
[S8] loaded HEAD from S7 (vec_in norm=1.633585)
[S8] cosine check vs S7: cos=0.9913
[S8] BUFFERED delta from S7 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1804) from S4
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.361541)
[S6] loaded HEAD from S4 (vec_in norm=1.361541)
[S6] cosine check vs S4: cos=0.9221
[S6] BUFFERED delta from S4 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1805) from S6
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.276186)
[S16] loaded HEAD from S6 (vec_in norm=1.276186)
[S16] cosine check vs S6: cos=0.9208
[S16] BUFFERED delta from S6 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=25 metric=0.9705 head_norm=1.838410
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.536869e-01
[S8] stored merged vector for next round verification (round=25)
[S8] DEBUG after merge:  round=25 metric=0.9705 head_norm=1.732211 delta_norm=0.153687
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=25 metric=0.7001 head_norm=1.126312
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.050057e-01
[S5] stored merged vector for next round verification (round=25)
[S5] DEBUG after merge:  round=25 metric=0.7001 head_norm=1.159364 delta_norm=0.105006
[S5] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.119 → S15@127.0.0.1:58315
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=25 metric=0.9967 head_norm=1.162932
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.174598e-01
[S11] stored merged vector for next round verification (round=25)
[S11] DEBUG after merge:  round=25 metric=0.9967 head_norm=1.118075 delta_norm=0.317460
[S11] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.178 → S4@127.0.0.1:58304
[S14] ⇄ pheromone p=0.068 → S7@127.0.0.1:58308
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=25 metric=0.9192 head_norm=1.276186
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.636290e-01
[S6] stored merged vector for next round verification (round=25)
[S6] DEBUG after merge:  round=25 metric=0.9211 head_norm=1.292951 delta_norm=0.263629
[S6] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.187 → S16@127.0.0.1:58316
[S9] ⇄ pheromone p=0.078 → S11@127.0.0.1:58312
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=25 metric=0.9419 head_norm=1.200719
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.491939e-01
[S16] stored merged vector for next round verification (round=25)
[S16] DEBUG after merge:  round=25 metric=0.9394 head_norm=1.213709 delta_norm=0.249194
[S16] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.162 → S5@127.0.0.1:58305
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=25 metric=0.9419 head_norm=1.361541
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.902249e-01
[S4] stored merged vector for next round verification (round=25)
[S4] DEBUG after merge:  round=25 metric=0.9419 head_norm=1.232425 delta_norm=0.290225
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.032 → S6@127.0.0.1:58307
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=25 metric=0.6832 head_norm=1.633585
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.410398e-01
[S7] stored merged vector for next round verification (round=25)
[S7] DEBUG after merge:  round=25 metric=0.6832 head_norm=1.586701 delta_norm=0.141040
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.336 → S8@127.0.0.1:58309
[S2] START round=26 head_norm_before_train=1.942001 (no previous merge yet)
[S2] round=26 local utility u=0.000000 metrics={'f1_val': 0.6547158541729906, 'auprc': 0.7212377222763721, 'loss_val': 1.3459855924406847, 'psi': 0.6813246014143431}-{'f1_val': 0.6714010920403973, 'auprc': 0.7247649411517633, 'loss_val': 1.1477667430697658, 'psi': 0.6927466316849438}
[S3] START round=26 head_norm_before_train=1.920877 (no previous merge yet)
[S3] round=26 local utility u=0.002987 metrics={'f1_val': 0.9973982357793907, 'auprc': 0.9987845874016706, 'loss_val': 0.03988354800601789, 'psi': 0.9979527764283027}-{'f1_val': 0.9973982357793907, 'auprc': 0.9988594853190937, 'loss_val': 0.04608255432562124, 'psi': 0.997982735595272}
[S4] START round=26 head_norm_before_train=1.232425 cos_to_last_merge=1.0000 (last merge round=25)
[S4] round=26 local utility u=0.000000 metrics={'f1_val': 0.9410503091491685, 'auprc': 0.9580154917953012, 'loss_val': 0.26971737339190255, 'psi': 0.9478363822076216}-{'f1_val': 0.9419452036597928, 'auprc': 0.9760547339357818, 'loss_val': 0.260907653429838, 'psi': 0.9555890157701885}
[S5] START round=26 head_norm_before_train=1.159364 cos_to_last_merge=1.0000 (last merge round=25)
[S5] round=26 local utility u=0.110197 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9896791110800568, 'loss_val': 0.28408463340080325, 'psi': 0.816064003526838}-{'f1_val': 0.7000725525005456, 'auprc': 0.9408314777649225, 'loss_val': 0.3564465122221374, 'psi': 0.7963761226062963}
[S6] START round=26 head_norm_before_train=1.292951 cos_to_last_merge=1.0000 (last merge round=25)
[S6] round=26 local utility u=0.000000 metrics={'f1_val': 0.7361715649446876, 'auprc': 0.9441252582848279, 'loss_val': 0.6517178369941751, 'psi': 0.8193530422807438}-{'f1_val': 0.9191632036754367, 'auprc': 0.9702599890636466, 'loss_val': 0.27353320591920555, 'psi': 0.9396019178307207}
[S7] START round=26 head_norm_before_train=1.586701 cos_to_last_merge=1.0000 (last merge round=25)
[S7] round=26 local utility u=0.000000 metrics={'f1_val': 0.5208882878605043, 'auprc': 0.781439244628203, 'loss_val': 0.8817360829202078, 'psi': 0.6251086705675839}-{'f1_val': 0.6831980145772676, 'auprc': 0.8860079338265773, 'loss_val': 0.41371112099471957, 'psi': 0.7643219822769916}
[S8] START round=26 head_norm_before_train=1.732211 cos_to_last_merge=1.0000 (last merge round=25)
[S8] round=26 local utility u=0.088807 metrics={'f1_val': 0.9941000136901317, 'auprc': 0.9957554568611284, 'loss_val': 0.0368018542745462, 'psi': 0.9947621909585304}-{'f1_val': 0.9704529147180777, 'auprc': 0.9992869508961107, 'loss_val': 0.08312860779936591, 'psi': 0.981986529189291}
[S9] START round=26 head_norm_before_train=1.161610 cos_to_last_merge=0.9864 (last merge round=22)
[S9] round=26 local utility u=0.006356 metrics={'f1_val': 0.9937719190709611, 'auprc': 0.999291012399697, 'loss_val': 0.09398997828355742, 'psi': 0.9959795564024554}-{'f1_val': 0.9966924912647621, 'auprc': 0.9949434932835418, 'loss_val': 0.11118236191107635, 'psi': 0.995992892072274}
[S10] START round=26 head_norm_before_train=2.038491 (no previous merge yet)
[S10] round=26 local utility u=0.000112 metrics={'f1_val': 0.9948838907637279, 'auprc': 0.996494861211034, 'loss_val': 0.026337977969467668, 'psi': 0.9955282789426504}-{'f1_val': 0.9948838907637279, 'auprc': 0.996494006369957, 'loss_val': 0.02655844762537491, 'psi': 0.9955279370062196}
[S11] START round=26 head_norm_before_train=1.118075 cos_to_last_merge=1.0000 (last merge round=25)
[S11] round=26 local utility u=0.000000 metrics={'f1_val': 0.9826499872321104, 'auprc': 0.9965503907704935, 'loss_val': 0.2606601993926628, 'psi': 0.9882101486474637}-{'f1_val': 0.9967224195815153, 'auprc': 0.9988054422000704, 'loss_val': 0.21710135801531402, 'psi': 0.9975556286289373}
[S13] START round=26 head_norm_before_train=1.587832 cos_to_last_merge=0.8718 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.872
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.6352038734907941, 'auprc': 0.7517424918977128, 'loss_val': 1.053174850624535, 'psi': 0.6818193208535616}-{'f1_val': 0.669306904507009, 'auprc': 0.7808469629981903, 'loss_val': 0.6840219916313981, 'psi': 0.7139229279034816}
[S14] START round=26 head_norm_before_train=1.551265 cos_to_last_merge=0.9952 (last merge round=22)
[S14] round=26 local utility u=0.014316 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9968857329561303, 'loss_val': 0.06357277770357671, 'psi': 0.9973449640123643}-{'f1_val': 0.9968028443251822, 'auprc': 0.9949712791661147, 'loss_val': 0.08137187364865002, 'psi': 0.9960702182615552}
[S15] START round=26 head_norm_before_train=1.217410 cos_to_last_merge=0.9982 (last merge round=24)
[S15] round=26 local utility u=0.123475 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9973502372217568, 'loss_val': 0.06884552805394806, 'psi': 0.9969880959212151}-{'f1_val': 0.9727001093416474, 'auprc': 0.9987200414382289, 'loss_val': 0.17562499042619278, 'psi': 0.98310808218028}
[S16] START round=26 head_norm_before_train=1.213709 cos_to_last_merge=1.0000 (last merge round=25)
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.936088635600199, 'auprc': 0.9906637866724131, 'loss_val': 0.24573496482016344, 'psi': 0.9579186960290846}-{'f1_val': 0.9419332498888123, 'auprc': 0.9931129606779256, 'loss_val': 0.1793952579556561, 'psi': 0.9624051342044576}
[S17] START round=26 head_norm_before_train=1.995369 (no previous merge yet)
[S17] round=26 local utility u=0.102774 metrics={'f1_val': 0.6335847799891872, 'auprc': 0.9882401516058384, 'loss_val': 1.119617774292072, 'psi': 0.7754469286358476}-{'f1_val': 0.6132457134181728, 'auprc': 0.9792302808267883, 'loss_val': 1.1761011438268647, 'psi': 0.759639540381619}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:58305
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:58308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:58315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S3] sending update (kind=head size=1806 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:58308
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] → sending delta(kind=head bytes=1793) to S11@127.0.0.1:58312
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1793 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1796) from S5
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.188348)
[S15] loaded HEAD from S5 (vec_in norm=1.188348)
[S15] cosine check vs S5: cos=0.8741
[S15] BUFFERED delta from S5 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1797) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.318598)
[S5] loaded HEAD from S15 (vec_in norm=1.318598)
[S5] cosine check vs S15: cos=0.8741
[S5] BUFFERED delta from S15 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1793) from S9
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.204011)
[S11] loaded HEAD from S9 (vec_in norm=1.204011)
[S11] cosine check vs S9: cos=0.9438
[S11] BUFFERED delta from S9 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1804) from S8
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.753468)
[S7] loaded HEAD from S8 (vec_in norm=1.753468)
[S7] cosine check vs S8: cos=0.9891
[S7] BUFFERED delta from S8 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1800) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.581371)
[S7] loaded HEAD from S14 (vec_in norm=1.581371)
[S7] cosine check vs S14: cos=0.9945
[S7] BUFFERED delta from S14 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=26 metric=0.9826 head_norm=1.171224
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.996745e-01
[S11] stored merged vector for next round verification (round=26)
[S11] DEBUG after merge:  round=26 metric=0.9942 head_norm=1.170826 delta_norm=0.199675
[S11] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=26 metric=0.5209 head_norm=1.593900
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.670918e-02
[S7] stored merged vector for next round verification (round=26)
[S7] DEBUG after merge:  round=26 metric=0.5235 head_norm=1.624080 delta_norm=0.046709
[S7] aggregate: ACCEPT kept=['S8', 'S14'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=26 metric=0.9967 head_norm=1.318598
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.207579e-01
[S15] stored merged vector for next round verification (round=26)
[S15] DEBUG after merge:  round=26 metric=0.9967 head_norm=1.213487 delta_norm=0.320758
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=26 metric=0.7003 head_norm=1.188348
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.207579e-01
[S5] stored merged vector for next round verification (round=26)
[S5] DEBUG after merge:  round=26 metric=0.7003 head_norm=1.213487 delta_norm=0.320758
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.950348 (no previous merge yet)
[S2] round=27 local utility u=0.058208 metrics={'f1_val': 0.6645601698829168, 'auprc': 0.7104222925938863, 'loss_val': 1.256188979421659, 'psi': 0.6829050189673046}-{'f1_val': 0.6547158541729906, 'auprc': 0.7212377222763721, 'loss_val': 1.3459855924406847, 'psi': 0.6813246014143431}
[S3] START round=27 head_norm_before_train=1.931917 (no previous merge yet)
[S3] round=27 local utility u=0.000000 metrics={'f1_val': 0.9605709740356257, 'auprc': 0.99714057420529, 'loss_val': 0.10873741913368114, 'psi': 0.9751988141034915}-{'f1_val': 0.9973982357793907, 'auprc': 0.9987845874016706, 'loss_val': 0.03988354800601789, 'psi': 0.9979527764283027}
[S4] START round=27 head_norm_before_train=1.271865 cos_to_last_merge=0.9996 (last merge round=25)
[S4] round=27 local utility u=0.000000 metrics={'f1_val': 0.9404275584661295, 'auprc': 0.948822168735225, 'loss_val': 0.27190296166975525, 'psi': 0.9437854025737676}-{'f1_val': 0.9410503091491685, 'auprc': 0.9580154917953012, 'loss_val': 0.26971737339190255, 'psi': 0.9478363822076216}
[S5] START round=27 head_norm_before_train=1.213487 cos_to_last_merge=1.0000 (last merge round=26)
[S5] round=27 local utility u=0.000000 metrics={'f1_val': 0.7004932948021524, 'auprc': 0.9713066132250049, 'loss_val': 0.29890047529955227, 'psi': 0.8088186221712934}-{'f1_val': 0.700320598491359, 'auprc': 0.9896791110800568, 'loss_val': 0.28408463340080325, 'psi': 0.816064003526838}
[S6] START round=27 head_norm_before_train=1.322138 cos_to_last_merge=0.9996 (last merge round=25)
[S6] round=27 local utility u=0.000000 metrics={'f1_val': 0.721414017486923, 'auprc': 0.9431349078784093, 'loss_val': 0.6851890642816942, 'psi': 0.8101023736435176}-{'f1_val': 0.7361715649446876, 'auprc': 0.9441252582848279, 'loss_val': 0.6517178369941751, 'psi': 0.8193530422807438}
[S7] START round=27 head_norm_before_train=1.624080 cos_to_last_merge=1.0000 (last merge round=26)
[S7] round=27 local utility u=0.278770 metrics={'f1_val': 0.5775186443973441, 'auprc': 0.7903002952461604, 'loss_val': 0.6905605529452336, 'psi': 0.6626313047368706}-{'f1_val': 0.5208882878605043, 'auprc': 0.781439244628203, 'loss_val': 0.8817360829202078, 'psi': 0.6251086705675839}
[S8] START round=27 head_norm_before_train=1.753468 cos_to_last_merge=0.9999 (last merge round=25)
[S8] round=27 local utility u=0.000000 metrics={'f1_val': 0.9636005588515559, 'auprc': 0.9992889262599367, 'loss_val': 0.11457497937124356, 'psi': 0.9778759058149082}-{'f1_val': 0.9941000136901317, 'auprc': 0.9957554568611284, 'loss_val': 0.0368018542745462, 'psi': 0.9947621909585304}
[S9] START round=27 head_norm_before_train=1.204011 cos_to_last_merge=0.9810 (last merge round=22)
[S9] round=27 local utility u=0.016086 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9972789986260508, 'loss_val': 0.07576771605840571, 'psi': 0.997173346957706}-{'f1_val': 0.9937719190709611, 'auprc': 0.999291012399697, 'loss_val': 0.09398997828355742, 'psi': 0.9959795564024554}
[S10] START round=27 head_norm_before_train=2.047724 (no previous merge yet)
[S10] round=27 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9964950855967233, 'loss_val': 0.02621458264916656, 'psi': 0.9954471997703128}-{'f1_val': 0.9948838907637279, 'auprc': 0.996494861211034, 'loss_val': 0.026337977969467668, 'psi': 0.9955282789426504}
[S11] START round=27 head_norm_before_train=1.170826 cos_to_last_merge=1.0000 (last merge round=26)
[S11] round=27 local utility u=0.025329 metrics={'f1_val': 0.992169190564683, 'auprc': 0.9983913358987813, 'loss_val': 0.2726405846805223, 'psi': 0.9946580486983223}-{'f1_val': 0.9826499872321104, 'auprc': 0.9965503907704935, 'loss_val': 0.2606601993926628, 'psi': 0.9882101486474637}
[S13] START round=27 head_norm_before_train=1.594032 cos_to_last_merge=0.8712 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.871
[S13] round=27 local utility u=0.139184 metrics={'f1_val': 0.6556912853475465, 'auprc': 0.7160491462465308, 'loss_val': 0.7906520994043597, 'psi': 0.6798344297071403}-{'f1_val': 0.6352038734907941, 'auprc': 0.7517424918977128, 'loss_val': 1.053174850624535, 'psi': 0.6818193208535616}
[S14] START round=27 head_norm_before_train=1.581371 cos_to_last_merge=0.9932 (last merge round=22)
[S14] round=27 local utility u=0.000000 metrics={'f1_val': 0.9355604811357552, 'auprc': 0.9952358933003327, 'loss_val': 0.1553926274082136, 'psi': 0.9594306460015862}-{'f1_val': 0.9976511180498535, 'auprc': 0.9968857329561303, 'loss_val': 0.06357277770357671, 'psi': 0.9973449640123643}
[S15] START round=27 head_norm_before_train=1.213487 cos_to_last_merge=1.0000 (last merge round=26)
[S15] round=27 local utility u=0.000000 metrics={'f1_val': 0.9010248947442796, 'auprc': 0.9963151870173829, 'loss_val': 0.23769120123810278, 'psi': 0.9391410116535208}-{'f1_val': 0.9967466683875206, 'auprc': 0.9973502372217568, 'loss_val': 0.06884552805394806, 'psi': 0.9969880959212151}
[S16] START round=27 head_norm_before_train=1.253641 cos_to_last_merge=0.9996 (last merge round=25)
[S16] round=27 local utility u=0.000000 metrics={'f1_val': 0.9339769562801139, 'auprc': 0.9939969957654528, 'loss_val': 0.2615774083582959, 'psi': 0.9579849720742495}-{'f1_val': 0.936088635600199, 'auprc': 0.9906637866724131, 'loss_val': 0.24573496482016344, 'psi': 0.9579186960290846}
[S17] START round=27 head_norm_before_train=2.010565 (no previous merge yet)
[S17] round=27 local utility u=0.000000 metrics={'f1_val': 0.6245707052497422, 'auprc': 0.8496204994490629, 'loss_val': 1.0883418655691834, 'psi': 0.7145906229294705}-{'f1_val': 0.6335847799891872, 'auprc': 0.9882401516058384, 'loss_val': 1.119617774292072, 'psi': 0.7754469286358476}
[S3]  timeout peer S2
[S2]  timeout peer S3
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:58309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:58310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S9] not sending this round → trigger blocked (psi=0.997)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1805) from S7
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.633199)
[S8] loaded HEAD from S7 (vec_in norm=1.633199)
[S8] cosine check vs S7: cos=0.9906
[S8] BUFFERED delta from S7 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1797) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.219247)
[S9] loaded HEAD from S11 (vec_in norm=1.219247)
[S9] cosine check vs S11: cos=0.9739
[S9] BUFFERED delta from S11 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=27 metric=0.9636 head_norm=1.770072
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.349454e-01
[S8] stored merged vector for next round verification (round=27)
[S8] DEBUG after merge:  round=27 metric=0.9639 head_norm=1.697657 delta_norm=0.134945
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=27 metric=0.9971 head_norm=1.240136
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.408063e-01
[S9] stored merged vector for next round verification (round=27)
[S9] DEBUG after merge:  round=27 metric=0.9971 head_norm=1.221648 delta_norm=0.140806
[S9] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=1.954559 (no previous merge yet)
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.6421975572666769, 'auprc': 0.6968105738159893, 'loss_val': 1.4321430167430484, 'psi': 0.6640427638864019}-{'f1_val': 0.6645601698829168, 'auprc': 0.7104222925938863, 'loss_val': 1.256188979421659, 'psi': 0.6829050189673046}
[S3] START round=28 head_norm_before_train=1.943048 (no previous merge yet)
[S3] round=28 local utility u=0.140623 metrics={'f1_val': 0.9965655661594752, 'auprc': 0.9970765706211606, 'loss_val': 0.04326730411671951, 'psi': 0.9967699679441494}-{'f1_val': 0.9605709740356257, 'auprc': 0.99714057420529, 'loss_val': 0.10873741913368114, 'psi': 0.9751988141034915}
[S4] START round=28 head_norm_before_train=1.309131 cos_to_last_merge=0.9987 (last merge round=25)
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.9392264830803551, 'auprc': 0.9322726230375347, 'loss_val': 0.2968156911019972, 'psi': 0.9364449390632269}-{'f1_val': 0.9404275584661295, 'auprc': 0.948822168735225, 'loss_val': 0.27190296166975525, 'psi': 0.9437854025737676}
[S5] START round=28 head_norm_before_train=1.232851 cos_to_last_merge=0.9995 (last merge round=26)
[S5] round=28 local utility u=0.267445 metrics={'f1_val': 0.7740000200195235, 'auprc': 0.9863266396287141, 'loss_val': 0.25011142229973427, 'psi': 0.8589306678631998}-{'f1_val': 0.7004932948021524, 'auprc': 0.9713066132250049, 'loss_val': 0.29890047529955227, 'psi': 0.8088186221712934}
[S6] START round=28 head_norm_before_train=1.351077 cos_to_last_merge=0.9986 (last merge round=25)
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.6902860513989698, 'auprc': 0.8899035141605531, 'loss_val': 0.725856996082589, 'psi': 0.7701330365036032}-{'f1_val': 0.721414017486923, 'auprc': 0.9431349078784093, 'loss_val': 0.6851890642816942, 'psi': 0.8101023736435176}
[S7] START round=28 head_norm_before_train=1.633199 cos_to_last_merge=0.9999 (last merge round=26)
[S7] round=28 local utility u=0.388595 metrics={'f1_val': 0.6705573592770028, 'auprc': 0.8031033705708621, 'loss_val': 0.510012348268594, 'psi': 0.7235757637945466}-{'f1_val': 0.5775186443973441, 'auprc': 0.7903002952461604, 'loss_val': 0.6905605529452336, 'psi': 0.6626313047368706}
[S8] START round=28 head_norm_before_train=1.697657 cos_to_last_merge=1.0000 (last merge round=27)
[S8] round=28 local utility u=0.128861 metrics={'f1_val': 0.9936253371144965, 'auprc': 0.9990013354760059, 'loss_val': 0.03613937637545827, 'psi': 0.9957757364591002}-{'f1_val': 0.9636005588515559, 'auprc': 0.9992889262599367, 'loss_val': 0.11457497937124356, 'psi': 0.9778759058149082}
[S9] START round=28 head_norm_before_train=1.221648 cos_to_last_merge=1.0000 (last merge round=27)
[S9] round=28 local utility u=0.000481 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9995408181188363, 'loss_val': 0.07659974641420582, 'psi': 0.9975789446857782}-{'f1_val': 0.9971029125121428, 'auprc': 0.9972789986260508, 'loss_val': 0.07576771605840571, 'psi': 0.997173346957706}
[S10] START round=28 head_norm_before_train=2.052772 (no previous merge yet)
[S10] round=28 local utility u=0.001815 metrics={'f1_val': 0.9952985899745774, 'auprc': 0.9964924149894046, 'loss_val': 0.025875722170265437, 'psi': 0.9957761199805082}-{'f1_val': 0.9947486092193725, 'auprc': 0.9964950855967233, 'loss_val': 0.02621458264916656, 'psi': 0.9954471997703128}
[S11] START round=28 head_norm_before_train=1.219247 cos_to_last_merge=0.9979 (last merge round=26)
[S11] round=28 local utility u=0.053926 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9969678461776204, 'loss_val': 0.1878375156215538, 'psi': 0.9968205902199574}-{'f1_val': 0.992169190564683, 'auprc': 0.9983913358987813, 'loss_val': 0.2726405846805223, 'psi': 0.9946580486983223}
[S13] START round=28 head_norm_before_train=1.596035 cos_to_last_merge=0.8714 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.871
[S13] round=28 local utility u=0.000000 metrics={'f1_val': 0.663006893569544, 'auprc': 0.7287028529260426, 'loss_val': 0.8933275616176001, 'psi': 0.6892852773121434}-{'f1_val': 0.6556912853475465, 'auprc': 0.7160491462465308, 'loss_val': 0.7906520994043597, 'psi': 0.6798344297071403}
[S14] START round=28 head_norm_before_train=1.603175 cos_to_last_merge=0.9916 (last merge round=22)
[S14] round=28 local utility u=0.234386 metrics={'f1_val': 0.9969676997584747, 'auprc': 0.9951660669077309, 'loss_val': 0.05485468783063739, 'psi': 0.9962470466181772}-{'f1_val': 0.9355604811357552, 'auprc': 0.9952358933003327, 'loss_val': 0.1553926274082136, 'psi': 0.9594306460015862}
[S15] START round=28 head_norm_before_train=1.311315 cos_to_last_merge=0.9972 (last merge round=26)
[S15] round=28 local utility u=0.376509 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9969557197788163, 'loss_val': 0.06092595057704957, 'psi': 0.9968302889440388}-{'f1_val': 0.9010248947442796, 'auprc': 0.9963151870173829, 'loss_val': 0.23769120123810278, 'psi': 0.9391410116535208}
[S16] START round=28 head_norm_before_train=1.287820 cos_to_last_merge=0.9986 (last merge round=25)
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.8545788814867236, 'auprc': 0.9932413835934625, 'loss_val': 0.5577885819936205, 'psi': 0.9100438823294191}-{'f1_val': 0.9339769562801139, 'auprc': 0.9939969957654528, 'loss_val': 0.2615774083582959, 'psi': 0.9579849720742495}
[S17] START round=28 head_norm_before_train=2.023921 (no previous merge yet)
[S17] round=28 local utility u=0.043178 metrics={'f1_val': 0.6195787517239182, 'auprc': 0.9404931245510207, 'loss_val': 1.2446519935614277, 'psi': 0.7479445008547592}-{'f1_val': 0.6245707052497422, 'auprc': 0.8496204994490629, 'loss_val': 1.0883418655691834, 'psi': 0.7145906229294705}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:58308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] sending update (kind=head size=1792 to 1 peers)
[S7] not sending this round → trigger blocked (psi=0.724)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:58308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:58312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:58315
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:58305
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.997)
[S15] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1800) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.619477)
[S7] loaded HEAD from S14 (vec_in norm=1.619477)
[S7] cosine check vs S14: cos=0.9906
[S7] BUFFERED delta from S14 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1798) from S8
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.718838)
[S7] loaded HEAD from S8 (vec_in norm=1.718838)
[S7] cosine check vs S8: cos=0.9968
[S7] BUFFERED delta from S8 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1801) from S5
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.250588)
[S15] loaded HEAD from S5 (vec_in norm=1.250588)
[S15] cosine check vs S5: cos=0.9874
[S15] BUFFERED delta from S5 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1801) from S9
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.254940)
[S11] loaded HEAD from S9 (vec_in norm=1.254940)
[S11] cosine check vs S9: cos=0.9844
[S11] BUFFERED delta from S9 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1802) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.415016)
[S5] loaded HEAD from S15 (vec_in norm=1.415016)
[S5] cosine check vs S15: cos=0.9874
[S5] BUFFERED delta from S15 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S17] sending update (kind=head size=1792 to 1 peers)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=28 metric=0.9967 head_norm=1.272242
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.118704e-01
[S11] stored merged vector for next round verification (round=28)
[S11] DEBUG after merge:  round=28 metric=0.9967 head_norm=1.258659 delta_norm=0.111870
[S11] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=28 metric=0.6706 head_norm=1.641541
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.684563e-02
[S7] stored merged vector for next round verification (round=28)
[S7] DEBUG after merge:  round=28 metric=0.6709 head_norm=1.650562 delta_norm=0.036846
[S7] aggregate: ACCEPT kept=['S14', 'S8'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=28 metric=0.7740 head_norm=1.250588
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.339353e-01
[S5] stored merged vector for next round verification (round=28)
[S5] DEBUG after merge:  round=28 metric=0.7005 head_norm=1.328601 delta_norm=0.133935
[S5] aggregate: ROLLBACK (f1_val pre=0.774 post=0.700 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=28 metric=0.9967 head_norm=1.415016
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.339353e-01
[S15] stored merged vector for next round verification (round=28)
[S15] DEBUG after merge:  round=28 metric=0.9967 head_norm=1.328601 delta_norm=0.133935
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=1.963752 (no previous merge yet)
[S2] round=29 local utility u=0.000000 metrics={'f1_val': 0.6223956600111976, 'auprc': 0.6928098611535907, 'loss_val': 1.437026419922014, 'psi': 0.6505613404681548}-{'f1_val': 0.6421975572666769, 'auprc': 0.6968105738159893, 'loss_val': 1.4321430167430484, 'psi': 0.6640427638864019}
[S3] START round=29 head_norm_before_train=1.953338 (no previous merge yet)
[S3] round=29 local utility u=0.003365 metrics={'f1_val': 0.9978100342676263, 'auprc': 0.9972684465902355, 'loss_val': 0.04457945530604559, 'psi': 0.9975933991966699}-{'f1_val': 0.9965655661594752, 'auprc': 0.9970765706211606, 'loss_val': 0.04326730411671951, 'psi': 0.9967699679441494}
[S4] START round=29 head_norm_before_train=1.342283 cos_to_last_merge=0.9976 (last merge round=25)
[S4] round=29 local utility u=0.034972 metrics={'f1_val': 0.9405274678797301, 'auprc': 0.9461879297473981, 'loss_val': 0.2764236432101698, 'psi': 0.9427916526267972}-{'f1_val': 0.9392264830803551, 'auprc': 0.9322726230375347, 'loss_val': 0.2968156911019972, 'psi': 0.9364449390632269}
[S5] START round=29 head_norm_before_train=1.328601 cos_to_last_merge=1.0000 (last merge round=28)
[S5] round=29 local utility u=0.000000 metrics={'f1_val': 0.5633562620298618, 'auprc': 0.8225642672561284, 'loss_val': 0.7137913349976143, 'psi': 0.6670394641203684}-{'f1_val': 0.7740000200195235, 'auprc': 0.9863266396287141, 'loss_val': 0.25011142229973427, 'psi': 0.8589306678631998}
[S6] START round=29 head_norm_before_train=1.375145 cos_to_last_merge=0.9975 (last merge round=25)
[S6] round=29 local utility u=0.424700 metrics={'f1_val': 0.7732097935991306, 'auprc': 0.9553045328422042, 'loss_val': 0.5702024755882164, 'psi': 0.84604768929636}-{'f1_val': 0.6902860513989698, 'auprc': 0.8899035141605531, 'loss_val': 0.725856996082589, 'psi': 0.7701330365036032}
[S7] START round=29 head_norm_before_train=1.650562 cos_to_last_merge=1.0000 (last merge round=28)
[S7] round=29 local utility u=0.000000 metrics={'f1_val': 0.5443643228827206, 'auprc': 0.7814669794827911, 'loss_val': 0.7833172584350281, 'psi': 0.6392053855227489}-{'f1_val': 0.6705573592770028, 'auprc': 0.8031033705708621, 'loss_val': 0.510012348268594, 'psi': 0.7235757637945466}
[S8] START round=29 head_norm_before_train=1.718838 cos_to_last_merge=0.9999 (last merge round=27)
[S8] round=29 local utility u=0.000000 metrics={'f1_val': 0.9750404496475202, 'auprc': 0.9990276220402279, 'loss_val': 0.06596764655067594, 'psi': 0.9846353186046033}-{'f1_val': 0.9936253371144965, 'auprc': 0.9990013354760059, 'loss_val': 0.03613937637545827, 'psi': 0.9957757364591002}
[S9] START round=29 head_norm_before_train=1.254940 cos_to_last_merge=0.9998 (last merge round=27)
[S9] round=29 local utility u=0.001622 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9958682128875302, 'loss_val': 0.06732910878457213, 'psi': 0.9966090326622978}-{'f1_val': 0.9962710290637395, 'auprc': 0.9995408181188363, 'loss_val': 0.07659974641420582, 'psi': 0.9975789446857782}
[S10] START round=29 head_norm_before_train=2.063360 (no previous merge yet)
[S10] round=29 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9964817687695078, 'loss_val': 0.025967842391719276, 'psi': 0.9954418730394266}-{'f1_val': 0.9952985899745774, 'auprc': 0.9964924149894046, 'loss_val': 0.025875722170265437, 'psi': 0.9957761199805082}
[S11] START round=29 head_norm_before_train=1.258659 cos_to_last_merge=1.0000 (last merge round=28)
[S11] round=29 local utility u=0.000000 metrics={'f1_val': 0.9577123967655682, 'auprc': 0.9965249095952815, 'loss_val': 0.20138029153356665, 'psi': 0.9732374018974536}-{'f1_val': 0.9967224195815153, 'auprc': 0.9969678461776204, 'loss_val': 0.1878375156215538, 'psi': 0.9968205902199574}
[S13] START round=29 head_norm_before_train=1.603756 cos_to_last_merge=0.8707 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.871
[S13] round=29 local utility u=0.000000 metrics={'f1_val': 0.6404486781217775, 'auprc': 0.7261536792747966, 'loss_val': 0.9518513461770365, 'psi': 0.6747306785829852}-{'f1_val': 0.663006893569544, 'auprc': 0.7287028529260426, 'loss_val': 0.8933275616176001, 'psi': 0.6892852773121434}
[S14] START round=29 head_norm_before_train=1.619477 cos_to_last_merge=0.9905 (last merge round=22)
[S14] round=29 local utility u=0.005239 metrics={'f1_val': 0.9971675724773966, 'auprc': 0.9968817423092222, 'loss_val': 0.05072271298021296, 'psi': 0.9970532404101269}-{'f1_val': 0.9969676997584747, 'auprc': 0.9951660669077309, 'loss_val': 0.05485468783063739, 'psi': 0.9962470466181772}
[S15] START round=29 head_norm_before_train=1.328601 cos_to_last_merge=1.0000 (last merge round=28)
[S15] round=29 local utility u=0.000000 metrics={'f1_val': 0.9011925060467738, 'auprc': 0.9963248576140697, 'loss_val': 0.18774885585468007, 'psi': 0.9392454466736923}-{'f1_val': 0.9967466683875206, 'auprc': 0.9969557197788163, 'loss_val': 0.06092595057704957, 'psi': 0.9968302889440388}
[S16] START round=29 head_norm_before_train=1.317963 cos_to_last_merge=0.9973 (last merge round=25)
[S16] round=29 local utility u=0.426665 metrics={'f1_val': 0.9375682980482571, 'auprc': 0.9948891107288467, 'loss_val': 0.20733754523528505, 'psi': 0.960496623120493}-{'f1_val': 0.8545788814867236, 'auprc': 0.9932413835934625, 'loss_val': 0.5577885819936205, 'psi': 0.9100438823294191}
[S17] START round=29 head_norm_before_train=2.039494 (no previous merge yet)
[S17] round=29 local utility u=0.460707 metrics={'f1_val': 0.6777034226468517, 'auprc': 0.9862521198496369, 'loss_val': 0.8092630114309047, 'psi': 0.8011229015279657}-{'f1_val': 0.6195787517239182, 'auprc': 0.9404931245510207, 'loss_val': 1.2446519935614277, 'psi': 0.7479445008547592}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:58316
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:58312
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1803) from S6
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.399032)
[S16] loaded HEAD from S6 (vec_in norm=1.399032)
[S16] cosine check vs S6: cos=0.9153
[S16] BUFFERED delta from S6 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1795) from S9
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.286120)
[S11] loaded HEAD from S9 (vec_in norm=1.286120)
[S11] cosine check vs S9: cos=0.9894
[S11] BUFFERED delta from S9 (total buffered=1)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:58308
[S14] sending update (kind=head size=1800 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1800) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.632130)
[S7] loaded HEAD from S14 (vec_in norm=1.632130)
[S7] cosine check vs S14: cos=0.9918
[S7] BUFFERED delta from S14 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S16] → sending delta(kind=head bytes=1806) to S6@127.0.0.1:58307
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1806 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1806) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.346386)
[S6] loaded HEAD from S16 (vec_in norm=1.346386)
[S6] cosine check vs S16: cos=0.9153
[S6] BUFFERED delta from S16 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:58307
[S4] sending update (kind=head size=1801 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1801) from S4
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.374046)
[S6] loaded HEAD from S4 (vec_in norm=1.374046)
[S6] cosine check vs S4: cos=0.9410
[S6] BUFFERED delta from S4 (total buffered=2)
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=29 metric=0.7732 head_norm=1.399032
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.415296e-01
[S6] stored merged vector for next round verification (round=29)
[S6] DEBUG after merge:  round=29 metric=0.7811 head_norm=1.336593 delta_norm=0.141530
[S6] aggregate: ACCEPT kept=['S16', 'S4'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=29 metric=0.9577 head_norm=1.306723
[S11] _apply_head_vector_avg (torch): Δ‖w‖=9.493180e-02
[S11] stored merged vector for next round verification (round=29)
[S11] DEBUG after merge:  round=29 metric=0.9577 head_norm=1.292982 delta_norm=0.094932
[S11] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=29 metric=0.5444 head_norm=1.657676
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.062989e-01
[S7] stored merged vector for next round verification (round=29)
[S7] DEBUG after merge:  round=29 metric=0.5493 head_norm=1.641514 delta_norm=0.106299
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=29 metric=0.9376 head_norm=1.346386
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.837166e-01
[S16] stored merged vector for next round verification (round=29)
[S16] DEBUG after merge:  round=29 metric=0.9367 head_norm=1.343327 delta_norm=0.283717
[S16] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=1.972835 (no previous merge yet)
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.5624117584694737, 'auprc': 0.6877805935915291, 'loss_val': 2.1172758196466073, 'psi': 0.6125592925182959}-{'f1_val': 0.6223956600111976, 'auprc': 0.6928098611535907, 'loss_val': 1.437026419922014, 'psi': 0.6505613404681548}
[S3] START round=30 head_norm_before_train=1.965997 (no previous merge yet)
[S3] round=30 local utility u=0.000000 metrics={'f1_val': 0.9419146778916829, 'auprc': 0.9971899177123744, 'loss_val': 0.14208611464934817, 'psi': 0.9640247738199595}-{'f1_val': 0.9978100342676263, 'auprc': 0.9972684465902355, 'loss_val': 0.04457945530604559, 'psi': 0.9975933991966699}
[S4] START round=30 head_norm_before_train=1.374046 cos_to_last_merge=0.9961 (last merge round=25)
[S4] round=30 local utility u=0.020462 metrics={'f1_val': 0.9411646313085129, 'auprc': 0.9565070095326026, 'loss_val': 0.27028073398325836, 'psi': 0.9473015825981488}-{'f1_val': 0.9405274678797301, 'auprc': 0.9461879297473981, 'loss_val': 0.2764236432101698, 'psi': 0.9427916526267972}
[S5] START round=30 head_norm_before_train=1.342691 cos_to_last_merge=0.9999 (last merge round=28)
[S5] round=30 local utility u=0.862279 metrics={'f1_val': 0.7004932948021524, 'auprc': 0.9890422519682699, 'loss_val': 0.3114886138834414, 'psi': 0.8159128776685994}-{'f1_val': 0.5633562620298618, 'auprc': 0.8225642672561284, 'loss_val': 0.7137913349976143, 'psi': 0.6670394641203684}
[S6] START round=30 head_norm_before_train=1.336593 cos_to_last_merge=1.0000 (last merge round=29)
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.6996807179470628, 'auprc': 0.9340122304651434, 'loss_val': 0.6412282076019743, 'psi': 0.793413322954295}-{'f1_val': 0.7732097935991306, 'auprc': 0.9553045328422042, 'loss_val': 0.5702024755882164, 'psi': 0.84604768929636}
[S7] START round=30 head_norm_before_train=1.641514 cos_to_last_merge=1.0000 (last merge round=29)
[S7] round=30 local utility u=0.597459 metrics={'f1_val': 0.6772508380953874, 'auprc': 0.809446770920555, 'loss_val': 0.469657609537322, 'psi': 0.7301292112254545}-{'f1_val': 0.5443643228827206, 'auprc': 0.7814669794827911, 'loss_val': 0.7833172584350281, 'psi': 0.6392053855227489}
[S8] START round=30 head_norm_before_train=1.738453 cos_to_last_merge=0.9998 (last merge round=27)
[S8] round=30 local utility u=0.069372 metrics={'f1_val': 0.9928938724649488, 'auprc': 0.999033127696739, 'loss_val': 0.034361392606913795, 'psi': 0.9953495745576648}-{'f1_val': 0.9750404496475202, 'auprc': 0.9990276220402279, 'loss_val': 0.06596764655067594, 'psi': 0.9846353186046033}
[S9] START round=30 head_norm_before_train=1.286120 cos_to_last_merge=0.9991 (last merge round=27)
[S9] round=30 local utility u=0.002058 metrics={'f1_val': 0.9958601375429889, 'auprc': 0.9971883520802214, 'loss_val': 0.059717467353768226, 'psi': 0.9963914233578819}-{'f1_val': 0.9971029125121428, 'auprc': 0.9958682128875302, 'loss_val': 0.06732910878457213, 'psi': 0.9966090326622978}
[S10] START round=30 head_norm_before_train=2.075911 (no previous merge yet)
[S10] round=30 local utility u=0.001307 metrics={'f1_val': 0.9951633020469546, 'auprc': 0.996487948219474, 'loss_val': 0.02586071421488499, 'psi': 0.9956931605159622}-{'f1_val': 0.9947486092193725, 'auprc': 0.9964817687695078, 'loss_val': 0.025967842391719276, 'psi': 0.9954418730394266}
[S11] START round=30 head_norm_before_train=1.292982 cos_to_last_merge=1.0000 (last merge round=29)
[S11] round=30 local utility u=0.132515 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9948482763265662, 'loss_val': 0.16538142548422072, 'psi': 0.9959727622795358}-{'f1_val': 0.9577123967655682, 'auprc': 0.9965249095952815, 'loss_val': 0.20138029153356665, 'psi': 0.9732374018974536}
[S13] START round=30 head_norm_before_train=1.613233 cos_to_last_merge=0.8700 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.870
[S13] round=30 local utility u=0.343598 metrics={'f1_val': 0.7114121084680627, 'auprc': 0.7339490148630647, 'loss_val': 0.7138220929432956, 'psi': 0.7204268710260635}-{'f1_val': 0.6404486781217775, 'auprc': 0.7261536792747966, 'loss_val': 0.9518513461770365, 'psi': 0.6747306785829852}
[S14] START round=30 head_norm_before_train=1.632130 cos_to_last_merge=0.9895 (last merge round=22)
[S14] round=30 local utility u=0.000000 metrics={'f1_val': 0.9952238762325061, 'auprc': 0.9957981508014347, 'loss_val': 0.05367346173019561, 'psi': 0.9954535860600775}-{'f1_val': 0.9971675724773966, 'auprc': 0.9968817423092222, 'loss_val': 0.05072271298021296, 'psi': 0.9970532404101269}
[S15] START round=30 head_norm_before_train=1.416490 cos_to_last_merge=0.9984 (last merge round=28)
[S15] round=30 local utility u=0.319074 metrics={'f1_val': 0.985808594582198, 'auprc': 0.9971748388164023, 'loss_val': 0.0598478218254981, 'psi': 0.9903550922758797}-{'f1_val': 0.9011925060467738, 'auprc': 0.9963248576140697, 'loss_val': 0.18774885585468007, 'psi': 0.9392454466736923}
[S16] START round=30 head_norm_before_train=1.343327 cos_to_last_merge=1.0000 (last merge round=29)
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.8346863055489921, 'auprc': 0.9537724842353233, 'loss_val': 0.820409829531626, 'psi': 0.8823207770235246}-{'f1_val': 0.9375682980482571, 'auprc': 0.9948891107288467, 'loss_val': 0.20733754523528505, 'psi': 0.960496623120493}
[S17] START round=30 head_norm_before_train=2.055534 (no previous merge yet)
[S17] round=30 local utility u=0.000000 metrics={'f1_val': 0.6353716684787859, 'auprc': 0.9199470534793016, 'loss_val': 1.0829665565437567, 'psi': 0.7492018224789923}-{'f1_val': 0.6777034226468517, 'auprc': 0.9862521198496369, 'loss_val': 0.8092630114309047, 'psi': 0.8011229015279657}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:58312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:58310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:58315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] sending update (kind=head size=1806 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:58307
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:58308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:58309
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:58305
[S11] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1803) from S8
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.754534)
[S7] loaded HEAD from S8 (vec_in norm=1.754534)
[S7] cosine check vs S8: cos=0.9879
[S7] BUFFERED delta from S8 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1800) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.336117)
[S9] loaded HEAD from S11 (vec_in norm=1.336117)
[S9] cosine check vs S11: cos=0.9923
[S9] BUFFERED delta from S11 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1799) from S7
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.649385)
[S8] loaded HEAD from S7 (vec_in norm=1.649385)
[S8] cosine check vs S7: cos=0.9879
[S8] BUFFERED delta from S7 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1803) from S5
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.352916)
[S15] loaded HEAD from S5 (vec_in norm=1.352916)
[S15] cosine check vs S5: cos=0.9950
[S15] BUFFERED delta from S5 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1797) from S9
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.314085)
[S11] loaded HEAD from S9 (vec_in norm=1.314085)
[S11] cosine check vs S9: cos=0.9923
[S11] BUFFERED delta from S9 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1800) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.481863)
[S5] loaded HEAD from S15 (vec_in norm=1.481863)
[S5] cosine check vs S15: cos=0.9950
[S5] BUFFERED delta from S15 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1799) from S4
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.397976)
[S6] loaded HEAD from S4 (vec_in norm=1.397976)
[S6] cosine check vs S4: cos=0.9438
[S6] BUFFERED delta from S4 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=30 metric=0.6997 head_norm=1.366947
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.322851e-01
[S6] stored merged vector for next round verification (round=30)
[S6] DEBUG after merge:  round=30 metric=0.7006 head_norm=1.362895 delta_norm=0.232285
[S6] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.129 → S16@127.0.0.1:58316
[S14] ⇄ pheromone p=0.054 → S7@127.0.0.1:58308
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=30 metric=0.7005 head_norm=1.352916
[S5] _apply_head_vector_avg (torch): Δ‖w‖=9.551096e-02
[S5] stored merged vector for next round verification (round=30)
[S5] DEBUG after merge:  round=30 metric=0.7005 head_norm=1.415637 delta_norm=0.095511
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.255 → S15@127.0.0.1:58315
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=30 metric=0.9959 head_norm=1.314085
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.287262e-02
[S9] stored merged vector for next round verification (round=30)
[S9] DEBUG after merge:  round=30 metric=0.9959 head_norm=1.322553 delta_norm=0.082873
[S9] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.028 → S11@127.0.0.1:58312
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=30 metric=0.6773 head_norm=1.649385
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.425281e-01
[S7] stored merged vector for next round verification (round=30)
[S7] DEBUG after merge:  round=30 metric=0.6765 head_norm=1.696796 delta_norm=0.142528
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.308 → S8@127.0.0.1:58309
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=30 metric=0.9929 head_norm=1.754534
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.425281e-01
[S8] stored merged vector for next round verification (round=30)
[S8] DEBUG after merge:  round=30 metric=0.9929 head_norm=1.696796 delta_norm=0.142528
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.053 → S7@127.0.0.1:58308
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=30 metric=0.9858 head_norm=1.481863
[S15] _apply_head_vector_avg (torch): Δ‖w‖=9.551095e-02
[S15] stored merged vector for next round verification (round=30)
[S15] DEBUG after merge:  round=30 metric=0.9879 head_norm=1.415637 delta_norm=0.095511
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.209 → S5@127.0.0.1:58305
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=30 metric=0.9967 head_norm=1.336117
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.287262e-02
[S11] stored merged vector for next round verification (round=30)
[S11] DEBUG after merge:  round=30 metric=0.9967 head_norm=1.322553 delta_norm=0.082873
[S11] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.094 → S9@127.0.0.1:58310
[S4] ⇄ pheromone p=0.020 → S6@127.0.0.1:58307
[S16] ⇄ pheromone p=0.121 → S5@127.0.0.1:58305
[S2] START round=31 head_norm_before_train=1.982655 (no previous merge yet)
[S2] round=31 local utility u=0.695513 metrics={'f1_val': 0.6585947966888022, 'auprc': 0.7228196436153411, 'loss_val': 1.4084644788149117, 'psi': 0.6842847354594177}-{'f1_val': 0.5624117584694737, 'auprc': 0.6877805935915291, 'loss_val': 2.1172758196466073, 'psi': 0.6125592925182959}
[S3] START round=31 head_norm_before_train=1.978104 (no previous merge yet)
[S3] round=31 local utility u=0.083822 metrics={'f1_val': 0.9611152572344858, 'auprc': 0.9971002625850847, 'loss_val': 0.08937614242802316, 'psi': 0.9755092593747253}-{'f1_val': 0.9419146778916829, 'auprc': 0.9971899177123744, 'loss_val': 0.14208611464934817, 'psi': 0.9640247738199595}
[S4] START round=31 head_norm_before_train=1.397976 cos_to_last_merge=0.9948 (last merge round=25)
[S4] round=31 local utility u=0.000000 metrics={'f1_val': 0.9410456936950233, 'auprc': 0.9514650604355399, 'loss_val': 0.2760307518641546, 'psi': 0.94521344039123}-{'f1_val': 0.9411646313085129, 'auprc': 0.9565070095326026, 'loss_val': 0.27028073398325836, 'psi': 0.9473015825981488}
[S5] START round=31 head_norm_before_train=1.415637 cos_to_last_merge=1.0000 (last merge round=30)
[S5] round=31 local utility u=0.018540 metrics={'f1_val': 0.7004938661094564, 'auprc': 0.9896292681118196, 'loss_val': 0.27617307462929447, 'psi': 0.8161480269104017}-{'f1_val': 0.7004932948021524, 'auprc': 0.9890422519682699, 'loss_val': 0.3114886138834414, 'psi': 0.8159128776685994}
[S6] START round=31 head_norm_before_train=1.362895 cos_to_last_merge=1.0000 (last merge round=30)
[S6] round=31 local utility u=0.458594 metrics={'f1_val': 0.8172192373642868, 'auprc': 0.947450216971731, 'loss_val': 0.4695856813588982, 'psi': 0.8693116292072645}-{'f1_val': 0.6996807179470628, 'auprc': 0.9340122304651434, 'loss_val': 0.6412282076019743, 'psi': 0.793413322954295}
[S7] START round=31 head_norm_before_train=1.696796 cos_to_last_merge=1.0000 (last merge round=30)
[S7] round=31 local utility u=0.000000 metrics={'f1_val': 0.5161207194662268, 'auprc': 0.7809546795233187, 'loss_val': 0.8613933718944494, 'psi': 0.6220543034890635}-{'f1_val': 0.6772508380953874, 'auprc': 0.809446770920555, 'loss_val': 0.469657609537322, 'psi': 0.7301292112254545}
[S8] START round=31 head_norm_before_train=1.696796 cos_to_last_merge=1.0000 (last merge round=30)
[S8] round=31 local utility u=0.000000 metrics={'f1_val': 0.9885804511658192, 'auprc': 0.9992731628521806, 'loss_val': 0.0446963063427604, 'psi': 0.9928575358403637}-{'f1_val': 0.9928938724649488, 'auprc': 0.999033127696739, 'loss_val': 0.034361392606913795, 'psi': 0.9953495745576648}
[S9] START round=31 head_norm_before_train=1.322553 cos_to_last_merge=1.0000 (last merge round=30)
[S9] round=31 local utility u=0.005116 metrics={'f1_val': 0.9958601375429889, 'auprc': 0.9993794006385298, 'loss_val': 0.0560588075458782, 'psi': 0.9972678427812052}-{'f1_val': 0.9958601375429889, 'auprc': 0.9971883520802214, 'loss_val': 0.059717467353768226, 'psi': 0.9963914233578819}
[S10] START round=31 head_norm_before_train=2.088698 (no previous merge yet)
[S10] round=31 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9960894550410779, 'loss_val': 0.02602362932365117, 'psi': 0.9952849475480547}-{'f1_val': 0.9951633020469546, 'auprc': 0.996487948219474, 'loss_val': 0.02586071421488499, 'psi': 0.9956931605159622}
[S11] START round=31 head_norm_before_train=1.322553 cos_to_last_merge=1.0000 (last merge round=30)
[S11] round=31 local utility u=0.007021 metrics={'f1_val': 0.9957161515329224, 'auprc': 0.9992755947065953, 'loss_val': 0.15858435986536804, 'psi': 0.9971399288023916}-{'f1_val': 0.9967224195815153, 'auprc': 0.9948482763265662, 'loss_val': 0.16538142548422072, 'psi': 0.9959727622795358}
[S13] START round=31 head_norm_before_train=1.626616 cos_to_last_merge=0.8687 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.869
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.6591898054066434, 'auprc': 0.6801023975286509, 'loss_val': 0.8653028048892615, 'psi': 0.6675548422554464}-{'f1_val': 0.7114121084680627, 'auprc': 0.7339490148630647, 'loss_val': 0.7138220929432956, 'psi': 0.7204268710260635}
[S14] START round=31 head_norm_before_train=1.643012 cos_to_last_merge=0.9886 (last merge round=22)
[S14] round=31 local utility u=0.010820 metrics={'f1_val': 0.9976760408229349, 'auprc': 0.9969760807063788, 'loss_val': 0.05028010660520726, 'psi': 0.9973960567763125}-{'f1_val': 0.9952238762325061, 'auprc': 0.9957981508014347, 'loss_val': 0.05367346173019561, 'psi': 0.9954535860600775}
[S15] START round=31 head_norm_before_train=1.415637 cos_to_last_merge=1.0000 (last merge round=30)
[S15] round=31 local utility u=0.037179 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9975692383892766, 'loss_val': 0.05230201719127758, 'psi': 0.997075696388223}-{'f1_val': 0.985808594582198, 'auprc': 0.9971748388164023, 'loss_val': 0.0598478218254981, 'psi': 0.9903550922758797}
[S16] START round=31 head_norm_before_train=1.368224 cos_to_last_merge=0.9998 (last merge round=29)
[S16] round=31 local utility u=0.861870 metrics={'f1_val': 0.9863560436928502, 'auprc': 0.9887041223128747, 'loss_val': 0.11148367518001728, 'psi': 0.98729527514086}-{'f1_val': 0.8346863055489921, 'auprc': 0.9537724842353233, 'loss_val': 0.820409829531626, 'psi': 0.8823207770235246}
[S17] START round=31 head_norm_before_train=2.067971 (no previous merge yet)
[S17] round=31 local utility u=0.000000 metrics={'f1_val': 0.6429136807223815, 'auprc': 0.8895174514986397, 'loss_val': 1.0714903274660483, 'psi': 0.7415551890328849}-{'f1_val': 0.6353716684787859, 'auprc': 0.9199470534793016, 'loss_val': 1.0829665565437567, 'psi': 0.7492018224789923}
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S8
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:58305
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:58304
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S15] → sending delta(kind=head bytes=1806) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:58315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:58317
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:58308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:58316
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1806 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1800) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.655066)
[S7] loaded HEAD from S14 (vec_in norm=1.655066)
[S7] cosine check vs S14: cos=0.9883
[S7] BUFFERED delta from S14 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1803) from S6
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.394100)
[S16] loaded HEAD from S6 (vec_in norm=1.394100)
[S16] cosine check vs S6: cos=0.9447
[S16] BUFFERED delta from S6 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1800) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.346273)
[S17] loaded HEAD from S9 (vec_in norm=1.346273)
[S17] cosine check vs S9: cos=0.3852
[S17] BUFFERED delta from S9 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1801) from S11
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.364121)
[S4] loaded HEAD from S11 (vec_in norm=1.364121)
[S4] cosine check vs S11: cos=0.8099
[S4] BUFFERED delta from S11 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1804) from S16
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.391638)
[S5] loaded HEAD from S16 (vec_in norm=1.391638)
[S5] cosine check vs S16: cos=0.8482
[S5] BUFFERED delta from S16 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1798) from S5
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.423401)
[S15] loaded HEAD from S5 (vec_in norm=1.423401)
[S15] cosine check vs S5: cos=0.9995
[S15] BUFFERED delta from S5 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1806) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.472009)
[S5] loaded HEAD from S15 (vec_in norm=1.472009)
[S5] cosine check vs S15: cos=0.9995
[S5] BUFFERED delta from S15 (total buffered=2)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=31 metric=0.5161 head_norm=1.703920
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.308394e-01
[S7] stored merged vector for next round verification (round=31)
[S7] DEBUG after merge:  round=31 metric=0.5201 head_norm=1.674567 delta_norm=0.130839
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=31 metric=0.9967 head_norm=1.472009
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.399956e-02
[S15] stored merged vector for next round verification (round=31)
[S15] DEBUG after merge:  round=31 metric=0.9967 head_norm=1.447510 delta_norm=0.034000
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=31 metric=0.9410 head_norm=1.422293
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.304044e-01
[S4] stored merged vector for next round verification (round=31)
[S4] DEBUG after merge:  round=31 metric=0.9410 head_norm=1.325377 delta_norm=0.430404
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=31 metric=0.9864 head_norm=1.391638
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.316875e-01
[S16] stored merged vector for next round verification (round=31)
[S16] DEBUG after merge:  round=31 metric=0.9886 head_norm=1.373465 delta_norm=0.231687
[S16] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S5] CommDone barrier timeout: have=2 need=5 — continuing
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=31 metric=0.7005 head_norm=1.423401
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.847332e-01
[S5] stored merged vector for next round verification (round=31)
[S5] DEBUG after merge:  round=31 metric=0.7003 head_norm=1.386083 delta_norm=0.184733
[S5] aggregate: ACCEPT kept=['S16', 'S15'] (k=2/2) mode=median trim_p=0.1
[S2] START round=32 head_norm_before_train=1.990623 (no previous merge yet)
[S2] round=32 local utility u=0.000000 metrics={'f1_val': 0.6241319478358935, 'auprc': 0.7262934978017113, 'loss_val': 1.640630231158869, 'psi': 0.6649965678222207}-{'f1_val': 0.6585947966888022, 'auprc': 0.7228196436153411, 'loss_val': 1.4084644788149117, 'psi': 0.6842847354594177}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=32 head_norm_before_train=1.989995 (no previous merge yet)
[S3] round=32 local utility u=0.125460 metrics={'f1_val': 0.9972450390152456, 'auprc': 0.9988464464335212, 'loss_val': 0.060472579326049374, 'psi': 0.9978856019825558}-{'f1_val': 0.9611152572344858, 'auprc': 0.9971002625850847, 'loss_val': 0.08937614242802316, 'psi': 0.9755092593747253}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] sending update (kind=head size=1804 to 1 peers)
[S4] START round=32 head_norm_before_train=1.325377 cos_to_last_merge=1.0000 (last merge round=31)
[S4] round=32 local utility u=0.026678 metrics={'f1_val': 0.9411646313085129, 'auprc': 0.9659312020088235, 'loss_val': 0.2667860714680363, 'psi': 0.9510712595886373}-{'f1_val': 0.9410456936950233, 'auprc': 0.9514650604355399, 'loss_val': 0.2760307518641546, 'psi': 0.94521344039123}
[S5] START round=32 head_norm_before_train=1.386083 cos_to_last_merge=1.0000 (last merge round=31)
[S5] round=32 local utility u=0.000000 metrics={'f1_val': 0.5448848371185864, 'auprc': 0.7061342898421143, 'loss_val': 0.8096604274819159, 'psi': 0.6093846182079976}-{'f1_val': 0.7004938661094564, 'auprc': 0.9896292681118196, 'loss_val': 0.27617307462929447, 'psi': 0.8161480269104017}
[S6] START round=32 head_norm_before_train=1.394100 cos_to_last_merge=0.9996 (last merge round=30)
[S6] round=32 local utility u=0.208955 metrics={'f1_val': 0.8628677795268277, 'auprc': 0.9605720763528014, 'loss_val': 0.36493232741173265, 'psi': 0.9019494982572172}-{'f1_val': 0.8172192373642868, 'auprc': 0.947450216971731, 'loss_val': 0.4695856813588982, 'psi': 0.8693116292072645}
[S7] START round=32 head_norm_before_train=1.674567 cos_to_last_merge=1.0000 (last merge round=31)
[S7] round=32 local utility u=0.178071 metrics={'f1_val': 0.5555600266445038, 'auprc': 0.7890923908095027, 'loss_val': 0.7663011173630563, 'psi': 0.6489729723105033}-{'f1_val': 0.5161207194662268, 'auprc': 0.7809546795233187, 'loss_val': 0.8613933718944494, 'psi': 0.6220543034890635}
[S8] START round=32 head_norm_before_train=1.721083 cos_to_last_merge=0.9999 (last merge round=30)
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.9860892612913941, 'auprc': 0.9990315806772655, 'loss_val': 0.0500215269415859, 'psi': 0.9912661890457426}-{'f1_val': 0.9885804511658192, 'auprc': 0.9992731628521806, 'loss_val': 0.0446963063427604, 'psi': 0.9928575358403637}
[S9] START round=32 head_norm_before_train=1.346273 cos_to_last_merge=0.9999 (last merge round=30)
[S9] round=32 local utility u=0.006989 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9995212937131666, 'loss_val': 0.049962522057723176, 'psi': 0.9980702649925524}-{'f1_val': 0.9958601375429889, 'auprc': 0.9993794006385298, 'loss_val': 0.0560588075458782, 'psi': 0.9972678427812052}
[S10] START round=32 head_norm_before_train=2.093990 (no previous merge yet)
[S10] round=32 local utility u=0.001316 metrics={'f1_val': 0.9951633020469546, 'auprc': 0.9960706892157754, 'loss_val': 0.02582296160310307, 'psi': 0.9955262569144829}-{'f1_val': 0.9947486092193725, 'auprc': 0.9960894550410779, 'loss_val': 0.02602362932365117, 'psi': 0.9952849475480547}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=32 head_norm_before_train=1.364121 cos_to_last_merge=0.9991 (last merge round=30)
[S11] round=32 local utility u=0.019207 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.99630961741093, 'loss_val': 0.11730961353169336, 'psi': 0.9965572987132812}-{'f1_val': 0.9957161515329224, 'auprc': 0.9992755947065953, 'loss_val': 0.15858435986536804, 'psi': 0.9971399288023916}
[S13] START round=32 head_norm_before_train=1.639293 cos_to_last_merge=0.8677 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.868
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.6106516822746244, 'auprc': 0.6191439182819802, 'loss_val': 1.280733217193315, 'psi': 0.6140485766775667}-{'f1_val': 0.6591898054066434, 'auprc': 0.6801023975286509, 'loss_val': 0.8653028048892615, 'psi': 0.6675548422554464}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=32 head_norm_before_train=1.655066 cos_to_last_merge=0.9877 (last merge round=22)
[S14] round=32 local utility u=0.004347 metrics={'f1_val': 0.9976516241010662, 'auprc': 0.9969744911123661, 'loss_val': 0.0414353269509514, 'psi': 0.9973807709055862}-{'f1_val': 0.9976760408229349, 'auprc': 0.9969760807063788, 'loss_val': 0.05028010660520726, 'psi': 0.9973960567763125}
[S15] START round=32 head_norm_before_train=1.447510 cos_to_last_merge=1.0000 (last merge round=31)
[S15] round=32 local utility u=0.005791 metrics={'f1_val': 0.9971172535281002, 'auprc': 0.99807963637842, 'loss_val': 0.044474799375947435, 'psi': 0.9975022066682281}-{'f1_val': 0.9967466683875206, 'auprc': 0.9975692383892766, 'loss_val': 0.05230201719127758, 'psi': 0.997075696388223}
[S16] START round=32 head_norm_before_train=1.373465 cos_to_last_merge=1.0000 (last merge round=31)
[S16] round=32 local utility u=0.000000 metrics={'f1_val': 0.938157072716885, 'auprc': 0.995464105451815, 'loss_val': 0.22323409124627375, 'psi': 0.9610798858108569}-{'f1_val': 0.9863560436928502, 'auprc': 0.9887041223128747, 'loss_val': 0.11148367518001728, 'psi': 0.98729527514086}
[S17] START round=32 head_norm_before_train=2.081429 (no previous merge yet)
[S17] round=32 local utility u=0.037871 metrics={'f1_val': 0.6470610829666054, 'auprc': 0.9278170446650668, 'loss_val': 1.135531860905931, 'psi': 0.7593634676459899}-{'f1_val': 0.6429136807223815, 'auprc': 0.8895174514986397, 'loss_val': 1.0714903274660483, 'psi': 0.7415551890328849}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=32 metric=0.6471 head_norm=2.099694
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.005627e+00
[S17] stored merged vector for next round verification (round=32)
[S17] DEBUG after merge:  round=32 metric=0.6526 head_norm=1.448896 delta_norm=1.005627
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:58305
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:58310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S6] → sending delta(kind=head bytes=1807) to S4@127.0.0.1:58304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S11@127.0.0.1:58312
[S5] RECEIVED delta(kind=head bytes=1801) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.505676)
[S5] loaded HEAD from S15 (vec_in norm=1.505676)
[S5] cosine check vs S15: cos=0.9878
[S5] BUFFERED delta from S15 (total buffered=1)
[S4] sending update (kind=head size=1803 to 1 peers)
[S6] sending update (kind=head size=1807 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] → sending delta(kind=head bytes=1805) to S11@127.0.0.1:58312
[S9] RECEIVED delta(kind=head bytes=1795) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.406425)
[S9] loaded HEAD from S11 (vec_in norm=1.406425)
[S9] cosine check vs S11: cos=0.9960
[S9] BUFFERED delta from S11 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1807) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.411357)
[S4] loaded HEAD from S6 (vec_in norm=1.411357)
[S4] cosine check vs S6: cos=0.9299
[S4] BUFFERED delta from S6 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1801) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.687242)
[S14] loaded HEAD from S7 (vec_in norm=1.687242)
[S14] cosine check vs S7: cos=0.9963
[S14] BUFFERED delta from S7 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1803) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.352220)
[S11] loaded HEAD from S4 (vec_in norm=1.352220)
[S11] cosine check vs S4: cos=0.9487
[S11] BUFFERED delta from S4 (total buffered=1)
[S9] sending update (kind=head size=1805 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1805) from S9
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.366770)
[S11] loaded HEAD from S9 (vec_in norm=1.366770)
[S11] cosine check vs S9: cos=0.9960
[S11] BUFFERED delta from S9 (total buffered=2)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=32 metric=0.9412 head_norm=1.352220
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.602299e-01
[S4] stored merged vector for next round verification (round=32)
[S4] DEBUG after merge:  round=32 metric=0.9412 head_norm=1.357385 delta_norm=0.260230
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=32 metric=0.9977 head_norm=1.667870
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.233848e-02
[S14] stored merged vector for next round verification (round=32)
[S14] DEBUG after merge:  round=32 metric=0.9977 head_norm=1.676023 delta_norm=0.072338
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=32 metric=0.9971 head_norm=1.366770
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.523097e-02
[S9] stored merged vector for next round verification (round=32)
[S9] DEBUG after merge:  round=32 metric=0.9971 head_norm=1.385204 delta_norm=0.065231
[S9] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=32 metric=0.9967 head_norm=1.406425
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.089770e-01
[S11] stored merged vector for next round verification (round=32)
[S11] DEBUG after merge:  round=32 metric=0.9967 head_norm=1.367942 delta_norm=0.108977
[S11] aggregate: ACCEPT kept=['S4', 'S9'] (k=2/2) mode=median trim_p=0.1
[S6]  timeout peer S16
[S11]  timeout peer S4
[S14]  timeout peer S7
[S14]  timeout peer S9
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S10
[S5]  timeout peer S14
[S16]  timeout peer S5
[S9]  timeout peer S13
[S9]  timeout peer S17
[S4]  timeout peer S6
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=32 metric=0.5449 head_norm=1.391814
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.267256e-01
[S5] stored merged vector for next round verification (round=32)
[S5] DEBUG after merge:  round=32 metric=0.5488 head_norm=1.444314 delta_norm=0.126726
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=33 head_norm_before_train=1.993868 (no previous merge yet)
[S2] round=33 local utility u=0.404831 metrics={'f1_val': 0.6829933562018174, 'auprc': 0.7254288259728402, 'loss_val': 1.1815427959609908, 'psi': 0.6999675441102265}-{'f1_val': 0.6241319478358935, 'auprc': 0.7262934978017113, 'loss_val': 1.640630231158869, 'psi': 0.6649965678222207}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=33 head_norm_before_train=2.000707 (no previous merge yet)
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9970755012539592, 'loss_val': 0.07085351706090866, 'psi': 0.9754752517412559}-{'f1_val': 0.9972450390152456, 'auprc': 0.9988464464335212, 'loss_val': 0.060472579326049374, 'psi': 0.9978856019825558}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=33 head_norm_before_train=1.357385 cos_to_last_merge=1.0000 (last merge round=32)
[S4] round=33 local utility u=0.024324 metrics={'f1_val': 0.9464443659672959, 'auprc': 0.9697046055897569, 'loss_val': 0.26113671095734403, 'psi': 0.9557484618162804}-{'f1_val': 0.9411646313085129, 'auprc': 0.9659312020088235, 'loss_val': 0.2667860714680363, 'psi': 0.9510712595886373}
[S5] START round=33 head_norm_before_train=1.444314 cos_to_last_merge=1.0000 (last merge round=32)
[S5] round=33 local utility u=1.000000 metrics={'f1_val': 0.7005802511973405, 'auprc': 0.9892749774739967, 'loss_val': 0.17848539727992327, 'psi': 0.816058141708003}-{'f1_val': 0.5448848371185864, 'auprc': 0.7061342898421143, 'loss_val': 0.8096604274819159, 'psi': 0.6093846182079976}
[S6] START round=33 head_norm_before_train=1.411357 cos_to_last_merge=0.9987 (last merge round=30)
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.5976495033328328, 'auprc': 0.9122765591838464, 'loss_val': 0.965027307585691, 'psi': 0.7235003256732383}-{'f1_val': 0.8628677795268277, 'auprc': 0.9605720763528014, 'loss_val': 0.36493232741173265, 'psi': 0.9019494982572172}
[S7] START round=33 head_norm_before_train=1.687242 cos_to_last_merge=0.9999 (last merge round=31)
[S7] round=33 local utility u=0.779256 metrics={'f1_val': 0.6923709167300711, 'auprc': 0.8926600686698849, 'loss_val': 0.33935826588093737, 'psi': 0.7724865775059966}-{'f1_val': 0.5555600266445038, 'auprc': 0.7890923908095027, 'loss_val': 0.7663011173630563, 'psi': 0.6489729723105033}
[S8] START round=33 head_norm_before_train=1.742367 cos_to_last_merge=0.9998 (last merge round=30)
[S8] round=33 local utility u=0.007872 metrics={'f1_val': 0.9876438719484958, 'auprc': 0.9992779441007023, 'loss_val': 0.044344350978041326, 'psi': 0.9922975008093784}-{'f1_val': 0.9860892612913941, 'auprc': 0.9990315806772655, 'loss_val': 0.0500215269415859, 'psi': 0.9912661890457426}
[S9] START round=33 head_norm_before_train=1.385204 cos_to_last_merge=1.0000 (last merge round=32)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9987679338377532, 'loss_val': 0.04809467016572942, 'psi': 0.9975034806234362}-{'f1_val': 0.9971029125121428, 'auprc': 0.9995212937131666, 'loss_val': 0.049962522057723176, 'psi': 0.9980702649925524}
[S10] START round=33 head_norm_before_train=2.097950 (no previous merge yet)
[S10] round=33 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9960308209263791, 'loss_val': 0.025841026765373826, 'psi': 0.9952614939021751}-{'f1_val': 0.9951633020469546, 'auprc': 0.9960706892157754, 'loss_val': 0.02582296160310307, 'psi': 0.9955262569144829}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=33 head_norm_before_train=1.367942 cos_to_last_merge=1.0000 (last merge round=32)
[S11] round=33 local utility u=0.000000 metrics={'f1_val': 0.9780169192111966, 'auprc': 0.9991181674811306, 'loss_val': 0.1520023953671678, 'psi': 0.9864574185191701}-{'f1_val': 0.9967224195815153, 'auprc': 0.99630961741093, 'loss_val': 0.11730961353169336, 'psi': 0.9965572987132812}
[S13] START round=33 head_norm_before_train=1.653165 cos_to_last_merge=0.8666 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.867
[S13] round=33 local utility u=0.509679 metrics={'f1_val': 0.633519051691489, 'auprc': 0.7766419388730089, 'loss_val': 0.8710725179983454, 'psi': 0.690768206564097}-{'f1_val': 0.6106516822746244, 'auprc': 0.6191439182819802, 'loss_val': 1.280733217193315, 'psi': 0.6140485766775667}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=33 head_norm_before_train=1.676023 cos_to_last_merge=1.0000 (last merge round=32)
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.9684392349336312, 'auprc': 0.9969596869626965, 'loss_val': 0.06805464225048986, 'psi': 0.9798474157452572}-{'f1_val': 0.9976516241010662, 'auprc': 0.9969744911123661, 'loss_val': 0.0414353269509514, 'psi': 0.9973807709055862}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=33 head_norm_before_train=1.505676 cos_to_last_merge=0.9996 (last merge round=31)
[S15] round=33 local utility u=0.000000 metrics={'f1_val': 0.9753780493476981, 'auprc': 0.9968933774377735, 'loss_val': 0.06041843268290669, 'psi': 0.9839841805837283}-{'f1_val': 0.9971172535281002, 'auprc': 0.99807963637842, 'loss_val': 0.044474799375947435, 'psi': 0.9975022066682281}
[S16] START round=33 head_norm_before_train=1.392420 cos_to_last_merge=0.9998 (last merge round=31)
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.8336659961459244, 'auprc': 0.9550659694137954, 'loss_val': 0.8301799706018029, 'psi': 0.8822259854530727}-{'f1_val': 0.938157072716885, 'auprc': 0.995464105451815, 'loss_val': 0.22323409124627375, 'psi': 0.9610798858108569}
[S17] START round=33 head_norm_before_train=1.448896 cos_to_last_merge=1.0000 (last merge round=32)
[S17] round=33 local utility u=0.000000 metrics={'f1_val': 0.6106374720555169, 'auprc': 0.8386864251601192, 'loss_val': 0.9556547704186226, 'psi': 0.7018570532973578}-{'f1_val': 0.6470610829666054, 'auprc': 0.9278170446650668, 'loss_val': 1.135531860905931, 'psi': 0.7593634676459899}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:58308
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S4] sending update (kind=head size=1807 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:58315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:58314
[S7] RECEIVED delta(kind=head bytes=1801) from S8
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.757870)
[S7] loaded HEAD from S8 (vec_in norm=1.757870)
[S7] cosine check vs S8: cos=0.9956
[S7] BUFFERED delta from S8 (total buffered=1)
[S7] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1802) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.701604)
[S14] loaded HEAD from S7 (vec_in norm=1.701604)
[S14] cosine check vs S7: cos=0.9986
[S14] BUFFERED delta from S7 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1802) from S5
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.448075)
[S15] loaded HEAD from S5 (vec_in norm=1.448075)
[S15] cosine check vs S5: cos=0.9958
[S15] BUFFERED delta from S5 (total buffered=1)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=33 metric=0.6924 head_norm=1.701604
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.624283e-02
[S7] stored merged vector for next round verification (round=33)
[S7] DEBUG after merge:  round=33 metric=0.6935 head_norm=1.727815 delta_norm=0.086243
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=34 head_norm_before_train=1.998758 (no previous merge yet)
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.6064152626244181, 'auprc': 0.7031007366378293, 'loss_val': 1.8492800046225537, 'psi': 0.6450894522297825}-{'f1_val': 0.6829933562018174, 'auprc': 0.7254288259728402, 'loss_val': 1.1815427959609908, 'psi': 0.6999675441102265}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=34 head_norm_before_train=2.013051 (no previous merge yet)
[S3] round=34 local utility u=0.101472 metrics={'f1_val': 0.9893971724872102, 'auprc': 0.9969242414391362, 'loss_val': 0.037388590402532805, 'psi': 0.9924080000679805}-{'f1_val': 0.9610750853994537, 'auprc': 0.9970755012539592, 'loss_val': 0.07085351706090866, 'psi': 0.9754752517412559}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=34 head_norm_before_train=1.390793 cos_to_last_merge=0.9998 (last merge round=32)
[S4] round=34 local utility u=0.000000 metrics={'f1_val': 0.9414683601130451, 'auprc': 0.9684181861430532, 'loss_val': 0.27077241014486936, 'psi': 0.9522482905250483}-{'f1_val': 0.9464443659672959, 'auprc': 0.9697046055897569, 'loss_val': 0.26113671095734403, 'psi': 0.9557484618162804}
[S5] START round=34 head_norm_before_train=1.448075 cos_to_last_merge=1.0000 (last merge round=32)
[S5] round=34 local utility u=0.000000 metrics={'f1_val': 0.44082116005653893, 'auprc': 0.8439607427903826, 'loss_val': 0.9299918054916365, 'psi': 0.6020769931500765}-{'f1_val': 0.7005802511973405, 'auprc': 0.9892749774739967, 'loss_val': 0.17848539727992327, 'psi': 0.816058141708003}
[S6] START round=34 head_norm_before_train=1.425827 cos_to_last_merge=0.9977 (last merge round=30)
[S6] round=34 local utility u=1.000000 metrics={'f1_val': 0.8720419782314206, 'auprc': 0.9654438489255892, 'loss_val': 0.31141809365369105, 'psi': 0.909402726509088}-{'f1_val': 0.5976495033328328, 'auprc': 0.9122765591838464, 'loss_val': 0.965027307585691, 'psi': 0.7235003256732383}
[S7] START round=34 head_norm_before_train=1.727815 cos_to_last_merge=1.0000 (last merge round=33)
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.5540348892926257, 'auprc': 0.7917808776687522, 'loss_val': 0.816014449886248, 'psi': 0.6491332846430763}-{'f1_val': 0.6923709167300711, 'auprc': 0.8926600686698849, 'loss_val': 0.33935826588093737, 'psi': 0.7724865775059966}
[S8] START round=34 head_norm_before_train=1.757870 cos_to_last_merge=0.9996 (last merge round=30)
[S8] round=34 local utility u=0.023818 metrics={'f1_val': 0.9941802643052118, 'auprc': 0.9985884556413348, 'loss_val': 0.03385890806043387, 'psi': 0.995943540839661}-{'f1_val': 0.9876438719484958, 'auprc': 0.9992779441007023, 'loss_val': 0.044344350978041326, 'psi': 0.9922975008093784}
[S9] START round=34 head_norm_before_train=1.402442 cos_to_last_merge=0.9999 (last merge round=32)
[S9] round=34 local utility u=0.000027 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9965797831905483, 'loss_val': 0.04413113344745618, 'psi': 0.996893660783505}-{'f1_val': 0.9966605118138915, 'auprc': 0.9987679338377532, 'loss_val': 0.04809467016572942, 'psi': 0.9975034806234362}
[S10] START round=34 head_norm_before_train=2.105075 (no previous merge yet)
[S10] round=34 local utility u=0.001918 metrics={'f1_val': 0.9951633020469546, 'auprc': 0.9963680493536984, 'loss_val': 0.025505014531540252, 'psi': 0.9956452009696521}-{'f1_val': 0.9947486092193725, 'auprc': 0.9960308209263791, 'loss_val': 0.025841026765373826, 'psi': 0.9952614939021751}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=34 head_norm_before_train=1.408191 cos_to_last_merge=0.9996 (last merge round=32)
[S11] round=34 local utility u=0.087138 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9983243171677991, 'loss_val': 0.08757699637197644, 'psi': 0.9973631786160289}-{'f1_val': 0.9780169192111966, 'auprc': 0.9991181674811306, 'loss_val': 0.1520023953671678, 'psi': 0.9864574185191701}
[S13] START round=34 head_norm_before_train=1.649426 cos_to_last_merge=0.8655 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.865
[S13] round=34 local utility u=0.000000 metrics={'f1_val': 0.620202510117093, 'auprc': 0.6363191825023808, 'loss_val': 1.0976209530323853, 'psi': 0.6266491790712081}-{'f1_val': 0.633519051691489, 'auprc': 0.7766419388730089, 'loss_val': 0.8710725179983454, 'psi': 0.690768206564097}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=34 head_norm_before_train=1.687450 cos_to_last_merge=1.0000 (last merge round=32)
[S14] round=34 local utility u=0.093460 metrics={'f1_val': 0.9961839019930665, 'auprc': 0.9969564430932712, 'loss_val': 0.04759327749840802, 'psi': 0.9964929184331484}-{'f1_val': 0.9684392349336312, 'auprc': 0.9969596869626965, 'loss_val': 0.06805464225048986, 'psi': 0.9798474157452572}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=34 metric=0.9962 head_norm=1.699018
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.974109e-02
[S14] stored merged vector for next round verification (round=34)
[S14] DEBUG after merge:  round=34 metric=0.9958 head_norm=1.699584 delta_norm=0.049741
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S15] START round=34 head_norm_before_train=1.554601 cos_to_last_merge=0.9987 (last merge round=31)
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.9016001089992542, 'auprc': 0.996767115096975, 'loss_val': 0.2511665536485737, 'psi': 0.9396669114383426}-{'f1_val': 0.9753780493476981, 'auprc': 0.9968933774377735, 'loss_val': 0.06041843268290669, 'psi': 0.9839841805837283}
[S16] START round=34 head_norm_before_train=1.411461 cos_to_last_merge=0.9994 (last merge round=31)
[S16] round=34 local utility u=0.900373 metrics={'f1_val': 0.9913080206785505, 'auprc': 0.9910733199924625, 'loss_val': 0.08330833632017316, 'psi': 0.9912141404041154}-{'f1_val': 0.8336659961459244, 'auprc': 0.9550659694137954, 'loss_val': 0.8301799706018029, 'psi': 0.8822259854530727}
[S17] START round=34 head_norm_before_train=1.500861 cos_to_last_merge=0.9993 (last merge round=32)
[S17] round=34 local utility u=0.059129 metrics={'f1_val': 0.6253989940102124, 'auprc': 0.8558620808087797, 'loss_val': 0.977493736556289, 'psi': 0.7175842287296392}-{'f1_val': 0.6106374720555169, 'auprc': 0.8386864251601192, 'loss_val': 0.9556547704186226, 'psi': 0.7018570532973578}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S8] not sending this round → trigger blocked (psi=0.996)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:58310
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:58307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S6] → sending delta(kind=head bytes=1807) to S4@127.0.0.1:58304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:58312
[S6] sending update (kind=head size=1807 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=34 metric=0.9016 head_norm=1.596634
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.096862e-01
[S15] stored merged vector for next round verification (round=34)
[S15] DEBUG after merge:  round=34 metric=0.9016 head_norm=1.520214 delta_norm=0.109686
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] RECEIVED delta(kind=head bytes=1803) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.443621)
[S9] loaded HEAD from S11 (vec_in norm=1.443621)
[S9] cosine check vs S11: cos=0.9917
[S9] BUFFERED delta from S11 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1796) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.430032)
[S6] loaded HEAD from S16 (vec_in norm=1.430032)
[S6] cosine check vs S16: cos=0.9793
[S6] BUFFERED delta from S16 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1807) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.440512)
[S4] loaded HEAD from S6 (vec_in norm=1.440512)
[S4] cosine check vs S6: cos=0.9797
[S4] BUFFERED delta from S6 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1800) from S9
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.420999)
[S11] loaded HEAD from S9 (vec_in norm=1.420999)
[S11] cosine check vs S9: cos=0.9917
[S11] BUFFERED delta from S9 (total buffered=1)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=34 metric=0.9967 head_norm=1.443621
[S11] _apply_head_vector_avg (torch): Δ‖w‖=9.306694e-02
[S11] stored merged vector for next round verification (round=34)
[S11] DEBUG after merge:  round=34 metric=0.9967 head_norm=1.429328 delta_norm=0.093067
[S11] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=34 metric=0.9971 head_norm=1.420999
[S9] _apply_head_vector_avg (torch): Δ‖w‖=9.306695e-02
[S9] stored merged vector for next round verification (round=34)
[S9] DEBUG after merge:  round=34 metric=0.9971 head_norm=1.429328 delta_norm=0.093067
[S9] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=34 metric=0.8720 head_norm=1.440512
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.460445e-01
[S6] stored merged vector for next round verification (round=34)
[S6] DEBUG after merge:  round=34 metric=0.8917 head_norm=1.427832 delta_norm=0.146044
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=35 head_norm_before_train=2.007122 (no previous merge yet)
[S2] round=35 local utility u=0.371090 metrics={'f1_val': 0.6503751297139619, 'auprc': 0.7178936627875508, 'loss_val': 1.4152382244466561, 'psi': 0.6773825429433975}-{'f1_val': 0.6064152626244181, 'auprc': 0.7031007366378293, 'loss_val': 1.8492800046225537, 'psi': 0.6450894522297825}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=35 head_norm_before_train=2.026667 (no previous merge yet)
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.964978637492565, 'auprc': 0.9970807015907576, 'loss_val': 0.06254481378886212, 'psi': 0.977819463131842}-{'f1_val': 0.9893971724872102, 'auprc': 0.9969242414391362, 'loss_val': 0.037388590402532805, 'psi': 0.9924080000679805}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=35 head_norm_before_train=1.423735 cos_to_last_merge=0.9992 (last merge round=32)
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.9387754144330569, 'auprc': 0.9368833828835874, 'loss_val': 0.290415470078655, 'psi': 0.938018601813269}-{'f1_val': 0.9414683601130451, 'auprc': 0.9684181861430532, 'loss_val': 0.27077241014486936, 'psi': 0.9522482905250483}
[S5] START round=35 head_norm_before_train=1.450728 cos_to_last_merge=1.0000 (last merge round=32)
[S5] round=35 local utility u=1.000000 metrics={'f1_val': 0.7004932948021524, 'auprc': 0.9745688899911267, 'loss_val': 0.2901337622402446, 'psi': 0.8101235328777421}-{'f1_val': 0.44082116005653893, 'auprc': 0.8439607427903826, 'loss_val': 0.9299918054916365, 'psi': 0.6020769931500765}
[S6] START round=35 head_norm_before_train=1.427832 cos_to_last_merge=1.0000 (last merge round=34)
[S6] round=35 local utility u=0.000000 metrics={'f1_val': 0.8267467643277715, 'auprc': 0.9486747186002433, 'loss_val': 0.4441354271206012, 'psi': 0.8755179460367603}-{'f1_val': 0.8720419782314206, 'auprc': 0.9654438489255892, 'loss_val': 0.31141809365369105, 'psi': 0.909402726509088}
[S7] START round=35 head_norm_before_train=1.737457 cos_to_last_merge=1.0000 (last merge round=33)
[S7] round=35 local utility u=0.000000 metrics={'f1_val': 0.4665744203257247, 'auprc': 0.7812900672049747, 'loss_val': 1.0734693601491039, 'psi': 0.5924606790774247}-{'f1_val': 0.5540348892926257, 'auprc': 0.7917808776687522, 'loss_val': 0.816014449886248, 'psi': 0.6491332846430763}
[S8] START round=35 head_norm_before_train=1.776272 cos_to_last_merge=0.9993 (last merge round=30)
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.9237501589064288, 'auprc': 0.9992634112880926, 'loss_val': 0.18110604276159206, 'psi': 0.9539554598590944}-{'f1_val': 0.9941802643052118, 'auprc': 0.9985884556413348, 'loss_val': 0.03385890806043387, 'psi': 0.995943540839661}
[S9] START round=35 head_norm_before_train=1.429328 cos_to_last_merge=1.0000 (last merge round=34)
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.9947734239942433, 'auprc': 0.9989875093598168, 'loss_val': 0.0464080296347845, 'psi': 0.9964590581404728}-{'f1_val': 0.9971029125121428, 'auprc': 0.9965797831905483, 'loss_val': 0.04413113344745618, 'psi': 0.996893660783505}
[S10] START round=35 head_norm_before_train=2.115114 (no previous merge yet)
[S10] round=35 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9960309356846374, 'loss_val': 0.025739292746146527, 'psi': 0.9952615398054785}-{'f1_val': 0.9951633020469546, 'auprc': 0.9963680493536984, 'loss_val': 0.025505014531540252, 'psi': 0.9956452009696521}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=35 head_norm_before_train=1.429328 cos_to_last_merge=1.0000 (last merge round=34)
[S11] round=35 local utility u=0.000000 metrics={'f1_val': 0.9794536628970224, 'auprc': 0.9991216475619138, 'loss_val': 0.13080424711409094, 'psi': 0.987320856762979}-{'f1_val': 0.9967224195815153, 'auprc': 0.9983243171677991, 'loss_val': 0.08757699637197644, 'psi': 0.9973631786160289}
[S13] START round=35 head_norm_before_train=1.647100 cos_to_last_merge=0.8649 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.865
[S13] round=35 local utility u=0.463909 metrics={'f1_val': 0.7090730934192949, 'auprc': 0.7382880917605276, 'loss_val': 1.0089331344928902, 'psi': 0.720759092755788}-{'f1_val': 0.620202510117093, 'auprc': 0.6363191825023808, 'loss_val': 1.0976209530323853, 'psi': 0.6266491790712081}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=35 head_norm_before_train=1.699584 cos_to_last_merge=1.0000 (last merge round=34)
[S14] round=35 local utility u=0.006380 metrics={'f1_val': 0.9974314937735356, 'auprc': 0.9967869853049702, 'loss_val': 0.0418111266469968, 'psi': 0.9971736903861095}-{'f1_val': 0.9961839019930665, 'auprc': 0.9969564430932712, 'loss_val': 0.04759327749840802, 'psi': 0.9964929184331484}
[S14] not sending this round → trigger blocked (psi=0.997)
[S15] START round=35 head_norm_before_train=1.520214 cos_to_last_merge=1.0000 (last merge round=34)
[S15] round=35 local utility u=0.393285 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9973807003988474, 'loss_val': 0.03731722044659571, 'psi': 0.9970002811920513}-{'f1_val': 0.9016001089992542, 'auprc': 0.996767115096975, 'loss_val': 0.2511665536485737, 'psi': 0.9396669114383426}
[S16] START round=35 head_norm_before_train=1.430032 cos_to_last_merge=0.9986 (last merge round=31)
[S16] round=35 local utility u=0.000000 metrics={'f1_val': 0.865812014043736, 'auprc': 0.9841918894475427, 'loss_val': 0.422924636635535, 'psi': 0.9131639642052586}-{'f1_val': 0.9913080206785505, 'auprc': 0.9910733199924625, 'loss_val': 0.08330833632017316, 'psi': 0.9912141404041154}
[S17] START round=35 head_norm_before_train=1.559366 cos_to_last_merge=0.9973 (last merge round=32)
[S17] round=35 local utility u=0.133898 metrics={'f1_val': 0.6588609597953272, 'auprc': 0.8762522121265941, 'loss_val': 0.9716406537834378, 'psi': 0.7458174607278341}-{'f1_val': 0.6253989940102124, 'auprc': 0.8558620808087797, 'loss_val': 0.977493736556289, 'psi': 0.7175842287296392}
[S17] not sending this round → trigger blocked (psi=0.746)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:58305
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] ⇄ pheromone p=0.022 → S7@127.0.0.1:58308
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=35 metric=0.9388 head_norm=1.440683
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.461298e-01
[S4] stored merged vector for next round verification (round=35)
[S4] DEBUG after merge:  round=35 metric=0.9388 head_norm=1.433167 delta_norm=0.146130
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.261 → S4@127.0.0.1:58304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:58315
[S15] sending update (kind=head size=1804 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] ⇄ pheromone p=0.047 → S9@127.0.0.1:58310
[S16] ⇄ pheromone p=0.254 → S6@127.0.0.1:58307
[S9] ⇄ pheromone p=0.010 → S11@127.0.0.1:58312
[S5] RECEIVED delta(kind=head bytes=1804) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.560665)
[S5] loaded HEAD from S15 (vec_in norm=1.560665)
[S5] cosine check vs S15: cos=0.9973
[S5] BUFFERED delta from S15 (total buffered=1)
[S5] sending update (kind=head size=1799 to 1 peers)
[S15] ⇄ pheromone p=0.151 → S5@127.0.0.1:58305
[S15] RECEIVED delta(kind=head bytes=1799) from S5
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.454352)
[S15] loaded HEAD from S5 (vec_in norm=1.454352)
[S15] cosine check vs S5: cos=0.9973
[S15] BUFFERED delta from S5 (total buffered=1)
[S7] ⇄ pheromone p=0.219 → S14@127.0.0.1:58314
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=35 metric=0.7005 head_norm=1.454352
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.692902e-02
[S5] stored merged vector for next round verification (round=35)
[S5] DEBUG after merge:  round=35 metric=0.7005 head_norm=1.506483 delta_norm=0.076929
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.413 → S15@127.0.0.1:58315
[S2] START round=36 head_norm_before_train=2.018651 (no previous merge yet)
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.6280020460148265, 'auprc': 0.7083064245539571, 'loss_val': 1.5849703461508773, 'psi': 0.6601237974304787}-{'f1_val': 0.6503751297139619, 'auprc': 0.7178936627875508, 'loss_val': 1.4152382244466561, 'psi': 0.6773825429433975}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=36 head_norm_before_train=2.039579 (no previous merge yet)
[S3] round=36 local utility u=0.088208 metrics={'f1_val': 0.9897903866502632, 'auprc': 0.9970803145745608, 'loss_val': 0.034998950417906724, 'psi': 0.9927063578199822}-{'f1_val': 0.964978637492565, 'auprc': 0.9970807015907576, 'loss_val': 0.06254481378886212, 'psi': 0.977819463131842}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=36 head_norm_before_train=1.433167 cos_to_last_merge=1.0000 (last merge round=35)
[S4] round=36 local utility u=0.091286 metrics={'f1_val': 0.9431891120632061, 'auprc': 0.9800865662678296, 'loss_val': 0.26393562139440674, 'psi': 0.9579480937450555}-{'f1_val': 0.9387754144330569, 'auprc': 0.9368833828835874, 'loss_val': 0.290415470078655, 'psi': 0.938018601813269}
[S5] START round=36 head_norm_before_train=1.506483 cos_to_last_merge=1.0000 (last merge round=35)
[S5] round=36 local utility u=0.000000 metrics={'f1_val': 0.5803346641923356, 'auprc': 0.7399403602612519, 'loss_val': 0.6958841828614934, 'psi': 0.6441769426199021}-{'f1_val': 0.7004932948021524, 'auprc': 0.9745688899911267, 'loss_val': 0.2901337622402446, 'psi': 0.8101235328777421}
[S6] START round=36 head_norm_before_train=1.451416 cos_to_last_merge=0.9999 (last merge round=34)
[S6] round=36 local utility u=0.000000 metrics={'f1_val': 0.7486401016063099, 'auprc': 0.8062268962337398, 'loss_val': 0.6418912533870673, 'psi': 0.7716748194572819}-{'f1_val': 0.8267467643277715, 'auprc': 0.9486747186002433, 'loss_val': 0.4441354271206012, 'psi': 0.8755179460367603}
[S7] START round=36 head_norm_before_train=1.744483 cos_to_last_merge=0.9999 (last merge round=33)
[S7] round=36 local utility u=1.000000 metrics={'f1_val': 0.6705747918605991, 'auprc': 0.8293025288291727, 'loss_val': 0.4214472856487676, 'psi': 0.7340658866480285}-{'f1_val': 0.4665744203257247, 'auprc': 0.7812900672049747, 'loss_val': 1.0734693601491039, 'psi': 0.5924606790774247}
[S8] START round=36 head_norm_before_train=1.796796 cos_to_last_merge=0.9989 (last merge round=30)
[S8] round=36 local utility u=0.283267 metrics={'f1_val': 0.9938130760262815, 'auprc': 0.998543901204643, 'loss_val': 0.032790909503456825, 'psi': 0.995705406097626}-{'f1_val': 0.9237501589064288, 'auprc': 0.9992634112880926, 'loss_val': 0.18110604276159206, 'psi': 0.9539554598590944}
[S9] START round=36 head_norm_before_train=1.447900 cos_to_last_merge=0.9999 (last merge round=34)
[S9] round=36 local utility u=0.004630 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9959694562999453, 'loss_val': 0.0420716629056797, 'psi': 0.9966495300272638}-{'f1_val': 0.9947734239942433, 'auprc': 0.9989875093598168, 'loss_val': 0.0464080296347845, 'psi': 0.9964590581404728}
[S10] START round=36 head_norm_before_train=2.123859 (no previous merge yet)
[S10] round=36 local utility u=0.001470 metrics={'f1_val': 0.9951633020469546, 'auprc': 0.9961470150395881, 'loss_val': 0.02563656108378034, 'psi': 0.995556787244008}-{'f1_val': 0.9947486092193725, 'auprc': 0.9960309356846374, 'loss_val': 0.025739292746146527, 'psi': 0.9952615398054785}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=36 head_norm_before_train=1.459902 cos_to_last_merge=0.9998 (last merge round=34)
[S11] round=36 local utility u=0.077980 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9982757374263471, 'loss_val': 0.07591852811600412, 'psi': 0.9973437467194481}-{'f1_val': 0.9794536628970224, 'auprc': 0.9991216475619138, 'loss_val': 0.13080424711409094, 'psi': 0.987320856762979}
[S13] START round=36 head_norm_before_train=1.654274 cos_to_last_merge=0.8629 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.863
[S13] round=36 local utility u=0.041944 metrics={'f1_val': 0.6642196047143537, 'auprc': 0.7949100357265294, 'loss_val': 0.8257891031445147, 'psi': 0.716495777119224}-{'f1_val': 0.7090730934192949, 'auprc': 0.7382880917605276, 'loss_val': 1.0089331344928902, 'psi': 0.720759092755788}
[S13] not sending this round → trigger blocked (psi=0.716)
[S14] START round=36 head_norm_before_train=1.711531 cos_to_last_merge=1.0000 (last merge round=34)
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.9968527342645841, 'auprc': 0.9967636895447308, 'loss_val': 0.03968482292620659, 'psi': 0.9968171163766428}-{'f1_val': 0.9974314937735356, 'auprc': 0.9967869853049702, 'loss_val': 0.0418111266469968, 'psi': 0.9971736903861095}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=36 head_norm_before_train=1.560665 cos_to_last_merge=0.9998 (last merge round=34)
[S15] round=36 local utility u=0.000004 metrics={'f1_val': 0.9967502409607594, 'auprc': 0.9980540736315539, 'loss_val': 0.03935039175346356, 'psi': 0.9972717740290771}-{'f1_val': 0.9967466683875206, 'auprc': 0.9973807003988474, 'loss_val': 0.03731722044659571, 'psi': 0.9970002811920513}
[S16] START round=36 head_norm_before_train=1.449010 cos_to_last_merge=0.9976 (last merge round=31)
[S16] round=36 local utility u=0.569667 metrics={'f1_val': 0.9915864049301352, 'auprc': 0.992019269920142, 'loss_val': 0.06171918792451501, 'psi': 0.9917595509261379}-{'f1_val': 0.865812014043736, 'auprc': 0.9841918894475427, 'loss_val': 0.422924636635535, 'psi': 0.9131639642052586}
[S17] START round=36 head_norm_before_train=1.613849 cos_to_last_merge=0.9950 (last merge round=32)
[S17] round=36 local utility u=0.000000 metrics={'f1_val': 0.5171365311417754, 'auprc': 0.8211283059009191, 'loss_val': 1.3377552609489514, 'psi': 0.6387332410454329}-{'f1_val': 0.6588609597953272, 'auprc': 0.8762522121265941, 'loss_val': 0.9716406537834378, 'psi': 0.7458174607278341}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:58310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:58312
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:58308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:58307
[S15] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:58314
[S16] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=36 metric=0.9968 head_norm=1.600353
[S15] _apply_head_vector_avg (torch): Δ‖w‖=9.981465e-02
[S15] stored merged vector for next round verification (round=36)
[S15] DEBUG after merge:  round=36 metric=0.9960 head_norm=1.525835 delta_norm=0.099815
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1799 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1803) from S8
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.813770)
[S7] loaded HEAD from S8 (vec_in norm=1.813770)
[S7] cosine check vs S8: cos=0.9972
[S7] BUFFERED delta from S8 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1799) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.487436)
[S9] loaded HEAD from S11 (vec_in norm=1.487436)
[S9] cosine check vs S11: cos=0.9989
[S9] BUFFERED delta from S11 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1801) from S9
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.464581)
[S11] loaded HEAD from S9 (vec_in norm=1.464581)
[S11] cosine check vs S9: cos=0.9989
[S11] BUFFERED delta from S9 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1799) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.469993)
[S6] loaded HEAD from S16 (vec_in norm=1.469993)
[S6] cosine check vs S16: cos=0.9908
[S6] BUFFERED delta from S16 (total buffered=1)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=36 metric=0.9967 head_norm=1.487436
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.653086e-02
[S11] stored merged vector for next round verification (round=36)
[S11] DEBUG after merge:  round=36 metric=0.9967 head_norm=1.475600 delta_norm=0.036531
[S11] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=36 metric=0.9971 head_norm=1.464581
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.653085e-02
[S9] stored merged vector for next round verification (round=36)
[S9] DEBUG after merge:  round=36 metric=0.9971 head_norm=1.475600 delta_norm=0.036531
[S9] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S7] sending update (kind=head size=1804 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1804) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.750054)
[S14] loaded HEAD from S7 (vec_in norm=1.750054)
[S14] cosine check vs S7: cos=0.9965
[S14] BUFFERED delta from S7 (total buffered=1)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=36 metric=0.6706 head_norm=1.750054
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.361691e-02
[S7] stored merged vector for next round verification (round=36)
[S7] DEBUG after merge:  round=36 metric=0.6703 head_norm=1.780675 delta_norm=0.073617
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=37 head_norm_before_train=2.036105 (no previous merge yet)
[S2] round=37 local utility u=0.104569 metrics={'f1_val': 0.6495095205797087, 'auprc': 0.7006599760958954, 'loss_val': 1.4819379909597852, 'psi': 0.6699697027861833}-{'f1_val': 0.6280020460148265, 'auprc': 0.7083064245539571, 'loss_val': 1.5849703461508773, 'psi': 0.6601237974304787}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=37 head_norm_before_train=2.052635 (no previous merge yet)
[S3] round=37 local utility u=0.028701 metrics={'f1_val': 0.9977814963782642, 'auprc': 0.9969269773409132, 'loss_val': 0.0250842765590573, 'psi': 0.9974396887633239}-{'f1_val': 0.9897903866502632, 'auprc': 0.9970803145745608, 'loss_val': 0.034998950417906724, 'psi': 0.9927063578199822}
[S3] not sending this round → trigger blocked (psi=0.997)
[S4] START round=37 head_norm_before_train=1.448968 cos_to_last_merge=0.9999 (last merge round=35)
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.9440287339713939, 'auprc': 0.9585950035855677, 'loss_val': 0.27659141964323625, 'psi': 0.9498552418170634}-{'f1_val': 0.9431891120632061, 'auprc': 0.9800865662678296, 'loss_val': 0.26393562139440674, 'psi': 0.9579480937450555}
[S5] START round=37 head_norm_before_train=1.513220 cos_to_last_merge=1.0000 (last merge round=35)
[S5] round=37 local utility u=0.999557 metrics={'f1_val': 0.7004938661094564, 'auprc': 0.9899242555501692, 'loss_val': 0.16767639490752664, 'psi': 0.8162660218857415}-{'f1_val': 0.5803346641923356, 'auprc': 0.7399403602612519, 'loss_val': 0.6958841828614934, 'psi': 0.6441769426199021}
[S6] START round=37 head_norm_before_train=1.472143 cos_to_last_merge=0.9995 (last merge round=34)
[S6] round=37 local utility u=0.489884 metrics={'f1_val': 0.8126485119451512, 'auprc': 0.9408567367411651, 'loss_val': 0.45006264391438244, 'psi': 0.8639318018635568}-{'f1_val': 0.7486401016063099, 'auprc': 0.8062268962337398, 'loss_val': 0.6418912533870673, 'psi': 0.7716748194572819}
[S7] START round=37 head_norm_before_train=1.780675 cos_to_last_merge=1.0000 (last merge round=36)
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.5624113655560583, 'auprc': 0.7916448006351039, 'loss_val': 0.7731303064710086, 'psi': 0.6541047395876766}-{'f1_val': 0.6705747918605991, 'auprc': 0.8293025288291727, 'loss_val': 0.4214472856487676, 'psi': 0.7340658866480285}
[S8] START round=37 head_norm_before_train=1.813770 cos_to_last_merge=0.9985 (last merge round=30)
[S8] round=37 local utility u=0.000000 metrics={'f1_val': 0.9882230176651405, 'auprc': 0.9990092411001252, 'loss_val': 0.04272959135602867, 'psi': 0.9925375070391345}-{'f1_val': 0.9938130760262815, 'auprc': 0.998543901204643, 'loss_val': 0.032790909503456825, 'psi': 0.995705406097626}
[S9] START round=37 head_norm_before_train=1.475600 cos_to_last_merge=1.0000 (last merge round=36)
[S9] round=37 local utility u=0.002449 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9964616813893641, 'loss_val': 0.03865055304576477, 'psi': 0.9968464200630314}-{'f1_val': 0.9971029125121428, 'auprc': 0.9959694562999453, 'loss_val': 0.0420716629056797, 'psi': 0.9966495300272638}
[S10] START round=37 head_norm_before_train=2.129040 (no previous merge yet)
[S10] round=37 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9960694628804723, 'loss_val': 0.025524735001721716, 'psi': 0.9952769506838124}-{'f1_val': 0.9951633020469546, 'auprc': 0.9961470150395881, 'loss_val': 0.02563656108378034, 'psi': 0.995556787244008}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=37 head_norm_before_train=1.475600 cos_to_last_merge=1.0000 (last merge round=36)
[S11] round=37 local utility u=0.002185 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9984847832062737, 'loss_val': 0.07217499878593177, 'psi': 0.9974273650314187}-{'f1_val': 0.9967224195815153, 'auprc': 0.9982757374263471, 'loss_val': 0.07591852811600412, 'psi': 0.9973437467194481}
[S13] START round=37 head_norm_before_train=1.660662 cos_to_last_merge=0.8622 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.862
[S13] round=37 local utility u=0.000000 metrics={'f1_val': 0.6644339171673557, 'auprc': 0.7580423509896069, 'loss_val': 1.0056070143868134, 'psi': 0.7018772906962563}-{'f1_val': 0.6642196047143537, 'auprc': 0.7949100357265294, 'loss_val': 0.8257891031445147, 'psi': 0.716495777119224}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=37 head_norm_before_train=1.724019 cos_to_last_merge=0.9999 (last merge round=34)
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.9967805075071389, 'auprc': 0.9967866182473891, 'loss_val': 0.041012849257189586, 'psi': 0.996782951803239}-{'f1_val': 0.9968527342645841, 'auprc': 0.9967636895447308, 'loss_val': 0.03968482292620659, 'psi': 0.9968171163766428}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=37 metric=0.9968 head_norm=1.735717
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.736756e-02
[S14] stored merged vector for next round verification (round=37)
[S14] DEBUG after merge:  round=37 metric=0.9968 head_norm=1.741182 delta_norm=0.077368
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S15] START round=37 head_norm_before_train=1.525835 cos_to_last_merge=1.0000 (last merge round=36)
[S15] round=37 local utility u=0.000000 metrics={'f1_val': 0.8993105336047318, 'auprc': 0.9962586803450475, 'loss_val': 0.25212864742604213, 'psi': 0.938089792300858}-{'f1_val': 0.9967502409607594, 'auprc': 0.9980540736315539, 'loss_val': 0.03935039175346356, 'psi': 0.9972717740290771}
[S16] START round=37 head_norm_before_train=1.469993 cos_to_last_merge=0.9964 (last merge round=31)
[S16] round=37 local utility u=0.006566 metrics={'f1_val': 0.9915588226900719, 'auprc': 0.9940773585068108, 'loss_val': 0.05459521048257919, 'psi': 0.9925662370167674}-{'f1_val': 0.9915864049301352, 'auprc': 0.992019269920142, 'loss_val': 0.06171918792451501, 'psi': 0.9917595509261379}
[S17] START round=37 head_norm_before_train=1.665080 cos_to_last_merge=0.9926 (last merge round=32)
[S17] round=37 local utility u=1.000000 metrics={'f1_val': 0.7745261796328569, 'auprc': 0.988948743401902, 'loss_val': 0.6202777905346643, 'psi': 0.8602952051404749}-{'f1_val': 0.5171365311417754, 'auprc': 0.8211283059009191, 'loss_val': 1.3377552609489514, 'psi': 0.6387332410454329}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.997)
[S16] not sending this round → trigger blocked (psi=0.993)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:58304
[S9] not sending this round → trigger blocked (psi=0.997)
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:58315
[S4] RECEIVED delta(kind=head bytes=1802) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.488400)
[S4] loaded HEAD from S6 (vec_in norm=1.488400)
[S4] cosine check vs S6: cos=0.9816
[S4] BUFFERED delta from S6 (total buffered=1)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=37 metric=0.8126 head_norm=1.488400
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.053981e-01
[S6] stored merged vector for next round verification (round=37)
[S6] DEBUG after merge:  round=37 metric=0.8082 head_norm=1.475465 delta_norm=0.105398
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S5] sending update (kind=head size=1797 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1797) from S5
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.517782)
[S15] loaded HEAD from S5 (vec_in norm=1.517782)
[S15] cosine check vs S5: cos=0.9995
[S15] BUFFERED delta from S5 (total buffered=1)
[S2] START round=38 head_norm_before_train=2.050570 (no previous merge yet)
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.6304177957567281, 'auprc': 0.6963822671202169, 'loss_val': 1.6542990836402391, 'psi': 0.6568035843021236}-{'f1_val': 0.6495095205797087, 'auprc': 0.7006599760958954, 'loss_val': 1.4819379909597852, 'psi': 0.6699697027861833}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=38 head_norm_before_train=2.064637 (no previous merge yet)
[S3] round=38 local utility u=0.000000 metrics={'f1_val': 0.9660958543001401, 'auprc': 0.997010371313363, 'loss_val': 0.0620283125244587, 'psi': 0.9784616611054293}-{'f1_val': 0.9977814963782642, 'auprc': 0.9969269773409132, 'loss_val': 0.0250842765590573, 'psi': 0.9974396887633239}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=38 head_norm_before_train=1.465059 cos_to_last_merge=0.9997 (last merge round=35)
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.9404104111414379, 'auprc': 0.9637576943762648, 'loss_val': 0.2917165854302054, 'psi': 0.9497493244353686}-{'f1_val': 0.9440287339713939, 'auprc': 0.9585950035855677, 'loss_val': 0.27659141964323625, 'psi': 0.9498552418170634}
[S5] START round=38 head_norm_before_train=1.517782 cos_to_last_merge=1.0000 (last merge round=35)
[S5] round=38 local utility u=0.000000 metrics={'f1_val': 0.47125982207149814, 'auprc': 0.8003926230956064, 'loss_val': 0.787637180991315, 'psi': 0.6029129424811415}-{'f1_val': 0.7004938661094564, 'auprc': 0.9899242555501692, 'loss_val': 0.16767639490752664, 'psi': 0.8162660218857415}
[S6] START round=38 head_norm_before_train=1.475465 cos_to_last_merge=1.0000 (last merge round=37)
[S6] round=38 local utility u=0.227847 metrics={'f1_val': 0.8637760173727373, 'auprc': 0.9615728953415308, 'loss_val': 0.36328264312685327, 'psi': 0.9028947685602547}-{'f1_val': 0.8126485119451512, 'auprc': 0.9408567367411651, 'loss_val': 0.45006264391438244, 'psi': 0.8639318018635568}
[S7] START round=38 head_norm_before_train=1.786093 cos_to_last_merge=1.0000 (last merge round=36)
[S7] round=38 local utility u=0.376620 metrics={'f1_val': 0.6384895340243288, 'auprc': 0.8059113130566141, 'loss_val': 0.5191585842680099, 'psi': 0.7054582456372429}-{'f1_val': 0.5624113655560583, 'auprc': 0.7916448006351039, 'loss_val': 0.7731303064710086, 'psi': 0.6541047395876766}
[S8] START round=38 head_norm_before_train=1.829281 cos_to_last_merge=0.9980 (last merge round=30)
[S8] round=38 local utility u=0.011381 metrics={'f1_val': 0.9907243993413981, 'auprc': 0.9992458153644554, 'loss_val': 0.03568515478911366, 'psi': 0.994132965750621}-{'f1_val': 0.9882230176651405, 'auprc': 0.9990092411001252, 'loss_val': 0.04272959135602867, 'psi': 0.9925375070391345}
[S9] START round=38 head_norm_before_train=1.492096 cos_to_last_merge=0.9999 (last merge round=36)
[S9] round=38 local utility u=0.000000 metrics={'f1_val': 0.9954158325366191, 'auprc': 0.9990567203343219, 'loss_val': 0.036996725621401924, 'psi': 0.9968721876557003}-{'f1_val': 0.9971029125121428, 'auprc': 0.9964616813893641, 'loss_val': 0.03865055304576477, 'psi': 0.9968464200630314}
[S10] START round=38 head_norm_before_train=2.138043 (no previous merge yet)
[S10] round=38 local utility u=0.001465 metrics={'f1_val': 0.9951633020469546, 'auprc': 0.9961703351413332, 'loss_val': 0.025386122984173344, 'psi': 0.995566115284706}-{'f1_val': 0.9947486092193725, 'auprc': 0.9960694628804723, 'loss_val': 0.025524735001721716, 'psi': 0.9952769506838124}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=38 head_norm_before_train=1.503963 cos_to_last_merge=0.9998 (last merge round=36)
[S11] round=38 local utility u=0.004542 metrics={'f1_val': 0.9966782942738902, 'auprc': 0.9990006745396653, 'loss_val': 0.0643742144084266, 'psi': 0.9976072463802003}-{'f1_val': 0.9967224195815153, 'auprc': 0.9984847832062737, 'loss_val': 0.07217499878593177, 'psi': 0.9974273650314187}
[S13] START round=38 head_norm_before_train=1.668281 cos_to_last_merge=0.8616 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.862
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.6395617002461012, 'auprc': 0.6646021314151414, 'loss_val': 1.0062301674817955, 'psi': 0.6495778727137173}-{'f1_val': 0.6644339171673557, 'auprc': 0.7580423509896069, 'loss_val': 1.0056070143868134, 'psi': 0.7018772906962563}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=38 head_norm_before_train=1.741182 cos_to_last_merge=1.0000 (last merge round=37)
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.9967805075071389, 'auprc': 0.9967876397050639, 'loss_val': 0.041148641990853434, 'psi': 0.9967833603863089}-{'f1_val': 0.9967805075071389, 'auprc': 0.9967866182473891, 'loss_val': 0.041012849257189586, 'psi': 0.996782951803239}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=38 head_norm_before_train=1.565702 cos_to_last_merge=0.9998 (last merge round=36)
[S15] round=38 local utility u=0.057338 metrics={'f1_val': 0.903170176196454, 'auprc': 0.9971942612061044, 'loss_val': 0.1634176580872732, 'psi': 0.9407798102003142}-{'f1_val': 0.8993105336047318, 'auprc': 0.9962586803450475, 'loss_val': 0.25212864742604213, 'psi': 0.938089792300858}
[S16] START round=38 head_norm_before_train=1.490587 cos_to_last_merge=0.9952 (last merge round=31)
[S16] round=38 local utility u=0.004167 metrics={'f1_val': 0.9907023209291154, 'auprc': 0.9976753629664964, 'loss_val': 0.05191646618610663, 'psi': 0.9934915377440677}-{'f1_val': 0.9915588226900719, 'auprc': 0.9940773585068108, 'loss_val': 0.05459521048257919, 'psi': 0.9925662370167674}
[S17] START round=38 head_norm_before_train=1.709781 cos_to_last_merge=0.9904 (last merge round=32)
[S17] round=38 local utility u=0.000000 metrics={'f1_val': 0.633854502308987, 'auprc': 0.9327670962566945, 'loss_val': 1.1559710190967118, 'psi': 0.7534195398880701}-{'f1_val': 0.7745261796328569, 'auprc': 0.988948743401902, 'loss_val': 0.6202777905346643, 'psi': 0.8602952051404749}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4]  timeout peer S11
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:58310
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] sending update (kind=head size=1806 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:58305
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=38 metric=0.9404 head_norm=1.479615
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.463179e-01
[S4] stored merged vector for next round verification (round=38)
[S4] DEBUG after merge:  round=38 metric=0.9404 head_norm=1.476783 delta_norm=0.146318
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:58309
[S15] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] RECEIVED delta(kind=head bytes=1800) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.531520)
[S9] loaded HEAD from S11 (vec_in norm=1.531520)
[S9] cosine check vs S11: cos=0.9991
[S9] BUFFERED delta from S11 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1798) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.605716)
[S5] loaded HEAD from S15 (vec_in norm=1.605716)
[S5] cosine check vs S15: cos=0.9987
[S5] BUFFERED delta from S15 (total buffered=1)
[S7] sending update (kind=head size=1803 to 1 peers)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=38 metric=0.9032 head_norm=1.605716
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.817144e-02
[S15] stored merged vector for next round verification (round=38)
[S15] DEBUG after merge:  round=38 metric=0.9032 head_norm=1.561284 delta_norm=0.058171
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S8] RECEIVED delta(kind=head bytes=1803) from S7
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.791707)
[S8] loaded HEAD from S7 (vec_in norm=1.791707)
[S8] cosine check vs S7: cos=0.9985
[S8] BUFFERED delta from S7 (total buffered=1)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=38 metric=0.4713 head_norm=1.522485
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.775249e-02
[S5] stored merged vector for next round verification (round=38)
[S5] DEBUG after merge:  round=38 metric=0.4814 head_norm=1.563588 delta_norm=0.057752
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=39 head_norm_before_train=2.061884 (no previous merge yet)
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.6112588755927217, 'auprc': 0.6966144784072869, 'loss_val': 1.8292939870497464, 'psi': 0.6454011167185478}-{'f1_val': 0.6304177957567281, 'auprc': 0.6963822671202169, 'loss_val': 1.6542990836402391, 'psi': 0.6568035843021236}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=40 psi=0.645 u=0.0000 p_local=0.0932 f1=0.611 auprc=0.697 bytes=25200
[S3] START round=39 head_norm_before_train=2.075586 (no previous merge yet)
[S3] round=39 local utility u=0.113310 metrics={'f1_val': 0.9977814963782642, 'auprc': 0.9967493673131762, 'loss_val': 0.024739720946982433, 'psi': 0.997368644752229}-{'f1_val': 0.9660958543001401, 'auprc': 0.997010371313363, 'loss_val': 0.0620283125244587, 'psi': 0.9784616611054293}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] sending update (kind=head size=1805 to 1 peers)
[S3] r=40 psi=0.997 u=0.1133 p_local=0.0648 f1=0.998 auprc=0.997 bytes=39639
[S4] START round=39 head_norm_before_train=1.476783 cos_to_last_merge=1.0000 (last merge round=38)
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.9456734739973948, 'auprc': 0.9444132783129532, 'loss_val': 0.2713143972084568, 'psi': 0.9451693957236181}-{'f1_val': 0.9404104111414379, 'auprc': 0.9637576943762648, 'loss_val': 0.2917165854302054, 'psi': 0.9497493244353686}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=40 psi=0.945 u=0.0000 p_local=0.0144 f1=0.946 auprc=0.944 bytes=32419
[S5] START round=39 head_norm_before_train=1.563588 cos_to_last_merge=1.0000 (last merge round=38)
[S5] round=39 local utility u=0.011340 metrics={'f1_val': 0.4503684847827017, 'auprc': 0.8558016447394388, 'loss_val': 0.8058360299997491, 'psi': 0.6125417487653966}-{'f1_val': 0.47125982207149814, 'auprc': 0.8003926230956064, 'loss_val': 0.787637180991315, 'psi': 0.6029129424811415}
[S6] START round=39 head_norm_before_train=1.501426 cos_to_last_merge=0.9998 (last merge round=37)
[S6] round=39 local utility u=0.000000 metrics={'f1_val': 0.7210563885339163, 'auprc': 0.9543541517140448, 'loss_val': 0.5534988450204401, 'psi': 0.8143754938059677}-{'f1_val': 0.8637760173727373, 'auprc': 0.9615728953415308, 'loss_val': 0.36328264312685327, 'psi': 0.9028947685602547}
[S7] START round=39 head_norm_before_train=1.791707 cos_to_last_merge=1.0000 (last merge round=36)
[S7] round=39 local utility u=0.000000 metrics={'f1_val': 0.5890525281167514, 'auprc': 0.7949941438878108, 'loss_val': 0.7042897548972475, 'psi': 0.6714291744251751}-{'f1_val': 0.6384895340243288, 'auprc': 0.8059113130566141, 'loss_val': 0.5191585842680099, 'psi': 0.7054582456372429}
[S8] START round=39 head_norm_before_train=1.847549 cos_to_last_merge=0.9975 (last merge round=30)
[S8] round=39 local utility u=0.000000 metrics={'f1_val': 0.8251823418662448, 'auprc': 0.9877559675533796, 'loss_val': 0.23391791016555563, 'psi': 0.8902117921410988}-{'f1_val': 0.9907243993413981, 'auprc': 0.9992458153644554, 'loss_val': 0.03568515478911366, 'psi': 0.994132965750621}
[S9] START round=39 head_norm_before_train=1.507098 cos_to_last_merge=0.9998 (last merge round=36)
[S9] round=39 local utility u=0.001057 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9956961179228164, 'loss_val': 0.03492253697113019, 'psi': 0.9965401946764123}-{'f1_val': 0.9954158325366191, 'auprc': 0.9990567203343219, 'loss_val': 0.036996725621401924, 'psi': 0.9968721876557003}
[S10] START round=39 head_norm_before_train=2.141945 (no previous merge yet)
[S10] round=39 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9962200259022358, 'loss_val': 0.025404995063343136, 'psi': 0.9953371758925178}-{'f1_val': 0.9951633020469546, 'auprc': 0.9961703351413332, 'loss_val': 0.025386122984173344, 'psi': 0.995566115284706}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=40 psi=0.995 u=0.0000 p_local=0.0012 f1=0.995 auprc=0.996 bytes=44964
[S11] START round=39 head_norm_before_train=1.531520 cos_to_last_merge=0.9994 (last merge round=36)
[S11] round=39 local utility u=0.003101 metrics={'f1_val': 0.9966782942738902, 'auprc': 0.999008080671509, 'loss_val': 0.05819447510027446, 'psi': 0.9976102088329377}-{'f1_val': 0.9966782942738902, 'auprc': 0.9990006745396653, 'loss_val': 0.0643742144084266, 'psi': 0.9976072463802003}
[S13] START round=39 head_norm_before_train=1.682239 cos_to_last_merge=0.8605 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.861
[S13] round=39 local utility u=0.270072 metrics={'f1_val': 0.6679452013370893, 'auprc': 0.7422449209615883, 'loss_val': 0.8693146993984342, 'psi': 0.697665089186889}-{'f1_val': 0.6395617002461012, 'auprc': 0.6646021314151414, 'loss_val': 1.0062301674817955, 'psi': 0.6495778727137173}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S13] r=40 psi=0.698 u=0.2701 p_local=0.1383 f1=0.668 auprc=0.742 bytes=36029
[S14] START round=39 head_norm_before_train=1.753024 cos_to_last_merge=1.0000 (last merge round=37)
[S14] round=39 local utility u=0.005063 metrics={'f1_val': 0.9976538428159559, 'auprc': 0.996846646010217, 'loss_val': 0.0364395381423131, 'psi': 0.9973309640936604}-{'f1_val': 0.9967805075071389, 'auprc': 0.9967876397050639, 'loss_val': 0.041148641990853434, 'psi': 0.9967833603863089}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S14] r=40 psi=0.997 u=0.0051 p_local=0.0155 f1=0.998 auprc=0.997 bytes=44937
[S15] START round=39 head_norm_before_train=1.561284 cos_to_last_merge=1.0000 (last merge round=38)
[S15] round=39 local utility u=0.336082 metrics={'f1_val': 0.9949235074714169, 'auprc': 0.9983576275247025, 'loss_val': 0.04526443339659769, 'psi': 0.9962971554927311}-{'f1_val': 0.903170176196454, 'auprc': 0.9971942612061044, 'loss_val': 0.1634176580872732, 'psi': 0.9407798102003142}
[S16] START round=39 head_norm_before_train=1.510358 cos_to_last_merge=0.9942 (last merge round=31)
[S16] round=39 local utility u=0.002672 metrics={'f1_val': 0.9911406723783132, 'auprc': 0.9976913157817424, 'loss_val': 0.0492503683600133, 'psi': 0.9937609297396849}-{'f1_val': 0.9907023209291154, 'auprc': 0.9976753629664964, 'loss_val': 0.05191646618610663, 'psi': 0.9934915377440677}
[S17] START round=39 head_norm_before_train=1.751511 cos_to_last_merge=0.9880 (last merge round=32)
[S17] round=39 local utility u=0.444336 metrics={'f1_val': 0.7567917012407634, 'auprc': 0.8615413751076479, 'loss_val': 0.7912448264325618, 'psi': 0.7986915707875173}-{'f1_val': 0.633854502308987, 'auprc': 0.9327670962566945, 'loss_val': 1.1559710190967118, 'psi': 0.7534195398880701}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S17] r=40 psi=0.799 u=0.4443 p_local=0.2507 f1=0.757 auprc=0.862 bytes=37742
[S11] not sending this round → trigger blocked (psi=0.998)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:58312
[S15] not sending this round → trigger blocked (psi=0.996)
[S16] not sending this round → trigger blocked (psi=0.994)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=40 psi=0.814 u=0.0000 p_local=0.2062 f1=0.721 auprc=0.954 bytes=36000
[S9] sending update (kind=head size=1796 to 1 peers)
[S16] r=40 psi=0.994 u=0.0027 p_local=0.1646 f1=0.991 auprc=0.998 bytes=39566
[S15] r=40 psi=0.996 u=0.3361 p_local=0.1382 f1=0.995 auprc=0.998 bytes=39582
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=39 metric=0.8252 head_norm=1.858122
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.120469e-02
[S8] stored merged vector for next round verification (round=39)
[S8] DEBUG after merge:  round=39 metric=0.8149 head_norm=1.824190 delta_norm=0.061205
[S8] aggregate: ROLLBACK (f1_val pre=0.825 post=0.815 tol_abs=0.005 tol_rel=0.0)
[S8] r=40 psi=0.890 u=0.0000 p_local=0.0399 f1=0.825 auprc=0.988 bytes=39644
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:58315
[S11] r=40 psi=0.998 u=0.0031 p_local=0.0290 f1=0.997 auprc=0.999 bytes=39570
[S11] RECEIVED delta(kind=head bytes=1796) from S9
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.521555)
[S11] loaded HEAD from S9 (vec_in norm=1.521555)
[S11] cosine check vs S9: cos=0.9982
[S11] BUFFERED delta from S9 (total buffered=1)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=39 metric=0.9971 head_norm=1.521555
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.610943e-02
[S9] stored merged vector for next round verification (round=39)
[S9] DEBUG after merge:  round=39 metric=0.9971 head_norm=1.526118 delta_norm=0.036109
[S9] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S9] r=40 psi=0.997 u=0.0011 p_local=0.0053 f1=0.997 auprc=0.996 bytes=48552
[S5] sending update (kind=head size=1797 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1797) from S5
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.567332)
[S15] loaded HEAD from S5 (vec_in norm=1.567332)
[S15] cosine check vs S5: cos=0.9997
[S15] BUFFERED delta from S5 (total buffered=1)
[S7] r=40 psi=0.671 u=0.0000 p_local=0.2523 f1=0.589 auprc=0.795 bytes=37807
[S5] r=40 psi=0.613 u=0.0113 p_local=0.2994 f1=0.450 auprc=0.856 bytes=41316
[S2] START round=40 head_norm_before_train=2.072050 (no previous merge yet)
[S2] round=40 local utility u=0.106151 metrics={'f1_val': 0.6287588287290921, 'auprc': 0.7018421863079025, 'loss_val': 1.7376741830427367, 'psi': 0.6579921717606163}-{'f1_val': 0.6112588755927217, 'auprc': 0.6966144784072869, 'loss_val': 1.8292939870497464, 'psi': 0.6454011167185478}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=40 head_norm_before_train=2.088274 (no previous merge yet)
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.9660958543001401, 'auprc': 0.9970688485137356, 'loss_val': 0.06251602351359803, 'psi': 0.9784850519855783}-{'f1_val': 0.9977814963782642, 'auprc': 0.9967493673131762, 'loss_val': 0.024739720946982433, 'psi': 0.997368644752229}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=40 head_norm_before_train=1.493187 cos_to_last_merge=0.9999 (last merge round=38)
[S4] round=40 local utility u=0.000000 metrics={'f1_val': 0.9393426190228547, 'auprc': 0.9526665556106225, 'loss_val': 0.3056435125056935, 'psi': 0.9446721936579618}-{'f1_val': 0.9456734739973948, 'auprc': 0.9444132783129532, 'loss_val': 0.2713143972084568, 'psi': 0.9451693957236181}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=40 head_norm_before_train=1.567332 cos_to_last_merge=1.0000 (last merge round=38)
[S5] round=40 local utility u=0.000000 metrics={'f1_val': 0.43676623050537206, 'auprc': 0.8557847595440333, 'loss_val': 0.9957750633036266, 'psi': 0.6043736421208366}-{'f1_val': 0.4503684847827017, 'auprc': 0.8558016447394388, 'loss_val': 0.8058360299997491, 'psi': 0.6125417487653966}
[S6] START round=40 head_norm_before_train=1.525858 cos_to_last_merge=0.9994 (last merge round=37)
[S6] round=40 local utility u=0.000000 metrics={'f1_val': 0.6269984217162434, 'auprc': 0.9438032243434559, 'loss_val': 0.6804002871910867, 'psi': 0.7537203427671284}-{'f1_val': 0.7210563885339163, 'auprc': 0.9543541517140448, 'loss_val': 0.5534988450204401, 'psi': 0.8143754938059677}
[S7] START round=40 head_norm_before_train=1.799161 cos_to_last_merge=0.9999 (last merge round=36)
[S7] round=40 local utility u=0.222700 metrics={'f1_val': 0.636486168846432, 'auprc': 0.8042925719662886, 'loss_val': 0.5713867258909109, 'psi': 0.7036087300943746}-{'f1_val': 0.5890525281167514, 'auprc': 0.7949941438878108, 'loss_val': 0.7042897548972475, 'psi': 0.6714291744251751}
[S8] START round=40 head_norm_before_train=1.824190 cos_to_last_merge=1.0000 (last merge round=39)
[S8] round=40 local utility u=0.597833 metrics={'f1_val': 0.9872874102666296, 'auprc': 0.9992698906188973, 'loss_val': 0.04542319314482496, 'psi': 0.9920804024075367}-{'f1_val': 0.8251823418662448, 'auprc': 0.9877559675533796, 'loss_val': 0.23391791016555563, 'psi': 0.8902117921410988}
[S9] START round=40 head_norm_before_train=1.526118 cos_to_last_merge=1.0000 (last merge round=39)
[S9] round=40 local utility u=0.001324 metrics={'f1_val': 0.9958601375429889, 'auprc': 0.9988347851581492, 'loss_val': 0.0342345811695458, 'psi': 0.9970499965890529}-{'f1_val': 0.9971029125121428, 'auprc': 0.9956961179228164, 'loss_val': 0.03492253697113019, 'psi': 0.9965401946764123}
[S10] START round=40 head_norm_before_train=2.149291 (no previous merge yet)
[S10] round=40 local utility u=0.001762 metrics={'f1_val': 0.9951633020469546, 'auprc': 0.9965770491200016, 'loss_val': 0.02543960263061089, 'psi': 0.9957288008761733}-{'f1_val': 0.9947486092193725, 'auprc': 0.9962200259022358, 'loss_val': 0.025404995063343136, 'psi': 0.9953371758925178}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=40 head_norm_before_train=1.558661 cos_to_last_merge=0.9988 (last merge round=36)
[S11] round=40 local utility u=0.000000 metrics={'f1_val': 0.9957161515329224, 'auprc': 0.9991036624939207, 'loss_val': 0.0566307738198305, 'psi': 0.9970711559173218}-{'f1_val': 0.9966782942738902, 'auprc': 0.999008080671509, 'loss_val': 0.05819447510027446, 'psi': 0.9976102088329377}
[S13] START round=40 head_norm_before_train=1.688936 cos_to_last_merge=0.8594 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.859
[S13] round=40 local utility u=0.108780 metrics={'f1_val': 0.6502648786343932, 'auprc': 0.825008984587118, 'loss_val': 0.7939641136165969, 'psi': 0.7201625210154832}-{'f1_val': 0.6679452013370893, 'auprc': 0.7422449209615883, 'loss_val': 0.8693146993984342, 'psi': 0.697665089186889}
[S13] not sending this round → trigger blocked (psi=0.720)
[S14] START round=40 head_norm_before_train=1.765544 cos_to_last_merge=0.9999 (last merge round=37)
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9967900282957993, 'loss_val': 0.03579351545959073, 'psi': 0.9971626078790166}-{'f1_val': 0.9976538428159559, 'auprc': 0.996846646010217, 'loss_val': 0.0364395381423131, 'psi': 0.9973309640936604}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=40 head_norm_before_train=1.601216 cos_to_last_merge=0.9998 (last merge round=38)
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.9027468058956304, 'auprc': 0.9973981826123662, 'loss_val': 0.17336224293701566, 'psi': 0.9406073565823247}-{'f1_val': 0.9949235074714169, 'auprc': 0.9983576275247025, 'loss_val': 0.04526443339659769, 'psi': 0.9962971554927311}
[S16] START round=40 head_norm_before_train=1.528272 cos_to_last_merge=0.9931 (last merge round=31)
[S16] round=40 local utility u=0.000000 metrics={'f1_val': 0.9567473167654018, 'auprc': 0.993053376382043, 'loss_val': 0.12065752614922917, 'psi': 0.9712697406120583}-{'f1_val': 0.9911406723783132, 'auprc': 0.9976913157817424, 'loss_val': 0.0492503683600133, 'psi': 0.9937609297396849}
[S17] START round=40 head_norm_before_train=1.777823 cos_to_last_merge=0.9865 (last merge round=32)
[S17] round=40 local utility u=0.565762 metrics={'f1_val': 0.8499468406434112, 'auprc': 0.9526765083261934, 'loss_val': 0.49205742688585596, 'psi': 0.891038707716524}-{'f1_val': 0.7567917012407634, 'auprc': 0.8615413751076479, 'loss_val': 0.7912448264325618, 'psi': 0.7986915707875173}
[S17] not sending this round → trigger blocked (psi=0.891)
[S9] not sending this round → trigger blocked (psi=0.997)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:58309
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=40 metric=0.9027 head_norm=1.636803
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.495984e-02
[S15] stored merged vector for next round verification (round=40)
[S15] DEBUG after merge:  round=40 metric=0.9027 head_norm=1.601813 delta_norm=0.044960
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.111 → S5@127.0.0.1:58305
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=40 metric=0.9957 head_norm=1.581051
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.173224e-02
[S11] stored merged vector for next round verification (round=40)
[S11] DEBUG after merge:  round=40 metric=0.9955 head_norm=1.550359 delta_norm=0.061732
[S11] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.023 → S9@127.0.0.1:58310
[S9] ⇄ pheromone p=0.004 → S11@127.0.0.1:58312
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1803) from S7
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.806389)
[S8] loaded HEAD from S7 (vec_in norm=1.806389)
[S8] cosine check vs S7: cos=0.9992
[S8] BUFFERED delta from S7 (total buffered=1)
[S5] ⇄ pheromone p=0.239 → S15@127.0.0.1:58315
[S7] ⇄ pheromone p=0.246 → S8@127.0.0.1:58309
[S2] START round=41 head_norm_before_train=2.077854 (no previous merge yet)
[S2] round=41 local utility u=0.000000 metrics={'f1_val': 0.5957791515273344, 'auprc': 0.6779399093122316, 'loss_val': 2.4993219205865396, 'psi': 0.6286434546412933}-{'f1_val': 0.6287588287290921, 'auprc': 0.7018421863079025, 'loss_val': 1.7376741830427367, 'psi': 0.6579921717606163}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=41 head_norm_before_train=2.098156 (no previous merge yet)
[S3] round=41 local utility u=0.108883 metrics={'f1_val': 0.9978100342676263, 'auprc': 0.9969811740599929, 'loss_val': 0.03477213232635134, 'psi': 0.9974784901845729}-{'f1_val': 0.9660958543001401, 'auprc': 0.9970688485137356, 'loss_val': 0.06251602351359803, 'psi': 0.9784850519855783}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] START round=41 head_norm_before_train=1.514354 cos_to_last_merge=0.9997 (last merge round=38)
[S4] round=41 local utility u=0.024651 metrics={'f1_val': 0.9421717171368664, 'auprc': 0.9551264320580861, 'loss_val': 0.28069637854268653, 'psi': 0.9473536031053542}-{'f1_val': 0.9393426190228547, 'auprc': 0.9526665556106225, 'loss_val': 0.3056435125056935, 'psi': 0.9446721936579618}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=41 head_norm_before_train=1.571013 cos_to_last_merge=0.9999 (last merge round=38)
[S5] round=41 local utility u=0.730764 metrics={'f1_val': 0.6033457609352193, 'auprc': 0.8647518543128248, 'loss_val': 0.5606264648881446, 'psi': 0.7079081982862615}-{'f1_val': 0.43676623050537206, 'auprc': 0.8557847595440333, 'loss_val': 0.9957750633036266, 'psi': 0.6043736421208366}
[S6] START round=41 head_norm_before_train=1.542194 cos_to_last_merge=0.9989 (last merge round=37)
[S6] round=41 local utility u=0.816744 metrics={'f1_val': 0.8465902862148047, 'auprc': 0.9483912270124684, 'loss_val': 0.3782278902158772, 'psi': 0.8873106625338701}-{'f1_val': 0.6269984217162434, 'auprc': 0.9438032243434559, 'loss_val': 0.6804002871910867, 'psi': 0.7537203427671284}
[S7] START round=41 head_norm_before_train=1.806389 cos_to_last_merge=0.9997 (last merge round=36)
[S7] round=41 local utility u=0.000000 metrics={'f1_val': 0.6107502124140514, 'auprc': 0.8015721807962973, 'loss_val': 0.6261929146811294, 'psi': 0.6870789997669497}-{'f1_val': 0.636486168846432, 'auprc': 0.8042925719662886, 'loss_val': 0.5713867258909109, 'psi': 0.7036087300943746}
[S8] START round=41 head_norm_before_train=1.831355 cos_to_last_merge=1.0000 (last merge round=39)
[S8] round=41 local utility u=0.024931 metrics={'f1_val': 0.9932593276801964, 'auprc': 0.9992632226064722, 'loss_val': 0.03137355087731964, 'psi': 0.9956608856507068}-{'f1_val': 0.9872874102666296, 'auprc': 0.9992698906188973, 'loss_val': 0.04542319314482496, 'psi': 0.9920804024075367}
[S9] START round=41 head_norm_before_train=1.539956 cos_to_last_merge=1.0000 (last merge round=39)
[S9] round=41 local utility u=0.002333 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.997134181713511, 'loss_val': 0.03192271694158918, 'psi': 0.9971154201926901}-{'f1_val': 0.9958601375429889, 'auprc': 0.9988347851581492, 'loss_val': 0.0342345811695458, 'psi': 0.9970499965890529}
[S10] START round=41 head_norm_before_train=2.158724 (no previous merge yet)
[S10] round=41 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.996131483596746, 'loss_val': 0.025647962137925997, 'psi': 0.9953017589703219}-{'f1_val': 0.9951633020469546, 'auprc': 0.9965770491200016, 'loss_val': 0.02543960263061089, 'psi': 0.9957288008761733}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=41 head_norm_before_train=1.550359 cos_to_last_merge=1.0000 (last merge round=40)
[S11] round=41 local utility u=0.002399 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9983808961017289, 'loss_val': 0.055701810126313825, 'psi': 0.9973858101896007}-{'f1_val': 0.9957161515329224, 'auprc': 0.9991036624939207, 'loss_val': 0.0566307738198305, 'psi': 0.9970711559173218}
[S13] START round=41 head_norm_before_train=1.691726 cos_to_last_merge=0.8592 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.859
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.7207790101900216, 'auprc': 0.7183838336252687, 'loss_val': 1.0318896352699254, 'psi': 0.7198209395641204}-{'f1_val': 0.6502648786343932, 'auprc': 0.825008984587118, 'loss_val': 0.7939641136165969, 'psi': 0.7201625210154832}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=41 head_norm_before_train=1.777177 cos_to_last_merge=0.9998 (last merge round=37)
[S14] round=41 local utility u=0.000499 metrics={'f1_val': 0.9970202894562089, 'auprc': 0.9968664763840983, 'loss_val': 0.03268141586582396, 'psi': 0.9969587642273647}-{'f1_val': 0.9974109942678281, 'auprc': 0.9967900282957993, 'loss_val': 0.03579351545959073, 'psi': 0.9971626078790166}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] START round=41 head_norm_before_train=1.601813 cos_to_last_merge=1.0000 (last merge round=40)
[S15] round=41 local utility u=0.236351 metrics={'f1_val': 0.9632120722874211, 'auprc': 0.9976382851686383, 'loss_val': 0.06417185310357004, 'psi': 0.9769825574399079}-{'f1_val': 0.9027468058956304, 'auprc': 0.9973981826123662, 'loss_val': 0.17336224293701566, 'psi': 0.9406073565823247}
[S16] START round=41 head_norm_before_train=1.541856 cos_to_last_merge=0.9922 (last merge round=31)
[S16] round=41 local utility u=0.146688 metrics={'f1_val': 0.9908535401463039, 'auprc': 0.9977799427340788, 'loss_val': 0.04609762599873572, 'psi': 0.9936241011814139}-{'f1_val': 0.9567473167654018, 'auprc': 0.993053376382043, 'loss_val': 0.12065752614922917, 'psi': 0.9712697406120583}
[S17] START round=41 head_norm_before_train=1.802516 cos_to_last_merge=0.9852 (last merge round=32)
[S17] round=41 local utility u=0.000000 metrics={'f1_val': 0.5989649309352157, 'auprc': 0.8214155095962465, 'loss_val': 1.4899448970461366, 'psi': 0.6879451623996281}-{'f1_val': 0.8499468406434112, 'auprc': 0.9526765083261934, 'loss_val': 0.49205742688585596, 'psi': 0.891038707716524}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:58310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:58312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S8] not sending this round → trigger blocked (psi=0.996)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1805 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=41 metric=0.9933 head_norm=1.836489
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.016887e-02
[S8] stored merged vector for next round verification (round=41)
[S8] DEBUG after merge:  round=41 metric=0.9933 head_norm=1.821058 delta_norm=0.040169
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:58315
[S5] RECEIVED delta(kind=head bytes=1805) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.633251)
[S5] loaded HEAD from S15 (vec_in norm=1.633251)
[S5] cosine check vs S15: cos=0.9994
[S5] BUFFERED delta from S15 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1795) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.570043)
[S9] loaded HEAD from S11 (vec_in norm=1.570043)
[S9] cosine check vs S11: cos=0.9995
[S9] BUFFERED delta from S11 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1797) from S9
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.552341)
[S11] loaded HEAD from S9 (vec_in norm=1.552341)
[S11] cosine check vs S9: cos=0.9995
[S11] BUFFERED delta from S9 (total buffered=1)
[S5] sending update (kind=head size=1802 to 1 peers)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=41 metric=0.9967 head_norm=1.570043
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.604097e-02
[S11] stored merged vector for next round verification (round=41)
[S11] DEBUG after merge:  round=41 metric=0.9967 head_norm=1.561000 delta_norm=0.026041
[S11] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=41 metric=0.9971 head_norm=1.552341
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.604097e-02
[S9] stored merged vector for next round verification (round=41)
[S9] DEBUG after merge:  round=41 metric=0.9971 head_norm=1.561000 delta_norm=0.026041
[S9] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S15] RECEIVED delta(kind=head bytes=1802) from S5
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.578019)
[S15] loaded HEAD from S5 (vec_in norm=1.578019)
[S15] cosine check vs S5: cos=0.9994
[S15] BUFFERED delta from S5 (total buffered=1)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=41 metric=0.6033 head_norm=1.578019
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.982706e-02
[S5] stored merged vector for next round verification (round=41)
[S5] DEBUG after merge:  round=41 metric=0.6054 head_norm=1.605379 delta_norm=0.039827
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=42 head_norm_before_train=2.082630 (no previous merge yet)
[S2] round=42 local utility u=0.940739 metrics={'f1_val': 0.6882158170989945, 'auprc': 0.7229660919363003, 'loss_val': 1.3075431393097408, 'psi': 0.7021159270339168}-{'f1_val': 0.5957791515273344, 'auprc': 0.6779399093122316, 'loss_val': 2.4993219205865396, 'psi': 0.6286434546412933}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=42 head_norm_before_train=2.107087 (no previous merge yet)
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.997041125214409, 'loss_val': 0.1092484819567493, 'psi': 0.9754615013254359}-{'f1_val': 0.9978100342676263, 'auprc': 0.9969811740599929, 'loss_val': 0.03477213232635134, 'psi': 0.9974784901845729}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=42 head_norm_before_train=1.533490 cos_to_last_merge=0.9994 (last merge round=38)
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.9407287401123796, 'auprc': 0.939175079066866, 'loss_val': 0.2878349365454793, 'psi': 0.9401072756941742}-{'f1_val': 0.9421717171368664, 'auprc': 0.9551264320580861, 'loss_val': 0.28069637854268653, 'psi': 0.9473536031053542}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=42 head_norm_before_train=1.605379 cos_to_last_merge=1.0000 (last merge round=41)
[S5] round=42 local utility u=0.592036 metrics={'f1_val': 0.7004938661094564, 'auprc': 0.9900748000381523, 'loss_val': 0.3354112321700185, 'psi': 0.8163262396809348}-{'f1_val': 0.6033457609352193, 'auprc': 0.8647518543128248, 'loss_val': 0.5606264648881446, 'psi': 0.7079081982862615}
[S6] START round=42 head_norm_before_train=1.559181 cos_to_last_merge=0.9983 (last merge round=37)
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.5971284871673869, 'auprc': 0.9013178888764733, 'loss_val': 0.8695384930053968, 'psi': 0.7188042478510215}-{'f1_val': 0.8465902862148047, 'auprc': 0.9483912270124684, 'loss_val': 0.3782278902158772, 'psi': 0.8873106625338701}
[S7] START round=42 head_norm_before_train=1.812791 cos_to_last_merge=0.9996 (last merge round=36)
[S7] round=42 local utility u=0.000000 metrics={'f1_val': 0.573217480503234, 'auprc': 0.7936979720660744, 'loss_val': 0.7806963258916568, 'psi': 0.6614096771283702}-{'f1_val': 0.6107502124140514, 'auprc': 0.8015721807962973, 'loss_val': 0.6261929146811294, 'psi': 0.6870789997669497}
[S8] START round=42 head_norm_before_train=1.821058 cos_to_last_merge=1.0000 (last merge round=41)
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.9925380579155019, 'auprc': 0.9991975119862159, 'loss_val': 0.03382661369010787, 'psi': 0.9952018395437875}-{'f1_val': 0.9932593276801964, 'auprc': 0.9992632226064722, 'loss_val': 0.03137355087731964, 'psi': 0.9956608856507068}
[S9] START round=42 head_norm_before_train=1.561000 cos_to_last_merge=1.0000 (last merge round=41)
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.9947734239942433, 'auprc': 0.998657732100225, 'loss_val': 0.03419383294528695, 'psi': 0.996327147236636}-{'f1_val': 0.9971029125121428, 'auprc': 0.997134181713511, 'loss_val': 0.03192271694158918, 'psi': 0.9971154201926901}
[S10] START round=42 head_norm_before_train=2.168514 (no previous merge yet)
[S10] round=42 local utility u=0.001899 metrics={'f1_val': 0.9951633020469546, 'auprc': 0.9965621639749502, 'loss_val': 0.025630632243696314, 'psi': 0.9957228468181528}-{'f1_val': 0.9947486092193725, 'auprc': 0.996131483596746, 'loss_val': 0.025647962137925997, 'psi': 0.9953017589703219}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=42 head_norm_before_train=1.561000 cos_to_last_merge=1.0000 (last merge round=41)
[S11] round=42 local utility u=0.000702 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9985742497225625, 'loss_val': 0.054877288005153235, 'psi': 0.9974631516379342}-{'f1_val': 0.9967224195815153, 'auprc': 0.9983808961017289, 'loss_val': 0.055701810126313825, 'psi': 0.9973858101896007}
[S13] START round=42 head_norm_before_train=1.694828 cos_to_last_merge=0.8590 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.859
[S13] round=42 local utility u=0.000000 metrics={'f1_val': 0.6208321744264386, 'auprc': 0.6482621299952822, 'loss_val': 1.1311275208756648, 'psi': 0.631804156653976}-{'f1_val': 0.7207790101900216, 'auprc': 0.7183838336252687, 'loss_val': 1.0318896352699254, 'psi': 0.7198209395641204}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=42 head_norm_before_train=1.789085 cos_to_last_merge=0.9997 (last merge round=37)
[S14] round=42 local utility u=0.000000 metrics={'f1_val': 0.9967774409524363, 'auprc': 0.9967033686541398, 'loss_val': 0.0329176771113642, 'psi': 0.9967478120331177}-{'f1_val': 0.9970202894562089, 'auprc': 0.9968664763840983, 'loss_val': 0.03268141586582396, 'psi': 0.9969587642273647}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=42 head_norm_before_train=1.633251 cos_to_last_merge=0.9999 (last merge round=40)
[S15] round=42 local utility u=0.116546 metrics={'f1_val': 0.9971172535281002, 'auprc': 0.9978324087647417, 'loss_val': 0.035094269088182264, 'psi': 0.9974033156227567}-{'f1_val': 0.9632120722874211, 'auprc': 0.9976382851686383, 'loss_val': 0.06417185310357004, 'psi': 0.9769825574399079}
[S16] START round=42 head_norm_before_train=1.556022 cos_to_last_merge=0.9913 (last merge round=31)
[S16] round=42 local utility u=0.000810 metrics={'f1_val': 0.991726697920398, 'auprc': 0.9966277790660955, 'loss_val': 0.046259135555680946, 'psi': 0.993687130378677}-{'f1_val': 0.9908535401463039, 'auprc': 0.9977799427340788, 'loss_val': 0.04609762599873572, 'psi': 0.9936241011814139}
[S17] START round=42 head_norm_before_train=1.823123 cos_to_last_merge=0.9840 (last merge round=32)
[S17] round=42 local utility u=1.000000 metrics={'f1_val': 0.8599649389125592, 'auprc': 0.9184396872652061, 'loss_val': 0.5330639900924075, 'psi': 0.8833548382536179}-{'f1_val': 0.5989649309352157, 'auprc': 0.8214155095962465, 'loss_val': 1.4899448970461366, 'psi': 0.6879451623996281}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.994)
[S11] not sending this round → trigger blocked (psi=0.997)
[S15] not sending this round → trigger blocked (psi=0.997)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.816)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=42 metric=0.9971 head_norm=1.665017
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.807014e-02
[S15] stored merged vector for next round verification (round=42)
[S15] DEBUG after merge:  round=42 metric=0.9971 head_norm=1.621062 delta_norm=0.058070
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=43 head_norm_before_train=2.081110 (no previous merge yet)
[S2] round=43 local utility u=0.029931 metrics={'f1_val': 0.6958358407417978, 'auprc': 0.7222682181124852, 'loss_val': 1.2913085808858875, 'psi': 0.7064087916900728}-{'f1_val': 0.6882158170989945, 'auprc': 0.7229660919363003, 'loss_val': 1.3075431393097408, 'psi': 0.7021159270339168}
[S2] not sending this round → trigger blocked (psi=0.706)
[S3] START round=43 head_norm_before_train=2.115417 (no previous merge yet)
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.7248963532691945, 'auprc': 0.9428231743475253, 'loss_val': 0.36817928894437807, 'psi': 0.8120670817005269}-{'f1_val': 0.9610750853994537, 'auprc': 0.997041125214409, 'loss_val': 0.1092484819567493, 'psi': 0.9754615013254359}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=43 head_norm_before_train=1.547669 cos_to_last_merge=0.9989 (last merge round=38)
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.8644175601006078, 'auprc': 0.9322643526571557, 'loss_val': 0.40813034551959554, 'psi': 0.8915562771232268}-{'f1_val': 0.9407287401123796, 'auprc': 0.939175079066866, 'loss_val': 0.2878349365454793, 'psi': 0.9401072756941742}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=43 head_norm_before_train=1.612432 cos_to_last_merge=1.0000 (last merge round=41)
[S5] round=43 local utility u=0.000000 metrics={'f1_val': 0.7004932948021524, 'auprc': 0.9640252022918666, 'loss_val': 0.3804404889039849, 'psi': 0.8059060577980381}-{'f1_val': 0.7004938661094564, 'auprc': 0.9900748000381523, 'loss_val': 0.3354112321700185, 'psi': 0.8163262396809348}
[S6] START round=43 head_norm_before_train=1.573451 cos_to_last_merge=0.9977 (last merge round=37)
[S6] round=43 local utility u=0.643628 metrics={'f1_val': 0.7427686104218962, 'auprc': 0.9534819760748012, 'loss_val': 0.612614596055243, 'psi': 0.8270539566830583}-{'f1_val': 0.5971284871673869, 'auprc': 0.9013178888764733, 'loss_val': 0.8695384930053968, 'psi': 0.7188042478510215}
[S7] START round=43 head_norm_before_train=1.818509 cos_to_last_merge=0.9995 (last merge round=36)
[S7] round=43 local utility u=0.425299 metrics={'f1_val': 0.65702419387647, 'auprc': 0.8076319237689953, 'loss_val': 0.47474074098731417, 'psi': 0.7172672858334801}-{'f1_val': 0.573217480503234, 'auprc': 0.7936979720660744, 'loss_val': 0.7806963258916568, 'psi': 0.6614096771283702}
[S8] START round=43 head_norm_before_train=1.834645 cos_to_last_merge=1.0000 (last merge round=41)
[S8] round=43 local utility u=0.000000 metrics={'f1_val': 0.9918109678295097, 'auprc': 0.9995119631889684, 'loss_val': 0.03567588611553003, 'psi': 0.9948913659732932}-{'f1_val': 0.9925380579155019, 'auprc': 0.9991975119862159, 'loss_val': 0.03382661369010787, 'psi': 0.9952018395437875}
[S9] START round=43 head_norm_before_train=1.573054 cos_to_last_merge=1.0000 (last merge round=41)
[S9] round=43 local utility u=0.000478 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9943089051125906, 'loss_val': 0.03170576675262537, 'psi': 0.9957390568038935}-{'f1_val': 0.9947734239942433, 'auprc': 0.998657732100225, 'loss_val': 0.03419383294528695, 'psi': 0.996327147236636}
[S10] START round=43 head_norm_before_train=2.175265 (no previous merge yet)
[S10] round=43 local utility u=0.000051 metrics={'f1_val': 0.9951633020469546, 'auprc': 0.9966315107995569, 'loss_val': 0.025735891575231085, 'psi': 0.9957505855479956}-{'f1_val': 0.9951633020469546, 'auprc': 0.9965621639749502, 'loss_val': 0.025630632243696314, 'psi': 0.9957228468181528}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=43 head_norm_before_train=1.580212 cos_to_last_merge=0.9999 (last merge round=41)
[S11] round=43 local utility u=0.000213 metrics={'f1_val': 0.9962419185632914, 'auprc': 0.9986297970080853, 'loss_val': 0.05173466200512639, 'psi': 0.9971970699412089}-{'f1_val': 0.9967224195815153, 'auprc': 0.9985742497225625, 'loss_val': 0.054877288005153235, 'psi': 0.9974631516379342}
[S13] START round=43 head_norm_before_train=1.697570 cos_to_last_merge=0.8592 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.859
[S13] round=43 local utility u=0.491226 metrics={'f1_val': 0.7092915567778523, 'auprc': 0.7179322014540558, 'loss_val': 0.888441650930045, 'psi': 0.7127478146483337}-{'f1_val': 0.6208321744264386, 'auprc': 0.6482621299952822, 'loss_val': 1.1311275208756648, 'psi': 0.631804156653976}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=43 head_norm_before_train=1.799678 cos_to_last_merge=0.9995 (last merge round=37)
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.9965344645149313, 'auprc': 0.9967897902711668, 'loss_val': 0.03224476673289103, 'psi': 0.9966365948174256}-{'f1_val': 0.9967774409524363, 'auprc': 0.9967033686541398, 'loss_val': 0.0329176771113642, 'psi': 0.9967478120331177}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=43 head_norm_before_train=1.621062 cos_to_last_merge=1.0000 (last merge round=42)
[S15] round=43 local utility u=0.000179 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9973019347758855, 'loss_val': 0.030920873564146953, 'psi': 0.9969687749428665}-{'f1_val': 0.9971172535281002, 'auprc': 0.9978324087647417, 'loss_val': 0.035094269088182264, 'psi': 0.9974033156227567}
[S16] START round=43 head_norm_before_train=1.570259 cos_to_last_merge=0.9904 (last merge round=31)
[S16] round=43 local utility u=0.000000 metrics={'f1_val': 0.9914570070691986, 'auprc': 0.9956293357628458, 'loss_val': 0.046020868387510155, 'psi': 0.9931259385466575}-{'f1_val': 0.991726697920398, 'auprc': 0.9966277790660955, 'loss_val': 0.046259135555680946, 'psi': 0.993687130378677}
[S17] START round=43 head_norm_before_train=1.830668 cos_to_last_merge=0.9840 (last merge round=32)
[S17] round=43 local utility u=0.000000 metrics={'f1_val': 0.6254291197228556, 'auprc': 0.933956353719807, 'loss_val': 1.2888161624746866, 'psi': 0.7488400133216362}-{'f1_val': 0.8599649389125592, 'auprc': 0.9184396872652061, 'loss_val': 0.5330639900924075, 'psi': 0.8833548382536179}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:58312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:58310
[S11] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:58309
[S15] sending update (kind=head size=1795 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] RECEIVED delta(kind=head bytes=1797) from S9
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.585053)
[S11] loaded HEAD from S9 (vec_in norm=1.585053)
[S11] cosine check vs S9: cos=0.9996
[S11] BUFFERED delta from S9 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1795) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.653084)
[S5] loaded HEAD from S15 (vec_in norm=1.653084)
[S5] cosine check vs S15: cos=0.9997
[S5] BUFFERED delta from S15 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1795) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.599673)
[S9] loaded HEAD from S11 (vec_in norm=1.599673)
[S9] cosine check vs S11: cos=0.9996
[S9] BUFFERED delta from S11 (total buffered=1)
[S7] sending update (kind=head size=1804 to 1 peers)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=43 metric=0.9962 head_norm=1.599673
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.344148e-02
[S11] stored merged vector for next round verification (round=43)
[S11] DEBUG after merge:  round=43 metric=0.9962 head_norm=1.592207 delta_norm=0.023441
[S11] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=43 metric=0.9967 head_norm=1.585053
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.344148e-02
[S9] stored merged vector for next round verification (round=43)
[S9] DEBUG after merge:  round=43 metric=0.9967 head_norm=1.592207 delta_norm=0.023441
[S9] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S8] RECEIVED delta(kind=head bytes=1804) from S7
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.823227)
[S8] loaded HEAD from S7 (vec_in norm=1.823227)
[S8] cosine check vs S7: cos=0.9991
[S8] BUFFERED delta from S7 (total buffered=1)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=43 metric=0.7005 head_norm=1.618253
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.680333e-02
[S5] stored merged vector for next round verification (round=43)
[S5] DEBUG after merge:  round=43 metric=0.7005 head_norm=1.635542 delta_norm=0.026803
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=44 head_norm_before_train=2.085060 (no previous merge yet)
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.6935849246643231, 'auprc': 0.7187531960746419, 'loss_val': 1.3201190603116466, 'psi': 0.7036522332284506}-{'f1_val': 0.6958358407417978, 'auprc': 0.7222682181124852, 'loss_val': 1.2913085808858875, 'psi': 0.7064087916900728}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=44 head_norm_before_train=2.123854 (no previous merge yet)
[S3] round=44 local utility u=1.000000 metrics={'f1_val': 0.9970158049264538, 'auprc': 0.9987422183222826, 'loss_val': 0.034407390548916436, 'psi': 0.9977063702847854}-{'f1_val': 0.7248963532691945, 'auprc': 0.9428231743475253, 'loss_val': 0.36817928894437807, 'psi': 0.8120670817005269}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=44 head_norm_before_train=1.567359 cos_to_last_merge=0.9984 (last merge round=38)
[S4] round=44 local utility u=0.339751 metrics={'f1_val': 0.9479380008850267, 'auprc': 0.9509777612464985, 'loss_val': 0.2858914566182705, 'psi': 0.9491539050296154}-{'f1_val': 0.8644175601006078, 'auprc': 0.9322643526571557, 'loss_val': 0.40813034551959554, 'psi': 0.8915562771232268}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=44 head_norm_before_train=1.635542 cos_to_last_merge=1.0000 (last merge round=43)
[S5] round=44 local utility u=0.000000 metrics={'f1_val': 0.6255174120207246, 'auprc': 0.8876138065497536, 'loss_val': 0.4753891144411041, 'psi': 0.7303559698323363}-{'f1_val': 0.7004932948021524, 'auprc': 0.9640252022918666, 'loss_val': 0.3804404889039849, 'psi': 0.8059060577980381}
[S6] START round=44 head_norm_before_train=1.593201 cos_to_last_merge=0.9970 (last merge round=37)
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.6487054991277064, 'auprc': 0.9549442892554312, 'loss_val': 0.6029175331476956, 'psi': 0.7712010151787962}-{'f1_val': 0.7427686104218962, 'auprc': 0.9534819760748012, 'loss_val': 0.612614596055243, 'psi': 0.8270539566830583}
[S7] START round=44 head_norm_before_train=1.823227 cos_to_last_merge=0.9993 (last merge round=36)
[S7] round=44 local utility u=0.000000 metrics={'f1_val': 0.591478276606369, 'auprc': 0.794164210940836, 'loss_val': 0.6742199165501357, 'psi': 0.6725526503401558}-{'f1_val': 0.65702419387647, 'auprc': 0.8076319237689953, 'loss_val': 0.47474074098731417, 'psi': 0.7172672858334801}
[S8] START round=44 head_norm_before_train=1.853151 cos_to_last_merge=0.9999 (last merge round=41)
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.9836229587527714, 'auprc': 0.9995343321428585, 'loss_val': 0.05337338805177918, 'psi': 0.9899875081088062}-{'f1_val': 0.9918109678295097, 'auprc': 0.9995119631889684, 'loss_val': 0.03567588611553003, 'psi': 0.9948913659732932}
[S9] START round=44 head_norm_before_train=1.592207 cos_to_last_merge=1.0000 (last merge round=43)
[S9] round=44 local utility u=0.004819 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9957502029950589, 'loss_val': 0.028854367002243524, 'psi': 0.9965618287053093}-{'f1_val': 0.9966924912647621, 'auprc': 0.9943089051125906, 'loss_val': 0.03170576675262537, 'psi': 0.9957390568038935}
[S10] START round=44 head_norm_before_train=2.179609 (no previous merge yet)
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9974442368298575, 'loss_val': 0.025809750280522188, 'psi': 0.9958268602635665}-{'f1_val': 0.9951633020469546, 'auprc': 0.9966315107995569, 'loss_val': 0.025735891575231085, 'psi': 0.9957505855479956}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=44 head_norm_before_train=1.592207 cos_to_last_merge=1.0000 (last merge round=43)
[S11] round=44 local utility u=0.003137 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9985087954704748, 'loss_val': 0.04798021138265967, 'psi': 0.9974369699370991}-{'f1_val': 0.9962419185632914, 'auprc': 0.9986297970080853, 'loss_val': 0.05173466200512639, 'psi': 0.9971970699412089}
[S13] START round=44 head_norm_before_train=1.699776 cos_to_last_merge=0.8590 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.859
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.7141796499497446, 'auprc': 0.7077867071454167, 'loss_val': 1.0074894185677663, 'psi': 0.7116224728280134}-{'f1_val': 0.7092915567778523, 'auprc': 0.7179322014540558, 'loss_val': 0.888441650930045, 'psi': 0.7127478146483337}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=44 head_norm_before_train=1.810474 cos_to_last_merge=0.9993 (last merge round=37)
[S14] round=44 local utility u=0.002600 metrics={'f1_val': 0.9971652929977585, 'auprc': 0.9969511167821776, 'loss_val': 0.031313655438358026, 'psi': 0.9970796225115262}-{'f1_val': 0.9965344645149313, 'auprc': 0.9967897902711668, 'loss_val': 0.03224476673289103, 'psi': 0.9966365948174256}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=44 head_norm_before_train=1.653084 cos_to_last_merge=0.9999 (last merge round=42)
[S15] round=44 local utility u=0.000000 metrics={'f1_val': 0.9016001089992542, 'auprc': 0.9972150942770799, 'loss_val': 0.22855660258738417, 'psi': 0.9398461031103845}-{'f1_val': 0.9967466683875206, 'auprc': 0.9973019347758855, 'loss_val': 0.030920873564146953, 'psi': 0.9969687749428665}
[S16] START round=44 head_norm_before_train=1.583405 cos_to_last_merge=0.9896 (last merge round=31)
[S16] round=44 local utility u=0.000000 metrics={'f1_val': 0.9360342443571118, 'auprc': 0.9885200775384246, 'loss_val': 0.15251770285848207, 'psi': 0.957028577629637}-{'f1_val': 0.9914570070691986, 'auprc': 0.9956293357628458, 'loss_val': 0.046020868387510155, 'psi': 0.9931259385466575}
[S17] START round=44 head_norm_before_train=1.843313 cos_to_last_merge=0.9834 (last merge round=32)
[S17] round=44 local utility u=1.000000 metrics={'f1_val': 0.9119876269698616, 'auprc': 0.9703410390294872, 'loss_val': 0.4362951881937233, 'psi': 0.9353289917937119}-{'f1_val': 0.6254291197228556, 'auprc': 0.933956353719807, 'loss_val': 1.2888161624746866, 'psi': 0.7488400133216362}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S5]  timeout peer S16
[S16]  timeout peer S6
[S7]  timeout peer S14
[S6]  timeout peer S4
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.997)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.997)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=44 metric=0.9836 head_norm=1.865147
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.830515e-02
[S8] stored merged vector for next round verification (round=44)
[S8] DEBUG after merge:  round=44 metric=0.9840 head_norm=1.843673 delta_norm=0.048305
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=45 head_norm_before_train=2.091472 (no previous merge yet)
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.6273818513535485, 'auprc': 0.7103217988726478, 'loss_val': 1.758643968139849, 'psi': 0.6605578303611882}-{'f1_val': 0.6935849246643231, 'auprc': 0.7187531960746419, 'loss_val': 1.3201190603116466, 'psi': 0.7036522332284506}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=45 head_norm_before_train=2.132666 (no previous merge yet)
[S3] round=45 local utility u=0.001061 metrics={'f1_val': 0.9976817496135393, 'auprc': 0.9979607490327707, 'loss_val': 0.03393599159605378, 'psi': 0.9977933493812319}-{'f1_val': 0.9970158049264538, 'auprc': 0.9987422183222826, 'loss_val': 0.034407390548916436, 'psi': 0.9977063702847854}
[S3] not sending this round → trigger blocked (psi=0.998)
[S4] START round=45 head_norm_before_train=1.586277 cos_to_last_merge=0.9979 (last merge round=38)
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.940859069022038, 'auprc': 0.943338500950871, 'loss_val': 0.29674525626970283, 'psi': 0.9418508417935711}-{'f1_val': 0.9479380008850267, 'auprc': 0.9509777612464985, 'loss_val': 0.2858914566182705, 'psi': 0.9491539050296154}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=45 head_norm_before_train=1.638558 cos_to_last_merge=1.0000 (last merge round=43)
[S5] round=45 local utility u=0.000000 metrics={'f1_val': 0.5635781127892209, 'auprc': 0.8571305849283752, 'loss_val': 0.6485355346152228, 'psi': 0.6809991016448826}-{'f1_val': 0.6255174120207246, 'auprc': 0.8876138065497536, 'loss_val': 0.4753891144411041, 'psi': 0.7303559698323363}
[S6] START round=45 head_norm_before_train=1.611151 cos_to_last_merge=0.9963 (last merge round=37)
[S6] round=45 local utility u=0.048042 metrics={'f1_val': 0.6684573657004484, 'auprc': 0.9545305405714164, 'loss_val': 0.6241034700925231, 'psi': 0.7828866356488356}-{'f1_val': 0.6487054991277064, 'auprc': 0.9549442892554312, 'loss_val': 0.6029175331476956, 'psi': 0.7712010151787962}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=45 head_norm_before_train=1.827417 cos_to_last_merge=0.9992 (last merge round=36)
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.5736362404371861, 'auprc': 0.7924924253477821, 'loss_val': 0.7735155422043533, 'psi': 0.6611787144014245}-{'f1_val': 0.591478276606369, 'auprc': 0.794164210940836, 'loss_val': 0.6742199165501357, 'psi': 0.6725526503401558}
[S8] START round=45 head_norm_before_train=1.843673 cos_to_last_merge=1.0000 (last merge round=44)
[S8] round=45 local utility u=0.040476 metrics={'f1_val': 0.9936253371144965, 'auprc': 0.9989143051319326, 'loss_val': 0.03057578865977705, 'psi': 0.995740924321471}-{'f1_val': 0.9836229587527714, 'auprc': 0.9995343321428585, 'loss_val': 0.05337338805177918, 'psi': 0.9899875081088062}
[S9] START round=45 head_norm_before_train=1.603020 cos_to_last_merge=1.0000 (last merge round=43)
[S9] round=45 local utility u=0.000000 metrics={'f1_val': 0.992684475148198, 'auprc': 0.9973859813585096, 'loss_val': 0.03743404044003757, 'psi': 0.9945650776323227}-{'f1_val': 0.9971029125121428, 'auprc': 0.9957502029950589, 'loss_val': 0.028854367002243524, 'psi': 0.9965618287053093}
[S10] START round=45 head_norm_before_train=2.180455 (no previous merge yet)
[S10] round=45 local utility u=0.001714 metrics={'f1_val': 0.9951633020469546, 'auprc': 0.9977132625905832, 'loss_val': 0.025677868625809876, 'psi': 0.996183286264406}-{'f1_val': 0.9947486092193725, 'auprc': 0.9974442368298575, 'loss_val': 0.025809750280522188, 'psi': 0.9958268602635665}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=45 head_norm_before_train=1.612384 cos_to_last_merge=0.9999 (last merge round=43)
[S11] round=45 local utility u=0.001101 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9986874704381511, 'loss_val': 0.04383428455725992, 'psi': 0.9972604389454816}-{'f1_val': 0.9967224195815153, 'auprc': 0.9985087954704748, 'loss_val': 0.04798021138265967, 'psi': 0.9974369699370991}
[S13] START round=45 head_norm_before_train=1.710083 cos_to_last_merge=0.8582 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.858
[S13] round=45 local utility u=0.049956 metrics={'f1_val': 0.7145262098742464, 'auprc': 0.7095066997987719, 'loss_val': 0.9148167315293909, 'psi': 0.7125184058440566}-{'f1_val': 0.7141796499497446, 'auprc': 0.7077867071454167, 'loss_val': 1.0074894185677663, 'psi': 0.7116224728280134}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S13] sending update (kind=head size=1807 to 1 peers)
[S14] START round=45 head_norm_before_train=1.820564 cos_to_last_merge=0.9991 (last merge round=37)
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.9974055297193176, 'auprc': 0.9969517949958877, 'loss_val': 0.03494972114349154, 'psi': 0.9972240358299457}-{'f1_val': 0.9971652929977585, 'auprc': 0.9969511167821776, 'loss_val': 0.031313655438358026, 'psi': 0.9970796225115262}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=45 head_norm_before_train=1.683869 cos_to_last_merge=0.9997 (last merge round=42)
[S15] round=45 local utility u=0.198235 metrics={'f1_val': 0.9480374134120665, 'auprc': 0.989486252097893, 'loss_val': 0.08752362756125037, 'psi': 0.9646169488863972}-{'f1_val': 0.9016001089992542, 'auprc': 0.9972150942770799, 'loss_val': 0.22855660258738417, 'psi': 0.9398461031103845}
[S16] START round=45 head_norm_before_train=1.593643 cos_to_last_merge=0.9888 (last merge round=31)
[S16] round=45 local utility u=0.229640 metrics={'f1_val': 0.9917337388513483, 'auprc': 0.993616304383366, 'loss_val': 0.04272260615599055, 'psi': 0.9924867650641553}-{'f1_val': 0.9360342443571118, 'auprc': 0.9885200775384246, 'loss_val': 0.15251770285848207, 'psi': 0.957028577629637}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=45 head_norm_before_train=1.854564 cos_to_last_merge=0.9829 (last merge round=32)
[S17] round=45 local utility u=0.000000 metrics={'f1_val': 0.6990914153379355, 'auprc': 0.9592374902122428, 'loss_val': 0.9850034428969613, 'psi': 0.8031498452876584}-{'f1_val': 0.9119876269698616, 'auprc': 0.9703410390294872, 'loss_val': 0.4362951881937233, 'psi': 0.9353289917937119}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:58305
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:58308
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:58310
[S8] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S9] ⇄ pheromone p=0.002 → S11@127.0.0.1:58312
[S5] ⇄ pheromone p=0.199 → S15@127.0.0.1:58315
[S7] ⇄ pheromone p=0.135 → S8@127.0.0.1:58309
[S7] RECEIVED delta(kind=head bytes=1803) from S8
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.859995)
[S7] loaded HEAD from S8 (vec_in norm=1.859995)
[S7] cosine check vs S8: cos=0.9994
[S7] BUFFERED delta from S8 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1800) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.711343)
[S5] loaded HEAD from S15 (vec_in norm=1.711343)
[S5] cosine check vs S15: cos=0.9993
[S5] BUFFERED delta from S15 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1799) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.631602)
[S9] loaded HEAD from S11 (vec_in norm=1.631602)
[S9] cosine check vs S11: cos=0.9997
[S9] BUFFERED delta from S11 (total buffered=1)
[S15] ⇄ pheromone p=0.107 → S5@127.0.0.1:58305
[S11] ⇄ pheromone p=0.009 → S9@127.0.0.1:58310
[S8] ⇄ pheromone p=0.060 → S7@127.0.0.1:58308
[S2] START round=46 head_norm_before_train=2.101840 (no previous merge yet)
[S2] round=46 local utility u=0.366439 metrics={'f1_val': 0.6785723157788838, 'auprc': 0.7161888895715371, 'loss_val': 1.350509689398462, 'psi': 0.6936189452959451}-{'f1_val': 0.6273818513535485, 'auprc': 0.7103217988726478, 'loss_val': 1.758643968139849, 'psi': 0.6605578303611882}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=46 head_norm_before_train=2.139545 (no previous merge yet)
[S3] round=46 local utility u=0.000000 metrics={'f1_val': 0.9605709740356257, 'auprc': 0.9972223254621053, 'loss_val': 0.12622774946722456, 'psi': 0.9752315146062176}-{'f1_val': 0.9976817496135393, 'auprc': 0.9979607490327707, 'loss_val': 0.03393599159605378, 'psi': 0.9977933493812319}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=46 head_norm_before_train=1.597897 cos_to_last_merge=0.9975 (last merge round=38)
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.9395966471664967, 'auprc': 0.9335859662876275, 'loss_val': 0.3057594139925289, 'psi': 0.937192374814949}-{'f1_val': 0.940859069022038, 'auprc': 0.943338500950871, 'loss_val': 0.29674525626970283, 'psi': 0.9418508417935711}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=46 head_norm_before_train=1.639943 cos_to_last_merge=1.0000 (last merge round=43)
[S5] round=46 local utility u=0.000000 metrics={'f1_val': 0.46001972881027986, 'auprc': 0.7041736361987982, 'loss_val': 0.8582780899120802, 'psi': 0.5576812917656873}-{'f1_val': 0.5635781127892209, 'auprc': 0.8571305849283752, 'loss_val': 0.6485355346152228, 'psi': 0.6809991016448826}
[S6] START round=46 head_norm_before_train=1.625535 cos_to_last_merge=0.9957 (last merge round=37)
[S6] round=46 local utility u=0.485830 metrics={'f1_val': 0.7868969607649402, 'auprc': 0.9651279853649234, 'loss_val': 0.39487295465815836, 'psi': 0.8581893706049335}-{'f1_val': 0.6684573657004484, 'auprc': 0.9545305405714164, 'loss_val': 0.6241034700925231, 'psi': 0.7828866356488356}
[S6] not sending this round → trigger blocked (psi=0.858)
[S7] START round=46 head_norm_before_train=1.834152 cos_to_last_merge=0.9991 (last merge round=36)
[S7] round=46 local utility u=0.077649 metrics={'f1_val': 0.590485997116549, 'auprc': 0.7947373418067901, 'loss_val': 0.7260506291240488, 'psi': 0.6721865349926455}-{'f1_val': 0.5736362404371861, 'auprc': 0.7924924253477821, 'loss_val': 0.7735155422043533, 'psi': 0.6611787144014245}
[S8] START round=46 head_norm_before_train=1.859995 cos_to_last_merge=1.0000 (last merge round=44)
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.9918109678295097, 'auprc': 0.9992503667458913, 'loss_val': 0.03305285675505442, 'psi': 0.9947867273960623}-{'f1_val': 0.9936253371144965, 'auprc': 0.9989143051319326, 'loss_val': 0.03057578865977705, 'psi': 0.995740924321471}
[S9] START round=46 head_norm_before_train=1.609940 cos_to_last_merge=1.0000 (last merge round=43)
[S9] round=46 local utility u=0.009611 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9932474137971157, 'loss_val': 0.029845167623662322, 'psi': 0.9953144602777035}-{'f1_val': 0.992684475148198, 'auprc': 0.9973859813585096, 'loss_val': 0.03743404044003757, 'psi': 0.9945650776323227}
[S10] START round=46 head_norm_before_train=2.187253 (no previous merge yet)
[S10] round=46 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.997706633860905, 'loss_val': 0.02557672682116796, 'psi': 0.9959318190759855}-{'f1_val': 0.9951633020469546, 'auprc': 0.9977132625905832, 'loss_val': 0.025677868625809876, 'psi': 0.996183286264406}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=46 head_norm_before_train=1.631602 cos_to_last_merge=0.9998 (last merge round=43)
[S11] round=46 local utility u=0.005367 metrics={'f1_val': 0.9974011907167429, 'auprc': 0.9989854941346503, 'loss_val': 0.040546049228369845, 'psi': 0.9980349120839059}-{'f1_val': 0.9963090846170353, 'auprc': 0.9986874704381511, 'loss_val': 0.04383428455725992, 'psi': 0.9972604389454816}
[S13] START round=46 head_norm_before_train=1.720087 cos_to_last_merge=0.8577 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.858
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.6427550769933451, 'auprc': 0.7355893472957603, 'loss_val': 1.0225903501828155, 'psi': 0.6798887851143112}-{'f1_val': 0.7145262098742464, 'auprc': 0.7095066997987719, 'loss_val': 0.9148167315293909, 'psi': 0.7125184058440566}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=46 head_norm_before_train=1.830473 cos_to_last_merge=0.9989 (last merge round=37)
[S14] round=46 local utility u=0.001309 metrics={'f1_val': 0.9967774409524363, 'auprc': 0.9969027193567874, 'loss_val': 0.028416307328837726, 'psi': 0.9968275523141767}-{'f1_val': 0.9974055297193176, 'auprc': 0.9969517949958877, 'loss_val': 0.03494972114349154, 'psi': 0.9972240358299457}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=46 head_norm_before_train=1.711343 cos_to_last_merge=0.9994 (last merge round=42)
[S15] round=46 local utility u=0.000000 metrics={'f1_val': 0.9249240727251564, 'auprc': 0.9950912497007218, 'loss_val': 0.08583515897294566, 'psi': 0.9529909435153826}-{'f1_val': 0.9480374134120665, 'auprc': 0.989486252097893, 'loss_val': 0.08752362756125037, 'psi': 0.9646169488863972}
[S16] START round=46 head_norm_before_train=1.604980 cos_to_last_merge=0.9880 (last merge round=31)
[S16] round=46 local utility u=0.000000 metrics={'f1_val': 0.9434735467018633, 'auprc': 0.9871354753068544, 'loss_val': 0.18502922896395568, 'psi': 0.9609383181438598}-{'f1_val': 0.9917337388513483, 'auprc': 0.993616304383366, 'loss_val': 0.04272260615599055, 'psi': 0.9924867650641553}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=46 head_norm_before_train=1.869394 cos_to_last_merge=0.9821 (last merge round=32)
[S17] round=46 local utility u=0.840071 metrics={'f1_val': 0.9042800860930098, 'auprc': 0.9413236970676976, 'loss_val': 0.4822516183803618, 'psi': 0.919097530482885}-{'f1_val': 0.6990914153379355, 'auprc': 0.9592374902122428, 'loss_val': 0.9850034428969613, 'psi': 0.8031498452876584}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:58309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:58312
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.998)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=46 metric=0.4600 head_norm=1.641899
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.610016e-02
[S5] stored merged vector for next round verification (round=46)
[S5] DEBUG after merge:  round=46 metric=0.4716 head_norm=1.676347 delta_norm=0.046100
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S11] RECEIVED delta(kind=head bytes=1797) from S9
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.617777)
[S11] loaded HEAD from S9 (vec_in norm=1.617777)
[S11] cosine check vs S9: cos=0.9994
[S11] BUFFERED delta from S9 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1801) from S7
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.840508)
[S8] loaded HEAD from S7 (vec_in norm=1.840508)
[S8] cosine check vs S7: cos=0.9990
[S8] BUFFERED delta from S7 (total buffered=1)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=46 metric=0.5905 head_norm=1.840508
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.509240e-02
[S7] stored merged vector for next round verification (round=46)
[S7] DEBUG after merge:  round=46 metric=0.5917 head_norm=1.849944 delta_norm=0.035092
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=46 metric=0.9967 head_norm=1.617777
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.322392e-02
[S9] stored merged vector for next round verification (round=46)
[S9] DEBUG after merge:  round=46 metric=0.9967 head_norm=1.624538 delta_norm=0.023224
[S9] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=47 head_norm_before_train=2.109051 (no previous merge yet)
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.6568752211309802, 'auprc': 0.7145518036065197, 'loss_val': 1.5834357485396628, 'psi': 0.679945854121196}-{'f1_val': 0.6785723157788838, 'auprc': 0.7161888895715371, 'loss_val': 1.350509689398462, 'psi': 0.6936189452959451}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=47 head_norm_before_train=2.143509 (no previous merge yet)
[S3] round=47 local utility u=0.027380 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.996996073530399, 'loss_val': 0.07357539656715009, 'psi': 0.9754195800754257}-{'f1_val': 0.9605709740356257, 'auprc': 0.9972223254621053, 'loss_val': 0.12622774946722456, 'psi': 0.9752315146062176}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=47 head_norm_before_train=1.608324 cos_to_last_merge=0.9970 (last merge round=38)
[S4] round=47 local utility u=0.000000 metrics={'f1_val': 0.9391007032241641, 'auprc': 0.9329157832071737, 'loss_val': 0.32127759771653225, 'psi': 0.936626735217368}-{'f1_val': 0.9395966471664967, 'auprc': 0.9335859662876275, 'loss_val': 0.3057594139925289, 'psi': 0.937192374814949}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=47 head_norm_before_train=1.676347 cos_to_last_merge=1.0000 (last merge round=46)
[S5] round=47 local utility u=1.000000 metrics={'f1_val': 0.7004938661094564, 'auprc': 0.9890510716906615, 'loss_val': 0.21557156207611108, 'psi': 0.8159167483419385}-{'f1_val': 0.46001972881027986, 'auprc': 0.7041736361987982, 'loss_val': 0.8582780899120802, 'psi': 0.5576812917656873}
[S6] START round=47 head_norm_before_train=1.640252 cos_to_last_merge=0.9951 (last merge round=37)
[S6] round=47 local utility u=0.147730 metrics={'f1_val': 0.8454876846186168, 'auprc': 0.949824126414139, 'loss_val': 0.40504626150779177, 'psi': 0.8872222613368257}-{'f1_val': 0.7868969607649402, 'auprc': 0.9651279853649234, 'loss_val': 0.39487295465815836, 'psi': 0.8581893706049335}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=47 head_norm_before_train=1.849944 cos_to_last_merge=1.0000 (last merge round=46)
[S7] round=47 local utility u=0.000000 metrics={'f1_val': 0.5717920419171563, 'auprc': 0.7932645347672849, 'loss_val': 0.7649613749306122, 'psi': 0.6603810390572078}-{'f1_val': 0.590485997116549, 'auprc': 0.7947373418067901, 'loss_val': 0.7260506291240488, 'psi': 0.6721865349926455}
[S8] START round=47 head_norm_before_train=1.880718 cos_to_last_merge=0.9998 (last merge round=44)
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.8325143748359195, 'auprc': 0.9993013218620526, 'loss_val': 0.4256021128918318, 'psi': 0.8992291536463728}-{'f1_val': 0.9918109678295097, 'auprc': 0.9992503667458913, 'loss_val': 0.03305285675505442, 'psi': 0.9947867273960623}
[S9] START round=47 head_norm_before_train=1.624538 cos_to_last_merge=1.0000 (last merge round=46)
[S9] round=47 local utility u=0.009218 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9985158474433266, 'loss_val': 0.027022931147016867, 'psi': 0.9974026460656655}-{'f1_val': 0.9966924912647621, 'auprc': 0.9932474137971157, 'loss_val': 0.029845167623662322, 'psi': 0.9953144602777035}
[S10] START round=47 head_norm_before_train=2.196073 (no previous merge yet)
[S10] round=47 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9976656900708004, 'loss_val': 0.025625805756421656, 'psi': 0.9959154415599436}-{'f1_val': 0.9947486092193725, 'auprc': 0.997706633860905, 'loss_val': 0.02557672682116796, 'psi': 0.9959318190759855}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=47 head_norm_before_train=1.649889 cos_to_last_merge=0.9996 (last merge round=43)
[S11] round=47 local utility u=0.000000 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9988702223838238, 'loss_val': 0.039335012822934175, 'psi': 0.9975815407024388}-{'f1_val': 0.9974011907167429, 'auprc': 0.9989854941346503, 'loss_val': 0.040546049228369845, 'psi': 0.9980349120839059}
[S13] START round=47 head_norm_before_train=1.725523 cos_to_last_merge=0.8572 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.857
[S13] round=47 local utility u=0.306529 metrics={'f1_val': 0.696772394260883, 'auprc': 0.7376698277038289, 'loss_val': 0.7398783277597776, 'psi': 0.7131313676380613}-{'f1_val': 0.6427550769933451, 'auprc': 0.7355893472957603, 'loss_val': 1.0225903501828155, 'psi': 0.6798887851143112}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=47 head_norm_before_train=1.838229 cos_to_last_merge=0.9987 (last merge round=37)
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.9851734501441849, 'auprc': 0.9968773834888254, 'loss_val': 0.04715319379704613, 'psi': 0.9898550234820411}-{'f1_val': 0.9967774409524363, 'auprc': 0.9969027193567874, 'loss_val': 0.028416307328837726, 'psi': 0.9968275523141767}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=47 head_norm_before_train=1.734651 cos_to_last_merge=0.9990 (last merge round=42)
[S15] round=47 local utility u=0.000000 metrics={'f1_val': 0.8126786019786039, 'auprc': 0.9138391858129067, 'loss_val': 0.4105738823622974, 'psi': 0.853142835512325}-{'f1_val': 0.9249240727251564, 'auprc': 0.9950912497007218, 'loss_val': 0.08583515897294566, 'psi': 0.9529909435153826}
[S16] START round=47 head_norm_before_train=1.613968 cos_to_last_merge=0.9873 (last merge round=31)
[S16] round=47 local utility u=0.220625 metrics={'f1_val': 0.9916758954598626, 'auprc': 0.9920812476640841, 'loss_val': 0.04783073412925624, 'psi': 0.9918380363415512}-{'f1_val': 0.9434735467018633, 'auprc': 0.9871354753068544, 'loss_val': 0.18502922896395568, 'psi': 0.9609383181438598}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=47 head_norm_before_train=1.889616 cos_to_last_merge=0.9808 (last merge round=32)
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.6195623597655763, 'auprc': 0.8972956094883696, 'loss_val': 1.3880234594569354, 'psi': 0.7306556596546936}-{'f1_val': 0.9042800860930098, 'auprc': 0.9413236970676976, 'loss_val': 0.4822516183803618, 'psi': 0.919097530482885}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:58315
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1804 to 1 peers)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=47 metric=0.8325 head_norm=1.897681
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.587276e-02
[S8] stored merged vector for next round verification (round=47)
[S8] DEBUG after merge:  round=47 metric=0.8355 head_norm=1.868478 delta_norm=0.055873
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=47 metric=0.9967 head_norm=1.666990
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.295768e-02
[S11] stored merged vector for next round verification (round=47)
[S11] DEBUG after merge:  round=47 metric=0.9967 head_norm=1.642006 delta_norm=0.042958
[S11] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S15] RECEIVED delta(kind=head bytes=1804) from S5
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.677460)
[S15] loaded HEAD from S5 (vec_in norm=1.677460)
[S15] cosine check vs S5: cos=0.9994
[S15] BUFFERED delta from S5 (total buffered=1)
[S2] START round=48 head_norm_before_train=2.116918 (no previous merge yet)
[S2] round=48 local utility u=0.000000 metrics={'f1_val': 0.6552366476111714, 'auprc': 0.7114396160756807, 'loss_val': 1.5791866177889924, 'psi': 0.6777178349969751}-{'f1_val': 0.6568752211309802, 'auprc': 0.7145518036065197, 'loss_val': 1.5834357485396628, 'psi': 0.679945854121196}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=48 head_norm_before_train=2.149282 (no previous merge yet)
[S3] round=48 local utility u=0.124270 metrics={'f1_val': 0.9953166962312615, 'auprc': 0.9969757299714865, 'loss_val': 0.030662869840779244, 'psi': 0.9959803097273515}-{'f1_val': 0.9610352511054436, 'auprc': 0.996996073530399, 'loss_val': 0.07357539656715009, 'psi': 0.9754195800754257}
[S3] not sending this round → trigger blocked (psi=0.996)
[S4] START round=48 head_norm_before_train=1.620303 cos_to_last_merge=0.9966 (last merge round=38)
[S4] round=48 local utility u=0.038696 metrics={'f1_val': 0.9412489990967361, 'auprc': 0.9473091513558456, 'loss_val': 0.29995497367994217, 'psi': 0.9436730600003799}-{'f1_val': 0.9391007032241641, 'auprc': 0.9329157832071737, 'loss_val': 0.32127759771653225, 'psi': 0.936626735217368}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=48 head_norm_before_train=1.677460 cos_to_last_merge=1.0000 (last merge round=46)
[S5] round=48 local utility u=0.000000 metrics={'f1_val': 0.42003571737649753, 'auprc': 0.8254842937237695, 'loss_val': 1.449104175967453, 'psi': 0.5822151479154063}-{'f1_val': 0.7004938661094564, 'auprc': 0.9890510716906615, 'loss_val': 0.21557156207611108, 'psi': 0.8159167483419385}
[S6] START round=48 head_norm_before_train=1.653540 cos_to_last_merge=0.9944 (last merge round=37)
[S6] round=48 local utility u=0.000000 metrics={'f1_val': 0.5976323236194052, 'auprc': 0.7509435678815293, 'loss_val': 1.007054962766129, 'psi': 0.6589568213242549}-{'f1_val': 0.8454876846186168, 'auprc': 0.949824126414139, 'loss_val': 0.40504626150779177, 'psi': 0.8872222613368257}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=48 head_norm_before_train=1.855981 cos_to_last_merge=1.0000 (last merge round=46)
[S7] round=48 local utility u=0.191222 metrics={'f1_val': 0.6083232868708971, 'auprc': 0.7987363089591758, 'loss_val': 0.6181210632806124, 'psi': 0.6844884957062086}-{'f1_val': 0.5717920419171563, 'auprc': 0.7932645347672849, 'loss_val': 0.7649613749306122, 'psi': 0.6603810390572078}
[S8] START round=48 head_norm_before_train=1.868478 cos_to_last_merge=1.0000 (last merge round=47)
[S8] round=48 local utility u=0.677580 metrics={'f1_val': 0.9928938724649488, 'auprc': 0.9987158252501593, 'loss_val': 0.030962433300299404, 'psi': 0.995222653579033}-{'f1_val': 0.8325143748359195, 'auprc': 0.9993013218620526, 'loss_val': 0.4256021128918318, 'psi': 0.8992291536463728}
[S9] START round=48 head_norm_before_train=1.632607 cos_to_last_merge=1.0000 (last merge round=46)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.993909773892786, 'auprc': 0.9979534420425129, 'loss_val': 0.032081711471206246, 'psi': 0.9955272411526768}-{'f1_val': 0.9966605118138915, 'auprc': 0.9985158474433266, 'loss_val': 0.027022931147016867, 'psi': 0.9974026460656655}
[S10] START round=48 head_norm_before_train=2.204319 (no previous merge yet)
[S10] round=48 local utility u=0.001020 metrics={'f1_val': 0.9951633020469546, 'auprc': 0.9975603941429798, 'loss_val': 0.02575843053787606, 'psi': 0.9961221388853647}-{'f1_val': 0.9947486092193725, 'auprc': 0.9976656900708004, 'loss_val': 0.025625805756421656, 'psi': 0.9959154415599436}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=48 head_norm_before_train=1.642006 cos_to_last_merge=1.0000 (last merge round=47)
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9984840672632895, 'loss_val': 0.04009111791058195, 'psi': 0.997427078654225}-{'f1_val': 0.9967224195815153, 'auprc': 0.9988702223838238, 'loss_val': 0.039335012822934175, 'psi': 0.9975815407024388}
[S13] START round=48 head_norm_before_train=1.739635 cos_to_last_merge=0.8556 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.856
[S13] round=48 local utility u=0.000000 metrics={'f1_val': 0.7126473832571059, 'auprc': 0.7175665514062645, 'loss_val': 0.9980658803654295, 'psi': 0.7146150505167692}-{'f1_val': 0.696772394260883, 'auprc': 0.7376698277038289, 'loss_val': 0.7398783277597776, 'psi': 0.7131313676380613}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=48 head_norm_before_train=1.846585 cos_to_last_merge=0.9985 (last merge round=37)
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.9762186322987483, 'auprc': 0.9969584683188382, 'loss_val': 0.05419068883820719, 'psi': 0.9845145667067842}-{'f1_val': 0.9851734501441849, 'auprc': 0.9968773834888254, 'loss_val': 0.04715319379704613, 'psi': 0.9898550234820411}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=48 head_norm_before_train=1.755476 cos_to_last_merge=0.9987 (last merge round=42)
[S15] round=48 local utility u=0.872181 metrics={'f1_val': 0.9971172535281002, 'auprc': 0.9973156198284892, 'loss_val': 0.023272676256868643, 'psi': 0.9971966000482557}-{'f1_val': 0.8126786019786039, 'auprc': 0.9138391858129067, 'loss_val': 0.4105738823622974, 'psi': 0.853142835512325}
[S16] START round=48 head_norm_before_train=1.623057 cos_to_last_merge=0.9866 (last merge round=31)
[S16] round=48 local utility u=0.007447 metrics={'f1_val': 0.9914570070691986, 'auprc': 0.9958266570054993, 'loss_val': 0.04285884714911058, 'psi': 0.9932048670437189}-{'f1_val': 0.9916758954598626, 'auprc': 0.9920812476640841, 'loss_val': 0.04783073412925624, 'psi': 0.9918380363415512}
[S16] not sending this round → trigger blocked (psi=0.993)
[S17] START round=48 head_norm_before_train=1.907955 cos_to_last_merge=0.9798 (last merge round=32)
[S17] round=48 local utility u=1.000000 metrics={'f1_val': 0.9030925847504625, 'auprc': 0.934393876304051, 'loss_val': 0.4974490086723465, 'psi': 0.9156131013718979}-{'f1_val': 0.6195623597655763, 'auprc': 0.8972956094883696, 'loss_val': 1.3880234594569354, 'psi': 0.7306556596546936}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:58305
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:58309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:58308
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1798) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.774364)
[S5] loaded HEAD from S15 (vec_in norm=1.774364)
[S5] cosine check vs S15: cos=0.9992
[S5] BUFFERED delta from S15 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1801) from S8
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.876134)
[S7] loaded HEAD from S8 (vec_in norm=1.876134)
[S7] cosine check vs S8: cos=0.9999
[S7] BUFFERED delta from S8 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1801) from S7
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.863091)
[S8] loaded HEAD from S7 (vec_in norm=1.863091)
[S8] cosine check vs S7: cos=0.9999
[S8] BUFFERED delta from S7 (total buffered=1)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=48 metric=0.9929 head_norm=1.876134
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.654669e-02
[S8] stored merged vector for next round verification (round=48)
[S8] DEBUG after merge:  round=48 metric=0.9929 head_norm=1.869550 delta_norm=0.016547
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=48 metric=0.6083 head_norm=1.863091
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.654668e-02
[S7] stored merged vector for next round verification (round=48)
[S7] DEBUG after merge:  round=48 metric=0.6087 head_norm=1.869550 delta_norm=0.016547
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=48 metric=0.9971 head_norm=1.774364
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.914032e-02
[S15] stored merged vector for next round verification (round=48)
[S15] DEBUG after merge:  round=48 metric=0.9971 head_norm=1.725579 delta_norm=0.059140
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=49 head_norm_before_train=2.129386 (no previous merge yet)
[S2] round=49 local utility u=0.000000 metrics={'f1_val': 0.6509005598829092, 'auprc': 0.690628668004725, 'loss_val': 1.6527915853688009, 'psi': 0.6667918031316356}-{'f1_val': 0.6552366476111714, 'auprc': 0.7114396160756807, 'loss_val': 1.5791866177889924, 'psi': 0.6777178349969751}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=49 head_norm_before_train=2.157691 (no previous merge yet)
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.9309175449368126, 'auprc': 0.9972413428513647, 'loss_val': 0.13023568682310385, 'psi': 0.9574470641026334}-{'f1_val': 0.9953166962312615, 'auprc': 0.9969757299714865, 'loss_val': 0.030662869840779244, 'psi': 0.9959803097273515}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=49 head_norm_before_train=1.631002 cos_to_last_merge=0.9961 (last merge round=38)
[S4] round=49 local utility u=0.009718 metrics={'f1_val': 0.9464843513311231, 'auprc': 0.9436901478028938, 'loss_val': 0.3010731505484264, 'psi': 0.9453666699198314}-{'f1_val': 0.9412489990967361, 'auprc': 0.9473091513558456, 'loss_val': 0.29995497367994217, 'psi': 0.9436730600003799}
[S4] not sending this round → trigger blocked (psi=0.945)
[S5] START round=49 head_norm_before_train=1.678551 cos_to_last_merge=1.0000 (last merge round=46)
[S5] round=49 local utility u=1.000000 metrics={'f1_val': 0.9886347870769929, 'auprc': 0.9960995092802055, 'loss_val': 0.15759286432450964, 'psi': 0.991620675958278}-{'f1_val': 0.42003571737649753, 'auprc': 0.8254842937237695, 'loss_val': 1.449104175967453, 'psi': 0.5822151479154063}
[S6] START round=49 head_norm_before_train=1.669083 cos_to_last_merge=0.9937 (last merge round=37)
[S6] round=49 local utility u=1.000000 metrics={'f1_val': 0.877451435125875, 'auprc': 0.9795528983861629, 'loss_val': 0.28658828473745823, 'psi': 0.9182920204299901}-{'f1_val': 0.5976323236194052, 'auprc': 0.7509435678815293, 'loss_val': 1.007054962766129, 'psi': 0.6589568213242549}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] START round=49 head_norm_before_train=1.869550 cos_to_last_merge=1.0000 (last merge round=48)
[S7] round=49 local utility u=0.000000 metrics={'f1_val': 0.5892979629842978, 'auprc': 0.7940833963860242, 'loss_val': 0.7245707819475745, 'psi': 0.6712121363449883}-{'f1_val': 0.6083232868708971, 'auprc': 0.7987363089591758, 'loss_val': 0.6181210632806124, 'psi': 0.6844884957062086}
[S8] START round=49 head_norm_before_train=1.869550 cos_to_last_merge=1.0000 (last merge round=48)
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.989780933099827, 'auprc': 0.9995102802249385, 'loss_val': 0.04102911187849638, 'psi': 0.9936726719498716}-{'f1_val': 0.9928938724649488, 'auprc': 0.9987158252501593, 'loss_val': 0.030962433300299404, 'psi': 0.995222653579033}
[S9] START round=49 head_norm_before_train=1.642033 cos_to_last_merge=1.0000 (last merge round=46)
[S9] round=49 local utility u=0.007283 metrics={'f1_val': 0.9956054446615002, 'auprc': 0.9983741204555372, 'loss_val': 0.028951099695244318, 'psi': 0.996712914979115}-{'f1_val': 0.993909773892786, 'auprc': 0.9979534420425129, 'loss_val': 0.032081711471206246, 'psi': 0.9955272411526768}
[S10] START round=49 head_norm_before_train=2.207185 (no previous merge yet)
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.9951633020469546, 'auprc': 0.9974125207569354, 'loss_val': 0.02584749603554939, 'psi': 0.996062989530947}-{'f1_val': 0.9951633020469546, 'auprc': 0.9975603941429798, 'loss_val': 0.02575843053787606, 'psi': 0.9961221388853647}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=49 head_norm_before_train=1.659324 cos_to_last_merge=1.0000 (last merge round=47)
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.995520683848358, 'auprc': 0.9991076796246301, 'loss_val': 0.039037015183727965, 'psi': 0.9969554821588669}-{'f1_val': 0.9967224195815153, 'auprc': 0.9984840672632895, 'loss_val': 0.04009111791058195, 'psi': 0.997427078654225}
[S13] START round=49 head_norm_before_train=1.756087 cos_to_last_merge=0.8536 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.854
[S13] round=49 local utility u=0.023972 metrics={'f1_val': 0.694269581561314, 'auprc': 0.7284714879618095, 'loss_val': 0.8725697825507807, 'psi': 0.7079503441215123}-{'f1_val': 0.7126473832571059, 'auprc': 0.7175665514062645, 'loss_val': 0.9980658803654295, 'psi': 0.7146150505167692}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=49 head_norm_before_train=1.853228 cos_to_last_merge=0.9983 (last merge round=37)
[S14] round=49 local utility u=0.075641 metrics={'f1_val': 0.9973564738121283, 'auprc': 0.9969608296324838, 'loss_val': 0.02974374606375151, 'psi': 0.9971982161402705}-{'f1_val': 0.9762186322987483, 'auprc': 0.9969584683188382, 'loss_val': 0.05419068883820719, 'psi': 0.9845145667067842}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=49 head_norm_before_train=1.725579 cos_to_last_merge=1.0000 (last merge round=48)
[S15] round=49 local utility u=0.000000 metrics={'f1_val': 0.8942582961370296, 'auprc': 0.9499846735054123, 'loss_val': 0.3256727937483295, 'psi': 0.9165488470843827}-{'f1_val': 0.9971172535281002, 'auprc': 0.9973156198284892, 'loss_val': 0.023272676256868643, 'psi': 0.9971966000482557}
[S16] START round=49 head_norm_before_train=1.632573 cos_to_last_merge=0.9860 (last merge round=31)
[S16] round=49 local utility u=0.000457 metrics={'f1_val': 0.9917006414071721, 'auprc': 0.9954484883250999, 'loss_val': 0.042272464425930786, 'psi': 0.9931997801743432}-{'f1_val': 0.9914570070691986, 'auprc': 0.9958266570054993, 'loss_val': 0.04285884714911058, 'psi': 0.9932048670437189}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=49 head_norm_before_train=1.917404 cos_to_last_merge=0.9794 (last merge round=32)
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.7516441038632629, 'auprc': 0.9301789853754275, 'loss_val': 0.8405689083600985, 'psi': 0.8230580564681287}-{'f1_val': 0.9030925847504625, 'auprc': 0.934393876304051, 'loss_val': 0.4974490086723465, 'psi': 0.9156131013718979}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:58312
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:58315
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1804 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1804) from S5
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.679413)
[S15] loaded HEAD from S5 (vec_in norm=1.679413)
[S15] cosine check vs S5: cos=0.9996
[S15] BUFFERED delta from S5 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1798) from S9
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.650400)
[S11] loaded HEAD from S9 (vec_in norm=1.650400)
[S11] cosine check vs S9: cos=0.9995
[S11] BUFFERED delta from S9 (total buffered=1)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=49 metric=0.9886 head_norm=1.679413
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.868668e-02
[S5] stored merged vector for next round verification (round=49)
[S5] DEBUG after merge:  round=49 metric=0.9906 head_norm=1.726544 delta_norm=0.058687
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[runner] rounds complete.
[runner] all agents stopped.
